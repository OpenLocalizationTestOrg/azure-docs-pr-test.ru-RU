---
title: "Среда выполнения интеграции в фабрике данных Azure | Документация Майкрософт"
description: "Сведения о среде выполнения интеграции в фабрике данных Azure."
services: data-factory
documentationcenter: 
author: sharonlo101
manager: jhubbard
editor: spelluru
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 01/22/2018
ms.author: shlo
ms.openlocfilehash: 5285cddcb64e44cb61c99cc18f8a66d60cd1c0fc
ms.sourcegitcommit: 9cc3d9b9c36e4c973dd9c9028361af1ec5d29910
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2018
---
# <a name="integration-runtime-in-azure-data-factory"></a>Среда выполнения интеграции в фабрике данных Azure
Среда выполнения интеграции (IR) — это инфраструктура вычислений, которую фабрика данных Azure использует для обеспечения перечисленных ниже возможностей интеграции данных в разных сетевых средах.

- **Перемещение данных**. Перемещение данных между хранилищами данных в общедоступной сети и хранилищами данных в частной сети (локальной или виртуальной частной сети). Поддерживаются встроенные соединители, преобразование форматов, сопоставление столбцов, высокопроизводительная и масштабируемая передача данных.
- **Диспетчеризация действий**. Назначение и мониторинг действий по преобразованию в разных службах вычислений, например Azure HDInsight, Машинное обучение Azure, база данных SQL Azure, SQL Server и других.
- **Выполнение пакетов служб SSIS**. Выполнение пакетов служб SQL Server Integration Services (SSIS) в собственном коде в управляемой вычислительной среде Azure.


> [!NOTE]
> Эта статья относится к версии 2 фабрики данных, которая в настоящее время доступна в предварительной версии. Если вы используете общедоступную версию 1 службы фабрики данных, используйте [документацию по версии 1 фабрики данных](v1/data-factory-introduction.md).

В фабрике данных действия определяют выполняемые операции. Связанная служба обозначает целевое хранилище данных или службу вычислений. Среда выполнения интеграции соединяет между собой действия и связанные службы.  Связанные службы ссылаются на эту среду, которая предоставляет вычислительную среду для выполнения или диспетчеризации действий.  Такая схема позволяет выполнять действия в регионе, который максимально близко расположен к целевому хранилищу данных или службе вычислений, обеспечивает высокую производительность и соблюдение требований по безопасности и соответствию.

## <a name="integration-runtime-types"></a>Типы сред выполнения интеграции
Фабрика данных предлагает три типа сред выполнения интеграции. Вы можете выбрать тот, который отвечает вашим потребностям в интеграции данных и сетевой среде.  Эти три типа перечислены ниже.

- Таблицы Azure
- Локальное размещение
- Службы SSIS Azure

В следующей таблице описаны возможности и поддержка сетей для каждого типа интеграции среды выполнения.

Тип IR | Общедоступная сеть | Частная сеть
------- | -------------- | ---------------
Таблицы Azure | Перемещение данных<br/>Диспетчеризация действий | &nbsp;
Локальное размещение | Перемещение данных<br/>Диспетчеризация действий | Перемещение данных<br/>Диспетчеризация действий
Службы SSIS Azure | Выполнение пакетов служб SSIS | Выполнение пакетов служб SSIS

На следующей схеме показано, как сочетать разные среды выполнения интеграции, чтобы обеспечить максимальные возможности по интеграции данных и поддержку сетей.

![Разные типы среды выполнения интеграции](media\concepts-integration-runtime\different-integration-runtimes.png)


## <a name="azure-integration-runtime"></a>Среда выполнения интеграции Azure
В среде выполнения интеграции Azure доступны следующие возможности.

- Выполнение действия копирования между облачными хранилищами данных
- Диспетчеризация нескольких действий преобразования в общедоступной сети: действие Hive в HDInsight, действие Pig в HDInsight, действие MapReduce в HDInsight, действие Spark в HDInsight, действие потоковой передачи в HDInsight, действие пакетного выполнения в Машинном обучении, действие обновления ресурсов в Машинном обучении, действие хранимой процедуры, действие U-SQL в Data Lake Analytics, настраиваемое действие .Net, веб-действия, действия поиска и действие получения метаданных.

### <a name="network-environment"></a>Сетевая среда
Среда выполнения интеграции Azure поддерживает подключение к хранилищам данных и службам вычислений в общедоступной сети с использованием общедоступных конечных точек. Для среды виртуальных сетей Azure следует использовать локально размещенную среду выполнения интеграции.

### <a name="compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование
Среда выполнения интеграции Azure предоставляет полностью управляемые вычисления в Azure без использования серверов.  Вам не нужно подготавливать инфраструктуру, устанавливать программное обеспечение, применять исправления и масштабировать емкость.  Кроме того, вы платите только за фактическое время использования.

Среда выполнения интеграции Azure предоставляет вычисления в собственном коде для безопасного, надежного и высокопроизводительного перемещения данных между облачными хранилищами данных.  Вам достаточно указать, сколько единиц перемещения данных нужно использовать для действия копирования, и среда Azure IR гибко увеличивает масштаб вычислительной среды соответствующим образом. Вам не нужно явно изменять размеры среды выполнения интеграции Azure.

Диспетчеризация действий не требует больших ресурсов, поскольку лишь перенаправляет действие на целевую службу вычислений. В этом сценарии вам не нужно увеличивать масштаб вычислительной среды.

Сведения о создании и настройке Azure IR см. в руководстве по созданию и настройке Azure IR. 

## <a name="self-hosted-integration-runtime"></a>Локальная среда IR
В локальной среде IR доступны следующие возможности.

- Выполнение действия копирования между облачными хранилищами данных и хранилищем данных в частной сети.
- Диспетчеризация нескольких действий преобразования для вычислительных ресурсов, размещенных локально или в виртуальной сети Azure: действие Hive в HDInsight (BYOC), действие Pig в HDInsight (BYOC), действие MapReduce в HDInsight (BYOC), действие Spark в HDInsight (BYOC), действие потоковой передачи в HDInsight (BYOC), действие пакетного выполнения в Машинном обучении, действие обновления ресурсов в Машинном обучении, действие хранимой процедуры, действие U-SQL в Data Lake Analytics, настраиваемое действие .Net, действия поиска и действие получения метаданных.

> [!NOTE] 
> Локальную среду выполнения интеграции следует использовать для поддержки хранилищ данных с собственными драйверами, таких как SAP Hana, MySQL и т.д.  Дополнительные сведения см. в [списке поддерживаемых хранилищ данных](copy-activity-overview.md#supported-data-stores-and-formats).

### <a name="network-environment"></a>Сетевая среда
Если вы хотите безопасно выполнять интеграцию данных в среде частной сети, которая не связана напрямую с общедоступной облачной средой, вы можете установить локальную IR в локальной среде за корпоративным брандмауэром или внутри виртуальной частной сети.  Локальная среда выполнения интеграции использует только исходящие HTTP-соединения во внешнюю сеть.

### <a name="compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование
Локальная IR устанавливается на локальном компьютере или виртуальной машине в частной сети. В настоящее время локальная IR может выполняться только в операционной системе Windows.  

Чтобы получить высокий уровень доступности и масштабируемости, разверните локальную IR. Для этого следует связать логический экземпляр с несколькими локальными компьютерами в режиме "активный — активный".  Дополнительные сведения см. в руководстве по созданию и настройке локальной IR.

## <a name="azure-ssis-integration-runtime"></a>Среда выполнения интеграции Azure SSIS
Чтобы переместить уже существующую рабочую нагрузку SSIS, создайте Azure SSIS IR для выполнения пакетов служб SSIS в собственной среде.

### <a name="network-environment"></a>Сетевая среда
Среда выполнения интеграции Azure SSIS может быть подготовлена в общедоступной сети или частной сети.  Доступ к локальным данным осуществляется за счет объединения Azure SSIS IR с виртуальной сетью, подключенной к локальной сети.  

### <a name="compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование
Azure SSIS IR — это полностью управляемый кластер виртуальных машин Azure, выделенный для выполнения пакетов служб SSIS. Для размещения подключаемого каталога проектов и (или) пакетов служб SSIS (SSISDB) вы можете использовать собственную базу данных SQL Azure или сервер управляемого экземпляра (предоставляется в закрытой предварительной версии). Чтобы увеличить или уменьшить масштаб вычислительных ресурсов, укажите соответствующее количество узлов в кластере. Чтобы снизить расходы на среду выполнения интеграции служб SSIS Azure, вы можете в любой момент останавливать ее и снова запускать.

Дополнительные сведения см. в руководстве по созданию и настройке Azure SSIS IR.  После создания среды вы сможете развернуть существующие пакеты служб SSIS и управлять ими практически так же, как при использовании локальной SSIS, с помощью привычных средств, например SQL Server Data Tools (SSDT) и SQL Server Management Studio (SSMS).

Дополнительные сведения о среде выполнения Azure SSIS см. в следующих статьях: 

- [Развертывание пакетов служб интеграции SQL Server (SSIS) в Azure](tutorial-deploy-ssis-packages-azure.md). Эта статья содержит пошаговые инструкции для создания Azure SSIS IR и использует базу данных SQL Azure для размещения каталога SSIS. 
- [Создание среды выполнения интеграции Azure SSIS](create-azure-ssis-integration-runtime.md). Эта статья дополняет соответствующее руководство, а также предоставляет инструкции по использованию управляемого экземпляра SQL Azure (закрытая предварительная версия) и присоединению среды выполнения интеграции к виртуальной сети. 
- [Мониторинг среды выполнения интеграции в фабрике данных Azure](monitor-integration-runtime.md#azure-ssis-integration-runtime). В этом статье показано, как извлечь сведения о среде выполнения интеграции Azure SSIS и описания состояний из возвращаемых данных. 
- [Управление средой выполнения интеграции Azure SSIS](manage-azure-ssis-integration-runtime.md). В этой статье показано, как остановить, запустить или удалить Azure SSIS IR. В ней также показано, как развернуть Azure SSIS IR путем добавления дополнительных узлов в среду выполнения интеграции. 
- [Join an Azure-SSIS integration runtime to a virtual network](join-azure-ssis-integration-runtime-virtual-network.md) (Присоединение среды выполнения интеграции Azure SSIS к виртуальной сети). В этой статье содержатся общие сведения о присоединении среды выполнения интеграции SSIS Azure к виртуальной сети Azure. В ней также показано, как настроить виртуальную сеть, чтобы присоединить среду выполнения интеграции SSIS Azure к виртуальной сети с помощью портала Azure. 

## <a name="determining-which-ir-to-use"></a>Выбор IR для использования
Для каждого действия преобразования задается целевая связанная служба вычислений, которая указывает на определенную среду выполнения интеграции. Этот экземпляр среды выполнения интеграции будет отвечать за диспетчеризацию действия преобразования.

Для действия копирования нужны связанные службы источника и приемника данных, которые определяют направление потока данных. Далее описан алгоритм выбора экземпляра среды выполнения интеграции, который будет выполнять копирование. 

- **Копирование между двумя облачными источниками данных**. Если связанные службы источника и приемника используют Azure IR, действие копирования выполняется в среде выполнения интеграции, которую использует связанная служба приемника.
- **Копирование между облачным источником данных и источником данных в частной сети**. Если связанная служба источника или приемника использует локальную IR, действие копирования выполняется в среде в этой локальной среде.
- **Копирование между двумя источниками данных в частной сети**. Обе связанные службы источника и приемника должны указывать на один экземпляр среды выполнения интеграции, и именно эта среда используется для выполнения действия копирования.

На следующей схеме показаны два примера действия копирования.

- Источником действия копирования 1 является связанная служба SQL Server, которая ссылается на локальную IR с именем A. В качестве приемника используется связанная служба хранилища Azure, которая ссылается на Azure IR с именем B. При запуске действия копирования оно выполняется в локальной IR с именем A.
- Источником действия копирования 2 является связанная служба базы данных Azure, которая ссылается на Azure IR с именем C. В качестве приемника выбрана связанная служба хранилища Azure, которая ссылается на Azure IR с именем B. При запуске действия копирования оно выполняется в Azure IR с именем B, так как эту среду выполнения интеграции использует связанная служба приемника.

![Какую среду выполнения интеграции использовать](media/concepts-integration-runtime/which-integration-runtime-to-use.png)

## <a name="integration-runtime-location"></a>Расположение среды выполнения интеграции
Расположение фабрики данных — это место, в котором хранятся метаданные этой фабрики данных и из которого инициируется конвейер. Сейчас поддерживаются следующие расположения фабрики данных: восточная часть США, восточная часть США 2 и Западная Европа. Однако для перемещения данных между хранилищами данных или для обработки данных с помощью служб вычислений фабрики данных могут обращаться к хранилищам данных и службам вычислений в других регионах Azure. Это поведение реализуется через глобально доступные IR в нескольких регионах для обеспечения соответствия данных, эффективности и снижения расходов на исходящий трафик.

Расположение среды IR определяет расположение ее вычислительных ресурсов, то есть, по сути, место выполнения всех операций по перемещению данных, диспетчеризации действий и выполнению пакета SSIS. Расположение IR может отличаться от расположения фабрики данных, которой она принадлежит. На следующей схеме показаны параметры расположения фабрики данных и ее среды выполнения интеграции.

![Расположение среды выполнения интеграции](media/concepts-integration-runtime/integration-runtime-location.png)

### <a name="azure-ir"></a>Azure IR
Фабрика данных использует для перемещения данных Azure IR, расположенную в ближайшем к приемнику данных регионе. Сопоставления см. в следующей таблице.

География хранилища данных приемника | Расположение хранилища данных приемника | Расположение, используемое для среды выполнения интеграции Azure
-------------------------------| ----------------| ------------------
США | Восток США | Восток США
&nbsp; | Восток США 2 | Восток США 2
&nbsp; | Центральный регион США | Центральный регион США
&nbsp; | Северо-центральный регион США | Северо-центральный регион США
&nbsp; | Южно-центральный регион США | Южно-центральный регион США
&nbsp; | Западно-центральная часть США | Западно-центральная часть США
&nbsp; | Запад США | Запад США
&nbsp; | Западный регион США 2 | Западный регион США 2
Канада | Восточная Канада | Центральная Канада
&nbsp; | Центральная Канада | Центральная Канада
Бразилия | Южная часть Бразилии | Южная часть Бразилии
Европа | Северная Европа | Северная Европа
&nbsp; | Западная Европа | Западная Европа
Великобритания | Западная часть Великобритании | Южная часть Великобритании
&nbsp; | Южная часть Великобритании | Южная часть Великобритании
Азиатско-Тихоокеанский регион | Юго-Восточная Азия | Юго-Восточная Азия
&nbsp; | Восточная Азия | Юго-Восточная Азия
Австралия | Восточная часть Австралии | Восточная часть Австралии
&nbsp; | Юго-Восточная часть Австралии | Юго-Восточная часть Австралии
Япония | Восточная часть Японии | Восточная часть Японии
&nbsp; | Западная часть Японии | Восточная часть Японии
Корея | Центральная Корея | Центральная Корея
&nbsp; | Южная Корея | Центральная Корея
Индия | Центральная Индия | Центральная Индия
&nbsp; | Западная Индия | Центральная Индия
&nbsp; | Южная Индия | Центральная Индия

Также вы можете задать автоматическое разрешение для расположения Azure IR. Тогда фабрика данных попытается автоматически выбрать лучшее расположение, используя определение связанной службы.

> [!NOTE] 
> Если регион целевого хранилища данных не числится в этом списке или не может быть определен, действие копирования для соблюдения ограничений соответствия завершается ошибкой, а не выполняется через другой регион. В таком случае следует явно указать альтернативное расположение для выполнения копирования.
 
На рисунке ниже показан пример выбора расположения, когда настроено автоматическое разрешение расположения Azure IR. При запуске действия копирования определяется расположение приемника данных, в этом примере это "западная Япония".  С учетом представленных в таблице данных для выполнения фактического копирования данных будет выбрана IR Azure в восточной Японии. Если эта же IR будет использоваться для подключения к HDInsight при выполнении действия Spark, отправка приложения Spark происходит из расположения фабрики данных (в нашем примере — "восток США"), а фактическое выполнение приложения Spark происходит в расположении сервера HDInsight. 

![Используемое расположение](media/concepts-integration-runtime/effective-location.png)

### <a name="self-hosted-ir"></a>Локально размещаемая IR
Локальная IR логически регистрируется в фабрике данных, а вычислительные ресурсы для ее работы вы предоставляете самостоятельно. Поэтому для локальных IR нельзя явно задать свойство расположения. 

Если локальная IR используется для перемещения данных, она извлекает данные из источника и записывает их в приемник.

### <a name="azure-ssis-ir"></a>Azure SSIS IR
От выбора расположения для службы Azure SSIS IR зависит производительность рабочих процессов извлечения, преобразования и загрузки.  В предварительной версии изначально доступны два расположения: восточная часть США и Северная Европа.

- Расположение Azure SSIS IR может не совпадать с расположением фабрики данных, но должно совпадать с расположением сервера базы данных SQL Azure или управляемого экземпляра (закрытая предварительная версия), на которых размещается база данных SSIS. Это позволит среде выполнения интеграции Azure SSIS легко обращаться к базе данных SSIS, не генерируя лишний трафик между расположениями.
- Если для размещения базы данных SSIS вы используете источники и назначения данных в локальной сети, а не существующий сервер базы данных SQL Azure или управляемого экземпляра (закрытой предварительной версии), создайте новый сервер базы данных SQL Azure или управляемого экземпляра (закрытой предварительной версии) в том же расположении, в котором находится виртуальная сеть, подключенная к этой локальной сети.  Таким образом вы можете создать службу Azure SSIS IR, использующую новый сервер базы данных SQL Azure или управляемого экземпляра (закрытой предварительной версии), и подключить эту службу к виртуальной сети. Так как все эти ресурсы находятся в одном расположении, трафик между разными расположениями будет минимальным.
- Иногда расположение существующего сервера базы данных SQL Azure или управляемого экземпляра (закрытой предварительной версии), на котором размещается база данных SSIS, не совпадает с расположением виртуальной сети, подключенной к локальной сети. В этом случае сначала создайте службу Azure SSIS IR, использующую существующий сервер базы данных SQL Azure или управляемого экземпляра (закрытой предварительной версии), и присоедините ее к другой виртуальной сети в том же расположении, а затем настройте подключение между виртуальными сетями из разных расположений.


## <a name="next-steps"></a>Дополнительная информация
Ознакомьтесь со следующими статьями:

- [Создание и настройка локальной среды выполнения интеграции](create-self-hosted-integration-runtime.md)
- [Создание среды выполнения интеграции Azure SSIS в фабрике данных Azure](create-azure-ssis-integration-runtime.md). Эта статья дополняет соответствующее руководство, а также предоставляет инструкции по использованию управляемого экземпляра SQL Azure (закрытая предварительная версия) и присоединению среды выполнения интеграции к виртуальной сети. 
