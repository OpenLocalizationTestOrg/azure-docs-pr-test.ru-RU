---
title: "Обеспечение высокого уровня доступности с помощью шлюза управления данными в фабрике данных Azure | Документация Майкрософт"
description: "В этой статье объясняется, как можно развернуть шлюз управления данными, добавив дополнительные узлы, и увеличить его масштаб, увеличив число одновременных заданий, которые могут выполняться на одном узле."
services: data-factory
documentationcenter: 
author: nabhishek
manager: jhubbard
editor: 
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/10/2018
ms.author: abnarain
robots: noindex
ms.openlocfilehash: 195a1a4810de478b77538716fa8d1362428864d8
ms.sourcegitcommit: 9cc3d9b9c36e4c973dd9c9028361af1ec5d29910
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2018
---
# <a name="data-management-gateway---high-availability-and-scalability-preview"></a>Шлюз управления данными: высокий уровень доступности и масштабируемость (предварительная версия)
> [!NOTE]
> Статья относится к версии 1 фабрики данных, которая является общедоступной версией. Если вы используете версию 2 службы фабрики данных, которая находится на этапе предварительной версии, прочитайте статью о [локальной среде выполнения интеграции в версии 2](../create-self-hosted-integration-runtime.md). 


Эта статья поможет вам настроить решение по обеспечению высокого уровня доступности и масштабируемости с помощью шлюза управления данными (Integration Runtime).    

> [!NOTE]
> В этой статье предполагается, что вы уже знакомы с основным концепциями Integration Runtime (ранее известной как шлюз управления данными). В противном случае см. статью [Шлюз управления данными](data-factory-data-management-gateway.md).

>**Эта функция предварительного просмотра официально поддерживается в версии 2.12.xxxx.x шлюза управления данными и более поздних версиях**. Убедитесь, что вы используете версию 2.12.xxxx.x или более позднюю версию. Загрузите [актуальную](https://www.microsoft.com/download/details.aspx?id=39717) версию шлюза управления данными.

## <a name="overview"></a>Обзор
Шлюзы управления данными, установленные на нескольких локальных компьютерах, можно связать с одним логическим шлюзом с портала. Эти компьютеры называются **узлами**. С логическим шлюзом можно связать **четыре узла**. Ниже перечислены преимущества связывания нескольких узлов (локальных компьютеров с установленным шлюзом) с логическим шлюзом.  

- Повышение производительности перемещения данных между локальными и облачными хранилищами данных.  
- Доступность узлов для переноса данных при сбое одного из узлов. 
- Доступность узлов для переноса данных при необходимости перевода одного из узлов в автономный режим для обслуживания.

Кроме того, вы можете настроить количество **одновременных заданий перемещения данных**, которые можно запустить на узле, чтобы расширить возможность перемещения данных между локальными и облачными хранилищами данных. 

С помощью портала Azure можно отслеживать состояние этих узлов. Так вы сможете решить, следует ли добавить или удалить узел в логическом шлюзе. 

## <a name="architecture"></a>Архитектура 
Следующая схема содержит общие сведения об архитектуре решений по обеспечению масштабируемости и доступности для шлюза управления данными: 

![Шлюз управления данными: высокий уровень доступности и масштабируемость](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-high-availability-and-scalability.png)

**Логический шлюз** добавляется в фабрику данных на портале Azure. Раньше с логическим шлюзом можно было связать только один локальный компьютер с Windows, на котором установлен шлюз управления данными. Этот локальный компьютер со шлюзом называется узлом. Теперь же с логическим шлюзом можно связать **четыре физических узла**. Логический шлюз с несколькими узлами называется **шлюзом с несколькими узлами**.  

Все узлы **активны**. Все они могут обрабатывать задания перемещения данных между локальными и облачными хранилищами данных. Один из узлов выполняет функции диспетчера и рабочей роли, а другие узлы в группах являются рабочими. Узел-**диспетчер** извлекает задачи и задания перемещения данных из облачной службы и передает их на рабочие узлы (и самому себе). **Рабочий** узел выполняет задания перемещения данных между локальными и облачными хранилищами данных. Все узлы являются рабочими, но только один узел может быть узлом-диспетчером и рабочим узлом.    

Обычно можно начать работу с одним узлом и по мере повышения нагрузки при перемещении данных на имеющийся узел **выполнить развертывание**, чтобы добавить дополнительные узлы. Кроме того, можно **расширить** возможность узла шлюза к перемещению данных, увеличив количество одновременных заданий, которые разрешено запускать на узле. Эта возможность также доступна для шлюза с одним узлом (даже если не включена функция масштабируемости и доступности). 

Шлюз с несколькими узлами синхронизирует учетные данные хранилища данных на всех узлах. Учетные данные могут рассинхронизироваться при проблеме подключения между узлами. Когда вы задаете учетные данные для локального хранилища данных, использующего шлюз, они сохраняются на узле, выполняющем функции узла-диспетчера и рабочего узла. Узел-диспетчер синхронизируется с другими рабочими узлами. Этот процесс известен как **синхронизация учетных данных**. Коммуникационный канал между узлами может **шифроваться** с помощью открытого SSL- или TLS-сертификата. 

## <a name="set-up-a-multi-node-gateway"></a>Настройка шлюза с несколькими узлами
В этом разделе предполагается, что вы ознакомились со следующими двумя статьями или знакомы с указанными в них концепциями: 

- Статья [Шлюз управления данными](data-factory-data-management-gateway.md) содержит подробный обзор шлюза.
- Статья [Перемещение данных между локальными источниками и облаком с помощью шлюза управления данными](data-factory-move-data-between-onprem-and-cloud.md) содержит пошаговые инструкции по использованию шлюза с одним узлом.  

> [!NOTE]
> Прежде чем устанавливать шлюз управления данными на локальном компьютере с Windows ознакомьтесь с предварительными требованиями, перечисленными в [основной статье](data-factory-data-management-gateway.md#prerequisites).

1. В ходе создания логического шлюза в рамках [пошагового руководства](data-factory-move-data-between-onprem-and-cloud.md#create-gateway) включите возможность **Высокий уровень доступности и масштабируемость**. 

    ![Шлюз управления данными: включение возможности "Высокий уровень доступности и масштабируемость"](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-enable-high-availability-scalability.png)
2. На странице **Настройка** воспользуйтесь ссылкой **Экспресс-установка** или **Установка вручную**, чтобы установить шлюз на первом узле (на локальном компьютере с Windows).

    ![Шлюз управления данными: экспресс-установка или установка вручную](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-express-manual-setup.png)

    > [!NOTE]
    > Если вы выбрали экспресс-установку, узлы взаимодействуют без шифрования. Имя узла соответствует имени компьютера. Используйте установку вручную, если связь между узлами должна шифроваться или если требуется указать собственное имя узла. Имена узлов невозможно изменить позже.
3. Если выбрать **экспресс-установку**:
    1. После успешной установки шлюза появится следующее сообщение:

        ![Шлюз управления данными: успешное выполнение экспресс-установки](media/data-factory-data-management-gateway-high-availability-scalability/express-setup-success.png)
    2. Запустите Configuration Manager шлюза управления данными, следуя [этим инструкциям](data-factory-data-management-gateway.md#configuration-manager). Отобразится имя шлюза, имя узла, сведения о состоянии и т. д.

        ![Шлюз управления данными: успешная установка](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-installation-success.png)
4. Если выбрать **установку вручную**:
    1. Скачайте пакет установки из Центра загрузки Майкрософт и запустите его, чтобы установить шлюз на компьютере.
    2. Используйте **ключ аутентификации** со страницы **Настройка** для регистрации шлюза.
    
        ![Шлюз управления данными: успешная установка](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-authentication-key.png)
    3. На странице **New gateway node** (Новый узел шлюза) можно указать пользовательское **имя** узла шлюза. По умолчанию имя узла соответствует имени компьютера.    

        ![Шлюз управления данными: указание имени](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-name.png)
    4. На следующей странице можно **включить шифрование для взаимодействия между узлами**. Нажмите кнопку **Пропустить** для отключения шифрования (по умолчанию).

        ![Шлюз управления данными: включение шифрования](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-node-encryption.png)  
    
        > [!NOTE]
        > Изменение режима шифрования поддерживается только при узлах с одним шлюзом в логическом шлюзе. Чтобы изменить режим шифрования для шлюза с несколькими узлами, сделайте следующее: удалите все узлы, кроме одного, измените режим шифрования и добавьте узлы снова.
        > 
        > Список предварительных требований для использования TLS- и SSL-сертификатов см. в [этом разделе](#tlsssl-certificate-requirements). 
    5. После успешной установки шлюза нажмите кнопку Launch Configuration Manager (Запустить Configuration Manager):
    
        ![Установка вручную: запуск Configuration Manager](media/data-factory-data-management-gateway-high-availability-scalability/manual-setup-launch-configuration-manager.png)   
    6. Отобразится Configuration Manager шлюза управления данными на узле (локальный компьютер с Windows). Здесь будут показаны сведения о состоянии подключения, **имя шлюза** и **имя узла**.  

        ![Шлюз управления данными: успешная установка](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-installation-success.png)

        > [!NOTE]
        > При подготовке шлюза в виртуальной машине Azure можно воспользоваться [этим шаблоном Azure Resource Manager](https://github.com/Azure/azure-quickstart-templates/tree/master/101-mutiple-vms-with-data-management-gateway). Этот сценарий создает логический шлюз, настраивает виртуальные машины с установленным программным обеспечением шлюза управления данными и регистрирует их в логическом шлюзе. 
6. На портале Azure откройте страницу **Шлюз**: 
    1. На домашней странице фабрики данных на портале щелкните **Связанные службы**.
    
        ![Домашняя страница фабрики данных](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-home-page.png)
    2. Выберите **шлюз** для просмотра страницы **Шлюз**:
    
        ![Домашняя страница фабрики данных](media/data-factory-data-management-gateway-high-availability-scalability/linked-services-gateway.png)
    4. После этого отобразится страница **шлюза**:   

        ![Представление шлюза с одним узлом](media/data-factory-data-management-gateway-high-availability-scalability/gateway-first-node-portal-view.png) 
7. Щелкните **Add Node** (Добавить узел) на панели инструментов, чтобы добавить узел в логической шлюз. Если вы планируете использовать экспресс-установку, выполните этот шаг на локальном компьютере, который будет добавлен в качестве узла к шлюзу. 

    ![Шлюз управления данными: меню Add Node (Добавить узел)](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-add-node-menu.png)
8. Действия аналогичны действиям при настройке первого узла. Если выбрать установку вручную, вы сможете задать имя узла в пользовательском интерфейсе Configuration Manager: 

    ![Configuration Manager: установка второго шлюза](media/data-factory-data-management-gateway-high-availability-scalability/install-second-gateway.png)
9. После успешной установки шлюза на узле в инструменте Configuration Manager отобразится следующий экран:  

    ![Configuration Manager: успешная установка второго шлюза](media/data-factory-data-management-gateway-high-availability-scalability/second-gateway-installation-successful.png)
10. При открытии страницы **шлюза** на портале отобразятся два узла шлюза: 

    ![Шлюз с двумя узлами на портале](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-multi-node-monitoring.png)
11. Чтобы удалить узел шлюза, щелкните **Delete Node** (Удалить узел) на панели инструментов, выберите узел, который требуется удалить, и щелкните **Удалить** на панели инструментов. При этом выбранный узел удаляется из группы, а программное обеспечение шлюза управления данными не удаляется с узла (локальный компьютер с Windows). Воспользуйтесь функцией **Установка и удаление программ** на панели управления на локальном компьютере для удаления шлюза. При удалении шлюза из узла он автоматически удаляется на портале.   

## <a name="upgrade-an-existing-gateway"></a>Обновление имеющегося шлюза
Вы можете обновить имеющийся шлюз, чтобы использовать функцию обеспечения высокого уровня доступности и масштабируемости. Она работает только с узлами, на которых установлен шлюз управления данными версии 2.12.xxxx и более поздней. Версию шлюза управления данными, установленного на компьютере, можно просмотреть на вкладке **Справка** Configuration Manager шлюза управления данными. 

1. Обновите шлюз на локальном компьютере до последней версии. Для этого необходимо скачать и выполнить пакет установки формата MSI из [Центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=39717). Дополнительные сведения см. в разделе об [установке](data-factory-data-management-gateway.md#installation).  
2. Перейдите на портал Azure. Запустите страницу **фабрики данных** для своей фабрики данных. Щелкните плитку "Связанные службы", чтобы запустить страницу **Связанные службы**. Выберите шлюз для запуска страницы **шлюза**. Щелкните **Предварительная версия функции** и включите ее, как показано на следующем рисунке: 

    ![Шлюз управления данными: включение предварительной версии функции](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-existing-gateway-enable-high-availability.png)   
2. После включения предварительной версии функции на портале закройте все страницы. Снова откройте страницу **шлюза**, чтобы увидеть новую предварительную версию пользовательского интерфейса.
 
    ![Шлюз управления данными: успешное включение предварительной версии функции](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-preview-success.png)

    ![Шлюз управления данными: предварительная версия пользовательского интерфейса](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-preview.png)

    > [!NOTE]
    > Во время обновления имя первого узла соответствует имени компьютера. 
3. Теперь добавьте узел. На странице **шлюза** щелкните **Add Node** (Добавить узел).  

    ![Шлюз управления данными: меню Add Node (Добавить узел)](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-add-node-menu.png)

    Следуйте инструкциям в предыдущем разделе для настройки узла. 

### <a name="installation-best-practices"></a>Рекомендации по установке

- Настройте схему управления питанием на хост-компьютере шлюза, отключив спящий режим. Когда хост-компьютер переходит в спящий режим, шлюз не может отвечать на запросы данных.
- Создайте резервную копию сертификата, связанного со шлюзом.
- Для оптимальной производительности убедитесь, что все узлы настроены одинаково (рекомендуется). 
- Добавьте по крайней мере два узла, чтобы обеспечить высокий уровень доступности.  

### <a name="tlsssl-certificate-requirements"></a>Требования к TLS- и SSL-сертификатам
Ниже приведены требования к TLS- и SSL-сертификатам, используемым для защиты взаимодействия между узлами Integration Runtime.

- Сертификат должен быть общедоступным доверенным сертификатом X509 v3. Мы рекомендуем использовать сертификаты, выданные общедоступным (сторонним) центром сертификации.
- Доверие этому сертификату необходимо настроить на всех узлах Integration Runtime и на клиентском компьютере, на котором выполняется приложение диспетчера учетных данных. 
> [!NOTE]
> Приложение диспетчера учетных данных используется для безопасной настройки учетных данных в мастере копирования и (или) на портале Azure. Его можно выполнять с любого компьютера в той же сети, где расположено локальное (частное) хранилище данных.
- Поддерживаются групповые сертификаты. Например, если вы используете полное доменное имя **node1.domain.contoso.com**, в сертификате можно указать имя субъекта ***.domain.contoso.com**.
- Мы не рекомендуем использовать сертификаты с альтернативным именем субъекта (SAN), так как в текущей реализации применяется только последнее из альтернативных имен, а остальные игнорируются. (например, Если у вас есть сертификат SAN с альтернативными именами субъекта **node1.domain.contoso.com** и **node2.domain.contoso.com**, его можно применить только для компьютера с полным доменным именем **node2.domain.contoso.com**.
- Поддержка ключа любого размера, поддерживаемого Windows Server 2012 R2 для SSL-сертификатов.
- Сертификаты с ключами CNG не поддерживаются. Не поддерживаются сертификаты на основе ключей CNG.

#### <a name="faq-when-would-i-not-enable-this-encryption"></a>Часто задаваемые вопросы: когда не нужно включать шифрование?
Шифрование может повысить расходы на инфраструктуру (за счет оплаты общего сертификата). Этих расходов можно избежать, не используя шифрование в следующих случаях:
- Если Integration Runtime выполняется в доверенной сети или сети с прозрачным шифрованием типа IP/SEC. Так как коммуникации по такому каналу выполняются только в доверенной сети, дополнительное шифрование не требуется.
- Если Integration Runtime выполняется не в рабочей среде. Это поможет снизить стоимость сертификата TLS/SSL.


## <a name="monitor-a-multi-node-gateway"></a>Мониторинг шлюза с несколькими узлами
### <a name="multi-node-gateway-monitoring"></a>Мониторинг шлюза с несколькими узлами
На портале Azure можно просмотреть моментальный снимок использования ресурсов на каждом узле в режиме, близком к реальному времени, а также сведения о состоянии узлов шлюза. 

![Шлюз управления данными: мониторинг нескольких узлов](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-multi-node-monitoring.png)

Вы можете включить **дополнительные параметры** на странице **шлюза**, чтобы просмотреть дополнительные метрики, например **Сеть**(входящий и исходящий трафик), **Network** (Роль и состояние учетных данных) (удобно при устранении проблем со шлюзом) и **Параллельные задания** (с состоянием "Выполняется" и "Ограничение"). Последнюю метрику можно изменить соответствующим образом во время настройки производительности. В следующей таблице приводится описание столбцов в списке **Узлы шлюза**.  

Свойство мониторинга | ОПИСАНИЕ
:------------------ | :---------- 
ИМЯ | Имя логического шлюза и узлов, связанных со шлюзом.  
Status | Состояние логического шлюза и узлов шлюза, например, "В сети", "Автономно", "Ограничено" и т. д. Сведения об этих состояниях см. в разделе [Состояние шлюза](#gateway-status). 
Version (версия) | Указывает версию логического шлюза и каждого узла шлюза. Версия логического шлюза определяется на основе версии большинства узлов в группе. Если в логическом шлюзе настроены узлы с разными версиями, должным образом будут работать только те из них, версия которых совпадает с версией логического шлюза. Другие узлы находятся в ограниченном режиме и их необходимо обновлять вручную (только при сбое автоматического обновления). 
Объем доступной памяти | Объем доступной памяти на узле шлюза. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. 
загрузка ЦП; | Использование ЦП на узле шлюза. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. 
Networking (In/Out) (Сеть (входящий и исходящий трафик)) | Использование сети на узле шлюза. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. 
Concurrent Jobs (Running/Limit) (Одновременные задания (выполняемые и ограниченные)) | Число заданий или задач, выполняющихся на каждом узле. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. Ограничение означает максимальное количество одновременно выполняемых заданий для каждого узла. Это значение определяется на основе размера компьютера. Ограничение можно увеличить, чтобы увеличить масштаб параллельных заданий в сложных сценариях, где ЦП, память или сеть мало используются, но время ожидания действий истекает. Эта возможность также доступна для шлюза с одним узлом (даже если не включена функция масштабируемости и доступности). Дополнительные сведения см. в разделе о [рекомендациях по масштабированию](#scale-considerations). 
Роль | Существует два типа ролей — диспетчер и рабочая роль. Все узлы являются рабочими, то есть их можно использовать для выполнения заданий. Только один узел выполняет роль диспетчера, который используется для извлечения задачи или задания из облачных служб и отправки в разные рабочие узлы (включая сам узел-диспетчер). 

![Шлюз управления данными: расширенный мониторинг нескольких узлов](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-multi-node-monitoring-advanced.png)

### <a name="gateway-status"></a>Состояние шлюза

В следующей таблице представлены сведения о возможных состояниях **узла шлюза**: 

Status  | Комментарии и сценарии
:------- | :------------------
В сети | Узел подключен к службе фабрики данных.
Автономно | Узел находится в автономном режиме.
Обновление | Узел автоматически обновляется.
Ограничено | Это состояние появляется при проблемах с подключением. Возможно, из-за проблем с портом 8050 HTTP, подключением к служебной шине или синхронизацией учетных данных. 
Неактивно | Конфигурация узла отличается от конфигурации большинства других узлов.<br/><br/> Узел может быть неактивным, если он не может подключиться к другим узлам. 


В следующей таблице представлены сведения о возможных состояниях **логического шлюза**: Состояние шлюза зависит от состояния его узлов. 

Status | Комментарии
:----- | :-------
Needs Registration (Требуется регистрация) | В логическом шлюзе не зарегистрированы узлы.
В сети | Узлы шлюза подключены к сети.
Автономно | Узлы не подключены к сети.
Ограничено | Не все узлы в этом шлюзе находятся в работоспособном состоянии. Это состояние является предупреждением, что определенный узел не работает. <br/><br/>Возможно, это произошло из-за проблемы с синхронизацией учетных данных на узле-диспетчера или на рабочем узле. 

### <a name="pipeline-activities-monitoring"></a>Мониторинг конвейера и действий
На портале Azure предусмотрены инструменты для мониторинга конвейера, а также представлены подробные сведения на уровне узла. Например, здесь можно узнать о действиях, выполненных на разных узлах. Эти сведения полезны при определении проблем с производительностью на определенном узле, например из-за регулирования сети. 

![Шлюз управления данными: мониторинг нескольких узлов для конвейеров](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-multi-node-monitoring-pipelines.png)

![Шлюз управления данными: сведения о конвейере](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-multi-node-pipeline-details.png)

## <a name="scale-considerations"></a>Рекомендации по масштабированию

### <a name="scale-out"></a>Масштабирование
Когда **доступной памяти недостаточно**, а **ЦП сильно загружен**, можно добавить новый узел, чтобы распределить нагрузку по нескольким компьютерам. Если действия не выполняются из-за истечения времени ожидания или из-за того, что узел шлюза находится в автономном режиме, можно добавить узел к шлюзу.
 
### <a name="scale-up"></a>Увеличение масштаба
Если доступная память и ЦП используются неэффективно, но время простоя равно 0, следует увеличить масштаб, увеличив количество одновременных заданий, которые могут выполняться на узле. Кроме того, масштаб можно увеличить, если время ожидания действия истекает из-за перегрузки шлюза. Как показано на следующем рисунке, можно увеличить максимальную емкость для узла. Для начала мы рекомендуем увеличить ее вдвое.  

![Шлюз управления данными: рекомендации по масштабированию](media/data-factory-data-management-gateway-high-availability-scalability/data-factory-gateway-scale-considerations.png)


## <a name="known-issuesbreaking-changes"></a>Известные проблемы и критические изменения

- Сейчас можно настроить четыре узла физического шлюза для одного логического шлюза. Если для повышения производительности вам нужно больше четырех узлов, отправьте сообщение электронной почты по адресу [DMGHelp@microsoft.com](mailto:DMGHelp@microsoft.com).
- Невозможно повторно зарегистрировать узел шлюза с использованием ключа аутентификации из другого логического шлюза, чтобы переключиться с текущего логического шлюза. Для повторной регистрации удалите шлюз с узла, переустановите шлюз и зарегистрируйте его с использованием ключа аутентификации для другого логического шлюза. 
- Если прокси-сервер HTTP требуется для всех узлов шлюза, настройте его в файлах diahost.exe.config и diawp.exe.config и воспользуйтесь диспетчером сервера, чтобы убедиться, что эти файлы одинаковы на всех узлах. Дополнительные сведения см. в разделе о [настройке параметров прокси-сервера](data-factory-data-management-gateway.md#configure-proxy-server-settings). 
- Чтобы изменить режим шифрования для обмена данными между узлами в Configuration Manager шлюза, удалите все узлы на портале, кроме одного. Затем после изменения режима шифрования добавьте узлы обратно.
- Если вы решили шифровать коммуникационный канал для взаимодействия узлов, используйте официальный SSL-сертификат. Самозаверяющий сертификат может вызвать проблемы с подключением, так как тот же сертификат не может быть доверенным в списке центров сертификации на других компьютерах. 
- Невозможно зарегистрировать узел шлюза на логическом шлюзе, если версия узла меньше, чем версия логического шлюза. Удалите все узлы логического шлюза с портала, чтобы зарегистрировать узел меньшей версии. При удалении всех узлов логического шлюза нужно установить и зарегистрировать новые узлы на нем вручную. В этом случае экспресс-установка не поддерживается.
- Экспресс-установку нельзя использовать для установки узлов на имеющемся логическом шлюзе, который по-прежнему использует учетные данные облака. Узнать, где хранятся учетные данные, можно в Configuration Manager шлюза на вкладке "Параметры".
- Экспресс-установку нельзя использовать для установки узлов на имеющемся логическом шлюзе с включенным шифрованием канала для обмена данными между узлами. Так как при установке режима шифрования нужно вручную добавлять сертификаты, экспресс-установка невозможна. 
- Чтобы скопировать файл из локальной среды, не используйте каталог \\localhost или C:\files, так как не все узлы имеют доступ к localhost или к локальному диску. Вместо этого используйте каталог \\ServerName\files, чтобы указать расположение файлов.


## <a name="rolling-back-from-the-preview"></a>Откат с предварительной версии 
Чтобы выполнить откат с предварительной версии, удалите все узлы, кроме одного. Неважно, какие узлы вы удалите. Убедитесь, что в логическом шлюзе имеется хотя бы один узел. Вы можете удалить узел, удалив шлюз на компьютере или с помощью портала Azure. На портале Azure на странице **фабрики данных** щелкните "Связанные службы", чтобы открыть страницу **Связанные службы**. Выберите шлюз для запуска страницы **шлюза**. На странице шлюза отображаются узлы, связанные со шлюзом. Страница предназначена для удаления узла из шлюза.
 
После удаления щелкните **предварительные версии компонентов** на той же странице портала Azure и отключите предварительную версию функции. Вы выполнили сброс шлюза к общедоступной версии шлюза с одним узлом.


## <a name="next-steps"></a>Дополнительная информация
Ознакомьтесь со следующими статьями:
- Статья [Шлюз управления данными](data-factory-data-management-gateway.md) содержит подробный обзор шлюза.
- Статья [Перемещение данных между локальными источниками и облаком с помощью шлюза управления данными](data-factory-move-data-between-onprem-and-cloud.md) содержит пошаговые инструкции по использованию шлюза с одним узлом. 
