---
title: "aaaCreate функцию, которая интегрируется с приложениями логики Azure | Документы Microsoft"
description: "Создайте функцию, которая интегрируется с мнений твит toocategorize приложения логики Azure и Когнитивных служб Azure и отправки уведомлений при низкой мнений."
services: functions, logic-apps, cognitive-services
keywords: "рабочий процесс, облачные приложения, облачные службы, бизнес-процессы, системная интеграция, интеграция приложений, EAI"
documentationcenter: 
author: ggailey777
manager: erikre
editor: 
ms.assetid: 60495cc5-1638-4bf0-8174-52786d227734
ms.service: functions
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: glenga
ms.custom: mvc
ms.openlocfilehash: e176bd946af9a3684b3ad0e4b1bed1c3ee344019
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="create-a-function-that-integrates-with-azure-logic-apps"></a>Создание функции, интегрируемой с Azure Logic Apps

Функции Azure интегрируется с логикой приложения Azure в конструкторе логики приложения hello. Эта интеграция позволяет использовать hello вычислительной мощности в взаимодействий с другими Azure и служб сторонних функций. 

В этом учебнике показано функционирование toouse мнений tooanalyze логику приложения и Когнитивных служб Azure из сообщений Twitter. Функция активации HTTP классифицирует твиты как зеленый, желтый или красный, на основе показателя мнений hello. При обнаружении недопустимого мнения отправляется электронное сообщение. 

![Изображение первых двух действий приложения в конструкторе приложений логики](media/functions-twitter-email/designer1.png)

Из этого руководства вы узнаете, как выполнять такие задачи:

> [!div class="checklist"]
> * Создайте учетную запись Cognitive Services.
> * Создание функции, классифицирующей мнения, выраженные в твитах.
> * Создайте логику приложения, которое подключается tooTwitter.
> * Добавление мнений обнаружения toohello логику приложения. 
> * Hello логику приложения toohello функции соединения.
> * Отправьте сообщение электронной почты, на основании hello ответа от функции hello.

## <a name="prerequisites"></a>Предварительные требования

+ Активная учетная запись [Twitter](https://twitter.com/). 
+ Учетная запись [Outlook.com](https://outlook.com/) (для отправки уведомлений).
+ В этом разделе используется как его начала ресурсы hello точки, созданные в [создания первой функции из портала Azure hello](functions-create-first-azure-function.md).  
Если это еще не сделано, выполните toocreate теперь эти действия функции приложения.

## <a name="create-a-cognitive-services-account"></a>Создание учетной записи Cognitive Services

Учетная запись службы Когнитивных — идея hello необходимые toodetect твиты отслеживается.

1. Войдите в toohello [портал Azure](https://portal.azure.com/).

2. Нажмите кнопку hello **New** кнопка найдена в верхнем левом углу hello hello портал Azure.

3. Щелкните **Данные+аналитика** > **Cognitive Services**. Затем использовать hello параметры, как указано в таблице hello, примите условия hello и проверьте **toodashboard ПИН-кода**.

    ![Колонка создания учетной записи Cognitive Services](media/functions-twitter-email/cog_svcs_account.png)

    | Настройка      |  Рекомендуемое значение   | Описание                                        |
    | --- | --- | --- |
    | **Имя** | MyCognitiveServicesAccnt | Выберите уникальное имя учетной записи. |
    | **Тип API.** | API анализа текста | API используемого tooanalyze текста.  |
    | **Расположение** | Запад США | Сейчас для анализа текста доступен только регион **западная часть США**. |
    | **Ценовая категория** | F0 | Начните с hello нижнего уровня. При запуске из вызовов, масштабируйте tooa высокого уровня.|
    | **Группа ресурсов** | myResourceGroup | Используйте hello же группу ресурсов для всех служб в этом учебнике.|

4. Нажмите кнопку **создать** toocreate вашей учетной записи. После создания учетной записи hello щелкните новой панели мониторинга закрепленных toohello Когнитивных службы учетной записи. 

5. Hello учетную запись, нажмите кнопку **ключи**, а затем скопируйте значение hello **раздел 1** и сохраните его. Использовании этого ключа tooconnect hello логику приложения tooyour Когнитивных службы учетной записи. 
 
    ![ключей](media/functions-twitter-email/keys.png)

## <a name="create-hello-function"></a>Создание функции hello

Функции предоставляет toooffload хорошим способом обработки задач в рабочем процессе логику приложения. В этом учебнике используется HTTP при запуске функции tooprocess твит мнений показатели Когнитивных службы и возвращают значения категории.  

1. Функции приложения, щелкните hello  **+**  рядом слишком**функции**, нажмите кнопку hello **HTTPTrigger** шаблона. Тип `CategorizeSentiment` для функции hello **имя** и нажмите кнопку **создать**.

    ![Колонка приложения-функции, добавление функции](media/functions-twitter-email/add_fun.png)

2. Замените содержимое файла run.csx hello hello hello после кода, а затем нажмите кнопку **Сохранить**:

    ```c#
    using System.Net;
    
    public static async Task<HttpResponseMessage> Run(HttpRequestMessage req, TraceWriter log)
    {
        // hello sentiment category defaults too'GREEN'. 
        string category = "GREEN";
    
        // Get hello sentiment score from hello request body.
        double score = await req.Content.ReadAsAsync<double>();
        log.Info(string.Format("hello sentiment score received is '{0}'.",
                    score.ToString()));
    
        // Set hello category based on hello sentiment score.
        if (score < .3)
        {
            category = "RED";
        }
        else if (score < .6)
        {
            category = "YELLOW";
        }
        return req.CreateResponse(HttpStatusCode.OK, category);
    }
    ```
    Этот код функции возвращает цветовую категорию на основе показателя мнений hello, получено в запросе hello. 

3. функция tootest hello, нажмите кнопку **тест** hello правого tooexpand hello теста вкладку в. Введите значение `0.2` для hello **текст запроса**, а затем нажмите кнопку **запуска**. Значение **RED** возвращается в тексте hello hello ответа. 

    ![Проверка функции hello в hello портал Azure](./media/functions-twitter-email/test.png)

Теперь у вас есть функция, классифицирующая оценку мнений. Создайте приложение логики, интегрирующее функцию с учетными записями Twitter и Cognitive Services. 

## <a name="create-a-logic-app"></a>Создайте приложение логики   

1. В hello портал Azure, щелкнув hello **New** кнопка найдена в верхнем левом углу hello hello портал Azure.

2. Щелкните **Интеграция Enterprise** > **Приложение логики**. Затем проверьте параметры использования hello как, указанные в таблице hello **toodashboard ПИН-код**и нажмите кнопку **создать**.
 
4. Введите **имя** как `TweetSentiment`, использовать параметры hello, как указано в таблице hello, примите условия hello и проверьте **toodashboard ПИН-кода**.

    ![Создание приложения логики в hello портал Azure](./media/functions-twitter-email/new_logicApp.png)

    | Настройка      |  Рекомендуемое значение   | Описание                                        |
    | ----------------- | ------------ | ------------- |
    | **Имя** | TweetSentiment | Выберите соответствующее имя для своего приложения. |
    | **Группа ресурсов** | myResourceGroup | API используемого tooanalyze текста.  |
    | **Расположение** | Восток США | Выберите расположение закрыть tooyou. |
    | **Группа ресурсов** | myResourceGroup | Выберите hello же существующую группу ресурсов, как и раньше.|

4. Нажмите кнопку **создать** toocreate логику приложения. После создания приложения hello щелкните новой панели мониторинга закрепленных toohello логику приложения. Затем в hello конструктора логики приложения, прокрутите вниз и нажмите кнопку hello **пустое приложение логики** шаблона. 

    ![Шаблон "Пустое приложение логики" Logic Apps](media/functions-twitter-email/blank.png)

Теперь можно использовать конструктор приложений логики tooadd службы и триггеры tooyour приложение hello.

## <a name="connect-tootwitter"></a>Подключение tooTwitter

Сначала необходимо создаете соединение tooyour учетную запись Twitter. приложения логики Hello запрашивает твиты, которые триггер toorun приложения hello.

1. В конструкторе hello щелкните hello **Twitter** службы и нажмите кнопку hello **при учете новый твит** триггера. Войдите в учетную запись Twitter tooyour и авторизуйте toouse Logic Apps вашей учетной записи.

2. Используйте параметры триггера hello Twitter, как указано в таблице hello. 

    ![Параметры соединителя Twitter](media/functions-twitter-email/azure_tweet.png)

    | Настройка      |  Рекомендуемое значение   | Описание                                        |
    | ----------------- | ------------ | ------------- |
    | **Текст поискового запроса** | #Azure | Используйте хэштегом, который популярен достаточно для нового твиты toogenerate hello выбранного интервала. При использовании бесплатный уровень hello и вашей хэштегом слишком популярных, можно быстро использовать hello транзакций в вашей учетной записи службы Когнитивных. |
    | **Frequency** | Минута | Hello частоты единица, используемая для опроса Twitter.  |
    | **Интервал** | 15 | Hello время, прошедшее между единиц частоты запросов Twitter. |

3.  Нажмите кнопку **Сохранить** tooconnect tooyour учетную запись Twitter. 

Теперь приложение будет подключенных tooTwitter. Затем вы подключения tootext toodetect analytics hello идея собранных твиты.

## <a name="add-sentiment-detection"></a>Добавление определения мнений

1. Щелкните **New Step** (Создать шаг), а затем — **Добавить действие**.

    ![Выбор действий "Новый шаг" и "Добавить действие"](media/functions-twitter-email/new_step.png)

2. В **выбрать действия**, нажмите кнопку **анализа текста**и нажмите кнопку hello **обнаружить мнений** действие.

    ![Определение мнений](media/functions-twitter-email/detect_sent.png)

3. Введите имя подключения, например `MyCognitiveServicesConnection`, вставьте hello ключ для учетной записи Когнитивных служб, которые сохранены и нажмите кнопку **создать**.  

4. Нажмите кнопку **tooanalyze текст** > **твит текст**, а затем нажмите кнопку **Сохранить**.  

    ![Определение мнений](media/functions-twitter-email/ds_tta.png)

Теперь, когда настроено выявление мнений, можно добавить функции tooyour соединение, использующее вывода показатель мнений hello.

## <a name="connect-sentiment-output-tooyour-function"></a>Функции tooyour мнений выходные данные соединения

1. В hello конструктора логики приложения, щелкните **новый шаг** > **добавить действие**и нажмите кнопку **функции Azure**. 

2. Нажмите кнопку **выберите Azure функцию**выберите hello **CategorizeSentiment** функция, было создано ранее.  

    ![Окно с функцией Azure и параметром "Выберите функцию Azure"](media/functions-twitter-email/choose_fun.png)

3. В разделе **Текст запроса** щелкните кнопку **Score** (Оценка) и **Сохранить**.

    ![Оценка](media/functions-twitter-email/trigger_score.png)

Теперь ваша функция срабатывает, когда показатель мнений отправляется из логики приложения hello. Цветное категории возвращается приложения логики toohello функции hello. Затем добавьте уведомление по электронной почте, отправляемых, когда значение мнений **RED** возвращается из функции hello. 

## <a name="add-email-notifications"></a>Добавление уведомлений по почте

Последняя часть Hello hello рабочего процесса является tootrigger сообщение электронной почты при мнений hello, оценивается как _RED_. В этом разделе использует соединитель Outlook.com. Можно выполнить аналогичные шаги toouse соединитель Gmail или Office 365 Outlook.   

1. В hello конструктора логики приложения, щелкните **новый шаг** > **добавить условие**. 

2. Щелкните **Выберите значение**, а затем — **Текст**. Выберите **равняется**, щелкните **Выберите значение**, введите `RED` и нажмите кнопку **Сохранить**. 

    ![Добавьте условие toohello логику приложения.](media/functions-twitter-email/condition.png)

3. В **Если Да, НИЧЕГО не**, нажмите кнопку **добавить действие**, поиск `outlook.com`, нажмите кнопку **отправить сообщение электронной почты**и выполните вход tooyour Outlook.com учетной записи.
    
    ![Выберите действие для hello условия.](media/functions-twitter-email/outlook.png)

    > [!NOTE]
    > Если у вас нет учетной записи Outlook.com, можно выбрать другой соединитель, например Gmail или Office 365 Outlook

4. В hello **отправить сообщение электронной почты** действия, параметры электронной почты используйте hello как, указанные в таблице hello. 

    ![Настройте hello электронной почты для отправки hello действия электронной почты.](media/functions-twitter-email/sendemail.png)

    | Настройка      |  Рекомендуемое значение   | Описание  |
    | ----------------- | ------------ | ------------- |
    | **To** | Введите адрес электронной почты | Hello адрес электронной почты, который получает уведомление о hello. |
    | **Тема** | Negative tweet sentiment detected (Обнаружено отрицательное мнение, выраженное в твите)  | Строка темы Hello hello уведомления по электронной почте.  |
    | **Текст** | "Текст твита", "Расположение" | Нажмите кнопку hello **твит текст** и **расположение** параметров. |

5.  Щелкните **Сохранить**.

Теперь, когда hello рабочий процесс будет завершен, можно включить логику приложения hello и в описании функции hello на работе.

## <a name="test-hello-workflow"></a>Рабочий процесс теста hello

1. В hello конструктор логики приложения, щелкните **запуска** toostart приложение hello.

2. В левом столбце hello, щелкните **Обзор** toosee состояние hello hello логику приложения. 
 
    ![Состояние выполнения приложения логики](media/functions-twitter-email/over1.png)

3. (Необязательно) Выберите один из hello запусков toosee подробности выполнения hello.

4. Go tooyour функции, просмотрите журналы hello и убедитесь, что значения мнений были получены и обработаны.
 
    ![Просмотр журналов функции](media/functions-twitter-email/sent.png)

5. При обнаружении потенциально негативного мнения вы получите электронное сообщение. Если вы еще не получили сообщение электронной почты, можно изменить tooreturn кода функции hello красный каждый раз:

        return req.CreateResponse(HttpStatusCode.OK, "RED");

    После проверки уведомления по электронной почте, измените задней toohello исходный код:

        return req.CreateResponse(HttpStatusCode.OK, category);

    > [!IMPORTANT]
    > После завершения этого учебника, следует отключить приложение hello логику. Отключение приложение hello, можно избежать, сняты выполнений и по использованию транзакций hello в вашей учетной записи службы Когнитивных.

Теперь вы уже узнали, как просто можно toointegrate функции в рабочем процессе приложения логики.

## <a name="disable-hello-logic-app"></a>Отключить приложение логики hello

приложения логики toodisable hello, нажмите кнопку **Обзор** и нажмите кнопку **отключить** hello верхней части экрана приветствия. Это предотвратит hello логики приложения, запускать и взимается плата, не удаляя приложение hello. 

![Журналы функций](media/functions-twitter-email/disable-logic-app.png)

## <a name="next-steps"></a>Дальнейшие действия

Из этого руководства вы узнали, как выполнять такие задачи:

> [!div class="checklist"]
> * Создайте учетную запись Cognitive Services.
> * Создание функции, классифицирующей мнения, выраженные в твитах.
> * Создайте логику приложения, которое подключается tooTwitter.
> * Добавление мнений обнаружения toohello логику приложения. 
> * Hello логику приложения toohello функции соединения.
> * Отправьте сообщение электронной почты, на основании hello ответа от функции hello.

Как переместить следующий учебник toolearn toohello toocreate без сервера API для функции.

> [!div class="nextstepaction"] 
> [Создание бессерверного API с помощью Функций Azure](functions-create-serverless-api.md)

toolearn Дополнительные сведения о приложении логики в разделе [приложения логики Azure](../logic-apps/logic-apps-what-are-logic-apps.md).

