---
title: "Разработка Функций Azure с помощью Visual Studio | Документация Майкрософт"
description: "Сведения о разработке и тестировании Функций Azure с помощью инструментов Функций Azure для Visual Studio 2017."
services: functions
documentationcenter: .net
author: ggailey777
manager: cfowler
editor: 
ms.service: functions
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 09/06/2017
ms.author: glenga
ms.openlocfilehash: 5f0b346ec1c4a42d11ef74ab8ac8701dd45b00eb
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="azure-functions-tools-for-visual-studio"></a>Инструменты Функций Azure для Visual Studio  

Инструменты Функций Azure для Visual Studio 2017 — это расширение для Visual Studio, которое позволяет разрабатывать, тестировать и развертывать функции C# в Azure. Если вы впервые сталкиваетесь с Функциями Azure, то см. дополнительные сведения в статье [Общие сведения о Функциях Azure](functions-overview.md).

Инструменты Функций Azure предоставляют следующие преимущества: 

* Создание, редактирование и выполнение функций на локальном компьютере для разработки. 
* Публикация проектов Функций Azure непосредственно в Azure. 
* Возможность использовать атрибуты веб-заданий для объявления привязок функций непосредственно в коде C# без ведения отдельного файла function.json для определений привязки.
* Разработка и развертывание предварительно скомпилированных функций C#. Предварительно скомпилированные функции обеспечивают более высокую производительность при холодном запуске, чем функции C# на основе сценариев. 
* Программирование функций в C#, сохраняя при этом все преимущества разработки в Visual Studio. 

В этом разделе показано, как использовать инструменты Функций Azure для Visual Studio 2017 для разработки функций в C#. Вы также узнаете, как опубликовать проект в Azure в виде сборки .NET.

## <a name="prerequisites"></a>Предварительные требования

Инструменты Функций Azure включены в рабочую нагрузку "разработка Azure" в [Visual Studio 2017 версии 15.3](https://www.visualstudio.com/vs/) или более поздней. Не забудьте включить рабочую нагрузку **разработка Azure** в своем экземпляре Visual Studio 2017 версии 15.3:

![Установка Visual Studio 2017 с рабочей нагрузкой разработки в Azure](./media/functions-create-your-first-function-visual-studio/functions-vs-workloads.png)

>[!NOTE]  
>Установив Visual Studio 2017 версии 15.3 или обновившись до этой версии, вы должны вручную обновить инструменты Visual Studio 2017 для решения "Функции Azure". Для обновления инструментов можно воспользоваться меню **Инструменты** в разделе **Расширения и обновления...** > **Обновления** > **Visual Studio Marketplace** > **Azure Functions and Web Jobs Tools** (Инструменты для функций и веб-заданий Azure)  > **Обновление**. 

Для создания и развертывания функций необходимы также следующие компоненты:

* Активная подписка Azure. Если у вас нет подписки Azure, воспользуйтесь [бесплатными учетными записями](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).

* Учетная запись хранения Azure. Чтобы создать учетную запись хранения, см. раздел [Создайте учетную запись хранения](../storage/common/storage-create-storage-account.md#create-a-storage-account).  
## <a name="create-an-azure-functions-project"></a>Создание проекта Функций Azure 

[!INCLUDE [Create a project using the Azure Functions](../../includes/functions-vstools-create.md)]


## <a name="configure-the-project-for-local-development"></a>Настройка проекта для локальной разработки

При создании нового проекта с помощью шаблона Функции Azure получается пустой проект C#, содержащий следующие файлы:

* **host.json**: позволяет настроить узел Функций. Эти параметры применяются как в локальном режиме, так и в Azure. Дополнительные сведения см. в [справочной статье о host.json](functions-host-json.md).
    
* **local.settings.json**: содержит параметры, используемые при выполнении функций локально. Эти параметры не используются в Azure, они используются [основными инструментами Функций Azure](functions-run-local.md). Используйте этот файл для указания параметров, таких как строки подключения к другим службам Azure. Добавьте новый ключ в массив **Values** для каждого подключения, которое необходимо для функций в проекте. Дополнительные сведения см. в разделе [Local settings file](functions-run-local.md#local-settings-file) (Файл локальных параметров) статьи, посвященной основным инструментам Функций Azure.

Среде выполнения Функций Azure необходима учетная запись хранения Azure для внутреннего использования. Для всех типов триггеров, кроме HTTP и веб-перехватчиков, необходимо задать в качестве ключа **Values.AzureWebJobsStorage** допустимую строку подключения к учетной записи хранения Azure.

[!INCLUDE [Note to not use local storage](../../includes/functions-local-settings-note.md)]

 Чтобы задать строку подключения к учетной записи хранения, выполните следующие действия:

1. В Visual Studio откройте **Cloud Explorer**, разверните узел **Учетная запись хранения** > **Ваша учетная запись хранения**, а затем выберите **Свойства** и скопируйте значение параметра **Основная строка подключения**.   

2. В своем проекте откройте файл проекта local.settings.json и задайте в качестве значения ключа **AzureWebJobsStorage** скопированную вами строку подключения.

3. Повторите предыдущий шаг, чтобы добавить уникальные ключи в массив **Values** для всех других подключений, которые необходимы для функций.  

## <a name="create-a-function"></a>Создание функции

В предварительно скомпилированных функциях привязки, используемые функцией, определяются посредством применения атрибутов в коде. При использовании инструментов Функций Azure для создания функций на основе предоставленных шаблонов эти атрибуты применяются автоматически. 

1. Щелкните правой кнопкой мыши узел проекта в **обозревателе решений** и выберите **Добавить** > **Новый элемент**. Выберите **Функция Azure**, введите **Имя** класса и нажмите кнопку **Добавить**.

2. Выберите триггер, задайте свойства привязки и нажмите кнопку **Создать**. В следующем примере показаны параметры при создании функции, активируемой хранилищем очередей. 

    ![](./media/functions-develop-vs/functions-vstools-create-queuetrigger.png)
    
    Указан ключ строки подключения **QueueStorage**, который определен в файле local.settings.json. 
 
3. Проверьте добавленный класс. Вы видите статический метод **Run**, который имеет атрибут **FunctionName**. Этот атрибут указывает, что метод является точкой входа для функции. 

    Например, следующий класс C# представляет собой простую функцию, активируемую хранилищем очередей:

    ````csharp
    using System;
    using Microsoft.Azure.WebJobs;
    using Microsoft.Azure.WebJobs.Host;
    
    namespace FunctionApp1
    {
        public static class Function1
        {
            [FunctionName("QueueTriggerCSharp")]        
            public static void Run([QueueTrigger("myqueue-items", Connection = "QueueStorage")]string myQueueItem, TraceWriter log)
            {
                log.Info($"C# Queue trigger function processed: {myQueueItem}");
            }
        }
    } 
    ````
 
    Определяемый привязкой атрибут применяется к каждому параметру привязки, передаваемому в метод точки входа. Атрибут принимает сведения о привязке в качестве параметров. В предыдущем примере к первому параметру применен атрибут **QueueTrigger**, указывающий на то, что функция активируется очередью. Имя очереди и имя строки подключения передаются в качестве параметров.  

## <a name="testing-functions"></a>Функции тестирования

Основные инструменты службы Функции Azure позволяют запускать проекты функций Azure на локальном компьютере разработчика. Вам будет предложено установить эти инструменты при первом запуске функции из Visual Studio.  

Чтобы проверить работу функции, нажмите клавишу F5. Если будет предложено, примите запрос от Visual Studio на скачивание и установку основных инструментов службы Функции Azure (CLI).  Кроме того, вам может понадобиться включить исключение брандмауэра, чтобы инструменты могли обрабатывать HTTP-запросы.

Когда проект запущен, можно протестировать код, как тестируется развернутая функция. Дополнительные сведения см. в статье [Методика тестирования кода с помощью Функций Azure](functions-test-a-function.md). При работе в режиме отладки точки останова срабатывают в Visual Studio должным образом. 

Пример того, как протестировать функцию, активируемую очередью, см. в разделе "Проверка функции" статьи [Создание функции, активируемой хранилищем очередей Azure](functions-create-storage-queue-triggered-function.md#test-the-function).  

Дополнительные сведения об использовании основных инструментов Функций Azure см. в статье [Как программировать и тестировать функции Azure в локальной среде](functions-run-local.md).

## <a name="publish-to-azure"></a>Публикация в Azure

[!INCLUDE [Publish the project to Azure](../../includes/functions-vstools-publish.md)]

>[!NOTE]  
>Все параметры, которые вы добавили в файл local.settings.json, необходимо также добавить в приложение-функцию в Azure. Эти параметры не добавляются автоматически. Добавить необходимые параметры в приложение-функцию можно одним из следующих способов:
>
>* [С помощью портала Azure](functions-how-to-use-azure-function-app-settings.md#settings).
>* [С помощью параметра публикации `--publish-local-settings` в основных инструментах Функций Azure](functions-run-local.md#publish).
>* [С помощью Azure CLI](/cli/azure/functionapp/config/appsettings#set). 

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об инструментах Функций Azure см. в разделе часто задаваемых вопросов записи блога [Visual Studio 2017 Tools for Azure Functions](https://blogs.msdn.microsoft.com/webdev/2017/05/10/azure-function-tools-for-visual-studio-2017/) (Инструменты Visual Studio 2017 для Функций Azure).

Дополнительные сведения об основных инструментах Функций Azure см. в статье [Как программировать и тестировать функции Azure в локальной среде](functions-run-local.md).  
Дополнительные сведения о разработке функций, таких как библиотек классов .NET, см. в статье [Using .NET class libraries with Azure Functions](functions-dotnet-class-library.md) (Использование библиотек классов .NET с помощью Функций Azure). Здесь также приведены примеры того, как использовать атрибуты для объявления различных типов привязок, поддерживаемых Функциями Azure.    
