---
title: "Azure ExpressRoute для поставщиков облачных решений | Документация Майкрософт"
description: "Эта статья содержит сведения для поставщиков облачных служб, которым нужно внедрить службы Azure и ExpressRoute в свои предложения."
documentationcenter: na
services: expressroute
author: richcar
manager: carmonm
editor: 
ms.assetid: f6c5f8ee-40ba-41a1-ae31-67669ca419a6
ms.service: expressroute
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/10/2016
ms.author: richcar
ms.openlocfilehash: dfae23638e31242dc795922fd62d1abb02579480
ms.sourcegitcommit: a48e503fce6d51c7915dd23b4de14a91dd0337d8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2017
---
# <a name="expressroute-for-cloud-solution-providers-csp"></a>ExpressRoute для поставщиков облачных решений (CSP)
Корпорация Майкрософт предоставляет традиционным торговым посредникам и распространителям (CSP) гипермасштабируемые службы, с помощью которых вы сможете быстро подготавливать к работе новые службы и решения для своих клиентов, не вкладывая средства в их разработку. Чтобы разрешить CSP управлять новыми службами напрямую, корпорация Майкрософт предоставляет программы и API, позволяющие CSP управлять ресурсами Microsoft Azure от имени клиентов. Один из этих ресурсов — ExpressRoute. Благодаря ExpressRoute CSP может подключать существующие ресурсы клиента к службам Azure. ExpressRoute представляет собой высокоскоростной частный канал связи со службами в среде Azure. 

Он состоит из пары каналов для обеспечения высокой доступности, подключенных к одной из клиентских подписок. Такие каналы не могут совместно использоваться несколькими клиентами. Каждый канал должен закрываться на другом маршрутизаторе, чтобы обеспечить высокую доступность.

> [!NOTE]
> В ExpressRoute есть ограничения пропускной способности и подключения. Это значит, что для крупных и сложных реализаций одному клиенту потребуется несколько каналов ExpressRoute.
> 
> 

Microsoft Azure предоставляет все больше служб, которые можно предложить клиентам. ExpressRoute помогает вам и вашим клиентам использовать преимущества этих служб, предоставляя высокоскоростной доступ к среде Microsoft Azure.

## <a name="microsoft-azure-management"></a>Управление Microsoft Azure
Корпорация Майкрософт предоставляет CSP API для управления клиентскими подписками Azure. Эти API предусматривают программную интеграцию с системами управления службами. Сведения о поддерживаемых возможностях управления см. [здесь](https://msdn.microsoft.com/library/partnercenter/dn974944.aspx).

## <a name="microsoft-azure-resource-management"></a>Управление ресурсами Microsoft Azure
Управление подпиской зависит от условий контракта с клиентом. CSP может напрямую управлять созданием и обслуживанием ресурсов или клиент может контролировать подписки Microsoft Azure и при необходимости создавать ресурсы Azure. Если клиент управляет созданием ресурсов в подписке Microsoft Azure, он будет использовать одну из двух моделей: *подключение через посредника* или *прямое подключение*. Эти модели подробно описаны в следующих разделах.  

### <a name="connect-through-model"></a>Подключение через посредника
![замещающий текст](./media/expressroute-for-cloud-solution-providers/connect-through.png)  

При подключении через посредника CSP создает прямое подключение между центром обработки данных и подпиской Azure клиента. Прямое подключение устанавливается с помощью решения ExpressRoute, которое подключает среду Azure к сети. Затем клиент подключается к сети. В этом сценарии требуется, чтобы клиент проходил через сеть CSP для доступа к службам Azure. 

Если у клиента есть подписки Azure, которыми вы не управляете, он может использовать общедоступное интернет- или частное подключение, чтобы подключаться к службам, подготовленным к работе в подписке, не управляемой CSP. 

Предполагается, что у CSP, управляющего службами Azure, уже есть предварительно настроенное хранилище клиентских удостоверений, которое затем будет реплицировано в Azure Active Directory для управления подпиской CSP по принципу администрирования от имени кого-либо. Есть следующие основные факторы, влияющие на выбор этого сценария: если между партнером или поставщиком служб и клиентом установлены отношения, клиент пользуется службами поставщика в настоящее время или если партнер хочет предоставлять решения, размещенные в среде поставщика и в Azure, чтобы обеспечить гибкость и удовлетворить требованиям клиента, которым не может удовлетворить CSP. Эта модель показана на **рисунке**ниже.

![замещающий текст](./media/expressroute-for-cloud-solution-providers/connect-through-model.png)

### <a name="connect-to-model"></a>Прямое подключение
![замещающий текст](./media/expressroute-for-cloud-solution-providers/connect-to.png)

Модель прямого подключения предусматривает, что поставщик служб создает прямое подключение между центром обработки данных своего клиента и подпиской Azure, подготовленной к работе CSP, при этом используя ExpressRoute в сети клиента.

> [!NOTE]
> Для работы ExpressRoute клиенту понадобится создать и обслуживать канал ExpressRoute.  
> 
> 

В этом сценарии подключения необходимо, чтобы клиент подключался напрямую через свою сеть для доступа к управляемой CSP подписке Azure. Он должен использовать прямое сетевое подключение, которое он создал, которым он владеет и управляет полностью или частично. Кроме того, предполагается, что в данный момент у поставщика отсутствует хранилище клиентских удостоверений и он поможет клиенту реплицировать текущее хранилище удостоверений в Azure Active Directory для управления подпиской по принципу администрирования от имени кого-либо. Есть следующие основные факторы, влияющие на выбор этого сценария: если между партнером или поставщиком служб и клиентом установлены отношения, клиент пользуется службами поставщика в настоящее время или если партнер хочет предоставлять службы, разработанные полностью на базе решений, размещенных в среде Azure, без необходимости использовать существующий центр обработки данных или инфраструктуру поставщика.

![замещающий текст](./media/expressroute-for-cloud-solution-providers/connect-to-model.png)

Выбор варианта зависит от требований клиента и текущей необходимости в предоставлении служб Azure. Сведения об этих моделях и связанные с ними функции управления доступом на основе ролей, функции сети и шаблоны проектирования удостоверений подробно рассматриваются в статьях по следующим ссылкам.

* **Управление доступом на основе ролей (RBAC)** — управление доступом на основе ролей в Azure Active Directory.  Дополнительные сведения об управлении доступом на основе ролей в Azure см. [здесь](../active-directory/role-based-access-control-configure.md).
* **Сети** — здесь описаны различные аспекты работы сети в Microsoft Azure.
* **Azure Active Directory (Azure AD).** Azure AD обеспечивает управление удостоверениями в приложениях Microsoft Azure и сторонних приложениях SaaS. Дополнительные сведения об Azure AD см. [здесь](https://azure.microsoft.com/documentation/services/active-directory/).  

## <a name="network-speeds"></a>Скорость сети
ExpressRoute поддерживает скорость сети от 50 Мбит/с до 10 Гбит/с. Это позволяет клиентам приобрести объем пропускной способности сети, требуемый для их уникальной среды.

> [!NOTE]
> При необходимости пропускную способность сети можно увеличить без прерывания связи. Чтобы уменьшить скорость сети, нужно закрыть канал и создать его заново, задав более низкую скорость.  
> 
> 

ExpressRoute поддерживает подключение нескольких виртуальных сетей к одному каналу ExpressRoute для более эффективного использования высокоскоростных подключений. Один канал ExpressRoute могут совместно использовать несколько подписок Azure, принадлежащих одному клиенту.

## <a name="configuring-expressroute"></a>Настройка ExpressRoute
В ExpressRoute можно настроить поддержку трех типов трафика ([доменов маршрутизации](#ExpressRoute-routing-domains)) в одном канале. Этот трафик распределяется на пиринг Майкрософт, общедоступный пиринг Azure и частный пиринг. Вы можете выбрать один или все типы трафика и отправлять его по одному каналу или использовать несколько каналов ExpressRoute в зависимости от размера канала ExpressRoute и изоляции, требуемой клиенту. Система безопасности клиента может запрещать передачу общедоступного и частного трафика по одному каналу.

### <a name="connect-through-model"></a>Подключение через посредника
В конфигурации с подключением через посредника вы отвечаете за настройку сети для подключения ресурсов центра обработки данных клиента к подпискам, размещенным в среде Azure. Каждому клиенту, которому нужно использовать возможности Azure, требуется собственное подключение ExpressRoute, которым будете управлять вы. Для приобретения канала ExpressRoute нужно использовать те же методы, что и клиент. Выполните действия по подготовке канала к работе и настройке его состояний, представленные в статье [Процедуры ExpressRoute для подготовки каналов и состояний каналов](expressroute-workflows.md) . Затем настройте маршруты протокола пограничного шлюза (BGP) для управления трафиком, передающимся между локальной сетью и виртуальной сетью Azure.

### <a name="connect-to-model"></a>Прямое подключение
В конфигурации с прямым подключением предполагается, что клиент уже установил подключение к Azure или установит подключение к поставщику услуг Интернета. При этом ExpressRoute устанавливает связь из центра обработки данных клиента напрямую со средой Azure, а не с вашим центром обработки данных. Чтобы начать подготовку к работе, клиенту нужно выполнить действия, описанные в разделе "Подключение через посредника" выше. После открытия канала клиенту необходимо настроить локальные маршрутизаторы так, чтобы у них был доступ к вашей сети и виртуальным сетям Azure.

Вы можете помочь установить подключение и настроить маршруты, чтобы обеспечить взаимодействие ваших ресурсов с ресурсами клиента в вашем центре обработки данных или с ресурсами, размещенными в среде Azure.

## <a name="expressroute-routing-domains"></a>Домены маршрутизации ExpressRoute
В ExpressRoute доступно три домена маршрутизации: для общедоступного, частного пиринга и пиринга Майкрософт. Все домены маршрутизации настраиваются одинаково, с использованием маршрутизаторов с конфигурацией "активный-активный", чтобы обеспечить высокую доступность. Дополнительные сведения о доменах маршрутизации ExpressRoute см. [здесь](expressroute-circuit-peerings.md).

Вы можете определить фильтры пользовательских маршрутов и разрешить использовать только определенные или необходимые маршруты. Дополнительные сведения о фильтрах маршрутизации и о том, как внести эти изменения, см. в статье [Создание и изменение маршрутизации для канала ExpressRoute](expressroute-howto-routing-classic.md).

> [!NOTE]
> Для пиринга Майкрософт и общедоступного пиринга необходимо использовать общедоступный IP-адрес, который принадлежит клиенту или CSP, и обеспечить соответствие всем определенным правилам. Дополнительные сведения см. в статье [Предварительные требования и контрольный список для ExpressRoute](expressroute-prerequisites.md).  
> 
> 

## <a name="routing"></a>Маршрутизация
ExpressRoute подключается к сети Azure через шлюз виртуальной сети Azure. Сетевые шлюзы обеспечивают маршрутизацию для виртуальных сетей Azure.

При создании виртуальных сетей Azure также создается таблица маршрутизации по умолчанию для виртуальной сети, используемая для передачи трафика между подсетями виртуальной сети. Если таблицы маршрутизации по умолчанию недостаточно для решения, можно создать пользовательские маршруты для маршрутизации исходящего трафика для пользовательских устройств или блокирования маршрутов к конкретным подсетям или внешним сетям.

### <a name="default-routing"></a>Маршрутизация по умолчанию
Таблица маршрутов по умолчанию включает в себя следующие маршруты:

* в одной подсети;
* между подсетями в виртуальной сети;
* в Интернет;
* между виртуальными сетями с использованием VPN-шлюза;
* между виртуальной и локальной сетью с использованием VPN-шлюза или шлюза ExpressRoute.

![замещающий текст](./media/expressroute-for-cloud-solution-providers/default-routing.png)  

### <a name="user-defined-routing-udr"></a>Определяемые пользователем маршруты
Определяемые пользователем маршруты позволяют управлять передачей исходящего трафика из одной подсети в другие подсети в виртуальной сети или по одному из других предустановленных шлюзов (ExpressRoute, Интернета или VPN). Системную таблицу маршрутизации по умолчанию можно заменить определяемой пользователем таблицей. При этом маршруты в таблице маршрутизации по умолчанию заменяются пользовательскими маршрутами. При определяемой пользователем маршрутизации клиенты могут создавать отдельные маршруты для устройств, например брандмауэров или устройств обнаружения атак, а также блокировать доступ к определенным подсетям из подсети, в которой размещен определенный пользователем маршрут. Общие сведения об определяемых пользователем маршрутов см. [здесь](../virtual-network/virtual-networks-udr-overview.md). 

## <a name="security"></a>Безопасность
В зависимости от используемой модели подключения (прямого подключения или подключения через посредника) клиент определяет политики безопасности в виртуальной сети или предъявляет CSP требования к политике безопасности для виртуальных сетей. Можно определить следующие критерии безопасности:

1. **Изоляция клиента.** Платформа Azure обеспечивает изоляцию клиента, сохраняя сведения об идентификаторе и виртуальной сети клиента в защищенной базе данных, что используется для инкапсуляции трафика клиента в туннеле GRE.
2. Правила **группы безопасности сети (NSG)** позволяют определить, какой трафик можно передавать в подсетях виртуальных сетей в Azure. По умолчанию NSG содержит правила блокировки, позволяющие блокировать трафик, передающийся из Интернета в виртуальную сеть, и правила разрешения для передачи трафика в виртуальной сети. Дополнительные сведения о группах безопасности сети см. [здесь](https://azure.microsoft.com/blog/network-security-groups/).
3. **Принудительное туннелирование.** При принудительном туннелировании интернет-трафик из среды Azure перенаправляется через подключение ExpressRoute в локальный центр обработки данных. Дополнительные сведения о принудительном туннелировании см. [здесь](expressroute-routing.md#advertising-default-routes).  
4. **Шифрование.** Несмотря на то что каналы ExpressRoute предназначены для конкретного клиента, существует вероятность атаки поставщика сети, в ходе которой злоумышленник может изучить трафик пакетов. Чтобы устранить возможную проблему, клиент или CSP может шифровать трафик, передаваемый через подключение, определив политики режима туннелирования IPSec для всего трафика между локальными ресурсами и ресурсами Azure (см. дополнительный режим туннелирования IPSec для клиента 1 на рис. 5 "Безопасность ExpressRoute" выше). Кроме того, можно установить брандмауэр на каждой конечной точке канала ExpressRoute. Для этого между конечными точками нужно установить дополнительные сторонние виртуальные машины или устройства, выполняющие роль брандмауэра, чтобы шифровать трафик, проходящий через канал ExpressRoute.

![замещающий текст](./media/expressroute-for-cloud-solution-providers/expressroute-security.png)  

## <a name="next-steps"></a>Дальнейшие действия
Служба Cloud Solution Provider позволяет вам повысить эффективность взаимодействия с клиентом без необходимости приобретать дорогостоящие инфраструктуру и возможности. При этом вы продолжаете выполнять функции основного поставщика услуг аутсорсинга. API CSP обеспечивает простую интеграцию со средой Microsoft Azure, позволяя интегрировать управление Microsoft Azure в существующую платформу управления.  

Дополнительные сведения см. по ссылкам ниже:

[Azure в программе поставщиков облачных решений](https://docs.microsoft.com/azure/cloud-solution-provider)  
[Готовность к модели Cloud Solution Provider](https://partner.microsoft.com/en-us/solutions/cloud-reseller-pre-launch)  
[Ресурсы по программе Microsoft Cloud Solution Provider](https://partner.microsoft.com/en-us/solutions/cloud-reseller-resources)
