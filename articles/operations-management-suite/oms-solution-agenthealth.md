---
title: "Решение для мониторинга работоспособности агентов в OMS | Документация Майкрософт"
description: "Эта статья поможет вам понять, как использовать это решение для отслеживания работоспособности агентов, которые отправляют отчеты непосредственно в OMS или System Center Operations Manager."
services: operations-management-suite
documentationcenter: 
author: MGoedtel
manager: carmonm
editor: 
ms.assetid: 
ms.service: operations-management-suite
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 07/17/2017
ms.author: magoedte
ms.openlocfilehash: b810e37e393ddab55500f636b72450789285a4f0
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
#  <a name="agent-health-solution-in-oms"></a><span data-ttu-id="277b5-103">Решение для мониторинга работоспособности агентов в OMS</span><span class="sxs-lookup"><span data-stu-id="277b5-103">Agent Health solution in OMS</span></span>
<span data-ttu-id="277b5-104">Решение для мониторинга работоспособности агентов в OMS помогает выявлять среди всех агентов, отправляющих отчеты непосредственно в OMS или подключенную к OMS группу управления System Center Operations Manager, агенты, которые не отвечают на запросы и которые отправляют оперативные данные.</span><span class="sxs-lookup"><span data-stu-id="277b5-104">The Agent Health solution in OMS helps you understand, for all of the agents reporting directly to the OMS workspace or a System Center Operations Manager management group  connected to OMS, which are unresponsive and submitting operational data.</span></span>  <span data-ttu-id="277b5-105">Вы также можете отслеживать число развернутых агентов и их географическое распределение, а также выполнять другие запросы, чтобы знать о распределении агентов, развернутых в Azure, других облачных средах или в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="277b5-105">You can also keep track of how many agents are deployed, where they are distributed geographically, and perform other queries to maintain awareness of the distribution of agents deployed in Azure, other cloud environments, or on-premises.</span></span>    

## <a name="prerequisites"></a><span data-ttu-id="277b5-106">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="277b5-106">Prerequisites</span></span>
<span data-ttu-id="277b5-107">Перед развертыванием этого решения убедитесь, что у вас есть поддерживаемые [агенты Windows](../log-analytics/log-analytics-windows-agents.md), которые отправляют отчеты в рабочую область OMS или [группу управления Operations Manager](../log-analytics/log-analytics-om-agents.md), интегрированную с вашей рабочей областью OMS.</span><span class="sxs-lookup"><span data-stu-id="277b5-107">Before you deploy this solution, confirm you have currently supported [Windows agents](../log-analytics/log-analytics-windows-agents.md) reporting to the OMS workspace or reporting to an [Operations Manager management group](../log-analytics/log-analytics-om-agents.md) integrated with your OMS workspace.</span></span>    

## <a name="solution-components"></a><span data-ttu-id="277b5-108">Компоненты решения</span><span class="sxs-lookup"><span data-stu-id="277b5-108">Solution components</span></span>
<span data-ttu-id="277b5-109">Это решение состоит из следующих ресурсов, добавленных в вашу рабочую область, и подключенных напрямую агентов или подключенной группы управления Operations Manager.</span><span class="sxs-lookup"><span data-stu-id="277b5-109">This solution consists of the following resources that are added to your workspace and directly connected agents or Operations Manager connected management group.</span></span>

### <a name="management-packs"></a><span data-ttu-id="277b5-110">Пакеты управления</span><span class="sxs-lookup"><span data-stu-id="277b5-110">Management packs</span></span>
<span data-ttu-id="277b5-111">Если группа управления System Center Operations Manager подключена к рабочей области OMS, в Operations Manager будут установлены следующие пакеты.</span><span class="sxs-lookup"><span data-stu-id="277b5-111">If your System Center Operations Manager management group is connected to an OMS workspace,  the following management packs are installed in Operations Manager.</span></span>  <span data-ttu-id="277b5-112">После добавления этого решения пакеты управления также будут установлены на компьютерах с Windows, подключенных напрямую.</span><span class="sxs-lookup"><span data-stu-id="277b5-112">These management packs are also installed on directly connected Windows computers after adding this solution.</span></span> <span data-ttu-id="277b5-113">Управление и настройка здесь не требуются.</span><span class="sxs-lookup"><span data-stu-id="277b5-113">There is nothing to configure or manage with these management packs.</span></span>

* <span data-ttu-id="277b5-114">Пакет аналитики канала Direct оценки работоспособности помощника Microsoft System Center (Microsoft.IntelligencePacks.HealthAssessmentDirect)</span><span class="sxs-lookup"><span data-stu-id="277b5-114">Microsoft System Center Advisor HealthAssessment Direct Channel Intelligence Pack  (Microsoft.IntelligencePacks.HealthAssessmentDirect)</span></span>
* <span data-ttu-id="277b5-115">Пакет аналитики канала сервера оценки работоспособности помощника Microsoft System Center (Microsoft.IntelligencePacks.HealthAssessmentViaServer).</span><span class="sxs-lookup"><span data-stu-id="277b5-115">Microsoft System Center Advisor HealthAssessment Server Channel Intelligence Pack (Microsoft.IntelligencePacks.HealthAssessmentViaServer).</span></span>  

<span data-ttu-id="277b5-116">Дополнительные сведения об обновлении пакетов управления для решений см. в статье [Подключение Operations Manager к Log Analytics](../log-analytics/log-analytics-om-agents.md).</span><span class="sxs-lookup"><span data-stu-id="277b5-116">For more information on how solution management packs are updated, see [Connect Operations Manager to Log Analytics](../log-analytics/log-analytics-om-agents.md).</span></span>

## <a name="configuration"></a><span data-ttu-id="277b5-117">Конфигурация</span><span class="sxs-lookup"><span data-stu-id="277b5-117">Configuration</span></span>
<span data-ttu-id="277b5-118">Добавьте решение для мониторинга работоспособности агентов в рабочую область OMS, как описано в статье [Добавление решений для управления Azure Log Analytics в рабочую область](../log-analytics/log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="277b5-118">Add the Agent Health solution to your OMS workspace using the process described in [Add solutions](../log-analytics/log-analytics-add-solutions.md).</span></span> <span data-ttu-id="277b5-119">Дополнительная настройка не требуется.</span><span class="sxs-lookup"><span data-stu-id="277b5-119">There is no further configuration required.</span></span>


## <a name="data-collection"></a><span data-ttu-id="277b5-120">Сбор данных</span><span class="sxs-lookup"><span data-stu-id="277b5-120">Data collection</span></span>
### <a name="supported-agents"></a><span data-ttu-id="277b5-121">Поддерживаемые агенты</span><span class="sxs-lookup"><span data-stu-id="277b5-121">Supported agents</span></span>
<span data-ttu-id="277b5-122">В следующей таблице описаны подключенные источники, которые поддерживаются этим решением.</span><span class="sxs-lookup"><span data-stu-id="277b5-122">The following table describes the connected sources that are supported by this solution.</span></span>

| <span data-ttu-id="277b5-123">Подключенный источник</span><span class="sxs-lookup"><span data-stu-id="277b5-123">Connected Source</span></span> | <span data-ttu-id="277b5-124">Поддерживаются</span><span class="sxs-lookup"><span data-stu-id="277b5-124">Supported</span></span> | <span data-ttu-id="277b5-125">Описание</span><span class="sxs-lookup"><span data-stu-id="277b5-125">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="277b5-126">Агенты Windows</span><span class="sxs-lookup"><span data-stu-id="277b5-126">Windows agents</span></span> | <span data-ttu-id="277b5-127">Да</span><span class="sxs-lookup"><span data-stu-id="277b5-127">Yes</span></span> | <span data-ttu-id="277b5-128">События пульса собираются от прямых агентов Windows.</span><span class="sxs-lookup"><span data-stu-id="277b5-128">Heartbeat events are collected from direct Windows agents.</span></span>|
| <span data-ttu-id="277b5-129">Группа управления System Center Operations Manager</span><span class="sxs-lookup"><span data-stu-id="277b5-129">System Center Operations Manager management group</span></span> | <span data-ttu-id="277b5-130">Да</span><span class="sxs-lookup"><span data-stu-id="277b5-130">Yes</span></span> | <span data-ttu-id="277b5-131">События пульса собираются с агентов, предоставляющих отчеты группам управления, каждые 60 секунд, а затем перенаправляются в Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="277b5-131">Heartbeat events are collected from  agents reporting to the management group every 60 seconds and then forwarded to Log Analytics.</span></span> <span data-ttu-id="277b5-132">Прямое подключение агентов Operations Manager к Log Analytics не требуется.</span><span class="sxs-lookup"><span data-stu-id="277b5-132">A direct connection from Operations Manager agents to Log Analytics is not required.</span></span> <span data-ttu-id="277b5-133">Данные событий пульса перенаправляются из группы управления в репозиторий Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="277b5-133">Heartbeat event data is forwarded from the management group to the Log Analytics repository.</span></span>|

## <a name="using-the-solution"></a><span data-ttu-id="277b5-134">Использование решения</span><span class="sxs-lookup"><span data-stu-id="277b5-134">Using the solution</span></span>
<span data-ttu-id="277b5-135">При добавлении решения в рабочую область OMS на панель мониторинга OMS добавляется плитка **Работоспособность агентов**.</span><span class="sxs-lookup"><span data-stu-id="277b5-135">When you add the solution to your OMS workspace, the **Agent Health** tile will be added to your OMS dashboard.</span></span> <span data-ttu-id="277b5-136">На ней отображается общее число агентов и число агентов, не отвечающих на запросы за последние 24 часа.</span><span class="sxs-lookup"><span data-stu-id="277b5-136">This tile shows the total number of agents and the number of unresponsive agents in the last 24 hours.</span></span><br><br> <span data-ttu-id="277b5-137">![Плитка решения "Работоспособность агентов" на панели мониторинга](./media/oms-solution-agenthealth/agenthealth-solution-tile-homepage.png)</span><span class="sxs-lookup"><span data-stu-id="277b5-137">![Agent Health Solution tile on dashboard](./media/oms-solution-agenthealth/agenthealth-solution-tile-homepage.png)</span></span>

<span data-ttu-id="277b5-138">Щелкните плитку **Работоспособность агентов**, чтобы открыть панель мониторинга **Работоспособность агентов**.</span><span class="sxs-lookup"><span data-stu-id="277b5-138">Click on the **Agent Health** tile to open the **Agent Health** dashboard.</span></span>  <span data-ttu-id="277b5-139">Панель мониторинга содержит столбцы, перечисленные в приведенной ниже таблице.</span><span class="sxs-lookup"><span data-stu-id="277b5-139">The dashboard includes the columns in the following table.</span></span> <span data-ttu-id="277b5-140">Каждый столбец содержит по десять основных событий, соответствующих таким указанным критериям, как диапазон времени.</span><span class="sxs-lookup"><span data-stu-id="277b5-140">Each column lists the top ten events by count that match that column’s criteria for the specified time range.</span></span> <span data-ttu-id="277b5-141">Можно выполнить поиск по журналам, чтобы отобразить весь список. Для этого щелкните элемент **Показать все** в правой нижней части каждого столбца или заголовок этого столбца.</span><span class="sxs-lookup"><span data-stu-id="277b5-141">You can run a log search that provides the entire list by selecting **See all** at the right bottom of each column, or by clicking the column header.</span></span>

| <span data-ttu-id="277b5-142">столбец</span><span class="sxs-lookup"><span data-stu-id="277b5-142">Column</span></span> | <span data-ttu-id="277b5-143">Описание</span><span class="sxs-lookup"><span data-stu-id="277b5-143">Description</span></span> |
|--------|-------------|
| <span data-ttu-id="277b5-144">Число агентов по времени</span><span class="sxs-lookup"><span data-stu-id="277b5-144">Agent count over time</span></span> | <span data-ttu-id="277b5-145">Тенденция изменения числа агентов в течение семи дней для агентов Linux и Windows.</span><span class="sxs-lookup"><span data-stu-id="277b5-145">A trend of your agent count over a period of seven days for both Linux and Windows agents.</span></span>|
| <span data-ttu-id="277b5-146">Число агентов, не отвечающих на запросы</span><span class="sxs-lookup"><span data-stu-id="277b5-146">Count of unresponsive agents</span></span> | <span data-ttu-id="277b5-147">Список агентов, которые не отправили пакеты пульса за последние 24 часа.</span><span class="sxs-lookup"><span data-stu-id="277b5-147">A list of agents that haven’t sent a heartbeat in the past 24 hours.</span></span>|
| <span data-ttu-id="277b5-148">Распределение по типам ОС</span><span class="sxs-lookup"><span data-stu-id="277b5-148">Distribution by OS Type</span></span> | <span data-ttu-id="277b5-149">Число агентов Windows и Linux в вашей среде.</span><span class="sxs-lookup"><span data-stu-id="277b5-149">A partition of how many Windows and Linux agents you have in your environment.</span></span>|
| <span data-ttu-id="277b5-150">Распределение по версиям агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-150">Distribution by Agent Version</span></span> | <span data-ttu-id="277b5-151">Другие версии агентов, установленные в вашей среде, и их число.</span><span class="sxs-lookup"><span data-stu-id="277b5-151">A partition of the different agent versions installed in your environment and a count of each one.</span></span>|
| <span data-ttu-id="277b5-152">Распределение по категориям агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-152">Distribution by Agent Category</span></span> | <span data-ttu-id="277b5-153">Различные категории агентов, отправляющих события пульса: прямые агенты, агенты OpsMgr и сервер управления OpsMgr.</span><span class="sxs-lookup"><span data-stu-id="277b5-153">A partition of the different categories of agents that are sending up heartbeat events: direct agents, OpsMgr agents, or the OpsMgr Management Server.</span></span>|
| <span data-ttu-id="277b5-154">Распределение по группам управления</span><span class="sxs-lookup"><span data-stu-id="277b5-154">Distribution by Management Group</span></span> | <span data-ttu-id="277b5-155">Разные группы управления SCOM в вашей среде.</span><span class="sxs-lookup"><span data-stu-id="277b5-155">A partition of the different SCOM Management groups in your environment.</span></span>|
| <span data-ttu-id="277b5-156">Географическое расположение агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-156">Geo-location of Agents</span></span> | <span data-ttu-id="277b5-157">Разные страны, в которых находятся ваши агенты, и общее число агентов, установленных в каждой стране.</span><span class="sxs-lookup"><span data-stu-id="277b5-157">A partition of the different countries where you have agents and a total count of the number of agents that have been installed in each country.</span></span>|
| <span data-ttu-id="277b5-158">Число установленных шлюзов</span><span class="sxs-lookup"><span data-stu-id="277b5-158">Count of Gateways Installed</span></span> | <span data-ttu-id="277b5-159">Число серверов, на которых установлен шлюз OMS, и список этих серверов.</span><span class="sxs-lookup"><span data-stu-id="277b5-159">The number of servers that have the OMS Gateway installed, and a list of these servers.</span></span>|

![Пример панели мониторинга "Работоспособность агентов"](./media/oms-solution-agenthealth/agenthealth-solution-dashboard.png)  

## <a name="log-analytics-records"></a><span data-ttu-id="277b5-161">Записи Log Analytics</span><span class="sxs-lookup"><span data-stu-id="277b5-161">Log Analytics records</span></span>
<span data-ttu-id="277b5-162">Решение создает один тип записи в репозитории OMS.</span><span class="sxs-lookup"><span data-stu-id="277b5-162">The solution creates one type of record in the OMS repository.</span></span>  

### <a name="heartbeat-records"></a><span data-ttu-id="277b5-163">Записи пульсов</span><span class="sxs-lookup"><span data-stu-id="277b5-163">Heartbeat records</span></span>
<span data-ttu-id="277b5-164">Создается запись с типом **Пульс**.</span><span class="sxs-lookup"><span data-stu-id="277b5-164">A record with a type of **Heartbeat** is created.</span></span>  <span data-ttu-id="277b5-165">У этих записей есть свойства, приведенные в таблице ниже.</span><span class="sxs-lookup"><span data-stu-id="277b5-165">These records have the properties in the following table.</span></span>  

| <span data-ttu-id="277b5-166">Свойство</span><span class="sxs-lookup"><span data-stu-id="277b5-166">Property</span></span> | <span data-ttu-id="277b5-167">Описание</span><span class="sxs-lookup"><span data-stu-id="277b5-167">Description</span></span> |
| --- | --- |
| <span data-ttu-id="277b5-168">Тип</span><span class="sxs-lookup"><span data-stu-id="277b5-168">Type</span></span> | <span data-ttu-id="277b5-169">*Пульс*</span><span class="sxs-lookup"><span data-stu-id="277b5-169">*Heartbeat*</span></span>|
| <span data-ttu-id="277b5-170">Категория</span><span class="sxs-lookup"><span data-stu-id="277b5-170">Category</span></span> | <span data-ttu-id="277b5-171">Значение — *Прямой агент*, *Агент SCOM*, или *Сервер управления SCOM*.</span><span class="sxs-lookup"><span data-stu-id="277b5-171">Value is *Direct Agent*, *SCOM Agent*, or *SCOM Management Server*.</span></span>|
| <span data-ttu-id="277b5-172">Компьютер</span><span class="sxs-lookup"><span data-stu-id="277b5-172">Computer</span></span> | <span data-ttu-id="277b5-173">Имя компьютера.</span><span class="sxs-lookup"><span data-stu-id="277b5-173">Computer name.</span></span>|
| <span data-ttu-id="277b5-174">OSType</span><span class="sxs-lookup"><span data-stu-id="277b5-174">OSType</span></span> | <span data-ttu-id="277b5-175">Операционная система Windows или Linux.</span><span class="sxs-lookup"><span data-stu-id="277b5-175">Windows or Linux operating system.</span></span>|
| <span data-ttu-id="277b5-176">OSMajorVersion</span><span class="sxs-lookup"><span data-stu-id="277b5-176">OSMajorVersion</span></span> | <span data-ttu-id="277b5-177">Основная версия операционной системы.</span><span class="sxs-lookup"><span data-stu-id="277b5-177">Operating system major version.</span></span>|
| <span data-ttu-id="277b5-178">OSMinorVersion</span><span class="sxs-lookup"><span data-stu-id="277b5-178">OSMinorVersion</span></span> | <span data-ttu-id="277b5-179">Второстепенная версия операционной системы.</span><span class="sxs-lookup"><span data-stu-id="277b5-179">Operating system minor version.</span></span>|
| <span data-ttu-id="277b5-180">Версия</span><span class="sxs-lookup"><span data-stu-id="277b5-180">Version</span></span> | <span data-ttu-id="277b5-181">Версия агента OMS или агента Operations Manager.</span><span class="sxs-lookup"><span data-stu-id="277b5-181">OMS Agent or Operations Manager Agent version.</span></span>|
| <span data-ttu-id="277b5-182">SCAgentChannel</span><span class="sxs-lookup"><span data-stu-id="277b5-182">SCAgentChannel</span></span> | <span data-ttu-id="277b5-183">Значение — *Прямой* и (или) *SCManagementServer*.</span><span class="sxs-lookup"><span data-stu-id="277b5-183">Value is *Direct* and/or *SCManagementServer*.</span></span>|
| <span data-ttu-id="277b5-184">IsGatewayInstalled</span><span class="sxs-lookup"><span data-stu-id="277b5-184">IsGatewayInstalled</span></span> | <span data-ttu-id="277b5-185">Если шлюз OMS установлен, этот параметр имеет значение *true*, в противном случае — значение *false*.</span><span class="sxs-lookup"><span data-stu-id="277b5-185">If OMS Gateway is installed, value is *true*, otherwise value is *false*.</span></span>|
| <span data-ttu-id="277b5-186">ComputerIP</span><span class="sxs-lookup"><span data-stu-id="277b5-186">ComputerIP</span></span> | <span data-ttu-id="277b5-187">IP-адрес компьютера.</span><span class="sxs-lookup"><span data-stu-id="277b5-187">IP address of the computer.</span></span>|
| <span data-ttu-id="277b5-188">RemoteIPCountry</span><span class="sxs-lookup"><span data-stu-id="277b5-188">RemoteIPCountry</span></span> | <span data-ttu-id="277b5-189">Географическое расположение, в котором развернут компьютер.</span><span class="sxs-lookup"><span data-stu-id="277b5-189">Geographic location where computer is deployed.</span></span>|
| <span data-ttu-id="277b5-190">ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="277b5-190">ManagementGroupName</span></span> | <span data-ttu-id="277b5-191">Имя группы управления Operations Manager.</span><span class="sxs-lookup"><span data-stu-id="277b5-191">Name of Operations Manager management group.</span></span>|
| <span data-ttu-id="277b5-192">SourceComputerId</span><span class="sxs-lookup"><span data-stu-id="277b5-192">SourceComputerId</span></span> | <span data-ttu-id="277b5-193">Уникальный идентификатор компьютера.</span><span class="sxs-lookup"><span data-stu-id="277b5-193">Unique ID of computer.</span></span>|
| <span data-ttu-id="277b5-194">RemoteIPLongitude</span><span class="sxs-lookup"><span data-stu-id="277b5-194">RemoteIPLongitude</span></span> | <span data-ttu-id="277b5-195">Долгота географического расположения компьютера.</span><span class="sxs-lookup"><span data-stu-id="277b5-195">Longitude of computer's geographic location.</span></span>|
| <span data-ttu-id="277b5-196">RemoteIPLatitude</span><span class="sxs-lookup"><span data-stu-id="277b5-196">RemoteIPLatitude</span></span> | <span data-ttu-id="277b5-197">Широта географического расположения компьютера.</span><span class="sxs-lookup"><span data-stu-id="277b5-197">Latitude of computer's geographic location.</span></span>|

<span data-ttu-id="277b5-198">Каждый агент, отправляющий отчеты на сервер управления Operations Manager, будет отправлять два пакета пульса, а значение свойства SCAgentChannel будет включать оба (**Прямой** и **SCManagementServer**) в зависимости от того, какие источники данных и решения Log Analytics включены в вашей подписке OMS.</span><span class="sxs-lookup"><span data-stu-id="277b5-198">Each agent reporting to an Operations Manager management server will send two heartbeats, and SCAgentChannel property's value will include both **Direct** and **SCManagementServer** depending on what Log Analytics data sources and solutions you have enabled in your OMS subscription.</span></span> <span data-ttu-id="277b5-199">Если вы помните, данные из этих решений отправляются непосредственно с сервера управления Operations Manager в веб-службу OMS или непосредственно с агента в веб-службу OMS, что зависит от объема данных, собранных с агента.</span><span class="sxs-lookup"><span data-stu-id="277b5-199">If you recall, data from solutions are either sent directly from an Operations Manager management server to the OMS web service, or because of the volume of data collected on the agent, are sent directly from the agent to OMS web service.</span></span> <span data-ttu-id="277b5-200">Для событий пульса со значением **SCManagementServer** значением ComputerIP является IP-адрес сервера управления, так как он фактически передает данные.</span><span class="sxs-lookup"><span data-stu-id="277b5-200">For heartbeat events which have the value **SCManagementServer**, the ComputerIP value is the IP address of the management server since the data is actually uploaded by it.</span></span>  <span data-ttu-id="277b5-201">Для пульсов со значением **Прямой** для параметра SCAgentChannel ComputerIP — это общедоступный IP-адрес агента.</span><span class="sxs-lookup"><span data-stu-id="277b5-201">For heartbeats where SCAgentChannel is set to **Direct**, it is the public IP address of the agent.</span></span>  

## <a name="sample-log-searches"></a><span data-ttu-id="277b5-202">Пример поисков журналов</span><span class="sxs-lookup"><span data-stu-id="277b5-202">Sample log searches</span></span>
<span data-ttu-id="277b5-203">Следующая таблица содержит примеры поисков по журналу для получения записей, собранных этим решением.</span><span class="sxs-lookup"><span data-stu-id="277b5-203">The following table provides sample log searches for records collected by this solution.</span></span>

| <span data-ttu-id="277b5-204">Запрос</span><span class="sxs-lookup"><span data-stu-id="277b5-204">Query</span></span> | <span data-ttu-id="277b5-205">Описание</span><span class="sxs-lookup"><span data-stu-id="277b5-205">Description</span></span> |
| --- | --- |
| <span data-ttu-id="277b5-206">Type=Heartbeat &#124; distinct Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-206">Type=Heartbeat &#124; distinct Computer</span></span> |<span data-ttu-id="277b5-207">Общее число агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-207">Total number of agents</span></span> |
| <span data-ttu-id="277b5-208">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-24HOURS</span><span class="sxs-lookup"><span data-stu-id="277b5-208">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-24HOURS</span></span> |<span data-ttu-id="277b5-209">Число агентов, не отвечающих на запросы за последние 24 часа</span><span class="sxs-lookup"><span data-stu-id="277b5-209">Count of unresponsive agents in the last 24 hours</span></span> |
| <span data-ttu-id="277b5-210">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-15MINUTES</span><span class="sxs-lookup"><span data-stu-id="277b5-210">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-15MINUTES</span></span> |<span data-ttu-id="277b5-211">Число агентов, не отвечающих на запросы за последние 15 минут</span><span class="sxs-lookup"><span data-stu-id="277b5-211">Count of unresponsive agents in the last 15 minutes</span></span> |
| <span data-ttu-id="277b5-212">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer IN {Type=Heartbeat TimeGenerated>NOW-24HOURS &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-212">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer IN {Type=Heartbeat TimeGenerated>NOW-24HOURS &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span></span> |<span data-ttu-id="277b5-213">Подключенные компьютеры (за последние 24 часа)</span><span class="sxs-lookup"><span data-stu-id="277b5-213">Computers online (in the last 24 hours)</span></span> |
| <span data-ttu-id="277b5-214">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer NOT IN {Type=Heartbeat TimeGenerated>NOW-30MINUTES &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-214">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer NOT IN {Type=Heartbeat TimeGenerated>NOW-30MINUTES &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span></span> |<span data-ttu-id="277b5-215">Общее число автономных агентов за последние 30 минут (за последние 24 часа)</span><span class="sxs-lookup"><span data-stu-id="277b5-215">Total Agents Offline in Last 30 minutes (for the last 24 hours)</span></span> |
| <span data-ttu-id="277b5-216">Type=Heartbeat &#124; measure countdistinct(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="277b5-216">Type=Heartbeat &#124; measure countdistinct(Computer) by OSType</span></span> |<span data-ttu-id="277b5-217">Получение тенденции изменения числа агентов за промежуток времени по типу ОС</span><span class="sxs-lookup"><span data-stu-id="277b5-217">Get a trend of number of agents over time by OSType</span></span>|
| <span data-ttu-id="277b5-218">Type=Heartbeat&#124;measure countdistinct(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="277b5-218">Type=Heartbeat&#124;measure countdistinct(Computer) by OSType</span></span> |<span data-ttu-id="277b5-219">Распределение по типам ОС</span><span class="sxs-lookup"><span data-stu-id="277b5-219">Distribution by OS Type</span></span> |
| <span data-ttu-id="277b5-220">Type=Heartbeat&#124;measure countdistinct(Computer) by Version</span><span class="sxs-lookup"><span data-stu-id="277b5-220">Type=Heartbeat&#124;measure countdistinct(Computer) by Version</span></span> |<span data-ttu-id="277b5-221">Распределение по версиям агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-221">Distribution by Agent Version</span></span> |
| <span data-ttu-id="277b5-222">Type=Heartbeat&#124;measure count() by Category</span><span class="sxs-lookup"><span data-stu-id="277b5-222">Type=Heartbeat&#124;measure count() by Category</span></span> |<span data-ttu-id="277b5-223">Распределение по категориям агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-223">Distribution by Agent Category</span></span> |
| <span data-ttu-id="277b5-224">Type=Heartbeat&#124;measure countdistinct(Computer) by ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="277b5-224">Type=Heartbeat&#124;measure countdistinct(Computer) by ManagementGroupName</span></span> | <span data-ttu-id="277b5-225">Распределение по группам управления</span><span class="sxs-lookup"><span data-stu-id="277b5-225">Distribution by Management Group</span></span> |
| <span data-ttu-id="277b5-226">Type=Heartbeat&#124;measure countdistinct(Computer) by RemoteIPCountry</span><span class="sxs-lookup"><span data-stu-id="277b5-226">Type=Heartbeat&#124;measure countdistinct(Computer) by RemoteIPCountry</span></span> |<span data-ttu-id="277b5-227">Географическое расположение агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-227">Geo-location of Agents</span></span> |
| <span data-ttu-id="277b5-228">Type=Heartbeat IsGatewayInstalled=true&#124;Distinct Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-228">Type=Heartbeat IsGatewayInstalled=true&#124;Distinct Computer</span></span> |<span data-ttu-id="277b5-229">Число установленных шлюзов OMS</span><span class="sxs-lookup"><span data-stu-id="277b5-229">Number of OMS Gateways Installed</span></span> |


>[!NOTE]
> <span data-ttu-id="277b5-230">Если для рабочей области обновлен [язык запросов Log Analytics](../log-analytics/log-analytics-log-search-upgrade.md), указанные выше запросы будут изменены следующим образом.</span><span class="sxs-lookup"><span data-stu-id="277b5-230">If your workspace has been upgraded to the [new Log Analytics query language](../log-analytics/log-analytics-log-search-upgrade.md), then the above queries would change to the following.</span></span>
>
>| <span data-ttu-id="277b5-231">Запрос</span><span class="sxs-lookup"><span data-stu-id="277b5-231">Query</span></span> | <span data-ttu-id="277b5-232">Описание</span><span class="sxs-lookup"><span data-stu-id="277b5-232">Description</span></span> |
|:---|:---|
| <span data-ttu-id="277b5-233">Heartbeat &#124; distinct Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-233">Heartbeat &#124; distinct Computer</span></span> |<span data-ttu-id="277b5-234">Общее число агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-234">Total number of agents</span></span> |
| <span data-ttu-id="277b5-235">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(24h)</span><span class="sxs-lookup"><span data-stu-id="277b5-235">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(24h)</span></span> |<span data-ttu-id="277b5-236">Число агентов, не отвечающих на запросы за последние 24 часа</span><span class="sxs-lookup"><span data-stu-id="277b5-236">Count of unresponsive agents in the last 24 hours</span></span> |
| <span data-ttu-id="277b5-237">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(15m)</span><span class="sxs-lookup"><span data-stu-id="277b5-237">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(15m)</span></span> |<span data-ttu-id="277b5-238">Число агентов, не отвечающих на запросы за последние 15 минут</span><span class="sxs-lookup"><span data-stu-id="277b5-238">Count of unresponsive agents in the last 15 minutes</span></span> |
| <span data-ttu-id="277b5-239">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer in ((Heartbeat &#124; where TimeGenerated > ago(24h) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-239">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer in ((Heartbeat &#124; where TimeGenerated > ago(24h) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span></span> |<span data-ttu-id="277b5-240">Подключенные компьютеры (за последние 24 часа)</span><span class="sxs-lookup"><span data-stu-id="277b5-240">Computers online (in the last 24 hours)</span></span> |
| <span data-ttu-id="277b5-241">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer !in ((Heartbeat &#124; where TimeGenerated > ago(30m) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-241">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer !in ((Heartbeat &#124; where TimeGenerated > ago(30m) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span></span> |<span data-ttu-id="277b5-242">Общее число автономных агентов за последние 30 минут (за последние 24 часа)</span><span class="sxs-lookup"><span data-stu-id="277b5-242">Total Agents Offline in Last 30 minutes (for the last 24 hours)</span></span> |
| <span data-ttu-id="277b5-243">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="277b5-243">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span></span> |<span data-ttu-id="277b5-244">Получение тенденции изменения числа агентов за промежуток времени по типу ОС</span><span class="sxs-lookup"><span data-stu-id="277b5-244">Get a trend of number of agents over time by OSType</span></span>|
| <span data-ttu-id="277b5-245">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="277b5-245">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span></span> |<span data-ttu-id="277b5-246">Распределение по типам ОС</span><span class="sxs-lookup"><span data-stu-id="277b5-246">Distribution by OS Type</span></span> |
| <span data-ttu-id="277b5-247">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by Version</span><span class="sxs-lookup"><span data-stu-id="277b5-247">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by Version</span></span> |<span data-ttu-id="277b5-248">Распределение по версиям агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-248">Distribution by Agent Version</span></span> |
| <span data-ttu-id="277b5-249">Heartbeat &#124; summarize AggregatedValue = count() by Category</span><span class="sxs-lookup"><span data-stu-id="277b5-249">Heartbeat &#124; summarize AggregatedValue = count() by Category</span></span> |<span data-ttu-id="277b5-250">Распределение по категориям агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-250">Distribution by Agent Category</span></span> |
| <span data-ttu-id="277b5-251">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="277b5-251">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by ManagementGroupName</span></span> | <span data-ttu-id="277b5-252">Распределение по группам управления</span><span class="sxs-lookup"><span data-stu-id="277b5-252">Distribution by Management Group</span></span> |
| <span data-ttu-id="277b5-253">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by RemoteIPCountry</span><span class="sxs-lookup"><span data-stu-id="277b5-253">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by RemoteIPCountry</span></span> |<span data-ttu-id="277b5-254">Географическое расположение агентов</span><span class="sxs-lookup"><span data-stu-id="277b5-254">Geo-location of Agents</span></span> |
| <span data-ttu-id="277b5-255">Heartbeat &#124; where iff(isnotnull(toint(IsGatewayInstalled)), IsGatewayInstalled == true, IsGatewayInstalled == "true") == true &#124; distinct Computer</span><span class="sxs-lookup"><span data-stu-id="277b5-255">Heartbeat &#124; where iff(isnotnull(toint(IsGatewayInstalled)), IsGatewayInstalled == true, IsGatewayInstalled == "true") == true &#124; distinct Computer</span></span> |<span data-ttu-id="277b5-256">Число установленных шлюзов OMS</span><span class="sxs-lookup"><span data-stu-id="277b5-256">Number of OMS Gateways Installed</span></span> |

## <a name="next-steps"></a><span data-ttu-id="277b5-257">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="277b5-257">Next steps</span></span>

* <span data-ttu-id="277b5-258">Дополнительные сведения о генерации оповещений из Log Analytics см. в статье [Оповещения в Log Analytics](../log-analytics/log-analytics-alerts.md).</span><span class="sxs-lookup"><span data-stu-id="277b5-258">Learn about [Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md) for details on generating alerts from Log Analytics.</span></span>
