---
title: "Подробное описание устранения неполадок SSH для виртуальной машины Azure | Документация Майкрософт"
description: "Подробные указания по устранению неполадок SSH-подключений к виртуальной машине Azure"
keywords: "в SSH-подключении отказано, ошибка SSH, Azure SSH, ошибка SSH-подключения"
services: virtual-machines-linux
documentationcenter: 
author: iainfoulds
manager: timlt
editor: 
tags: top-support-issue,azure-service-management,azure-resource-manager
ms.assetid: b8e8be5f-e8a6-489d-9922-9df8de32e839
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: support-article
ms.date: 07/06/2017
ms.author: iainfou
ms.openlocfilehash: 9ccdb3fbca21264065eeb1c4e46314c62af4c2e8
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="detailed-ssh-troubleshooting-steps-for-issues-connecting-to-a-linux-vm-in-azure"></a><span data-ttu-id="6e8a1-104">Подробные инструкции по устранению неполадок SSH-подключений к виртуальной машине Linux в Azure</span><span class="sxs-lookup"><span data-stu-id="6e8a1-104">Detailed SSH troubleshooting steps for issues connecting to a Linux VM in Azure</span></span>
<span data-ttu-id="6e8a1-105">Клиенту SSH не всегда удается получить доступ к SSH-службе на виртуальной машине по многим причинам.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-105">There are many possible reasons that the SSH client might not be able to reach the SSH service on the VM.</span></span> <span data-ttu-id="6e8a1-106">Если вы использовали более [общие действия по устранению неполадок SSH](troubleshoot-ssh-connection.md), то необходимы более конкретные действия для устранения проблемы подключения.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-106">If you have followed through the more [general SSH troubleshooting steps](troubleshoot-ssh-connection.md), you need to further troubleshoot the connection issue.</span></span> <span data-ttu-id="6e8a1-107">В этой статье подробно изложено, как определить, где происходит сбой подключения SSH и как его устранить.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-107">This article guides you through detailed troubleshooting steps to determine where the SSH connection is failing and how to resolve it.</span></span>

## <a name="take-preliminary-steps"></a><span data-ttu-id="6e8a1-108">Выполнение предварительных действий</span><span class="sxs-lookup"><span data-stu-id="6e8a1-108">Take preliminary steps</span></span>
<span data-ttu-id="6e8a1-109">На следующей схеме показаны задействованные при этом компоненты.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-109">The following diagram shows the components that are involved.</span></span>

![Схема компонентов службы SSH](./media/detailed-troubleshoot-ssh-connection/ssh-tshoot1.png)

<span data-ttu-id="6e8a1-111">Приведенные ниже шаги помогут вам выявить источник сбоя и определить способы его устранения или обхода.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-111">The following steps help you isolate the source of the failure and figure out solutions or workarounds.</span></span>

1. <span data-ttu-id="6e8a1-112">Проверьте состояние виртуальной машины на портале.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-112">Check the status of the VM in the portal.</span></span>
   <span data-ttu-id="6e8a1-113">На [портале Azure](https://portal.azure.com) выберите **Виртуальные машины** > *Имя виртуальной машины*.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-113">In the [Azure portal](https://portal.azure.com), select **Virtual machines** > *VM name*.</span></span>

   <span data-ttu-id="6e8a1-114">Панель состояния виртуальной машины должна отображать состояние **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-114">The status pane for the VM should show **Running**.</span></span> <span data-ttu-id="6e8a1-115">Прокрутите страницу вниз для просмотра последних действий в ресурсах вычислений, хранения и сетевых ресурсах.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-115">Scroll down to show recent activity for compute, storage, and network resources.</span></span>

2. <span data-ttu-id="6e8a1-116">Выберите **Параметры**, чтобы проверить конечные точки, IP-адреса, группы безопасности и другие параметры.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-116">Select **Settings** to examine endpoints, IP addresses, network security groups, and other settings.</span></span>

   <span data-ttu-id="6e8a1-117">Виртуальная машина должна иметь конечную точку, определенную для SSH-трафика, которую можно просмотреть в разделе **Конечные точки** или **[Группа безопасности сети](../../virtual-network/virtual-networks-nsg.md)**.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-117">The VM should have an endpoint defined for SSH traffic that you can view in **Endpoints** or **[Network security group](../../virtual-network/virtual-networks-nsg.md)**.</span></span> <span data-ttu-id="6e8a1-118">Конечные точки в виртуальных машинах, созданных с помощью Resource Manager, сохраняются в группе безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-118">Endpoints in VMs that were created by using Resource Manager are stored in a network security group.</span></span> <span data-ttu-id="6e8a1-119">Кроме того, убедитесь, что к группе безопасности сети применены правила и что в подсети есть ссылки на них.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-119">Also, verify that the rules have been applied to the network security group and that they're referenced in the subnet.</span></span>

<span data-ttu-id="6e8a1-120">Чтобы проверить сетевое подключение, проверьте настроенные конечные точки и определите, можете ли вы получить доступ к виртуальной машине с помощью другого протокола, например HTTP, или другой службы.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-120">To verify network connectivity, check the configured endpoints and see if you can reach the VM through another protocol, such as HTTP or another service.</span></span>

<span data-ttu-id="6e8a1-121">Выполнив эти действия, попытайтесь создать SSH-подключение еще раз.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-121">After these steps, try the SSH connection again.</span></span>

## <a name="find-the-source-of-the-issue"></a><span data-ttu-id="6e8a1-122">Поиск источника проблемы</span><span class="sxs-lookup"><span data-stu-id="6e8a1-122">Find the source of the issue</span></span>
<span data-ttu-id="6e8a1-123">Неспособность клиента SSH подключиться к службе SSH на виртуальной машине Azure может быть связана с проблемами и неправильными настройками в перечисленных ниже областях.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-123">The SSH client on your computer might fail to reach the SSH service on the Azure VM due to issues or misconfigurations in the following areas:</span></span>

* [<span data-ttu-id="6e8a1-124">Клиентский компьютер SSH.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-124">SSH client computer</span></span>](#source-1-ssh-client-computer)
* [<span data-ttu-id="6e8a1-125">Пограничное устройство организации.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-125">Organization edge device</span></span>](#source-2-organization-edge-device)
* [<span data-ttu-id="6e8a1-126">Конечная точка облачной службы и список управления доступом (ACL)</span><span class="sxs-lookup"><span data-stu-id="6e8a1-126">Cloud service endpoint and access control list (ACL)</span></span>](#source-3-cloud-service-endpoint-and-acl)
* [<span data-ttu-id="6e8a1-127">Группы безопасности сети</span><span class="sxs-lookup"><span data-stu-id="6e8a1-127">Network security groups</span></span>](#source-4-network-security-groups)
* [<span data-ttu-id="6e8a1-128">Виртуальная машина Azure под управлением Linux</span><span class="sxs-lookup"><span data-stu-id="6e8a1-128">Linux-based Azure VM</span></span>](#source-5-linux-based-azure-virtual-machine)

## <a name="source-1-ssh-client-computer"></a><span data-ttu-id="6e8a1-129">Источник 1: клиентский компьютер SSH</span><span class="sxs-lookup"><span data-stu-id="6e8a1-129">Source 1: SSH client computer</span></span>
<span data-ttu-id="6e8a1-130">Чтобы исключить компьютер из числа возможных источников ошибок, убедитесь, что с его помощью можно установить SSH-подключения к другому локальному компьютеру под управлением Linux.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-130">To eliminate your computer as the source of the failure, verify that it can make SSH connections to another on-premises, Linux-based computer.</span></span>

![Схема, на которой выделены компоненты клиентского компьютера SSH](./media/detailed-troubleshoot-ssh-connection/ssh-tshoot2.png)

<span data-ttu-id="6e8a1-132">В случае сбоя подключения проверьте, нет ли на компьютере:</span><span class="sxs-lookup"><span data-stu-id="6e8a1-132">If the connection fails, check for the following issues on your computer:</span></span>

* <span data-ttu-id="6e8a1-133">настройки локального брандмауэра, блокирующей входящий и исходящий SSH-трафик (TCP 22);</span><span class="sxs-lookup"><span data-stu-id="6e8a1-133">A local firewall setting that is blocking inbound or outbound SSH traffic (TCP 22)</span></span>
* <span data-ttu-id="6e8a1-134">локального программного обеспечения с функциями прокси клиента, которое не позволяет установить SSH-подключение;</span><span class="sxs-lookup"><span data-stu-id="6e8a1-134">Locally installed client proxy software that is preventing SSH connections</span></span>
* <span data-ttu-id="6e8a1-135">локального программного обеспечения для мониторинга сети, которое не позволяет установить SSH-подключение;</span><span class="sxs-lookup"><span data-stu-id="6e8a1-135">Locally installed network monitoring software that is preventing SSH connections</span></span>
* <span data-ttu-id="6e8a1-136">других программ для обеспечения безопасности, которые ведут мониторинг трафика либо разрешают и запрещают трафик определенных типов.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-136">Other types of security software that either monitor traffic or allow/disallow specific types of traffic</span></span>

<span data-ttu-id="6e8a1-137">Если одно из этих условий совпадает, временно отключите программное обеспечение и попробуйте установить SSH-подключение к локальному компьютеру, чтобы узнать причину блокировки подключения на вашем компьютере.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-137">If one of these conditions apply, temporarily disable the software and try an SSH connection to an on-premises computer to find out the reason the connection is being blocked on your computer.</span></span> <span data-ttu-id="6e8a1-138">Затем при поддержке администратора сети измените параметры программного обеспечения таким образом, чтобы оно не блокировало SSH-подключение.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-138">Then work with your network administrator to correct the software settings to allow SSH connections.</span></span>

<span data-ttu-id="6e8a1-139">Если вы используете проверку подлинности на основе сертификата, убедитесь, что у вас есть следующие разрешения для папки SSH в домашнем каталоге:</span><span class="sxs-lookup"><span data-stu-id="6e8a1-139">If you are using certificate authentication, verify that you have these permissions to the .ssh folder in your home directory:</span></span>

* <span data-ttu-id="6e8a1-140">Chmod 700 ~/.ssh;</span><span class="sxs-lookup"><span data-stu-id="6e8a1-140">Chmod 700 ~/.ssh</span></span>
* <span data-ttu-id="6e8a1-141">Chmod 644 ~/.ssh/\*.pub</span><span class="sxs-lookup"><span data-stu-id="6e8a1-141">Chmod 644 ~/.ssh/\*.pub</span></span>
* <span data-ttu-id="6e8a1-142">Chmod 600 ~/.ssh/id_rsa (или другие файлы, в которых хранятся ваши закрытые ключи);</span><span class="sxs-lookup"><span data-stu-id="6e8a1-142">Chmod 600 ~/.ssh/id_rsa (or any other files that have your private keys stored in them)</span></span>
* <span data-ttu-id="6e8a1-143">Chmod 644 ~/.ssh/known_hosts (содержит узлы, к которым установлено подключение по SSH-протоколу).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-143">Chmod 644 ~/.ssh/known_hosts (contains hosts that you’ve connected to via SSH)</span></span>

## <a name="source-2-organization-edge-device"></a><span data-ttu-id="6e8a1-144">Источник 2: пограничное устройство организации</span><span class="sxs-lookup"><span data-stu-id="6e8a1-144">Source 2: Organization edge device</span></span>
<span data-ttu-id="6e8a1-145">Чтобы исключить пограничное устройство организации из числа возможных источников ошибок, убедитесь, что компьютер, подключенный к Интернету напрямую, может устанавливать SSH-подключения к виртуальной машине Azure.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-145">To eliminate your organization edge device as the source of the failure, verify that a computer that's directly connected to the Internet can make SSH connections to your Azure VM.</span></span> <span data-ttu-id="6e8a1-146">Если вы получаете доступ к виртуальной машине через VPN-подключение типа "сеть — сеть" или подключение Azure ExpressRoute, перейдите к подразделу [Источник 4: группы безопасности сети](#nsg).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-146">If you are accessing the VM over a site-to-site VPN or an Azure ExpressRoute connection, skip to [Source 4: Network security groups](#nsg).</span></span>

![Схема, на которой выделено пограничное устройство организации](./media/detailed-troubleshoot-ssh-connection/ssh-tshoot3.png)

<span data-ttu-id="6e8a1-148">Если у вас нет компьютера, непосредственно подключенного к Интернету, создайте виртуальную машину Azure, размещенную в собственной группе ресурсов или облачной службе, и используйте ее.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-148">If you don't have a computer that is directly connected to the Internet, create a new Azure VM in its own resource group or cloud service and use it.</span></span> <span data-ttu-id="6e8a1-149">Дополнительные сведения см. в статье [Создание виртуальной машины Linux с помощью интерфейса командной строки Azure 2.0](quick-create-cli.md).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-149">For more information, see [Create a virtual machine running Linux in Azure](quick-create-cli.md).</span></span> <span data-ttu-id="6e8a1-150">Завершив проверку, удалите группу ресурсов или виртуальную машину и облачную службу.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-150">Delete the resource group or VM and cloud service when you're done with your testing.</span></span>

<span data-ttu-id="6e8a1-151">Если вам удается установить SSH-подключение с компьютера, непосредственно подключенного к Интернету, убедитесь, что на пограничном устройстве вашей организации отсутствуют следующие компоненты:</span><span class="sxs-lookup"><span data-stu-id="6e8a1-151">If you can create an SSH connection with a computer that's directly connected to the Internet, check your organization edge device for:</span></span>

* <span data-ttu-id="6e8a1-152">внутренний брандмауэр, который блокирует SSH-трафик в Интернете;</span><span class="sxs-lookup"><span data-stu-id="6e8a1-152">An internal firewall that's blocking SSH traffic with the Internet</span></span>
* <span data-ttu-id="6e8a1-153">прокси-сервер, который не позволяет устанавливать SSH-подключения;</span><span class="sxs-lookup"><span data-stu-id="6e8a1-153">A proxy server that's preventing SSH connections</span></span>
* <span data-ttu-id="6e8a1-154">программное обеспечение для обнаружения атак и мониторинга сети, которое работает на устройствах в вашей сети периметра и блокирует SSH-подключения.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-154">Intrusion detection or network monitoring software running on devices in your edge network that's preventing SSH connections</span></span>

<span data-ttu-id="6e8a1-155">При поддержке администратора сети измените параметры пограничного устройства организации таким образом, чтобы оно не блокировало SSH-трафик через Интернет.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-155">Work with your network administrator to correct the settings of your organization edge devices to allow SSH traffic with the Internet.</span></span>

## <a name="source-3-cloud-service-endpoint-and-acl"></a><span data-ttu-id="6e8a1-156">Источник 3: конечная точка облачной службы и список управления доступом (ACL)</span><span class="sxs-lookup"><span data-stu-id="6e8a1-156">Source 3: Cloud service endpoint and ACL</span></span>
> [!NOTE]
> <span data-ttu-id="6e8a1-157">Этот источник применяется только к виртуальным машинам, созданным с помощью классической модели развертывания.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-157">This source applies only to VMs that were created by using the classic deployment model.</span></span> <span data-ttu-id="6e8a1-158">Для виртуальных машин, созданных с помощью Resource Manager, перейдите к подразделу [Источник 4: группы безопасности сети](#nsg).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-158">For VMs that were created by using Resource Manager, skip to [source 4: Network security groups](#nsg).</span></span>

<span data-ttu-id="6e8a1-159">Чтобы исключить конечную точку облачной службы и список управления доступом из числа возможных источников ошибок, убедитесь, что другая виртуальная машина Azure в той же виртуальной сети может устанавливать SSH-подключения к вашей виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-159">To eliminate the cloud service endpoint and ACL as the source of the failure, verify that another Azure VM in the same virtual network can make SSH connections to your VM.</span></span>

![Диаграмма, на которой выделены конечная точка облачной службы и ACL](./media/detailed-troubleshoot-ssh-connection/ssh-tshoot4.png)

<span data-ttu-id="6e8a1-161">Если у вас нет еще одной виртуальной машины в той же виртуальной сети, вы можете легко ее создать.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-161">If you don't have another VM in the same virtual network, you can easily create one.</span></span> <span data-ttu-id="6e8a1-162">Дополнительные сведения см. в статье [Создание виртуальной машины Linux с помощью интерфейса командной строки Azure 2.0](quick-create-cli.md).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-162">For more information, see [Create a Linux VM on Azure using the CLI](quick-create-cli.md).</span></span> <span data-ttu-id="6e8a1-163">Завершив проверку, удалите дополнительную виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-163">Delete the extra VM when you are done with your testing.</span></span>

<span data-ttu-id="6e8a1-164">Если вы создаете подключение SSH к виртуальной машине в той же виртуальной сети, проверьте следующие области.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-164">If you can create an SSH connection with a VM in the same virtual network, check the following areas:</span></span>

* <span data-ttu-id="6e8a1-165">**Конфигурация конечной точки для SSH-трафика на целевой виртуальной машине.**</span><span class="sxs-lookup"><span data-stu-id="6e8a1-165">**The endpoint configuration for SSH traffic on the target VM.**</span></span> <span data-ttu-id="6e8a1-166">Частный TCP-порт на конечной точке должен совпадать с TCP-портом, который прослушивает SSH-служба на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-166">The private TCP port of the endpoint should match the TCP port on which the SSH service on the VM is listening.</span></span> <span data-ttu-id="6e8a1-167">(Порт по умолчанию — 22.)</span><span class="sxs-lookup"><span data-stu-id="6e8a1-167">(The default port is 22).</span></span> <span data-ttu-id="6e8a1-168">Проверьте номер TCP-порта SSH. Для этого на портале Azure последовательно выберите **Виртуальные машины** > *Имя виртуальной машины* > **Параметры** > **Конечные точки**.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-168">Verify the SSH TCP port number in the Azure portal by selecting **Virtual machines** > *VM name* > **Settings** > **Endpoints**.</span></span>
* <span data-ttu-id="6e8a1-169">**Список управления доступом на конечной точке для SSH-трафика на целевой виртуальной машине.**</span><span class="sxs-lookup"><span data-stu-id="6e8a1-169">**The ACL for the SSH traffic endpoint on the target virtual machine.**</span></span> <span data-ttu-id="6e8a1-170">С помощью него можно разрешать и запрещать входящий трафик из Интернета в зависимости от IP-адреса источника.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-170">An ACL enables you to specify allowed or denied incoming traffic from the Internet, based on its source IP address.</span></span> <span data-ttu-id="6e8a1-171">Если список управления доступом неправильно настроен, входящий SSH-трафик на эту конечную точку может блокироваться.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-171">Misconfigured ACLs can prevent incoming SSH traffic to the endpoint.</span></span> <span data-ttu-id="6e8a1-172">Проверьте свои списки управления доступом и убедитесь в том, что входящий трафик с общедоступных IP-адресов вашего прокси-сервера или другого пограничного сервера разрешен.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-172">Check your ACLs to ensure that incoming traffic from the public IP addresses of your proxy or other edge server is allowed.</span></span> <span data-ttu-id="6e8a1-173">Дополнительные сведения см. в статье [Список управления доступом (ACL) конечной точки](../../virtual-network/virtual-networks-acl.md).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-173">For more information, see [About network access control lists (ACLs)](../../virtual-network/virtual-networks-acl.md).</span></span>

<span data-ttu-id="6e8a1-174">Чтобы исключить конечную точку из числа возможных источников проблем, удалите ее и создайте другую конечную точку, указав имя SSH (номер для общего и частного TCP-порта — 22).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-174">To eliminate the endpoint as a source of the problem, remove the current endpoint, create another endpoint, and specify the SSH name (TCP port 22 for the public and private port number).</span></span> <span data-ttu-id="6e8a1-175">Дополнительные сведения см. в статье [Настройка конечных точек в классической виртуальной машине Windows в Azure](../windows/classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-175">For more information, see [Set up endpoints on a virtual machine in Azure](../windows/classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span></span>

<a id="nsg"></a>

## <a name="source-4-network-security-groups"></a><span data-ttu-id="6e8a1-176">Источник 4: группы безопасности сети</span><span class="sxs-lookup"><span data-stu-id="6e8a1-176">Source 4: Network security groups</span></span>
<span data-ttu-id="6e8a1-177">Группы безопасности сети позволяют точнее настраивать параметры разрешенного входящего и исходящего трафика.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-177">Network security groups enable you to have more granular control of allowed inbound and outbound traffic.</span></span> <span data-ttu-id="6e8a1-178">Можно создавать правила, которые распространяются на подсети и облачные службы в виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-178">You can create rules that span subnets and cloud services in an Azure virtual network.</span></span> <span data-ttu-id="6e8a1-179">Проверьте свои правила групп безопасности сети и убедитесь, что входящий и исходящий SSH-трафик разрешен.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-179">Check your network security group rules to ensure that SSH traffic to and from the Internet is allowed.</span></span>
<span data-ttu-id="6e8a1-180">Дополнительные сведения см. в статье [Группа безопасности сети](../../virtual-network/virtual-networks-nsg.md).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-180">For more information, see [About network security groups](../../virtual-network/virtual-networks-nsg.md).</span></span>

<span data-ttu-id="6e8a1-181">Для проверки конфигурации NSG можно также использовать функцию проверки IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-181">You can also use IP Verify to validate the NSG configuration.</span></span> <span data-ttu-id="6e8a1-182">Дополнительные сведения см. в статье [Обзор мониторинга сети Azure](https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-182">For more information, see [Azure network monitoring overview](https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview).</span></span> 

## <a name="source-5-linux-based-azure-virtual-machine"></a><span data-ttu-id="6e8a1-183">Источник 5: виртуальная машина Azure в службе Azure</span><span class="sxs-lookup"><span data-stu-id="6e8a1-183">Source 5: Linux-based Azure virtual machine</span></span>
<span data-ttu-id="6e8a1-184">Последним потенциальным источником проблем является сама виртуальная машина Azure.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-184">The last source of possible problems is the Azure virtual machine itself.</span></span>

![Диаграмма, на которой выделена виртуальная машина Azure под управлением Linux](./media/detailed-troubleshoot-ssh-connection/ssh-tshoot5.png)

<span data-ttu-id="6e8a1-186">Выполните указания по [сбросу пароля или SSH на виртуальных машинах Linux](classic/reset-access.md?toc=%2fazure%2fvirtual-machines%2flinux%2fclassic%2ftoc.json) (если вы еще этого не сделали).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-186">If you haven't done so already, follow the instructions [to reset a password or SSH for Linux-based virtual machines](classic/reset-access.md?toc=%2fazure%2fvirtual-machines%2flinux%2fclassic%2ftoc.json).</span></span>

<span data-ttu-id="6e8a1-187">Попытайтесь снова установить подключение со своего компьютера.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-187">Try connecting from your computer again.</span></span> <span data-ttu-id="6e8a1-188">Если вам по-прежнему не удается подключиться, проверьте, не соответствует ли ваша среда одному из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="6e8a1-188">If it still fails, the following are some of the possible issues:</span></span>

* <span data-ttu-id="6e8a1-189">На целевой виртуальной машине не запущена SSH-служба.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-189">The SSH service is not running on the target virtual machine.</span></span>
* <span data-ttu-id="6e8a1-190">SSH-служба не прослушивает TCP-порт 22.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-190">The SSH service is not listening on TCP port 22.</span></span> <span data-ttu-id="6e8a1-191">Чтобы проверить это, установите клиент telnet на локальном компьютере и выполните команду telnet *cloudServiceName*.cloudapp.net 22.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-191">To test, install a telnet client on your local computer and run "telnet *cloudServiceName*.cloudapp.net 22".</span></span> <span data-ttu-id="6e8a1-192">Эта команда позволит определить, разрешает ли виртуальная машина входящий и исходящий обмен данными с конечной точкой SSH.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-192">This step determines if the virtual machine allows inbound and outbound communication to the SSH endpoint.</span></span>
* <span data-ttu-id="6e8a1-193">Правила локального брандмауэра на целевой виртуальной машине блокируют входящий и исходящий SSH-трафик.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-193">The local firewall on the target virtual machine has rules that are preventing inbound or outbound SSH traffic.</span></span>
* <span data-ttu-id="6e8a1-194">Программное обеспечение для обнаружения атак и мониторинга сети на виртуальной машине Azure блокирует SSH-подключения.</span><span class="sxs-lookup"><span data-stu-id="6e8a1-194">Intrusion detection or network monitoring software that's running on the Azure virtual machine is preventing SSH connections.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="6e8a1-195">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="6e8a1-195">Additional resources</span></span>
<span data-ttu-id="6e8a1-196">Дополнительные сведения об устранении неполадок с доступом к приложению см. в статье [Устранение проблем с подключением к приложениям на виртуальных машинах Linux в Azure](troubleshoot-app-connection.md).</span><span class="sxs-lookup"><span data-stu-id="6e8a1-196">For more information about troubleshooting application access, see [Troubleshoot access to an application running on an Azure virtual machine](troubleshoot-app-connection.md)</span></span>
