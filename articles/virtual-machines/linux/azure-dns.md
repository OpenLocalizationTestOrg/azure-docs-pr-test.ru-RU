---
title: "aaaDNS параметры разрешения имен для виртуальных машин Linux в Azure"
description: "Сценарии разрешения имен для виртуальных машин Linux в Azure IaaS, включая предоставленные службы DNS, гибридные внешние DNS и использование собственного DNS-сервера."
services: virtual-machines
documentationcenter: na
author: RicksterCDN
manager: timlt
editor: tysonn
ms.assetid: 787a1e04-cebf-4122-a1b4-1fcf0a2bbf5f
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2016
ms.author: rclaus
ms.openlocfilehash: 7df2320b6f6b42b479bf4070ea60fe5770a78a41
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="dns-name-resolution-options-for-linux-virtual-machines-in-azure"></a><span data-ttu-id="87317-103">Параметры разрешения DNS-имен для виртуальных машин Linux в Azure</span><span class="sxs-lookup"><span data-stu-id="87317-103">DNS Name Resolution options for Linux virtual machines in Azure</span></span>
<span data-ttu-id="87317-104">Azure по умолчанию предоставляет разрешение DNS-имен для всех виртуальных машин, находящихся в одной виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="87317-104">Azure provides DNS name resolution by default for all virtual machines that are in a single virtual network.</span></span> <span data-ttu-id="87317-105">Вы можете реализовать собственный механизм разрешения DNS-имен, настроив собственные службы DNS в виртуальных машинах, размещенных в Azure.</span><span class="sxs-lookup"><span data-stu-id="87317-105">You can implement your own DNS name resolution solution by configuring your own DNS services on your virtual machines that Azure hosts.</span></span> <span data-ttu-id="87317-106">Hello следующие сценарии поможет вам выбрать тот, который работает в вашей ситуации hello.</span><span class="sxs-lookup"><span data-stu-id="87317-106">hello following scenarios should help you choose hello one that works for your situation.</span></span>

* [<span data-ttu-id="87317-107">Разрешение имен, предоставляемое Azure</span><span class="sxs-lookup"><span data-stu-id="87317-107">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution)
* [<span data-ttu-id="87317-108">разрешение имен с помощью собственного DNS-сервера.</span><span class="sxs-lookup"><span data-stu-id="87317-108">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server)

<span data-ttu-id="87317-109">Тип разрешения имен, используемого Hello зависит от того, как виртуальные машины и экземпляры ролей требуется toocommunicate друг с другом.</span><span class="sxs-lookup"><span data-stu-id="87317-109">hello type of name resolution that you use depends on how your virtual machines and role instances need toocommunicate with each other.</span></span>

<span data-ttu-id="87317-110">Hello следующей таблице представлены сценарии и соответствующие решения для разрешения имен.</span><span class="sxs-lookup"><span data-stu-id="87317-110">hello following table illustrates scenarios and corresponding name resolution solutions:</span></span>

| <span data-ttu-id="87317-111">**Сценарий**</span><span class="sxs-lookup"><span data-stu-id="87317-111">**Scenario**</span></span> | <span data-ttu-id="87317-112">**Решение**</span><span class="sxs-lookup"><span data-stu-id="87317-112">**Solution**</span></span> | <span data-ttu-id="87317-113">**Суффикс**</span><span class="sxs-lookup"><span data-stu-id="87317-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="87317-114">Разрешение между экземплярами ролей или виртуальных машин в приветствия имен одной виртуальной сети</span><span class="sxs-lookup"><span data-stu-id="87317-114">Name resolution between role instances or virtual machines in hello same virtual network</span></span> |[<span data-ttu-id="87317-115">Разрешение имен, предоставляемое Azure</span><span class="sxs-lookup"><span data-stu-id="87317-115">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="87317-116">Имя узла или полное доменное имя</span><span class="sxs-lookup"><span data-stu-id="87317-116">hostname or fully-qualified domain name (FQDN)</span></span> |
| <span data-ttu-id="87317-117">Разрешение имен между экземплярами ролей или виртуальными машинами, находящимися в разных виртуальных сетях</span><span class="sxs-lookup"><span data-stu-id="87317-117">Name resolution between role instances or virtual machines in different virtual networks</span></span> |<span data-ttu-id="87317-118">Управляемые клиентами DNS-серверы, перенаправляющие запросы между виртуальными сетями для разрешения в Azure (DNS-прокси).</span><span class="sxs-lookup"><span data-stu-id="87317-118">Customer-managed DNS servers that forward queries between virtual networks for resolution by Azure (DNS proxy).</span></span> <span data-ttu-id="87317-119">См. раздел [Разрешение имен с помощью собственного DNS-сервера](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="87317-119">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="87317-120">только полное доменное имя</span><span class="sxs-lookup"><span data-stu-id="87317-120">FQDN only</span></span> |
| <span data-ttu-id="87317-121">Разрешение имен локальных компьютеров и служб из экземпляров роли или виртуальных машин в Azure</span><span class="sxs-lookup"><span data-stu-id="87317-121">Resolution of on-premises computers and service names from role instances or virtual machines in Azure</span></span> |<span data-ttu-id="87317-122">Управляемые клиентами DNS-серверы (например, локальный контроллер домена, локальный контроллер домена только для чтения или DNS-сервер, вторично синхронизированный с помощью передач зоны).</span><span class="sxs-lookup"><span data-stu-id="87317-122">Customer-managed DNS servers (for example, on-premises domain controller, local read-only domain controller, or a DNS secondary synced by using zone transfers).</span></span> <span data-ttu-id="87317-123">См. раздел [Разрешение имен с помощью собственного DNS-сервера](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="87317-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="87317-124">только полное доменное имя</span><span class="sxs-lookup"><span data-stu-id="87317-124">FQDN only</span></span> |
| <span data-ttu-id="87317-125">Разрешение имен узлов Azure с локальных компьютеров</span><span class="sxs-lookup"><span data-stu-id="87317-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="87317-126">Пересылать запросы tooa под управлением прокси-сервер DNS в hello соответствующей виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="87317-126">Forward queries tooa customer-managed DNS proxy server in hello corresponding virtual network.</span></span> <span data-ttu-id="87317-127">Hello прокси-сервер перенаправляет запросы tooAzure для разрешения.</span><span class="sxs-lookup"><span data-stu-id="87317-127">hello proxy server forwards queries tooAzure for resolution.</span></span> <span data-ttu-id="87317-128">См. раздел [Разрешение имен с помощью собственного DNS-сервера](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="87317-128">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="87317-129">только полное доменное имя</span><span class="sxs-lookup"><span data-stu-id="87317-129">FQDN only</span></span> |
| <span data-ttu-id="87317-130">Обратный поиск DNS для внутренних IP-адресов</span><span class="sxs-lookup"><span data-stu-id="87317-130">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="87317-131">разрешение имен с помощью собственного DNS-сервера.</span><span class="sxs-lookup"><span data-stu-id="87317-131">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="87317-132">Недоступно</span><span class="sxs-lookup"><span data-stu-id="87317-132">n/a</span></span> |

## <a name="name-resolution-that-azure-provides"></a><span data-ttu-id="87317-133">Разрешение имен, предоставляемое Azure</span><span class="sxs-lookup"><span data-stu-id="87317-133">Name resolution that Azure provides</span></span>
<span data-ttu-id="87317-134">А также разрешение общедоступные DNS-имена Azure предоставляет внутреннее разрешение имен для виртуальных машин и Здравствуйте, экземпляры роли, которые находятся в одной виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="87317-134">Along with resolution of public DNS names, Azure provides internal name resolution for virtual machines and role instances that are in hello same virtual network.</span></span> <span data-ttu-id="87317-135">В виртуальных сетях, основанных на Azure Resource Manager hello DNS-суффикс является согласованным для всех hello виртуальной сети. Hello полное доменное имя не требуется.</span><span class="sxs-lookup"><span data-stu-id="87317-135">In virtual networks that are based on Azure Resource Manager, hello DNS suffix is consistent across hello virtual network; hello FQDN is not needed.</span></span> <span data-ttu-id="87317-136">DNS-имена могут назначаться tooboth сетевых интерфейсных плат (NIC) и виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="87317-136">DNS names can be assigned tooboth network interface cards (NICs) and virtual machines.</span></span> <span data-ttu-id="87317-137">Несмотря на то, что hello разрешении имен Azure не требует какой-либо настройки, это не hello правильный выбор для всех сценариев развертывания, как видно в предшествующей таблице hello.</span><span class="sxs-lookup"><span data-stu-id="87317-137">Although hello name resolution that Azure provides does not require any configuration, it is not hello appropriate choice for all deployment scenarios, as seen on hello preceding table.</span></span>

### <a name="features-and-considerations"></a><span data-ttu-id="87317-138">Функции и рекомендации</span><span class="sxs-lookup"><span data-stu-id="87317-138">Features and considerations</span></span>
<span data-ttu-id="87317-139">**Функции**</span><span class="sxs-lookup"><span data-stu-id="87317-139">**Features:**</span></span>

* <span data-ttu-id="87317-140">Ничего настраивать не требуется toouse разрешении имен Azure.</span><span class="sxs-lookup"><span data-stu-id="87317-140">No configuration is required toouse name resolution that Azure provides.</span></span>
* <span data-ttu-id="87317-141">Служба разрешения имен Hello, Azure предоставляет высокой доступности.</span><span class="sxs-lookup"><span data-stu-id="87317-141">hello name resolution service that Azure provides is highly available.</span></span> <span data-ttu-id="87317-142">Не нужны toocreate и управление кластерами серверов DNS.</span><span class="sxs-lookup"><span data-stu-id="87317-142">You don't need toocreate and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="87317-143">Служба разрешения имен Hello, Azure предоставляет может использоваться вместе с собственного tooresolve серверами DNS как локальной, так и имена узлов Azure.</span><span class="sxs-lookup"><span data-stu-id="87317-143">hello name resolution service that Azure provides can be used along with your own DNS servers tooresolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="87317-144">Разрешение имен обеспечивается между виртуальными машинами в виртуальной сети без необходимости hello полное доменное имя.</span><span class="sxs-lookup"><span data-stu-id="87317-144">Name resolution is provided between virtual machines in virtual networks without need for hello FQDN.</span></span>
* <span data-ttu-id="87317-145">Вместо использования автоматически создаваемых имен узлов вы можете создавать имена, которые наиболее точно описывают ваши развертывания.</span><span class="sxs-lookup"><span data-stu-id="87317-145">You can use hostnames that best describe your deployments rather than working with auto-generated names.</span></span>

<span data-ttu-id="87317-146">**Рекомендации**</span><span class="sxs-lookup"><span data-stu-id="87317-146">**Considerations:**</span></span>

* <span data-ttu-id="87317-147">Невозможно изменить Hello DNS-суффикс, который создается в Azure.</span><span class="sxs-lookup"><span data-stu-id="87317-147">hello DNS suffix that Azure creates cannot be modified.</span></span>
* <span data-ttu-id="87317-148">Собственные записи нельзя регистрировать вручную.</span><span class="sxs-lookup"><span data-stu-id="87317-148">You cannot manually register your own records.</span></span>
* <span data-ttu-id="87317-149">WINS и NetBIOS не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="87317-149">WINS and NetBIOS are not supported.</span></span>
* <span data-ttu-id="87317-150">Имена узлов должны быть DNS-совместимыми.</span><span class="sxs-lookup"><span data-stu-id="87317-150">Hostnames must be DNS-compatible.</span></span>
    <span data-ttu-id="87317-151">Они могут содержать только символы 0–9, a–z и "-" и не могут начинаться или заканчиваться на "-".</span><span class="sxs-lookup"><span data-stu-id="87317-151">Names must use only 0-9, a-z, and '-', and they cannot start or end with a '-'.</span></span> <span data-ttu-id="87317-152">См. раздел 2 RFC 3696.</span><span class="sxs-lookup"><span data-stu-id="87317-152">See RFC 3696 Section 2.</span></span>
* <span data-ttu-id="87317-153">Трафик запросов DNS регулируется для каждой виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="87317-153">DNS query traffic is throttled for each virtual machine.</span></span> <span data-ttu-id="87317-154">Регулирование не должно влиять на большинство приложений.</span><span class="sxs-lookup"><span data-stu-id="87317-154">Throttling shouldn't impact most applications.</span></span>  <span data-ttu-id="87317-155">Если наблюдается регулирование запросов, проверьте, включено ли кэширование на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="87317-155">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="87317-156">Дополнительные сведения см. в разделе [начало hello большинство с разрешением имен, Azure предоставляет](#getting-the-most-from-name-resolution-that-azure-provides).</span><span class="sxs-lookup"><span data-stu-id="87317-156">For more information, see [Getting hello most from name resolution that Azure provides](#getting-the-most-from-name-resolution-that-azure-provides).</span></span>

### <a name="getting-hello-most-from-name-resolution-that-azure-provides"></a><span data-ttu-id="87317-157">Начало с разрешением имен, Azure предоставляет большинство hello</span><span class="sxs-lookup"><span data-stu-id="87317-157">Getting hello most from name resolution that Azure provides</span></span>
<span data-ttu-id="87317-158">**Кэширование на стороне клиента**</span><span class="sxs-lookup"><span data-stu-id="87317-158">**Client-side caching:**</span></span>

<span data-ttu-id="87317-159">Некоторые запросы не передаются по сети hello.</span><span class="sxs-lookup"><span data-stu-id="87317-159">Some DNS queries are not sent across hello network.</span></span> <span data-ttu-id="87317-160">Кэширование на стороне клиента помогает уменьшить задержку и повышения устойчивости toonetwork несоответствий, разрешая периодические запросы DNS из локального кэша.</span><span class="sxs-lookup"><span data-stu-id="87317-160">Client-side caching helps reduce latency and improve resilience toonetwork inconsistencies by resolving recurring DNS queries from a local cache.</span></span> <span data-ttu-id="87317-161">DNS-записи содержат срока жизни (TTL), позволяющий запись hello toostore hello кэша в течение без ущерба для записей актуальность.</span><span class="sxs-lookup"><span data-stu-id="87317-161">DNS records contain a Time-To-Live (TTL), which enables hello cache toostore hello record for as long as possible without impacting record freshness.</span></span> <span data-ttu-id="87317-162">Следовательно, кэширование на стороне клиента подходит для большинства ситуаций.</span><span class="sxs-lookup"><span data-stu-id="87317-162">As a result, client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="87317-163">В некоторых дистрибутивах Linux возможность кэширования не включена по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="87317-163">Some Linux distributions do not include caching by default.</span></span> <span data-ttu-id="87317-164">Рекомендуется добавлять виртуальные машины Linux tooeach кэша после проверки того, что не существует локального кэша уже.</span><span class="sxs-lookup"><span data-stu-id="87317-164">We recommend that you add a cache tooeach Linux virtual machine after you check that there isn't a local cache already.</span></span>

<span data-ttu-id="87317-165">Существует несколько разных пакетов кэширования DNS, например dnsmasq.</span><span class="sxs-lookup"><span data-stu-id="87317-165">Several different DNS caching packages, such as dnsmasq, are available.</span></span> <span data-ttu-id="87317-166">Ниже приведены dnsmasq tooinstall действия hello в наиболее распространенных распределениях hello.</span><span class="sxs-lookup"><span data-stu-id="87317-166">Here are hello steps tooinstall dnsmasq on hello most common distributions:</span></span>

<span data-ttu-id="87317-167">**Ubuntu (используется пакет resolvconf)**</span><span class="sxs-lookup"><span data-stu-id="87317-167">**Ubuntu (uses resolvconf)**</span></span>
  * <span data-ttu-id="87317-168">Установите пакет dnsmasq hello («sudo установки apt get dnsmasq»).</span><span class="sxs-lookup"><span data-stu-id="87317-168">Install hello dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>

<span data-ttu-id="87317-169">**SUSE (используется пакет netconf)**:</span><span class="sxs-lookup"><span data-stu-id="87317-169">**SUSE (uses netconf)**:</span></span>
1. <span data-ttu-id="87317-170">Установите пакет dnsmasq hello («sudo zypper установки dnsmasq»).</span><span class="sxs-lookup"><span data-stu-id="87317-170">Install hello dnsmasq package (“sudo zypper install dnsmasq”).</span></span>
2. <span data-ttu-id="87317-171">Включите службу hello dnsmasq («systemctl enable dnsmasq.service»).</span><span class="sxs-lookup"><span data-stu-id="87317-171">Enable hello dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="87317-172">Запустите службу hello dnsmasq («systemctl начала dnsmasq.service»).</span><span class="sxs-lookup"><span data-stu-id="87317-172">Start hello dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="87317-173">Изменить «/ и т. д/sysconfig / / конфигурация сети» и измените NETCONFIG_DNS_FORWARDER = "» слишком «dnsmasq».</span><span class="sxs-lookup"><span data-stu-id="87317-173">Edit “/etc/sysconfig/network/config”, and change NETCONFIG_DNS_FORWARDER="" too”dnsmasq”.</span></span>
5. <span data-ttu-id="87317-174">Обновите кэш hello («обновление netconfig») tooset хоста как hello локального разрешения имен DNS.</span><span class="sxs-lookup"><span data-stu-id="87317-174">Update resolv.conf ("netconfig update") tooset hello cache as hello local DNS resolver.</span></span>

<span data-ttu-id="87317-175">**CentOS от Rogue Wave Software (прежнее название — OpenLogic; использует NetworkManager)**</span><span class="sxs-lookup"><span data-stu-id="87317-175">**CentOS by Rogue Wave Software (formerly OpenLogic; uses NetworkManager)**</span></span>
1. <span data-ttu-id="87317-176">Установите пакет dnsmasq hello («sudo yum установки dnsmasq»).</span><span class="sxs-lookup"><span data-stu-id="87317-176">Install hello dnsmasq package (“sudo yum install dnsmasq”).</span></span>
2. <span data-ttu-id="87317-177">Включите службу hello dnsmasq («systemctl enable dnsmasq.service»).</span><span class="sxs-lookup"><span data-stu-id="87317-177">Enable hello dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="87317-178">Запустите службу hello dnsmasq («systemctl начала dnsmasq.service»).</span><span class="sxs-lookup"><span data-stu-id="87317-178">Start hello dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="87317-179">Добавьте «добавить серверы доменных имен 127.0.0.1;» too"/etc/dhclient-eth0.conf».</span><span class="sxs-lookup"><span data-stu-id="87317-179">Add “prepend domain-name-servers 127.0.0.1;” too“/etc/dhclient-eth0.conf”.</span></span>
5. <span data-ttu-id="87317-180">Перезагрузить кэш hello сетевой службы («сеть перезапуска службы») tooset hello hello локального разрешения имен DNS</span><span class="sxs-lookup"><span data-stu-id="87317-180">Restart hello network service (“service network restart”) tooset hello cache as hello local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="87317-181">: hello «dnsmasq» пакета используется только одно из hello кэширует много DNS, которые доступны для Linux.</span><span class="sxs-lookup"><span data-stu-id="87317-181">: hello 'dnsmasq' package is only one of hello many DNS caches that are available for Linux.</span></span> <span data-ttu-id="87317-182">Перед его использованием проверьте, соответствует ли он вашим потребностям, а также не установлен ли у вас другой кэш.</span><span class="sxs-lookup"><span data-stu-id="87317-182">Before you use it, check its suitability for your needs and that no other cache is installed.</span></span>
>
>

<span data-ttu-id="87317-183">**Повторные попытки на стороне клиента**</span><span class="sxs-lookup"><span data-stu-id="87317-183">**Client-side retries**</span></span>

<span data-ttu-id="87317-184">DNS использует преимущественно протокол UDP.</span><span class="sxs-lookup"><span data-stu-id="87317-184">DNS is primarily a UDP protocol.</span></span> <span data-ttu-id="87317-185">Так как hello протокол UDP не гарантирует доставку сообщений, hello сам протокол DNS обрабатывает логику повторных попыток.</span><span class="sxs-lookup"><span data-stu-id="87317-185">Because hello UDP protocol doesn't guarantee message delivery, hello DNS protocol itself handles retry logic.</span></span> <span data-ttu-id="87317-186">Каждый DNS-клиента (операционная система) можно достичь логика повторов разные в зависимости от предпочтений hello создатель:</span><span class="sxs-lookup"><span data-stu-id="87317-186">Each DNS client (operating system) can exhibit different retry logic depending on hello creator's preference:</span></span>

* <span data-ttu-id="87317-187">ОС Windows выполняет повторную попытку через одну секунду, затем через две и четыре, а затем снова через четыре секунды.</span><span class="sxs-lookup"><span data-stu-id="87317-187">Windows operating systems retry after one second and then again after another two, four, and another four seconds.</span></span>
* <span data-ttu-id="87317-188">повторные попытки установки Linux по умолчанию Hello через пять секунд.</span><span class="sxs-lookup"><span data-stu-id="87317-188">hello default Linux setup retries after five seconds.</span></span>  <span data-ttu-id="87317-189">Необходимо изменить этот tooretry пять раз интервалы одну секунду.</span><span class="sxs-lookup"><span data-stu-id="87317-189">You should change this tooretry five times at one-second intervals.</span></span>  

<span data-ttu-id="87317-190">toocheck hello текущие параметры на виртуальной машине Linux «кошка /etc/resolv.conf» и посмотрите на строку «параметры» hello, например:</span><span class="sxs-lookup"><span data-stu-id="87317-190">toocheck hello current settings on a Linux virtual machine, 'cat /etc/resolv.conf', and look at hello 'options' line, for example:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="87317-191">Hello хоста файл создан автоматически и не следует изменять.</span><span class="sxs-lookup"><span data-stu-id="87317-191">hello resolv.conf file is auto-generated and should not be edited.</span></span> <span data-ttu-id="87317-192">Здравствуйте, конкретные действия, которые добавить hello «параметры» строки различаются в зависимости от распределения:</span><span class="sxs-lookup"><span data-stu-id="87317-192">hello specific steps that add hello 'options' line vary by distribution:</span></span>

<span data-ttu-id="87317-193">**Ubuntu** (используется пакет resolvconf)</span><span class="sxs-lookup"><span data-stu-id="87317-193">**Ubuntu** (uses resolvconf)</span></span>
1. <span data-ttu-id="87317-194">Добавить too'/etc/resolveconf/resolv.conf.d/head строку hello параметры ".</span><span class="sxs-lookup"><span data-stu-id="87317-194">Add hello options line too'/etc/resolveconf/resolv.conf.d/head'.</span></span>
2. <span data-ttu-id="87317-195">Запустите tooupdate «resolvconf -u».</span><span class="sxs-lookup"><span data-stu-id="87317-195">Run 'resolvconf -u' tooupdate.</span></span>

<span data-ttu-id="87317-196">**SUSE** (используется пакет netconf)</span><span class="sxs-lookup"><span data-stu-id="87317-196">**SUSE** (uses netconf)</span></span>
1. <span data-ttu-id="87317-197">Добавить toohello 'timeout:1 попыток: 5' NETCONFIG_DNS_RESOLVER_OPTIONS = "» параметра в «/ и т. д/sysconfig / / конфигурация сети».</span><span class="sxs-lookup"><span data-stu-id="87317-197">Add 'timeout:1 attempts:5' toohello NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'.</span></span>
2. <span data-ttu-id="87317-198">Запустите tooupdate «netconfig обновления».</span><span class="sxs-lookup"><span data-stu-id="87317-198">Run 'netconfig update' tooupdate.</span></span>

<span data-ttu-id="87317-199">**CentOS от Rogue Wave Software (прежнее название — OpenLogic**; использует NetworkManager)</span><span class="sxs-lookup"><span data-stu-id="87317-199">**CentOS by Rogue Wave Software (formerly OpenLogic)** (uses NetworkManager)</span></span>
1. <span data-ttu-id="87317-200">Добавить too'/etc/NetworkManager/dispatcher.d/11-dhclient «echo «параметры timeout:1 попыток: 5»» ".</span><span class="sxs-lookup"><span data-stu-id="87317-200">Add 'echo "options timeout:1 attempts:5"' too'/etc/NetworkManager/dispatcher.d/11-dhclient'.</span></span>
2. <span data-ttu-id="87317-201">Запустите tooupdate «перезапуск службы сети».</span><span class="sxs-lookup"><span data-stu-id="87317-201">Run 'service network restart' tooupdate.</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="87317-202">разрешение имен с помощью собственного DNS-сервера.</span><span class="sxs-lookup"><span data-stu-id="87317-202">Name resolution using your own DNS server</span></span>
<span data-ttu-id="87317-203">Ваших потребностей разрешения имен может выйти за рамки hello функций, предоставляемых Azure.</span><span class="sxs-lookup"><span data-stu-id="87317-203">Your name resolution needs may go beyond hello features that Azure provides.</span></span> <span data-ttu-id="87317-204">Например, может требоваться разрешение DNS-имен между виртуальными сетями.</span><span class="sxs-lookup"><span data-stu-id="87317-204">For example, you might require DNS resolution between virtual networks.</span></span> <span data-ttu-id="87317-205">toocover этот сценарий можно использовать DNS-серверы.</span><span class="sxs-lookup"><span data-stu-id="87317-205">toocover this scenario, you can use your own DNS servers.</span></span>  

<span data-ttu-id="87317-206">DNS-серверы в пределах прямой DNS запрашивает toorecursive специалисты по разрешению имен узлов Azure tooresolve может виртуальной сети, которые в hello одной виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="87317-206">DNS servers within a virtual network can forward DNS queries toorecursive resolvers of Azure tooresolve hostnames that are in hello same virtual network.</span></span> <span data-ttu-id="87317-207">Например DNS-сервер, который работает в Azure может отвечать запросы tooDNS свой собственный DNS для зон файлы и пересылать все другие tooAzure запросов.</span><span class="sxs-lookup"><span data-stu-id="87317-207">For example, a DNS server that runs in Azure can respond tooDNS queries for its own DNS zone files and forward all other queries tooAzure.</span></span> <span data-ttu-id="87317-208">Эти возможности позволяют toosee виртуальные машины в обеих записей в зоне файлов и имена узлов, которые предоставляет Azure (через сервер пересылки hello).</span><span class="sxs-lookup"><span data-stu-id="87317-208">This functionality enables virtual machines toosee both your entries in your zone files and hostnames that Azure provides (via hello forwarder).</span></span> <span data-ttu-id="87317-209">Распознаватели рекурсивные toohello доступ из Azure обеспечивается за счет hello виртуального IP-адреса 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="87317-209">Access toohello recursive resolvers of Azure is provided via hello virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="87317-210">Перенаправление запросов DNS также позволяет разрешение DNS между виртуальными сетями, а вашей локальной машины tooresolve имена узлов, которые предоставляет Azure.</span><span class="sxs-lookup"><span data-stu-id="87317-210">DNS forwarding also enables DNS resolution between virtual networks and enables your on-premises machines tooresolve hostnames that Azure provides.</span></span> <span data-ttu-id="87317-211">tooresolve имя узла виртуальной машины, виртуальную машину hello DNS server должен находиться в hello одной виртуальной сети и быть tooAzure запросы настроенных tooforward имя узла.</span><span class="sxs-lookup"><span data-stu-id="87317-211">tooresolve a virtual machine's hostname, hello DNS server virtual machine must reside in hello same virtual network and be configured tooforward hostname queries tooAzure.</span></span> <span data-ttu-id="87317-212">Из-за hello DNS-суффикс в каждой виртуальной сети, можно использовать условное перенаправление правила toosend DNS запрашивает toohello исправить виртуальной сети для разрешения.</span><span class="sxs-lookup"><span data-stu-id="87317-212">Because hello DNS suffix is different in each virtual network, you can use conditional forwarding rules toosend DNS queries toohello correct virtual network for resolution.</span></span> <span data-ttu-id="87317-213">Hello следующем рисунке показаны две виртуальные сети и локальной сетью, выполнив разрешение DNS между виртуальными сетями с помощью этого метода:</span><span class="sxs-lookup"><span data-stu-id="87317-213">hello following image shows two virtual networks and an on-premises network doing DNS resolution between virtual networks by using this method:</span></span>

![Разрешение DNS между виртуальными сетями](./media/azure-dns/inter-vnet-dns.png)

<span data-ttu-id="87317-215">При использовании разрешения имен, Azure предоставляет внутренние DNS-суффикс hello предоставляется tooeach виртуальной машины с помощью DHCP.</span><span class="sxs-lookup"><span data-stu-id="87317-215">When you use name resolution that Azure provides, hello internal DNS suffix is provided tooeach virtual machine by using DHCP.</span></span> <span data-ttu-id="87317-216">При использовании собственного решения разрешение имени этот суффикс не предоставленного toovirtual машины так как суффикс hello мешает других архитектур DNS.</span><span class="sxs-lookup"><span data-stu-id="87317-216">When you use your own name resolution solution, this suffix is not supplied toovirtual machines because hello suffix interferes with other DNS architectures.</span></span> <span data-ttu-id="87317-217">toomachines toorefer полное доменное имя или tooconfigure суффикс hello на виртуальных машинах, можно использовать PowerShell или hello суффикс hello toodetermine API:</span><span class="sxs-lookup"><span data-stu-id="87317-217">toorefer toomachines by FQDN or tooconfigure hello suffix on your virtual machines, you can use PowerShell or hello API toodetermine hello suffix:</span></span>

* <span data-ttu-id="87317-218">Для виртуальных сетей, которые управляются диспетчером ресурсов Azure, суффикс hello доступна через hello [сетевой адаптер](https://msdn.microsoft.com/library/azure/mt163668.aspx) ресурсов.</span><span class="sxs-lookup"><span data-stu-id="87317-218">For virtual networks that are managed by Azure Resource Manager, hello suffix is available via hello [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource.</span></span> <span data-ttu-id="87317-219">Можно также запустить hello `azure network public-ip show <resource group> <pip name>` команда toodisplay hello сведения о вашей общедоступный IP-адрес, который включает hello полное доменное имя hello сетевого адаптера.</span><span class="sxs-lookup"><span data-stu-id="87317-219">You can also run hello `azure network public-ip show <resource group> <pip name>` command toodisplay hello details of your public IP, which includes hello FQDN of hello NIC.</span></span>

<span data-ttu-id="87317-220">Если пересылка запросов tooAzure не подходят, tooprovide необходимо собственное решение DNS.</span><span class="sxs-lookup"><span data-stu-id="87317-220">If forwarding queries tooAzure doesn't suit your needs, you need tooprovide your own DNS solution.</span></span>  <span data-ttu-id="87317-221">Ваше решение DNS должно:</span><span class="sxs-lookup"><span data-stu-id="87317-221">Your DNS solution needs to:</span></span>

* <span data-ttu-id="87317-222">Предоставлять корректное разрешение имен, например, с помощью [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="87317-222">Provide appropriate hostname resolution, for example via [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span></span> <span data-ttu-id="87317-223">При использовании DDNS, может потребоваться очистки записей toodisable DNS.</span><span class="sxs-lookup"><span data-stu-id="87317-223">If you use DDNS, you might need toodisable DNS record scavenging.</span></span> <span data-ttu-id="87317-224">Время аренды DHCP в Azure очень долгое, и очистка может удалить записи DNS преждевременно.</span><span class="sxs-lookup"><span data-stu-id="87317-224">DHCP leases of Azure are very long and scavenging may remove DNS records prematurely.</span></span>
* <span data-ttu-id="87317-225">Укажите соответствующие рекурсивного разрешения tooallow разрешения внешних доменных имен.</span><span class="sxs-lookup"><span data-stu-id="87317-225">Provide appropriate recursive resolution tooallow resolution of external domain names.</span></span>
* <span data-ttu-id="87317-226">Быть доступны (TCP и UDP-порт 53) от клиентов hello, он выполняет и быть hello может tooaccess Интернета.</span><span class="sxs-lookup"><span data-stu-id="87317-226">Be accessible (TCP and UDP on port 53) from hello clients it serves and be able tooaccess hello Internet.</span></span>
* <span data-ttu-id="87317-227">Быть защищены от доступа из hello Internet toomitigate угрозы внешних агентов.</span><span class="sxs-lookup"><span data-stu-id="87317-227">Be secured against access from hello Internet toomitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="87317-228">Для повышения производительности при использовании виртуальных машин в Azure DNS-серверы, отключить протокол IPv6 и назначить [общедоступный IP-адрес уровня экземпляра](../../virtual-network/virtual-networks-instance-level-public-ip.md) tooeach DNS server виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="87317-228">For best performance, when you use virtual machines in Azure DNS servers, disable IPv6 and assign an [Instance-Level Public IP](../../virtual-network/virtual-networks-instance-level-public-ip.md) tooeach DNS server virtual machine.</span></span>  
>
>
