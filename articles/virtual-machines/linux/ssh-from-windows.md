---
title: "Использование ключей SSH для Windows для подключения к виртуальным машинам Linux | Документация Майкрософт"
description: "Узнайте, как создавать и использовать ключи SSH на компьютере Windows для подключения к виртуальной машине Linux в Azure."
services: virtual-machines-linux
documentationcenter: 
author: dlepow
manager: timlt
editor: 
tags: azure-service-management,azure-resource-manager
ms.assetid: 2cacda3b-7949-4036-bd5d-837e8b09a9c8
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 03/08/2017
ms.author: danlep
ms.openlocfilehash: 66837a3a153cda041f5351c52c8ccb1f8ccfea50
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="how-to-use-ssh-keys-with-windows-on-azure"></a><span data-ttu-id="d61c7-103">Использование ключей SSH с Windows в Azure</span><span class="sxs-lookup"><span data-stu-id="d61c7-103">How to Use SSH keys with Windows on Azure</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="d61c7-104">Windows</span><span class="sxs-lookup"><span data-stu-id="d61c7-104">Windows</span></span>](ssh-from-windows.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
> * [<span data-ttu-id="d61c7-105">Linux или Mac</span><span class="sxs-lookup"><span data-stu-id="d61c7-105">Linux/Mac</span></span>](mac-create-ssh-keys.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
>
>

<span data-ttu-id="d61c7-106">При подключении к виртуальным машинам Linux в Azure необходимо использовать [шифрование с открытым ключом](https://wikipedia.org/wiki/Public-key_cryptography), которое обеспечивает белее высокий уровень безопасности при входе на виртуальные машины Linux.</span><span class="sxs-lookup"><span data-stu-id="d61c7-106">When you connect to Linux virtual machines (VMs) in Azure, you should use [public-key cryptography](https://wikipedia.org/wiki/Public-key_cryptography) to provide a more secure way to log in to your Linux VM.</span></span> <span data-ttu-id="d61c7-107">Этот процесс предполагает обмен открытыми и закрытыми ключами с использованием команды Secure Shell (SSH), что позволяет аутентифицировать себя, не вводя имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="d61c7-107">This process involves a public and private key exchange using the secure shell (SSH) command to authenticate yourself rather than a username and password.</span></span> <span data-ttu-id="d61c7-108">Пароли подвержены атакам методом подбора, особенно на виртуальных машинах с подключением к Интернету, таких как веб-серверы.</span><span class="sxs-lookup"><span data-stu-id="d61c7-108">Passwords are vulnerable to brute-force attacks, especially on Internet-facing VMs such as web servers.</span></span> <span data-ttu-id="d61c7-109">В этой статье приведены общие сведения о ключах SSH, а также о том, как создать соответствующие ключи на компьютере Windows.</span><span class="sxs-lookup"><span data-stu-id="d61c7-109">This article provides an overview of SSH keys and how to generate the appropriate keys on a Windows computer.</span></span>

## <a name="overview-of-ssh-and-keys"></a><span data-ttu-id="d61c7-110">Общие сведения о SSH и ключах</span><span class="sxs-lookup"><span data-stu-id="d61c7-110">Overview of SSH and keys</span></span>
<span data-ttu-id="d61c7-111">На виртуальную машину Linux можно безопасно войти с использованием открытых и закрытых ключей.</span><span class="sxs-lookup"><span data-stu-id="d61c7-111">You can securely log in to your Linux VM by using public and private keys:</span></span>

* <span data-ttu-id="d61c7-112">**Открытый ключ** хранится на виртуальной машине Linux или в любой другой службе, для которой требуется шифрование с открытым ключом.</span><span class="sxs-lookup"><span data-stu-id="d61c7-112">The **public key** is placed on your Linux VM, or any other service that you wish to use with public-key cryptography.</span></span>
* <span data-ttu-id="d61c7-113">**Закрытый ключ** предоставляется виртуальной машине Linux при входе в систему для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d61c7-113">The **private key** is what you present to your Linux VM when you log in, to verify your identity.</span></span> <span data-ttu-id="d61c7-114">Его нужно защищать</span><span class="sxs-lookup"><span data-stu-id="d61c7-114">Protect this private key.</span></span> <span data-ttu-id="d61c7-115">и нельзя никому предоставлять.</span><span class="sxs-lookup"><span data-stu-id="d61c7-115">Do not share it.</span></span>

<span data-ttu-id="d61c7-116">Открытые и закрытые ключи можно использовать на нескольких виртуальных машинах или в нескольких службах.</span><span class="sxs-lookup"><span data-stu-id="d61c7-116">These public and private keys can be used on multiple VMs and services.</span></span> <span data-ttu-id="d61c7-117">Не нужно выделять пару ключей для каждой виртуальной машины или службы, к которой необходим доступ.</span><span class="sxs-lookup"><span data-stu-id="d61c7-117">You do not need a pair of keys for each VM or service you wish to access.</span></span> <span data-ttu-id="d61c7-118">Дополнительные сведения о шифровании с открытым ключом см. [здесь](https://wikipedia.org/wiki/Public-key_cryptography).</span><span class="sxs-lookup"><span data-stu-id="d61c7-118">For a more detailed overview, see [public-key cryptography](https://wikipedia.org/wiki/Public-key_cryptography).</span></span>

<span data-ttu-id="d61c7-119">SSH — это протокол зашифрованного подключения, позволяющий безопасно входить в систему через незащищенные соединения.</span><span class="sxs-lookup"><span data-stu-id="d61c7-119">SSH is an encrypted connection protocol that allows secure logins over unsecured connections.</span></span> <span data-ttu-id="d61c7-120">Это протокол подключения по умолчанию для виртуальных машин Linux, размещенных в Azure.</span><span class="sxs-lookup"><span data-stu-id="d61c7-120">It is the default connection protocol for Linux VMs hosted in Azure.</span></span> <span data-ttu-id="d61c7-121">Хотя протокол SSH и обеспечивает зашифрованное подключение, при использовании соединений SSH пароль виртуальной машины все равно не защищен от атак методом подбора.</span><span class="sxs-lookup"><span data-stu-id="d61c7-121">Although SSH itself provides an encrypted connection, using passwords with SSH connections still leaves the VM vulnerable to brute-force attacks or guessing of passwords.</span></span> <span data-ttu-id="d61c7-122">Более безопасный и предпочтительный метод подключения к виртуальной машине по протоколу SSH заключается в использовании открытых и закрытых ключей, также известных как ключи SSH.</span><span class="sxs-lookup"><span data-stu-id="d61c7-122">A more secure and preferred method of connecting to a VM using SSH is by using these public and private keys, also known as SSH keys.</span></span>

<span data-ttu-id="d61c7-123">Если вам не нужно использовать эти ключи для входа на виртуальную машину Linux, можно по-прежнему использовать пароль.</span><span class="sxs-lookup"><span data-stu-id="d61c7-123">If you do not wish to use SSH keys, you can still log in to your Linux VMs using a password.</span></span> <span data-ttu-id="d61c7-124">Этого достаточно для виртуальных машин без интернет-доступа.</span><span class="sxs-lookup"><span data-stu-id="d61c7-124">If your VM is not exposed to the Internet, using passwords may be sufficient.</span></span> <span data-ttu-id="d61c7-125">Но пользователь по-прежнему должен управлять паролями каждой своей виртуальной машины, а также вводить соответствующие политики паролей и предоставлять рекомендации, к примеру, в отношении минимальной длины паролей и частоты их обновления.</span><span class="sxs-lookup"><span data-stu-id="d61c7-125">However, you still need to manage your passwords for each Linux VM and maintain healthy password policies and practices, such as minimum password length and regularly updating them.</span></span> <span data-ttu-id="d61c7-126">Использование ключей SSH упрощает управление отдельными учетными данными на нескольких виртуальных машинах.</span><span class="sxs-lookup"><span data-stu-id="d61c7-126">The use of SSH keys reduces the complexity of managing individual credentials across multiple VMs.</span></span>

## <a name="windows-packages-and-ssh-clients"></a><span data-ttu-id="d61c7-127">Пакеты Windows и SSH-клиенты</span><span class="sxs-lookup"><span data-stu-id="d61c7-127">Windows packages and SSH clients</span></span>
<span data-ttu-id="d61c7-128">Пользователи могут подключаться к виртуальным машинам Linux в Azure и управлять ими с помощью **SSH-клиента**.</span><span class="sxs-lookup"><span data-stu-id="d61c7-128">You connect to and manage Linux VMs in Azure using an **SSH client**.</span></span> <span data-ttu-id="d61c7-129">Но на компьютерах Windows, как правило, SSH-клиент не установлен.</span><span class="sxs-lookup"><span data-stu-id="d61c7-129">Windows computers do not typically have an SSH client installed.</span></span> <span data-ttu-id="d61c7-130">В юбилейном обновлении Windows 10 добавлен компонент Bash для Windows, а последняя версия Windows 10 Creators Update содержит дополнительные обновления.</span><span class="sxs-lookup"><span data-stu-id="d61c7-130">The Windows 10 Anniversary Update added Bash for Windows, and the latest Windows 10 Creators Update provides additional updates.</span></span> <span data-ttu-id="d61c7-131">Эта подсистема Windows для Linux позволяет запускать и использовать такие служебные программы, как SSH-клиент, в собственной оболочке Bash.</span><span class="sxs-lookup"><span data-stu-id="d61c7-131">This Windows Subsystem for Linux allows you to run and access utilities such as an SSH client natively within a Bash shell.</span></span> <span data-ttu-id="d61c7-132">Это позволяет выполнять инструкции из любой документации по Linux, например из раздела [Как создать и использовать пару из открытого и закрытого ключей SSH для виртуальных машин Linux в Azure](mac-create-ssh-keys.md).</span><span class="sxs-lookup"><span data-stu-id="d61c7-132">You can then follow any of the Linux docs, such as [How to generate SSH key pairs for Linux](mac-create-ssh-keys.md).</span></span> <span data-ttu-id="d61c7-133">Bash для Windows находится на стадии разработки, и сейчас доступен бета-выпуск.</span><span class="sxs-lookup"><span data-stu-id="d61c7-133">Bash for Windows is still under development, and is considered a beta release.</span></span> <span data-ttu-id="d61c7-134">Дополнительные сведения о Bash для Windows см. в записи блога [Bash on Ubuntu on Windows](https://msdn.microsoft.com/commandline/wsl/about) (Bash для Ubuntu в Windows).</span><span class="sxs-lookup"><span data-stu-id="d61c7-134">For more information about Bash for Windows, see [Bash on Ubuntu on Windows](https://msdn.microsoft.com/commandline/wsl/about).</span></span>

<span data-ttu-id="d61c7-135">Если вы хотите использовать не Bash для Windows, а другой инструмент, то можете установить общие SSH-клиенты Windows, включенные в следующие пакеты:</span><span class="sxs-lookup"><span data-stu-id="d61c7-135">If you wish to use something other than Bash for Windows, common Windows SSH clients you can install are included in the following packages:</span></span>

* <span data-ttu-id="d61c7-136">[Git для Windows](https://git-for-windows.github.io/);</span><span class="sxs-lookup"><span data-stu-id="d61c7-136">[Git For Windows](https://git-for-windows.github.io/)</span></span>
* <span data-ttu-id="d61c7-137">[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/);</span><span class="sxs-lookup"><span data-stu-id="d61c7-137">[puTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)</span></span>
* [<span data-ttu-id="d61c7-138">MobaXterm</span><span class="sxs-lookup"><span data-stu-id="d61c7-138">MobaXterm</span></span>](http://mobaxterm.mobatek.net/)
* [<span data-ttu-id="d61c7-139">Cygwin</span><span class="sxs-lookup"><span data-stu-id="d61c7-139">Cygwin</span></span>](https://cygwin.com/)


## <a name="which-key-files-do-you-need-to-create"></a><span data-ttu-id="d61c7-140">Какие файлы ключей необходимо создать?</span><span class="sxs-lookup"><span data-stu-id="d61c7-140">Which key files do you need to create?</span></span>
<span data-ttu-id="d61c7-141">В Azure необходимо использовать по крайней 2048-разрядные открытые и закрытые ключи в формате **ssh-rsa**.</span><span class="sxs-lookup"><span data-stu-id="d61c7-141">Azure requires at least 2048-bit, **ssh-rsa** formatted public and private keys.</span></span> <span data-ttu-id="d61c7-142">Если для управления ресурсами Azure используется классическая модель развертывания, также необходимо создать ключ формата PEM (`.pem`-файла).</span><span class="sxs-lookup"><span data-stu-id="d61c7-142">If you are managing Azure resources using the Classic deployment model, you also need to generate a PEM (`.pem` file).</span></span>

<span data-ttu-id="d61c7-143">Ниже приведены сценарии развертывания и типы используемых в них файлов.</span><span class="sxs-lookup"><span data-stu-id="d61c7-143">Here are the deployment scenarios, and the types of files you use in each:</span></span>

1. <span data-ttu-id="d61c7-144">Ключи **ssh-rsa** нужны для любого развертывания с использованием [портала Azure](https://portal.azure.com), а также для развертываний Resource Manager с помощью [интерфейса командной строки Azure](../../cli-install-nodejs.md).</span><span class="sxs-lookup"><span data-stu-id="d61c7-144">**ssh-rsa** keys are required for any deployment using the [Azure portal](https://portal.azure.com), and Resource Manager deployments using the [Azure CLI](../../cli-install-nodejs.md).</span></span>
   * <span data-ttu-id="d61c7-145">Обычно эти ключи нужны большинству пользователей.</span><span class="sxs-lookup"><span data-stu-id="d61c7-145">These keys are usually all most people need.</span></span>
2. <span data-ttu-id="d61c7-146">`.pem`-файл нужен для создания виртуальных машин с помощью классической модели развертывания.</span><span class="sxs-lookup"><span data-stu-id="d61c7-146">A `.pem` file is required to create VMs using the Classic deployment.</span></span> <span data-ttu-id="d61c7-147">Эти ключи поддерживаются в классической модели развертывания при использовании [портала Azure](https://portal.azure.com) или [Azure CLI](../../cli-install-nodejs.md).</span><span class="sxs-lookup"><span data-stu-id="d61c7-147">These keys are supported in Classic deployments when using the [Azure portal](https://portal.azure.com) or [Azure CLI](../../cli-install-nodejs.md).</span></span>
   * <span data-ttu-id="d61c7-148">Дополнительные ключи и сертификаты нужно создавать только для управления ресурсами, созданными с использованием классической модели развертывания.</span><span class="sxs-lookup"><span data-stu-id="d61c7-148">You only need to create these additional keys and certificates if you are managing resources created using the Classic deployment model.</span></span>

## <a name="install-git-for-windows"></a><span data-ttu-id="d61c7-149">Установка Git для Windows</span><span class="sxs-lookup"><span data-stu-id="d61c7-149">Install Git for Windows</span></span>
<span data-ttu-id="d61c7-150">В предыдущем разделе указаны несколько пакетов, содержащих средство `openssl` для Windows.</span><span class="sxs-lookup"><span data-stu-id="d61c7-150">The preceding section listed several packages that include the `openssl` tool for Windows.</span></span> <span data-ttu-id="d61c7-151">Это средство используется для создания открытых и закрытых ключей.</span><span class="sxs-lookup"><span data-stu-id="d61c7-151">This tool is needed to create public and private keys.</span></span> <span data-ttu-id="d61c7-152">В следующих примерах приведены инструкции по установке и использованию средства **Git для Windows**, но вы можете использовать любой из указанных пакетов.</span><span class="sxs-lookup"><span data-stu-id="d61c7-152">The following examples detail how to install and use **Git for Windows**, though you can choose whichever package you prefer.</span></span> <span data-ttu-id="d61c7-153">**Git для Windows** предоставляет доступ к дополнительным средствам и служебным программам с открытым кодом ([OSS](https://en.wikipedia.org/wiki/Open-source_software)), полезным при работе с виртуальными машинами Linux.</span><span class="sxs-lookup"><span data-stu-id="d61c7-153">**Git for Windows** gives you access to some additional open-source software ([OSS](https://en.wikipedia.org/wiki/Open-source_software)) tools and utilities that may be useful as you work with Linux VMs.</span></span>

1. <span data-ttu-id="d61c7-154">Скачайте **Git для Windows** по адресу [https://git-for-windows.github.io/](https://git-for-windows.github.io/) и установите его.</span><span class="sxs-lookup"><span data-stu-id="d61c7-154">Download and install **Git for Windows** from the following location: [https://git-for-windows.github.io/](https://git-for-windows.github.io/).</span></span>
2. <span data-ttu-id="d61c7-155">Во время установки примите параметры по умолчанию (при необходимости их можно изменить).</span><span class="sxs-lookup"><span data-stu-id="d61c7-155">Accept the default options during the install process unless you specifically need to change them.</span></span>
3. <span data-ttu-id="d61c7-156">Запустите**Git Bash** (**меню "Пуск"** > **Git** > **Git Bash**).</span><span class="sxs-lookup"><span data-stu-id="d61c7-156">Run **Git Bash** from the **Start Menu** > **Git** > **Git Bash**.</span></span> <span data-ttu-id="d61c7-157">Консоль будет выглядеть примерно следующим образом:</span><span class="sxs-lookup"><span data-stu-id="d61c7-157">The console looks similar to the following example:</span></span>

    ![Оболочка Bash Git для Windows](./media/ssh-from-windows/git-bash-window.png)

## <a name="create-a-private-key"></a><span data-ttu-id="d61c7-159">Создание закрытого ключа</span><span class="sxs-lookup"><span data-stu-id="d61c7-159">Create a private key</span></span>
1. <span data-ttu-id="d61c7-160">В окне **Git Bash** используйте `openssl.exe`, чтобы создать закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="d61c7-160">In your **Git Bash** window, use `openssl.exe` to create a private key.</span></span> <span data-ttu-id="d61c7-161">В следующем примере создается ключ с именем `myPrivateKey` и сертификат `myCert.pem`.</span><span class="sxs-lookup"><span data-stu-id="d61c7-161">The following example creates a key named `myPrivateKey` and certificate named `myCert.pem`:</span></span>

    ```bash
    openssl.exe req -x509 -nodes -days 365 -newkey rsa:2048 \
        -keyout myPrivateKey.key -out myCert.pem
    ```

    <span data-ttu-id="d61c7-162">Результат должен быть аналогичным приведенному ниже:</span><span class="sxs-lookup"><span data-stu-id="d61c7-162">The output looks similar to the following example:</span></span>

    ```bash
    Generating a 2048 bit RSA private key
    .......................................+++
    .......................+++
    writing new private key to 'myPrivateKey.key'
    -----
    You are about to be asked to enter information that will be incorporated
    into your certificate request.
    What you are about to enter is what is called a Distinguished Name or a DN.
    There are quite a few fields but you can leave some blank
    For some fields there will be a default value,
    If you enter '.', the field will be left blank.
    -----
    Country Name (2 letter code) [AU]:
    ```

   <span data-ttu-id="d61c7-163">Если bash сообщает об ошибке, попробуйте открыть новое окно **Git Bash** с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="d61c7-163">If bash reports an error, try opening a new **Git Bash** window with elevated privileges.</span></span> <span data-ttu-id="d61c7-164">Затем повторно выполните команду `openssl`.</span><span class="sxs-lookup"><span data-stu-id="d61c7-164">Then, rerun the `openssl` command.</span></span>

2. <span data-ttu-id="d61c7-165">В ответ на запросы укажите название страны, расположение, название организации и т. д.</span><span class="sxs-lookup"><span data-stu-id="d61c7-165">Answer the prompts for country name, location, organization name, etc.</span></span>
3. <span data-ttu-id="d61c7-166">Новый закрытый ключ и сертификат будут созданы в текущей рабочей папке.</span><span class="sxs-lookup"><span data-stu-id="d61c7-166">Your new private key and certificate are created in your current working directory.</span></span> <span data-ttu-id="d61c7-167">В целях обеспечения безопасности, чтобы у посторонних пользователей не было доступа к закрытому ключу, для него необходимо задать разрешения.</span><span class="sxs-lookup"><span data-stu-id="d61c7-167">As a security measure, you should set the permissions on your private key so that only you can access it:</span></span>

    ```bash
    chmod 0600 myPrivateKey.key
    ```

4. <span data-ttu-id="d61c7-168">В [следующем разделе](#create-a-private-key-for-putty) представлены сведения о просмотре и использовании открытого ключа с помощью PuTTYgen, а также о создании закрытого ключа для подключения к виртуальной машине Linux по протоколу SSH с помощью PuTTY.</span><span class="sxs-lookup"><span data-stu-id="d61c7-168">The [next section](#create-a-private-key-for-putty) details using PuTTYgen to both view and use the public key, and create a private key specific for using PuTTY to SSH to Linux VMs.</span></span> <span data-ttu-id="d61c7-169">Следующая команда создает файл открытого ключа с именем `myPublicKey.key`, который можно сразу использовать:</span><span class="sxs-lookup"><span data-stu-id="d61c7-169">The following command generates a public key file named `myPublicKey.key` that you can use right away:</span></span>

    ```bash
    openssl.exe rsa -pubout -in myPrivateKey.key -out myPublicKey.key
    ```

5. <span data-ttu-id="d61c7-170">Чтобы управлять классическими ресурсами, преобразуйте `myCert.pem` в `myCert.cer` (сертификат X509 в кодировке DER).</span><span class="sxs-lookup"><span data-stu-id="d61c7-170">If you also need to manage Classic resources, convert the `myCert.pem` to `myCert.cer` (DER encoded X509 certificate).</span></span> <span data-ttu-id="d61c7-171">Это действие необязательное и требуется, только если нужно управлять устаревшими классическими ресурсами.</span><span class="sxs-lookup"><span data-stu-id="d61c7-171">Perform this optional step only if you need to specifically manage older Classic resources.</span></span>

    <span data-ttu-id="d61c7-172">Преобразуйте сертификат с помощью следующей команды:</span><span class="sxs-lookup"><span data-stu-id="d61c7-172">Convert the certificate using the following command:</span></span>

    ```bash
    openssl.exe  x509 -outform der -in myCert.pem -out myCert.cer
    ```

## <a name="create-a-private-key-for-putty"></a><span data-ttu-id="d61c7-173">Создание закрытого ключа для PuTTY</span><span class="sxs-lookup"><span data-stu-id="d61c7-173">Create a private key for PuTTY</span></span>
<span data-ttu-id="d61c7-174">PuTTY — это общераспространенный SSH-клиент для Windows.</span><span class="sxs-lookup"><span data-stu-id="d61c7-174">PuTTY is a common SSH client for Windows.</span></span> <span data-ttu-id="d61c7-175">Вы можете использовать любой необходимый SSH-клиент.</span><span class="sxs-lookup"><span data-stu-id="d61c7-175">You are free to use any SSH client that you wish.</span></span> <span data-ttu-id="d61c7-176">Для поддержки клиента PuTTY необходимо создать ключ еще одного типа, закрытый ключ PuTTY (PPK).</span><span class="sxs-lookup"><span data-stu-id="d61c7-176">To use PuTTY, you need to create an additional type of key - a PuTTY Private Key (PPK).</span></span> <span data-ttu-id="d61c7-177">Если вы не хотите использовать PuTTY, пропустите этот раздел.</span><span class="sxs-lookup"><span data-stu-id="d61c7-177">If you do not wish to use PuTTY, skip this section.</span></span>

<span data-ttu-id="d61c7-178">В следующем примере создается этот дополнительный закрытый ключ специально для PuTTY.</span><span class="sxs-lookup"><span data-stu-id="d61c7-178">The following example creates this additional private key specifically for PuTTY to use:</span></span>

1. <span data-ttu-id="d61c7-179">Используйте **Git Bash**, чтобы преобразовать свой закрытый ключ в закрытый ключ RSA, который распознается PuTTYgen.</span><span class="sxs-lookup"><span data-stu-id="d61c7-179">Use **Git Bash** to convert your private key into an RSA private key that PuTTYgen can understand.</span></span> <span data-ttu-id="d61c7-180">В следующем примере создается ключ с именем `myPrivateKey_rsa` на основе имеющегося ключа `myPrivateKey`.</span><span class="sxs-lookup"><span data-stu-id="d61c7-180">The following example creates a key named `myPrivateKey_rsa` from the existing key named `myPrivateKey`:</span></span>

    ```bash
    openssl rsa -in ./myPrivateKey.key -out myPrivateKey_rsa
    ```

    <span data-ttu-id="d61c7-181">В целях обеспечения безопасности, чтобы у посторонних пользователей не было доступа к закрытому ключу, для него необходимо задать разрешения.</span><span class="sxs-lookup"><span data-stu-id="d61c7-181">As a security measure, you should set the permissions on your private key so that only you can access it:</span></span>

    ```bash
    chmod 0600 myPrivateKey_rsa
    ```
2. <span data-ttu-id="d61c7-182">Скачайте и запустите PuTTYgen из следующего расположения: [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html).</span><span class="sxs-lookup"><span data-stu-id="d61c7-182">Download and run PuTTYgen from the following location: [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)</span></span>
3. <span data-ttu-id="d61c7-183">Выберите меню **File** (Файл) > **Load a Private Key** (Загрузить закрытый ключ).</span><span class="sxs-lookup"><span data-stu-id="d61c7-183">Click the menu: **File** > **Load Private Key**</span></span>
4. <span data-ttu-id="d61c7-184">Найдите свой закрытый ключ (в предыдущем примере — `myPrivateKey_rsa`).</span><span class="sxs-lookup"><span data-stu-id="d61c7-184">Locate your private key (`myPrivateKey_rsa` in the previous example).</span></span> <span data-ttu-id="d61c7-185">При запуске **Git Bash** по умолчанию используется каталог `C:\Users\%username%`.</span><span class="sxs-lookup"><span data-stu-id="d61c7-185">The default directory when you start **Git Bash** is `C:\Users\%username%`.</span></span> <span data-ttu-id="d61c7-186">Измените фильтр файлов, чтобы отобразить **все файлы (\*.\*)**.</span><span class="sxs-lookup"><span data-stu-id="d61c7-186">Change the file filter to show **All Files (\*.\*)**:</span></span>

    ![Загрузка имеющегося закрытого ключа в PuTTYgen](./media/ssh-from-windows/load-private-key.png)
5. <span data-ttu-id="d61c7-188">Щелкните **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="d61c7-188">Click **Open**.</span></span> <span data-ttu-id="d61c7-189">Появится запрос, который указывает, что ключ успешно импортирован.</span><span class="sxs-lookup"><span data-stu-id="d61c7-189">A prompt indicates that the key has been successfully imported:</span></span>

    ![Ключ успешно импортирован в PuTTYgen](./media/ssh-from-windows/successfully-imported-key.png)
6. <span data-ttu-id="d61c7-191">Нажмите кнопку **OK** (ОК), чтобы закрыть запрос.</span><span class="sxs-lookup"><span data-stu-id="d61c7-191">Click **OK** to close the prompt.</span></span>
7. <span data-ttu-id="d61c7-192">Открытый ключ отображается в верхней части окна **PuTTYgen**.</span><span class="sxs-lookup"><span data-stu-id="d61c7-192">The public key is displayed at the top of the **PuTTYgen** window.</span></span> <span data-ttu-id="d61c7-193">Скопируйте этот открытый ключ и вставьте его на портале Azure или в шаблон Azure Resource Manager при создании виртуальной машины Linux.</span><span class="sxs-lookup"><span data-stu-id="d61c7-193">You copy and paste this public key into the Azure portal or Azure Resource Manager template when you create a Linux VM.</span></span> <span data-ttu-id="d61c7-194">Кроме того, нажав кнопку **Save public key** (Сохранить открытый ключ), вы сохраните копию ключа на компьютере.</span><span class="sxs-lookup"><span data-stu-id="d61c7-194">You can also click **Save public key** to save a copy to your computer:</span></span>

    ![Сохранение файла PuTTY с открытым ключом](./media/ssh-from-windows/save-public-key.png)

    <span data-ttu-id="d61c7-196">В следующем примере показано, как скопировать и вставить открытый ключ на портале Azure при создании виртуальной машины Linux.</span><span class="sxs-lookup"><span data-stu-id="d61c7-196">The following example shows how you would copy and paste this public key into the Azure portal when you create a Linux VM.</span></span> <span data-ttu-id="d61c7-197">Открытый ключ, как правило, хранится в каталоге `~/.ssh/authorized_keys` на новой виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="d61c7-197">The public key is typically then stored in `~/.ssh/authorized_keys` on your new VM.</span></span>

    ![Использование открытого ключа при создании виртуальной машины на портале Azure](./media/ssh-from-windows/use-public-key-azure-portal.png)
8. <span data-ttu-id="d61c7-199">Вернитесь к **PuTTYgen** и нажмите кнопку **Save private Key** (Сохранить закрытый ключ):</span><span class="sxs-lookup"><span data-stu-id="d61c7-199">Back in **PuTTYgen**, Click **Save private Key**:</span></span>

    ![Сохранение файла PuTTY с закрытым ключом](./media/ssh-from-windows/save-ppk-file.png)

   > [!WARNING]
   > <span data-ttu-id="d61c7-201">Появится запрос на продолжение работы без ввода парольной фразы для ключа.</span><span class="sxs-lookup"><span data-stu-id="d61c7-201">A prompt asks if you wish to continue without entering a passphrase for your key.</span></span> <span data-ttu-id="d61c7-202">Парольная фраза представляет собой пароль, прикрепленный к закрытому ключу.</span><span class="sxs-lookup"><span data-stu-id="d61c7-202">A passphrase is like a password attached to your private key.</span></span> <span data-ttu-id="d61c7-203">Даже если другой пользователь получит доступ к вашему закрытому ключу, он не сможет пройти проверку подлинности с помощью одного только ключа.</span><span class="sxs-lookup"><span data-stu-id="d61c7-203">Even if someone were to obtain your private key, they still would not be able to authenticate using just the key.</span></span> <span data-ttu-id="d61c7-204">Ему потребуется также парольная фраза.</span><span class="sxs-lookup"><span data-stu-id="d61c7-204">They would also need the passphrase.</span></span> <span data-ttu-id="d61c7-205">Если не создать парольную фразу, пользователь, получивший ваш закрытый ключ, сможет войти на любую виртуальную машину или в службу, использующую этот ключ.</span><span class="sxs-lookup"><span data-stu-id="d61c7-205">Without a passphrase, if someone obtains your private key, they can log in to any VM or service that uses that key.</span></span> <span data-ttu-id="d61c7-206">Мы рекомендуем создать ее.</span><span class="sxs-lookup"><span data-stu-id="d61c7-206">We recommend you create a passphrase.</span></span> <span data-ttu-id="d61c7-207">Однако если вы забудете парольную фразу, восстановить ее будет невозможно.</span><span class="sxs-lookup"><span data-stu-id="d61c7-207">However, if you forget the passphrase, there is no way to recover it.</span></span>
   >
   >

    <span data-ttu-id="d61c7-208">Чтобы ввести парольную фразу, щелкните **No** (Нет), введите ее в главном окне PuTTYgen, а затем снова нажмите кнопку **Save private key** (Сохранить закрытый ключ).</span><span class="sxs-lookup"><span data-stu-id="d61c7-208">If you wish to enter a passphrase, click **No**, enter a passphrase in the main PuTTYgen window, and then click **Save private key** again.</span></span> <span data-ttu-id="d61c7-209">Или же щелкните **Yes** (Да), чтобы продолжить без парольной фразы.</span><span class="sxs-lookup"><span data-stu-id="d61c7-209">Otherwise, click **Yes** to continue without providing the optional passphrase.</span></span>
9. <span data-ttu-id="d61c7-210">Введите имя PPK-файла и расположение, в котором его нужно сохранить.</span><span class="sxs-lookup"><span data-stu-id="d61c7-210">Enter a name and location to save your PPK file.</span></span>

## <a name="use-putty-to-ssh-to-a-linux-machine"></a><span data-ttu-id="d61c7-211">Использование PuTTY для подключения к компьютеру Linux по протоколу SSH</span><span class="sxs-lookup"><span data-stu-id="d61c7-211">Use Putty to SSH to a Linux Machine</span></span>
<span data-ttu-id="d61c7-212">Отметим еще раз, PuTTY — это общераспространенный SSH-клиент для Windows.</span><span class="sxs-lookup"><span data-stu-id="d61c7-212">Again, PuTTY is a common SSH client for Windows.</span></span> <span data-ttu-id="d61c7-213">Вы можете использовать любой необходимый SSH-клиент.</span><span class="sxs-lookup"><span data-stu-id="d61c7-213">You are free to use any SSH client that you wish.</span></span> <span data-ttu-id="d61c7-214">Шаги ниже описывают, как использовать закрытый ключ для аутентификации на виртуальной машине Azure по протоколу SSH.</span><span class="sxs-lookup"><span data-stu-id="d61c7-214">The following steps detail how to use your private key to authenticate with your Azure VM using SSH.</span></span> <span data-ttu-id="d61c7-215">В других SSH-клиентах выполняются аналогичные шаги относительно загрузки закрытого ключа для проверки подлинности подключения SSH.</span><span class="sxs-lookup"><span data-stu-id="d61c7-215">The steps are similar in other SSH key clients in terms of needing to load your private key to authenticate the SSH connection.</span></span>

1. <span data-ttu-id="d61c7-216">Скачайте и запустите PuTTY из следующего расположения: [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html).</span><span class="sxs-lookup"><span data-stu-id="d61c7-216">Download and run putty from the following location: [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)</span></span>
2. <span data-ttu-id="d61c7-217">Введите имя узла или IP-адрес виртуальной машины на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="d61c7-217">Fill in the host name or IP address of your VM from the Azure portal:</span></span>

    ![Открытие нового подключения PuTTY](./media/ssh-from-windows/putty-new-connection.png)
3. <span data-ttu-id="d61c7-219">Прежде чем нажать **Open** (Открыть) щелкните узел **Connection** (Подключение)  > **SSH** > вкладка **Auth** (Проверка подлинности).</span><span class="sxs-lookup"><span data-stu-id="d61c7-219">Before selecting **Open**, click **Connection** > **SSH** > **Auth** tab.</span></span> <span data-ttu-id="d61c7-220">Укажите закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="d61c7-220">Browse to and select your private key:</span></span>

    ![Выбор закрытого ключа PuTTY для проверки подлинности](./media/ssh-from-windows/putty-auth-dialog.png)
4. <span data-ttu-id="d61c7-222">Щелкните **Открыть** , чтобы подключится к виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="d61c7-222">Click **Open** to connect to your virtual machine</span></span>

## <a name="next-steps"></a><span data-ttu-id="d61c7-223">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d61c7-223">Next steps</span></span>
<span data-ttu-id="d61c7-224">Открытые и закрытые ключи можно также создавать в [OS X и Linux](mac-create-ssh-keys.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="d61c7-224">You can also generate the public and private keys [using OS X and Linux](mac-create-ssh-keys.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

<span data-ttu-id="d61c7-225">Дополнительные сведения о Bash для Windows и преимуществах средств OSS на компьютере Windows см. в записи блога [Bash on Ubuntu on Windows](https://msdn.microsoft.com/commandline/wsl/about) (Bash для Ubuntu в Windows).</span><span class="sxs-lookup"><span data-stu-id="d61c7-225">For more information about Bash for Windows and the benefits of having OSS tools readily available on your Windows computer, see [Bash on Ubuntu on Windows](https://msdn.microsoft.com/commandline/wsl/about).</span></span>

<span data-ttu-id="d61c7-226">Если при подключении к виртуальным машинам Linux по протоколу SSH возникают проблемы, см. статью [Устранение неполадок с SSH-подключением к виртуальной машине Azure Linux](troubleshoot-ssh-connection.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="d61c7-226">If you have trouble using SSH to connect to your Linux VMs, see [Troubleshoot SSH connections to an Azure Linux VM](troubleshoot-ssh-connection.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>
