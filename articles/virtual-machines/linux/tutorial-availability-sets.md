---
title: "aaaAvailability задает учебника для виртуальных машин Linux в Azure | Документы Microsoft"
description: "Дополнительные сведения о hello группы доступности для виртуальных машин Linux в Azure."
documentationcenter: 
services: virtual-machines-linux
author: cynthn
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 05/22/2017
ms.author: cynthn
ms.custom: mvc
ms.openlocfilehash: 2a91e4a6057180035ec51410d9fffccaca343758
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="how-toouse-availability-sets"></a>Каким образом задает toouse доступности


В этом учебнике вы узнаете, как tooincrease hello доступность и надежность решений для виртуальной машины в Azure, используя возможность вызывать группы доступности. Группы доступности убедитесь, что hello, развертываемым в Azure виртуальные машины распределены по нескольким кластерам изолированное оборудовании. Это гарантирует, что если происходит сбой оборудования или программного обеспечения в Azure, будут затронуты только подмножество виртуальных машин и что всего решения будет оставаться доступными и функциональными с точки зрения hello ваших клиентов, используя его.

Из этого руководства вы узнаете, как выполнять такие задачи:

> [!div class="checklist"]
> * "Создать группу доступности"
> * Создание виртуальной машины в группе доступности
> * Проверка доступных размеров виртуальных машин


[!INCLUDE [cloud-shell-try-it.md](../../../includes/cloud-shell-try-it.md)]

Если выбрать tooinstall и использовать hello CLI локально, упражнений этого учебника требуется, вы используете версию Azure CLI hello 2.0.4 или более поздней версии. Запустите `az --version` версии toofind hello. Если требуется tooinstall или обновления, см. раздел [установить CLI Azure 2.0]( /cli/azure/install-azure-cli). 

## <a name="availability-set-overview"></a>Обзор групп доступности

Группа доступности — возможность логическое группирование, который можно использовать в Azure tooensure, изолированы друг от друга ресурсы hello виртуальных Машин, размещаемых в ней при развертывании в центре обработки данных Azure. Azure гарантирует, что hello поместить в группу доступности, запустите несколько физических серверов, виртуальных машин, вычислений стойки, устройства хранения и сетевых коммутаторов. Это гарантирует, что в событии hello оборудования или программного обеспечения Azure сбоя, будут затронуты только подмножество виртуальных машин и общую приложения будет работать и продолжить toobe tooyour доступны клиентам. С помощью групп доступности, tooleverage основных возможностей можно создать toobuild надежного облачных решений.

Рассмотрим стандартное решение на основе виртуальной машины, в котором может находиться 4 внешних веб-сервера и использоваться 2 внутренние виртуальные машины, содержащие базу данных. С помощью Azure необходимо два набора доступности toodefine перед развертыванием виртуальных машин: группа доступности одного уровня «web» hello и один набор доступности для уровня «database» hello. При создании новой виртуальной Машины, можно указать hello доступности виртуальной машины az toohello параметр «Создать», а Azure автоматически гарантирует, что hello виртуальных машин, создаваемых внутри hello доступных набор изолированы по нескольким ресурсам физического оборудования. Это означает, что если hello физическое оборудование, на котором один из веб-сервер или ВМ сервера базы данных выполняется на проблемы, вы знаете, hello другие экземпляры веб-сервера и базы данных виртуальных машин сможет продолжить работу нормально, так как они находятся на другое оборудование.

При необходимости toodeploy решений надежного Виртуальных машинах в Azure, следует всегда использовать группы доступности.


## <a name="create-an-availability-set"></a>"Создать группу доступности"

Вы можете создать группу доступности с помощью команды [az vm availability-set create](/cli/azure/vm/availability-set#create). В этом примере задается количество доменах обновления и отказоустойчивости на обоих hello *2* для обеспечения доступности hello набор *myAvailabilitySet* в hello *myResourceGroupAvailability*группы ресурсов.

Создайте группу ресурсов.

```azurecli-interactive 
az group create --name myResourceGroupAvailability --location eastus
```


```azurecli-interactive 
az vm availability-set create \
    --resource-group myResourceGroupAvailability \
    --name myAvailabilitySet \
    --platform-fault-domain-count 2 \
    --platform-update-domain-count 2
```

Наборы доступности возможность tooisolate ресурсы в «домены сбоя» и «update доменов». **Домен сбоя** представляет собой изолированную коллекцию ресурсов сервера, службы хранилища и сетевых ресурсов. Предшествующий пример hello мы указываем, что мы хотим нашей доступности набора toobe распределяется по крайней мере в двух доменах отказоустойчивости при развертывании нашей виртуальных машин. Кроме того, группу доступности необходимо распределить между двумя **доменами обновления**.  Двумя доменами обновления убедитесь, что при Azure выполняет обновление программного обеспечения ресурсов виртуальной Машины изолированы, препятствует выполнению под нашей виртуальной Машины выполняется обновление на hello программное обеспечение hello то же время.

## <a name="configure-virtual-network"></a>Настройка виртуальной сети
Перед развертыванием некоторые виртуальные машины и можно проверить балансировки, создайте hello, поддерживающие ресурсы виртуальной сети. Дополнительные сведения о виртуальных сетях см. в разделе hello [управление виртуальными сетями Azure](tutorial-virtual-network.md) учебника.

### <a name="create-network-resources"></a>Создание сетевых ресурсов
Создайте виртуальную сеть с помощью команды [az network vnet create](/cli/azure/network/vnet#create). Hello следующий пример создает виртуальную сеть с именем *myVnet* с подсеть с именем *mySubnet*:

```azurecli-interactive 
az network vnet create \
    --resource-group myResourceGroupAvailability \
    --name myVnet \
    --subnet-name mySubnet
```
Для создания виртуальных сетевых карт используется команда [az network nic create](/cli/azure/network/nic#create). Hello следующий пример создает три виртуальных сетевых адаптеров. (Один виртуальный сетевой Адаптер для каждой виртуальной Машины, создать приложение hello следующих шагов). Можно создать в любое время дополнительных виртуальных сетевых адаптеров и виртуальные машины и добавить их toohello балансировки нагрузки:

```bash
for i in `seq 1 3`; do
    az network nic create \
        --resource-group myResourceGroupAvailability \
        --name myNic$i \
        --vnet-name myVnet \
        --subnet mySubnet \
        --lb-name myLoadBalancer \
        --lb-address-pools myBackEndPool
done
```

## <a name="create-vms-inside-an-availability-set"></a>Создание виртуальных машин в группе доступности

Виртуальные машины должны создаваться в том, что правильно распределены по оборудованию hello toomake набор доступности hello. Не удается добавить группу существующей виртуальной Машины tooan доступности после его создания. 

При создании виртуальной Машины с помощью [создания виртуальной машины az](/cli/azure/vm#create) укажите hello доступности с помощью hello `--availability-set` параметр toospecify hello имя набора доступности hello.

```azurecli-interactive 
for i in `seq 1 2`; do
   az vm create \
     --resource-group myResourceGroupAvailability \
     --name myVM$i \
     --availability-set myAvailabilitySet \
     --nics myNic$i \
     --size Standard_DS1_v2  \
     --image Canonical:UbuntuServer:14.04.4-LTS:latest \
     --admin-username azureuser \
     --generate-ssh-keys \
     --no-wait
done 
```

Теперь в созданной группе доступности у нас есть две виртуальные машины. Так как они находятся в hello же наборе доступности Azure гарантирует виртуальных машин, hello и все свои ресурсы (включая диски с данными) распределяются между изолированной физического оборудования. за счет чего обеспечивается более высокий уровень доступности общего решения виртуальной машины.

Единственное, что могут возникнуть при добавлении виртуальных машин — что определенного размера виртуальной Машины больше не доступны toouse в наборе доступности. Эта проблема может произойти, если больше не хватает tooadd емкости, сохраняя набор доступности hello правила изоляции hello контроллер обеспечивает соблюдение. Вы можете проверить toosee какие размеры виртуальных Машин, доступных toouse в существующий набор с помощью hello доступности `--availability-set list-sizes` параметра.

## <a name="check-for-available-vm-sizes"></a>Знакомство с доступными размерами виртуальной машины 

Можно добавить дополнительные виртуальные машины toohello доступности более поздней версии, но необходимо tooknow какие размеры виртуальных Машин доступны на оборудовании hello. Используйте [список размеров az набора доступности виртуальных машин](/cli/azure/availability-set#list-sizes) toolist все доступные размеры hello на оборудовании hello кластера для группы доступности hello.

```azurecli-interactive 
az vm availability-set list-sizes \
     --resource-group myResourceGroupAvailability \
     --name myAvailabilitySet \
     --output table  
```

## <a name="next-steps"></a>Дальнейшие действия

Из этого руководства вы узнали, как выполнять такие задачи:

> [!div class="checklist"]
> * "Создать группу доступности"
> * Создание виртуальной машины в группе доступности
> * Проверка доступных размеров виртуальных машин

Переместить следующий учебник toolearn toohello о наборы масштабирования виртуальных машин.

> [!div class="nextstepaction"]
> [Создание масштабируемого набора виртуальных машин](tutorial-create-vmss.md)

