---
title: "Решения для хранения данных виртуальных машин Linux в Azure | Документация Майкрософт"
description: "Изучите основные рекомендации по проектированию и реализации, касающиеся развертывания решений для хранения данных в службах инфраструктуры Azure."
documentationcenter: 
services: virtual-machines-linux
author: iainfoulds
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 3c368f07-189b-4520-bbe2-f4080253bbf2
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 06/26/2017
ms.author: iainfou
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 7c5089b9db945b0e0f4523e53bb44c178ffd0781
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="azure-storage-infrastructure-guidelines-for-linux-vms"></a><span data-ttu-id="24030-103">Рекомендации по службе хранилища Azure для виртуальных машин Linux</span><span class="sxs-lookup"><span data-stu-id="24030-103">Azure storage infrastructure guidelines for Linux VMs</span></span>

[!INCLUDE [virtual-machines-linux-infrastructure-guidelines-intro](../../../includes/virtual-machines-linux-infrastructure-guidelines-intro.md)]

<span data-ttu-id="24030-104">Эта статья посвящена требованиям к хранилищу и вопросам проектирования, связанным с обеспечением оптимальной производительности виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="24030-104">This article focuses on understanding storage needs and design considerations for achieving optimum virtual machine (VM) performance.</span></span>

## <a name="implementation-guidelines-for-storage"></a><span data-ttu-id="24030-105">Рекомендации по реализации хранилища</span><span class="sxs-lookup"><span data-stu-id="24030-105">Implementation guidelines for storage</span></span>
<span data-ttu-id="24030-106">Решения</span><span class="sxs-lookup"><span data-stu-id="24030-106">Decisions:</span></span>

* <span data-ttu-id="24030-107">Что вы собираетесь использовать: Управляемые диски Azure или неуправляемые диски?</span><span class="sxs-lookup"><span data-stu-id="24030-107">Are you going to use Azure Managed Disks or unmanaged disks?</span></span>
* <span data-ttu-id="24030-108">Для рабочей нагрузки необходимо использовать хранилище уровня "Стандартный" или "Премиум"?</span><span class="sxs-lookup"><span data-stu-id="24030-108">Do you need to use Standard or Premium storage for your workload?</span></span>
* <span data-ttu-id="24030-109">Требуется ли чередование для создания дисков размером более 4 ТБ?</span><span class="sxs-lookup"><span data-stu-id="24030-109">Do you need disk striping to create disks larger than 4TB?</span></span>
* <span data-ttu-id="24030-110">Требуется ли чередование дисков, чтобы обеспечить оптимальную производительность ввода-вывода для рабочей нагрузки?</span><span class="sxs-lookup"><span data-stu-id="24030-110">Do you need disk striping to achieve optimal I/O performance for your workload?</span></span>
* <span data-ttu-id="24030-111">Какие учетные записи хранения необходимы для размещения рабочей нагрузки в ИТ-среде или ИТ-инфраструктуры?</span><span class="sxs-lookup"><span data-stu-id="24030-111">What set of storage accounts do you need to host your IT workload or infrastructure?</span></span>

<span data-ttu-id="24030-112">Задачи</span><span class="sxs-lookup"><span data-stu-id="24030-112">Tasks:</span></span>

* <span data-ttu-id="24030-113">Просмотрите требования к вводу-выводу разворачиваемых приложений и спланируйте нужное количество и тип учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="24030-113">Review I/O demands of the applications you are deploying and plan the appropriate number and type of storage accounts.</span></span>
* <span data-ttu-id="24030-114">Создать набор учетных записей хранения с использованием соглашения об именовании.</span><span class="sxs-lookup"><span data-stu-id="24030-114">Create the set of storage accounts using your naming convention.</span></span> <span data-ttu-id="24030-115">Можно использовать интерфейс командной строки Azure (Azure CLI) или портал.</span><span class="sxs-lookup"><span data-stu-id="24030-115">You can use the Azure CLI or the portal.</span></span>

## <a name="storage"></a><span data-ttu-id="24030-116">Хранилище</span><span class="sxs-lookup"><span data-stu-id="24030-116">Storage</span></span>
<span data-ttu-id="24030-117">Служба хранилища Azure — ключевая составляющая в развертывании виртуальных машин и приложений и управлении ими.</span><span class="sxs-lookup"><span data-stu-id="24030-117">Azure Storage is a key part of deploying and managing virtual machines (VMs) and applications.</span></span> <span data-ttu-id="24030-118">Служба хранилища Azure предоставляет службы для хранения файловых данных, неструктурированных данных и сообщений, а также является частью инфраструктуры, обслуживающей виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="24030-118">Azure Storage provides services for storing file data, unstructured data, and messages, and it is also part of the infrastructure supporting VMs.</span></span>

<span data-ttu-id="24030-119">[Управляемые диски Azure](../../storage/storage-managed-disks-overview.md) обслуживают хранилище в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="24030-119">[Azure Managed Disks](../../storage/storage-managed-disks-overview.md) handles storage for you behind the scenes.</span></span> <span data-ttu-id="24030-120">При использовании неуправляемых дисков, чтобы хранить диски (VHD-файлы) для виртуальных машин Azure, нужно создавать учетные записи хранения.</span><span class="sxs-lookup"><span data-stu-id="24030-120">With unmanaged disks, you create storage accounts to hold the disks (VHD files) for your Azure VMs.</span></span> <span data-ttu-id="24030-121">При увеличении масштаба требуется создавать дополнительные учетные записи хранения, чтобы не превысить предел операций ввода-вывода в секунду для дисков в хранилище.</span><span class="sxs-lookup"><span data-stu-id="24030-121">When scaling up, you must make sure you created additional storage accounts so you don’t exceed the IOPS limit for storage with any of your disks.</span></span> <span data-ttu-id="24030-122">При использовании хранилища, которое управляется с помощью управляемых дисков, ограничения для учетной записи хранения (например, 20 000 операций ввода-вывода в секунду на учетную запись) отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="24030-122">With Managed Disks handling storage, you are no longer limited by the storage account limits (such as 20,000 IOPS / account).</span></span> <span data-ttu-id="24030-123">Больше не требуется копировать пользовательские образы (VHD-файлы) в несколько учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="24030-123">You also no longer have to copy your custom images (VHD files) to multiple storage accounts.</span></span> <span data-ttu-id="24030-124">Вы можете управлять ими в одной учетной записи хранения на каждый регион Azure и использовать их для создания сотен виртуальных машин в одной подписке.</span><span class="sxs-lookup"><span data-stu-id="24030-124">You can manage them in a central location – one storage account per Azure region – and use them to create hundreds of VMs in a subscription.</span></span> <span data-ttu-id="24030-125">Мы рекомендуем использовать Управляемые диски для новых развертываний.</span><span class="sxs-lookup"><span data-stu-id="24030-125">We recommend you use Managed Disks for new deployments.</span></span>

<span data-ttu-id="24030-126">Для обслуживания виртуальных машин доступны учетные записи хранения двух типов.</span><span class="sxs-lookup"><span data-stu-id="24030-126">There are two types of storage accounts available for supporting VMs:</span></span>

* <span data-ttu-id="24030-127">Учетная запись хранения уровня "Стандартный" предоставляет доступ к хранилищу BLOB-объектов (которое используется для хранения дисков виртуальных машин Azure), хранилищу таблиц, хранилищу очередей и хранилищу файлов.</span><span class="sxs-lookup"><span data-stu-id="24030-127">Standard storage accounts give you access to blob storage (used for storing Azure VM disks), table storage, queue storage, and file storage.</span></span>
* <span data-ttu-id="24030-128">[хранения уровня "Премиум"](../../storage/storage-premium-storage.md) обеспечивают высокопроизводительные диски с малой задержкой для рабочих нагрузок с интенсивным вводом-выводом, например для рабочих нагрузок в сегментированных кластерах MongoDB.</span><span class="sxs-lookup"><span data-stu-id="24030-128">[Premium storage](../../storage/storage-premium-storage.md) accounts deliver high-performance, low-latency disk support for I/O intensive workloads, such as MongoDB Sharded cluster.</span></span> <span data-ttu-id="24030-129">В настоящее время хранилище уровня "Премиум" поддерживает только диски виртуальных машин Azure.</span><span class="sxs-lookup"><span data-stu-id="24030-129">Premium storage currently supports Azure VM disks only.</span></span>

<span data-ttu-id="24030-130">Azure создает виртуальные машины с диском операционной системы, временным диском и любым количеством дополнительных дисков данных (которые могут и отсутствовать).</span><span class="sxs-lookup"><span data-stu-id="24030-130">Azure creates VMs with an operating system disk, a temporary disk, and zero or more optional data disks.</span></span> <span data-ttu-id="24030-131">Диск операционной системы и диски данных — страничные BLOB-объекты Azure, тогда как временный диск хранится на локальном узле, на котором запущена виртуальная машина.</span><span class="sxs-lookup"><span data-stu-id="24030-131">The operating system disk and data disks are Azure page blobs, whereas the temporary disk is stored locally on the node where the machine lives.</span></span> <span data-ttu-id="24030-132">Будьте внимательны при проектировании приложений, использующих только этот временный диск для временных данных, так как во время события обслуживания виртуальная машина может быть перенесена между узлами.</span><span class="sxs-lookup"><span data-stu-id="24030-132">Take care when designing applications to only use this temporary disk for non-persistent data as the VM may be migrated between hosts during a maintenance event.</span></span> <span data-ttu-id="24030-133">При этом все данные, хранящиеся на временном диске, будут потеряны.</span><span class="sxs-lookup"><span data-stu-id="24030-133">Any data stored on the temporary disk would be lost.</span></span>

<span data-ttu-id="24030-134">Базовая среда службы хранилища Azure обеспечивает устойчивость и высокий уровень доступности. Это гарантирует защиту данных от внепланового обслуживания или сбоев оборудования.</span><span class="sxs-lookup"><span data-stu-id="24030-134">Durability and high availability is provided by the underlying Azure Storage environment to ensure that your data remains protected against unplanned maintenance or hardware failures.</span></span> <span data-ttu-id="24030-135">При разработке среды службы хранилища Azure можно выбрать способ репликации хранилища виртуальной машины:</span><span class="sxs-lookup"><span data-stu-id="24030-135">As you design your Azure Storage environment, you can choose to replicate VM storage:</span></span>

* <span data-ttu-id="24030-136">локально в пределах заданного центра обработки данных Azure;</span><span class="sxs-lookup"><span data-stu-id="24030-136">locally within a given Azure datacenter</span></span>
* <span data-ttu-id="24030-137">между центрами обработки данных Azure в пределах заданного региона;</span><span class="sxs-lookup"><span data-stu-id="24030-137">across Azure datacenters within a given region</span></span>
* <span data-ttu-id="24030-138">между центрами обработки данных Azure из разных регионов.</span><span class="sxs-lookup"><span data-stu-id="24030-138">across Azure datacenters across different regions.</span></span>

<span data-ttu-id="24030-139">Вы можете больше узнать о [возможностях репликации для обеспечения высокого уровня доступности](../../storage/storage-introduction.md#replication-for-durability-and-high-availability).</span><span class="sxs-lookup"><span data-stu-id="24030-139">You can read [more about the replication options for high availability](../../storage/storage-introduction.md#replication-for-durability-and-high-availability).</span></span>

<span data-ttu-id="24030-140">Максимальный размер дисков операционной системы и дисков данных составляет 4 ГБ.</span><span class="sxs-lookup"><span data-stu-id="24030-140">Operating system disks and data disks have a maximum size of 4TB.</span></span> <span data-ttu-id="24030-141">Чтобы преодолеть это ограничение, можно использовать диспетчер логических томов (LVM), чтобы сформировать пулы дисков данных, представляющие логические тома более 1023 ГБ для виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="24030-141">You can use Logical Volume Manager (LVM) to surpass this limit by pooling together data disks to present logical volumes larger than 1023GB to your VM.</span></span>

<span data-ttu-id="24030-142">Существуют некоторые ограничения масштабируемости, накладываемые при проектировании развертываний службы хранилища Azure. Дополнительные сведения об этом см. в статье [Подписка Azure, границы, квоты и ограничения службы](../../azure-subscription-service-limits.md#storage-limits).</span><span class="sxs-lookup"><span data-stu-id="24030-142">There are some scalability limits when designing your Azure Storage deployments - for more information, see [Microsoft Azure subscription and service limits, quotas, and constraints](../../azure-subscription-service-limits.md#storage-limits).</span></span> <span data-ttu-id="24030-143">Ознакомьтесь также со статьей [Целевые показатели масштабируемости и производительности хранилища Azure](../../storage/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="24030-143">Also see [Azure storage scalability and performance targets](../../storage/storage-scalability-targets.md).</span></span>

<span data-ttu-id="24030-144">Что касается хранилища приложений, можно хранить неструктурированные данные объектов, таких как документы, изображения, резервные копии, данные конфигурации, журналы и т.</span><span class="sxs-lookup"><span data-stu-id="24030-144">For application storage, you can store unstructured object data such as documents, images, backups, configuration data, logs, etc.</span></span> <span data-ttu-id="24030-145">д., используя хранилище BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="24030-145">using blob storage.</span></span> <span data-ttu-id="24030-146">Вместо того, чтобы записывать данные на виртуальный диск, подключенный к виртуальной машине, приложение может записывать их непосредственно в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="24030-146">Rather than your application writing to a virtual disk attached to the VM, the application can write directly to Azure blob storage.</span></span> <span data-ttu-id="24030-147">Хранилище BLOB-объектов также предоставляет функцию ["горячего" и "холодного" уровней хранилища](../../storage/storage-blob-storage-tiers.md) , которую можно использовать в зависимости от требований к доступности и ограничений затрат.</span><span class="sxs-lookup"><span data-stu-id="24030-147">Blob storage also provides the option of [hot and cool storage tiers](../../storage/storage-blob-storage-tiers.md) depending on your availability needs and cost constraints.</span></span>

## <a name="striped-disks"></a><span data-ttu-id="24030-148">Диски с чередованием</span><span class="sxs-lookup"><span data-stu-id="24030-148">Striped disks</span></span>
<span data-ttu-id="24030-149">Использование чередования для дисков данных, помимо возможности создавать диски размером более 1023 ГБ, во многих случаях увеличивает производительность благодаря тому, что для единого тома хранилища используются несколько больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="24030-149">Besides allowing you to create disks larger than 1023 GB, in many instances, using striping for data disks enhances performance by allowing multiple blobs to back the storage for a single volume.</span></span> <span data-ttu-id="24030-150">При чередовании дисков операции ввода-вывода для одного логического диска могут выполняться параллельно.</span><span class="sxs-lookup"><span data-stu-id="24030-150">With striping, the I/O required to write and read data from a single logical disk proceeds in parallel.</span></span>

<span data-ttu-id="24030-151">Azure накладывает ограничения на количество дисков данных и пропускную способность в зависимости от размера виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="24030-151">Azure imposes limits on the number of data disks and amount of bandwidth available, depending on the VM size.</span></span> <span data-ttu-id="24030-152">Дополнительные сведения см. в статье [Размеры виртуальных машин](sizes.md).</span><span class="sxs-lookup"><span data-stu-id="24030-152">For details, see [Sizes for virtual machines](sizes.md)</span></span>

<span data-ttu-id="24030-153">При использовании чередования дисков данных Azure придерживайтесь следующих рекомендаций:</span><span class="sxs-lookup"><span data-stu-id="24030-153">If you are using disk striping for Azure data disks, consider the following guidelines:</span></span>

* <span data-ttu-id="24030-154">Подключайте столько дисков данных, сколько позволяет размер виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="24030-154">Attach the maximum data disks allowed for the VM size.</span></span>
* <span data-ttu-id="24030-155">Используйте LVM.</span><span class="sxs-lookup"><span data-stu-id="24030-155">Use LVM.</span></span>
* <span data-ttu-id="24030-156">Избегайте использовать параметры кэширования дисков данных Azure (для политики кэширования нужно выбрать параметр "Нет").</span><span class="sxs-lookup"><span data-stu-id="24030-156">Avoid using Azure data disk caching options (caching policy = None).</span></span>

<span data-ttu-id="24030-157">Дополнительные сведения см. в статье [Настройка диспетчера логических томов на виртуальной машине Linux в Azure](configure-lvm.md).</span><span class="sxs-lookup"><span data-stu-id="24030-157">For more information, see [Configuring LVM on a Linux VM](configure-lvm.md).</span></span>

## <a name="multiple-storage-accounts"></a><span data-ttu-id="24030-158">Несколько учетных записей хранения</span><span class="sxs-lookup"><span data-stu-id="24030-158">Multiple storage accounts</span></span>
<span data-ttu-id="24030-159">Этот раздел не относится к [Управляемым дискам Azure](../../storage/storage-managed-disks-overview.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), так как вы не создаете отдельные учетные записи хранения.</span><span class="sxs-lookup"><span data-stu-id="24030-159">This section does not apply to [Azure Managed Disks](../../storage/storage-managed-disks-overview.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), as you do not create separate storage accounts.</span></span> 

<span data-ttu-id="24030-160">При проектировании среды службы хранилища Azure для неуправляемых дисков вы можете использовать несколько учетных записей хранения, так как количество развертываемых виртуальных машин может увеличиться.</span><span class="sxs-lookup"><span data-stu-id="24030-160">When designing your Azure Storage environment for unmanaged disks, you can use multiple storage accounts as the number of VMs you deploy increases.</span></span> <span data-ttu-id="24030-161">Такой подход помогает распределить операции ввода-вывода по базовой инфраструктуре службы хранилища Azure, чтобы обеспечить оптимальную производительность виртуальных машин и приложений.</span><span class="sxs-lookup"><span data-stu-id="24030-161">This approach helps distribute out the I/O across the underlying Azure Storage infrastructure to maintain optimum performance for your VMs and applications.</span></span> <span data-ttu-id="24030-162">При проектировании развертываемых приложений учтите требования к вводу-выводу каждой виртуальной машины и равномерно распределите их между учетными записями хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="24030-162">As you design the applications that you are deploying, consider the I/O requirements each VM has and balance out those VMs across Azure Storage accounts.</span></span> <span data-ttu-id="24030-163">Старайтесь избегать группирования всех виртуальных машин с высокой интенсивностью ввода-вывода всего лишь в одной или двух учетных записях хранения.</span><span class="sxs-lookup"><span data-stu-id="24030-163">Try to avoid grouping all the high I/O demanding VMs in to just one or two storage accounts.</span></span>

<span data-ttu-id="24030-164">Дополнительную информацию о возможностях ввода-вывода различных вариантов службы хранилища Azure и некоторые рекомендуемые максимальные значения можно найти в статье [Целевые показатели масштабируемости и производительности службы хранилища Azure](../../storage/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="24030-164">For more information about the I/O capabilities of the different Azure Storage options and some recommend maximums, see [Azure storage scalability and performance targets](../../storage/storage-scalability-targets.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="24030-165">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="24030-165">Next steps</span></span>
[!INCLUDE [virtual-machines-linux-infrastructure-guidelines-next-steps](../../../includes/virtual-machines-linux-infrastructure-guidelines-next-steps.md)]

