---
title: "aaaSecurity рекомендации по SQL Server в Azure | Документы Microsoft"
description: "В этом разделе приведены общие указания по обеспечению безопасности сервера SQL Server, работающего на виртуальной машине Azure."
services: virtual-machines-windows
documentationcenter: na
author: rothja
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: d710c296-e490-43e7-8ca9-8932586b71da
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/02/2017
ms.author: jroth
ms.openlocfilehash: 14c3d828fa87446da67beea6d28886de254afe15
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="security-considerations-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="7dcc5-103">Вопросы безопасности SQL Server на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="7dcc5-103">Security Considerations for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="7dcc5-104">Этот раздел содержит общие рекомендации по безопасности, которые помогут обеспечить экземпляров сервера tooSQL безопасного доступа в Azure виртуальной машины (VM).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-104">This topic includes overall security guidelines that help establish secure access tooSQL Server instances in an Azure virtual machine (VM).</span></span>

<span data-ttu-id="7dcc5-105">Azure соответствует ряду отраслевых норм и стандартов, которые можно одновременно toobuild решении совместимые с SQL Server, запущенный на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-105">Azure complies with several industry regulations and standards that can enable you toobuild a compliant solution with SQL Server running in a virtual machine.</span></span> <span data-ttu-id="7dcc5-106">Сведения о соответствии нормам Azure см. в [центре управления безопасностью Azure](https://azure.microsoft.com/support/trust-center/).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-106">For information about regulatory compliance with Azure, see [Azure Trust Center](https://azure.microsoft.com/support/trust-center/).</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="control-access-toohello-sql-vm"></a><span data-ttu-id="7dcc5-107">Элемент управления доступа toohello виртуальной Машины SQL</span><span class="sxs-lookup"><span data-stu-id="7dcc5-107">Control access toohello SQL VM</span></span>

<span data-ttu-id="7dcc5-108">При создании виртуальной машины SQL Server, необходимо учитывайте как toocarefully контролировать, кто имеет доступ toohello компьютера и tooSQL сервера.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-108">When you create your SQL Server virtual machine, consider how toocarefully control who has access toohello machine and tooSQL Server.</span></span> <span data-ttu-id="7dcc5-109">Как правило, вам следует hello следующее:</span><span class="sxs-lookup"><span data-stu-id="7dcc5-109">In general, you should do hello following:</span></span>

- <span data-ttu-id="7dcc5-110">Ограничьте доступ tooSQL серверных tooonly hello приложений и клиентов, которым она необходима.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-110">Restrict access tooSQL Server tooonly hello applications and clients that need it.</span></span>
- <span data-ttu-id="7dcc5-111">придерживаться рекомендаций по управлению учетными записями пользователей и паролями.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-111">Follow best practices for managing user accounts and passwords.</span></span>

<span data-ttu-id="7dcc5-112">Hello в следующих разделах предоставляют подсказки на анализ через эти точки.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-112">hello following sections provide suggestions on thinking through these points.</span></span>

## <a name="secure-connections"></a><span data-ttu-id="7dcc5-113">Защита подключений</span><span class="sxs-lookup"><span data-stu-id="7dcc5-113">Secure connections</span></span>

<span data-ttu-id="7dcc5-114">При создании виртуальной машины с SQL Server с помощью образа коллекции hello **связи SQL Server** параметр дает hello Выбор **локальной (в виртуальной Машине)**, **закрытый (в виртуальной сети)** , или **общей (Интернет)**.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-114">When you create a SQL Server virtual machine with a gallery image, hello **SQL Server Connectivity** option gives you hello choice of **Local (inside VM)**, **Private (within Virtual Network)**, or **Public (Internet)**.</span></span>

![Подключение к серверу SQL Server](./media/virtual-machines-windows-sql-security/sql-vm-connectivity-option.png)

<span data-ttu-id="7dcc5-116">В целях повышения безопасности hello вариант hello наиболее строгие для вашего сценария.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-116">For hello best security, choose hello most restrictive option for your scenario.</span></span> <span data-ttu-id="7dcc5-117">Например, при запуске приложения, которое работает на SQL Server hello одной виртуальной Машины, затем **локального** наиболее безопасный вариант hello.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-117">For example, if you are running an application that accesses SQL Server on hello same VM, then **Local** is hello most secure choice.</span></span> <span data-ttu-id="7dcc5-118">При запуске приложения Azure, требуется доступ toohello SQL Server, то **закрытый** защищает tooSQL связи сервера только в пределах указанного hello [виртуальной сети Azure](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-118">If you are running an Azure application that requires access toohello SQL Server, then **Private** secures communication tooSQL Server only within hello specified [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).</span></span> <span data-ttu-id="7dcc5-119">Если требуется **открытый** toohello (internest) доступа к виртуальной Машине SQL Server, затем убедитесь, что toofollow других рекомендаций в этой статье tooreduce контактную зону.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-119">If you require **Public** (internest) access toohello SQL Server VM, then make sure toofollow other best practices in this topic tooreduce your attack surface area.</span></span>

<span data-ttu-id="7dcc5-120">Hello выбранные параметры на портале hello использовать правила безопасности для входящего трафика на виртуальные машины hello [сетевой группы безопасности](../../../virtual-network/virtual-networks-nsg.md) tooallow (NSG) или запрещать сетевой трафик tooyour виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-120">hello selected options in hello portal use inbound security rules on hello VMs [Network Security Group](../../../virtual-network/virtual-networks-nsg.md) (NSG) tooallow or deny network traffic tooyour virtual machine.</span></span> <span data-ttu-id="7dcc5-121">Можно изменить или создать новые правила для входящих подключений NSG порт SQL Server toohello tooallow трафика (по умолчанию 1433).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-121">You can modify or create new inbound NSG rules tooallow traffic toohello SQL Server port (default 1433).</span></span> <span data-ttu-id="7dcc5-122">Можно также указать конкретные IP-адреса, разрешенные toocommunicate через этот порт.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-122">You can also specify specific IP addresses that are allowed toocommunicate over this port.</span></span>

![Правила группы безопасности сети](./media/virtual-machines-windows-sql-security/sql-vm-network-security-group-rules.png)

<span data-ttu-id="7dcc5-124">В дополнение к этому tooNSG правила toorestrict сетевого трафика, можно также использовать hello брандмауэра Windows на виртуальной машине hello.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-124">In addition tooNSG rules toorestrict network traffic, you can also use hello Windows Firewall on hello virtual machine.</span></span>

<span data-ttu-id="7dcc5-125">При использовании конечных точек с hello классической модели развертывания удалите конечные точки на виртуальной машине hello, если они не используются.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-125">If you are using endpoints with hello classic deployment model, remove any endpoints on hello virtual machine if you do not use them.</span></span> <span data-ttu-id="7dcc5-126">Инструкции по использованию списков ACL с конечными точками, см. в разделе [управление hello ACL в конечной точке](../classic/setup-endpoints.md#manage-the-acl-on-an-endpoint).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-126">For instructions on using ACLs with endpoints, see [Manage hello ACL on an endpoint](../classic/setup-endpoints.md#manage-the-acl-on-an-endpoint).</span></span> <span data-ttu-id="7dcc5-127">Это не требуется для виртуальных машин, использующих hello диспетчера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-127">This is not necessary for VMs that use hello Resource Manager.</span></span>

<span data-ttu-id="7dcc5-128">Наконец можно включить зашифрованные соединения для экземпляра hello hello SQL Server Database Engine в виртуальной машине Azure.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-128">Finally, consider enabling encrypted connections for hello instance of hello SQL Server Database Engine in your Azure virtual machine.</span></span> <span data-ttu-id="7dcc5-129">Настройте новый экземпляр SQL Server с подписанным сертификатом.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-129">Configure SQL server instance with a signed certificate.</span></span> <span data-ttu-id="7dcc5-130">Дополнительные сведения см. в разделе [toohello Включение шифрования соединений СУБД](https://docs.microsoft.com/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine) и [синтаксис строки соединения](https://msdn.microsoft.com/library/ms254500.aspx).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-130">For more information, see [Enable Encrypted Connections toohello Database Engine](https://docs.microsoft.com/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine) and [Connection String Syntax](https://msdn.microsoft.com/library/ms254500.aspx).</span></span>

## <a name="use-a-non-default-port"></a><span data-ttu-id="7dcc5-131">Использование нестандартного порта</span><span class="sxs-lookup"><span data-stu-id="7dcc5-131">Use a non-default port</span></span>

<span data-ttu-id="7dcc5-132">По умолчанию сервер SQL Server ожидает передачи данных через стандартный порт 1433.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-132">By default, SQL Server listens on a well-known port, 1433.</span></span> <span data-ttu-id="7dcc5-133">Для повышения безопасности следует настройте toolisten SQL Server на нестандартный порт, например 1401.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-133">For increased security, configure SQL Server toolisten on a non-default port, such as 1401.</span></span> <span data-ttu-id="7dcc5-134">Если вы подготовить образ SQL Server коллекции в hello портал Azure, можно указать этот порт в hello **параметры SQL Server** колонку.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-134">If you provision a SQL Server gallery image in hello Azure portal, you can specify this port in hello **SQL Server settings** blade.</span></span>

<span data-ttu-id="7dcc5-135">tooconfigure этот после подготовки, у вас есть два варианта:</span><span class="sxs-lookup"><span data-stu-id="7dcc5-135">tooconfigure this after provisioning, you have two options:</span></span>

- <span data-ttu-id="7dcc5-136">Для виртуальных машин диспетчера ресурсов, можно выбрать **конфигурации SQL Server** из колонки Обзор hello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-136">For Resource Manager VMs, you can select **SQL Server configuration** from hello VM overview blade.</span></span> <span data-ttu-id="7dcc5-137">Это позволяет toochange hello порта.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-137">This provides an option toochange hello port.</span></span>

  ![Изменение TCP-порта на портале](./media/virtual-machines-windows-sql-security/sql-vm-change-tcp-port.png)

- <span data-ttu-id="7dcc5-139">Для классических виртуальных машин или виртуальные машины SQL Server, не были подготовлены при помощи портала hello можно вручную настроить порт hello посредством удаленного подключения toohello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-139">For Classic VMs or for SQL Server VMs that were not provisioned with hello portal, you can manually configure hello port by connecting remotely toohello VM.</span></span> <span data-ttu-id="7dcc5-140">Действия по настройке hello, см. [Настройка tooListen сервера определенного порта TCP](https://docs.microsoft.com/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-140">For hello configuration steps, see [Configure a Server tooListen on a Specific TCP Port](https://docs.microsoft.com/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port).</span></span> <span data-ttu-id="7dcc5-141">Если вы используете этот способ вручную, необходимо также tooadd брандмауэра Windows правило tooallow входящий трафик на TCP-порта.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-141">If you use this manual technique, you also need tooadd a Windows Firewall rule tooallow incoming traffic on that TCP port.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dcc5-142">Указание порта не по умолчанию имеет смысл, если порт SQL Server откройте toopublic подключения к Интернету.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-142">Specifying a non-default port is a good idea if your SQL Server port is open toopublic internet connections.</span></span>

<span data-ttu-id="7dcc5-143">Если SQL Server прослушивает порт не по умолчанию, необходимо указать hello порт при подключении.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-143">When SQL Server is listening on a non-default port, you must specify hello port when you connect.</span></span> <span data-ttu-id="7dcc5-144">Например, рассмотрим сценарий, где 13.55.255.255 IP-адрес сервера hello и SQL Server прослушивает порт 1401.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-144">For example, consider a scenario where hello server IP address is 13.55.255.255 and SQL Server is listening on port 1401.</span></span> <span data-ttu-id="7dcc5-145">tooSQL tooconnect сервера, следует указать `13.55.255.255,1401` в строке подключения hello.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-145">tooconnect tooSQL Server, you would specify `13.55.255.255,1401` in hello connection string.</span></span>

## <a name="manage-accounts"></a><span data-ttu-id="7dcc5-146">Управление учетными записями</span><span class="sxs-lookup"><span data-stu-id="7dcc5-146">Manage accounts</span></span>

<span data-ttu-id="7dcc5-147">Вы не хотите злоумышленники tooeasily предположением счета имена и пароли.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-147">You don't want attackers tooeasily guess account names or passwords.</span></span> <span data-ttu-id="7dcc5-148">Используйте следующие советы toohelp hello.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-148">Use hello following tips toohelp:</span></span>

- <span data-ttu-id="7dcc5-149">Создайте уникальную локальную учетную запись администратора с именем, отличным от **Administrator**.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-149">Create a unique local administrator account that is not named **Administrator**.</span></span>

- <span data-ttu-id="7dcc5-150">Используйте сложные надежные пароли для всех учетных записей.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-150">Use complex strong passwords for all your accounts.</span></span> <span data-ttu-id="7dcc5-151">Дополнительные сведения о том, как toocreate надежный пароль. в разделе [создать надежный пароль](https://support.microsoft.com/instantanswers/9bd5223b-efbe-aa95-b15a-2fb37bef637d/create-a-strong-password) статьи.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-151">For more information about how toocreate a strong password, see [Create a strong password](https://support.microsoft.com/instantanswers/9bd5223b-efbe-aa95-b15a-2fb37bef637d/create-a-strong-password) article.</span></span>

- <span data-ttu-id="7dcc5-152">По умолчанию во время настройки виртуальной машины SQL Server в Azure выбирается проверка подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-152">By default, Azure selects Windows Authentication during SQL Server Virtual Machine setup.</span></span> <span data-ttu-id="7dcc5-153">Здравствуйте, поэтому **SA** входа будет отключена, а пароль присваивается программой установки.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-153">Therefore, hello **SA** login is disabled and a password is assigned by setup.</span></span> <span data-ttu-id="7dcc5-154">Мы рекомендуем, hello **SA** входа не следует использовать или включена.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-154">We recommend that hello **SA** login should not be used or enabled.</span></span> <span data-ttu-id="7dcc5-155">Если необходимо иметь учетные данные SQL, воспользуйтесь одним из следующих стратегий hello:</span><span class="sxs-lookup"><span data-stu-id="7dcc5-155">If you must have a SQL login, use one of hello following strategies:</span></span>

  - <span data-ttu-id="7dcc5-156">Создайте учетную запись SQL с уникальным именем, являющуюся участником роли **sysadmin**.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-156">Create a SQL account with a unique name that has **sysadmin** membership.</span></span> <span data-ttu-id="7dcc5-157">Включив это можно сделать через портал hello **проверки подлинности SQL** во время инициализации.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-157">You can do this from hello portal by enabling **SQL Authentication** during provisioning.</span></span>

    > [!TIP] 
    > <span data-ttu-id="7dcc5-158">Если не включить проверку подлинности SQL во время подготовки, необходимо вручную изменить режим проверки подлинности hello слишком**SQL Server и режим проверки подлинности Windows**.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-158">If you do not enable SQL Authentication during provisioning, you must manually change hello authentication mode too**SQL Server and Windows Authentication Mode**.</span></span> <span data-ttu-id="7dcc5-159">Дополнительные сведения см. в статье [Изменение режима проверки подлинности сервера](https://docs.microsoft.com/sql/database-engine/configure-windows/change-server-authentication-mode).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-159">For more information, see [Change Server Authentication Mode](https://docs.microsoft.com/sql/database-engine/configure-windows/change-server-authentication-mode).</span></span>

  - <span data-ttu-id="7dcc5-160">Если необходимо использовать hello **SA** входа, входа hello enable после подготовки и назначить новый надежный пароль.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-160">If you must use hello **SA** login, enable hello login after provisioning and assign a new strong password.</span></span>

## <a name="follow-on-premises-best-practices"></a><span data-ttu-id="7dcc5-161">Рекомендации по локальной среде</span><span class="sxs-lookup"><span data-stu-id="7dcc5-161">Follow on-premises best practices</span></span>

<span data-ttu-id="7dcc5-162">Кроме toohello и рекомендации, описанные в этом разделе, рекомендуется изучить и реализовать рекомендации по обеспечению безопасности в локальном hello, где это возможно.</span><span class="sxs-lookup"><span data-stu-id="7dcc5-162">In addition toohello practices described in this topic, we recommend that you review and implement hello traditional on-premises security practices where applicable.</span></span> <span data-ttu-id="7dcc5-163">Дополнительные сведения см. в статье [Вопросы безопасности при установке SQL Server](https://docs.microsoft.com/sql/sql-server/install/security-considerations-for-a-sql-server-installation).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-163">For more information, see [Security Considerations for a SQL Server Installation](https://docs.microsoft.com/sql/sql-server/install/security-considerations-for-a-sql-server-installation)</span></span>

## <a name="next-steps"></a><span data-ttu-id="7dcc5-164">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="7dcc5-164">Next Steps</span></span>

<span data-ttu-id="7dcc5-165">Если вам также интересны рекомендации по повышению производительности, ознакомьтесь со статьей [Рекомендации по оптимизации производительности SQL Server в виртуальных машинах Azure](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-165">If you are also interested in best practices around performance, see [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="7dcc5-166">Другие разделы, посвященные toorunning SQL Server в виртуальных машинах Azure, см. в разделе [SQL Server на виртуальных машинах Azure Обзор](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7dcc5-166">For other topics related toorunning SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines overview](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

