---
title: "Архивация и восстановление для SQL Server | Документация Майкрософт"
description: "Содержит сведения об архивации и восстановлении баз данных SQL Server на виртуальных машинах Azure."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-resource-management
ms.assetid: 95a89072-0edf-49b5-88ed-584891c0e066
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 11/15/2016
ms.author: mikeray
ms.openlocfilehash: 65557938673c5442758396a47873be1016e0f71b
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="backup-and-restore-for-sql-server-in-azure-virtual-machines"></a>Резервное копирование и восстановление SQL Server в виртуальных машинах Azure
## <a name="overview"></a>Обзор
В службе хранилища Azure хранится 3 копии каждого диска виртуальной машины Azure для защиты от потери или физического повреждения данных. Таким образом, в отличие от использования локальной среды, об этом можно не беспокоиться. Тем не менее, все равно следует архивировать базы данных SQL Server для защиты от ошибок приложений и пользователей (это может быть вставка неправильных данных или удаление таблицы), чтобы иметь возможность выполнить восстановление на определенный момент времени.

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

Для SQL Server на виртуальных машинах Azure можно применять  собственные методы архивации и восстановления, используя для хранения файлов резервных копий подключенные диски. При этом существует ограничение на количество дисков, которые можно присоединить к виртуальной машине Azure, связанное с [размером виртуальной машины](../sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json). Также необходимо учитывать накладные расходы на управление дисками.

Начиная с SQL Server 2014 для архивации и восстановления можно использовать хранилище BLOB-объектов Microsoft Azure. Дополнительные возможности для этого параметра реализуются также в версии SQL Server 2016. Кроме того, SQL Server 2016 позволяет практически мгновенно создавать резервные копии файлов базы данных, которые находятся в хранилище больших двоичных объектов Microsoft Azure, и быстро их восстанавливать с помощью моментальных снимков Azure. В этой статье содержится обзор этих параметров. Дополнительные сведения см. в статье [Резервное копирование и восстановление SQL Server с помощью службы хранилища BLOB-объектов Microsoft Azure](https://msdn.microsoft.com/library/jj919148.aspx).

> [!NOTE]
> Обсуждение параметров архивации очень больших баз данных см. в публикации блога [Multi-Terabyte SQL Server Database Backup Strategies for Azure Virtual Machines](http://blogs.msdn.com/b/igorpag/archive/2015/07/28/multi-terabyte-sql-server-database-backup-strategies-for-azure-virtual-machines.aspx) (Стратегии архивации терабайтных баз данных SQL Server для виртуальных машин Azure).
> 
> 

В следующих разделах приводятся сведения по отдельным версиям SQL Server, которые поддерживаются виртуальными машинами Azure.

## <a name="sql-server-virtual-machines"></a>Виртуальные машины SQL Server
Если экземпляр SQL Server работает на виртуальной машине Azure, файлы базы данных уже содержатся на дисках данных в Azure. Эти диски находятся в хранилище BLOB-объектов. Поэтому причины для архивации базы данных и применяемый подход будут немного отличаться. Давайте рассмотрим следующее. 

* Архивировать базы данных для защиты от сбоев оборудования или отказа носителей больше не нужно, поскольку такая защита предоставляется в рамках службы Microsoft Azure по умолчанию.
* Архивация базы данных требуется для защиты от ошибок пользователей, а также для формирования архивов, соблюдения нормативных требований или в административных целях.
* Файл резервной копии можно хранить непосредственно в Azure. Дополнительные сведения см. в следующих разделах, которые дают представление о различных версиях SQL Server.

## <a name="sql-server-2016"></a>SQL Server 2016
Microsoft SQL Server 2016 поддерживает функции [архивации и восстановления с использованием больших двоичных объектов Azure](https://msdn.microsoft.com/library/jj919148.aspx) , реализованные в SQL Server 2014. Однако эта версия включает также следующие усовершенствования:

| Усовершенствования 2016 года | Сведения |
| --- | --- |
| **Чередование** |Когда выполняется резервное копирование в хранилище BLOB-объектов Microsoft Azure, SQL Server 2016 позволяет использовать сразу несколько больших двоичных объектов и, таким образом, создавать резервные копии больших баз данных размером до 12,8 ТБ. |
| **Резервное копирование моментальных снимков** |Благодаря использованию моментальных снимков Azure функция резервного копирования моментальных снимков файлов SQL Server дает возможность практически мгновенно создавать резервные копии и быстро восстанавливать файлы баз данных, сохраненные с помощью службы хранилища BLOB-объектов Azure. Это позволяет упростить политики архивации и восстановления политик. Функция архивации моментальных снимков файлов поддерживает также восстановление до определенной точки во времени. Дополнительные сведения см. в статье [Резервные копии моментальных снимков файлов для файлов базы данных в Azure](https://msdn.microsoft.com/library/mt169363%28v=sql.130%29.aspx). |
| **Планирование управляемого резервного копирования** |Функция управляемого резервного копирования в Azure, доступная в SQL Server, теперь поддерживает пользовательские расписания. Дополнительные сведения см. в статье [Управляемое резервное копирование SQL Server в Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx). |

Инструкции по использованию функций SQL Server 2016 при работе с хранилищем BLOB-объектов Azure см. в учебнике [Использование службы хранилища больших двоичных объектов Microsoft Azure с базами данных SQL Server 2016](https://msdn.microsoft.com/library/dn466438.aspx).

## <a name="sql-server-2014"></a>SQL Server 2014
SQL Server 2014 включает следующие усовершенствования:

1. **Резервное копирование и восстановление в Azure**.
   
   * Функция *архивации SQL Server на URL-адрес* теперь поддерживается в среде SQL Server Management Studio. Теперь при выполнении задачи архивации или восстановления, а также при работе с мастером планов обслуживания в SQL Server Management Studio можно сохранять резервные копии в Azure. Дополнительные сведения см. в статье [Резервное копирование и восстановление SQL Server с помощью службы хранилищ больших двоичных объектов Windows Azure](https://msdn.microsoft.com/library/jj919148%28v=sql.120%29.aspx).
   * В функцию *управляемой архивации SQL Server в Azure* добавлены новые возможности, позволяющие автоматизировать управление архивацией. Они пригодятся при управлении автоматической архивацией для экземпляров SQL Server 2014, выполняемых на машине Azure. Дополнительные сведения см. в статье [Управляемое резервное копирование SQL Server в Microsoft Azure](https://msdn.microsoft.com/library/dn449496%28v=sql.120%29.aspx).
   * Функция *автоматической архивации* позволяет автоматически включать *управляемую архивацию SQL Server в Azure* во всех действующих и новых базах данных для виртуальной машины SQL Server в Azure. Дополнительную информацию см. в статье [Автоматическая архивация SQL Server на виртуальных машинах Azure (Resource Manager)](virtual-machines-windows-sql-automated-backup.md).
   * Общие сведения обо всех параметрах архивации SQL Server 2014 в Azure см. в статье [Резервное копирование и восстановление SQL Server с помощью службы хранилищ больших двоичных объектов Windows Azure](https://msdn.microsoft.com/library/jj919148%28v=sql.120%29.aspx).
2. **Шифрование**: SQL Server 2014 поддерживает шифрование данных при создании архива. Поддерживаются несколько алгоритмов шифрования и использование сертификата или асимметричного ключа. Дополнительные сведения см. в статье [Шифрование резервной копии](https://msdn.microsoft.com/library/dn449489%28v=sql.120%29.aspx).

## <a name="sql-server-2012"></a>SQL Server 2012
Подробные сведения об архивации и восстановлении в SQL Server 2012 см. в статье [Резервное копирование и восстановление баз данных SQL Server](https://msdn.microsoft.com/library/ms187048%28v=sql.110%29.aspx).

Начиная с SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 2, поддерживается архивация и восстановление через службу хранилища больших двоичных объектов Azure. Это улучшение можно использовать для архивации баз данных SQL Server в SQL Server на виртуальной машине Azure или в локальном экземпляре. Дополнительные сведения см. в статье [Резервное копирование и восстановление SQL Server с помощью службы хранилищ больших двоичных объектов Windows Azure](https://msdn.microsoft.com/library/jj919148%28v=sql.110%29.aspx).

К ряду преимуществ, связанных с использованием службы хранилища больших двоичных объектов Azure, относятся: возможность обойти ограничение, позволяющего подключать не больше 16 дисков, легкость управления, а также прямая доступность резервных файлов для другого экземпляра SQL Server, работающего на виртуальной машине Azure, или локальных экземпляров для переноса или аварийного восстановления данных. Полный список преимуществ, связанных с хранением архивов SQL Server в службе хранилища BLOB-объектов Azure, см. в разделе *Преимущества* статьи [Резервное копирование и восстановление SQL Server с помощью службы хранилищ больших двоичных объектов Windows Azure](https://msdn.microsoft.com/library/jj919148%28v=sql.110%29.aspx).

Рекомендации и сведения об устранении неполадок см. в статье [Рекомендованные методы резервного копирования и восстановления (служба хранилищ больших двоичных объектов Windows Azure)](https://msdn.microsoft.com/library/jj919149%28v=sql.110%29.aspx).

## <a name="sql-server-2008"></a>SQL Server 2008
Сведения об архивации и восстановлении в SQL Server 2008 R2 см. в статье [Резервное копирование и восстановление баз данных в SQL Server (SQL Server 2008 R2)](https://msdn.microsoft.com/library/ms187048%28v=sql.105%29.aspx).

Сведения об архивации и восстановлении в SQL Server 2008 см. в статье [Резервное копирование и восстановление баз данных в SQL Server (SQL Server 2008)](https://msdn.microsoft.com/library/ms187048%28v=sql.100%29.aspx).

## <a name="next-steps"></a>Дальнейшие действия
Планируя развертывание SQL Server на виртуальной машине Azure, воспользуйтесь рекомендациями из учебника [Подготовка виртуальной машины SQL Server на портале Azure](virtual-machines-windows-portal-sql-server-provision.md).

При том, что архивацию и восстановление можно использовать для переноса данных, существуют более простые способы переноса данных в SQL Server на виртуальной машине Azure. Полное описание вариантов переноса и соответствующие рекомендации см. в статье [Миграция базы данных SQL Server в экземпляр SQL Server на виртуальной машине Azure](virtual-machines-windows-migrate-sql.md).

Просмотрите и другие [ресурсы по запуску SQL Server на виртуальных машинах Azure](virtual-machines-windows-sql-server-iaas-overview.md).

