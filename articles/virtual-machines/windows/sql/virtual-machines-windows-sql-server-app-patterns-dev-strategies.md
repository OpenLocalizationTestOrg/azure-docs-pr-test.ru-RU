---
title: "Шаблоны приложений SQL Server в виртуальных машинах | Документация Майкрософт"
description: "В этой статье описаны шаблоны приложений для SQL Server в виртуальных машинах Azure. Статья предоставляет архитекторам и разработчикам решений основу для создания правильных архитектуры и конструкции."
services: virtual-machines-windows
documentationcenter: na
author: ninarn
manager: jhubbard
editor: 
tags: azure-service-management,azure-resource-manager
ms.assetid: 41863c8d-f3a3-4584-ad86-b95094365e05
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/31/2017
ms.author: ninarn
ms.openlocfilehash: a716de21e21148a082f49f0f416b14ca0eaa8192
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="application-patterns-and-development-strategies-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="c74c5-104">Шаблоны приложений и стратегии разработки для SQL Server на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="c74c5-104">Application Patterns and Development Strategies for SQL Server in Azure Virtual Machines</span></span>
[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="summary"></a><span data-ttu-id="c74c5-105">Сводка:</span><span class="sxs-lookup"><span data-stu-id="c74c5-105">Summary:</span></span>
<span data-ttu-id="c74c5-106">Выбор моделей приложений, которые вы будете использовать для ваших приложений на основе SQL Server в среде Azure, — это важное решение на этапе проектирования. Чтобы принять его, необходимо хорошо понимать, как SQL Server и все компоненты инфраструктуры Azure работают друг с другом.</span><span class="sxs-lookup"><span data-stu-id="c74c5-106">Determining which application pattern or patterns to use for your SQL-Server-based applications in Azure environment is an important design decision and it requires a solid understanding of how SQL Server and each infrastructure component of Azure work together.</span></span> <span data-ttu-id="c74c5-107">С помощью SQL Server в службах инфраструктуры Azure можно легко переносить существующие приложения SQL Server, созданные в Windows Server, в виртуальные машины в Azure, а также обслуживать и отслеживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-107">With SQL Server in Azure Infrastructure Services, you can easily migrate, maintain, and monitor your existing SQL Server applications built-on Windows Server to virtual machines in Azure.</span></span>

<span data-ttu-id="c74c5-108">Цель данной статьи — предоставить архитекторам и разработчикам решений основу в виде правильных архитектуры и конструкции приложений, которых можно придерживаться как при переносе существующих приложений в Azure, так и при разработке новых приложений в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-108">The goal of this article is to provide solution architects and developers a foundation for good application architecture and design, which they can follow when migrating existing applications to Azure as well as developing new applications in Azure.</span></span>

<span data-ttu-id="c74c5-109">Для каждой модели приложений имеются локальный сценарий, соответствующее решение для облачной среды, а также технические рекомендации.</span><span class="sxs-lookup"><span data-stu-id="c74c5-109">For each application pattern, you will find an on-premises scenario, its respective cloud-enabled solution, and the related technical recommendations.</span></span> <span data-ttu-id="c74c5-110">Кроме того, в статье рассматриваются стратегии разработки, характерные для Azure. Применяя их, вы сможете правильно разрабатывать свои приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-110">In addition, the article discusses Azure-specific development strategies so that you can design your applications correctly.</span></span> <span data-ttu-id="c74c5-111">Из-за большого количества возможных моделей приложений архитекторам и разработчикам рекомендуется выбирать модели, наиболее подходящие для их приложений и пользователей.</span><span class="sxs-lookup"><span data-stu-id="c74c5-111">Due to the many possible application patterns, it’s recommended that architects and developers should choose the most appropriate pattern for their applications and users.</span></span>

<span data-ttu-id="c74c5-112">**Технические соавторы:** Луис Карлос Варгас Херринг (Luis Carlos Vargas Herring), Мадхан Арумугам Рамакришнан (Madhan Arumugam Ramakrishnan)</span><span class="sxs-lookup"><span data-stu-id="c74c5-112">**Technical Contributors:** Luis Carlos Vargas Herring, Madhan Arumugam Ramakrishnan</span></span>

<span data-ttu-id="c74c5-113">**Технические рецензенты:** Кори Сэндерс (Corey Sanders), Дрю МакДэниэл (Drew McDaniel), Нараян Аннамалай (Narayan Annamalai), Нир Машковски (Nir Mashkowski), Санджей Мишра (Sanjay Mishra), Сильвано Кориани (Silvano Coriani), Стефан Шакоу (Stefan Schackow), Тим Хики (Tim Hickey), Тим Виман (Tim Wieman), Синь Цзинь (Xin Jin).</span><span class="sxs-lookup"><span data-stu-id="c74c5-113">**Technical Reviewers:** Corey Sanders, Drew McDaniel, Narayan Annamalai, Nir Mashkowski, Sanjay Mishra, Silvano Coriani, Stefan Schackow, Tim Hickey, Tim Wieman, Xin Jin</span></span>

## <a name="introduction"></a><span data-ttu-id="c74c5-114">Введение</span><span class="sxs-lookup"><span data-stu-id="c74c5-114">Introduction</span></span>
<span data-ttu-id="c74c5-115">Вы можете разрабатывать n-уровневые приложения самых разных типов, размещая компоненты различных слоев приложений на разных компьютерах и в разных компонентах.</span><span class="sxs-lookup"><span data-stu-id="c74c5-115">You can develop many types of n-tier applications by separating the components of the different application layers on different machines as well as in separate components.</span></span> <span data-ttu-id="c74c5-116">Например, можно разместить клиентское приложение и компоненты бизнес-правил на одном компьютере, компоненты интерфейсного веб-уровня и уровня доступа к данным — на другом компьютере, а уровень внутренней базы данных — на третьем.</span><span class="sxs-lookup"><span data-stu-id="c74c5-116">For example, you can place the client application and business rules components in one machine, front-end web tier and data access tier components in another machine, and a back-end database tier in another machine.</span></span> <span data-ttu-id="c74c5-117">Такой способ структурирования позволяет изолировать уровни друг от друга.</span><span class="sxs-lookup"><span data-stu-id="c74c5-117">This kind of structuring helps isolate each tier from each other.</span></span> <span data-ttu-id="c74c5-118">При изменении источника данных вам не придется изменять клиент или веб-приложение, достаточно изменить компоненты уровня доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="c74c5-118">If you change where data comes from, you don’t need to change the client or web application but only the data access tier components.</span></span>

<span data-ttu-id="c74c5-119">Типичное *n-уровневое* приложение включает в себя уровень представления, бизнес-уровень и уровень данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-119">A typical *n-tier* application includes the presentation tier, the business tier, and the data tier:</span></span>

| <span data-ttu-id="c74c5-120">Уровень</span><span class="sxs-lookup"><span data-stu-id="c74c5-120">Tier</span></span> | <span data-ttu-id="c74c5-121">Описание</span><span class="sxs-lookup"><span data-stu-id="c74c5-121">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c74c5-122">**Уровень представления**</span><span class="sxs-lookup"><span data-stu-id="c74c5-122">**Presentation**</span></span> |<span data-ttu-id="c74c5-123">*Уровень представления* (веб-уровень, интерфейсный уровень) — это слой, на котором пользователи взаимодействуют с приложением.</span><span class="sxs-lookup"><span data-stu-id="c74c5-123">The *presentation tier* (web tier, front-end tier) is the layer in which users interact with an application.</span></span> |
| <span data-ttu-id="c74c5-124">**Рабочий телефон**</span><span class="sxs-lookup"><span data-stu-id="c74c5-124">**Business**</span></span> |<span data-ttu-id="c74c5-125">*Бизнес-уровень* (средний уровень) — это слой, который уровни представления и данных используют для связи друг с другом. На этом слое реализована основная функциональность системы.</span><span class="sxs-lookup"><span data-stu-id="c74c5-125">The *business tier* (middle tier) is the layer that the presentation tier and the data tier use to communicate with each other and includes the core functionality of the system.</span></span> |
| <span data-ttu-id="c74c5-126">**Данные**</span><span class="sxs-lookup"><span data-stu-id="c74c5-126">**Data**</span></span> |<span data-ttu-id="c74c5-127">По существу, *уровень данных* представляет собой сервер, на котором хранятся данные приложения (например, сервер под управлением SQL Server).</span><span class="sxs-lookup"><span data-stu-id="c74c5-127">The *data tier* is basically the server that stores an application's data (for example, a server running SQL Server).</span></span> |

<span data-ttu-id="c74c5-128">Под слоями приложений подразумеваются логические группы функций и компонентов в приложении. Уровни же определяют физическое распределение функций и компонентов на отдельных физических серверах, компьютерах, в сетях или удаленных расположениях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-128">Application layers describe the logical groupings of the functionality and components in an application; whereas tiers describe the physical distribution of the functionality and components on separate physical servers, computers, networks, or remote locations.</span></span> <span data-ttu-id="c74c5-129">Слои приложения могут быть размещены на одном физическом компьютере (на одном уровне), а могут быть распределены по разным компьютерам (n-уровневое размещение). Компоненты в каждом слое взаимодействуют с компонентами в других слоях с помощью четко определенных интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-129">The layers of an application may reside on the same physical computer (the same tier) or may be distributed over separate computers (n-tier), and the components in each layer communicate with components in other layers through well-defined interfaces.</span></span> <span data-ttu-id="c74c5-130">В данной статье термин "уровень" относится к моделям физического распределения(пример: модели двухуровневого, трехуровневого и n-уровневого приложений).</span><span class="sxs-lookup"><span data-stu-id="c74c5-130">You can think of the term tier as referring to physical distribution patterns such as two-tier, three-tier, and n-tier.</span></span> <span data-ttu-id="c74c5-131">**Модель двухуровневого приложения** содержит два уровня приложений: сервер приложений и сервер базы данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-131">A **2-tier application pattern** contains two application tiers: application server and database server.</span></span> <span data-ttu-id="c74c5-132">Между сервером приложений и сервером базы данных происходит прямой обмен данными.</span><span class="sxs-lookup"><span data-stu-id="c74c5-132">The direct communication happens between the application server and the database server.</span></span> <span data-ttu-id="c74c5-133">Сервер приложений содержит компоненты веб уровня и бизнес уровня.</span><span class="sxs-lookup"><span data-stu-id="c74c5-133">The application server contains both web-tier and business-tier components.</span></span> <span data-ttu-id="c74c5-134">**Модель трехуровневого приложения** включает три уровня приложений: веб-сервер, сервер приложений (содержит уровень бизнес-логики и компоненты доступа к данным бизнес-уровня) и сервер базы данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-134">In **3-tier application pattern**, there are three application tiers: web server, application server, which contains the business logic tier and/or business tier data access components, and the database server.</span></span> <span data-ttu-id="c74c5-135">Обмен данными между веб-сервером и сервером базы данных происходит через сервер приложений.</span><span class="sxs-lookup"><span data-stu-id="c74c5-135">The communication between the web server and the database server happens over the application server.</span></span> <span data-ttu-id="c74c5-136">Подробные сведения о слоях и уровнях приложений см. в статье [Microsoft Application Architecture Guide](https://msdn.microsoft.com/library/ff650706.aspx) (Руководство по архитектуре приложений Майкрософт).</span><span class="sxs-lookup"><span data-stu-id="c74c5-136">For detailed information on application layers and tiers, see [Microsoft Application Architecture Guide](https://msdn.microsoft.com/library/ff650706.aspx).</span></span>

<span data-ttu-id="c74c5-137">Прежде чем читать данную статью, изучите фундаментальные понятия SQL Server и Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-137">Before you start reading this article, you should have knowledge on the fundamental concepts of SQL Server and Azure.</span></span> <span data-ttu-id="c74c5-138">Дополнительные сведения см. в статьях [Microsoft SQL Server](https://msdn.microsoft.com/library/bb545450.aspx) и [Приступая к работе с SQL Server в виртуальных машинах Azure](virtual-machines-windows-sql-server-iaas-overview.md), а также на веб-сайте [Azure.com](https://azure.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="c74c5-138">For information, see [SQL Server Books Online](https://msdn.microsoft.com/library/bb545450.aspx), [SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md) and [Azure.com](https://azure.microsoft.com/).</span></span>

<span data-ttu-id="c74c5-139">В данной статье рассказывается о нескольких моделях приложений, которые можно использовать как для простых приложений, так и для очень сложных корпоративных приложений.</span><span class="sxs-lookup"><span data-stu-id="c74c5-139">This article describes several application patterns that can be suitable for your simple applications as well as the highly complex enterprise applications.</span></span> <span data-ttu-id="c74c5-140">Перед подробным изучением каждой модели мы рекомендуем ознакомиться с доступными службами хранилищ данных Azure, например со [службой хранилища Azure](../../../storage/common/storage-introduction.md), [Базой данных SQL Azure](../../../sql-database/sql-database-technical-overview.md) и [SQL Server на виртуальной машине Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-140">Before detailing each pattern, we recommend that you should familiarize yourself with the available data storage services in Azure, such as [Azure Storage](../../../storage/common/storage-introduction.md), [Azure SQL Database](../../../sql-database/sql-database-technical-overview.md), and [SQL Server in an Azure Virtual Machine](virtual-machines-windows-sql-server-iaas-overview.md).</span></span> <span data-ttu-id="c74c5-141">Чтобы принять лучшее решение о выборе конструкции приложения, необходимо четко понимать, когда и какие службы хранилищ данных необходимо использовать.</span><span class="sxs-lookup"><span data-stu-id="c74c5-141">To make the best design decisions for your applications, understand when to use which data storage service clearly.</span></span>

### <a name="choose-sql-server-in-an-azure-virtual-machine-when"></a><span data-ttu-id="c74c5-142">Выбирайте SQL Server на виртуальной машине Azure в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-142">Choose SQL Server in an Azure Virtual Machine, when:</span></span>
* <span data-ttu-id="c74c5-143">Вам необходим контроль над SQL Server и Windows.</span><span class="sxs-lookup"><span data-stu-id="c74c5-143">You need control on SQL Server and Windows.</span></span> <span data-ttu-id="c74c5-144">Например, вам может быть необходимо выбрать версию SQL Server, специальные исправления, конфигурацию производительности, и т. д.</span><span class="sxs-lookup"><span data-stu-id="c74c5-144">For example, this might include the SQL Server version, special hotfixes, performance configuration, etc.</span></span>
* <span data-ttu-id="c74c5-145">Требуется полная совместимость с локальным SQL Server, так как необходимо переместить существующие приложения в Azure "как есть".</span><span class="sxs-lookup"><span data-stu-id="c74c5-145">You need a full compatibility with SQL Server on-premises and want to move existing applications to Azure as-is.</span></span>
* <span data-ttu-id="c74c5-146">Вам необходимо использовать возможности среды Azure, но База данных SQL Azure не поддерживает все функции, которые требуются приложению.</span><span class="sxs-lookup"><span data-stu-id="c74c5-146">You want to leverage the capabilities of the Azure environment but Azure SQL Database does not support all the features that your application requires.</span></span> <span data-ttu-id="c74c5-147">Это могут быть указанные ниже возможности.</span><span class="sxs-lookup"><span data-stu-id="c74c5-147">This could include the following areas:</span></span>
  
  * <span data-ttu-id="c74c5-148">**Размер базы данных**: на момент обновления данной статьи, База данных SQL поддерживает базы данных размером до 1 ТБ.</span><span class="sxs-lookup"><span data-stu-id="c74c5-148">**Database size**: At the time this article was updated, SQL Database supports a database of up to 1 TB of data.</span></span> <span data-ttu-id="c74c5-149">Если приложение использует более 1 ТБ данных, и вы не хотите реализовывать собственные решения для сегментирования, рекомендуется использовать SQL Server на виртуальной машине Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-149">If your application requires more than 1 TB of data and you don’t want to implement custom sharding solutions, it’s recommended that you use SQL Server in an Azure Virtual Machine.</span></span> <span data-ttu-id="c74c5-150">Самые актуальные сведения см. в статьях [Развертывание с помощью Базы данных SQL Azure](https://msdn.microsoft.com/library/azure/dn495641.aspx) и [Уровни служб базы данных SQL для отдельных баз данных и пулов эластичных баз данных](../../../sql-database/sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-150">For the latest information, see [Scaling Out Azure SQL Databases](https://msdn.microsoft.com/library/azure/dn495641.aspx) and [Azure SQL Database Service Tiers and Performance Levels](../../../sql-database/sql-database-service-tiers.md).</span></span>
  * <span data-ttu-id="c74c5-151">**Соответствие требованиям HIPAA**. Клиенты из сферы здравоохранения и независимые поставщики программного обеспечения могут предпочесть [SQL Server на виртуальной машине Azure](virtual-machines-windows-sql-server-iaas-overview.md) вместо [базы данных SQL Azure](../../../sql-database/sql-database-technical-overview.md), так как вариант с SQL Server на виртуальной машине Azure оговорен в соглашении с бизнес-партнерами HIPAA.</span><span class="sxs-lookup"><span data-stu-id="c74c5-151">**HIPAA compliance**: Healthcare customers and Independent Software Vendors (ISVs) might choose [SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md) instead of [Azure SQL Database](../../../sql-database/sql-database-technical-overview.md) because SQL Server in an Azure Virtual Machine is covered by HIPAA Business Associate Agreement (BAA).</span></span> <span data-ttu-id="c74c5-152">Сведения о соответствии требованиям см. в [центре управления безопасностью Microsoft Azure](https://azure.microsoft.com/support/trust-center/compliance/) — раздел "Compliance" (Соответствие требованиям).</span><span class="sxs-lookup"><span data-stu-id="c74c5-152">For information on compliance, see [Microsoft Azure Trust Center: Compliance](https://azure.microsoft.com/support/trust-center/compliance/).</span></span>
  * <span data-ttu-id="c74c5-153">**Функции на уровне экземпляра**: в настоящее время База данных SQL не поддерживает функции, находящиеся вне базы данных (например, связанные серверы, задания агентов, файловые потоки, компонент Service Broker и т. д.).</span><span class="sxs-lookup"><span data-stu-id="c74c5-153">**Instance-level features**: At this time, SQL Database doesn’t support features that live outside of the database (such as Linked Servers, Agent jobs, FileStream, Service Broker, etc.).</span></span> <span data-ttu-id="c74c5-154">Дополнительные сведения см. в статье [Общие ограничения и рекомендации для базы данных SQL Azure](https://msdn.microsoft.com/library/azure/ff394102.aspx).</span><span class="sxs-lookup"><span data-stu-id="c74c5-154">For more information, see [Azure SQL Database Guidelines and Limitations](https://msdn.microsoft.com/library/azure/ff394102.aspx).</span></span>

## <a name="1-tier-simple-single-virtual-machine"></a><span data-ttu-id="c74c5-155">Модель простого одноуровневого приложения: одна виртуальная машина</span><span class="sxs-lookup"><span data-stu-id="c74c5-155">1-tier (simple): single virtual machine</span></span>
<span data-ttu-id="c74c5-156">При использовании этой модели приложения выполняется развертывание приложения SQL Server и базы данных на автономной виртуальной машине в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-156">In this application pattern, you deploy your SQL Server application and database to a standalone virtual machine in Azure.</span></span> <span data-ttu-id="c74c5-157">Эта же виртуальная машина содержит клиентское или веб-приложение, бизнес-компоненты, слой доступа к данным и сервер базы данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-157">The same virtual machine contains your client/web application, business components, data access layer, and the database server.</span></span> <span data-ttu-id="c74c5-158">Код уровня представления, бизнес-уровня и уровня доступа к данным логически разделен, но физически размещен на одном и том же компьютере сервера.</span><span class="sxs-lookup"><span data-stu-id="c74c5-158">The presentation, business, and data access code are logically separated but are physically located in a single-server machine.</span></span> <span data-ttu-id="c74c5-159">Большинство клиентов начинает работу с этой модели приложения, а затем выполняет горизонтальное масштабирование, добавляя дополнительные веб-роли или виртуальные машины в систему.</span><span class="sxs-lookup"><span data-stu-id="c74c5-159">Most customers start with this application pattern and then, they scale out by adding more web roles or virtual machines to their system.</span></span>

<span data-ttu-id="c74c5-160">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-160">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-161">Необходимо выполнить простую миграцию на платформу Azure, чтобы оценить, отвечает ли платформа требованиям приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-161">You want to perform a simple migration to Azure platform to evaluate whether the platform answers your application’s requirements or not.</span></span>
* <span data-ttu-id="c74c5-162">Необходимо разместить все уровни приложения в одной виртуальной машине в одном центре обработки данных Azure, чтобы уменьшить задержки при передаче данных между уровнями.</span><span class="sxs-lookup"><span data-stu-id="c74c5-162">You want to keep all the application tiers hosted in the same virtual machine in the same Azure data center to reduce the latency between tiers.</span></span>
* <span data-ttu-id="c74c5-163">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-163">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-164">Необходимо выполнить нагрузочное тестирование для изменяющихся уровней рабочих нагрузок, но при этом вы не хотите постоянно владеть большим количеством компьютеров и обслуживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-164">You want to perform stress testing for varying workload levels but at the same time you do not want to own and maintain many physical machines all the time.</span></span>

<span data-ttu-id="c74c5-165">На схеме ниже показан простой локальный сценарий, а также то, как можно развернуть облачное решение для этого сценария на одной виртуальной машине в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-165">The following diagram demonstrates a simple on-premises scenario and how you can deploy its cloud enabled solution in a single virtual machine in Azure.</span></span>

![Модель одноуровневого приложения](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728008.png)

<span data-ttu-id="c74c5-167">Развертывая бизнес-слой (бизнес-логику и компоненты доступа к данным) на одном физическом уровне со слоем представления, можно добиться максимальной производительности приложений, если только не требуется использовать отдельный уровень из соображений масштабирования или безопасности.</span><span class="sxs-lookup"><span data-stu-id="c74c5-167">Deploying the business layer (business logic and data access components) on the same physical tier as the presentation layer can maximize application performance, unless you must use a separate tier due to scalability or security concerns.</span></span>

<span data-ttu-id="c74c5-168">Так как это очень популярная модель для начала работы, следующая статья о миграции может оказаться полезной при перемещении данных на виртуальную машину SQL Server: [Миграция базы данных SQL Server в экземпляр SQL Server на виртуальной машине Azure](virtual-machines-windows-migrate-sql.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-168">Since this is a very common pattern to start with, you might find the following article on migration useful for moving your data to your SQL Server VM: [Migrating a Database to SQL Server on an Azure VM](virtual-machines-windows-migrate-sql.md).</span></span>

## <a name="3-tier-simple-multiple-virtual-machines"></a><span data-ttu-id="c74c5-169">Модель простого трехуровневого приложения: несколько виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="c74c5-169">3-tier (simple): multiple virtual machines</span></span>
<span data-ttu-id="c74c5-170">При использовании этой модели приложения выполняется развертывание трехуровневого приложения в Azure. При этом каждый уровень приложения размещается на отдельной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="c74c5-170">In this application pattern, you deploy a 3-tier application in Azure by placing each application tier in a different virtual machine.</span></span> <span data-ttu-id="c74c5-171">Это обеспечивает гибкую среду, в которой можно легко выполнить вертикальное и горизонтальное масштабирование.</span><span class="sxs-lookup"><span data-stu-id="c74c5-171">This provides a flexible environment for an easy scale-up and scale-out scenarios.</span></span> <span data-ttu-id="c74c5-172">В то время как одна виртуальная машина содержит клиентское или веб-приложение, на другой размещаются бизнес-компоненты, а на третьей — сервер базы данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-172">When one virtual machine contains your client/web application, the other one hosts your business components, and the other one hosts the database server.</span></span>

<span data-ttu-id="c74c5-173">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-173">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-174">Необходимо выполнить миграцию сложных приложений базы данных на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-174">You want to perform a migration of complex database applications to Azure Virtual Machines.</span></span>
* <span data-ttu-id="c74c5-175">Необходимо, чтобы разные уровни приложения были размещены в разных регионах.</span><span class="sxs-lookup"><span data-stu-id="c74c5-175">You want different application tiers to be hosted in different regions.</span></span> <span data-ttu-id="c74c5-176">Например, у вас могут быть общие базы данных, развернутые в нескольких регионах с целью составления отчетов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-176">For example, you might have shared databases that are deployed to multiple regions for reporting purposes.</span></span>
* <span data-ttu-id="c74c5-177">Необходимо переместить корпоративные приложения из локальных виртуализированных платформ на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-177">You want to move enterprise applications from on-premises virtualized platforms to Azure Virtual Machines.</span></span> <span data-ttu-id="c74c5-178">Подробные сведения о корпоративных приложениях см. в статье [What is an Enterprise Application?](https://msdn.microsoft.com/library/aa267045.aspx) (Основные сведения о корпоративных приложениях).</span><span class="sxs-lookup"><span data-stu-id="c74c5-178">For a detailed discussion on enterprise applications, see [What is an Enterprise Application](https://msdn.microsoft.com/library/aa267045.aspx).</span></span>
* <span data-ttu-id="c74c5-179">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-179">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-180">Необходимо выполнить нагрузочное тестирование для изменяющихся уровней рабочих нагрузок, но при этом вы не хотите постоянно владеть большим количеством компьютеров и обслуживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-180">You want to perform stress testing for varying workload levels but at the same time you do not want to own and maintain many physical machines all the time.</span></span>

<span data-ttu-id="c74c5-181">На схеме ниже показано, как разместить простое трехуровневое приложение в Azure, помещая каждый уровень приложения в отдельную виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="c74c5-181">The following diagram demonstrates how you can place a simple 3-tier application in Azure by placing each application tier in a different virtual machine.</span></span>

![Модель трехуровневого приложения](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728009.png)

<span data-ttu-id="c74c5-183">В этой модели приложения на каждом уровне используется только одна виртуальная машина.</span><span class="sxs-lookup"><span data-stu-id="c74c5-183">In this application pattern, there is only one virtual machine (VM) in each tier.</span></span> <span data-ttu-id="c74c5-184">Если у вас есть несколько виртуальных машин в Azure, мы рекомендуем настроить виртуальную сеть.</span><span class="sxs-lookup"><span data-stu-id="c74c5-184">If you have multiple VMs in Azure, we recommend that you set up a virtual network.</span></span> <span data-ttu-id="c74c5-185">[Виртуальная сеть Azure](../../../virtual-network/virtual-networks-overview.md) создает надежный периметр безопасности и позволяет виртуальным машинам взаимодействовать друг с другом через частный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="c74c5-185">[Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) creates a trusted security boundary and also allows VMs to communicate among themselves over the private IP address.</span></span> <span data-ttu-id="c74c5-186">Кроме того, необходимо всегда проверять, что все подключения к Интернету ведут только на уровень представления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-186">In addition, always make sure that all Internet connections only go to the presentation tier.</span></span> <span data-ttu-id="c74c5-187">При использовании данной модели приложения для контроля доступа управляйте правилами группы безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="c74c5-187">When following this application pattern, manage the network security group rules to control access.</span></span> <span data-ttu-id="c74c5-188">Дополнительные сведения см. в статье [Открытие портов для виртуальной машины в Azure с помощью портала Azure](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c74c5-188">For more information, see [Allow external access to your VM using the Azure portal](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="c74c5-189">На схеме протоколы IP — это протоколы TCP, UDP, HTTP или HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c74c5-189">In the diagram, Internet Protocols can be TCP, UDP, HTTP, or HTTPS.</span></span>

> [!NOTE]
> <span data-ttu-id="c74c5-190">Настройка виртуальной сети в Azure выполняется бесплатно.</span><span class="sxs-lookup"><span data-stu-id="c74c5-190">Setting up a virtual network in Azure is free of charge.</span></span> <span data-ttu-id="c74c5-191">Тем не менее с вас будет взиматься плата за VPN-шлюз, подключаемый к локальной среде.</span><span class="sxs-lookup"><span data-stu-id="c74c5-191">However, you are charged for the VPN gateway that connects to on-premises.</span></span> <span data-ttu-id="c74c5-192">Размер платы зависят от количества времени, на которое это соединение предоставлено и в течение которого оно доступно.</span><span class="sxs-lookup"><span data-stu-id="c74c5-192">This charge is based on the amount of time that connection is provisioned and available.</span></span>
> 
> 

## <a name="2-tier-and-3-tier-with-presentation-tier-scale-out"></a><span data-ttu-id="c74c5-193">Модель двух- и трехуровневого приложений с горизонтальным масштабированием уровня представления</span><span class="sxs-lookup"><span data-stu-id="c74c5-193">2-tier and 3-tier with presentation tier scale-out</span></span>
<span data-ttu-id="c74c5-194">При использовании этой модели приложения выполняется развертывание двух- или трехуровневого приложения базы данных на виртуальных машинах Azure. При этом каждый уровень приложения размещается на отдельной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="c74c5-194">In this application pattern, you deploy 2-tier or 3-tier database application to Azure Virtual Machines by placing each application tier in a different virtual machine.</span></span> <span data-ttu-id="c74c5-195">Кроме того, можно горизонтально масштабировать уровень представления при увеличении объема входящих клиентских запросов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-195">In addition, you scale out the presentation tier due to increased volume of incoming client requests.</span></span>

<span data-ttu-id="c74c5-196">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-196">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-197">Необходимо переместить корпоративные приложения из локальных виртуализированных платформ на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-197">You want to move enterprise applications from on-premises virtualized platforms to Azure Virtual Machines.</span></span>
* <span data-ttu-id="c74c5-198">Необходимо горизонтально масштабировать уровень представления при увеличении объема входящих клиентских запросов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-198">You want to scale out the presentation tier due to increased volume of incoming client requests.</span></span>
* <span data-ttu-id="c74c5-199">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-199">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-200">Необходимо выполнить нагрузочное тестирование для изменяющихся уровней рабочих нагрузок, но при этом вы не хотите постоянно владеть большим количеством компьютеров и обслуживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-200">You want to perform stress testing for varying workload levels but at the same time you do not want to own and maintain many physical machines all the time.</span></span>
* <span data-ttu-id="c74c5-201">Необходимо владеть инфраструктурой, масштаб которой можно увеличивать или уменьшать по требованию.</span><span class="sxs-lookup"><span data-stu-id="c74c5-201">You want to own an infrastructure environment that can scale up and down on demand.</span></span>

<span data-ttu-id="c74c5-202">На схеме ниже показано, как разместить уровни приложений на нескольких виртуальных машинах в Azure путем горизонтального масштабирования уровня представления при увеличении объема входящих клиентских запросов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-202">The following diagram demonstrates how you can place the application tiers in multiple virtual machines in Azure by scaling out the presentation tier due to increased volume of incoming client requests.</span></span> <span data-ttu-id="c74c5-203">Как показано на схеме, балансировщик нагрузки Azure отвечает за распределение трафика по нескольким виртуальным машинам и определяет, к какому веб-серверу следует подключиться.</span><span class="sxs-lookup"><span data-stu-id="c74c5-203">As seen in the diagram, Azure Load Balancer is responsible for distributing traffic across multiple virtual machines and also determining which web server to connect to.</span></span> <span data-ttu-id="c74c5-204">Наличие нескольких экземпляров веб-серверов за балансировщиком нагрузки обеспечивает высокий уровень доступности уровня представления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-204">Having multiple instances of the web servers behind a load balancer ensures the high availability of the presentation tier.</span></span>

![Модель приложения: горизонтальное масштабирование уровня представления](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728010.png)

### <a name="best-practices-for-2-tier-3-tier-or-n-tier-patterns-that-have-multiple-vms-in-one-tier"></a><span data-ttu-id="c74c5-206">Рекомендации для моделей двух-, трех- и n-уровневых приложений с несколькими виртуальными машинами на одном уровне</span><span class="sxs-lookup"><span data-stu-id="c74c5-206">Best practices for 2-tier, 3-tier, or n-tier patterns that have multiple VMs in one tier</span></span>
<span data-ttu-id="c74c5-207">Рекомендуется размещать виртуальные машины, принадлежащие одному уровню, в одной и той же облачной службе и в одной и той же группе доступности.</span><span class="sxs-lookup"><span data-stu-id="c74c5-207">It’s recommended that you place the virtual machines that belong to the same tier in the same cloud service and in the same the availability set.</span></span> <span data-ttu-id="c74c5-208">Например, вы можете поместить набор веб-серверов в облачную службу **CloudService1** и группу доступности **AvailabilitySet1**, а набор серверов баз данных — в облачную службу **CloudService2** и группу доступности **AvailabilitySet2**.</span><span class="sxs-lookup"><span data-stu-id="c74c5-208">For example, place a set of web servers in **CloudService1** and **AvailabilitySet1** and a set of database servers in **CloudService2** and **AvailabilitySet2**.</span></span> <span data-ttu-id="c74c5-209">Группа доступности в Azure позволяет помещать узлы с высоким уровнем доступности в отдельные домены сбоя и обновления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-209">An availability set in Azure enables you to place the high availability nodes into separate fault domains and upgrade domains.</span></span>

<span data-ttu-id="c74c5-210">Чтобы использовать несколько экземпляров виртуальных машин какого-либо уровня, необходимо настроить балансировщик нагрузки Azure между уровнями приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-210">To leverage multiple VM instances of a tier, you need to configure Azure Load Balancer between application tiers.</span></span> <span data-ttu-id="c74c5-211">Чтобы настроить балансировщик нагрузки на каждом уровне, создайте конечные точки с балансировкой нагрузки отдельно для виртуальных машин каждого уровня.</span><span class="sxs-lookup"><span data-stu-id="c74c5-211">To configure Load Balancer in each tier, create a load-balanced endpoint on each tier’s VMs separately.</span></span> <span data-ttu-id="c74c5-212">Для конкретного уровня сначала создайте виртуальные машины в той же облачной службе.</span><span class="sxs-lookup"><span data-stu-id="c74c5-212">For a specific tier, first create VMs in the same cloud service.</span></span> <span data-ttu-id="c74c5-213">В результате они гарантированно будут иметь одинаковый общедоступный виртуальный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="c74c5-213">This ensures that they have the same public Virtual IP address.</span></span> <span data-ttu-id="c74c5-214">Затем создайте конечную точку на одной из виртуальных машин на этом уровне.</span><span class="sxs-lookup"><span data-stu-id="c74c5-214">Next, create an endpoint on one of the virtual machines on that tier.</span></span> <span data-ttu-id="c74c5-215">Далее для балансировки нагрузки назначьте эту конечную точку другим виртуальным машинам на этом уровне.</span><span class="sxs-lookup"><span data-stu-id="c74c5-215">Then, assign the same endpoint to the other virtual machines on that tier for load balancing.</span></span> <span data-ttu-id="c74c5-216">После создания набора с балансировкой нагрузки трафик будет распределяться по нескольким виртуальным машинам, а балансировщик нагрузки сможет определять, какой узел подключать при сбое внутреннего узла виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c74c5-216">By creating a load-balanced set, you distribute traffic across multiple virtual machines and also allow the Load Balancer to determine which node to connect when a backend VM node fails.</span></span> <span data-ttu-id="c74c5-217">Например, наличие нескольких экземпляров веб-серверов за балансировщиком нагрузки обеспечивает высокий уровень доступности уровня представления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-217">For example, having multiple instances of the web servers behind a load balancer ensures the high availability of the presentation tier.</span></span>

<span data-ttu-id="c74c5-218">Рекомендуется всегда проверять, что все подключения к Интернету сначала ведут на уровень представления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-218">As a best practice, always make sure that all internet connections first go to the presentation tier.</span></span> <span data-ttu-id="c74c5-219">Уровень представления получает доступ к бизнес-уровню, а затем бизнес-уровень получает доступ к уровню данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-219">The presentation layer accesses the business tier, and then the business tier accesses the data tier.</span></span> <span data-ttu-id="c74c5-220">Дополнительные сведения о том, как разрешить доступ к уровню представления данных см. в статье [Открытие портов для виртуальной машины в Azure с помощью портала Azure](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c74c5-220">For more information on how to allow access to the presentation layer, see [Allow external access to your VM using the Azure portal](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="c74c5-221">Обратите внимание, что балансировщик нагрузки в Azure работает аналогично балансировщикам нагрузки в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="c74c5-221">Note that the Load Balancer in Azure works similar to load balancers in an on-premises environment.</span></span> <span data-ttu-id="c74c5-222">Дополнительные сведения см. в статье [Балансировка нагрузки для служб инфраструктуры Azure](../tutorial-load-balancer.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c74c5-222">For more information, see [Load balancing for Azure infrastructure services](../tutorial-load-balancer.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="c74c5-223">Кроме того, мы рекомендуем настроить частную сеть для ваших виртуальных машин с помощью виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-223">In addition, we recommend that you set up a private network for your virtual machines by using Azure Virtual Network.</span></span> <span data-ttu-id="c74c5-224">Это позволит виртуальным машинам обмениваться друг с другом данными через частный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="c74c5-224">This allows them to communicate among themselves over the private IP address.</span></span> <span data-ttu-id="c74c5-225">Дополнительные сведения см. в статье [Обзор виртуальной сети](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-225">For more information, see [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).</span></span>

## <a name="2-tier-and-3-tier-with-business-tier-scale-out"></a><span data-ttu-id="c74c5-226">Модель двух- и трехуровневых приложений с горизонтальным масштабированием бизнес-уровня</span><span class="sxs-lookup"><span data-stu-id="c74c5-226">2-tier and 3-tier with business tier scale-out</span></span>
<span data-ttu-id="c74c5-227">При использовании этой модели приложения выполняется развертывание двух- или трехуровневого приложения базы данных на виртуальных машинах Azure. При этом каждый уровень приложения размещается на отдельной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="c74c5-227">In this application pattern, you deploy 2-tier or 3-tier database application to Azure Virtual Machines by placing each application tier in a different virtual machine.</span></span> <span data-ttu-id="c74c5-228">Кроме того, из-за сложности приложения вам может потребоваться распределить компоненты сервера приложений по нескольким виртуальным машинам.</span><span class="sxs-lookup"><span data-stu-id="c74c5-228">In addition, you might want to distribute the application server components to multiple virtual machines due to the complexity of your application.</span></span>

<span data-ttu-id="c74c5-229">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-229">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-230">Необходимо переместить корпоративные приложения из локальных виртуализированных платформ на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-230">You want to move enterprise applications from on-premises virtualized platforms to Azure Virtual Machines.</span></span>
* <span data-ttu-id="c74c5-231">Из-за сложности приложения необходимо распределить компоненты сервера приложений по нескольким виртуальным машинам.</span><span class="sxs-lookup"><span data-stu-id="c74c5-231">You want to distribute the application server components to multiple virtual machines due to the complexity of your application.</span></span>
* <span data-ttu-id="c74c5-232">Необходимо переместить локальные бизнес-приложения с серьезной нагрузкой бизнес-логики на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-232">You want to move business logic heavy on-premises LOB (line-of-business) applications to Azure Virtual Machines.</span></span> <span data-ttu-id="c74c5-233">Бизнес-приложения — это набор критически важных компьютерных приложений, необходимых для работы предприятия. Например, это могут быть приложения для учета, отдела кадров, расчета заработной платы, управления логистическими цепочками и планирования ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-233">LOB applications are a set of critical computer applications that are vital to running an enterprise, such as accounting, human resources (HR), payroll, supply chain management, and resource planning applications.</span></span>
* <span data-ttu-id="c74c5-234">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-234">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-235">Необходимо выполнить нагрузочное тестирование для изменяющихся уровней рабочих нагрузок, но при этом вы не хотите постоянно владеть большим количеством компьютеров и обслуживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-235">You want to perform stress testing for varying workload levels but at the same time you do not want to own and maintain many physical machines all the time.</span></span>
* <span data-ttu-id="c74c5-236">Необходимо владеть инфраструктурой, масштаб которой можно увеличивать или уменьшать по требованию.</span><span class="sxs-lookup"><span data-stu-id="c74c5-236">You want to own an infrastructure environment that can scale up and down on demand.</span></span>

<span data-ttu-id="c74c5-237">На схеме ниже показан локальный сценарий и облачное решение для него.</span><span class="sxs-lookup"><span data-stu-id="c74c5-237">The following diagram demonstrates an on-premises scenario and its cloud enabled solution.</span></span> <span data-ttu-id="c74c5-238">В этом сценарии уровни приложения размещаются на нескольких виртуальных машинах в Azure, при этом выполняется горизонтальное масштабирование бизнес-уровня, содержащего уровень бизнес-логики и компоненты доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="c74c5-238">In this scenario, you place the application tiers in multiple virtual machines in Azure by scaling out the business tier, which contains the business logic tier and data access components.</span></span> <span data-ttu-id="c74c5-239">Как показано на схеме, балансировщик нагрузки Azure отвечает за распределение трафика по нескольким виртуальным машинам и определяет, к какому веб-серверу следует подключиться.</span><span class="sxs-lookup"><span data-stu-id="c74c5-239">As seen in the diagram, Azure Load Balancer is responsible for distributing traffic across multiple virtual machines and also determining which web server to connect to.</span></span> <span data-ttu-id="c74c5-240">Наличие нескольких экземпляров серверов приложений за балансировщиком нагрузки обеспечивает высокий уровень доступности бизнес-уровня.</span><span class="sxs-lookup"><span data-stu-id="c74c5-240">Having multiple instances of the application servers behind a load balancer ensures the high availability of the business tier.</span></span> <span data-ttu-id="c74c5-241">Дополнительные сведения см. в разделе [Рекомендации для моделей двух-, трех- и n-уровневых приложений с несколькими виртуальными машинами на одном уровне](#best-practices-for-2-tier-3-tier-or-n-tier-patterns-that-have-multiple-vms-in-one-tier).</span><span class="sxs-lookup"><span data-stu-id="c74c5-241">For more information, see [Best practices for 2-tier, 3-tier, or n-tier application patterns that have multiple virtual machines in one tier](#best-practices-for-2-tier-3-tier-or-n-tier-patterns-that-have-multiple-vms-in-one-tier).</span></span>

![Модель приложения с горизонтальным масштабированием бизнес-уровня](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728011.png)

## <a name="2-tier-and-3-tier-with-presentation-and-business-tiers-scale-out-and-hadr"></a><span data-ttu-id="c74c5-243">Модель двух- и трехуровневых приложений с горизонтальным масштабированием уровня представления и бизнес-уровня и HADR</span><span class="sxs-lookup"><span data-stu-id="c74c5-243">2-tier and 3-tier with presentation and business tiers scale-out and HADR</span></span>
<span data-ttu-id="c74c5-244">В этой модели приложения выполняется развертывание двух- или трехуровневого приложение баз данных на виртуальных машинах Azure. При этом компоненты уровня представления (веб-сервер) и бизнес-уровня (сервер приложений) распределяются по нескольким виртуальным машинам.</span><span class="sxs-lookup"><span data-stu-id="c74c5-244">In this application pattern, you deploy 2-tier or 3-tier database application to Azure Virtual Machines by distributing the presentation tier (web server) and the business tier (application server) components to multiple virtual machines.</span></span> <span data-ttu-id="c74c5-245">Кроме того, вы можете реализовать решения для обеспечения высокого уровня доступности и аварийного восстановления баз данных на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-245">In addition, you implement high-availability and disaster recovery solutions for your databases in Azure virtual machines.</span></span>

<span data-ttu-id="c74c5-246">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-246">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-247">Необходимо переместить корпоративные приложения с локальных виртуализированных платформ в Azure путем реализации возможностей обеспечения высокого уровня доступности SQL Server и аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-247">You want to move enterprise applications from virtualized platforms on-premises to Azure by implementing SQL Server high availability and disaster recovery capabilities.</span></span>
* <span data-ttu-id="c74c5-248">Необходимо выполнять горизонтальное масштабирование уровня представления и бизнес-уровня из-за увеличения объема входящих клиентских запросов и сложности приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-248">You want to scale out the presentation tier and the business tier due to increased volume of incoming client requests and the complexity of your application.</span></span>
* <span data-ttu-id="c74c5-249">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-249">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-250">Необходимо выполнить нагрузочное тестирование для изменяющихся уровней рабочих нагрузок, но при этом вы не хотите постоянно владеть большим количеством компьютеров и обслуживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-250">You want to perform stress testing for varying workload levels but at the same time you do not want to own and maintain many physical machines all the time.</span></span>
* <span data-ttu-id="c74c5-251">Необходимо владеть инфраструктурой, масштаб которой можно увеличивать или уменьшать по требованию.</span><span class="sxs-lookup"><span data-stu-id="c74c5-251">You want to own an infrastructure environment that can scale up and down on demand.</span></span>

<span data-ttu-id="c74c5-252">На схеме ниже показан локальный сценарий и облачное решение для него.</span><span class="sxs-lookup"><span data-stu-id="c74c5-252">The following diagram demonstrates an on-premises scenario and its cloud enabled solution.</span></span> <span data-ttu-id="c74c5-253">В этом сценарии выполняется горизонтальное масштабирование компонентов уровня представления и бизнес-уровня на нескольких виртуальных машинах в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-253">In this scenario, you scale out the presentation tier and the business tier components in multiple virtual machines in Azure.</span></span> <span data-ttu-id="c74c5-254">Кроме того, вы можете реализовать методы высокого уровня доступности и аварийного восстановления (HADR) для баз данных SQL Server в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-254">In addition, you implement high availability and disaster recovery (HADR) techniques for SQL Server databases in Azure.</span></span>

<span data-ttu-id="c74c5-255">Если несколько копий приложения работают на разных виртуальных машинах, то для них выполняется балансировка нагрузки по обработке запросов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-255">Running multiple copies of an application in different VMs make sure that you are load balancing requests across them.</span></span> <span data-ttu-id="c74c5-256">При наличии нескольких виртуальных машин необходимо обеспечить доступность всех виртуальных машин и их одновременную работу.</span><span class="sxs-lookup"><span data-stu-id="c74c5-256">When you have multiple virtual machines, you need to make sure that all your VMs are accessible and running at one point in time.</span></span> <span data-ttu-id="c74c5-257">Если вы настроите функцию балансировки нагрузки, то Azure Load Balancer будет отслеживать работоспособность виртуальных машин и соответствующим образом направлять входящие вызовы в полноценно функционирующие узлы виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c74c5-257">If you configure load balancing, Azure Load Balancer tracks the health of VMs and directs incoming calls to the healthy functioning VM nodes properly.</span></span> <span data-ttu-id="c74c5-258">Сведения о настройке балансировки нагрузки виртуальных машин см. в статье [Балансировка нагрузки для служб инфраструктуры Azure](../tutorial-load-balancer.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c74c5-258">For information on how to set up load balancing of the virtual machines, see [Load balancing for Azure infrastructure services](../tutorial-load-balancer.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span> <span data-ttu-id="c74c5-259">При наличии нескольких экземпляров веб-серверов и серверов приложений за балансировщиком нагрузки обеспечивает высокий уровень доступности уровня представления и бизнес-уровня.</span><span class="sxs-lookup"><span data-stu-id="c74c5-259">Having multiple instances of web and application servers behind a load balancer ensures the high availability of the presentation and business tiers.</span></span>

![Горизонтальное масштабирование и высокий уровень доступности](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728012.png)

### <a name="best-practices-for-application-patterns-requiring-sql-hadr"></a><span data-ttu-id="c74c5-261">Рекомендации для моделей приложений, требующих HADR SQL</span><span class="sxs-lookup"><span data-stu-id="c74c5-261">Best practices for application patterns requiring SQL HADR</span></span>
<span data-ttu-id="c74c5-262">Если вы устанавливаете решения по обеспечению высокого уровня доступности и аварийного восстановления SQL Server на виртуальных машинах Azure, то вам также необходимо настроить виртуальную сеть для ваших виртуальных машин с помощью [виртуальной сети Azure](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-262">When you set up SQL Server high availability and disaster recovery solutions in Azure Virtual Machines, setting up a virtual network for your virtual machines using [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) is mandatory.</span></span>  <span data-ttu-id="c74c5-263">Виртуальные машины в виртуальной сети будут иметь постоянный частный IP-адрес даже после простоя службы. Таким образом, можно избежать времени обновления, необходимого для разрешения имен DNS.</span><span class="sxs-lookup"><span data-stu-id="c74c5-263">Virtual machines within a Virtual Network will have a stable private IP address even after a service downtime, thus you can avoid the update time required for DNS name resolution.</span></span> <span data-ttu-id="c74c5-264">Кроме того, виртуальная сеть позволяет расширить локальную сеть в Azure и создает надежный периметр безопасности.</span><span class="sxs-lookup"><span data-stu-id="c74c5-264">In addition, the virtual network allows you to extend your on-premises network to Azure and creates a trusted security boundary.</span></span> <span data-ttu-id="c74c5-265">Например, если для приложения действуют ограничения корпоративного домена (такие как аутентификация Windows или Active Directory), то необходимо настроить [виртуальную сеть Azure](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-265">For example, if your application has corporate domain restrictions (such as, Windows authentication, Active Directory), setting up [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) is necessary.</span></span>

<span data-ttu-id="c74c5-266">Большинство клиентов, выполняющих рабочий код в Azure, хранят и основную, и дополнительную реплики в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-266">Most of customers, who are running production code on Azure, are keeping both primary and secondary replicas in Azure.</span></span>

<span data-ttu-id="c74c5-267">Подробные сведения и учебники по обеспечению высокого уровня доступности и аварийного восстановления см. в статье [Высокий уровень доступности и аварийное восстановление для SQL Server на виртуальных машинах Azure](virtual-machines-windows-sql-high-availability-dr.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-267">For comprehensive information and tutorials on high availability and disaster recovery techniques, see [High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-high-availability-dr.md).</span></span>

## <a name="2-tier-and-3-tier-using-azure-vms-and-cloud-services"></a><span data-ttu-id="c74c5-268">Модель двух- и трехуровневых приложений, использующих виртуальные машины Azure и облачные службы</span><span class="sxs-lookup"><span data-stu-id="c74c5-268">2-tier and 3-tier using Azure VMs and Cloud Services</span></span>
<span data-ttu-id="c74c5-269">В этой модели приложения выполняется развертывание двух- или трехуровневого приложения в Azure с помощью [облачных служб Azure](../../../cloud-services/cloud-services-choose-me.md#tellmecs) (веб и рабочая роли — платформа как услуга (PaaS)) и [виртуальных машин Azure](../overview.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) (инфраструктура как услуга (IaaS)).</span><span class="sxs-lookup"><span data-stu-id="c74c5-269">In this application pattern, you deploy 2-tier or 3-tier application to Azure by using both [Azure Cloud Services](../../../cloud-services/cloud-services-choose-me.md#tellmecs) (web and worker roles - Platform as a Service (PaaS)) and [Azure Virtual Machines](../overview.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) (Infrastructure as a Service (IaaS)).</span></span> <span data-ttu-id="c74c5-270">Вариант, когда [облачные службы Azure](https://azure.microsoft.com/documentation/services/cloud-services/) используются для уровня представления или бизнес-уровня, а SQL Server на [виртуальных машинах Azure](../overview.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) — для уровня данных, хорошо подходит для большинства приложений, работающих в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-270">Using [Azure Cloud Services](https://azure.microsoft.com/documentation/services/cloud-services/) for the presentation tier/business tier and SQL Server in [Azure Virtual Machines](../overview.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) for the data tier is beneficial for most applications running on Azure.</span></span> <span data-ttu-id="c74c5-271">Причина состоит в том, что наличие вычислительной операции, работающей в облачных службах, упрощает управление, развертывание, отслеживание и горизонтальное масштабирование.</span><span class="sxs-lookup"><span data-stu-id="c74c5-271">The reason is that having a compute instance running on Cloud Services provides an easy management, deployment, monitoring, and scale-out.</span></span>

<span data-ttu-id="c74c5-272">Благодаря облачным службам Azure поддерживает инфраструктуру, выполняет плановое обслуживание, применяет исправления для операционных систем и выполняет восстановление после сбоев служб и аппаратных сбоев.</span><span class="sxs-lookup"><span data-stu-id="c74c5-272">With Cloud Services, Azure maintains the infrastructure for you, performs routine maintenance, patches the operating systems, and attempts to recover from service and hardware failures.</span></span> <span data-ttu-id="c74c5-273">Если приложению необходимо горизонтальное масштабирование, для вашего проекта облачной службы можно использовать как ручные, так и автоматические функции горизонтального масштабирования путем увеличения или уменьшения количества экземпляров или виртуальных машин, используемых приложением.</span><span class="sxs-lookup"><span data-stu-id="c74c5-273">When your application needs scale-out, automatic, and manual scale-out options are available for your cloud service project by increasing or decreasing the number of instances or virtual machines that are used by your application.</span></span> <span data-ttu-id="c74c5-274">Кроме того, можно использовать локальный Visual Studio для развертывания приложения в проекте облачной службы в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-274">In addition, you can use on-premises Visual Studio to deploy your application to a cloud service project in Azure.</span></span>

<span data-ttu-id="c74c5-275">Таким образом, если вы не хотите выполнять широкомасштабные административные задачи для уровня представления или бизнес-уровня и вашему приложению не требуется сложная конфигурация программного обеспечения или операционной системы, используйте облачные службы Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-275">In summary, if you don’t want to own extensive administrative tasks for the presentation/business tier and your application does not require any complex configuration of software or the operating system, use Azure Cloud Services.</span></span> <span data-ttu-id="c74c5-276">Если База данных SQL Azure не поддерживает все функции, которые вам необходимы, то для уровня данных используйте SQL Server на виртуальной машине Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-276">If Azure SQL Database does not support all the features you are looking for, use SQL Server in an Azure Virtual Machine for the data tier.</span></span> <span data-ttu-id="c74c5-277">Выполняя приложения в облачных службах Azure и храня данных на виртуальных машинах Azure, можно сочетать преимущества обеих служб.</span><span class="sxs-lookup"><span data-stu-id="c74c5-277">Running an application on Azure Cloud Services and storing data in Azure Virtual Machines combines the benefits of both services.</span></span> <span data-ttu-id="c74c5-278">Подробное сравнение см. в разделе [Сравнение стратегий веб-разработки в Azure](#comparing-web-development-strategies-in-azure) данной статьи.</span><span class="sxs-lookup"><span data-stu-id="c74c5-278">For a detailed comparison, see the section in this topic on [Comparing development strategies in Azure](#comparing-web-development-strategies-in-azure).</span></span>

<span data-ttu-id="c74c5-279">В этой модели приложения уровень представления включает веб-роль, представляющую собой компонент облачных служб, который работает в среде выполнения Azure. Этот компонент настроен для программирования веб-приложений с поддержкой IIS и ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c74c5-279">In this application pattern, the presentation tier includes a web role, which is a Cloud Services component running in the Azure execution environment and it is customized for web application programming as supported by IIS and ASP.NET.</span></span> <span data-ttu-id="c74c5-280">Бизнес-уровень или внутренний уровень включает рабочую роль,представляющую собой компонент облачных служб, который работает в среде выполнения Azure. Этот компонент удобно использовать для общей разработки. Кроме того, он может выполнять фоновую обработку для веб-роли.</span><span class="sxs-lookup"><span data-stu-id="c74c5-280">The business or backend tier includes a worker role, which is a Cloud Services component running in the Azure execution environment and it is useful for generalized development, and may perform background processing for a web role.</span></span> <span data-ttu-id="c74c5-281">Уровень базы данных находится на виртуальной машине SQL Server в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-281">The database tier resides in a SQL Server virtual machine in Azure.</span></span> <span data-ttu-id="c74c5-282">Обмен данными между уровнем представления и уровнем базы данных происходит напрямую или через бизнес-уровень, представляющий собой компоненты рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="c74c5-282">The communication between the presentation tier and the database tier happens directly or over the business tier – worker role components.</span></span>

<span data-ttu-id="c74c5-283">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-283">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-284">Необходимо переместить корпоративные приложения с локальных виртуализированных платформ в Azure путем реализации возможностей обеспечения высокого уровня доступности SQL Server и аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-284">You want to move enterprise applications from virtualized platforms on-premises to Azure by implementing SQL Server high availability and disaster recovery capabilities.</span></span>
* <span data-ttu-id="c74c5-285">Необходимо владеть инфраструктурой, масштаб которой можно увеличивать или уменьшать по требованию.</span><span class="sxs-lookup"><span data-stu-id="c74c5-285">You want to own an infrastructure environment that can scale up and down on demand.</span></span>
* <span data-ttu-id="c74c5-286">База данных SQL Azure поддерживает не все функции, необходимые для вашего приложения или базы данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-286">Azure SQL Database does not support all the features that your application or database needs.</span></span>
* <span data-ttu-id="c74c5-287">Необходимо выполнить нагрузочное тестирование для изменяющихся уровней рабочих нагрузок, но при этом вы не хотите постоянно владеть большим количеством компьютеров и обслуживать их.</span><span class="sxs-lookup"><span data-stu-id="c74c5-287">You want to perform stress testing for varying workload levels but at the same time you do not want to own and maintain many physical machines all the time.</span></span>

<span data-ttu-id="c74c5-288">На схеме ниже показан локальный сценарий и облачное решение для него.</span><span class="sxs-lookup"><span data-stu-id="c74c5-288">The following diagram demonstrates an on-premises scenario and its cloud enabled solution.</span></span> <span data-ttu-id="c74c5-289">В этом сценарии уровень представления размещается в веб-ролях, бизнес-уровень — в рабочих ролях, а уровень данных — на виртуальных машинах в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-289">In this scenario, you place the presentation tier in web roles, the business tier in worker roles but the data tier in virtual machines in Azure.</span></span> <span data-ttu-id="c74c5-290">При работе нескольких копий уровня представления в разных веб-ролях между ними будет выполняться балансировка нагрузки по обработке запросов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-290">Running multiple copies of the presentation tier in different web roles ensures to load balance requests across them.</span></span> <span data-ttu-id="c74c5-291">При совместном использовании облачных служб Azure с виртуальными машинами Azure рекомендуется также настроить [виртуальную сеть Azure](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-291">When you combine Azure Cloud Services with Azure Virtual Machines, we recommend that you set up [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) as well.</span></span> <span data-ttu-id="c74c5-292">С [ее помощью](../../../virtual-network/virtual-networks-overview.md) вы получите стабильные и постоянные частные IP-адреса в рамках одной облачной службы в облаке.</span><span class="sxs-lookup"><span data-stu-id="c74c5-292">With [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md), you can have stable and persistent private IP addresses within the same cloud service in the cloud.</span></span> <span data-ttu-id="c74c5-293">После определения виртуальной сети для виртуальных машин и облачных служб они смогут обмениваться данными друг с другом через частный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="c74c5-293">Once you define a virtual network for your virtual machines and cloud services, they can start communicating among themselves over the private IP address.</span></span> <span data-ttu-id="c74c5-294">Кроме того, если виртуальные машины, веб-роли и рабочие роли Azure находятся в одной [виртуальной сети Azure](../../../virtual-network/virtual-networks-overview.md), то обеспечиваются низкие задержки при обмене данными и более безопасное подключение.</span><span class="sxs-lookup"><span data-stu-id="c74c5-294">In addition, having virtual machines and Azure web/worker roles in the same [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) provides low latency and more secure connectivity.</span></span> <span data-ttu-id="c74c5-295">Дополнительные сведения см. в статье [Стоит ли сделать выбор в пользу облачных служб или чего-то другого?](../../../cloud-services/cloud-services-choose-me.md)</span><span class="sxs-lookup"><span data-stu-id="c74c5-295">For more information, see [What is a cloud service](../../../cloud-services/cloud-services-choose-me.md).</span></span>

<span data-ttu-id="c74c5-296">Как показано на схеме, балансировщик нагрузки Azure распределяет трафик по нескольким виртуальным машинам, а также определяет, к какому веб-серверу или серверу приложений необходимо подключиться.</span><span class="sxs-lookup"><span data-stu-id="c74c5-296">As seen in the diagram, Azure Load Balancer distributes traffic across multiple virtual machines and also determines which web server or application server to connect to.</span></span> <span data-ttu-id="c74c5-297">Наличие нескольких экземпляров веб-серверов и серверов приложений за балансировщиком нагрузки обеспечивает высокий уровень доступности уровня представления и бизнес-уровня.</span><span class="sxs-lookup"><span data-stu-id="c74c5-297">Having multiple instances of the web and application servers behind a load balancer ensures the high availability of the presentation tier and the business tier.</span></span> <span data-ttu-id="c74c5-298">Дополнительные сведения см. в разделе [Рекомендации для моделей приложений, требующих HADR SQL](#best-practices-for-application-patterns-requiring-sql-hadr).</span><span class="sxs-lookup"><span data-stu-id="c74c5-298">For more information, see [Best practices for application patterns requiring SQL HADR](#best-practices-for-application-patterns-requiring-sql-hadr).</span></span>

![Модели приложений с использованием облачных служб](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728013.png)

<span data-ttu-id="c74c5-300">Другой подход к реализации этой модели приложения состоит в использовании консолидированной веб-роли, содержащей компоненты уровня представления и бизнес-уровня, как показано на схеме ниже.</span><span class="sxs-lookup"><span data-stu-id="c74c5-300">Another approach to implement this application pattern is to use a consolidated web role that contains both presentation tier and business tier components as shown in the following diagram.</span></span> <span data-ttu-id="c74c5-301">Эта модель приложения подходит для приложений, которым требуется конструкция с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="c74c5-301">This application pattern is useful for applications that require stateful design.</span></span> <span data-ttu-id="c74c5-302">Так как для веб-ролей и рабочих ролей Azure предоставляет вычислительные узлы без отслеживания состояния, мы рекомендуем реализовать логику для хранения состояний сеансов с помощью одной из следующих технологий: [кэширование Azure](https://azure.microsoft.com/documentation/services/redis-cache/), [табличное хранилище Azure](../../../cosmos-db/table-storage-how-to-use-dotnet.md) или [База данных SQL Azure](../../../sql-database/sql-database-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-302">Since Azure provides stateless compute nodes on web and worker roles, we recommend that you implement a logic to store session state using one of the following technologies: [Azure Caching](https://azure.microsoft.com/documentation/services/redis-cache/), [Azure Table Storage](../../../cosmos-db/table-storage-how-to-use-dotnet.md) or [Azure SQL Database](../../../sql-database/sql-database-technical-overview.md).</span></span>

![Модели приложений с использованием облачных служб](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728014.png)

## <a name="pattern-with-azure-vms-azure-sql-database-and-azure-app-service-web-apps"></a><span data-ttu-id="c74c5-304">Модель с виртуальными машинами Azure, базой данных SQL Azure и службой приложений Azure (веб-приложениями Azure)</span><span class="sxs-lookup"><span data-stu-id="c74c5-304">Pattern with Azure VMs, Azure SQL Database, and Azure App Service (Web Apps)</span></span>
<span data-ttu-id="c74c5-305">Основная цель этой модели приложения — показать, как в вашем решении можно объединить компоненты "инфраструктура как услуга" в Azure с компонентами "платформа как услуга" в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-305">The primary goal of this application pattern is to show you how to combine Azure infrastructure as a service (IaaS) components with Azure platform-as-a-service components (PaaS) in your solution.</span></span> <span data-ttu-id="c74c5-306">Эта модель предназначена для Базы данных SQL Azure, хранящей реляционные данные.</span><span class="sxs-lookup"><span data-stu-id="c74c5-306">This pattern is focused on Azure SQL Database for relational data storage.</span></span> <span data-ttu-id="c74c5-307">Она не включает SQL Server на виртуальной машине Azure, который является частью предложения "инфраструктура как услуга" в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-307">It does not include SQL Server in an Azure virtual machine, which is part of the Azure infrastructure as a service offering.</span></span>

<span data-ttu-id="c74c5-308">В этой модели приложения выполняется развертывание приложения базы данных в Azure путем размещения уровня представления и бизнес-уровня в одной виртуальной машине и получения доступа к базе данных на серверах Базы данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-308">In this application pattern, you deploy a database application to Azure by placing the presentation and business tiers in the same virtual machine and accessing a database in Azure SQL Database (SQL Database) servers.</span></span> <span data-ttu-id="c74c5-309">Уровень представления можно реализовать с помощью традиционных веб-решений на основе IIS.</span><span class="sxs-lookup"><span data-stu-id="c74c5-309">You can implement the presentation tier by using traditional IIS-based web solutions.</span></span> <span data-ttu-id="c74c5-310">Кроме того, вы можете объединить уровень представления и бизнес-уровень, используя [веб-приложения Azure](https://azure.microsoft.com/documentation/services/app-service/web/).</span><span class="sxs-lookup"><span data-stu-id="c74c5-310">Or, you can implement a combined presentation and business tier by using [Azure Web Apps](https://azure.microsoft.com/documentation/services/app-service/web/).</span></span>

<span data-ttu-id="c74c5-311">Эту модель приложения удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-311">This application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-312">У вас уже есть сервер Базы данных SQL, настроенный в Azure, и необходимо быстро протестировать приложение.</span><span class="sxs-lookup"><span data-stu-id="c74c5-312">You already have an existing SQL Database server configured in Azure and you want to test your application quickly.</span></span>
* <span data-ttu-id="c74c5-313">Необходимо протестировать возможности среды Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-313">You want to test the capabilities of Azure environment.</span></span>
* <span data-ttu-id="c74c5-314">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-314">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-315">Компоненты бизнес-логики и доступа к данным могут быть автономными и размещаться в веб-приложении.</span><span class="sxs-lookup"><span data-stu-id="c74c5-315">Your business logic and data access components can be self-contained within a web application.</span></span>

<span data-ttu-id="c74c5-316">На схеме ниже показан локальный сценарий и облачное решение для него.</span><span class="sxs-lookup"><span data-stu-id="c74c5-316">The following diagram demonstrates an on-premises scenario and its cloud enabled solution.</span></span> <span data-ttu-id="c74c5-317">В этом сценарии уровни приложения размещаются в одной виртуальной машине в Azure, и вы получаете доступ к данным в Базе данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-317">In this scenario, you place the application tiers in a single virtual machine in Azure and access data in Azure SQL Database.</span></span>

![Модель смешанного приложения](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728015.png)

<span data-ttu-id="c74c5-319">Если вы решили объединить веб-уровень и уровень приложений с помощью веб-приложений Azure, мы рекомендуем сохранить средний уровень или уровень приложения в виде библиотеки динамической компоновки (DLL) в контексте веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-319">If you choose to implement a combined web and application tier by using Azure Web Apps, we recommend that you keep the middle-tier or application tier as dynamic-link libraries (DLLs) in the context of a web application.</span></span>

<span data-ttu-id="c74c5-320">Кроме того, изучите рекомендации, приведенные в разделе [Сравнение стратегий веб-разработки в Azure](#comparing-web-development-strategies-in-azure) в конце этой статьи, чтобы узнать больше о методах программирования.</span><span class="sxs-lookup"><span data-stu-id="c74c5-320">In addition, review the recommendations given in the [Comparing web development strategies in Azure](#comparing-web-development-strategies-in-azure) section at the end of this article to learn more about programming techniques.</span></span>

## <a name="n-tier-hybrid-application-pattern"></a><span data-ttu-id="c74c5-321">Модель n-уровневого гибридного приложения</span><span class="sxs-lookup"><span data-stu-id="c74c5-321">N-tier hybrid application pattern</span></span>
<span data-ttu-id="c74c5-322">В модели n-уровневого гибридного приложения выполняется реализация приложения на нескольких уровнях, распределенных между локальной средой и Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-322">In n-tier hybrid application pattern, you implement your application in multiple tiers distributed between on-premises and Azure.</span></span> <span data-ttu-id="c74c5-323">Таким образом, вы создаете гибкую и многократно используемую гибридную систему, которую можно изменить и в которую можно добавить определенный уровень без изменения остальных уровней.</span><span class="sxs-lookup"><span data-stu-id="c74c5-323">Therefore, you create a flexible and reusable hybrid system, which you can modify or add a specific tier without changing the other tiers.</span></span> <span data-ttu-id="c74c5-324">Для расширения корпоративной сети в облако используйте службу [виртуальной сети Azure](../../../virtual-network/virtual-networks-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="c74c5-324">To extend your corporate network to the cloud, you use [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) service.</span></span>

<span data-ttu-id="c74c5-325">Эту модель гибридных приложений удобно использовать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="c74c5-325">This hybrid application pattern is useful when:</span></span>

* <span data-ttu-id="c74c5-326">Необходимо создавать приложения, которые частично работают в облаке и частично — в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="c74c5-326">You want to build applications that run partly in the cloud and partly on-premises.</span></span>
* <span data-ttu-id="c74c5-327">Необходимо выполнить миграцию некоторых или всех элементов существующего локального приложения в облако.</span><span class="sxs-lookup"><span data-stu-id="c74c5-327">You want to migrate some or all elements of an existing on-premises application to the cloud.</span></span>
* <span data-ttu-id="c74c5-328">Необходимо переместить корпоративные приложения из локальных виртуализированных платформ в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-328">You want to move enterprise applications from on-premises virtualized platforms to Azure.</span></span>
* <span data-ttu-id="c74c5-329">Необходимо владеть инфраструктурой, масштаб которой можно увеличивать или уменьшать по требованию.</span><span class="sxs-lookup"><span data-stu-id="c74c5-329">You want to own an infrastructure environment that can scale up and down on demand.</span></span>
* <span data-ttu-id="c74c5-330">Необходимо за небольшое время подготовить к работе среду разработки и тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-330">You want to quickly provision development and test environments for short periods of time.</span></span>
* <span data-ttu-id="c74c5-331">Необходим экономически эффективный способ создания резервных копий корпоративных приложений базы данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-331">You want a cost effective way to take backups for enterprise database applications.</span></span>

<span data-ttu-id="c74c5-332">На схеме ниже показана модель n-уровневого гибридного приложения, работающего и в локальной сети, и в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-332">The following diagram demonstrates an n-tier hybrid application pattern that spans across on-premises and Azure.</span></span> <span data-ttu-id="c74c5-333">Как показано на схеме, локальная инфраструктура использует контроллер домена [доменных служб Active Directory](https://technet.microsoft.com/library/hh831484.aspx) для проверки подлинности и авторизации пользователей.</span><span class="sxs-lookup"><span data-stu-id="c74c5-333">As shown in the diagram, on-premises infrastructure includes [Active Directory Domain Services](https://technet.microsoft.com/library/hh831484.aspx) domain controller to support user authentication and authorization.</span></span> <span data-ttu-id="c74c5-334">Обратите внимание, что на схеме показан сценарий, в котором некоторые компоненты уровня данных размещены в локальном центре обработки данных, а другие компоненты уровня данных — в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-334">Note that the diagram demonstrates a scenario, where some parts of the data tier live in an on-premises data center whereas some parts of the data tier live in Azure.</span></span> <span data-ttu-id="c74c5-335">В зависимости от потребностей вашего приложения можно реализовать несколько других гибридных сценариев.</span><span class="sxs-lookup"><span data-stu-id="c74c5-335">Depending on your application’s needs, you can implement several other hybrid scenarios.</span></span> <span data-ttu-id="c74c5-336">Например, можно оставить уровень представления и бизнес-уровень в локальной среде, а уровень данных разместить в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-336">For example, you might keep the presentation tier and the business tier in an on-premises environment but the data tier in Azure.</span></span>

![Модель n-уровневого приложения](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728016.png)

<span data-ttu-id="c74c5-338">В Azure можно использовать Active Directory как изолированный облачный каталог для вашей организации. Кроме того, можно интегрировать существующий локальный каталог Active Directory с [Azure Active Directory](https://azure.microsoft.com/documentation/services/active-directory/).</span><span class="sxs-lookup"><span data-stu-id="c74c5-338">In Azure, you can use Active Directory as a standalone cloud directory for your organization, or you can also integrate existing on-premises Active Directory with [Azure Active Directory](https://azure.microsoft.com/documentation/services/active-directory/).</span></span> <span data-ttu-id="c74c5-339">Как показано на схеме, компоненты бизнес-уровня могут получать доступ к нескольким источникам данных: к [серверу SQL Server в Azure](virtual-machines-windows-sql-server-iaas-overview.md) (через частный внутренний IP-адрес), к локальному серверу SQL Server (через [виртуальную сеть Azure](../../../virtual-network/virtual-networks-overview.md)) или к [базе данных SQL](../../../sql-database/sql-database-technical-overview.md) (с помощью поставщика данных .NET Framework).</span><span class="sxs-lookup"><span data-stu-id="c74c5-339">As seen in the diagram, the business tier components can access to multiple data sources, such as to [SQL Server in Azure](virtual-machines-windows-sql-server-iaas-overview.md) via a private internal IP address, to on-premises SQL Server via [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md), or to [SQL Database](../../../sql-database/sql-database-technical-overview.md) using the .NET Framework data provider technologies.</span></span> <span data-ttu-id="c74c5-340">На этой схеме База данных SQL Azure представляет собой дополнительную службу хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-340">In this diagram, Azure SQL Database is an optional data storage service.</span></span>

<span data-ttu-id="c74c5-341">В модели n-уровневого гибридного приложения можно реализовать указанный ниже рабочий процесс в указанном порядке.</span><span class="sxs-lookup"><span data-stu-id="c74c5-341">In n-tier hybrid application pattern, you can implement the following workflow in the order specified:</span></span>

1. <span data-ttu-id="c74c5-342">Определите корпоративные приложения базы данных, которые необходимо переместить в облако, с помощью [Microsoft Assessment and Planning (MAP) Toolkit](http://microsoft.com/map).</span><span class="sxs-lookup"><span data-stu-id="c74c5-342">Identify enterprise database applications that need to be moved up to cloud by using the [Microsoft Assessment and Planning (MAP) Toolkit](http://microsoft.com/map).</span></span> <span data-ttu-id="c74c5-343">MAP Toolkit собирает данные инвентаризации и производительности с компьютеров, которые планируется виртуализировать, и предоставляет рекомендации по планированию емкости и оценки.</span><span class="sxs-lookup"><span data-stu-id="c74c5-343">The MAP Toolkit gathers inventory and performance data from computers you are considering for virtualization and provides recommendations on capacity and assessment planning.</span></span>
2. <span data-ttu-id="c74c5-344">Спланируйте ресурсы и конфигурацию, необходимые в платформе Azure, например учетные записи хранения и виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="c74c5-344">Plan the resources and configuration needed in the Azure platform, such as storage accounts and virtual machines.</span></span>
3. <span data-ttu-id="c74c5-345">Настройте сетевое соединение между корпоративной локальной сетью и [виртуальной сетью Azure](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-345">Set up network connectivity between the corporate network on-premises and [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).</span></span> <span data-ttu-id="c74c5-346">Чтобы настроить соединение между корпоративной локальной сетью и виртуальной машиной в Azure, воспользуйтесь одним из двух указанных ниже методов.</span><span class="sxs-lookup"><span data-stu-id="c74c5-346">To set up the connection between the corporate network on-premises and a virtual machine in Azure, use one of the following two methods:</span></span>
   
   1. <span data-ttu-id="c74c5-347">Установите соединение между локальной сетью и Azure посредством общедоступных конечных точек на виртуальной машине в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-347">Establish a connection between on-premises and Azure via public end points on a virtual machine in Azure.</span></span> <span data-ttu-id="c74c5-348">Этот метод обеспечивает простую настройку и позволяет использовать проверку подлинности SQL Server на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="c74c5-348">This method provides an easy setup and enables you to use SQL Server authentication in your virtual machine.</span></span> <span data-ttu-id="c74c5-349">Кроме того, настройте правила групп безопасности сети для контроля общего трафика на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="c74c5-349">In addition, set up your network security group rules to control public traffic to the VM.</span></span> <span data-ttu-id="c74c5-350">Дополнительные сведения см. в статье [Открытие портов для виртуальной машины в Azure с помощью портала Azure](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c74c5-350">For more information, see [Allow external access to your VM using the Azure portal](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
   2. <span data-ttu-id="c74c5-351">Установите соединение между локальной сетью и Azure с помощью туннеля виртуальной частной сети (VPN).</span><span class="sxs-lookup"><span data-stu-id="c74c5-351">Establish a connection between on-premises and Azure via Azure Virtual Private network (VPN) tunnel.</span></span> <span data-ttu-id="c74c5-352">Этот метод позволяет распространить политики домена на виртуальную машину в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-352">This method allows you to extend domain policies to a virtual machine in Azure.</span></span> <span data-ttu-id="c74c5-353">Кроме того, можно настроить правила брандмауэра и использовать проверку подлинности Windows на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="c74c5-353">In addition, you can set up firewall rules and use Windows authentication in your virtual machine.</span></span> <span data-ttu-id="c74c5-354">Сейчас Azure поддерживает безопасные подключения VPN типа "сеть-сеть" и VPN типа "точка-сеть".</span><span class="sxs-lookup"><span data-stu-id="c74c5-354">Currently, Azure supports secure site-to-site VPN and point-to-site VPN connections:</span></span>
      
      * <span data-ttu-id="c74c5-355">С помощью защищенного подключения типа "сеть-сеть" можно установить сетевое соединение между локальной сетью и виртуальной сетью в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-355">With secure site-to-site connection, you can establish network connectivity between your on-premises network and your virtual network in Azure.</span></span> <span data-ttu-id="c74c5-356">Это рекомендуется для подключения локальной среды центра обработки данных к Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-356">It is recommended for connecting your on-premises data center environment to Azure.</span></span>
      * <span data-ttu-id="c74c5-357">С помощью защищенного подключения типа "точка-сеть" можно установить сетевое соединение между виртуальной сетью в Azure и отдельными компьютерами, работающими в любом месте.</span><span class="sxs-lookup"><span data-stu-id="c74c5-357">With secure point-to-site connection, you can establish network connectivity between your virtual network in Azure and your individual computers running anywhere.</span></span> <span data-ttu-id="c74c5-358">Такой вариант рекомендуется, главным образом, для целей разработки и тестирования.</span><span class="sxs-lookup"><span data-stu-id="c74c5-358">It is mostly recommended for development and test purposes.</span></span>
      
      <span data-ttu-id="c74c5-359">Сведения о том, как подключиться к серверу SQL Server в Azure, см. в статье [Подключение к виртуальной машине SQL Server в Azure](virtual-machines-windows-sql-connect.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-359">For information on how to connect to SQL Server in Azure, see [Connect to a SQL Server Virtual Machine on Azure](virtual-machines-windows-sql-connect.md).</span></span>
4. <span data-ttu-id="c74c5-360">Настройте запланированные задания и предупреждения, которые создают резервные копии локальных данных на диске виртуальной машины в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-360">Set up scheduled jobs and alerts that back up on-premises data in a virtual machine disk in Azure.</span></span> <span data-ttu-id="c74c5-361">Дополнительные сведения см. в статьях [Резервное копирование и восстановление SQL Server с помощью службы хранилища BLOB-объектов Microsoft Azure](https://msdn.microsoft.com/library/jj919148.aspx) и [Резервное копирование и восстановление SQL Server в виртуальных машинах Azure](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-361">For more information, see [SQL Server Backup and Restore with Azure Blob Storage Service](https://msdn.microsoft.com/library/jj919148.aspx) and [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span>
5. <span data-ttu-id="c74c5-362">В зависимости от потребностей вашего приложения можно реализовать один из трех указанных ниже распространенных сценариев.</span><span class="sxs-lookup"><span data-stu-id="c74c5-362">Depending on your application’s needs, you can implement one of the following three common scenarios:</span></span>
   
   1. <span data-ttu-id="c74c5-363">Вы можете разместить веб-сервер, сервер приложений и неконфиденциальные данные на сервере базы данных в Azure, а конфиденциальные данные — в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="c74c5-363">You can keep your web server, application server, and insensitive data in a database server in Azure whereas you keep the sensitive data on-premises.</span></span>
   2. <span data-ttu-id="c74c5-364">Вы можете разместить веб-сервер и сервер приложений в локальной сети, а сервер базы данных — на виртуальной машине в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-364">You can keep your web server and application server on-premises whereas the database server in a virtual machine in Azure.</span></span>
   3. <span data-ttu-id="c74c5-365">Вы можете разместить сервер базы данных, веб-сервер и сервер приложений в локальной сети, а реплики базы данных — на виртуальных машинах в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-365">You can keep your database server, web server, and application server on-premises whereas you keep the database replicas in virtual machines in Azure.</span></span> <span data-ttu-id="c74c5-366">Этот параметр позволяет локальным веб-серверам или приложениям отчетности получать доступ к репликам базы данных в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-366">This setting allows the on-premises web servers or reporting applications to access the database replicas in Azure.</span></span> <span data-ttu-id="c74c5-367">Таким образом, можно добиться снижения рабочей нагрузки в локальной базе данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-367">Therefore, you can achieve to lower the workload in an on-premises database.</span></span> <span data-ttu-id="c74c5-368">Мы рекомендуем использовать этот сценарий для серьезных рабочих нагрузок и целей разработки.</span><span class="sxs-lookup"><span data-stu-id="c74c5-368">We recommend that you implement this scenario for heavy read workloads and developmental purposes.</span></span> <span data-ttu-id="c74c5-369">Дополнительные сведения о создании реплик баз данных в Azure см. в описании групп доступности AlwaysOn в статье [Высокий уровень доступности и аварийное восстановление для SQL Server на виртуальных машинах Azure](virtual-machines-windows-sql-high-availability-dr.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-369">For information on creating database replicas in Azure, see AlwaysOn Availability Groups at [High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-high-availability-dr.md).</span></span>

## <a name="comparing-web-development-strategies-in-azure"></a><span data-ttu-id="c74c5-370">Сравнение стратегий веб-разработки в Azure</span><span class="sxs-lookup"><span data-stu-id="c74c5-370">Comparing web development strategies in Azure</span></span>
<span data-ttu-id="c74c5-371">Для реализации и развертывания многоуровневого приложения на основе SQL Server в Azure можно использовать один из указанных ниже двух методов программирования.</span><span class="sxs-lookup"><span data-stu-id="c74c5-371">To implement and deploy a multi-tier SQL Server-based application in Azure, you can use one of the following two programming methods:</span></span>

* <span data-ttu-id="c74c5-372">Настройте традиционный веб-сервер (IIS) в Azure и доступ к базам данных в SQL Server на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-372">Set up a traditional web server (IIS - Internet Information Services) in Azure and access databases in SQL Server in Azure Virtual Machines.</span></span>
* <span data-ttu-id="c74c5-373">Реализуйте и разверните облачную службу в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-373">Implement and deploy a cloud service to Azure.</span></span> <span data-ttu-id="c74c5-374">Затем убедитесь, что эта облачная служба имеет доступ к базам данных в SQL Server на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-374">Then, make sure that this cloud service can access databases in SQL Server in Azure Virtual machines.</span></span> <span data-ttu-id="c74c5-375">Облачная служба может включать несколько веб- и рабочих ролей.</span><span class="sxs-lookup"><span data-stu-id="c74c5-375">A cloud service can include multiple web and worker roles.</span></span>

<span data-ttu-id="c74c5-376">В таблице ниже представлено сравнение традиционной веб-разработки (с облачными службами Azure и веб-приложениями Azure) с SQL Server на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-376">The following table provides a comparison of traditional web development with Azure Cloud Services and Azure Web Apps with respect to SQL Server in Azure Virtual Machines.</span></span> <span data-ttu-id="c74c5-377">В таблице имеются сведения о веб-приложениях Azure, так как можно использовать SQL Server на виртуальной машине Azure в качестве источника данных для веб-приложений Azure через его общедоступный виртуальный IP-адрес или DNS-имя.</span><span class="sxs-lookup"><span data-stu-id="c74c5-377">The table includes Azure Web Apps as it is possible to use SQL Server in Azure VM as a data source for Azure Web Apps via its public virtual IP address or DNS name.</span></span>

|  | <span data-ttu-id="c74c5-378">Традиционная веб-разработка в виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="c74c5-378">Traditional web development in Azure Virtual Machines</span></span> | <span data-ttu-id="c74c5-379">Облачные службы в Azure</span><span class="sxs-lookup"><span data-stu-id="c74c5-379">Cloud Services in Azure</span></span> | <span data-ttu-id="c74c5-380">Веб-размещение с помощью веб-приложений Azure</span><span class="sxs-lookup"><span data-stu-id="c74c5-380">Web Hosting with Azure Web Apps</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="c74c5-381">**Миграция приложений из локальных систем**</span><span class="sxs-lookup"><span data-stu-id="c74c5-381">**Application Migration from on-premises**</span></span> |<span data-ttu-id="c74c5-382">Существующие приложения как есть.</span><span class="sxs-lookup"><span data-stu-id="c74c5-382">Existing applications as-is.</span></span> |<span data-ttu-id="c74c5-383">Приложениям необходимы веб-роли и рабочие роли.</span><span class="sxs-lookup"><span data-stu-id="c74c5-383">Applications need web and worker roles.</span></span> |<span data-ttu-id="c74c5-384">Вариант "Существующие приложения как есть" подходит для независимых веб-приложений и веб-служб, которым требуется быстрая масштабируемость.</span><span class="sxs-lookup"><span data-stu-id="c74c5-384">Existing applications as-is but suited for self-contained web applications and web services that require quick scalability.</span></span> |
| <span data-ttu-id="c74c5-385">**Разработка и развертывание**</span><span class="sxs-lookup"><span data-stu-id="c74c5-385">**Development and Deployment**</span></span> |<span data-ttu-id="c74c5-386">Visual Studio, WebMatrix, Visual Web Developer, WebDeploy, FTP, TFS, диспетчер IIS, PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c74c5-386">Visual Studio, WebMatrix, Visual Web Developer, WebDeploy, FTP, TFS, IIS Manager, PowerShell.</span></span> |<span data-ttu-id="c74c5-387">Visual Studio Azure SDK, TFS, PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c74c5-387">Visual Studio, Azure SDK, TFS, PowerShell.</span></span> <span data-ttu-id="c74c5-388">Каждая облачная служба имеет две среды, в которых можно развернуть пакет и конфигурацию службы: промежуточную и рабочую.</span><span class="sxs-lookup"><span data-stu-id="c74c5-388">Each cloud service has two environments to which you can deploy your service package and configuration: staging and production.</span></span> <span data-ttu-id="c74c5-389">Можно развернуть облачную службу в промежуточной среде, чтобы проверить ее работу перед переносом в производственную среду.</span><span class="sxs-lookup"><span data-stu-id="c74c5-389">You can deploy a cloud service to the staging environment to test it before you promote it to production.</span></span> |<span data-ttu-id="c74c5-390">Visual Studio, WebMatrix, Visual Web Developer, FTP, GIT, BitBucket, CodePlex, DropBox, GitHub, Mercurial, TFS, веб-развертывание, PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c74c5-390">Visual Studio, WebMatrix, Visual Web Developer, FTP, GIT, BitBucket, CodePlex, DropBox, GitHub, Mercurial, TFS, Web Deploy, PowerShell.</span></span> |
| <span data-ttu-id="c74c5-391">**Администрирование и настройка**</span><span class="sxs-lookup"><span data-stu-id="c74c5-391">**Administration and Setup**</span></span> |<span data-ttu-id="c74c5-392">Вы несете ответственность за выполнение административных задач для приложений, данных, правил брандмауэра, виртуальной сети и операционной системы.</span><span class="sxs-lookup"><span data-stu-id="c74c5-392">You are responsible for administrative tasks on the application, data, firewall rules, virtual network, and operating system.</span></span> |<span data-ttu-id="c74c5-393">Вы несете ответственность за выполнение административных задач для приложений, данных, правил брандмауэра и виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="c74c5-393">You are responsible for administrative tasks on the application, data, firewall rules, and virtual network.</span></span> |<span data-ttu-id="c74c5-394">Вы несете ответственность за выполнение административных задач только для приложений и данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-394">You are responsible for administrative tasks on the application and data only.</span></span> |
| <span data-ttu-id="c74c5-395">**Высокая доступность и аварийное восстановление**</span><span class="sxs-lookup"><span data-stu-id="c74c5-395">**High Availability and Disaster Recovery (HADR)**</span></span> |<span data-ttu-id="c74c5-396">Мы рекомендуем размещать виртуальные машины в одной группе доступности и в одной облачной службе.</span><span class="sxs-lookup"><span data-stu-id="c74c5-396">We recommend that you place virtual machines in the same availability set and in the same cloud service.</span></span> <span data-ttu-id="c74c5-397">Благодаря размещению виртуальных машин в одной группе доступности можно помещать узлы с высоким уровнем доступности в отдельные домены сбоя и обновления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-397">Keeping your VMs in the same availability set allows Azure to place the high availability nodes into separate fault domains and upgrade domains.</span></span> <span data-ttu-id="c74c5-398">Аналогично, размещение виртуальных машин в одной и той же облачной службе позволяет выполнять балансировку нагрузки, при этом виртуальные машины могут обмениваться данными непосредственно друг с другом по локальной сети в рамках центра обработки данных Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-398">Similarly, keeping your VMs in the same cloud service enables load balancing and VMs can communicate directly with one another over the local network within an Azure data center.</span></span><br/><br/><span data-ttu-id="c74c5-399">Чтобы избежать простоев, вам нужно реализовать решения по обеспечению высокого уровня доступности и аварийного восстановления SQL Server на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-399">You are responsible for implementing a high availability and disaster recovery solution for SQL Server in Azure Virtual Machines to avoid any downtime.</span></span> <span data-ttu-id="c74c5-400">Сведения о поддерживаемых технологиях HADR см. в статье [Высокий уровень доступности и аварийное восстановление для SQL Server на виртуальных машинах Azure](virtual-machines-windows-sql-high-availability-dr.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-400">For supported HADR technologies, see [High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-high-availability-dr.md).</span></span><br/><br/><span data-ttu-id="c74c5-401">Вы отвечаете за архивацию своих данных и приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-401">You are responsible for backing up your own data and application.</span></span><br/><br/><span data-ttu-id="c74c5-402">Azure может перемещать ваши виртуальные машины в случае сбоя хост-компьютера в центре обработки данных из-за проблем с оборудованием.</span><span class="sxs-lookup"><span data-stu-id="c74c5-402">Azure can move your virtual machines if the host machine in the data center fails due to hardware issues.</span></span> <span data-ttu-id="c74c5-403">Кроме того, возможны запланированные простои ваших виртуальных машин при установке обновлений для системы безопасности и обновлений программного обеспечения на хост-компьютер.</span><span class="sxs-lookup"><span data-stu-id="c74c5-403">In addition, there could be planned downtime of your VM when the host machine is updated for security or software updates.</span></span> <span data-ttu-id="c74c5-404">Поэтому для обеспечения постоянной доступности мы рекомендуем поддерживать по крайней мере две виртуальные машины на каждом уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-404">Therefore, we recommend that you maintain at least two VMs in each application tier to ensure the continuous availability.</span></span> <span data-ttu-id="c74c5-405">Azure не обеспечивает выполнение соглашений об уровне обслуживания при использовании одной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="c74c5-405">Azure does not provide SLA for a single virtual machine.</span></span> <span data-ttu-id="c74c5-406">Дополнительные сведения см. в [техническом руководстве по обеспечению устойчивости в Azure](../../../resiliency/resiliency-technical-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-406">For more information, see [Azure resiliency technical guidance](../../../resiliency/resiliency-technical-guidance.md).</span></span> |<span data-ttu-id="c74c5-407">Azure управляет сбоями, вызванными используемым оборудованием или операционной системой.</span><span class="sxs-lookup"><span data-stu-id="c74c5-407">Azure manages the failures resulting from the underlying hardware or operating system software.</span></span> <span data-ttu-id="c74c5-408">Для обеспечения высокого уровня доступности вашего приложения мы рекомендуем реализовать несколько экземпляров веб- и рабочих ролей.</span><span class="sxs-lookup"><span data-stu-id="c74c5-408">We recommend that you implement multiple instances of a web or worker role to ensure the high availability of your application.</span></span> <span data-ttu-id="c74c5-409">Дополнительные сведения см. в статьях [Соглашение об уровне обслуживания для облачных служб, виртуальных машин и виртуальной сети](http://www.microsoft.com/download/details.aspx?id=38427) и [Аварийное восстановление и высокая доступность для приложений на платформе Azure](../../../resiliency/resiliency-disaster-recovery-high-availability-azure-applications.md)</span><span class="sxs-lookup"><span data-stu-id="c74c5-409">For information, see [Cloud Services, Virtual Machines, and Virtual Network Service Level Agreement](http://www.microsoft.com/download/details.aspx?id=38427) and [Disaster recovery and high availability for Azure applications](../../../resiliency/resiliency-disaster-recovery-high-availability-azure-applications.md)</span></span><br/><br/><span data-ttu-id="c74c5-410">Вы отвечаете за архивацию своих данных и приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-410">You are responsible for backing up your own data and application.</span></span><br/><br/><span data-ttu-id="c74c5-411">При использовании баз данных, находящихся в базе данных SQL Server на виртуальной машине Azure, вы отвечаете за реализацию решения, которое обеспечивает высокую доступность и аварийное восстановление во избежание простоев.</span><span class="sxs-lookup"><span data-stu-id="c74c5-411">For databases residing in a SQL Server database in an Azure VM, you are responsible for implementing a high availability and disaster recovery solution to avoid any downtime.</span></span> <span data-ttu-id="c74c5-412">Сведения о поддерживаемых технологиях HADR см. в статье "Высокий уровень доступности и аварийное восстановление для SQL Server на виртуальных машинах Azure".</span><span class="sxs-lookup"><span data-stu-id="c74c5-412">For supported HDAR technologies, see High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines.</span></span><br/><br/><span data-ttu-id="c74c5-413">**Зеркальное отображение базы данных SQL Server**: используйте с облачными службами Azure (веб-роли и рабочие роли).</span><span class="sxs-lookup"><span data-stu-id="c74c5-413">**SQL Server Database Mirroring**: Use with Azure Cloud Services (web/worker roles).</span></span> <span data-ttu-id="c74c5-414">Виртуальные машины SQL Server и проект облачной службы могут находиться в одной и той же виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-414">SQL Server VMs and a cloud service project can be in the same Azure Virtual Network.</span></span> <span data-ttu-id="c74c5-415">Если виртуальная машина SQL Server не находится в той же виртуальной сети, необходимо создать псевдоним SQL Server для маршрутизации данных к экземпляру SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c74c5-415">If SQL Server VM is not in the same Virtual Network, you need to create a SQL Server Alias to route communication to the instance of SQL Server.</span></span> <span data-ttu-id="c74c5-416">Кроме того, имя псевдонима должно соответствовать имени SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c74c5-416">In addition, the alias name must match the SQL Server name.</span></span> |<span data-ttu-id="c74c5-417">Высокий уровень доступности наследуется от рабочих ролей Azure, хранилища BLOB-объектов Azure и базы данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-417">High Availability is inherited from Azure worker roles, Azure blob storage, and Azure SQL Database.</span></span> <span data-ttu-id="c74c5-418">Например, служба хранилища Azure поддерживает три реплики для всех данных больших двоичных объектов, таблиц и очереди.</span><span class="sxs-lookup"><span data-stu-id="c74c5-418">For example, Azure Storage maintains three replicas of all blob, table, and queue data.</span></span> <span data-ttu-id="c74c5-419">В любой момент времени База данных SQL Azure хранит три реплики рабочих данных: одну основную и две дополнительных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-419">At any one time, Azure SQL Database keeps three replicas of data running—one primary replica and two secondary replicas.</span></span> <span data-ttu-id="c74c5-420">Дополнительные сведения см. в статьях [Документация по хранилищу](https://azure.microsoft.com/documentation/services/storage/) и [Что такое база данных SQL? Введение в базы данных SQL](../../../sql-database/sql-database-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-420">For more information, see [Azure Storage](https://azure.microsoft.com/documentation/services/storage/) and [Azure SQL Database](../../../sql-database/sql-database-technical-overview.md).</span></span><br/><br/><span data-ttu-id="c74c5-421">При использовании SQL Server на виртуальной машине Azure в качестве источника данных для веб-приложений Azure следует иметь в виду, что веб-приложения Azure не поддерживают виртуальную сеть Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-421">When using SQL Server in Azure VM as a data source for Azure Web Apps, keep in mind that Azure Web Apps does not support Azure Virtual Network.</span></span> <span data-ttu-id="c74c5-422">Другими словами, все соединения веб-приложений Azure с виртуальными машинами SQL Server в Azure должны проходить через общедоступные конечные точки виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c74c5-422">In other words, all connections from Azure Web Apps to SQL Server VMs in Azure must go through public end points of virtual machines.</span></span> <span data-ttu-id="c74c5-423">Это может привести к некоторым ограничениям для сценариев обеспечения высокого уровня доступности и аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="c74c5-423">This might cause some limitations for high availability and disaster recovery scenarios.</span></span> <span data-ttu-id="c74c5-424">Например, клиентское приложение в веб-приложениях Azure, подключающееся к виртуальной машине SQL Server с зеркальным отображением базы данных, не сможет подключиться к новому основному серверу, так как для зеркального отображения базы данных требуется настроить виртуальную сеть Azure между виртуальными машинами SQL Server в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-424">For example, the client application on Azure Web Apps connecting to SQL Server VM with database mirroring would not be able to connect to the new primary server as database mirroring requires that you set up Azure Virtual Network between SQL Server host VMs in Azure.</span></span> <span data-ttu-id="c74c5-425">Таким образом, использование **зеркального отображения базы данных SQL Server** совместно с веб-приложениями Azure не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c74c5-425">Therefore, using **SQL Server Database Mirroring** with Azure Web Apps is not supported currently.</span></span><br/><br/><span data-ttu-id="c74c5-426">**Группы доступности AlwaysOn SQL Server**: вы можете настроить группы доступности AlwaysOn при использовании веб-приложений Azure совместно с виртуальными машинами SQL Server в Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-426">**SQL Server AlwaysOn Availability Groups**: You can set up AlwaysOn Availability Groups when using Azure Web Apps with SQL Server VMs in Azure.</span></span> <span data-ttu-id="c74c5-427">Однако необходимо настроить прослушиватель группы доступности AlwaysOn для организации связи с первичной репликой через общедоступные конечные точки балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="c74c5-427">But you need to configure AlwaysOn Availability Group Listener to route the communication to the primary replica via public load-balanced endpoints.</span></span> |
| <span data-ttu-id="c74c5-428">**Возможности распределенного подключения**</span><span class="sxs-lookup"><span data-stu-id="c74c5-428">**cross-premises Connectivity**</span></span> |<span data-ttu-id="c74c5-429">Виртуальную сеть Azure можно использовать для локального подключения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-429">You can use Azure Virtual Network to connect to on-premises.</span></span> |<span data-ttu-id="c74c5-430">Виртуальную сеть Azure можно использовать для локального подключения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-430">You can use Azure Virtual Network to connect to on-premises.</span></span> |<span data-ttu-id="c74c5-431">Виртуальная сеть Azure поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c74c5-431">Azure Virtual Network is supported.</span></span> <span data-ttu-id="c74c5-432">Дополнительные сведения см. в публикации блога [Web Apps Virtual Network Integration](https://azure.microsoft.com/blog/2014/09/15/azure-websites-virtual-network-integration/) (Интеграция виртуальной сети веб-приложений).</span><span class="sxs-lookup"><span data-stu-id="c74c5-432">For more information, see [Web Apps Virtual Network Integration](https://azure.microsoft.com/blog/2014/09/15/azure-websites-virtual-network-integration/).</span></span> |
| <span data-ttu-id="c74c5-433">**Масштабируемость**</span><span class="sxs-lookup"><span data-stu-id="c74c5-433">**Scalability**</span></span> |<span data-ttu-id="c74c5-434">Разворачивание доступно путем увеличения размера виртуальных машин или добавления дополнительных дисков.</span><span class="sxs-lookup"><span data-stu-id="c74c5-434">Scale-up is available by increasing the virtual machine sizes or adding more disks.</span></span> <span data-ttu-id="c74c5-435">Дополнительные сведения о размерах виртуальных машин см. в разделе [Размеры виртуальных машин в Azure](../sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c74c5-435">For more information about virtual machine sizes, see [Virtual Machine Sizes for Azure](../sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span><br/><br/><span data-ttu-id="c74c5-436">**Для сервера базы данных**: горизонтальное масштабирование можно выполнить с помощью методов секционирования базы данных и групп доступности AlwaysOn в SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c74c5-436">**For Database Server**: Scale-out is available via database partitioning techniques and SQL Server AlwaysOn Availability groups.</span></span><br/><br/><span data-ttu-id="c74c5-437">Для серьезных рабочих нагрузок чтения можно использовать [группы доступности AlwaysOn](https://msdn.microsoft.com/library/hh510230.aspx) на нескольких дополнительных узлах, а также репликацию SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c74c5-437">For heavy read workloads, you can use [AlwaysOn Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) on multiple secondary nodes as well as SQL Server Replication.</span></span><br/><br/><span data-ttu-id="c74c5-438">Для серьезных рабочих нагрузок записи можно реализовать горизонтальное секционирование данных на нескольких физических серверах для обеспечения горизонтального масштабирования приложений.</span><span class="sxs-lookup"><span data-stu-id="c74c5-438">For heavy write workloads, you can implement horizontal partitioning data across multiple physical servers to provide application scale-out.</span></span><br/><br/><span data-ttu-id="c74c5-439">Кроме того, можно реализовать горизонтальное масштабирование, используя [SQL Server с маршрутизацией, зависящей от данных](https://technet.microsoft.com/library/cc966448.aspx).</span><span class="sxs-lookup"><span data-stu-id="c74c5-439">In addition, you can implement a scale-out by using [SQL Server with Data Dependent Routing](https://technet.microsoft.com/library/cc966448.aspx).</span></span> <span data-ttu-id="c74c5-440">При использовании технологии маршрутизации, зависящей от данных, необходимо реализовать механизм секционирования в клиентском приложении (обычно в слое бизнес-уровня) для маршрутизации запросов к базе данных на несколько узлов SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c74c5-440">With Data Dependent Routing (DDR), you need to implement the partitioning mechanism in the client application, typically in the business tier layer, to route the database requests to multiple SQL Server nodes.</span></span> <span data-ttu-id="c74c5-441">Бизнес-уровень содержит сопоставления, определяющие порядок секционирования данных и то, какой узел содержит данные.</span><span class="sxs-lookup"><span data-stu-id="c74c5-441">The business tier contains mappings to how the data is partitioned and which node contains the data.</span></span><br/><br/><span data-ttu-id="c74c5-442">Вы можете масштабировать приложения, запускающие виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="c74c5-442">You can scale applications that are running virtual machines.</span></span> <span data-ttu-id="c74c5-443">Дополнительные сведения см. в статье [Автомасштабирование облачной службы](../../../cloud-services/cloud-services-how-to-scale.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-443">For more information, see [How to Scale an Application](../../../cloud-services/cloud-services-how-to-scale.md).</span></span><br/><br/><span data-ttu-id="c74c5-444">**Важное примечание**. Благодаря функции **автомасштабирования** в Azure можно автоматически увеличивать или уменьшать размер виртуальных машин, используемых приложением.</span><span class="sxs-lookup"><span data-stu-id="c74c5-444">**Important Note**: The **AutoScale** feature in Azure allows you to automatically increase or decrease the Virtual Machines that are used by your application.</span></span> <span data-ttu-id="c74c5-445">Эта функция гарантирует, что во время периодов пика активности на работу конечных пользователей не будет оказано отрицательного влияния, а в периоды низкого спроса работа виртуальных машин будет завершена.</span><span class="sxs-lookup"><span data-stu-id="c74c5-445">This feature guarantees that the end-user experience is not affected negatively during peak periods, and VMs are shut down when the demand is low.</span></span> <span data-ttu-id="c74c5-446">Рекомендуется не настраивать параметр автомасштабирования для облачной службы, если она включает виртуальные машины SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c74c5-446">It’s recommended that you do not set the AutoScale option for your cloud service if it includes SQL Server VMs.</span></span> <span data-ttu-id="c74c5-447">Причина заключается в том, что функция автомасштабирования позволяет Azure включать виртуальную машину, когда степень использования ЦП на этой виртуальной машине превышает некоторое пороговое значение, и выключать виртуальную машину, если степень использования ЦП становится ниже этого значения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-447">The reason is that the AutoScale feature lets Azure to turn on a virtual machine when the CPU usage in that VM is higher than some threshold, and to turn off a virtual machine when the CPU usage goes lower than it.</span></span> <span data-ttu-id="c74c5-448">Функция автомасштабирования подходит для приложений без учета состояния, например для веб-серверов, где все виртуальные машины могут управлять рабочей нагрузкой без учета предыдущего состояния.</span><span class="sxs-lookup"><span data-stu-id="c74c5-448">The AutoScale feature is useful for stateless applications, such as web servers, where any VM can manage the workload without any references to any previous state.</span></span> <span data-ttu-id="c74c5-449">Тем не менее, функция автомасштабирования не подходит для приложений с отслеживанием состояния, например для SQL Server, когда только один экземпляр разрешает запись в базу данных.</span><span class="sxs-lookup"><span data-stu-id="c74c5-449">However, the AutoScale feature is not useful for stateful applications, such as SQL Server, where only one instance allows writing to the database.</span></span> |<span data-ttu-id="c74c5-450">Разворачивание можно выполнять с помощью нескольких веб-ролей и рабочих ролей.</span><span class="sxs-lookup"><span data-stu-id="c74c5-450">Scale-up is available by using multiple web and worker roles.</span></span> <span data-ttu-id="c74c5-451">Дополнительные сведения о размерах виртуальных машин для веб-ролей и рабочих ролей см. в статье [Размеры для облачных служб](../../../cloud-services/cloud-services-sizes-specs.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-451">For more information about virtual machine sizes for web roles and worker roles, see [Configure Sizes for Cloud Services](../../../cloud-services/cloud-services-sizes-specs.md).</span></span><br/><br/><span data-ttu-id="c74c5-452">При использовании **облачных служб** можно определить несколько ролей для распределения обработки и гибкого масштабирования приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-452">When using **Cloud Services**, you can define multiple roles to distribute processing and also achieve flexible scaling of your application.</span></span> <span data-ttu-id="c74c5-453">Все облачные службы включают одну или несколько веб-ролей или рабочих ролей, каждая из которых имеет собственные файлы и конфигурацию приложения.</span><span class="sxs-lookup"><span data-stu-id="c74c5-453">Each cloud service includes one or more web roles and/or worker roles, each with its own application files and configuration.</span></span> <span data-ttu-id="c74c5-454">Вы можете увеличивать масштаб облачной службы за счет увеличения количества экземпляров роли (виртуальных машин), развернутых для роли, или уменьшать его за счет уменьшения количества экземпляров роли.</span><span class="sxs-lookup"><span data-stu-id="c74c5-454">You can scale-up a cloud service by increasing the number of role instances (virtual machines) deployed for a role and scale-down a cloud service by decreasing the number of role instances.</span></span> <span data-ttu-id="c74c5-455">Дополнительные сведения см. в статье [Стоит ли сделать выбор в пользу облачных служб или чего-то другого?](../../../cloud-services/cloud-services-choose-me.md)</span><span class="sxs-lookup"><span data-stu-id="c74c5-455">For detailed information, see [Azure Execution Models](../../../cloud-services/cloud-services-choose-me.md).</span></span><br/><br/><span data-ttu-id="c74c5-456">Вы можете выполнять горизонтальное масштабирование благодаря встроенной поддержке высокого уровня доступности Azure в соответствии с [соглашением об уровне обслуживания для облачных служб, виртуальных машин и виртуальной сети](http://www.microsoft.com/download/details.aspx?id=38427) и балансировщика нагрузки.</span><span class="sxs-lookup"><span data-stu-id="c74c5-456">Scale-out is available via built-in Azure high availability support through [Cloud Services, Virtual Machines, and Virtual Network Service Level Agreement](http://www.microsoft.com/download/details.aspx?id=38427) and Load Balancer.</span></span><br/><br/><span data-ttu-id="c74c5-457">Для многоуровневого приложения мы рекомендуем подключить приложение веб-ролей и рабочих ролей к виртуальным машинам сервера базы данных через виртуальную сеть Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-457">For a multi-tier application, we recommend that you connect web/worker roles application to database server VMs via Azure Virtual Network.</span></span> <span data-ttu-id="c74c5-458">Кроме того, Azure обеспечивает балансировку нагрузки для виртуальных машин в рамках одной облачной службы, распределяя запросы пользователей между ними.</span><span class="sxs-lookup"><span data-stu-id="c74c5-458">In addition, Azure provides load balancing for VMs in the same cloud service, spreading user requests across them.</span></span> <span data-ttu-id="c74c5-459">Виртуальные машины, подключенные таким образом, могут обмениваться данными напрямую друг с другом по локальной сети в центре обработки данных Azure.</span><span class="sxs-lookup"><span data-stu-id="c74c5-459">Virtual machines connected in this way can communicate directly with one another over the local network within an Azure data center.</span></span><br/><br/><span data-ttu-id="c74c5-460">На портале Azure можно настроить **автомасштабирование**, а также запланировать время масштабирования.</span><span class="sxs-lookup"><span data-stu-id="c74c5-460">You can set up **AutoScale** on the Azure portal as well as the schedule times.</span></span> <span data-ttu-id="c74c5-461">Дополнительные сведения см. в разделе [Как настроить автомасштабирование для облачной службы на портале](../../../cloud-services/cloud-services-how-to-scale-portal.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-461">For more information, see [How to configure auto scaling for a Cloud Service in the portal](../../../cloud-services/cloud-services-how-to-scale-portal.md).</span></span> |<span data-ttu-id="c74c5-462">**Увеличение и уменьшение масштаба**: вы можете увеличивать или уменьшать размер экземпляра (виртуальной машины), зарезервированный для веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="c74c5-462">**Scale up and down**: You can increase/decrease the size of the instance (VM) reserved for your web site.</span></span><br/><br/><span data-ttu-id="c74c5-463">Горизонтальное масштабирование: вы можете добавить дополнительные зарезервированные экземпляры (виртуальные машины) для своего веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="c74c5-463">Scale out: You can add more reserved instances (VMs) for your web site.</span></span><br/><br/><span data-ttu-id="c74c5-464">На портале можно настроить **автомасштабирование**, а также запланировать время масштабирования.</span><span class="sxs-lookup"><span data-stu-id="c74c5-464">You can set up **AutoScale** on the portal as well as the schedule times.</span></span> <span data-ttu-id="c74c5-465">Дополнительные сведения см. в статье [Увеличение масштаба приложения в Azure](../../../app-service-web/web-sites-scale.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-465">For more information, see [How to Scale Web Apps](../../../app-service-web/web-sites-scale.md).</span></span> |

<span data-ttu-id="c74c5-466">Дополнительные сведения о том, как выбрать необходимый метод программирования, см. в статье [Сравнение службы приложений Azure, виртуальных машин, Service Fabric и облачных служб](../../../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-466">For more information on choosing between these programming methods, see [Azure Web Apps, Cloud Services, and VMs: When to use which](../../../app-service-web/choose-web-site-cloud-service-vm.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="c74c5-467">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c74c5-467">Next Steps</span></span>
<span data-ttu-id="c74c5-468">Дополнительные сведения о работе SQL Server на виртуальных машинах Azure см. в статье [Приступая к работе с SQL Server в виртуальных машинах Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c74c5-468">For more information on running SQL Server in Azure Virtual machines, see [SQL Server on Azure Virtual Machines Overview](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

