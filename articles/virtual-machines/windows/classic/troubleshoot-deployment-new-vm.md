---
title: "aaaTroubleshoot классическую развертывания виртуальной Машины Windows | Документы Microsoft"
description: "Устранение неполадок, возникающих при создании виртуальной машины Windows в Azure с помощью классической модели развертывания"
services: virtual-machines-windows
documentationcenter: 
author: JiangChen79
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 9f01d237-ba39-4c32-b72d-18f5f505d43a
ms.service: virtual-machines-windows
ms.workload: na
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 12/16/2016
ms.author: cjiang
ms.openlocfilehash: aa12cb013a18e0572fbef8b7ea69106dd47c1fd9
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-classic-deployment-issues-with-creating-a-new-windows-virtual-machine-in-azure"></a><span data-ttu-id="33533-103">Устранение неполадок в классическом развертывании при создании виртуальной машины Windows в Azure</span><span class="sxs-lookup"><span data-stu-id="33533-103">Troubleshoot classic deployment issues with creating a new Windows virtual machine in Azure</span></span>
[!INCLUDE [virtual-machines-troubleshoot-deployment-new-vm-selectors](../../../../includes/virtual-machines-windows-troubleshoot-deployment-new-vm-selectors-include.md)]

[!INCLUDE [virtual-machines-troubleshoot-deployment-new-vm-opening](../../../../includes/virtual-machines-troubleshoot-deployment-new-vm-opening-include.md)]

> [!IMPORTANT] 
> <span data-ttu-id="33533-104">В Azure предлагаются две модели развертывания для создания ресурсов и работы с ними: [модель диспетчера ресурсов и классическая модель](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="33533-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="33533-105">В этой статье описан с помощью hello классической модели развертывания.</span><span class="sxs-lookup"><span data-stu-id="33533-105">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="33533-106">Корпорация Майкрософт рекомендует наиболее новые развертывания модели hello диспетчера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="33533-106">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="33533-107">Hello диспетчера ресурсов версию этой статьи в разделе [здесь](../../virtual-machines-windows-troubleshoot-deployment-new-vm.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="33533-107">For hello Resource Manager version of this article, see [here](../../virtual-machines-windows-troubleshoot-deployment-new-vm.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

[!INCLUDE [support-disclaimer](../../../../includes/support-disclaimer.md)]

## <a name="collect-audit-logs"></a><span data-ttu-id="33533-108">Сбор журналов аудита</span><span class="sxs-lookup"><span data-stu-id="33533-108">Collect audit logs</span></span>
<span data-ttu-id="33533-109">Устранение неполадок, toostart hello сбора аудита записывает ошибку tooidentify hello, связанной с проблемой hello.</span><span class="sxs-lookup"><span data-stu-id="33533-109">toostart troubleshooting, collect hello audit logs tooidentify hello error associated with hello issue.</span></span>

<span data-ttu-id="33533-110">В hello портал Azure, щелкните **Обзор** > **виртуальные машины** > *виртуальной машины Windows*  >   **Параметры** > **журналы аудита**.</span><span class="sxs-lookup"><span data-stu-id="33533-110">In hello Azure portal, click **Browse** > **Virtual machines** > *your Windows virtual machine* > **Settings** > **Audit logs**.</span></span>

[!INCLUDE [virtual-machines-troubleshoot-deployment-new-vm-issue1](../../../../includes/virtual-machines-troubleshoot-deployment-new-vm-issue1-include.md)]

[!INCLUDE [virtual-machines-windows-troubleshoot-deployment-new-vm-table](../../../../includes/virtual-machines-windows-troubleshoot-deployment-new-vm-table.md)]

<span data-ttu-id="33533-111">**Y:** Если hello ОС Windows обобщены и его отправки и/или записанный с помощью hello обобщенный параметр, то не будет ошибок.</span><span class="sxs-lookup"><span data-stu-id="33533-111">**Y:** If hello OS is Windows generalized, and it is uploaded and/or captured with hello generalized setting, then there won’t be any errors.</span></span> <span data-ttu-id="33533-112">Аналогично Если hello ОС специализированные Windows, и его отправки и/или захватить с hello специализированные параметр, то не будет ошибок.</span><span class="sxs-lookup"><span data-stu-id="33533-112">Similarly, if hello OS is Windows specialized, and it is uploaded and/or captured with hello specialized setting, then there won’t be any errors.</span></span>

<span data-ttu-id="33533-113">**Ошибки передачи:**</span><span class="sxs-lookup"><span data-stu-id="33533-113">**Upload Errors:**</span></span>

<span data-ttu-id="33533-114">**N<sup>1</sup>:** Если hello ОС Windows обобщенный и передается как специализированными, возникнет ошибка подготовки тайм-аута с виртуальной Машины заблокировано на экране Приветствия hello hello.</span><span class="sxs-lookup"><span data-stu-id="33533-114">**N<sup>1</sup>:** If hello OS is Windows generalized, and it is uploaded as specialized, you will get a provisioning timeout error with hello VM stuck at hello OOBE screen.</span></span>

<span data-ttu-id="33533-115">**N<sup>2</sup>:** Если hello ОС Windows специализированные и отправкой как обобщенный, вы получите подготовки ошибка с виртуальной Машины заблокировано на экран Приветствия hello, поскольку hello Новая виртуальная машина запущена с исходного компьютера hello hello имя, имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="33533-115">**N<sup>2</sup>:** If hello OS is Windows specialized, and it is uploaded as generalized, you will get a provisioning failure error with hello VM stuck at hello OOBE screen because hello new VM is running with hello original computer name, username and password.</span></span>

<span data-ttu-id="33533-116">**Способы устранения:**</span><span class="sxs-lookup"><span data-stu-id="33533-116">**Resolution:**</span></span>

<span data-ttu-id="33533-117">Отправить tooresolve оба эти ошибки Здравствуйте исходного VHD, доступных в локальной среде, с hello же задание, что и для hello ОС (обобщенный/специализированные).</span><span class="sxs-lookup"><span data-stu-id="33533-117">tooresolve both these errors, upload hello original VHD, available on-prem, with hello same setting as that for hello OS (generalized/specialized).</span></span> <span data-ttu-id="33533-118">tooupload как обобщены, сначала следует помнить toorun sysprep.</span><span class="sxs-lookup"><span data-stu-id="33533-118">tooupload as generalized, remember toorun sysprep first.</span></span> <span data-ttu-id="33533-119">В разделе [Создание и отправка Windows Server VHD tooAzure](createupload-vhd.md) для получения дополнительной информации.</span><span class="sxs-lookup"><span data-stu-id="33533-119">See [Create and upload a Windows Server VHD tooAzure](createupload-vhd.md) for more information.</span></span>

<span data-ttu-id="33533-120">**Ошибки записи:**</span><span class="sxs-lookup"><span data-stu-id="33533-120">**Capture Errors:**</span></span>

<span data-ttu-id="33533-121">**N<sup>3</sup>:** Если hello ОС Windows обобщенный и записывается в виде специализированными, вы получите подготовки ошибка тайм-аута из-за hello исходной виртуальной Машины не может использоваться как она помечена как обобщенный.</span><span class="sxs-lookup"><span data-stu-id="33533-121">**N<sup>3</sup>:** If hello OS is Windows generalized, and it is captured as specialized, you will get a provisioning timeout error because hello original VM is not usable as it is marked as generalized.</span></span>

<span data-ttu-id="33533-122">**N<sup>4</sup>:** Если специализированные Windows, и она записывается как обобщенный hello операционной системы, вы получите инициализации: сбой, так как hello новой виртуальной Машины, выполнив hello исходное имя компьютера, имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="33533-122">**N<sup>4</sup>:** If hello OS is Windows specialized, and it is captured as generalized, you will get a provisioning failure error because hello new VM is running with hello original computer name, username and password.</span></span> <span data-ttu-id="33533-123">Кроме того, исходный hello виртуальной Машины не выполняется, так как она помечена как специальные.</span><span class="sxs-lookup"><span data-stu-id="33533-123">Also, hello original VM is not usable because it is marked as specialized.</span></span>

<span data-ttu-id="33533-124">**Способы устранения:**</span><span class="sxs-lookup"><span data-stu-id="33533-124">**Resolution:**</span></span>

<span data-ttu-id="33533-125">tooresolve оба эти ошибки удалить текущее изображение hello из портала hello и [захватить снова из hello текущего виртуальные жесткие диски](capture-image.md) с "hello" того же параметра, что и для hello ОС (обобщенный/специализированные).</span><span class="sxs-lookup"><span data-stu-id="33533-125">tooresolve both these errors, delete hello current image from hello portal, and [recapture it from hello current VHDs](capture-image.md) with hello same setting as that for hello OS (generalized/specialized).</span></span>

## <a name="issue-custom-gallery-marketplace-image-allocation-failure"></a><span data-ttu-id="33533-126">Проблема: ошибка выделения (пользовательский образ, образ из коллекции или Marketplace)</span><span class="sxs-lookup"><span data-stu-id="33533-126">Issue: Custom/ gallery/ marketplace image; allocation failure</span></span>
<span data-ttu-id="33533-127">Эта ошибка возникает в ситуациях, при отправке hello новой виртуальной Машины запроса tooa кластера, либо не поддерживает запрос hello tooaccommodate доступного свободного места, или не поддерживает запрашиваемый размер виртуальной Машины hello.</span><span class="sxs-lookup"><span data-stu-id="33533-127">This error arises in situations when hello new VM request is sent tooa cluster that either does not have available free space tooaccommodate hello request, or cannot support hello VM size being requested.</span></span> <span data-ttu-id="33533-128">Не возможные toomix другую серию виртуальных машин в hello же облачной службе.</span><span class="sxs-lookup"><span data-stu-id="33533-128">It is not possible toomix different series of VMs in hello same cloud service.</span></span> <span data-ttu-id="33533-129">Поэтому следует toocreate новой виртуальной Машины разного размера, чем облачной службы, которые может поддерживать hello вычислений запрос завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="33533-129">So if you want toocreate a new VM of a different size than what your cloud service can support, hello compute request will fail.</span></span>

<span data-ttu-id="33533-130">В зависимости от ограничений hello hello облачной службы используйте toocreate Здравствуйте новой виртуальной Машины, может возникнуть ошибка вызвана одной из двух ситуациях.</span><span class="sxs-lookup"><span data-stu-id="33533-130">Depending on hello constraints of hello cloud service you use toocreate hello new VM, you might encounter an error caused by one of two situations.</span></span>

<span data-ttu-id="33533-131">**Причина 1:** hello облачная служба закрепленных tooa конкретного кластера, или связанных tooan территориальную группу и поэтому закрепленных tooa конкретного кластера намеренно.</span><span class="sxs-lookup"><span data-stu-id="33533-131">**Cause 1:** hello cloud service is pinned tooa specific cluster, or it is linked tooan affinity group, and hence pinned tooa specific cluster by design.</span></span> <span data-ttu-id="33533-132">Поэтому запрашивает новый вычислительных ресурсов в этой территориальной группе опрашиваются в hello же кластера, где размещаются существующие ресурсы hello.</span><span class="sxs-lookup"><span data-stu-id="33533-132">So new compute resource requests in that affinity group are tried in hello same cluster where hello existing resources are hosted.</span></span> <span data-ttu-id="33533-133">Однако hello одного кластера может либо hello поддержки запрошенный размер ВМ или имеет недостаточно места на диске, что приводит к ошибке выделения.</span><span class="sxs-lookup"><span data-stu-id="33533-133">However, hello same cluster may either not support hello requested VM size or have insufficient available space, resulting in an allocation error.</span></span> <span data-ttu-id="33533-134">Это верно ли hello новые ресурсы создаются через новой облачной службы или существующей облачной службе.</span><span class="sxs-lookup"><span data-stu-id="33533-134">This is true whether hello new resources are created through a new cloud service or through an existing cloud service.</span></span>

<span data-ttu-id="33533-135">**Способ устранения 1.**</span><span class="sxs-lookup"><span data-stu-id="33533-135">**Resolution 1:**</span></span>

* <span data-ttu-id="33533-136">Создайте новую облачную службу и свяжите ее с регионом или виртуальной сетью на основе региона.</span><span class="sxs-lookup"><span data-stu-id="33533-136">Create a new cloud service and associate it with either a region or a region-based virtual network.</span></span>
* <span data-ttu-id="33533-137">Создание новой виртуальной Машины в новой облачной службе hello.</span><span class="sxs-lookup"><span data-stu-id="33533-137">Create a new VM in hello new cloud service.</span></span>
  <span data-ttu-id="33533-138">Если возникает сообщение об ошибке при попытке toocreate новой облачной службы, повторите попытку позднее или изменить регион hello для hello облачной службы.</span><span class="sxs-lookup"><span data-stu-id="33533-138">If you get an error when trying toocreate a new cloud service, either retry at a later time or change hello region for hello cloud service.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="33533-139">Если предпринималась toocreate новой виртуальной Машины в существующей облачной службе, но не удалось и имели toocreate новой облачной службы для новой виртуальной Машины, можно выбрать tooconsolidate все виртуальные машины в hello же облачной службе.</span><span class="sxs-lookup"><span data-stu-id="33533-139">If you were trying toocreate a new VM in an existing cloud service but couldn’t, and had toocreate a new cloud service for your new VM, you can choose tooconsolidate all your VMs in hello same cloud service.</span></span> <span data-ttu-id="33533-140">toodo таким образом, удалите hello виртуальных машин в существующей облачной службе hello и создайте их повторно их диски в новой облачной службе hello.</span><span class="sxs-lookup"><span data-stu-id="33533-140">toodo so, delete hello VMs in hello existing cloud service, and recapture them from their disks in hello new cloud service.</span></span> <span data-ttu-id="33533-141">Однако это важно tooremember, что hello новой облачной службы будет новое имя и VIP, поэтому вам необходимо будет tooupdate эти данные для всех зависимостей hello, которые сейчас используют эту информацию для hello существующей облачной службы.</span><span class="sxs-lookup"><span data-stu-id="33533-141">However, it is important tooremember that hello new cloud service will have a new name and VIP, so you will need tooupdate these for all hello dependencies that currently use this information for hello existing cloud service.</span></span>
> 
> 

<span data-ttu-id="33533-142">**Причина 2:** hello облачная служба связана с виртуальной сети, которая является связанного tooan территориальную группу, поэтому закрепленных tooa конкретного кластера намеренно.</span><span class="sxs-lookup"><span data-stu-id="33533-142">**Cause 2:** hello cloud service is associated with a virtual network that is linked tooan affinity group, so it is pinned tooa specific cluster by design.</span></span> <span data-ttu-id="33533-143">Таким образом, все новые запросы вычислительных ресурсов в этой территориальной группе опрашиваются в hello же кластера, где размещаются существующие ресурсы hello.</span><span class="sxs-lookup"><span data-stu-id="33533-143">All new compute resource requests in that affinity group are therefore tried in hello same cluster where hello existing resources are hosted.</span></span> <span data-ttu-id="33533-144">Однако hello одного кластера может либо hello поддержки запрошенный размер ВМ или имеет недостаточно места на диске, что приводит к ошибке выделения.</span><span class="sxs-lookup"><span data-stu-id="33533-144">However, hello same cluster may either not support hello requested VM size or have insufficient available space, resulting in an allocation error.</span></span> <span data-ttu-id="33533-145">Это верно ли hello новые ресурсы создаются через новой облачной службы или существующей облачной службе.</span><span class="sxs-lookup"><span data-stu-id="33533-145">This is true whether hello new resources are created through a new cloud service or through an existing cloud service.</span></span>

<span data-ttu-id="33533-146">**Способ устранения 2.**</span><span class="sxs-lookup"><span data-stu-id="33533-146">**Resolution 2:**</span></span>

* <span data-ttu-id="33533-147">Создайте региональную виртуальную сеть.</span><span class="sxs-lookup"><span data-stu-id="33533-147">Create a new regional virtual network.</span></span>
* <span data-ttu-id="33533-148">Создание новой виртуальной Машины в новой виртуальной сети hello hello.</span><span class="sxs-lookup"><span data-stu-id="33533-148">Create hello new VM in hello new virtual network.</span></span>
* <span data-ttu-id="33533-149">[Подключиться к существующей виртуальной сети](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/) toohello новую виртуальную сеть.</span><span class="sxs-lookup"><span data-stu-id="33533-149">[Connect your existing virtual network](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/) toohello new virtual network.</span></span> <span data-ttu-id="33533-150">См. дополнительные сведения о [региональных виртуальных сетях](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).</span><span class="sxs-lookup"><span data-stu-id="33533-150">See more about [regional virtual networks](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).</span></span> <span data-ttu-id="33533-151">Вы также можете [миграция виртуальной сети территориальной группы на основе tooa региональной виртуальной сети](https://azure.microsoft.com/blog/2014/11/26/migrating-existing-services-to-regional-scope/), а затем создать hello новой виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="33533-151">Alternatively, you can [migrate your affinity-group-based virtual network tooa regional virtual network](https://azure.microsoft.com/blog/2014/11/26/migrating-existing-services-to-regional-scope/), and then create hello new VM.</span></span>

## <a name="next-steps"></a><span data-ttu-id="33533-152">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="33533-152">Next steps</span></span>
<span data-ttu-id="33533-153">При возникновении проблем во время запуска остановленной виртуальной машины Windows или в случае изменения размера существующей виртуальной машины Windows в Azure см. раздел [Устранение неполадок в классическом развертывании при перезагрузке или изменении размера существующей виртуальной машины Windows в Azure](virtual-machines-windows-classic-restart-resize-error-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="33533-153">If you encounter issues when you start a stopped Windows VM or resize an existing Windows VM in Azure, see [Troubleshoot classic deployment issues with restarting or resizing an existing Windows Virtual Machine in Azure](virtual-machines-windows-classic-restart-resize-error-troubleshooting.md).</span></span>

