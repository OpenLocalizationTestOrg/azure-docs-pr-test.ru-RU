---
title: "Группы доступности для виртуальных машин Windows в Azure | Документация Майкрософт"
description: "Изучите основные рекомендации по проектированию и реализации, касающиеся развертывания групп доступности в службах инфраструктуры Azure."
documentationcenter: 
services: virtual-machines-windows
author: iainfoulds
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: f9449f58-664b-4d5d-82f6-84c5d083047f
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 06/26/2017
ms.author: iainfou
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f94004fbd32dcc8a2394fcdfe2ac61519364f176
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="azure-availability-sets-guidelines-for-windows-vms"></a><span data-ttu-id="8ce10-103">Рекомендации по группам доступности Azure для виртуальных машин Windows</span><span class="sxs-lookup"><span data-stu-id="8ce10-103">Azure availability sets guidelines for Windows VMs</span></span>

[!INCLUDE [virtual-machines-windows-infrastructure-guidelines-intro](../../../includes/virtual-machines-windows-infrastructure-guidelines-intro.md)]

<span data-ttu-id="8ce10-104">Эта статья посвящена необходимым действиям по планированию группы доступности, позволяющим обеспечить доступность вашего приложения во время плановых или внеплановых событий.</span><span class="sxs-lookup"><span data-stu-id="8ce10-104">This article focuses on understanding the required planning steps for availability sets to ensure your applications remains accessible during planned or unplanned events.</span></span>

## <a name="implementation-guidelines-for-availability-sets"></a><span data-ttu-id="8ce10-105">Рекомендации по реализации групп доступности</span><span class="sxs-lookup"><span data-stu-id="8ce10-105">Implementation guidelines for availability sets</span></span>
<span data-ttu-id="8ce10-106">Решения</span><span class="sxs-lookup"><span data-stu-id="8ce10-106">Decisions:</span></span>

* <span data-ttu-id="8ce10-107">Сколько нужно групп доступности для различных ролей и уровней в инфраструктуре приложений?</span><span class="sxs-lookup"><span data-stu-id="8ce10-107">How many availability sets do you need for the various roles and tiers in your application infrastructure?</span></span>

<span data-ttu-id="8ce10-108">Задачи</span><span class="sxs-lookup"><span data-stu-id="8ce10-108">Tasks:</span></span>

* <span data-ttu-id="8ce10-109">Определите необходимое число виртуальных машин на каждом уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="8ce10-109">Define the number of VMs in each application tier you require.</span></span>
* <span data-ttu-id="8ce10-110">Определите, нужно ли скорректировать число доменов сбоя или доменов обновления для приложения.</span><span class="sxs-lookup"><span data-stu-id="8ce10-110">Determine if you need to adjust the number of fault or update domains to be used for your application.</span></span>
* <span data-ttu-id="8ce10-111">Определите требуемые группы доступности, учитывая соглашение об именовании и размещаемые в них виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="8ce10-111">Define the required availability sets using your naming convention and what VMs reside in them.</span></span> <span data-ttu-id="8ce10-112">Виртуальная машина может находиться только в одной группе доступности.</span><span class="sxs-lookup"><span data-stu-id="8ce10-112">A VM can only reside in one availability set.</span></span>

## <a name="availability-sets"></a><span data-ttu-id="8ce10-113">Группы доступности</span><span class="sxs-lookup"><span data-stu-id="8ce10-113">Availability sets</span></span>
<span data-ttu-id="8ce10-114">В Azure виртуальные машины могут быть помещены в логическую группу, называемую группой доступности.</span><span class="sxs-lookup"><span data-stu-id="8ce10-114">In Azure, virtual machines (VMs) can be placed in to a logical grouping called an availability set.</span></span> <span data-ttu-id="8ce10-115">При создании виртуальных машин в группе доступности платформа Azure распределяет их размещение по базовой инфраструктуре.</span><span class="sxs-lookup"><span data-stu-id="8ce10-115">When you create VMs within an availability set, the Azure platform distributes the placement of those VMs across the underlying infrastructure.</span></span> <span data-ttu-id="8ce10-116">Использование группы доступности гарантирует, что в случае планового обслуживания платформы Azure либо сбоя базового оборудования или инфраструктуры по крайней мере одна виртуальная машина продолжит работать.</span><span class="sxs-lookup"><span data-stu-id="8ce10-116">Should there be a planned maintenance event to the Azure platform or an underlying hardware / infrastructure fault, the use of availability sets ensures that at least one VM remains running.</span></span>

<span data-ttu-id="8ce10-117">Не рекомендуется размещать приложения на одной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="8ce10-117">As a best practice, applications should not reside on a single VM.</span></span> <span data-ttu-id="8ce10-118">Группа доступности, которая содержит одну виртуальную машину, не обеспечивает защиту от плановых или внеплановых событий платформы Azure.</span><span class="sxs-lookup"><span data-stu-id="8ce10-118">An availability set that contains a single VM doesn't gain any protection from planned or unplanned events within the Azure platform.</span></span> <span data-ttu-id="8ce10-119">[Соглашение об уровне обслуживания Azure](https://azure.microsoft.com/support/legal/sla/virtual-machines) предписывает использовать от двух виртуальных машин в группе доступности, чтобы обеспечить распределение виртуальных машин по базовой инфраструктуре.</span><span class="sxs-lookup"><span data-stu-id="8ce10-119">The [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines) requires two or more VMs within an availability set to allow the distribution of VMs across the underlying infrastructure.</span></span> <span data-ttu-id="8ce10-120">Если вы используете [службу хранилища Azure уровня "Премиум"](../../storage/storage-premium-storage.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), то соглашение об уровне обслуживания Azure распространяется на одну виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="8ce10-120">If you are using [Azure Premium Storage](../../storage/storage-premium-storage.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), the Azure SLA applies to a single VM.</span></span>

<span data-ttu-id="8ce10-121">Базовая инфраструктура в Azure делится на несколько аппаратных кластеров.</span><span class="sxs-lookup"><span data-stu-id="8ce10-121">The underlying infrastructure in Azure is divided in to multiple hardware clusters.</span></span> <span data-ttu-id="8ce10-122">Каждый аппаратный кластер может поддерживать определенный диапазон размеров виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="8ce10-122">Each hardware cluster can support a range of VM sizes.</span></span> <span data-ttu-id="8ce10-123">В любой момент времени группа доступности может размещаться только в одном аппаратном кластере.</span><span class="sxs-lookup"><span data-stu-id="8ce10-123">An availability set can only be hosted on a single hardware cluster at any point in time.</span></span> <span data-ttu-id="8ce10-124">Следовательно, диапазон размеров виртуальных машин, которые могут существовать в отдельной группе доступности, ограничен диапазоном размеров виртуальных машин, поддерживаемых аппаратным кластером.</span><span class="sxs-lookup"><span data-stu-id="8ce10-124">Therefore, the range of VM sizes that can exist in a single availability set is limited to the range of VM sizes supported by the hardware cluster.</span></span> <span data-ttu-id="8ce10-125">Аппаратный кластер для группы доступности выбирается при развертывании первой виртуальной машины в группе доступности или при запуске первой виртуальной машины в группе доступности, в которой все виртуальные машины в настоящее время остановлены и освобождены.</span><span class="sxs-lookup"><span data-stu-id="8ce10-125">The hardware cluster for the availability set is selected when the first VM in the availability set is deployed or when starting the first VM in an availability set where all VMs are currently in the stopped-deallocated state.</span></span> <span data-ttu-id="8ce10-126">Для определения диапазона размеров виртуальных машин, доступных для группы доступности, можно использовать следующую команду PowerShell: Get-AzureRmVMSize -ResourceGroupName \<строка\> -AvailabilitySetName \<строка\></span><span class="sxs-lookup"><span data-stu-id="8ce10-126">The following PowerShell command can be used to determine the range of VM sizes available for an availability set: "Get-AzureRmVMSize -ResourceGroupName \<string\> -AvailabilitySetName \<string\>"</span></span>

<span data-ttu-id="8ce10-127">Каждый аппаратный кластер делится на несколько доменов обновления и доменов сбоя.</span><span class="sxs-lookup"><span data-stu-id="8ce10-127">Each hardware cluster is divided in to multiple update domains and fault domains.</span></span> <span data-ttu-id="8ce10-128">Эти домены определяются узлами с общим циклом обновления или с общей физической инфраструктурой, например источником питания и сетью.</span><span class="sxs-lookup"><span data-stu-id="8ce10-128">These domains are defined by what hosts share a common update cycle, or share similar physical infrastructure such as power and networking.</span></span> <span data-ttu-id="8ce10-129">Azure автоматически распределяет виртуальные машины в группе доступности между доменами, чтобы обеспечивать доступность и отказоустойчивость.</span><span class="sxs-lookup"><span data-stu-id="8ce10-129">Azure automatically distributes your VMs within an availability set across domains to maintain availability and fault tolerance.</span></span> <span data-ttu-id="8ce10-130">В зависимости от размера приложения и числа виртуальных машин в группе доступности можно соответственно изменить количество доменов, которые требуется использовать.</span><span class="sxs-lookup"><span data-stu-id="8ce10-130">Depending on the size of your application and the number of VMs within an availability set, you can adjust the number of domains you wish to use.</span></span> <span data-ttu-id="8ce10-131">Вы можете больше узнать об [управлении доступностью и использовании доменов обновления и доменов сбоя](manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="8ce10-131">You can read more about [managing availability and use of update and fault domains](manage-availability.md).</span></span>

<span data-ttu-id="8ce10-132">При проектировании инфраструктуры приложений нужно составить план уровней приложения, которые будут использоваться.</span><span class="sxs-lookup"><span data-stu-id="8ce10-132">When designing your application infrastructure, plan the application tiers that you use.</span></span> <span data-ttu-id="8ce10-133">Объедините в группы доступности виртуальные машины, которые выполняют одну функцию, например интерфейсные виртуальные машины, на которых работает ПО IIS.</span><span class="sxs-lookup"><span data-stu-id="8ce10-133">Group VMs that serve the same purpose in to availability sets, such as an availability set for your front-end VMs running IIS.</span></span> <span data-ttu-id="8ce10-134">Создайте отдельную группу доступности для серверных виртуальных машин, на которых работает решение SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8ce10-134">Create a separate availability set for your back-end VMs running SQL Server.</span></span> <span data-ttu-id="8ce10-135">Цель этого — обеспечить защиту каждого компонента приложения посредством группы доступности и гарантировать, что как минимум один экземпляр приложения всегда будет работать.</span><span class="sxs-lookup"><span data-stu-id="8ce10-135">The goal is to ensure that each component of your application is protected by an availability set and at least once instance always remains running.</span></span>

<span data-ttu-id="8ce10-136">Над каждым уровнем приложения можно использовать балансировщики нагрузки, которые будут функционировать вместе с группой доступности и обеспечивать перенаправление трафика в работающий экземпляр.</span><span class="sxs-lookup"><span data-stu-id="8ce10-136">Load balancers can be utilized in front of each application tier to work alongside an availability set and ensure traffic can always be routed to a running instance.</span></span> <span data-ttu-id="8ce10-137">Без подсистемы балансировки нагрузки виртуальные машины могут продолжать работать на протяжении всех плановых и внеплановых событий обслуживания, но пользователи могут не иметь возможности обращаться к ним, если недоступна основная виртуальная машина.</span><span class="sxs-lookup"><span data-stu-id="8ce10-137">Without a load balancer, your VMs may continue running throughout planned and unplanned maintenance events, but your end user may not be able to resolve them if the primary VM is unavailable.</span></span>

<span data-ttu-id="8ce10-138">Обеспечение высокого уровня доступности приложения следует проектировать на уровне хранилища.</span><span class="sxs-lookup"><span data-stu-id="8ce10-138">Design your application for high availability at storage layer.</span></span> <span data-ttu-id="8ce10-139">Рекомендуется [использовать Управляемые диски для виртуальных машин в группе доступности](manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="8ce10-139">The best practice is to [use Managed Disks for VMs in an Availability Set](manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span> <span data-ttu-id="8ce10-140">Если сейчас вы используете неуправляемые диски, мы настоятельно рекомендуем [преобразовать виртуальные машины в группе доступности для использования Управляемых дисков](convert-unmanaged-to-managed-disks.md#convert-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="8ce10-140">If you are currently using unmanaged disks, we highly recommend you to [convert VMs in Availability Set to use Managed Disks](convert-unmanaged-to-managed-disks.md#convert-vms-in-an-availability-set).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8ce10-141">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="8ce10-141">Next steps</span></span>
[!INCLUDE [virtual-machines-windows-infrastructure-guidelines-next-steps](../../../includes/virtual-machines-windows-infrastructure-guidelines-next-steps.md)]
