---
title: "aaaUse a Windows, устранение неполадок виртуальной Машины в hello портал Azure | Документы Microsoft"
description: "Узнайте, как проблемы виртуальной машины Windows tootroubleshoot в Azure, подключающегося hello ОС диска tooa восстановления виртуальной Машины с помощью hello портал Azure"
services: virtual-machines-windows
documentationCenter: 
authors: genlin
manager: timlt
editor: 
ms.service: virtual-machines-windows
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure
ms.date: 05/26/2017
ms.author: genli
ms.openlocfilehash: 396f70338fa39f80bb9adcb9244d3c83f2a233eb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-a-windows-vm-by-attaching-hello-os-disk-tooa-recovery-vm-using-hello-azure-portal"></a>Устранение неполадок виртуальной Машины Windows путем присоединения восстановление tooa диска hello ОС виртуальной Машины с помощью hello портал Azure
Если на виртуальной машине (ВМ) в Azure, возникает ошибка загрузки или диск, может потребоваться tooperform устранения неполадок на виртуальном жестком диске hello сам. Распространенным примером будет обновление отказавшего приложения, которое предотвращает hello виртуальной Машины может tooboot успешно. Этой статьи описаны как toouse hello Azure портала tooconnect вашего виртуального жесткого диск виртуальной Машины Windows toofix tooanother все ошибки, а затем повторно создать исходной виртуальной Машины.

## <a name="recovery-process-overview"></a>Обзор процесса восстановления
Поиск и устранение неполадок Hello выглядит следующим образом:

1. Удалите hello ВМ возникновения проблемы, поддержание hello виртуальных жестких дисков.
2. Присоединение и подключить виртуальный жесткий диск hello tooanother виртуальной Машины Windows для устранения неполадок.
3. Подключите toohello Устранение неполадок виртуальной Машины. Изменение файлов или выполните любые средства toofix проблемы на hello исходный виртуальный жесткий диск.
4. Отключите образ и отсоединить виртуальный жесткий диск hello из hello, устранение неполадок виртуальной Машины.
5. Создайте виртуальную Машину с помощью hello исходный виртуальный жесткий диск.


## <a name="determine-boot-issues"></a>Выявление проблем при загрузке
toodetermine, почему ВМ не могут tooboot правильно, просмотрите Диагностика загрузки hello снимок экрана виртуальной Машины. Например, причиной может быть сбой обновления приложения, удаление или перемещение базового виртуального жесткого диска и т. п.

Выбрать ВМ на портале hello и прокрутите вниз toohello **поддержки + Устранение неполадок** раздела. Нажмите кнопку **загрузки диагностики** tooview экрана приветствия. Обратите внимание на любые сообщения об ошибках или коды ошибок toohelp определить, почему возникают проблемы с hello виртуальной Машины. Hello ниже приведен пример Ожидание остановки службы виртуальной Машины.

![Просмотр журналов консоли для диагностики загрузки виртуальной машины](./media/troubleshoot-recovery-disks-portal/screenshot-error.png)

Можно также щелкнуть **экрана** toodownload захвата снимка экрана приветствия виртуальной Машины.


## <a name="view-existing-virtual-hard-disk-details"></a>Просмотр сведений для существующего виртуального жесткого диска
Перед тем как присоединить tooanother вашего виртуального жесткого диска виртуальной Машины, необходимо имя hello tooidentify hello виртуального жесткого диска (VHD). 

Выберите группу ресурсов с портала hello, а затем выберите учетную запись хранилища. Нажмите кнопку **большие двоичные объекты**, как показано в следующий пример hello:

![Выбор больших двоичных объектов для хранения](./media/troubleshoot-recovery-disks-portal/storage-account-overview.png)

Обычно виртуальные жесткие диски хранятся в отдельном контейнере с именем **vhds**. Выберите контейнер hello tooview список виртуальных жестких дисков. Примечание hello имя вашего виртуального жесткого диска (префикс hello обычно — имя hello ВМ):

![Поиск виртуального жесткого диска в контейнере хранилища](./media/troubleshoot-recovery-disks-portal/storage-container.png)

Выберите существующий виртуальный жесткий диск из списка hello и скопируйте hello URL-адрес для использования в hello следующие шаги:

![Копирование URL-адреса существующего виртуального жесткого диска](./media/troubleshoot-recovery-disks-portal/copy-vhd-url.png)


## <a name="delete-existing-vm"></a>Удаление существующей виртуальной машины
Виртуальные жесткие диски и виртуальные машины — это разные ресурсы в Azure. Виртуальный жесткий диск является местом hello операционной системы, приложения и конфигурации. Hello самой ВМ — точно так же метаданные, которые определяет hello размер или расположение и ссылки на ресурсы, такие как виртуальный жесткий диск или виртуальный сетевой адаптер (NIC). Каждый виртуальный жесткий диск содержит аренды, назначенный при присоединении tooa виртуальной Машины. Несмотря на то, что диски с данными может быть присоединенные и отсоединенные даже в том случае, когда выполняется hello виртуальной Машины, диска ОС hello отключить невозможно, пока удаляется hello ресурса виртуальной Машины. Аренда Hello продолжается tooassociate hello ОС диска с виртуальной Машиной даже в том случае, если этой виртуальной Машины находится в состоянии остановки и освобождается.

Здравствуйте, первый шаг toorecover ВМ — toodelete hello ВМ сам ресурс. Удаление hello ВМ оставляет hello виртуальных жестких дисков в вашей учетной записи хранилища. После hello удаления виртуальной Машины присоединения hello виртуальный жесткий диск tooanother ВМ tootroubleshoot и устранение ошибок hello.

Выберите виртуальную Машину на портале hello, щелкните **удалить**:

![Снимок экрана диагностики загрузки виртуальной машины с сообщением об ошибке загрузки](./media/troubleshoot-recovery-disks-portal/stop-delete-vm.png)

Подождите, пока hello ВМ закончит удаление перед присоединением tooanother hello виртуальный жесткий диск виртуальной Машины. Аренда Hello hello виртуальный жесткий диск, который связывает его с hello виртуальной Машины должен toobe выпуска перед тем как присоединить tooanother hello виртуальный жесткий диск виртуальной Машины.


## <a name="attach-existing-virtual-hard-disk-tooanother-vm"></a>Подключить существующий виртуальный жесткий диск tooanother виртуальной Машины
Для Здравствуйте рядом шагах, для устранения неполадок используется другой виртуальной Машиной. Подключить существующий виртуальный жесткий диск toothis hello Устранение неполадок может toobrowse toobe ВМ и изменить содержимое диска hello. Этот процесс позволяет toocorrect все ошибки конфигурации или Просмотр дополнительных приложений или файлы журналов, например системы. Выберите или создайте другой toouse виртуальной Машины для устранения неполадок.

1. Выберите группу ресурсов с портала hello, а затем выберите виртуальную Машину по устранению неполадок. Выберите **Диски** и нажмите кнопку **Подключить существующий**.

    ![Подключить существующий диск в портале hello](./media/troubleshoot-recovery-disks-portal/attach-existing-disk.png)

2. tooselect существующего виртуального жесткого диска, нажмите кнопку **VHD-файл**:

    ![Поиск существующего виртуального жесткого диска](./media/troubleshoot-recovery-disks-portal/select-vhd-location.png)

3. Выберите учетную запись хранения и контейнер, затем щелкните существующий виртуальный жесткий диск. Нажмите кнопку hello **выберите** кнопку tooconfirm Выбор:

    ![Выбор существующего виртуального жесткого диска](./media/troubleshoot-recovery-disks-portal/select-vhd.png)

4. С вашей VHD выбранное сейчас, нажмите кнопку **ОК** tooattach hello существующего виртуального жесткого диска:

    ![Подтверждение присоединения существующего виртуального жесткого диска](./media/troubleshoot-recovery-disks-portal/attach-disk-confirm.png)

5. Через несколько секунд hello **дисков** ваш существующий виртуальный жесткий диск, подключенный как диск данных перечислены области для вашей виртуальной Машины:

    ![Существующий виртуальный жесткий диск присоединен как диск данных](./media/troubleshoot-recovery-disks-portal/attached-disk.png)


## <a name="mount-hello-attached-data-disk"></a>Подключить hello подключенный диск данных

1. Откройте tooyour подключения удаленного рабочего стола виртуальной Машины. Выберите виртуальную Машину на портале hello и нажмите кнопку **Connect**. Загрузите и откройте hello подключение RDP-файл. Введите ваш toolog учетные данные в tooyour виртуальной Машины следующим образом:

    ![Войдите в виртуальную Машину с помощью удаленного рабочего стола tooyour](./media/troubleshoot-recovery-disks-portal/open-remote-desktop.png)

2. Откройте **диспетчер сервера** и выберите **Файловые службы и службы хранилища**. 

    ![Выбор параметра "Файловые службы и службы хранилища" в диспетчере сервера](./media/troubleshoot-recovery-disks-portal/server-manager-select-storage.png)

3. диск данных Hello автоматически обнаружены и подсоединен. toosee список hello подключенные диски, выберите **дисков**. Можно выбрать на диске tooview тома сведения о данных, в том числе буква диска hello. Здравствуйте, следующий пример показывает hello присоединенного диска данных и с помощью **F:**:

    ![Подключенный диск и сведения о томах в диспетчере сервера](./media/troubleshoot-recovery-disks-portal/server-manager-disk-attached.png)


## <a name="fix-issues-on-original-virtual-hard-disk"></a>Устранение неполадок на исходном виртуальном жестком диске
С hello существующий виртуальный жесткий диск подключен теперь можно выполнять обслуживание и действия по устранению неполадок при необходимости. После разрешения проблемы hello продолжите hello следующие шаги.


## <a name="unmount-and-detach-original-virtual-hard-disk"></a>Отключение и отсоединение исходного виртуального жесткого диска
После разрешения ошибки, отсоедините hello существующий виртуальный жесткий диск из виртуальной Машины по устранению неполадок. Расположение виртуального жесткого диска нельзя использовать с любой другой ВМ до освобождения аренды hello присоединение toohello hello виртуального жесткого диска, устранение неполадок виртуальной Машины.

1. Tooyour сеанс RDP hello виртуальной Машины, откройте **диспетчера сервера**, а затем выберите **файловых служб и служб хранилища**:

    ![Выбор параметра "Файловые службы и службы хранилища" в диспетчере сервера](./media/troubleshoot-recovery-disks-portal/server-manager-select-storage.png)

2. Щелкните **Диски** и выберите свой диск данных. Щелкните его правой кнопкой мыши и выберите **Отключить**.

    ![Диск данных hello набор как вне сети в диспетчере сервера](./media/troubleshoot-recovery-disks-portal/server-manager-set-disk-offline.png)

3. Теперь отсоедините hello виртуальный жесткий диск из виртуальной Машины hello. Выберите виртуальную Машину в hello портал Azure и выберите **дисков**. Выберите существующий виртуальный жесткий диск и щелкните **Отсоединить**.

    ![Отсоединение существующего виртуального жесткого диска](./media/troubleshoot-recovery-disks-portal/detach-disk.png)

    Подождите, пока hello виртуальной Машины успешно отсоединена hello диск данных перед продолжением.

## <a name="create-vm-from-original-hard-disk"></a>Создание виртуальной машины из исходного жесткого диска
использовать ВМ с исходного виртуального жесткого диска, toocreate [этого шаблона Azure Resource Manager](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-specialized-vhd-existing-vnet). шаблон Hello развертывания ВМ в существующей виртуальной сети, с помощью hello URL-адрес VHD из hello ранее команд. Нажмите кнопку hello **развертывание tooAzure** кнопку следующим образом:

![Развертывание виртуальной машины из шаблона Github](./media/troubleshoot-recovery-disks-portal/deploy-template-from-github.png)

шаблон Hello загружается hello портала Azure для развертывания. Введите имена hello для новой виртуальной Машины и существующие ресурсы Azure и вставьте hello URL-адрес tooyour существующий виртуальный жесткий диск. Развертывание toobegin hello, нажмите кнопку **покупки**:

![Развертывание виртуальной машины на основе шаблона](./media/troubleshoot-recovery-disks-portal/deploy-from-image.png)


## <a name="re-enable-boot-diagnostics"></a>Восстановление диагностики загрузки
При создании ВМ из hello существующий виртуальный жесткий диск, диагностика загрузки может не быть доступной. toocheck hello состояние Диагностика загрузки и включите при необходимости выбрать ВМ на портале hello. В разделе **Мониторинг** щелкните **Параметры диагностики**. Убедитесь, находится в состоянии hello **на**, и hello флажок рядом слишком**загрузки диагностики** выбран. Если вы внесете здесь изменения, нажмите кнопку **Сохранить**.

![Обновление параметров диагностики загрузки](./media/troubleshoot-recovery-disks-portal/reenable-boot-diagnostics.png)

## <a name="next-steps"></a>Дальнейшие действия
Если возникают проблемы с подключением tooyour виртуальной Машины, см. раздел [tooan подключений RDP, устранение неполадок виртуальной Машины Azure](troubleshoot-rdp-connection.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json). Для устранения проблем с доступом к приложениям, выполняющимся на виртуальной машине, прочитайте статью [Устранение неполадок доступа к приложению, выполняющемуся в виртуальной машине Azure](troubleshoot-app-connection.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

Дополнительные сведения об использовании Resource Manager вы найдете в статье [Общие сведения об Azure Resource Manager](../../azure-resource-manager/resource-group-overview.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).