---
title: "aaaPrepare tooAzure tooupload виртуального жесткого диска Windows | Документы Microsoft"
description: "Как tooprepare Windows VHD или VHDX, перед отправкой tooAzure"
services: virtual-machines-windows
documentationcenter: 
author: glimoli
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7802489d-33ec-4302-82a4-91463d03887a
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 08/01/2017
ms.author: genli
ms.openlocfilehash: 530390e4c6a4f66ddfd4da23338f9bb3708c299f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="prepare-a-windows-vhd-or-vhdx-tooupload-tooazure"></a><span data-ttu-id="b81f8-103">Подготовка виртуального жесткого диска Windows или VHDX tooAzure tooupload</span><span class="sxs-lookup"><span data-stu-id="b81f8-103">Prepare a Windows VHD or VHDX tooupload tooAzure</span></span>
<span data-ttu-id="b81f8-104">Перед отправкой виртуальных машинах (VM) из локальной tooMicrosoft Azure, необходимо подготовить hello виртуального жесткого диска (VHD или VHDX).</span><span class="sxs-lookup"><span data-stu-id="b81f8-104">Before you upload a Windows  virtual machines (VM) from on-premises tooMicrosoft Azure, you must prepare hello virtual hard disk (VHD or VHDX).</span></span> <span data-ttu-id="b81f8-105">Azure поддерживает только первого поколения виртуальных машин, которые находятся в формате VHD hello и фиксированного размера диска.</span><span class="sxs-lookup"><span data-stu-id="b81f8-105">Azure supports only generation 1 VMs that are in hello VHD file format and have a fixed sized disk.</span></span> <span data-ttu-id="b81f8-106">Максимальный размер Hello разрешена для hello виртуального жесткого диска — 1023 ГБ.</span><span class="sxs-lookup"><span data-stu-id="b81f8-106">hello maximum size allowed for hello VHD is 1,023 GB.</span></span> <span data-ttu-id="b81f8-107">Вы можете преобразовать поколение 1 виртуальной Машины из hello VHDX файла tooVHD системы и с динамически расширяемый диска toofixed нулевого размера.</span><span class="sxs-lookup"><span data-stu-id="b81f8-107">You can convert a generation 1 VM from hello VHDX file system tooVHD and from a dynamically expanding disk toofixed-sized.</span></span> <span data-ttu-id="b81f8-108">Но вы не можете изменить поколение виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="b81f8-108">But you can't change a VM's generation.</span></span> <span data-ttu-id="b81f8-109">Дополнительные сведения см. в статье о том, [как выбрать поколение для виртуальной машины в Hyper-V](https://technet.microsoft.com/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v).</span><span class="sxs-lookup"><span data-stu-id="b81f8-109">For more information, see [Should I create a generation 1 or 2 VM in Hyper-V](https://technet.microsoft.com/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v).</span></span>

<span data-ttu-id="b81f8-110">Дополнительные сведения о политике поддержки hello для виртуальной Машины Azure см. в разделе [поддержка по Microsoft server для виртуальных машин Microsoft Azure](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="b81f8-110">For more information about hello support policy for Azure VM, see [Microsoft server software support for Microsoft Azure VMs](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines).</span></span>

> [!Note]
> <span data-ttu-id="b81f8-111">инструкции Hello в данной статье применимы toohello 64-разрядной версии Windows Server 2008 R2 и более поздних версий ОС Windows server.</span><span class="sxs-lookup"><span data-stu-id="b81f8-111">hello instructions in this article apply toohello 64-bit version of Windows Server 2008 R2 and later Windows server operating system.</span></span> <span data-ttu-id="b81f8-112">Сведения о запуске 32-разрядной версии операционной системы в Azure см. в статье [Support for 32-bit operating systems in Azure virtual machines](https://support.microsoft.com/help/4021388/support-for-32-bit-operating-systems-in-azure-virtual-machines) (Поддержка 32-разрядных операционных систем на виртуальных машинах Azure).</span><span class="sxs-lookup"><span data-stu-id="b81f8-112">For information about running 32-bit version of operating system in Azure, see [Support for 32-bit operating systems in Azure virtual machines](https://support.microsoft.com/help/4021388/support-for-32-bit-operating-systems-in-azure-virtual-machines).</span></span>

## <a name="convert-hello-virtual-disk-toovhd-and-fixed-size-disk"></a><span data-ttu-id="b81f8-113">Преобразовать диск фиксированного размера и tooVHD hello виртуального диска</span><span class="sxs-lookup"><span data-stu-id="b81f8-113">Convert hello virtual disk tooVHD and fixed size disk</span></span> 
<span data-ttu-id="b81f8-114">Если вам требуется tooconvert вашей toohello виртуальный диск требуется формат для Azure, воспользуйтесь одним из способов hello в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="b81f8-114">If you need tooconvert your virtual disk toohello required format for Azure, use one of hello methods in this section.</span></span> <span data-ttu-id="b81f8-115">Создайте резервную копию hello виртуальной Машины перед запуском процесса преобразования виртуального диска hello и убедитесь в том, что hello виртуального жесткого диска Windows правильно работает на локальном сервере hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-115">Back up hello VM before you run hello virtual disk conversion process and make sure that hello Windows VHD works correctly on hello local server.</span></span> <span data-ttu-id="b81f8-116">Устраните все ошибки в самой ВМ hello, прежде чем повторите tooconvert или передать его tooAzure.</span><span class="sxs-lookup"><span data-stu-id="b81f8-116">Resolve any errors within hello VM itself before you try tooconvert or upload it tooAzure.</span></span>

<span data-ttu-id="b81f8-117">После преобразования диска hello, создание виртуальной Машины, которая использует hello преобразовать диск.</span><span class="sxs-lookup"><span data-stu-id="b81f8-117">After you convert hello disk, create a VM that uses hello converted disk.</span></span> <span data-ttu-id="b81f8-118">Запустите и выполните вход toofinish ВМ toohello Подготовка hello виртуальной Машины для передачи.</span><span class="sxs-lookup"><span data-stu-id="b81f8-118">Start and sign in toohello VM toofinish preparing hello VM for upload.</span></span>

### <a name="convert-disk-using-hyper-v-manager"></a><span data-ttu-id="b81f8-119">Преобразование диска с помощью диспетчера Hyper-V</span><span class="sxs-lookup"><span data-stu-id="b81f8-119">Convert disk using Hyper-V Manager</span></span>
1. <span data-ttu-id="b81f8-120">Откройте диспетчер Hyper-V и выберите локального компьютера в левой hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-120">Open Hyper-V Manager and select your local computer on hello left.</span></span> <span data-ttu-id="b81f8-121">В меню над списком компьютера hello hello выберите **действия** > **изменить диск**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-121">In hello menu above hello computer list, click **Action** > **Edit Disk**.</span></span>
2. <span data-ttu-id="b81f8-122">На hello **поиск виртуального жесткого диска** экране, найдите и выберите виртуальный диск.</span><span class="sxs-lookup"><span data-stu-id="b81f8-122">On hello **Locate Virtual Hard Disk** screen, locate and select your virtual disk.</span></span>
3. <span data-ttu-id="b81f8-123">На hello **выбрать действие** экрана, а затем выберите **преобразовать** и **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-123">On hello **Choose Action** screen, and then select **Convert** and **Next**.</span></span>
4. <span data-ttu-id="b81f8-124">Если вам требуется tooconvert из формата VHDX, выберите **VHD** и нажмите кнопку **Далее**</span><span class="sxs-lookup"><span data-stu-id="b81f8-124">If you need tooconvert from VHDX, select **VHD** and then click **Next**</span></span>
5. <span data-ttu-id="b81f8-125">Если вам требуется tooconvert с динамически расширяемые диска, выберите **фиксированный размер** и нажмите кнопку **Далее**</span><span class="sxs-lookup"><span data-stu-id="b81f8-125">If you need tooconvert from a dynamically expanding disk, select **Fixed size** and then click **Next**</span></span>
6. <span data-ttu-id="b81f8-126">Найдите и выберите путь toosave hello виртуального жесткого диска в новый файл.</span><span class="sxs-lookup"><span data-stu-id="b81f8-126">Locate and select a path toosave hello new VHD file to.</span></span>
7. <span data-ttu-id="b81f8-127">Нажмите кнопку **Готово**</span><span class="sxs-lookup"><span data-stu-id="b81f8-127">Click **Finish**.</span></span>

>[!NOTE]
><span data-ttu-id="b81f8-128">команды Hello в этой статье, должны выполняться в сеансе PowerShell с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="b81f8-128">hello commands in this article must be run on an elevated PowerShell session.</span></span>

### <a name="convert-disk-by-using-powershell"></a><span data-ttu-id="b81f8-129">Преобразование диска с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="b81f8-129">Convert disk by using PowerShell</span></span>
<span data-ttu-id="b81f8-130">Виртуальный диск можно преобразовать с помощью hello [Convert-VHD](http://technet.microsoft.com/library/hh848454.aspx) команды в Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b81f8-130">You can convert a virtual disk by using hello [Convert-VHD](http://technet.microsoft.com/library/hh848454.aspx) command in Windows PowerShell.</span></span> <span data-ttu-id="b81f8-131">При запуске PowerShell выберите **Запуск от имени администратора**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-131">Select **Run as administrator** when you start PowerShell.</span></span> 

<span data-ttu-id="b81f8-132">Hello следующая команда преобразует VHDX tooVHD и динамически расширяемые toofixed размер диска:</span><span class="sxs-lookup"><span data-stu-id="b81f8-132">hello following example command converts from VHDX tooVHD, and from a dynamically expanding disk toofixed-size:</span></span>

```Powershell
Convert-VHD –Path c:\test\MY-VM.vhdx –DestinationPath c:\test\MY-NEW-VM.vhd -VHDType Fixed
```
<span data-ttu-id="b81f8-133">В этой команде замените значение hello для «-путь» с hello путь toohello виртуальный жесткий диск, необходимо tooconvert и hello значение для «-DestinationPath» hello новый путь и имя hello преобразовать диск.</span><span class="sxs-lookup"><span data-stu-id="b81f8-133">In this command, replace hello value for "-Path" with hello path toohello virtual hard disk that you want tooconvert and hello value for "-DestinationPath" with hello new path and name of hello converted disk.</span></span>

### <a name="convert-from-vmware-vmdk-disk-format"></a><span data-ttu-id="b81f8-134">Преобразование диска VMware в формате VMDK</span><span class="sxs-lookup"><span data-stu-id="b81f8-134">Convert from VMware VMDK disk format</span></span>
<span data-ttu-id="b81f8-135">При наличии образ виртуальной Машины Windows в hello [формате VMDK](https://en.wikipedia.org/wiki/VMDK), преобразуйте его tooa виртуального жесткого диска с помощью hello [преобразователь виртуальной Машины Microsoft](https://www.microsoft.com/download/details.aspx?id=42497).</span><span class="sxs-lookup"><span data-stu-id="b81f8-135">If you have a Windows VM image in hello [VMDK file format](https://en.wikipedia.org/wiki/VMDK), convert it tooa VHD by using hello [Microsoft VM Converter](https://www.microsoft.com/download/details.aspx?id=42497).</span></span> <span data-ttu-id="b81f8-136">Дополнительные сведения см. в статье hello блог [как tooConvert tooHyper-V VHD VMDK для VMware](http://blogs.msdn.com/b/timomta/archive/2015/06/11/how-to-convert-a-vmware-vmdk-to-hyper-v-vhd.aspx).</span><span class="sxs-lookup"><span data-stu-id="b81f8-136">For more information, see hello blog article [How tooConvert a VMware VMDK tooHyper-V VHD](http://blogs.msdn.com/b/timomta/archive/2015/06/11/how-to-convert-a-vmware-vmdk-to-hyper-v-vhd.aspx).</span></span>

## <a name="set-windows-configurations-for-azure"></a><span data-ttu-id="b81f8-137">Настройка конфигурации Windows для Azure</span><span class="sxs-lookup"><span data-stu-id="b81f8-137">Set Windows configurations for Azure</span></span>

<span data-ttu-id="b81f8-138">Для виртуальной Машины, которая планируется hello tooAzure tooupload, выполнить все команды в hello ниже шагов из [окно командной строки с повышенными привилегиями](https://technet.microsoft.com/library/cc947813.aspx):</span><span class="sxs-lookup"><span data-stu-id="b81f8-138">On hello VM that you plan tooupload tooAzure, run all commands in hello following steps from an [elevated Command Prompt window](https://technet.microsoft.com/library/cc947813.aspx):</span></span>

1. <span data-ttu-id="b81f8-139">Удалите все статические постоянный маршрут в таблице маршрутизации hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-139">Remove any static persistent route on hello routing table:</span></span>
   
   * <span data-ttu-id="b81f8-140">таблицы маршрутов tooview hello, запустите `route print` hello командной строки.</span><span class="sxs-lookup"><span data-stu-id="b81f8-140">tooview hello route table, run `route print` at hello command prompt.</span></span>
   * <span data-ttu-id="b81f8-141">Проверьте hello **маршруты сохраняемости** разделы.</span><span class="sxs-lookup"><span data-stu-id="b81f8-141">Check hello **Persistence Routes** sections.</span></span> <span data-ttu-id="b81f8-142">При наличии постоянный маршрут, воспользуйтесь [удаление маршрута](https://technet.microsoft.com/library/cc739598.apx) tooremove его.</span><span class="sxs-lookup"><span data-stu-id="b81f8-142">If there is a persistent route, use [route delete](https://technet.microsoft.com/library/cc739598.apx) tooremove it.</span></span>
2. <span data-ttu-id="b81f8-143">Удалите прокси-сервера WinHTTP hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-143">Remove hello WinHTTP proxy:</span></span>
   
    ```PowerShell
    netsh winhttp reset proxy
    ```
3. <span data-ttu-id="b81f8-144">Задать политику SAN диска hello слишком[Onlineall](https://technet.microsoft.com/library/gg252636.aspx).</span><span class="sxs-lookup"><span data-stu-id="b81f8-144">Set hello disk SAN policy too[Onlineall](https://technet.microsoft.com/library/gg252636.aspx).</span></span> 
   
    ```PowerShell
    diskpart 
    ```
    <span data-ttu-id="b81f8-145">Привет открыть окно командной строки введите следующие команды hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-145">In hello open Command Prompt window, type hello following commands:</span></span>

     ```DISKPART
    san policy=onlineall
    exit   
    ```

4. <span data-ttu-id="b81f8-146">Задать время по Гринвичу (UTC) для Windows и hello тип запуска службы времени Windows (w32time) hello слишком**автоматически**:</span><span class="sxs-lookup"><span data-stu-id="b81f8-146">Set Coordinated Universal Time (UTC) time for Windows and hello startup type of hello Windows Time (w32time) service too**Automatically**:</span></span>
   
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\TimeZoneInformation' -name "RealTimeIsUniversal" 1 -Type DWord

    Set-Service -Name w32time -StartupType Auto
    ```
5. <span data-ttu-id="b81f8-147">Задайте профиль toohello hello power **высокая производительность**:</span><span class="sxs-lookup"><span data-stu-id="b81f8-147">Set hello power profile toohello **High Performance**:</span></span>

    ```PowerShell
    powercfg /setactive SCHEME_MIN
    ```

## <a name="check-hello-windows-services"></a><span data-ttu-id="b81f8-148">Проверка служб Windows hello</span><span class="sxs-lookup"><span data-stu-id="b81f8-148">Check hello Windows services</span></span>
<span data-ttu-id="b81f8-149">Убедитесь, что каждый из следующих служб Windows hello задано toohello **значения по умолчанию Windows**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-149">Make sure that each of hello following Windows services is set toohello **Windows default values**.</span></span> <span data-ttu-id="b81f8-150">Ниже приведены минимальные номера hello служб, которые должны настраиваться toomake том, что этой hello виртуальная машина подключена.</span><span class="sxs-lookup"><span data-stu-id="b81f8-150">These are hello minimum numbers of services that must be set up toomake sure that hello VM has connectivity.</span></span> <span data-ttu-id="b81f8-151">tooreset hello параметры запуска, запустите hello, следующие команды:</span><span class="sxs-lookup"><span data-stu-id="b81f8-151">tooreset hello startup settings, run hello following commands:</span></span>
   
```PowerShell
Set-Service -Name bfe -StartupType Auto
Set-Service -Name dhcp -StartupType Auto
Set-Service -Name dnscache -StartupType Auto
Set-Service -Name IKEEXT -StartupType Auto
Set-Service -Name iphlpsvc -StartupType Auto
Set-Service -Name netlogon -StartupType Manual
Set-Service -Name netman -StartupType Manual
Set-Service -Name nsi -StartupType Auto
Set-Service -Name termService -StartupType Manual
Set-Service -Name MpsSvc -StartupType Auto
Set-Service -Name RemoteRegistry -StartupType Auto
```

## <a name="update-remote-desktop-registry-settings"></a><span data-ttu-id="b81f8-152">Обновление параметров реестра для удаленного рабочего стола</span><span class="sxs-lookup"><span data-stu-id="b81f8-152">Update Remote Desktop registry settings</span></span>
<span data-ttu-id="b81f8-153">Убедитесь, что hello следующие параметры настроены правильно для подключения удаленного рабочего стола:</span><span class="sxs-lookup"><span data-stu-id="b81f8-153">Make sure that hello following settings are configured correctly for remote desktop connection:</span></span>

>[!Note] 
><span data-ttu-id="b81f8-154">Может появиться сообщение об ошибке при запуске hello **Set-ItemProperty-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal службы — имя &lt;имя объекта&gt; &lt;значение&gt;** в этом пошаговом руководстве.</span><span class="sxs-lookup"><span data-stu-id="b81f8-154">You may receive an error message when you run hello **Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -name &lt;object name&gt; &lt;value&gt;** in these steps.</span></span> <span data-ttu-id="b81f8-155">сообщение об ошибке Hello можно спокойно проигнорировать.</span><span class="sxs-lookup"><span data-stu-id="b81f8-155">hello error message can be safely ignored.</span></span> <span data-ttu-id="b81f8-156">Это означает, что домен hello не внедряет этой конфигурации с помощью объекта групповой политики.</span><span class="sxs-lookup"><span data-stu-id="b81f8-156">It means only that hello domain is not pushing that configuration through a Group Policy object.</span></span>
>
>

1. <span data-ttu-id="b81f8-157">Включите протокол удаленного рабочего стола (RDP):</span><span class="sxs-lookup"><span data-stu-id="b81f8-157">Remote Desktop Protocol (RDP) is enabled:</span></span>
   
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -Value 0 -Type DWord

    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "fDenyTSConnections" -Value 0 -Type DWord
    ```
   
2. <span data-ttu-id="b81f8-158">Hello RDP-порту настроены правильно (по умолчанию порт 3389):</span><span class="sxs-lookup"><span data-stu-id="b81f8-158">hello RDP port is set up correctly (Default port 3389):</span></span>
   
    ```PowerShell
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "PortNumber" 3389 -Type DWord
    ```
    <span data-ttu-id="b81f8-159">При развертывании виртуальной Машины к порту 3389 создаются правила по умолчанию hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-159">When you deploy a VM, hello default rules are created against port 3389.</span></span> <span data-ttu-id="b81f8-160">Номер порта toochange hello следует сделайте после развертывания hello ВМ в Azure.</span><span class="sxs-lookup"><span data-stu-id="b81f8-160">If you want toochange hello port number,  do that after hello VM is deployed in Azure.</span></span>

3. <span data-ttu-id="b81f8-161">Hello прослушиватель в каждом сетевой интерфейс:</span><span class="sxs-lookup"><span data-stu-id="b81f8-161">hello listener is listening in every network interface:</span></span>
   
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "LanAdapter" 0 -Type DWord
   ```
4. <span data-ttu-id="b81f8-162">Настройка режима проверки подлинности на уровне сети hello для подключений по протоколу RDP hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-162">Configure hello Network Level Authentication mode for hello RDP connections:</span></span>
   
    ```PowerShell
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "UserAuthentication" 1 -Type DWord

    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "SecurityLayer" 1 -Type DWord

    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "fAllowSecProtocolNegotiation" 1 -Type DWord
     ```

5. <span data-ttu-id="b81f8-163">Установите значение keep-alive hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-163">Set hello keep-alive value：</span></span>
    
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "KeepAliveEnable" 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "KeepAliveInterval" 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "KeepAliveTimeout" 1 -Type DWord
    ```
6. <span data-ttu-id="b81f8-164">Выполните повторное подключение:</span><span class="sxs-lookup"><span data-stu-id="b81f8-164">Reconnect：</span></span>
    
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "fDisableAutoReconnect" 0 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "fInheritReconnectSame" 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "fReconnectSame" 0 -Type DWord
    ```
7. <span data-ttu-id="b81f8-165">Максимальное число одновременных подключений в hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-165">Limit hello number of concurrent connections：</span></span>
    
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "MaxInstanceCount" 4294967295 -Type DWord
    ```
8. <span data-ttu-id="b81f8-166">При наличии любого самозаверяющие сертификаты привязаны toohello RDP-прослушиватель, удалить их:</span><span class="sxs-lookup"><span data-stu-id="b81f8-166">If there are any self-signed certificates tied toohello RDP listener, remove them:</span></span>
    
    ```PowerShell
    Remove-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "SSLCertificateSHA1Hash"
    ```
    <span data-ttu-id="b81f8-167">Это toomake том, что можно подключиться в начале hello при развертывании виртуальной Машины hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-167">This is toomake sure that you can connect at hello beginning when you deploy hello VM.</span></span> <span data-ttu-id="b81f8-168">Можно также просмотреть это на следующем этапе после развертывания ВМ в Azure, при необходимости приветствия.</span><span class="sxs-lookup"><span data-stu-id="b81f8-168">You can also review this on a later stage after hello VM is deployed in Azure if needed.</span></span>

9. <span data-ttu-id="b81f8-169">Если hello виртуальной Машины будет входить в состав домена, убедитесь, что все hello следующие параметры toomake убедиться, что hello прежние параметры, не будут возвращены.</span><span class="sxs-lookup"><span data-stu-id="b81f8-169">If hello VM will be part of a Domain, check all hello following settings toomake sure that hello former settings are not reverted.</span></span> <span data-ttu-id="b81f8-170">Hello политики, которые должны быть проверены, hello следующее:</span><span class="sxs-lookup"><span data-stu-id="b81f8-170">hello policies that must be checked are hello following:</span></span>
    
    - <span data-ttu-id="b81f8-171">Включите RDP:</span><span class="sxs-lookup"><span data-stu-id="b81f8-171">RDP is enabled:</span></span>

         <span data-ttu-id="b81f8-172">Computer Configuration\Policies\Windows Settings\Administrative Templates\ Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span><span class="sxs-lookup"><span data-stu-id="b81f8-172">Computer Configuration\Policies\Windows Settings\Administrative Templates\ Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span>
         
         <span data-ttu-id="b81f8-173">**Разрешить пользователям tooconnect удаленно с помощью удаленного рабочего стола**</span><span class="sxs-lookup"><span data-stu-id="b81f8-173">**Allow users tooconnect remotely by using Remote Desktop**</span></span>

    - <span data-ttu-id="b81f8-174">Групповая политика с проверкой подлинности на уровне сети:</span><span class="sxs-lookup"><span data-stu-id="b81f8-174">NLA group policy:</span></span>

        <span data-ttu-id="b81f8-175">Settings\Administrative Templates\Components\Remote Desktop Services\Remote Desktop Session Host\Security:</span><span class="sxs-lookup"><span data-stu-id="b81f8-175">Settings\Administrative Templates\Components\Remote Desktop Services\Remote Desktop Session Host\Security:</span></span> 
        
        <span data-ttu-id="b81f8-176">**Требовать проверку подлинности пользователя для удаленных подключений путем проверки подлинности на уровне сети**</span><span class="sxs-lookup"><span data-stu-id="b81f8-176">**Require user Authentication for remote connections by using Network Level Authentication**</span></span>
    
    - <span data-ttu-id="b81f8-177">Параметры проверки активности:</span><span class="sxs-lookup"><span data-stu-id="b81f8-177">Keep Alive settings:</span></span>

        <span data-ttu-id="b81f8-178">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span><span class="sxs-lookup"><span data-stu-id="b81f8-178">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span> 
        
        <span data-ttu-id="b81f8-179">**Настроить интервал проверяемых на активность подключений**</span><span class="sxs-lookup"><span data-stu-id="b81f8-179">**Configure keep-alive connection interval**</span></span>

    - <span data-ttu-id="b81f8-180">Параметры повторного подключения:</span><span class="sxs-lookup"><span data-stu-id="b81f8-180">Reconnect settings:</span></span>

        <span data-ttu-id="b81f8-181">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span><span class="sxs-lookup"><span data-stu-id="b81f8-181">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span> 
        
        <span data-ttu-id="b81f8-182">**Автоматическое переподключение**</span><span class="sxs-lookup"><span data-stu-id="b81f8-182">**Automatic reconnection**</span></span>

    - <span data-ttu-id="b81f8-183">Максимальное число подключений в hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-183">Limit hello number of connections settings:</span></span>

        <span data-ttu-id="b81f8-184">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span><span class="sxs-lookup"><span data-stu-id="b81f8-184">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span> 
        
        <span data-ttu-id="b81f8-185">**Ограничить количество подключений**</span><span class="sxs-lookup"><span data-stu-id="b81f8-185">**Limit number of connections**</span></span>

## <a name="configure-windows-firewall-rules"></a><span data-ttu-id="b81f8-186">Настройка правил брандмауэра Windows</span><span class="sxs-lookup"><span data-stu-id="b81f8-186">Configure Windows Firewall rules</span></span>
1. <span data-ttu-id="b81f8-187">Включите брандмауэр Windows hello трех профилей (домен, Standard и Public):</span><span class="sxs-lookup"><span data-stu-id="b81f8-187">Turn on Windows Firewall on hello three profiles (Domain, Standard, and Public):</span></span>

   ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\DomainProfile' -name "EnableFirewall" -Value 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\PublicProfile' -name "EnableFirewall" -Value 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\Standardprofile' -name "EnableFirewall" -Value 1 -Type DWord
   ```

2. <span data-ttu-id="b81f8-188">Запустите следующую команду в PowerShell tooallow WinRM через hello трех профилей брандмауэра (домен, частные и Общие) hello и включение hello служба PowerShell Remote.</span><span class="sxs-lookup"><span data-stu-id="b81f8-188">Run hello following command in PowerShell tooallow WinRM through hello three firewall profiles (Domain, Private, and Public) and enable hello PowerShell Remote service:</span></span>
   
   ```PowerShell
    Enable-PSRemoting -force
    netsh advfirewall firewall set rule dir=in name="Windows Remote Management (HTTP-In)" new enable=yes
    netsh advfirewall firewall set rule dir=in name="Windows Remote Management (HTTP-In)" new enable=yes
   ```
3. <span data-ttu-id="b81f8-189">Включить hello следующий трафик RDP hello tooallow правила брандмауэра</span><span class="sxs-lookup"><span data-stu-id="b81f8-189">Enable hello following firewall rules tooallow hello RDP traffic</span></span> 

   ```PowerShell
    netsh advfirewall firewall set rule group="Remote Desktop" new enable=yes
   ```   
4. <span data-ttu-id="b81f8-190">Включите hello файла и общий доступ к принтеру правила, чтобы hello виртуальной Машины может отвечать команду ping tooa внутри hello виртуальной сети:</span><span class="sxs-lookup"><span data-stu-id="b81f8-190">Enable hello File and Printer Sharing rule so that hello VM can respond tooa ping command inside hello Virtual Network:</span></span>

   ```PowerShell
    netsh advfirewall firewall set rule dir=in name="File and Printer Sharing (Echo Request - ICMPv4-In)" new enable=yes
   ``` 
5. <span data-ttu-id="b81f8-191">Если hello виртуальной Машины будет входить в состав домена, проверьте следующие параметры toomake убедиться, что не будут возвращены hello прежние параметры hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-191">If hello VM  will be part of a Domain, check hello following settings toomake sure that hello former settings are not reverted.</span></span> <span data-ttu-id="b81f8-192">Hello AD политики, которые необходимо проверить, hello следующее:</span><span class="sxs-lookup"><span data-stu-id="b81f8-192">hello AD policies that must be checked are hello following:</span></span>

    - <span data-ttu-id="b81f8-193">Включить профили брандмауэра Windows hello</span><span class="sxs-lookup"><span data-stu-id="b81f8-193">Enable hello Windows Firewall profiles</span></span>

        <span data-ttu-id="b81f8-194">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Защита всех сетевых подключений**</span><span class="sxs-lookup"><span data-stu-id="b81f8-194">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Protect all network connections**</span></span>

       <span data-ttu-id="b81f8-195">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Защита всех сетевых подключений**</span><span class="sxs-lookup"><span data-stu-id="b81f8-195">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Protect all network connections**</span></span>

    - <span data-ttu-id="b81f8-196">Включите RDP:</span><span class="sxs-lookup"><span data-stu-id="b81f8-196">Enable RDP</span></span> 

        <span data-ttu-id="b81f8-197">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Разрешить исключения для входящих сообщений удаленного управления рабочим столом**</span><span class="sxs-lookup"><span data-stu-id="b81f8-197">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Allow inbound Remote Desktop exceptions**</span></span>

        <span data-ttu-id="b81f8-198">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Разрешить исключения для входящих сообщений удаленного управления рабочим столом**</span><span class="sxs-lookup"><span data-stu-id="b81f8-198">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Allow inbound Remote Desktop exceptions**</span></span>

    - <span data-ttu-id="b81f8-199">Включите ICMP-V4:</span><span class="sxs-lookup"><span data-stu-id="b81f8-199">Enable ICMP-V4</span></span>

        <span data-ttu-id="b81f8-200">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Разрешить исключения ICMP**</span><span class="sxs-lookup"><span data-stu-id="b81f8-200">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Allow ICMP exceptions**</span></span>

        <span data-ttu-id="b81f8-201">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Разрешить исключения ICMP**</span><span class="sxs-lookup"><span data-stu-id="b81f8-201">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Allow ICMP exceptions**</span></span>

## <a name="verify-vm-is-healthy-secure-and-accessible-with-rdp"></a><span data-ttu-id="b81f8-202">Проверка виртуальной машины: работоспособность, защищенность и доступ по протоколу RDP</span><span class="sxs-lookup"><span data-stu-id="b81f8-202">Verify VM is healthy, secure, and accessible with RDP</span></span> 
1. <span data-ttu-id="b81f8-203">toomake убедиться, что hello диск находится в работоспособном состоянии и согласованного, запустите операцию проверки диска hello при следующей перезагрузке виртуальной Машины:</span><span class="sxs-lookup"><span data-stu-id="b81f8-203">toomake sure hello disk is healthy and consistent, run a check disk operation at hello next VM restart:</span></span>

    ```PowerShell
    Chkdsk /f
    ```
    <span data-ttu-id="b81f8-204">Убедитесь, что отчет hello показывает исправна и очистки диска.</span><span class="sxs-lookup"><span data-stu-id="b81f8-204">Make sure that hello report shows a clean and healthy disk.</span></span>

2. <span data-ttu-id="b81f8-205">Чтобы задайте параметры данных конфигурации загрузки (BCD) hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-205">Set hello Boot Configuration Data (BCD) settings.</span></span> 

    > [!Note]
    > <span data-ttu-id="b81f8-206">Обязательно выполните следующие команды в окне командной строки с повышенными привилегиями, а **НЕ** в PowerShell:</span><span class="sxs-lookup"><span data-stu-id="b81f8-206">Make sure you run these commands on an elevated CMD window and **NOT** on PowerShell:</span></span>
   
   ```CMD
   bcdedit /set {bootmgr} integrityservices enable
   
   bcdedit /set {default} device partition=C:
   
   bcdedit /set {default} integrityservices enable
   
   bcdedit /set {default} recoveryenabled Off
   
   bcdedit /set {default} osdevice partition=C:
   
   bcdedit /set {default} bootstatuspolicy IgnoreAllFailures
   ```
3. <span data-ttu-id="b81f8-207">Проверьте согласованность репозитория правильно Windows hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-207">Verify that hello Windows Management Instrumentations repository is consistent.</span></span> <span data-ttu-id="b81f8-208">tooperform, выполнения hello следующую команду:</span><span class="sxs-lookup"><span data-stu-id="b81f8-208">tooperform this, run hello following command:</span></span>

    ```PowerShell
    winmgmt /verifyrepository
    ```
    <span data-ttu-id="b81f8-209">См. в случае повреждения репозитория hello [WMI: повреждение базы данных или не](https://blogs.technet.microsoft.com/askperf/2014/08/08/wmi-repository-corruption-or-not).</span><span class="sxs-lookup"><span data-stu-id="b81f8-209">If hello repository is corrupted, see [WMI: Repository Corruption, or Not](https://blogs.technet.microsoft.com/askperf/2014/08/08/wmi-repository-corruption-or-not).</span></span>

4. <span data-ttu-id="b81f8-210">Убедитесь, что любое другое приложение не использует hello порт 3389.</span><span class="sxs-lookup"><span data-stu-id="b81f8-210">Make sure that any other application is not using hello port 3389.</span></span> <span data-ttu-id="b81f8-211">Этот порт используется для hello службы протокола удаленного рабочего СТОЛА в Azure.</span><span class="sxs-lookup"><span data-stu-id="b81f8-211">This port is used for hello RDP service in Azure.</span></span> <span data-ttu-id="b81f8-212">Можно запустить **netstat - anob** toosee, какие порты в используются на hello виртуальной Машины:</span><span class="sxs-lookup"><span data-stu-id="b81f8-212">You can run **netstat -anob** toosee which ports are in used on hello VM:</span></span>

    ```PowerShell
    netstat -anob
    ```

5. <span data-ttu-id="b81f8-213">Если hello виртуального жесткого диска Windows, которые должны tooupload является контроллером домена, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="b81f8-213">If hello Windows VHD that you want tooupload is a domain controller, then follow these steps:</span></span>

    <span data-ttu-id="b81f8-214">О.</span><span class="sxs-lookup"><span data-stu-id="b81f8-214">A.</span></span> <span data-ttu-id="b81f8-215">Выполните [этих дополнительных шагов](https://support.microsoft.com/kb/2904015) tooprepare hello диска.</span><span class="sxs-lookup"><span data-stu-id="b81f8-215">Follow [these extra steps](https://support.microsoft.com/kb/2904015) tooprepare hello disk.</span></span>

    <span data-ttu-id="b81f8-216">B.</span><span class="sxs-lookup"><span data-stu-id="b81f8-216">B.</span></span> <span data-ttu-id="b81f8-217">Убедитесь, что вы знаете пароль DSRM hello случаю, когда toostart hello виртуальной Машины в режиме DSRM в определенный момент.</span><span class="sxs-lookup"><span data-stu-id="b81f8-217">Make sure that you know hello DSRM password in case you have toostart hello VM in DSRM at some point.</span></span> <span data-ttu-id="b81f8-218">Вы можете toorefer toothis связать tooset hello [Пароль DSRM](https://technet.microsoft.com/library/cc754363(v=ws.11).aspx).</span><span class="sxs-lookup"><span data-stu-id="b81f8-218">You may want toorefer toothis link tooset hello [DSRM password](https://technet.microsoft.com/library/cc754363(v=ws.11).aspx).</span></span>

6. <span data-ttu-id="b81f8-219">Убедитесь, что hello встроенной учетной записи администратора и пароль являются известными tooyou.</span><span class="sxs-lookup"><span data-stu-id="b81f8-219">Make sure that hello Built-in Administrator account and password are known tooyou.</span></span> <span data-ttu-id="b81f8-220">Можно tooreset hello текущий пароль локального администратора и убедитесь в том, что toosign этой учетной записи можно использовать в tooWindows через hello RDP-подключение.</span><span class="sxs-lookup"><span data-stu-id="b81f8-220">You may want tooreset hello current local administrator password and make sure that you can use this account toosign in tooWindows through hello RDP connection.</span></span> <span data-ttu-id="b81f8-221">Это разрешение доступа управляется hello объекта групповой политики «Локальный вход на через службу удаленных рабочих столов».</span><span class="sxs-lookup"><span data-stu-id="b81f8-221">This access permission is controlled by hello "Allow log on through Remote Desktop Services" Group Policy object.</span></span> <span data-ttu-id="b81f8-222">Этот объект можно просмотреть в hello редактор локальной групповой политики в разделе:</span><span class="sxs-lookup"><span data-stu-id="b81f8-222">You can view this object in hello Local Group Policy Editor under:</span></span>

    <span data-ttu-id="b81f8-223">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment</span><span class="sxs-lookup"><span data-stu-id="b81f8-223">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment</span></span>

7. <span data-ttu-id="b81f8-224">Убедитесь, что следующие AD hello политики toomake убедиться, что не блокируют RDP-доступ через протокола удаленного рабочего СТОЛА или из сети hello:</span><span class="sxs-lookup"><span data-stu-id="b81f8-224">Check hello following AD polices toomake sure that you are not blocking your RDP access through RDP nor from hello network:</span></span>

    - <span data-ttu-id="b81f8-225">Компьютер Configuration\Windows Settings\Security безопасности\Локальные политики\Назначение прав Assignment\Deny доступа toothis компьютер от сети hello</span><span class="sxs-lookup"><span data-stu-id="b81f8-225">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny access toothis computer from hello network</span></span>

    - <span data-ttu-id="b81f8-226">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Запретить вход в систему через службу удаленных рабочих столов.</span><span class="sxs-lookup"><span data-stu-id="b81f8-226">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on through Remote Desktop Services</span></span>


8. <span data-ttu-id="b81f8-227">Перезапуск hello ВМ toomake том, что Windows по-прежнему работоспособна можно получить с помощью hello RDP-подключение.</span><span class="sxs-lookup"><span data-stu-id="b81f8-227">Restart hello VM toomake sure that Windows is still healthy can be reached by using hello RDP connection.</span></span> <span data-ttu-id="b81f8-228">На этом этапе можно toocreate виртуальной Машины в вашей локальной Hyper-V toomake убедиться, что приветствия полностью выполняется запуск виртуальной Машины и затем проверьте, является ли он доступным протокола удаленного рабочего СТОЛА.</span><span class="sxs-lookup"><span data-stu-id="b81f8-228">At this point, you may want toocreate a VM in your local Hyper-V toomake sure hello VM is starting completely and then test whether it is RDP reachable.</span></span>

9. <span data-ttu-id="b81f8-229">Удалите все дополнительные фильтры TDI, например программное обеспечение, которое анализирует пакеты TCP, или дополнительные брандмауэры.</span><span class="sxs-lookup"><span data-stu-id="b81f8-229">Remove any extra Transport Driver Interface filters, such as software that analyzes TCP packets or extra firewalls.</span></span> <span data-ttu-id="b81f8-230">Можно также просмотреть это на следующем этапе после развертывания ВМ в Azure, при необходимости приветствия.</span><span class="sxs-lookup"><span data-stu-id="b81f8-230">You can also review this on a later stage after hello VM is deployed in Azure if needed.</span></span>

10. <span data-ttu-id="b81f8-231">Удалите другие стороннего программного обеспечения и драйвер, toophysical связанные компоненты или любой другой технологии виртуализации.</span><span class="sxs-lookup"><span data-stu-id="b81f8-231">Uninstall any other third-party software and driver that is related toophysical components or any other virtualization technology.</span></span>

### <a name="install-windows-updates"></a><span data-ttu-id="b81f8-232">Установка обновлений Windows</span><span class="sxs-lookup"><span data-stu-id="b81f8-232">Install Windows Updates</span></span>
<span data-ttu-id="b81f8-233">Лучшая конфигурация Hello является слишком**имеют уровень исправления hello машины hello в последней hello**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-233">hello ideal configuration is too**have hello patch level of hello machine at hello latest**.</span></span> <span data-ttu-id="b81f8-234">Если это невозможно, убедитесь, что hello, после обновления установлены:</span><span class="sxs-lookup"><span data-stu-id="b81f8-234">If this is not possible, make sure that hello following updates are installed:</span></span>

|                       |                   |           |                                       <span data-ttu-id="b81f8-235">Минимальная версия файла для 64-разрядной системы</span><span class="sxs-lookup"><span data-stu-id="b81f8-235">Minimum file version x64</span></span>       |                                      |                                      |                            |
|-------------------------|-------------------|------------------------------------|---------------------------------------------|--------------------------------------|--------------------------------------|----------------------------|
| <span data-ttu-id="b81f8-236">Компонент</span><span class="sxs-lookup"><span data-stu-id="b81f8-236">Component</span></span>               | <span data-ttu-id="b81f8-237">Binary</span><span class="sxs-lookup"><span data-stu-id="b81f8-237">Binary</span></span>            | <span data-ttu-id="b81f8-238">Windows 7 и Windows Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="b81f8-238">Windows 7 & Windows Server 2008 R2</span></span> | <span data-ttu-id="b81f8-239">Windows 8 и Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="b81f8-239">Windows 8 & Windows Server 2012</span></span>             | <span data-ttu-id="b81f8-240">Windows 8.1 и Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="b81f8-240">Windows 8.1 & Windows Server 2012 R2</span></span> | <span data-ttu-id="b81f8-241">Windows 10 и Windows Server 2016 RS1</span><span class="sxs-lookup"><span data-stu-id="b81f8-241">Windows 10 & Windows Server 2016 RS1</span></span> | <span data-ttu-id="b81f8-242">Windows 10 RS2</span><span class="sxs-lookup"><span data-stu-id="b81f8-242">Windows 10 RS2</span></span>             |
| <span data-ttu-id="b81f8-243">Хранилище</span><span class="sxs-lookup"><span data-stu-id="b81f8-243">Storage</span></span>                 | <span data-ttu-id="b81f8-244">disk.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-244">disk.sys</span></span>          | <span data-ttu-id="b81f8-245">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-245">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-246">6.2.9200.17638 / 6.2.9200.21757 — KB3137061</span><span class="sxs-lookup"><span data-stu-id="b81f8-246">6.2.9200.17638 / 6.2.9200.21757 - KB3137061</span></span> | <span data-ttu-id="b81f8-247">6.3.9600.18203 — KB3137061</span><span class="sxs-lookup"><span data-stu-id="b81f8-247">6.3.9600.18203 - KB3137061</span></span>           | -                                    | -                          |
|                         | <span data-ttu-id="b81f8-248">storport.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-248">storport.sys</span></span>      | <span data-ttu-id="b81f8-249">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-249">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-250">6.2.9200.17188 / 6.2.9200.21306 — KB3018489</span><span class="sxs-lookup"><span data-stu-id="b81f8-250">6.2.9200.17188 / 6.2.9200.21306 - KB3018489</span></span> | <span data-ttu-id="b81f8-251">6.3.9600.18573 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-251">6.3.9600.18573 - KB4022726</span></span>           | <span data-ttu-id="b81f8-252">10.0.14393.1358 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-252">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="b81f8-253">10.0.15063.332</span><span class="sxs-lookup"><span data-stu-id="b81f8-253">10.0.15063.332</span></span>             |
|                         | <span data-ttu-id="b81f8-254">ntfs.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-254">ntfs.sys</span></span>          | <span data-ttu-id="b81f8-255">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-255">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-256">6.2.9200.17623 / 6.2.9200.21743 — KB3121255</span><span class="sxs-lookup"><span data-stu-id="b81f8-256">6.2.9200.17623 / 6.2.9200.21743 - KB3121255</span></span> | <span data-ttu-id="b81f8-257">6.3.9600.18654 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-257">6.3.9600.18654 - KB4022726</span></span>           | <span data-ttu-id="b81f8-258">10.0.14393.1198 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-258">10.0.14393.1198 - KB4022715</span></span>          | <span data-ttu-id="b81f8-259">10.0.15063.447</span><span class="sxs-lookup"><span data-stu-id="b81f8-259">10.0.15063.447</span></span>             |
|                         | <span data-ttu-id="b81f8-260">Iologmsg.dll</span><span class="sxs-lookup"><span data-stu-id="b81f8-260">Iologmsg.dll</span></span>      | <span data-ttu-id="b81f8-261">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-261">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-262">6.2.9200.16384 — KB2995387</span><span class="sxs-lookup"><span data-stu-id="b81f8-262">6.2.9200.16384 - KB2995387</span></span>                  | -                                    | -                                    | -                          |
|                         | <span data-ttu-id="b81f8-263">Classpnp.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-263">Classpnp.sys</span></span>      | <span data-ttu-id="b81f8-264">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-264">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-265">6.2.9200.17061 / 6.2.9200.21180 — KB2995387</span><span class="sxs-lookup"><span data-stu-id="b81f8-265">6.2.9200.17061 / 6.2.9200.21180 - KB2995387</span></span> | <span data-ttu-id="b81f8-266">6.3.9600.18334 — KB3172614</span><span class="sxs-lookup"><span data-stu-id="b81f8-266">6.3.9600.18334 - KB3172614</span></span>           | <span data-ttu-id="b81f8-267">10.0.14393.953 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-267">10.0.14393.953 - KB4022715</span></span>           | -                          |
|                         | <span data-ttu-id="b81f8-268">Volsnap.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-268">Volsnap.sys</span></span>       | <span data-ttu-id="b81f8-269">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-269">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-270">6.2.9200.17047 / 6.2.9200.21165 — KB2975331</span><span class="sxs-lookup"><span data-stu-id="b81f8-270">6.2.9200.17047 / 6.2.9200.21165 - KB2975331</span></span> | <span data-ttu-id="b81f8-271">6.3.9600.18265 — KB3145384</span><span class="sxs-lookup"><span data-stu-id="b81f8-271">6.3.9600.18265 - KB3145384</span></span>           | -                                    | <span data-ttu-id="b81f8-272">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-272">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-273">partmgr.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-273">partmgr.sys</span></span>       | <span data-ttu-id="b81f8-274">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-274">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-275">6.2.9200.16681 — KB2877114</span><span class="sxs-lookup"><span data-stu-id="b81f8-275">6.2.9200.16681 - KB2877114</span></span>                  | <span data-ttu-id="b81f8-276">6.3.9600.17401 — KB3000850</span><span class="sxs-lookup"><span data-stu-id="b81f8-276">6.3.9600.17401 - KB3000850</span></span>           | <span data-ttu-id="b81f8-277">10.0.14393.953 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-277">10.0.14393.953 - KB4022715</span></span>           | <span data-ttu-id="b81f8-278">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-278">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-279">volmgr.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-279">volmgr.sys</span></span>        |                                    |                                             |                                      |                                      | <span data-ttu-id="b81f8-280">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-280">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-281">Volmgrx.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-281">Volmgrx.sys</span></span>       | <span data-ttu-id="b81f8-282">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-282">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | <span data-ttu-id="b81f8-283">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-283">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-284">Msiscsi.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-284">Msiscsi.sys</span></span>       | <span data-ttu-id="b81f8-285">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-285">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-286">6.2.9200.21006 — KB2955163</span><span class="sxs-lookup"><span data-stu-id="b81f8-286">6.2.9200.21006 - KB2955163</span></span>                  | <span data-ttu-id="b81f8-287">6.3.9600.18624 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-287">6.3.9600.18624 - KB4022726</span></span>           | <span data-ttu-id="b81f8-288">10.0.14393.1066 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-288">10.0.14393.1066 - KB4022715</span></span>          | <span data-ttu-id="b81f8-289">10.0.15063.447</span><span class="sxs-lookup"><span data-stu-id="b81f8-289">10.0.15063.447</span></span>             |
|                         | <span data-ttu-id="b81f8-290">Msdsm.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-290">Msdsm.sys</span></span>         | <span data-ttu-id="b81f8-291">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-291">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-292">6.2.9200.21474 — KB3046101</span><span class="sxs-lookup"><span data-stu-id="b81f8-292">6.2.9200.21474 - KB3046101</span></span>                  | <span data-ttu-id="b81f8-293">6.3.9600.18592 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-293">6.3.9600.18592 - KB4022726</span></span>           | -                                    | -                          |
|                         | <span data-ttu-id="b81f8-294">Mpio.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-294">Mpio.sys</span></span>          | <span data-ttu-id="b81f8-295">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-295">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-296">6.2.9200.21190 — KB3046101</span><span class="sxs-lookup"><span data-stu-id="b81f8-296">6.2.9200.21190 - KB3046101</span></span>                  | <span data-ttu-id="b81f8-297">6.3.9600.18616 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-297">6.3.9600.18616 - KB4022726</span></span>           | <span data-ttu-id="b81f8-298">10.0.14393.1198 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-298">10.0.14393.1198 - KB4022715</span></span>          | -                          |
|                         | <span data-ttu-id="b81f8-299">Fveapi.dll</span><span class="sxs-lookup"><span data-stu-id="b81f8-299">Fveapi.dll</span></span>        | <span data-ttu-id="b81f8-300">6.1.7601.23311 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-300">6.1.7601.23311 - KB3125574</span></span>         | <span data-ttu-id="b81f8-301">6.2.9200.20930 — KB2930244</span><span class="sxs-lookup"><span data-stu-id="b81f8-301">6.2.9200.20930 - KB2930244</span></span>                  | <span data-ttu-id="b81f8-302">6.3.9600.18294 — KB3172614</span><span class="sxs-lookup"><span data-stu-id="b81f8-302">6.3.9600.18294 - KB3172614</span></span>           | <span data-ttu-id="b81f8-303">10.0.14393.576 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-303">10.0.14393.576 - KB4022715</span></span>           | -                          |
|                         | <span data-ttu-id="b81f8-304">Fveapibase.dll</span><span class="sxs-lookup"><span data-stu-id="b81f8-304">Fveapibase.dll</span></span>    | <span data-ttu-id="b81f8-305">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-305">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-306">6.2.9200.20930 — KB2930244</span><span class="sxs-lookup"><span data-stu-id="b81f8-306">6.2.9200.20930 - KB2930244</span></span>                  | <span data-ttu-id="b81f8-307">6.3.9600.17415 — KB3172614</span><span class="sxs-lookup"><span data-stu-id="b81f8-307">6.3.9600.17415 - KB3172614</span></span>           | <span data-ttu-id="b81f8-308">10.0.14393.206 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-308">10.0.14393.206 - KB4022715</span></span>           | -                          |
| <span data-ttu-id="b81f8-309">Сеть</span><span class="sxs-lookup"><span data-stu-id="b81f8-309">Network</span></span>                 | <span data-ttu-id="b81f8-310">netvsc.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-310">netvsc.sys</span></span>        | -                                  | -                                           | -                                    | <span data-ttu-id="b81f8-311">10.0.14393.1198 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-311">10.0.14393.1198 - KB4022715</span></span>          | <span data-ttu-id="b81f8-312">10.0.15063.250 — KB4020001</span><span class="sxs-lookup"><span data-stu-id="b81f8-312">10.0.15063.250 - KB4020001</span></span> |
|                         | <span data-ttu-id="b81f8-313">mrxsmb10.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-313">mrxsmb10.sys</span></span>      | <span data-ttu-id="b81f8-314">6.1.7601.23816 — KB4022722</span><span class="sxs-lookup"><span data-stu-id="b81f8-314">6.1.7601.23816 - KB4022722</span></span>         | <span data-ttu-id="b81f8-315">6.2.9200.22108 — KB4022724</span><span class="sxs-lookup"><span data-stu-id="b81f8-315">6.2.9200.22108 - KB4022724</span></span>                  | <span data-ttu-id="b81f8-316">6.3.9600.18603 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-316">6.3.9600.18603 - KB4022726</span></span>           | <span data-ttu-id="b81f8-317">10.0.14393.479 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-317">10.0.14393.479 - KB4022715</span></span>           | <span data-ttu-id="b81f8-318">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="b81f8-318">10.0.15063.483</span></span>             |
|                         | <span data-ttu-id="b81f8-319">mrxsmb20.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-319">mrxsmb20.sys</span></span>      | <span data-ttu-id="b81f8-320">6.1.7601.23816 — KB4022722</span><span class="sxs-lookup"><span data-stu-id="b81f8-320">6.1.7601.23816 - KB4022722</span></span>         | <span data-ttu-id="b81f8-321">6.2.9200.21548 — KB4022724</span><span class="sxs-lookup"><span data-stu-id="b81f8-321">6.2.9200.21548 - KB4022724</span></span>                  | <span data-ttu-id="b81f8-322">6.3.9600.18586 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-322">6.3.9600.18586 - KB4022726</span></span>           | <span data-ttu-id="b81f8-323">10.0.14393.953 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-323">10.0.14393.953 - KB4022715</span></span>           | <span data-ttu-id="b81f8-324">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="b81f8-324">10.0.15063.483</span></span>             |
|                         | <span data-ttu-id="b81f8-325">mrxsmb.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-325">mrxsmb.sys</span></span>        | <span data-ttu-id="b81f8-326">6.1.7601.23816 — KB4022722</span><span class="sxs-lookup"><span data-stu-id="b81f8-326">6.1.7601.23816 - KB4022722</span></span>         | <span data-ttu-id="b81f8-327">6.2.9200.22074 — KB4022724</span><span class="sxs-lookup"><span data-stu-id="b81f8-327">6.2.9200.22074 - KB4022724</span></span>                  | <span data-ttu-id="b81f8-328">6.3.9600.18586 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-328">6.3.9600.18586 - KB4022726</span></span>           | <span data-ttu-id="b81f8-329">10.0.14393.953 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-329">10.0.14393.953 - KB4022715</span></span>           | <span data-ttu-id="b81f8-330">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-330">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-331">tcpip.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-331">tcpip.sys</span></span>         | <span data-ttu-id="b81f8-332">6.1.7601.23761 — KB4022722</span><span class="sxs-lookup"><span data-stu-id="b81f8-332">6.1.7601.23761 - KB4022722</span></span>         | <span data-ttu-id="b81f8-333">6.2.9200.22070 — KB4022724</span><span class="sxs-lookup"><span data-stu-id="b81f8-333">6.2.9200.22070 - KB4022724</span></span>                  | <span data-ttu-id="b81f8-334">6.3.9600.18478 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-334">6.3.9600.18478 - KB4022726</span></span>           | <span data-ttu-id="b81f8-335">10.0.14393.1358 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-335">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="b81f8-336">10.0.15063.447</span><span class="sxs-lookup"><span data-stu-id="b81f8-336">10.0.15063.447</span></span>             |
|                         | <span data-ttu-id="b81f8-337">http.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-337">http.sys</span></span>          | <span data-ttu-id="b81f8-338">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-338">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-339">6.2.9200.17285 — KB3042553</span><span class="sxs-lookup"><span data-stu-id="b81f8-339">6.2.9200.17285 - KB3042553</span></span>                  | <span data-ttu-id="b81f8-340">6.3.9600.18574 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-340">6.3.9600.18574 - KB4022726</span></span>           | <span data-ttu-id="b81f8-341">10.0.14393.251 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-341">10.0.14393.251 - KB4022715</span></span>           | <span data-ttu-id="b81f8-342">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="b81f8-342">10.0.15063.483</span></span>             |
|                         | <span data-ttu-id="b81f8-343">vmswitch.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-343">vmswitch.sys</span></span>      | <span data-ttu-id="b81f8-344">6.1.7601.23727 — KB4022719</span><span class="sxs-lookup"><span data-stu-id="b81f8-344">6.1.7601.23727 - KB4022719</span></span>         | <span data-ttu-id="b81f8-345">6.2.9200.22117 — KB4022724</span><span class="sxs-lookup"><span data-stu-id="b81f8-345">6.2.9200.22117 - KB4022724</span></span>                  | <span data-ttu-id="b81f8-346">6.3.9600.18654 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-346">6.3.9600.18654 - KB4022726</span></span>           | <span data-ttu-id="b81f8-347">10.0.14393.1358 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-347">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="b81f8-348">10.0.15063.138</span><span class="sxs-lookup"><span data-stu-id="b81f8-348">10.0.15063.138</span></span>             |
| <span data-ttu-id="b81f8-349">Core</span><span class="sxs-lookup"><span data-stu-id="b81f8-349">Core</span></span>                    | <span data-ttu-id="b81f8-350">ntoskrnl.exe</span><span class="sxs-lookup"><span data-stu-id="b81f8-350">ntoskrnl.exe</span></span>      | <span data-ttu-id="b81f8-351">6.1.7601.23807 — KB4022719</span><span class="sxs-lookup"><span data-stu-id="b81f8-351">6.1.7601.23807 - KB4022719</span></span>         | <span data-ttu-id="b81f8-352">6.2.9200.22170 — KB4022718</span><span class="sxs-lookup"><span data-stu-id="b81f8-352">6.2.9200.22170 - KB4022718</span></span>                  | <span data-ttu-id="b81f8-353">6.3.9600.18696 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-353">6.3.9600.18696 - KB4022726</span></span>           | <span data-ttu-id="b81f8-354">10.0.14393.1358 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-354">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="b81f8-355">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="b81f8-355">10.0.15063.483</span></span>             |
| <span data-ttu-id="b81f8-356">Службы удаленных рабочих столов</span><span class="sxs-lookup"><span data-stu-id="b81f8-356">Remote Desktop Services</span></span> | <span data-ttu-id="b81f8-357">rdpcorets.dll</span><span class="sxs-lookup"><span data-stu-id="b81f8-357">rdpcorets.dll</span></span>     | <span data-ttu-id="b81f8-358">6.2.9200.21506 — KB4022719</span><span class="sxs-lookup"><span data-stu-id="b81f8-358">6.2.9200.21506 - KB4022719</span></span>         | <span data-ttu-id="b81f8-359">6.2.9200.22104 — KB4022724</span><span class="sxs-lookup"><span data-stu-id="b81f8-359">6.2.9200.22104 - KB4022724</span></span>                  | <span data-ttu-id="b81f8-360">6.3.9600.18619 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-360">6.3.9600.18619 - KB4022726</span></span>           | <span data-ttu-id="b81f8-361">10.0.14393.1198 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-361">10.0.14393.1198 - KB4022715</span></span>          | <span data-ttu-id="b81f8-362">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-362">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-363">termsrv.dll</span><span class="sxs-lookup"><span data-stu-id="b81f8-363">termsrv.dll</span></span>       | <span data-ttu-id="b81f8-364">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-364">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="b81f8-365">6.2.9200.17048 — KB2973501</span><span class="sxs-lookup"><span data-stu-id="b81f8-365">6.2.9200.17048 - KB2973501</span></span>                  | <span data-ttu-id="b81f8-366">6.3.9600.17415 — KB3000850</span><span class="sxs-lookup"><span data-stu-id="b81f8-366">6.3.9600.17415 - KB3000850</span></span>           | <span data-ttu-id="b81f8-367">10.0.14393.0 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-367">10.0.14393.0 - KB4022715</span></span>             | <span data-ttu-id="b81f8-368">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="b81f8-368">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="b81f8-369">termdd.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-369">termdd.sys</span></span>        | <span data-ttu-id="b81f8-370">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-370">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | -                          |
|                         | <span data-ttu-id="b81f8-371">win32k.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-371">win32k.sys</span></span>        | <span data-ttu-id="b81f8-372">6.1.7601.23807 — KB4022719</span><span class="sxs-lookup"><span data-stu-id="b81f8-372">6.1.7601.23807 - KB4022719</span></span>         | <span data-ttu-id="b81f8-373">6.2.9200.22168 — KB4022718</span><span class="sxs-lookup"><span data-stu-id="b81f8-373">6.2.9200.22168 - KB4022718</span></span>                  | <span data-ttu-id="b81f8-374">6.3.9600.18698 — KB4022726</span><span class="sxs-lookup"><span data-stu-id="b81f8-374">6.3.9600.18698 - KB4022726</span></span>           | <span data-ttu-id="b81f8-375">10.0.14393.594 — KB4022715</span><span class="sxs-lookup"><span data-stu-id="b81f8-375">10.0.14393.594 - KB4022715</span></span>           | -                          |
|                         | <span data-ttu-id="b81f8-376">rdpdd.dll</span><span class="sxs-lookup"><span data-stu-id="b81f8-376">rdpdd.dll</span></span>         | <span data-ttu-id="b81f8-377">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-377">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | -                          |
|                         | <span data-ttu-id="b81f8-378">rdpwd.sys</span><span class="sxs-lookup"><span data-stu-id="b81f8-378">rdpwd.sys</span></span>         | <span data-ttu-id="b81f8-379">6.1.7601.23403 — KB3125574</span><span class="sxs-lookup"><span data-stu-id="b81f8-379">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | -                          |
| <span data-ttu-id="b81f8-380">Безопасность</span><span class="sxs-lookup"><span data-stu-id="b81f8-380">Security</span></span>                | <span data-ttu-id="b81f8-381">Из-за tooWannaCrypt</span><span class="sxs-lookup"><span data-stu-id="b81f8-381">Due tooWannaCrypt</span></span> | <span data-ttu-id="b81f8-382">KB4012212</span><span class="sxs-lookup"><span data-stu-id="b81f8-382">KB4012212</span></span>                          | <span data-ttu-id="b81f8-383">KB4012213</span><span class="sxs-lookup"><span data-stu-id="b81f8-383">KB4012213</span></span>                                   | <span data-ttu-id="b81f8-384">KB4012213</span><span class="sxs-lookup"><span data-stu-id="b81f8-384">KB4012213</span></span>                            | <span data-ttu-id="b81f8-385">KB4012606</span><span class="sxs-lookup"><span data-stu-id="b81f8-385">KB4012606</span></span>                            | <span data-ttu-id="b81f8-386">KB4012606</span><span class="sxs-lookup"><span data-stu-id="b81f8-386">KB4012606</span></span>                  |
|                         |                   |                                    | <span data-ttu-id="b81f8-387">KB4012216</span><span class="sxs-lookup"><span data-stu-id="b81f8-387">KB4012216</span></span>                                   |                                      | <span data-ttu-id="b81f8-388">KB4013198</span><span class="sxs-lookup"><span data-stu-id="b81f8-388">KB4013198</span></span>                            | <span data-ttu-id="b81f8-389">KB4013198</span><span class="sxs-lookup"><span data-stu-id="b81f8-389">KB4013198</span></span>                  |
|                         |                   | <span data-ttu-id="b81f8-390">KB4012215</span><span class="sxs-lookup"><span data-stu-id="b81f8-390">KB4012215</span></span>                          | <span data-ttu-id="b81f8-391">KB4012214</span><span class="sxs-lookup"><span data-stu-id="b81f8-391">KB4012214</span></span>                                   | <span data-ttu-id="b81f8-392">KB4012216</span><span class="sxs-lookup"><span data-stu-id="b81f8-392">KB4012216</span></span>                            | <span data-ttu-id="b81f8-393">KB4013429</span><span class="sxs-lookup"><span data-stu-id="b81f8-393">KB4013429</span></span>                            | <span data-ttu-id="b81f8-394">KB4013429</span><span class="sxs-lookup"><span data-stu-id="b81f8-394">KB4013429</span></span>                  |
|                         |                   |                                    | <span data-ttu-id="b81f8-395">KB4012217</span><span class="sxs-lookup"><span data-stu-id="b81f8-395">KB4012217</span></span>                                   |                                      | <span data-ttu-id="b81f8-396">KB4013429</span><span class="sxs-lookup"><span data-stu-id="b81f8-396">KB4013429</span></span>                            | <span data-ttu-id="b81f8-397">KB4013429</span><span class="sxs-lookup"><span data-stu-id="b81f8-397">KB4013429</span></span>                  |
       
### <span data-ttu-id="b81f8-398">Когда toouse sysprep<a id="step23"></a></span><span class="sxs-lookup"><span data-stu-id="b81f8-398">When toouse sysprep <a id="step23"></a></span></span>    

<span data-ttu-id="b81f8-399">Sysprep — это процесс, могут возникнуть в версии windows, приведет к сбросу hello установки системы hello и предоставит «out of hello box experience», удаляя все личные данные и сброс несколько компонентов.</span><span class="sxs-lookup"><span data-stu-id="b81f8-399">Sysprep is a process that you could run into a windows installation that will reset hello installation of hello system and will provide an “out of hello box experience” by removing all personal data and resetting several components.</span></span> <span data-ttu-id="b81f8-400">Обычно это делается, если вы хотите toocreate шаблон, из которого можно развернуть несколько виртуальных машин, имеющих определенную конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="b81f8-400">You typically do this if you want toocreate a template from which you can deploy several other VMs that have a specific configuration.</span></span> <span data-ttu-id="b81f8-401">Этот шаблон называется **универсальным образом**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-401">This is called a **generalized image**.</span></span>

<span data-ttu-id="b81f8-402">Если вместо этого необходимо только toocreate одной виртуальной Машины с одного диска нет toouse sysprep.</span><span class="sxs-lookup"><span data-stu-id="b81f8-402">If, instead, you want only toocreate one VM from one disk, you don’t have toouse sysprep.</span></span> <span data-ttu-id="b81f8-403">В этом случае можно просто создать hello виртуальной Машины в том, что известно как **специализированный образ**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-403">In this situation, you can just create hello VM from what is known as a **specialized image**.</span></span>

<span data-ttu-id="b81f8-404">Дополнительные сведения о том, как toocreate ВМ из специализированного диска отображается:</span><span class="sxs-lookup"><span data-stu-id="b81f8-404">For more information about how toocreate a VM from a specialized disk, see:</span></span>

- [<span data-ttu-id="b81f8-405">Создание виртуальной машины Windows из специализированного диска</span><span class="sxs-lookup"><span data-stu-id="b81f8-405">Create a VM from a specialized disk</span></span>](create-vm-specialized.md)
- <span data-ttu-id="b81f8-406">[Create a VM from a specialized VHD disk](https://azure.microsoft.com/resources/templates/201-vm-specialized-vhd/) (Создание виртуальной машины из специализированного VHD-диска)</span><span class="sxs-lookup"><span data-stu-id="b81f8-406">[Create a VM from a specialized VHD disk](https://azure.microsoft.com/resources/templates/201-vm-specialized-vhd/)</span></span>

<span data-ttu-id="b81f8-407">Если вы хотите toocreate обобщенный образ, необходимо toorun sysprep.</span><span class="sxs-lookup"><span data-stu-id="b81f8-407">If you want toocreate a generalized image, you need toorun sysprep.</span></span> <span data-ttu-id="b81f8-408">Дополнительные сведения о программе Sysprep см. в разделе [как tooUse Sysprep: введение](http://technet.microsoft.com/library/bb457073.aspx).</span><span class="sxs-lookup"><span data-stu-id="b81f8-408">For more information about Sysprep, see [How tooUse Sysprep: An Introduction](http://technet.microsoft.com/library/bb457073.aspx).</span></span> 

<span data-ttu-id="b81f8-409">Не все роли или приложения, установленные на компьютере с Windows, поддерживают этот образ.</span><span class="sxs-lookup"><span data-stu-id="b81f8-409">Not every role or application that’s installed on a Windows-based computer supports this generalization.</span></span> <span data-ttu-id="b81f8-410">Поэтому перед выполнять эту процедуру, см. Убедитесь, что следующие статьи toomake toohello этой роли "hello" этого компьютера поддерживается sysprep.</span><span class="sxs-lookup"><span data-stu-id="b81f8-410">So before you run this procedure, refer toohello following article toomake sure that hello role of that computer is supported by sysprep.</span></span> <span data-ttu-id="b81f8-411">[Sysprep Support for Server Roles](https://msdn.microsoft.com/windows/hardware/commercialize/manufacture/desktop/sysprep-support-for-server-roles) (Поддержка серверных ролей в Sysprep).</span><span class="sxs-lookup"><span data-stu-id="b81f8-411">For more information, [Sysprep Support for Server Roles](https://msdn.microsoft.com/windows/hardware/commercialize/manufacture/desktop/sysprep-support-for-server-roles).</span></span>

### <a name="steps-toogeneralize-a-vhd"></a><span data-ttu-id="b81f8-412">Действия toogeneralize виртуального жесткого диска</span><span class="sxs-lookup"><span data-stu-id="b81f8-412">Steps toogeneralize a VHD</span></span>

>[!NOTE]
> <span data-ttu-id="b81f8-413">После запуска sysprep.exe, как указано в hello, выполнив действия, выключите hello виртуальной Машины и не включить его снова до создания образа из него в Azure.</span><span class="sxs-lookup"><span data-stu-id="b81f8-413">After you run sysprep.exe as specified  in hello following steps, turn off hello VM, and do not turn it back on until you create an image from it in Azure.</span></span>

1. <span data-ttu-id="b81f8-414">Войдите в toohello виртуальной Машины Windows.</span><span class="sxs-lookup"><span data-stu-id="b81f8-414">Sign in toohello Windows VM.</span></span>
2. <span data-ttu-id="b81f8-415">Запустите **командную строку** от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="b81f8-415">Run **Command Prompt** as an administrator.</span></span> 
3. <span data-ttu-id="b81f8-416">Перейдите в каталог hello для: **%windir%\system32\sysprep**, а затем запустите **sysprep.exe**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-416">Change hello directory to: **%windir%\system32\sysprep**, and then run **sysprep.exe**.</span></span>
3. <span data-ttu-id="b81f8-417">В hello **средство подготовки системы** выберите **Enter System Out-of-Box Experience (OOBE)**и убедитесь, что hello **Generalize** установлен флажок.</span><span class="sxs-lookup"><span data-stu-id="b81f8-417">In hello **System Preparation Tool** dialog box, select **Enter System Out-of-Box Experience (OOBE)**, and make sure that hello **Generalize** check box is selected.</span></span>

    ![Средство SysPrep](media/prepare-for-upload-vhd-image/syspre.png)
4. <span data-ttu-id="b81f8-419">В разделе **Параметры завершения работы** выберите **Завершение работы**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-419">In **Shutdown Options**, select **Shutdown**.</span></span>
5. <span data-ttu-id="b81f8-420">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="b81f8-420">Click **OK**.</span></span>
6. <span data-ttu-id="b81f8-421">По завершении работы программы Sysprep завершите работу виртуальной Машины hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-421">When Sysprep completes, shut down hello VM.</span></span> <span data-ttu-id="b81f8-422">Не используйте **перезапустите** tooshut вниз hello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="b81f8-422">Do not use **Restart** tooshut down hello VM.</span></span>
7. <span data-ttu-id="b81f8-423">Теперь hello виртуального жесткого диска — Готово toobe отправлен.</span><span class="sxs-lookup"><span data-stu-id="b81f8-423">Now hello VHD is ready toobe uploaded.</span></span> <span data-ttu-id="b81f8-424">Дополнительные сведения о том, как toocreate ВМ с общего диска, на экране [Отправка обобщенный виртуальный жесткий ДИСК и использовать toocreate новые виртуальные машины в Azure](sa-upload-generalized.md).</span><span class="sxs-lookup"><span data-stu-id="b81f8-424">For more information about how toocreate a VM from a generalized disk, see [Upload a generalized VHD and use it toocreate a new VMs in Azure](sa-upload-generalized.md).</span></span>


## <a name="complete-recommended-configurations"></a><span data-ttu-id="b81f8-425">Рекомендуемые настройки</span><span class="sxs-lookup"><span data-stu-id="b81f8-425">Complete recommended configurations</span></span>
<span data-ttu-id="b81f8-426">Привет, следующие параметры не влияют на Отправка виртуального жесткого диска.</span><span class="sxs-lookup"><span data-stu-id="b81f8-426">hello following settings do not affect VHD uploading.</span></span> <span data-ttu-id="b81f8-427">Тем не менее, мы настоятельно рекомендуем их настроить.</span><span class="sxs-lookup"><span data-stu-id="b81f8-427">However, we strongly recommend that you configured them.</span></span>

* <span data-ttu-id="b81f8-428">Установка hello [агента ВМ Azure](http://go.microsoft.com/fwlink/?LinkID=394789&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="b81f8-428">Install hello [Azure VMs Agent](http://go.microsoft.com/fwlink/?LinkID=394789&clcid=0x409).</span></span> <span data-ttu-id="b81f8-429">Затем можно включить расширения виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="b81f8-429">Then you can enable VM extensions.</span></span> <span data-ttu-id="b81f8-430">Hello расширения ВМ реализуют значительную часть важных функций hello, возможно требуется toouse в ВМ, таких как сброс паролей, Настройка RDP и так далее.</span><span class="sxs-lookup"><span data-stu-id="b81f8-430">hello VM extensions implement most of hello critical functionality that you might want toouse with your VMs such as resetting passwords, configuring RDP, and so on.</span></span> <span data-ttu-id="b81f8-431">Дополнительные сведения можно найти в разделе </span><span class="sxs-lookup"><span data-stu-id="b81f8-431">For more information, see:</span></span>

    - <span data-ttu-id="b81f8-432">[VM Agent and Extensions – Part 1](https://azure.microsoft.com/blog/vm-agent-and-extensions-part-1/) (Расширения и агент виртуальной машины. Часть 1)</span><span class="sxs-lookup"><span data-stu-id="b81f8-432">[VM Agent and Extensions – Part 1](https://azure.microsoft.com/blog/vm-agent-and-extensions-part-1/)</span></span>
    - <span data-ttu-id="b81f8-433">[VM Agent and Extensions – Part 2](https://azure.microsoft.com/blog/vm-agent-and-extensions-part-2/) (Расширения и агент виртуальной машины. Часть 2)</span><span class="sxs-lookup"><span data-stu-id="b81f8-433">[VM Agent and Extensions – Part 2](https://azure.microsoft.com/blog/vm-agent-and-extensions-part-2/)</span></span>
* <span data-ttu-id="b81f8-434">Hello дампа журнала может оказаться полезным при устранении неполадок Windows аварийного завершения.</span><span class="sxs-lookup"><span data-stu-id="b81f8-434">hello Dump log can be helpful in troubleshooting Windows crash issues.</span></span> <span data-ttu-id="b81f8-435">Включите сбор журналов hello дампа:</span><span class="sxs-lookup"><span data-stu-id="b81f8-435">Enable hello Dump log collection:</span></span>
  
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "CrashDumpEnable" -Value "2" -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "DumpFile" -Value "%SystemRoot%\MEMORY.DMP"
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "AutoReboot" -Value 0 -Type DWord
    New-Item -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps'
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpFolder" -Value "c:\CrashDumps"
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpCount" -Value 10 -Type DWord
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpType" -Value 2 -Type DWord
    Set-Service -Name WerSvc -StartupType Manual
    ```
    <span data-ttu-id="b81f8-436">При получении ошибки во время выполнения любой hello практические шаги в этой статье, это означает, что разделы реестра hello уже существует.</span><span class="sxs-lookup"><span data-stu-id="b81f8-436">If you receive any errors during any of hello procedural steps in this article, this means that hello registry keys already exists.</span></span> <span data-ttu-id="b81f8-437">В этом случае используйте hello вместо следующие команды:</span><span class="sxs-lookup"><span data-stu-id="b81f8-437">In this situation, use hello following commands instead:</span></span>

    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "CrashDumpEnable" -Value "2" -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "DumpFile" -Value "%SystemRoot%\MEMORY.DMP"
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpFolder" -Value "c:\CrashDumps"
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpCount" -Value 10 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpType" -Value 2 -Type DWord
    Set-Service -Name WerSvc -StartupType Manual
    ```
*  <span data-ttu-id="b81f8-438">После создания hello ВМ в Azure рекомендуется поместить файл подкачки hello производительность tooimprove тома hello «Temporal водить».</span><span class="sxs-lookup"><span data-stu-id="b81f8-438">After hello VM is created in Azure, we recommend that you put hello pagefile on hello ”Temporal drive” volume tooimprove performance.</span></span> <span data-ttu-id="b81f8-439">Вы можете это сделать, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="b81f8-439">You can set up this as follows:</span></span>

    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management' -name "PagingFiles" -Value "D:\pagefile"
    ```
<span data-ttu-id="b81f8-440">Если любой диск, который является toohello подключенных виртуальных Машин, букву диска тома временных дисков hello обычно является «Г.»</span><span class="sxs-lookup"><span data-stu-id="b81f8-440">If there’s any data disk that is attached toohello VM, hello Temporal drive volume's drive letter is typically "D."</span></span> <span data-ttu-id="b81f8-441">Это назначение может отличаться, в зависимости от числа доступных дисков и hello настройки, выполненные hello.</span><span class="sxs-lookup"><span data-stu-id="b81f8-441">This designation could be different, depending on hello number of available drives and hello settings that you  make.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b81f8-442">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b81f8-442">Next steps</span></span>
* [<span data-ttu-id="b81f8-443">Отправка tooAzure образ виртуальной Машины Windows для развертывания диспетчера ресурсов</span><span class="sxs-lookup"><span data-stu-id="b81f8-443">Upload a Windows VM image tooAzure for Resource Manager deployments</span></span>](upload-generalized-managed.md)

