---
title: "aaaConfigure группы доступности AlwaysOn в виртуальных машинах Azure (классические) | Документы Microsoft"
description: "Создание группы доступности AlwaysOn на виртуальных машинах Azure. В этом учебнике используется главным образом hello пользовательского интерфейса и средства, а не сценарии."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 8d48a3d2-79f8-4ab0-9327-2f30ee0b2ff1
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 03/17/2017
ms.author: mikeray
ms.openlocfilehash: f428ad994a55378c281c959f4696fdcaf50632b1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="configure-always-on-availability-group-in-azure-virtual-machines-classic"></a><span data-ttu-id="997ee-104">Настройка группы доступности AlwaysOn на виртуальных машинах Azure (классическая модель)</span><span class="sxs-lookup"><span data-stu-id="997ee-104">Configure Always On availability group in Azure Virtual Machines (classic)</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="997ee-105">Классическая модель: пользовательский интерфейс</span><span class="sxs-lookup"><span data-stu-id="997ee-105">Classic: UI</span></span>](../classic/portal-sql-alwayson-availability-groups.md)
> * <span data-ttu-id="997ee-106">[Классическая модель: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span><span class="sxs-lookup"><span data-stu-id="997ee-106">[Classic: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span></span><br/>

<span data-ttu-id="997ee-107">Прежде чем начать, учтите, что теперь можно выполнить эту задачу в модели Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="997ee-107">Before you begin, consider that you can now complete this task in Azure Resource Manager model.</span></span> <span data-ttu-id="997ee-108">Для новых развертываний мы советуем использовать модель Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="997ee-108">We recommend Azure Resource Manager model for new deployments.</span></span> <span data-ttu-id="997ee-109">См. сведения в статье [Введение в группы доступности Always On SQL Server на виртуальных машинах Azure](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-109">See [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="997ee-110">Корпорация Майкрософт рекомендует наиболее новые развертывания модели hello диспетчера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="997ee-110">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="997ee-111">Azure имеет два toocreate модели развертывания и работы с ресурсами: [диспетчера ресурсов и классическом](../../../azure-resource-manager/resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-111">Azure has two different deployment models toocreate and work with resources: [Resource Manager and classic](../../../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="997ee-112">В этой статье объясняется, как toouse hello классической модели развертывания.</span><span class="sxs-lookup"><span data-stu-id="997ee-112">This article explains how toouse hello classic deployment model.</span></span> 

<span data-ttu-id="997ee-113">toocomplete этой задачи с моделью hello диспетчера ресурсов Azure, в разделе [SQL Server групп доступности AlwaysOn на виртуальных машинах Azure](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-113">toocomplete this task with hello Azure Resource Manager model, see [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

<span data-ttu-id="997ee-114">Это конца в конец учебнике рассказывается о том, как группы доступности tooimplement с помощью AlwaysOn в SQL Server на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="997ee-114">This end-to-end tutorial shows you how tooimplement availability groups by using SQL Server Always On running on Azure Virtual Machines.</span></span>

<span data-ttu-id="997ee-115">В конце учебника hello hello решения AlwaysOn в SQL Server в Azure будет состоять из hello следующие элементы:</span><span class="sxs-lookup"><span data-stu-id="997ee-115">At hello end of hello tutorial, your SQL Server Always On solution in Azure will consist of hello following elements:</span></span>

* <span data-ttu-id="997ee-116">виртуальной сети, которая содержит несколько подсетей, в том числе внешнюю и внутреннюю подсети;</span><span class="sxs-lookup"><span data-stu-id="997ee-116">A virtual network that contains multiple subnets and includes a frontend and a backend subnet</span></span>
* <span data-ttu-id="997ee-117">контроллера домена с доменом Active Directory (Azure AD);</span><span class="sxs-lookup"><span data-stu-id="997ee-117">A domain controller with an Active Directory (Azure AD) domain</span></span>
* <span data-ttu-id="997ee-118">Две виртуальные машины под управлением SQL Server, — toohello развернутой серверной подсети и домен присоединены к домену toohello Azure AD</span><span class="sxs-lookup"><span data-stu-id="997ee-118">Two virtual machines that run SQL Server and are deployed toohello backend subnet and joined toohello Azure AD domain</span></span>
* <span data-ttu-id="997ee-119">Трех узлов отказоустойчивого кластера с моделью кворума большинства узлов hello</span><span class="sxs-lookup"><span data-stu-id="997ee-119">A three-node failover cluster with hello Node Majority quorum model</span></span>
* <span data-ttu-id="997ee-120">группа доступности с двумя репликами базы данных доступности с синхронной фиксацией.</span><span class="sxs-lookup"><span data-stu-id="997ee-120">An availability group that has two synchronous-commit replicas of an availability database</span></span>

<span data-ttu-id="997ee-121">Следующая иллюстрация Hello является графическим представлением решения hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-121">hello following illustration is a graphical representation of hello solution.</span></span>

![Тестовая архитектура для групп доступности в Azure](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC791912.png)

<span data-ttu-id="997ee-123">Обратите внимание, что это одна из возможных конфигураций.</span><span class="sxs-lookup"><span data-stu-id="997ee-123">Note that this is one possible configuration.</span></span> <span data-ttu-id="997ee-124">Например можно свести к минимуму hello количество виртуальных машин для группы доступности с двумя репликами.</span><span class="sxs-lookup"><span data-stu-id="997ee-124">For example, you can minimize hello number of virtual machines for a two-replica availability group.</span></span> <span data-ttu-id="997ee-125">Эта конфигурация сохраняет на часы вычислений в Azure, используя hello контроллер домена как следящую общую папку hello кворума в кластере с двумя узлами.</span><span class="sxs-lookup"><span data-stu-id="997ee-125">This configuration saves on compute hours in Azure by using hello domain controller as hello quorum file share witness in a two-node cluster.</span></span> <span data-ttu-id="997ee-126">Этот метод уменьшает число hello виртуальной машины одним из конфигурации показано hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-126">This method reduces hello virtual machine count by one from hello illustrated configuration.</span></span>

<span data-ttu-id="997ee-127">В этом учебнике предполагается hello следующее:</span><span class="sxs-lookup"><span data-stu-id="997ee-127">This tutorial assumes hello following:</span></span>

* <span data-ttu-id="997ee-128">У вас уже есть учетная запись Azure.</span><span class="sxs-lookup"><span data-stu-id="997ee-128">You already have an Azure account.</span></span>
* <span data-ttu-id="997ee-129">Вы уже знаете, как toouse hello графического интерфейса пользователя в коллекции tooprovision hello виртуальной машины классической виртуальной машины под управлением SQL Server.</span><span class="sxs-lookup"><span data-stu-id="997ee-129">You already know how toouse hello GUI in hello virtual machine gallery tooprovision a classic virtual machine that runs SQL Server.</span></span>
* <span data-ttu-id="997ee-130">Вы хорошо понимаете принцип работы групп доступности AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="997ee-130">You already have a solid understanding of Always On availability groups.</span></span> <span data-ttu-id="997ee-131">Дополнительные сведения см. в разделе [Группы доступности AlwaysOn (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span><span class="sxs-lookup"><span data-stu-id="997ee-131">For more information, see [Always On Availability Groups (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="997ee-132">Если вы планируете использовать группы доступности AlwaysOn с SharePoint, ознакомьтесь также со статьей [Настройка групп обеспечения доступности SQL Server 2012 AlwaysOn для SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span><span class="sxs-lookup"><span data-stu-id="997ee-132">If you are interested in using Always On availability groups with SharePoint, also see [Configure SQL Server 2012 Always On Availability Groups for SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span></span>
> 
> 

## <a name="create-hello-virtual-network-and-domain-controller-server"></a><span data-ttu-id="997ee-133">Создание виртуальной сети hello и контроллер домена</span><span class="sxs-lookup"><span data-stu-id="997ee-133">Create hello virtual network and domain controller server</span></span>
<span data-ttu-id="997ee-134">Сначала создайте новую пробную учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="997ee-134">You begin with a new Azure trial account.</span></span> <span data-ttu-id="997ee-135">После настройки учетной записи должно быть на начальном экране hello объекта hello классический портал Azure.</span><span class="sxs-lookup"><span data-stu-id="997ee-135">After you set up your account, you should be on hello home screen of hello Azure classic portal.</span></span>

1. <span data-ttu-id="997ee-136">Нажмите кнопку hello **New** кнопки в левом углу hello hello внизу страницы приветствия, как показано на следующий снимок экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-136">Click hello **New** button at hello left corner of hello bottom of hello page, as shown in hello following screenshot.</span></span>
   
    ![Нажмите кнопку "Создать" портала hello](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665511.gif)
2. <span data-ttu-id="997ee-138">Нажмите кнопку **сетевые службы** > **виртуальной сети** > **настраиваемое создание**, как показано в следующих экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-138">Click **Network Services** > **Virtual Network** > **Custom Create**, as shown in hello following screenshot.</span></span>
   
    ![Создание виртуальной сети](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665512.gif)
3. <span data-ttu-id="997ee-140">В hello **Создание ВИРТУАЛЬНОЙ сети** диалогового окна поле, создайте новую виртуальную сеть с помощью параметров hello hello в следующей таблице и пошаговое выполнение страницы приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-140">In hello **CREATE A VIRTUAL NETWORK** dialog box, create a new virtual network by stepping through hello pages and using hello settings in hello following table.</span></span> 
   
   | <span data-ttu-id="997ee-141">Страница</span><span class="sxs-lookup"><span data-stu-id="997ee-141">Page</span></span> | <span data-ttu-id="997ee-142">данных</span><span class="sxs-lookup"><span data-stu-id="997ee-142">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="997ee-143">Информация о виртуальной сети</span><span class="sxs-lookup"><span data-stu-id="997ee-143">Virtual Network Details</span></span> |<span data-ttu-id="997ee-144">**Имя — ContosoNET**</span><span class="sxs-lookup"><span data-stu-id="997ee-144">**NAME = ContosoNET**</span></span><br/><span data-ttu-id="997ee-145">**REGION = West US**</span><span class="sxs-lookup"><span data-stu-id="997ee-145">**REGION = West US**</span></span> |
   | <span data-ttu-id="997ee-146">DNS-серверы и подключение VPN</span><span class="sxs-lookup"><span data-stu-id="997ee-146">DNS Servers and VPN Connectivity</span></span> |<span data-ttu-id="997ee-147">None</span><span class="sxs-lookup"><span data-stu-id="997ee-147">None</span></span> |
   | <span data-ttu-id="997ee-148">Адресные пространства виртуальной сети</span><span class="sxs-lookup"><span data-stu-id="997ee-148">Virtual Network Address Spaces</span></span> |<span data-ttu-id="997ee-149">Параметры показаны на следующий снимок экрана приветствия:</span><span class="sxs-lookup"><span data-stu-id="997ee-149">Settings are shown in hello following screenshot:</span></span> ![Создание виртуальной сети](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784620.png) |
4. <span data-ttu-id="997ee-151">Создайте виртуальную машину hello, который будет использоваться в качестве hello контроллера домена (DC).</span><span class="sxs-lookup"><span data-stu-id="997ee-151">Create hello virtual machine that you will use as hello domain controller (DC).</span></span> <span data-ttu-id="997ee-152">Нажмите кнопку **New** > **вычислений** > **виртуальной машины** > **из коллекции**, как показано в Следующий снимок экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-152">Click **New** > **Compute** > **Virtual Machine** > **From Gallery**, as shown in hello following screenshot.</span></span>
   
    ![Создание виртуальной машины](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784621.png)
5. <span data-ttu-id="997ee-154">В hello **Создание ВИРТУАЛЬНОЙ МАШИНЫ** диалоговом окне настройте новую виртуальную машину с помощью параметров hello hello в следующей таблице и пошаговое выполнение страницы приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-154">In hello **CREATE A VIRTUAL MACHINE** dialog box, configure a new virtual machine by stepping through hello pages and using hello settings in hello following table.</span></span> 
   
   | <span data-ttu-id="997ee-155">Страница</span><span class="sxs-lookup"><span data-stu-id="997ee-155">Page</span></span> | <span data-ttu-id="997ee-156">данных</span><span class="sxs-lookup"><span data-stu-id="997ee-156">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="997ee-157">Выберите операционную систему виртуальной машины hello</span><span class="sxs-lookup"><span data-stu-id="997ee-157">Select hello virtual machine operating system</span></span> |<span data-ttu-id="997ee-158">Центр обработки данных Windows Server 2012 R2;</span><span class="sxs-lookup"><span data-stu-id="997ee-158">Windows Server 2012 R2 Datacenter</span></span> |
   | <span data-ttu-id="997ee-159">Конфигурация виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-159">Virtual machine configuration</span></span> |<span data-ttu-id="997ee-160">**Дата выпуска версии** — (последняя)</span><span class="sxs-lookup"><span data-stu-id="997ee-160">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="997ee-161">**Имя виртуальной машины** — ContosoDC</span><span class="sxs-lookup"><span data-stu-id="997ee-161">**VIRTUAL MACHINE NAME** = ContosoDC</span></span><br/><span data-ttu-id="997ee-162">**Уровень** — Стандартный</span><span class="sxs-lookup"><span data-stu-id="997ee-162">**TIER** = STANDARD</span></span><br/><span data-ttu-id="997ee-163">**Размер** — A2 (2 ядра)</span><span class="sxs-lookup"><span data-stu-id="997ee-163">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="997ee-164">**Новое имя пользователя** — AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="997ee-164">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="997ee-165">**Новый пароль** — Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-165">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="997ee-166">**ПОДТВЕРЖДЕНИЕ** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-166">**CONFIRM** = Contoso!000</span></span> |
   | <span data-ttu-id="997ee-167">Конфигурация виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-167">Virtual machine configuration</span></span> |<span data-ttu-id="997ee-168">**Облачная служба** — создайте облачную службу</span><span class="sxs-lookup"><span data-stu-id="997ee-168">**CLOUD SERVICE** = Create a new cloud service</span></span><br/><span data-ttu-id="997ee-169">**DNS-имя облачной службы** — уникальное имя облачной службы</span><span class="sxs-lookup"><span data-stu-id="997ee-169">**CLOUD SERVICE DNS NAME** = A unique cloud service name</span></span><br/><span data-ttu-id="997ee-170">**DNS-имя** — уникальное имя (например, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="997ee-170">**DNS NAME** = A unique name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="997ee-171">**Регион, территориальная группа, виртуальная сеть** — ContosoNET</span><span class="sxs-lookup"><span data-stu-id="997ee-171">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="997ee-172">**Подсети виртуальной сети** — Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="997ee-172">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="997ee-173">**УЧЕТНАЯ ЗАПИСЬ ХРАНЕНИЯ** = используйте автоматически созданную учетную запись хранения</span><span class="sxs-lookup"><span data-stu-id="997ee-173">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="997ee-174">**ГРУППА ДОСТУПНОСТИ** = (нет)</span><span class="sxs-lookup"><span data-stu-id="997ee-174">**AVAILABILITY SET** = (None)</span></span> |
   | <span data-ttu-id="997ee-175">Параметры виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-175">Virtual machine options</span></span> |<span data-ttu-id="997ee-176">По умолчанию</span><span class="sxs-lookup"><span data-stu-id="997ee-176">Use defaults</span></span> |

<span data-ttu-id="997ee-177">После настройки hello новой виртуальной машины, дождитесь провизионирования toobe hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="997ee-177">After you configure hello new virtual machine, wait for hello virtual machine toobe provsioned.</span></span> <span data-ttu-id="997ee-178">Этот процесс занимает некоторое время toofinish.</span><span class="sxs-lookup"><span data-stu-id="997ee-178">This process takes some time toofinish.</span></span> <span data-ttu-id="997ee-179">При нажатии кнопки hello **виртуальной машины** на вкладке hello Azure классического портала, можно увидеть ContosoDC циклического состояния из **запуск (Подготовка)** слишком**остановлена**, **Запуск**, **выполняется (Провизионирование)**и, наконец, **под управлением**.</span><span class="sxs-lookup"><span data-stu-id="997ee-179">If you click hello **Virtual Machine** tab in hello Azure classic portal, you can see ContosoDC cycling states from **Starting (Provisioning)** too**Stopped**, **Starting**, **Running (Provisioning)**, and finally **Running**.</span></span>

<span data-ttu-id="997ee-180">Hello Контроллера домена успешно подготовлен.</span><span class="sxs-lookup"><span data-stu-id="997ee-180">hello DC server is now successfully provisioned.</span></span> <span data-ttu-id="997ee-181">После этого вы настроите hello домена Active Directory на этом сервере контроллера домена.</span><span class="sxs-lookup"><span data-stu-id="997ee-181">Next, you will configure hello Active Directory domain on this DC server.</span></span>

## <a name="configure-hello-domain-controller"></a><span data-ttu-id="997ee-182">Настройка контроллера домена hello</span><span class="sxs-lookup"><span data-stu-id="997ee-182">Configure hello domain controller</span></span>
<span data-ttu-id="997ee-183">В hello, выполнив действия настроить машину ContosoDC hello как контроллер домена для corp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="997ee-183">In hello following steps, you configure hello ContosoDC machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="997ee-184">Hello портале выберите hello **ContosoDC** машины.</span><span class="sxs-lookup"><span data-stu-id="997ee-184">In hello portal, select hello **ContosoDC** machine.</span></span> <span data-ttu-id="997ee-185">На hello **мониторинга** щелкните **Connect** tooopen файл удаленного рабочего стола (RDP) для удаленного доступа к рабочему столу.</span><span class="sxs-lookup"><span data-stu-id="997ee-185">On hello **Dashboard** tab, click **Connect** tooopen a remote desktop (RDP) file for remote desktop access.</span></span>
   
    ![Подключение tooVritual машины](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784622.png)
2. <span data-ttu-id="997ee-187">Войдите в систему с использованием настроенной учетной записи администратора (**\AzureAdmin**) и пароля (**Contoso!000**).</span><span class="sxs-lookup"><span data-stu-id="997ee-187">Sign in with your configured administrator account (**\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="997ee-188">По умолчанию hello **диспетчера сервера** должна отображаться панель мониторинга.</span><span class="sxs-lookup"><span data-stu-id="997ee-188">By default, hello **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="997ee-189">Нажмите кнопку hello **Добавить роли и компоненты** ссылку на панель мониторинга hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-189">Click hello **Add roles and features** link on hello dashboard.</span></span>
   
    ![Добавление ролей с помощью обозревателя серверов](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784623.png)
5. <span data-ttu-id="997ee-191">Нажмите кнопку **Далее** до получения toohello **ролей сервера** раздела.</span><span class="sxs-lookup"><span data-stu-id="997ee-191">Click **Next** until you get toohello **Server Roles** section.</span></span>
6. <span data-ttu-id="997ee-192">Выберите hello **доменных служб Active Directory** и **DNS-сервер** ролей.</span><span class="sxs-lookup"><span data-stu-id="997ee-192">Select hello **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="997ee-193">При появлении запроса добавьте требуемые для этих ролей дополнительные компоненты.</span><span class="sxs-lookup"><span data-stu-id="997ee-193">When prompted, add more features that these roles require.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="997ee-194">Вы получите предупреждение проверки об отсутствии статического IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="997ee-194">You will get a validation warning that there is no static IP address.</span></span> <span data-ttu-id="997ee-195">Если вы тестируете конфигурацию hello, нажмите кнопку **Продолжить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-195">If you are testing hello configuration, click **Continue**.</span></span> <span data-ttu-id="997ee-196">Для рабочих сценариев [PowerShell tooset hello статический IP-адрес компьютера контроллера домена hello](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-196">For production scenarios [use PowerShell tooset hello static IP address of hello domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   > 
   > 
   
    ![Диалоговое окно добавления ролей](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784624.png)
7. <span data-ttu-id="997ee-198">Нажмите кнопку **Далее** пока не достигнете hello **Подтверждение** раздела.</span><span class="sxs-lookup"><span data-stu-id="997ee-198">Click **Next** until you reach hello **Confirmation** section.</span></span> <span data-ttu-id="997ee-199">Выберите hello **перезапустите hello целевой сервер автоматически, если необходимо** флажок.</span><span class="sxs-lookup"><span data-stu-id="997ee-199">Select hello **Restart hello destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="997ee-200">Щелкните **Install**(Установить).</span><span class="sxs-lookup"><span data-stu-id="997ee-200">Click **Install**.</span></span>
9. <span data-ttu-id="997ee-201">После установки функции hello возвращают toohello **диспетчера сервера** панели мониторинга.</span><span class="sxs-lookup"><span data-stu-id="997ee-201">After hello features are installed, return toohello **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="997ee-202">Выберите hello новый **AD DS** параметр в левой области hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-202">Select hello new **AD DS** option on hello left pane.</span></span>
11. <span data-ttu-id="997ee-203">Нажмите кнопку hello **дополнительные** ссылку на hello желтой строке предупреждения.</span><span class="sxs-lookup"><span data-stu-id="997ee-203">Click hello **More** link on hello yellow warning bar.</span></span>
    
     ![Диалоговое окно "AD DS" на виртуальной машине DNS-сервера](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784625.png)
12. <span data-ttu-id="997ee-205">В hello **действия** столбец hello **все сведения о задаче сервера** диалоговое окно, нажмите кнопку **повысить роль этого контроллера домена server tooa**.</span><span class="sxs-lookup"><span data-stu-id="997ee-205">In hello **Action** column of hello **All Server Task Details** dialog box, click **Promote this server tooa domain controller**.</span></span>
13. <span data-ttu-id="997ee-206">В hello **мастер настройки доменных служб Active Directory**, использовать hello следующие значения:</span><span class="sxs-lookup"><span data-stu-id="997ee-206">In hello **Active Directory Domain Services Configuration Wizard**, use hello following values:</span></span>
    
    | <span data-ttu-id="997ee-207">Страница</span><span class="sxs-lookup"><span data-stu-id="997ee-207">Page</span></span> | <span data-ttu-id="997ee-208">Настройка</span><span class="sxs-lookup"><span data-stu-id="997ee-208">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="997ee-209">Конфигурация развертывания</span><span class="sxs-lookup"><span data-stu-id="997ee-209">Deployment Configuration</span></span> |<span data-ttu-id="997ee-210">**Добавить новый лес** = выбрано</span><span class="sxs-lookup"><span data-stu-id="997ee-210">**Add a new forest** = Selected</span></span><br/><span data-ttu-id="997ee-211">**Имя корневого домена** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="997ee-211">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="997ee-212">Параметры контроллера домена</span><span class="sxs-lookup"><span data-stu-id="997ee-212">Domain Controller Options</span></span> |<span data-ttu-id="997ee-213">**Пароль** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-213">**Password** = Contoso!000</span></span><br/><span data-ttu-id="997ee-214">**Подтверждение пароля** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-214">**Confirm Password** = Contoso!000</span></span> |
14. <span data-ttu-id="997ee-215">Нажмите кнопку **Далее** toogo через hello других страницах мастера hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-215">Click **Next** toogo through hello other pages in hello wizard.</span></span> <span data-ttu-id="997ee-216">На hello **проверка предварительных требований** страницы, убедитесь, что отображаются следующие сообщения hello: **наличие всех необходимых компонентов прошла успешно**.</span><span class="sxs-lookup"><span data-stu-id="997ee-216">On hello **Prerequisites Check** page, verify that you see hello following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="997ee-217">Обратите внимание, что следует просмотреть все применимые предупреждающие сообщения, но это возможно toocontinue с установкой hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-217">Note that you should review all applicable warning messages, but it is possible toocontinue with hello installation.</span></span>
15. <span data-ttu-id="997ee-218">Щелкните **Install**(Установить).</span><span class="sxs-lookup"><span data-stu-id="997ee-218">Click **Install**.</span></span> <span data-ttu-id="997ee-219">Hello **ContosoDC** виртуальной машины будет автоматически перезагружен.</span><span class="sxs-lookup"><span data-stu-id="997ee-219">hello **ContosoDC** virtual machine will automatically reboot.</span></span>

## <a name="configure-domain-accounts"></a><span data-ttu-id="997ee-220">Настройка учетных записей в домене</span><span class="sxs-lookup"><span data-stu-id="997ee-220">Configure domain accounts</span></span>
<span data-ttu-id="997ee-221">Дальнейшие действия Hello настроить учетные записи Active Directory hello для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="997ee-221">hello next steps configure hello Active Directory accounts for later use.</span></span>

1. <span data-ttu-id="997ee-222">Войти снова toohello **ContosoDC** машины.</span><span class="sxs-lookup"><span data-stu-id="997ee-222">Sign back in toohello **ContosoDC** machine.</span></span>
2. <span data-ttu-id="997ee-223">На панели **Диспетчер серверов** выберите **Сервис** > **Центр администрирования Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="997ee-223">In **Server Manager**, click **Tools** > **Active Directory Administrative Center**.</span></span>
   
    ![Центр администрирования Active Directory](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784626.png)
3. <span data-ttu-id="997ee-225">В hello **Центр администрирования Active Directory**выберите **corp (local)** hello левой панели.</span><span class="sxs-lookup"><span data-stu-id="997ee-225">In hello **Active Directory Administrative Center**, select **corp (local)** in hello left pane.</span></span>
4. <span data-ttu-id="997ee-226">На правом hello **задачи** области, нажмите кнопку **New** > **пользователя**.</span><span class="sxs-lookup"><span data-stu-id="997ee-226">On hello right **Tasks** pane, click **New** > **User**.</span></span> <span data-ttu-id="997ee-227">Используйте hello следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="997ee-227">Use hello following settings:</span></span>
   
   | <span data-ttu-id="997ee-228">Настройка</span><span class="sxs-lookup"><span data-stu-id="997ee-228">Setting</span></span> | <span data-ttu-id="997ee-229">Значение</span><span class="sxs-lookup"><span data-stu-id="997ee-229">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="997ee-230">**Имя**</span><span class="sxs-lookup"><span data-stu-id="997ee-230">**First Name**</span></span> |<span data-ttu-id="997ee-231">Install</span><span class="sxs-lookup"><span data-stu-id="997ee-231">Install</span></span> |
   | <span data-ttu-id="997ee-232">**User SamAccountName**</span><span class="sxs-lookup"><span data-stu-id="997ee-232">**User SamAccountName**</span></span> |<span data-ttu-id="997ee-233">Install</span><span class="sxs-lookup"><span data-stu-id="997ee-233">Install</span></span> |
   | <span data-ttu-id="997ee-234">**Пароль**</span><span class="sxs-lookup"><span data-stu-id="997ee-234">**Password**</span></span> |<span data-ttu-id="997ee-235">Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-235">Contoso!000</span></span> |
   | <span data-ttu-id="997ee-236">**Подтверждение пароля.**</span><span class="sxs-lookup"><span data-stu-id="997ee-236">**Confirm password**</span></span> |<span data-ttu-id="997ee-237">Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-237">Contoso!000</span></span> |
   | <span data-ttu-id="997ee-238">**Другие параметры пароля**</span><span class="sxs-lookup"><span data-stu-id="997ee-238">**Other password options**</span></span> |<span data-ttu-id="997ee-239">Выбрано</span><span class="sxs-lookup"><span data-stu-id="997ee-239">Selected</span></span> |
   | <span data-ttu-id="997ee-240">**Срок действия пароля не ограничен**</span><span class="sxs-lookup"><span data-stu-id="997ee-240">**Password never expires**</span></span> |<span data-ttu-id="997ee-241">Флажок установлен</span><span class="sxs-lookup"><span data-stu-id="997ee-241">Checked</span></span> |
5. <span data-ttu-id="997ee-242">Нажмите кнопку **ОК** toocreate hello **установить** пользователя.</span><span class="sxs-lookup"><span data-stu-id="997ee-242">Click **OK** toocreate hello **Install** user.</span></span> <span data-ttu-id="997ee-243">Эта учетная запись будет использоваться tooconfigure hello отказоустойчивого кластера и hello группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-243">This account will be used tooconfigure hello failover cluster and hello availability group.</span></span>
6. <span data-ttu-id="997ee-244">Создайте двух дополнительных пользователей **CORP\SQLSvc1** и **CORP\SQLSvc2**, с hello одну последовательность шагов.</span><span class="sxs-lookup"><span data-stu-id="997ee-244">Create two additional users, **CORP\SQLSvc1** and **CORP\SQLSvc2**, with hello same steps.</span></span> <span data-ttu-id="997ee-245">Эти учетные записи будут использоваться для экземпляров SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-245">These accounts will be used for hello SQL Server instances.</span></span> <span data-ttu-id="997ee-246">Далее необходимо toogive **CORP\Install** hello необходимые разрешения tooconfigure отказоустойчивой кластеризации в Windows.</span><span class="sxs-lookup"><span data-stu-id="997ee-246">Next, you need toogive **CORP\Install** hello necessary permissions tooconfigure Windows failover clustering.</span></span>
7. <span data-ttu-id="997ee-247">В hello **Центр администрирования Active Directory**, нажмите кнопку **corp (local)** hello левой панели.</span><span class="sxs-lookup"><span data-stu-id="997ee-247">In hello **Active Directory Administrative Center**, click **corp (local)** in hello left pane.</span></span> <span data-ttu-id="997ee-248">В hello **задачи** области, нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="997ee-248">In hello **Tasks** pane, click **Properties**.</span></span>
   
    ![Свойства пользователя CORP](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784627.png)
8. <span data-ttu-id="997ee-250">Выберите **расширения**, а затем нажмите кнопку hello **Дополнительно** кнопку на hello **безопасности** вкладку.</span><span class="sxs-lookup"><span data-stu-id="997ee-250">Select **Extensions**, and then click hello **Advanced** button on hello **Security** tab.</span></span>
9. <span data-ttu-id="997ee-251">В hello **Дополнительные параметры безопасности для corp** диалоговое окно, нажмите кнопку **добавить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-251">In hello **Advanced Security Settings for corp** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="997ee-252">Щелкните **Выберите субъект**, найдите **CORP\Install** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-252">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
11. <span data-ttu-id="997ee-253">Выберите hello **чтение всех свойств** и **создание объектов-компьютеров** разрешения.</span><span class="sxs-lookup"><span data-stu-id="997ee-253">Select hello **Read all properties** and **Create Computer objects** permissions.</span></span>
    
     ![Разрешения пользователя CORP](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784628.png)
12. <span data-ttu-id="997ee-255">Нажмите кнопку **ОК**, а затем снова кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-255">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="997ee-256">Окно свойств corp закрыть hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-256">Close hello corp properties window.</span></span>

<span data-ttu-id="997ee-257">Теперь, когда вы настроили Active Directory и объектов пользователей hello, вы создадите три виртуальные машины SQL Server и присоединять их toothis домена.</span><span class="sxs-lookup"><span data-stu-id="997ee-257">Now that you configured Active Directory and hello user objects, you will create three SQL Server virtual machines and join them toothis domain.</span></span>

## <a name="create-hello-sql-server-virtual-machines"></a><span data-ttu-id="997ee-258">Создание виртуальных машин SQL Server hello</span><span class="sxs-lookup"><span data-stu-id="997ee-258">Create hello SQL Server virtual machines</span></span>
<span data-ttu-id="997ee-259">Создайте три виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="997ee-259">Create three virtual machines.</span></span> <span data-ttu-id="997ee-260">Одна из них предназначена для узла кластера, а другие две — для SQL Server.</span><span class="sxs-lookup"><span data-stu-id="997ee-260">One is for a cluster node and two are for SQL Server.</span></span> <span data-ttu-id="997ee-261">toocreate каждого hello виртуальных машин, перейти обратно toohello классический портал Azure, щелкните **New** > **вычислений** > **виртуальной машины**  >  **Из коллекции**.</span><span class="sxs-lookup"><span data-stu-id="997ee-261">toocreate each of hello virtual machines, go back toohello Azure classic portal, click **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span> <span data-ttu-id="997ee-262">Затем с помощью шаблонов hello в следующие таблицы toohelp при создании виртуальных машин hello hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-262">Then, use hello templates in hello following table toohelp you create hello virtual machines.</span></span>

| <span data-ttu-id="997ee-263">Страница</span><span class="sxs-lookup"><span data-stu-id="997ee-263">Page</span></span> | <span data-ttu-id="997ee-264">VM1</span><span class="sxs-lookup"><span data-stu-id="997ee-264">VM1</span></span> | <span data-ttu-id="997ee-265">VM2</span><span class="sxs-lookup"><span data-stu-id="997ee-265">VM2</span></span> | <span data-ttu-id="997ee-266">VM3</span><span class="sxs-lookup"><span data-stu-id="997ee-266">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="997ee-267">Выберите операционную систему виртуальной машины hello</span><span class="sxs-lookup"><span data-stu-id="997ee-267">Select hello virtual machine operating system</span></span> |<span data-ttu-id="997ee-268">**Центр обработки данных Windows Server 2012 R2**</span><span class="sxs-lookup"><span data-stu-id="997ee-268">**Windows Server 2012 R2 Datacenter**</span></span> |<span data-ttu-id="997ee-269">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="997ee-269">**SQL Server 2014 RTM Enterprise**</span></span> |<span data-ttu-id="997ee-270">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="997ee-270">**SQL Server 2014 RTM Enterprise**</span></span> |
| <span data-ttu-id="997ee-271">Конфигурация виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-271">Virtual machine configuration</span></span> |<span data-ttu-id="997ee-272">**Дата выпуска версии** — (последняя)</span><span class="sxs-lookup"><span data-stu-id="997ee-272">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="997ee-273">**Имя виртуальной машины** — ContosoWSFCNode</span><span class="sxs-lookup"><span data-stu-id="997ee-273">**VIRTUAL MACHINE NAME** = ContosoWSFCNode</span></span><br/><span data-ttu-id="997ee-274">**Уровень** — Стандартный</span><span class="sxs-lookup"><span data-stu-id="997ee-274">**TIER** = STANDARD</span></span><br/><span data-ttu-id="997ee-275">**Размер** — A2 (2 ядра)</span><span class="sxs-lookup"><span data-stu-id="997ee-275">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="997ee-276">**Новое имя пользователя** — AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="997ee-276">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="997ee-277">**Новый пароль** — Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-277">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="997ee-278">**ПОДТВЕРЖДЕНИЕ** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-278">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="997ee-279">**Дата выпуска версии** — (последняя)</span><span class="sxs-lookup"><span data-stu-id="997ee-279">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="997ee-280">**Имя виртуальной машины** — ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="997ee-280">**VIRTUAL MACHINE NAME** = ContosoSQL1</span></span><br/><span data-ttu-id="997ee-281">**Уровень** — Стандартный</span><span class="sxs-lookup"><span data-stu-id="997ee-281">**TIER** = STANDARD</span></span><br/><span data-ttu-id="997ee-282">**Размер** — A3 (4 ядра)</span><span class="sxs-lookup"><span data-stu-id="997ee-282">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="997ee-283">**Новое имя пользователя** — AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="997ee-283">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="997ee-284">**Новый пароль** — Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-284">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="997ee-285">**ПОДТВЕРЖДЕНИЕ** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-285">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="997ee-286">**Дата выпуска версии** — (последняя)</span><span class="sxs-lookup"><span data-stu-id="997ee-286">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="997ee-287">**Имя виртуальной машины** — ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="997ee-287">**VIRTUAL MACHINE NAME** = ContosoSQL2</span></span><br/><span data-ttu-id="997ee-288">**Уровень** — Стандартный</span><span class="sxs-lookup"><span data-stu-id="997ee-288">**TIER** = STANDARD</span></span><br/><span data-ttu-id="997ee-289">**Размер** — A3 (4 ядра)</span><span class="sxs-lookup"><span data-stu-id="997ee-289">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="997ee-290">**Новое имя пользователя** — AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="997ee-290">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="997ee-291">**Новый пароль** — Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-291">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="997ee-292">**ПОДТВЕРЖДЕНИЕ** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="997ee-292">**CONFIRM** = Contoso!000</span></span> |
| <span data-ttu-id="997ee-293">Конфигурация виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-293">Virtual machine configuration</span></span> |<span data-ttu-id="997ee-294">**Облачная служба** — уникальное DNS-имя ранее созданной облачной службы (например, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="997ee-294">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="997ee-295">**Регион, территориальная группа, виртуальная сеть** — ContosoNET</span><span class="sxs-lookup"><span data-stu-id="997ee-295">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="997ee-296">**Подсети виртуальной сети** — Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="997ee-296">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="997ee-297">**УЧЕТНАЯ ЗАПИСЬ ХРАНЕНИЯ** = используйте автоматически созданную учетную запись хранения</span><span class="sxs-lookup"><span data-stu-id="997ee-297">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="997ee-298">**Группа доступности** — создайте группу доступности</span><span class="sxs-lookup"><span data-stu-id="997ee-298">**AVAILABILITY SET** = Create an availability set</span></span><br/><span data-ttu-id="997ee-299">**ИМЯ ГРУППЫ ДОСТУПНОСТИ** = SQLHADR</span><span class="sxs-lookup"><span data-stu-id="997ee-299">**AVAILABILITY SET NAME** = SQLHADR</span></span> |<span data-ttu-id="997ee-300">**Облачная служба** — уникальное DNS-имя ранее созданной облачной службы (например, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="997ee-300">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="997ee-301">**Регион, территориальная группа, виртуальная сеть** — ContosoNET</span><span class="sxs-lookup"><span data-stu-id="997ee-301">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="997ee-302">**Подсети виртуальной сети** — Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="997ee-302">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="997ee-303">**УЧЕТНАЯ ЗАПИСЬ ХРАНЕНИЯ** = используйте автоматически созданную учетную запись хранения</span><span class="sxs-lookup"><span data-stu-id="997ee-303">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="997ee-304">**ГРУППА ДОСТУПНОСТИ** = SQLHADR (вы можете также настроить hello доступности после создания машины hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-304">**AVAILABILITY SET** = SQLHADR (You can also configure hello availability set after hello machine has been created.</span></span> <span data-ttu-id="997ee-305">Все три машины следует назначить доступности sqlhadr toohello.)</span><span class="sxs-lookup"><span data-stu-id="997ee-305">All three machines should be assigned toohello SQLHADR availability set.)</span></span> |<span data-ttu-id="997ee-306">**Облачная служба** — уникальное DNS-имя ранее созданной облачной службы (например, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="997ee-306">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="997ee-307">**Регион, территориальная группа, виртуальная сеть** — ContosoNET</span><span class="sxs-lookup"><span data-stu-id="997ee-307">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="997ee-308">**Подсети виртуальной сети** — Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="997ee-308">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="997ee-309">**УЧЕТНАЯ ЗАПИСЬ ХРАНЕНИЯ** = используйте автоматически созданную учетную запись хранения</span><span class="sxs-lookup"><span data-stu-id="997ee-309">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="997ee-310">**ГРУППА ДОСТУПНОСТИ** = SQLHADR (вы можете также настроить hello доступности после создания машины hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-310">**AVAILABILITY SET** = SQLHADR (You can also configure hello availability set after hello machine has been created.</span></span> <span data-ttu-id="997ee-311">Все три машины следует назначить доступности sqlhadr toohello.)</span><span class="sxs-lookup"><span data-stu-id="997ee-311">All three machines should be assigned toohello SQLHADR availability set.)</span></span> |
| <span data-ttu-id="997ee-312">Параметры виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-312">Virtual machine options</span></span> |<span data-ttu-id="997ee-313">По умолчанию</span><span class="sxs-lookup"><span data-stu-id="997ee-313">Use defaults</span></span> |<span data-ttu-id="997ee-314">По умолчанию</span><span class="sxs-lookup"><span data-stu-id="997ee-314">Use defaults</span></span> |<span data-ttu-id="997ee-315">По умолчанию</span><span class="sxs-lookup"><span data-stu-id="997ee-315">Use defaults</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="997ee-316">Hello предыдущей конфигурации предлагает стандартный уровень виртуальных машин, так как БАЗОВЫЙ уровень машины не поддерживают конечных точек с балансировкой нагрузки.</span><span class="sxs-lookup"><span data-stu-id="997ee-316">hello previous configuration suggests STANDARD tier virtual machines, because BASIC tier machines do not support load-balanced endpoints.</span></span> <span data-ttu-id="997ee-317">Требуется конечных точек с балансировкой нагрузки более поздней версии toocreate прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-317">You need load-balanced endpoints later toocreate an availability group listener.</span></span> <span data-ttu-id="997ee-318">Кроме того размеры hello машины, которые предлагаются здесь предназначены для тестирования на виртуальных машинах Azure для группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-318">Also, hello machine sizes that are suggested here are meant for testing availability groups in Azure Virtual Machines.</span></span> <span data-ttu-id="997ee-319">Для наилучшей производительности hello на рабочие нагрузки, увидеть рекомендации hello размеров машины SQL Server и конфигурации в [рекомендации по производительности для SQL Server в виртуальных машинах Azure](../sql/virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-319">For hello best performance on production workloads, see hello recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure Virtual Machines](../sql/virtual-machines-windows-sql-performance.md).</span></span>
> 
> 

<span data-ttu-id="997ee-320">После полного выделения hello трех виртуальных машин необходимо toojoin их toohello **corp.contoso.com** домена и предоставьте машины toohello CORP\Install права администратора.</span><span class="sxs-lookup"><span data-stu-id="997ee-320">After hello three virtual machines are fully provisioned, you need toojoin them toohello **corp.contoso.com** domain and grant CORP\Install administrative rights toohello machines.</span></span> <span data-ttu-id="997ee-321">toodo, hello используйте следующие шаги для каждой из трех hello виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="997ee-321">toodo this, use hello following steps for each of hello three virtual machines.</span></span>

1. <span data-ttu-id="997ee-322">Во-первых измените hello предпочитаемый адрес DNS-сервера.</span><span class="sxs-lookup"><span data-stu-id="997ee-322">First, change hello preferred DNS server address.</span></span> <span data-ttu-id="997ee-323">Загрузите локальный каталог файла протокола удаленного рабочего СТОЛА tooyour каждой виртуальной машины, выбрав в списке hello hello виртуальную машину и щелкнув hello **Connect** кнопки.</span><span class="sxs-lookup"><span data-stu-id="997ee-323">Download each virtual machine's RDP file tooyour local directory by selecting hello virtual machine in hello list and clicking hello **Connect** button.</span></span> <span data-ttu-id="997ee-324">tooselect виртуальной машины, щелкните в любом но hello первую ячейку в строке приветствия, как показано на следующий снимок экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-324">tooselect a virtual machine, click anywhere but hello first cell in hello row, as shown in hello following screenshot.</span></span>
   
    ![Загрузить RDP-файл hello](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664953.jpg)
2. <span data-ttu-id="997ee-326">Файл, который был загружен Привет открыть RDP и выполните вход toohello виртуальной машины с помощью учетной записи администратора (**BUILTIN\AzureAdmin**) и пароль (**Contoso! 000**).</span><span class="sxs-lookup"><span data-stu-id="997ee-326">Open hello RDP file that you downloaded, and sign in toohello virtual machine by using your configured administrator account (**BUILTIN\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="997ee-327">После входа вы увидите hello **диспетчера сервера** панели мониторинга.</span><span class="sxs-lookup"><span data-stu-id="997ee-327">After you sign in, you should see hello **Server Manager** dashboard.</span></span> <span data-ttu-id="997ee-328">Нажмите кнопку **локального сервера** hello левой панели.</span><span class="sxs-lookup"><span data-stu-id="997ee-328">Click **Local Server** in hello left pane.</span></span>
4. <span data-ttu-id="997ee-329">Нажмите кнопку hello **IPv4-адрес, назначенный DHCP, IPv6 включены** ссылку.</span><span class="sxs-lookup"><span data-stu-id="997ee-329">Click hello **IPv4 address assigned by DHCP, IPv6 enabled** link.</span></span>
5. <span data-ttu-id="997ee-330">В hello **сетевых подключений** диалогового окна выберите значок сети hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-330">In hello **Network Connections** dialog box, click hello network icon.</span></span>
   
    ![Изменение hello виртуальной машины предпочитаемый DNS-сервер](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784629.png)
6. <span data-ttu-id="997ee-332">На панели команд hello, нажмите кнопку **изменить параметры этого подключения hello**.</span><span class="sxs-lookup"><span data-stu-id="997ee-332">On hello command bar, click **Change hello settings of this connection**.</span></span> <span data-ttu-id="997ee-333">(В зависимости от размера окна hello, может потребоваться tooclick hello двойную стрелку справа toosee этой команды).</span><span class="sxs-lookup"><span data-stu-id="997ee-333">(Depending on hello size of your window, you might have tooclick hello double right arrow toosee this command).</span></span>
7. <span data-ttu-id="997ee-334">Выберите пункт **Протокол Интернета версии 4 (TCP/IPv4)** и нажмите кнопку **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="997ee-334">Select **Internet Protocol Version 4 (TCP/IPv4)**, and then click **Properties**.</span></span>
8. <span data-ttu-id="997ee-335">Выберите **hello использовать следующие адреса DNS-серверов** и укажите **10.10.2.4** в **предпочитаемый DNS-сервер**.</span><span class="sxs-lookup"><span data-stu-id="997ee-335">Select **Use hello following DNS server addresses** and then specify **10.10.2.4** in **Preferred DNS server**.</span></span>
9. <span data-ttu-id="997ee-336">Hello **10.10.2.4** адрес является hello, назначенный tooa виртуальная машина в подсети 10.10.2.0/24 hello в виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="997ee-336">hello **10.10.2.4** address is hello address that's assigned tooa virtual machine in hello 10.10.2.0/24 subnet in an Azure virtual network.</span></span> <span data-ttu-id="997ee-337">Речь идет о виртуальной машине **ContosoDC**.</span><span class="sxs-lookup"><span data-stu-id="997ee-337">That virtual machine is **ContosoDC**.</span></span> <span data-ttu-id="997ee-338">tooverify **ContosoDC**его IP-адрес, используйте **nslookup contosodc** в окне командной строки hello, как показано на следующий снимок экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-338">tooverify **ContosoDC**'s IP address, use **nslookup contosodc** in hello command prompt window, as shown in hello following screenshot.</span></span>
   
    ![Использование команды NSLOOKUP toofind IP-адреса для контроллера домена](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664954.jpg)
10. <span data-ttu-id="997ee-340">Нажмите кнопку **ОК** > **закрыть** toocommit hello изменения.</span><span class="sxs-lookup"><span data-stu-id="997ee-340">Click **OK** > **Close** toocommit hello changes.</span></span> <span data-ttu-id="997ee-341">Теперь можно присоединить hello виртуальную машину слишком**corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="997ee-341">You can now join hello virtual machine too**corp.contoso.com**.</span></span>
11. <span data-ttu-id="997ee-342">Обратно в hello **локального сервера** окно, нажмите кнопку hello **рабочей группы** ссылку.</span><span class="sxs-lookup"><span data-stu-id="997ee-342">Back in hello **Local Server** window, click hello **WORKGROUP** link.</span></span>
12. <span data-ttu-id="997ee-343">В hello **имя компьютера** щелкните **изменений**.</span><span class="sxs-lookup"><span data-stu-id="997ee-343">In hello **Computer Name** section, click **Change**.</span></span>
13. <span data-ttu-id="997ee-344">Выберите hello **домена** флажок, введите **corp.contoso.com** в hello текстовое поле и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-344">Select hello **Domain** check box, type **corp.contoso.com** in hello text box, and then click **OK**.</span></span>
14. <span data-ttu-id="997ee-345">В hello **безопасности Windows** диалоговом окне укажите hello учетные данные для учетной записи администратора домена по умолчанию hello (**CORP\AzureAdmin**) и пароль hello (**Contoso! 000**).</span><span class="sxs-lookup"><span data-stu-id="997ee-345">In hello **Windows Security** dialog box, specify hello credentials for hello default domain administrator account (**CORP\AzureAdmin**) and hello password (**Contoso!000**).</span></span>
15. <span data-ttu-id="997ee-346">После появления сообщения «toohello приветствия домена corp.contoso.com» hello, нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-346">When you see hello "Welcome toohello corp.contoso.com domain" message, click **OK**.</span></span>
16. <span data-ttu-id="997ee-347">Нажмите кнопку **закрыть** > **Перезагрузить сейчас** в диалоговое окно «hello».</span><span class="sxs-lookup"><span data-stu-id="997ee-347">Click **Close** > **Restart Now** in hello dialog box.</span></span>

### <a name="add-hello-corpinstall-user-as-an-administrator-on-each-virtual-machine"></a><span data-ttu-id="997ee-348">Добавить hello Corp\Install пользователя с правами администратора на каждой виртуальной машине</span><span class="sxs-lookup"><span data-stu-id="997ee-348">Add hello Corp\Install user as an administrator on each virtual machine</span></span>
1. <span data-ttu-id="997ee-349">Подождите, пока hello виртуальная машина перезапускается и откройте hello RDP файлов снова toosign toohello виртуальной машине с использованием hello **BUILTIN\AzureAdmin** учетной записи.</span><span class="sxs-lookup"><span data-stu-id="997ee-349">Wait until hello virtual machine restarts, and then open hello RDP file again toosign in toohello virtual machine by using hello **BUILTIN\AzureAdmin** account.</span></span>
2. <span data-ttu-id="997ee-350">В области **Диспетчер серверов** выберите **Сервис** > **Управление компьютером**.</span><span class="sxs-lookup"><span data-stu-id="997ee-350">In **Server Manager** click **Tools** > **Computer Management**.</span></span>
   
    ![Управление компьютерами](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784630.png)
3. <span data-ttu-id="997ee-352">В hello **Управление компьютером** диалогового окна разверните **локальные пользователи и группы**, а затем нажмите кнопку **группы**.</span><span class="sxs-lookup"><span data-stu-id="997ee-352">In hello **Computer Management** dialog box, expand **Local Users and Groups**, and then click **Groups**.</span></span>
4. <span data-ttu-id="997ee-353">Дважды щелкните hello **Администраторы** группы.</span><span class="sxs-lookup"><span data-stu-id="997ee-353">Double-click hello **Administrators** group.</span></span>
5. <span data-ttu-id="997ee-354">В hello **свойства администратора** диалоговое окно, нажмите кнопку hello **добавить** кнопки.</span><span class="sxs-lookup"><span data-stu-id="997ee-354">In hello **Administrators Properties** dialog box, click hello **Add** button.</span></span>
6. <span data-ttu-id="997ee-355">Введите пользователя hello **CORP\Install**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-355">Enter hello user **CORP\Install**, and then click **OK**.</span></span> <span data-ttu-id="997ee-356">При запросе учетных данных следует использовать hello **AzureAdmin** учетную запись с hello **Contoso! 000** пароль.</span><span class="sxs-lookup"><span data-stu-id="997ee-356">When prompted for credentials, use hello **AzureAdmin** account with hello **Contoso!000** password.</span></span>
7. <span data-ttu-id="997ee-357">Нажмите кнопку **ОК** tooclose hello **свойства администратора** диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="997ee-357">Click **OK** tooclose hello **Administrator Properties** dialog box.</span></span>

### <a name="add-hello-failover-clustering-feature-tooeach-virtual-machine"></a><span data-ttu-id="997ee-358">Добавление tooeach отказоустойчивой кластеризации функции hello виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-358">Add hello Failover Clustering feature tooeach virtual machine</span></span>
1. <span data-ttu-id="997ee-359">В hello **диспетчера сервера** панели мониторинга, щелкните **Добавить роли и компоненты**.</span><span class="sxs-lookup"><span data-stu-id="997ee-359">In hello **Server Manager** dashboard, click **Add roles and features**.</span></span>
2. <span data-ttu-id="997ee-360">В hello **мастера добавления ролей и компонентов**, нажмите кнопку **Далее** до получения toohello **функции** страницы.</span><span class="sxs-lookup"><span data-stu-id="997ee-360">In hello **Add Roles and Features Wizard**, click **Next** until you get toohello **Features** page.</span></span>
3. <span data-ttu-id="997ee-361">Выберите **Отказоустойчивость кластеров**.</span><span class="sxs-lookup"><span data-stu-id="997ee-361">Select **Failover Clustering**.</span></span> <span data-ttu-id="997ee-362">При появлении запроса добавьте остальные зависимые компоненты.</span><span class="sxs-lookup"><span data-stu-id="997ee-362">When prompted, add other dependent features.</span></span>
   
    ![Добавить машину toovirtual отказоустойчивости кластеров](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784631.png)
4. <span data-ttu-id="997ee-364">Нажмите кнопку **Далее**, а затем нажмите кнопку **установить** на hello **Подтверждение** страницы.</span><span class="sxs-lookup"><span data-stu-id="997ee-364">Click **Next**, and then click **Install** on hello **Confirmation** page.</span></span>
5. <span data-ttu-id="997ee-365">Здравствуйте, когда **отказоустойчивой кластеризации** выполнена установка компонентов, нажмите кнопку **закрыть**.</span><span class="sxs-lookup"><span data-stu-id="997ee-365">When hello **Failover Clustering** feature installation is finished, click **Close**.</span></span>
6. <span data-ttu-id="997ee-366">Выйдите из виртуальной машины hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-366">Sign out of hello virtual machine.</span></span>
7. <span data-ttu-id="997ee-367">Повторите шаги с hello в этом разделе для всех трех серверов: **ContosoWSFCNode**, **ContosoSQL1**, и **ContosoSQL2**.</span><span class="sxs-lookup"><span data-stu-id="997ee-367">Repeat hello steps in this section for all three servers: **ContosoWSFCNode**, **ContosoSQL1**, and **ContosoSQL2**.</span></span>

<span data-ttu-id="997ee-368">Здравствуйте, SQL Server, виртуальные машины настроены и запущены, но каждый из них имеет параметры по умолчанию hello для SQL Server.</span><span class="sxs-lookup"><span data-stu-id="997ee-368">hello SQL Server virtual machines are now provisioned and running, but each has hello default options for SQL Server.</span></span>

## <a name="create-hello-failover-cluster"></a><span data-ttu-id="997ee-369">Создание отказоустойчивого кластера hello</span><span class="sxs-lookup"><span data-stu-id="997ee-369">Create hello failover cluster</span></span>
<span data-ttu-id="997ee-370">В этом разделе создайте hello отказоустойчивого кластера, где будет размещаться hello группы доступности, которая будет создана в более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="997ee-370">In this section, you create hello failover cluster that will host hello availability group that you will create later.</span></span> <span data-ttu-id="997ee-371">К этому моменту необходимо выполнить следующие tooeach hello трех виртуальных машин, которые будут использоваться в отказоустойчивом кластере hello hello:</span><span class="sxs-lookup"><span data-stu-id="997ee-371">By now, you should have done hello following tooeach of hello three virtual machines that you will use in hello failover cluster:</span></span>

* <span data-ttu-id="997ee-372">Полностью подготовленные hello виртуальную машину в Azure</span><span class="sxs-lookup"><span data-stu-id="997ee-372">Fully provisioned hello virtual machine in Azure</span></span>
* <span data-ttu-id="997ee-373">Присоединен к домену toohello hello виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="997ee-373">Joined hello virtual machine toohello domain</span></span>
* <span data-ttu-id="997ee-374">Добавлен **CORP\Install** toohello локальной группы администраторов</span><span class="sxs-lookup"><span data-stu-id="997ee-374">Added **CORP\Install** toohello local Administrators group</span></span>
* <span data-ttu-id="997ee-375">Добавлены hello отказоустойчивости кластеров</span><span class="sxs-lookup"><span data-stu-id="997ee-375">Added hello failover clustering feature</span></span>

<span data-ttu-id="997ee-376">Все это предварительные условия для каждой виртуальной машины, прежде чем присоединить его toohello отказоустойчивого кластера.</span><span class="sxs-lookup"><span data-stu-id="997ee-376">All these are prerequisites on each virtual machine before you can join it toohello failover cluster.</span></span>

<span data-ttu-id="997ee-377">Кроме того, обратите внимание, что hello виртуальная сеть Azure работает не так hello таким же, как и в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="997ee-377">Also, note that hello Azure virtual network does not behave in hello same way as an on-premises network.</span></span> <span data-ttu-id="997ee-378">Требуется toocreate кластера hello в hello следующий порядок:</span><span class="sxs-lookup"><span data-stu-id="997ee-378">You need toocreate hello cluster in hello following order:</span></span>

1. <span data-ttu-id="997ee-379">Создайте кластер с одним узлом на одном из узлов (**ContosoSQL1**).</span><span class="sxs-lookup"><span data-stu-id="997ee-379">Create a single-node cluster on one node (**ContosoSQL1**).</span></span>
2. <span data-ttu-id="997ee-380">Изменить IP адрес hello кластера tooan неиспользуемый IP-адрес (**10.10.2.101**).</span><span class="sxs-lookup"><span data-stu-id="997ee-380">Modify hello cluster IP address tooan unused IP address (**10.10.2.101**).</span></span>
3. <span data-ttu-id="997ee-381">Перевести hello имя кластера в оперативный режим.</span><span class="sxs-lookup"><span data-stu-id="997ee-381">Bring hello cluster name online.</span></span>
4. <span data-ttu-id="997ee-382">Добавить другие узлы hello (**ContosoSQL2** и **ContosoWSFCNode**).</span><span class="sxs-lookup"><span data-stu-id="997ee-382">Add hello other nodes (**ContosoSQL2** and **ContosoWSFCNode**).</span></span>

<span data-ttu-id="997ee-383">Используйте следующие шаги toocomplete hello задачи, которые полностью настроить кластер hello hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-383">Use hello following steps toocomplete hello tasks that fully configure hello cluster.</span></span>

1. <span data-ttu-id="997ee-384">Привет открыть RDP-файл для **ContosoSQL1**и вход с помощью учетной записи домена hello **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="997ee-384">Open hello RDP file for **ContosoSQL1**, and sign in by using hello domain account **CORP\Install**.</span></span>
2. <span data-ttu-id="997ee-385">В hello **диспетчера сервера** панели мониторинга, щелкните **средства** > **Диспетчер отказоустойчивости кластеров**.</span><span class="sxs-lookup"><span data-stu-id="997ee-385">In hello **Server Manager** dashboard, click **Tools** > **Failover Cluster Manager**.</span></span>
3. <span data-ttu-id="997ee-386">Hello левой панели щелкните правой кнопкой мыши **Диспетчер отказоустойчивости кластеров**, а затем нажмите кнопку **создать кластер**, как показано в следующих экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-386">In hello left pane, right-click **Failover Cluster Manager**, and then click **Create a Cluster**, as shown in hello following screenshot.</span></span>
   
    ![Создание кластера](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784632.png)
4. <span data-ttu-id="997ee-388">В Здравствуйте, мастер создания кластера, создать кластер с одним узлом, настроив страницах hello и с использованием параметров hello в следующей таблице hello:</span><span class="sxs-lookup"><span data-stu-id="997ee-388">In hello Create Cluster Wizard, create a one-node cluster by stepping through hello pages and using hello settings in hello following table:</span></span>
   
   | <span data-ttu-id="997ee-389">Страница</span><span class="sxs-lookup"><span data-stu-id="997ee-389">Page</span></span> | <span data-ttu-id="997ee-390">Параметры</span><span class="sxs-lookup"><span data-stu-id="997ee-390">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="997ee-391">Перед началом работы</span><span class="sxs-lookup"><span data-stu-id="997ee-391">Before You Begin</span></span> |<span data-ttu-id="997ee-392">По умолчанию</span><span class="sxs-lookup"><span data-stu-id="997ee-392">Use defaults</span></span> |
   | <span data-ttu-id="997ee-393">Выбор серверов</span><span class="sxs-lookup"><span data-stu-id="997ee-393">Select Servers</span></span> |<span data-ttu-id="997ee-394">Введите **ContosoSQL1** в поле **Введите имя сервера** и щелкните **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-394">Type **ContosoSQL1** in **Enter server name** and click **Add**</span></span> |
   | <span data-ttu-id="997ee-395">Предупреждение проверки</span><span class="sxs-lookup"><span data-stu-id="997ee-395">Validation Warning</span></span> |<span data-ttu-id="997ee-396">Выберите **проверяет, но мне не требуется поддержка Майкрософт для этого кластера, а не требуется проверка toorun hello. После нажатия кнопки Далее продолжить создание кластера hello**.</span><span class="sxs-lookup"><span data-stu-id="997ee-396">Select **No. I do not require support from Microsoft for this cluster, and therefore do not want toorun hello validation tests. When I click Next, continue creating hello cluster**.</span></span> |
   | <span data-ttu-id="997ee-397">Точка доступа для hello администрирование кластера</span><span class="sxs-lookup"><span data-stu-id="997ee-397">Access Point for Administering hello Cluster</span></span> |<span data-ttu-id="997ee-398">Введите **Cluster1** в поле **Имя кластера**</span><span class="sxs-lookup"><span data-stu-id="997ee-398">Type **Cluster1** in **Cluster Name**</span></span> |
   | <span data-ttu-id="997ee-399">Подтверждение</span><span class="sxs-lookup"><span data-stu-id="997ee-399">Confirmation</span></span> |<span data-ttu-id="997ee-400">Используйте параметры по умолчанию, если вы не используете дисковые пространства.</span><span class="sxs-lookup"><span data-stu-id="997ee-400">Use defaults unless you are using Storage Spaces.</span></span> <span data-ttu-id="997ee-401">В разделе hello предупреждение после этой таблицы.</span><span class="sxs-lookup"><span data-stu-id="997ee-401">See hello warning following this table.</span></span> |
   
   > [!WARNING]
   > <span data-ttu-id="997ee-402">При использовании [дисковых пространств](https://technet.microsoft.com/library/hh831739), которые группируют несколько дисков в пулы носителей, необходимо очистить hello **Добавление всех допустимых хранилищ toohello кластера** флажок на hello **Подтверждение** страницы.</span><span class="sxs-lookup"><span data-stu-id="997ee-402">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear hello **Add all eligible storage toohello cluster** check box on hello **Confirmation** page.</span></span> <span data-ttu-id="997ee-403">Если вы не снят, hello виртуальные диски будут отсоединены во время процесса кластеризации hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-403">If you do not clear this option, hello virtual disks will be detached during hello clustering process.</span></span> <span data-ttu-id="997ee-404">В результате они также не отображаются в диспетчере дисков или проводнике пока удаляются из кластера hello hello дисковых пространств и повторно присоединить, с помощью PowerShell.</span><span class="sxs-lookup"><span data-stu-id="997ee-404">As a result, they will also not appear in Disk Manager or Explorer until hello storage spaces are removed from hello cluster and reattached by using PowerShell.</span></span>
   > 
   > 
5. <span data-ttu-id="997ee-405">Hello левой панели разверните **Диспетчер отказоустойчивости кластеров**, а затем нажмите кнопку **Cluster1.corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="997ee-405">In hello left pane, expand **Failover Cluster Manager**, and then click **Cluster1.corp.contoso.com**.</span></span>
6. <span data-ttu-id="997ee-406">В центральной области hello, прокрутите вниз toohello **основные ресурсы кластера** статьи, а затем разверните hello **имя: Clutser1** сведения.</span><span class="sxs-lookup"><span data-stu-id="997ee-406">In hello center pane, scroll down toohello **Cluster Core Resources** section, and expand hello **Name: Clutser1** details.</span></span> <span data-ttu-id="997ee-407">Вы увидите обоих hello **имя** и hello **IP-адрес** ресурсы hello **сбой** состояния.</span><span class="sxs-lookup"><span data-stu-id="997ee-407">You should see both hello **Name** and hello **IP Address** resources in hello **Failed** state.</span></span> <span data-ttu-id="997ee-408">Hello ресурс IP-адреса не удается подключить из-за hello кластеру назначен hello IP-адресом hello машине, который является повторяющийся адрес.</span><span class="sxs-lookup"><span data-stu-id="997ee-408">hello IP address resource cannot be brought online because hello cluster is assigned hello same IP address as hello machine itself, which is a duplicate address.</span></span>
7. <span data-ttu-id="997ee-409">Щелкните правой кнопкой мыши hello сбой **IP-адрес** ресурсов, а затем щелкните **свойства**.</span><span class="sxs-lookup"><span data-stu-id="997ee-409">Right-click hello failed **IP Address** resource, and then click **Properties**.</span></span>
   
    ![Свойства кластера](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784633.png)
8. <span data-ttu-id="997ee-411">Выберите **статический IP-адрес**, укажите **10.10.2.101** в hello **адрес** текстовое поле и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-411">Select **Static IP Address**, specify **10.10.2.101** in hello **Address** text box, and then click **OK**.</span></span>
9. <span data-ttu-id="997ee-412">В hello **основные ресурсы кластера** щелкните правой кнопкой мыши **имя: Cluster1**, а затем нажмите кнопку **перевести в оперативный режим**.</span><span class="sxs-lookup"><span data-stu-id="997ee-412">In hello **Cluster Core Resources** section, right-click **Name: Cluster1**, and then click **Bring Online**.</span></span> <span data-ttu-id="997ee-413">Подождите, пока оба ресурса будут подключены.</span><span class="sxs-lookup"><span data-stu-id="997ee-413">Wait until both resources are online.</span></span> <span data-ttu-id="997ee-414">Когда ресурс имени кластера hello станет доступной, сервер DC hello обновляется новой учетной записи компьютера Active Directory.</span><span class="sxs-lookup"><span data-stu-id="997ee-414">When hello cluster name resource comes online, hello DC server is updated with a new Active Directory computer account.</span></span> <span data-ttu-id="997ee-415">Эта учетная запись Active Directory будет использоваться toorun hello доступности группы кластеризованную службу позже.</span><span class="sxs-lookup"><span data-stu-id="997ee-415">This Active Directory account will be used toorun hello availability group clustered service later.</span></span>
10. <span data-ttu-id="997ee-416">Добавьте оставшихся узлах кластера toohello hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-416">Add hello remaining nodes toohello cluster.</span></span> <span data-ttu-id="997ee-417">Дерево обозревателя hello, щелкните правой кнопкой мыши **Cluster1.corp.contoso.com**, а затем нажмите кнопку **добавления узла**, как показано в следующих экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-417">In hello browser tree, right-click **Cluster1.corp.contoso.com**, and then click **Add Node**, as shown in hello following screenshot.</span></span>
    
     ![Добавление узла кластера toohello](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784634.png)
11. <span data-ttu-id="997ee-419">В hello **мастер добавления узла**, нажмите кнопку **Далее** на hello **Выбор серверов** добавьте **ContosoSQL2** и **ContosoWSFCNode**  toohello список, введя имя сервера hello в **введите имя сервера** и выбрав **добавить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-419">In hello **Add Node Wizard**, click **Next** on hello **Select Servers** page, add **ContosoSQL2** and **ContosoWSFCNode** toohello list by typing hello server name in **Enter server name** and then clicking **Add**.</span></span> <span data-ttu-id="997ee-420">Когда будете готовы, нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-420">When you are done, click **Next**.</span></span>
12. <span data-ttu-id="997ee-421">На hello **предупреждение проверки** щелкните **нет**, несмотря на то, что в рабочих сценариях необходимо выполнить проверочные тесты hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-421">On hello **Validation Warning** page, click **No**, although in a production scenario, you should perform hello validation tests.</span></span> <span data-ttu-id="997ee-422">Затем щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-422">Then, click **Next**.</span></span>
13. <span data-ttu-id="997ee-423">На hello **Подтверждение** щелкните **Далее** tooadd hello узлов.</span><span class="sxs-lookup"><span data-stu-id="997ee-423">On hello **Confirmation** page, click **Next** tooadd hello nodes.</span></span>
    
    > [!WARNING]
    > <span data-ttu-id="997ee-424">Если вы используете [дисковых пространств](https://technet.microsoft.com/library/hh831739), которые группируют несколько дисков в пулы носителей, необходимо очистить hello **Добавление всех допустимых хранилищ toohello кластера** флажок.</span><span class="sxs-lookup"><span data-stu-id="997ee-424">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear hello **Add all eligible storage toohello cluster** check box.</span></span> <span data-ttu-id="997ee-425">Если вы не снят, hello виртуальные диски будут отсоединены во время процесса кластеризации hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-425">If you do not clear this option, hello virtual disks will be detached during hello clustering process.</span></span> <span data-ttu-id="997ee-426">В результате они не будут отображаться в диспетчере дисков или проводнике пока hello дисковых пространств, удаляются из кластера и повторно подключены с помощью PowerShell.</span><span class="sxs-lookup"><span data-stu-id="997ee-426">As a result, they will also not appear in Disk Manager or Explorer until hello storage spaces are removed from cluster and reattached using PowerShell.</span></span>
    > 
    > 
14. <span data-ttu-id="997ee-427">После добавления узлов hello toohello кластера, нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="997ee-427">After hello nodes are added toohello cluster, click **Finish**.</span></span> <span data-ttu-id="997ee-428">Диспетчер отказоустойчивости кластеров теперь покажет, что кластер имеет три узла и перечислять в hello **узлы** контейнера.</span><span class="sxs-lookup"><span data-stu-id="997ee-428">Failover Cluster Manager should now show that your cluster has three nodes and list them in hello **Nodes** container.</span></span>
15. <span data-ttu-id="997ee-429">Выйдите из сеанса удаленного рабочего стола hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-429">Sign out of hello remote desktop session.</span></span>

## <a name="prepare-hello-sql-server-instances-for-availability-groups"></a><span data-ttu-id="997ee-430">Подготовка экземпляров SQL Server hello для групп доступности</span><span class="sxs-lookup"><span data-stu-id="997ee-430">Prepare hello SQL Server instances for availability groups</span></span>
<span data-ttu-id="997ee-431">В этом разделе будет выполнять hello, выполнив на обоих **ContosoSQL1** и **contosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="997ee-431">In this section, you will do hello following on both **ContosoSQL1** and **contosoSQL2**:</span></span>

* <span data-ttu-id="997ee-432">Добавьте имя входа для **NT AUTHORITY\System** экземпляр SQL Server по умолчанию toohello установите необходимые разрешения.</span><span class="sxs-lookup"><span data-stu-id="997ee-432">Add a login for **NT AUTHORITY\System** with necessary permissions set toohello default SQL Server instance.</span></span>
* <span data-ttu-id="997ee-433">Добавить **CORP\Install** как экземпляр SQL Server по умолчанию toohello роли sysadmin.</span><span class="sxs-lookup"><span data-stu-id="997ee-433">Add **CORP\Install** as a sysadmin role toohello default SQL Server instance.</span></span>
* <span data-ttu-id="997ee-434">Откройте брандмауэр Windows hello для удаленного доступа к SQL Server.</span><span class="sxs-lookup"><span data-stu-id="997ee-434">Open hello firewall for remote access of SQL Server.</span></span>
* <span data-ttu-id="997ee-435">Включите hello Always On функции групп доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-435">Enable hello Always On availability groups feature.</span></span>
* <span data-ttu-id="997ee-436">Изменение учетной записи службы SQL Server hello слишком**CORP\SQLSvc1** и **CORP\SQLSvc2**соответственно.</span><span class="sxs-lookup"><span data-stu-id="997ee-436">Change hello SQL Server service account too**CORP\SQLSvc1** and **CORP\SQLSvc2**, respectively.</span></span>

<span data-ttu-id="997ee-437">Эти действия можно выполнять в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="997ee-437">These actions can be performed in any order.</span></span> <span data-ttu-id="997ee-438">Тем не менее следующие шаги hello поможет выполнить их в порядке.</span><span class="sxs-lookup"><span data-stu-id="997ee-438">Nevertheless, hello following steps will walk through them in order.</span></span> <span data-ttu-id="997ee-439">Выполните действия hello для обоих **ContosoSQL1** и **ContosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="997ee-439">Follow hello steps for both **ContosoSQL1** and **ContosoSQL2**:</span></span>

1. <span data-ttu-id="997ee-440">Если вы не выполнили выход из системы hello сеанса удаленного рабочего стола для виртуальной машины hello, сделайте это сейчас.</span><span class="sxs-lookup"><span data-stu-id="997ee-440">If you have not signed out of hello remote desktop session for hello virtual machine, do so now.</span></span>
2. <span data-ttu-id="997ee-441">Привет открыть RDP файлы для **ContosoSQL1** и **ContosoSQL2**и войдите как **BUILTIN\AzureAdmin**.</span><span class="sxs-lookup"><span data-stu-id="997ee-441">Open hello RDP files for **ContosoSQL1** and **ContosoSQL2**, and sign in as **BUILTIN\AzureAdmin**.</span></span>
3. <span data-ttu-id="997ee-442">Добавить **NT AUTHORITY\System** toohello имена входа SQL Server с необходимыми разрешениями.</span><span class="sxs-lookup"><span data-stu-id="997ee-442">Add **NT AUTHORITY\System** toohello SQL Server logins with necessary permissions.</span></span> <span data-ttu-id="997ee-443">Откройте **SQL Server Management Studio**.</span><span class="sxs-lookup"><span data-stu-id="997ee-443">Open **SQL Server Management Studio**.</span></span>
4. <span data-ttu-id="997ee-444">Нажмите кнопку **Connect** экземпляр SQL Server по умолчанию toohello tooconnect.</span><span class="sxs-lookup"><span data-stu-id="997ee-444">Click **Connect** tooconnect toohello default SQL Server instance.</span></span>
5. <span data-ttu-id="997ee-445">В **обозревателе объектов** разверните элемент **Безопасность**, а затем элемент **Имена входа**.</span><span class="sxs-lookup"><span data-stu-id="997ee-445">In **Object Explorer**, expand **Security**, and then expand **Logins**.</span></span>
6. <span data-ttu-id="997ee-446">Щелкните правой кнопкой мыши hello **NT AUTHORITY\System** входа в систему, а затем щелкните **свойства**.</span><span class="sxs-lookup"><span data-stu-id="997ee-446">Right-click hello **NT AUTHORITY\System** login, and then click **Properties**.</span></span>
7. <span data-ttu-id="997ee-447">На hello **защищаемые объекты** страницы для hello локального сервера выберите **Grant** для hello следующие разрешения, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-447">On hello **Securables** page, for hello local server, select **Grant** for hello following permissions, and then click **OK**.</span></span>
   
   * <span data-ttu-id="997ee-448">Изменение любой группы доступности</span><span class="sxs-lookup"><span data-stu-id="997ee-448">Alter any availability group</span></span>
   * <span data-ttu-id="997ee-449">Соединение SQL</span><span class="sxs-lookup"><span data-stu-id="997ee-449">Connect SQL</span></span>
   * <span data-ttu-id="997ee-450">Просмотр состояния сервера</span><span class="sxs-lookup"><span data-stu-id="997ee-450">View server state</span></span>
8. <span data-ttu-id="997ee-451">Добавить **CORP\Install** как **sysadmin** экземпляра SQL Server по умолчанию toohello роли.</span><span class="sxs-lookup"><span data-stu-id="997ee-451">Add **CORP\Install** as a **sysadmin** role toohello default SQL Server instance.</span></span> <span data-ttu-id="997ee-452">В **обозревателе объектов** щелкните правой кнопкой мыши узел **Имена для входа**, а затем выберите пункт **Создать имя входа**.</span><span class="sxs-lookup"><span data-stu-id="997ee-452">In **Object Explorer**, right-click **Logins**, and then click **New Login**.</span></span>
9. <span data-ttu-id="997ee-453">Введите **CORP\Install** в поле **Имя для входа**.</span><span class="sxs-lookup"><span data-stu-id="997ee-453">Type **CORP\Install** in **Login name**.</span></span>
10. <span data-ttu-id="997ee-454">На hello **ролей сервера** выберите **sysadmin**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-454">On hello **Server Roles** page, select **sysadmin**, and then click **OK**.</span></span> <span data-ttu-id="997ee-455">После создания имени входа hello, его можно просматривать, развернув **входа** в **обозревателя объектов**.</span><span class="sxs-lookup"><span data-stu-id="997ee-455">After you create hello login, you can see it by expanding **Logins** in **Object Explorer**.</span></span>
11. <span data-ttu-id="997ee-456">правило брандмауэра для SQL Server на hello toocreate **запустить** экрана, откройте **брандмауэр Windows в режиме повышенной безопасности**.</span><span class="sxs-lookup"><span data-stu-id="997ee-456">toocreate a firewall rule for SQL Server, on hello **Start** screen, open **Windows Firewall with Advanced Security**.</span></span>
12. <span data-ttu-id="997ee-457">Выберите в левой области hello **правила для входящих подключений**.</span><span class="sxs-lookup"><span data-stu-id="997ee-457">In hello left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="997ee-458">Hello правой панели щелкните **новое правило**.</span><span class="sxs-lookup"><span data-stu-id="997ee-458">In hello right pane, click **New Rule**.</span></span>
13. <span data-ttu-id="997ee-459">На hello **тип правила** щелкните **программы** > **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-459">On hello **Rule Type** page, click **Program** > **Next**.</span></span>
14. <span data-ttu-id="997ee-460">На hello **программы** выберите **путь к этой программе**, тип **%ProgramFiles%\Microsoft SQL Server\MSSQL12. MSSQLSERVER\MSSQL\Binn\sqlservr.exe** в hello текстовое поле и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-460">On hello **Program** page, select **This program path**, type **%ProgramFiles%\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\sqlservr.exe** in hello text box, and then click **Next**.</span></span> <span data-ttu-id="997ee-461">Если вы следуете этим указаниям, но с помощью SQL Server 2012, каталог SQL Server hello имеет **MSSQL11. MSSQLSERVER**.</span><span class="sxs-lookup"><span data-stu-id="997ee-461">If you are following these directions but using SQL Server 2012, hello SQL Server directory is **MSSQL11.MSSQLSERVER**.</span></span>
15. <span data-ttu-id="997ee-462">На hello **действия** оставьте **разрешить подключение hello** , а затем нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-462">On hello **Action** page, keep **Allow hello connection** selected, and then click **Next**.</span></span>
16. <span data-ttu-id="997ee-463">На hello **профиль** примите параметры по умолчанию hello и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-463">On hello **Profile** page, accept hello default settings, and then click **Next**.</span></span>
17. <span data-ttu-id="997ee-464">На hello **имя** укажите имя правила, например **SQL Server (правило программы)**, в hello **имя** текстовое поле, а затем нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="997ee-464">On hello **Name** page, specify a rule name, such as **SQL Server (Program Rule)**, in hello **Name** text box, then click **Finish**.</span></span>
18. <span data-ttu-id="997ee-465">tooenable hello **группы доступности AlwaysOn** функции в hello **запустить** открывшегося экрана **диспетчер конфигурации SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="997ee-465">tooenable hello **Always On Availability Groups** feature, on hello **Start** screen, open **SQL Server Configuration Manager**.</span></span>
19. <span data-ttu-id="997ee-466">В дереве обозревателя hello, нажмите кнопку **служб SQL Server**, щелкните правой кнопкой мыши hello **SQL Server (MSSQLSERVER)** службы, а затем нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="997ee-466">In hello browser tree, click **SQL Server Services**, right-click hello **SQL Server (MSSQLSERVER)** service, and then click **Properties**.</span></span>
20. <span data-ttu-id="997ee-467">Нажмите кнопку hello **высокий уровень доступности AlwaysOn** выберите **включить группы доступности AlwaysOn**, как показано в hello следующий снимок экрана, а затем нажмите кнопку **применить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-467">Click hello **Always On High Availability** tab, select **Enable Always On Availability Groups**, as shown in hello following screenshot, and then click **Apply**.</span></span> <span data-ttu-id="997ee-468">Нажмите кнопку **ОК** в hello диалоговое окно и не закрывайте hello **свойства** еще диалоговое окно «».</span><span class="sxs-lookup"><span data-stu-id="997ee-468">Click **OK** in hello dialog box, and do not close hello **Properties** dialog box yet.</span></span> <span data-ttu-id="997ee-469">Службы SQL Server hello будет перезагружен после изменения учетной записи службы hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-469">You will restart hello SQL Server service after you change hello service account.</span></span>
    
     ![Включение групп доступности AlwaysOn](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665520.gif)
21. <span data-ttu-id="997ee-471">hello toochange учетной записи службы SQL Server, нажмите кнопку hello **вход в систему** введите **CORP\SQLSvc1** (для **ContosoSQL1**) или **CORP\SQLSvc2** () для **ContosoSQL2**) в **имя учетной записи**, заполните и подтвердите пароль hello и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-471">toochange hello SQL Server service account, click hello **Log On** tab, type **CORP\SQLSvc1** (for **ContosoSQL1**) or **CORP\SQLSvc2** (for **ContosoSQL2**) in **Account Name**, fill in and confirm hello password, and then click **OK**.</span></span>
22. <span data-ttu-id="997ee-472">В hello открывшемся диалоговом окне, щелкните **Да** toorestart hello службы SQL Server.</span><span class="sxs-lookup"><span data-stu-id="997ee-472">In hello dialog box that opens, click **Yes** toorestart hello SQL Server service.</span></span> <span data-ttu-id="997ee-473">После перезапуска службы SQL Server hello, изменения, внесенные в hello **свойства** диалоговое окно, вступают в силу.</span><span class="sxs-lookup"><span data-stu-id="997ee-473">After hello SQL Server service restarts, changes that you made in hello **Properties** dialog box are effective.</span></span>
23. <span data-ttu-id="997ee-474">Выйдите из виртуальных машин hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-474">Sign out of hello virtual machines.</span></span>

## <a name="create-hello-availability-group"></a><span data-ttu-id="997ee-475">Создание группы доступности hello</span><span class="sxs-lookup"><span data-stu-id="997ee-475">Create hello availability group</span></span>
<span data-ttu-id="997ee-476">Теперь вы находитесь готов tooconfigure группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-476">You are now ready tooconfigure an availability group.</span></span> <span data-ttu-id="997ee-477">Ниже приведено краткое описание того, что вам потребуется сделать:</span><span class="sxs-lookup"><span data-stu-id="997ee-477">Below is an outline of what you will do:</span></span>

* <span data-ttu-id="997ee-478">Создание базы данных (**MyDB1**) на **ContosoSQL1**.</span><span class="sxs-lookup"><span data-stu-id="997ee-478">Create a new database (**MyDB1**) on **ContosoSQL1**.</span></span>
* <span data-ttu-id="997ee-479">Отключите полной резервной копии и резервной копии журнала транзакций базы данных hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-479">Take both a full backup and a transaction log backup of hello database.</span></span>
* <span data-ttu-id="997ee-480">Восстановление полной hello и резервные копии журналов слишком**ContosoSQL2** с hello **NORECOVERY** параметр.</span><span class="sxs-lookup"><span data-stu-id="997ee-480">Restore hello full and log backups too**ContosoSQL2** with hello **NORECOVERY** option.</span></span>
* <span data-ttu-id="997ee-481">Создание группы доступности hello (**AG1**) с синхронной фиксацией, автоматической отработки отказа и вторичные реплики для чтения.</span><span class="sxs-lookup"><span data-stu-id="997ee-481">Create hello availability group (**AG1**) with synchronous commit, automatic failover, and readable secondary replicas.</span></span>

### <a name="create-hello-mydb1-database-on-contososql1"></a><span data-ttu-id="997ee-482">Создание базы данных MyDB1 hello на ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="997ee-482">Create hello MyDB1 database on ContosoSQL1</span></span>
1. <span data-ttu-id="997ee-483">Если вы не уже вышли hello сеансов удаленного рабочего стола для **ContosoSQL1** и **ContosoSQL2**, сделайте это сейчас.</span><span class="sxs-lookup"><span data-stu-id="997ee-483">If you have not already signed out of hello remote desktop sessions for **ContosoSQL1** and **ContosoSQL2**, do so now.</span></span>
2. <span data-ttu-id="997ee-484">Привет открыть RDP-файл для **ContosoSQL1**и войдите как **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="997ee-484">Open hello RDP file for **ContosoSQL1**, and sign in as **CORP\Install**.</span></span>
3. <span data-ttu-id="997ee-485">В **проводнике** на диске **C:\\** создайте каталог **backup**.</span><span class="sxs-lookup"><span data-stu-id="997ee-485">In **File Explorer**, under **C:\\**, create a directory named **backup**.</span></span> <span data-ttu-id="997ee-486">Будет использоваться этот каталог tooback и восстановление базы данных.</span><span class="sxs-lookup"><span data-stu-id="997ee-486">You will use this directory tooback up and restore your database.</span></span>
4. <span data-ttu-id="997ee-487">Щелкните правой кнопкой мыши новый каталог hello, укажите слишком**предоставить**и нажмите кнопку **конкретные пользователи**, как показано в следующих экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-487">Right-click hello new directory, point too**Share with**, and then click **Specific people**, as shown in hello following screenshot.</span></span>
   
    ![Создание папки резервного копирования](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665521.gif)
5. <span data-ttu-id="997ee-489">Добавить **CORP\SQLSvc1**и присвойте ему hello **чтения и записи** разрешение.</span><span class="sxs-lookup"><span data-stu-id="997ee-489">Add **CORP\SQLSvc1**, and then give it hello **Read/Write** permission.</span></span> <span data-ttu-id="997ee-490">Добавить **CORP\SQLSvc2**и присвойте ему hello **чтения** разрешения, как показано в hello следующий снимок экрана, а затем нажмите кнопку **общего ресурса**.</span><span class="sxs-lookup"><span data-stu-id="997ee-490">Add **CORP\SQLSvc2**, and then give it hello **Read** permission, as shown in hello following screenshot, and then click **Share**.</span></span> <span data-ttu-id="997ee-491">После завершения процесса обмена файлами hello щелкните **сделать**.</span><span class="sxs-lookup"><span data-stu-id="997ee-491">After hello file-sharing process is finished, click **Done**.</span></span>
   
    ![Предоставление разрешений для папки резервного копирования](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665522.gif)
6. <span data-ttu-id="997ee-493">базы данных hello toocreate из hello **запустить** выберите пункт **SQL Server Management Studio**и нажмите кнопку **Connect** экземпляр SQL Server по умолчанию toohello tooconnect.</span><span class="sxs-lookup"><span data-stu-id="997ee-493">toocreate hello database, from hello **Start** menu, open **SQL Server Management Studio**, and then click **Connect** tooconnect toohello default SQL Server instance.</span></span>
7. <span data-ttu-id="997ee-494">В **обозревателе объектов** щелкните правой кнопкой мыши элемент **Базы данных** и выберите пункт **Создать базу данных**.</span><span class="sxs-lookup"><span data-stu-id="997ee-494">In **Object Explorer**, right-click **Databases**, and then click **New Database**.</span></span>
8. <span data-ttu-id="997ee-495">В поле **Имя базы данных** введите **MyDB1**, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-495">In **Database name**, type **MyDB1**, and then click **OK**.</span></span>

### <a name="make-a-full-backup-of-mydb1-and-restore-it-on-contososql2"></a><span data-ttu-id="997ee-496">Создание полной резервной копии MyDB1 и восстановление ее на ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="997ee-496">Make a full backup of MyDB1 and restore it on ContosoSQL2</span></span>
1. <span data-ttu-id="997ee-497">toomake hello полной резервной копии базы данных, в **обозревателя объектов**, разверните **баз данных**, щелкните правой кнопкой мыши **MyDB1**, слишком точки**задачи**, и Нажмите кнопку **резервное копирование**.</span><span class="sxs-lookup"><span data-stu-id="997ee-497">toomake a full backup of hello database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point too**Tasks**, and then click **Back Up**.</span></span>
2. <span data-ttu-id="997ee-498">В hello **источника** установите **тип резервной копии** значение слишком**полного**.</span><span class="sxs-lookup"><span data-stu-id="997ee-498">In hello **Source** section, keep **Backup type** set too**Full**.</span></span> <span data-ttu-id="997ee-499">В hello **назначения** щелкните **удалить** tooremove hello по умолчанию путь к файлу hello резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="997ee-499">In hello **Destination** section, click **Remove** tooremove hello default file path for hello backup file.</span></span>
3. <span data-ttu-id="997ee-500">В hello **назначения** щелкните **добавить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-500">In hello **Destination** section, click **Add**.</span></span>
4. <span data-ttu-id="997ee-501">В hello **имя файла** введите  **\\ContosoSQL1\backup\MyDB1.bak**, нажмите кнопку **ОК**, а затем нажмите кнопку **ОК** еще раз tooback hello базы данных.</span><span class="sxs-lookup"><span data-stu-id="997ee-501">In hello **File name** text box, type **\\ContosoSQL1\backup\MyDB1.bak**, click **OK**, and then click **OK** again tooback up hello database.</span></span> <span data-ttu-id="997ee-502">По завершении операции резервного копирования приветствия нажмите кнопку **ОК** снова tooclose hello диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="997ee-502">When hello backup operation finishes, click **OK** again tooclose hello dialog box.</span></span>
5. <span data-ttu-id="997ee-503">toomake транзакции вход резервной копии hello, **обозревателя объектов**, разверните **баз данных**, щелкните правой кнопкой мыши **MyDB1**, слишком точки**задачи**, а затем нажмите кнопку **резервное копирование**.</span><span class="sxs-lookup"><span data-stu-id="997ee-503">toomake a transaction log backup of hello database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point too**Tasks**, and then click **Back Up**.</span></span>
6. <span data-ttu-id="997ee-504">В поле **Тип резервной копии** выберите вариант **Журнал транзакций**.</span><span class="sxs-lookup"><span data-stu-id="997ee-504">In **Backup type**, select **Transaction Log**.</span></span> <span data-ttu-id="997ee-505">Сохранить hello **назначения** файла toohello набор путь был указан ранее и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-505">Keep hello **Destination** file path set toohello one you specified earlier, and then click **OK**.</span></span> <span data-ttu-id="997ee-506">После завершения операции резервного копирования hello щелкните **ОК** еще раз.</span><span class="sxs-lookup"><span data-stu-id="997ee-506">After hello backup operation finishes, click **OK** again.</span></span>
7. <span data-ttu-id="997ee-507">hello toorestore полная и журналов транзакций резервных копий **ContosoSQL2**откройте hello RDP-файла для **ContosoSQL2**и войдите как **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="997ee-507">toorestore hello full and transaction log backups on **ContosoSQL2**, open hello RDP file for **ContosoSQL2**, and sign in as **CORP\Install**.</span></span> <span data-ttu-id="997ee-508">Оставьте hello сеанса удаленного рабочего стола для **ContosoSQL1** открыть.</span><span class="sxs-lookup"><span data-stu-id="997ee-508">Leave hello remote desktop session for **ContosoSQL1** open.</span></span>
8. <span data-ttu-id="997ee-509">Из hello **запустить** выберите пункт **SQL Server Management Studio**и нажмите кнопку **Connect** экземпляр SQL Server по умолчанию toohello tooconnect.</span><span class="sxs-lookup"><span data-stu-id="997ee-509">From hello **Start** menu, open **SQL Server Management Studio**, and then click **Connect** tooconnect toohello default SQL Server instance.</span></span>
9. <span data-ttu-id="997ee-510">В **обозревателе объектов** щелкните правой кнопкой мыши элемент **Базы данных** и выберите пункт **Восстановить базу данных**.</span><span class="sxs-lookup"><span data-stu-id="997ee-510">In **Object Explorer**, right-click **Databases**, and then click **Restore Database**.</span></span>
10. <span data-ttu-id="997ee-511">В hello **источника** выберите **устройства**и нажмите кнопку с многоточием hello **...**</span><span class="sxs-lookup"><span data-stu-id="997ee-511">In hello **Source** section, select **Device**, and click hello ellipsis **…**</span></span> <span data-ttu-id="997ee-512">.</span><span class="sxs-lookup"><span data-stu-id="997ee-512">button.</span></span>
11. <span data-ttu-id="997ee-513">В разделе **Выберите устройства резервного копирования** нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="997ee-513">In **Select backup devices**, click **Add**.</span></span>
12. <span data-ttu-id="997ee-514">В поле **Расположение файла резервной копии** введите **\\ContosoSQL1\backup**, нажмите кнопку **Обновить**, выберите **MyDB1.bak**, нажмите кнопку **ОК** и еще раз нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-514">In **Backup file location**, type **\\ContosoSQL1\backup**, click **Refresh**, select **MyDB1.bak**, click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="997ee-515">Должно отобразиться hello полную резервную копию и резервную копию журнала hello в hello **резервные наборы данных toorestore** области.</span><span class="sxs-lookup"><span data-stu-id="997ee-515">You should now see hello full backup and hello log backup in hello **Backup sets toorestore** pane.</span></span>
13. <span data-ttu-id="997ee-516">Go toohello **параметры** выберите **инструкции RESTORE WITH NORECOVERY** в **состояние восстановления**, а затем нажмите кнопку **ОК** базы данных toorestore hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-516">Go toohello **Options** page, select **RESTORE WITH NORECOVERY** in **Recovery state**, and then click **OK** toorestore hello database.</span></span> <span data-ttu-id="997ee-517">После hello для завершения операции восстановления, нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="997ee-517">After hello restore operation finishes, click **OK**.</span></span>

### <a name="create-hello-availability-group"></a><span data-ttu-id="997ee-518">Создание группы доступности hello</span><span class="sxs-lookup"><span data-stu-id="997ee-518">Create hello availability group</span></span>
1. <span data-ttu-id="997ee-519">Перейдите обратно toohello сеанс удаленного рабочего стола для **ContosoSQL1**.</span><span class="sxs-lookup"><span data-stu-id="997ee-519">Go back toohello remote desktop session for **ContosoSQL1**.</span></span> <span data-ttu-id="997ee-520">В **обозревателя объектов** в SQL Server Management Studio, щелкните правой кнопкой мыши **высокий уровень доступности AlwaysOn**, а затем нажмите кнопку **мастера создания группы доступности**, как показано в hello Следующий снимок экрана.</span><span class="sxs-lookup"><span data-stu-id="997ee-520">In **Object Explorer** in SQL Server Management Studio, right-click **Always On High Availability**, and then click **New Availability Group Wizard**, as shown in hello following screenshot.</span></span>
   
    ![Запуск мастера создания групп доступности](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665523.gif)
2. <span data-ttu-id="997ee-522">На hello **Введение** щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-522">On hello **Introduction** page, click **Next**.</span></span> <span data-ttu-id="997ee-523">На hello **Указание имени группы доступности** введите **AG1** в **имя группы доступности**, нажмите кнопку **Далее** еще раз.</span><span class="sxs-lookup"><span data-stu-id="997ee-523">On hello **Specify Availability Group Name** page, type **AG1** in **Availability group name**, then click **Next** again.</span></span>
   
    ![Мастер создания групп доступности, страница "Указание имени группы доступности"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665524.gif)
3. <span data-ttu-id="997ee-525">На hello **Выбор баз данных** выберите **MyDB1**, а затем нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-525">On hello **Select Databases** page, select **MyDB1**, and then click **Next**.</span></span> <span data-ttu-id="997ee-526">Hello базы данных предварительным требованиям hello для группы доступности из-за выполнения по крайней мере одну полную резервную копию на hello целевой первичной реплики.</span><span class="sxs-lookup"><span data-stu-id="997ee-526">hello database meets hello prerequisites for an availability group because you have taken at least one full backup on hello intended primary replica.</span></span>
   
    ![Мастер создания групп доступности, страница "Выбор баз данных"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665525.gif)
4. <span data-ttu-id="997ee-528">на hello **Выбор реплик** щелкните **добавления реплики**.</span><span class="sxs-lookup"><span data-stu-id="997ee-528">on hello **Specify Replicas** page, click **Add Replica**.</span></span>
   
    ![Мастер создания групп доступности, страница "Указание реплик"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665526.gif)
5. <span data-ttu-id="997ee-530">В hello **подключения tooServer** диалоговое окно, введите **ContosoSQL2** в **имя сервера**, а затем нажмите кнопку **Connect**.</span><span class="sxs-lookup"><span data-stu-id="997ee-530">In hello **Connect tooServer** dialog box, type **ContosoSQL2** in **Server name**, and then click **Connect**.</span></span>
   
    ![Мастер создания групп доступности, Connect tooserver](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665527.gif)
6. <span data-ttu-id="997ee-532">Включите hello **Выбор реплик** страницы должна появиться **ContosoSQL2** в **доступные реплики**.</span><span class="sxs-lookup"><span data-stu-id="997ee-532">Back on hello **Specify Replicas** page, you should now see **ContosoSQL2** listed in **Available Replicas**.</span></span> <span data-ttu-id="997ee-533">Настройка реплик hello, как показано на следующий снимок экрана приветствия.</span><span class="sxs-lookup"><span data-stu-id="997ee-533">Configure hello replicas as shown in hello following screenshot.</span></span> <span data-ttu-id="997ee-534">После завершения нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-534">When you are finished, click **Next**.</span></span>
   
    ![Мастер создания групп доступности, заполненная страница "Указание реплик"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665528.gif)
7. <span data-ttu-id="997ee-536">На hello **Выбор начальной синхронизации данных** выберите **только присоединение**, а затем нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-536">On hello **Select Initial Data Synchronization** page, select **Join only**, and then click **Next**.</span></span> <span data-ttu-id="997ee-537">Вы уже выполнили синхронизации данных вручную при внесении hello full и операции резервного копирования на **ContosoSQL1** и их восстановление на **ContosoSQL2**.</span><span class="sxs-lookup"><span data-stu-id="997ee-537">You already performed data synchronization manually when you made hello full and transaction backups on **ContosoSQL1** and restored them on **ContosoSQL2**.</span></span> <span data-ttu-id="997ee-538">Можно выбрать не tooperform hello операции резервного копирования и восстановления базы данных, а вместо этого выберите **полного** toolet приветствия мастера создания группы доступности выполнил синхронизацию данных.</span><span class="sxs-lookup"><span data-stu-id="997ee-538">You can choose not tooperform hello backup and restore operations on your database and instead select **Full** toolet hello New Availability Group Wizard perform data synchronization for you.</span></span> <span data-ttu-id="997ee-539">Однако мы не рекомендуем такой вариант для очень крупных баз данных, которые иногда используются на предприятиях.</span><span class="sxs-lookup"><span data-stu-id="997ee-539">However, we do not recommend this option for very large databases that are found in some enterprises.</span></span>
   
    ![Мастер создания групп доступности, страница "Выбор начальной синхронизации данных"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665529.gif)
8. <span data-ttu-id="997ee-541">На hello **проверки** щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="997ee-541">On hello **Validation** page, click **Next**.</span></span> <span data-ttu-id="997ee-542">Эта страница должна выглядеть примерно toohello следующий снимок экрана.</span><span class="sxs-lookup"><span data-stu-id="997ee-542">This page should look similar toohello following screenshot.</span></span> <span data-ttu-id="997ee-543">Имеется предупреждение для конфигурации прослушивателя hello, так как вы не настроили прослушиватель группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-543">There is a warning for hello listener configuration because you have not configured an availability group listener.</span></span> <span data-ttu-id="997ee-544">Вы можете пропустить это предупреждение, поскольку процедура настройки прослушивателя не описана в этом учебнике.</span><span class="sxs-lookup"><span data-stu-id="997ee-544">You can ignore this warning, because this tutorial does not configure a listener.</span></span> <span data-ttu-id="997ee-545">прослушиватель hello tooconfigure после завершения этого учебника, см. в разделе [настроить прослушиватель ILB для группы доступности AlwaysOn в Azure](../classic/ps-sql-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-545">tooconfigure hello listener after you complete this tutorial, see [Configure an ILB listener for Always On Availability Groups in Azure](../classic/ps-sql-int-listener.md).</span></span>
   
    ![Мастер создания групп доступности, страница "Проверка"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665530.gif)
9. <span data-ttu-id="997ee-547">На hello **Сводка** нажмите кнопку **Готово**, а затем подождите, пока мастер hello настраивает hello новой группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-547">On hello **Summary** page, click **Finish**, and then wait while hello wizard configures hello new availability group.</span></span> <span data-ttu-id="997ee-548">На hello **выполняется** страницы, можно щелкнуть **Дополнительные сведения о** tooview hello подробные хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="997ee-548">On hello **Progress** page, you can click **More details** tooview hello detailed progress.</span></span> <span data-ttu-id="997ee-549">По окончании работы мастера hello проверять hello **результатов** tooverify странице этой группы доступности hello успешно создан, как показано на следующий снимок экрана приветствия и нажмите кнопку **закрыть** tooexit hello мастер.</span><span class="sxs-lookup"><span data-stu-id="997ee-549">After hello wizard finishes, inspect hello **Results** page tooverify that hello availability group is successfully created, as shown in hello following screenshot, and then click **Close** tooexit hello wizard.</span></span>
   
    ![Мастер создания групп доступности, страница "Результаты"](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665531.gif)
10. <span data-ttu-id="997ee-551">В **обозревателе объектов** разверните узел **Высокий уровень доступности AlwaysOn**, а затем узел **Группы доступности**.</span><span class="sxs-lookup"><span data-stu-id="997ee-551">In **Object Explorer**, expand **Always On High Availability**, and then expand **Availability Groups**.</span></span> <span data-ttu-id="997ee-552">Теперь вы увидите hello новой группы доступности в этом контейнере.</span><span class="sxs-lookup"><span data-stu-id="997ee-552">You should now see hello new availability group in this container.</span></span> <span data-ttu-id="997ee-553">Щелкните правой кнопкой мыши элемент **AG1 (основная)** и выберите пункт **Отобразить панель мониторинга**.</span><span class="sxs-lookup"><span data-stu-id="997ee-553">Right-click **AG1 (Primary)**, and then click **Show Dashboard**.</span></span>
    
     ![Отображение панели мониторинга группы доступности](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665532.gif)
11. <span data-ttu-id="997ee-555">Ваш **панели мониторинга AlwaysOn** следует искать аналогичные toohello один в hello следующий снимок экрана.</span><span class="sxs-lookup"><span data-stu-id="997ee-555">Your **Always On Dashboard** should look similar toohello one in hello following screenshot.</span></span> <span data-ttu-id="997ee-556">Вы увидите реплики hello, hello режима отработки отказа для каждой реплики и состояние синхронизации hello.</span><span class="sxs-lookup"><span data-stu-id="997ee-556">You can see hello replicas, hello failover mode of each replica, and hello synchronization state.</span></span>
    
     ![Панель мониторинга группы доступности](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665533.gif)
12. <span data-ttu-id="997ee-558">Возвращает слишком**диспетчера сервера**, нажмите кнопку **средства**и откройте **Диспетчер отказоустойчивости кластеров**.</span><span class="sxs-lookup"><span data-stu-id="997ee-558">Return too**Server Manager**, click **Tools**, and then open **Failover Cluster Manager**.</span></span>
13. <span data-ttu-id="997ee-559">Разверните элемент **Cluster1.corp.contoso.com**, а затем разверните элемент **Службы и приложения**.</span><span class="sxs-lookup"><span data-stu-id="997ee-559">Expand **Cluster1.corp.contoso.com**, and then expand **Services and applications**.</span></span> <span data-ttu-id="997ee-560">Выберите **ролей** и обратите внимание, что hello **AG1** была создана роль группы доступности.</span><span class="sxs-lookup"><span data-stu-id="997ee-560">Select **Roles** and note that hello **AG1** availability group role has been created.</span></span> <span data-ttu-id="997ee-561">Обратите внимание, что AG1 не имеет IP-адрес, базы данных, который клиенты могут подключаться toohello группы доступности, так как не удалось настроить прослушиватель.</span><span class="sxs-lookup"><span data-stu-id="997ee-561">Note that AG1 does not have an IP address by which database clients can connect toohello availability group, because you did not configure a listener.</span></span> <span data-ttu-id="997ee-562">Можно подключаться напрямую toohello основным узлом для операций чтения и записи и hello дополнительного узла для запросов только для чтения.</span><span class="sxs-lookup"><span data-stu-id="997ee-562">You can connect directly toohello primary node for read-write operations and hello secondary node for read-only queries.</span></span>
    
     ![Группа доступности в диспетчере отказоустойчивости кластеров](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665534.gif)

> [!WARNING]
> <span data-ttu-id="997ee-564">Не предпринимайте toofail hello группы доступности из hello диспетчера отказоустойчивости кластеров.</span><span class="sxs-lookup"><span data-stu-id="997ee-564">Do not try toofail over hello availability group from hello Failover Cluster Manager.</span></span> <span data-ttu-id="997ee-565">Все операции отработки отказа следует выполнять через **панель мониторинга AlwaysOn** в SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="997ee-565">All failover operations should be performed from within **Always On Dashboard** in SQL Server Management Studio.</span></span> <span data-ttu-id="997ee-566">Дополнительные сведения см. в разделе [ограничения на использование hello Диспетчер отказоустойчивости кластеров с группами доступности](https://msdn.microsoft.com/library/ff929171.aspx).</span><span class="sxs-lookup"><span data-stu-id="997ee-566">For more information, see [Restrictions on Using hello Failover Cluster Manager with Availability Groups](https://msdn.microsoft.com/library/ff929171.aspx).</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="997ee-567">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="997ee-567">Next steps</span></span>
<span data-ttu-id="997ee-568">Решение SQL Server Always On на основе группы доступности в Azure успешно создано.</span><span class="sxs-lookup"><span data-stu-id="997ee-568">You have now successfully implemented SQL Server Always On by creating an availability group in Azure.</span></span> <span data-ttu-id="997ee-569">tooconfigure прослушивателя для этой группы доступности. в разделе [настроить прослушиватель ILB для групп доступности AlwaysOn в Azure](../classic/ps-sql-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-569">tooconfigure a listener for this availability group, see [Configure an ILB listener for Always On availability groups in Azure](../classic/ps-sql-int-listener.md).</span></span>

<span data-ttu-id="997ee-570">Дополнительные сведения об использовании SQL Server в Azure см. в статье [Общие сведения об SQL Server на виртуальных машинах Azure](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="997ee-570">For other information about using SQL Server in Azure, see [SQL Server on Azure Virtual Machines](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

