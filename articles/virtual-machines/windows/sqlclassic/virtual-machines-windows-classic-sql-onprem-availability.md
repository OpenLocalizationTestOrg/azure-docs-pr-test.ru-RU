---
title: "aaaExtend локальной группы доступности AlwaysOn tooAzure | Документы Microsoft"
description: "Этот учебник использует ресурсы, созданные с помощью hello классической модели развертывания и описывает, как toouse hello мастера добавления реплики в SQL Server Management Studio (SSMS) tooadd реплики группы доступности AlwaysOn в Azure."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 7ca7c423-8342-4175-a70b-d5101dfb7f23
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/31/2017
ms.author: mikeray
ms.openlocfilehash: 51fe117b40d69706b35f30101538a7a36116e128
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="extend-on-premises-always-on-availability-groups-tooazure"></a>Расширить tooAzure локальных групп доступности AlwaysOn
Группы доступности Always On обеспечивают высокий уровень доступности для групп базы данных путем добавления вторичных реплик. Эти реплики позволяют отрабатывать отказы баз данных. Кроме того, они могут быть используется toooffload чтения рабочих нагрузок или задачи резервного копирования.

TooMicrosoft локальной группы доступности Azure можно расширить путем подготовки один или несколько виртуальных машин Azure с SQL Server и добавляя их как tooyour реплик и локальные группы доступности.

В этом учебнике предполагается, что у вас есть следующие hello:

* Активная подписка Azure. Вы можете [воспользоваться бесплатной пробной версией](https://azure.microsoft.com/pricing/free-trial/).
* Существующая локальная группа доступности Always On. Дополнительные сведения о группах доступности см. в статье [Группы доступности Always On](https://msdn.microsoft.com/library/hh510230.aspx).
* Связь между hello в локальной сети и виртуальной сети Azure. Дополнительные сведения о создании этой виртуальной сети см. в разделе [создать сайт-сайт, используя подключение hello портал Azure (классические)](../../../vpn-gateway/vpn-gateway-howto-site-to-site-classic-portal.md).

> [!IMPORTANT] 
> В Azure предлагаются две модели развертывания для создания ресурсов и работы с ними: [модель диспетчера ресурсов и классическая модель](../../../azure-resource-manager/resource-manager-deployment-model.md). В этой статье описан с помощью hello классической модели развертывания. Корпорация Майкрософт рекомендует наиболее новые развертывания модели hello диспетчера ресурсов.

## <a name="add-azure-replica-wizard"></a>Мастер добавления реплики Azure
В этом разделе показано, как toouse hello **мастер добавления реплики Azure** tooextend tooinclude решение вашей группы доступности AlwaysOn Azure реплик.

> [!IMPORTANT]
> Hello **мастер добавления реплики Azure** поддерживает только виртуальные машины, созданные hello классической модели развертывания. Новые развертывания виртуальных Машин следует использовать hello новая модель диспетчера ресурсов. При использовании виртуальных машин с помощью диспетчера ресурсов, необходимо вручную добавить hello вторичной реплики Azure с помощью Transact-SQL commmands (здесь не показаны). Этот мастер не будет работать в сценарии hello диспетчера ресурсов.

1. В SQL Server Management Studio разверните раздел **Always On High Availability**(Высокий уровень доступности Always On) > **Группы доступности** > **[Имя группы доступности]**.
2. Щелкните правой кнопкой мыши **Реплики доступности** и выберите пункт **Добавить реплику**.
3. По умолчанию hello **tooAvailability добавления реплики мастера группы** отображается. Щелкните **Далее**.  Если вы выбрали hello **больше не показывать эту страницу** параметр hello нижней части страницы приветствия во время предыдущего запуска мастера, этот экран не будет отображаться.
   
    ![SQL](./media/virtual-machines-windows-classic-sql-onprem-availability/IC742861.png)
4. Будет необходимо tooconnect tooall существующим вторичным репликам. Щелкните **Connect…** (Подключиться...) рядом с каждой репликой или **Connect All…** (Подключить все...). hello нижней части экрана приветствия. После проверки подлинности, нажмите кнопку **Далее** tooadvance toohello следующий экран.
5. На hello **Выбор реплик** страницы, несколько вкладок в верхней hello: **реплик**, **конечные точки**, **настройки резервного копирования**, и **Прослушивателя**. Из hello **реплик** щелкните **добавить реплику Azure...** toolaunch hello мастер добавления реплики Azure.
   
    ![SQL](./media/virtual-machines-windows-classic-sql-onprem-availability/IC742863.png)
6. Выберите существующий сертификат управления Azure в локальном хранилище сертификатов Windows hello, прежде чем после установки. Выберите или введите идентификатор подписки Azure hello при использовании прежней позиции. Нажмите кнопку загрузки toodownload и установите сертификат управления Azure можно загрузить список подписок, используя учетную запись Azure hello.
   
    ![SQL](./media/virtual-machines-windows-classic-sql-onprem-availability/IC742864.png)
7. Будет заполнять каждое поле на странице приветствия со значениями, которые будут использоваться toocreate hello Azure виртуальной машины (VM), где будет размещаться реплика hello.
   
   | Настройка | Описание |
   | --- | --- |
   | **Образ —** |Выберите сочетание hello требуемого операционной системы и SQL Server |
   | **Размер виртуальной машины** |Выберите размер виртуальной Машины, лучше всего соответствует вашим деловым потребностям hello |
   | **Имя виртуальной машины** |Укажите уникальное имя для hello новой виртуальной Машины. Hello имя должно содержать от 3 до 15 символов, может содержать только буквы, цифры и дефисы и должно начинаться с буквы и заканчиваться буквой или цифрой. |
   | **Имя пользователя виртуальной машины** |Укажите имя пользователя, который должен стать учетной записи администратора hello hello виртуальной Машины |
   | **Пароль администратора виртуальной машины** |Укажите пароль для новой учетной записи hello |
   | **Подтверждение пароля** |Подтверждение пароля hello hello новой учетной записи |
   | **Виртуальная сеть** |Укажите hello Azure виртуальные сети, который должна использовать Новая виртуальная машина hello. Дополнительные сведения о виртуальных сетях см. в статье [Обзор виртуальной сети](../../../virtual-network/virtual-networks-overview.md). |
   | **Подсеть виртуальной сети** |Укажите подсеть виртуальной сети hello, который должна использовать Новая виртуальная машина hello |
   | **Домен** |Подтвердите правильность hello предустановленное значение для домена hello |
   | **Имя пользователя домена** |Укажите учетную запись, входящую в группу локальных администраторов hello на узлах локального кластера hello |
   | **Пароль** |Укажите hello пароль для имени пользователя домена hello |
8. Нажмите кнопку **ОК** параметры развертывания toovalidate hello.
9. После этого отобразятся условия соглашения. Прочтите и нажмите кнопку **ОК** Если вы согласны toothese условия.
10. Hello **Выбор реплик** снова откроется страница. Проверьте параметры hello новая реплика Azure hello на hello **реплик**, **конечные точки**, и **настройки резервного копирования** вкладок. Измените параметры toomeet бизнес-требований.  Дополнительные сведения о параметрах hello на этих вкладках см. в разделе [укажите страницу реплик (мастера создания группы доступности мастер или добавить реплику)](https://msdn.microsoft.com/library/hh213088.aspx). Обратите внимание, что нельзя создать с помощью вкладки hello прослушивателя для групп доступности, которые содержат реплики Azure. Кроме того если прослушиватель уже был создан предыдущей toolaunching приветствия мастера, вы получите сообщение о том, что не поддерживается в Azure. Мы рассмотрим как toocreate прослушиватели hello **создание прослушивателя группы доступности** раздела.
    
     ![SQL](./media/virtual-machines-windows-classic-sql-onprem-availability/IC742865.png)
11. Щелкните **Далее**.
12. Выберите метод синхронизации данных hello, требуется toouse на hello **Выбор начальной синхронизации данных** и нажмите кнопку **Далее**. В большинстве случаев следует выбирать вариант **Full Data Synchronization** (Полная синхронизация данных). Дополнительные сведения о методах синхронизации данных см. в статье [Страница "Выбор начальной синхронизации данных" (мастера группы доступности Always On)](https://msdn.microsoft.com/library/hh231021.aspx).
13. Просмотрите результаты hello на hello **проверки** страницы. Устраните Нерешенные проблемы и при необходимости перезапустите проверки hello. Щелкните **Далее**.
    
     ![SQL](./media/virtual-machines-windows-classic-sql-onprem-availability/IC742866.png)
14. Просмотрите параметры hello на hello **Сводка** , а затем нажмите кнопку **Готово**.
15. начинает процесс подготовки Hello. По завершении приветствия мастера нажмите кнопку **закрыть** tooexit приветствия мастера.

> [!NOTE]
> Hello мастер добавления реплики Azure создает файл журнала в Users\User Name\AppData\Local\SQL Server\AddReplicaWizard. Этот файл журнала может быть используется tootroubleshoot Сбой развертывания реплики Azure. Если мастер hello не удается выполнить какие-либо действия, выполняется откат всех предыдущих операций, включая удаление hello подготовки виртуальной Машины.
> 
> 

## <a name="create-an-availability-group-listener"></a>Создание прослушивателя группы доступности
После создания группы доступности hello следует создайте прослушиватель для клиентов tooconnect toohello реплик. Прослушиватели направляют входящие подключения tooeither hello первичного или только для чтения вторичной реплике. Дополнительные сведения о прослушивателях см. в статье [Настройка прослушивателя внутренней подсистемы балансировки нагрузки для группы доступности Always On в Azure](../classic/ps-sql-int-listener.md).

## <a name="next-steps"></a>Дальнейшие действия
В дополнение toousing hello **мастер добавления реплики Azure** tooextend tooAzure вашей группы доступности AlwaysOn, также может перемещать некоторых рабочих нагрузок SQL Server tooAzure полностью. tooget работы см. в разделе [подготовки виртуальной машины SQL Server в Azure](../sql/virtual-machines-windows-portal-sql-server-provision.md).

Другие разделы, посвященные toorunning SQL Server в виртуальных машинах Azure, см. в разделе [SQL Server на виртуальных машинах Azure](../sql/virtual-machines-windows-sql-server-iaas-overview.md).

