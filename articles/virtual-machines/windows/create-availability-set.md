---
title: "Создание группы доступности виртуальных машин в Azure | Документация Майкрософт"
description: "Узнайте, как создать управляемую или неуправляемую группу доступности для виртуальных машин посредством Azure PowerShell или портала в модели развертывания с помощью Resource Manager."
keywords: "группа доступности"
services: virtual-machines-windows
documentationcenter: 
author: cynthn
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: a3db8659-ace8-4e78-8b8c-1e75c04c042c
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 02/06/2017
ms.author: cynthn
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: e813ade8e105169f21138ed8a8eafda1ff39f42e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="increase-vm-availability-by-creating-an-azure-availability-set"></a>Повышение уровня доступности виртуальной машины с помощью группы доступности Azure 
Группы доступности обеспечивают избыточность приложения. Мы рекомендуем включить две или больше виртуальных машин в группу доступности. Эта конфигурация обеспечит доступность не менее одной виртуальной машины и достижение показателя 99,95 % уровня обслуживания (SLA) Azure как при событиях запланированного обслуживания, так и при незапланированного. Дополнительные сведения см. в статье о [соглашении об уровне обслуживания для виртуальных машин](https://azure.microsoft.com/support/legal/sla/virtual-machines/).

> [!IMPORTANT]
> Виртуальные машины должны быть созданы в той же группе ресурсов, что и группа доступности.
> 

Если вы хотите, чтобы виртуальная машина входила в группу доступности, сначала нужно создать группу доступности, либо следует создать эту виртуальную машину в качестве первой виртуальной машины в группе доступности. Если виртуальная машина будет использовать управляемые диски, то должна быть создана управляемая группа доступности.

Дополнительную сведения о создании и использовании групп доступности см. в статье [Управление доступностью виртуальных машин](manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

## <a name="use-the-portal-to-create-an-availability-set-before-creating-your-vms"></a>Создание группы доступности с помощью портала перед созданием виртуальных машин
1. В главном меню щелкните **Обзор** и выберите **Группы доступности**.
2. В **колонке "Группы доступности"** нажмите кнопку **Добавить**.
   
    ![Снимок экрана, показывающий кнопку "Добавить" для создания новой группы доступности.](./media/create-availability-set/add-availability-set.png)
3. В колонке **Создать группу доступности** заполните сведения для своей группы.
   
    ![Снимок экрана, показывающий, какие сведения необходимо ввести для создания группы доступности.](./media/create-availability-set/create-availability-set.png)
   
   * **Имя** — имя должно содержать от 1 до 80 знаков, которыми могут быть цифры, буквы, точки, знаки подчеркивания и тире. Первый знак должен быть буквой или цифрой. Последний знак должен быть буквой, цифрой или знаком подчеркивания.
   * **Домены сбоя** — домены сбоя определяют группу виртуальных машин, которые совместно используют общий источник питания и сетевой коммутатор. По умолчанию виртуальные машины разделяются на несколько доменов сбоя, но не более трех. Их число можно менять от 1 до 3.
   * **Домены обновления** — пять доменов обновления назначаются по умолчанию, и их число можно изменить от 1 до 20. Домены обновления — это группы виртуальных машин и базовое физическое оборудование, которое может быть перезагружено одновременно. Например, если указать пять доменов обновления, то когда в одной группе доступности настраивается более пяти виртуальных машин, шестая виртуальная машина будет помещена в тот же домен обновления, что и первая виртуальная машина, седьмая — что и вторая, и т. д. Порядок перезагрузки может не быть последовательным, но одновременно будет перезагружаться только один домен обновления.
   * **Подписка** — при наличии нескольких подписок выберите подписку, которую вы хотите использовать.
   * **Группа ресурсов** — выберите существующую группу ресурсов, щелкнув стрелку и выбрав группу ресурсов из раскрывающегося списка. Также можно создать новую группу ресурсов, введя имя. Имя может содержать следующие знаки: буквы, цифры, точки, тире, знаки подчеркивания, а также открывающую и закрывающую скобки. Имя не может заканчиваться точкой. Все виртуальные машины в группе доступности должны создаваться в той же группе ресурсов, что и группа доступности.
   * **Расположение** — выберите расположение из раскрывающегося списка.
   * **Управляемая** — выберите *Да*, чтобы создать управляемую группу доступности для виртуальных машин, использующих Управляемые диски для хранения данных. Выберите **Нет**, если виртуальные машины в группе будут использовать неуправляемые диски, расположенные в учетной записи хранения.
   
4. После ввода необходимых сведений нажмите кнопку **Создать**. 

## <a name="use-the-portal-to-create-a-virtual-machine-and-an-availability-set-at-the-same-time"></a>Одновременное создание виртуальной машины и группы доступности с помощью портала
При создании новой виртуальной машины с помощью портала можно также создать новую группу доступности для виртуальной машины в тот момент, когда создается первая виртуальная машина в группе. Если вы решили использовать для виртуальной машины Управляемые диски, то будет создана управляемая группа доступности.

![Снимок экрана, показывающий процесс создания группы доступности одновременно с созданием виртуальной машины.](./media/create-availability-set/new-vm-avail-set.png)

## <a name="add-a-new-vm-to-an-existing-availability-set-in-the-portal"></a>Добавление новой виртуальной машины в существующую группу доступности на портале
При создании каждой дополнительной виртуальной машины, которая должна входить в группу, убедитесь, что она создается в той же **группе ресурсов** , а затем выберите существующую группу доступности из шага 3. 

![Снимок экрана, показывающий, как выбирать существующую группу доступности для виртуальной машины.](./media/create-availability-set/add-vm-to-set.png)

## <a name="use-powershell-to-create-an-availability-set"></a>Создание группы доступности с помощью PowerShell
В этом примере создается группа доступности **myAvailabilitySet** в группе ресурсов **myResourceGroup**, находящейся в расположении **Западная часть США**. Это необходимо сделать до того, как в группе будет создана первая виртуальная машина.

Прежде чем начать, убедитесь, что у вас установлена последняя версия модуля PowerShell AzureRM.Compute. Выполните следующую команду, чтобы установить ее.

```powershell
Install-Module AzureRM.Compute -RequiredVersion 2.6.0
```
Дополнительные сведения см. в разделе [об управлении версиями Azure PowerShell](/powershell/azure/overview).


Если для виртуальных машин вы используете управляемые диски, введите следующую команду.

```powershell
    New-AzureRmAvailabilitySet -ResourceGroupName "myResourceGroup" '
    -Name "myAvailabilitySet" -Location "West US" -managed
```

Если вы используете для виртуальных машин собственные учетные записи хранения, введите следующую команду.

```powershell
    New-AzureRmAvailabilitySet -ResourceGroupName "myResourceGroup" '
    -Name "myAvailabilitySet" -Location "West US" 
```

Дополнительные сведения см. в разделе [New-AzureRmAvailabilitySet](/powershell/module/azurerm.compute/new-azurermavailabilityset).

## <a name="troubleshooting"></a>Устранение неполадок
* Если при создании виртуальной машины необходимая вам группа доступности отсутствует в раскрывающемся списке на портале, возможно, она была создана в другой группе ресурсов. Если вы не знаете, к какой группе ресурсов относится группа доступности, перейдите в главное меню и щелкните "Обзор" > "Группы доступности", чтобы просмотреть список групп доступности и соответствующие им группы ресурсов.

## <a name="next-steps"></a>Дальнейшие действия
Увеличьте емкость хранилища для виртуальной машины, добавив дополнительный [диск данных](attach-disk-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

