---
title: "aaaImpactful обслуживания для виртуальных машин Windows в Azure | Документы Microsoft"
description: "Обслуживание с перезапуском виртуальных машин Windows."
services: virtual-machines-windows
documentationcenter: 
author: zivr
manager: timlt
editor: 
tags: azure-service-management,azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 03/27/2017
ms.author: zivr
ms.openlocfilehash: 98afaea0fdca796177e075b33615b03f1e7a0fdc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="impactful-maintenance-for-virtual-machines"></a>Обслуживание с перезапуском виртуальных машин

Существует несколько случаев, где перезагрузке ВМ из-за toohello обслуживания tooplanned базовой инфраструктуры. Эффективная toothe доступности виртуальных машин, размещенных в Azure, hello следующие теперь доступны для вас toouse:

-   По крайней мере за 30 дней до влияние hello отправлено уведомление.

-   Видимость toohello обслуживания windows на каждой виртуальной Машине.

-   Гибкость и контроль при задании hello точное время для обслуживания влиять на виртуальные машины.

Обслуживание в Microsoft Azure выполняется в режиме итераций. Начальные итерации имеют меньшего размера области в порядке tooreduce hello риск в развертывании новых исправлений и возможности. Более поздние итерации могут охватывать несколько областей (не из hello одной паре региона). Виртуальная машина входит в одну итерацию обслуживания. Если итерация прерывается, то оставшиеся виртуальные машины будут включены в будущие итерации.

Hello планового обслуживания итерации включает два этапа: Pre-emptive периода обслуживания и расписание обслуживания.

Hello **периода обслуживания Pre-emptive** предоставляет hello гибкость tooinitiate hello обслуживания на виртуальные машины. Таким образом, можно определить, когда затронутых виртуальных машин, hello последовательность обновления hello и hello время между каждой виртуальной Машины поддерживается. Можно запросить каждой виртуальной Машины toosee ли запланировано обслуживание и проверьте hello результат последнего запроса инициируемых обслуживания.

Hello **запланированного периода обслуживания** при Azure запланировало виртуальные машины для обслуживания hello. Период времени, который приведен ниже упреждающие обслуживания, можно выполнять запросы для окна обслуживания hello, но больше не будет возможности tooorchestrate hello обслуживания.

## <a name="availability-considerations-during-planned-maintenance"></a>Вопросы доступности во время планового обслуживания 

### <a name="paired-regions"></a>Пары регионов

Каждый регион Azure связаны с другой области внутри hello же geography, вместе внесения региональные пары. При выполнении обслуживания, Azure будет обновлять только hello экземпляров виртуальных машин в одной области его пары. Например, при обновлении hello виртуальных машин в северо-центральной части США, Azure не обновит все виртуальные машины в центральных штатах юга США на hello то же время. Это обновление будет запланировано на отдельное время с включением отработки отказа или балансировки нагрузки между регионами. Однако другие области Северной Европе могут быть в режиме технического обслуживания на hello же время, что Восток США.
Узнайте больше о [парах регионов Azure](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).

### <a name="single-instance-vms-vs-availability-set-or-vm-scale-set"></a>Одноэкземплярные виртуальные машины, группы доступности и масштабируемый набор виртуальных машин

При развертывании рабочей нагрузки с использованием виртуальных машин в Azure, можно создать hello виртуальные машины в группу доступности в приложение tooyour заказов tooprovide высокого уровня доступности. Эта конфигурация обеспечит доступность по крайней мере одной виртуальной машины во время обслуживания или при сбое.

В группе доступности отдельные виртуальные машины распределены по too20 домены обновления. Во время планового обслуживания в конкретный момент времени всегда затрагивается только один домен обновления. порядок Hello понижает домены обновления не может производиться последовательно во время планового обслуживания. Для одного экземпляра ВМ (не часть набора доступности), то нет способа toopredict или определить, какой и сколько виртуальных машин затронуты друг с другом.

Наборы масштабирования виртуальных машин являются ресурсом вычислений Azure, позволяющая toodeploy и управление набором идентичные виртуальные машины как одного ресурса.
набор масштабирования Hello предоставляет аналогичные гарантии доступности tooan в форме домены обновления. 

Дополнительные сведения о настройке виртуальных машин высокой доступности см. в разделе [ *управлять доступностью виртуальных машин Windows hello*](../linux/manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

### <a name="scheduled-events"></a>Запланированные события

Служба Azure метаданных позволяет toodiscover сведения о вашей виртуальной машине, размещенной в Azure. Назначенные задания, одну из категорий предоставляемых hello, предоставляет доступ к информации о предстоящих событиях (например, перезагрузить), приложение можно подготовить для них и ограничить перебоев в работе.

Дополнительные сведения о запланированных событий см. в разделе слишком[служба метаданных Azure — запланированные события](../virtual-machines-scheduled-events.md).

## <a name="maintenance-discovery-and-notifications"></a>Видимость обслуживания и уведомления о нем

Расписание обслуживания является видимым toocustomers отдельных виртуальных машин на уровне hello. Можно использовать Azure portal, tooquery API, PowerShell или CLI для упреждающие и запланированного обслуживания windows. Кроме того, ожидается, что для получения уведомлений (электронной почты) в случае hello там, где один (или более) виртуальных машин затронуты во время процесса hello.

Этапы и упреждающего, и планового обслуживания начинаются с уведомления. Ожидается, что tooreceive одно уведомление на подписку Azure. Hello отправляется уведомление администратору и соадминистратору toohello подписки по умолчанию. Можно также настроить hello аудитории для обслуживания уведомления.

### <a name="view-hello-maintenance-window-in-hello-portal"></a>Просмотр портала hello hello периода обслуживания 

Можно использовать портал Azure hello и найдите виртуальные машины, запланированные для обслуживания.

1.  Войдите в систему toohello портал Azure.

2.  Выберите и откройте hello **виртуальные машины** колонку.

3.  Нажмите кнопку hello **столбцы** toochoose доступные столбцы из списка hello tooopen кнопки

4.  Выберите и добавьте hello **периода обслуживания** столбцов. Виртуальные машины, которые запланированы для обслуживания имеют периоды обслуживания hello отображена. После завершения или прерывания обслуживания окно обслуживания больше не отображается.

### <a name="query-maintenance-details-using-hello-azure-api"></a>Сведения об обслуживании запроса с помощью API-интерфейса Azure hello

Используйте hello [получить информацию о виртуальной Машины API](https://docs.microsoft.com/rest/api/compute/virtualmachines/virtualmachines-get) и выполните поиск hello экземпляр просмотрите toodiscover hello обслуживания сведения об отдельных виртуальных Машин. Hello ответ включает hello следующие элементы:

  - isCustomerInitiatedMaintenanceAllowed: означает ли теперь может инициировать упреждающие повторного развертывания на hello виртуальной Машины.

  - preMaintenanceWindowStartTime: hello время начала периода упреждающие обслуживания hello.

  - preMaintenanceWindowEndTime: hello время окончания периода упреждающие обслуживания hello. После этого времени не будет возможности tooinitiate обслуживания на этой виртуальной Машины.
    
  - maintenanceWindowStartTime: hello hello запланированного окна обслуживания время начала, когда ВМ затронуты.

  - maintenanceWindowEndTime: hello время окончания hello запланированного периода обслуживания.
  
  - lastOperationResultCode: hello результат последняя операция повторного развертывания обслуживания.
 
  - lastOperationMessage: описания hello результат последнего повторного развертывания обслуживания операции сообщения.

## <a name="pre-emptive-redeploy"></a>Упреждающее повторное развертывание

Повторное развертывание упреждающие действия предоставляет hello гибкость toocontrol hello время, когда обслуживание примененных tooyour ВМ в Azure. Плановое обслуживание начинается с периода обслуживания упреждающие решаете на hello точного времени для каждого из вашего toobe ВМ перезагрузки. Ниже приведены примеры использования, когда такая функциональность полезна:

-   Toobe необходимость обслуживания координируется с hello конечному клиенту.

-   Недостаточно Hello запланированного окна обслуживания службами Azure.
    Возможно, что окно hello происходит toobe на время максимальной загрузки hello недели или слишком велика.

-   Для нескольких экземпляров или многоуровневые приложения необходимо достаточно времени между двумя виртуальными машинами или определенных toofollow последовательности.

При вызове для упреждающие повторного развертывания на виртуальной Машине, он перемещает tooan hello виртуальной Машины уже обновлен узел и затем лежащих в основе его обратно на сохранение параметров конфигурации и связанных ресурсов. Хотя таким образом, hello временный диск не потеряны и обновляются динамические IP-адреса, связанные с виртуального сетевого интерфейса.

Упреждающее повторное развертывание выполняется один раз для каждой виртуальной машины. Если возникает ошибка во время процесса hello, hello операция отменяется, приветствия не влияет на виртуальной Машине и он исключается из итерации hello планового обслуживания. Необходимо обратиться в более позднее время с новым расписанием и предлагаемые новые возможности tooschedule и последовательности hello влияние на виртуальные машины.