---
title: "aaaDesign и реализуйте Oracle базы данных в Azure | Документы Microsoft"
description: "Разработка базы данных Oracle и ее реализация в среду Azure."
services: virtual-machines-linux
documentationcenter: virtual-machines
author: v-shiuma
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 6/22/2017
ms.author: rclaus
ms.openlocfilehash: 8fa1207458695df1c7330ec626888b1b6b8d8939
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="design-and-implement-an-oracle-database-in-azure"></a>Разработка базы данных Oracle и ее реализация в Azure

## <a name="assumptions"></a>Предположения

- Вы планируете toomigrate из tooAzure локальной базы данных Oracle.
- В отчетах Гарантийных Oracle различные метрики получить представление об hello.
- У вас есть базовое представление о производительности приложения и использовании платформы.

## <a name="goals"></a>Цели

- Понять, каким образом toooptimize Oracle развертывания в Azure.
- Изучить параметры настройки производительности для базы данных Oracle в среде Azure.

## <a name="hello-differences-between-an-on-premises-and-azure-implementation"></a>Здравствуйте, различия между локальной и реализации Azure 

Ниже приведены некоторые важные tookeep действия в виду при миграции локальных приложений tooAzure. 

Важным отличием является то, что при реализации в Azure ресурсы (например, виртуальные машины, диски и виртуальные сети) можно совместно использовать с другими клиентами. Кроме того ресурсы можно регулировать, в соответствии с требованиями hello. Вместо фокусирования на предотвращение сбоем (MTBF), Azure больше сосредоточен на оставшихся hello сбоя (MTTR).

Hello следующей таблице перечислены некоторые различия hello реализацию в локальной среде и Azure реализация базы данных Oracle.

> 
> |  | **Реализация в локальной среде** | **Реализация в Azure** |
> | --- | --- | --- |
> | **Сеть** |Локальная или глобальная сеть  |SDN (программно-конфигурируемая сеть)|
> | **Группа безопасности** |Средства ограничения портов и IP-адресов |[Группа безопасности сети](https://azure.microsoft.com/blog/network-security-groups) |
> | **Устойчивость** |MTBF (среднее время безотказной работы) |MTTR (среднее время toorecovery)|
> | **Плановое техническое обслуживание** |Установка исправлений и обновлений|[Группы доступности](https://docs.microsoft.com/azure/virtual-machines/windows/infrastructure-availability-sets-guidelines) (установка исправлений и обновлений, управляемая Azure) |
> | **Ресурс** |Выделенные  |Совместное использование с другими клиентами|
> | **Регионы** |Центры обработки данных |[Пары регионов](https://docs.microsoft.com/azure/virtual-machines/windows/regions-and-availability)|
> | **Хранилище** |Сеть SAN и физические диски |[Хранилище под управлением Azure](https://azure.microsoft.com/pricing/details/managed-disks/?v=17.23h)|
> | **Масштабирование** |Вертикальное масштабирование |Горизонтальное масштабирование|


### <a name="requirements"></a>Требования

- Определите hello базы данных размера и темпов роста.
- Определите требования hello операций ввода-ВЫВОДА, которые можно оценить на основе Oracle Гарантийных отчеты или другие средства сетевого мониторинга.

## <a name="configuration-options"></a>Варианты настройки

Существует четыре возможных области, можно настроить производительность tooimprove в среду Azure:

- размер виртуальной машины;
- Пропускная способность сети
- Типы дисков и их конфигурации
- Настройки кэша дисков.

### <a name="generate-an-awr-report"></a>Создание отчета AWR

Если есть существующий базы данных Oracle и планировании toomigrate tooAzure, есть несколько вариантов. Можно запустить hello Гарантийных Oracle отчетов tooget hello метрики (операции ввода-ВЫВОДА, Мбит/с, GiBs и т. д.). Затем выберите ВМ на основе hello собранными приветствия. Или вы можете связаться с вашей команды инфраструктуры tooget аналогичные сведения.

Вы можете запустить отчет AWR во время обычной и пиковой рабочей нагрузки, чтобы сравнить результаты. На основе этих отчетов, можно изменить размеры hello виртуальных машин на основании среднего hello рабочей нагрузки или hello максимальной рабочей нагрузки.

Ниже приведен пример того, как toogenerate гарантийные отчета:

```bash
$ sqlplus / as sysdba
SQL> EXEC DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT;
SQL> @?/rdbms/admin/awrrpt.sql
```

### <a name="key-metrics"></a>Ключевые метрики

Ниже приведены hello метрик, которые можно получить из hello Гарантийных отчета:

- общее число ядер;
- тактовая частота процессора;
- общий объем памяти в ГБ;
- загрузка ЦП;
- пиковая частота передачи данных;
- частота изменения числа операций ввода-вывода (чтение и запись);
- скорость записи в журнал повторяемых операций (Мбит/с);
- Пропускная способность сети
- показатель задержек сети (низкий и высокий уровень);
- размер базы данных (в ГБ);
- Байт, полученных через SQL * Net из / tooclient

### <a name="virtual-machine-size"></a>размер виртуальной машины;

#### <a name="1-estimate-vm-size-based-on-cpu-memory-and-io-usage-from-hello-awr-report"></a>1. Оценка размера виртуальной Машины на основе использования ЦП, памяти и ввода-вывода из hello Гарантийных отчета

Единственное, обратите внимание на — hello пять верхних синхронизированного переднего плана событий, указывающие, где находятся узкие места системы hello.

Например следующая схема hello, hello синхронизации файлов журнала при вверху hello. Он указывает hello число ожиданий, необходимые перед hello LGWR записывает повтора hello журнала буфера toohello файл журнала. Эти результаты указывают на то, что требуются более производительные диски или хранилище. Кроме того hello также показан hello количество ЦП (ядра) и hello объем памяти.

![Снимок экрана со страницей отчетов Гарантийных hello](./media/oracle-design/cpu_memory_info.png)

Hello следующая диаграмма показывает hello всего операций ввода-вывода чтения и записи. Было 59 чтения и 247.3 ГБ записи во время hello hello отчета.

![Снимок экрана со страницей отчетов Гарантийных hello](./media/oracle-design/io_info.png)

#### <a name="2-choose-a-vm"></a>2. Выбор виртуальной машины

На основе hello сведений, собираемых с hello Гарантийных отчета, hello следующим шагом является toochoose ВМ одинаковый размер, который соответствует вашим требованиям. Список доступных виртуальных машин можно найти в статье hello [оптимизированные для памяти](https://docs.microsoft.com/azure/virtual-machinFine tune es/virtual-machines-windows-sizes-memory).

#### <a name="3-fine-tune-hello-vm-sizing-with-a-similar-vm-series-based-on-hello-acu"></a>3. Оптимизировать hello размера виртуальной Машины с аналогичные Серия виртуальных Машин с учетом hello ACU

Сразу после выбора hello виртуальной Машины, обратите внимание toohello ACU для hello виртуальной Машины. Можно выбрать другой виртуальной Машины основании hello значение ACU, которая соответствует вашим требованиям. Дополнительные сведения см. в статье [Единицы вычислений Azure (ACU)](https://docs.microsoft.com/azure/virtual-machines/windows/acu).

![Снимок экрана со страницей единицы ACU hello](./media/oracle-design/acu_units.png)

### <a name="network-throughput"></a>Пропускная способность сети

Привет, следующая схема показывает hello отношение между пропускной способности и операций ввода-ВЫВОДА:

![Снимок экрана с показателями пропускной способности](./media/oracle-design/throughput.png)

пропускная способность сети общее Hello оценивается основании hello следующую информацию:
- объем трафика SQL*Net;
- Мбит/с x число серверов (исходящий поток, например Oracle Data Guard);
- другие факторы, такие как репликация приложений.

![Снимок экрана: hello SQL * Net пропускной способности](./media/oracle-design/sqlnet_info.png)

Зависимости от требований к пропускной способности сети, существуют различные типы шлюза для toochoose из. К ним относятся шлюзы категории "Базовый", VpnGw и Azure ExpressRoute. Дополнительные сведения см. в разделе hello [VPN-шлюз странице цен](https://azure.microsoft.com/en-us/pricing/details/vpn-gateway/?v=17.23h).

**рекомендации**;

- Задержки в сети находится выше по сравнению tooan локального развертывания. Сокращение круговых путей по сети существенно влияет на производительность.
- tooreduce циклов приема-передачи, консолидации приложений, которые имеют высокий уровень транзакции «нестабильной» приложений на hello одной виртуальной машине.

### <a name="disk-types-and-configurations"></a>Типы дисков и их конфигурации

- *Диски ОС по умолчанию.* Диски этого типа обеспечивают хранение постоянных данных и кэширование. Они оптимизированы для доступа к ОС при запуске и не предназначены для транзакционных рабочих нагрузок или рабочих нагрузок хранилищ данных (аналитических нагрузок).

- *Неуправляемые дисков*: В этих типов дисков, управление hello учетных записей хранилища, где хранятся файлы виртуального жесткого диска (VHD) hello, соответствующие tooyour дисков виртуальной Машины. VHD-файлы хранятся в учетных записях хранения Azure как страничные BLOB-объекты.

- *Управлять дисками*: Azure управляет hello учетных записей хранилища, используемого для дисков виртуальной Машины. Укажите тип диска hello (premium или standard) и размер hello hello диска, который требуется. Azure создает и управляет hello диска.

- *Диски хранилища класса Premium.* Диски этого типа лучше всего подходят для производственных рабочих нагрузок. Размер серии toospecific присоединенного Premium поддерживает VM диски, которые могут быть виртуальными машинами, такие как ВМ серии DS, серии DSv2, GS и F. диск premium Hello поставляется с разными размерами, и можно выбрать между дисками, начиная от too4 32 ГБ, 096 ГБ. Каждый из них имеет свои собственные характеристики производительности. В зависимости от требований приложения можно добавить один или несколько tooyour дисков виртуальной Машины.

При создании нового управляемого диска с портала hello, вы можете hello **тип счета** hello типу диска необходимо toouse. Имейте в виду, что не все доступные диски отображаются в раскрывающемся меню hello. После выбора определенного размера виртуальной Машины, меню hello отображение только hello доступной расширенной хранилища конфигураций, основанных на размер этой виртуальной Машины.

![Снимок экрана со страницей hello управляемого диска](./media/oracle-design/premium_disk01.png)

Дополнительные сведения см. в статье [High-performance Premium Storage and managed disks for VMs](https://docs.microsoft.com/azure/storage/storage-premium-storage) (Высокопроизводительное хранилище класса Premium и управляемые диски для виртуальных машин).

После настройки хранилища на виртуальной Машине, перед созданием базы данных может потребоваться tooload теста hello дисков. Зная, что hello скорость ввода-вывода с точки зрения задержки и пропускной способности может помочь определить, если виртуальные машины hello поддерживает hello ожидается пропускной способности с задержкой целевых объектов.

Есть несколько средств для нагрузочного тестирования приложения, например Oracle Orion, Sysbench и Fio.

Снова запустите hello нагрузочного теста после развертывания базы данных Oracle. Запустите обычных и пиковых рабочих нагрузок и hello результаты показывают hello базовой среды.

Это может быть более важным хранилище hello toosize на основании hello скорость операций ввода-ВЫВОДА, а не размер хранилища hello. Например при необходимости hello операций ввода-ВЫВОДА — 5000, но требуется только 200 ГБ вы по-прежнему получить hello P30 класса premium диска несмотря на то, что он поступает с более чем 200 ГБ хранилища.

скорость операций ввода-ВЫВОДА Hello можно получить из отчетов Гарантийных hello. Определяется журнала повторяемых операций hello, физических операций чтения и записи степень.

![Снимок экрана со страницей отчетов Гарантийных hello](./media/oracle-design/awr_report.png)

Например hello повтора составляет 12,200,000 байт в секунду, что равно too11.63 Мбит/с.
Hello операций ввода-ВЫВОДА — 12,200,000 / 2,358 = 5,174.

После того как вы четкое представление о hello требования ввода-вывода, можно выбрать сочетание дисков, которые являются наилучшим образом подходит toomeet этим требованиям.

**рекомендации**;

- Для табличного пространства данных распределены рабочей нагрузки ввода-вывода hello число дисков с помощью управляемого хранилища или Oracle ASM.
- С увеличением размера блока hello ввода-вывода для операций с высокой интенсивностью чтения и записи интенсивно, добавьте дополнительные диски с данными.
- Увеличьте размер блока hello для больших последовательных процессов.
- Используйте ввод-вывод tooreduce сжатия данных (данные и индексы).
- Используйте отдельные диски данных для журналов повторяемых операций, а также табличного пространства system, temp и undo.
- Не размещайте файлы приложений на дисках операционной системы по умолчанию (/dev/sda). Эти диски не оптимизированы для быстрой загрузки виртуальной машины и не могут обеспечить высокую производительность приложений.

### <a name="disk-cache-settings"></a>Настройки кэша дисков.

Существует три варианта кэширования узла:

- *Только для чтения:* все запросы кэшируются для операций чтения в будущем. Все операции записи сохраняются непосредственно tooAzure хранилища больших двоичных объектов.

- *Чтение и запись:* это алгоритм упреждающего чтения. Hello считывает и записывает находятся в кэше для будущих операций чтения. Операции записи не записи через сохранить toohello локального кэша. Для SQL Server записывает не сохраненного tooAzure хранилища, поскольку она использует сквозной записи. Он также предоставляет hello Наименьшая задержка диска светлой рабочих нагрузок.

- *Нет* (отключено): С помощью этого параметра, вы можете обойти hello кэша. Все данные hello переносятся toodisk и сохраняется tooAzure хранилища. Это метод дает hello место интенсивности ввода-вывода для рабочих нагрузок с большим объемом операций ввода-вывода. Необходимо также tootake «стоимость транзакции» в расчет.

**рекомендации**;

пропускная способность hello toomaximize, мы рекомендуем начать работу с **нет** для кэширования узла. Для хранения Premium, следует учитывать, необходимо отключить барьеры «hello» при подключении hello файловой системы с hello **ReadOnly** или **нет** параметры. Измените файл/etc/fstab hello hello UUID toohello дисков.

Дополнительные сведения см. в разделе [Хранилище класса Premium для виртуальных машин Linux](https://docs.microsoft.com/azure/storage/storage-premium-storage#premium-storage-for-linux-vms).

![Снимок экрана со страницей hello управляемого диска](./media/oracle-design/premium_disk02.png)

- Для дисков операционной системы используйте кэширование **Чтение и запись** по умолчанию.
- Для кэширования SYSTEM, TEMP и UNDO используйте параметр **Нет**.
- Для кэширования DATA используйте параметр **Нет**. Но если база данных предназначена только для чтения или интенсивного чтения, используйте кэширование **Только для чтения**.

После сохранения настроек диск данных выбрать параметр кэширования узла hello отключить диск hello на уровне ОС hello и затем снова подключить после внесения изменения hello.


## <a name="security"></a>Безопасность

После установки и настройки среды Azure hello следующим шагом является toosecure вашей сети. Вот несколько рекомендаций.

- *Политика NSG:* NSG можно определить для подсети или сетевого адаптера. Это более простой toocontrol доступ на уровне подсети hello для безопасности и маршрутизации force для таких вещей, как приложение брандмауэры.

- *Jumpbox*: для более безопасного доступа, администраторы не должна подключаться напрямую toohello приложения службы или базы данных. Jumpbox используется в качестве носителя между hello администратор компьютера и ресурсов Azure.
![Снимок экрана со страницей топологии Jumpbox hello](./media/oracle-design/jumpbox.png)

    Hello администратора машины должны обеспечивать только jumpbox toohello IP ограниченного доступа. Hello jumpbox должна иметь доступ toohello приложения и базы данных.

- *Частная сеть* (подсети): рекомендуется наличие службы приложения hello и базы данных в разных подсетях, чтобы можно было задать улучшенное управление политикой NSG.


## <a name="additional-reading"></a>Дополнительные материалы

- [Настройка Oracle ASM](configure-oracle-asm.md)
- [Реализация Oracle Data Guard на виртуальной машине Azure под управлением Linux](configure-oracle-dataguard.md)
- [Реализация Oracle Golden Gate на виртуальной машине Azure под управлением Linux](configure-oracle-golden-gate.md)
- [Создание резервных копий и восстановление базы данных Oracle Database 12c на виртуальной машине Linux в Azure](oracle-backup-recovery.md)

## <a name="next-steps"></a>Дальнейшие действия

- Изучите [руководство по созданию высокодоступных виртуальных машин](../../linux/create-cli-complete.md).
- [Изучите примеры развертывания виртуальных машин с помощью интерфейса командной строки](../../linux/cli-samples.md).
