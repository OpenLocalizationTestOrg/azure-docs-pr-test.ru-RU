---
title: "Инфраструктура и подключение к SAP HANA в Azure (крупные экземпляры) | Документация Майкрософт"
description: "Настройте требуемую инфраструктуру для подключения, чтобы использовать SAP HANA в Azure (крупные экземпляры)."
services: virtual-machines-linux
documentationcenter: 
author: RicksterCDN
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 12/01/2016
ms.author: rclaus
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 177627d8f72dbd04fb918ac7ece18321246a9c62
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="sap-hana-large-instances-infrastructure-and-connectivity-on-azure"></a><span data-ttu-id="0ac47-103">Инфраструктура и возможности подключения SAP HANA в Azure (крупные экземпляры)</span><span class="sxs-lookup"><span data-stu-id="0ac47-103">SAP HANA (large instances) infrastructure and connectivity on Azure</span></span> 

<span data-ttu-id="0ac47-104">В этом руководстве используются некоторые общие определения. Ознакомьтесь с ними, прежде чем приступать к изучению руководства.</span><span class="sxs-lookup"><span data-stu-id="0ac47-104">Some definitions upfront before reading this guide.</span></span> <span data-ttu-id="0ac47-105">В статье [Обзор и описание архитектуры SAP HANA в Azure (крупные экземпляры)](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture) мы представили два разных класса единиц крупных экземпляров HANA с:</span><span class="sxs-lookup"><span data-stu-id="0ac47-105">In [SAP HANA (large instances) overview and architecture on Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture) we introduced two different classes of HANA Large Instance units with:</span></span>

- <span data-ttu-id="0ac47-106">S72, S72m, S144, S144m, S192 и S192m, которые обычно называются номерами SKU 1 класса;</span><span class="sxs-lookup"><span data-stu-id="0ac47-106">S72, S72m, S144, S144m, S192, and S192m, which we refer to as the 'Type I class' of SKUs.</span></span>
- <span data-ttu-id="0ac47-107">S384, S384m, S384xm, S576, S768 и S960, которые обычно называются номерами SKU 2 класса.</span><span class="sxs-lookup"><span data-stu-id="0ac47-107">S384, S384m, S384xm, S576, S768, and S960, which we refer to as the 'Type II class' of SKUs.</span></span>

<span data-ttu-id="0ac47-108">В документации по крупным экземплярам HANA описатели классов будут использоваться для ссылки на различные возможности и требования, основанные на номерах SKU крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-108">The class specifiers are going to be used throughout the HANA Large Instance documentation to eventually refer to different capabilities and requirements based on HANA Large Instance SKUs.</span></span>

<span data-ttu-id="0ac47-109">Кроме того, часто используются следующие определения.</span><span class="sxs-lookup"><span data-stu-id="0ac47-109">Other definitions we use frequently are:</span></span>
- <span data-ttu-id="0ac47-110">**Стек крупных экземпляров:** сертифицированный для программы SAP HANA TDI аппаратный стек, предназначенный для запуска экземпляров SAP HANA в Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-110">**Large Instance stamp:** A hardware infrastructure stack that is SAP HANA TDI certified and dedicated to run SAP HANA instances within Azure.</span></span>
- <span data-ttu-id="0ac47-111">**SAP HANA в Azure (крупные экземпляры):** официальное название предложения в Azure, предусматривающее запуск экземпляров SAP HANA на оборудовании, сертифицированном для программы SAP HANA TDI, которые развертываются в стеках крупных экземпляров в разных регионах Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-111">**SAP HANA on Azure (Large Instances):** Official name for the offer in Azure to run HANA instances in on SAP HANA TDI certified hardware that is deployed in Large Instance stamps in different Azure regions.</span></span> <span data-ttu-id="0ac47-112">Связанный термин **крупные экземпляры HANA** — сокращенное название SAP HANA в Azure (крупные экземпляры), которое широко используется в этом техническом руководстве по развертыванию.</span><span class="sxs-lookup"><span data-stu-id="0ac47-112">The related term **HANA Large Instance** is short for SAP HANA on Azure (Large Instances) and is widely used this technical deployment guide.</span></span>
 

<span data-ttu-id="0ac47-113">После завершения процесса покупки SAP HANA в Azure (крупные экземпляры) со службой поддержки корпоративных учетных записей Майкрософт необходимо указать следующие сведения, чтобы специалисты Майкрософт развернули единицы крупных экземпляров HANA:</span><span class="sxs-lookup"><span data-stu-id="0ac47-113">After the purchase of SAP HANA on Azure (Large Instances) is finalized between you and the Microsoft enterprise account team, the following information is required by Microsoft to deploy HANA Large Instance Units:</span></span>

- <span data-ttu-id="0ac47-114">Имя клиента.</span><span class="sxs-lookup"><span data-stu-id="0ac47-114">Customer name</span></span>
- <span data-ttu-id="0ac47-115">Корпоративные контактные сведения (адрес электронной почты и номер телефона).</span><span class="sxs-lookup"><span data-stu-id="0ac47-115">Business contact information (including e-mail address and phone number)</span></span>
- <span data-ttu-id="0ac47-116">Технические контактные сведения (адрес электронной почты и номер телефона).</span><span class="sxs-lookup"><span data-stu-id="0ac47-116">Technical contact information (including e-mail address and phone number)</span></span>
- <span data-ttu-id="0ac47-117">Технические сетевые контактные сведения (адрес электронной почты и номер телефона).</span><span class="sxs-lookup"><span data-stu-id="0ac47-117">Technical networking contact information (including e-mail address and phone number)</span></span>
- <span data-ttu-id="0ac47-118">Регион развертывания Azure (запад США, восток США, Восточная Австралия, Юго-Восточная Австралия, Западная Европа и Северная Европа, начиная с июля</span><span class="sxs-lookup"><span data-stu-id="0ac47-118">Azure deployment region (West US, East US, Australia East, Australia Southeast, West Europe, and North Europe as of July</span></span> 
- 2017)
- <span data-ttu-id="0ac47-119">Подтверждение номера SKU SAP HANA в Azure (крупные экземпляры) (конфигурация).</span><span class="sxs-lookup"><span data-stu-id="0ac47-119">Confirm SAP HANA on Azure (Large Instances) SKU (configuration)</span></span>
- <span data-ttu-id="0ac47-120">Как уже упоминалось в документах с общими сведениями и данными об архитектуре, крупные экземпляры HANA для каждого региона Azure развертываются в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="0ac47-120">As already detailed in the Overview and Architecture document for HANA Large Instances, for every Azure Region being deployed to:</span></span>
    - <span data-ttu-id="0ac47-121">диапазон IP-адресов с маской /29 для подключений ER-P2P между виртуальными сетями Azure и крупными экземплярами HANA;</span><span class="sxs-lookup"><span data-stu-id="0ac47-121">A /29 IP address range for ER-P2P Connections that connect Azure VNets to HANA Large Instances</span></span>
    - <span data-ttu-id="0ac47-122">блок CIDR с маской /24 (используется для пула NAT крупных экземпляров HANA).</span><span class="sxs-lookup"><span data-stu-id="0ac47-122">A /24 CIDR Block used for the HANA Large Instances Server IP Pool</span></span>
- <span data-ttu-id="0ac47-123">Значения диапазона IP-адресов, используемые в атрибуте адресного пространства виртуальной сети, каждой виртуальной сети Azure, которая будет подключаться к крупным экземплярам HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-123">The IP address range values used in the VNet Address Space attribute of every Azure VNet that connects to the HANA Large Instances</span></span>
- <span data-ttu-id="0ac47-124">Данные для каждой системы крупных экземпляров HANA:</span><span class="sxs-lookup"><span data-stu-id="0ac47-124">Data for each of HANA Large Instances system:</span></span>
  - <span data-ttu-id="0ac47-125">Требуемое имя узла (в идеале с полным доменным именем).</span><span class="sxs-lookup"><span data-stu-id="0ac47-125">Desired hostname - ideally with fully qualified domain name.</span></span>
  - <span data-ttu-id="0ac47-126">Требуемый IP-адрес для единицы крупного экземпляра HANA вне диапазона IP-адресов пула серверов. Помните, что первые 30 IP-адресов в диапазоне IP-адресов пула серверов зарезервированы для внутреннего использования в крупных экземплярах HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-126">Desired IP address for the HANA Large Instance unit out of the Server IP Pool address range - Keep in mind that the first 30 IP addresses in the Server IP Pool address range are reserved for internal usage within HANA Large Instances</span></span>
  - <span data-ttu-id="0ac47-127">Имя ИД безопасности SAP HANA для экземпляра SAP HANA (требуется для создания необходимых томов дисков SAP HANA).</span><span class="sxs-lookup"><span data-stu-id="0ac47-127">SAP HANA SID name for the SAP HANA instance (required to create the necessary SAP HANA-related disk volumes).</span></span> <span data-ttu-id="0ac47-128">ИД безопасности HANA необходим для создания разрешений для <sidadm> на томах NFS, которые присоединяются к единице крупного экземпляра HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-128">The HANA SID is required for creating the permissions for <sidadm> on the NFS volumes, which are getting attached to the HANA Large Instance unit.</span></span> <span data-ttu-id="0ac47-129">Он также используется как один из компонентов имени подключаемых томов на диске.</span><span class="sxs-lookup"><span data-stu-id="0ac47-129">It also is used as one of the name components of the disk volumes that get mounted.</span></span> <span data-ttu-id="0ac47-130">Для запуска более одного экземпляра HANA на одной единице необходимо перечислить несколько идентификаторов безопасности HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-130">If you want to run more than one HANA instance on the unit, you need to list multiple HANA SIDs.</span></span> <span data-ttu-id="0ac47-131">Каждый из них возвращает отдельный набор назначенных томов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-131">Each one gets a separate set of volumes assigned.</span></span>
  - <span data-ttu-id="0ac47-132">Идентификатор группы пользователя hana-sidadm в ОС Linux требуется для создания томов диска, связанных с SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-132">The groupid the hana-sidadm user has in the Linux OS is required to create the necessary SAP HANA-related disk volumes.</span></span> <span data-ttu-id="0ac47-133">При установке SAP HANA обычно создается группа sapsys с идентификатором группы 1001,</span><span class="sxs-lookup"><span data-stu-id="0ac47-133">The SAP HANA installation usually creates the sapsys group with a group id of 1001.</span></span> <span data-ttu-id="0ac47-134">в которую входит пользователь hana-sidadm.</span><span class="sxs-lookup"><span data-stu-id="0ac47-134">The hana-sidadm user is part of that group</span></span>
  - <span data-ttu-id="0ac47-135">Идентификатор пользователя hana-sidadm в ОС Linux требуется для создания томов диска, связанных с SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-135">The userid the hana-sidadm user has in the Linux OS is required to create the necessary SAP HANA-related disk volumes.</span></span> <span data-ttu-id="0ac47-136">Если на одной единице запущено несколько экземпляров HANA, необходимо перечислить всех администраторов <sid></span><span class="sxs-lookup"><span data-stu-id="0ac47-136">If you are running multiple HANA instances on the unit, you need to list all the <sid>adm users</span></span> 
- <span data-ttu-id="0ac47-137">Идентификатор подписки Azure, к которой будет напрямую подключаться SAP HANA в Azure (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-137">Azure subscription ID for the Azure subscription to which SAP HANA on Azure HANA Large Instances are going to be directly connected.</span></span> <span data-ttu-id="0ac47-138">Этот идентификатор подписки ссылается на подписку Azure, которая будет связана с единицами HANA (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-138">This subscription ID references the Azure subscription, which is going to be charged with the HANA Large Instance unit(s).</span></span>

<span data-ttu-id="0ac47-139">После того как вы предоставите сведения, специалисты Майкрософт подготовят SAP HANA в Azure (крупные экземпляры) и отправят вам сведения, необходимые для связывания ваших виртуальных сетей Azure с крупными экземплярами HANA и доступа к единицам крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-139">After you provide the information, Microsoft provisions SAP HANA on Azure (Large Instances) and will return the information necessary to link your Azure VNets to HANA Large Instances and to access the HANA Large Instance units.</span></span>

## <a name="connecting-azure-vms-to-hana-large-instances"></a><span data-ttu-id="0ac47-140">Подключение виртуальных машин Azure к крупным экземплярам HANA</span><span class="sxs-lookup"><span data-stu-id="0ac47-140">Connecting Azure VMs to HANA Large Instances</span></span>

<span data-ttu-id="0ac47-141">Как уже упоминалось в статье [Обзор и описание архитектуры SAP HANA в Azure (крупные экземпляры)](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture), минимальное развертывание крупных экземпляров HANA с уровнем приложений SAP в Azure выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0ac47-141">As already mentioned in [SAP HANA (large instances) overview and architecture on Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture) the minimal deployment of HANA Large Instances with the SAP application layer in Azure looks like:</span></span>

![Виртуальная сеть Azure подключена к SAP HANA в Azure (крупные экземпляры) и к локальной сети](./media/hana-overview-architecture/image3-on-premises-infrastructure.png)

<span data-ttu-id="0ac47-143">Обратите внимание на виртуальную сеть Azure. Для нее требуется следующее:</span><span class="sxs-lookup"><span data-stu-id="0ac47-143">Looking closer on the Azure VNet side, we realize the need for:</span></span>

- <span data-ttu-id="0ac47-144">Определение виртуальной сети Azure, которое будет использоваться для развертывания виртуальных машин на уровне приложений SAP.</span><span class="sxs-lookup"><span data-stu-id="0ac47-144">The definition of an Azure VNet that is going to be used to deploy the VMs of the SAP application layer into.</span></span>
- <span data-ttu-id="0ac47-145">Это автоматически означает, что в виртуальной сети Azure определяется подсеть по умолчанию, в которой будут фактически развернуты виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="0ac47-145">That automatically means that a default subnet in the Azure Vnet is defined that is really the one used to deploy the VMs into.</span></span>
- <span data-ttu-id="0ac47-146">В создаваемой виртуальной сети Azure должна быть по крайней мере одна подсеть виртуальной машины и одна подсеть шлюза для ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-146">The Azure VNet that's created needs to have at least one VM subnet and one ExpressRoute Gateway subnet.</span></span> <span data-ttu-id="0ac47-147">Таким подсетям нужно назначить диапазоны IP-адресов в соответствии со сведениями, указанными в разделах ниже.</span><span class="sxs-lookup"><span data-stu-id="0ac47-147">These subnets should be assigned the IP address ranges as specified and discussed in the following sections.</span></span>

<span data-ttu-id="0ac47-148">Итак, давайте подробнее рассмотрим создание виртуальной сети Azure для крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-148">So, let's look a bit closer into the Azure VNet creation for HANA Large Instances</span></span>

### <a name="creating-the-azure-vnet-for-hana-large-instances"></a><span data-ttu-id="0ac47-149">Создание виртуальной сети Azure для крупных экземпляров HANA</span><span class="sxs-lookup"><span data-stu-id="0ac47-149">Creating the Azure VNet for HANA Large Instances</span></span>

>[!Note]
><span data-ttu-id="0ac47-150">Эту виртуальную сеть Azure для крупных экземпляров HANA следует создавать с использованием модели развертывания с помощью Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="0ac47-150">The Azure VNet for HANA Large Instance must be created using the Azure Resource Manager deployment model.</span></span> <span data-ttu-id="0ac47-151">Крупные экземпляры HANA не поддерживают старую модель развертывания Azure, известную как классическая модель развертывания.</span><span class="sxs-lookup"><span data-stu-id="0ac47-151">The older Azure deployment model, commonly known as classic deployment model, is not supported with the HANA Large Instance solution.</span></span>

<span data-ttu-id="0ac47-152">Виртуальную сеть можно создать с помощью портала Azure, PowerShell, шаблона Azure или Azure CLI (см. статью [Создание виртуальной сети с помощью портала Azure](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)).</span><span class="sxs-lookup"><span data-stu-id="0ac47-152">The VNet can be created using the Azure portal, PowerShell, Azure template, or Azure CLI (see [Create a virtual network using the Azure portal](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)).</span></span> <span data-ttu-id="0ac47-153">В следующем примере мы рассмотрим виртуальную сеть, созданную с помощью портала Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-153">In the following example, we look into a VNet created through the Azure portal.</span></span>

<span data-ttu-id="0ac47-154">Просматривая определения виртуальной сети Azure на портале Azure, давайте обратим внимание на некоторые определения и их взаимосвязь с перечисленными ниже различными диапазонами IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-154">If we look into the definitions of an Azure VNet through the Azure portal, let's look into some of the definitions and how those relate to what we list of different IP address ranges.</span></span> <span data-ttu-id="0ac47-155">Говоря об **адресном пространстве**, мы имеем в виду адресное пространство, которое разрешено использовать виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-155">As we are talking about the **Address Space**, we mean the address space that the Azure VNet is allowed to use.</span></span> <span data-ttu-id="0ac47-156">Оно будет использоваться в виртуальной сети для распространения маршрутов BGP.</span><span class="sxs-lookup"><span data-stu-id="0ac47-156">This address space is also the address range that the VNet uses for BGP route propagation.</span></span> <span data-ttu-id="0ac47-157">Это **адресное пространство** можно увидеть здесь:</span><span class="sxs-lookup"><span data-stu-id="0ac47-157">This **Address Space** can be seen here:</span></span>

![Адресное пространство виртуальной сети Azure на портале Azure](./media/hana-overview-connectivity/image1-azure-vnet-address-space.png)

<span data-ttu-id="0ac47-159">В предыдущем случае пространству адресов 10.16.0.0/16 виртуальной сети Azure назначен достаточно большой диапазон IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-159">In the case preceding, with 10.16.0.0/16, the Azure VNet was given a rather large and wide IP address range to use.</span></span> <span data-ttu-id="0ac47-160">Это значит, что все диапазоны IP-адресов последующих подсетей в виртуальной сети могут входить в указанное адресное пространство.</span><span class="sxs-lookup"><span data-stu-id="0ac47-160">Means all the IP address ranges of subsequent subnets within this VNet can have their ranges within that 'Address Space'.</span></span> <span data-ttu-id="0ac47-161">Обычно мы не рекомендуем использовать настолько большой диапазон адресов для одной виртуальной сети в Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-161">Usually we are not recommending such a large address range for single VNet in Azure.</span></span> <span data-ttu-id="0ac47-162">Однако давайте заглянем немного наперед и посмотрим подсети, определенные в виртуальной сети Azure:</span><span class="sxs-lookup"><span data-stu-id="0ac47-162">But getting a step further, let's look into the subnets defined in the Azure VNet:</span></span>

![Подсети виртуальной сети Azure и их IP-адреса](./media/hana-overview-connectivity/image2b-vnet-subnets.png)

<span data-ttu-id="0ac47-164">Как видно, создана виртуальная сеть с первой подсетью виртуальной машины (default) и подсеть GatewaySubnet.</span><span class="sxs-lookup"><span data-stu-id="0ac47-164">As you can see, we look at a VNet with a first VM subnet (here called 'default') and a subnet called 'GatewaySubnet'.</span></span>
<span data-ttu-id="0ac47-165">В следующем разделе мы будем называть диапазон IP-адресов подсети default на снимке экрана **диапазоном IP-адресов подсети виртуальной машины Azure**,</span><span class="sxs-lookup"><span data-stu-id="0ac47-165">In the following section, we refer to the IP address range of the subnet, which was called 'default' in the graphics as **Azure VM subnet IP address range**.</span></span> <span data-ttu-id="0ac47-166">а диапазон IP-адресов подсети шлюза — **диапазоном IP-адресов подсети шлюза виртуальной сети**.</span><span class="sxs-lookup"><span data-stu-id="0ac47-166">In the following sections, we refer to the IP address range of the Gateway Subnet as **VNet Gateway Subnet IP address range**.</span></span> 

<span data-ttu-id="0ac47-167">В случае выше на двух снимках экрана можно увидеть, что в **адресное пространство виртуальной сети** входит **диапазон IP-адресов подсети виртуальной машины Azure** и **диапазон IP-адресов подсети шлюза виртуальной сети**.</span><span class="sxs-lookup"><span data-stu-id="0ac47-167">In the case demonstrated by the two graphics above, you see that the **VNet Address Space** covers both, the **Azure VM subnet IP address range** and the **VNet Gateway Subnet IP address range**.</span></span> 

<span data-ttu-id="0ac47-168">В других случаях, где необходимо сохранить диапазоны IP-адресов или использовать определенные диапазоны, можно ограничить **адресное пространство виртуальной сети** определенными диапазонами, используемыми каждой подсетью.</span><span class="sxs-lookup"><span data-stu-id="0ac47-168">In other cases where you need to conserve or be specific with your IP address ranges, you can restrict the **VNet Address Space** of a VNet to the specific ranges being used by each subnet.</span></span> <span data-ttu-id="0ac47-169">В этом случае **адресное пространство виртуальной сети** можно определить как несколько конкретных диапазонов, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="0ac47-169">In this case, you can define the **VNet Address Space** of a VNet as multiple specific ranges as shown here:</span></span>

![Адресное пространство виртуальной сети Azure в качестве двух пространств](./media/hana-overview-connectivity/image3-azure-vnet-address-space_alternate.png)

<span data-ttu-id="0ac47-171">В этом случае для **адресного пространства виртуальной сети** определено два пространства,</span><span class="sxs-lookup"><span data-stu-id="0ac47-171">In this case, the **VNet Address Space** has two spaces defined.</span></span> <span data-ttu-id="0ac47-172">идентичных диапазонам IP-адресов, определенным для **диапазона IP-адресов подсети виртуальной машины Azure** и **диапазона IP-адресов подсети шлюза виртуальной сети**.</span><span class="sxs-lookup"><span data-stu-id="0ac47-172">These two spaces, are identical to the IP address ranges defined for **Azure VM subnet IP address range** and the **VNet Gateway Subnet IP address range.**</span></span>

<span data-ttu-id="0ac47-173">Для этих подсетей клиента (подсетей виртуальной машины) можно использовать любой стандарт именования.</span><span class="sxs-lookup"><span data-stu-id="0ac47-173">You can use any naming standard you like for these tenant subnets (VM subnets).</span></span> <span data-ttu-id="0ac47-174">Тем не менее **каждой виртуальной подсети должна соответствовать только одна подсеть шлюза**, подключающаяся к каналу ExpressRoute для SAP HANA в Azure (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-174">However, **there must always be one, and only one, gateway subnet for each VNet** that connects to the SAP HANA on Azure (Large Instances) ExpressRoute circuit.</span></span> <span data-ttu-id="0ac47-175">**Эту подсеть шлюза нужно называть GatewaySubnet**, чтобы обеспечить правильное размещение шлюза ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-175">And **this gateway subnet must always be named "GatewaySubnet"** to ensure proper placement of the ExpressRoute gateway.</span></span>

> [!WARNING] 
> <span data-ttu-id="0ac47-176">Крайне важно, чтобы подсеть шлюза называлась GatewaySubnet.</span><span class="sxs-lookup"><span data-stu-id="0ac47-176">It is critical that the gateway subnet always is named "GatewaySubnet."</span></span>

<span data-ttu-id="0ac47-177">Вы можете использовать несколько подсетей виртуальной машины, даже при применении несмежных адресов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-177">Multiple VM subnets may be used, even utilizing non-contiguous address ranges.</span></span> <span data-ttu-id="0ac47-178">Однако, как упоминалось ранее, эти диапазоны адресов должны входить в **адресное пространство виртуальной сети** и указываться в сводной форме или в списке точных диапазонов подсетей виртуальной машины и подсети шлюза.</span><span class="sxs-lookup"><span data-stu-id="0ac47-178">But as mentioned previously, these address ranges must be covered by the **VNet Address Space** of the VNet either in aggregated form or in a list of the exact ranges of the VM subnets and the gateway subnet.</span></span>

<span data-ttu-id="0ac47-179">Ниже представлены важные факты о виртуальной сети Azure, которая подключается к крупным экземплярам HANA:</span><span class="sxs-lookup"><span data-stu-id="0ac47-179">Summarizing the important fact about an Azure VNet that connects to HANA Large Instances:</span></span>

- <span data-ttu-id="0ac47-180">При выполнении первоначального развертывания больших экземпляров HANA необходимо отправить **адресное пространство виртуальной сети** в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-180">You need to submit to Microsoft the **VNet Address Space** when performing an initial deployment of HANA Large Instances.</span></span> 
- <span data-ttu-id="0ac47-181">**Адресное пространство адресов виртуальной сети** может представлять собой один большой диапазон, охватывающий диапазоны IP-адресов подсети виртуальной машины Azure и диапазон IP-адресов подсети шлюза,</span><span class="sxs-lookup"><span data-stu-id="0ac47-181">The **VNet Address Space** can be one larger range that covers the range for Azure VM subnet IP address range(s) and the VNet Gateway Subnet IP address range.</span></span>
- <span data-ttu-id="0ac47-182">или несколько диапазонов, **охватывающих разные** диапазоны IP-адресов в пределах диапазонов IP-адресов подсети виртуальной машины и диапазона IP-адресов подсети шлюза.</span><span class="sxs-lookup"><span data-stu-id="0ac47-182">Or you can submit as **VNet Address Space** multiple ranges that cover the different IP address ranges of VM subnet IP address range(s) and the VNet Gateway Subnet IP address range.</span></span>
- <span data-ttu-id="0ac47-183">Определенное **адресное пространство виртуальной сети** используется для распространения маршрутов BGP.</span><span class="sxs-lookup"><span data-stu-id="0ac47-183">The defined **VNet Address Space** is used BGP routing propagation.</span></span>
- <span data-ttu-id="0ac47-184">Для подсети шлюза должно использоваться имя **GatewaySubnet**.</span><span class="sxs-lookup"><span data-stu-id="0ac47-184">The name of the Gateway subnet must be: **"GatewaySubnet."**</span></span>
- <span data-ttu-id="0ac47-185">**Адресное пространство виртуальной сети** используется в качестве фильтра на стороне крупных экземпляров HANA, чтобы разрешать или запрещать передачу трафика к единицам крупных экземпляров HANA из Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-185">The **VNet Address Space** is used as a filter on the HANA Large Instance side to allow or disallow traffic to the HANA Large Instance units from Azure.</span></span> <span data-ttu-id="0ac47-186">Если сведения о маршрутах BGP виртуальной сети Azure и диапазонах IP-адресов, настроенных для фильтрации на стороне крупных экземпляров HANA, не совпадают, могут возникнуть проблемы с подключением.</span><span class="sxs-lookup"><span data-stu-id="0ac47-186">If the BGP routing information of the Azure VNet and the IP address ranges configured for filtering on the HANA Large Instance side do not match, issues in connectivity can arise.</span></span>
- <span data-ttu-id="0ac47-187">В разделе "Подключение виртуальной сети к каналу ExpressRoute крупных экземпляров HANA" ниже указаны некоторые дополнительные сведения о подсети шлюза.</span><span class="sxs-lookup"><span data-stu-id="0ac47-187">There are some details about the Gateway subnet that are discussed further down in Section 'Connecting a VNet to HANA Large Instance ExpressRoute'</span></span>



### <a name="different-ip-address-ranges-to-be-defined"></a><span data-ttu-id="0ac47-188">Определение разных диапазонов IP-адресов</span><span class="sxs-lookup"><span data-stu-id="0ac47-188">Different IP address ranges to be defined</span></span> 

<span data-ttu-id="0ac47-189">В предыдущих разделах мы уже рассмотрели некоторые диапазоны IP-адресов, необходимые для развертывания крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-189">We already introduced some of the IP address ranges necessary to deploy HANA Large Instances in earlier sections.</span></span> <span data-ttu-id="0ac47-190">Однако стоит упомянуть и о других важных диапазонах IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-190">But there are some more IP address ranges, which are important.</span></span> <span data-ttu-id="0ac47-191">Давайте рассмотрим их подробнее.</span><span class="sxs-lookup"><span data-stu-id="0ac47-191">Let's go through some further details.</span></span> <span data-ttu-id="0ac47-192">Вам нужно определить следующие IP-адреса перед отправкой запроса на первоначальное развертывание (лишь некоторые из них нужно отправлять в корпорацию Майкрософт):</span><span class="sxs-lookup"><span data-stu-id="0ac47-192">The following IP addresses of which not all need to be submitted to Microsoft need to be defined, before sending a request for initial deployment:</span></span>

- <span data-ttu-id="0ac47-193">**Адресное пространство виртуальной сети** — это диапазон IP-адресов (как уже представлено выше), назначенный (или который планируется назначить) пространству адресов виртуальной сети Azure, которая подключается к среде крупных экземпляров SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-193">**VNet Address Space:** As already introduced earlier, is or are the IP address range(s) you have assigned (or plan to assign) to your address space parameter in the Azure Virtual Network(s) (VNet) connecting to the SAP HANA Large Instance environment.</span></span> <span data-ttu-id="0ac47-194">Мы рекомендуем, чтобы параметр адресного пространства использовался в качестве многострочного значения, состоящего из диапазонов подсети виртуальной машины Azure и диапазона подсети шлюза Azure, как показано на рисунке выше.</span><span class="sxs-lookup"><span data-stu-id="0ac47-194">It is recommended that this Address Space parameter is a multi-line value comprised of the Azure VM Subnet range(s) and the Azure Gateway subnet range as shown in the graphics earlier.</span></span> <span data-ttu-id="0ac47-195">Этот диапазон НЕ ДОЛЖЕН пересекаться с локальным диапазоном адресов, диапазоном IP-адресов пула серверов или с диапазоном адресов ER-P2P.</span><span class="sxs-lookup"><span data-stu-id="0ac47-195">This range must NOT overlap with your on-premise or Server IP Pool or ER-P2P address ranges.</span></span> <span data-ttu-id="0ac47-196">Как это можно осуществить?</span><span class="sxs-lookup"><span data-stu-id="0ac47-196">How to get this or these IP address range(s)?</span></span> <span data-ttu-id="0ac47-197">Специалисты по работе с корпоративными сетями или поставщик услуг должны предоставить один или несколько диапазонов IP-адресов в сети или вне ее.</span><span class="sxs-lookup"><span data-stu-id="0ac47-197">Your corporate network team or service provider should provide one or multiple IP Address Range(s), which is or are not used inside your network.</span></span> <span data-ttu-id="0ac47-198">Например, если используется подсеть виртуальной машины Azure 10.0.1.0/24 (см. выше) и подсеть шлюза Azure 10.0.2.0/28 (см. ниже), мы рекомендуем применять адресное пространство виртуальной сети Azure 10.0.1.0/24 и 10.0.2.0/28.</span><span class="sxs-lookup"><span data-stu-id="0ac47-198">Example: If your Azure VM Subnet (see earlier) is 10.0.1.0/24, and your Azure Gateway Subnet (see following) is 10.0.2.0/28, then your Azure VNet Address Space is recommended to be two lines; 10.0.1.0/24 and 10.0.2.0/28.</span></span> <span data-ttu-id="0ac47-199">Хотя значения адресных пространств можно агрегировать, мы рекомендуем сопоставить их с диапазонами подсетей, чтобы избежать случайного повторного использования неиспользуемых диапазонов IP-адресов с более крупными адресными пространствами в сети в будущем.</span><span class="sxs-lookup"><span data-stu-id="0ac47-199">Although the Address Space values can be aggregated, it is recommended matching them to the subnet ranges to avoid accidental reuse of unused IP address ranges within larger address spaces in the future elsewhere in your network.</span></span> <span data-ttu-id="0ac47-200">**Адресное пространство виртуальной сети — это диапазон IP-адресов, который нужно отправить в корпорацию Майкрософт вместе с запросом на первоначальное развертывание.**</span><span class="sxs-lookup"><span data-stu-id="0ac47-200">**The VNET Address Space is an IP address range, which needs to be submitted to Microsoft when asking for an initial deployment**</span></span>

- <span data-ttu-id="0ac47-201">**Диапазон IP-адресов подсети виртуальной машины Azure** — это диапазон IP-адресов (как уже представлено выше), назначенный (или который планируется назначить) подсети виртуальной сети Azure, которая подключается к среде крупных экземпляров SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-201">**Azure VM subnet IP address range:** This IP address range, as discussed earlier already, is the one you have assigned (or plan to assign) to the Azure VNet subnet parameter in your Azure VNET connecting to the SAP HANA Large Instance environment.</span></span> <span data-ttu-id="0ac47-202">Этот диапазон IP-адресов используется для назначения IP-адресов виртуальным машинам Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-202">This IP address range is used to assign IP addresses to your Azure VMs.</span></span> <span data-ttu-id="0ac47-203">IP-адреса вне этого диапазона разрешено использовать для подключения к серверам крупных экземпляров SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-203">The IP addresses out of this range are allowed to connect to your SAP HANA Large Instance server(s).</span></span> <span data-ttu-id="0ac47-204">При необходимости можно использовать несколько подсетей виртуальной машины Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-204">If needed, multiple Azure VM subnets may be used.</span></span> <span data-ttu-id="0ac47-205">Майкрософт рекомендует использовать по блоку CIDR с маской /24 для каждой подсети виртуальной машины Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-205">A /24 CIDR block is recommended by Microsoft for each Azure VM Subnet.</span></span> <span data-ttu-id="0ac47-206">Этот диапазон адресов должен быть частью значений, используемых в адресном пространстве виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-206">This address range must be a part of the values used in the Azure VNet Address Space.</span></span> <span data-ttu-id="0ac47-207">Как это можно осуществить?</span><span class="sxs-lookup"><span data-stu-id="0ac47-207">How to get this IP address range?</span></span> <span data-ttu-id="0ac47-208">Специалисты по работе с корпоративными сетями или поставщик услуг должен предоставить диапазон IP-адресов вне сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-208">Your corporate network team or service provider should provide an IP Address Range, which is not currently used inside your network.</span></span>

- <span data-ttu-id="0ac47-209">**Диапазон IP-адресов подсети шлюза виртуальной сети.** В зависимости от функций, которые планируется использовать, мы рекомендуем применять следующие размеры:</span><span class="sxs-lookup"><span data-stu-id="0ac47-209">**VNet Gateway Subnet IP address range:** Depending on the features you plan to use, the recommended size would be:</span></span>
   - <span data-ttu-id="0ac47-210">Ультрапроизводительный шлюз ExpressRoute: блок адресов размером /26 — требуется для номеров SKU класса II</span><span class="sxs-lookup"><span data-stu-id="0ac47-210">Ultra-performance ExpressRoute gateway: /26 address block - required for Type II class of SKUs</span></span>
   - <span data-ttu-id="0ac47-211">Сосуществование с VPN и ExpressRoute с применением шлюза HighPerformance ExpressRoute (или более низкой версии): блок адресов размером /27.</span><span class="sxs-lookup"><span data-stu-id="0ac47-211">Co-existence with VPN and ExpressRoute using a High-performance ExpressRoute Gateway (or smaller): /27 address block</span></span>
   - <span data-ttu-id="0ac47-212">Другие ситуации: блок адресов размером /28.</span><span class="sxs-lookup"><span data-stu-id="0ac47-212">All other situations: /28 address block.</span></span> <span data-ttu-id="0ac47-213">Этот диапазон адресов должен быть частью значений, используемых в адресном пространстве виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-213">This address range must be a part of the values used in the “VNet Address Space” values.</span></span> <span data-ttu-id="0ac47-214">Этот диапазон адресов должен быть частью значений, используемых в адресном пространстве виртуальной сети Azure, которые нужно отправить в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-214">This address range must be a part of the values used in the Azure VNet Address Space values that you need to submit to Microsoft.</span></span> <span data-ttu-id="0ac47-215">Как это можно осуществить?</span><span class="sxs-lookup"><span data-stu-id="0ac47-215">How to get this IP address range?</span></span> <span data-ttu-id="0ac47-216">Специалисты по работе с корпоративными сетями или поставщик услуг должен предоставить диапазон IP-адресов вне сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-216">Your corporate network team or service provider should provide an IP Address Range, which is not currently used inside your network.</span></span> 

- <span data-ttu-id="0ac47-217">**Диапазон адресов для подключения ER-P2P** — это диапазон IP-адресов для однорангового подключения ExpressRoute (ER) крупных экземпляров SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-217">**Address range for ER-P2P connectivity:** This range is the IP range for your SAP HANA Large Instance ExpressRoute (ER) P2P connection.</span></span> <span data-ttu-id="0ac47-218">Это должен быть диапазон IP-адресов CIDR с маской /29.</span><span class="sxs-lookup"><span data-stu-id="0ac47-218">This range of IP addresses must be a /29 CIDR IP address range.</span></span> <span data-ttu-id="0ac47-219">Этот диапазон НЕ ДОЛЖЕН пересекаться с локальным диапазоном адресов и с другими диапазонами IP-адресов Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-219">This range must NOT overlap with your on-premise or other Azure IP address ranges.</span></span> <span data-ttu-id="0ac47-220">Он используется для настройки подключения ER между шлюзом ExpressRoute виртуальной сети Azure и серверами крупных экземпляров SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-220">This IP address range is used to set up the ER connectivity from your Azure VNet ExpressRoute Gateway to the SAP HANA Large Instance servers.</span></span> <span data-ttu-id="0ac47-221">Как это можно осуществить?</span><span class="sxs-lookup"><span data-stu-id="0ac47-221">How to get this IP address range?</span></span> <span data-ttu-id="0ac47-222">Специалисты по работе с корпоративными сетями или поставщик услуг должен предоставить диапазон IP-адресов вне сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-222">Your corporate network team or service provider should provide an IP Address Range, which is not currently used inside your network.</span></span> <span data-ttu-id="0ac47-223">**Этот диапазон IP-адресов нужно отправить в корпорацию Майкрософт вместе с запросом на первоначальное развертывание.**</span><span class="sxs-lookup"><span data-stu-id="0ac47-223">**This range is an IP address range, which needs to be submitted to Microsoft when asking for an initial deployment**</span></span>
  
- <span data-ttu-id="0ac47-224">**Диапазон IP-адресов пула серверов.** Этот диапазон IP-адресов используется для назначения отдельных IP-адресов серверам больших экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-224">**Server IP Pool Address Range:** This IP address range is used to assign the individual IP address to HANA large instance servers.</span></span> <span data-ttu-id="0ac47-225">Мы рекомендуем использовать такой размер подсети, как блоки CIDR с маской /24. При необходимости его можно уменьшить, чтобы предоставлять минимальное число IP-адресов (64).</span><span class="sxs-lookup"><span data-stu-id="0ac47-225">The recommended subnet size is a /24 CIDR block - but if needed it can be smaller to a minimum of providing 64 IP addresses.</span></span> <span data-ttu-id="0ac47-226">Первые 30 IP-адресов в этом диапазоне будут зарезервированы для использования корпорацией Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-226">From this range, the first 30 IP addresses are reserved for use by Microsoft.</span></span> <span data-ttu-id="0ac47-227">Учитывайте это, выбирая размер диапазона.</span><span class="sxs-lookup"><span data-stu-id="0ac47-227">Ensure this fact is accounted for when choosing the size of the range.</span></span> <span data-ttu-id="0ac47-228">Этот диапазон НЕ ДОЛЖЕН пересекаться с локальным диапазоном адресов и с другими диапазонами IP-адресов Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-228">This range must NOT overlap with your on-premise or other Azure IP addresses.</span></span> <span data-ttu-id="0ac47-229">Как это можно осуществить?</span><span class="sxs-lookup"><span data-stu-id="0ac47-229">How to get this IP address range?</span></span> <span data-ttu-id="0ac47-230">Специалисты по работе с корпоративными сетями или поставщик услуг должен предоставить диапазон IP-адресов вне сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-230">Your corporate network team or service provider should provide an IP Address Range which is not currently used inside your network.</span></span> <span data-ttu-id="0ac47-231">Уникальный блок CIDR с диапазоном /24 (рекомендуется) для назначения определенных IP-адресов, необходимых для SAP HANA в Azure (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-231">A /24 (recommended) unique CIDR block to be used for assigning the specific IP addresses needed for SAP HANA on Azure (Large Instances).</span></span> <span data-ttu-id="0ac47-232">**Этот диапазон IP-адресов нужно отправить в корпорацию Майкрософт вместе с запросом на первоначальное развертывание.**</span><span class="sxs-lookup"><span data-stu-id="0ac47-232">**This range is an IP address range, which needs to be submitted to Microsoft when asking for an initial deployment**</span></span>
 
<span data-ttu-id="0ac47-233">Хотя необходимо определить и спланировать диапазоны IP-адресов выше, не все из них нужно отправлять в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-233">Though you need to define and plan the IP address ranges above, not all them need to be transmitted to Microsoft.</span></span> <span data-ttu-id="0ac47-234">Итак, вам нужно отправить в корпорацию Майкрософт следующие диапазоны IP-адресов:</span><span class="sxs-lookup"><span data-stu-id="0ac47-234">To summarize the above, the IP address ranges you are required to name to Microsoft are:</span></span>

- <span data-ttu-id="0ac47-235">Адресное пространство виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-235">Azure VNet Address Space(s)</span></span>
- <span data-ttu-id="0ac47-236">Диапазон IP-адресов для подключений ER-P2P.</span><span class="sxs-lookup"><span data-stu-id="0ac47-236">Address range for ER-P2P connectivity</span></span>
- <span data-ttu-id="0ac47-237">Диапазон IP-адресов пула серверов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-237">Server IP Pool Address Range</span></span>

<span data-ttu-id="0ac47-238">Для добавления дополнительных виртуальных сетей, которым требуется подключиться к крупным экземплярам HANA, необходимо отправить новое адресное пространство виртуальной сети Azure, добавляемой в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-238">Adding additional VNets that need to connect to HANA Large Instances, requires you to submit the new Azure VNet Address Space you're adding to Microsoft.</span></span> 

<span data-ttu-id="0ac47-239">Ниже приведен пример различных диапазонов, которые нужно настроить и отправить в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-239">Following is an example of the different ranges and some example ranges as you need to configure and eventually provide to Microsoft.</span></span> <span data-ttu-id="0ac47-240">В первом примере значение адресного пространства виртуальной сети Azure не агрегировано. Оно определяется по диапазонам первого диапазона IP-адресов подсети виртуальной машины Azure и диапазона IP-адресов подсети шлюза виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-240">As you can see, the value for the Azure VNet Address Space is not aggregated in the first example, but is defined from the ranges of the first Azure VM subnet IP address range and the VNet Gateway Subnet IP address range.</span></span> <span data-ttu-id="0ac47-241">Чтобы вы могли использовать несколько подсетей виртуальной машины в виртуальной сети Azure соответствующим образом, настройте и отправьте дополнительные диапазоны IP-адресов дополнительных виртуальных подсетей в составе адресного пространства виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-241">Using multiple VM subnets within the Azure VNet would work accordingly by configuring and submitting the additional IP address ranges of the additional VM subnet(s) as part of the Azure VNet Address Space.</span></span>

![Диапазоны IP-адресов, необходимые для минимального развертывания SAP HANA в Azure (крупные экземпляры)](./media/hana-overview-connectivity/image4b-ip-addres-ranges-necessary.png)

<span data-ttu-id="0ac47-243">Вы также можете выполнить статистическую обработку данных, отправляемых в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-243">You also have the possibility of aggregating the data you submit to Microsoft.</span></span> <span data-ttu-id="0ac47-244">В этом случае адресное пространство виртуальной сети Azure будет содержать всего одно пространство.</span><span class="sxs-lookup"><span data-stu-id="0ac47-244">In that case, the Address Space of the Azure VNet only would include one space.</span></span> <span data-ttu-id="0ac47-245">Если использовать диапазоны IP-адресов из примера выше,</span><span class="sxs-lookup"><span data-stu-id="0ac47-245">Using the IP address ranges used in the example earlier.</span></span> <span data-ttu-id="0ac47-246">агрегированное адресное пространство виртуальной сети может выглядеть так:</span><span class="sxs-lookup"><span data-stu-id="0ac47-246">This aggregated VNet Address space could look like:</span></span>

![Второй вариант диапазонов IP-адресов, необходимых для минимального развертывания SAP HANA в Azure (крупные экземпляры)](./media/hana-overview-connectivity/image5b-ip-addres-ranges-necessary-one-value.png)

<span data-ttu-id="0ac47-248">Как можно заметить, вместо двух диапазонов меньшего размера, определяющих адресное пространство виртуальной сети Azure, у нас есть один больший диапазон, охватывающий 4096 IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-248">As you can see above, instead of two smaller ranges that defined the address space of the Azure VNet, we have one larger range that covers 4096 IP addresses.</span></span> <span data-ttu-id="0ac47-249">При таком крупном определении адресного пространства некоторые крупные диапазоны не используются.</span><span class="sxs-lookup"><span data-stu-id="0ac47-249">Such a large definition of the Address Space leaves some rather large ranges unused.</span></span> <span data-ttu-id="0ac47-250">Так как значения адресного пространства виртуальной сети используются для распространения маршрутов BGP, использование неиспользуемых диапазонов локально или в другой части сети может вызвать проблемы маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="0ac47-250">Since the VNet Address Space value(s) are used for BGP route propagation, usage of the unused ranges on-premises or elsewhere in your network can cause routing issues.</span></span> <span data-ttu-id="0ac47-251">Поэтому мы рекомендуем обеспечить точное соответствие адресного пространства фактически используемому адресному пространству подсети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-251">So it's recommended to keep the Address Space tightly aligned with the actual subnet address space used.</span></span> <span data-ttu-id="0ac47-252">При необходимости вы можете в любое время добавить новые значения адресного пространства позже, не вызывая простои в виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-252">If needed, without incurring downtime on the VNet, you can always add new Address Space values later.</span></span>
 
> [!IMPORTANT] 
> <span data-ttu-id="0ac47-253">IP-адреса адресного пространства ER-P2P, пула серверов и виртуальной сети Azure **НЕ** должны пересекаться между собой или с другими диапазонами IP-адресов в сети. Это должны быть отдельные адреса и, как показано на двух рисунках выше, они не должны быть частью подсети другого диапазона.</span><span class="sxs-lookup"><span data-stu-id="0ac47-253">Each IP address range of ER-P2P, Server IP Pool, Azure VNet Address Space must **NOT** overlap with each other or any other range used somewhere else in your network; each must be discrete and as the two graphics earlier show, may not be a subnet of any other range.</span></span> <span data-ttu-id="0ac47-254">Если диапазоны пересекаются, виртуальная сеть Azure может не подключиться к каналу ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-254">If overlaps occur between ranges, the Azure VNet may not connect to the ExpressRoute circuit.</span></span>

### <a name="next-steps-after-address-ranges-have-been-defined"></a><span data-ttu-id="0ac47-255">Дальнейшие действия после определения диапазонов адресов</span><span class="sxs-lookup"><span data-stu-id="0ac47-255">Next steps after address ranges have been defined</span></span>
<span data-ttu-id="0ac47-256">После определения диапазонов IP-адресов нужно сделать следующее:</span><span class="sxs-lookup"><span data-stu-id="0ac47-256">After the IP address ranges have been defined, the following activities need to happen:</span></span>

1. <span data-ttu-id="0ac47-257">Отправьте диапазоны IP-адресов для адресного пространства виртуальной сети Azure, подключения ER-P2P и диапазона IP-адресов пула серверов, а также другие данные, указанные в начале документа.</span><span class="sxs-lookup"><span data-stu-id="0ac47-257">Submit the IP address ranges for Azure VNet Address Space, the ER-P2P connectivity, and Server IP Pool Address Range, together with other data that has been listed at the beginning of the document.</span></span> <span data-ttu-id="0ac47-258">Сейчас также можно приступить к созданию виртуальной сети и подсети виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="0ac47-258">At this point in time, you also could start to create the VNet and the VM Subnets.</span></span> 
2. <span data-ttu-id="0ac47-259">Корпорация Майкрософт создает канал ExpressRoute между подпиской Azure и стеком крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-259">An Express Route circuit is created by Microsoft between your Azure subscription and the HANA Large Instance stamp.</span></span>
3. <span data-ttu-id="0ac47-260">Корпорация Майкрософт создает клиентскую сеть в стеке крупных экземпляров.</span><span class="sxs-lookup"><span data-stu-id="0ac47-260">A tenant network is created on the Large Instance stamp by Microsoft.</span></span>
4. <span data-ttu-id="0ac47-261">Специалисты Майкрософт настроят сеть таким образом, чтобы инфраструктура SAP HANA в Azure (крупные экземпляры) принимала IP-адреса из адресного диапазона виртуальной сети Azure, которая будет взаимодействовать с крупными экземплярами HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-261">Microsoft configures networking in the SAP HANA on Azure (Large Instances) infrastructure to accept IP addresses from your Azure VNet Address Space that communicates with HANA Large Instances.</span></span>
5. <span data-ttu-id="0ac47-262">В зависимости от конкретного приобретенного SKU SAP HANA в Azure (крупные экземпляры), корпорация Майкрософт назначит единицу вычисления в сети клиента, выделит и подключит хранилище, а также установит операционную систему (SUSE или RedHat Linux).</span><span class="sxs-lookup"><span data-stu-id="0ac47-262">Depending on the specific SAP HANA on Azure (Large Instances) SKU purchased, Microsoft assigns a compute unit in a tenant network, allocate and mount storage, and install the operating system (SUSE or Red Hat Linux).</span></span> <span data-ttu-id="0ac47-263">IP-адреса для этих единиц берутся из диапазона IP-адресов пула серверов, отправленного в корпорацию Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-263">IP addresses for these units are taken out of the Server IP Pool address Range you submitted to Microsoft.</span></span>

<span data-ttu-id="0ac47-264">В конце развертывания специалисты Майкрософт отправят вам следующие данные:</span><span class="sxs-lookup"><span data-stu-id="0ac47-264">At the end of the deployment process, Microsoft delivers the following data to you:</span></span>
- <span data-ttu-id="0ac47-265">Сведения, нужные для подключения виртуальной сети Azure к каналу ExpressRoute, по которому они подключаются к крупным экземплярам HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-265">Information needed to connect your Azure VNet(s) to the ExpressRoute circuit that connects Azure VNets to HANA Large Instances:</span></span>
     - <span data-ttu-id="0ac47-266">ключи авторизации;</span><span class="sxs-lookup"><span data-stu-id="0ac47-266">Authorization key(s)</span></span>
     - <span data-ttu-id="0ac47-267">код узла ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-267">ExpressRoute PeerID</span></span>
- <span data-ttu-id="0ac47-268">Данные для доступа к крупным экземплярам HANA по настроенному каналу ExpressRoute и виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-268">Data to access HANA Large Instances after you established ExpressRoute circuit and Azure VNet.</span></span>

<span data-ttu-id="0ac47-269">Можно также обратиться к последовательности подключения крупных экземпляров HANA, которая описана в документе [Комплексная настройка крупных экземпляров SAP HANA](https://azure.microsoft.com/resources/sap-hana-on-azure-large-instances-setup/).</span><span class="sxs-lookup"><span data-stu-id="0ac47-269">You can also find the sequence of connecting HANA Large Instances in the document [End to End Setup for SAP HANA Large Instances](https://azure.microsoft.com/resources/sap-hana-on-azure-large-instances-setup/).</span></span> <span data-ttu-id="0ac47-270">Многие из следующих действий демонстрируются в примере развертывания в этом документе.</span><span class="sxs-lookup"><span data-stu-id="0ac47-270">Many of the following steps are shown in an example deployment in that document.</span></span> 


## <a name="connecting-a-vnet-to-hana-large-instance-expressroute"></a><span data-ttu-id="0ac47-271">Подключение виртуальной сети к каналу ExpressRoute крупных экземпляров HANA</span><span class="sxs-lookup"><span data-stu-id="0ac47-271">Connecting a VNet to HANA Large Instance ExpressRoute</span></span>

<span data-ttu-id="0ac47-272">Определив диапазоны IP-адресов и получив данные из корпорации Майкрософт, вы можете приступить к подключению виртуальной сети, созданной ранее, к крупным экземплярам HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-272">As you defined all the IP address ranges and now got the data back from Microsoft, you can start connecting the VNet you created before to HANA Large Instances.</span></span> <span data-ttu-id="0ac47-273">После создания виртуальной сети Azure в ней нужно создать шлюз ExpressRoute, чтобы связать эту виртуальную сеть с каналом ExpressRoute, подключающимся к клиенту пользователя по метке крупного экземпляра.</span><span class="sxs-lookup"><span data-stu-id="0ac47-273">Once the Azure VNet is created, an ExpressRoute gateway must be created on the VNet to link the VNet to the ExpressRoute circuit that connects to the customer tenant on the Large Instance stamp.</span></span>

> [!NOTE] 
> <span data-ttu-id="0ac47-274">Это может занять до 30 минут, так как при этом создается шлюз в обозначенной подписке Azure, который затем подключается к указанной виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-274">This step can take up to 30 minutes to complete, as the new gateway is created in the designated Azure subscription and then connected to the specified Azure VNet.</span></span>

<span data-ttu-id="0ac47-275">Если шлюз уже существует, проверьте, является ли он шлюзом ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-275">If a gateway already exists, check whether it is an ExpressRoute gateway or not.</span></span> <span data-ttu-id="0ac47-276">В противном случае шлюз необходимо удалить и повторно создать в качестве шлюза ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-276">If not, the gateway must be deleted and recreated as an ExpressRoute gateway.</span></span> <span data-ttu-id="0ac47-277">Если шлюз ExpressRoute уже установлен, а виртуальная сеть Azure подключена к каналу ExpressRoute для локального подключения, перейдите к разделу "Связывание виртуальных сетей" ниже.</span><span class="sxs-lookup"><span data-stu-id="0ac47-277">If an ExpressRoute gateway is already established, since the Azure VNet is already connected to the ExpressRoute circuit for on-premises connectivity, proceed to the Linking VNets section below.</span></span>

- <span data-ttu-id="0ac47-278">Используйте новый [портал Azure](https://portal.azure.com/) или PowerShell, чтобы создать VPN-шлюз ExpressRoute, подключенный к виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-278">Use either the (new) [Azure portal](https://portal.azure.com/), or PowerShell to create an ExpressRoute VPN gateway connected to your VNet.</span></span>
  - <span data-ttu-id="0ac47-279">Если вы используете портал Azure, добавьте новый **шлюз виртуальной сети**, а затем в качестве типа шлюза выберите **ExpressRoute**.</span><span class="sxs-lookup"><span data-stu-id="0ac47-279">If you use the Azure portal, add a new **Virtual Network Gateway** and then select **ExpressRoute** as the gateway type.</span></span>
  - <span data-ttu-id="0ac47-280">Если же вы выбрали PowerShell, сначала скачайте и используйте последнюю версию [пакета SDK для Azure PowerShell](https://azure.microsoft.com/downloads/) для оптимальной работы.</span><span class="sxs-lookup"><span data-stu-id="0ac47-280">If you chose PowerShell instead, first download and use the latest [Azure PowerShell SDK](https://azure.microsoft.com/downloads/) to ensure an optimal experience.</span></span> <span data-ttu-id="0ac47-281">Следующие команды создают шлюз ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-281">The following commands create an ExpressRoute gateway.</span></span> <span data-ttu-id="0ac47-282">Текст, перед которым стоит символ _$_, — это определяемые пользователем переменные, которые нужно обновить, используя ваши сведения.</span><span class="sxs-lookup"><span data-stu-id="0ac47-282">The texts preceded by a _$_ are user defined variables that need to be updated with your specific information.</span></span>

```PowerShell
# These Values should already exist, update to match your environment
$myAzureRegion = "eastus"
$myGroupName = "SAP-East-Coast"
$myVNetName = "VNet01"

# These values are used to create the gateway, update for how you wish the GW components to be named
$myGWName = "VNet01GW"
$myGWConfig = "VNet01GWConfig"
$myGWPIPName = "VNet01GWPIP"
$myGWSku = "HighPerformance" # Supported values for HANA Large Instances are: HighPerformance or UltraPerformance

# These Commands create the Public IP and ExpressRoute Gateway
$vnet = Get-AzureRmVirtualNetwork -Name $myVNetName -ResourceGroupName $myGroupName
$subnet = Get-AzureRmVirtualNetworkSubnetConfig -Name 'GatewaySubnet' -VirtualNetwork $vnet
New-AzureRmPublicIpAddress -Name $myGWPIPName -ResourceGroupName $myGroupName `
-Location $myAzureRegion -AllocationMethod Dynamic
$gwpip = Get-AzureRmPublicIpAddress -Name $myGWPIPName -ResourceGroupName $myGroupName
$gwipconfig = New-AzureRmVirtualNetworkGatewayIpConfig -Name $myGWConfig -SubnetId $subnet.Id `
-PublicIpAddressId $gwpip.Id

New-AzureRmVirtualNetworkGateway -Name $myGWName -ResourceGroupName $myGroupName -Location $myAzureRegion `
-IpConfigurations $gwipconfig -GatewayType ExpressRoute `
-GatewaySku $myGWSku -VpnType PolicyBased -EnableBgp $true
```

<span data-ttu-id="0ac47-283">В этом примере использовался номер SKU шлюза HighPerformance.</span><span class="sxs-lookup"><span data-stu-id="0ac47-283">In this example, the HighPerformance gateway SKU was used.</span></span> <span data-ttu-id="0ac47-284">Имеются следующие варианты: HighPerformance или UltraPerformance. Это единственные номера SKU шлюза, которые поддерживает SAP HANA в Azure (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-284">Your options are HighPerformance or UltraPerformance as the only gateway SKUs that are supported for SAP HANA on Azure (Large Instances).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0ac47-285">Для больших экземпляров HANA с номерами SKU типов S384, S384m, S384xm, S576, S768 и S960 (номера SKU класса II) использование номер SKU ультрапроизводительного шлюза является обязательным.</span><span class="sxs-lookup"><span data-stu-id="0ac47-285">For HANA Large Instances of the SKU types S384, S384m, S384xm, S576, S768, and S960 (Type II class SKUs), the usage of the UltraPerformance Gateway SKU is mandatory.</span></span>

### <a name="linking-vnets"></a><span data-ttu-id="0ac47-286">Связывание виртуальных сетей</span><span class="sxs-lookup"><span data-stu-id="0ac47-286">Linking VNets</span></span>

<span data-ttu-id="0ac47-287">Теперь, когда для виртуальной сети Azure создан шлюз ExpressRoute, используйте сведения об авторизации, предоставленные корпорацией Майкрософт, для подключения шлюза ExpressRoute к каналу ExpressRoute SAP HANA в Azure (крупные экземпляры), созданного именно для этого.</span><span class="sxs-lookup"><span data-stu-id="0ac47-287">Now that the Azure VNet has an ExpressRoute gateway, you use the authorization information provided by Microsoft to connect the ExpressRoute gateway to the SAP HANA on Azure (Large Instances) ExpressRoute circuit created for this connectivity.</span></span> <span data-ttu-id="0ac47-288">Это можно сделать на портале Azure или с помощью PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0ac47-288">This step can be performed using the Azure portal or PowerShell.</span></span> <span data-ttu-id="0ac47-289">Мы рекомендуем использовать портал. Тем не менее далее указаны инструкции для PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0ac47-289">The portal is recommended, however PowerShell instructions are as follows.</span></span> 

- <span data-ttu-id="0ac47-290">Выполните следующие команды для каждого шлюза виртуальной сети, используя разные AuthGUID для каждого подключения.</span><span class="sxs-lookup"><span data-stu-id="0ac47-290">You execute the following commands for each VNet gateway using a different AuthGUID for each connection.</span></span> <span data-ttu-id="0ac47-291">Первые две записи, приведенные в сценарии ниже, получены из сведений, предоставленных корпорацией Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-291">The first two entries shown in the script following come from the information provided by Microsoft.</span></span> <span data-ttu-id="0ac47-292">Кроме того, каждый AuthGUID связан с конкретной виртуальной сетью и шлюзом.</span><span class="sxs-lookup"><span data-stu-id="0ac47-292">Also, the AuthGUID is specific for every VNet and its gateway.</span></span> <span data-ttu-id="0ac47-293">Это значит, что если вы хотите добавить еще одну виртуальную сеть Azure, вам необходимо получить другой AuthID для канала ExpressRoute, по которому крупные экземпляры HANA подключаются к Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-293">Means, if you want to add another Azure VNet, you need to get another AuthID for your ExpressRoute circuit that connects HANA Large Instances into Azure.</span></span> 

```PowerShell
# Populate with information provided by Microsoft Onboarding team
$PeerID = "/subscriptions/9cb43037-9195-4420-a798-f87681a0e380/resourceGroups/Customer-USE-Circuits/providers/Microsoft.Network/expressRouteCircuits/Customer-USE01"
$AuthGUID = "76d40466-c458-4d14-adcf-3d1b56d1cd61"

# Your ExpressRoute Gateway Information
$myGroupName = "SAP-East-Coast"
$myGWName = "VNet01GW"
$myGWLocation = "East US"

# Define the name for your connection
$myConnectionName = "VNet01GWConnection"

# Create a new connection between the ER Circuit and your Gateway using the Authorization
$gw = Get-AzureRmVirtualNetworkGateway -Name $myGWName -ResourceGroupName $myGroupName
    
New-AzureRmVirtualNetworkGatewayConnection -Name $myConnectionName `
-ResourceGroupName $myGroupName -Location $myGWLocation -VirtualNetworkGateway1 $gw `
-PeerId $PeerID -ConnectionType ExpressRoute -AuthorizationKey $AuthGUID
```

<span data-ttu-id="0ac47-294">Возможно, вам потребуется сделать это несколько раз, если вы хотите подключить шлюз к нескольким каналам ExpressRoute, связанным с вашей подпиской.</span><span class="sxs-lookup"><span data-stu-id="0ac47-294">If you want to connect the gateway to multiple ExpressRoute circuits that are associated with your subscription, you may need to execute this step more than once.</span></span> <span data-ttu-id="0ac47-295">Например, скорее всего, вам потребуется подключить тот же шлюз виртуальной сети к каналу ExpressRoute, с помощью которого виртуальная сеть подключается к локальной сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-295">For example, you are likely going to connect the same VNet Gateway to the ExpressRoute circuit that connects the VNet to your on-premise network.</span></span>

## <a name="adding-more-ip-addresses-or-subnets"></a><span data-ttu-id="0ac47-296">Добавление дополнительных IP-адресов или подсетей</span><span class="sxs-lookup"><span data-stu-id="0ac47-296">Adding more IP addresses or subnets</span></span>

<span data-ttu-id="0ac47-297">При добавлении дополнительных IP-адресов или подсетей используйте портал Azure, PowerShell или интерфейс командной строки.</span><span class="sxs-lookup"><span data-stu-id="0ac47-297">Use either the Azure portal, PowerShell, or CLI when adding more IP addresses or subnets.</span></span>

<span data-ttu-id="0ac47-298">В этом случае мы рекомендуем добавить новый диапазон IP-адресов в адресное пространство виртуальной сети, а не создавать агрегированный диапазон.</span><span class="sxs-lookup"><span data-stu-id="0ac47-298">In this case, the recommendation is to add the new IP address range as new range to the VNet Address Space instead of generating a new aggregated range.</span></span> <span data-ttu-id="0ac47-299">В любом случае необходимо отправить соответствующие сведения в корпорацию Майкрософт, чтобы разрешить подключение к единицам крупных экземпляров HANA в клиентском приложении с использованием нового диапазона IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="0ac47-299">In either case, you need to submit this change to Microsoft to allow connectivity out of that new IP address range to the HANA Large Instance units in your client.</span></span> <span data-ttu-id="0ac47-300">Вы можете отправить запрос на добавление адресного пространства виртуальной сети в службу поддержки Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-300">You can open an Azure support request to get the new VNet Address space added.</span></span> <span data-ttu-id="0ac47-301">Получив подтверждение, выполните следующие шаги.</span><span class="sxs-lookup"><span data-stu-id="0ac47-301">After you receive confirmation, perform the next steps.</span></span>

<span data-ttu-id="0ac47-302">Чтобы создать дополнительные подсети с помощью портала Azure, см. статью [Создание виртуальной сети с помощью портала Azure](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), а для создания с помощью PowerShell см. статью [Создание виртуальной сети с помощью PowerShell](../../../virtual-network/virtual-networks-create-vnet-arm-ps.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="0ac47-302">To create an additional subnet from the Azure portal, see the article [Create a virtual network using the Azure portal](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), and to create from PowerShell, see [Create a virtual network using PowerShell](../../../virtual-network/virtual-networks-create-vnet-arm-ps.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

## <a name="adding-vnets"></a><span data-ttu-id="0ac47-303">Добавление виртуальных сетей</span><span class="sxs-lookup"><span data-stu-id="0ac47-303">Adding VNets</span></span>

<span data-ttu-id="0ac47-304">Подключив одну или несколько виртуальных сетей Azure, вы, возможно, захотите добавить дополнительные виртуальные сети, которые обращаются к SAP HANA в Azure (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-304">After initially connecting one or more Azure VNets, you might want to add additional ones that access SAP HANA on Azure (Large Instances).</span></span> <span data-ttu-id="0ac47-305">Сначала отправьте запрос на поддержку Azure и укажите в нем сведения о конкретном развертывании Azure и диапазоны IP-адресов из адресного пространства виртуальных сетей Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-305">First, submit an Azure support request, in that request include both the specific information identifying the particular Azure deployment, and the IP address space range(s) of the Azure VNet Address Space.</span></span> <span data-ttu-id="0ac47-306">Затем специалисты службы поддержки "SAP HANA для управления службами Azure" предоставят сведения, необходимые для подключения дополнительных виртуальных сетей и ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="0ac47-306">SAP HANA on Azure Service Management then provides the necessary information you need to connect the additional VNets and ExpressRoute.</span></span> <span data-ttu-id="0ac47-307">Для каждой виртуальной сети следует использовать уникальный ключ авторизации для подключения к каналу ExpressRoute для крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-307">For every VNet, you need a unique Authorization Key to connect to the ExpressRoute Circuit to HANA Large Instances.</span></span>

<span data-ttu-id="0ac47-308">Процедура добавления новой виртуальной сети Azure</span><span class="sxs-lookup"><span data-stu-id="0ac47-308">Steps to add a new Azure VNet:</span></span>

1. <span data-ttu-id="0ac47-309">Выполните первый шаг в процессе внедрения (см. раздел _Создание виртуальной сети Azure_).</span><span class="sxs-lookup"><span data-stu-id="0ac47-309">Complete the first step in the onboarding process, see the _Creating Azure VNet_ section.</span></span>
2. <span data-ttu-id="0ac47-310">Выполните второй шаг в процессе внедрения (см. раздел _Создание подсети шлюза_).</span><span class="sxs-lookup"><span data-stu-id="0ac47-310">Complete the second step in the onboarding process, see the _Creating gateway subnet_ section.</span></span>
3. <span data-ttu-id="0ac47-311">Откройте запрос на поддержку Azure, указав сведения о новой виртуальной сети, и запросите новый ключ авторизации для подключения дополнительных виртуальных сетей к каналу ExpressRoute крупных экземпляров HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-311">To connect your additional VNets to the HANA Large Instance ExpressRoute circuit, open an Azure support request with information on the new VNet and request a new Authorization Key.</span></span>
4. <span data-ttu-id="0ac47-312">Получив уведомление о завершении авторизации, используйте сведения об авторизации, предоставленные корпорацией Майкрософт, чтобы выполнить третий шаг в процессе внедрения (см. раздел _Связывание виртуальных сетей_).</span><span class="sxs-lookup"><span data-stu-id="0ac47-312">Once notified that the authorization is complete, use the Microsoft-provided authorization information to complete the third step in the onboarding process, see the _Linking VNets_ section.</span></span>

## <a name="increasing-expressroute-circuit-bandwidth"></a><span data-ttu-id="0ac47-313">Повышение пропускной способности канала ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="0ac47-313">Increasing ExpressRoute circuit bandwidth</span></span>

<span data-ttu-id="0ac47-314">Обратитесь в службу поддержки решения "SAP HANA для управления службами Azure".</span><span class="sxs-lookup"><span data-stu-id="0ac47-314">Consult with SAP HANA on Azure Service Management.</span></span> <span data-ttu-id="0ac47-315">Если вам порекомендовали увеличить пропускную способность канала ExpressRoute SAP HANA в Azure (крупные экземпляры), создайте запрос на поддержку Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-315">If you are advised to increase the bandwidth of the SAP HANA on Azure (Large Instances) ExpressRoute circuit, create an Azure support request.</span></span> <span data-ttu-id="0ac47-316">(Вы можете отправить запрос о повышении пропускной способности одного канала до максимального показателя — 10 Гбит/с.) После завершения операции вы получите уведомление. Чтобы таким образом повысить производительность в Azure, не нужно больше ничего делать.</span><span class="sxs-lookup"><span data-stu-id="0ac47-316">(You can request an increase for a single circuit bandwidth up to a maximum of 10 Gbps.) You then receive notification after the operation is complete; no additional action needed to enable this higher speed in Azure.</span></span>

## <a name="adding-an-additional-expressroute-circuit"></a><span data-ttu-id="0ac47-317">Добавление дополнительного канала ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="0ac47-317">Adding an additional ExpressRoute circuit</span></span>

<span data-ttu-id="0ac47-318">Обратитесь в службу поддержки решения "SAP HANA для управления службами Azure", если вам порекомендовали добавить дополнительный канал ExpressRoute. Отправьте запрос на поддержку Azure для создания канала ExpressRoute (а также для получения сведений об авторизации для подключения к нему).</span><span class="sxs-lookup"><span data-stu-id="0ac47-318">Consult with SAP HANA on Azure Service Management, if you are advised that an additional ExpressRoute circuit is needed, make an Azure support request to create a new ExpressRoute circuit (and to get authorization information to connect to it).</span></span> <span data-ttu-id="0ac47-319">Перед этим определите адресное пространство, которое будет использоваться в виртуальной сети, чтобы специалисты службы поддержки решения "SAP HANA для управления службами Azure" предоставили вам возможность авторизации.</span><span class="sxs-lookup"><span data-stu-id="0ac47-319">The address space that is going be used on the VNets must be defined before making the request, in order for SAP HANA on Azure Service Management to provide authorization.</span></span>

<span data-ttu-id="0ac47-320">После создания канала и завершения настройки решения "SAP HANA для управления службами Azure" вы получите уведомление со сведениями, необходимыми, чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0ac47-320">Once the new circuit is created and the SAP HANA on Azure Service Management configuration is complete, you are going to receive notification with the information you need to proceed.</span></span> <span data-ttu-id="0ac47-321">Выполните шаги, описанные выше, чтобы создать виртуальную сеть и подключить ее к этому дополнительному каналу.</span><span class="sxs-lookup"><span data-stu-id="0ac47-321">Follow the steps provided above for creating and connecting the new VNet to this additional circuit.</span></span> <span data-ttu-id="0ac47-322">Вы не сможете подключить виртуальные сети Azure к этому дополнительному каналу, если они уже подключены к другому каналу ExpressRoute SAP HANA в Azure (крупные экземпляры) в том же регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="0ac47-322">You are not able to connect Azure VNets to this additional circuit if they already connected to another SAP HANA on Azure (Large Instance) ExpressRoute circuit in the same Azure Region.</span></span>

## <a name="deleting-a-subnet"></a><span data-ttu-id="0ac47-323">Удаление подсети</span><span class="sxs-lookup"><span data-stu-id="0ac47-323">Deleting a subnet</span></span>

<span data-ttu-id="0ac47-324">Чтобы удалить подсеть виртуальной сети, можно использовать портал Azure, PowerShell или интерфейс командной строки.</span><span class="sxs-lookup"><span data-stu-id="0ac47-324">To remove a VNet subnet, either the Azure portal, PowerShell, or CLI can be used.</span></span> <span data-ttu-id="0ac47-325">Если диапазон IP-адресов или адресное пространство виртуальной сети Azure представляли собой агрегированный диапазон, вам не нужно ничего отправлять в Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="0ac47-325">In case your Azure VNet IP address range/Azure VNet Address Space was an aggregated range, there is no follow up for you with Microsoft.</span></span> <span data-ttu-id="0ac47-326">Однако виртуальная сеть распространяет маршруты BGP по адресному пространству, включающему удаленную подсеть.</span><span class="sxs-lookup"><span data-stu-id="0ac47-326">Except that the VNet is still propagating BGP route address space that includes the deleted subnet.</span></span> <span data-ttu-id="0ac47-327">Если вы определили диапазон IP-адресов или адресное пространство виртуальной сети Azure как несколько диапазонов IP-адресов, один из которых был назначен удаленной подсети, его следует удалить из адресного пространства виртуальной сети и сообщить специалистам отдела по управлению службами SAP HANA в Azure, что его нужно удалить из диапазонов, с которыми разрешено взаимодействовать SAP HANA в Azure (крупные экземпляры).</span><span class="sxs-lookup"><span data-stu-id="0ac47-327">If you defined the Azure VNet IP address range/Azure VNet Address Space as multiple IP address ranges of which one was assigned to your deleted subnet, you should delete that out of your VNet Address Space and subsequently inform  SAP HANA on Azure Service Management to remove it from the ranges that SAP HANA on Azure (Large Instances) is allowed to communicate with.</span></span>

<span data-ttu-id="0ac47-328">Хотя на сайте Azure.com нет конкретных рекомендаций по удалению подсетей, этот процесс противоположен процессу добавления.</span><span class="sxs-lookup"><span data-stu-id="0ac47-328">While there isn't yet specific, dedicated Azure.com guidance on removing subnets, the process for removing subnets is the reverse of the process for adding them.</span></span> <span data-ttu-id="0ac47-329">Дополнительные сведения о создании подсетей см. в статье [Создание виртуальной сети с помощью портала Azure](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="0ac47-329">See the article [Create a virtual network using the Azure portal](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) for more information on creating subnets.</span></span>

## <a name="deleting-a-vnet"></a><span data-ttu-id="0ac47-330">Удаление виртуальной сети</span><span class="sxs-lookup"><span data-stu-id="0ac47-330">Deleting a VNet</span></span>

<span data-ttu-id="0ac47-331">При удалении виртуальной сети используйте портал Azure, PowerShell или интерфейс командной строки.</span><span class="sxs-lookup"><span data-stu-id="0ac47-331">Use either the Azure portal, PowerShell, or CLI when deleting a VNet.</span></span> <span data-ttu-id="0ac47-332">Специалисты отдела по управлению службами SAP HANA в Azure удаляют существующую авторизацию для канала ExpressRoute HANA SAP в Azure (крупные экземпляры), а также удаляют диапазоны IP-адресов и адресное пространство виртуальной сети Azure для взаимодействия с крупными экземплярами HANA.</span><span class="sxs-lookup"><span data-stu-id="0ac47-332">SAP HANA on Azure Service Management removes the existing authorizations on the SAP HANA on Azure (Large Instances) ExpressRoute circuit and remove the Azure VNet IP address range/Azure VNet Address Space for the communication with HANA Large Instances.</span></span>

<span data-ttu-id="0ac47-333">После удаления виртуальной сети откройте запрос на поддержку Azure, чтобы указать адресные пространства диапазона IP-адресов, которые следует удалить.</span><span class="sxs-lookup"><span data-stu-id="0ac47-333">Once the VNet has been removed, open an Azure support request to provide the IP address space range(s) to be removed.</span></span>

<span data-ttu-id="0ac47-334">Хотя на сайте Azure.com нет конкретных рекомендаций по удалению виртуальных сетей, этот процесс противоположен процессу добавления (описано выше).</span><span class="sxs-lookup"><span data-stu-id="0ac47-334">While there isn't yet specific, dedicated Azure.com guidance on removing VNets, the process for removing VNets is the reverse of the process for adding them, which is described above.</span></span> <span data-ttu-id="0ac47-335">Дополнительные сведения о создании виртуальных сетей см. в статьях [Создание виртуальной сети с помощью портала Azure](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) и [Создание виртуальной сети с помощью PowerShell](../../../virtual-network/virtual-networks-create-vnet-arm-ps.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="0ac47-335">See the articles [Create a virtual network using the Azure portal](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) and [Create a virtual network using PowerShell](../../../virtual-network/virtual-networks-create-vnet-arm-ps.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) for more information on creating VNets.</span></span>

<span data-ttu-id="0ac47-336">Чтобы убедиться, что все удалено, удалите следующие компоненты:</span><span class="sxs-lookup"><span data-stu-id="0ac47-336">To ensure everything is removed, delete the following items:</span></span>

- <span data-ttu-id="0ac47-337">Подключение ExpressRoute, шлюз виртуальной сети, общедоступный IP-адрес шлюза виртуальной сети и виртуальную сеть.</span><span class="sxs-lookup"><span data-stu-id="0ac47-337">The ExpressRoute connection, VNet Gateway, VNet Gateway Public IP and, VNet</span></span>

## <a name="deleting-an-expressroute-circuit"></a><span data-ttu-id="0ac47-338">Удаление канала ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="0ac47-338">Deleting an ExpressRoute circuit</span></span>

<span data-ttu-id="0ac47-339">Чтобы удалить дополнительный канал ExpressRoute SAP HANA в Azure (крупные экземпляры), откройте запрос на поддержку Azure в службе поддержки решения "SAP HANA для управления службами Azure" и укажите, что нужно удалить канал.</span><span class="sxs-lookup"><span data-stu-id="0ac47-339">To remove an additional SAP HANA on Azure (Large Instances) ExpressRoute circuit, open an Azure support request with SAP HANA on Azure Service Management and request that the circuit should be deleted.</span></span> <span data-ttu-id="0ac47-340">В подписке Azure вы можете по желанию удалить или оставить виртуальную сеть.</span><span class="sxs-lookup"><span data-stu-id="0ac47-340">Within the Azure subscription, you may delete or keep the VNet as necessary.</span></span> <span data-ttu-id="0ac47-341">Тем не менее нужно удалить подключение между каналом ExpressRoute крупных экземпляров HANA и связанным шлюзом виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="0ac47-341">However, you must delete the connection between the HANA Large Instances ExpressRoute circuit and the linked VNet gateway.</span></span>

<span data-ttu-id="0ac47-342">Если требуется также удалить виртуальную сеть, следуйте соответствующим указаниям в предыдущем разделе.</span><span class="sxs-lookup"><span data-stu-id="0ac47-342">If you also want to remove a VNet, follow the guidance on Deleting a VNet in the section above.</span></span>


