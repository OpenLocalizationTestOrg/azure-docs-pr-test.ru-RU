---
title: "Краткое руководство по установке одного экземпляра SAP HANA вручную на виртуальных машинах Azure | Документация Майкрософт"
description: "Краткое руководство по установке одного экземпляра SAP HANA вручную на виртуальных машинах Azure"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
tags: azure-resource-manager
keywords: 
ms.assetid: c51a2a06-6e97-429b-a346-b433a785c9f0
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 09/15/2016
ms.author: hermannd
ms.openlocfilehash: 05fb31007e1e4c2243f93169129ec5b2c93099e2
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="quickstart-manual-installation-of-single-instance-sap-hana-on-azure-vms"></a>Краткое руководство по установке одного экземпляра SAP HANA вручную на виртуальных машинах Azure
## <a name="introduction"></a>Введение
Это руководство поможет вам настроить один экземпляр SAP HANA на виртуальных машинах Azure при установке SAP NetWeaver 7.5 и SAP HANA 1.0 SP12 вручную. В этом руководстве описывается развертывание SAP HANA в Azure. Оно не заменяет документацию по SAP. 

>[!Note]
>Это руководство описывает развертывание SAP HANA на виртуальных машинах Azure. Сведения о развертывании HANA SAP на крупных экземплярах HANA см. в статье [Использование SAP на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/get-started).
 
## <a name="prerequisites"></a>Предварительные требования
В руководстве предполагается, что вы знакомы с инфраструктурой как услугой (IaaS), т. е. умеете выполнять такие задачи:
 * развертывать виртуальные машины или виртуальные сети на портале Azure или с помощью PowerShell;
 * работать с кроссплатформенным интерфейсом командной строки Azure, в т. ч. использовать шаблоны JavaScript Object Notification (JSON).

В этом руководстве также предполагается, что вы знакомы со следующими технологиями и процедурами:
* SAP HANA и SAP NetWeaver и их локальная установка.
* Установка и эксплуатации SAP HANA и экземпляров приложения SAP в Azure.
* Основные понятия и процедуры.
   * Планирование развертывания SAP в Azure, в т. ч. планирование виртуальной сети Azure и использование службы хранилища Azure. См. статью [SAP NetWeaver на виртуальных машинах Windows. Руководство по планированию и внедрению](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/planning-guide).
   * Принципы и способы развертывания виртуальных машин в Azure. См. статью [Развертывание программного обеспечения SAP на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/deployment-guide).
   * Обеспечение высокого уровня доступности для SAP NetWeaver ASCS (ABAP SAP Central Services), SCS (SAP Central Services) и ERS (расчет оценки поступления) в Azure. См. статью [Высокий уровень доступности SAP NetWeaver на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/high-availability-guide).
   * Повышение эффективности с помощью установки нескольких SID ASCS/SCS в Azure. См. статью [Создание конфигурации с несколькими идентификаторами безопасности SAP NetWeaver](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/high-availability-multi-sid). 
   * Принципы работы SAP NetWeaver на виртуальных машинах Linux в Azure. См. статью [Запуск SAP NetWeaver на виртуальных машинах SUSE Linux в Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/suse-quickstart). В этом руководстве описываются важные настройки Linux на виртуальных машинах Azure, а также приведены сведения о том, как правильно присоединять диски хранилища Azure к виртуальным машинам Linux.

Сейчас виртуальные машины Azure сертифицированы SAP только для конфигураций вертикального масштабирования SAP HANA. Конфигурации горизонтального масштабирования при использовании рабочих нагрузок SAP HANA пока не поддерживаются. Сведения об обеспечении высокого уровня доступности SAP HANA для конфигураций вертикального масштабирования см. в статье [Высокий уровень доступности SAP HANA на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-high-availability).

Если вы хотите очень быстро развернуть экземпляр системы SAP HANA S/4HANA или BW/4HANA, попробуйте использовать [библиотеку SAP Cloud Appliance Library](http://cal.sap.com). Документацию по развертыванию системы S/4HANA с использованием клиентской лицензии SAP в Azure см. в статье [Развертывание SAP S/4HANA или BW/4HANA в Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/cal-s4h). Вам понадобится только подписка Azure и пользователь SAP, которого можно зарегистрировать в библиотеке SAP Cloud Appliance Library.

## <a name="additional-resources"></a>Дополнительные ресурсы
### <a name="sap-hana-backup"></a>Резервное копирование SAP HANA
Сведения о резервном копировании баз данных SAP HANA на виртуальных машинах Azure см. в следующих статьях:
* [Руководство по резервному копированию SAP HANA на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-guide)
* [Резервное копирование SAP HANA в Azure на уровне файлов](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-file-level)
* [Резервное копирование SAP HANA на основе моментальных снимков хранилища](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-storage-snapshots)

### <a name="sap-cloud-appliance-library"></a>Библиотека SAP Cloud Appliance Library
Сведения об использовании библиотеки SAP Cloud Appliance Library для развертывания S/4HANA или BW/4HANA см. в статье [Развертывание SAP S/4HANA или BW/4HANA в Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/cal-s4h).

### <a name="sap-hana-supported-operating-systems"></a>Операционные системы, поддерживаемые платформой SAP HANA
Сведения о поддерживаемых операционных системах для SAP HANA см. в [примечании по поддержке SAP № 2235581](https://launchpad.support.sap.com/#/notes/2235581/E). На виртуальных машинах Azure поддерживаются только эти операционные системы. Следующие операционные системы поддерживаются для развертывания SAP HANA в Azure: 

* SUSE Linux Enterprise Server 12.x;
* Red Hat Enterprise Linux 7.2

Дополнительную документацию SAP по платформе SAP HANA и разным дистрибутивах Linux см. по ссылкам ниже.

* [SAP Support Note #171356 – SAP Software on Linux: General Information](https://launchpad.support.sap.com/#/notes/1984787) (Примечание по поддержке SAP №171356. Общие сведения о ПО SAP на платформе Linux).
* [SAP Support Note #1944799 – SAP HANA Guidelines for SLES Operating System Installation](http://go.sap.com/documents/2016/05/e8705aae-717c-0010-82c7-eda71af511fa.html) (Примечание по поддержке SAP №1944799. Рекомендации по установке SAP HANA в ОС SLES).
* [SAP Support Note #2205917 – SAP HANA DB Recommended OS Settings for SLES 12 for SAP Applications](https://launchpad.support.sap.com/#/notes/2205917/E) (Примечание по поддержке SAP №2205917. База данных SAP HANA: рекомендуемые параметры ОС для SLES 12 для приложений SAP).
* [SAP Support Note #1984787 – SUSE Linux Enterprise Server 12: Installation Notes](https://launchpad.support.sap.com/#/notes/1984787) (Примечание по поддержке SAP №1984787. Заметки об установке SUSE Linux Enterprise Server 12).
* [SAP Support Note #1391070 – Linux UUID Solutions](https://launchpad.support.sap.com/#/notes/1391070) (Примечание по поддержке SAP №1391070. Решения UUID для Linux).
* [SAP Support Note #2009879 - SAP HANA Guidelines for Red Hat Enterprise Linux (RHEL) Operating System](https://launchpad.support.sap.com/#/notes/2009879) (Примечание по поддержке SAP № 2009879. Рекомендации для установки SAP HANA на ОС Red Hat Enterprise Linux (RHEL));
* [2292690 - SAP HANA DB: Recommended OS settings for RHEL 7](https://launchpad.support.sap.com/#/notes/2292690/E) (Примечание по поддержке SAP № 2292690. База данных SAP HANA: рекомендуемые параметры операционной системы для RHEL 7).

### <a name="sap-monitoring-in-azure"></a>Мониторинг SAP в Azure
Сведения о мониторинге SAP в Azure см. по ссылкам ниже.

* [Примечание к SAP № 2191498](https://launchpad.support.sap.com/#/notes/2191498/E) — сведения о расширенном мониторинге с помощью виртуальных машин Linux в Azure. 
* [Примечание к SAP № 1102124](https://launchpad.support.sap.com/#/notes/1102124/E) — сведения о SAPOSCOL в Linux. 
* [Примечание к SAP № 2178632](https://launchpad.support.sap.com/#/notes/2178632/E) — ключевые метрики мониторинга для SAP в Microsoft Azure.

### <a name="azure-vm-types"></a>Типы виртуальных машин Azure
Типы виртуальных машин Azure и поддерживаемые сценарии рабочих нагрузок SAP, используемых с SAP HANA, описаны на [странице сертифицированных платформ IaaS](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html). 

Типы виртуальных машин Azure, которые сертифицированы SAP для уровня приложения SAP NetWeaver или S/4HANA, описаны здесь: [SAP Note 1928533 - SAP Applications on Azure: Supported Products and Azure VM types](https://launchpad.support.sap.com/#/notes/1928533/E) (Примечание по поддержке SAP № 1928533. Приложения SAP в Azure: поддерживаемые продукты и типы виртуальных машин Azure).

>[!Note]
>Интеграция SAP, Linux и Azure поддерживается только в модели развертывания с помощью Azure Resource Manager и не поддерживается в классической модели развертывания. 

## <a name="manual-installation-of-sap-hana"></a>Установка SAP HANA вручную
В этом руководстве описываются два разных способа установки SAP HANA на виртуальных машинах Azure вручную:

* использование диспетчера подготовки программного обеспечения SAP (SWPM) в рамках распределенной установки NetWeaver на шаге "Установка экземпляра базы данных";
* использование диспетчера управления жизненным циклом базы данных SAP HANA (средства HDBLCM), а затем установка NetWeaver.

Кроме того, с помощью SWPM вы можете установить все компоненты (SAP HANA, сервер приложений SAP, экземпляр ASCS) на одной виртуальной машине, как описано в [этой записи блога](https://blogs.saphana.com/2013/12/31/announcement-sap-hana-and-sap-netweaver-as-abap-deployed-on-one-server-is-generally-available/). Последний вариант не описан в этом кратком руководстве, но при его использовании следует учитывать все соответствующие нюансы.

Прежде чем начать установку, прочтите раздел "Подготовка виртуальных машин Azure к установке SAP HANA вручную" этого руководства. Это поможет предотвратить несколько основных ошибок, которые могут возникнуть при использовании только конфигурации виртуальной машины Azure по умолчанию.

## <a name="key-steps-for-sap-hana-installation-when-you-use-sap-swpm"></a>Основные шаги по установке SAP HANA при использовании SAP SWPM
В этом разделе перечислены основные шаги для установки SAP HANA на уровне отдельного экземпляра вручную при использовании SAP SWPM для выполнения распределенной установки SAP NetWeaver 7.5. Отдельные шаги более подробно объясняются в этом руководстве на снимках экрана.

1. Создайте виртуальную сеть Azure с двумя тестовыми виртуальными машинами.
2. Разверните две виртуальные машины Azure с операционными системами (в нашем примере — SUSE Linux Enterprise Server (SLES) и SLES for SAP Applications 12 с пакетом обновления 1 (SP1)) в соответствии с моделью Azure Resource Manager.
3. Присоедините два диска хранилища класса Standard или Premium к виртуальной машине сервера приложений (например, диски на 75 ГБ или 500 ГБ).
4. Присоедините диски хранилища класса Premium к виртуальной машине сервера базы данных HANA. Дополнительные сведения см. в разделе "Настройка диска" в этом руководстве.
5. В зависимости от требований к размерам или пропускной способности, подключите несколько дисков и создайте чередующиеся тома с помощью средства управления логическими томами или администрирования нескольких устройств (MDADM) на уровне операционной системы в виртуальной машине.
6. Создайте на подключенных дисках или логических томах файловые системы XFS.
7. Подключите новые файловые системы XFS на уровне операционной системы. Используйте одну файловую систему для всего программного обеспечения SAP. Используйте другую файловую систему для каталога /sapmnt и резервных копий. На сервере базы данных SAP HANA подключите файловые системы XFS на дисках хранилища класса Premium, такие как /hana и /usr/sap. Это необходимо, чтобы предотвратить переполнение корневой файловой системы, которая имеет небольшой размер на виртуальных машинах Azure под управлением Linux.
8. Добавьте в файл /etc/hosts локальные IP-адреса тестовых виртуальных машин.
9. Добавьте в файл /etc/fstab параметр **nofail**.
10. Настройте параметры ядра Linux в соответствии с выпуском ОС Linux, который вы используете. Дополнительные сведения см. в соответствующих примечаниях SAP, посвященных HANA, и в разделе "Параметры ядра" этого руководства.
11. Добавьте область буфера.
12. При необходимости установите на тестовых виртуальных машинах графический рабочий стол. В противном случае используйте удаленную установку SAPinst.
13. Скачайте программное обеспечение SAP из SAP Service Marketplace.
14. Установите экземпляр SAP ASCS на виртуальной машине сервера приложений.
15. Предоставьте общий доступ к каталогу /sapmnt для тестовых виртуальных машин с помощью NFS. Виртуальная машина сервера приложений — это сервер NFS.
16. Установите на виртуальной машине сервера базы данных экземпляр базы данных, в том числе HANA, с помощью SWPM.
17. Установите основной сервер приложений (PAS) на виртуальной машине сервера приложений.
18. Запустите консоль управления SAP (SAP MC). Подключитесь к консоли с помощью графического пользовательского интерфейса SAP или HANA Studio.

## <a name="key-steps-for-sap-hana-installation-when-you-use-hdblcm"></a>Основные шаги по установке SAP HANA при использовании HDBLCM
В этом разделе перечислены основные шаги по установке SAP HANA на уровне отдельного экземпляра вручную при использовании SAP HDBLCM для выполнения распределенной установки SAP NetWeaver 7.5. Отдельные шаги более подробно объясняются в этом руководстве на снимках экрана.

1. Создайте виртуальную сеть Azure с двумя тестовыми виртуальными машинами.
2. Разверните две виртуальные машины Azure с операционными системами (в нашем примере — SLES и SLES for SAP Applications 12 с пакетом обновления 1 (SP1)) в соответствии с моделью Azure Resource Manager.
3. Присоедините два диска хранилища класса Standard или Premium к виртуальной машине сервера приложений (например, диски на 75 ГБ или 500 ГБ).
4. Присоедините диски хранилища класса Premium к виртуальной машине сервера базы данных HANA. Дополнительные сведения см. в разделе "Настройка диска" в этом руководстве.
5. В зависимости от требований к размерам или пропускной способности, подключите несколько дисков и создайте чередующиеся тома с помощью средства управления логическими томами или администрирования нескольких устройств (MDADM) на уровне операционной системы в виртуальной машине.
6. Создайте на подключенных дисках или логических томах файловые системы XFS.
7. Подключите новые файловые системы XFS на уровне операционной системы. Используйте одну файловую систему для всего программного обеспечения SAP, а другую — для каталога /sapmnt и резервных копий. На сервере базы данных SAP HANA подключите файловые системы XFS на дисках хранилища класса Premium, такие как /hana и /usr/sap. Это необходимо, чтобы предотвратить переполнение корневой файловой системы, которая имеет небольшой размер на виртуальных машинах Azure под управлением Linux.
8. Добавьте в файл /etc/hosts локальные IP-адреса тестовых виртуальных машин.
9. Добавьте в файл /etc/fstab параметр **nofail**.
10. Настройте параметры ядра в соответствии с выпуском ОС Linux, который вы используете. Дополнительные сведения см. в соответствующих примечаниях SAP, посвященных HANA, и в разделе "Параметры ядра" этого руководства.
11. Добавьте область буфера.
12. При необходимости установите на тестовых виртуальных машинах графический рабочий стол. В противном случае используйте удаленную установку SAPinst.
13. Скачайте программное обеспечение SAP из SAP Service Marketplace.
14. Создайте на виртуальной машине сервера базы данных HANA группу sapsys с идентификатором 1001.
15. Установите SAP HANA на виртуальной машине сервера базы данных с помощью диспетчера управления жизненным циклом базы данных HANA (HDBLCM).
16. Установите экземпляр SAP ASCS на виртуальной машине сервера приложений.
17. Предоставьте общий доступ к каталогу /sapmnt для тестовых виртуальных машин с помощью NFS. Виртуальная машина сервера приложений — это сервер NFS.
18. Установите на виртуальной машине сервера базы данных HANA экземпляр базы данных, в том числе HANA, с помощью SWPM.
19. Установите основной сервер приложений (PAS) на виртуальной машине сервера приложений.
20. Запустите консоль управления SAP. Подключитесь к консоли с помощью графического пользовательского интерфейса SAP или HANA Studio.

## <a name="preparing-azure-vms-for-a-manual-installation-of-sap-hana"></a>Подготовка виртуальных машин Azure к установке SAP HANA вручную
В этом разделе описываются следующие темы:

* обновления ОС;
* настройка диска;
* параметры ядра;
* файловые системы;
* файл/etc/hosts;
* файл /etc/fstab.

### <a name="os-updates"></a>Обновления ОС
Перед установкой дополнительного программного обеспечения проверьте наличие обновлений и исправлений для ОС Linux. Если вы установите исправление, возможно, вам не нужно будет обращаться в службу поддержки.

Убедитесь, что вы используете следующие операционные системы:
* SUSE Linux Enterprise Server for SAP Applications;
* Red Hat Enterprise Linux for SAP Applications или Red Hat Enterprise Linux for SAP HANA. 

Если вы еще не сделали это, зарегистрируйте развертывание операционной системы с помощью подписки Linux, предоставленной поставщиком Linux. Обратите внимание, что для SUSE есть также образы ОС для приложений SAP, которые уже содержат службы и зарегистрированы автоматически.

В примере ниже показано, как проверить наличие доступных исправлений для SUSE Linux с помощью команды **zypper**:

 `sudo zypper list-patches`

В зависимости от типа ошибки исправления классифицируются по категориям и уровню серьезности. Часто используемые значения категорий: **security** (Безопасность), **recommended** (Рекомендуемое), **optional** (Необязательное), **feature** (Компонент), **document** (Документ) или **yast** (Еще один инструмент установки).
Часто используемые значения уровней серьезности: **critical** (Критическое), **important** (Важное), **moderate** (Средней важности), **low** (Низкой важности) или **unspecified** (Не указано).

Команда **zypper** находит только те обновления, которые требуются для установленных пакетов. Например, можно использовать эту команду:

`sudo zypper patch  --category=security,recommended --severity=critical,important`

Можно добавить параметр `--dry-run`, чтобы протестировать обновление без фактического обновления системы.


### <a name="disk-setup"></a>настройка диска;
Размер корневой файловой системы на виртуальных машинах Linux в Azure ограничен. Поэтому для работы SAP на виртуальной машине Azure необходимо добавить дополнительное дисковое пространство. Для виртуальных машин Azure сервера приложений SAP достаточно использовать диски хранилища Azure класса Standard. Но для виртуальных машин Azure сервера СУБД SAP HANA использование дисков хранилища класса Premium для производственных и непроизводственных реализаций является обязательным.

Учитывая [требования программы SAP HANA TDI к хранилищу](https://www.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html), мы предлагаем следующую конфигурацию хранилища класса Premium: 

| SKU виртуальной машины | ОЗУ |  /hana/data и /hana/log, <br /> чередующиеся с диспетчером логических томов или MDADM | /hana/shared | том /root | /usr/sap |
| --- | --- | --- | --- | --- | --- |
| GS5 | 448 ГБ | 2 x P30 | 1 x P20 | 1 x P10 | 1 x P10 | 

В конфигурации диска выше том данных и журнала HANA будут размещаться в одном наборе дисков хранилища класса Premium, чередующихся с диспетчером логических томов или MDADM. Не нужно определять уровень избыточности RAID, так как хранилище Azure класса Premium сохраняет три образа дисков для обеспечения избыточности. Чтобы настроить достаточный объем хранилища, ознакомьтесь с [требованиями программы SAP HANA TDI к хранилищу](https://www.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html) и [руководством по установке и обновлению сервера SAP HANA](http://help.sap.com/saphelp_hanaplatform/helpdata/en/4c/24d332a37b4a3caad3e634f9900a45/frameset.htm). Мы рекомендуем также учитывать разные объемы пропускной способности виртуального жесткого диска (VHD) для разных дисков хранилища класса Premium. Дополнительные сведения см. в статье [Высокопроизводительное хранилище класса Premium и управляемые диски для виртуальных машин Azure](https://docs.microsoft.com/azure/storage/storage-premium-storage). 

Можно добавить дополнительные диски хранилища класса Premium на виртуальные машины СУБД HANA для хранения резервных копий журнала транзакций или базы данных.

Дополнительные сведения о двух основных средствах для настройки чередования см. в следующих статьях:

* [Настройка программного RAID-массива в Linux](../../linux/configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [Настройка диспетчера логических томов на виртуальной машине Linux в Azure](../../linux/configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)

Дополнительные сведения о присоединении дисков к виртуальным машинам Azure под управлением Linux в качестве гостевой ОС см. в статье [Добавление диска к виртуальной машине Linux](../../linux/add-disk.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

Хранилище Azure класса Premium позволяет определять режимы кэширования диска. Для чередующегося набора, который содержит тома /hana/data и /hana/log, кэширование диска нужно отключить. Для других томов (дисков) для режима кэширования необходимо установить значение **Только для чтения**.

Дополнительные сведения см. в статье [Хранилище класса "Премиум": высокопроизводительная служба хранилища для рабочих нагрузок виртуальных машин Azure](../../../storage/common/storage-premium-storage.md).

Примеры шаблонов JSON для создания виртуальных машин см. на странице с [шаблонами быстрого запуска Azure](https://github.com/Azure/azure-quickstart-templates).
Шаблон vm-simple-sles является базовым. Оно содержит раздел хранилища с дополнительным диском данных размером 100 ГБ. Этот шаблон можно использовать в качестве базы. Шаблон можно адаптировать для конкретной конфигурации.

>[!Note]
>Важно добавить диск хранилища Azure с помощью UUID, как описано в статье [Запуск SAP NetWeaver на виртуальных машинах SUSE Linux в Microsoft Azure](suse-quickstart.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

В тестовой среде к виртуальной машине сервера приложений SAP необходимо подключить два диска стандартного хранилища Azure, как показано на следующем снимке экрана. На одном хранится программное обеспечение SAP для установки (например, NetWeaver 7.5, графический пользовательский интерфейс SAP, SAP HANA). Второй диск обеспечивает достаточный объем свободного места для удовлетворения дополнительных требований (например, резервного копирования и тестовых данных) и предоставления общего доступа к каталогу /sapmnt (т. е. профилям SAP) всем виртуальным машинам, которые относятся к одному ландшафту SAP.

![Окно дисков сервера приложений SAP HANA, отображающее два диска данных и их размеры](./media/hana-get-started/image003.jpg)


### <a name="kernel-parameters"></a>параметры ядра;
Перед установкой SAP HANA необходимо указать определенные параметры ядра Linux, которые не относятся к стандартным образам из коллекции Azure и требуют настройки вручную. Для SUSE или Red Hat параметры могут отличаться. В примечаниях SAP, перечисленных выше, содержатся сведения об этих параметрах. На снимках экрана используется SUSE Linux 12 с пакетом обновления 1 (SP1). 

В общедоступной версии SLES for SAP Applications 12 GA и SLES for SAP Applications 12 с пакетом обновления 1 (SP1) добавлен новое средство (**tuned-adm**), заменяющее устаревшее средство **sapconf**. Для средства **tuned-adm** существует специальный профиль SAP HANA. Чтобы настроить систему для SAP HANA, выполните следующую команду от имени привилегированного пользователя:

   `tuned-adm profile sap-hana`

Дополнительные сведения о средстве **tuned-adm** см. в [ соответствующей документации по SUSE](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip).

На следующем снимке экрана показаны значения `transparent_hugepage` и `numa_balancing`, измененные с помощью средства **tuned-adm** в соответствии с требуемыми параметрами SAP HANA.

![Инструмент tuned-adm изменяет значения в соответствии с требуемыми параметрами SAP HANA](./media/hana-get-started/image005.jpg)

Чтобы сделать параметры ядра SAP HANA постоянными, используйте в SLES 12 загрузчик **grub2**. Дополнительные сведения о загрузчике **grub2** см. в разделе о [структуре файла конфигурации документации по SUSE](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip).

На следующем снимке экрана показаны измененные в файле конфигурации, а затем скомпилированные с помощью **grub2-mkconfig** параметры ядра:

![Параметры ядра, измененные в файле конфигурации и скомпилированные с помощью grub2-mkconfig](./media/hana-get-started/image006.jpg)

Параметры ядра также можно изменить, используя YaST или выбрав параметры **Boot Loader** > **Kernel Parameters** (Загрузчик > Параметры ядра):

![Вкладка параметров Kernel Parameters (Параметры ядра) в загрузчике YaST](./media/hana-get-started/image007.jpg)

### <a name="file-systems"></a>Файловые системы
На следующем снимке экрана показаны две файловые системы, созданные на виртуальной машине сервера приложений SAP поверх двух подключенных дисков стандартного хранилища Azure. Эти файловые системы типа XFS подключены к /sapdata и /sapsoftware.

Структурировать файловые системы таким образом необязательно. Структурировать дисковое пространство можно и с помощью других параметров. Наиболее важно предотвратить нехватку свободного места в корневой файловой системе.

![Две файловые системы, созданные на виртуальной машине сервера приложений SAP](./media/hana-get-started/image008.jpg)

Во время установки базы данных на виртуальную машину базы данных SAP HANA при использовании SWPM или **обычного** варианта установки, компоненты устанавливаются в /hana и /usr/sap. Резервная копия журналов SAP HANA по умолчанию хранится в расположении /usr/sap. Опять же, так как очень важно предотвратить нехватку свободного пространства для корневой файловой системы, перед установкой SAP HANA с помощью SWPM убедитесь, что в разделе /hana и /usr/sap достаточно свободного места.

Описание макета стандартной файловой системы SAP HANA см. в [руководстве по установке и обновлению сервера SAP HANA](http://help.sap.com/saphelp_hanaplatform/helpdata/en/4c/24d332a37b4a3caad3e634f9900a45/frameset.htm).

![Дополнительные файловые системы, созданные на виртуальной машине сервера приложений SAP](./media/hana-get-started/image009.jpg)

Когда вы устанавливаете SAP NetWeaver в среде SLES 12 или SLES for SAP Applications 12 из стандартного образа коллекции Azure, отображается сообщение о нехватке области буфера, как показано на следующем снимке экрана. Чтобы закрыть это сообщение, можно вручную добавить файл подкачки с помощью **dd**, **mkswap** и **swapon**. Инструкции см. в подразделе "Adding a Swap File Manually" (Добавление файла подкачки вручную) [раздела "Using the YaST Partitioner" (Использование модуля секционирования YaST) документации SUSE](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip).

Область буфера можно также настроить с помощью агента виртуальной машины Linux. Дополнительные сведения см. в [руководстве пользователя агента Linux Azure](../../linux/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

![Всплывающее сообщение, предупреждающее о том, что в области буфера недостаточно места](./media/hana-get-started/image010.jpg)


### <a name="the-etchosts-file"></a>файл/etc/hosts;
Перед началом установки SAP необходимо добавить в файл /etc/hosts имена узлов и IP-адреса виртуальных машин SAP. Разверните все виртуальные машины SAP в одной виртуальной сети Azure, а затем используйте внутренние IP-адреса, как показано ниже:

![Имена узлов и IP-адреса виртуальных машин SAP, приведенные в файле /etc/hosts](./media/hana-get-started/image011.jpg)

### <a name="the-etcfstab-file"></a>файл /etc/fstab.

Стоит добавить параметр **nofail** в файл fstab. При возникновении проблем с дисками этот параметр позволит виртуальной машине загрузиться, а не зависнуть в процессе загрузки. Помните, что на диске может не быть дополнительного места и процессы могут заполнить корневую файловую систему. Если /hana отсутствует, SAP HANA не запустится.

![Добавление параметра nofail в файл fstab](./media/hana-get-started/image000c.jpg)

## <a name="graphical-gnome-desktop-on-sles-12sles-for-sap-applications-12"></a>Графический рабочий стол GNOME в SLES 12 или SLES for SAP Applications 12
В этом разделе описываются следующие темы:

* Установка рабочего стола GNOME и xrdp в SLES 12 или SLES for SAP Applications 12.
* Запуск консоли управления SAP на основе Java с помощью Firefox в SLES 12 или SLES for SAP Applications 12.

Можно также использовать альтернативные варианты, например Xterminal или VNC (не описанные в этом руководстве).

### <a name="installing-the-gnome-desktop-and-xrdp-on-sles-12sles-for-sap-applications-12"></a>Установка рабочего стола GNOME и xrdp в SLES 12 или SLES for SAP Applications 12
Если у вас есть ОС Windows, для запуска Firefox, SAPinst, графического пользовательского интерфейса SAP, консоли управления SAP или HANA Studio можно использовать графический рабочий стол непосредственно в виртуальных машинах SAP под управлением Linux. Кроме того, можно подключиться к виртуальной машине по протоколу удаленного рабочего стола с компьютера Windows. В вашей компании может быть настроена политика в отношении добавления графических пользовательских интерфейсов в рабочие и нерабочие среды Linux. В таком случае вам может понадобится установить GNOME на сервер. Чтобы установить рабочий стол GNOME на виртуальную машину Azure SLES 12 или SLES for SAP Applications 12, сделайте следующее.

1. Установите рабочий стол GNOME с помощью следующей команды (например, в окне PuTTY):

   `zypper in -t pattern gnome-basic`

2. Чтобы разрешить подключение к виртуальной машине через удаленный рабочий стол, установите xrdp:

   `zypper in xrdp`

3. Измените файл /etc/sysconfig/windowmanager и установите GNOME в качестве диспетчера окон по умолчанию:

   `DEFAULT_WM="gnome"`

4. Выполните команду **chkconfig**, чтобы убедиться, что xrdp автоматически запустится после перезагрузки:

   `chkconfig -level 3 xrdp on`

5. Если с подключением RDP возникнут проблемы, попробуйте перезагрузить систему (в окне PuTTY):

   `/etc/xrdp/xrdp.sh restart`

6. Если перезапуск xrdp, упомянутый на предыдущем шаге, не работает, проверьте наличие PID-файла:

   `check /var/run` 

   Поищите `xrdp.pid`. Если вы найдете этот файл, удалите его и попробуйте еще раз перезагрузить систему.

### <a name="starting-sap-mc"></a>Запуск консоли управления SAP
Когда вы установите рабочий стол GNOME, при запуске графической консоли управления SAP на основе Java из Firefox в виртуальной машине Azure SLES 12 или SLES for SAP Applications 12 может отображаться ошибка из-за отсутствия в браузере подключаемого модуля Java.

Чтобы запустить консоль управления SAP, используйте следующий URL-адрес: `<server>:5<instance_number>13`.

Дополнительные сведения см. в разделе [Starting the Web-Based SAP Management Console](https://help.sap.com/saphelp_nwce10/helpdata/en/48/6b7c6178dc4f93e10000000a42189d/frameset.htm) (Запуск консоли управления SAP на основе веб-технологий).

На следующем снимке экрана показано сообщение об ошибке, которое отображается при отсутствии в браузере подключаемого модуля Java:

![Сообщение об ошибке, указывающее на отсутствие в браузере подключаемого модуля Java](./media/hana-get-started/image013.jpg)

Чтобы решить эту проблему, установите отсутствующий подключаемый модуль с помощью YaST, как показано на следующем снимке экрана:

![Использование YaST для установки отсутствующего подключаемого модуля](./media/hana-get-started/image014.jpg)

Когда вы повторно введете URL-адрес консоли управления SAP, отобразится сообщение с запросом на активацию подключаемого модуля:

![Диалоговое окно с запросом на активацию подключаемого модуля](./media/hana-get-started/image015.jpg)

Также может появиться сообщение об отсутствующем файле javafx.properties. Это связано с требованием наличия Oracle Java 1.8 для SAP GUI 7.4. (См. [примечание к SAP 2059429](https://launchpad.support.sap.com/#/notes/2059424)). Ни версия Java для IBM, ни пакет openjdk, поставляемый в составе SLES или SLES for SAP Applications 12, не содержат необходимый файл javafx.properties. Рекомендуется скачать и установить Java SE8 с сайта Oracle.

Сведения о подобной проблеме с openjdk в openSUSE см. в обсуждении [SAPGui 7.4 Java for openSUSE 42.1 Leap](https://scn.sap.com/thread/3908306).

## <a name="manual-installation-of-sap-hana-swpm"></a>Установка SAP HANA вручную: SWPM
На серии снимков экрана в этом разделе показаны основные действия по установке SAP NetWeaver 7.5 и SAP HANA SP12 при использовании SWPM (SAPinst). Во время установки NetWeaver 7.5 при использовании SWPM можно также установить отдельный экземпляр базы данных HANA.

В примере со средой тестирования мы установили только один сервер приложений Advanced Business Application Programming (ABAP). Как показано на следующем снимке экрана, для установки ASCS и основных экземпляров сервера приложений на одной виртуальной машине Azure и SAP HANA в качестве системы баз данных на другой виртуальной машине Azure мы использовали параметр **Distributed System** (Распределенная система).

![ASCS и основные экземпляры сервера приложений, установленные с помощью параметра "Distributed System" (Распределенная система)](./media/hana-get-started/image012.jpg)

Когда экземпляр ASCS будет установлен на виртуальной машине сервера приложений и будет отмечен в консоли управления SAP зеленой галочкой (см. снимок экрана ниже), для виртуальной машины сервера базы данных SAP HANA необходимо будет предоставить доступ к каталогу /sapmnt (содержащему каталог профилей SAP). Доступ к этому каталогу требуется во время установки базы данных. Лучший способ предоставить доступ — использовать клиент NFS, который можно настроить с помощью Yast.

![Консоль управления SAP, отображающая экземпляр ASCS, установленный на виртуальной машине сервера приложений, с заданным значением green](./media/hana-get-started/image016.jpg)

Общий доступ к каталогу /sapmnt на виртуальной машине сервера приложений необходимо предоставить через NFS-клиент с помощью параметров **rw** и **no_root_squash**. По умолчанию используются параметры **ro** и **root_squash**, но при установке экземпляра базы данных из-за них могут возникать проблемы.

![Предоставление общего доступа к каталогу /sapmnt через NFS-клиент с использованием параметров rw и no_root_squash](./media/hana-get-started/image017b.jpg)

На следующем снимке экрана показано, как на виртуальной машине сервера базы данных SAP HANA каталог /sapmnt, доступ к которому предоставляется с виртуальной машины сервера приложений, необходимо настроить с помощью **NFS-клиента** (и с помощью Yast).

![Каталог /sapmnt, настроенный с помощью NFS-клиента](./media/hana-get-started/image018b.jpg)

Для установки **экземпляра базы данных** в рамках распределенной установки NetWeaver 7.5, как показано на следующем снимке экрана, войдите на виртуальную машину сервера базы данных SAP HANA и запустите SWPM.

![Установка экземпляра базы данных путем входа на виртуальную машину сервера базы данных SAP HANA и запуска SWPM](./media/hana-get-started/image019.jpg)

Выбрав **обычную** установку и путь к установочному носителю, введите идентификатор безопасности базы данных, имя узла, число экземпляров и пароль системного администратора базы данных.

![Страница входа в систему системного администратора базы данных SAP HANA](./media/hana-get-started/image035b.jpg)

Введите пароль схемы DBACOCKPIT:

![Поле для ввода пароля для схемы DBACockpit](./media/hana-get-started/image036b.jpg)

Введите вопрос для пароля схемы SAPABAP1:

![Ввод вопроса для пароля схемы SAPABAP1](./media/hana-get-started/image037b.jpg)

После выполнения каждого задания рядом с каждым этапом процесса установки базы данных появится зеленая галочка. Отобразится сообщение "Execution of ... Database Instance has completed" (Выполнение экземпляра базы данных (...) завершено).

![Окно выполнения задачи, содержащее сообщение с подтверждением](./media/hana-get-started/image023.jpg)

После успешной установки в консоли управления SAP возле экземпляра базы данных также будет установлена зеленая галочка и отобразится список всех процессов SAP HANA (hdbindexserver, hdbcompileserver и т. д.).

![Окно консоли управления SAP со списком процессов SAP HANA](./media/hana-get-started/image024.jpg)

На следующем снимке экрана показаны части структуры файла в каталоге /hana/shared, созданном SWPM во время установки HANA. Так как невозможно указать другой путь, перед установкой SAP HANA с помощью SWPM важно подключить дополнительное дисковое пространство в каталоге /hana. Оно обеспечивает достаточный объем памяти для корневой файловой системы.

![Структура файла каталога /hana/shared, созданного во время установки HANA](./media/hana-get-started/image025.jpg)

На этом снимке экрана показана структура файла каталога /usr/sap:

![Структура файла каталога usr/sap/](./media/hana-get-started/image026.jpg)

Последний шаг распределенной установки ABAP — это установка основного экземпляра сервера приложений:

![Установка ABAP, отображающая основной экземпляр сервера приложений в качестве завершающего этапа](./media/hana-get-started/image027b.jpg)

После установки основного экземпляра сервера приложений и графического пользовательского интерфейса SAP с помощью транзакции **DBA Cockpit** убедитесь, что установка SAP HANA выполнена правильно:

![Окно DBACockpit с подтверждением успешной установки](./media/hana-get-started/image028b.jpg)

В качестве последнего шага на виртуальной машине сервера приложений SAP можно установить HANA Studio, а затем подключить ее к экземпляру SAP HANA, запущенному на виртуальной машине сервера базы данных:

![Установка SAP HANA Studio на виртуальной машине сервера приложений SAP](./media/hana-get-started/image038b.jpg)

## <a name="manual-installation-of-sap-hana-hdblcm"></a>Установка SAP HANA вручную: HDBLCM
Кроме установки SAP HANA в рамках распределенной установки с помощью SWPM, можно сначала установить только HANA с помощью HDBLCM. Затем можно установить SAP NetWeaver 7.5. Процесс показан на снимках экрана в этом разделе.

Дополнительные сведения о средстве HDBLCM HANA см. в следующих источниках:

* [Choosing the Correct SAP HANA HDBLCM for Your Task (Выбор подходящего средства SAP HANA HDBLCM для выполнения определенных заданий)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/68/5cff570bb745d48c0ab6d50123ca60/content.htm)
* [SAP HANA Lifecycle Management Tools (Средства управления жизненным циклом SAP Hana)](http://saphanatutorial.com/sap-hana-lifecycle-management-tools/)
* [SAP HANA Server Installation and Update Guide (Руководство по установке и обновлению сервера SAP Hana)](http://help.sap.com/hana/SAP_HANA_Server_Installation_Guide_en.pdf)

Чтобы избежать проблем с настройкой идентификатора группы по умолчанию для пользователя `\<HANA SID\>adm user` (созданного с помощью средства HDBLCM), перед установкой SAP HANA с помощью HDBLCM необходимо определить новую группу `sapsys` с помощью идентификатора группы `1001`:

![Новая группа sapsys, определенная с использованием идентификатора группы 1001](./media/hana-get-started/image030.jpg)

При запуске HDBLCM в первый раз отображается простое главное меню. Выберите пункт 1, **Install new system** (Установка новой системы), как показано на следующем снимке экрана:

![Параметр "Install new system" (Установка новой системы) в окне запуска HDBLCM](./media/hana-get-started/image031.jpg)

На следующем снимке экрана отображаются все ранее выбранные основные параметры.

> [!IMPORTANT]
> Каталоги, используемые для журналов и томов данных HANA, а также путь установки (/hana/shared в этом примере) и /usr/sap, не должны быть частью корневой файловой системы. Эти каталоги принадлежат к дискам данных Azure, которые присоединены к виртуальной машине, как описано в разделе "Настройка диска". Такой подход обеспечивает достаточный объем памяти для корневой файловой системы. На следующем снимке экрана можно увидеть, что у системного администратора HANA есть идентификатор пользователя `1005`, а сам он является участником группы `sapsys` (ID `1001`), которая определена до установки.

![Список всех выбранных ранее основных компонентов SAP HANA](./media/hana-get-started/image032.jpg)

Вы можете найти сведения пользователя `\<HANA SID\>adm user` (`azdadm` на следующем снимке экрана) в каталоге /etc/passwd:

![Сведения о пользователе \<HANA SID\>adm user в каталоге /etc/passwd](./media/hana-get-started/image033.jpg)

После установки SAP HANA с помощью HDBLCM в SAP HANA Studio отобразится структура файла, как показано на следующем снимке экрана. Схема SAPABAP1 со всеми таблицами SAP NetWeaver еще недоступна.

![Структура файла SAP HANA в SAP HANA Studio](./media/hana-get-started/image034.jpg)

После установки SAP HANA на его основе можно установить SAP NetWeaver. Как показано на следующем снимке экрана, установка выполнена как "распределенная" с помощью SWPM (как описано в предыдущем разделе). При установке экземпляра базы данных с помощью SWPM вводятся те же данные, что и при использовании HDBLCM (например, имя узла, идентификатор безопасности HANA и число экземпляров). Затем SWPM использует имеющуюся установку HANA и добавляет дополнительные схемы.

![Распределенная установка, выполненная с помощью SWPM](./media/hana-get-started/image035b.jpg)

На следующем снимке экрана показан этап установки SWPM с вводом данных о схеме DBACOCKPIT:

![Этап установки SWPM, на котором вводятся данные о схеме DBACockpit](./media/hana-get-started/image036b.jpg)

Введите данные о схеме SAPABAP1:

![Ввод данных о схеме SAPABAP1](./media/hana-get-started/image037b.jpg)

После установки экземпляра базы данных SWPM схема SAPABAP1 отобразится в SAP HANA Studio:

![Схема SAPABAP1 в SAP HANA Studio](./media/hana-get-started/image038b.jpg)

Наконец, после установки сервера приложений SAP и графического пользовательского интерфейса SAP можно проверить экземпляр базы данных HANA с помощью транзакции **DBA Cockpit**:

![Экземпляр базы данных HANA, проверенный с помощью транзакции DBA Cockpit](./media/hana-get-started/image039b.jpg)


## <a name="sap-software-downloads"></a>Скачивания программного обеспечения SAP
Программное обеспечение можно скачать с SAP Service Marketplace, как показано на следующих снимках экрана.

Скачивание NetWeaver 7.5 для Linux и HANA.

 ![Окно установки и обновления службы SAP для скачивания NetWeaver 7.5](./media/hana-get-started/image001.jpg)

Скачивание выпуска HANA SP12 Platform.

 ![Окно установки и обновления службы SAP для скачивания выпуска HANA SP12 Platform](./media/hana-get-started/image002.jpg)

