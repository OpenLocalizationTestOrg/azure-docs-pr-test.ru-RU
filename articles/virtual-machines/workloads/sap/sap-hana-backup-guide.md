---
title: "aaaBackup руководство по SAP HANA на виртуальных машинах Azure | Документы Microsoft"
description: "Рекомендации по использованию двух основных возможностей резервного копирования SAP HANA на виртуальных машинах Azure."
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: e651091bb5da2698ec8bf80cad405bfce5b192cf
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="backup-guide-for-sap-hana-on-azure-virtual-machines"></a><span data-ttu-id="8f13c-103">Руководство по резервному копированию SAP HANA на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="8f13c-103">Backup guide for SAP HANA on Azure Virtual Machines</span></span>

## <a name="getting-started"></a><span data-ttu-id="8f13c-104">Приступая к работе</span><span class="sxs-lookup"><span data-stu-id="8f13c-104">Getting Started</span></span>

<span data-ttu-id="8f13c-105">руководстве по резервному копированию Hello для SAP HANA, работающих на виртуальных машинах Azure рассматриваются только разделах, посвященных Azure.</span><span class="sxs-lookup"><span data-stu-id="8f13c-105">hello backup guide for SAP HANA running on Azure virtual Machines will only describe Azure-specific topics.</span></span> <span data-ttu-id="8f13c-106">Общие SAP HANA резервного копирования связанных элементов, см. документацию SAP HANA hello (см. _резервного копирования документации SAP HANA_ далее в этой статье).</span><span class="sxs-lookup"><span data-stu-id="8f13c-106">For general SAP HANA backup related items, check hello SAP HANA documentation (see _SAP HANA backup documentation_ later in this article).</span></span>

<span data-ttu-id="8f13c-107">Hello в этой статье нацелено на две основные резервного копирования возможности для SAP HANA на виртуальных машинах Azure:</span><span class="sxs-lookup"><span data-stu-id="8f13c-107">hello focus of this article is on two major backup possibilities for SAP HANA on Azure virtual machines:</span></span>

- <span data-ttu-id="8f13c-108">HANA toohello резервного копирования файловой системы на виртуальной машине Azure Linux (см. [SAP HANA Azure резервное копирование на уровне файлов](sap-hana-backup-file-level.md))</span><span class="sxs-lookup"><span data-stu-id="8f13c-108">HANA backup toohello file system in an Azure Linux Virtual Machine (see [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md))</span></span>
- <span data-ttu-id="8f13c-109">Резервное копирование HANA на основе хранилища моментальных снимков, с помощью функции моментального снимка большого двоичного объекта хранилища Azure hello вручную или службы резервного копирования Azure (см. [SAP HANA резервной копии, основанные на моментальных снимках хранилища](sap-hana-backup-storage-snapshots.md))</span><span class="sxs-lookup"><span data-stu-id="8f13c-109">HANA backup based on storage snapshots using hello Azure storage blob snapshot feature manually or Azure Backup Service (see [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md))</span></span>

<span data-ttu-id="8f13c-110">SAP HANA предлагает API, который позволяет toointegrate сторонних средств резервного копирования непосредственно с SAP HANA резервной копии.</span><span class="sxs-lookup"><span data-stu-id="8f13c-110">SAP HANA offers a backup API, which allows third-party backup tools toointegrate directly with SAP HANA.</span></span> <span data-ttu-id="8f13c-111">(Это не внутри области hello данного руководства.) Сейчас этот API-интерфейс не поддерживает прямую интеграцию SAP HANA со службой архивации Azure.</span><span class="sxs-lookup"><span data-stu-id="8f13c-111">(That is not within hello scope of this guide.) There is no direct integration of SAP HANA with Azure Backup service available right now based on this API.</span></span>

<span data-ttu-id="8f13c-112">SAP HANA официально поддерживается на виртуальной Машине Azure тип GS5 как один экземпляр с рабочими нагрузками tooOLAP дополнительное ограничение (см. [найти платформы IaaS сертифицированные](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) на веб-сайте hello SAP).</span><span class="sxs-lookup"><span data-stu-id="8f13c-112">SAP HANA is officially supported on Azure VM type GS5 as single instance with an additional restriction tooOLAP workloads (see [Find Certified IaaS Platforms](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) on hello SAP website).</span></span> <span data-ttu-id="8f13c-113">При добавлении новых предложений для SAP HANA в Azure мы обновим эту статью.</span><span class="sxs-lookup"><span data-stu-id="8f13c-113">This article will be updated as new offerings for SAP HANA on Azure become available.</span></span>

<span data-ttu-id="8f13c-114">В Azure также доступно гибридное решение SAP HANA, где эта платформа выполняется на невиртуализированных физических серверах.</span><span class="sxs-lookup"><span data-stu-id="8f13c-114">There is also an SAP HANA hybrid solution available on Azure, where SAP HANA runs non-virtualized on physical servers.</span></span> <span data-ttu-id="8f13c-115">Тем не менее, в этом руководстве по резервному копированию SAP HANA в Azure рассматривается чистая среда Azure, где SAP HANA выполняется на виртуальной машине Azure, а не в &quot;крупных экземплярах&quot;. Дополнительные сведения об этом решении для резервного копирования в &quot;крупных экземплярах&quot; на основе моментальных снимков хранилища см. в статье [Обзор и описание архитектуры SAP HANA в Azure (крупные экземпляры)](hana-overview-architecture.md).</span><span class="sxs-lookup"><span data-stu-id="8f13c-115">However, this SAP HANA Azure backup guide covers a pure Azure environment where SAP HANA runs in an Azure VM, not SAP HANA running on &quot;large instances.&quot; See [SAP HANA (large instances) overview and architecture on Azure](hana-overview-architecture.md) for more information about this backup solution on &quot;large instances&quot; based on storage snapshots.</span></span>

<span data-ttu-id="8f13c-116">Общие сведения о продуктах SAP, поддерживаемых в Azure, см. в [примечании SAP 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span><span class="sxs-lookup"><span data-stu-id="8f13c-116">General information about SAP products supported on Azure can be found in [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span></span>

<span data-ttu-id="8f13c-117">Hello следующих трех значений обзора hello SAP HANA параметры резервного копирования с помощью собственных возможностей Azure в настоящее время, а также отображается три возможных будущих сценарии резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="8f13c-117">hello following three figures give an overview of hello SAP HANA backup options using native Azure capabilities currently, and also show three potential future backup scenarios.</span></span> <span data-ttu-id="8f13c-118">Hello других связанных статьях [SAP HANA Azure резервное копирование на уровне файлов](sap-hana-backup-file-level.md) и [SAP HANA резервной копии, основанные на моментальных снимках хранилища](sap-hana-backup-storage-snapshots.md) описываются эти возможности более подробно, включая рекомендации по размеру и производительности для SAP HANA резервные копии, которые multi терабайт.</span><span class="sxs-lookup"><span data-stu-id="8f13c-118">hello related articles [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) and [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describe these options in more detail, including size and performance considerations for SAP HANA backups that are multi-terabytes in size.</span></span>

![На этом рисунке показано две возможности по сохранению hello текущее состояние виртуальной Машины](media/sap-hana-backup-guide/image001.png)

<span data-ttu-id="8f13c-120">На этом рисунке показано hello возможность сохранения hello текущее состояние виртуальной Машины, или с помощью службы архивации Azure или ручной моментальных снимков дисков виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="8f13c-120">This figure shows hello possibility of saving hello current VM state, either via Azure Backup service or manual snapshot of VM disks.</span></span> <span data-ttu-id="8f13c-121">Этот подход, один &#39; t полностью резервные копии toomanage SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-121">With this approach, one doesn&#39;t have toomanage SAP HANA backups.</span></span> <span data-ttu-id="8f13c-122">Задача Hello сценария моментального снимка hello диска — целостность файловой системы и состояния диска согласованных на уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="8f13c-122">hello challenge of hello disk snapshot scenario is file system consistency, and an application-consistent disk state.</span></span> <span data-ttu-id="8f13c-123">Hello согласованности разделе рассматривается в разделе hello _целостности данных SAP HANA, когда создание хранилища моментальных снимков_ далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="8f13c-123">hello consistency topic is discussed in hello section _SAP HANA data consistency when taking storage snapshots_ later in this article.</span></span> <span data-ttu-id="8f13c-124">Возможности и ограничения службы резервного копирования Azure, касающиеся резервного копирования HANA tooSAP также описаны далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="8f13c-124">Capabilities and restrictions of Azure Backup service related tooSAP HANA backups are also discussed later in this article.</span></span>

![На этом рисунке показано, что параметры для перевода SAP HANA файлов резервной копии внутри hello виртуальной Машины](media/sap-hana-backup-guide/image002.png)

<span data-ttu-id="8f13c-126">На этом рисунке показано параметры созданием резервной копии файла SAP HANA внутри hello виртуальной Машины и затем запоминался файлов резервных копий HANA где-либо еще, с помощью различных средств.</span><span class="sxs-lookup"><span data-stu-id="8f13c-126">This figure shows options for taking an SAP HANA file backup inside hello VM, and then storing it HANA backup files somewhere else using different tools.</span></span> <span data-ttu-id="8f13c-127">Для создания резервной копии HANA требуется больше времени, чем для выполнения этого процесса на основе моментальных снимков, но первый вариант более целесообразный в плане целостности и согласованности данных.</span><span class="sxs-lookup"><span data-stu-id="8f13c-127">Taking a HANA backup requires more time than a snapshot-based backup solution, but it has advantages regarding integrity and consistency.</span></span> <span data-ttu-id="8f13c-128">Дополнительные сведения приведены далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="8f13c-128">More details are provided later in this article.</span></span>

![Возможный будущий сценарий резервного копирования SAP HANA](media/sap-hana-backup-guide/image003.png)

<span data-ttu-id="8f13c-130">На рисунке выше показан возможный будущий сценарий резервного копирования SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-130">This figure shows a potential future SAP HANA backup scenario.</span></span> <span data-ttu-id="8f13c-131">Если SAP HANA поддерживает создание резервных копий во вторичном экземпляре репликации, это обеспечивает дополнительные возможности резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="8f13c-131">If SAP HANA allowed taking backups from a replication secondary, it would add additional options for backup strategies.</span></span> <span data-ttu-id="8f13c-132">В настоящее время не существует в соответствии с tooa post в hello SAP HANA вики-сайте:</span><span class="sxs-lookup"><span data-stu-id="8f13c-132">Currently it isn't possible according tooa post in hello SAP HANA Wiki:</span></span>

<span data-ttu-id="8f13c-133">_&quot;Это возможно tootake резервные копии на стороне получателя hello?_</span><span class="sxs-lookup"><span data-stu-id="8f13c-133">_&quot;Is it possible tootake backups on hello secondary side?_</span></span>

<span data-ttu-id="8f13c-134">_Нет, в настоящее время можно получать данные и только резервную копию журнала на первичной стороне hello. Резервное копирование автоматический вход при включении после слиянию компании toohello задняя сторона, резервные копии журналов hello автоматически записывается существует.&quot;_</span><span class="sxs-lookup"><span data-stu-id="8f13c-134">_No, currently you can only take data and log backups on hello primary side. If automatic log backup is enabled, after takeover toohello secondary side, hello log backups will automatically be written there.&quot;_</span></span>

## <a name="sap-resources-for-hana-backup"></a><span data-ttu-id="8f13c-135">Ресурсы SAP для резервного копирования HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-135">SAP resources for HANA backup</span></span>

### <a name="sap-hana-backup-documentation"></a><span data-ttu-id="8f13c-136">Документация по резервному копированию SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-136">SAP HANA backup documentation</span></span>

- [<span data-ttu-id="8f13c-137">Введение tooSAP HANA администрирования</span><span class="sxs-lookup"><span data-stu-id="8f13c-137">Introduction tooSAP HANA Administration</span></span>](https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.00/en-US)
- <span data-ttu-id="8f13c-138">[Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) (Планирование стратегии резервного копирования и восстановления)</span><span class="sxs-lookup"><span data-stu-id="8f13c-138">[Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)</span></span>
- <span data-ttu-id="8f13c-139">[Schedule HANA Backup using ABAP DBACOCKPIT](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html) (Планирование резервного копирования HANA с помощью ABAP DBACOCKPIT)</span><span class="sxs-lookup"><span data-stu-id="8f13c-139">[Schedule HANA Backup using ABAP DBACOCKPIT](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html)</span></span>
- <span data-ttu-id="8f13c-140">[Schedule Data Backups (SAP HANA Cockpit)](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm) (Планирование резервного копирования данных (панель SAP HANA))</span><span class="sxs-lookup"><span data-stu-id="8f13c-140">[Schedule Data Backups (SAP HANA Cockpit)](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm)</span></span>
- <span data-ttu-id="8f13c-141">Часто задаваемые вопросы о резервном копировании SAP HANA см. в [примечании к SAP 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span><span class="sxs-lookup"><span data-stu-id="8f13c-141">FAQ about SAP HANA backup in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span></span>
- <span data-ttu-id="8f13c-142">Часто задаваемые вопросы о моментальных снимках базы данных и хранилища SAP HANA см. в [примечании к SAP 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span><span class="sxs-lookup"><span data-stu-id="8f13c-142">FAQ about SAP HANA database and storage snapshots in [SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span></span>
- <span data-ttu-id="8f13c-143">Сведения о сетевых файловых системах (NFS), неподдерживаемых для резервного копирования и восстановления, см. в [примечании к SAP 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span><span class="sxs-lookup"><span data-stu-id="8f13c-143">Unsuitable network file systems for backup and recovery in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span></span>

### <a name="why-sap-hana-backup"></a><span data-ttu-id="8f13c-144">Преимущества резервного копирования SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-144">Why SAP HANA backup?</span></span>

<span data-ttu-id="8f13c-145">Хранилище Azure обеспечивает доступность и надежность стандартной hello (см. [tooMicrosoft введение хранилища Azure](../../../storage/common/storage-introduction.md) Дополнительные сведения о хранилище Azure).</span><span class="sxs-lookup"><span data-stu-id="8f13c-145">Azure storage offers availability and reliability out of hello box (see [Introduction tooMicrosoft Azure Storage](../../../storage/common/storage-introduction.md) for more information about Azure storage).</span></span>

<span data-ttu-id="8f13c-146">Минимальное значение для Hello &quot;резервного копирования&quot; — toorely на hello Azure соглашений об уровне обслуживания, хранение hello SAP HANA файлов данных и журналов на сервере SAP HANA вложенного toohello Azure виртуальные жесткие диски виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="8f13c-146">hello minimum for &quot;backup&quot; is toorely on hello Azure SLAs, keeping hello SAP HANA data and log files on Azure VHDs attached toohello SAP HANA server VM.</span></span> <span data-ttu-id="8f13c-147">Этот подход охватывает сбои виртуальной Машины, но не потенциальных данных SAP HANA toohello повреждения и файлы журнала или логические ошибки, например удаление файлов данных или случайно.</span><span class="sxs-lookup"><span data-stu-id="8f13c-147">This approach covers VM failures, but not potential damage toohello SAP HANA data and log files, or logical errors like deleting data or files by accident.</span></span> <span data-ttu-id="8f13c-148">Резервные копии также необходимы для обеспечения соответствия требованиям или по юридическим причинам.</span><span class="sxs-lookup"><span data-stu-id="8f13c-148">Backups are also required for compliance or legal reasons.</span></span> <span data-ttu-id="8f13c-149">Короче говоря, резервные копии SAP HANA нужны всегда.</span><span class="sxs-lookup"><span data-stu-id="8f13c-149">In short, there is always a need for SAP HANA backups.</span></span>

### <a name="how-tooverify-correctness-of-sap-hana-backup"></a><span data-ttu-id="8f13c-150">Как tooverify правильность SAP HANA резервного копирования</span><span class="sxs-lookup"><span data-stu-id="8f13c-150">How tooverify correctness of SAP HANA backup</span></span>
<span data-ttu-id="8f13c-151">При использовании моментальных снимков хранилища мы советуем выполнять тестовое восстановление в другой системе.</span><span class="sxs-lookup"><span data-stu-id="8f13c-151">When using storage snapshots, running a test restore on a different system is recommended.</span></span> <span data-ttu-id="8f13c-152">Такой подход обеспечивает tooensure способом, резервная копия является правильный и внутренние процессы для резервного копирования и восстановления рабочих, как ожидалось.</span><span class="sxs-lookup"><span data-stu-id="8f13c-152">This approach provides a way tooensure that a backup is correct, and internal processes for backup and restore work as expected.</span></span> <span data-ttu-id="8f13c-153">Хотя такой подход значительно препятствие локально, это гораздо проще tooaccomplish в облаке hello временно предоставляя необходимые ресурсы для этой цели.</span><span class="sxs-lookup"><span data-stu-id="8f13c-153">While this is a significant hurdle on-premises, it is much easier tooaccomplish in hello cloud by providing necessary resources temporarily for this purpose.</span></span>

<span data-ttu-id="8f13c-154">Обратите внимание, что недостаточно выполнить простое восстановление и проверку, когда платформа HANA настроена и запущена.</span><span class="sxs-lookup"><span data-stu-id="8f13c-154">Keep in mind that doing a simple restore and checking if HANA is up and running is not sufficient.</span></span> <span data-ttu-id="8f13c-155">В идеальном случае один должна выполняться проверка таблицы согласованности, toobe hello восстановления базы данных должно быть нормально.</span><span class="sxs-lookup"><span data-stu-id="8f13c-155">Ideally, one should run a table consistency check toobe sure that hello restored database is fine.</span></span> <span data-ttu-id="8f13c-156">SAP HANA предлагает несколько типов проверок согласованности (см. [примечание к SAP 1977584](https://launchpad.support.sap.com/#/notes/1977584)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-156">SAP HANA offers several kinds of consistency checks described in [SAP Note 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span></span>

<span data-ttu-id="8f13c-157">Сведения о hello проверка согласованности таблицы также можно найти на веб-сайте SAP hello по [таблицы и проверки целостности каталога](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span><span class="sxs-lookup"><span data-stu-id="8f13c-157">Information about hello table consistency check can also be found on hello SAP website at [Table and Catalog Consistency Checks](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span></span>

<span data-ttu-id="8f13c-158">Для стандартных резервных копий файлов тестовое восстановление выполнять не обязательно.</span><span class="sxs-lookup"><span data-stu-id="8f13c-158">For standard file backups, a test restore is not necessary.</span></span> <span data-ttu-id="8f13c-159">Можно использовать два средства SAP HANA, которые помогают toocheck, какую резервную копию можно использовать для восстановления: hdbbackupdiag и hdbbackupcheck.</span><span class="sxs-lookup"><span data-stu-id="8f13c-159">There are two SAP HANA tools that help toocheck which backup can be used for restore: hdbbackupdiag and hdbbackupcheck.</span></span> <span data-ttu-id="8f13c-160">Дополнительные сведения об этих средствах см. в статье [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) (Проверка возможности восстановления вручную).</span><span class="sxs-lookup"><span data-stu-id="8f13c-160">See [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) for more information about these tools.</span></span>

### <a name="pros-and-cons-of-hana-backup-versus-storage-snapshot"></a><span data-ttu-id="8f13c-161">Преимущества и недостатки резервной копии HANA и резервной копии на основе моментального снимка хранилища</span><span class="sxs-lookup"><span data-stu-id="8f13c-161">Pros and cons of HANA backup versus storage snapshot</span></span>

<span data-ttu-id="8f13c-162">SAP &#39; t предпочтения позволяют tooeither резервного копирования HANA и хранения моментальных снимков.</span><span class="sxs-lookup"><span data-stu-id="8f13c-162">SAP doesn&#39;t give preference tooeither HANA backup versus storage snapshot.</span></span> <span data-ttu-id="8f13c-163">Перечисляет их преимущества и недостатки, поэтому один можно определить, какие toouse в зависимости от ситуации hello и технологии доступное хранилище (в разделе [планирование Your резервной копии и стратегия восстановления](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-163">It lists their pros and cons, so one can determine which toouse depending on hello situation and available storage technology (see [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span></span>

<span data-ttu-id="8f13c-164">В Azure, имейте в виду обстоятельство hello, hello функция моментальный снимок BLOB-объектов Azure &#39; t гарантировать целостность файловой системы (в разделе [моментальные снимки больших двоичных объектов с помощью PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-164">On Azure, be aware of hello fact that hello Azure blob snapshot feature doesn&#39;t guarantee file system consistency (see [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span></span> <span data-ttu-id="8f13c-165">Здравствуйте, следующем разделе _целостности данных SAP HANA, когда создание хранилища моментальных снимков_, рассматриваются некоторые вопросы, касающиеся этой функции.</span><span class="sxs-lookup"><span data-stu-id="8f13c-165">hello next section, _SAP HANA data consistency when taking storage snapshots_, discusses some considerations regarding this feature.</span></span>

<span data-ttu-id="8f13c-166">Кроме того, есть toounderstand hello финансовые последствия при работе часто с моментальными снимками BLOB-объектов, как описано в этой статье: [основные сведения о том, как моментальные снимки увеличивают плату](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)— он &#39; t очевидны, как с помощью Azure виртуальные диски.</span><span class="sxs-lookup"><span data-stu-id="8f13c-166">In addition, one has toounderstand hello billing implications when working frequently with blob snapshots as described in this article: [Understanding How Snapshots Accrue Charges](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)—it isn&#39;t as obvious as using Azure virtual disks.</span></span>

### <a name="sap-hana-data-consistency-when-taking-storage-snapshots"></a><span data-ttu-id="8f13c-167">Согласованность данных SAP HANA при создании моментальных снимков хранилища</span><span class="sxs-lookup"><span data-stu-id="8f13c-167">SAP HANA data consistency when taking storage snapshots</span></span>

<span data-ttu-id="8f13c-168">При создании моментальных снимков хранилища обеспечение согласованности файловой системы и приложения связанно с определенными проблемами.</span><span class="sxs-lookup"><span data-stu-id="8f13c-168">File system and application consistency is a complex issue when taking storage snapshots.</span></span> <span data-ttu-id="8f13c-169">Hello простым способом tooavoid проблем бы быть tooshut вниз SAP HANA или даже hello всей виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="8f13c-169">hello easiest way tooavoid problems would be tooshut down SAP HANA, or maybe even hello whole virtual machine.</span></span> <span data-ttu-id="8f13c-170">Это можно выполнить в прототипе, демонстрационной системе или даже в системе разработки. Но это не вариант для рабочей системы.</span><span class="sxs-lookup"><span data-stu-id="8f13c-170">A shutdown might be doable with a demo or prototype, or even a development system, but it is not an option for a production system.</span></span>

<span data-ttu-id="8f13c-171">В Azure один имеет tookeep помните, что hello функция моментальный снимок BLOB-объектов Azure &#39; t гарантировать целостность файловой системы.</span><span class="sxs-lookup"><span data-stu-id="8f13c-171">On Azure, one has tookeep in mind that hello Azure blob snapshot feature doesn&#39;t guarantee file system consistency.</span></span> <span data-ttu-id="8f13c-172">Он хорошо работает тем не менее с помощью hello SAP HANA моментальных снимков компонент, при условии, что существует только один виртуальный диск.</span><span class="sxs-lookup"><span data-stu-id="8f13c-172">It works fine however by using hello SAP HANA snapshot feature, as long as there is only a single virtual disk involved.</span></span> <span data-ttu-id="8f13c-173">Но даже с одного диска, дополнительные элементы, которые имеют toobe проверяется.</span><span class="sxs-lookup"><span data-stu-id="8f13c-173">But even with a single disk, additional items have toobe checked.</span></span> <span data-ttu-id="8f13c-174">В [примечании к SAP 2039883](https://launchpad.support.sap.com/#/notes/2039883) приведены важные сведения о резервных копиях SAP HANA и моментальных снимках хранилища.</span><span class="sxs-lookup"><span data-stu-id="8f13c-174">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) has important information about SAP HANA backups via storage snapshots.</span></span> <span data-ttu-id="8f13c-175">Например, сообщение о том, что, с использованием hello XFS файловой системы, это необходимые toorun **xfs\_закрепить** до начала хранилища моментальных снимков согласованности tooguarantee (см. [xfs\_freeze(8) - Linux man страница](https://linux.die.net/man/8/xfs_freeze) сведения о **xfs\_закрепить**).</span><span class="sxs-lookup"><span data-stu-id="8f13c-175">For example, it mentions that, with hello XFS file system, it is necessary toorun **xfs\_freeze** before starting a storage snapshot tooguarantee consistency (see [xfs\_freeze(8) - Linux man page](https://linux.die.net/man/8/xfs_freeze) for details on **xfs\_freeze**).</span></span>

<span data-ttu-id="8f13c-176">раздел Hello согласованности еще сложнее в случае, когда одну файловую систему охватывает несколько дисков или томов.</span><span class="sxs-lookup"><span data-stu-id="8f13c-176">hello topic of consistency becomes even more challenging in a case where a single file system spans multiple disks/volumes.</span></span> <span data-ttu-id="8f13c-177">Примером может служить чередование данных с помощью mdadm или LVM.</span><span class="sxs-lookup"><span data-stu-id="8f13c-177">For example, by using mdadm or LVM and striping.</span></span> <span data-ttu-id="8f13c-178">Hello вышеупомянутых состояний Примечание SAP:</span><span class="sxs-lookup"><span data-stu-id="8f13c-178">hello SAP Note mentioned above states:</span></span>

<span data-ttu-id="8f13c-179">_&quot;Но следует помнить, что система хранения hello имеет согласованности tooguarantee ввода-вывода при создании моментального снимка хранилища на том данных SAP HANA, т. е. создания снимков тома данных служб SAP HANA должен быть атомарной операции.&quot;_</span><span class="sxs-lookup"><span data-stu-id="8f13c-179">_&quot;But keep in mind that hello storage system has tooguarantee I/O consistency while creating a storage snapshot per SAP HANA data volume, i.e. snapshotting of an SAP HANA service-specific data volume must be an atomic operation.&quot;_</span></span>

<span data-ttu-id="8f13c-180">При условии, что имеется в файловой системе XFS охват четыре Azure виртуальные диски, hello ниже перечислены шаги согласованный моментальный снимок, представляющий область данных HANA hello.</span><span class="sxs-lookup"><span data-stu-id="8f13c-180">Assuming there is an XFS file system spanning four Azure virtual disks, hello following steps provide a consistent snapshot that represents hello HANA data area:</span></span>

- <span data-ttu-id="8f13c-181">Подготовьте моментальный снимок HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-181">HANA snapshot prepare</span></span>
- <span data-ttu-id="8f13c-182">Закрепить hello файловой системы (например, использовать **xfs\_закрепить**)</span><span class="sxs-lookup"><span data-stu-id="8f13c-182">Freeze hello file system (for example, use **xfs\_freeze**)</span></span>
- <span data-ttu-id="8f13c-183">Создайте все необходимые моментальные снимки больших двоичных объектов в Azure.</span><span class="sxs-lookup"><span data-stu-id="8f13c-183">Create all necessary blob snapshots on Azure</span></span>
- <span data-ttu-id="8f13c-184">Отмена закрепления hello файловой системы</span><span class="sxs-lookup"><span data-stu-id="8f13c-184">Unfreeze hello file system</span></span>
- <span data-ttu-id="8f13c-185">Подтвердите моментального снимка HANA hello</span><span class="sxs-lookup"><span data-stu-id="8f13c-185">Confirm hello HANA snapshot</span></span>

<span data-ttu-id="8f13c-186">Рекомендуется toouse hello описанную выше процедуру в все случаи toobe со стороны hello безопасный, независимо от того, какой файловой системы.</span><span class="sxs-lookup"><span data-stu-id="8f13c-186">Recommendation is toouse hello procedure above in all cases toobe on hello safe side, no matter which file system.</span></span> <span data-ttu-id="8f13c-187">Кроме того, его можно использовать при наличии одного диска или при чередовании данных по нескольким дискам с помощью mdadm или LVM.</span><span class="sxs-lookup"><span data-stu-id="8f13c-187">Or if it is a single disk or striping, via mdadm or LVM across multiple disks.</span></span>

<span data-ttu-id="8f13c-188">Это важные tooconfirm hello HANA снимка.</span><span class="sxs-lookup"><span data-stu-id="8f13c-188">It is important tooconfirm hello HANA snapshot.</span></span> <span data-ttu-id="8f13c-189">Из-за toohello &quot;копирования при записи,&quot; SAP HANA не может потребоваться дополнительное место на диске в этом режиме подготовки моментального снимка.</span><span class="sxs-lookup"><span data-stu-id="8f13c-189">Due toohello &quot;Copy-on-Write,&quot; SAP HANA might not require additional disk space while in this snapshot-prepare mode.</span></span> <span data-ttu-id="8f13c-190">&#39; s также невозможно toostart новых резервных копий до моментального снимка SAP HANA hello подтверждается.</span><span class="sxs-lookup"><span data-stu-id="8f13c-190">It&#39;s also not possible toostart new backups until hello SAP HANA snapshot is confirmed.</span></span>

<span data-ttu-id="8f13c-191">Служба резервного копирования Azure использует tootake расширений ВМ Azure заботиться о hello целостность файловой системы.</span><span class="sxs-lookup"><span data-stu-id="8f13c-191">Azure Backup service uses Azure VM extensions tootake care of hello file system consistency.</span></span> <span data-ttu-id="8f13c-192">Эти расширения недоступны для автономного использования.</span><span class="sxs-lookup"><span data-stu-id="8f13c-192">These VM extensions are not available for standalone usage.</span></span> <span data-ttu-id="8f13c-193">Один по-прежнему имеет согласованности toomanage SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-193">One still has toomanage SAP HANA consistency.</span></span> <span data-ttu-id="8f13c-194">Hello см. в статье [SAP HANA Azure Backup на уровне файла](sap-hana-backup-file-level.md) для получения дополнительной информации.</span><span class="sxs-lookup"><span data-stu-id="8f13c-194">See hello related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) for more information.</span></span>

### <a name="sap-hana-backup-scheduling-strategy"></a><span data-ttu-id="8f13c-195">Стратегия планирования резервного копирования SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-195">SAP HANA backup scheduling strategy</span></span>

<span data-ttu-id="8f13c-196">статья Hello SAP HANA [планирование Your резервной копии и стратегия восстановления](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) состояний a basic планирование toodo резервных копий:</span><span class="sxs-lookup"><span data-stu-id="8f13c-196">hello SAP HANA article [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) states a basic plan toodo backups:</span></span>

- <span data-ttu-id="8f13c-197">создание моментального снимка хранилища (ежедневно);</span><span class="sxs-lookup"><span data-stu-id="8f13c-197">Storage snapshot (daily)</span></span>
- <span data-ttu-id="8f13c-198">создание полной резервной копии данных с использованием файла или формата backint (раз в неделю);</span><span class="sxs-lookup"><span data-stu-id="8f13c-198">Complete data backup using file or bacint format (once a week)</span></span>
- <span data-ttu-id="8f13c-199">создание автоматических резервных копий журналов.</span><span class="sxs-lookup"><span data-stu-id="8f13c-199">Automatic log backups</span></span>

<span data-ttu-id="8f13c-200">Моментальное снимки хранилища создавать необязательно. Вместо них можно использовать измененные резервные копии HANA, например добавочные или разностные резервные копии (см. статью об [измененных резервных копиях](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-200">Optionally, one could go completely without storage snapshots; they could be replaced by HANA delta backups, like incremental or differential backups (see [Delta Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span></span>

<span data-ttu-id="8f13c-201">руководство по администрированию HANA Hello предоставляет пример списка.</span><span class="sxs-lookup"><span data-stu-id="8f13c-201">hello HANA Administration guide provides an example list.</span></span> <span data-ttu-id="8f13c-202">Предполагается, что один восстановить SAP HANA tooa определенный момент времени с помощью hello следующая последовательность резервных копий:</span><span class="sxs-lookup"><span data-stu-id="8f13c-202">It suggests that one recover SAP HANA tooa specific point in time using hello following sequence of backups:</span></span>

1. <span data-ttu-id="8f13c-203">полная резервная копия данных;</span><span class="sxs-lookup"><span data-stu-id="8f13c-203">Full data backup</span></span>
2. <span data-ttu-id="8f13c-204">разностная резервная копия;</span><span class="sxs-lookup"><span data-stu-id="8f13c-204">Differential backup</span></span>
3. <span data-ttu-id="8f13c-205">добавочная резервная копия 1;</span><span class="sxs-lookup"><span data-stu-id="8f13c-205">Incremental backup 1</span></span>
4. <span data-ttu-id="8f13c-206">добавочная резервная копия 2;</span><span class="sxs-lookup"><span data-stu-id="8f13c-206">Incremental backup 2</span></span>
5. <span data-ttu-id="8f13c-207">резервные копии журнала.</span><span class="sxs-lookup"><span data-stu-id="8f13c-207">Log backups</span></span>

<span data-ttu-id="8f13c-208">О точное расписание как toowhen и как часто должно происходить определенный тип резервного копирования, он не возможные toogive правило, он слишком заказчика и зависит от того, сколько данных изменений в системе hello.</span><span class="sxs-lookup"><span data-stu-id="8f13c-208">Regarding an exact schedule as toowhen and how often a specific backup type should happen, it is not possible toogive a general guideline—it is too customer-specific, and depends on how many data changes occur in hello system.</span></span> <span data-ttu-id="8f13c-209">Основные из SAP стороне, которая может рассматриваться как общие рекомендации, рекомендуется toomake один HANA резервное копирование один раз в неделю.</span><span class="sxs-lookup"><span data-stu-id="8f13c-209">One basic recommendation from SAP side, which can be seen as general guidance, is toomake one full HANA backup once a week.</span></span>
<span data-ttu-id="8f13c-210">О резервных копий журналов, см. в документации SAP HANA hello [резервные копии журналов](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span><span class="sxs-lookup"><span data-stu-id="8f13c-210">Regarding log backups, see hello SAP HANA documentation [Log Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span></span>

<span data-ttu-id="8f13c-211">SAP рекомендует выполнив некоторые вспомогательные tookeep hello каталога резервного копирования он Неограниченный рост (в разделе [Housekeeping для каталога резервного копирования и хранения резервных копий](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-211">SAP also recommends doing some housekeeping of hello backup catalog tookeep it from growing infinitely (see [Housekeeping for Backup Catalog and Backup Storage](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span></span>

### <a name="sap-hana-configuration-files"></a><span data-ttu-id="8f13c-212">Файлы конфигурации SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-212">SAP HANA configuration files</span></span>

<span data-ttu-id="8f13c-213">Как уже говорилось в hello вопросов и Ответов в [1642148 Примечание SAP](https://launchpad.support.sap.com/#/notes/1642148), файлы конфигурации SAP HANA hello не являются частью стандартной HANA резервной копии.</span><span class="sxs-lookup"><span data-stu-id="8f13c-213">As stated in hello FAQ in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148), hello SAP HANA configuration files are not part of a standard HANA backup.</span></span> <span data-ttu-id="8f13c-214">Они не являются основные toorestore системы.</span><span class="sxs-lookup"><span data-stu-id="8f13c-214">They are not essential toorestore a system.</span></span> <span data-ttu-id="8f13c-215">После восстановления hello Hello HANA конфигурации может быть изменен вручную.</span><span class="sxs-lookup"><span data-stu-id="8f13c-215">hello HANA configuration could be changed manually after hello restore.</span></span> <span data-ttu-id="8f13c-216">В случае, если хотите один tooget hello же пользовательской конфигурации в процессе hello восстановления, это необходимые tooback копию файлов конфигурации HANA hello отдельно.</span><span class="sxs-lookup"><span data-stu-id="8f13c-216">In case one would like tooget hello same custom configuration during hello restore process, it is necessary tooback up hello HANA configuration files separately.</span></span>

<span data-ttu-id="8f13c-217">Если стандартная HANA резервные копии будут tooa выделенного HANA резервной копии файловой системы, один также может копировать toohello файлы конфигурации hello же создать резервную копию файловой системы, а затем скопируйте все вместе toohello конечной точке хранения, например охлаждение хранилища больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="8f13c-217">If standard HANA backups are going tooa dedicated HANA backup file system, one could also copy hello configuration files toohello same backup filesystem, and then copy everything together toohello final storage destination like cool blob storage.</span></span>

### <a name="sap-hana-cockpit"></a><span data-ttu-id="8f13c-218">Панель SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-218">SAP HANA Cockpit</span></span>

<span data-ttu-id="8f13c-219">Панель SAP HANA предлагает hello возможности наблюдения и управления SAP HANA через браузер.</span><span class="sxs-lookup"><span data-stu-id="8f13c-219">SAP HANA Cockpit offers hello possibility of monitoring and managing SAP HANA via a browser.</span></span> <span data-ttu-id="8f13c-220">Он также позволяет обработки SAP HANA резервных копий и таким образом, можно использовать в качестве альтернативного tooSAP HANA Studio и ABAP DBACOCKPIT (см. [панель SAP HANA](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) для получения дополнительной информации).</span><span class="sxs-lookup"><span data-stu-id="8f13c-220">It also allows handling of SAP HANA backups, and therefore can be used as an alternative tooSAP HANA Studio and ABAP DBACOCKPIT (see [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) for more information).</span></span>

![На следующем рисунке показан экран панель администрирования базы данных для SAP HANA hello](media/sap-hana-backup-guide/image004.png)

<span data-ttu-id="8f13c-222">Это hello рисунке показан экран панель администрирования базы данных для SAP HANA, а hello резервного копирования плитки на hello слева.</span><span class="sxs-lookup"><span data-stu-id="8f13c-222">This figure shows hello SAP HANA Cockpit Database Administration Screen, and hello backup tile on hello left.</span></span> <span data-ttu-id="8f13c-223">Просматривают резервного копирования плитки приветствия требует соответствующих разрешений пользователя для учетной записи входа.</span><span class="sxs-lookup"><span data-stu-id="8f13c-223">Seeing hello backup tile requires appropriate user permissions for login account.</span></span>

![Мониторинг текущих резервных копий на панели SAP HANA](media/sap-hana-backup-guide/image005.png)

<span data-ttu-id="8f13c-225">Резервные копии можно наблюдать в панель SAP HANA, пока они выполняются, и доступны после завершения всех hello сведения об архивации.</span><span class="sxs-lookup"><span data-stu-id="8f13c-225">Backups can be monitored in SAP HANA Cockpit while they are ongoing and, once it is finished, all hello backup details are available.</span></span>

![Пример использования Firefox на виртуальной машине Azure SLES 12 с GNOME Desktop](media/sap-hana-backup-guide/image006.png)

<span data-ttu-id="8f13c-227">созданные предыдущих снимках экрана приветствия для ВМ Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="8f13c-227">hello previous screenshots were made from an Azure Windows VM.</span></span> <span data-ttu-id="8f13c-228">В отличии от них снимок экрана выше сделан в браузере Firefox на виртуальной машине Azure SLES 12 с GNOME Desktop.</span><span class="sxs-lookup"><span data-stu-id="8f13c-228">This one is an example using Firefox on an Azure SLES 12 VM with Gnome desktop.</span></span> <span data-ttu-id="8f13c-229">Отображает расписания резервного копирования SAP HANA toodefine параметр hello в панель SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-229">It shows hello option toodefine SAP HANA backup schedules in SAP HANA Cockpit.</span></span> <span data-ttu-id="8f13c-230">Один можно видеть, предлагает даты и времени, как префикс для файлов резервных копий hello.</span><span class="sxs-lookup"><span data-stu-id="8f13c-230">As one can also see, it suggests date/time as a prefix for hello backup files.</span></span> <span data-ttu-id="8f13c-231">В SAP HANA Studio является префиксом по умолчанию hello &quot;ЗАВЕРШИТЬ\_данные\_резервного КОПИРОВАНИЯ&quot; при выполнении полной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="8f13c-231">In SAP HANA Studio, hello default prefix is &quot;COMPLETE\_DATA\_BACKUP&quot; when doing a full file backup.</span></span> <span data-ttu-id="8f13c-232">Мы советуем использовать уникальный префикс.</span><span class="sxs-lookup"><span data-stu-id="8f13c-232">Using a unique prefix is recommended.</span></span>

### <a name="sap-hana-backup-encryption"></a><span data-ttu-id="8f13c-233">Шифрование резервной копии SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-233">SAP HANA backup encryption</span></span>

<span data-ttu-id="8f13c-234">SAP HANA обеспечивает шифрование данных и журнала.</span><span class="sxs-lookup"><span data-stu-id="8f13c-234">SAP HANA offers encryption of data and log.</span></span> <span data-ttu-id="8f13c-235">Если не зашифровано SAP HANA данных и журналов, затем hello резервные копии также не шифруются.</span><span class="sxs-lookup"><span data-stu-id="8f13c-235">If SAP HANA data and log are not encrypted, then hello backups are also not encrypted.</span></span> <span data-ttu-id="8f13c-236">Он работает toouse клиента toohello определенные виды стороннее решение tooencrypt hello SAP HANA, резервные копии.</span><span class="sxs-lookup"><span data-stu-id="8f13c-236">It is up toohello customer toouse some form of third-party solution tooencrypt hello SAP HANA backups.</span></span> <span data-ttu-id="8f13c-237">В разделе [данных и шифрования тома журнала](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) toofind дополнительных сведений о шифровании SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-237">See [Data and Log Volume Encryption](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) toofind out more about SAP HANA encryption.</span></span>

<span data-ttu-id="8f13c-238">В Microsoft Azure клиент может использовать hello tooencrypt функции шифрования ВМ IaaS.</span><span class="sxs-lookup"><span data-stu-id="8f13c-238">On Microsoft Azure, a customer could use hello IaaS VM encryption feature tooencrypt.</span></span> <span data-ttu-id="8f13c-239">Например можно было использовать toohello присоединенные диски выделенных данных виртуальной Машины, которой используется toostore SAP HANA резервных копий, а затем создайте копии этих дисков.</span><span class="sxs-lookup"><span data-stu-id="8f13c-239">For example, one could use dedicated data disks attached toohello VM, which are used toostore SAP HANA backups, then make copies of these disks.</span></span>

<span data-ttu-id="8f13c-240">Служба резервного копирования Azure может обрабатывать зашифрованные ВМ и дисков (в разделе [способ tooback копирования и восстановления шифрования виртуальные машины в Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-240">Azure Backup service can handle encrypted VMs/disks (see [How tooback up and restore encrypted virtual machines with Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span></span>

<span data-ttu-id="8f13c-241">Другой вариант будут toomaintain hello SAP HANA ВМ и ее диски без шифрования и храните файлы резервных копий SAP HANA hello в учетной записи хранения, для которого была активирована система шифрования (см. [шифрование службы хранилища Azure для статических данных](../../../storage/common/storage-service-encryption.md)) .</span><span class="sxs-lookup"><span data-stu-id="8f13c-241">Another option would be toomaintain hello SAP HANA VM and its disks without encryption, and store hello SAP HANA backup files in a storage account for which encryption was enabled (see [Azure Storage Service Encryption for Data at Rest](../../../storage/common/storage-service-encryption.md)).</span></span>

## <a name="test-setup"></a><span data-ttu-id="8f13c-242">Тестирование настройки</span><span class="sxs-lookup"><span data-stu-id="8f13c-242">Test setup</span></span>

### <a name="test-virtual-machine-on-azure"></a><span data-ttu-id="8f13c-243">Тестирование виртуальных машин в Azure</span><span class="sxs-lookup"><span data-stu-id="8f13c-243">Test Virtual Machine on Azure</span></span>

<span data-ttu-id="8f13c-244">Установка SAP HANA на виртуальной Машине Azure GS5 был использован для hello следующие тесты резервного копирования и восстановления.</span><span class="sxs-lookup"><span data-stu-id="8f13c-244">An SAP HANA installation in an Azure GS5 VM was used for hello following backup/restore tests.</span></span>

![На рисунке показана часть hello Azure — Обзор портала для hello HANA тестовой виртуальной Машине](media/sap-hana-backup-guide/image007.png)

<span data-ttu-id="8f13c-246">На рисунке показана часть hello Azure — Обзор портала для hello HANA тестовой виртуальной Машине.</span><span class="sxs-lookup"><span data-stu-id="8f13c-246">This figure shows part of hello Azure portal overview for hello HANA test VM.</span></span>

### <a name="test-backup-size"></a><span data-ttu-id="8f13c-247">Проверка размера резервной копии</span><span class="sxs-lookup"><span data-stu-id="8f13c-247">Test backup size</span></span>

![Этот рисунок был взят из резервной копии консоль hello в HANA Studio и отображает размер файла резервной копии hello 229 ГБ сервера индекса HANA hello](media/sap-hana-backup-guide/image008.png)

<span data-ttu-id="8f13c-249">Пустой таблицы была заполнена tooget данных размер резервной копии данных, более чем 200 ГБ tooderive реалистичных данных о производительности.</span><span class="sxs-lookup"><span data-stu-id="8f13c-249">A dummy table was filled up with data tooget a total data backup size of over 200 GB tooderive realistic performance data.</span></span> <span data-ttu-id="8f13c-250">Рисунок Hello взято из резервной копии консоль hello в HANA Studio и отображает размер файла резервной копии hello 229 ГБ сервера индекса HANA hello.</span><span class="sxs-lookup"><span data-stu-id="8f13c-250">hello figure was taken from hello backup console in HANA Studio and shows hello backup file size of 229 GB for hello HANA index server.</span></span> <span data-ttu-id="8f13c-251">Для тестов hello использовался префикс «COMPLETE_DATA_BACKUP» в SAP HANA Studio резервного копирования по умолчанию hello.</span><span class="sxs-lookup"><span data-stu-id="8f13c-251">For hello tests, hello default backup prefix "COMPLETE_DATA_BACKUP" in SAP HANA Studio was used.</span></span> <span data-ttu-id="8f13c-252">В реальных рабочих системах следует определить более практичный префикс.</span><span class="sxs-lookup"><span data-stu-id="8f13c-252">In real production systems, a more useful prefix should be defined.</span></span> <span data-ttu-id="8f13c-253">На панели SAP HANA это время и дата.</span><span class="sxs-lookup"><span data-stu-id="8f13c-253">SAP HANA Cockpit suggests date/time.</span></span>

### <a name="test-tool-toocopy-files-directly-tooazure-storage"></a><span data-ttu-id="8f13c-254">Toocopy средства тестирования непосредственно файлы хранилища tooAzure</span><span class="sxs-lookup"><span data-stu-id="8f13c-254">Test tool toocopy files directly tooAzure storage</span></span>

<span data-ttu-id="8f13c-255">файлов резервных копий SAP HANA tootransfer непосредственно tooAzure хранилища BLOB-объектов или Azure общих папок, hello blobxfer использовалось средство, так как он поддерживает целевых объектов и его можно легко интегрировать в сценариев автоматизации из-за tooits интерфейс командной строки.</span><span class="sxs-lookup"><span data-stu-id="8f13c-255">tootransfer SAP HANA backup files directly tooAzure blob storage, or Azure file shares, hello blobxfer tool was used because it supports both targets and it can be easily integrated into automation scripts due tooits command-line interface.</span></span> <span data-ttu-id="8f13c-256">Средство blobxfer Hello доступно на [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="8f13c-256">hello blobxfer tool is available on [GitHub](https://github.com/Azure/blobxfer).</span></span>

### <a name="test-backup-size-estimation"></a><span data-ttu-id="8f13c-257">Оценка размера тестовой резервной копии</span><span class="sxs-lookup"><span data-stu-id="8f13c-257">Test backup size estimation</span></span>

<span data-ttu-id="8f13c-258">Это важные tooestimate hello размер резервной копии из SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-258">It is important tooestimate hello backup size of SAP HANA.</span></span> <span data-ttu-id="8f13c-259">Эта оценка позволяет повысить производительность tooimprove, определяя размер hello max файла резервной копии для нескольких файлов резервной копии из-за tooparallelism во время копирования файлов.</span><span class="sxs-lookup"><span data-stu-id="8f13c-259">This estimate helps tooimprove performance by defining hello max backup file size for a number of backup files, due tooparallelism during a file copy.</span></span> <span data-ttu-id="8f13c-260">(Это объясняется далее в статье.) Один необходимо также решить, будет ли toodo полного резервного копирования или разностного резервного копирования (добавочная или разностная).</span><span class="sxs-lookup"><span data-stu-id="8f13c-260">(Those details are explained later in this article.) One must also decide whether toodo a full backup or a delta backup (incremental or differential).</span></span>

<span data-ttu-id="8f13c-261">К счастью, имеется простой инструкции SQL, вычисляющая размер hello hello резервного копирования файлов: **выберите \* от M\_резервного КОПИРОВАНИЯ\_размер\_ОЦЕНКАМ** (см. [ Оценка hello пространства необходимости в hello файловой системы для резервного копирования данных](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-261">Fortunately, there is a simple SQL statement that estimates hello size of hello backup files: **select \* from M\_BACKUP\_SIZE\_ESTIMATIONS** (see [Estimate hello Space Needed in hello File System for a Data Backup](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span></span>

![выходные данные Hello Эта инструкция SQL соответствует почти полностью hello реальный объем hello полной резервной копии данных на диске](media/sap-hana-backup-guide/image009.png)

<span data-ttu-id="8f13c-263">Для тестовой системы hello hello выходные данные этой инструкции SQL соответствует почти полностью hello реальный объем hello полной резервной копии данных на диске.</span><span class="sxs-lookup"><span data-stu-id="8f13c-263">For hello test system, hello output of this SQL statement matches almost exactly hello real size of hello full data backup on disk.</span></span>

### <a name="test-hana-backup-file-size"></a><span data-ttu-id="8f13c-264">Проверка размера файла резервной копии HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-264">Test HANA backup file size</span></span>

![Hello HANA Studio резервного копирования консоль предоставляет один toorestrict hello максимальный размер файла резервной копии файлов HANA](media/sap-hana-backup-guide/image010.png)

<span data-ttu-id="8f13c-266">консоль резервного копирования HANA Studio Hello позволяет один toorestrict hello максимальный размер файла резервной копии файлов HANA.</span><span class="sxs-lookup"><span data-stu-id="8f13c-266">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="8f13c-267">В среде образец hello эта функция упрощает возможных tooget файлы несколько небольших резервной копии вместо одного файла резервной копии 230 ГБ.</span><span class="sxs-lookup"><span data-stu-id="8f13c-267">In hello sample environment, that feature makes it possible tooget multiple smaller backup files instead of one 230-GB backup file.</span></span> <span data-ttu-id="8f13c-268">Размер файла оказывает значительное влияние на производительность (см. в статье связанные hello [SAP HANA Azure Backup на уровне файла](sap-hana-backup-file-level.md)).</span><span class="sxs-lookup"><span data-stu-id="8f13c-268">Smaller file size has a significant impact on performance (see hello related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md)).</span></span>

## <a name="summary"></a><span data-ttu-id="8f13c-269">Сводка</span><span class="sxs-lookup"><span data-stu-id="8f13c-269">Summary</span></span>

<span data-ttu-id="8f13c-270">На основании результатов теста hello hello следующие таблицы Показать преимуществ и недостатков использования решения tooback копирование базы данных SAP HANA, работающих на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="8f13c-270">Based on hello test results hello following tables show pros and cons of solutions tooback up an SAP HANA database running on Azure virtual machines.</span></span>

<span data-ttu-id="8f13c-271">**Создайте резервную копию файловой системы SAP HANA toohello и скопируйте файлы резервной копии после окончательного назначения резервного копирования toohello**</span><span class="sxs-lookup"><span data-stu-id="8f13c-271">**Back up SAP HANA toohello file system and copy backup files afterwards toohello final backup destination**</span></span>

|<span data-ttu-id="8f13c-272">Решение</span><span class="sxs-lookup"><span data-stu-id="8f13c-272">Solution</span></span>                                           |<span data-ttu-id="8f13c-273">Преимущества</span><span class="sxs-lookup"><span data-stu-id="8f13c-273">Pros</span></span>                                 |<span data-ttu-id="8f13c-274">Недостатки</span><span class="sxs-lookup"><span data-stu-id="8f13c-274">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="8f13c-275">Хранение резервных копий HANA на дисках виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="8f13c-275">Keep HANA backups on VM disks</span></span>                      |<span data-ttu-id="8f13c-276">Управление выполняется без дополнительных усилий</span><span class="sxs-lookup"><span data-stu-id="8f13c-276">No additional management efforts</span></span>     |<span data-ttu-id="8f13c-277">Используется дисковое пространство локальной виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="8f13c-277">Eats up local VM disk space</span></span>           |
|<span data-ttu-id="8f13c-278">Blobxfer средство toocopy файлов резервных копий tooblob хранилища</span><span class="sxs-lookup"><span data-stu-id="8f13c-278">Blobxfer tool toocopy backup files tooblob storage</span></span> |<span data-ttu-id="8f13c-279">Параллелизм toocopy несколько файлов, выбор toouse ожиданием BLOB-объекта хранилища</span><span class="sxs-lookup"><span data-stu-id="8f13c-279">Parallelism toocopy multiple files, choice toouse cool blob storage</span></span> | <span data-ttu-id="8f13c-280">Настройка дополнительного средства и написание пользовательских скриптов</span><span class="sxs-lookup"><span data-stu-id="8f13c-280">Additional tool maintenance and custom scripting</span></span> | 
|<span data-ttu-id="8f13c-281">Копирование больших двоичных объектов через PowerShell или интерфейс командной строки</span><span class="sxs-lookup"><span data-stu-id="8f13c-281">Blob copy via Powershell or CLI</span></span>                    |<span data-ttu-id="8f13c-282">Не нужно использовать дополнительные средства. Процесс выполняется через PowerShell или интерфейс командной строки</span><span class="sxs-lookup"><span data-stu-id="8f13c-282">No additional tool necessary, can be accomplished via Azure Powershell or CLI</span></span> |<span data-ttu-id="8f13c-283">ручной процесс у клиента имеется tootake заботиться о сценариев и управление скопированный больших двоичных объектов для восстановления</span><span class="sxs-lookup"><span data-stu-id="8f13c-283">manual process, customer has tootake care of scripting and management of copied blobs for restore</span></span>|
|<span data-ttu-id="8f13c-284">Общая папка tooNFS копирования</span><span class="sxs-lookup"><span data-stu-id="8f13c-284">Copy tooNFS share</span></span>                                  |<span data-ttu-id="8f13c-285">Обработка после резервного копирования файлов на других виртуальных Машин без влияния на сервере HANA hello</span><span class="sxs-lookup"><span data-stu-id="8f13c-285">Post-processing of backup files on other VM without impact on hello HANA server</span></span>|<span data-ttu-id="8f13c-286">Копирование выполняется медленно</span><span class="sxs-lookup"><span data-stu-id="8f13c-286">Slow copy process</span></span>|
|<span data-ttu-id="8f13c-287">TooAzure Blobxfer копирования файловой службы</span><span class="sxs-lookup"><span data-stu-id="8f13c-287">Blobxfer copy tooAzure File Service</span></span>                |<span data-ttu-id="8f13c-288">Пространство на дисках локальной виртуальной машины не используется</span><span class="sxs-lookup"><span data-stu-id="8f13c-288">Doesn't eat up space on local VM disks</span></span>|<span data-ttu-id="8f13c-289">Резервная копия HANA не поддерживает непосредственную запись. Сейчас ограничение размера файлового ресурса составляет 5 ТБ</span><span class="sxs-lookup"><span data-stu-id="8f13c-289">No direct write support by HANA backup, size restriction of file share currently at 5 TB</span></span>|
|<span data-ttu-id="8f13c-290">Агент службы архивации Azure</span><span class="sxs-lookup"><span data-stu-id="8f13c-290">Azure Backup Agent</span></span>                                 | <span data-ttu-id="8f13c-291">Используется как предпочтительное решение</span><span class="sxs-lookup"><span data-stu-id="8f13c-291">Would be preferred solution</span></span>         | <span data-ttu-id="8f13c-292">Сейчас недоступен в Linux</span><span class="sxs-lookup"><span data-stu-id="8f13c-292">Currently not available on Linux</span></span>    |



<span data-ttu-id="8f13c-293">**Резервное копирование SAP HANA на основе моментальных снимков хранилища**</span><span class="sxs-lookup"><span data-stu-id="8f13c-293">**Backup SAP HANA based on storage snapshots**</span></span>

|<span data-ttu-id="8f13c-294">Решение</span><span class="sxs-lookup"><span data-stu-id="8f13c-294">Solution</span></span>                                           |<span data-ttu-id="8f13c-295">Преимущества</span><span class="sxs-lookup"><span data-stu-id="8f13c-295">Pros</span></span>                                 |<span data-ttu-id="8f13c-296">Недостатки</span><span class="sxs-lookup"><span data-stu-id="8f13c-296">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="8f13c-297">Служба архивации Azure</span><span class="sxs-lookup"><span data-stu-id="8f13c-297">Azure Backup Service</span></span>                               | <span data-ttu-id="8f13c-298">Поддерживает резервное копирование виртуальной машины на основе моментальных снимков хранилища</span><span class="sxs-lookup"><span data-stu-id="8f13c-298">Allows VM backup based on blob snapshots</span></span> | <span data-ttu-id="8f13c-299">Если не используется восстановление на уровне файлов, hello Создание новой виртуальной Машины требуется для процесса восстановления hello, который затем подразумевает необходимость hello нового ключа лицензии SAP HANA</span><span class="sxs-lookup"><span data-stu-id="8f13c-299">When not using file level restore, it requires hello creation of a new VM for hello restore process, which then implies hello need of a new SAP HANA license key</span></span>|
|<span data-ttu-id="8f13c-300">Создание моментальных снимков больших двоичных объектов вручную</span><span class="sxs-lookup"><span data-stu-id="8f13c-300">Manual blob snapshots</span></span>                              | <span data-ttu-id="8f13c-301">Гибкость toocreate и восстановления конкретных диски ВМ без изменения hello уникальный ИД виртуальной Машины</span><span class="sxs-lookup"><span data-stu-id="8f13c-301">Flexibility toocreate and restore specific VM disks without changing hello unique VM ID</span></span>|<span data-ttu-id="8f13c-302">Все ручной работы, которая имеет toobe, сделанных клиентом hello</span><span class="sxs-lookup"><span data-stu-id="8f13c-302">All manual work, which has toobe done by hello customer</span></span>|

## <a name="next-steps"></a><span data-ttu-id="8f13c-303">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="8f13c-303">Next steps</span></span>
* <span data-ttu-id="8f13c-304">[SAP HANA Azure резервное копирование на уровне файлов](sap-hana-backup-file-level.md) описание параметра резервного копирования на основе файла hello.</span><span class="sxs-lookup"><span data-stu-id="8f13c-304">[SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) describes hello file-based backup option.</span></span>
* <span data-ttu-id="8f13c-305">[Резервное копирование SAP HANA, основанные на моментальных снимках хранилища](sap-hana-backup-storage-snapshots.md) описывает hello вариант хранения данных на основе моментального снимка резервной копии.</span><span class="sxs-lookup"><span data-stu-id="8f13c-305">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="8f13c-306">tooestablish высокого уровня доступности и план аварийного восстановления из SAP HANA в Azure (большие экземпляры). в статье toolearn [SAP HANA (крупных экземпляров) высокой доступности и аварийного восстановления в Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="8f13c-306">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
