---
title: "aaaSAP HANA резервного копирования Azure на уровне файлов | Документы Microsoft"
description: "Существуют две основные возможности резервного копирования SAP HANA на виртуальных машинах Azure. В этой статье рассматривается резервное копирование на уровне файлов."
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="003e3-103">Резервное копирование SAP HANA в Azure на уровне файлов</span><span class="sxs-lookup"><span data-stu-id="003e3-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="003e3-104">Введение</span><span class="sxs-lookup"><span data-stu-id="003e3-104">Introduction</span></span>

<span data-ttu-id="003e3-105">Эта статья входит в цикл из трех связанных статей, посвященных резервному копированию SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="003e3-106">[Руководстве по резервному копированию для SAP HANA на виртуальных машинах Azure](./sap-hana-backup-guide.md) содержит обзор и сведения о начале работы и [SAP HANA резервной копии, основанные на моментальных снимках хранилища](./sap-hana-backup-storage-snapshots.md) деле hello параметра резервного копирования на основе моментального снимка хранилища.</span><span class="sxs-lookup"><span data-stu-id="003e3-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="003e3-107">Просматривая hello размеров виртуальных Машин Azure, увидит, GS5 разрешает 64 подключенные диски данных.</span><span class="sxs-lookup"><span data-stu-id="003e3-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="003e3-108">В крупных системах SAP HANA большее число этих дисков могут занимать файлы данных и журналов, а также программный RAID-массив, обеспечивающий оптимальную пропускную способность операций ввода-вывода на диске.</span><span class="sxs-lookup"><span data-stu-id="003e3-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="003e3-109">Hello вопрос — где toostore SAP HANA резервное копирование файлов, которые может заполниться до конца данных hello присоединенных дисков со временем?</span><span class="sxs-lookup"><span data-stu-id="003e3-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="003e3-110">В разделе [размеры виртуальных машин Linux в Azure](../../linux/sizes.md) для hello таблицы размера виртуальной Машины Azure.</span><span class="sxs-lookup"><span data-stu-id="003e3-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="003e3-111">Сейчас служба архивации Azure не поддерживает интеграцию с резервным копированием SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="003e3-112">стандартный способ Hello toomanage резервного копирования и восстановления на уровне файла hello — с помощью файлов резервной копии SAP HANA Studio или с помощью инструкций SAP HANA SQL.</span><span class="sxs-lookup"><span data-stu-id="003e3-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="003e3-113">Дополнительные сведения см. в [справочнике по системным представлениям и представлениям SQL для SAP HANA](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf).</span><span class="sxs-lookup"><span data-stu-id="003e3-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![На этом рисунке показано диалоговое окно приветствия пункта меню резервного копирования hello в SAP HANA Studio](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="003e3-115">На этом рисунке показано диалоговое окно приветствия пункта меню резервного копирования hello в SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="003e3-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="003e3-116">При выборе типа &quot;файл&quot; один имеет toospecify путь в файловой системе hello, где SAP HANA записывает hello файлов резервных копий.</span><span class="sxs-lookup"><span data-stu-id="003e3-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="003e3-117">Восстановление работает hello таким же образом.</span><span class="sxs-lookup"><span data-stu-id="003e3-117">Restore works hello same way.</span></span>

<span data-ttu-id="003e3-118">Хотя этот вариант выглядит простым, он имеет некоторые особенности.</span><span class="sxs-lookup"><span data-stu-id="003e3-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="003e3-119">Как упоминалось ранее, к виртуальной машине Azure можно подключить ограничение количества дисков данных.</span><span class="sxs-lookup"><span data-stu-id="003e3-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="003e3-120">Не может быть емкость toostore SAP HANA резервного копирования файлов в файловых системах hello объекта hello виртуальной Машины, в зависимости от размера hello hello базы данных и диск пропускной способности требования, выполнение которых может потребоваться программного обеспечения RAID-с помощью чередованием по нескольким данных дисков.</span><span class="sxs-lookup"><span data-stu-id="003e3-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="003e3-121">Сведения о разных вариантах перемещения этих файлов резервных копий, а также об управлении ограничениями размера и производительностью при обработке терабайт данных приведены далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="003e3-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="003e3-122">Еще один вариант, обеспечивающий большую гибкость в отношении общей емкости, — это хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="003e3-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="003e3-123">Один большой двоичный объект также является ограниченным too1 ТБ, общая емкость hello один большой двоичный объект контейнера в настоящее время составляет 500 ТБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="003e3-124">Кроме того, он дает пользователям hello choice tooselect так называемые &quot;ожиданием&quot; BLOB-объект хранилища, который имеет преимущество затрат.</span><span class="sxs-lookup"><span data-stu-id="003e3-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="003e3-125">Сведения об этом хранилище см. в статье [Хранилище BLOB-объектов Azure: "горячий" и "холодный" уровни хранилища](../../../storage/blobs/storage-blob-storage-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="003e3-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="003e3-126">В целях дополнительной безопасности геореплицированном хранилище учетной записи toostore hello SAP HANA резервные копии используйте.</span><span class="sxs-lookup"><span data-stu-id="003e3-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="003e3-127">Дополнительные сведения о репликации учетной записи хранения см. в статье [Репликация службы хранилища Azure](../../../storage/common/storage-redundancy.md).</span><span class="sxs-lookup"><span data-stu-id="003e3-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="003e3-128">Пользователи могут поместить выделенные виртуальные жесткие диски, на которых хранятся резервные копии SAP HANA, в геореплицированную учетную запись хранения резервных копий.</span><span class="sxs-lookup"><span data-stu-id="003e3-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="003e3-129">В противном случае один удалось скопировать hello VHD, в которых сохраняются резервные копии SAP HANA hello учетной записи хранилища с георепликацией tooa или tooa учетной записи хранилища, который находится в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="003e3-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="003e3-130">Агент службы архивации Azure</span><span class="sxs-lookup"><span data-stu-id="003e3-130">Azure backup agent</span></span>

<span data-ttu-id="003e3-131">Toonot параметр hello Azure предлагает резервного копирования только резервное копирование завершено виртуальные машины, но также файлы и каталоги через hello резервного копирования, имеющая toobe установлен на hello гостевой ОС.</span><span class="sxs-lookup"><span data-stu-id="003e3-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="003e3-132">Однако начиная с 2016 декабря, этот агент поддерживается только в Windows (см. [резервное копирование сервера или клиента tooAzure, с помощью модели развертывания диспетчера ресурсов hello](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="003e3-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="003e3-133">Решения этой проблемы является копией toofirst tooa SAP HANA файлов резервных копий виртуальной Машины Windows в Azure (например, через общий ресурс SAMBA), а затем используйте hello агента резервного копирования Azure оттуда.</span><span class="sxs-lookup"><span data-stu-id="003e3-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="003e3-134">Хотя технически возможно, он будет усложнения и замедлить hello резервного копирования или восстановления немного из-за toohello копию между hello Linux и ВМ Windows hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="003e3-135">Это не рекомендуется toofollow этот подход.</span><span class="sxs-lookup"><span data-stu-id="003e3-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="003e3-136">Сведения о служебной программе Azure blobxfer</span><span class="sxs-lookup"><span data-stu-id="003e3-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="003e3-137">toostore каталогам и файлам на хранилища Azure, можно было использовать интерфейс командной строки или PowerShell, или создайте средство, с помощью одного из hello [пакеты SDK Azure](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="003e3-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="003e3-138">Существует также готовые к использованию служебной программы AzCopy, для копирования tooAzure хранения данных, но только в том случае Windows (в разделе [передачи данных с помощью командной строки программу AzCopy hello](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="003e3-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="003e3-139">Поэтому в рамках этой статьи для копирования файлов резервных копий SAP HANA мы используем blobxfer.</span><span class="sxs-lookup"><span data-stu-id="003e3-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="003e3-140">Это средство с открытым исходным кодом доступно в [GitHub](https://github.com/Azure/blobxfer). Большое количество пользователей использует его в рабочих средах.</span><span class="sxs-lookup"><span data-stu-id="003e3-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="003e3-141">Это средство позволяет toocopy данных напрямую tooeither Azure BLOB-объектов хранилища или Azure общей папке.</span><span class="sxs-lookup"><span data-stu-id="003e3-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="003e3-142">Кроме того, это средство предоставляет ряд полезных возможностей, таких как поддержка MD5-хэша или автоматического параллелизма при копировании каталога с несколькими файлами.</span><span class="sxs-lookup"><span data-stu-id="003e3-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="003e3-143">Производительность резервного копирования SAP HANA</span><span class="sxs-lookup"><span data-stu-id="003e3-143">SAP HANA backup performance</span></span>

![На этом снимке экрана — SAP HANA hello резервного копирования консоли в SAP HANA Studio](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="003e3-145">На этом снимке экрана — SAP HANA hello резервного копирования консоли в SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="003e3-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="003e3-146">Ушло примерно 42 минут toodo hello архивации из hello 230 ГБ на диске один Azure стандартное хранилище присоединенного toohello HANA виртуальной Машины с помощью XFS файловой системы.</span><span class="sxs-lookup"><span data-stu-id="003e3-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![На этом снимке экрана имеет YaST на hello SAP HANA тестовой виртуальной Машине](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="003e3-148">На этом снимке экрана имеет YaST на hello SAP HANA тестовой виртуальной Машине.</span><span class="sxs-lookup"><span data-stu-id="003e3-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="003e3-149">Как уже упоминалось увидит hello 1 ТБ отдельный диск для резервного копирования SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="003e3-150">Ушло примерно 42 минут toobackup 230 ГБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="003e3-151">Кроме того, к виртуальной машине подключены 5 дисков емкостью 200 ГБ, на которых установлен программный RAID-массив md0, выполняющий чередование по этим дискам данных Azure.</span><span class="sxs-lookup"><span data-stu-id="003e3-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Повторение hello же резервного копирования на программное обеспечение RAID с чередованием через пять присоединенных дисков с данными Azure стандартное хранилище](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="003e3-153">Повторяющийся hello же резервного копирования на программное обеспечение RAID с чередованием через пять присоединенного время резервного копирования hello перевести диски данных Azure стандартное хранилище из 42 минут вниз too10 минут.</span><span class="sxs-lookup"><span data-stu-id="003e3-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="003e3-154">без кэширования toohello виртуальной Машины были присоединены диски Hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="003e3-155">В этом случае является очевидным важность производительность записи на диск для hello время резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="003e3-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="003e3-156">Один может затем toofurther хранилища premium tooAzure коммутатора ускорить процесс hello для достижения оптимальной производительности.</span><span class="sxs-lookup"><span data-stu-id="003e3-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="003e3-157">Как правило, это хранилище следует использовать в рабочих системах.</span><span class="sxs-lookup"><span data-stu-id="003e3-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="003e3-158">Скопируйте хранилища больших двоичных объектов tooAzure SAP HANA файлов резервных копий</span><span class="sxs-lookup"><span data-stu-id="003e3-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="003e3-159">Как лучше всего 2016 декабря hello параметр tooquickly хранилище SAP HANA резервного копирования файлов: хранилище больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="003e3-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="003e3-160">Один контейнер один большой двоичный объект имеет ограничение в 500 ТБ, достаточно для большинства систем SAP HANA, запущенным на виртуальной машине, GS5 в Azure, tookeep достаточно SAP HANA, резервные копии.</span><span class="sxs-lookup"><span data-stu-id="003e3-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="003e3-161">Клиенты имеют hello Выбор между &quot;горячей&quot; и &quot;холодного&quot; хранилище больших двоичных объектов (в разделе [хранилища больших двоичных объектов: горячей и охлаждение уровни хранилища](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="003e3-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="003e3-162">С помощью средства blobxfer hello это файлов резервных копий SAP HANA hello легко toocopy напрямую tooAzure хранилище больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="003e3-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Здесь один могут видеть файлы hello полной резервной копии файла SAP HANA](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="003e3-164">Здесь один могут видеть файлы hello полной резервной копии файла SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="003e3-165">Существует четыре файла и hello крупнейших есть примерно 230 ГБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Ушло примерно 3000 секунд toocopy tooan 230 ГБ hello Azure стандартное хранилище контейнер BLOB-объектов учетной записи](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="003e3-167">Не использует хэш md5 в первоначальном тестировании hello, ушло примерно 3000 секунд toocopy tooan 230 ГБ hello Azure стандартное хранилище контейнер BLOB-объектов учетной записи.</span><span class="sxs-lookup"><span data-stu-id="003e3-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![На этом снимке экрана можно см. на внешний вид на hello портал Azure](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="003e3-169">На этом снимке экрана один см, как будет выглядеть на портал Azure hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="003e3-170">Контейнер больших двоичных объектов с именем &quot;sap hana резервные копии&quot; был создан и включает в себя четыре hello больших двоичных объектов, которые представляют Привет SAP HANA резервного копирования файлов.</span><span class="sxs-lookup"><span data-stu-id="003e3-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="003e3-171">Размер одного из них составляет 230 ГБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="003e3-172">консоль резервного копирования HANA Studio Hello позволяет один toorestrict hello максимальный размер файла резервной копии файлов HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="003e3-173">В среде образец hello Улучшенная производительность за счет возможности toohave файлы несколько меньшего размера резервной копии, а не один большой файл 230 ГБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![Задание hello предельный размер файла резервной копии на стороне hello HANA &#39; t увеличить время резервного копирования hello](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="003e3-175">Задание hello предельный размер файла резервной копии на стороне hello HANA &#39; t увеличить hello время резервного копирования, так как файлы hello записываются последовательно, как показано на рисунке.</span><span class="sxs-lookup"><span data-stu-id="003e3-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="003e3-176">предельный размер файла Hello был установлен too60 ГБ, поэтому hello резервного копирования созданы четыре больших файлов данных вместо 230 ГБ hello одного файла.</span><span class="sxs-lookup"><span data-stu-id="003e3-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![tootest параллелизма средства blobxfer hello, hello максимальный размер файла для резервного копирования HANA затем был настроен too15 ГБ](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="003e3-178">tootest параллелизма средства blobxfer hello, hello максимальный размер файла для резервного копирования HANA затем был настроен too15 ГБ, что привело к 19 файлов резервных копий.</span><span class="sxs-lookup"><span data-stu-id="003e3-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="003e3-179">Эта конфигурация перевести в режим hello время tooAzure blobxfer toocopy hello 230 ГБ хранилища BLOB-объектов из 3000 секунд работу too875 сек.</span><span class="sxs-lookup"><span data-stu-id="003e3-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="003e3-180">Этот результат — из-за ограничения toohello 60 МБ в секунду для записи большого двоичного объекта Azure.</span><span class="sxs-lookup"><span data-stu-id="003e3-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="003e3-181">Параллелизм через несколько больших двоичных объектов позволяет решить hello узким местом, но есть недостаток: увеличение производительности hello blobxfer средство toocopy все эти файлы резервных копий tooAzure HANA хранилища больших двоичных объектов помещает нагрузки на hello HANA виртуальную Машину и сети hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="003e3-182">а это влияет на операции в системе HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="003e3-183">Копирование большого двоичного объекта выделенных дисков данных Azure в программном RAID-массиве резервного копирования</span><span class="sxs-lookup"><span data-stu-id="003e3-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="003e3-184">В отличие от hello вручную виртуальной Машины диск резервного копирования данных в этом подходе одно не резервное копирование всех дисков виртуальной Машины toosave hello всю SAP сборку, включая данных HANA hello данных HANA регистрирует файлы и файлы конфигурации.</span><span class="sxs-lookup"><span data-stu-id="003e3-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="003e3-185">Вместо этого hello представление — это toohave выделенной программное обеспечение RAID с чередованием через несколько данных Azure виртуальные жесткие диски для хранения полной резервной копии файла SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="003e3-186">Один копирует только эти диски, имеющих резервного копирования hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="003e3-187">Они легко может храниться в выделенную учетную запись хранения резервных копий HANA или присоединенного выделенного tooa &quot;резервного копирования виртуальных Машин управления&quot; для дальнейшей обработки.</span><span class="sxs-lookup"><span data-stu-id="003e3-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Все виртуальные жесткие диски участвующих были скопированы с помощью hello ** Пуск-azurestorageblobcopy ** команды PowerShell](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="003e3-189">После завершения hello резервного копирования toohello локального программного обеспечения RAID, все виртуальные жесткие диски участвующих были скопированы с помощью hello **начала azurestorageblobcopy** команду PowerShell (см. [AzureStorageBlobCopy начала](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="003e3-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="003e3-190">Как оно влияет только на выделенный hello файловой системы для хранения файлов резервных копий hello, нет никаких проблем, о SAP HANA данных или журнала согласованность файлов на диске hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="003e3-191">Преимущество этой команды — что он работает во время интерактивной hello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="003e3-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="003e3-192">убедиться, что toounmount быть toobe, определенных в том, что процесс не записывает toohello резервного копирования чередующемся наборе, перед hello больших двоичных объектов копирования, а затем снова подключить его.</span><span class="sxs-lookup"><span data-stu-id="003e3-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="003e3-193">Или можно было использовать соответствующий слишком&quot;закрепить&quot; hello файловой системы.</span><span class="sxs-lookup"><span data-stu-id="003e3-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="003e3-194">Например, через xfs\_заморозить для hello XFS файловой системы.</span><span class="sxs-lookup"><span data-stu-id="003e3-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![На этом снимке экрана показан список hello больших двоичных объектов в контейнере hello виртуальные жесткие диски на hello портал Azure](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="003e3-196">На этом снимке экрана показан список hello больших двоичных объектов в hello &quot;виртуальные жесткие диски&quot; контейнера на hello портал Azure.</span><span class="sxs-lookup"><span data-stu-id="003e3-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="003e3-197">Hello снимке экрана приветствия пяти виртуальных жестких дисков, которой были вложены tooserve виртуальной Машины сервера SAP HANA toohello как hello программного RAID tookeep SAP HANA файлов резервных копий.</span><span class="sxs-lookup"><span data-stu-id="003e3-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="003e3-198">Он также показывает hello пять копий, которые были выполнены с помощью команды копирования большого двоичного объекта hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![В целях тестирования hello копий дисков RAID hello SAP HANA программное обеспечение резервного копирования были toohello вложенного приложения сервера виртуальной Машины](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="003e3-200">В целях тестирования hello копии hello SAP HANA программное обеспечение резервного копирования RAID дисков были toohello вложенного приложения сервера виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="003e3-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![Виртуальная машина сервера приложения Hello была выключена копий дисков tooattach hello](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="003e3-202">Виртуальная машина сервера приложения Hello была завершена копий дисков tooattach hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="003e3-203">После запуска hello виртуальной Машины, hello дисков и hello RAID обнаруженные правильно (устанавливать при помощи UUID).</span><span class="sxs-lookup"><span data-stu-id="003e3-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="003e3-204">Только точку подключения hello отсутствует, которой была создана с помощью разделителя YaST hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="003e3-205">После этого копирует файл резервной копии SAP HANA hello стало видимым на уровне операционной системы.</span><span class="sxs-lookup"><span data-stu-id="003e3-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="003e3-206">Скопируйте файлы резервной копии SAP HANA tooNFS общей папки</span><span class="sxs-lookup"><span data-stu-id="003e3-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="003e3-207">toolessen hello может оказать влияние на hello системы SAP HANA из производительности или дискового пространства перспективы, один может рассмотрите возможность хранения файлов резервной копии hello SAP HANA на общего ресурса NFS.</span><span class="sxs-lookup"><span data-stu-id="003e3-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="003e3-208">Технически это работает, но это означает, что использование второй виртуальной Машине Azure в качестве узла hello из общей папки NFS приветствия.</span><span class="sxs-lookup"><span data-stu-id="003e3-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="003e3-209">Не должно быть небольшой размер виртуальной Машины, из-за toohello пропускной способности сети виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="003e3-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="003e3-210">Это сделает смысле, а затем tooshut вниз это &quot;резервного копирования виртуальной Машины&quot; и вызове его только для выполнения резервного копирования hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="003e3-211">Запись на NFS общего ресурса помещает нагрузки на сеть hello влияние hello системы SAP HANA, а просто управление hello файлы резервных копий позже на hello &quot;резервного копирования виртуальной Машины&quot; не во всех влияют hello системы SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![Общего ресурса NFS с другой ВМ был сервером SAP HANA toohello подключенных виртуальных Машин](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="003e3-213">вариант использования tooverify hello NFS, общего ресурса NFS с другой ВМ был сервером SAP HANA toohello подключенных виртуальных Машин.</span><span class="sxs-lookup"><span data-stu-id="003e3-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="003e3-214">не используя специальные настройки этой системы.</span><span class="sxs-lookup"><span data-stu-id="003e3-214">There was no special NFS tuning applied.</span></span>

![Резервное копирование hello toodo 1 час 46 минут потребовалось напрямую](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="003e3-216">общего ресурса NFS Hello был быстрого чередующемся наборе, например hello один на сервере SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="003e3-217">Тем не менее заняло 1 час и 46 минут toodo hello резервного копирования непосредственно на общих папок NFS hello вместо 10 минут при записи tooa локального чередующийся набор.</span><span class="sxs-lookup"><span data-stu-id="003e3-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![альтернативой Hello не намного быстрее, поскольку на 1 час 43 минуты](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="003e3-219">альтернативой Hello это локальный чередующегося набора архивации tooa и копирование toohello общих ресурсов NFS на уровне операционной системы (простой **cp - avr** команда) не было намного быстрее, поскольку.</span><span class="sxs-lookup"><span data-stu-id="003e3-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="003e3-220">В целом этот процесс занимает 1 час 43 минуты, что не сильно отличается от первого значения.</span><span class="sxs-lookup"><span data-stu-id="003e3-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="003e3-221">Поэтому он работает, но производительность не была хорошо подходит для тестирования резервного копирования 230 ГБ hello.</span><span class="sxs-lookup"><span data-stu-id="003e3-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="003e3-222">А при резервном копировании нескольких терабайт производительность будет еще ниже.</span><span class="sxs-lookup"><span data-stu-id="003e3-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="003e3-223">Скопируйте SAP HANA файлов резервных копий tooAzure файловой службы</span><span class="sxs-lookup"><span data-stu-id="003e3-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="003e3-224">Это возможно toomount Azure общей папки в виртуальной Машине Linux Azure.</span><span class="sxs-lookup"><span data-stu-id="003e3-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="003e3-225">статья Hello [как toouse хранилища Azure File с Linux](../../../storage/files/storage-how-to-use-files-linux.md) предоставляет подробные сведения о том, как toodo его.</span><span class="sxs-lookup"><span data-stu-id="003e3-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="003e3-226">Помните, что сейчас в файловом ресурсе Azure можно хранить 5 ТБ данных, а максимальный размер файла составляет 1 ТБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="003e3-227">Дополнительные сведения об ограничениях хранилища см. в статье [Целевые показатели масштабируемости и производительности службы хранилища Azure](../../../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="003e3-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="003e3-228">Тесты показывают, что сейчас резервное копирование SAP HANA напрямую не поддерживает этот тип подключения CIFS.</span><span class="sxs-lookup"><span data-stu-id="003e3-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="003e3-229">В [примечании к SAP 1820529](https://launchpad.support.sap.com/#/notes/1820529) также указано, что специалисты не советуют использовать CIFS.</span><span class="sxs-lookup"><span data-stu-id="003e3-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![На рисунке показана ошибка в диалоговое окно hello в SAP HANA Studio](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="003e3-231">Этот рисунок отображает ошибку в диалоговое окно hello в SAP HANA Studio, при попытке tooback вверх непосредственно tooa CIFS подключить Azure общей папки.</span><span class="sxs-lookup"><span data-stu-id="003e3-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="003e3-232">Поэтому один имеет toodo стандартную резервную копию SAP HANA в файловой системе виртуальной Машины сначала, а затем hello резервного копирования файлов из отсутствует tooAzure файловой службы.</span><span class="sxs-lookup"><span data-stu-id="003e3-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![На этом рисунке показано занимает 929 секунд toocopy 19 SAP HANA файлов резервных копий](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="003e3-234">На этом рисунке показано затраченное о toocopy 929 секунд 19 SAP HANA резервного копирования файлов общим размером примерно 230 ГБ toohello Azure файлового ресурса общего доступа.</span><span class="sxs-lookup"><span data-stu-id="003e3-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![Hello структуру каталогов источника на hello ВМ SAP HANA был скопированный toohello Azure общей папки](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="003e3-236">На этом снимке экрана, увидит, что структуру каталогов источника hello на hello ВМ SAP HANA был скопированный toohello Azure общей папки: один каталог (hana\_резервного копирования\_fsl\_15 ГБ) и 19 отдельные файлы резервных копий.</span><span class="sxs-lookup"><span data-stu-id="003e3-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="003e3-237">Хранение резервных копий файлов SAP HANA на файлы Azure может быть интересные параметра в будущем hello при его непосредственно поддерживает резервные копии файлов SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="003e3-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="003e3-238">Или когда он становится возможным toomount Azure файлы через NFS и максимальную квоту hello значительно больше, чем 5 ТБ.</span><span class="sxs-lookup"><span data-stu-id="003e3-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="003e3-239">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="003e3-239">Next steps</span></span>
* <span data-ttu-id="003e3-240">Общие сведения и информацию о начале работы см. в [руководстве по резервному копированию SAP HANA на виртуальных машинах Azure](sap-hana-backup-guide.md).</span><span class="sxs-lookup"><span data-stu-id="003e3-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="003e3-241">[Резервное копирование SAP HANA, основанные на моментальных снимках хранилища](sap-hana-backup-storage-snapshots.md) описывает hello вариант хранения данных на основе моментального снимка резервной копии.</span><span class="sxs-lookup"><span data-stu-id="003e3-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="003e3-242">tooestablish высокого уровня доступности и план аварийного восстановления из SAP HANA в Azure (большие экземпляры). в статье toolearn [SAP HANA (крупных экземпляров) высокой доступности и аварийного восстановления в Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="003e3-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
