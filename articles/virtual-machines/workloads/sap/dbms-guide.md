---
title: "SAP NetWeaver на виртуальных машинах Windows. Руководство по развертыванию СУБД | Документация Майкрософт"
description: "SAP NetWeaver на виртуальных машинах Windows. Руководство по развертыванию СУБД"
services: virtual-machines-linux,virtual-machines-windows
documentationcenter: 
author: MSSedusch
manager: timlt
editor: 
tags: azure-resource-manager
keywords: 
ms.assetid: 5654dac7-4204-4387-b312-3d8b2898eb3a
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 11/08/2016
ms.author: sedusch
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 1046d32a0b4b6ede027ef1931314a188c64c94bb
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="azure-virtual-machines-dbms-deployment-for-sap-netweaver"></a><span data-ttu-id="42034-103">SAP NetWeaver на виртуальных машинах Windows. Руководство по развертыванию СУБД</span><span class="sxs-lookup"><span data-stu-id="42034-103">Azure Virtual Machines DBMS deployment for SAP NetWeaver</span></span>
[767598]:https://launchpad.support.sap.com/#/notes/767598
[773830]:https://launchpad.support.sap.com/#/notes/773830
[826037;]:https://launchpad.support.sap.com/#/notes/826037
[965908]:https://launchpad.support.sap.com/#/notes/965908
[1031096]:https://launchpad.support.sap.com/#/notes/1031096
[1114181]:https://launchpad.support.sap.com/#/notes/1114181
[1139904;]:https://launchpad.support.sap.com/#/notes/1139904
[1173395.]:https://launchpad.support.sap.com/#/notes/1173395
[1245200]:https://launchpad.support.sap.com/#/notes/1245200
[1409604]:https://launchpad.support.sap.com/#/notes/1409604
[1558958;]:https://launchpad.support.sap.com/#/notes/1558958
[1585981.]:https://launchpad.support.sap.com/#/notes/1585981
[1588316]:https://launchpad.support.sap.com/#/notes/1588316
[1590719]:https://launchpad.support.sap.com/#/notes/1590719
[1597355]:https://launchpad.support.sap.com/#/notes/1597355
[1605680;]:https://launchpad.support.sap.com/#/notes/1605680
[1619720]:https://launchpad.support.sap.com/#/notes/1619720
[1619726]:https://launchpad.support.sap.com/#/notes/1619726
[1619967;]:https://launchpad.support.sap.com/#/notes/1619967
[1750510]:https://launchpad.support.sap.com/#/notes/1750510
[1752266]:https://launchpad.support.sap.com/#/notes/1752266
[1757924;]:https://launchpad.support.sap.com/#/notes/1757924
[1757928]:https://launchpad.support.sap.com/#/notes/1757928
[1758182]:https://launchpad.support.sap.com/#/notes/1758182
[1758496;]:https://launchpad.support.sap.com/#/notes/1758496
[1772688]:https://launchpad.support.sap.com/#/notes/1772688
[1814258;]:https://launchpad.support.sap.com/#/notes/1814258
[1882376.]:https://launchpad.support.sap.com/#/notes/1882376
[1909114]:https://launchpad.support.sap.com/#/notes/1909114
[1922555;]:https://launchpad.support.sap.com/#/notes/1922555
[1928533]:https://launchpad.support.sap.com/#/notes/1928533
[1941500]:https://launchpad.support.sap.com/#/notes/1941500
[1956005.]:https://launchpad.support.sap.com/#/notes/1956005
[1973241]:https://launchpad.support.sap.com/#/notes/1973241
[1984787]:https://launchpad.support.sap.com/#/notes/1984787
[1999351]:https://launchpad.support.sap.com/#/notes/1999351
[2002167]:https://launchpad.support.sap.com/#/notes/2002167
[2015553]:https://launchpad.support.sap.com/#/notes/2015553
[2039619]:https://launchpad.support.sap.com/#/notes/2039619
[2069760]:https://launchpad.support.sap.com/#/notes/2069760
[2121797]:https://launchpad.support.sap.com/#/notes/2121797
[2134316]:https://launchpad.support.sap.com/#/notes/2134316
[2171857]:https://launchpad.support.sap.com/#/notes/2171857
[2178632]:https://launchpad.support.sap.com/#/notes/2178632
[2191498]:https://launchpad.support.sap.com/#/notes/2191498
[2233094]:https://launchpad.support.sap.com/#/notes/2233094
[2243692]:https://launchpad.support.sap.com/#/notes/2243692

[azure-cli]:../../../cli-install-nodejs.md
[azure-portal]:https://portal.azure.com
[azure-ps]:/powershell/azureps-cmdlets-docs
[azure-quickstart-templates-github]:https://github.com/Azure/azure-quickstart-templates
[azure-script-ps]:https://go.microsoft.com/fwlink/p/?LinkID=395017
[azure-subscription-service-limits]:../../../azure-subscription-service-limits.md
[azure-subscription-service-limits-subscription]:../../../azure-subscription-service-limits.md#subscription-limits

[dbms-guide]:dbms-guide.md 
[dbms-guide-2.1]:dbms-guide.md#c7abf1f0-c927-4a7c-9c1d-c7b5b3b7212f 
[dbms-guide-2.2]:dbms-guide.md#c8e566f9-21b7-4457-9f7f-126036971a91 
[dbms-guide-2.3]:dbms-guide.md#10b041ef-c177-498a-93ed-44b3441ab152 
[dbms-guide-2]:dbms-guide.md#65fa79d6-a85f-47ee-890b-22e794f51a64 
[dbms-guide-3]:dbms-guide.md#871dfc27-e509-4222-9370-ab1de77021c3 
[dbms-guide-5.5.1]:dbms-guide.md#0fef0e79-d3fe-4ae2-85af-73666a6f7268 
[dbms-guide-5.5.2]:dbms-guide.md#f9071eff-9d72-4f47-9da4-1852d782087b 
[dbms-guide-5.6]:dbms-guide.md#1b353e38-21b3-4310-aeb6-a77e7c8e81c8 
[dbms-guide-5.8]:dbms-guide.md#9053f720-6f3b-4483-904d-15dc54141e30 
[dbms-guide-5]:dbms-guide.md#3264829e-075e-4d25-966e-a49dad878737 
[dbms-guide-8.4.1]:dbms-guide.md#b48cfe3b-48e9-4f5b-a783-1d29155bd573 
[dbms-guide-8.4.2]:dbms-guide.md#23c78d3b-ca5a-4e72-8a24-645d141a3f5d 
[dbms-guide-8.4.3]:dbms-guide.md#77cd2fbb-307e-4cbf-a65f-745553f72d2c 
[dbms-guide-8.4.4]:dbms-guide.md#f77c1436-9ad8-44fb-a331-8671342de818 
[dbms-guide-900-sap-cache-server-on-premises]:dbms-guide.md#642f746c-e4d4-489d-bf63-73e80177a0a8
[dbms-guide-managed-disks]:dbms-guide.md#f42c6cb5-d563-484d-9667-b07ae51bce29

[dbms-guide-figure-100]:media/virtual-machines-shared-sap-dbms-guide/100_storage_account_types.png
[dbms-guide-figure-200]:media/virtual-machines-shared-sap-dbms-guide/200-ha-set-for-dbms-ha.png
[dbms-guide-figure-300]:media/virtual-machines-shared-sap-dbms-guide/300-reference-config-iaas.png
[dbms-guide-figure-400]:media/virtual-machines-shared-sap-dbms-guide/400-sql-2012-backup-to-blob-storage.png
[dbms-guide-figure-500]:media/virtual-machines-shared-sap-dbms-guide/500-sql-2012-backup-to-blob-storage-different-containers.png
[dbms-guide-figure-600]:media/virtual-machines-shared-sap-dbms-guide/600-iaas-maxdb.png
[dbms-guide-figure-700]:media/virtual-machines-shared-sap-dbms-guide/700-livecach-prod.png
[dbms-guide-figure-800]:media/virtual-machines-shared-sap-dbms-guide/800-azure-vm-sap-content-server.png
[dbms-guide-figure-900]:media/virtual-machines-shared-sap-dbms-guide/900-sap-cache-server-on-premises.png

[deployment-guide]:deployment-guide.md 
[deployment-guide-2.2]:deployment-guide.md#42ee2bdb-1efc-4ec7-ab31-fe4c22769b94 
[deployment-guide-3.1.2]:deployment-guide.md#3688666f-281f-425b-a312-a77e7db2dfab 
[deployment-guide-3.2]:deployment-guide.md#db477013-9060-4602-9ad4-b0316f8bb281 
[deployment-guide-3.3]:deployment-guide.md#54a1fc6d-24fd-4feb-9c57-ac588a55dff2 
[deployment-guide-3.4]:deployment-guide.md#a9a60133-a763-4de8-8986-ac0fa33aa8c1 
[deployment-guide-3]:deployment-guide.md#b3253ee3-d63b-4d74-a49b-185e76c4088e 
[deployment-guide-4.1]:deployment-guide.md#604bcec2-8b6e-48d2-a944-61b0f5dee2f7 
[deployment-guide-4.2]:deployment-guide.md#7ccf6c3e-97ae-4a7a-9c75-e82c37beb18e 
[deployment-guide-4.3]:deployment-guide.md#31d9ecd6-b136-4c73-b61e-da4a29bbc9cc 
[deployment-guide-4.4.2]:deployment-guide.md#6889ff12-eaaf-4f3c-97e1-7c9edc7f7542 
[deployment-guide-4.4]:deployment-guide.md#c7cbb0dc-52a4-49db-8e03-83e7edc2927d 
[deployment-guide-4.5.1]:deployment-guide.md#987cf279-d713-4b4c-8143-6b11589bb9d4 
[deployment-guide-4.5.2]:deployment-guide.md#408f3779-f422-4413-82f8-c57a23b4fc2f 
[deployment-guide-4.5]:deployment-guide.md#d98edcd3-f2a1-49f7-b26a-07448ceb60ca 
[deployment-guide-5.1]:deployment-guide.md#bb61ce92-8c5c-461f-8c53-39f5e5ed91f2 
[deployment-guide-5.2]:deployment-guide.md#e2d592ff-b4ea-4a53-a91a-e5521edb6cd1
[deployment-guide-5.3]:deployment-guide.md#fe25a7da-4e4e-4388-8907-8abc2d33cfd8 

[deployment-guide-configure-monitoring-scenario-1]:deployment-guide.md#ec323ac3-1de9-4c3a-b770-4ff701def65b 
[deployment-guide-configure-proxy]:deployment-guide.md#baccae00-6f79-4307-ade4-40292ce4e02d 
[deployment-guide-figure-100]:media/virtual-machines-shared-sap-deployment-guide/100-deploy-vm-image.png
[deployment-guide-figure-1000]:media/virtual-machines-shared-sap-deployment-guide/1000-service-properties.png
[deployment-guide-figure-11]:deployment-guide.md#figure-11
[deployment-guide-figure-1100]:media/virtual-machines-shared-sap-deployment-guide/1100-azperflib.png
[deployment-guide-figure-1200]:media/virtual-machines-shared-sap-deployment-guide/1200-cmd-test-login.png
[deployment-guide-figure-1300]:media/virtual-machines-shared-sap-deployment-guide/1300-cmd-test-executed.png
[deployment-guide-figure-14]:deployment-guide.md#figure-14
[deployment-guide-figure-1400]:media/virtual-machines-shared-sap-deployment-guide/1400-azperflib-error-servicenotstarted.png
[deployment-guide-figure-300]:media/virtual-machines-shared-sap-deployment-guide/300-deploy-private-image.png
[deployment-guide-figure-400]:media/virtual-machines-shared-sap-deployment-guide/400-deploy-using-disk.png
[deployment-guide-figure-5]:deployment-guide.md#figure-5
[deployment-guide-figure-50]:media/virtual-machines-shared-sap-deployment-guide/50-forced-tunneling-suse.png
[deployment-guide-figure-500]:media/virtual-machines-shared-sap-deployment-guide/500-install-powershell.png
[deployment-guide-figure-6]:deployment-guide.md#figure-6
[deployment-guide-figure-600]:media/virtual-machines-shared-sap-deployment-guide/600-powershell-version.png
[deployment-guide-figure-7]:deployment-guide.md#figure-7
[deployment-guide-figure-700]:media/virtual-machines-shared-sap-deployment-guide/700-install-powershell-installed.png
[deployment-guide-figure-760]:media/virtual-machines-shared-sap-deployment-guide/760-azure-cli-version.png
[deployment-guide-figure-900]:media/virtual-machines-shared-sap-deployment-guide/900-cmd-update-executed.png
[deployment-guide-figure-azure-cli-installed]:deployment-guide.md#402488e5-f9bb-4b29-8063-1c5f52a892d0
[deployment-guide-figure-azure-cli-version]:deployment-guide.md#0ad010e6-f9b5-4c21-9c09-bb2e5efb3fda
[deployment-guide-install-vm-agent-windows]:deployment-guide.md#b2db5c9a-a076-42c6-9835-16945868e866
[deployment-guide-troubleshooting-chapter]:deployment-guide.md#564adb4f-5c95-4041-9616-6635e83a810b

[deploy-template-cli]:../../../resource-group-template-deploy-cli.md
[deploy-template-portal]:../../../resource-group-template-deploy-portal.md
[deploy-template-powershell]:../../../resource-group-template-deploy.md

[dr-guide-classic]:http://go.microsoft.com/fwlink/?LinkID=521971

[getting-started]:get-started.md
[getting-started-dbms]:get-started.md#1343ffe1-8021-4ce6-a08d-3a1553a4db82
[getting-started-deployment]:get-started.md#6aadadd2-76b5-46d8-8713-e8d63630e955
[getting-started-planning]:get-started.md#3da0389e-708b-4e82-b2a2-e92f132df89c

[getting-started-windows-classic]:../../virtual-machines-windows-classic-sap-get-started.md
[getting-started-windows-classic-dbms]:../../virtual-machines-windows-classic-sap-get-started.md#c5b77a14-f6b4-44e9-acab-4d28ff72a930
[getting-started-windows-classic-deployment]:../../virtual-machines-windows-classic-sap-get-started.md#f84ea6ce-bbb4-41f7-9965-34d31b0098ea
[getting-started-windows-classic-dr]:../../virtual-machines-windows-classic-sap-get-started.md#cff10b4a-01a5-4dc3-94b6-afb8e55757d3
[getting-started-windows-classic-ha-sios]:../../virtual-machines-windows-classic-sap-get-started.md#4bb7512c-0fa0-4227-9853-4004281b1037
[getting-started-windows-classic-planning]:../../virtual-machines-windows-classic-sap-get-started.md#f2a5e9d8-49e4-419e-9900-af783173481c

[ha-guide-classic]:http://go.microsoft.com/fwlink/?LinkId=613056

[install-extension-cli]:virtual-machines-linux-enable-aem.md

[Logo_Linux]:media/virtual-machines-shared-sap-shared/Linux.png
[Logo_Windows]:media/virtual-machines-shared-sap-shared/Windows.png

[msdn-set-azurermvmaemextension]:https://msdn.microsoft.com/library/azure/mt670598.aspx

[planning-guide]:planning-guide.md 
[planning-guide-1.2]:planning-guide.md#e55d1e22-c2c8-460b-9897-64622a34fdff 
[planning-guide-11]:planning-guide.md#7cf991a1-badd-40a9-944e-7baae842a058 
[planning-guide-11.4.1]:planning-guide.md#5d9d36f9-9058-435d-8367-5ad05f00de77 
[planning-guide-11.5]:planning-guide.md#4e165b58-74ca-474f-a7f4-5e695a93204f 
[planning-guide-2.1]:planning-guide.md#1625df66-4cc6-4d60-9202-de8a0b77f803 
[planning-guide-2.2]:planning-guide.md#f5b3b18c-302c-4bd8-9ab2-c388f1ab3d10 
[planning-guide-3.1]:planning-guide.md#be80d1b9-a463-4845-bd35-f4cebdb5424a 
[planning-guide-3.2.1]:planning-guide.md#df49dc09-141b-4f34-a4a2-990913b30358 
[planning-guide-3.2.2]:planning-guide.md#fc1ac8b2-e54a-487c-8581-d3cc6625e560 
[planning-guide-3.2.3]:planning-guide.md#18810088-f9be-4c97-958a-27996255c665 
[planning-guide-3.2]:planning-guide.md#8d8ad4b8-6093-4b91-ac36-ea56d80dbf77 
[planning-guide-3.3.2]:planning-guide.md#ff5ad0f9-f7f4-4022-9102-af07aef3bc92 
[planning-guide-5.1.1]:planning-guide.md#4d175f1b-7353-4137-9d2f-817683c26e53 
[planning-guide-5.1.2]:planning-guide.md#e18f7839-c0e2-4385-b1e6-4538453a285c 
[planning-guide-5.2.1]:planning-guide.md#1b287330-944b-495d-9ea7-94b83aff73ef 
[planning-guide-5.2.2]:planning-guide.md#57f32b1c-0cba-4e57-ab6e-c39fe22b6ec3 
[planning-guide-5.2]:planning-guide.md#6ffb9f41-a292-40bf-9e70-8204448559e7 
[planning-guide-5.3.1]:planning-guide.md#6e835de8-40b1-4b71-9f18-d45b20959b79 
[planning-guide-5.3.2]:planning-guide.md#a43e40e6-1acc-4633-9816-8f095d5a7b6a 
[planning-guide-5.4.2]:planning-guide.md#9789b076-2011-4afa-b2fe-b07a8aba58a1 
[planning-guide-5.5.1]:planning-guide.md#4efec401-91e0-40c0-8e64-f2dceadff646 
[planning-guide-5.5.3]:planning-guide.md#17e0d543-7e8c-4160-a7da-dd7117a1ad9d 
[planning-guide-7.1]:planning-guide.md#3e9c3690-da67-421a-bc3f-12c520d99a30 
[planning-guide-7]:planning-guide.md#96a77628-a05e-475d-9df3-fb82217e8f14 
[planning-guide-9.1]:planning-guide.md#6f0a47f3-a289-4090-a053-2521618a28c3 
[planning-guide-azure-premium-storage]:planning-guide.md#ff5ad0f9-f7f4-4022-9102-af07aef3bc92 

[planning-guide-figure-100]:media/virtual-machines-shared-sap-planning-guide/100-single-vm-in-azure.png
[planning-guide-figure-1300]:media/virtual-machines-shared-sap-planning-guide/1300-ref-config-iaas-for-sap.png
[planning-guide-figure-1400]:media/virtual-machines-shared-sap-planning-guide/1400-attach-detach-disks.png
[planning-guide-figure-1600]:media/virtual-machines-shared-sap-planning-guide/1600-firewall-port-rule.png
[planning-guide-figure-1700]:media/virtual-machines-shared-sap-planning-guide/1700-single-vm-demo.png
[planning-guide-figure-1900]:media/virtual-machines-shared-sap-planning-guide/1900-vm-set-vnet.png
[planning-guide-figure-200]:media/virtual-machines-shared-sap-planning-guide/200-multiple-vms-in-azure.png
[planning-guide-figure-2100]:media/virtual-machines-shared-sap-planning-guide/2100-s2s.png
[planning-guide-figure-2200]:media/virtual-machines-shared-sap-planning-guide/2200-network-printing.png
[planning-guide-figure-2300]:media/virtual-machines-shared-sap-planning-guide/2300-sapgui-stms.png
[planning-guide-figure-2400]:media/virtual-machines-shared-sap-planning-guide/2400-vm-extension-overview.png
[planning-guide-figure-2500]:media/virtual-machines-shared-sap-planning-guide/2500-vm-extension-details.png
[planning-guide-figure-2600]:media/virtual-machines-shared-sap-planning-guide/2600-sap-router-connection.png
[planning-guide-figure-2700]:media/virtual-machines-shared-sap-planning-guide/2700-exposed-sap-portal.png
[planning-guide-figure-2800]:media/virtual-machines-shared-sap-planning-guide/2800-endpoint-config.png
[planning-guide-figure-2900]:media/virtual-machines-shared-sap-planning-guide/2900-azure-ha-sap-ha.png
[planning-guide-figure-300]:media/virtual-machines-shared-sap-planning-guide/300-vpn-s2s.png
[planning-guide-figure-3000]:media/virtual-machines-shared-sap-planning-guide/3000-sap-ha-on-azure.png
[planning-guide-figure-3200]:media/virtual-machines-shared-sap-planning-guide/3200-sap-ha-with-sql.png
[planning-guide-figure-400]:media/virtual-machines-shared-sap-planning-guide/400-vm-services.png
[planning-guide-figure-600]:media/virtual-machines-shared-sap-planning-guide/600-s2s-details.png
[planning-guide-figure-700]:media/virtual-machines-shared-sap-planning-guide/700-decision-tree-deploy-to-azure.png
[planning-guide-figure-800]:media/virtual-machines-shared-sap-planning-guide/800-portal-vm-overview.png
[planning-guide-microsoft-azure-networking]:planning-guide.md#61678387-8868-435d-9f8c-450b2424f5bd 
[planning-guide-storage-microsoft-azure-storage-and-data-disks]:planning-guide.md#a72afa26-4bf4-4a25-8cf7-855d6032157f 

[powershell-install-configure]:https://docs.microsoft.com/powershell/azure/install-azurerm-ps
[resource-group-authoring-templates]:../../../resource-group-authoring-templates.md
[resource-group-overview]:../../../azure-resource-manager/resource-group-overview.md
[resource-groups-networking]:../../../virtual-network/resource-groups-networking.md
[sap-pam]:https://support.sap.com/pam 
[sap-templates-2-tier-marketplace-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-marketplace-image%2Fazuredeploy.json
[sap-templates-2-tier-os-disk]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-user-disk%2Fazuredeploy.json
[sap-templates-2-tier-user-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-2-tier-user-image%2Fazuredeploy.json
[sap-templates-3-tier-marketplace-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-3-tier-marketplace-image%2Fazuredeploy.json
[sap-templates-3-tier-user-image]:https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fsap-3-tier-user-image%2Fazuredeploy.json
[storage-azure-cli]:../../../storage/common/storage-azure-cli.md
[storage-azure-cli-copy-blobs]:../../../storage/common/storage-azure-cli.md#copy-blobs
[storage-introduction]:../../../storage/common/storage-introduction.md
[storage-powershell-guide-full-copy-vhd]:../../../storage/common/storage-powershell-guide-full.md#how-to-copy-blobs-from-one-storage-container-to-another
[storage-premium-storage-preview-portal]:../../../storage/common/storage-premium-storage.md
[storage-redundancy]:../../../storage/common/storage-redundancy.md
[storage-scalability-targets]:../../../storage/common/storage-scalability-targets.md
[storage-use-azcopy]:../../../storage/common/storage-use-azcopy.md
[template-201-vm-from-specialized-vhd]:https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-from-specialized-vhd
[templates-101-simple-windows-vm]:https://github.com/Azure/azure-quickstart-templates/tree/master/101-simple-windows-vm
[templates-101-vm-from-user-image]:https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-from-user-image
[virtual-machines-linux-attach-disk-portal]:../../linux/attach-disk-portal.md
[virtual-machines-azure-resource-manager-architecture]:../../../resource-manager-deployment-model.md
[virtual-machines-azurerm-versus-azuresm]:../../../resource-manager-deployment-model.md
[virtual-machines-windows-classic-configure-oracle-data-guard]:../../virtual-machines-windows-classic-configure-oracle-data-guard.md
[virtual-machines-linux-cli-deploy-templates]:../../linux/cli-deploy-templates.md 
[virtual-machines-deploy-rmtemplates-powershell]:../../virtual-machines-windows-ps-manage.md 
[virtual-machines-linux-agent-user-guide]:../../linux/agent-user-guide.md
[virtual-machines-linux-agent-user-guide-command-line-options]:../../linux/agent-user-guide.md#command-line-options
[virtual-machines-linux-capture-image]:../../linux/capture-image.md
[virtual-machines-linux-capture-image-resource-manager]:../../linux/capture-image.md
[virtual-machines-linux-capture-image-resource-manager-capture]:../../linux/capture-image.md#step-2-capture-the-vm
[virtual-machines-linux-configure-raid]:../../linux/configure-raid.md
[virtual-machines-linux-configure-lvm]:../../linux/configure-lvm.md
[virtual-machines-linux-classic-create-upload-vhd-step-1]:../../virtual-machines-linux-classic-create-upload-vhd.md#step-1-prepare-the-image-to-be-uploaded
[virtual-machines-linux-create-upload-vhd-suse]:../../linux/suse-create-upload-vhd.md
[virtual-machines-linux-redhat-create-upload-vhd]:../../linux/redhat-create-upload-vhd.md
[virtual-machines-linux-how-to-attach-disk]:../../linux/add-disk.md
[virtual-machines-linux-how-to-attach-disk-how-to-initialize-a-new-data-disk-in-linux]:../../linux/add-disk.md#connect-to-the-linux-vm-to-mount-the-new-disk
[virtual-machines-linux-tutorial]:../../linux/quick-create-cli.md
[virtual-machines-linux-update-agent]:../../linux/update-agent.md
[virtual-machines-manage-availability-linux]:../../linux/manage-availability.md
[virtual-machines-manage-availability-windows]:../../windows/manage-availability.md
[virtual-machines-ps-create-preconfigure-windows-resource-manager-vms]:virtual-machines-windows-create-powershell.md
[virtual-machines-sizes-linux]:../../linux/sizes.md
[virtual-machines-sizes-windows]:../../windows/sizes.md
[virtual-machines-windows-classic-ps-sql-alwayson-availability-groups]:./../../windows/sqlclassic/virtual-machines-windows-classic-ps-sql-alwayson-availability-groups.md
[virtual-machines-windows-classic-ps-sql-int-listener]:./../../windows/sqlclassic/virtual-machines-windows-classic-ps-sql-int-listener.md
[virtual-machines-sql-server-high-availability-and-disaster-recovery-solutions]:./../../windows/sql/virtual-machines-windows-sql-high-availability-dr.md
[virtual-machines-sql-server-infrastructure-services]:./../../windows/sql/virtual-machines-windows-sql-server-iaas-overview.md
[virtual-machines-sql-server-performance-best-practices]:./../../windows/sql/virtual-machines-windows-sql-performance.md
[virtual-machines-upload-image-windows-resource-manager]:../../virtual-machines-windows-upload-image.md
[virtual-machines-windows-tutorial]:../../virtual-machines-windows-hero-tutorial.md
[virtual-machines-workload-template-sql-alwayson]:https://azure.microsoft.com/documentation/templates/sql-server-2014-alwayson-dsc/
[virtual-network-deploy-multinic-arm-cli]:../../../virtual-network/virtual-network-deploy-multinic-arm-cli.md
[virtual-network-deploy-multinic-arm-ps]:../../../virtual-network/virtual-network-deploy-multinic-arm-ps.md
[virtual-network-deploy-multinic-arm-template]:../../../virtual-network/virtual-network-deploy-multinic-arm-template.md
[virtual-networks-configure-vnet-to-vnet-connection]:../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md
[virtual-networks-create-vnet-arm-pportal]:../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md
[virtual-networks-manage-dns-in-vnet]:../../../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md
[virtual-networks-multiple-nics]:../../../virtual-network/virtual-networks-multiple-nics.md
[virtual-networks-nsg]:../../../virtual-network/virtual-networks-nsg.md
[virtual-networks-reserved-private-ip]:../../../virtual-network/virtual-networks-static-private-ip-arm-ps.md
[virtual-networks-static-private-ip-arm-pportal]:../../../virtual-network/virtual-networks-static-private-ip-arm-pportal.md
[virtual-networks-udr-overview]:../../../virtual-network/virtual-networks-udr-overview.md
[vpn-gateway-about-vpn-devices]:../../../vpn-gateway/vpn-gateway-about-vpn-devices.md
[vpn-gateway-create-site-to-site-rm-powershell]:../../../vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md
[vpn-gateway-cross-premises-options]:../../../vpn-gateway/vpn-gateway-plan-design.md
[vpn-gateway-site-to-site-create]:../../../vpn-gateway/vpn-gateway-site-to-site-create.md
[vpn-gateway-vpn-faq]:../../../vpn-gateway/vpn-gateway-vpn-faq.md
[xplat-cli]:../../../cli-install-nodejs.md
[xplat-cli-azure-resource-manager]:../../../xplat-cli-azure-resource-manager.md

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-rm-include.md)]

<span data-ttu-id="42034-149">Это руководство — часть документации по внедрению и развертыванию программного обеспечения SAP в Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-149">This guide is part of the documentation on implementing and deploying the SAP software on Microsoft Azure.</span></span> <span data-ttu-id="42034-150">Перед ознакомлением с этим руководством прочитайте статью [SAP NetWeaver на виртуальных машинах Azure. Руководство по планированию и реализации][planning-guide].</span><span class="sxs-lookup"><span data-stu-id="42034-150">Before reading this guide, read the [Planning and Implementation Guide][planning-guide].</span></span> <span data-ttu-id="42034-151">В руководстве рассматривается развертывание различных реляционных систем управления базами данных (РСУБД) и связанных продуктов в сочетании с SAP на виртуальных машинах Microsoft Azure с использованием возможностей инфраструктуры Azure как услуги (IaaS).</span><span class="sxs-lookup"><span data-stu-id="42034-151">This document covers the deployment of various Relational Database Management Systems (RDBMS) and related products in combination with SAP on Microsoft Azure Virtual Machines (VMs) using the Azure Infrastructure as a Service (IaaS) capabilities.</span></span>

<span data-ttu-id="42034-152">Это руководство дополняет документацию по установке SAP и комментарии по SAP, которые являются основными ресурсами по установке и развертыванию SAP на упомянутых платформах.</span><span class="sxs-lookup"><span data-stu-id="42034-152">The paper complements the SAP Installation Documentation and SAP Notes, which represent the primary resources for installations and deployments of SAP software on given platforms.</span></span>

## <a name="general-considerations"></a><span data-ttu-id="42034-153">Общие рекомендации</span><span class="sxs-lookup"><span data-stu-id="42034-153">General considerations</span></span>
<span data-ttu-id="42034-154">В этой главе рассматриваются вопросы запуска связанных с SAP систем СУБД на виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-154">In this chapter, considerations of running SAP-related DBMS systems in Azure VMs are introduced.</span></span> <span data-ttu-id="42034-155">Также здесь приводятся ссылки на конкретные СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-155">There are few references to specific DBMS systems in this chapter.</span></span> <span data-ttu-id="42034-156">Конкретные СУБД рассматриваются в руководстве после этой главы.</span><span class="sxs-lookup"><span data-stu-id="42034-156">Instead the specific DBMS systems are handled within this paper, after this chapter.</span></span>

### <a name="definitions-upfront"></a><span data-ttu-id="42034-157">Определения</span><span class="sxs-lookup"><span data-stu-id="42034-157">Definitions upfront</span></span>
<span data-ttu-id="42034-158">В этом документе мы будем использовать следующие термины.</span><span class="sxs-lookup"><span data-stu-id="42034-158">Throughout the document, we use the following terms:</span></span>

* <span data-ttu-id="42034-159">IaaS: инфраструктура как услуга.</span><span class="sxs-lookup"><span data-stu-id="42034-159">IaaS: Infrastructure as a Service.</span></span>
* <span data-ttu-id="42034-160">PaaS: платформа как услуга.</span><span class="sxs-lookup"><span data-stu-id="42034-160">PaaS: Platform as a Service.</span></span>
* <span data-ttu-id="42034-161">SaaS: программное обеспечение как услуга.</span><span class="sxs-lookup"><span data-stu-id="42034-161">SaaS: Software as a Service.</span></span>
* <span data-ttu-id="42034-162">Компонент SAP: отдельное приложение SAP, например ECC, BW, Solution Manager или EP.</span><span class="sxs-lookup"><span data-stu-id="42034-162">SAP Component: an individual SAP application such as ECC, BW, Solution Manager, or EP.</span></span>  <span data-ttu-id="42034-163">Компоненты SAP могут основываться на традиционной технологии ABAP или Java или быть приложениями не на основе NetWeaver, например бизнес-объектами.</span><span class="sxs-lookup"><span data-stu-id="42034-163">SAP components can be based on traditional ABAP or Java technologies or a non-NetWeaver based application such as Business Objects.</span></span>
* <span data-ttu-id="42034-164">Среда SAP: один или несколько компонентов SAP, логически сгруппированных для выполнения бизнес-функции (разработка, оценка качества, обучение, аварийное восстановление или производство).</span><span class="sxs-lookup"><span data-stu-id="42034-164">SAP Environment: one or more SAP components logically grouped to perform a business function such as Development, QAS, Training, DR, or Production.</span></span>
* <span data-ttu-id="42034-165">Ландшафт SAP: термин обозначает все ресурсы SAP, доступные в клиентском ИТ-ландшафте.</span><span class="sxs-lookup"><span data-stu-id="42034-165">SAP Landscape: This refers to the entire SAP assets in a customer’s IT landscape.</span></span> <span data-ttu-id="42034-166">Ландшафт SAP включает все рабочие и нерабочие среды.</span><span class="sxs-lookup"><span data-stu-id="42034-166">The SAP landscape includes all production and non-production environments.</span></span>
* <span data-ttu-id="42034-167">Система SAP: сочетание уровня СУБД и уровня приложений системы разработки SAP ERP, например тестовой системы SAP BW, рабочей системы SAP CRM и т. д. В развертываниях Azure не поддерживается разделение этих двух уровней между локальной средой и Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-167">SAP System: The combination of DBMS layer and application layer of, for example, an SAP ERP development system, SAP BW test system, SAP CRM production system, etc. In Azure deployments, it is not supported to divide these two layers between on-premises and Azure.</span></span> <span data-ttu-id="42034-168">Таким образом, система SAP должна быть развернута полностью в локальной среде или полностью в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-168">This means an SAP system is either deployed on-premises or it is deployed in Azure.</span></span> <span data-ttu-id="42034-169">Но при этом вы можете развертывать разные системы ландшафта SAP как в Azure, так и локально.</span><span class="sxs-lookup"><span data-stu-id="42034-169">However, you can deploy the different systems of an SAP landscape in Azure or on-premises.</span></span> <span data-ttu-id="42034-170">Например, системы разработки и тестирования SAP CRM можно развернуть в Azure, а производственную систему SAP CRM — в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-170">For example, you could deploy the SAP CRM development and test systems in Azure but the SAP CRM production system on-premises.</span></span>
* <span data-ttu-id="42034-171">Развертывание только в облаке: это развертывание, в котором подписка Azure не подключена к инфраструктуре локальной сети через подключение типа "сеть — сеть" или ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="42034-171">Cloud-Only deployment: A deployment where the Azure subscription is not connected via a site-to-site or ExpressRoute connection to the on-premises network infrastructure.</span></span> <span data-ttu-id="42034-172">В документации Azure развертывания такого рода традиционно называются полностью облачными.</span><span class="sxs-lookup"><span data-stu-id="42034-172">In common Azure documentation these kinds of deployments are also described as ‘Cloud-Only’ deployments.</span></span> <span data-ttu-id="42034-173">Доступ к виртуальным машинам, развернутым с помощью этого метода, осуществляется через Интернет по общедоступным конечным точкам, которые назначаются виртуальным машинам в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-173">Virtual Machines deployed with this method are accessed through the Internet and public Internet endpoints assigned to the VMs in Azure.</span></span> <span data-ttu-id="42034-174">В этих типах развертываний Active Directory (AD) и DNS из локальной сети не расширяется в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-174">The on-premises Active Directory (AD) and DNS is not extended to Azure in these types of deployments.</span></span> <span data-ttu-id="42034-175">Таким образом, эти виртуальные машины не входят в локальный каталог Active Directory.</span><span class="sxs-lookup"><span data-stu-id="42034-175">Hence the VMs are not part of the on-premises Active Directory.</span></span> <span data-ttu-id="42034-176">Примечание. Развертывания только в облаке в этом документе определяются как полные ландшафты SAP, которые работают исключительно в Azure. Для них службы Active Directory и служба разрешения имен не распространяются из локальной сети в общедоступное облако.</span><span class="sxs-lookup"><span data-stu-id="42034-176">Note: Cloud-Only deployments in this document are defined as complete SAP landscapes, which are running exclusively in Azure without extension of Active Directory or name resolution from on-premises into public cloud.</span></span> <span data-ttu-id="42034-177">Полностью облачные конфигурации не поддерживаются для производственных систем SAP и конфигураций, в которых требуется наличие SAP STMS или других локальных ресурсов между размещенными в Azure системами SAP и локальными ресурсами.</span><span class="sxs-lookup"><span data-stu-id="42034-177">Cloud-Only configurations are not supported for production SAP systems or configurations where SAP STMS or other on-premises resources need to be used between SAP systems hosted on Azure and resources residing on-premises.</span></span>
* <span data-ttu-id="42034-178">Распределенное развертывание: описывает сценарии, при которых в подписке Azure развернуты виртуальные машины с подключениями типа "сеть — сеть" или ExpressRoute между локальными центрами обработки данных и Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-178">Cross-Premises: Describes a scenario where VMs are deployed to an Azure subscription that has site-to-site, multi-site, or ExpressRoute connectivity between the on-premises datacenter(s) and Azure.</span></span> <span data-ttu-id="42034-179">В документации Azure развертывания такого рода также называются распределенными развертываниями.</span><span class="sxs-lookup"><span data-stu-id="42034-179">In common Azure documentation, these kinds of deployments are also described as Cross-Premises scenarios.</span></span> <span data-ttu-id="42034-180">Такое подключение используется для расширения в Azure локальных доменов, локальной службы Active Directory и локальной службы DNS.</span><span class="sxs-lookup"><span data-stu-id="42034-180">The reason for the connection is to extend on-premises domains, on-premises Active Directory, and on-premises DNS into Azure.</span></span> <span data-ttu-id="42034-181">Локальная среда распространяется на ресурсы Azure, входящие в подписку.</span><span class="sxs-lookup"><span data-stu-id="42034-181">The on-premises landscape is extended to the Azure assets of the subscription.</span></span> <span data-ttu-id="42034-182">При таком расширении виртуальные машины могут быть частью локального домена.</span><span class="sxs-lookup"><span data-stu-id="42034-182">Having this extension, the VMs can be part of the on-premises domain.</span></span> <span data-ttu-id="42034-183">Пользователи локального домена имеют доступ к серверам и могут запускать службы на этих виртуальных машинах (например, службы СУБД).</span><span class="sxs-lookup"><span data-stu-id="42034-183">Domain users of the on-premises domain can access the servers and can run services on those VMs (like DBMS services).</span></span> <span data-ttu-id="42034-184">Возможно взаимодействие и разрешение имен между виртуальными машинами, развернутыми в локальной сети и Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-184">Communication and name resolution between VMs deployed on-premises and VMs deployed in Azure is possible.</span></span> <span data-ttu-id="42034-185">Ожидается, что это будет наиболее распространенным сценарием развертывания ресурсов SAP в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-185">We expect this to be the most common scenario for deploying SAP assets on Azure.</span></span> <span data-ttu-id="42034-186">Дополнительные сведения см. в [этой][vpn-gateway-cross-premises-options] и [этой][vpn-gateway-site-to-site-create] статьях.</span><span class="sxs-lookup"><span data-stu-id="42034-186">For more information, see [this article][vpn-gateway-cross-premises-options] and [this article][vpn-gateway-site-to-site-create].</span></span>

> [!NOTE]
> <span data-ttu-id="42034-187">Для производственных систем SAP поддерживаются распределенные развертывания систем SAP, в которых системы SAP выполняются на виртуальных машинах Azure, являющихся членами локального домена.</span><span class="sxs-lookup"><span data-stu-id="42034-187">Cross-Premises deployments of SAP systems where Azure Virtual Machines running SAP systems are members of an on-premises domain are supported for production SAP systems.</span></span> <span data-ttu-id="42034-188">Распределенная конфигурация предполагает развертывание в Azure полного ландшафта SAP или его частей.</span><span class="sxs-lookup"><span data-stu-id="42034-188">Cross-Premises configurations are supported for deploying parts or complete SAP landscapes into Azure.</span></span> <span data-ttu-id="42034-189">Даже если весь ландшафт SAP работает в Azure, эти виртуальные машины должны входить в локальный домен и каталог ADS.</span><span class="sxs-lookup"><span data-stu-id="42034-189">Even running the complete SAP landscape in Azure requires having those VMs being part of on-premises domain and ADS.</span></span> <span data-ttu-id="42034-190">В прежних версиях этого документа мы говорили о гибридных сценариях ИТ-систем, где термин "гибридные" применялся на том основании, что между локальной сетью и Azure существует распределенное подключение.</span><span class="sxs-lookup"><span data-stu-id="42034-190">In former versions of the documentation, we talked about Hybrid-IT scenarios, where the term ‘Hybrid’ is rooted in the fact that there is a cross-premises connectivity between on-premises and Azure.</span></span> <span data-ttu-id="42034-191">Кроме того, этот термин также обозначает, что развернутые в Azure виртуальные машины являются частью локальной системы Active Directory.</span><span class="sxs-lookup"><span data-stu-id="42034-191">In this case ‘Hybrid’ also means that the VMs in Azure are part of the on-premises Active Directory.</span></span>
> 
> 

<span data-ttu-id="42034-192">В некоторой документации Майкрософт сценарии распределенного подключения описываются иначе. В частности, это касается высокодоступных конфигураций СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-192">Some Microsoft documentation describes Cross-Premises scenarios a bit differently, especially for DBMS HA configurations.</span></span> <span data-ttu-id="42034-193">В документации по SAP сценарий распределенного подключения сводится к двум моментам: наличию подключения типа "сеть — сеть" или частного (ExpressRoute) подключения, а также распределению ландшафта SAP между локальной сетью и Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-193">In the case of the SAP-related documents, the Cross-Premises scenario just boils down to having a site-to-site or private (ExpressRoute) connectivity and to the fact that the SAP landscape is distributed between on-premises and Azure.</span></span>

### <a name="resources"></a><span data-ttu-id="42034-194">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="42034-194">Resources</span></span>
<span data-ttu-id="42034-195">По теме развертывания SAP в Azure доступны следующие руководства:</span><span class="sxs-lookup"><span data-stu-id="42034-195">The following guides are available for the topic of SAP deployments on Azure:</span></span>

* <span data-ttu-id="42034-196">[SAP NetWeaver на виртуальных машинах Windows. Руководство по планированию и внедрению][planning-guide]</span><span class="sxs-lookup"><span data-stu-id="42034-196">[Azure Virtual Machines planning and implementation for SAP NetWeaver][planning-guide]</span></span>
* <span data-ttu-id="42034-197">[SAP NetWeaver на виртуальных машинах Windows. Руководство по развертыванию][deployment-guide]</span><span class="sxs-lookup"><span data-stu-id="42034-197">[Azure Virtual Machines deployment for SAP NetWeaver][deployment-guide]</span></span>
* <span data-ttu-id="42034-198">[SAP NetWeaver на виртуальных машинах Windows. Руководство по развертыванию СУБД (этот документ)][dbms-guide]</span><span class="sxs-lookup"><span data-stu-id="42034-198">[Azure Virtual Machines DBMS deployment for SAP NetWeaver (this document)][dbms-guide]</span></span>

<span data-ttu-id="42034-199">Следующие примечания по SAP актуальны для развертывания SAP в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-199">The following SAP Notes are related to the topic of SAP on Azure:</span></span>

| <span data-ttu-id="42034-200">Номер примечания</span><span class="sxs-lookup"><span data-stu-id="42034-200">Note number</span></span> | <span data-ttu-id="42034-201">Название</span><span class="sxs-lookup"><span data-stu-id="42034-201">Title</span></span> |
| --- | --- |
| <span data-ttu-id="42034-202">[1928533]</span><span class="sxs-lookup"><span data-stu-id="42034-202">[1928533]</span></span> |<span data-ttu-id="42034-203">Приложения SAP в Azure: поддерживаемые продукты и типы виртуальных машин Azure</span><span class="sxs-lookup"><span data-stu-id="42034-203">SAP Applications on Azure: Supported Products and Azure VM types</span></span> |
| <span data-ttu-id="42034-204">[2015553]</span><span class="sxs-lookup"><span data-stu-id="42034-204">[2015553]</span></span> |<span data-ttu-id="42034-205">SAP в Microsoft Azure: требования</span><span class="sxs-lookup"><span data-stu-id="42034-205">SAP on Microsoft Azure: Support Prerequisites</span></span> |
| <span data-ttu-id="42034-206">[1999351]</span><span class="sxs-lookup"><span data-stu-id="42034-206">[1999351]</span></span> |<span data-ttu-id="42034-207">Устранение неполадок, связанных с расширенным мониторингом Azure для SAP</span><span class="sxs-lookup"><span data-stu-id="42034-207">Troubleshooting Enhanced Azure Monitoring for SAP</span></span> |
| <span data-ttu-id="42034-208">[2178632]</span><span class="sxs-lookup"><span data-stu-id="42034-208">[2178632]</span></span> |<span data-ttu-id="42034-209">Ключевые метрики мониторинга для SAP в Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="42034-209">Key Monitoring Metrics for SAP on Microsoft Azure</span></span> |
| <span data-ttu-id="42034-210">[1409604]</span><span class="sxs-lookup"><span data-stu-id="42034-210">[1409604]</span></span> |<span data-ttu-id="42034-211">Виртуализация в Windows: расширенный мониторинг</span><span class="sxs-lookup"><span data-stu-id="42034-211">Virtualization on Windows: Enhanced Monitoring</span></span> |
| <span data-ttu-id="42034-212">[2191498]</span><span class="sxs-lookup"><span data-stu-id="42034-212">[2191498]</span></span> |<span data-ttu-id="42034-213">SAP на платформе Linux в Azure: расширенный мониторинг</span><span class="sxs-lookup"><span data-stu-id="42034-213">SAP on Linux with Azure: Enhanced Monitoring</span></span> |
| <span data-ttu-id="42034-214">[2039619]</span><span class="sxs-lookup"><span data-stu-id="42034-214">[2039619]</span></span> |<span data-ttu-id="42034-215">Приложения SAP в Microsoft Azure с использованием базы данных Oracle: поддерживаемые продукты и версии</span><span class="sxs-lookup"><span data-stu-id="42034-215">SAP Applications on Microsoft Azure using the Oracle Database: Supported Products and Versions</span></span> |
| <span data-ttu-id="42034-216">[2233094]</span><span class="sxs-lookup"><span data-stu-id="42034-216">[2233094]</span></span> |<span data-ttu-id="42034-217">DB6: приложения SAP в Azure с использованием IBM DB2 для Linux, UNIX и Windows — дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="42034-217">DB6: SAP Applications on Azure Using IBM DB2 for Linux, UNIX, and Windows - Additional Information</span></span> |
| <span data-ttu-id="42034-218">[2243692]</span><span class="sxs-lookup"><span data-stu-id="42034-218">[2243692]</span></span> |<span data-ttu-id="42034-219">Linux на виртуальной машине Microsoft Azure (IaaS): проблемы с лицензированием SAP</span><span class="sxs-lookup"><span data-stu-id="42034-219">Linux on Microsoft Azure (IaaS) VM: SAP license issues</span></span> |
| <span data-ttu-id="42034-220">[1984787]</span><span class="sxs-lookup"><span data-stu-id="42034-220">[1984787]</span></span> |<span data-ttu-id="42034-221">SUSE LINUX Enterprise Server 12: примечания к установке</span><span class="sxs-lookup"><span data-stu-id="42034-221">SUSE LINUX Enterprise Server 12: Installation notes</span></span> |
| <span data-ttu-id="42034-222">[2002167]</span><span class="sxs-lookup"><span data-stu-id="42034-222">[2002167]</span></span> |<span data-ttu-id="42034-223">Red Hat Enterprise Linux 7.x: установка и обновление</span><span class="sxs-lookup"><span data-stu-id="42034-223">Red Hat Enterprise Linux 7.x: Installation and Upgrade</span></span> |
| <span data-ttu-id="42034-224">[2069760]</span><span class="sxs-lookup"><span data-stu-id="42034-224">[2069760]</span></span> |<span data-ttu-id="42034-225">Установка и обновление Oracle Linux 7.x SAP</span><span class="sxs-lookup"><span data-stu-id="42034-225">Oracle Linux 7.x SAP Installation and Upgrade</span></span> |
| <span data-ttu-id="42034-226">[1597355]</span><span class="sxs-lookup"><span data-stu-id="42034-226">[1597355]</span></span> |<span data-ttu-id="42034-227">Рекомендация по области буфера для Linux</span><span class="sxs-lookup"><span data-stu-id="42034-227">Swap-space recommendation for Linux</span></span> |
| <span data-ttu-id="42034-228">[2171857]</span><span class="sxs-lookup"><span data-stu-id="42034-228">[2171857]</span></span> |<span data-ttu-id="42034-229">Oracle Database 12c: поддержка файловой системы в Linux</span><span class="sxs-lookup"><span data-stu-id="42034-229">Oracle Database 12c - file system support on Linux</span></span> |
| <span data-ttu-id="42034-230">[1114181]</span><span class="sxs-lookup"><span data-stu-id="42034-230">[1114181]</span></span> |<span data-ttu-id="42034-231">Oracle Database 11g: поддержка файловой системы в Linux</span><span class="sxs-lookup"><span data-stu-id="42034-231">Oracle Database 11g - file system support on Linux</span></span> |


<span data-ttu-id="42034-232">Ознакомьтесь также с разделом [вики-сайта SCN](https://wiki.scn.sap.com/wiki/display/HOME/SAPonLinuxNotes), где представлены все примечания к SAP для Linux.</span><span class="sxs-lookup"><span data-stu-id="42034-232">Also read the [SCN Wiki](https://wiki.scn.sap.com/wiki/display/HOME/SAPonLinuxNotes) that contains all SAP Notes for Linux.</span></span>

<span data-ttu-id="42034-233">Вы узнаете об архитектуре Microsoft Azure и о том, как развертываются и эксплуатируются виртуальные машины Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-233">You should have a working knowledge about the Microsoft Azure Architecture and how Microsoft Azure Virtual Machines are deployed and operated.</span></span> <span data-ttu-id="42034-234">Дополнительные сведения см. по адресу <https://azure.microsoft.com/documentation/>.</span><span class="sxs-lookup"><span data-stu-id="42034-234">You can find more information at <https://azure.microsoft.com/documentation/></span></span>

> [!NOTE]
> <span data-ttu-id="42034-235">Мы **не** обсуждаем предложения платформы Microsoft Azure как услуги (PaaS) на платформе Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-235">We are **not** discussing Microsoft Azure Platform as a Service (PaaS) offerings of the Microsoft Azure Platform.</span></span> <span data-ttu-id="42034-236">Этот документ посвящен запуску системы управления базами данных (СУБД) на виртуальных машинах Microsoft Azure (IaaS) — так же, как СУБД запускается в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-236">This paper is about running a database management system (DBMS) in Microsoft Azure Virtual Machines (IaaS) just as you would run the DBMS in your on-premises environment.</span></span> <span data-ttu-id="42034-237">Возможности и функции базы данных в этих двух предложениях существенно отличаются, и их не следует путать друг с другом.</span><span class="sxs-lookup"><span data-stu-id="42034-237">Database capabilities and functionalities between these two offers are very different and should not be mixed up with each other.</span></span> <span data-ttu-id="42034-238">См. также: <https://azure.microsoft.com/services/sql-database/>.</span><span class="sxs-lookup"><span data-stu-id="42034-238">See also: <https://azure.microsoft.com/services/sql-database/></span></span>
> 
> 

<span data-ttu-id="42034-239">Для IaaS установка и настройка Windows, Linux и СУБД в целом выполняются так же, как и для любой виртуальной или физической машины, устанавливаемой локально.</span><span class="sxs-lookup"><span data-stu-id="42034-239">Since we are discussing IaaS, in general the Windows, Linux, and DBMS installation and configuration are essentially the same as any virtual machine or bare metal machine you would install on-premises.</span></span> <span data-ttu-id="42034-240">Но некоторые решения в плане архитектуры и реализации управления системой все же отличаются при использовании IaaS.</span><span class="sxs-lookup"><span data-stu-id="42034-240">However, there are some architecture and system management implementation decisions, which are different when utilizing IaaS.</span></span> <span data-ttu-id="42034-241">В этом документе объясняются конкретные различия в архитектуре и управлении системой, которые следует учитывать при использовании IaaS.</span><span class="sxs-lookup"><span data-stu-id="42034-241">The purpose of this document is to explain the specific architectural and system management differences that you must be prepared for when using IaaS.</span></span>

<span data-ttu-id="42034-242">В целом в документе рассматриваются такие области различий:</span><span class="sxs-lookup"><span data-stu-id="42034-242">In general, the overall areas of difference that this paper discusses are:</span></span>

* <span data-ttu-id="42034-243">Планирование надлежащей структуры виртуальных машин и дисков для систем SAP, чтобы обеспечить необходимую структуру файлов данных и достичь достаточного количества операций ввода-вывода для рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="42034-243">Planning the proper VM/disk layout of SAP systems to ensure you have the proper data file layout and can achieve enough IOPS for your workload.</span></span>
* <span data-ttu-id="42034-244">Сетевые аспекты при использовании IaaS.</span><span class="sxs-lookup"><span data-stu-id="42034-244">Networking considerations when using IaaS.</span></span>
* <span data-ttu-id="42034-245">Возможности конкретной базы данных, используемые для оптимизации ее структуры.</span><span class="sxs-lookup"><span data-stu-id="42034-245">Specific database features to use in order to optimize the database layout.</span></span>
* <span data-ttu-id="42034-246">Вопросы резервного копирования и восстановления в IaaS.</span><span class="sxs-lookup"><span data-stu-id="42034-246">Backup and restore considerations in IaaS.</span></span>
* <span data-ttu-id="42034-247">Использование разных типов образов для развертывания.</span><span class="sxs-lookup"><span data-stu-id="42034-247">Utilizing different types of images for deployment.</span></span>
* <span data-ttu-id="42034-248">Высокий уровень доступности в Azure IaaS.</span><span class="sxs-lookup"><span data-stu-id="42034-248">High Availability in Azure IaaS.</span></span>

## <span data-ttu-id="42034-249"><a name="65fa79d6-a85f-47ee-890b-22e794f51a64"></a>Структура развертывания реляционной СУБД</span><span class="sxs-lookup"><span data-stu-id="42034-249"><a name="65fa79d6-a85f-47ee-890b-22e794f51a64"></a>Structure of an RDBMS Deployment</span></span>
<span data-ttu-id="42034-250">Прежде чем вы продолжите чтение, давайте вспомним, о чем шла речь в [этом][deployment-guide-3] разделе [руководства по развертыванию][deployment-guide].</span><span class="sxs-lookup"><span data-stu-id="42034-250">In order to follow this chapter, it is necessary to understand what was presented in [this][deployment-guide-3] chapter of the [Deployment Guide][deployment-guide].</span></span> <span data-ttu-id="42034-251">Вы должны разбираться в сериях виртуальных машин и понимать разницу между ними, а также понимать разницу между службами хранилища Azure классов Standard и Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-251">Knowledge about the different VM-Series and their differences and differences of Azure Standard and Premium Storage should be understood and known before reading this chapter.</span></span>

<span data-ttu-id="42034-252">До марта 2015 г. диски Azure, содержащие операционную систему, были ограничены размером 127 ГБ.</span><span class="sxs-lookup"><span data-stu-id="42034-252">Until March 2015, disks, which contain an operating system were limited to 127 GB in size.</span></span> <span data-ttu-id="42034-253">Это ограничение было снято в марте 2015 года (дополнительные сведения см. по ссылке <https://azure.microsoft.com/blog/2015/03/25/azure-vm-os-drive-limit-octupled/>).</span><span class="sxs-lookup"><span data-stu-id="42034-253">This limitation got lifted in March 2015 (for more information check <https://azure.microsoft.com/blog/2015/03/25/azure-vm-os-drive-limit-octupled/>).</span></span> <span data-ttu-id="42034-254">Теперь диски с операционной системой могут иметь такой же размер, как и любой другой диск.</span><span class="sxs-lookup"><span data-stu-id="42034-254">From there on disks containing the operating system can have the same size as any other disk.</span></span> <span data-ttu-id="42034-255">Но мы все равно предпочитаем структуру развертывания, в которой операционная система, СУБД и конечные двоичные файлы SAP отделены от файлов базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-255">Nevertheless, we still prefer a structure of deployment where the operating system, DBMS, and eventual SAP binaries are separate from the database files.</span></span> <span data-ttu-id="42034-256">Следовательно, мы ожидаем, что в системах SAP, выполняемых на виртуальных машинах Azure, будут установлены операционная система, исполняемые файлы СУБД и исполняемые файлы SAP на базовой виртуальной машине (или диске).</span><span class="sxs-lookup"><span data-stu-id="42034-256">Therefore, we expect SAP systems running in Azure Virtual Machines have the base VM (or disk) installed with the operating system, database management system executables, and SAP executables.</span></span> <span data-ttu-id="42034-257">Файлы данных СУБД и журналов будут храниться в службе хранилища Azure (класса Standard или Premium) в отдельных файлах дисков и присоединяться в качестве логических дисков к исходной виртуальной машине с образом операционной системы Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-257">The DBMS data and log files are stored in Azure Storage (Standard or Premium Storage) in separate disks and attached as logical disks to the original Azure operating system image VM.</span></span> 

<span data-ttu-id="42034-258">В зависимости от того, какой класс хранилища Azure используется — Standard или Premium (например, при использовании виртуальных машин серии DS или серии GS), в Azure предусмотрены другие квоты, описанные [здесь (Linux)][virtual-machines-sizes-linux] и [здесь (Windows)][virtual-machines-sizes-windows].</span><span class="sxs-lookup"><span data-stu-id="42034-258">Dependent on leveraging Azure Standard or Premium Storage (for example by using the DS-series or GS-series VMs) there are other quotas in Azure, which are documented [here (Linux)][virtual-machines-sizes-linux] and [here (Windows)][virtual-machines-sizes-windows].</span></span> <span data-ttu-id="42034-259">При планировании структуры дисков вам нужно найти оптимальный баланс квоты для следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="42034-259">When planning your disk layout, you need to find the best balance of the quotas for the following items:</span></span>

* <span data-ttu-id="42034-260">Количество файлов данных.</span><span class="sxs-lookup"><span data-stu-id="42034-260">The number of data files.</span></span>
* <span data-ttu-id="42034-261">Число дисков, содержащих файлы.</span><span class="sxs-lookup"><span data-stu-id="42034-261">The number of disks that contain the files.</span></span>
* <span data-ttu-id="42034-262">Количество операций ввода-вывода для одного диска.</span><span class="sxs-lookup"><span data-stu-id="42034-262">The IOPS quotas of a single disk.</span></span>
* <span data-ttu-id="42034-263">Пропускная способность каждого диска.</span><span class="sxs-lookup"><span data-stu-id="42034-263">The data throughput per disk.</span></span>
* <span data-ttu-id="42034-264">Количество дополнительных доступных дисков в зависимости от размера виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-264">The number of additional data disks possible per VM size.</span></span>
* <span data-ttu-id="42034-265">Общая пропускная способность хранилища, которую может предоставить виртуальная машина.</span><span class="sxs-lookup"><span data-stu-id="42034-265">The overall storage throughput a VM can provide.</span></span>

<span data-ttu-id="42034-266">Azure обеспечивает квоту на количество операций ввода-вывода для каждого диска данных.</span><span class="sxs-lookup"><span data-stu-id="42034-266">Azure enforces an IOPS quota per data disk.</span></span> <span data-ttu-id="42034-267">Эти квоты различаются для дисков, размещенных в службе хранилища Azure классов Standard и Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-267">These quotas are different for disks hosted on Azure Standard Storage and Premium Storage.</span></span> <span data-ttu-id="42034-268">Кроме того, между двумя типами хранилищ существенно различаются задержки при операциях ввода-вывода (например, хранилище класса Premium обеспечивает улучшенные показатели).</span><span class="sxs-lookup"><span data-stu-id="42034-268">I/O latencies are also very different between the two storage types with Premium Storage delivering factors better I/O latencies.</span></span> <span data-ttu-id="42034-269">Каждый из типов виртуальных машин поддерживает присоединение ограниченного количества дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-269">Each of the different VM types has a limited number of data disks that you are able to attach.</span></span> <span data-ttu-id="42034-270">Другое ограничение состоит в том, что только некоторые типы виртуальных машин могут использовать службу хранилища Azure класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-270">Another restriction is that only certain VM types can leverage Azure Premium Storage.</span></span> <span data-ttu-id="42034-271">Это означает, что решение для определенного типа виртуальной машины может приниматься не только на основе требований к ЦП и памяти, но и требований к операциям ввода-вывода, задержке и пропускной способности диска, которые обычно масштабируются в зависимости от количества дисков или типа дисков хранилища класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-271">This means the decision for a certain VM type might not only be driven by the CPU and memory requirements, but also by the IOPS, latency and disk throughput requirements that usually are scaled with the number of disks or the type of Premium Storage disks.</span></span> <span data-ttu-id="42034-272">В частности, для хранилища класса Premium размер диска также может зависеть от количества операций ввода-вывода и пропускной способности, которая должна достигаться каждым диском.</span><span class="sxs-lookup"><span data-stu-id="42034-272">Especially with Premium Storage the size of a disk also might be dictated by the number of IOPS and throughput that needs to be achieved by each disk.</span></span>

<span data-ttu-id="42034-273">Так как общая частота операций ввода-вывода, количество подключенных дисков и размер виртуальной машины взаимосвязаны, конфигурация Azure для системы SAP будет отличаться от конфигурации при развертывании в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-273">The fact that the overall IOPS rate, the number of disks mounted, and the size of the VM are all tied together, might cause an Azure configuration of an SAP system to be different than its on-premises deployment.</span></span> <span data-ttu-id="42034-274">Ограничения для операций ввода-вывода на каждый номер логического устройства (LUN) обычно настраиваются в локальных развертываниях.</span><span class="sxs-lookup"><span data-stu-id="42034-274">The IOPS limits per LUN are usually configurable in on-premises deployments.</span></span> <span data-ttu-id="42034-275">Для службы хранилища Azure эти ограничения фиксированы, а для хранилища класса Premium они зависят от типа диска.</span><span class="sxs-lookup"><span data-stu-id="42034-275">Whereas with Azure Storage those limits are fixed or as in Premium Storage dependent on the disk type.</span></span> <span data-ttu-id="42034-276">Поэтому при локальных развертываниях мы наблюдаем пользовательские конфигурации серверов баз данных, в которых используется много разных томов для специальных исполняемых файлов, включая SAP и СУБД, или специальных томов для временных баз данных или табличных пространств.</span><span class="sxs-lookup"><span data-stu-id="42034-276">So with on-premises deployments we see customer configurations of database servers that are using many different volumes for special executables like SAP and the DBMS or special volumes for temporary databases or table spaces.</span></span> <span data-ttu-id="42034-277">Перемещение такой локальной системы в Azure может привести к потере потенциальной пропускной способности для операций ввода-вывода, так как ресурсы диска будет расходоваться на исполняемые файлы или базы данных, которые не выполняют операции ввода-вывода вообще или выполняют незначительное их количество.</span><span class="sxs-lookup"><span data-stu-id="42034-277">When such an on-premises system is moved to Azure, it might lead to a waste of potential IOPS bandwidth by wasting a disk for executables or databases, which do not perform any or not a lot of IOPS.</span></span> <span data-ttu-id="42034-278">Таким образом, по возможности исполняемые файлы СУБД и SAP на виртуальных машинах Azure рекомендуется устанавливать на диск с ОС.</span><span class="sxs-lookup"><span data-stu-id="42034-278">Therefore, in Azure VMs we recommend that the DBMS and SAP executables be installed on the OS disk if possible.</span></span>

<span data-ttu-id="42034-279">Расположение файлов баз данных и файлов журналов, а также тип используемой службы хранилища Azure должны определяться требованиями к операциям ввода-вывода, задержкам и пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="42034-279">The placement of the database files and log files and the type of Azure Storage used, should be defined by IOPS, latency, and throughput requirements.</span></span> <span data-ttu-id="42034-280">Чтобы получить достаточное количество операций ввода-вывода для журнала транзакций, иногда необходимо использовать несколько дисков для файла журнала транзакций или более крупный диск хранилища класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-280">In order to have enough IOPS for the transaction log, you might be forced to leverage multiple disks for the transaction log file or use a larger Premium Storage disk.</span></span> <span data-ttu-id="42034-281">В этом случае можно создать программный RAID-массив (например, пул хранения Windows для Windows или MDADM и LVM (диспетчер логических томов) для Linux) с дисками, содержащими журнал транзакций.</span><span class="sxs-lookup"><span data-stu-id="42034-281">In such a case one would build a software RAID (for example Windows Storage Pool for Windows or MDADM and LVM (Logical Volume Manager) for Linux) with the disks, which contain the transaction log.</span></span>

- - -
> ![Windows][Logo_Windows] <span data-ttu-id="42034-283">Windows</span><span class="sxs-lookup"><span data-stu-id="42034-283">Windows</span></span>
> 
> <span data-ttu-id="42034-284">D:\ на виртуальной машине Azure — это несохраняемый диск, поддерживаемый некоторыми локальными дисками на вычислительном узле Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-284">Drive D:\ in an Azure VM is a non-persisted drive, which is backed by some local disks on the Azure compute node.</span></span> <span data-ttu-id="42034-285">Несохраняемый означает, что любые изменения содержимого диска D:\ теряются при перезагрузке виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-285">Because it is non-persisted, this means that any changes made to the content on the D:\ drive is lost when the VM is rebooted.</span></span> <span data-ttu-id="42034-286">Под любыми изменениями подразумевается сохранение файлов, создание каталогов, установка приложений и т. д.</span><span class="sxs-lookup"><span data-stu-id="42034-286">By "any changes", we mean saved files, directories created, applications installed, etc.</span></span>
> 
> ![Linux][Logo_Linux] <span data-ttu-id="42034-288">Linux</span><span class="sxs-lookup"><span data-stu-id="42034-288">Linux</span></span>
> 
> <span data-ttu-id="42034-289">Виртуальные машины Azure под управлением Linux автоматически подключают диск к каталогу /mnt/resource — несохраняемому диску, который поддерживается локальными дисками на вычислительном узле Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-289">Linux Azure VMs automatically mount a drive at /mnt/resource that is a non-persisted drive backed by local disks on the Azure compute node.</span></span> <span data-ttu-id="42034-290">Несохраняемый обозначает, что любые изменения содержимого каталога /mnt/resource теряются при перезагрузке виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-290">Because it is non-persisted, this means that any changes made to content in /mnt/resource are lost when the VM is rebooted.</span></span> <span data-ttu-id="42034-291">Под любыми изменениями подразумевается сохранение файлов, создание каталогов, установка приложений и т. д.</span><span class="sxs-lookup"><span data-stu-id="42034-291">By any changes, we mean files saved, directories created, applications installed, etc.</span></span>
> 
> 

- - -
<span data-ttu-id="42034-292">В зависимости от серии виртуальной машины Azure локальные диски на вычислительном узле имеют разные показатели производительности; категории приведены ниже.</span><span class="sxs-lookup"><span data-stu-id="42034-292">Dependent on the Azure VM-series, the local disks on the compute node show different performance, which can be categorized like:</span></span>

* <span data-ttu-id="42034-293">A0–A7: крайне ограниченная производительность.</span><span class="sxs-lookup"><span data-stu-id="42034-293">A0-A7: Very limited performance.</span></span> <span data-ttu-id="42034-294">Используется только для файла подкачки Windows.</span><span class="sxs-lookup"><span data-stu-id="42034-294">Not usable for anything beyond windows page file</span></span>
* <span data-ttu-id="42034-295">A8–A11: очень хорошая производительность на уровне 10 тыс. операций ввода-вывода в секунду и более 1 ГБ/с пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="42034-295">A8-A11: Very good performance characteristics with some ten thousand IOPS and >1GB/sec throughput</span></span>
* <span data-ttu-id="42034-296">Серия D: очень хорошая производительность на уровне 10 тыс. операций ввода-вывода в секунду и более 1 ГБ/с пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="42034-296">D-Series: Very good performance characteristics with some ten thousand IOPS and >1GB/sec throughput</span></span>
* <span data-ttu-id="42034-297">Серия DS: очень хорошая производительность на уровне 10 тыс. операций ввода-вывода в секунду и более 1 ГБ/с пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="42034-297">DS-Series: Very good performance characteristics with some ten thousand IOPS and >1GB/sec throughput</span></span>
* <span data-ttu-id="42034-298">Серия G: очень хорошая производительность на уровне 10 тыс. операций ввода-вывода в секунду и более 1 ГБ/с пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="42034-298">G-Series: Very good performance characteristics with some ten thousand IOPS and >1GB/sec throughput</span></span>
* <span data-ttu-id="42034-299">Серия GS: очень хорошая производительность на уровне 10 тыс. операций ввода-вывода в секунду и более 1 ГБ/с пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="42034-299">GS-Series: Very good performance characteristics with some ten thousand IOPS and >1GB/sec throughput</span></span>

<span data-ttu-id="42034-300">Эти сведения относятся к типам виртуальных машин, которые сертифицированы для использования с SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-300">Statements above are applying to the VM types that are certified with SAP.</span></span> <span data-ttu-id="42034-301">Серии виртуальных машин с высокими показателями операций ввода-вывода и пропускной способности позволяют использовать некоторые возможности СУБД, включая tempdb и временное табличное пространство.</span><span class="sxs-lookup"><span data-stu-id="42034-301">The VM-series with excellent IOPS and throughput qualify for leverage by some DBMS features, like tempdb or temporary table space.</span></span>

### <span data-ttu-id="42034-302"><a name="c7abf1f0-c927-4a7c-9c1d-c7b5b3b7212f"></a>Кэширование для виртуальных машин и дисков данных</span><span class="sxs-lookup"><span data-stu-id="42034-302"><a name="c7abf1f0-c927-4a7c-9c1d-c7b5b3b7212f"></a>Caching for VMs and data disks</span></span>
<span data-ttu-id="42034-303">При создании дисков данных через портал, а также при подключении отправленных дисков к виртуальным машинам мы можем выбрать, будет ли кэшироваться трафик ввода-вывода между виртуальной машиной и этими дисками, размещенными в хранилище Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-303">When we create data disks through the portal or when we mount uploaded disks to VMs, we can choose whether the I/O traffic between the VM and those disks located in Azure storage are cached.</span></span> <span data-ttu-id="42034-304">В службе хранилища Azure классов Standard и Premium для этого типа кэша используются две разные технологии.</span><span class="sxs-lookup"><span data-stu-id="42034-304">Azure Standard and Premium Storage use two different technologies for this type of cache.</span></span> <span data-ttu-id="42034-305">В обоих случаях сам кэш поддерживается теми же дисками, которые используются для временного диска виртуальной машины (D:\ в Windows или /mnt/resource в Linux).</span><span class="sxs-lookup"><span data-stu-id="42034-305">In both cases, the cache itself would be disk backed on the same drives used by the temporary disk (D:\ on Windows or /mnt/resource on Linux) of the VM.</span></span>

<span data-ttu-id="42034-306">Для службы хранилища Azure класса Standard возможны следующие типы кэша:</span><span class="sxs-lookup"><span data-stu-id="42034-306">For Azure Standard Storage the possible cache types are:</span></span>

* <span data-ttu-id="42034-307">Без кэширования</span><span class="sxs-lookup"><span data-stu-id="42034-307">No caching</span></span>
* <span data-ttu-id="42034-308">Кэширование чтения</span><span class="sxs-lookup"><span data-stu-id="42034-308">Read caching</span></span>
* <span data-ttu-id="42034-309">Кэширование чтения и записи</span><span class="sxs-lookup"><span data-stu-id="42034-309">Read and Write caching</span></span>

<span data-ttu-id="42034-310">Согласованную и предсказуемую производительность можно получить, задав значение "Нет" для параметра кэширования в службе хранилища Azure уровня "Стандартный" для всех дисков, содержащих **файлы данных, связанные с СУБД, файлы журналов и табличное пространство**.</span><span class="sxs-lookup"><span data-stu-id="42034-310">In order to get consistent and deterministic performance, you should set the caching on Azure Standard Storage for all disks containing **DBMS-related data files, log files, and table space to 'NONE'**.</span></span> <span data-ttu-id="42034-311">Кэширование виртуальной машины можно оставить по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="42034-311">The caching of the VM can remain with the default.</span></span>

<span data-ttu-id="42034-312">Для службы хранилища Azure класса Premium существуют следующие режимы кэширования:</span><span class="sxs-lookup"><span data-stu-id="42034-312">For Azure Premium Storage the following caching options exist:</span></span>

* <span data-ttu-id="42034-313">Без кэширования</span><span class="sxs-lookup"><span data-stu-id="42034-313">No caching</span></span>
* <span data-ttu-id="42034-314">Кэширование чтения</span><span class="sxs-lookup"><span data-stu-id="42034-314">Read caching</span></span>

<span data-ttu-id="42034-315">Для хранилища Azure класса Premium рекомендуется использовать параметр **Read caching for data files** (Кэширование чтения файлов данных) базы данных SAP и выбрать **No caching for the disks of log file(s)** (Без кэширования дисков файлов журнала).</span><span class="sxs-lookup"><span data-stu-id="42034-315">Recommendation for Azure Premium Storage is to leverage **Read caching for data files** of the SAP database and chose **No caching for the disks of log file(s)**.</span></span>

### <span data-ttu-id="42034-316"><a name="c8e566f9-21b7-4457-9f7f-126036971a91"></a>Программный RAID-массив</span><span class="sxs-lookup"><span data-stu-id="42034-316"><a name="c8e566f9-21b7-4457-9f7f-126036971a91"></a>Software RAID</span></span>
<span data-ttu-id="42034-317">Как уже говорилось выше, вам потребуется сбалансировать настраиваемое количество операций ввода-вывода, необходимых для файлов базы данных, между дисками. Кроме того, это нужно сделать в отношении максимального количества операций ввода-вывода, которое виртуальная машина Azure обеспечивает для каждого диска или типа диска в хранилище класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-317">As already stated above, you need to balance the number of IOPS needed for the database files across the number of disks you can configure and the maximum IOPS an Azure VM provides per disk or Premium Storage disk type.</span></span> <span data-ttu-id="42034-318">Самый простой способ справиться с нагрузкой операций ввода-вывода — создать программный RAID-массив для разных дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-318">Easiest way to deal with the IOPS load over disks is to build a software RAID over the different disks.</span></span> <span data-ttu-id="42034-319">Затем следует поместить ряд файлов данных СУБД SAP в LUN, полученные из программного RAID-массива.</span><span class="sxs-lookup"><span data-stu-id="42034-319">Then place a number of data files of the SAP DBMS on the LUNS carved out of the software RAID.</span></span> <span data-ttu-id="42034-320">В зависимости от требований иногда рекомендуется использовать хранилище класса Premium, так как два из трех разных дисков хранилища этого класса предоставляют более высокую квоту операций ввода-вывода, чем диски в хранилище класса Standard.</span><span class="sxs-lookup"><span data-stu-id="42034-320">Dependent on the requirements you might want to consider the usage of Premium Storage as well since two of the three different Premium Storage disks provide higher IOPS quota than disks based on Standard Storage.</span></span> <span data-ttu-id="42034-321">Кроме того, служба хранилища Azure класса Premium характеризуется улучшенной задержкой при операциях ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-321">Besides the significant better I/O latency provided by Azure Premium Storage.</span></span> 

<span data-ttu-id="42034-322">То же применяется и к журналу транзакций разных систем СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-322">Same applies to the transaction log of the different DBMS systems.</span></span> <span data-ttu-id="42034-323">При большом их количестве простое добавление дополнительных файлов Tlog не помогает, так как системы СУБД одновременно записывают данные только в один файл.</span><span class="sxs-lookup"><span data-stu-id="42034-323">With many of them just adding more Tlog files does not help since the DBMS systems write into one of the files at a time only.</span></span> <span data-ttu-id="42034-324">Если требуются более высокие скорости операций ввода-вывода, чем может обеспечить отдельный диск в хранилище класса Standard, можно создать чередующийся массив из нескольких таких дисков или использовать более крупный тип диска хранилища класса Premium (этот тип помимо высокоскоростных операций ввода-вывода также обеспечивает намного меньшую задержку при операциях записи в журнал транзакций).</span><span class="sxs-lookup"><span data-stu-id="42034-324">If higher IOPS rates are needed than a single Standard Storage based disk can deliver, you can stripe over multiple Standard Storage disks or you can use a larger Premium Storage disk type that beyond higher IOPS rates also delivers factors lower latency for the write I/Os into the transaction log.</span></span>

<span data-ttu-id="42034-325">При развертывании Azure программный RAID-массив предпочтительно использовать в следующих ситуациях:</span><span class="sxs-lookup"><span data-stu-id="42034-325">Situations experienced in Azure deployments, which would favor using a software RAID are:</span></span>

* <span data-ttu-id="42034-326">Журнал транзакций или журнал повтора операций требует больше операций ввода-вывода, чем обеспечивает Azure для одного диска.</span><span class="sxs-lookup"><span data-stu-id="42034-326">Transaction Log/Redo Log require more IOPS than Azure provides for a single disk.</span></span> <span data-ttu-id="42034-327">Как упоминалось выше, это можно решить, создав LUN для нескольких дисков с помощью программного RAID-массива.</span><span class="sxs-lookup"><span data-stu-id="42034-327">As mentioned above this can be solved by building a LUN over multiple disks using a software RAID.</span></span>
* <span data-ttu-id="42034-328">Неравномерное распределение рабочей нагрузки ввода-вывода между разными файлами данных в базе данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-328">Uneven I/O workload distribution over the different data files of the SAP database.</span></span> <span data-ttu-id="42034-329">В таких случаях может возникнуть ситуация, когда один файл данных будет часто превышать квоту.</span><span class="sxs-lookup"><span data-stu-id="42034-329">In such cases one can experience one data file hitting the quota rather often.</span></span> <span data-ttu-id="42034-330">При этом другие файлы данных даже не приблизятся к квоте на количество операций ввода-вывода для одного диска.</span><span class="sxs-lookup"><span data-stu-id="42034-330">Whereas other data files are not even getting close to the IOPS quota of a single disk.</span></span> <span data-ttu-id="42034-331">В этом случае самым простым решением будет создать один LUN для нескольких дисков с помощью программного RAID-массива.</span><span class="sxs-lookup"><span data-stu-id="42034-331">In such cases the easiest solution is to build one LUN over multiple disks using a software RAID.</span></span> 
* <span data-ttu-id="42034-332">Вы не знаете точную рабочую нагрузку ввода-вывода на каждый файл данных, и вы только примерно знаете общую рабочую нагрузку операций ввода-вывода для СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-332">You don’t know what the exact I/O workload per data file is and only roughly know what the overall IOPS workload against the DBMS is.</span></span> <span data-ttu-id="42034-333">Проще всего будет создать один LUN с помощью программного RAID-массива.</span><span class="sxs-lookup"><span data-stu-id="42034-333">Easiest to do is to build one LUN with the help of a software RAID.</span></span> <span data-ttu-id="42034-334">После этого сумма квот для нескольких дисков, входящих в этот LUN, будет соответствовать известной скорости операций ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-334">The sum of quotas of multiple disks behind this LUN should then fulfill the known IOPS rate.</span></span>

- - -
> ![Windows][Logo_Windows] <span data-ttu-id="42034-336">Windows</span><span class="sxs-lookup"><span data-stu-id="42034-336">Windows</span></span>
> 
> <span data-ttu-id="42034-337">Мы рекомендуем использовать дисковые пространства Windows при работе с Windows Server 2012 или более поздней версии,</span><span class="sxs-lookup"><span data-stu-id="42034-337">We recommend using Windows Storage Spaces if you run on Windows Server 2012 or higher.</span></span> <span data-ttu-id="42034-338">так как это более эффективно, чем функция Windows Striping из более ранних версий Windows.</span><span class="sxs-lookup"><span data-stu-id="42034-338">It is more efficient than Windows Striping of earlier Windows versions.</span></span> <span data-ttu-id="42034-339">При использовании операционной системы Windows Server 2012 иногда необходимо создавать пулы хранения и дисковые пространства Windows с помощью команд PowerShell.</span><span class="sxs-lookup"><span data-stu-id="42034-339">You might need to create the Windows Storage Pools and Storage Spaces by PowerShell commands when using Windows Server 2012 as Operating System.</span></span> <span data-ttu-id="42034-340">Команды PowerShell описаны здесь: <https://technet.microsoft.com/library/jj851254.aspx>.</span><span class="sxs-lookup"><span data-stu-id="42034-340">The PowerShell commands can be found here <https://technet.microsoft.com/library/jj851254.aspx></span></span>
> 
> ![Linux][Logo_Linux] <span data-ttu-id="42034-342">Linux</span><span class="sxs-lookup"><span data-stu-id="42034-342">Linux</span></span>
> 
> <span data-ttu-id="42034-343">Для создания программного RAID-массива в Linux поддерживаются только MDADM и LVM (диспетчер логических томов).</span><span class="sxs-lookup"><span data-stu-id="42034-343">Only MDADM and LVM (Logical Volume Manager) are supported to build a software RAID on Linux.</span></span> <span data-ttu-id="42034-344">Дополнительные сведения см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="42034-344">For more information, read the following articles:</span></span>
> 
> * <span data-ttu-id="42034-345">[Настройка программного RAID-массива в Linux][virtual-machines-linux-configure-raid] (для MDADM)</span><span class="sxs-lookup"><span data-stu-id="42034-345">[Configure Software RAID on Linux][virtual-machines-linux-configure-raid] (for MDADM)</span></span>
> * <span data-ttu-id="42034-346">[Настройка диспетчера логических томов на виртуальной машине Linux в Azure][virtual-machines-linux-configure-lvm]</span><span class="sxs-lookup"><span data-stu-id="42034-346">[Configure LVM on a Linux VM in Azure][virtual-machines-linux-configure-lvm]</span></span>
> 
> 

- - -
<span data-ttu-id="42034-347">Рекомендации по использованию серий виртуальных машин, которые поддерживают службу хранилища Azure класса Premium:</span><span class="sxs-lookup"><span data-stu-id="42034-347">Considerations for leveraging VM-series, which are able to work with Azure Premium Storage usually are:</span></span>

* <span data-ttu-id="42034-348">Требования к задержкам при операциях ввода-вывода, близкие к обеспечиваемым сетями SAN и устройствами NAS.</span><span class="sxs-lookup"><span data-stu-id="42034-348">Demands for I/O latencies that are close to what SAN/NAS devices deliver.</span></span>
* <span data-ttu-id="42034-349">Потребность в улучшенной задержке при операциях ввода-вывода, чем обеспечивает служба хранилища Azure класса Standard.</span><span class="sxs-lookup"><span data-stu-id="42034-349">Demand for factors better I/O latency than Azure Standard Storage can deliver.</span></span>
* <span data-ttu-id="42034-350">Больше операций ввода-вывода на виртуальную машину, чем можно достичь с помощью нескольких дисков хранилища класса Standard в отношении определенного типа виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-350">Higher IOPS per VM than what could be achieved with multiple Standard Storage disks against a certain VM type.</span></span>

<span data-ttu-id="42034-351">Так как базовая служба хранилища Azure реплицирует каждый диск минимум на три узла хранилища, можно просто использовать технологию чередующегося массива (RAID 0).</span><span class="sxs-lookup"><span data-stu-id="42034-351">Since the underlying Azure Storage replicates each disk to at least three storage nodes, simple RAID 0 striping can be used.</span></span> <span data-ttu-id="42034-352">В реализации RAID5 или RAID1 нет необходимости.</span><span class="sxs-lookup"><span data-stu-id="42034-352">There is no need to implement RAID5 or RAID1.</span></span>

### <span data-ttu-id="42034-353"><a name="10b041ef-c177-498a-93ed-44b3441ab152"></a>Служба хранилища Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="42034-353"><a name="10b041ef-c177-498a-93ed-44b3441ab152"></a>Microsoft Azure Storage</span></span>
<span data-ttu-id="42034-354">В службе хранилища Microsoft Azure храниться базовая виртуальная машина (с ОС) и диски или большие двоичные объекты минимум для трех отдельных узлов хранилища.</span><span class="sxs-lookup"><span data-stu-id="42034-354">Microsoft Azure Storage stores the base VM (with OS) and disks or BLOBs to at least three separate storage nodes.</span></span> <span data-ttu-id="42034-355">При создании учетной записи хранения или управляемого диска можно выбрать уровень защиты, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="42034-355">When creating a storage account or managed disk, there is a choice of protection as shown here:</span></span>

![Георепликация включена для учетной записи хранения Azure][dbms-guide-figure-100]

<span data-ttu-id="42034-357">Локальная репликация службы хранилища Azure (локально избыточная) обеспечивает такие уровни защиты от потери данных вследствие сбоя инфраструктуры, которые мало кто из клиентов может себе позволить развернуть.</span><span class="sxs-lookup"><span data-stu-id="42034-357">Azure Storage Local Replication (Locally Redundant) provides levels of protection against data loss due to infrastructure failure that few customers could afford to deploy.</span></span> <span data-ttu-id="42034-358">Как показано выше, существуют четыре варианта; также доступен пятый — как разновидность одного из первых трех.</span><span class="sxs-lookup"><span data-stu-id="42034-358">As shown above there are four different options with a fifth being a variation of one of the first three.</span></span> <span data-ttu-id="42034-359">Различия состоят в следующем:</span><span class="sxs-lookup"><span data-stu-id="42034-359">Looking closer at them we can distinguish:</span></span>

* <span data-ttu-id="42034-360">**Локально избыточное хранилище (LRS) класса Premium.** Хранилище Azure класса Premium обеспечивает поддержку высокопроизводительных дисков с низкой задержкой для виртуальных машин с интенсивной рабочей нагрузкой ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-360">**Premium Locally Redundant Storage (LRS)**: Azure Premium Storage delivers high-performance, low-latency disk support for virtual machines running I/O-intensive workloads.</span></span> <span data-ttu-id="42034-361">Предусматриваются три реплики данных в пределах одного и того же центра обработки данных Azure в том или ином регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-361">There are three replicas of the data within the same Azure datacenter of an Azure region.</span></span> <span data-ttu-id="42034-362">Копии располагаются в разных доменах сбоя и обновления (основные понятия описываются в [этом][planning-guide-3.2] разделе [руководства по планированию][planning-guide]).</span><span class="sxs-lookup"><span data-stu-id="42034-362">The copies are in different Fault and Upgrade Domains (for concepts see [this][planning-guide-3.2] chapter in the [Planning Guide][planning-guide]).</span></span> <span data-ttu-id="42034-363">В случае выхода из строя реплики данных из-за сбоя узла хранилища или диска автоматически создается новая реплика.</span><span class="sxs-lookup"><span data-stu-id="42034-363">In case of a replica of the data going out of service due to a storage node failure or disk failure, a new replica is generated automatically.</span></span>
* <span data-ttu-id="42034-364">**Локально избыточное хранилище (LRS).** В этом случае предусматриваются 3 реплики данных в одном и том же центре обработки данных Azure в регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-364">**Locally Redundant Storage (LRS)**: In this case, there are three replicas of the data within the same Azure datacenter of an Azure region.</span></span> <span data-ttu-id="42034-365">Копии располагаются в разных доменах сбоя и обновления (основные понятия описываются в [этом][planning-guide-3.2] разделе [руководства по планированию][planning-guide]).</span><span class="sxs-lookup"><span data-stu-id="42034-365">The copies are in different Fault and Upgrade Domains (for concepts see [this][planning-guide-3.2] chapter in the [Planning Guide][planning-guide]).</span></span> <span data-ttu-id="42034-366">В случае выхода из строя реплики данных из-за сбоя узла хранилища или диска автоматически создается новая реплика.</span><span class="sxs-lookup"><span data-stu-id="42034-366">In case of a replica of the data going out of service due to a storage node failure or disk failure, a new replica is generated automatically.</span></span> 
* <span data-ttu-id="42034-367">**Геоизбыточное хранилище (GRS).** В этом случае реализуется асинхронная репликация, которая обслуживает 3 дополнительные реплики данных в другом регионе Azure, который в большинстве случаев находится в том же географическом регионе (например, Северная Европа и Западная Европа).</span><span class="sxs-lookup"><span data-stu-id="42034-367">**Geo Redundant Storage (GRS)**: In this case, there is an asynchronous replication that feeds an additional three replicas of the data in another Azure Region, which is in most of the cases in the same geographical region (like North Europe and West Europe).</span></span> <span data-ttu-id="42034-368">В результате получатся три дополнительные реплики, так что всего суммарно реплик будет шесть.</span><span class="sxs-lookup"><span data-stu-id="42034-368">This results in three additional replicas, so that there are six replicas in sum.</span></span> <span data-ttu-id="42034-369">Может быть вариант, когда данные в геореплицированном регионе Azure используются для чтения (геоизбыточность с доступом на чтение).</span><span class="sxs-lookup"><span data-stu-id="42034-369">A variation of this is an addition where the data in the geo replicated Azure region can be used for read purposes (Read-Access Geo-Redundant).</span></span>
* <span data-ttu-id="42034-370">**Хранилище, избыточное в пределах зоны (ZRS).** В этом случае 3 реплики данных хранятся в одном и том же регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-370">**Zone Redundant Storage (ZRS)**: In this case, the three replicas of the data remain in the same Azure Region.</span></span> <span data-ttu-id="42034-371">Как описано в [этом][planning-guide-3.1] разделе [руководства по планированию][planning-guide], в одном регионе Azure может быть несколько центров обработки данных, расположенных в непосредственной близости.</span><span class="sxs-lookup"><span data-stu-id="42034-371">As explained in [this][planning-guide-3.1] chapter of the [Planning Guide][planning-guide] an Azure region can be a number of datacenters in close proximity.</span></span> <span data-ttu-id="42034-372">В случае LRS реплики будут распределяться между разными центрами обработки данных, которые входят в один регион Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-372">In the case of LRS the replicas would be distributed over the different datacenters that make one Azure region.</span></span>

<span data-ttu-id="42034-373">Дополнительные сведения см. [здесь][storage-redundancy].</span><span class="sxs-lookup"><span data-stu-id="42034-373">More information can be found [here][storage-redundancy].</span></span>

> [!NOTE]
> <span data-ttu-id="42034-374">Для развертываний СУБД не рекомендуется использовать географически избыточное хранилище.</span><span class="sxs-lookup"><span data-stu-id="42034-374">For DBMS deployments, the usage of Geo Redundant Storage is not recommended</span></span>
> 
> <span data-ttu-id="42034-375">Георепликация хранилища Azure является асинхронной.</span><span class="sxs-lookup"><span data-stu-id="42034-375">Azure Storage Geo-Replication is asynchronous.</span></span> <span data-ttu-id="42034-376">Репликация отдельных дисков, подключенных к одной виртуальной машине, не синхронизируется в связке.</span><span class="sxs-lookup"><span data-stu-id="42034-376">Replication of individual disks mounted to a single VM are not synchronized in lock step.</span></span> <span data-ttu-id="42034-377">Таким образом, это не подходит для репликации файлов СУБД, которые распределены между разными дисками или развернуты в программном RAID-массиве из нескольких дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-377">Therefore, it is not suitable to replicate DBMS files that are distributed over different disks or deployed against a software RAID based on multiple disks.</span></span> <span data-ttu-id="42034-378">Для программного обеспечения СУБД требуется, чтобы постоянное дисковое хранилище в точности синхронизировалось между разными LUN, базовыми дисками и шпинделями.</span><span class="sxs-lookup"><span data-stu-id="42034-378">DBMS software requires that the persistent disk storage is precisely synchronized across different LUNs and underlying disks/spindles.</span></span> <span data-ttu-id="42034-379">Программное обеспечение СУБД использует различные механизмы для последовательной организации операций записи ввода-вывода. СУБД сообщает о повреждении целевого дискового хранилища репликации, даже если эти показатели будут различаться всего на несколько миллисекунд.</span><span class="sxs-lookup"><span data-stu-id="42034-379">DBMS software uses various mechanisms to sequence IO write activities and a DBMS reports that the disk storage targeted by the replication is corrupted if these vary even by a few milliseconds.</span></span> <span data-ttu-id="42034-380">Следовательно, если действительно требуется конфигурация базы данных, распределенной между несколькими дисками с георепликацией, такую репликацию следует выполнять с использованием средств и функций базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-380">Hence if one really wants a database configuration with a database stretched across multiple disks geo-replicated, such a replication needs to be performed with database means and functionality.</span></span> <span data-ttu-id="42034-381">При выполнении этого задания не следует полагаться на георепликацию хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-381">One should not rely on Azure Storage Geo-Replication to perform this job.</span></span> 
> 
> <span data-ttu-id="42034-382">Проблему проще всего объяснить на примере системы.</span><span class="sxs-lookup"><span data-stu-id="42034-382">The problem is simplest to explain with an example system.</span></span> <span data-ttu-id="42034-383">Предположим, что имеется система SAP, переданная в Azure, в которой имеется восемь дисков, содержащих файлы данных СУБД, а также один диск, содержащий файл журнала транзакций.</span><span class="sxs-lookup"><span data-stu-id="42034-383">Let’s assume you have an SAP system uploaded into Azure, which has eight disks containing data files of the DBMS plus one disk containing the transaction log file.</span></span> <span data-ttu-id="42034-384">Каждый из этих девяти дисков будет содержать данные, записанные на него согласованным методом в соответствии с СУБД, будь то в файлы данных или файлы журнала транзакций.</span><span class="sxs-lookup"><span data-stu-id="42034-384">Each one of these nine disks have data written to them in a consistent method according to the DBMS, whether the data is being written to the data or transaction log files.</span></span>
> 
> <span data-ttu-id="42034-385">Для правильной георепликации данных и поддержания целостного образа базы данных необходимо геореплицировать содержимое всех девяти дисков в том порядке, в котором выполнялись операции ввода-вывода для девяти разных дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-385">In order to properly geo-replicate the data and maintain a consistent database image, the content of all nine disks would have to be geo-replicated in the exact order the I/O operations were executed against the nine different disks.</span></span> <span data-ttu-id="42034-386">Однако георепликация хранилища Azure не позволяет объявлять зависимости между дисками.</span><span class="sxs-lookup"><span data-stu-id="42034-386">However, Azure Storage geo-replication does not allow to declare dependencies between disks.</span></span> <span data-ttu-id="42034-387">Это означает, что функция георепликации хранилища Microsoft Azure не располагает информацией о том, как содержимое этих девяти разных дисков связано друг с другом, и что изменения данных согласуются только при репликации в порядке, в котором выполнялись операции ввода-вывода для всех девяти дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-387">This means Microsoft Azure Storage geo-replication doesn’t know about the fact that the contents in these nine different disks are related to each other and that the data changes are consistent only when replicating in the order the I/O operations happened across all the nine disks.</span></span>
> 
> <span data-ttu-id="42034-388">Помимо высокой вероятности того, что геореплицированные образы в этом сценарии не обеспечат согласованного образа базы данных, есть вероятность существенного нежелательного влияния на производительность геореплицированного хранилища.</span><span class="sxs-lookup"><span data-stu-id="42034-388">Besides chances being high that the geo-replicated images in the scenario do not provide a consistent database image, there also is a performance penalty that shows up with geo redundant storage that can severely impact performance.</span></span> <span data-ttu-id="42034-389">Иными словами, этот тип избыточности хранилища не следует использовать для рабочих нагрузок типа СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-389">In summary, do not use this type of storage redundancy for DBMS type workloads.</span></span>
> 
> 

#### <a name="mapping-vhds-into-azure-virtual-machine-service-storage-accounts"></a><span data-ttu-id="42034-390">Сопоставление виртуальных жестких дисков с учетными записями хранения службы виртуальных машин Azure</span><span class="sxs-lookup"><span data-stu-id="42034-390">Mapping VHDs into Azure Virtual Machine Service Storage Accounts</span></span>
<span data-ttu-id="42034-391">Сведения в этом разделе применяется только к учетным записям хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-391">This chapter only applies to Azure Storage Accounts.</span></span> <span data-ttu-id="42034-392">Если вы планируете использовать Управляемые диски, ограничения, упомянутые в этой главе, неприменимы.</span><span class="sxs-lookup"><span data-stu-id="42034-392">If you plan to use Managed Disks, the limitations mentioned in this chapter do not apply.</span></span> <span data-ttu-id="42034-393">Дополнительные сведения об Управляемых дисках см. в [этом разделе][dbms-guide-managed-disks] данного руководства.</span><span class="sxs-lookup"><span data-stu-id="42034-393">For more information about Managed Disks, read chapter [Managed Disks][dbms-guide-managed-disks] of this guide.</span></span>

<span data-ttu-id="42034-394">Учетная запись хранения Azure является не только административной конструкцией, но и предметом ограничений.</span><span class="sxs-lookup"><span data-stu-id="42034-394">An Azure Storage Account is not only an administrative construct, but also a subject of limitations.</span></span> <span data-ttu-id="42034-395">Ограничения отличаются для учетных записей службы хранилища Azure классов Standard и Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-395">Whereas the limitations vary on whether we talk about an Azure Standard Storage Account or an Azure Premium Storage Account.</span></span> <span data-ttu-id="42034-396">Точное описание возможностей и ограничений приведено [здесь][storage-scalability-targets].</span><span class="sxs-lookup"><span data-stu-id="42034-396">The exact capabilities and limitations are listed [here][storage-scalability-targets]</span></span>

<span data-ttu-id="42034-397">Поэтому для службы хранилища Azure уровня "Стандартный" важно отметить ограничение количества операций ввода-вывода для учетной записи хранения (см. строку "Частота запросов" в [этой статье][storage-scalability-targets]).</span><span class="sxs-lookup"><span data-stu-id="42034-397">So for Azure Standard Storage it is important to note there is a limit on the IOPS per storage account (Row containing ‘Total Request Rate’ in [the article][storage-scalability-targets]).</span></span> <span data-ttu-id="42034-398">Кроме того, существует изначальное ограничение в 100 учетных записей хранения на одну подписку Azure (начиная с июля 2015 г.).</span><span class="sxs-lookup"><span data-stu-id="42034-398">In addition, there is an initial limit of 100 Storage Accounts per Azure subscription (as of July 2015).</span></span> <span data-ttu-id="42034-399">Таким образом, при использовании службы хранилища Azure класса Standard рекомендуется сбалансировать количество операций ввода-вывода для виртуальных машин между несколькими учетными записями хранения.</span><span class="sxs-lookup"><span data-stu-id="42034-399">Therefore, it is recommended to balance IOPS of VMs between multiple storage accounts when using Azure Standard Storage.</span></span> <span data-ttu-id="42034-400">При этом отдельная виртуальная машина в идеале использует по возможности одну учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="42034-400">Whereas a single VM ideally uses one storage account if possible.</span></span> <span data-ttu-id="42034-401">Поэтому, если говорить о развертываниях СУБД, где каждый виртуальный жесткий диск, размещенный в службе хранилища Azure класса Standard, может достичь предела квоты, следует развертывать не более 30–40 виртуальных жестких дисков на одну учетную запись службы хранилища Azure класса Standard.</span><span class="sxs-lookup"><span data-stu-id="42034-401">So if we talk about DBMS deployments where each VHD that is hosted on Azure Standard Storage could reach its quota limit, you should only deploy 30-40 VHDs per Azure Storage Account that uses Azure Standard Storage.</span></span> <span data-ttu-id="42034-402">С другой стороны, если используется служба хранилища Azure класса Premium и есть необходимость хранить крупные тома базы данных, показатели операций ввода-вывода будут адекватными.</span><span class="sxs-lookup"><span data-stu-id="42034-402">On the other hand, if you leverage Azure Premium Storage and want to store large database volumes, you might be fine in terms of IOPS.</span></span> <span data-ttu-id="42034-403">Однако учетная запись службы хранилища Azure класса Premium накладывает существенно большие ограничения на объем данных, чем аналогичная учетная запись хранилища класса Standard.</span><span class="sxs-lookup"><span data-stu-id="42034-403">But an Azure Premium Storage Account is way more restrictive in data volume than an Azure Standard Storage Account.</span></span> <span data-ttu-id="42034-404">Поэтому в учетной записи службы хранилища Azure класса Premium можно развернуть только ограниченное количество виртуальных жестких дисков, прежде чем лимит объема данных будет исчерпан.</span><span class="sxs-lookup"><span data-stu-id="42034-404">As a result, you can only deploy a limited number of VHDs within an Azure Premium Storage Account before hitting the data volume limit.</span></span> <span data-ttu-id="42034-405">В конечном итоге учетную запись службы хранилища Azure можно рассматривать как виртуальную сеть SAN с ограниченными возможностями в показателях операций ввода-вывода и (или) емкости.</span><span class="sxs-lookup"><span data-stu-id="42034-405">At the end, think of an Azure Storage Account as a “Virtual SAN” that has limited capabilities in IOPS and/or capacity.</span></span> <span data-ttu-id="42034-406">В результате остается та же задача, что и при локальном развертывании, — определить структуру виртуальных жестких дисков различных систем SAP для разных воображаемых устройств SAN или учетных записей службы хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-406">As a result, the task remains, as in on-premises deployments, to define the layout of the VHDs of the different SAP systems over the different ‘imaginary SAN devices’ or Azure Storage Accounts.</span></span>

<span data-ttu-id="42034-407">Для службы хранилища Azure класса Standard по возможности не рекомендуется предоставлять хранилище, состоящее из разных учетных записей хранения, одной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="42034-407">For Azure Standard Storage, it is not recommended to present storage from different storage accounts to a single VM if possible.</span></span>

<span data-ttu-id="42034-408">При использовании виртуальных машин Azure серии DS или GS возможно подключить виртуальные жесткие диски с использованием учетных записей хранения Azure классов "Стандартный" и "Премиум".</span><span class="sxs-lookup"><span data-stu-id="42034-408">When using the DS or GS-series of Azure VMs, it is possible to mount VHDs out of Azure Standard Storage Accounts and Premium Storage Accounts.</span></span> <span data-ttu-id="42034-409">Такое разнородное хранилище может быть полезно, например, при записи резервных копий на виртуальные жесткие диски хранилища класса Standard, когда файлы данных и журналов СУБД содержатся в хранилище класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-409">Use cases like writing backups into Standard Storage backed VHDs and having DBMS data and log files on Premium Storage come to mind where such heterogeneous storage could be leveraged.</span></span> 

<span data-ttu-id="42034-410">Опыт развертывания и тестирования систем клиентами показывает, что для одной учетной записи службы хранилища Azure класса Standard с приемлемой производительностью можно подготовить около 30–40 виртуальных жестких дисков, содержащих файлы данных и журнала базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-410">Based on customer deployments and testing around 30 to 40 VHDs containing database data files and log files can be provisioned on a single Azure Standard Storage Account with acceptable performance.</span></span> <span data-ttu-id="42034-411">Как упоминалось ранее, для учетной записи службы хранилища Azure класса Premium более вероятны ограничения на объем данных, которые могут в нем содержаться, а не на операции ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-411">As mentioned earlier, the limitation of an Azure Premium Storage Account is likely to be the data capacity it can hold and not IOPS.</span></span>

<span data-ttu-id="42034-412">Как и в случае с локальными устройствами SAN, для совместного использования требуется определенный мониторинг, позволяющий своевременно обнаруживать проблемы, связанные с учетной записью службы хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-412">As with SAN devices on-premises, sharing requires some monitoring in order to eventually detect bottlenecks on an Azure Storage Account.</span></span> <span data-ttu-id="42034-413">Такие средства, как расширение мониторинга Azure для SAP и портал Azure, позволяют обнаруживать загруженные учетные записи хранения Azure, которые могут демонстрировать неоптимальную производительность ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-413">The Azure Monitoring Extension for SAP and the Azure portal are tools that can be used to detect busy Azure Storage Accounts that may be delivering suboptimal IO performance.</span></span>  <span data-ttu-id="42034-414">В таком случае рекомендуется переместить загруженные виртуальные машины в другую учетную запись службы хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-414">If this situation is detected, it is recommended to move busy VMs to another Azure Storage Account.</span></span> <span data-ttu-id="42034-415">Дополнительные сведения о том, как активировать возможности мониторинга узла SAP, см. в [руководстве по развертыванию][deployment-guide].</span><span class="sxs-lookup"><span data-stu-id="42034-415">Refer to the [Deployment Guide][deployment-guide] for details on how to activate the SAP host monitoring capabilities.</span></span>

<span data-ttu-id="42034-416">Другую статью со сводкой практических рекомендаций по хранилищу Azure класса Standard и связанным учетным записям см. здесь: <https://blogs.msdn.com/b/mast/archive/2014/10/14/configuring-azure-virtual-machines-for-optimal-storage-performance.aspx>.</span><span class="sxs-lookup"><span data-stu-id="42034-416">Another article summarizing best practices around Azure Standard Storage and Azure Standard Storage Accounts can be found here <https://blogs.msdn.com/b/mast/archive/2014/10/14/configuring-azure-virtual-machines-for-optimal-storage-performance.aspx></span></span>

#### <span data-ttu-id="42034-417"><a name="f42c6cb5-d563-484d-9667-b07ae51bce29"></a>Управляемые диски</span><span class="sxs-lookup"><span data-stu-id="42034-417"><a name="f42c6cb5-d563-484d-9667-b07ae51bce29"></a>Managed Disks</span></span>
<span data-ttu-id="42034-418">Управляемые диски — это ресурс нового типа в Azure Resource Manager, который можно использовать вместо виртуальных жестких дисков, хранимых в учетных записях хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-418">Managed Disks are a new resource type in Azure Resource Manager that can be used instead of VHDs that are stored in Azure Storage Accounts.</span></span> <span data-ttu-id="42034-419">Управляемые диски автоматически соответствуют группам доступности виртуальной машины, к которой они подключены, и таким образом повышают ее доступность и доступность служб, выполняющихся на ней.</span><span class="sxs-lookup"><span data-stu-id="42034-419">Managed Disks automatically align with the Availability Set of the virtual machine they are attached to and therefore increase the availability of your virtual machine and the services that are running on the virtual machine.</span></span> <span data-ttu-id="42034-420">Дополнительные сведения см. в [обзорной статье](https://docs.microsoft.com/azure/storage/storage-managed-disks-overview).</span><span class="sxs-lookup"><span data-stu-id="42034-420">To learn more, read the [overview article](https://docs.microsoft.com/azure/storage/storage-managed-disks-overview).</span></span>

<span data-ttu-id="42034-421">Сейчас SAP поддерживает только Управляемые диски уровня "Премиум".</span><span class="sxs-lookup"><span data-stu-id="42034-421">SAP currently only supports Premium Managed Disks.</span></span> <span data-ttu-id="42034-422">Дополнительные сведения см. в примечании к SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="42034-422">Read SAP Note [1928533] for more details.</span></span>

#### <a name="moving-deployed-dbms-vms-from-azure-standard-storage-to-azure-premium-storage"></a><span data-ttu-id="42034-423">Перемещение развернутых виртуальных машин СУБД из службы хранилища Azure класса Standard в службу хранилища Azure класса Premium</span><span class="sxs-lookup"><span data-stu-id="42034-423">Moving deployed DBMS VMs from Azure Standard Storage to Azure Premium Storage</span></span>
<span data-ttu-id="42034-424">Существует немало сценариев, когда заказчику необходимо переместить развернутую виртуальную машину между службами хранилища Azure разных классов (Standard и Premium).</span><span class="sxs-lookup"><span data-stu-id="42034-424">We encounter quite some scenarios where you as customer want to move a deployed VM from Azure Standard Storage into Azure Premium Storage.</span></span> <span data-ttu-id="42034-425">Если диски хранятся в учетных записях хранения Azure, вы не сможете это сделать без физического перемещения данных.</span><span class="sxs-lookup"><span data-stu-id="42034-425">If your disks are stored in Azure Storage Accounts, this is not possible without physically moving the data.</span></span> <span data-ttu-id="42034-426">Это можно сделать несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="42034-426">There are several ways to achieve the goal:</span></span>

* <span data-ttu-id="42034-427">Можно просто скопировать все виртуальные жесткие диски — базовый диск и диски с данными — в новую учетную запись службы хранилища Azure класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-427">You could simply copy all VHDs, base VHD as well as data VHDs into a new Azure Premium Storage Account.</span></span> <span data-ttu-id="42034-428">Часто количество виртуальных жестких дисков в службе хранилища Azure класса Standard выбирается не на основе определенного объема данных,</span><span class="sxs-lookup"><span data-stu-id="42034-428">Often you chose the number of VHDs in Azure Standard Storage not because of the fact that you needed the data volume.</span></span> <span data-ttu-id="42034-429">а на основе количества операций ввода-вывода, соответствующих определенному количеству виртуальных жестких дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-429">But you needed that many VHDs because of the IOPS.</span></span> <span data-ttu-id="42034-430">Теперь при перемещении в службу хранилища Azure класса Premium можно обеспечить требуемую пропускную способность для операций ввода-вывода, используя гораздо меньше виртуальных жестких дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-430">Now that you move to Azure Premium Storage you could go with way fewer VHDs to achieve the same IOPS throughput.</span></span> <span data-ttu-id="42034-431">Учитывая тот факт, что в хранилище Azure Standard вы платите за используемые данные, а не за номинальный размер дисков, количество виртуальных жестких дисков не имеет значения с точки зрения затрат.</span><span class="sxs-lookup"><span data-stu-id="42034-431">Given the fact that in Azure Standard Storage you pay for the used data and not the nominal disk size, the number of VHDs did not really matter in terms of costs.</span></span> <span data-ttu-id="42034-432">Однако при использовании службы хранилища Azure класса Premium за номинальный размер дисков взимается плата.</span><span class="sxs-lookup"><span data-stu-id="42034-432">However, with Azure Premium Storage, you would pay for the nominal disk size.</span></span> <span data-ttu-id="42034-433">Поэтому большинство клиентов стараются поддерживать количество виртуальных жестких дисков Azure в хранилище класса Premium на уровне, необходимом для достижения требуемой пропускной способности для операций ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-433">Therefore, most of the customers try to keep the number of Azure VHDs in Premium Storage at the number needed to achieve the IOPS throughput necessary.</span></span> <span data-ttu-id="42034-434">Следовательно, большинство пользователей отказываются от простого способа копирования в соотношении 1:1.</span><span class="sxs-lookup"><span data-stu-id="42034-434">So, most customers decide against the way of a simple 1:1 copy.</span></span>
* <span data-ttu-id="42034-435">Если это еще не сделано, следует подключить один виртуальный жесткий диск, на котором можно разместить резервную копию базы данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-435">If not yet mounted, you mount a single VHD that can contain a database backup of your SAP database.</span></span> <span data-ttu-id="42034-436">После создания резервной копии следует отключить все виртуальные жесткие диски, включая диск с резервной копией, и скопировать базовый диск и диск с резервной копией в учетную запись службы хранилища Azure класса Premium.</span><span class="sxs-lookup"><span data-stu-id="42034-436">After the backup, you unmount all VHDs including the VHD containing the backup and copy the base VHD and the VHD with the backup into an Azure Premium Storage account.</span></span> <span data-ttu-id="42034-437">Затем нужно развернуть виртуальную машину на основе базового виртуального жесткого диска и подключить диск с резервной копией.</span><span class="sxs-lookup"><span data-stu-id="42034-437">You would then deploy the VM based on the base VHD and mount the VHD with the backup.</span></span> <span data-ttu-id="42034-438">Теперь следует создать дополнительные пустые диски хранилища класса Premium для виртуальной машины, на которые восстанавливается база данных.</span><span class="sxs-lookup"><span data-stu-id="42034-438">Now you create additional empty Premium Storage Disks for the VM that are used to restore the database into.</span></span> <span data-ttu-id="42034-439">При этом предполагается, что СУБД позволяет изменять пути к файлам данных и журналов в ходе восстановления.</span><span class="sxs-lookup"><span data-stu-id="42034-439">This assumes that the DBMS allows you to change paths to the data and log files as part of the restore process.</span></span>
* <span data-ttu-id="42034-440">Еще одна возможность — разновидность предыдущего процесса, когда виртуальный жесткий диск с резервной копией просто копируется в службу хранилища Azure класса Premium и присоединяется к только что развернутой и установленной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="42034-440">Another possibility is a variation of the former process, where you just copy the backup VHD into Azure Premium Storage and attach it against a VM that you newly deployed and installed.</span></span>
* <span data-ttu-id="42034-441">Четвертый вариант следует выбирать, если нужно изменить количество файлов данных в базе данных.</span><span class="sxs-lookup"><span data-stu-id="42034-441">The fourth possibility you would choose when you are in need to change the number of data files of your database.</span></span> <span data-ttu-id="42034-442">В таком случае следует выполнить копирование однородной системы SAP с помощью экспорта и импорта.</span><span class="sxs-lookup"><span data-stu-id="42034-442">In such a case, you would perform an SAP homogenous system copy using export/import.</span></span> <span data-ttu-id="42034-443">Поместите файлы экспорта на виртуальный жесткий диск, который копируется в учетную запись службы хранилища Azure класса Premium, и подключите его к виртуальной машине, используемой для запуска импорта.</span><span class="sxs-lookup"><span data-stu-id="42034-443">Put those export files into a VHD that is copied into an Azure Premium Storage Account and attach it to a VM that you use to run the import processes.</span></span> <span data-ttu-id="42034-444">Клиенты преимущественно используют эту возможность, когда нужно уменьшить количество файлов данных.</span><span class="sxs-lookup"><span data-stu-id="42034-444">Customers use this possibility mainly when they want to decrease the number of data files.</span></span>

<span data-ttu-id="42034-445">При использовании Управляемых дисков перенести данные в хранилище класса Premium можно следующим способом:</span><span class="sxs-lookup"><span data-stu-id="42034-445">If you use Managed Disks, you can migrate to Premium Storage by:</span></span>

1. <span data-ttu-id="42034-446">Освободить виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="42034-446">Deallocate the virtual machine</span></span>
2. <span data-ttu-id="42034-447">При необходимости изменить размер виртуальной машины до поддерживающего хранилище класса Premium (например, DS или GS).</span><span class="sxs-lookup"><span data-stu-id="42034-447">If necessary, resize the virtual machine to a size that supports Premium Storage (for example DS or GS)</span></span>
3. <span data-ttu-id="42034-448">Изменить тип учетной записи управляемого диска на Premium (SSD).</span><span class="sxs-lookup"><span data-stu-id="42034-448">Change the Managed Disk account type to Premium (SSD)</span></span>
4. <span data-ttu-id="42034-449">Запустить виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="42034-449">Start your virtual machine</span></span>

### <a name="deployment-of-vms-for-sap-in-azure"></a><span data-ttu-id="42034-450">Развертывание виртуальных машин для SAP в Azure</span><span class="sxs-lookup"><span data-stu-id="42034-450">Deployment of VMs for SAP in Azure</span></span>
<span data-ttu-id="42034-451">Microsoft Azure предусматривает несколько способов развертывания виртуальных машин и связанных дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-451">Microsoft Azure offers multiple ways to deploy VMs and associated disks.</span></span> <span data-ttu-id="42034-452">Важно понимать различия между ними, так как подготовка виртуальной машины может отличаться в зависимости от способа развертывания.</span><span class="sxs-lookup"><span data-stu-id="42034-452">Thereby it is important to understand the differences since preparations of the VMs might differ dependent on the way of deployment.</span></span> <span data-ttu-id="42034-453">В целом мы рассмотрим сценарии, описанные в следующих главах.</span><span class="sxs-lookup"><span data-stu-id="42034-453">In general, we look into the scenarios described in the following chapters.</span></span>

#### <a name="deploying-a-vm-from-the-azure-marketplace"></a><span data-ttu-id="42034-454">Развертывание виртуальной машины из Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="42034-454">Deploying a VM from the Azure Marketplace</span></span>
<span data-ttu-id="42034-455">Вы можете использовать для развертывания виртуальной машины образ из Azure Marketplace, предоставленный корпорацией Майкрософт или сторонним поставщиком.</span><span class="sxs-lookup"><span data-stu-id="42034-455">You like to take a Microsoft or third party provided image from the Azure Marketplace to deploy your VM.</span></span> <span data-ttu-id="42034-456">Когда вы развернете виртуальную машину в Azure, следуйте тем же рекомендациям и инструкциям средств для установки программного обеспечения SAP на виртуальной машине, что и в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-456">After you deployed your VM in Azure, you follow the same guidelines and tools to install the SAP software inside your VM as you would do in an on-premises environment.</span></span> <span data-ttu-id="42034-457">Чтобы установить программное обеспечение SAP на виртуальную машину Azure, специалисты SAP и Майкрософт рекомендуют скачать и сохранить установочный носитель SAP на дисках Azure или создать виртуальную машину Azure в качестве файлового сервера, содержащего все необходимые установочные носители SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-457">For installing the SAP software inside the Azure VM, SAP and Microsoft recommend uploading and store the SAP installation media in disks or to create an Azure VM working as a 'File server', which contains all the necessary SAP installation media.</span></span>

#### <a name="deploying-a-vm-with-a-customer-specific-generalized-image"></a><span data-ttu-id="42034-458">Развертывание виртуальной машины с помощью конкретного универсального пользовательского образа</span><span class="sxs-lookup"><span data-stu-id="42034-458">Deploying a VM with a customer-specific generalized image</span></span>
<span data-ttu-id="42034-459">Если для вашей версии ОС или СУБД существуют особые требования по установке исправлений, представленные в Azure Marketplace образы могут не соответствовать вашим потребностям.</span><span class="sxs-lookup"><span data-stu-id="42034-459">Due to specific patch requirements regarding your OS or DBMS version, the provided images in the Azure Marketplace might not fit your needs.</span></span> <span data-ttu-id="42034-460">В этом случае следует создать виртуальную машину с помощью собственного пользовательского образа ОС/СУБД для виртуальной машины, который можно развертывать многократно.</span><span class="sxs-lookup"><span data-stu-id="42034-460">Therefore, you might need to create a VM using your own 'private' OS/DBMS VM image, which can be deployed several times afterwards.</span></span> <span data-ttu-id="42034-461">Чтобы подготовить такой пользовательский образ к дублированию, на локальной виртуальной машине необходимо создать универсальный образ ОС.</span><span class="sxs-lookup"><span data-stu-id="42034-461">To prepare such a 'private' image for duplication, the OS must be generalized on the on-premises VM.</span></span> <span data-ttu-id="42034-462">Дополнительные сведения о подготовке к использованию виртуальной машины см. в [руководстве по развертыванию][deployment-guide].</span><span class="sxs-lookup"><span data-stu-id="42034-462">Refer to the [Deployment Guide][deployment-guide] for details on how to generalize a VM.</span></span>

<span data-ttu-id="42034-463">Если вы уже установили содержимое SAP на локальную виртуальную машину (что особенно важно для двухуровневых систем), то параметры системы SAP можно изменить после развертывания виртуальной машины в Azure. Для этого переименуйте экземпляр в SAP Software Provisioning Manager (см. примечание к SAP [1619720]).</span><span class="sxs-lookup"><span data-stu-id="42034-463">If you have already installed SAP content in your on-premises VM (especially for 2-Tier systems), you can adapt the SAP system settings after the deployment of the Azure VM through the instance rename procedure supported by the SAP Software Provisioning Manager (SAP Note [1619720]).</span></span> <span data-ttu-id="42034-464">В противном случае программное обеспечение SAP можно установить позже после развертывания виртуальной машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-464">Otherwise you can install the SAP software later after the deployment of the Azure VM.</span></span>

<span data-ttu-id="42034-465">Что касается содержимого базы данных, используемого приложением SAP, можно либо создать это содержимое заново с помощью установки SAP, либо импортировать содержимое в Azure, используя виртуальный жесткий диск с резервной копией базы данных СУБД или задействовав возможности СУБД для прямого резервного копирования в хранилище Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-465">As of the database content used by the SAP application, you can either generate the content freshly by an SAP installation or you can import your content into Azure by using a VHD with a DBMS database backup or by leveraging capabilities of the DBMS to directly backup into Microsoft Azure Storage.</span></span> <span data-ttu-id="42034-466">В этом случае можно также подготовить виртуальные жесткие диски с файлами данных и журналов СУБД локально, а затем импортировать их как диски в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-466">In this case, you could also prepare VHDs with the DBMS data and log files on-premises and then import those as Disks into Azure.</span></span> <span data-ttu-id="42034-467">Однако передача данных СУБД, которые загружаются из локальной среды в Azure, будет осуществляться через виртуальные жесткие диски, которые необходимо подготовить локально.</span><span class="sxs-lookup"><span data-stu-id="42034-467">But the transfer of DBMS data, which is getting loaded from on-premises to Azure would work over VHD disks that need to be prepared on-premises.</span></span>

#### <a name="moving-a-vm-from-on-premises-to-azure-with-a-non-generalized-disk"></a><span data-ttu-id="42034-468">Перемещение виртуальной машины из локальной среды в Azure с помощью специализированного диска</span><span class="sxs-lookup"><span data-stu-id="42034-468">Moving a VM from on-premises to Azure with a non-generalized disk</span></span>
<span data-ttu-id="42034-469">Предположим, вы хотите переместить определенную систему SAP из локальной среды в Azure (методика Lift and Shift — перенос с сохранением структуры).</span><span class="sxs-lookup"><span data-stu-id="42034-469">You plan to move a specific SAP system from on-premises to Azure (lift and shift).</span></span> <span data-ttu-id="42034-470">Для этого можно передать в Azure диск, который содержит ОС, двоичные файлы SAP и конечные двоичные файлы СУБД, а также дополнительные диски с файлами данных и журналов СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-470">This can be done by uploading the disk, which contains the OS, the SAP binaries, and eventual DBMS binaries plus the disks with the data and log files of the DBMS to Azure.</span></span> <span data-ttu-id="42034-471">В отличие от описанного выше сценария 2, вы сохраните на виртуальной машине Azure те же имя узла, идентификатор безопасности SAP и учетные записи пользователей SAP, которые были настроены в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-471">In opposite to scenario #2 above, you keep the hostname, SAP SID, and SAP user accounts in the Azure VM as they were configured in the on-premises environment.</span></span> <span data-ttu-id="42034-472">В этом случае создание универсального образа не требуется.</span><span class="sxs-lookup"><span data-stu-id="42034-472">Therefore, generalizing the image is not necessary.</span></span> <span data-ttu-id="42034-473">Этот случай главным образом касается сценариев распределенного развертывания, при которых одна часть ландшафта SAP выполняется локально, а другая часть — в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-473">This case mostly applies for Cross-Premises scenarios where a part of the SAP landscape is run on-premises and parts on Azure.</span></span>

## <span data-ttu-id="42034-474"><a name="871dfc27-e509-4222-9370-ab1de77021c3"></a>Высокая доступность и аварийное восстановление с использованием виртуальных машин Azure</span><span class="sxs-lookup"><span data-stu-id="42034-474"><a name="871dfc27-e509-4222-9370-ab1de77021c3"></a>High Availability and Disaster Recovery with Azure VMs</span></span>
<span data-ttu-id="42034-475">Azure предоставляет следующие функции высокой доступности (HA) и аварийного восстановления (DR) для различных компонентов, которые могут использоваться для развертываний SAP и СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-475">Azure offers the following High Availability (HA) and Disaster Recovery (DR) functionalities, which apply to different components we would use for SAP and DBMS deployments</span></span>

### <a name="vms-deployed-on-azure-nodes"></a><span data-ttu-id="42034-476">Виртуальные машины, развернутые на узлах Azure</span><span class="sxs-lookup"><span data-stu-id="42034-476">VMs deployed on Azure Nodes</span></span>
<span data-ttu-id="42034-477">Для развернутых виртуальных машин платформа Azure не предоставляет таких функций, как динамическая миграция.</span><span class="sxs-lookup"><span data-stu-id="42034-477">The Azure Platform does not offer features such as Live Migration for deployed VMs.</span></span> <span data-ttu-id="42034-478">Это означает, что при необходимости в техническом обслуживании на серверном кластере, где развернута виртуальная машина, эту машину потребуется остановить и перезапустить.</span><span class="sxs-lookup"><span data-stu-id="42034-478">This means if there is maintenance necessary on a server cluster on which a VM is deployed, the VM needs to get stopped and restarted.</span></span> <span data-ttu-id="42034-479">Техническое обслуживание в Azure выполняется с помощью так называемых доменов обновления в кластерах серверов.</span><span class="sxs-lookup"><span data-stu-id="42034-479">Maintenance in Azure is performed using so called Upgrade Domains within clusters of servers.</span></span> <span data-ttu-id="42034-480">Одновременно поддерживается обслуживание только одного домена обновления.</span><span class="sxs-lookup"><span data-stu-id="42034-480">Only one Upgrade Domain at a time is being maintained.</span></span> <span data-ttu-id="42034-481">В ходе такой перезагрузки обслуживание будет прервано на время выключения виртуальной машины, выполнения технического обслуживания и перезапуска виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-481">During such a restart, there is an interruption of service while the VM is shut down, maintenance is performed and VM restarted.</span></span> <span data-ttu-id="42034-482">Однако большинство поставщиков СУБД предоставляют функциональные возможности высокой доступности и аварийного восстановления, которые позволяют быстро перезапустить службы СУБД на другом узле в случае недоступности основного узла.</span><span class="sxs-lookup"><span data-stu-id="42034-482">Most DBMS vendors however provide High Availability and Disaster Recovery functionality that quickly restarts the DBMS services on another node if the primary node is unavailable.</span></span> <span data-ttu-id="42034-483">Платформа Azure предоставляет функциональные возможности для распределения виртуальных машин, службы хранилища и других служб Azure между доменами обновления, чтобы гарантировать, что плановое техническое обслуживание или сбой инфраструктуры повлияют только на небольшое подмножество виртуальных машин или служб.</span><span class="sxs-lookup"><span data-stu-id="42034-483">The Azure Platform offers functionality to distribute VMs, Storage, and other Azure services across Upgrade Domains to ensure that planned maintenance or infrastructure failures would only impact a small subset of VMs or services.</span></span>  <span data-ttu-id="42034-484">Благодаря тщательному планированию можно добиться уровней доступности, сравнимых с локальными инфраструктурами.</span><span class="sxs-lookup"><span data-stu-id="42034-484">With careful planning, it is possible to achieve availability levels comparable to on-premises infrastructures.</span></span>

<span data-ttu-id="42034-485">Группы доступности Microsoft Azure — это логические группы виртуальных машин или служб, которые обеспечивают их распределение по разным доменам сбоя и обновления в кластере таким образом, чтобы в любой момент времени могла быть завершена работа только одного узла (дополнительные сведения см. в [этой (Linux)][virtual-machines-manage-availability-linux] или [этой (Windows)][virtual-machines-manage-availability-windows] статье).</span><span class="sxs-lookup"><span data-stu-id="42034-485">Microsoft Azure Availability Sets are a logical grouping of VMs or Services that ensures VMs and other services are distributed to different Fault and Upgrade Domains within a cluster such that there would only be one node shutdown at any one point in time (read [this (Linux)][virtual-machines-manage-availability-linux] or [this (Windows)][virtual-machines-manage-availability-windows] article for more details).</span></span>

<span data-ttu-id="42034-486">Их необходимо настроить в соответствии с назначением при развертывании виртуальных машин, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="42034-486">It needs to be configured by purpose when rolling out VMs as seen here:</span></span>

![Определение группы доступности для конфигураций высокой доступности СУБД ][dbms-guide-figure-200]

<span data-ttu-id="42034-488">Если требуется создать высокодоступные конфигурации развертываний СУБД (независимо от используемых функций высокой доступности отдельных СУБД), для виртуальных машин СУБД потребуется следующее:</span><span class="sxs-lookup"><span data-stu-id="42034-488">If we want to create highly available configurations of DBMS deployments (independent of the individual DBMS HA functionality used), the DBMS VMs would need to:</span></span>

* <span data-ttu-id="42034-489">Добавьте виртуальные машины в ту же виртуальную сеть Azure (<https://azure.microsoft.com/documentation/services/virtual-network/>).</span><span class="sxs-lookup"><span data-stu-id="42034-489">Add the VMs to the same Azure Virtual Network (<https://azure.microsoft.com/documentation/services/virtual-network/>)</span></span>
* <span data-ttu-id="42034-490">Виртуальные машины в высокодоступной конфигурации также должны находиться в той же подсети.</span><span class="sxs-lookup"><span data-stu-id="42034-490">The VMs of the HA configuration should also be in the same subnet.</span></span> <span data-ttu-id="42034-491">Разрешение имен между разными подсетями невозможно в развертываниях только в облаке. В таком случае работает только разрешение IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="42034-491">Name resolution between the different subnets is not possible in Cloud-Only deployments, only IP resolution works.</span></span> <span data-ttu-id="42034-492">Для распределенного развертывания с использованием подключения "сеть — сеть" или ExpressRoute уже будет установлена сеть по крайней мере с одной подсетью.</span><span class="sxs-lookup"><span data-stu-id="42034-492">Using site-to-site or ExpressRoute connectivity for Cross-Premises deployments, a network with at least one subnet is already established.</span></span> <span data-ttu-id="42034-493">Разрешение имен будет выполняться в соответствии с локальными политиками AD и сетевой инфраструктурой.</span><span class="sxs-lookup"><span data-stu-id="42034-493">Name resolution is done according to the on-premises AD policies and network infrastructure.</span></span> 

[comment]: <> (Пользователь MSSedusch: проверить, актуально ли до сих пор в ARM)

#### <a name="ip-addresses"></a><span data-ttu-id="42034-495">IP-адреса</span><span class="sxs-lookup"><span data-stu-id="42034-495">IP Addresses</span></span>
<span data-ttu-id="42034-496">Настоятельно рекомендуем использовать гибкую настройку виртуальных машин для высокодоступных конфигураций.</span><span class="sxs-lookup"><span data-stu-id="42034-496">It is highly recommended to setup the VMs for HA configurations in a resilient way.</span></span> <span data-ttu-id="42034-497">Использовать IP-адреса для обращения к партнерам по высокой доступности в высокодоступной конфигурации в Azure рекомендуется только в том случае, если используются статические IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="42034-497">Relying on IP addresses to address the HA partner(s) within the HA configuration is not reliable in Azure unless static IP addresses are used.</span></span> <span data-ttu-id="42034-498">В Azure существует два понятия "завершение работы".</span><span class="sxs-lookup"><span data-stu-id="42034-498">There are two "Shutdown" concepts in Azure:</span></span>

* <span data-ttu-id="42034-499">Завершение работы с помощью портала Azure или командлета Azure PowerShell Stop-AzureRmVM. В этом случае выполняется завершение работы виртуальной машины и отмена распределения.</span><span class="sxs-lookup"><span data-stu-id="42034-499">Shut down through Azure portal or Azure PowerShell cmdlet Stop-AzureRmVM: In this case, the Virtual Machine gets shutdown and de-allocated.</span></span> <span data-ttu-id="42034-500">За учетную запись Azure для этой виртуальной машины больше не взимается плата. Оплачивается только используемое хранилище.</span><span class="sxs-lookup"><span data-stu-id="42034-500">Your Azure account is no longer charged for this VM so the only charges that incur are for the storage used.</span></span> <span data-ttu-id="42034-501">Однако если частный IP-адрес сетевого интерфейса не является статическим, этот IP-адрес освобождается, и нет никакой гарантии, что сетевой интерфейс снова получит старый IP-адрес после перезапуска виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-501">However, if the private IP address of the network interface was not static, the IP address is released and it is not guaranteed that the network interface gets the old IP address assigned again after a restart of the VM.</span></span> <span data-ttu-id="42034-502">При завершении работы через портал Azure или с помощью командлета Stop-AzureRmVM распределение памяти автоматически отменяется.</span><span class="sxs-lookup"><span data-stu-id="42034-502">Performing the shut down through the Azure portal or by calling Stop-AzureRmVM automatically causes de-allocation.</span></span> <span data-ttu-id="42034-503">Если распределение не следует отменять, используйте командлет Stop-AzureRmVM -StayProvisioned.</span><span class="sxs-lookup"><span data-stu-id="42034-503">If you do not want to deallocate the machine use Stop-AzureRmVM -StayProvisioned</span></span> 
* <span data-ttu-id="42034-504">При завершении работы на уровне операционной системы эта виртуальная машина выключается, но распределение НЕ отменяется.</span><span class="sxs-lookup"><span data-stu-id="42034-504">If you shut down the VM from an OS level, the VM gets shut down and NOT de-allocated.</span></span> <span data-ttu-id="42034-505">Однако в этом случае с учетной записи Azure взимается плата за виртуальную машину, несмотря на то что она выключена.</span><span class="sxs-lookup"><span data-stu-id="42034-505">However, in this case, your Azure account is still charged for the VM, despite the fact that it is shutdown.</span></span> <span data-ttu-id="42034-506">В таком случае назначение IP-адреса остановленной виртуальной машины останется без изменений.</span><span class="sxs-lookup"><span data-stu-id="42034-506">In such a case, the assignment of the IP address to a stopped VM remains intact.</span></span> <span data-ttu-id="42034-507">Завершение работы виртуальной машины изнутри не приводит к автоматической отмене распределения.</span><span class="sxs-lookup"><span data-stu-id="42034-507">Shutting down the VM from within does not automatically force de-allocation.</span></span>

<span data-ttu-id="42034-508">Даже в распределенных сценариях завершение работы и отмена распределения по умолчанию означают отмену назначения IP-адресов виртуальной машине, даже если локальные политики в параметрах DHCP настроены иначе.</span><span class="sxs-lookup"><span data-stu-id="42034-508">Even for Cross-Premises scenarios, by default a shutdown and de-allocation means de-assignment of the IP addresses from the VM, even if on-premises policies in DHCP settings are different.</span></span> 

* <span data-ttu-id="42034-509">Исключением является ситуация, когда сетевому интерфейсу назначается статический IP-адрес, как описано [здесь][virtual-networks-reserved-private-ip].</span><span class="sxs-lookup"><span data-stu-id="42034-509">The exception is if one assigns a static IP address to a network interface as described [here][virtual-networks-reserved-private-ip].</span></span>
* <span data-ttu-id="42034-510">В таком случае IP-адрес остается неизменным при условии, что сетевой интерфейс не удаляется.</span><span class="sxs-lookup"><span data-stu-id="42034-510">In such a case the IP address remains fixed as long as the network interface is not deleted.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="42034-511">Чтобы поддерживать всю развернутую службу в простом и управляемом состоянии, настоятельно рекомендуется настроить партнерство виртуальных машин в конфигурации СУБД высокой доступности или аварийного восстановления в Azure таким образом, чтобы функционировало разрешение имен между разными задействованными виртуальными машинами.</span><span class="sxs-lookup"><span data-stu-id="42034-511">In order to keep the whole deployment simple and manageable, the clear recommendation is to setup the VMs partnering in a DBMS HA or DR configuration within Azure in a way that there is a functioning name resolution between the different VMs involved.</span></span>
> 
> 

## <a name="deployment-of-host-monitoring"></a><span data-ttu-id="42034-512">Развертывание мониторинга узлов</span><span class="sxs-lookup"><span data-stu-id="42034-512">Deployment of Host Monitoring</span></span>
<span data-ttu-id="42034-513">Для использования приложений SAP на виртуальных машинах Azure в производственных целях системе SAP требуется возможность получения данных мониторинга узлов с физических узлов, на которых работают виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-513">For productive usage of SAP Applications in Azure Virtual Machines, SAP requires the ability to get host monitoring data from the physical hosts running the Azure Virtual Machines.</span></span> <span data-ttu-id="42034-514">Требуется определенный уровень исправлений SAP HostAgent, включающий эту возможность в SAPOSCOL и SAP HostAgent.</span><span class="sxs-lookup"><span data-stu-id="42034-514">A specific SAP Host Agent patch level is required that enables this capability in SAPOSCOL and SAP Host Agent.</span></span> <span data-ttu-id="42034-515">Точное описание уровня исправлений указано в примечании к SAP [1409604].</span><span class="sxs-lookup"><span data-stu-id="42034-515">The exact patch level is documented in SAP Note [1409604].</span></span>

<span data-ttu-id="42034-516">Дополнительные сведения о развертывании компонентов, передающих данные узлов в SAPOSCOL и SAPHostAgent, и об управлении жизненным циклом этих компонентов см. в [руководстве по развертыванию][deployment-guide].</span><span class="sxs-lookup"><span data-stu-id="42034-516">For the details regarding deployment of components that deliver host data to SAPOSCOL and SAP Host Agent and the lifecycle management of those components, refer to the [Deployment Guide][deployment-guide]</span></span>

## <span data-ttu-id="42034-517"><a name="3264829e-075e-4d25-966e-a49dad878737"></a>Особенности Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-517"><a name="3264829e-075e-4d25-966e-a49dad878737"></a>Specifics to Microsoft SQL Server</span></span>
### <a name="sql-server-iaas"></a><span data-ttu-id="42034-518">IaaS в SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-518">SQL Server IaaS</span></span>
<span data-ttu-id="42034-519">Начиная с Microsoft Azure, можно легко переносить существующие приложения SQL Server, построенные на платформе Windows Server, на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-519">Starting with Microsoft Azure, you can easily migrate your existing SQL Server applications built on Windows Server platform to Azure Virtual Machines.</span></span> <span data-ttu-id="42034-520">SQL Server на виртуальной машине позволяет снизить общую стоимость владения для операций развертывания и обслуживания корпоративных приложений, а также управления ими благодаря простому переносу этих приложений в Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-520">SQL Server in a Virtual Machine enables you to reduce the total cost of ownership of deployment, management, and maintenance of enterprise breadth applications by easily migrating these applications to Microsoft Azure.</span></span> <span data-ttu-id="42034-521">С помощью SQL Server на виртуальной машине Azure администраторы и разработчики могут по-прежнему использовать те же средства разработки и администрирования, которые доступны в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-521">With SQL Server in an Azure Virtual Machine, administrators and developers can still use the same development and administration tools that are available on-premises.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="42034-522">Обратите внимание, что мы не обсуждаем базу данных SQL Microsoft Azure, которая представляет собой предложение в формате "платформа как услуга" на платформе Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-522">We are not discussing Microsoft Azure SQL Database, which is a Platform as a Service offer of the Microsoft Azure Platform.</span></span> <span data-ttu-id="42034-523">В этом документе рассматривается запуск продукта SQL Server в том виде, в каком он традиционно используется для локальных развертываний на виртуальных машинах Azure, с использованием функций инфраструктуры как услуги в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-523">The discussion in this paper is about running the SQL Server product as it is known for on-premises deployments in Azure Virtual Machines, leveraging the Infrastructure as a Service capability of Azure.</span></span> <span data-ttu-id="42034-524">Возможности и функции базы данных в этих двух предложениях различаются, и их не следует путать друг с другом.</span><span class="sxs-lookup"><span data-stu-id="42034-524">Database capabilities and functionalities between these two offers are different and should not be mixed up with each other.</span></span> <span data-ttu-id="42034-525">См. также: <https://azure.microsoft.com/services/sql-database/>.</span><span class="sxs-lookup"><span data-stu-id="42034-525">See also: <https://azure.microsoft.com/services/sql-database/></span></span>
> 
> 

<span data-ttu-id="42034-526">Прежде чем продолжить, настоятельно рекомендуем ознакомиться с [этой][virtual-machines-sql-server-infrastructure-services] документацией.</span><span class="sxs-lookup"><span data-stu-id="42034-526">It is strongly recommended to review [this][virtual-machines-sql-server-infrastructure-services] documentation before continuing.</span></span>

<span data-ttu-id="42034-527">В следующих разделах упоминаются различные фрагменты документации по указанной выше ссылке.</span><span class="sxs-lookup"><span data-stu-id="42034-527">In the following sections pieces of parts of the documentation under the link above are aggregated and mentioned.</span></span> <span data-ttu-id="42034-528">Также упоминаются особенности, связанные с SAP. Некоторые основные понятия описаны более подробно.</span><span class="sxs-lookup"><span data-stu-id="42034-528">Specifics around SAP are mentioned as well and some concepts are described in more detail.</span></span> <span data-ttu-id="42034-529">Однако настоятельно рекомендуем сначала поработать с упомянутой выше документацией, прежде чем приступать к чтению документации, касающейся SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-529">However, it is highly recommended to work through the documentation above first before reading the SQL Server specific documentation.</span></span>

<span data-ttu-id="42034-530">Существуют некоторые специальные сведения об SQL Server в IaaS, которые следует знать перед продолжением:</span><span class="sxs-lookup"><span data-stu-id="42034-530">There is some SQL Server in IaaS specific information you should know before continuing:</span></span>

* <span data-ttu-id="42034-531">**Соглашение об уровне обслуживания для виртуальных машин.** Существует соглашение об уровне обслуживания для виртуальных машин, работающих в Azure, которое можно найти здесь: <https://azure.microsoft.com/support/legal/sla/>.</span><span class="sxs-lookup"><span data-stu-id="42034-531">**Virtual Machine SLA**: There is an SLA for Virtual Machines running in Azure, which can be found here: <https://azure.microsoft.com/support/legal/sla/></span></span>  
* <span data-ttu-id="42034-532">**Поддержка версий SQL.** Для клиентов SAP на виртуальной машине Microsoft Azure поддерживается SQL Server 2008 R2 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="42034-532">**SQL Version Support**: For SAP customers, we support SQL Server 2008 R2 and higher on Microsoft Azure Virtual Machine.</span></span> <span data-ttu-id="42034-533">Более ранние выпуски не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="42034-533">Earlier editions are not supported.</span></span> <span data-ttu-id="42034-534">Дополнительные сведения см. в этом общем [заявлении о поддержке](https://support.microsoft.com/kb/956893).</span><span class="sxs-lookup"><span data-stu-id="42034-534">Review this general [Support Statement](https://support.microsoft.com/kb/956893) for more details.</span></span> <span data-ttu-id="42034-535">Обратите внимание, что в целом SQL Server 2008 также поддерживается корпорацией Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="42034-535">Note that in general SQL Server 2008 is supported by Microsoft as well.</span></span> <span data-ttu-id="42034-536">Однако в SQL Server 2008 R2 были представлены важные функциональные возможности для SAP, поэтому SQL Server 2008 R2 является минимальной поддерживаемой версией для SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-536">However due to significant functionality for SAP, which was introduced with SQL Server 2008 R2, SQL Server 2008 R2 is the minimum release for SAP.</span></span> <span data-ttu-id="42034-537">Помните, что в версиях SQL Server 2012 и 2014 были добавлены функции углубленной интеграции в сценарий IaaS (например, резервное копирование непосредственно в хранилище Azure).</span><span class="sxs-lookup"><span data-stu-id="42034-537">Keep in mind that SQL Server 2012 and 2014 got extended with deeper integration into the IaaS scenario (like backing up directly against Azure Storage).</span></span> <span data-ttu-id="42034-538">Поэтому в данном документе мы ограничиваемся версиями SQL Server 2012 и 2014 с последним уровнем исправления для Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-538">Therefore, we restrict this paper to SQL Server 2012 and 2014 with its latest patch level for Azure.</span></span>
* <span data-ttu-id="42034-539">**Поддержка функций SQL.** Большинство функций SQL Server поддерживается на виртуальных машинах Microsoft Azure с некоторыми исключениями.</span><span class="sxs-lookup"><span data-stu-id="42034-539">**SQL Feature Support**: Most SQL Server features are supported on Microsoft Azure Virtual Machines with some exceptions.</span></span> <span data-ttu-id="42034-540">**Создание отказоустойчивых кластеров SQL Server с использованием общих дисков не поддерживается**.</span><span class="sxs-lookup"><span data-stu-id="42034-540">**SQL Server Failover Clustering using Shared Disks is not supported**.</span></span>  <span data-ttu-id="42034-541">Распределенные технологии, такие как зеркальное отображение базы данных, группы доступности AlwaysOn, репликация, доставка журналов и Service Broker, поддерживаются в пределах одного региона Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-541">Distributed technologies like Database Mirroring, AlwaysOn Availability Groups, Replication, Log Shipping and Service Broker are supported within a single Azure Region.</span></span> <span data-ttu-id="42034-542">SQL Server AlwaysOn также поддерживается между разными регионами Azure, как описано здесь: <https://blogs.technet.com/b/dataplatforminsider/archive/2014/06/19/sql-server-alwayson-availability-groups-supported-between-microsoft-azure-regions.aspx>.</span><span class="sxs-lookup"><span data-stu-id="42034-542">SQL Server AlwaysOn also is supported between different Azure Regions as documented here:  <https://blogs.technet.com/b/dataplatforminsider/archive/2014/06/19/sql-server-alwayson-availability-groups-supported-between-microsoft-azure-regions.aspx>.</span></span>  <span data-ttu-id="42034-543">Дополнительные сведения см. в [заявлении о поддержке](https://support.microsoft.com/kb/956893).</span><span class="sxs-lookup"><span data-stu-id="42034-543">Review the [Support Statement](https://support.microsoft.com/kb/956893) for more details.</span></span> <span data-ttu-id="42034-544">Пример развертывания конфигурации AlwaysOn показан в [этой][virtual-machines-workload-template-sql-alwayson] статье.</span><span class="sxs-lookup"><span data-stu-id="42034-544">An example on how to deploy an AlwaysOn configuration is shown in [this][virtual-machines-workload-template-sql-alwayson] article.</span></span> <span data-ttu-id="42034-545">Кроме того, ознакомьтесь с практическими рекомендациями, описанными [здесь][virtual-machines-sql-server-infrastructure-services].</span><span class="sxs-lookup"><span data-stu-id="42034-545">Also, check out the Best Practices documented [here][virtual-machines-sql-server-infrastructure-services]</span></span> 
* <span data-ttu-id="42034-546">**Производительность SQL.** Мы уверены, что размещенные в Microsoft Azure виртуальные машины работают очень хорошо по сравнению с другими общедоступными облачными предложениями виртуализации, но отдельные результаты могут отличаться.</span><span class="sxs-lookup"><span data-stu-id="42034-546">**SQL Performance**: We are confident that Microsoft Azure hosted Virtual Machines perform very well in comparison to other public cloud virtualization offerings, but individual results may vary.</span></span> <span data-ttu-id="42034-547">Ознакомьтесь с [этой][virtual-machines-sql-server-performance-best-practices] статьей.</span><span class="sxs-lookup"><span data-stu-id="42034-547">Check out [this][virtual-machines-sql-server-performance-best-practices] article.</span></span>
* <span data-ttu-id="42034-548">**Использование образов из Azure Marketplace.** Самый быстрый способ развернуть новую виртуальную машину Microsoft Azure — использовать образ из Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="42034-548">**Using Images from Azure Marketplace**: The fastest way to deploy a new Microsoft Azure VM is to use an image from the Azure Marketplace.</span></span> <span data-ttu-id="42034-549">В Azure Marketplace имеются образы, содержащие SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-549">There are images in the Azure Marketplace, which contain SQL Server.</span></span> <span data-ttu-id="42034-550">Образы, в которых уже установлен SQL Server, нельзя сразу же использовать для приложений SAP NetWeaver.</span><span class="sxs-lookup"><span data-stu-id="42034-550">The images where SQL Server already is installed can’t be immediately used for SAP NetWeaver applications.</span></span> <span data-ttu-id="42034-551">Причина в том, что в таких образах заданы параметры сортировки по умолчанию для SQL Server, которые отличаются от параметров, требующихся для систем SAP NetWeaver.</span><span class="sxs-lookup"><span data-stu-id="42034-551">The reason is the default SQL Server collation is installed within those images and not the collation required by SAP NetWeaver systems.</span></span> <span data-ttu-id="42034-552">Чтобы использовать такие образы, выполните действия, описанные в разделе [Использование образов SQL Server из Microsoft Azure Marketplace][dbms-guide-5.6].</span><span class="sxs-lookup"><span data-stu-id="42034-552">In order to use such images, check the steps documented in chapter [Using a SQL Server image out of the Microsoft Azure Marketplace][dbms-guide-5.6].</span></span> 
* <span data-ttu-id="42034-553">Дополнительные сведения см. в статье [Сведения о ценах](https://azure.microsoft.com/pricing/).</span><span class="sxs-lookup"><span data-stu-id="42034-553">Check out [Pricing Details](https://azure.microsoft.com/pricing/) for more information.</span></span> <span data-ttu-id="42034-554">Важными материалами также являются [руководство по лицензированию SQL Server 2012](https://download.microsoft.com/download/7/3/C/73CAD4E0-D0B5-4BE5-AB49-D5B886A5AE00/SQL_Server_2012_Licensing_Reference_Guide.pdf) и [руководство по лицензированию SQL Server 2014](https://download.microsoft.com/download/B/4/E/B4E604D9-9D38-4BBA-A927-56E4C872E41C/SQL_Server_2014_Licensing_Guide.pdf).</span><span class="sxs-lookup"><span data-stu-id="42034-554">The [SQL Server 2012 Licensing Guide](https://download.microsoft.com/download/7/3/C/73CAD4E0-D0B5-4BE5-AB49-D5B886A5AE00/SQL_Server_2012_Licensing_Reference_Guide.pdf) and [SQL Server 2014 Licensing Guide](https://download.microsoft.com/download/B/4/E/B4E604D9-9D38-4BBA-A927-56E4C872E41C/SQL_Server_2014_Licensing_Guide.pdf) are also an important resource.</span></span>

### <a name="sql-server-configuration-guidelines-for-sap-related-sql-server-installations-in-azure-vms"></a><span data-ttu-id="42034-555">Рекомендации по конфигурации SQL Server для связанных с SAP установок SQL Server на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="42034-555">SQL Server configuration guidelines for SAP-related SQL Server installations in Azure VMs</span></span>
#### <a name="recommendations-on-vmvhd-structure-for-sap-related-sql-server-deployments"></a><span data-ttu-id="42034-556">Рекомендации по структуре виртуальных машин и виртуальных жестких дисков для связанных с SAP развертываний SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-556">Recommendations on VM/VHD structure for SAP-related SQL Server deployments</span></span>
<span data-ttu-id="42034-557">В соответствии с общим описанием исполняемые файлы SQL Server должны быть расположены или установлены на системном диске ОС виртуальной машины (диск C:\)).</span><span class="sxs-lookup"><span data-stu-id="42034-557">In accordance with the general description, SQL Server executables should be located or installed into the system drive of the VM’s OS disk (drive C:\).</span></span>  <span data-ttu-id="42034-558">Как правило, большая часть системных баз данных SQL Server не используется на высоком уровне рабочей нагрузкой SAP NetWeaver.</span><span class="sxs-lookup"><span data-stu-id="42034-558">Typically, most of the SQL Server system databases are not utilized at a high level by SAP NetWeaver workload.</span></span> <span data-ttu-id="42034-559">Поэтому системные базы данных SQL Server (master, msdb и model) могут также оставаться на диске C:\.</span><span class="sxs-lookup"><span data-stu-id="42034-559">Hence the system databases of SQL Server (master, msdb, and model) can remain on the C:\ drive as well.</span></span> <span data-ttu-id="42034-560">Исключением может быть tempdb, для которой в случае некоторых рабочих нагрузок SAP ERP и любых рабочих нагрузок BW может потребоваться больший объем данных или объем операций ввода-вывода, с которым не справится исходная виртуальная машина.</span><span class="sxs-lookup"><span data-stu-id="42034-560">An exception could be tempdb, which in the case of some SAP ERP and all BW workloads, might require either higher data volume or I/O operations volume, which can’t fit into the original VM.</span></span> <span data-ttu-id="42034-561">Для таких систем необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="42034-561">For such systems, the following steps should be performed:</span></span>

* <span data-ttu-id="42034-562">Переместите основные файлы данных tempdb на тот же логический диск, где находятся основные файлы данных базы данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-562">Move the primary tempdb data file(s) to the same logical drive as the primary data file(s) of the SAP database.</span></span>
* <span data-ttu-id="42034-563">Добавьте все дополнительные файлы данных tempdb на каждый из остальных логических дисков, содержащих файл данных базы данных пользователя SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-563">Add any additional tempdb data files to each of the other logical drives containing a data file of the SAP user database.</span></span>
* <span data-ttu-id="42034-564">Добавьте файл журнала базы данных tempdb на логический диск, содержащий файл журнала базы данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="42034-564">Add the tempdb logfile to the logical drive, which contains the user database’s log file.</span></span>
* <span data-ttu-id="42034-565">**Исключительно для типов виртуальных машин, использующих локальные твердотельные накопители**: на вычислительном узле файлы данных и журналов tempdb могут располагаться на диске D:\.</span><span class="sxs-lookup"><span data-stu-id="42034-565">**Exclusively for VM types that use local SSDs** on the compute node tempdb data and log files might be placed on the D:\ drive.</span></span> <span data-ttu-id="42034-566">Тем не менее можно рекомендовать использовать несколько файлов данных базы данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="42034-566">Nevertheless, it might be recommended to use multiple tempdb data files.</span></span> <span data-ttu-id="42034-567">Учтите, что тома диска D:\ различаются в зависимости от типа виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-567">Be aware D:\ drive volumes are different based on the VM type.</span></span>

<span data-ttu-id="42034-568">Эти конфигурации позволяют tempdb использовать больше пространства, чем может предоставить системный диск.</span><span class="sxs-lookup"><span data-stu-id="42034-568">These configurations enable tempdb to consume more space than the system drive is able to provide.</span></span> <span data-ttu-id="42034-569">Чтобы определить необходимый размер tempdb, можно проверить размеры tempdb в существующих системах, работающих локально.</span><span class="sxs-lookup"><span data-stu-id="42034-569">In order to determine the proper tempdb size, one can check the tempdb sizes on existing systems, which run on-premises.</span></span> <span data-ttu-id="42034-570">Кроме того, такая конфигурация обеспечит такие показатели операций ввода-вывода в tempdb, которые не могут быть предоставлены системным диском.</span><span class="sxs-lookup"><span data-stu-id="42034-570">In addition, such a configuration would enable IOPS numbers against tempdb, which cannot be provided with the system drive.</span></span> <span data-ttu-id="42034-571">Опять же, системы, работающие в локальной среде, можно использовать для мониторинга рабочей нагрузки ввода-вывода в отношении базы данных tempdb, чтобы определить показатели операций ввода-вывода, которые ожидаются в базе данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="42034-571">Again, systems that are running on-premises can be used to monitor I/O workload against tempdb so that you can derive the IOPS numbers you expect to see on your tempdb.</span></span>

<span data-ttu-id="42034-572">Конфигурация виртуальной машины, на которой выполняется SQL Server с базой данных SAP, а данные tempdb и файл журнала tempdb располагаются на диске D:\, выглядит следующим образом.</span><span class="sxs-lookup"><span data-stu-id="42034-572">A VM configuration, which runs SQL Server with an SAP database and where tempdb data and tempdb logfile are placed on the D:\ drive would look like:</span></span>

![Эталонная конфигурация виртуальной машины Azure IaaS для SAP][dbms-guide-figure-300]

<span data-ttu-id="42034-574">Учтите, что размеры диска D:\ различаются в зависимости от типа виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-574">Be aware that the D:\ drive has different sizes dependent on the VM type.</span></span> <span data-ttu-id="42034-575">В зависимости от требований к размеру базы данных tempdb может потребоваться связать файлы данных и журналов tempdb с файлами данных и журналов базы данных SAP в случаях, когда диск D:\ слишком мал.</span><span class="sxs-lookup"><span data-stu-id="42034-575">Dependent on the size requirement of tempdb you might be forced to pair tempdb data and log files with the SAP database data and log files in cases where D:\ drive is too small.</span></span>

#### <a name="formatting-the-disks"></a><span data-ttu-id="42034-576">Форматирование дисков</span><span class="sxs-lookup"><span data-stu-id="42034-576">Formatting the disks</span></span>
<span data-ttu-id="42034-577">Для SQL Server размер блока NTFS для дисков, содержащих файлы данных и журналов SQL Server, должен быть равен 64 КБ.</span><span class="sxs-lookup"><span data-stu-id="42034-577">For SQL Server the NTFS block size for disks containing SQL Server data and log files should be 64K.</span></span> <span data-ttu-id="42034-578">Форматировать диск D:\ нет необходимости.</span><span class="sxs-lookup"><span data-stu-id="42034-578">There is no need to format the D:\ drive.</span></span> <span data-ttu-id="42034-579">Он предварительно отформатирован.</span><span class="sxs-lookup"><span data-stu-id="42034-579">This drive comes pre-formatted.</span></span>

<span data-ttu-id="42034-580">Чтобы при восстановлении или создании баз данных предотвратить инициализацию файлов данных путем обнуления их содержимого, следует убедиться, что контекст пользователя, в котором выполняется служба SQL Server, имеет определенное разрешение.</span><span class="sxs-lookup"><span data-stu-id="42034-580">In order to make sure that the restore or creation of databases is not initializing the data files by zeroing the content of the files, one should make sure that the user context the SQL Server service is running in has a certain permission.</span></span> <span data-ttu-id="42034-581">Обычно эти разрешения имеют пользователи из группы администраторов Windows.</span><span class="sxs-lookup"><span data-stu-id="42034-581">Usually users in the Windows Administrator group have these permissions.</span></span> <span data-ttu-id="42034-582">Если служба SQL Server выполняется в контексте пользователя без прав администратора Windows, необходимо назначить этому пользователю право "Выполнение задач по обслуживанию томов".</span><span class="sxs-lookup"><span data-stu-id="42034-582">If the SQL Server service is run in the user context of non-Windows Administrator user, you need to assign that user the User Right ‘Perform volume maintenance tasks’.</span></span>  <span data-ttu-id="42034-583">Дополнительные сведения см. в следующей статье базы знаний Майкрософт: <https://support.microsoft.com/kb/2574695>.</span><span class="sxs-lookup"><span data-stu-id="42034-583">See the details in this Microsoft Knowledge Base Article: <https://support.microsoft.com/kb/2574695></span></span>

#### <a name="impact-of-database-compression"></a><span data-ttu-id="42034-584">Влияние сжатия базы данных</span><span class="sxs-lookup"><span data-stu-id="42034-584">Impact of database compression</span></span>
<span data-ttu-id="42034-585">В конфигурациях, в которых пропускная способность ввода-вывода может стать ограничивающим фактором, каждая мера, позволяющая сократить объем операций ввода-вывода, помогает растянуть рабочую нагрузку, которую можно запускать в сценарии IaaS, например Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-585">In configurations where I/O bandwidth can become a limiting factor, every measure, which reduces IOPS might help to stretch the workload one can run in an IaaS scenario like Azure.</span></span> <span data-ttu-id="42034-586">Таким образом, если это еще не сделано, применение сжатия PAGE для SQL Server настоятельно рекомендуется как SAP, так и корпорацией Майкрософт перед отправкой существующих баз данных SAP в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-586">Therefore, if not yet done, applying SQL Server PAGE compression is strongly recommended by both SAP and Microsoft before uploading an existing SAP database to Azure.</span></span>

<span data-ttu-id="42034-587">Выполнять сжатие базы данных перед отправкой в Azure рекомендуется по следующим двум причинам:</span><span class="sxs-lookup"><span data-stu-id="42034-587">The recommendation to perform Database Compression before uploading to Azure is given out of two reasons:</span></span>

* <span data-ttu-id="42034-588">Объем отправляемых данных уменьшается.</span><span class="sxs-lookup"><span data-stu-id="42034-588">The amount of data to be uploaded is lower.</span></span>
* <span data-ttu-id="42034-589">Длительность выполнения сжатия сокращается, при условии, что локально можно использовать более мощное оборудование с большим числом ЦП, более высокой пропускной способностью ввода-вывода или меньшими задержками ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-589">The duration of the compression execution is shorter assuming that one can use stronger hardware with more CPUs or higher I/O bandwidth or less I/O latency on-premises.</span></span>
* <span data-ttu-id="42034-590">Уменьшение размеров баз данных может сократить затраты на выделение места на дисках.</span><span class="sxs-lookup"><span data-stu-id="42034-590">Smaller database sizes might lead to less costs for disk allocation</span></span>

<span data-ttu-id="42034-591">Сжатие баз данных работает на виртуальных машинах Azure так же, как и в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-591">Database compression works as well in an Azure Virtual Machines as it does on-premises.</span></span> <span data-ttu-id="42034-592">Дополнительные сведения о том, как сжать существующую базу данных SQL Server для SAP, см. здесь: <https://blogs.msdn.com/b/saponsqlserver/archive/2010/10/08/compressing-an-sap-database-using-report-msscompress.aspx>.</span><span class="sxs-lookup"><span data-stu-id="42034-592">For more details on how to compress an existing SAP SQL Server database, check here: <https://blogs.msdn.com/b/saponsqlserver/archive/2010/10/08/compressing-an-sap-database-using-report-msscompress.aspx></span></span>

### <a name="sql-server-2014--storing-database-files-directly-on-azure-blob-storage"></a><span data-ttu-id="42034-593">SQL Server 2014: хранение файлов базы данных непосредственно в хранилище BLOB-объектов Azure</span><span class="sxs-lookup"><span data-stu-id="42034-593">SQL Server 2014 – Storing Database Files directly on Azure Blob Storage</span></span>
<span data-ttu-id="42034-594">SQL Server 2014 открывает возможность хранить файлы базы данных непосредственно в хранилище BLOB-объектов Azure без создания вокруг них "оболочки" виртуального жесткого диска.</span><span class="sxs-lookup"><span data-stu-id="42034-594">SQL Server 2014 opens the possibility to store database files directly on Azure Blob Store without the ‘wrapper’ of a VHD around them.</span></span> <span data-ttu-id="42034-595">В частности, при использовании виртуальных машин хранилища Azure класса "Стандартный" или меньшего размера это позволяет реализовать сценарии, где можно обойти ограничения операций ввода-вывода, устанавливаемые ограниченным числом дисков, которые можно подключить к некоторым типам небольших виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="42034-595">Especially with using Standard Azure Storage or smaller VM types this enables scenarios where you can overcome the limits of IOPS that would be enforced by a limited number of disks that can be mounted to some smaller VM types.</span></span> <span data-ttu-id="42034-596">Это возможно в случае с пользовательскими базами данных, но не с системными базами данных SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-596">This works for user databases however not for system databases of SQL Server.</span></span> <span data-ttu-id="42034-597">Также это возможно для файлов данных и журналов SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-597">It also works for data and log files of SQL Server.</span></span> <span data-ttu-id="42034-598">Если вы предпочитаете развернуть базу данных SQL Server SAP таким образом, не заключая ее в "оболочку" виртуальных жестких дисков, помните следующее.</span><span class="sxs-lookup"><span data-stu-id="42034-598">If you’d like to deploy an SAP SQL Server database this way instead of ‘wrapping’ it into VHDs, keep the following in mind:</span></span>

* <span data-ttu-id="42034-599">Используемая учетная запись хранения должна располагаться в том же регионе Azure, что и учетная запись, которая использовалась для развертывания виртуальной машины, на которой работает SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-599">The Storage Account used needs to be in the same Azure Region as the one that is used to deploy the VM SQL Server is running in.</span></span>
* <span data-ttu-id="42034-600">К этому методу развертывания также применяются перечисленные выше рекомендации, касающиеся распределения виртуальных жестких дисков по разным учетным записям хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-600">Considerations listed earlier regarding the distribution of VHDs over different Azure Storage Accounts apply for this method of deployments as well.</span></span> <span data-ttu-id="42034-601">Это означает количество операций ввода-вывода относительно ограничений учетной записи хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-601">Means the I/O operations count against the limits of the Azure Storage Account.</span></span>

[comment]: <> (Пользователь MSSedusch: но при этом будет использоваться пропускная способность сети, а не хранилища, не так ли?)

<span data-ttu-id="42034-603">Сведения об этом типе развертывания представлены здесь: <https://docs.microsoft.com/sql/relational-databases/databases/sql-server-data-files-in-microsoft-azure>.</span><span class="sxs-lookup"><span data-stu-id="42034-603">Details about this type of deployment are listed here: <https://docs.microsoft.com/sql/relational-databases/databases/sql-server-data-files-in-microsoft-azure></span></span>

<span data-ttu-id="42034-604">Для хранения файлов данных SQL Server непосредственно в хранилище Azure класса Premium необходима минимальная версия исправления SQL Server 2014, которая описана здесь: <https://support.microsoft.com/kb/3063054>.</span><span class="sxs-lookup"><span data-stu-id="42034-604">In order to store SQL Server data files directly on Azure Premium Storage, you need to have a minimum SQL Server 2014 patch release, which is documented here: <https://support.microsoft.com/kb/3063054>.</span></span> <span data-ttu-id="42034-605">Хранение файлов данных SQL Server в хранилище Azure класса "Стандартный" работает с выпущенной версией SQL Server 2014.</span><span class="sxs-lookup"><span data-stu-id="42034-605">Storing SQL Server data files on Azure Standard Storage does work with the released version of SQL Server 2014.</span></span> <span data-ttu-id="42034-606">Однако те же пакеты исправлений содержат еще один ряд исправлений, которые делают прямое использование хранилища BLOB-объектов Azure для файлов данных и резервных копий SQL Server более надежным.</span><span class="sxs-lookup"><span data-stu-id="42034-606">However, the very same patches contain another series of fixes, which make the direct usage of Azure Blob Storage for SQL Server data files and backups more reliable.</span></span> <span data-ttu-id="42034-607">Поэтому мы, в целом, рекомендуем использовать эти исправления.</span><span class="sxs-lookup"><span data-stu-id="42034-607">Therefore we recommend using these patches in general.</span></span>

### <a name="sql-server-2014-buffer-pool-extension"></a><span data-ttu-id="42034-608">Расширение буферного пула SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="42034-608">SQL Server 2014 Buffer Pool Extension</span></span>
<span data-ttu-id="42034-609">В SQL Server 2014 появилась новая функция, которая называется "Расширение буферного пула".</span><span class="sxs-lookup"><span data-stu-id="42034-609">SQL Server 2014 introduced a new feature, which is called Buffer Pool Extension.</span></span> <span data-ttu-id="42034-610">Эта функция расширяет буферный пул SQL Server, который хранится в памяти, с помощью кэша второго уровня, поддерживаемого локальными твердотельными накопителями сервера или виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-610">This functionality extends the buffer pool of SQL Server, which is kept in memory with a second level cache that is backed by local SSDs of a server or VM.</span></span> <span data-ttu-id="42034-611">Это позволяет поддерживать в памяти рабочий набор данных большего размера.</span><span class="sxs-lookup"><span data-stu-id="42034-611">This enables to keep a larger working set of data ‘in memory’.</span></span> <span data-ttu-id="42034-612">По сравнению с доступом к хранилищу Azure класса "Стандартный" доступ к расширению буферного пула, который хранится на локальных твердотельных накопителях виртуальной машины Azure, предоставляется во много раз быстрее.</span><span class="sxs-lookup"><span data-stu-id="42034-612">Compared to accessing Azure Standard Storage the access into the extension of the buffer pool, which is stored on local SSDs of an Azure VM is many factors faster.</span></span>  <span data-ttu-id="42034-613">Таким образом, использование локального диска D:\ таких типов виртуальных машин, которые обладают отличными показателями операций ввода-вывода и пропускной способности, может быть весьма разумным способом снизить нагрузку операций ввода-вывода на хранилище Azure и значительно улучшить время отклика на запросы.</span><span class="sxs-lookup"><span data-stu-id="42034-613">Therefore, leveraging the local D:\ drive of the VM types that have excellent IOPS and throughput could be a very reasonable way to reduce the IOPS load against Azure Storage and improve response times of queries dramatically.</span></span> <span data-ttu-id="42034-614">Это применимо особенно в том случае, если хранилище класса Premium не используется.</span><span class="sxs-lookup"><span data-stu-id="42034-614">This applies especially when not using Premium Storage.</span></span> <span data-ttu-id="42034-615">В случае с хранилищем класса Premium и использованием кэша чтения Azure Premium на вычислительном узле (что рекомендуется для файлов данных) существенных различий быть не должно.</span><span class="sxs-lookup"><span data-stu-id="42034-615">In case of Premium Storage and the usage of the Premium Azure Read Cache on the compute node, as recommended for data files, no significant differences are expected.</span></span> <span data-ttu-id="42034-616">Причина в том, что оба кэша (расширение буферного пула для SQL Server и кэш чтения хранилища класса Premium) используют локальные диски вычислительных узлов.</span><span class="sxs-lookup"><span data-stu-id="42034-616">Reason is that both caches (SQL Server Buffer Pool Extension and Premium Storage Read Cache) are using the local disks of the compute nodes.</span></span>
<span data-ttu-id="42034-617">Дополнительные сведения об этих возможностях см. в этой документации: <https://docs.microsoft.com/sql/database-engine/configure-windows/buffer-pool-extension>.</span><span class="sxs-lookup"><span data-stu-id="42034-617">For more details about this functionality, check this documentation: <https://docs.microsoft.com/sql/database-engine/configure-windows/buffer-pool-extension></span></span> 

### <a name="backuprecovery-considerations-for-sql-server"></a><span data-ttu-id="42034-618">Рекомендации по резервному копированию и восстановлению для SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-618">Backup/Recovery considerations for SQL Server</span></span>
<span data-ttu-id="42034-619">При развертывании SQL Server в Azure методику резервного копирования необходимо пересмотреть.</span><span class="sxs-lookup"><span data-stu-id="42034-619">When deploying SQL Server into Azure your backup methodology must be reviewed.</span></span> <span data-ttu-id="42034-620">Даже если система не используется для производственных задач, необходимо периодически производить резервное копирование базы данных SAP, размещенной на сервере SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-620">Even if the system is not a productive system, the SAP database hosted by SQL Server must be backed up periodically.</span></span> <span data-ttu-id="42034-621">Так как в службе хранилища Azure хранятся три образа, резервное копирование становится менее важным с точки зрения восстановления хранилища после сбоя.</span><span class="sxs-lookup"><span data-stu-id="42034-621">Since Azure Storage keeps three images, a backup is now less important in respect to compensating a storage crash.</span></span> <span data-ttu-id="42034-622">Основная причина соблюдения надлежащего плана резервного копирования и восстановления состоит в том, что, имея возможность восстановить состояние на определенный момент времени, вы можете исправлять логические или пользовательские ошибки.</span><span class="sxs-lookup"><span data-stu-id="42034-622">The priority reason for maintaining a proper backup and recovery plan is more that you can compensate for logical/manual errors by providing point in time recovery capabilities.</span></span> <span data-ttu-id="42034-623">Следовательно, резервные копии используются для восстановления состояния базы данных на определенный момент времени или для создания другой системы в Azure путем копирования существующей базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-623">So the goal is to either use backups to restore the database back to a certain point in time or to use the backups in Azure to seed another system by copying the existing database.</span></span> <span data-ttu-id="42034-624">Например, с помощью восстановления из резервной копии вы можете перейти от двухуровневой конфигурации SAP к трехуровневой для той же системы.</span><span class="sxs-lookup"><span data-stu-id="42034-624">For example, you could transfer from a 2-Tier SAP configuration to a 3-Tier system setup of the same system by restoring a backup.</span></span>

<span data-ttu-id="42034-625">Существует три разных способа резервного копирования SQL Server в хранилище Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-625">There are three different ways to backup SQL Server to Azure Storage:</span></span>

1. <span data-ttu-id="42034-626">SQL Server 2012 CU4 и более поздних версий может собственными средствами выполнять резервное копирование баз данных на URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="42034-626">SQL Server 2012 CU4 and higher can natively backup databases to a URL.</span></span> <span data-ttu-id="42034-627">Подробное описание см. в блоге [New functionality in SQL Server 2014 — Part 5 — Backup/Restore Enhancements](https://blogs.msdn.com/b/saponsqlserver/archive/2014/02/15/new-functionality-in-sql-server-2014-part-5-backup-restore-enhancements.aspx) (Новые функциональные возможности SQL Server 2014. Часть 5: усовершенствования архивации и восстановления).</span><span class="sxs-lookup"><span data-stu-id="42034-627">This is detailed in the blog [New functionality in SQL Server 2014 – Part 5 – Backup/Restore Enhancements](https://blogs.msdn.com/b/saponsqlserver/archive/2014/02/15/new-functionality-in-sql-server-2014-part-5-backup-restore-enhancements.aspx).</span></span> <span data-ttu-id="42034-628">Ознакомьтесь с разделом [SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 4 (CU4) и последующие выпуски][dbms-guide-5.5.1].</span><span class="sxs-lookup"><span data-stu-id="42034-628">See chapter [SQL Server 2012 SP1 CU4 and later][dbms-guide-5.5.1].</span></span>
2. <span data-ttu-id="42034-629">Выпуски SQL Server до SQL 2012 CU4 могут использовать функцию перенаправления для резервного копирования на виртуальный жесткий диск и по сути перемещать поток записи к расположению хранилища Azure, которое было настроено.</span><span class="sxs-lookup"><span data-stu-id="42034-629">SQL Server releases prior to SQL 2012 CU4 can use a redirection functionality to backup to a VHD and basically move the write stream towards an Azure Storage location that has been configured.</span></span> <span data-ttu-id="42034-630">Ознакомьтесь с разделом [SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 3 (CU3) и предыдущие выпуски][dbms-guide-5.5.2].</span><span class="sxs-lookup"><span data-stu-id="42034-630">See chapter [SQL Server 2012 SP1 CU3 and earlier releases][dbms-guide-5.5.2].</span></span>
3. <span data-ttu-id="42034-631">Последний метод — применение обычной команды резервного копирования SQL Server на диск к устройству диска.</span><span class="sxs-lookup"><span data-stu-id="42034-631">The final method is to perform a conventional SQL Server backup to disk command onto a disk device.</span></span> <span data-ttu-id="42034-632">Это идентично схеме локального развертывания и не рассматривается в данном документе подробно.</span><span class="sxs-lookup"><span data-stu-id="42034-632">This is identical to the on-premises deployment pattern and is not discussed in detail in this document.</span></span>

#### <span data-ttu-id="42034-633"><a name="0fef0e79-d3fe-4ae2-85af-73666a6f7268"></a>SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 4 (CU4) и последующие выпуски</span><span class="sxs-lookup"><span data-stu-id="42034-633"><a name="0fef0e79-d3fe-4ae2-85af-73666a6f7268"></a>SQL Server 2012 SP1 CU4 and later</span></span>
<span data-ttu-id="42034-634">Эта функция позволяет выполнять резервное копирование непосредственно в хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-634">This functionality allows you to directly backup to Azure BLOB storage.</span></span> <span data-ttu-id="42034-635">Без этого метода резервное копирование следует выполнять на другие диски. В таком случае будет использоваться емкость операций ввода-вывода и дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-635">Without this method, you must backup to other disks, which would consume disk and IOPS capacity.</span></span> <span data-ttu-id="42034-636">Идея заключается в следующем:</span><span class="sxs-lookup"><span data-stu-id="42034-636">The idea is basically this:</span></span>

 ![Резервное копирование с SQL Server 2012 в хранилище BLOB-объектов Microsoft Azure][dbms-guide-figure-400]

<span data-ttu-id="42034-638">Преимущество в этом случае состоит в том, что не нужно тратить пространство дисков на хранение резервных копий SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-638">The advantage in this case is that one doesn’t need to spend disks to store SQL Server backups on.</span></span> <span data-ttu-id="42034-639">Поэтому можно выделить меньше дисков и использовать всю пропускную способность их операций ввода-вывода для файлов данных и журналов.</span><span class="sxs-lookup"><span data-stu-id="42034-639">So you have fewer disks allocated and the whole bandwidth of disk IOPS can be used for data and log files.</span></span> <span data-ttu-id="42034-640">Обратите внимание, что максимальный размер резервной копии ограничен 1 ТБ, как описано в разделе "Ограничения" этой статьи: <https://docs.microsoft.com/sql/relational-databases/backup-restore/sql-server-backup-to-url#limitations>.</span><span class="sxs-lookup"><span data-stu-id="42034-640">Note that the maximum size of a backup is limited to a maximum of 1 TB as documented in the section ‘Limitations’ in this article: <https://docs.microsoft.com/sql/relational-databases/backup-restore/sql-server-backup-to-url#limitations>.</span></span> <span data-ttu-id="42034-641">Если, несмотря на использование сжатия резервных копий SQL Server, размер резервной копии превышает 1 ТБ, то необходимо использовать функциональные возможности, описанные в разделе [SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 3 (CU3) и предыдущие выпуски][dbms-guide-5.5.2] этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-641">If the backup size, despite using SQL Server Backup compression would exceed 1 TB in size, the functionality described in chapter [SQL Server 2012 SP1 CU3 and earlier releases][dbms-guide-5.5.2] in this document needs to be used.</span></span>

<span data-ttu-id="42034-642">В [связанной документации](https://docs.microsoft.com/sql/relational-databases/backup-restore/restoring-from-backups-stored-in-microsoft-azure), в которой описано восстановление баз данных из резервных копий в хранилище BLOB-объектов Azure, рекомендуется не выполнять восстановление непосредственно из хранилища BLOB-объектов Azure, если размер резервных копий превышает 25 ГБ.</span><span class="sxs-lookup"><span data-stu-id="42034-642">[Related documentation](https://docs.microsoft.com/sql/relational-databases/backup-restore/restoring-from-backups-stored-in-microsoft-azure) describing the restore of databases from backups against Azure Blob Store recommend not to restore directly from Azure BLOB store if the backup is >25GB.</span></span> <span data-ttu-id="42034-643">Рекомендации в данной статье основаны просто на соображениях производительности, а не на функциональных ограничениях.</span><span class="sxs-lookup"><span data-stu-id="42034-643">The recommendation in this article is simply based on performance considerations and not due to functional restrictions.</span></span> <span data-ttu-id="42034-644">Поэтому для разных случаев могут применяться разные условия.</span><span class="sxs-lookup"><span data-stu-id="42034-644">Therefore, different conditions may apply on a case by case basis.</span></span>

<span data-ttu-id="42034-645">Документацию по настройке и использованию преимуществ этого типа архивации можно найти в [этом](https://docs.microsoft.com/sql/relational-databases/tutorial-use-azure-blob-storage-service-with-sql-server-2016) учебнике.</span><span class="sxs-lookup"><span data-stu-id="42034-645">Documentation on how this type of backup is set up and leveraged can be found in [this](https://docs.microsoft.com/sql/relational-databases/tutorial-use-azure-blob-storage-service-with-sql-server-2016) tutorial</span></span>

<span data-ttu-id="42034-646">Пример последовательности действий приведен [здесь](https://docs.microsoft.com/sql/relational-databases/backup-restore/sql-server-backup-to-url).</span><span class="sxs-lookup"><span data-stu-id="42034-646">An example of the sequence of steps can be read [here](https://docs.microsoft.com/sql/relational-databases/backup-restore/sql-server-backup-to-url).</span></span>

<span data-ttu-id="42034-647">При автоматизации резервного копирования важнее всего обеспечить различия в именовании BLOB-объектов для каждой резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-647">Automating backups, it is of highest importance to make sure that the BLOBs for each backup are named differently.</span></span> <span data-ttu-id="42034-648">В противном случае они будут перезаписаны, и цепочка восстановления разорвется.</span><span class="sxs-lookup"><span data-stu-id="42034-648">Otherwise they are overwritten and the restore chain is broken.</span></span>

<span data-ttu-id="42034-649">Чтобы не перепутать три разных типа резервных копий, рекомендуется создать разные контейнеры в учетной записи хранения, используемой для резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-649">In order not to mix up things between the three different types of backups, it is advisable to create different containers underneath the storage account used for backups.</span></span> <span data-ttu-id="42034-650">Тип контейнера может предполагать хранение только виртуальных машин или виртуальных машин и резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-650">The containers could be by VM only or by VM and Backup type.</span></span> <span data-ttu-id="42034-651">Схема может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="42034-651">The schema could look like:</span></span>

 ![Резервное копирование с SQL Server 2012 в хранилище BLOB-объектов Microsoft Azure. Разные контейнеры в отдельной учетной записи хранения][dbms-guide-figure-500]

<span data-ttu-id="42034-653">В приведенном выше примере резервное копирование не будет выполняться в ту же учетную запись хранения, где развернуты виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="42034-653">In the example above, the backups would not be performed into the same storage account where the VMs are deployed.</span></span> <span data-ttu-id="42034-654">Для резервных копий будет специально создана новая учетная запись хранения.</span><span class="sxs-lookup"><span data-stu-id="42034-654">There would be a new storage account specifically for the backups.</span></span> <span data-ttu-id="42034-655">В учетной записи хранения будет создано несколько контейнеров для разных типов резервных копий. Эти контейнеры будут связаны с определенной виртуальной машиной.</span><span class="sxs-lookup"><span data-stu-id="42034-655">Within the storage accounts, there would be different containers created with a matrix of the type of backup and the VM name.</span></span> <span data-ttu-id="42034-656">Такая сегментация упрощает администрирование резервных копий разных виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="42034-656">Such segmentation makes it easier to administrate the backups of the different VMs.</span></span>

<span data-ttu-id="42034-657">Большие двоичные объекты, в которые непосредственно записываются резервные копии, не увеличивают количество дисков данных виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-657">The BLOBs one directly writes the backups to, are not adding to the count of the data disks of a VM.</span></span> <span data-ttu-id="42034-658">Следовательно, можно использовать максимум дисков данных, подключенных к конкретной SKU виртуальной машины, для файлов данных и журнала транзакций и при этом выполнять резервное копирование в контейнер хранилища.</span><span class="sxs-lookup"><span data-stu-id="42034-658">Hence one could maximize the maximum of data disks mounted of the specific VM SKU for the data and transaction log file and still execute a backup against a storage container.</span></span> 

#### <span data-ttu-id="42034-659"><a name="f9071eff-9d72-4f47-9da4-1852d782087b"></a>SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 3 (CU3) и предыдущие выпуски</span><span class="sxs-lookup"><span data-stu-id="42034-659"><a name="f9071eff-9d72-4f47-9da4-1852d782087b"></a>SQL Server 2012 SP1 CU3 and earlier releases</span></span>
<span data-ttu-id="42034-660">Первый шаг, который необходимо выполнить для архивации непосредственно в службе хранилища Azure, — скачать MSI-файл, который связан с [этой](https://www.microsoft.com/download/details.aspx?id=40740) статьей базы знаний.</span><span class="sxs-lookup"><span data-stu-id="42034-660">The first step you must perform in order to achieve a backup directly against Azure Storage would be to download the msi, which is linked to [this](https://www.microsoft.com/download/details.aspx?id=40740) KBA article.</span></span>

<span data-ttu-id="42034-661">Скачайте 64-разрядный файл установки и документацию.</span><span class="sxs-lookup"><span data-stu-id="42034-661">Download the x64 installation file and the documentation.</span></span> <span data-ttu-id="42034-662">Этот файл устанавливает программу под названием Microsoft SQL Server Backup to Microsoft Azure Tool.</span><span class="sxs-lookup"><span data-stu-id="42034-662">The file installs a program called: ‘Microsoft SQL Server Backup to Microsoft Azure Tool’.</span></span> <span data-ttu-id="42034-663">Внимательно прочитайте документацию по продукту.</span><span class="sxs-lookup"><span data-stu-id="42034-663">Read the documentation of the product thoroughly.</span></span>  <span data-ttu-id="42034-664">По сути это средство работает следующим образом.</span><span class="sxs-lookup"><span data-stu-id="42034-664">The tool basically works in the following way:</span></span>

* <span data-ttu-id="42034-665">Со стороны SQL Server определяется расположение резервной копии SQL Server на диске (не используйте для этого диск D:\).</span><span class="sxs-lookup"><span data-stu-id="42034-665">From the SQL Server side, a disk location for the SQL Server backup is defined (don’t use the D:\ drive for this).</span></span>
* <span data-ttu-id="42034-666">Этот инструмент позволяет определить правила, которые могут использоваться для направления разных типов резервных копий в разные контейнеры хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-666">The tool allows you to define rules, which can be used to direct different types of backups to different Azure Storage containers.</span></span>
* <span data-ttu-id="42034-667">После определения правил инструмент направляет поток записи резервной копии на один из дисков или виртуальных жестких дисков в расположение хранилища Azure, заданное ранее.</span><span class="sxs-lookup"><span data-stu-id="42034-667">Once the rules are in place, the tool redirects the write stream of the backup to one of the VHDs/disks to the Azure Storage location, which was defined earlier.</span></span>
* <span data-ttu-id="42034-668">Инструмент оставляет небольшой файл-заглушку размером в несколько килобайт на диске или виртуальном жестком диске, который был определен для резервной копии SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-668">The tool leaves a small stub file of a few KB size on the VHD/Disk, which was defined for the SQL Server backup.</span></span> <span data-ttu-id="42034-669">**Этот файл следует оставить в хранилище, так как он потребуется для восстановления из хранилища Azure.**</span><span class="sxs-lookup"><span data-stu-id="42034-669">**This file should be left on the storage location since it is required to restore again from Azure Storage.**</span></span>
  * <span data-ttu-id="42034-670">Если вы потеряли файл-заглушку (например, утрачен носитель, содержащий файл-заглушку) и выбрали вариант резервного копирования в учетную запись хранилища Microsoft Azure, файл-заглушку можно восстановить из хранилища Microsoft Azure, загрузив его из контейнера хранилища, в который он был помещен.</span><span class="sxs-lookup"><span data-stu-id="42034-670">If you have lost the stub file (for example through loss of the storage media that contained the stub file) and you have chosen the option of backing up to a Microsoft Azure Storage account, you may recover the stub file through Microsoft Azure Storage by downloading it from the storage container in which it was placed.</span></span> <span data-ttu-id="42034-671">Затем файл-заглушку следует поместить в папку на локальном компьютере, в которой данное средство настроено на обнаружение и отправку того же контейнера с тем же паролем шифрования, если в исходном правиле применялось шифрование.</span><span class="sxs-lookup"><span data-stu-id="42034-671">You should then place the stub file into a folder on the local machine where the Tool is configured to detect and upload to the same container with the same encryption password if encryption was used with the original rule.</span></span> 

<span data-ttu-id="42034-672">Это означает, что описанная выше схема для последних версий SQL Server может быть реализована и для тех версий SQL Server, которые не разрешают непосредственно обращаться к расположению хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-672">This means the schema as described above for more recent releases of SQL Server can be put in place as well for SQL Server releases, which are not allowing direct address an Azure Storage location.</span></span>

<span data-ttu-id="42034-673">Этот способ не следует использовать с более новыми версиями SQL Server, которые изначально поддерживают резервное копирование в хранилище Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-673">This method should not be used with more recent SQL Server releases, which support backing up natively against Azure Storage.</span></span> <span data-ttu-id="42034-674">Исключениями являются случаи, когда ограничения встроенного резервного копирования в Azure блокируют его выполнение.</span><span class="sxs-lookup"><span data-stu-id="42034-674">Exceptions are where limitations of the native backup into Azure are blocking native backup execution into Azure.</span></span>

#### <a name="other-possibilities-to-backup-sql-server-databases"></a><span data-ttu-id="42034-675">Альтернативные способы резервного копирования баз данных SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-675">Other possibilities to backup SQL Server databases</span></span>
<span data-ttu-id="42034-676">Альтернативным способом резервного копирования баз данных является подключение дополнительных дисков данных к виртуальной машине, которая используется для хранения резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-676">Other possibilities to backup databases is to attach additional data disks to a VM that you use to store backups on.</span></span> <span data-ttu-id="42034-677">В таком случае необходимо убедиться, что диски не переполняются.</span><span class="sxs-lookup"><span data-stu-id="42034-677">In such a case, you would need to make sure that the disks are not running full.</span></span> <span data-ttu-id="42034-678">Если это так, необходимо отключить диск, "архивировать" его и заменить новым пустым диском.</span><span class="sxs-lookup"><span data-stu-id="42034-678">If that is the case, you would need to unmount the disks and so to speak ‘archive’ it and replace it with a new empty disk.</span></span> <span data-ttu-id="42034-679">При использовании этого способа возникнет необходимость хранить такие виртуальные жесткие диски в отдельных учетных записях хранения Azure, отличающихся от учетных записей, содержащих виртуальные жесткие диски с файлами базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-679">If you go down that path, you want to keep these VHDs in separate Azure Storage Accounts from the ones that the VHDs with the database files.</span></span>

<span data-ttu-id="42034-680">Еще один способ — использовать виртуальную машину большого размера, к которой можно подключить множество дисков, например виртуальную машину D14 с 32 виртуальными жесткими дисками.</span><span class="sxs-lookup"><span data-stu-id="42034-680">A second possibility is to use a large VM that can have many disks attached, for example a D14 with 32VHDs.</span></span> <span data-ttu-id="42034-681">Дисковые пространства позволяют построить гибкую среду, где можно создавать общие папки, которые затем будут использоваться как целевые папки резервного копирования для разных серверов СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-681">Use Storage Spaces to build a flexible environment where you could build shares that are used then as backup targets for the different DBMS servers.</span></span>

<span data-ttu-id="42034-682">Некоторые практические рекомендации также описаны [здесь](https://blogs.msdn.com/b/sqlcat/archive/2015/02/26/large-sql-server-database-backup-on-an-azure-vm-and-archiving.aspx) .</span><span class="sxs-lookup"><span data-stu-id="42034-682">Some best practices got documented [here](https://blogs.msdn.com/b/sqlcat/archive/2015/02/26/large-sql-server-database-backup-on-an-azure-vm-and-archiving.aspx) as well.</span></span> 

#### <a name="performance-considerations-for-backupsrestores"></a><span data-ttu-id="42034-683">Рекомендации по ускорению резервного копирования и восстановления</span><span class="sxs-lookup"><span data-stu-id="42034-683">Performance considerations for backups/restores</span></span>
<span data-ttu-id="42034-684">Как и при развертывании на сервер без операционной системы, скорость резервного копирования и восстановления зависит от количества томов, которые могут считываться параллельно, а также от пропускной способности этих томов.</span><span class="sxs-lookup"><span data-stu-id="42034-684">As in bare-metal deployments, backup/restore performance is dependent on how many volumes can be read in parallel and what the throughput of those volumes might be.</span></span> <span data-ttu-id="42034-685">Кроме того, загрузка ЦП при сжатии резервной копии может играть значительную роль на виртуальных машинах, имеющих не более восьми потоков ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-685">In addition, the CPU consumption used by backup compression may play a significant role on VMs with just up to eight CPU threads.</span></span> <span data-ttu-id="42034-686">Исходя из сказанного выше, можно сделать следующие выводы.</span><span class="sxs-lookup"><span data-stu-id="42034-686">Therefore, one can assume:</span></span>

* <span data-ttu-id="42034-687">Чем меньше дисков используется для хранения файлов данных, тем меньше общая пропускная способность при чтении.</span><span class="sxs-lookup"><span data-stu-id="42034-687">The fewer the number of disks used to store the data files, the smaller the overall throughput in reading.</span></span>
* <span data-ttu-id="42034-688">Чем меньше потоков ЦП на виртуальной машине, тем сильнее влияние сжатия резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-688">The smaller the number of CPU threads in the VM, the more severe the impact of backup compression.</span></span>
* <span data-ttu-id="42034-689">Чем меньше целевых объектов (BLOB-объектов, виртуальных жестких дисков или дисков), на которые записываются резервные копии, тем меньше пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="42034-689">The fewer targets (BLOBs, VHDs, or disks) to write the backup to, the lesser the throughput.</span></span>
* <span data-ttu-id="42034-690">Чем меньше размер виртуальной машины, тем меньше квота пропускной способности хранилища для записи и чтения из хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-690">The smaller the VM size, the smaller the storage throughput quota writing and reading from Azure Storage.</span></span> <span data-ttu-id="42034-691">Это не зависит от того, где хранятся резервные копии — непосредственно в BLOB-объектах Azure или на виртуальных жестких дисках, которые в свою очередь хранятся в BLOB-объектах Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-691">Independent of whether the backups are directly stored on Azure Blob or whether they are stored in VHDs that again are stored in Azure Blobs.</span></span>

<span data-ttu-id="42034-692">При использовании BLOB-объекта хранилища Microsoft Azure в качестве целевого объекта резервного копирования в последних версиях можно назначить только один целевой URL-адрес для каждой конкретной резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-692">When using a Microsoft Azure Storage BLOB as the backup target in more recent releases, you are restricted to designating only one URL target for each specific backup.</span></span>

<span data-ttu-id="42034-693">Однако при использовании средства Microsoft SQL Server Backup to Microsoft Azure Tool в предыдущих версиях можно определить несколько целевых расположений для файлов.</span><span class="sxs-lookup"><span data-stu-id="42034-693">But when using the ‘Microsoft SQL Server Backup to Microsoft Azure Tool’ in older releases, you can define more than one file target.</span></span> <span data-ttu-id="42034-694">При наличии нескольких целевых папок резервное копирование можно масштабировать, а его пропускная способность увеличивается.</span><span class="sxs-lookup"><span data-stu-id="42034-694">With more than one target, the backup can scale and the throughput of the backup is higher.</span></span> <span data-ttu-id="42034-695">В результате в учетной записи службы хранилища Azure также появится несколько файлов.</span><span class="sxs-lookup"><span data-stu-id="42034-695">This would result then in multiple files as well in the Azure Storage account.</span></span> <span data-ttu-id="42034-696">В ходе тестирования оказалось, что использование нескольких целевых папок для файлов определенно позволяет достичь пропускной способности, которая достигается с помощью расширений резервного копирования, впервые реализованных в версии SQL Server 2012 с пакетом обновления 1 (SP1) и накопительным пакетом 4 (CU4).</span><span class="sxs-lookup"><span data-stu-id="42034-696">In our testing, using multiple file destinations one can definitely achieve the throughput, which one could achieve with the backup extensions implemented in from SQL Server 2012 SP1 CU4 on.</span></span> <span data-ttu-id="42034-697">Также отсутствует ограничение в 1 ТБ, присущее встроенной функции резервного копирования Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-697">You also are not blocked by the 1TB limit as in the native backup into Azure.</span></span>

<span data-ttu-id="42034-698">При этом следует помнить, что пропускная способность также зависит от расположения учетной записи службы хранения Azure, которая используется для резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="42034-698">However, keep in mind, the throughput also is dependent on the location of the Azure Storage Account you use for the backup.</span></span> <span data-ttu-id="42034-699">Хорошей идеей будет использовать учетную запись хранения, расположенную не в том же регионе, в котором запущены виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="42034-699">An idea might be to locate the storage account in a different region than the VMs are running in.</span></span> <span data-ttu-id="42034-700">Например, виртуальная машина может быть расположена в Западной Европе, а учетная запись хранения, используемая для резервного копирования, — в Северной Европе.</span><span class="sxs-lookup"><span data-stu-id="42034-700">For example you would run the VM configuration in West-Europe, but put the Storage Account that you use to back up against in North-Europe.</span></span> <span data-ttu-id="42034-701">Безусловно, это окажет влияние на пропускную способность резервного копирования: вам, скорее всего, не удастся достичь пропускной способности в 150 МБ/с, которая возможна, когда целевое хранилище и виртуальные машины работают в одном и том же региональном центре обработки данных.</span><span class="sxs-lookup"><span data-stu-id="42034-701">That certainly has an impact on the backup throughput and is not likely to generate a throughput of 150MB/sec as it seems to be possible in cases where the target storage and the VMs are running in the same regional datacenter.</span></span>

#### <a name="managing-backup-blobs"></a><span data-ttu-id="42034-702">Управление BLOB-объектами при резервном копировании</span><span class="sxs-lookup"><span data-stu-id="42034-702">Managing Backup BLOBs</span></span>
<span data-ttu-id="42034-703">Резервными копиями пользователь должен управлять самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="42034-703">There is a requirement to manage the backups on your own.</span></span> <span data-ttu-id="42034-704">При частом резервном копировании журнала транзакций создается множество больших двоичных объектов, поэтому администрирование этих объектов может легко перегрузить портал Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-704">Since the expectation is that many blobs are created by executing frequent transaction log backups, administration of those blobs easily can overburden the Azure portal.</span></span> <span data-ttu-id="42034-705">Поэтому рекомендуется использовать обозреватель хранилищ Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-705">Therefore, it is recommendable to leverage an Azure storage explorer.</span></span> <span data-ttu-id="42034-706">Доступно несколько хороших обозревателей, которые помогают управлять учетной записью хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-706">There are several good ones available, which can help to manage an Azure storage account</span></span>

* <span data-ttu-id="42034-707">Microsoft Visual Studio с установленным пакетом SDK для Azure (<https://azure.microsoft.com/downloads/>).</span><span class="sxs-lookup"><span data-stu-id="42034-707">Microsoft Visual Studio with Azure SDK installed (<https://azure.microsoft.com/downloads/>)</span></span>
* <span data-ttu-id="42034-708">Обозреватель службы хранилища Microsoft Azure (<https://azure.microsoft.com/downloads/>).</span><span class="sxs-lookup"><span data-stu-id="42034-708">Microsoft Azure Storage Explorer (<https://azure.microsoft.com/downloads/>)</span></span>
* <span data-ttu-id="42034-709">Инструменты сторонних производителей</span><span class="sxs-lookup"><span data-stu-id="42034-709">Third party tools</span></span>

<span data-ttu-id="42034-710">Дополнительные сведения о реализации архивации и SAP в Azure см. в [руководстве по архивации SAP](sap-hana-backup-guide.md).</span><span class="sxs-lookup"><span data-stu-id="42034-710">For a more complete discussion of Backup and SAP on Azure, refer to [the SAP Backup Guide](sap-hana-backup-guide.md) for more information.</span></span>

### <span data-ttu-id="42034-711"><a name="1b353e38-21b3-4310-aeb6-a77e7c8e81c8"></a>Использование образов SQL Server из Microsoft Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="42034-711"><a name="1b353e38-21b3-4310-aeb6-a77e7c8e81c8"></a>Using a SQL Server image out of the Microsoft Azure Marketplace</span></span>
<span data-ttu-id="42034-712">Корпорация Майкрософт размещает в Azure Marketplace виртуальные машины, которые уже содержат версии SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-712">Microsoft offers VMs in the Azure Marketplace, which already contain versions of SQL Server.</span></span> <span data-ttu-id="42034-713">Следовательно, клиенты SAP, которым нужны лицензии на SQL Server и Windows, могут удовлетворить потребность в лицензиях, развертывая виртуальные машины с уже установленной средой SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-713">For SAP customers who require licenses for SQL Server and Windows, this might be an opportunity to basically cover the need for licenses by spinning up VMs with SQL Server already installed.</span></span> <span data-ttu-id="42034-714">Чтобы использовать такие образы для SAP, необходимо учитывать следующие факторы.</span><span class="sxs-lookup"><span data-stu-id="42034-714">In order to use such images for SAP, the following considerations need to be made:</span></span>

* <span data-ttu-id="42034-715">Неознакомительные версии SQL Server стоят дороже, чем обычная виртуальная машина "только для Windows", развернутая из Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="42034-715">The SQL Server non-Evaluation versions acquire higher costs than just a ‘Windows-only’ VM deployed from Azure Marketplace.</span></span> <span data-ttu-id="42034-716">Сравнение цен см. в этих статьях: <https://azure.microsoft.com/pricing/details/virtual-machines/windows/> и <https://azure.microsoft.com/pricing/details/virtual-machines/sql-server-enterprise/>.</span><span class="sxs-lookup"><span data-stu-id="42034-716">See these articles to compare prices: <https://azure.microsoft.com/pricing/details/virtual-machines/windows/> and <https://azure.microsoft.com/pricing/details/virtual-machines/sql-server-enterprise/>.</span></span> 
* <span data-ttu-id="42034-717">Использовать можно только те выпуски SQL Server, которые поддерживаются SAP, например SQL Server 2012.</span><span class="sxs-lookup"><span data-stu-id="42034-717">You only can use SQL Server releases, which are supported by SAP, like SQL Server 2012.</span></span>
* <span data-ttu-id="42034-718">Параметры сортировки экземпляра SQL Server, который устанавливается на виртуальных машинах из Azure Marketplace, не соответствуют параметрам, необходимым SAP NetWeaver для запуска экземпляра SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-718">The collation of the SQL Server instance, which is installed in the VMs offered in the Azure Marketplace is not the collation SAP NetWeaver requires the SQL Server instance to run.</span></span> <span data-ttu-id="42034-719">Параметры сортировки можно изменить, выполнив инструкции из следующего раздела.</span><span class="sxs-lookup"><span data-stu-id="42034-719">You can change the collation though with the directions in the following section.</span></span>

#### <a name="changing-the-sql-server-collation-of-a-microsoft-windowssql-server-vm"></a><span data-ttu-id="42034-720">Изменение параметров сортировки SQL Server на виртуальной машине с Microsoft Windows и SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-720">Changing the SQL Server Collation of a Microsoft Windows/SQL Server VM</span></span>
<span data-ttu-id="42034-721">Так как в образах SQL Server в Azure Marketplace не настроено использование параметров сортировки, необходимых для приложений SAP NetWeaver, их необходимо изменить сразу же после развертывания.</span><span class="sxs-lookup"><span data-stu-id="42034-721">Since the SQL Server images in the Azure Marketplace are not set up to use the collation, which is required by SAP NetWeaver applications, it needs to be changed immediately after the deployment.</span></span> <span data-ttu-id="42034-722">Для SQL Server 2012 это можно сделать с помощью следующих действий сразу после того, как виртуальная машина будет развернута и администратор сможет выполнить в нее вход.</span><span class="sxs-lookup"><span data-stu-id="42034-722">For SQL Server 2012, this can be done with the following steps as soon as the VM has been deployed and an administrator is able to log into the deployed VM:</span></span>

* <span data-ttu-id="42034-723">Откройте окно командной строки Windows с правами администратора.</span><span class="sxs-lookup"><span data-stu-id="42034-723">Open a Windows Command Window ‘as administrator’.</span></span>
* <span data-ttu-id="42034-724">Перейдите в каталог C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\SQLServer2012.</span><span class="sxs-lookup"><span data-stu-id="42034-724">Change the directory to C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\SQLServer2012.</span></span>
* <span data-ttu-id="42034-725">Выполните команду: Setup.exe /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=MSSQLSERVER /SQLSYSADMINACCOUNTS=`<local_admin_account_name`> /SQLCOLLATION=SQL_Latin1_General_Cp850_BIN2</span><span class="sxs-lookup"><span data-stu-id="42034-725">Execute the command: Setup.exe /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=MSSQLSERVER /SQLSYSADMINACCOUNTS=`<local_admin_account_name`> /SQLCOLLATION=SQL_Latin1_General_Cp850_BIN2</span></span>   
  * <span data-ttu-id="42034-726">`<local_admin_account_name`> — это учетная запись, которая была определена как учетная запись администратора при развертывании виртуальной машины в первый раз с помощью коллекции.</span><span class="sxs-lookup"><span data-stu-id="42034-726">`<local_admin_account_name`> is the account, which was defined as the administrator account when deploying the VM for the first time through the gallery.</span></span>

<span data-ttu-id="42034-727">Процесс должен занять только несколько минут.</span><span class="sxs-lookup"><span data-stu-id="42034-727">The process should only take a few minutes.</span></span> <span data-ttu-id="42034-728">Чтобы проверить, завершился ли этот шаг правильным результатом, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="42034-728">In order to make sure whether the step ended up with the correct result, perform the following steps:</span></span>

* <span data-ttu-id="42034-729">Откройте среду SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="42034-729">Open SQL Server Management Studio.</span></span>
* <span data-ttu-id="42034-730">Откройте окно запроса.</span><span class="sxs-lookup"><span data-stu-id="42034-730">Open a Query Window.</span></span>
* <span data-ttu-id="42034-731">Выполните команду sp_helpsort в базе данных master SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-731">Execute the command sp_helpsort in the SQL Server master database.</span></span>

<span data-ttu-id="42034-732">Правильный результат должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="42034-732">The desired result should look like:</span></span>

    Latin1-General, binary code point comparison sort for Unicode Data, SQL Server Sort Order 40 on Code Page 850 for non-Unicode Data

<span data-ttu-id="42034-733">Если результат выглядит иначе, ОСТАНОВИТЕ развертывание SAP и выясните, почему команда установки сработала не так, как ожидалось.</span><span class="sxs-lookup"><span data-stu-id="42034-733">If this is not the result, STOP deploying SAP and investigate why the setup command did not work as expected.</span></span> <span data-ttu-id="42034-734">Развертывание приложений SAP NetWeaver в экземпляре SQL Server с кодовыми страницами SQL Server, отличающимися от упомянутой выше, **НЕ** поддерживается.</span><span class="sxs-lookup"><span data-stu-id="42034-734">Deployment of SAP NetWeaver applications onto SQL Server instance with different SQL Server codepages than the one mentioned above is **NOT** supported.</span></span>

### <a name="sql-server-high-availability-for-sap-in-azure"></a><span data-ttu-id="42034-735">Высокая доступность SQL Server для SAP в Azure</span><span class="sxs-lookup"><span data-stu-id="42034-735">SQL Server High-Availability for SAP in Azure</span></span>
<span data-ttu-id="42034-736">Как упоминалось ранее в данном документе, невозможно создать общее хранилище, которое необходимо для использования наиболее старой функции высокой доступности SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-736">As mentioned earlier in this paper, there is no possibility to create shared storage, which is necessary for the usage of the oldest SQL Server high availability functionality.</span></span> <span data-ttu-id="42034-737">Эта функция предусматривала установку двух или более экземпляров SQL Server в отказоустойчивом кластере Windows Server (WSFC) с использованием общего диска для пользовательских баз данных (и в конечном счете tempdb).</span><span class="sxs-lookup"><span data-stu-id="42034-737">This functionality would install two or more SQL Server instances in a Windows Server Failover Cluster (WSFC) using a shared disk for the user databases (and eventually tempdb).</span></span> <span data-ttu-id="42034-738">Этот способ обеспечения высокой доступности долгое время был стандартом, который также поддерживается в SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-738">This is the long time standard high availability method, which also is supported by SAP.</span></span> <span data-ttu-id="42034-739">Поскольку Azure не поддерживает общее хранилище, невозможно реализовать конфигурации высокого уровня доступности SQL Server с конфигурацией кластера общих дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-739">Because Azure doesn’t support shared storage, SQL Server high availability configurations with a shared disk cluster configuration cannot be realized.</span></span> <span data-ttu-id="42034-740">Однако многие другие методы обеспечения высокой доступности остаются возможными и описаны в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="42034-740">However, many other high availability methods are still possible and are described in the following sections.</span></span>

#### <a name="sql-server-log-shipping"></a><span data-ttu-id="42034-741">Доставка журналов SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-741">SQL Server Log Shipping</span></span>
<span data-ttu-id="42034-742">Одним из способов обеспечения высокого уровня доступности (HA) является доставка журналов SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-742">One of the methods of high availability (HA) is SQL Server Log Shipping.</span></span> <span data-ttu-id="42034-743">Если в конфигурации высокой доступности виртуальные машины имеют работающее разрешение имен, проблемы нет и настройка в Azure не будет отличаться от любой настройки, которая выполняется локально.</span><span class="sxs-lookup"><span data-stu-id="42034-743">If the VMs participating in the HA configuration have working name resolution, there is no problem and the setup in Azure does not differ from any setup that is done on-premises.</span></span> <span data-ttu-id="42034-744">Мы не рекомендуем полагаться только на разрешение IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="42034-744">It is not recommended to rely on IP resolution only.</span></span> <span data-ttu-id="42034-745">Дополнительную информацию о настройке доставки журналов и принципах их доставки см. в следующей документации:</span><span class="sxs-lookup"><span data-stu-id="42034-745">With regards to setting up Log Shipping and the principles around Log Shipping, check this documentation:</span></span>

<span data-ttu-id="42034-746"><https://docs.microsoft.com/sql/database-engine/log-shipping/about-log-shipping-sql-server></span><span class="sxs-lookup"><span data-stu-id="42034-746"><https://docs.microsoft.com/sql/database-engine/log-shipping/about-log-shipping-sql-server></span></span>

<span data-ttu-id="42034-747">Чтобы в действительности добиться высокой доступности, необходимо развернуть виртуальные машины, находящиеся в такой конфигурации доставки журналов в одной группе доступности Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-747">In order to really achieve any high availability, one needs to deploy the VMs, which are within such a Log Shipping configuration to be within the same Azure Availability Set.</span></span>

#### <a name="database-mirroring"></a><span data-ttu-id="42034-748">Зеркальное отображение базы данных</span><span class="sxs-lookup"><span data-stu-id="42034-748">Database Mirroring</span></span>
<span data-ttu-id="42034-749">Зеркальное отображение базы данных в поддерживаемом SAP виде (см. примечание к SAP [965908]) полагается на определение партнера по отработке отказа в строке подключения SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-749">Database Mirroring as supported by SAP (see SAP Note [965908]) relies on defining a failover partner in the SAP connection string.</span></span> <span data-ttu-id="42034-750">При подключении между организациями предполагается, что две виртуальные машины находятся в одном и том же домене, а пользовательский контекст, в котором запускаются два экземпляра SQL Server, является также пользователями домена, которые имеют достаточно прав в двух задействованных экземплярах SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-750">For the Cross-Premises cases, we assume that the two VMs are in the same domain and that the user context the two SQL Server instances are running under a domain user as well and have sufficient privileges in the two SQL Server instances involved.</span></span> <span data-ttu-id="42034-751">Таким образом, настройка зеркального отображения базы данных в Azure не отличается от обычной локальной установки и конфигурации.</span><span class="sxs-lookup"><span data-stu-id="42034-751">Therefore, the setup of Database Mirroring in Azure does not differ between a typical on-premises setup/configuration.</span></span>

<span data-ttu-id="42034-752">Самый простой способ полностью облачного развертывания — настроить другой домен в Azure так, чтобы эти виртуальные машины СУБД (а в идеале выделенные виртуальные машины SAP) находились в пределах одного домена.</span><span class="sxs-lookup"><span data-stu-id="42034-752">As of Cloud-Only deployments, the easiest method is to have another domain setup in Azure to have those DBMS VMs (and ideally dedicated SAP VMs) within one domain.</span></span>

<span data-ttu-id="42034-753">Если использовать домен невозможно, то можно также применять сертификаты для конечных точек зеркального отображения базы данных, как описано здесь: <https://docs.microsoft.com/sql/database-engine/database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql>.</span><span class="sxs-lookup"><span data-stu-id="42034-753">If a domain is not possible, one can also use certificates for the database mirroring endpoints as described here: <https://docs.microsoft.com/sql/database-engine/database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql></span></span>

<span data-ttu-id="42034-754">Руководство по настройке зеркального отображения базы данных в Azure см. здесь: <https://docs.microsoft.com/sql/database-engine/database-mirroring/database-mirroring-sql-server>.</span><span class="sxs-lookup"><span data-stu-id="42034-754">A tutorial to set up Database Mirroring in Azure can be found here: <https://docs.microsoft.com/sql/database-engine/database-mirroring/database-mirroring-sql-server></span></span> 

#### <a name="sql-server-always-on"></a><span data-ttu-id="42034-755">AlwaysOn в SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-755">SQL Server Always On</span></span>
<span data-ttu-id="42034-756">Так как функция AlwaysOn поддерживается для SAP в локальной среде (см. примечание к SAP [1772688]), то ее можно использовать вместе с SAP в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-756">As Always On is supported for SAP on-premises (see SAP Note [1772688]), it is supported to be used in combination with SAP in Azure.</span></span> <span data-ttu-id="42034-757">То, что вы не можете создавать общие диски в Azure, не означает, что нельзя создать конфигурацию отказоустойчивого кластера Windows Server (WSFC) с AlwaysOn между разными виртуальными машинами.</span><span class="sxs-lookup"><span data-stu-id="42034-757">The fact that you are not able to create shared disks in Azure doesn’t mean that one can’t create an Always On Windows Server Failover Cluster (WSFC) configuration between different VMs.</span></span> <span data-ttu-id="42034-758">Это только означает отсутствие возможности использовать общий диск в качестве кворума в конфигурации кластера.</span><span class="sxs-lookup"><span data-stu-id="42034-758">It only means that you do not have the possibility to use a shared disk as a quorum in the cluster configuration.</span></span> <span data-ttu-id="42034-759">Таким образом, можно создать конфигурацию WSFC AlwaysOn в Azure и просто не выбирать тип кворума, в котором используется общий диск.</span><span class="sxs-lookup"><span data-stu-id="42034-759">Hence you can build an Always On WSFC configuration in Azure and simply not select the quorum type that utilizes shared disk.</span></span> <span data-ttu-id="42034-760">Среда Azure, в которой развертываются эти виртуальные машины, должна распознавать виртуальные машины по имени, и эти виртуальные машины должны находиться в одном и том же домене.</span><span class="sxs-lookup"><span data-stu-id="42034-760">The Azure environment those VMs are deployed in should resolve the VMs by name and the VMs should be in the same domain.</span></span> <span data-ttu-id="42034-761">Это касается развертываний только в Azure и распределенных развертываний.</span><span class="sxs-lookup"><span data-stu-id="42034-761">This is true for Azure only and Cross-Premises deployments.</span></span> <span data-ttu-id="42034-762">Существуют особые рекомендации по развертыванию прослушивателя группы доступности SQL Server (не путать с группой доступности Azure), так как Azure на данный момент не разрешает просто создать объект AD/DNS, как это возможно в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-762">There are some special considerations around deploying the SQL Server Availability Group Listener (not to be confused with the Azure Availability Set) since Azure at this point in time does not allow to simply create an AD/DNS object as it is possible on-premises.</span></span> <span data-ttu-id="42034-763">Таким образом, необходимо выполнить ряд отдельных шагов по установке для преодоления характерного поведения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-763">Therefore, some different installation steps are necessary to overcome the specific behavior of Azure.</span></span>

<span data-ttu-id="42034-764">Ниже приведены некоторые рекомендации по использованию прослушивателя группы доступности.</span><span class="sxs-lookup"><span data-stu-id="42034-764">Some considerations using an Availability Group Listener are:</span></span>

* <span data-ttu-id="42034-765">Использование прослушивателя группы доступности возможно, только если в качестве гостевой ОС виртуальной машины используется Windows Server 2012 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="42034-765">Using an Availability Group Listener is only possible with Windows Server 2012 or higher as guest OS of the VM.</span></span> <span data-ttu-id="42034-766">Если вы используете Windows Server 2012, то убедитесь, что установлено следующее исправление: <https://support.microsoft.com/kb/2854082>.</span><span class="sxs-lookup"><span data-stu-id="42034-766">For Windows Server 2012 you need to make sure that this patch is applied: <https://support.microsoft.com/kb/2854082></span></span> 
* <span data-ttu-id="42034-767">Для Windows Server 2008 R2 такое исправление отсутствует, и AlwaysOn необходимо использовать таким же образом, как зеркальное отображение базы данных, указав партнер по отработке отказа в строке подключения (для этого используется параметр dbs/mss/server в SAP default.pfl; см. примечание к SAP [965908]).</span><span class="sxs-lookup"><span data-stu-id="42034-767">For Windows Server 2008 R2 this patch does not exist and Always On would need to be used in the same manner as Database Mirroring by specifying a failover partner in the connections string (done through the SAP default.pfl parameter dbs/mss/server – see SAP Note [965908]).</span></span>
* <span data-ttu-id="42034-768">При использовании прослушивателя группы доступности виртуальные машины баз данных необходимо подключить к выделенному Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="42034-768">When using an Availability Group Listener, the Database VMs need to be connected to a dedicated Load Balancer.</span></span> <span data-ttu-id="42034-769">Разрешение имен в полностью облачных развертываниях требует, чтобы все виртуальные машины системы SAP (серверы приложений, сервер СУБД и сервер (A)SCS) находились в одной виртуальной сети или чтобы на уровне приложений SAP осуществлялась поддержка файла etc\host для разрешения имен виртуальных машин SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42034-769">Name resolution in Cloud-Only deployments would either require all VMs of an SAP system (application servers, DBMS server, and (A)SCS server) are in the same virtual network or would require from an SAP application layer the maintenance of the etc\host file in order to get the VM names of the SQL Server VMs resolved.</span></span> <span data-ttu-id="42034-770">Во избежание назначения системой Azure новых IP-адресов при случайном завершении работы обеих виртуальных машин следует назначить статические IP-адреса сетевым интерфейсам этих виртуальных машин в конфигурации AlwaysOn (определение статического IP-адреса описано в [этой][virtual-networks-reserved-private-ip] статье).</span><span class="sxs-lookup"><span data-stu-id="42034-770">In order to avoid that Azure is assigning new IP addresses in cases where both VMs incidentally are shutdown, one should assign static IP addresses to the network interfaces of those VMs in the Always On configuration (defining a static IP address is described in [this][virtual-networks-reserved-private-ip] article)</span></span>

[comment]: <> (Старые блоги)
[comment]: <> (<https://blogs.msdn.com/b/alwaysonpro/archive/2014/08/29/recommendations-and-best-practices-when-deploying-sql-server-alwayson-availability-groups-in-windows-azure-iaas.aspx>, <https://blogs.technet.com/b/rmilne/archive/2015/07/27/how-to-set-static-ip-on-azure-vm.aspx>) 
* <span data-ttu-id="42034-773">Особые действия требуются при построении конфигурации кластера WSFC, где кластеру требуется назначить специальный IP-адрес, так как Azure с текущими функциональными возможностями назначит имени кластера тот же IP-адрес, что и у узла, на котором создается кластер.</span><span class="sxs-lookup"><span data-stu-id="42034-773">There are special steps required when building the WSFC cluster configuration where the cluster needs a special IP address assigned, because Azure with its current functionality would assign the cluster name the same IP address as the node the cluster is created on.</span></span> <span data-ttu-id="42034-774">Это означает, что необходимо вручную назначить кластеру другой IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="42034-774">This means a manual step must be performed to assign a different IP address to the cluster.</span></span>
* <span data-ttu-id="42034-775">Прослушиватель группы доступности будет создан в Azure с конечными точками TCP/IP, назначенными виртуальным машинам, на которых запускаются первичная и вторичная реплики группы доступности.</span><span class="sxs-lookup"><span data-stu-id="42034-775">The Availability Group Listener is going to be created in Azure with TCP/IP endpoints, which are assigned to the VMs running the primary and secondary replicas of the Availability group.</span></span>
* <span data-ttu-id="42034-776">Может возникнуть необходимость обеспечить безопасность этих конечных точек с помощью списков управления доступом.</span><span class="sxs-lookup"><span data-stu-id="42034-776">There might be a need to secure these endpoints with ACLs.</span></span>

[comment]: <> (TODO старый блог)
[comment]: <> (Подробные инструкции и необходимые условия для установки конфигурации AlwaysOn в Azure лучше всего выполнять после изучения руководства, которое доступно [здесь][virtual-machines-windows-classic-ps-sql-alwayson-availability-groups])
[comment]: <> (Установка AlwaysOn с предварительной настройкой с помощью коллекции Azure <https://blogs.technet.com/b/dataplatforminsider/archive/2014/08/25/sql-server-alwayson-offering-in-microsoft-azure-portal-gallery.aspx>)
[comment]: <> (Создание прослушивателя группы доступности лучше всего описано в [этом][virtual-machines-windows-classic-ps-sql-int-listener] руководстве)
[comment]: <> (Защита сетевых конечных точек с помощью списков управления доступом лучше всего объясняется здесь:)
[comment]: <> (*    <https://michaelwasham.com/windows-azure-powershell-reference-guide/network-access-control-list-capability-in-windows-azure-powershell/>)
[comment]: <> (*    <https://blogs.technet.com/b/heyscriptingguy/archive/2013/08/31/weekend-scripter-creating-acls-for-windows-azure-endpoints-part-1-of-2.aspx> )
[comment]: <> (*    <https://blogs.technet.com/b/heyscriptingguy/archive/2013/09/01/weekend-scripter-creating-acls-for-windows-azure-endpoints-part-2-of-2.aspx>)  
[comment]: <> (*    <https://blogs.technet.com/b/heyscriptingguy/archive/2013/09/18/creating-acls-for-windows-azure-endpoints.aspx>) 

<span data-ttu-id="42034-786">Группу доступности AlwaysOn SQL Server можно также развернуть в разных регионах Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-786">It is possible to deploy a SQL Server Always On Availability Group over different Azure Regions as well.</span></span> <span data-ttu-id="42034-787">В работе этой функции задействовано подключение Azure между виртуальными сетями ([подробнее об этом][virtual-networks-configure-vnet-to-vnet-connection]).</span><span class="sxs-lookup"><span data-stu-id="42034-787">This functionality leverages the Azure VNet-to-Vnet connectivity ([more details][virtual-networks-configure-vnet-to-vnet-connection]).</span></span>

[comment]: <> (TODO старый блог)
[comment]: <> (Настройка групп доступности AlwaysOn SQL Server при таком сценарии описана здесь: <https://blogs.technet.com/b/dataplatforminsider/archive/2014/06/19/sql-server-alwayson-availability-groups-supported-between-microsoft-azure-regions.aspx>.) 

#### <a name="summary-on-sql-server-high-availability-in-azure"></a><span data-ttu-id="42034-790">Сводка по высокой доступности SQL Server в Azure</span><span class="sxs-lookup"><span data-stu-id="42034-790">Summary on SQL Server High Availability in Azure</span></span>
<span data-ttu-id="42034-791">Учитывая тот факт, что хранилище Azure осуществляет защиту содержимого, существует на одну причину меньше настаивать на образе горячей замены.</span><span class="sxs-lookup"><span data-stu-id="42034-791">Given the fact that Azure Storage is protecting the content, there is one less reason to insist on a hot-standby image.</span></span> <span data-ttu-id="42034-792">Это означает, что в вашем сценарии обеспечения высокой доступности необходимо реализовать защиту только от следующих ситуаций.</span><span class="sxs-lookup"><span data-stu-id="42034-792">This means your High Availability scenario needs to only protect against the following cases:</span></span>

* <span data-ttu-id="42034-793">Недоступность виртуальной машины в целом из-за технического обслуживания в серверном кластере Azure или по другим причинам</span><span class="sxs-lookup"><span data-stu-id="42034-793">Unavailability of the VM as a whole due to maintenance on the server cluster in Azure or other reasons</span></span>
* <span data-ttu-id="42034-794">Проблемы с программным обеспечением в экземпляре SQL Server</span><span class="sxs-lookup"><span data-stu-id="42034-794">Software issues in the SQL Server instance</span></span>
* <span data-ttu-id="42034-795">Защита от ошибок пользователей при удалении данных, когда требуется восстановление на определенный момент времени</span><span class="sxs-lookup"><span data-stu-id="42034-795">Protecting from manual error where data gets deleted and point-in-time recovery is needed</span></span>

<span data-ttu-id="42034-796">При рассмотрении похожих технологий можно утверждать, что первые две ситуации может решить зеркальное отображение базы данных или AlwaysOn, а третью ситуацию — только доставка журналов.</span><span class="sxs-lookup"><span data-stu-id="42034-796">Looking at matching technologies one can argue that the first two cases can be covered by Database Mirroring or Always On, whereas the third case only can be covered by Log-Shipping.</span></span>

<span data-ttu-id="42034-797">Вам нужно сбалансировать более сложную настройку AlwaysOn (по сравнению с зеркальным отображением базы данных) преимуществами AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="42034-797">You need to balance the more complex setup of Always On, compared to Database Mirroring, with the advantages of Always On.</span></span> <span data-ttu-id="42034-798">Эти преимущества перечислены ниже.</span><span class="sxs-lookup"><span data-stu-id="42034-798">Those advantages can be listed like:</span></span>

* <span data-ttu-id="42034-799">Вторичные реплики для чтения.</span><span class="sxs-lookup"><span data-stu-id="42034-799">Readable secondary replicas.</span></span>
* <span data-ttu-id="42034-800">Резервные копии из вторичных реплик.</span><span class="sxs-lookup"><span data-stu-id="42034-800">Backups from secondary replicas.</span></span>
* <span data-ttu-id="42034-801">Улучшенная масштабируемость.</span><span class="sxs-lookup"><span data-stu-id="42034-801">Better scalability.</span></span>
* <span data-ttu-id="42034-802">Несколько вторичных реплик.</span><span class="sxs-lookup"><span data-stu-id="42034-802">More than one secondary replicas.</span></span>

### <span data-ttu-id="42034-803"><a name="9053f720-6f3b-4483-904d-15dc54141e30"></a>Общие сведения об SQL Server для SAP в Azure</span><span class="sxs-lookup"><span data-stu-id="42034-803"><a name="9053f720-6f3b-4483-904d-15dc54141e30"></a>General SQL Server for SAP on Azure Summary</span></span>
<span data-ttu-id="42034-804">Это руководство содержит много рекомендаций, и мы советуем прочитать его несколько раз перед планированием развертывания в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-804">There are many recommendations in this guide and we recommend you read it more than once before planning your Azure deployment.</span></span> <span data-ttu-id="42034-805">В целом необходимо учитывать десять основных рекомендаций, касающихся СУБД в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-805">In general, though, be sure to follow the top ten general DBMS on Azure specific points:</span></span>

[comment]: <> (В 2,3 раза более высокая пропускная способность, чем что? Чем один виртуальный жесткий диск?)
1. <span data-ttu-id="42034-807">Используйте новейшую версию СУБД, например SQL Server 2014, которая обладает максимумом преимуществ в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-807">Use the latest DBMS release, like SQL Server 2014, that has the most advantages in Azure.</span></span> <span data-ttu-id="42034-808">Для SQL Server это версия SQL Server 2012 SP1 CU4, включающая функцию резервного копирования в хранилище Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-808">For SQL Server, this is SQL Server 2012 SP1 CU4, which would include the feature of backing up against Azure Storage.</span></span> <span data-ttu-id="42034-809">Однако в сочетании с SAP мы бы рекомендовали минимум SQL Server 2014 SP1 CU1 или SQL Server 2012 SP2 и новейший пакет CU.</span><span class="sxs-lookup"><span data-stu-id="42034-809">However, in conjunction with SAP we would recommend at least SQL Server 2014 SP1 CU1 or SQL Server 2012 SP2 and the latest CU.</span></span>
2. <span data-ttu-id="42034-810">Тщательно планируйте ландшафт системы SAP в Azure, чтобы сбалансировать структуру файлов данных и ограничения Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-810">Carefully plan your SAP system landscape in Azure to balance the data file layout and Azure restrictions:</span></span>
   * <span data-ttu-id="42034-811">Не устанавливайте слишком много дисков, но обеспечьте достаточное количество для достижения необходимого числа операций ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-811">Don’t have too many disks, but have enough to ensure you can reach your required IOPS.</span></span>
   * <span data-ttu-id="42034-812">Если вы не используете Управляемые диски, помните, что количество операций ввода-вывода также ограничено для каждой учетной записи хранения Azure, а количество учетных записей хранения ограничено для каждой подписки Azure ([подробнее об этом][azure-subscription-service-limits]).</span><span class="sxs-lookup"><span data-stu-id="42034-812">If you don't use Managed Disks, remember that IOPS are also limited per Azure Storage Account and that Storage Accounts are limited within each Azure subscription ([more details][azure-subscription-service-limits]).</span></span> 
   * <span data-ttu-id="42034-813">Создавайте stripe-массив из дисков только при необходимости обеспечить более высокую пропускную способность.</span><span class="sxs-lookup"><span data-stu-id="42034-813">Only stripe across disks if you need to achieve a higher throughput.</span></span>
3. <span data-ttu-id="42034-814">Никогда не устанавливайте программное обеспечение и не помещайте файлы, которые требуется сохранять на постоянной основе, на диск D:\, так как он является непостоянным, и любое содержимое этого диска будет потеряно при перезагрузке Windows.</span><span class="sxs-lookup"><span data-stu-id="42034-814">Never install software or put any files that require persistence on the D:\ drive as it is non-permanent and anything on this drive is lost at a Windows reboot.</span></span>
4. <span data-ttu-id="42034-815">Не используйте кэширование дисков для хранилища Azure класса Standard.</span><span class="sxs-lookup"><span data-stu-id="42034-815">Don’t use disk caching for Azure Standard Storage.</span></span>
5. <span data-ttu-id="42034-816">Не используйте геореплицированные учетные записи хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-816">Don’t use Azure geo-replicated Storage Accounts.</span></span>  <span data-ttu-id="42034-817">Используйте локальную избыточность для рабочих нагрузок СУБД.</span><span class="sxs-lookup"><span data-stu-id="42034-817">Use Locally Redundant for DBMS workloads.</span></span>
6. <span data-ttu-id="42034-818">Используйте решение HA/DR поставщика СУБД для репликации данных из базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-818">Use your DBMS vendor’s HA/DR solution to replicate database data.</span></span>
7. <span data-ttu-id="42034-819">Всегда используйте разрешение имен, не полагайтесь на IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="42034-819">Always use Name Resolution, don’t rely on IP addresses.</span></span>
8. <span data-ttu-id="42034-820">Используйте наибольшую возможную степень сжатия базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-820">Use the highest database compression possible.</span></span> <span data-ttu-id="42034-821">Для SQL Server это сжатие страниц.</span><span class="sxs-lookup"><span data-stu-id="42034-821">For SQL Server this is page compression.</span></span>
9. <span data-ttu-id="42034-822">Соблюдайте осторожность при использовании образов SQL Server из Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="42034-822">Be careful using SQL Server images from the Azure Marketplace.</span></span> <span data-ttu-id="42034-823">При использовании образа SQL Server необходимо изменить параметры сортировки экземпляра, прежде чем устанавливать на него систему SAP NetWeaver.</span><span class="sxs-lookup"><span data-stu-id="42034-823">If you use the SQL Server one, you must change the instance collation before installing any SAP NetWeaver system on it.</span></span>
10. <span data-ttu-id="42034-824">Установите и настройте мониторинг узла SAP для Azure, как описано в [руководстве по развертыванию][deployment-guide].</span><span class="sxs-lookup"><span data-stu-id="42034-824">Install and configure the SAP Host Monitoring for Azure as described in [Deployment Guide][deployment-guide].</span></span>

## <a name="specifics-to-sap-ase-on-windows"></a><span data-ttu-id="42034-825">Особенности SAP ASE в Windows</span><span class="sxs-lookup"><span data-stu-id="42034-825">Specifics to SAP ASE on Windows</span></span>
<span data-ttu-id="42034-826">Начиная с Microsoft Azure, можно легко переносить существующие приложения SAP ASE на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-826">Starting with Microsoft Azure, you can easily migrate your existing SAP ASE applications to Azure Virtual Machines.</span></span> <span data-ttu-id="42034-827">SAP ASE на виртуальной машине позволяет снизить общую стоимость владения для развертывания и обслуживания приложений уровня организации, а также управления ими благодаря переносу этих приложений в Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-827">SAP ASE in a Virtual Machine enables you to reduce the total cost of ownership of deployment, management, and maintenance of enterprise breadth applications by easily migrating these applications to Microsoft Azure.</span></span> <span data-ttu-id="42034-828">С помощью SAP ASE на виртуальной машине Azure администраторы и разработчики могут продолжать использовать те же средства разработки и администрирования, которые доступны в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-828">With SAP ASE in an Azure Virtual Machine, administrators and developers can still use the same development and administration tools that are available on-premises.</span></span>

<span data-ttu-id="42034-829">Существует соглашение об уровне обслуживания для виртуальных машин, работающих в Azure, которое можно найти здесь: <https://azure.microsoft.com/support/legal/sla/virtual-machines>.</span><span class="sxs-lookup"><span data-stu-id="42034-829">There is an SLA for the Azure Virtual Machines, which can be found here: <https://azure.microsoft.com/support/legal/sla/virtual-machines></span></span>

<span data-ttu-id="42034-830">Мы уверены, что размещенные в Microsoft Azure виртуальные машины работают очень хорошо по сравнению с другими предложениями виртуализации в общедоступном облаке, но некоторые результаты могут быть разными.</span><span class="sxs-lookup"><span data-stu-id="42034-830">We are confident that Microsoft Azure hosted Virtual Machines performs very well in comparison to other public cloud virtualization offerings, but individual results may vary.</span></span> <span data-ttu-id="42034-831">Номера SAPS размеров SAP для различных сертифицированных SAP SKU виртуальных машин предоставлены в отдельном примечании к SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="42034-831">SAP sizing SAPS numbers of the different SAP certified VM SKUs is provided in a separate SAP Note [1928533].</span></span>

<span data-ttu-id="42034-832">Инструкции и рекомендации по использованию службы хранилища Azure, развертыванию виртуальных машин SAP или мониторингу SAP применяются к развертываниям SAP ASE в сочетании с приложениями SAP, как указано в первых четырех главах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-832">Statements and recommendations in regard to the usage of Azure Storage, Deployment of SAP VMs or SAP Monitoring apply to deployments of SAP ASE in conjunction with SAP applications as stated throughout the first four chapters of this document.</span></span>

### <a name="sap-ase-version-support"></a><span data-ttu-id="42034-833">Поддержка версий SAP ASE</span><span class="sxs-lookup"><span data-stu-id="42034-833">SAP ASE Version Support</span></span>
<span data-ttu-id="42034-834">SAP в настоящее время поддерживает версию SAP ASE 16.0 для использования с продуктами SAP Business Suite.</span><span class="sxs-lookup"><span data-stu-id="42034-834">SAP currently supports SAP ASE version 16.0 for use with SAP Business Suite products.</span></span> <span data-ttu-id="42034-835">Все обновления для сервера SAP ASE, а также драйверы JDBC и ODBC для продуктов SAP Business Suite доступны только в SAP Service Marketplace по адресу <https://support.sap.com/swdc>.</span><span class="sxs-lookup"><span data-stu-id="42034-835">All updates for SAP ASE server, or JDBC and ODBC drivers to be used with SAP Business Suite products are provided solely through the SAP Service Marketplace at: <https://support.sap.com/swdc>.</span></span>

<span data-ttu-id="42034-836">Для установки в локальной среде не следует загружать обновления для сервера SAP ASE или драйверы JDBC и ODBC непосредственно с веб-сайтов Sybase.</span><span class="sxs-lookup"><span data-stu-id="42034-836">As for installations on-premises, do not download updates for the SAP ASE server, or for the JDBC and ODBC drivers directly from Sybase websites.</span></span> <span data-ttu-id="42034-837">Подробные сведения об исправлениях, которые поддерживаются для использования с продуктами SAP Business Suite в локальной среде и на виртуальных машинах Azure, см. в следующих примечаниях SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-837">For detailed information on patches, which are supported for use with SAP Business Suite products on-premises and in Azure Virtual Machines see the following SAP Notes:</span></span>

* <span data-ttu-id="42034-838">[1590719]</span><span class="sxs-lookup"><span data-stu-id="42034-838">[1590719]</span></span>
* <span data-ttu-id="42034-839">[1973241]</span><span class="sxs-lookup"><span data-stu-id="42034-839">[1973241]</span></span>

<span data-ttu-id="42034-840">Общие сведения о запуске SAP Business Suite в SAP ASE можно найти на сайте [SCN](https://www.sap.com/community/topic/ase.html)</span><span class="sxs-lookup"><span data-stu-id="42034-840">General information on running SAP Business Suite on SAP ASE can be found in the [SCN](https://www.sap.com/community/topic/ase.html)</span></span>

### <a name="sap-ase-configuration-guidelines-for-sap-related-sap-ase-installations-in-azure-vms"></a><span data-ttu-id="42034-841">Рекомендации по конфигурации SAP ASE для связанных с SAP установок SAP ASE на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="42034-841">SAP ASE Configuration Guidelines for SAP-related SAP ASE Installations in Azure VMs</span></span>
#### <a name="structure-of-the-sap-ase-deployment"></a><span data-ttu-id="42034-842">Структура развертывания SAP ASE</span><span class="sxs-lookup"><span data-stu-id="42034-842">Structure of the SAP ASE Deployment</span></span>
<span data-ttu-id="42034-843">В соответствии с общим описанием исполняемые файлы SAP ASE должны быть расположены или установлены на системном диске ОС виртуальной машины (диск C:\)).</span><span class="sxs-lookup"><span data-stu-id="42034-843">In accordance with the general description, SAP ASE executables should be located or installed into the system drive of the VM’s OS disk (drive c:\).</span></span> <span data-ttu-id="42034-844">Как правило, большинство баз данных системы и средств SAP ASE не особо активно используются рабочей нагрузкой SAP NetWeaver.</span><span class="sxs-lookup"><span data-stu-id="42034-844">Typically, most of the SAP ASE system and tools databases are not really leveraged hard by SAP NetWeaver workload.</span></span> <span data-ttu-id="42034-845">Поэтому базы данных системы и средств (master, model, saptools, sybmgmtdb, sybsystemdb) могут также оставаться на диске C:\.</span><span class="sxs-lookup"><span data-stu-id="42034-845">Hence the system and tools databases (master, model, saptools, sybmgmtdb, sybsystemdb) can remain on the C:\ drive as well.</span></span> 

<span data-ttu-id="42034-846">Исключением может быть временная база данных, содержащая все рабочие таблицы и временные таблицы, созданные SAP ASE, что в случае некоторых рабочих нагрузок SAP ERP и всех рабочих нагрузок BW может потребовать большего объема данных или объема операций ввода-вывода, с которым не справится диск операционной системы исходной виртуальной машины (диск c:\).</span><span class="sxs-lookup"><span data-stu-id="42034-846">An exception could be the temporary database containing all work tables and temporary tables created by SAP ASE, which in case of some SAP ERP and all BW workloads might require either higher data volume or I/O operations volume, which can’t fit into the original VM’s OS disk (drive c:\).</span></span>

<span data-ttu-id="42034-847">В зависимости от версии SAPInst или SWPM, использованной для установки системы, база данных может содержать следующие компоненты.</span><span class="sxs-lookup"><span data-stu-id="42034-847">Depending on the version of SAPInst/SWPM used to install the system, the database might contain:</span></span>

* <span data-ttu-id="42034-848">Отдельную базу tempdb SAP ASE, которая создается при установке SAP ASE.</span><span class="sxs-lookup"><span data-stu-id="42034-848">A single SAP ASE tempdb, which is created when installing SAP ASE</span></span>
* <span data-ttu-id="42034-849">Базу tempdb SAP ASE, созданную при установке SAP ASE, и дополнительную базу saptempdb, созданную процедурой установки SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-849">An SAP ASE tempdb created by installing SAP ASE and an additional saptempdb created by the SAP installation routine</span></span>
* <span data-ttu-id="42034-850">Базу данных tempdb SAP ASE, созданную при установке SAP ASE, и дополнительную базу данных tempdb, созданную вручную (например, согласно примечанию к SAP [1752266]) для соответствия особым требованиям tempdb к ERP/BW.</span><span class="sxs-lookup"><span data-stu-id="42034-850">An SAP ASE tempdb created by installing SAP ASE and an additional tempdb that has been created manually (for example following SAP Note [1752266]) to meet ERP/BW specific tempdb requirements</span></span>

<span data-ttu-id="42034-851">При определенных рабочих нагрузках ERP или всех рабочих нагрузках BW имеет смысл по соображениям производительности поддерживать работу устройств tempdb дополнительно созданной базы данных tempdb (с помощью SWPM или вручную) на любом диске, кроме C:\.</span><span class="sxs-lookup"><span data-stu-id="42034-851">In case of specific ERP or all BW workloads, it makes sense, in regard to performance, to keep the tempdb devices of the additionally created tempdb (by SWPM or manually) on a drive other than C:\.</span></span> <span data-ttu-id="42034-852">При отсутствии дополнительной базы данных tempdb рекомендуется ее создать (примечание к SAP [1752266]).</span><span class="sxs-lookup"><span data-stu-id="42034-852">If no additional tempdb exists, it is recommended to create one (SAP Note [1752266]).</span></span>

<span data-ttu-id="42034-853">Для таких систем необходимо выполнить следующие действия над дополнительно созданной базой данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="42034-853">For such systems the following steps should be performed for the additionally created tempdb:</span></span>

* <span data-ttu-id="42034-854">Переместите первое устройство tempdb на первое устройство базы данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-854">Move the first tempdb device to the first device of the SAP database</span></span>
* <span data-ttu-id="42034-855">Добавьте устройства tempdb на каждый диск, содержащий устройства базы данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-855">Add tempdb devices to each of the VHDs containing a device of the SAP database</span></span>

<span data-ttu-id="42034-856">Эта конфигурация позволяет tempdb потреблять больше пространства, чем может предоставить системный диск.</span><span class="sxs-lookup"><span data-stu-id="42034-856">This configuration enables tempdb to either consume more space than the system drive is able to provide.</span></span> <span data-ttu-id="42034-857">Для справки можно проверить размеры устройств tempdb в существующих системах, работающих локально.</span><span class="sxs-lookup"><span data-stu-id="42034-857">As a reference one can check the tempdb device sizes on existing systems, which run on-premises.</span></span> <span data-ttu-id="42034-858">Или же такая конфигурация обеспечит такие показатели операций ввода-вывода в tempdb, которые не могут быть предоставлены системным диском.</span><span class="sxs-lookup"><span data-stu-id="42034-858">Or such a configuration would enable IOPS numbers against tempdb, which cannot be provided with the system drive.</span></span> <span data-ttu-id="42034-859">Опять же, системы, работающие в локальной среде, можно использовать для мониторинга рабочей нагрузки ввода-вывода на базу данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="42034-859">Again systems that are running on-premises can be used to monitor I/O workload against tempdb.</span></span>

<span data-ttu-id="42034-860">Никогда не помещайте устройства SAP ASE на диск D:\ виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-860">Never put any SAP ASE devices onto the D:\ drive of the VM.</span></span> <span data-ttu-id="42034-861">Это правило также применяется к tempdb, даже если содержащиеся в tempdb объекты являются временными.</span><span class="sxs-lookup"><span data-stu-id="42034-861">This also applies to the tempdb, even if the objects kept in the tempdb are only temporary.</span></span>

#### <a name="impact-of-database-compression"></a><span data-ttu-id="42034-862">Влияние сжатия базы данных</span><span class="sxs-lookup"><span data-stu-id="42034-862">Impact of Database Compression</span></span>
<span data-ttu-id="42034-863">В конфигурациях, в которых пропускная способность ввода-вывода может стать ограничивающим фактором, каждая мера, позволяющая сократить объем операций ввода-вывода, помогает растянуть рабочую нагрузку, которую можно запускать в сценарии IaaS, например Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-863">In configurations where I/O bandwidth can become a limiting factor, every measure, which reduces IOPS might help to stretch the workload one can run in an IaaS scenario like Azure.</span></span> <span data-ttu-id="42034-864">Таким образом, настоятельно рекомендуется обязательно использовать сжатие SAP ASE перед отправкой существующей базы данных SAP в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-864">Therefore, it is strongly recommended to make sure that SAP ASE compression is used before uploading an existing SAP database to Azure.</span></span>

<span data-ttu-id="42034-865">Рекомендация выполнять сжатие перед отправкой в Azure, если оно еще не реализовано, дается по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="42034-865">The recommendation to perform compression before uploading to Azure if it is not already implemented is given out of several reasons:</span></span>

* <span data-ttu-id="42034-866">Объем отправляемых в Azure данных уменьшается.</span><span class="sxs-lookup"><span data-stu-id="42034-866">The amount of data to be uploaded to Azure is lower</span></span>
* <span data-ttu-id="42034-867">Длительность выполнения сжатия короче, при условии, что локально можно использовать более мощное оборудование с большим числом ЦП, более высокой пропускной способностью ввода-вывода или меньшими задержками ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-867">The duration of the compression execution is shorter assuming that one can use stronger hardware with more CPUs or higher I/O bandwidth or less I/O latency on-premises</span></span>
* <span data-ttu-id="42034-868">Уменьшение размеров баз данных может сократить затраты на выделение места на дисках.</span><span class="sxs-lookup"><span data-stu-id="42034-868">Smaller database sizes might lead to less costs for disk allocation</span></span>

<span data-ttu-id="42034-869">Сжатие данных и LOB работает на виртуальных машинах Azure так же, как и в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-869">Data- and LOB-Compression work in a VM hosted in Azure Virtual Machines as it does on-premises.</span></span> <span data-ttu-id="42034-870">Дополнительные сведения о том, как проверить, используется ли уже сжатие в существующей базе данных SAP ASE, см. в примечании к SAP [1750510].</span><span class="sxs-lookup"><span data-stu-id="42034-870">For more details on how to check if compression is already in use in an existing SAP ASE database, check SAP Note [1750510].</span></span>

#### <a name="using-dbacockpit-to-monitor-database-instances"></a><span data-ttu-id="42034-871">Использование DBACockpit для мониторинга экземпляров баз данных</span><span class="sxs-lookup"><span data-stu-id="42034-871">Using DBACockpit to monitor Database Instances</span></span>
<span data-ttu-id="42034-872">Для систем SAP, в которых используется SAP ASE в качестве платформы баз данных, средство DBACockpit доступно в виде встроенных окон браузера в DBACockpit для транзакции или в виде Webdynpro.</span><span class="sxs-lookup"><span data-stu-id="42034-872">For SAP systems, which are using SAP ASE as database platform, the DBACockpit is accessible as embedded browser windows in transaction DBACockpit or as Webdynpro.</span></span> <span data-ttu-id="42034-873">Однако полный набор функций для мониторинга и администрирования базы данных доступен только в реализации Webdynpro средства DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="42034-873">However the full functionality for monitoring and administering the database is available in the Webdynpro implementation of the DBACockpit only.</span></span>

<span data-ttu-id="42034-874">Как и для локальных систем, требуется выполнить ряд действий, чтобы включить все функциональные возможности SAP NetWeaver, используемые в реализации Webdynpro средства DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="42034-874">As with on-premises systems several steps are required to enable all SAP NetWeaver functionality used by the Webdynpro implementation of the DBACockpit.</span></span> <span data-ttu-id="42034-875">Ознакомьтесь с информацией в примечании к SAP [1245200] , чтобы включить использование инструментов Webdynpro и создать те из них, которые необходимы.</span><span class="sxs-lookup"><span data-stu-id="42034-875">Follow SAP Note [1245200] to enable the usage of webdynpros and generate the required ones.</span></span> <span data-ttu-id="42034-876">При соблюдении инструкций в упомянутых выше примечаниях будет также выполнена настройка Internet Communication Manager (icm) вместе с портами, используемыми для подключений http и https.</span><span class="sxs-lookup"><span data-stu-id="42034-876">When following the instructions in the above notes, you also configure the Internet Communication Manager (icm) along with the ports to be used for http and https connections.</span></span> <span data-ttu-id="42034-877">Настройка по умолчанию для http выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="42034-877">The default setting for http looks like this:</span></span>

> <span data-ttu-id="42034-878">icm/server_port_0 = PROT=HTTP,PORT=8000,PROCTIMEOUT=600,TIMEOUT=600</span><span class="sxs-lookup"><span data-stu-id="42034-878">icm/server_port_0 = PROT=HTTP,PORT=8000,PROCTIMEOUT=600,TIMEOUT=600</span></span>
> 
> <span data-ttu-id="42034-879">icm/server_port_1 = PROT=HTTPS,PORT=443$$,PROCTIMEOUT=600,TIMEOUT=600</span><span class="sxs-lookup"><span data-stu-id="42034-879">icm/server_port_1 = PROT=HTTPS,PORT=443$$,PROCTIMEOUT=600,TIMEOUT=600</span></span>
> 
> 

<span data-ttu-id="42034-880">Ссылки, создаваемые в DBACockpit для транзакции, будут выглядеть примерно так:</span><span class="sxs-lookup"><span data-stu-id="42034-880">and the links generated in transaction DBACockpit will look similar to this:</span></span>

> <span data-ttu-id="42034-881">https://`<fullyqualifiedhostname`>:44300/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-881">https://`<fullyqualifiedhostname`>:44300/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> <span data-ttu-id="42034-882">http://`<fullyqualifiedhostname`>:8000/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-882">http://`<fullyqualifiedhostname`>:8000/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> 

<span data-ttu-id="42034-883">В зависимости от того, подключена ли виртуальная машина Azure, на которой размещается система SAP, в режиме "сеть — сеть", в режиме многосетевого подключения или ExpressRoute (распределенное развертывание), а также от способа этого подключения, необходимо убедиться, что ICM использует полное имя узла, которое может быть разрешено на компьютере, с которого вы пытаетесь открыть DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="42034-883">Depending on if and how the Azure Virtual Machine hosting the SAP system is connected via site-to-site, multi-site or ExpressRoute (Cross-Premises deployment) you need to make sure that ICM is using a fully qualified hostname that can be resolved on the machine where you are trying to open the DBACockpit from.</span></span> <span data-ttu-id="42034-884">Чтобы узнать, как ICM определяет полное имя узла в зависимости от параметров профиля, а также явным образом задать параметр icm/host_name_full (если необходимо), ознакомьтесь с примечанием к SAP [773830].</span><span class="sxs-lookup"><span data-stu-id="42034-884">See SAP Note [773830] to understand how ICM determines the fully qualified host name depending on profile parameters and set parameter icm/host_name_full explicitly if required.</span></span>

<span data-ttu-id="42034-885">Если вы развернули виртуальную машину только в облачной среде (без подключения между локальной средой и Azure), вам необходимо определить общедоступный IP-адрес и метку домена.</span><span class="sxs-lookup"><span data-stu-id="42034-885">If you deployed the VM in a Cloud-Only scenario without cross-premises connectivity between on-premises and Azure, you need to define a public IP address and a domainlabel.</span></span> <span data-ttu-id="42034-886">Тогда формат общедоступного DNS-имени виртуальной машины будет выглядеть так:</span><span class="sxs-lookup"><span data-stu-id="42034-886">The format of the public DNS name of the VM looks like this:</span></span>

> <span data-ttu-id="42034-887">`<custom domainlabel`>.`<azure region`>.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="42034-887">`<custom domainlabel`>.`<azure region`>.cloudapp.azure.com</span></span>
> 
> 

<span data-ttu-id="42034-888">Дополнительную информацию о DNS-имени см. [здесь][virtual-machines-azurerm-versus-azuresm].</span><span class="sxs-lookup"><span data-stu-id="42034-888">More details related to the DNS name can be found [here][virtual-machines-azurerm-versus-azuresm].</span></span>

<span data-ttu-id="42034-889">Если для параметра профиля SAP icm/host_name_full задать DNS-имя виртуальной машины Azure, ссылка может выглядеть так:</span><span class="sxs-lookup"><span data-stu-id="42034-889">Setting the SAP profile parameter icm/host_name_full to the DNS name of the Azure VM the link might look similar to:</span></span>

> <span data-ttu-id="42034-890">https://mydomainlabel.westeurope.cloudapp.net:44300/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-890">https://mydomainlabel.westeurope.cloudapp.net:44300/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> <span data-ttu-id="42034-891">http://mydomainlabel.westeurope.cloudapp.net:8000/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-891">http://mydomainlabel.westeurope.cloudapp.net:8000/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> 

<span data-ttu-id="42034-892">В таком случае необходимо:</span><span class="sxs-lookup"><span data-stu-id="42034-892">In this case you need to make sure to:</span></span>

* <span data-ttu-id="42034-893">добавить правила для входящего трафика в группу безопасности сети на портале Azure для портов TCP/IP, используемых для связи с ICM;</span><span class="sxs-lookup"><span data-stu-id="42034-893">Add Inbound rules to the Network Security Group in the Azure portal for the TCP/IP ports used to communicate with ICM</span></span>
* <span data-ttu-id="42034-894">добавить правила для входящего трафика в конфигурацию брандмауэра Windows для портов TCP/IP, используемых для связи с ICM.</span><span class="sxs-lookup"><span data-stu-id="42034-894">Add Inbound rules to the Windows Firewall configuration for the TCP/IP ports used to communicate with the ICM</span></span>

<span data-ttu-id="42034-895">Для автоматического импорта всех доступных исправлений рекомендуется периодически применять примечания SAP, содержащие наборы исправлений, которые относятся к вашей версии SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-895">For an automated imported of all corrections available, it is recommended to periodically apply the correction collection SAP Note applicable to your SAP version:</span></span>

* <span data-ttu-id="42034-896">[1558958;]</span><span class="sxs-lookup"><span data-stu-id="42034-896">[1558958]</span></span>
* <span data-ttu-id="42034-897">[1619967;]</span><span class="sxs-lookup"><span data-stu-id="42034-897">[1619967]</span></span>
* <span data-ttu-id="42034-898">[1882376.]</span><span class="sxs-lookup"><span data-stu-id="42034-898">[1882376]</span></span>

<span data-ttu-id="42034-899">Дополнительные сведения о панели DBA для SAP ASE можно найти в следующих примечаниях SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-899">Further information about DBA Cockpit for SAP ASE can be found in the following SAP Notes:</span></span>

* <span data-ttu-id="42034-900">[1605680;]</span><span class="sxs-lookup"><span data-stu-id="42034-900">[1605680]</span></span>
* <span data-ttu-id="42034-901">[1757924;]</span><span class="sxs-lookup"><span data-stu-id="42034-901">[1757924]</span></span>
* <span data-ttu-id="42034-902">[1757928]</span><span class="sxs-lookup"><span data-stu-id="42034-902">[1757928]</span></span>
* <span data-ttu-id="42034-903">[1758182]</span><span class="sxs-lookup"><span data-stu-id="42034-903">[1758182]</span></span>
* <span data-ttu-id="42034-904">[1758496;]</span><span class="sxs-lookup"><span data-stu-id="42034-904">[1758496]</span></span>    
* <span data-ttu-id="42034-905">[1814258;]</span><span class="sxs-lookup"><span data-stu-id="42034-905">[1814258]</span></span>
* <span data-ttu-id="42034-906">[1922555;]</span><span class="sxs-lookup"><span data-stu-id="42034-906">[1922555]</span></span>
* <span data-ttu-id="42034-907">[1956005.]</span><span class="sxs-lookup"><span data-stu-id="42034-907">[1956005]</span></span>

#### <a name="backuprecovery-considerations-for-sap-ase"></a><span data-ttu-id="42034-908">Рекомендации по резервному копированию и восстановлению для SAP ASE</span><span class="sxs-lookup"><span data-stu-id="42034-908">Backup/Recovery Considerations for SAP ASE</span></span>
<span data-ttu-id="42034-909">При развертывании SAP ASE в Azure методику резервного копирования необходимо пересмотреть.</span><span class="sxs-lookup"><span data-stu-id="42034-909">When deploying SAP ASE into Azure your backup methodology must be reviewed.</span></span> <span data-ttu-id="42034-910">Даже если система не используется для производственных задач, необходимо периодически выполнять резервное копирование базы данных SAP, размещенной в SAP ASE.</span><span class="sxs-lookup"><span data-stu-id="42034-910">Even if the system is not a productive system, the SAP database hosted by SAP ASE must be backed up periodically.</span></span> <span data-ttu-id="42034-911">Так как в службе хранилища Azure хранятся три образа, резервное копирование становится менее важным с точки зрения восстановления хранилища после сбоя.</span><span class="sxs-lookup"><span data-stu-id="42034-911">Since Azure Storage keeps three images, a backup is now less important in respect to compensating a storage crash.</span></span> <span data-ttu-id="42034-912">Основная причина соблюдения надлежащего плана резервного копирования и восстановления следующая. Благодаря возможности восстанавливать состояние на определенный момент времени вы можете исправлять логические и пользовательские ошибки.</span><span class="sxs-lookup"><span data-stu-id="42034-912">The primary reason for maintaining a proper backup and restore plan is more that you can compensate for logical/manual errors by providing point in time recovery capabilities.</span></span> <span data-ttu-id="42034-913">Следовательно, резервные копии используются для восстановления состояния базы данных на определенный момент времени или для создания другой системы в Azure путем копирования существующей базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-913">So the goal is to either use backups to restore the database back to a certain point in time or to use the backups in Azure to seed another system by copying the existing database.</span></span> <span data-ttu-id="42034-914">Например, с помощью восстановления из резервной копии вы можете перейти от двухуровневой конфигурации SAP к трехуровневой для той же системы.</span><span class="sxs-lookup"><span data-stu-id="42034-914">For example, you could transfer from a 2-Tier SAP configuration to a 3-Tier system setup of the same system by restoring a backup.</span></span>

<span data-ttu-id="42034-915">Резервное копирование и восстановление базы данных в Azure работает так же, как и в локальных системах.</span><span class="sxs-lookup"><span data-stu-id="42034-915">Backing up and restoring a database in Azure works the same way as it does on-premises.</span></span> <span data-ttu-id="42034-916">Ознакомьтесь с примечаниями к SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-916">See SAP Notes:</span></span>

* <span data-ttu-id="42034-917">[1588316]</span><span class="sxs-lookup"><span data-stu-id="42034-917">[1588316]</span></span>
* <span data-ttu-id="42034-918">[1585981.]</span><span class="sxs-lookup"><span data-stu-id="42034-918">[1585981]</span></span>

<span data-ttu-id="42034-919">В них вы найдете дополнительные сведения о создании конфигураций дампов и планировании резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="42034-919">for details on creating dump configurations and scheduling backups.</span></span> <span data-ttu-id="42034-920">В зависимости от стратегии и потребностей можно настроить запись дампов базы данных и журнала на диск на одном из существующих дисков или добавить дополнительный диск для резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-920">Depending on your strategy and needs you can configure database and log dumps to disk onto one of the existing disks or add an additional disk for the backup.</span></span> <span data-ttu-id="42034-921">Чтобы снизить риск потери данных в случае возникновения ошибки, мы рекомендуем использовать диск, на котором нет устройства базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-921">To reduce the danger of data loss in case of an error, it is recommended to use a disk where no database device is located.</span></span>

<span data-ttu-id="42034-922">Помимо сжатия данных и больших объектов система SAP ASE также предлагает сжатие резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-922">Besides data- and LOB compression SAP ASE also offers backup compression.</span></span> <span data-ttu-id="42034-923">Чтобы дампы базы данных и журнала занимали меньше места, рекомендуется использовать сжатие резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-923">To occupy less space with the database and log dumps it is recommended to use backup compression.</span></span> <span data-ttu-id="42034-924">Дополнительные сведения см. в примечании SAP [1588316].</span><span class="sxs-lookup"><span data-stu-id="42034-924">For more information, see SAP Note [1588316].</span></span> <span data-ttu-id="42034-925">Сжатие резервных копий также позволяет существенно уменьшить объем данных при передаче. Это актуально, если вы планируете скачивать резервные копии или содержимое виртуальных дисков с дампами резервных копий с виртуальных машин Azure в локальную систему.</span><span class="sxs-lookup"><span data-stu-id="42034-925">Compressing the backup is also crucial to reduce the amount of data to be transferred if you plan to download backups or VHDs containing backup dumps from the Azure Virtual Machine to on-premises.</span></span>

<span data-ttu-id="42034-926">Не используйте диск D:\ в качестве назначения дампа базы данных или журнала.</span><span class="sxs-lookup"><span data-stu-id="42034-926">Do not use drive D:\ as database or log dump destination.</span></span>

#### <a name="performance-considerations-for-backupsrestores"></a><span data-ttu-id="42034-927">Рекомендации по ускорению резервного копирования и восстановления</span><span class="sxs-lookup"><span data-stu-id="42034-927">Performance Considerations for Backups/Restores</span></span>
<span data-ttu-id="42034-928">Как и при развертывании на сервер без операционной системы, скорость резервного копирования и восстановления зависит от количества томов, которые могут считываться параллельно, а также от пропускной способности этих томов.</span><span class="sxs-lookup"><span data-stu-id="42034-928">As in bare-metal deployments, backup/restore performance is dependent on how many volumes can be read in parallel and what the throughput of those volumes might be.</span></span> <span data-ttu-id="42034-929">Кроме того, загрузка ЦП при сжатии резервной копии может играть значительную роль на виртуальных машинах, имеющих не более восьми потоков ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-929">In addition, the CPU consumption used by backup compression may play a significant role on VMs with just up to eight CPU threads.</span></span> <span data-ttu-id="42034-930">Исходя из сказанного выше, можно сделать следующие выводы.</span><span class="sxs-lookup"><span data-stu-id="42034-930">Therefore, one can assume:</span></span>

* <span data-ttu-id="42034-931">Чем меньше дисков используется для хранения устройств базы данных, тем меньше общая пропускная способность при чтении.</span><span class="sxs-lookup"><span data-stu-id="42034-931">The fewer the number of disks used to store the database devices, the smaller the overall throughput in reading</span></span>
* <span data-ttu-id="42034-932">Чем меньше потоков ЦП на виртуальной машине, тем сильнее влияние сжатия резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-932">The smaller the number of CPU threads in the VM, the more severe the impact of backup compression</span></span>
* <span data-ttu-id="42034-933">Чем меньше целевых объектов (чередующиеся каталоги, диски), на которые записываются резервные копии, тем меньше пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="42034-933">The fewer targets (Stripe Directories, disks) to write the backup to, the lesser the throughput</span></span>

<span data-ttu-id="42034-934">Увеличить количество целевых объектов для записи можно двумя способами. Выбор того или иного варианта (и даже их сочетания) зависит от ваших потребностей.</span><span class="sxs-lookup"><span data-stu-id="42034-934">To increase the number of targets to write to there are two options, which can be used/combined depending on your needs:</span></span>

* <span data-ttu-id="42034-935">Распределить содержимое целевого тома, на котором хранятся резервные копии, между несколькими подключенными дисками, чтобы увеличить на чередующемся томе количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-935">Striping the backup target volume over multiple mounted disks in order to improve the IOPS throughput on that striped volume</span></span>
* <span data-ttu-id="42034-936">Создать конфигурацию дампов на уровне SAP ASE, в которой дампы записываются в несколько целевых каталогов.</span><span class="sxs-lookup"><span data-stu-id="42034-936">Creating a dump configuration on SAP ASE level, which uses more than one target directory to write the dump to</span></span>

<span data-ttu-id="42034-937">Сведения о распределении тома между несколькими дисками см. выше в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="42034-937">Striping a volume over multiple mounted disks has been discussed earlier in this guide.</span></span> <span data-ttu-id="42034-938">Дополнительные сведения об использовании нескольких каталогов в конфигурации дампов в SAP ASE см. в документации по хранимой процедуре sp_config_dump, которая используется для создания конфигурации дампов, в [справочном центре Sybase](http://infocenter.sybase.com/help/index.jsp).</span><span class="sxs-lookup"><span data-stu-id="42034-938">For more information on using multiple directories in the SAP ASE dump configuration, refer to the documentation on Stored Procedure sp_config_dump, which is used to create the dump configuration on the [Sybase Infocenter](http://infocenter.sybase.com/help/index.jsp).</span></span>

### <a name="disaster-recovery-with-azure-vms"></a><span data-ttu-id="42034-939">Аварийное восстановление с помощью виртуальных машин Azure</span><span class="sxs-lookup"><span data-stu-id="42034-939">Disaster Recovery with Azure VMs</span></span>
#### <a name="data-replication-with-sap-sybase-replication-server"></a><span data-ttu-id="42034-940">Репликация данных с помощью сервера репликации SAP Sybase</span><span class="sxs-lookup"><span data-stu-id="42034-940">Data Replication with SAP Sybase Replication Server</span></span>
<span data-ttu-id="42034-941">Сервер репликации SAP Sybase (SRS) в SAP ASE — это "теплый" резервный сервер, используемый для асинхронной передачи транзакций базы данных в удаленное расположение.</span><span class="sxs-lookup"><span data-stu-id="42034-941">With the SAP Sybase Replication Server (SRS) SAP ASE provides a warm standby solution to transfer database transactions to a distant location asynchronously.</span></span> 

<span data-ttu-id="42034-942">Установка и эксплуатация сервера SRS на виртуальной машине, размещенной в службах виртуальных машин Azure, функционально ничем не отличается от аналогичных операций в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-942">The installation and operation of SRS works as well functionally in a VM hosted in Azure Virtual Machine Services as it does on-premises.</span></span>

<span data-ttu-id="42034-943">Поддержка функций HADR ASE через сервер репликации SAP запланирована в будущем выпуске.</span><span class="sxs-lookup"><span data-stu-id="42034-943">ASE HADR via SAP Replication Server is planned with a future release.</span></span> <span data-ttu-id="42034-944">Это решение будет протестировано и выпущено для платформ Microsoft Azure, как только оно станет доступно.</span><span class="sxs-lookup"><span data-stu-id="42034-944">It will be tested with and released for Microsoft Azure platforms as soon as it is available.</span></span>

## <a name="specifics-to-sap-ase-on-linux"></a><span data-ttu-id="42034-945">Особенности SAP ASE на платформе Linux</span><span class="sxs-lookup"><span data-stu-id="42034-945">Specifics to SAP ASE on Linux</span></span>
<span data-ttu-id="42034-946">Начиная с Microsoft Azure, можно легко переносить существующие приложения SAP ASE на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-946">Starting with Microsoft Azure, you can easily migrate your existing SAP ASE applications to Azure Virtual Machines.</span></span> <span data-ttu-id="42034-947">SAP ASE на виртуальной машине позволяет снизить общую стоимость владения для развертывания и обслуживания приложений уровня организации, а также управления ими благодаря переносу этих приложений в Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-947">SAP ASE in a Virtual Machine enables you to reduce the total cost of ownership of deployment, management, and maintenance of enterprise breadth applications by easily migrating these applications to Microsoft Azure.</span></span> <span data-ttu-id="42034-948">С помощью SAP ASE на виртуальной машине Azure администраторы и разработчики могут продолжать использовать те же средства разработки и администрирования, которые доступны в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-948">With SAP ASE in an Azure Virtual Machine, administrators and developers can still use the same development and administration tools that are available on-premises.</span></span>

<span data-ttu-id="42034-949">Для развертывания виртуальных машин Azure важно учитывать официальные соглашения об уровне обслуживания, которые можно найти здесь: <https://azure.microsoft.com/support/legal/sla>.</span><span class="sxs-lookup"><span data-stu-id="42034-949">For deploying Azure VMs it's important to know the official SLAs, which can be found here: <https://azure.microsoft.com/support/legal/sla></span></span>

<span data-ttu-id="42034-950">Сведения о размерах SAP и перечень сертифицированных SAP SKU виртуальных машин предоставлены в примечании к SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="42034-950">SAP sizing information and a list of SAP certified VM SKUs is provided in SAP Note [1928533].</span></span> <span data-ttu-id="42034-951">Дополнительные документы о размерах SAP для виртуальных машин Azure можно найти здесь <http://blogs.msdn.com/b/saponsqlserver/archive/2015/06/19/how-to-size-sap-systems-running-on-azure-vms.aspx> и здесь <http://blogs.msdn.com/b/saponsqlserver/archive/2015/12/01/new-white-paper-on-sizing-sap-solutions-on-azure-public-cloud.aspx>.</span><span class="sxs-lookup"><span data-stu-id="42034-951">Additional SAP sizing documents for Azure Virtual machines can be found here <http://blogs.msdn.com/b/saponsqlserver/archive/2015/06/19/how-to-size-sap-systems-running-on-azure-vms.aspx> and here <http://blogs.msdn.com/b/saponsqlserver/archive/2015/12/01/new-white-paper-on-sizing-sap-solutions-on-azure-public-cloud.aspx></span></span>

<span data-ttu-id="42034-952">Инструкции и рекомендации по использованию службы хранилища Azure, развертыванию виртуальных машин SAP или мониторингу SAP применяются к развертываниям SAP ASE в сочетании с приложениями SAP, как указано в первых четырех главах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-952">Statements and recommendations in regard to the usage of Azure Storage, Deployment of SAP VMs or SAP Monitoring apply to deployments of SAP ASE in conjunction with SAP applications as stated throughout the first four chapters of this document.</span></span>

<span data-ttu-id="42034-953">Общие сведения об ASE на Linux и ASE в облаке содержатся в следующих двух примечаниях SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-953">The following two SAP Notes include general information about ASE on Linux and ASE in the Cloud:</span></span>

* <span data-ttu-id="42034-954">[2134316]</span><span class="sxs-lookup"><span data-stu-id="42034-954">[2134316]</span></span>
* <span data-ttu-id="42034-955">[1941500]</span><span class="sxs-lookup"><span data-stu-id="42034-955">[1941500]</span></span>

### <a name="sap-ase-version-support"></a><span data-ttu-id="42034-956">Поддержка версий SAP ASE</span><span class="sxs-lookup"><span data-stu-id="42034-956">SAP ASE Version Support</span></span>
<span data-ttu-id="42034-957">SAP в настоящее время поддерживает версию SAP ASE 16.0 для использования с продуктами SAP Business Suite.</span><span class="sxs-lookup"><span data-stu-id="42034-957">SAP currently supports SAP ASE version 16.0 for use with SAP Business Suite products.</span></span> <span data-ttu-id="42034-958">Все обновления для сервера SAP ASE, а также драйверы JDBC и ODBC для продуктов SAP Business Suite доступны только в SAP Service Marketplace по адресу <https://support.sap.com/swdc>.</span><span class="sxs-lookup"><span data-stu-id="42034-958">All updates for SAP ASE server, or JDBC and ODBC drivers to be used with SAP Business Suite products are provided solely through the SAP Service Marketplace at: <https://support.sap.com/swdc>.</span></span>

<span data-ttu-id="42034-959">Для установки в локальной среде не следует загружать обновления для сервера SAP ASE или драйверы JDBC и ODBC непосредственно с веб-сайтов Sybase.</span><span class="sxs-lookup"><span data-stu-id="42034-959">As for installations on-premises, do not download updates for the SAP ASE server, or for the JDBC and ODBC drivers directly from Sybase websites.</span></span> <span data-ttu-id="42034-960">Подробные сведения об исправлениях, которые поддерживаются для использования с продуктами SAP Business Suite в локальной среде и на виртуальных машинах Azure, см. в следующих примечаниях SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-960">For detailed information on patches, which are supported for use with SAP Business Suite products on-premises and in Azure Virtual Machines see the following SAP Notes:</span></span>

* <span data-ttu-id="42034-961">[1590719]</span><span class="sxs-lookup"><span data-stu-id="42034-961">[1590719]</span></span>
* <span data-ttu-id="42034-962">[1973241]</span><span class="sxs-lookup"><span data-stu-id="42034-962">[1973241]</span></span>

<span data-ttu-id="42034-963">Общие сведения о запуске SAP Business Suite в SAP ASE можно найти на сайте [SCN](https://www.sap.com/community/topic/ase.html)</span><span class="sxs-lookup"><span data-stu-id="42034-963">General information on running SAP Business Suite on SAP ASE can be found in the [SCN](https://www.sap.com/community/topic/ase.html)</span></span>

### <a name="sap-ase-configuration-guidelines-for-sap-related-sap-ase-installations-in-azure-vms"></a><span data-ttu-id="42034-964">Рекомендации по конфигурации SAP ASE для связанных с SAP установок SAP ASE на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="42034-964">SAP ASE Configuration Guidelines for SAP-related SAP ASE Installations in Azure VMs</span></span>
#### <a name="structure-of-the-sap-ase-deployment"></a><span data-ttu-id="42034-965">Структура развертывания SAP ASE</span><span class="sxs-lookup"><span data-stu-id="42034-965">Structure of the SAP ASE Deployment</span></span>
<span data-ttu-id="42034-966">В соответствии с общим описанием исполняемые файлы SAP ASE должны быть расположены или установлены в корневой файловой системе виртуальной машины ( /sybase ).</span><span class="sxs-lookup"><span data-stu-id="42034-966">In accordance with the general description, SAP ASE executables should be located or installed into the root file system of the VM ( /sybase ).</span></span> <span data-ttu-id="42034-967">Как правило, большинство баз данных системы и средств SAP ASE не особо активно используются рабочей нагрузкой SAP NetWeaver.</span><span class="sxs-lookup"><span data-stu-id="42034-967">Typically, most of the SAP ASE system and tools databases are not really leveraged hard by SAP NetWeaver workload.</span></span> <span data-ttu-id="42034-968">Поэтому базы данных системы и средств (master, model, saptools, sybmgmtdb, sybsystemdb) могут также оставаться в корневой файловой системе.</span><span class="sxs-lookup"><span data-stu-id="42034-968">Hence the system and tools databases (master, model, saptools, sybmgmtdb, sybsystemdb) can remain on the root file system as well.</span></span> 

<span data-ttu-id="42034-969">Исключением может быть временная база данных, содержащая все рабочие таблицы и временные таблицы, созданные SAP ASE, что в случае некоторых рабочих нагрузок SAP ERP и всех рабочих нагрузок BW может потребовать большего объема данных или объема операций ввода-вывода, с которым не справится диск операционной системы исходной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-969">An exception could be the temporary database containing all work tables and temporary tables created by SAP ASE, which in case of some SAP ERP and all BW workloads might require either higher data volume or I/O operations, volume which can’t fit into the original VM’s OS disk.</span></span>

<span data-ttu-id="42034-970">В зависимости от версии SAPInst или SWPM, использованной для установки системы, база данных может содержать следующие компоненты.</span><span class="sxs-lookup"><span data-stu-id="42034-970">Depending on the version of SAPInst/SWPM used to install the system, the database might contain:</span></span>

* <span data-ttu-id="42034-971">Отдельную базу tempdb SAP ASE, которая создается при установке SAP ASE.</span><span class="sxs-lookup"><span data-stu-id="42034-971">A single SAP ASE tempdb, which is created when installing SAP ASE</span></span>
* <span data-ttu-id="42034-972">Базу tempdb SAP ASE, созданную при установке SAP ASE, и дополнительную базу saptempdb, созданную процедурой установки SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-972">An SAP ASE tempdb created by installing SAP ASE and an additional saptempdb created by the SAP installation routine</span></span>
* <span data-ttu-id="42034-973">Базу данных tempdb SAP ASE, созданную при установке SAP ASE, и дополнительную базу данных tempdb, созданную вручную (например, согласно примечанию к SAP [1752266]) для соответствия особым требованиям tempdb к ERP/BW.</span><span class="sxs-lookup"><span data-stu-id="42034-973">An SAP ASE tempdb created by installing SAP ASE and an additional tempdb that has been created manually (for example following SAP Note [1752266]) to meet ERP/BW specific tempdb requirements</span></span>

<span data-ttu-id="42034-974">При определенных рабочих нагрузках ERP или всех рабочих нагрузках BW имеет смысл по соображениям производительности поддерживать работу устройств tempdb дополнительно созданной базы данных tempdb (с помощью SWPM или вручную) в отдельной файловой системе, которая может быть представлена одним диском данных Azure или RAID-массивом Linux, охватывающим несколько дисков данных Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-974">In case of specific ERP or all BW workloads, it makes sense, in regard to performance, to keep the tempdb devices of the additionally created tempdb (by SWPM or manually) on a separate file system, which can be represented by a single Azure data disk or a Linux RAID spanning multiple Azure data disks.</span></span> <span data-ttu-id="42034-975">При отсутствии дополнительной базы данных tempdb рекомендуется ее создать (примечание к SAP [1752266]).</span><span class="sxs-lookup"><span data-stu-id="42034-975">If no additional tempdb exists, it is recommended to create one (SAP Note [1752266]).</span></span>

<span data-ttu-id="42034-976">Для таких систем необходимо выполнить следующие действия над дополнительно созданной базой данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="42034-976">For such systems the following steps should be performed for the additionally created tempdb:</span></span>

* <span data-ttu-id="42034-977">Переместить первый каталог базы данных tempdb в первую файловую систему базы данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-977">Move the first tempdb directory to the first file system of the SAP database</span></span>
* <span data-ttu-id="42034-978">Добавить каталоги tempdb на каждый диск, содержащий файловую систему базы данных SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-978">Add tempdb directories to each of the disks containing a filesystem of the SAP database</span></span>

<span data-ttu-id="42034-979">Эта конфигурация позволяет tempdb потреблять больше пространства, чем может предоставить системный диск.</span><span class="sxs-lookup"><span data-stu-id="42034-979">This configuration enables tempdb to either consume more space than the system drive is able to provide.</span></span> <span data-ttu-id="42034-980">Для справки можно проверить размеры каталогов tempdb в существующих системах, работающих локально.</span><span class="sxs-lookup"><span data-stu-id="42034-980">As a reference one can check the tempdb directory sizes on existing systems, which run on-premises.</span></span> <span data-ttu-id="42034-981">Или же такая конфигурация обеспечит такие показатели операций ввода-вывода в tempdb, которые не могут быть предоставлены системным диском.</span><span class="sxs-lookup"><span data-stu-id="42034-981">Or such a configuration would enable IOPS numbers against tempdb, which cannot be provided with the system drive.</span></span> <span data-ttu-id="42034-982">Опять же, системы, работающие в локальной среде, можно использовать для мониторинга рабочей нагрузки ввода-вывода на базу данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="42034-982">Again systems that are running on-premises can be used to monitor I/O workload against tempdb.</span></span>

<span data-ttu-id="42034-983">Никогда не помещайте каталоги SAP ASE в каталог /mnt или /mnt/resource виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-983">Never put any SAP ASE directories onto /mnt or /mnt/resource of the VM.</span></span> <span data-ttu-id="42034-984">Это правило также касается базы данных tempdb, даже если объекты, содержащиеся в tempdb, являются только временными, так как /mnt или /mnt/resource — это стандартное временное пространство виртуальной машины Azure, которое не сохраняется на постоянной основе.</span><span class="sxs-lookup"><span data-stu-id="42034-984">This also applies to the tempdb, even if the objects kept in the tempdb are only temporary because /mnt or /mnt/resource is a default Azure VM temp space, which is not persistent.</span></span> <span data-ttu-id="42034-985">Дополнительные сведения о временном пространстве виртуальной машины Azure можно найти в [этой статье][virtual-machines-linux-how-to-attach-disk].</span><span class="sxs-lookup"><span data-stu-id="42034-985">More details about the Azure VM temp space can be found in [this article][virtual-machines-linux-how-to-attach-disk]</span></span>

#### <a name="impact-of-database-compression"></a><span data-ttu-id="42034-986">Влияние сжатия базы данных</span><span class="sxs-lookup"><span data-stu-id="42034-986">Impact of Database Compression</span></span>
<span data-ttu-id="42034-987">В конфигурациях, в которых пропускная способность ввода-вывода может стать ограничивающим фактором, каждая мера, позволяющая сократить объем операций ввода-вывода, помогает растянуть рабочую нагрузку, которую можно запускать в сценарии IaaS, например Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-987">In configurations where I/O bandwidth can become a limiting factor, every measure, which reduces IOPS might help to stretch the workload one can run in an IaaS scenario like Azure.</span></span> <span data-ttu-id="42034-988">Таким образом, настоятельно рекомендуется обязательно использовать сжатие SAP ASE перед отправкой существующей базы данных SAP в Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-988">Therefore, it is strongly recommended to make sure that SAP ASE compression is used before uploading an existing SAP database to Azure.</span></span>

<span data-ttu-id="42034-989">Рекомендация выполнять сжатие перед отправкой в Azure, если оно еще не реализовано, дается по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="42034-989">The recommendation to perform compression before uploading to Azure if it is not already implemented is given out of several reasons:</span></span>

* <span data-ttu-id="42034-990">Объем отправляемых в Azure данных уменьшается.</span><span class="sxs-lookup"><span data-stu-id="42034-990">The amount of data to be uploaded to Azure is lower</span></span>
* <span data-ttu-id="42034-991">Длительность выполнения сжатия короче, при условии, что локально можно использовать более мощное оборудование с большим числом ЦП, более высокой пропускной способностью ввода-вывода или меньшими задержками ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="42034-991">The duration of the compression execution is shorter assuming that one can use stronger hardware with more CPUs or higher I/O bandwidth or less I/O latency on-premises</span></span>
* <span data-ttu-id="42034-992">Уменьшение размеров баз данных может сократить затраты на выделение места на дисках.</span><span class="sxs-lookup"><span data-stu-id="42034-992">Smaller database sizes might lead to less costs for disk allocation</span></span>

<span data-ttu-id="42034-993">Сжатие данных и LOB работает на виртуальных машинах Azure так же, как и в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-993">Data- and LOB-Compression work in a VM hosted in Azure Virtual Machines as it does on-premises.</span></span> <span data-ttu-id="42034-994">Дополнительные сведения о том, как проверить, используется ли уже сжатие в существующей базе данных SAP ASE, см. в примечании к SAP [1750510].</span><span class="sxs-lookup"><span data-stu-id="42034-994">For more details on how to check if compression is already in use in an existing SAP ASE database, check SAP Note [1750510].</span></span> <span data-ttu-id="42034-995">Дополнительные сведения о сжатии баз данных см. в примечании к SAP [2121797].</span><span class="sxs-lookup"><span data-stu-id="42034-995">For additional information regarding database compression, see SAP Note [2121797].</span></span>

#### <a name="using-dbacockpit-to-monitor-database-instances"></a><span data-ttu-id="42034-996">Использование DBACockpit для мониторинга экземпляров баз данных</span><span class="sxs-lookup"><span data-stu-id="42034-996">Using DBACockpit to monitor Database Instances</span></span>
<span data-ttu-id="42034-997">Для систем SAP, в которых используется SAP ASE в качестве платформы баз данных, средство DBACockpit доступно в виде встроенных окон браузера в DBACockpit для транзакции или в виде Webdynpro.</span><span class="sxs-lookup"><span data-stu-id="42034-997">For SAP systems, which are using SAP ASE as database platform, the DBACockpit is accessible as embedded browser windows in transaction DBACockpit or as Webdynpro.</span></span> <span data-ttu-id="42034-998">Однако полный набор функций для мониторинга и администрирования базы данных доступен только в реализации Webdynpro средства DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="42034-998">However the full functionality for monitoring and administering the database is available in the Webdynpro implementation of the DBACockpit only.</span></span>

<span data-ttu-id="42034-999">Как и для локальных систем, требуется выполнить ряд действий, чтобы включить все функциональные возможности SAP NetWeaver, используемые в реализации Webdynpro средства DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="42034-999">As with on-premises systems several steps are required to enable all SAP NetWeaver functionality used by the Webdynpro implementation of the DBACockpit.</span></span> <span data-ttu-id="42034-1000">Ознакомьтесь с информацией в примечании к SAP [1245200] , чтобы включить использование инструментов Webdynpro и создать те из них, которые необходимы.</span><span class="sxs-lookup"><span data-stu-id="42034-1000">Follow SAP Note [1245200] to enable the usage of webdynpros and generate the required ones.</span></span> <span data-ttu-id="42034-1001">При соблюдении инструкций в упомянутых выше примечаниях будет также выполнена настройка Internet Communication Manager (icm) вместе с портами, используемыми для подключений http и https.</span><span class="sxs-lookup"><span data-stu-id="42034-1001">When following the instructions in the above notes, you also configure the Internet Communication Manager (icm) along with the ports to be used for http and https connections.</span></span> <span data-ttu-id="42034-1002">Настройка по умолчанию для http выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="42034-1002">The default setting for http looks like this:</span></span>

> <span data-ttu-id="42034-1003">icm/server_port_0 = PROT=HTTP,PORT=8000,PROCTIMEOUT=600,TIMEOUT=600</span><span class="sxs-lookup"><span data-stu-id="42034-1003">icm/server_port_0 = PROT=HTTP,PORT=8000,PROCTIMEOUT=600,TIMEOUT=600</span></span>
> 
> <span data-ttu-id="42034-1004">icm/server_port_1 = PROT=HTTPS,PORT=443$$,PROCTIMEOUT=600,TIMEOUT=600</span><span class="sxs-lookup"><span data-stu-id="42034-1004">icm/server_port_1 = PROT=HTTPS,PORT=443$$,PROCTIMEOUT=600,TIMEOUT=600</span></span>
> 
> 

<span data-ttu-id="42034-1005">Ссылки, создаваемые в DBACockpit для транзакции, будут выглядеть примерно так:</span><span class="sxs-lookup"><span data-stu-id="42034-1005">and the links generated in transaction DBACockpit will look similar to this:</span></span>

> <span data-ttu-id="42034-1006">https://`<fullyqualifiedhostname`>:44300/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-1006">https://`<fullyqualifiedhostname`>:44300/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> <span data-ttu-id="42034-1007">http://`<fullyqualifiedhostname`>:8000/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-1007">http://`<fullyqualifiedhostname`>:8000/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> 

<span data-ttu-id="42034-1008">В зависимости от того, подключена ли виртуальная машина Azure, на которой размещается система SAP, в режиме "сеть — сеть", в режиме многосетевого подключения или ExpressRoute (распределенное развертывание), а также от способа этого подключения, необходимо убедиться, что ICM использует полное имя узла, которое может быть разрешено на компьютере, с которого вы пытаетесь открыть DBACockpit.</span><span class="sxs-lookup"><span data-stu-id="42034-1008">Depending on if and how the Azure Virtual Machine hosting the SAP system is connected via site-to-site, multi-site or ExpressRoute (Cross-Premises deployment) you need to make sure that ICM is using a fully qualified hostname that can be resolved on the machine where you are trying to open the DBACockpit from.</span></span> <span data-ttu-id="42034-1009">Чтобы узнать, как ICM определяет полное имя узла в зависимости от параметров профиля, а также явным образом задать параметр icm/host_name_full (если необходимо), ознакомьтесь с примечанием к SAP [773830].</span><span class="sxs-lookup"><span data-stu-id="42034-1009">See SAP Note [773830] to understand how ICM determines the fully qualified host name depending on profile parameters and set parameter icm/host_name_full explicitly if required.</span></span>

<span data-ttu-id="42034-1010">Если вы развернули виртуальную машину только в облачной среде (без подключения между локальной средой и Azure), вам необходимо определить общедоступный IP-адрес и метку домена.</span><span class="sxs-lookup"><span data-stu-id="42034-1010">If you deployed the VM in a Cloud-Only scenario without cross-premises connectivity between on-premises and Azure, you need to define a public IP address and a domainlabel.</span></span> <span data-ttu-id="42034-1011">Тогда формат общедоступного DNS-имени виртуальной машины будет выглядеть так:</span><span class="sxs-lookup"><span data-stu-id="42034-1011">The format of the public DNS name of the VM looks like this:</span></span>

> <span data-ttu-id="42034-1012">`<custom domainlabel`>.`<azure region`>.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="42034-1012">`<custom domainlabel`>.`<azure region`>.cloudapp.azure.com</span></span>
> 
> 

<span data-ttu-id="42034-1013">Дополнительную информацию о DNS-имени см. [здесь][virtual-machines-azurerm-versus-azuresm].</span><span class="sxs-lookup"><span data-stu-id="42034-1013">More details related to the DNS name can be found [here][virtual-machines-azurerm-versus-azuresm].</span></span>

<span data-ttu-id="42034-1014">Если для параметра профиля SAP icm/host_name_full задать DNS-имя виртуальной машины Azure, ссылка может выглядеть так:</span><span class="sxs-lookup"><span data-stu-id="42034-1014">Setting the SAP profile parameter icm/host_name_full to the DNS name of the Azure VM the link might look similar to:</span></span>

> <span data-ttu-id="42034-1015">https://mydomainlabel.westeurope.cloudapp.net:44300/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-1015">https://mydomainlabel.westeurope.cloudapp.net:44300/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> <span data-ttu-id="42034-1016">http://mydomainlabel.westeurope.cloudapp.net:8000/sap/bc/webdynpro/sap/dba_cockpit</span><span class="sxs-lookup"><span data-stu-id="42034-1016">http://mydomainlabel.westeurope.cloudapp.net:8000/sap/bc/webdynpro/sap/dba_cockpit</span></span>
> 
> 

<span data-ttu-id="42034-1017">В таком случае необходимо:</span><span class="sxs-lookup"><span data-stu-id="42034-1017">In this case you need to make sure to:</span></span>

* <span data-ttu-id="42034-1018">добавить правила для входящего трафика в группу безопасности сети на портале Azure для портов TCP/IP, используемых для связи с ICM;</span><span class="sxs-lookup"><span data-stu-id="42034-1018">Add Inbound rules to the Network Security Group in the Azure portal for the TCP/IP ports used to communicate with ICM</span></span>
* <span data-ttu-id="42034-1019">добавить правила для входящего трафика в конфигурацию брандмауэра Windows для портов TCP/IP, используемых для связи с ICM.</span><span class="sxs-lookup"><span data-stu-id="42034-1019">Add Inbound rules to the Windows Firewall configuration for the TCP/IP ports used to communicate with the ICM</span></span>

<span data-ttu-id="42034-1020">Для автоматического импорта всех доступных исправлений рекомендуется периодически применять примечания SAP, содержащие наборы исправлений, которые относятся к вашей версии SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-1020">For an automated imported of all corrections available, it is recommended to periodically apply the correction collection SAP Note applicable to your SAP version:</span></span>

* <span data-ttu-id="42034-1021">[1558958;]</span><span class="sxs-lookup"><span data-stu-id="42034-1021">[1558958]</span></span>
* <span data-ttu-id="42034-1022">[1619967;]</span><span class="sxs-lookup"><span data-stu-id="42034-1022">[1619967]</span></span>
* <span data-ttu-id="42034-1023">[1882376.]</span><span class="sxs-lookup"><span data-stu-id="42034-1023">[1882376]</span></span>

<span data-ttu-id="42034-1024">Дополнительные сведения о панели DBA для SAP ASE можно найти в следующих примечаниях SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-1024">Further information about DBA Cockpit for SAP ASE can be found in the following SAP Notes:</span></span>

* <span data-ttu-id="42034-1025">[1605680;]</span><span class="sxs-lookup"><span data-stu-id="42034-1025">[1605680]</span></span>
* <span data-ttu-id="42034-1026">[1757924;]</span><span class="sxs-lookup"><span data-stu-id="42034-1026">[1757924]</span></span>
* <span data-ttu-id="42034-1027">[1757928]</span><span class="sxs-lookup"><span data-stu-id="42034-1027">[1757928]</span></span>
* <span data-ttu-id="42034-1028">[1758182]</span><span class="sxs-lookup"><span data-stu-id="42034-1028">[1758182]</span></span>
* <span data-ttu-id="42034-1029">[1758496;]</span><span class="sxs-lookup"><span data-stu-id="42034-1029">[1758496]</span></span>    
* <span data-ttu-id="42034-1030">[1814258;]</span><span class="sxs-lookup"><span data-stu-id="42034-1030">[1814258]</span></span>
* <span data-ttu-id="42034-1031">[1922555;]</span><span class="sxs-lookup"><span data-stu-id="42034-1031">[1922555]</span></span>
* <span data-ttu-id="42034-1032">[1956005.]</span><span class="sxs-lookup"><span data-stu-id="42034-1032">[1956005]</span></span>

#### <a name="backuprecovery-considerations-for-sap-ase"></a><span data-ttu-id="42034-1033">Рекомендации по резервному копированию и восстановлению для SAP ASE</span><span class="sxs-lookup"><span data-stu-id="42034-1033">Backup/Recovery Considerations for SAP ASE</span></span>
<span data-ttu-id="42034-1034">При развертывании SAP ASE в Azure методику резервного копирования необходимо пересмотреть.</span><span class="sxs-lookup"><span data-stu-id="42034-1034">When deploying SAP ASE into Azure your backup methodology must be reviewed.</span></span> <span data-ttu-id="42034-1035">Даже если система не используется для производственных задач, необходимо периодически выполнять резервное копирование базы данных SAP, размещенной в SAP ASE.</span><span class="sxs-lookup"><span data-stu-id="42034-1035">Even if the system is not a productive system, the SAP database hosted by SAP ASE must be backed up periodically.</span></span> <span data-ttu-id="42034-1036">Так как в службе хранилища Azure хранятся три образа, резервное копирование становится менее важным с точки зрения восстановления хранилища после сбоя.</span><span class="sxs-lookup"><span data-stu-id="42034-1036">Since Azure Storage keeps three images, a backup is now less important in respect to compensating a storage crash.</span></span> <span data-ttu-id="42034-1037">Основная причина соблюдения надлежащего плана резервного копирования и восстановления следующая. Благодаря возможности восстанавливать состояние на определенный момент времени вы можете исправлять логические и пользовательские ошибки.</span><span class="sxs-lookup"><span data-stu-id="42034-1037">The primary reason for maintaining a proper backup and restore plan is more that you can compensate for logical/manual errors by providing point in time recovery capabilities.</span></span> <span data-ttu-id="42034-1038">Следовательно, резервные копии используются для восстановления состояния базы данных на определенный момент времени или для создания другой системы в Azure путем копирования существующей базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1038">So the goal is to either use backups to restore the database back to a certain point in time or to use the backups in Azure to seed another system by copying the existing database.</span></span> <span data-ttu-id="42034-1039">Например, с помощью восстановления из резервной копии вы можете перейти от двухуровневой конфигурации SAP к трехуровневой для той же системы.</span><span class="sxs-lookup"><span data-stu-id="42034-1039">For example, you could transfer from a 2-Tier SAP configuration to a 3-Tier system setup of the same system by restoring a backup.</span></span>

<span data-ttu-id="42034-1040">Резервное копирование и восстановление базы данных в Azure работает так же, как и в локальных системах.</span><span class="sxs-lookup"><span data-stu-id="42034-1040">Backing up and restoring a database in Azure works the same way as it does on-premises.</span></span> <span data-ttu-id="42034-1041">Ознакомьтесь с примечаниями к SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-1041">See SAP Notes:</span></span>

* <span data-ttu-id="42034-1042">[1588316]</span><span class="sxs-lookup"><span data-stu-id="42034-1042">[1588316]</span></span>
* <span data-ttu-id="42034-1043">[1585981.]</span><span class="sxs-lookup"><span data-stu-id="42034-1043">[1585981]</span></span>

<span data-ttu-id="42034-1044">В них вы найдете дополнительные сведения о создании конфигураций дампов и планировании резервного копирования.</span><span class="sxs-lookup"><span data-stu-id="42034-1044">for details on creating dump configurations and scheduling backups.</span></span> <span data-ttu-id="42034-1045">В зависимости от стратегии и потребностей можно настроить запись дампов базы данных и журнала на диск на одном из существующих дисков или добавить дополнительный диск для резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-1045">Depending on your strategy and needs you can configure database and log dumps to disk onto one of the existing disks or add an additional disk for the backup.</span></span> <span data-ttu-id="42034-1046">Чтобы снизить риск потери данных в случае возникновения ошибки, рекомендуется использовать диск, на котором нет каталога или файлов базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1046">To reduce the danger of data loss in case of an error it is recommended to use a disk where no database directory/file is located.</span></span>

<span data-ttu-id="42034-1047">Помимо сжатия данных и больших объектов система SAP ASE также предлагает сжатие резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-1047">Besides data- and LOB compression SAP ASE also offers backup compression.</span></span> <span data-ttu-id="42034-1048">Чтобы дампы базы данных и журнала занимали меньше места, рекомендуется использовать сжатие резервных копий.</span><span class="sxs-lookup"><span data-stu-id="42034-1048">To occupy less space with the database and log dumps it is recommended to use backup compression.</span></span> <span data-ttu-id="42034-1049">Дополнительные сведения см. в примечании SAP [1588316].</span><span class="sxs-lookup"><span data-stu-id="42034-1049">For more information, see SAP Note [1588316].</span></span> <span data-ttu-id="42034-1050">Сжатие резервных копий также позволяет существенно уменьшить объем данных при передаче. Это актуально, если вы планируете скачивать резервные копии или содержимое виртуальных дисков с дампами резервных копий с виртуальных машин Azure в локальную систему.</span><span class="sxs-lookup"><span data-stu-id="42034-1050">Compressing the backup is also crucial to reduce the amount of data to be transferred if you plan to download backups or VHDs containing backup dumps from the Azure Virtual Machine to on-premises.</span></span>

<span data-ttu-id="42034-1051">Не сохраняйте дампы базы данных или журналов во временные пространства виртуальной машины Azure /mnt и /mnt/resource.</span><span class="sxs-lookup"><span data-stu-id="42034-1051">Do not use the Azure VM temp space /mnt or /mnt/resource as database or log dump destination.</span></span>

#### <a name="performance-considerations-for-backupsrestores"></a><span data-ttu-id="42034-1052">Рекомендации по ускорению резервного копирования и восстановления</span><span class="sxs-lookup"><span data-stu-id="42034-1052">Performance Considerations for Backups/Restores</span></span>
<span data-ttu-id="42034-1053">Как и при развертывании на сервер без операционной системы, скорость резервного копирования и восстановления зависит от количества томов, которые могут считываться параллельно, а также от пропускной способности этих томов.</span><span class="sxs-lookup"><span data-stu-id="42034-1053">As in bare-metal deployments, backup/restore performance is dependent on how many volumes can be read in parallel and what the throughput of those volumes might be.</span></span> <span data-ttu-id="42034-1054">Кроме того, загрузка ЦП при сжатии резервной копии может играть значительную роль на виртуальных машинах, имеющих не более восьми потоков ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-1054">In addition, the CPU consumption used by backup compression may play a significant role on VMs with just up to eight CPU threads.</span></span> <span data-ttu-id="42034-1055">Исходя из сказанного выше, можно сделать следующие выводы.</span><span class="sxs-lookup"><span data-stu-id="42034-1055">Therefore, one can assume:</span></span>

* <span data-ttu-id="42034-1056">Чем меньше дисков используется для хранения устройств базы данных, тем меньше общая пропускная способность при чтении.</span><span class="sxs-lookup"><span data-stu-id="42034-1056">The fewer the number of disks used to store the database devices, the smaller the overall throughput in reading</span></span>
* <span data-ttu-id="42034-1057">Чем меньше потоков ЦП на виртуальной машине, тем сильнее влияние сжатия резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-1057">The smaller the number of CPU threads in the VM, the more severe the impact of backup compression</span></span>
* <span data-ttu-id="42034-1058">Чем меньше целевых объектов (программные RAID-массивы Linux, диски), на которые записываются резервные копии, тем меньше пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="42034-1058">The fewer targets (Linux software RAID, disks) to write the backup to, the lesser the throughput</span></span>

<span data-ttu-id="42034-1059">Увеличить количество целевых объектов для записи можно двумя способами. Выбор того или иного варианта (и даже их сочетания) зависит от ваших потребностей.</span><span class="sxs-lookup"><span data-stu-id="42034-1059">To increase the number of targets to write to there are two options, which can be used/combined depending on your needs:</span></span>

* <span data-ttu-id="42034-1060">Распределить содержимое целевого тома, на котором хранятся резервные копии, между несколькими подключенными дисками, чтобы увеличить на чередующемся томе количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1060">Striping the backup target volume over multiple mounted disks in order to improve the IOPS throughput on that striped volume</span></span>
* <span data-ttu-id="42034-1061">Создать конфигурацию дампов на уровне SAP ASE, в которой дампы записываются в несколько целевых каталогов.</span><span class="sxs-lookup"><span data-stu-id="42034-1061">Creating a dump configuration on SAP ASE level, which uses more than one target directory to write the dump to</span></span>

<span data-ttu-id="42034-1062">Сведения о распределении тома между несколькими дисками см. выше в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="42034-1062">Striping a volume over multiple mounted disks has been discussed earlier in this guide.</span></span> <span data-ttu-id="42034-1063">Дополнительные сведения об использовании нескольких каталогов в конфигурации дампов в SAP ASE см. в документации по хранимой процедуре sp_config_dump, которая используется для создания конфигурации дампов, в [справочном центре Sybase](http://infocenter.sybase.com/help/index.jsp).</span><span class="sxs-lookup"><span data-stu-id="42034-1063">For more information on using multiple directories in the SAP ASE dump configuration, refer to the documentation on Stored Procedure sp_config_dump, which is used to create the dump configuration on the [Sybase Infocenter](http://infocenter.sybase.com/help/index.jsp).</span></span>

### <a name="disaster-recovery-with-azure-vms"></a><span data-ttu-id="42034-1064">Аварийное восстановление с помощью виртуальных машин Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1064">Disaster Recovery with Azure VMs</span></span>
#### <a name="data-replication-with-sap-sybase-replication-server"></a><span data-ttu-id="42034-1065">Репликация данных с помощью сервера репликации SAP Sybase</span><span class="sxs-lookup"><span data-stu-id="42034-1065">Data Replication with SAP Sybase Replication Server</span></span>
<span data-ttu-id="42034-1066">Сервер репликации SAP Sybase (SRS) в SAP ASE — это "теплый" резервный сервер, используемый для асинхронной передачи транзакций базы данных в удаленное расположение.</span><span class="sxs-lookup"><span data-stu-id="42034-1066">With the SAP Sybase Replication Server (SRS) SAP ASE provides a warm standby solution to transfer database transactions to a distant location asynchronously.</span></span> 

<span data-ttu-id="42034-1067">Установка и эксплуатация сервера SRS на виртуальной машине, размещенной в службах виртуальных машин Azure, функционально ничем не отличается от аналогичных операций в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="42034-1067">The installation and operation of SRS works as well functionally in a VM hosted in Azure Virtual Machine Services as it does on-premises.</span></span>

<span data-ttu-id="42034-1068">Сейчас работа ASE HADR через сервер репликации SAP не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="42034-1068">ASE HADR via SAP Replication Server is NOT supported at this point in time.</span></span> <span data-ttu-id="42034-1069">Это решение может быть протестировано и выпущено для платформ Microsoft Azure в будущем.</span><span class="sxs-lookup"><span data-stu-id="42034-1069">It might be tested with and released for Microsoft Azure platforms in the future.</span></span>

## <a name="specifics-to-oracle-database-on-windows"></a><span data-ttu-id="42034-1070">Особенности базы данных Oracle в Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1070">Specifics to Oracle Database on Windows</span></span>
<span data-ttu-id="42034-1071">Программное обеспечение Oracle поддерживает работу с Microsoft Windows Hyper-V и Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1071">Oracle software is supported by Oracle to run on Microsoft Windows Hyper-V and Azure.</span></span> <span data-ttu-id="42034-1072">Дополнительные сведения об общей поддержке Windows Hyper-V и Azure см. здесь: <https://blogs.oracle.com/cloud/entry/oracle_and_microsoft_join_forces>.</span><span class="sxs-lookup"><span data-stu-id="42034-1072">For details on the general support of Windows Hyper-V and Azure, check: <https://blogs.oracle.com/cloud/entry/oracle_and_microsoft_join_forces></span></span> 

<span data-ttu-id="42034-1073">Кроме общей поддержки, также поддерживаются определенные сценарии приложений SAP, использующих базы данных Oracle.</span><span class="sxs-lookup"><span data-stu-id="42034-1073">Following the general support, the specific scenario of SAP applications leveraging Oracle Databases is supported as well.</span></span> <span data-ttu-id="42034-1074">Подробности приведены в этой части документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1074">Details are named in this part of the document.</span></span>

### <a name="oracle-version-support"></a><span data-ttu-id="42034-1075">Поддерживаемые версии Oracle</span><span class="sxs-lookup"><span data-stu-id="42034-1075">Oracle Version Support</span></span>
<span data-ttu-id="42034-1076">Cведения о версиях Oracle и соответствующих версиях ОС, которые поддерживаются для работы SAP в Oracle на виртуальных машинах Azure, см. в примечании к SAP [2039619].</span><span class="sxs-lookup"><span data-stu-id="42034-1076">Oracle versions and corresponding OS versions, which are supported for running SAP on Oracle on Azure Virtual Machines can be found in SAP Note [2039619].</span></span>

<span data-ttu-id="42034-1077">Общие сведения о работе SAP Business Suite в Oracle см. на сайте 1DX: <https://www.sap.com/community/topic/oracle.html>.</span><span class="sxs-lookup"><span data-stu-id="42034-1077">General information about running SAP Business Suite on Oracle can be found in 1DX: <https://www.sap.com/community/topic/oracle.html></span></span>

### <a name="oracle-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1078">Рекомендации по конфигурации Oracle для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1078">Oracle Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <a name="storage-configuration"></a><span data-ttu-id="42034-1079">Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1079">Storage configuration</span></span>
<span data-ttu-id="42034-1080">Поддерживается только один экземпляр Oracle, использующий диски, отформатированные в NTFS.</span><span class="sxs-lookup"><span data-stu-id="42034-1080">Only single instance Oracle using NTFS formatted disks is supported.</span></span> <span data-ttu-id="42034-1081">Все файлы базы данных должны храниться на виртуальных жестких дисках или Управляемых дисках с файловой системой NTFS.</span><span class="sxs-lookup"><span data-stu-id="42034-1081">All database files must be stored on the NTFS file system based on VHDs or Managed Disks.</span></span> <span data-ttu-id="42034-1082">Эти виртуальные жестки диски должны быть подключены к виртуальной машине Azure и созданы на основе хранилища страничных BLOB-объектов Azure (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) или Управляемых дисков (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span><span class="sxs-lookup"><span data-stu-id="42034-1082">These disks are mounted to the Azure VM and are based on Azure Page BLOB Storage (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) or Managed Disks (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span></span> <span data-ttu-id="42034-1083">Любые сетевые диски и удаленные общие ресурсы, включая файловые службы Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1083">Any kind of network drives or remote shares like Azure file services:</span></span>

* <span data-ttu-id="42034-1084"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1084"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span></span> 
* <span data-ttu-id="42034-1085"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1085"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span></span>

<span data-ttu-id="42034-1086">**невозможно** использовать для хранения файлов базы данных Oracle!</span><span class="sxs-lookup"><span data-stu-id="42034-1086">are **NOT** supported for Oracle database files!</span></span>

<span data-ttu-id="42034-1087">Если используются диски, созданные на основе хранилища страничных BLOB-объектов Azure или Управляемых дисков, то сведения, приведенные в этом документе в разделах [Кэширование для виртуальных машин и дисков данных][dbms-guide-2.1] и [Служба хранилища Microsoft Azure][dbms-guide-2.3], относятся также и к развертываниям с базой данных Oracle.</span><span class="sxs-lookup"><span data-stu-id="42034-1087">Using disks based on Azure Page BLOB Storage or Managed Disks, the statements made in this document in chapter [Caching for VMs and data disks][dbms-guide-2.1] and [Microsoft Azure Storage][dbms-guide-2.3] apply to deployments with the Oracle Database as well.</span></span>

<span data-ttu-id="42034-1088">Как упомянуто в общей части этого документа, для дисков Azure существуют квоты на количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1088">As explained earlier in the general part of the document, quotas on IOPS throughput for Azure disks exist.</span></span> <span data-ttu-id="42034-1089">Квоты зависят от типа используемой виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-1089">The exact quotas are depending on the VM type used.</span></span> <span data-ttu-id="42034-1090">Список типов виртуальных машин с соответствующими квотами приведен [здесь (Linux)][virtual-machines-sizes-linux] и [здесь (Windows)][virtual-machines-sizes-windows].</span><span class="sxs-lookup"><span data-stu-id="42034-1090">A list of VM types with their quotas can be found [here (Linux)][virtual-machines-sizes-linux] and [here (Windows)][virtual-machines-sizes-windows].</span></span>

<span data-ttu-id="42034-1091">Чтобы определить поддерживаемые типы виртуальных машин Azure, ознакомьтесь с примечанием к SAP [1928533]</span><span class="sxs-lookup"><span data-stu-id="42034-1091">To identify the supported Azure VM types, refer to SAP note [1928533].</span></span>

<span data-ttu-id="42034-1092">Если текущего количества операций ввода-вывода в секунду для каждого диска достаточно, все файлы базы данных можно хранить на одном подключенном диске Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1092">As long as the current IOPS quota per disk satisfies the requirements, it is possible to store all the DB files on one single mounted disk.</span></span> 

<span data-ttu-id="42034-1093">Если требуется большее количество операций ввода-вывода в секунду, настоятельно рекомендуем использовать пулы носителей Window (доступны только в Windows Server 2012 и более поздних версиях) или функцию чередования дисков (для Windows 2008 R2). Таким образом из нескольких подключенных дисков вы сможете создать одно большое логическое устройство (также см. раздел [Программный RAID-массив][dbms-guide-2.2] этого документа).</span><span class="sxs-lookup"><span data-stu-id="42034-1093">If more IOPS are required, it is strongly recommended to use Window Storage Pools (only available in Windows Server 2012 and higher) or Windows striping for Windows 2008 R2 to create one large logical device over multiple mounted disks (see also chapter [Software RAID][dbms-guide-2.2] of this document).</span></span> <span data-ttu-id="42034-1094">Такой подход позволяет сократить административные расходы на управление дисковым пространством и избежать необходимости вручную распределять файлы между несколькими подключенными дисками.</span><span class="sxs-lookup"><span data-stu-id="42034-1094">This approach simplifies the administration overhead to manage the disk space and avoids the effort to manually distribute files across multiple mounted disks.</span></span>

#### <a name="backup--restore"></a><span data-ttu-id="42034-1095">Резервное копирование и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1095">Backup / Restore</span></span>
<span data-ttu-id="42034-1096">Для резервного копирования и восстановления можно использовать средства SAP BR* для Oracle. Они поддерживаются так же, как и в стандартных операционных системах Windows Server и Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="42034-1096">For backup / restore functionality, the SAP BR*Tools for Oracle are supported in the same way as on standard Windows Server Operating Systems and Hyper-V.</span></span> <span data-ttu-id="42034-1097">Для резервного копирования на диски и восстановления с дисков также можно использовать диспетчер восстановления Oracle (RMAN).</span><span class="sxs-lookup"><span data-stu-id="42034-1097">Oracle Recovery Manager (RMAN) is also supported for backups to disk and restore from disk.</span></span>

#### <a name="high-availability"></a><span data-ttu-id="42034-1098">Высокая доступность</span><span class="sxs-lookup"><span data-stu-id="42034-1098">High Availability</span></span>
<span data-ttu-id="42034-1099">Для обеспечения высокой доступности и аварийного восстановления можно использовать Oracle Data Guard.</span><span class="sxs-lookup"><span data-stu-id="42034-1099">Oracle Data Guard is supported for high availability and disaster recovery purposes.</span></span> <span data-ttu-id="42034-1100">Дополнительные сведения см. в [этой документации][virtual-machines-windows-classic-configure-oracle-data-guard].</span><span class="sxs-lookup"><span data-stu-id="42034-1100">Details can be found in [this][virtual-machines-windows-classic-configure-oracle-data-guard] documentation.</span></span>

#### <a name="other"></a><span data-ttu-id="42034-1101">Другие</span><span class="sxs-lookup"><span data-stu-id="42034-1101">Other</span></span>
<span data-ttu-id="42034-1102">Все другие общие темы, такие как группы доступности Azure и мониторинг SAP, касаются также развертывания виртуальных машин с базой данных Oracle, как описано в первых трех разделах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1102">All other general topics like Azure Availability Sets or SAP monitoring apply as described in the first three chapters of this document for deployments of VMs with the Oracle Database as well.</span></span>

## <a name="specifics-to-oracle-database-on-oracle-linux"></a><span data-ttu-id="42034-1103">Особенности базы данных Oracle в Oracle Linux</span><span class="sxs-lookup"><span data-stu-id="42034-1103">Specifics to Oracle Database on Oracle Linux</span></span>
<span data-ttu-id="42034-1104">Программное обеспечение Oracle поддерживает работу с Microsoft Windows Hyper-V и Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1104">Oracle software is supported by Oracle to run on Microsoft Windows Hyper-V and Azure.</span></span> <span data-ttu-id="42034-1105">Дополнительные сведения об общей поддержке Windows Hyper-V и Azure см. здесь: <https://blogs.oracle.com/cloud/entry/oracle_and_microsoft_join_forces>.</span><span class="sxs-lookup"><span data-stu-id="42034-1105">For details on the general support of Windows Hyper-V and Azure, check: <https://blogs.oracle.com/cloud/entry/oracle_and_microsoft_join_forces></span></span> 

<span data-ttu-id="42034-1106">Кроме общей поддержки, также поддерживаются определенные сценарии приложений SAP, использующих базы данных Oracle.</span><span class="sxs-lookup"><span data-stu-id="42034-1106">Following the general support, the specific scenario of SAP applications leveraging Oracle Databases is supported as well.</span></span> <span data-ttu-id="42034-1107">Подробности приведены в этой части документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1107">Details are named in this part of the document.</span></span>

### <a name="oracle-version-support"></a><span data-ttu-id="42034-1108">Поддерживаемые версии Oracle</span><span class="sxs-lookup"><span data-stu-id="42034-1108">Oracle Version Support</span></span>
<span data-ttu-id="42034-1109">Cведения о версиях Oracle и соответствующих версиях ОС, которые поддерживаются для работы SAP в Oracle на виртуальных машинах Azure, см. в примечании к SAP [2039619].</span><span class="sxs-lookup"><span data-stu-id="42034-1109">Oracle versions and corresponding OS versions, which are supported for running SAP on Oracle on Azure Virtual Machines can be found in SAP Note [2039619].</span></span>

<span data-ttu-id="42034-1110">Общие сведения о работе SAP Business Suite в Oracle см. на сайте 1DX: <https://www.sap.com/community/topic/oracle.html>.</span><span class="sxs-lookup"><span data-stu-id="42034-1110">General information about running SAP Business Suite on Oracle can be found in 1DX: <https://www.sap.com/community/topic/oracle.html></span></span>

### <a name="oracle-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1111">Рекомендации по конфигурации Oracle для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1111">Oracle Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <a name="storage-configuration"></a><span data-ttu-id="42034-1112">Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1112">Storage configuration</span></span>
<span data-ttu-id="42034-1113">Поддерживается только один экземпляр Oracle, использующий диски, отформатированные в EXT3, EXT4 и XFS.</span><span class="sxs-lookup"><span data-stu-id="42034-1113">Only single instance Oracle using ext3, ext4, and xfs formatted disks is supported.</span></span> <span data-ttu-id="42034-1114">Все файлы базы данных должны храниться на виртуальных жестких дисках или Управляемых дисках с этими файловыми системами.</span><span class="sxs-lookup"><span data-stu-id="42034-1114">All database files must be stored on these file systems based on VHDs or Managed Disks.</span></span> <span data-ttu-id="42034-1115">Эти виртуальные жестки диски должны быть подключены к виртуальной машине Azure и созданы на основе хранилища страничных BLOB-объектов Azure (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) или Управляемых дисков (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span><span class="sxs-lookup"><span data-stu-id="42034-1115">These disks are mounted to the Azure VM and are based on Azure Page BLOB Storage (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) or Managed Disks (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span></span> <span data-ttu-id="42034-1116">Любые сетевые диски и удаленные общие ресурсы, включая файловые службы Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1116">Any kind of network drives or remote shares like Azure file services:</span></span>

* <span data-ttu-id="42034-1117"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1117"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span></span> 
* <span data-ttu-id="42034-1118"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1118"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span></span>

<span data-ttu-id="42034-1119">**невозможно** использовать для хранения файлов базы данных Oracle!</span><span class="sxs-lookup"><span data-stu-id="42034-1119">are **NOT** supported for Oracle database files!</span></span>

<span data-ttu-id="42034-1120">Если используются диски, созданные на основе хранилища страничных BLOB-объектов Azure или Управляемых дисков, то сведения, приведенные в этом документе в разделах [Кэширование для виртуальных машин и дисков данных][dbms-guide-2.1] и [Служба хранилища Microsoft Azure][dbms-guide-2.3], относятся также и к развертываниям с базой данных Oracle.</span><span class="sxs-lookup"><span data-stu-id="42034-1120">Using disks based on Azure Page BLOB Storage or Managed Disks, the statements made in this document in chapter [Caching for VMs and data disks][dbms-guide-2.1] and [Microsoft Azure Storage][dbms-guide-2.3] apply to deployments with the Oracle Database as well.</span></span>

<span data-ttu-id="42034-1121">Как упомянуто в общей части этого документа, для дисков Azure существуют квоты на количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1121">As explained earlier in the general part of the document, quotas on IOPS throughput for Azure disks exist.</span></span> <span data-ttu-id="42034-1122">Квоты зависят от типа используемой виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-1122">The exact quotas are depending on the VM type used.</span></span> <span data-ttu-id="42034-1123">Список типов виртуальных машин с соответствующими квотами приведен [здесь (Linux)][virtual-machines-sizes-linux] и [здесь (Windows)][virtual-machines-sizes-windows].</span><span class="sxs-lookup"><span data-stu-id="42034-1123">A list of VM types with their quotas can be found [here (Linux)][virtual-machines-sizes-linux] and [here (Windows)][virtual-machines-sizes-windows].</span></span>

<span data-ttu-id="42034-1124">Чтобы определить поддерживаемые типы виртуальных машин Azure, ознакомьтесь с примечанием к SAP [1928533]</span><span class="sxs-lookup"><span data-stu-id="42034-1124">To identify the supported Azure VM types, refer to SAP note [1928533]</span></span>

<span data-ttu-id="42034-1125">Если текущего количества операций ввода-вывода в секунду для каждого диска достаточно, все файлы базы данных можно хранить на одном подключенном диске Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1125">As long as the current IOPS quota per disk satisfies the requirements, it is possible to store all the DB files on one single mounted disk.</span></span> 

<span data-ttu-id="42034-1126">Если требуется большее количество операций ввода-вывода в секунду, мы настоятельно рекомендуем использовать диспетчер логических томов или MDADM,чтобы создать один большой логический том на несколько подключенных дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-1126">If more IOPS are required, it is strongly recommended to use LVM (Logical Volume Manager) or MDADM to create one large logical volume over multiple mounted disks.</span></span> <span data-ttu-id="42034-1127">Ознакомьтесь также с разделом [Программный RAID-массив][dbms-guide-2.2] в этом документе.</span><span class="sxs-lookup"><span data-stu-id="42034-1127">See also chapter [Software RAID][dbms-guide-2.2] of this document.</span></span> <span data-ttu-id="42034-1128">Такой подход позволяет сократить административные расходы на управление дисковым пространством и избежать необходимости вручную распределять файлы между несколькими подключенными дисками.</span><span class="sxs-lookup"><span data-stu-id="42034-1128">This approach simplifies the administration overhead to manage the disk space and avoids the effort to manually distribute files across multiple mounted disks.</span></span>

#### <a name="backup--restore"></a><span data-ttu-id="42034-1129">Резервное копирование и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1129">Backup / Restore</span></span>
<span data-ttu-id="42034-1130">Для архивации и восстановления можно использовать инструменты SAP BR* для Oracle. Они поддерживаются так же, как и в системе с исходным состоянием и Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="42034-1130">For backup / restore functionality, the SAP BR*Tools for Oracle are supported in the same way as on bare metal and Hyper-V.</span></span> <span data-ttu-id="42034-1131">Для резервного копирования на диски и восстановления с дисков также можно использовать диспетчер восстановления Oracle (RMAN).</span><span class="sxs-lookup"><span data-stu-id="42034-1131">Oracle Recovery Manager (RMAN) is also supported for backups to disk and restore from disk.</span></span>

#### <a name="high-availability"></a><span data-ttu-id="42034-1132">Высокая доступность</span><span class="sxs-lookup"><span data-stu-id="42034-1132">High Availability</span></span>
<span data-ttu-id="42034-1133">Для обеспечения высокой доступности и аварийного восстановления можно использовать Oracle Data Guard.</span><span class="sxs-lookup"><span data-stu-id="42034-1133">Oracle Data Guard is supported for high availability and disaster recovery purposes.</span></span> <span data-ttu-id="42034-1134">Дополнительные сведения см. в [этой документации][virtual-machines-windows-classic-configure-oracle-data-guard].</span><span class="sxs-lookup"><span data-stu-id="42034-1134">Details can be found in [this][virtual-machines-windows-classic-configure-oracle-data-guard] documentation.</span></span>

#### <a name="other"></a><span data-ttu-id="42034-1135">Другие</span><span class="sxs-lookup"><span data-stu-id="42034-1135">Other</span></span>
<span data-ttu-id="42034-1136">Все другие общие темы, такие как группы доступности Azure и мониторинг SAP, касаются также развертывания виртуальных машин с базой данных Oracle, как описано в первых трех разделах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1136">All other general topics like Azure Availability Sets or SAP monitoring apply as described in the first three chapters of this document for deployments of VMs with the Oracle Database as well.</span></span>

## <a name="specifics-for-the-sap-maxdb-database-on-windows"></a><span data-ttu-id="42034-1137">Особенности базы данных SAP MaxDB в Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1137">Specifics for the SAP MaxDB Database on Windows</span></span>
### <a name="sap-maxdb-version-support"></a><span data-ttu-id="42034-1138">Поддерживаемые версии SAP MaxDB</span><span class="sxs-lookup"><span data-stu-id="42034-1138">SAP MaxDB Version Support</span></span>
<span data-ttu-id="42034-1139">Сейчас с продуктами на основе SAP NetWeaver в Azure можно использовать SAP MaxDB версии 7.9.</span><span class="sxs-lookup"><span data-stu-id="42034-1139">SAP currently supports SAP MaxDB version 7.9 for use with SAP NetWeaver-based products in Azure.</span></span> <span data-ttu-id="42034-1140">Все обновления для сервера SAP MaxDB и драйверов JDBC и ODBC для продуктов на основе SAP NetWeaver предоставляются исключительно через SAP Service Marketplace по адресу <https://support.sap.com/swdc>.</span><span class="sxs-lookup"><span data-stu-id="42034-1140">All updates for SAP MaxDB server, or JDBC and ODBC drivers to be used with SAP NetWeaver-based products are provided solely through the SAP Service Marketplace at <https://support.sap.com/swdc>.</span></span>
<span data-ttu-id="42034-1141">Общие сведения о выполнении SAP NetWeaver в SAP MaxDB см. здесь: <https://www.sap.com/community/topic/maxdb.html>.</span><span class="sxs-lookup"><span data-stu-id="42034-1141">General information on running SAP NetWeaver on SAP MaxDB can be found at <https://www.sap.com/community/topic/maxdb.html>.</span></span>

### <a name="supported-microsoft-windows-versions-and-azure-vm-types-for-sap-maxdb-dbms"></a><span data-ttu-id="42034-1142">Поддерживаемые версии Microsoft Windows и типы виртуальных машин Azure для СУБД SAP MaxDB</span><span class="sxs-lookup"><span data-stu-id="42034-1142">Supported Microsoft Windows Versions and Azure VM types for SAP MaxDB DBMS</span></span>
<span data-ttu-id="42034-1143">Сведения о поддерживаемых версиях Microsoft Windows для СУБД SAP MaxDB в Azure, см. по следующим ссылкам:</span><span class="sxs-lookup"><span data-stu-id="42034-1143">To find the supported Microsoft Windows version for SAP MaxDB DBMS on Azure, see:</span></span>

* <span data-ttu-id="42034-1144">[матрица доступности продуктов SAP;][sap-pam]</span><span class="sxs-lookup"><span data-stu-id="42034-1144">[SAP Product Availability Matrix (PAM)][sap-pam]</span></span>
* <span data-ttu-id="42034-1145">примечание к SAP [1928533]</span><span class="sxs-lookup"><span data-stu-id="42034-1145">SAP Note [1928533]</span></span>

<span data-ttu-id="42034-1146">Мы настоятельно рекомендуем использовать последнюю версию операционной системы Microsoft Windows — Microsoft Windows 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="42034-1146">It is highly recommended to use the newest version of the operating system Microsoft Windows, which is Microsoft Windows 2012 R2.</span></span>

### <a name="available-sap-maxdb-documentation"></a><span data-ttu-id="42034-1147">Доступная документация по SAP MaxDB</span><span class="sxs-lookup"><span data-stu-id="42034-1147">Available SAP MaxDB Documentation</span></span>
<span data-ttu-id="42034-1148">Обновленный список документации по SAP MaxDB представлен в примечании к SAP [767598]</span><span class="sxs-lookup"><span data-stu-id="42034-1148">You can find the updated list of SAP MaxDB documentation in the following SAP Note [767598]</span></span>

### <a name="sap-maxdb-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1149">Рекомендации по конфигурации SAP MaxDB для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1149">SAP MaxDB Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <span data-ttu-id="42034-1150"><a name="b48cfe3b-48e9-4f5b-a783-1d29155bd573"></a>Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1150"><a name="b48cfe3b-48e9-4f5b-a783-1d29155bd573"></a>Storage configuration</span></span>
<span data-ttu-id="42034-1151">Рекомендации для службы хранилища Azure и SAP MaxDB соответствуют общим рекомендациям, приведенным в разделе [Структура развертывания реляционной СУБД][dbms-guide-2].</span><span class="sxs-lookup"><span data-stu-id="42034-1151">Azure storage best practices for SAP MaxDB follow the general recommendations mentioned in chapter [Structure of an RDBMS Deployment][dbms-guide-2].</span></span>

> [!IMPORTANT]
> <span data-ttu-id="42034-1152">Как и в других базах данных, в SAP MaxDB тоже есть файлы данных и файлы журналов,</span><span class="sxs-lookup"><span data-stu-id="42034-1152">Like other databases, SAP MaxDB also has data and log files.</span></span> <span data-ttu-id="42034-1153">но в терминологии SAP MaxDB вместо понятия "файл" используется "том".</span><span class="sxs-lookup"><span data-stu-id="42034-1153">However, in SAP MaxDB terminology the correct term is “volume” (not “file”).</span></span> <span data-ttu-id="42034-1154">Например, в SAP MaxDB существуют тома данных и тома журналов.</span><span class="sxs-lookup"><span data-stu-id="42034-1154">For example, there are SAP MaxDB data volumes and log volumes.</span></span> <span data-ttu-id="42034-1155">Не путайте их с томами жестких дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-1155">Do not confuse these with OS disk volumes.</span></span> 
> 
> 

<span data-ttu-id="42034-1156">Вкратце повторим рекомендации.</span><span class="sxs-lookup"><span data-stu-id="42034-1156">In short you have to:</span></span>

* <span data-ttu-id="42034-1157">При использовании учетных записей хранения Azure настройте учетную запись хранения Azure, в которой будут храниться тома (т. е. файлы) данных и журналов SAP MaxDB, в качестве **локально избыточного хранилища (LRS)**, как описано в разделе [Служба хранилища Microsoft Azure][dbms-guide-2.3].</span><span class="sxs-lookup"><span data-stu-id="42034-1157">If you use Azure Storage accounts, set the Azure storage account that holds the SAP MaxDB data and log volumes (i.e. files) to **Local Redundant Storage (LRS)** as specified in chapter [Microsoft Azure Storage][dbms-guide-2.3].</span></span>
* <span data-ttu-id="42034-1158">Разделите пути ввода-вывода для томов (т. е. файлов) данных и томов журналов SAP MaxDB.</span><span class="sxs-lookup"><span data-stu-id="42034-1158">Separate the IO path for SAP MaxDB data volumes (i.e. files) from the IO path for log volumes (i.e. files).</span></span> <span data-ttu-id="42034-1159">Это означает, что тома (т. е. файлы) данных SAP MaxDB должны быть установлены на один логический диск, а тома (т. е. файлы) журналов SAP MaxDB — на другой логический диск.</span><span class="sxs-lookup"><span data-stu-id="42034-1159">This means that SAP MaxDB data volumes (i.e. files) have to be installed on one logical drive and SAP MaxDB log volumes (i.e. files) have to be installed on another logical drive.</span></span>
* <span data-ttu-id="42034-1160">Правильно настройте тип кэширования для каждого диска. Настройки кэширования зависят от того, что будет храниться в большом двоичном объекте (тома (т. е. файлы) данных или журналов SAP MaxDB), а также от класса хранилища Azure (Standard или Premium), как описано в разделе [Кэширование для виртуальных машин и дисков данных][dbms-guide-2.1].</span><span class="sxs-lookup"><span data-stu-id="42034-1160">Set the proper caching type for each disk, depending on whether you use it for SAP MaxDB data or log volumes (i.e. files), and whether you use Azure Standard or Azure Premium Storage, as described in chapter [Caching for VMs and data disks][dbms-guide-2.1].</span></span>
* <span data-ttu-id="42034-1161">Если текущего количества операций ввода-вывода в секунду для каждого диска достаточно, все тома данных можно хранить на одном подключенном диске, а все тома журналов базы данных — на другом.</span><span class="sxs-lookup"><span data-stu-id="42034-1161">As long as the current IOPS quota per disk satisfies the requirements, it is possible to store all the data volumes on a single mounted disk, and also store all database log volumes on another single mounted disk.</span></span>
* <span data-ttu-id="42034-1162">Если требуется дополнительное пространство или большее количество операций ввода-вывода в секунду, настоятельно рекомендуем использовать пулы носителей Microsoft Window (доступны только в Microsoft Windows Server 2012 и более поздних версиях) или функцию чередования дисков (для Microsoft Windows 2008 R2). Таким образом из нескольких подключенных дисков вы сможете создать одно большое логическое устройство.</span><span class="sxs-lookup"><span data-stu-id="42034-1162">If more IOPS and/or space are required, it is strongly recommended to use Microsoft Window Storage Pools (only available in Microsoft Windows Server 2012 and higher) or Microsoft Windows striping for Microsoft Windows 2008 R2 to create one large logical device over multiple mounted disks.</span></span> <span data-ttu-id="42034-1163">Ознакомьтесь также с разделом [Программный RAID-массив][dbms-guide-2.2] в этом документе.</span><span class="sxs-lookup"><span data-stu-id="42034-1163">See also chapter [Software RAID][dbms-guide-2.2] of this document.</span></span> <span data-ttu-id="42034-1164">Такой подход позволяет сократить административные расходы на управление дисковым пространством и избежать необходимости вручную распределять файлы между несколькими подключенными дисками.</span><span class="sxs-lookup"><span data-stu-id="42034-1164">This approach simplifies the administration overhead to manage the disk space and avoids the effort of manually distributing files across multiple mounted disks.</span></span>
* <span data-ttu-id="42034-1165">Если вам требуется максимальное количество операций ввода-вывода в секунду, используйте службу хранилища Azure класса Premium, доступную на виртуальных машинах серий DS и GS.</span><span class="sxs-lookup"><span data-stu-id="42034-1165">For the highest IOPS requirements, you can use Azure Premium Storage, which is available on DS-series and GS-series VMs.</span></span>

![Эталонная конфигурация виртуальной машины Azure IaaS для СУБД SAP MaxDB][dbms-guide-figure-600]

#### <span data-ttu-id="42034-1167"><a name="23c78d3b-ca5a-4e72-8a24-645d141a3f5d"></a>Архивация и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1167"><a name="23c78d3b-ca5a-4e72-8a24-645d141a3f5d"></a>Backup and Restore</span></span>
<span data-ttu-id="42034-1168">При развертывании SAP MaxDB в Azure методику резервного копирования необходимо пересмотреть.</span><span class="sxs-lookup"><span data-stu-id="42034-1168">When deploying SAP MaxDB into Azure, you must review your backup methodology.</span></span> <span data-ttu-id="42034-1169">Даже если система не используется для производственных задач, необходимо периодически производить резервное копирование базы данных SAP, размещенной в SAP MaxDB.</span><span class="sxs-lookup"><span data-stu-id="42034-1169">Even if the system is not a productive system, the SAP database hosted by SAP MaxDB must be backed up periodically.</span></span> <span data-ttu-id="42034-1170">Так как в службе хранилища Azure хранятся три образа, резервное копирование представляется менее важным в контексте защиты системы от сбоев хранилища и более важных эксплуатационных и административных сбоев.</span><span class="sxs-lookup"><span data-stu-id="42034-1170">Since Azure Storage keeps three images, a backup is now less important in terms of protecting your system against storage failure and more important operational or administrative failures.</span></span> <span data-ttu-id="42034-1171">Основная причина соблюдения надлежащего плана резервного копирования и восстановления следующая. Благодаря возможности восстанавливать состояние на определенный момент времени вы можете исправлять логические или пользовательские ошибки.</span><span class="sxs-lookup"><span data-stu-id="42034-1171">The primary reason for maintaining a proper backup and restore plan is so that you can compensate for logical or manual errors by providing point-in-time recovery capabilities.</span></span> <span data-ttu-id="42034-1172">Следовательно, резервные копии используются для восстановления состояния базы данных на определенный момент времени или для создания другой системы в Azure путем копирования существующей базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1172">So the goal is to either use backups to restore the database to a certain point in time or to use the backups in Azure to seed another system by copying the existing database.</span></span> <span data-ttu-id="42034-1173">Например, с помощью восстановления из резервной копии вы можете перейти от двухуровневой конфигурации SAP к трехуровневой для той же системы.</span><span class="sxs-lookup"><span data-stu-id="42034-1173">For example, you could transfer from a 2-tier SAP configuration to a 3-tier system setup of the same system by restoring a backup.</span></span>

<span data-ttu-id="42034-1174">Архивация и восстановление базы данных в Azure работает так же, как и в локальных системах. Поэтому вы можете использовать стандартные инструменты архивации и восстановления SAP MaxDB, описанные в одном из перечисленных в примечании к SAP [767598] документов по SAP MaxDB.</span><span class="sxs-lookup"><span data-stu-id="42034-1174">Backing up and restoring a database in Azure works the same way as it does for on-premises systems, so you can use standard SAP MaxDB backup/restore tools, which are described in one of the SAP MaxDB documentation documents listed in SAP Note [767598].</span></span> 

#### <span data-ttu-id="42034-1175"><a name="77cd2fbb-307e-4cbf-a65f-745553f72d2c"></a>Рекомендации по ускорению архивации и восстановления</span><span class="sxs-lookup"><span data-stu-id="42034-1175"><a name="77cd2fbb-307e-4cbf-a65f-745553f72d2c"></a>Performance Considerations for Backup and Restore</span></span>
<span data-ttu-id="42034-1176">Как и при развертывании на сервер без операционной системы, скорость резервного копирования и восстановления зависит от количества томов, которые могут считываться параллельно, а также от пропускной способности этих томов.</span><span class="sxs-lookup"><span data-stu-id="42034-1176">As in bare-metal deployments, backup and restore performance is dependent on how many volumes can be read in parallel and the throughput of those volumes.</span></span> <span data-ttu-id="42034-1177">Кроме того, загрузка ЦП при сжатии резервной копии может играть значительную роль на виртуальных машинах, имеющих не более восьми потоков ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-1177">In addition, the CPU consumption used by backup compression can play a significant role on VMs with up to eight CPU threads.</span></span> <span data-ttu-id="42034-1178">Исходя из сказанного выше, можно сделать следующие выводы.</span><span class="sxs-lookup"><span data-stu-id="42034-1178">Therefore, one can assume:</span></span>

* <span data-ttu-id="42034-1179">Чем меньше дисков используется для хранения устройств базы данных, тем меньше общая пропускная способность при чтении.</span><span class="sxs-lookup"><span data-stu-id="42034-1179">The fewer the number of disks used to store the database devices, the lower the overall read throughput</span></span>
* <span data-ttu-id="42034-1180">Чем меньше потоков ЦП на виртуальной машине, тем сильнее влияние сжатия резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-1180">The smaller the number of CPU threads in the VM, the more severe the impact of backup compression</span></span>
* <span data-ttu-id="42034-1181">Чем меньше целевых объектов (чередующиеся каталоги, диски), на которые записываются резервные копии, тем меньше пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="42034-1181">The fewer targets (Stripe Directories, disks) to write the backup to, the lower the throughput</span></span>

<span data-ttu-id="42034-1182">Увеличить количество целевых объектов для записи можно двумя способами. Выбор того или иного варианта (и даже их сочетания) зависит от ваших потребностей.</span><span class="sxs-lookup"><span data-stu-id="42034-1182">To increase the number of targets to write to, there are two options that you can use, possibly in combination, depending on your needs:</span></span>

* <span data-ttu-id="42034-1183">Выделить для резервных копий отдельные тома.</span><span class="sxs-lookup"><span data-stu-id="42034-1183">Dedicating separate volumes for backup</span></span>
* <span data-ttu-id="42034-1184">Распределить содержимое целевого тома, на котором хранятся резервные копии, между несколькими подключенными дисками, чтобы увеличить на чередующемся дисковом томе количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1184">Striping the backup target volume over multiple mounted disks in order to improve the IOPS throughput on that striped disk volume</span></span>
* <span data-ttu-id="42034-1185">Выделить отдельные логические диски для:</span><span class="sxs-lookup"><span data-stu-id="42034-1185">Having separate dedicated logical disk devices for:</span></span>
  * <span data-ttu-id="42034-1186">томов (т. е. файлов) резервных копий SAP MaxDB;</span><span class="sxs-lookup"><span data-stu-id="42034-1186">SAP MaxDB backup volumes (i.e. files)</span></span>
  * <span data-ttu-id="42034-1187">томов (т. е. файлов) данных SAP MaxDB;</span><span class="sxs-lookup"><span data-stu-id="42034-1187">SAP MaxDB data volumes (i.e. files)</span></span>
  * <span data-ttu-id="42034-1188">томов (т. е. файлов) журналов SAP MaxDB.</span><span class="sxs-lookup"><span data-stu-id="42034-1188">SAP MaxDB log volumes (i.e. files)</span></span>

<span data-ttu-id="42034-1189">Сведения о распределении тома между несколькими дисками см. в разделе [Программный RAID-массив][dbms-guide-2.2] этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1189">Striping a volume over multiple mounted disks has been discussed earlier in chapter [Software RAID][dbms-guide-2.2] of this document.</span></span> 

#### <span data-ttu-id="42034-1190"><a name="f77c1436-9ad8-44fb-a331-8671342de818"></a>Другое</span><span class="sxs-lookup"><span data-stu-id="42034-1190"><a name="f77c1436-9ad8-44fb-a331-8671342de818"></a>Other</span></span>
<span data-ttu-id="42034-1191">Все другие общие темы, включая группы доступности Azure и мониторинг SAP, также касаются развертывания виртуальных машин с базой данных SAP MaxDB, как описано в первых трех разделах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1191">All other general topics such as Azure Availability Sets or SAP monitoring also apply as described in the first three chapters of this document for deployments of VMs with the SAP MaxDB database.</span></span>
<span data-ttu-id="42034-1192">Другие параметры SAP MaxDB прозрачны для виртуальных машин Azure и описаны в различных документах, перечисленных в примечании к SAP [767598] , а также в следующих примечаниях к SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-1192">Other SAP MaxDB-specific settings are transparent to Azure VMs and are described in different documents listed in SAP Note [767598] and in these SAP notes:</span></span>

* <span data-ttu-id="42034-1193">[826037;]</span><span class="sxs-lookup"><span data-stu-id="42034-1193">[826037]</span></span> 
* <span data-ttu-id="42034-1194">[1139904;]</span><span class="sxs-lookup"><span data-stu-id="42034-1194">[1139904]</span></span>
* <span data-ttu-id="42034-1195">[1173395.]</span><span class="sxs-lookup"><span data-stu-id="42034-1195">[1173395]</span></span>

## <a name="specifics-for-sap-livecache-on-windows"></a><span data-ttu-id="42034-1196">Особенности SAP liveCache в Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1196">Specifics for SAP liveCache on Windows</span></span>
### <a name="sap-livecache-version-support"></a><span data-ttu-id="42034-1197">Поддерживаемые версии SAP liveCache</span><span class="sxs-lookup"><span data-stu-id="42034-1197">SAP liveCache Version Support</span></span>
<span data-ttu-id="42034-1198">Минимальной поддерживаемой версией SAP liveCache в службе виртуальных машин Azure является **SAP LC/LCAPPS 10.0 SP 25** (включая **liveCache 7.9.08.31** и **LCA-Build 25**), выпущенная для **EhP 2 для SAP SCM 7.0** и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="42034-1198">Minimal version of SAP liveCache supported in Azure Virtual Machines is **SAP LC/LCAPPS 10.0 SP 25** including **liveCache 7.9.08.31** and **LCA-Build 25**, released for **EhP 2 for SAP SCM 7.0** and higher.</span></span>

### <a name="supported-microsoft-windows-versions-and-azure-vm-types-for-sap-livecache-dbms"></a><span data-ttu-id="42034-1199">Поддерживаемые версии Microsoft Windows и типы виртуальных машин Azure для СУБД SAP liveCache</span><span class="sxs-lookup"><span data-stu-id="42034-1199">Supported Microsoft Windows Versions and Azure VM types for SAP liveCache DBMS</span></span>
<span data-ttu-id="42034-1200">Сведения о поддерживаемых версиях Microsoft Windows для СУБД SAP liveCache в Azure, см. по следующим ссылкам:</span><span class="sxs-lookup"><span data-stu-id="42034-1200">To find the supported Microsoft Windows version for SAP liveCache on Azure, see:</span></span>

* <span data-ttu-id="42034-1201">[матрица доступности продуктов SAP;][sap-pam]</span><span class="sxs-lookup"><span data-stu-id="42034-1201">[SAP Product Availability Matrix (PAM)][sap-pam]</span></span>
* <span data-ttu-id="42034-1202">примечание к SAP [1928533]</span><span class="sxs-lookup"><span data-stu-id="42034-1202">SAP Note [1928533]</span></span>

<span data-ttu-id="42034-1203">Мы настоятельно рекомендуем использовать последнюю версию операционной системы Microsoft Windows Server.</span><span class="sxs-lookup"><span data-stu-id="42034-1203">It is highly recommended to use the newest version of the operating system Microsoft Windows Server.</span></span> 

### <a name="sap-livecache-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1204">Рекомендации по конфигурации SAP liveCache для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1204">SAP liveCache Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <a name="recommended-azure-vm-types"></a><span data-ttu-id="42034-1205">Рекомендуемые типы виртуальных машин Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1205">Recommended Azure VM Types</span></span>
<span data-ttu-id="42034-1206">Так как SAP liveCache является приложением, выполняющим огромный объем вычислений, основное влияние на его производительность оказывают скорость и объем оперативной памяти и ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-1206">As SAP liveCache is an application that performs huge calculations, the amount and speed of RAM and CPU has a major influence on SAP liveCache performance.</span></span> 

<span data-ttu-id="42034-1207">Для типов виртуальных машин Azure, поддерживаемых в SAP (см. примечание к SAP [1928533]), все ресурсы виртуального ЦП, выделенного для виртуальной машины, обеспечиваются выделенными ресурсами физического ЦП гипервизора.</span><span class="sxs-lookup"><span data-stu-id="42034-1207">For the Azure VM types supported by SAP (SAP Note [1928533]), all virtual CPU resources allocated to the VM are backed by dedicated physical CPU resources of the hypervisor.</span></span> <span data-ttu-id="42034-1208">Из-за отсутствия избыточного выделения ресурсов отсутствует конкуренция за ресурсы ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-1208">No overprovisioning (and therefore no competition for CPU resources) takes place.</span></span>

<span data-ttu-id="42034-1209">Аналогично для всех типов виртуальных машин Azure, поддерживаемых в SAP, память виртуальной машины на 100 % соответствует физической памяти. Избыточное выделение (перерасход) не используется.</span><span class="sxs-lookup"><span data-stu-id="42034-1209">Similarly, for all Azure VM instance types supported by SAP, the VM memory is 100% mapped to the physical memory – overprovisioning (over-commitment), for example, is not used.</span></span>

<span data-ttu-id="42034-1210">В этом контексте мы настоятельно рекомендуем использовать новый тип виртуальных машин Azure серии D или DS (в сочетании с хранилищем Azure класса Premium), так как они имеют на 60 % более быстрые процессоры, чем машины серии A.</span><span class="sxs-lookup"><span data-stu-id="42034-1210">From this perspective, it is highly recommended to use the new D- series or DS-series (in combination with Azure Premium Storage) Azure VM type, as they have 60% faster processors than the A-series.</span></span> <span data-ttu-id="42034-1211">Если предполагается очень высокая загрузка ОЗУ и ЦП, можно использовать виртуальные машины серий G и GS с новейшими процессорами Intel® Xeon® семейства E5 v3 (в сочетании с хранилищем Azure класса Premium). Эти машины имеют в два раза больше памяти и в четыре раза более объемные твердотельные диски (SSD), чем машины серий D и DS.</span><span class="sxs-lookup"><span data-stu-id="42034-1211">For the highest RAM and CPU load, you can use G-series and GS-series (in combination with Azure Premium Storage) VMs with the latest Intel® Xeon® processor E5 v3 family, which have twice the memory and four times the solid state drive storage (SSDs) of the D/DS-series.</span></span>

#### <a name="storage-configuration"></a><span data-ttu-id="42034-1212">Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1212">Storage Configuration</span></span>
<span data-ttu-id="42034-1213">Так как в основе SAP liveCache лежат технологии SAP MaxDB, то все рекомендации для службы хранилища Azure, приведенные для SAP MaxDB в разделе [Конфигурация хранилища][dbms-guide-8.4.1], относятся также и к SAP liveCache.</span><span class="sxs-lookup"><span data-stu-id="42034-1213">As SAP liveCache is based on SAP MaxDB technology, all the Azure storage best practice recommendations mentioned for SAP MaxDB in chapter [Storage configuration][dbms-guide-8.4.1] are also valid for SAP liveCache.</span></span> 

#### <a name="dedicated-azure-vm-for-livecache"></a><span data-ttu-id="42034-1214">Выделенная виртуальная машина Azure для liveCache</span><span class="sxs-lookup"><span data-stu-id="42034-1214">Dedicated Azure VM for liveCache</span></span>
<span data-ttu-id="42034-1215">Так как SAP liveCache интенсивно использует вычислительные мощности, для достижения максимальной производительности мы настоятельно рекомендуем развертывать СУБД на выделенной виртуальной машине Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1215">As SAP liveCache intensively uses computational power, for productive usage it is highly recommended to deploy on a dedicated Azure Virtual Machine.</span></span> 

![Виртуальная машина Azure, выделенная для liveCache, для производственных целей][dbms-guide-figure-700]

#### <a name="backup-and-restore"></a><span data-ttu-id="42034-1217">Архивация и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1217">Backup and Restore</span></span>
<span data-ttu-id="42034-1218">Вопросы архивации и восстановления, включая рекомендации по повышению производительности, уже раскрыты в соответствующих разделах, посвященных SAP MaxDB: [Архивация и восстановление][dbms-guide-8.4.2] и [Рекомендации по ускорению архивации и восстановления][dbms-guide-8.4.3].</span><span class="sxs-lookup"><span data-stu-id="42034-1218">Backup and restore, including performance considerations, are already described in the relevant SAP MaxDB chapters [Backup and Restore][dbms-guide-8.4.2] and [Performance Considerations for Backup and Restore][dbms-guide-8.4.3].</span></span> 

#### <a name="other"></a><span data-ttu-id="42034-1219">Другие</span><span class="sxs-lookup"><span data-stu-id="42034-1219">Other</span></span>
<span data-ttu-id="42034-1220">Все другие общие темы уже описаны в [этом][dbms-guide-8.4.4] разделе о SAP MaxDB.</span><span class="sxs-lookup"><span data-stu-id="42034-1220">All other general topics are already described in the relevant SAP MaxDB [this][dbms-guide-8.4.4] chapter.</span></span> 

## <a name="specifics-for-the-sap-content-server-on-windows"></a><span data-ttu-id="42034-1221">Особенности сервера содержимого SAP в Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1221">Specifics for the SAP Content Server on Windows</span></span>
<span data-ttu-id="42034-1222">Сервер содержимого SAP (SAP Content Server) — это отдельный серверный компонент для хранения содержимого, например электронных документов в различных форматах.</span><span class="sxs-lookup"><span data-stu-id="42034-1222">The SAP Content Server is a separate, server-based component to store content such as electronic documents in different formats.</span></span> <span data-ttu-id="42034-1223">Сервер содержимого SAP предоставляется благодаря развитию технологий и используется для всех приложений SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1223">The SAP Content Server is provided by development of technology and is to be used cross-application for any SAP applications.</span></span> <span data-ttu-id="42034-1224">Он устанавливается на отдельной системе.</span><span class="sxs-lookup"><span data-stu-id="42034-1224">It is installed on a separate system.</span></span> <span data-ttu-id="42034-1225">Стандартное содержимое — это учебные материалы и документация из базы знаний или технические чертежи из системы управления документами mySAP PLM.</span><span class="sxs-lookup"><span data-stu-id="42034-1225">Typical content is training material and documentation from Knowledge Warehouse or technical drawings originating from the mySAP PLM Document Management System.</span></span> 

### <a name="sap-content-server-version-support"></a><span data-ttu-id="42034-1226">Поддерживаемые версии сервера содержимого SAP</span><span class="sxs-lookup"><span data-stu-id="42034-1226">SAP Content Server Version Support</span></span>
<span data-ttu-id="42034-1227">В настоящее время SAP поддерживает:</span><span class="sxs-lookup"><span data-stu-id="42034-1227">SAP currently supports:</span></span>

* <span data-ttu-id="42034-1228">**сервер содержимого SAP** версии **6.50 (и более поздние)**;</span><span class="sxs-lookup"><span data-stu-id="42034-1228">**SAP Content Server** with version **6.50 (and higher)**</span></span>
* <span data-ttu-id="42034-1229">**SAP MaxDB версии 7.9;**</span><span class="sxs-lookup"><span data-stu-id="42034-1229">**SAP MaxDB version 7.9**</span></span>
* <span data-ttu-id="42034-1230">**службы Microsoft IIS версии 8.0 (и более поздние версии).**</span><span class="sxs-lookup"><span data-stu-id="42034-1230">**Microsoft IIS (Internet Information Server) version 8.0 (and higher)**</span></span>

<span data-ttu-id="42034-1231">Мы настоятельно рекомендуем использовать последнюю версию сервера содержимого SAP (**6.50 SP4**) на момент написания этого документа, а также самую последнюю версию **служб Microsoft IIS — 8.5**.</span><span class="sxs-lookup"><span data-stu-id="42034-1231">It is highly recommended to use the newest version of SAP Content Server, which at the time of writing this document is **6.50 SP4**, and the newest version of **Microsoft IIS 8.5**.</span></span> 

<span data-ttu-id="42034-1232">Узнать последние версии SAP Content Server и служб Microsoft IIS можно в [матрице доступности продуктов SAP][sap-pam].</span><span class="sxs-lookup"><span data-stu-id="42034-1232">Check the latest supported versions of SAP Content Server and Microsoft IIS in the [SAP Product Availability Matrix (PAM)][sap-pam].</span></span>

### <a name="supported-microsoft-windows-and-azure-vm-types-for-sap-content-server"></a><span data-ttu-id="42034-1233">Поддерживаемые версии Microsoft Windows и типы виртуальных машин Azure для сервера содержимого SAP</span><span class="sxs-lookup"><span data-stu-id="42034-1233">Supported Microsoft Windows and Azure VM types for SAP Content Server</span></span>
<span data-ttu-id="42034-1234">Сведения о поддерживаемых версиях Microsoft Windows для сервера содержимого SAP в Azure см. по следующим ссылкам:</span><span class="sxs-lookup"><span data-stu-id="42034-1234">To find out supported Windows version for SAP Content Server on Azure, see:</span></span>

* <span data-ttu-id="42034-1235">[матрица доступности продуктов SAP;][sap-pam]</span><span class="sxs-lookup"><span data-stu-id="42034-1235">[SAP Product Availability Matrix (PAM)][sap-pam]</span></span>
* <span data-ttu-id="42034-1236">примечание к SAP [1928533]</span><span class="sxs-lookup"><span data-stu-id="42034-1236">SAP Note [1928533]</span></span>

<span data-ttu-id="42034-1237">Мы настоятельно рекомендуется использовать последнюю версию Microsoft Windows Server.</span><span class="sxs-lookup"><span data-stu-id="42034-1237">It is highly recommended to use the newest version of Microsoft Windows Server.</span></span>

### <a name="sap-content-server-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1238">Рекомендации по конфигурации сервера содержимого SAP для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1238">SAP Content Server Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <a name="storage-configuration"></a><span data-ttu-id="42034-1239">Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1239">Storage Configuration</span></span>
<span data-ttu-id="42034-1240">При настройке SAP Content Server для хранения файлов в базе данных SAP MaxDB все рекомендации для службы хранилища Azure, приведенные для SAP MaxDB в разделе [Конфигурация хранилища][dbms-guide-8.4.1], относятся также и к серверу содержимого SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1240">If you configure SAP Content Server to store files in the SAP MaxDB database, all Azure storage best practices recommendation mentioned for SAP MaxDB in chapter [Storage Configuration][dbms-guide-8.4.1] are also valid for the SAP Content Server scenario.</span></span> 

<span data-ttu-id="42034-1241">При настройке сервера контента SAP для хранения файлов в файловой системе мы рекомендуем использовать выделенный логический диск.</span><span class="sxs-lookup"><span data-stu-id="42034-1241">If you configure SAP Content Server to store files in the file system, it is recommended to use a dedicated logical drive.</span></span> <span data-ttu-id="42034-1242">Кроме того, использование дисковых пространств Windows позволяет увеличить размер логического диска и количество операций ввода-вывода в секунду, как описано в разделе [Программный RAID-массив][dbms-guide-2.2].</span><span class="sxs-lookup"><span data-stu-id="42034-1242">Using Windows Storage Spaces enables you to also increase logical disk size and IOPS throughput, as described in chapter [Software RAID][dbms-guide-2.2].</span></span> 

#### <a name="sap-content-server-location"></a><span data-ttu-id="42034-1243">Расположение сервера содержимого SAP</span><span class="sxs-lookup"><span data-stu-id="42034-1243">SAP Content Server Location</span></span>
<span data-ttu-id="42034-1244">Сервер содержимого SAP должен быть развернут в том же регионе Azure и в той же виртуальной сети Azure, где развернута система SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1244">SAP Content Server has to be deployed in the same Azure region and Azure VNET where the SAP system is deployed.</span></span> <span data-ttu-id="42034-1245">Компоненты сервера содержимого SAP можно развернуть как на выделенной виртуальной машине Azure, так и на той, где работает система SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1245">You are free to decide whether you want to deploy SAP Content Server components on a dedicated Azure VM or on the same VM where the SAP system is running.</span></span> 

![Виртуальная машина Azure, выделенная для сервера содержимого SAP][dbms-guide-figure-800]

#### <a name="sap-cache-server-location"></a><span data-ttu-id="42034-1247">Расположение сервера кэширования SAP</span><span class="sxs-lookup"><span data-stu-id="42034-1247">SAP Cache Server Location</span></span>
<span data-ttu-id="42034-1248">Сервер кэширования SAP — это дополнительный серверный компонент для предоставления локального доступа к (кэшированным) документам.</span><span class="sxs-lookup"><span data-stu-id="42034-1248">The SAP Cache Server is an additional server-based component to provide access to (cached) documents locally.</span></span> <span data-ttu-id="42034-1249">Сервер кэширования SAP кэширует документы с сервера содержимого SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1249">The SAP Cache Server caches the documents of an SAP Content Server.</span></span> <span data-ttu-id="42034-1250">Это позволяет оптимизировать сетевой трафик, если обращения к документу происходят более одного раза из разных расположений.</span><span class="sxs-lookup"><span data-stu-id="42034-1250">This is to optimize network traffic if documents have to be retrieved more than once from different locations.</span></span> <span data-ttu-id="42034-1251">Общее правило состоит в том, что сервер кэширования SAP должен располагаться физически близко к клиенту, который к нему обращается.</span><span class="sxs-lookup"><span data-stu-id="42034-1251">The general rule is that the SAP Cache Server has to be physically close to the client that accesses the SAP Cache Server.</span></span> 

<span data-ttu-id="42034-1252">В этом случае существует два варианта.</span><span class="sxs-lookup"><span data-stu-id="42034-1252">Here you have two options:</span></span>

1. <span data-ttu-id="42034-1253">**Клиентом выступает внутренняя система SAP.** Если во внутренней системе SAP настроен доступ к серверу содержимого SAP, то клиентом выступает система SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1253">**Client is a backend SAP system** If a backend SAP system is configured to access SAP Content Server, that SAP system is a client.</span></span> <span data-ttu-id="42034-1254">Так как система SAP и сервер содержимого SAP развернуты в одном и том же регионе Azure (в одном центре обработки данных Azure), они находятся физически близко друг к другу.</span><span class="sxs-lookup"><span data-stu-id="42034-1254">As both SAP system and SAP Content Server are deployed in the same Azure region – in the same Azure datacenter – they are physically close to each other.</span></span> <span data-ttu-id="42034-1255">В этом случае вам не нужен выделенный сервер кэширования SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1255">Therefore, there is no need to have a dedicated SAP Cache Server.</span></span> <span data-ttu-id="42034-1256">Клиенты пользовательского интерфейса SAP (графического пользовательского интерфейса SAP или веб-браузера) обращаются к системе SAP напрямую, и система SAP извлекает документы с сервера содержимого SAP.</span><span class="sxs-lookup"><span data-stu-id="42034-1256">SAP UI clients (SAP GUI or web browser) access the SAP system directly, and the SAP system retrieves documents from the SAP Content Server.</span></span>
2. <span data-ttu-id="42034-1257">**Клиентом выступает локальный веб-браузер.** Сервер содержимого SAP можно настроить так, чтобы к нему можно было обращаться напрямую из веб-браузера.</span><span class="sxs-lookup"><span data-stu-id="42034-1257">**Client is an on-premises web browser** The SAP Content Server can be configured to be accessed directly by the web browser.</span></span> <span data-ttu-id="42034-1258">В таком случае клиентом сервера содержимого SAP выступает локальный веб-браузер.</span><span class="sxs-lookup"><span data-stu-id="42034-1258">In this case, a web browser running on–premises is a client of the SAP Content Server.</span></span> <span data-ttu-id="42034-1259">Локальный центр обработки данных и центр обработки данных Azure физически расположены в разных местах (в идеальном случае вблизи друг от друга).</span><span class="sxs-lookup"><span data-stu-id="42034-1259">On-premises datacenter and Azure datacenter are placed in different physical locations (ideally close to each other).</span></span> <span data-ttu-id="42034-1260">Ваш локальный ЦОД соединен с Azure через канал ExpressRoute или VPN-подключение типа "сайт — сайт".</span><span class="sxs-lookup"><span data-stu-id="42034-1260">Your on-premises datacenter is connected to Azure via Azure Site-to-Site VPN or ExpressRoute.</span></span> <span data-ttu-id="42034-1261">Хотя оба варианта предлагают безопасное VPN-подключение к Azure, подключение типа "сайт — сайт" не обеспечивает высокую пропускную способность и низкие задержки для соединения между локальным ЦОД и ЦОД Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1261">Although both options offer secure VPN network connection to Azure, site-to-site network connection does not offer a network bandwidth and latency SLA between the on-premises datacenter and the Azure datacenter.</span></span> <span data-ttu-id="42034-1262">Ускорить доступ к документам можно двумя способами:</span><span class="sxs-lookup"><span data-stu-id="42034-1262">To speed up access to documents, you can do one of the following:</span></span>
   1. <span data-ttu-id="42034-1263">установить SAP Cache Server локально, поблизости от локального веб-браузера (см. [рисунок][dbms-guide-900-sap-cache-server-on-premises] ниже);</span><span class="sxs-lookup"><span data-stu-id="42034-1263">Install SAP Cache Server on-premises, close to the on-premises web browser (option on [this][dbms-guide-900-sap-cache-server-on-premises] Figure)</span></span>
   2. <span data-ttu-id="42034-1264">настроить канал Azure ExpressRoute, который обеспечивает выделенное высокоскоростное сетевое подключение с низкой задержкой между локальным ЦОД и ЦОД Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1264">Configure Azure ExpressRoute, which offers a high-speed and low-latency dedicated network connection between on-premises datacenter and Azure datacenter.</span></span>

<span data-ttu-id="42034-1265">![Вариант локальной установки сервера кэширования SAP][dbms-guide-figure-900]
<a name="642f746c-e4d4-489d-bf63-73e80177a0a8"></a></span><span class="sxs-lookup"><span data-stu-id="42034-1265">![Option to install SAP Cache Server on-premises][dbms-guide-figure-900]
<a name="642f746c-e4d4-489d-bf63-73e80177a0a8"></a></span></span>

#### <a name="backup--restore"></a><span data-ttu-id="42034-1266">Резервное копирование и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1266">Backup / Restore</span></span>
<span data-ttu-id="42034-1267">Если вы настраиваете SAP Content Server для хранения файлов в базе данных SAP MaxDB, процедуры архивации и восстановления и вопросы производительности уже описаны в соответствующих разделах, посвященных SAP MaxDB: [Архивация и восстановление][dbms-guide-8.4.2] и [Рекомендации по ускорению архивации и восстановления][dbms-guide-8.4.3].</span><span class="sxs-lookup"><span data-stu-id="42034-1267">If you configure the SAP Content Server to store files in the SAP MaxDB database, the backup/restore procedure and performance considerations are already described in SAP MaxDB chapter [Backup and Restore][dbms-guide-8.4.2] and chapter [Performance Considerations for Backup and Restore][dbms-guide-8.4.3].</span></span> 

<span data-ttu-id="42034-1268">Если вы настраиваете сервер содержимого SAP для хранения файлов в файловой системе, резервное копировании и восстановление выполняется вручную для всей файловой структуры, в которой хранятся документы.</span><span class="sxs-lookup"><span data-stu-id="42034-1268">If you configure the SAP Content Server to store files in the file system, one option is to execute manual backup/restore of the whole file structure where the documents are located.</span></span> <span data-ttu-id="42034-1269">Как и в случае с резервным копированием и восстановлением SAP MaxDB, для целей резервного копирования мы рекомендуем выделить отдельный том диска.</span><span class="sxs-lookup"><span data-stu-id="42034-1269">Similar to SAP MaxDB backup/restore, it is recommended to have a dedicated disk volume for backup purpose.</span></span> 

#### <a name="other"></a><span data-ttu-id="42034-1270">Другие</span><span class="sxs-lookup"><span data-stu-id="42034-1270">Other</span></span>
<span data-ttu-id="42034-1271">Другие параметры сервера содержимого SAP прозрачны для виртуальных машин Azure и описаны в различных документах и примечаниях SAP:</span><span class="sxs-lookup"><span data-stu-id="42034-1271">Other SAP Content Server specific settings are transparent to Azure VMs and are described in various documents and SAP Notes:</span></span>

* <span data-ttu-id="42034-1272"><https://service.sap.com/contentserver></span><span class="sxs-lookup"><span data-stu-id="42034-1272"><https://service.sap.com/contentserver></span></span> 
* <span data-ttu-id="42034-1273">примечание к SAP [1619726]</span><span class="sxs-lookup"><span data-stu-id="42034-1273">SAP Note [1619726]</span></span>  

## <a name="specifics-to-ibm-db2-for-luw-on-windows"></a><span data-ttu-id="42034-1274">Особенности IBM DB2 для LUW в Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1274">Specifics to IBM DB2 for LUW on Windows</span></span>
<span data-ttu-id="42034-1275">Microsoft Azure позволяет легко перенести существующие приложения SAP, работающие в IBM DB2 для Linux, UNIX и Windows (LUW), на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1275">With Microsoft Azure, you can easily migrate your existing SAP application running on IBM DB2 for Linux, UNIX, and Windows (LUW) to Azure virtual machines.</span></span> <span data-ttu-id="42034-1276">Для решений SAP на базе IBM DB2 для LUW администраторы и разработчики могут по-прежнему использовать те же средства разработки и администрирования, которые доступны локально.</span><span class="sxs-lookup"><span data-stu-id="42034-1276">With SAP on IBM DB2 for LUW, administrators and developers can still use the same development and administration tools, which are available on-premises.</span></span>
<span data-ttu-id="42034-1277">Общую информацию о работе SAP Business Suite в IBM DB2 для LUW см. на сайте сообщества SAP (SCN): <https://www.sap.com/community/topic/db2-for-linux-unix-and-windows.html>.</span><span class="sxs-lookup"><span data-stu-id="42034-1277">General information about running SAP Business Suite on IBM DB2 for LUW can be found in the SAP Community Network (SCN) at <https://www.sap.com/community/topic/db2-for-linux-unix-and-windows.html>.</span></span>

<span data-ttu-id="42034-1278">Дополнительные сведения и новости о SAP в DB2 для LUW в Azure см. в примечании к SAP [2233094].</span><span class="sxs-lookup"><span data-stu-id="42034-1278">For additional information and updates about SAP on DB2 for LUW on Azure, see SAP Note [2233094].</span></span> 

### <a name="ibm-db2-for-linux-unix-and-windows-version-support"></a><span data-ttu-id="42034-1279">Поддерживаемые версии IBM DB2 для Linux, UNIX и Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1279">IBM DB2 for Linux, UNIX, and Windows Version Support</span></span>
<span data-ttu-id="42034-1280">SAP в IBM DB2 для LUW поддерживается в службах виртуальных машин Microsoft Azure начиная с версии DB2 10.5.</span><span class="sxs-lookup"><span data-stu-id="42034-1280">SAP on IBM DB2 for LUW on Microsoft Azure Virtual Machine Services is supported as of DB2 version 10.5.</span></span>

<span data-ttu-id="42034-1281">Дополнительные сведения о поддерживаемых продуктах SAP и типах виртуальных машин Azure см. в примечании к SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="42034-1281">For information about supported SAP products and Azure VM types, refer to SAP Note [1928533].</span></span>

### <a name="ibm-db2-for-linux-unix-and-windows-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1282">Рекомендации по конфигурации IBM DB2 для Linux, UNIX и Windows для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1282">IBM DB2 for Linux, UNIX, and Windows Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <a name="storage-configuration"></a><span data-ttu-id="42034-1283">Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1283">Storage Configuration</span></span>
<span data-ttu-id="42034-1284">Все файлы базы данных должны храниться на подключенных напрямую дисках с файловой системой NTFS.</span><span class="sxs-lookup"><span data-stu-id="42034-1284">All database files must be stored on the NTFS file system based on directly attached disks.</span></span> <span data-ttu-id="42034-1285">Эти виртуальные жестки диски должны быть подключены к виртуальной машине Azure и созданы на основе хранилища страничных BLOB-объектов Azure (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) или Управляемых дисков (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span><span class="sxs-lookup"><span data-stu-id="42034-1285">These disks are mounted to the Azure VM and are based in Azure Page BLOB Storage (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) or Managed Disks (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span></span> <span data-ttu-id="42034-1286">Сетевые диски всех типов и удаленные общие ресурсы, включая следующие файловые службы Azure, **невозможно** использовать для хранения файлов базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1286">Any kind of network drives or remote shares like the following Azure file services are **NOT** supported for database files:</span></span> 

* <span data-ttu-id="42034-1287"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1287"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span></span>
* <span data-ttu-id="42034-1288"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1288"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span></span>

<span data-ttu-id="42034-1289">Если вы используете диски, созданные на основе хранилища страничных BLOB-объектов Azure или Управляемых дисков, то сведения, приведенные в этом документе в разделе [Структура развертывания реляционной СУБД][dbms-guide-2], относятся также к развертываниям с базой данных IBM DB2 для LUW.</span><span class="sxs-lookup"><span data-stu-id="42034-1289">If you are using disks based on Azure Page BLOB Storage or Managed Disks, the statements made in this document in chapter [Structure of an RDBMS Deployment][dbms-guide-2] also apply to deployments with the IBM DB2 for LUW Database.</span></span> 

<span data-ttu-id="42034-1290">Как упомянуто в общей части этого документа, для дисков существуют квоты на количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1290">As explained earlier in the general part of the document, quotas on IOPS throughput for disks exist.</span></span> <span data-ttu-id="42034-1291">Квоты зависят от типа используемой виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-1291">The exact quotas depend on the VM type used.</span></span> <span data-ttu-id="42034-1292">Список типов виртуальных машин с соответствующими квотами приведен [здесь (Linux)][virtual-machines-sizes-linux] и [здесь (Windows)][virtual-machines-sizes-windows].</span><span class="sxs-lookup"><span data-stu-id="42034-1292">A list of VM types with their quotas can be found [here (Linux)][virtual-machines-sizes-linux] and [here (Windows)][virtual-machines-sizes-windows].</span></span>

<span data-ttu-id="42034-1293">Если текущего количества операций ввода-вывода в секунду для каждого диска достаточно, все файлы базы данных можно хранить на одном подключенном диске.</span><span class="sxs-lookup"><span data-stu-id="42034-1293">As long as the current IOPS quota per disk is sufficient, it is possible to store all the database files on one single mounted disk.</span></span> 

<span data-ttu-id="42034-1294">Рекомендации по повышению производительности можно также найти в руководствах по установке SAP в разделе о рекомендациях по безопасности данных и повышению производительности в каталогах баз данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1294">For performance considerations also refer to chapter “Data Safety and Performance Considerations for Database Directories” in SAP installation guides.</span></span>

<span data-ttu-id="42034-1295">Кроме того, с помощью пулов носителей Windows (только в Windows Server 2012 и более поздних версиях) или функции чередования дисков Windows (в Windows 2008 R2) из нескольких подключенных дисков можно создать одно большое логическое устройство. Сведения об этом см. в разделе [Программный RAID-массив][dbms-guide-2.2] этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1295">Alternatively, you can use Windows Storage Pools (only available in Windows Server 2012 and higher) or Windows striping for Windows 2008 R2 as described in chapter [Software RAID][dbms-guide-2.2] of this document to create one large logical device over multiple disks.</span></span>
<span data-ttu-id="42034-1296">Для дисков, на которых хранятся данные (sapdata) и временные каталоги (saptmp) SAP DB2, в качестве размера сектора физического диска необходимо указать 512 КБ.</span><span class="sxs-lookup"><span data-stu-id="42034-1296">For the disks containing the DB2 storage paths for your sapdata and saptmp directories, you must specify a physical disk sector size of 512 KB.</span></span> <span data-ttu-id="42034-1297">При использовании пулов носителей Windows эти пулы необходимо создать вручную с помощью интерфейса командной строки, используя параметр -LogicalSectorSizeDefault.</span><span class="sxs-lookup"><span data-stu-id="42034-1297">When using Windows Storage Pools, you must create the storage pools  manually via command line interface using the parameter „-LogicalSectorSizeDefault“.</span></span> <span data-ttu-id="42034-1298">Дополнительные сведения см. здесь: <https://technet.microsoft.com/itpro/powershell/windows/storage/new-storagepool>.</span><span class="sxs-lookup"><span data-stu-id="42034-1298">For more information, see <https://technet.microsoft.com/itpro/powershell/windows/storage/new-storagepool>.</span></span>

#### <a name="backuprestore"></a><span data-ttu-id="42034-1299">Резервное копирование и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1299">Backup/Restore</span></span>
<span data-ttu-id="42034-1300">Для резервного копирования и восстановления можно использовать средства IBM DB2 для LUW. Они поддерживаются так же, как в стандартных операционных системах Windows Server и Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="42034-1300">The backup/restore functionality for IBM DB2 for LUW is supported in the same way as on standard Windows Server Operating Systems and Hyper-V.</span></span>

<span data-ttu-id="42034-1301">У вас обязательно должна быть надежная стратегия резервного копирования базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1301">You must make sure that you have a valid database backup strategy in place.</span></span> 

<span data-ttu-id="42034-1302">Как и при развертывании на сервер без операционной системы, скорость резервного копирования и восстановления зависит от количества томов, которые могут считываться параллельно, а также от пропускной способности этих томов.</span><span class="sxs-lookup"><span data-stu-id="42034-1302">As in bare-metal deployments, backup/restore performance depends on how many volumes can be read in parallel and what the throughput of those volumes might be.</span></span> <span data-ttu-id="42034-1303">Кроме того, загрузка ЦП при сжатии резервной копии может играть значительную роль на виртуальных машинах, имеющих не более восьми потоков ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-1303">In addition, the CPU consumption used by backup compression may play a significant role on VMs with just up to eight CPU threads.</span></span> <span data-ttu-id="42034-1304">Исходя из сказанного выше, можно сделать следующие выводы.</span><span class="sxs-lookup"><span data-stu-id="42034-1304">Therefore, one can assume:</span></span>

* <span data-ttu-id="42034-1305">Чем меньше дисков используется для хранения устройств базы данных, тем меньше общая пропускная способность при чтении.</span><span class="sxs-lookup"><span data-stu-id="42034-1305">The fewer the number of disks used to store the database devices, the smaller the overall throughput in reading</span></span>
* <span data-ttu-id="42034-1306">Чем меньше потоков ЦП на виртуальной машине, тем сильнее влияние сжатия резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-1306">The smaller the number of CPU threads in the VM, the more severe the impact of backup compression</span></span>
* <span data-ttu-id="42034-1307">Чем меньше целевых объектов (чередующиеся каталоги, диски), на которые записываются резервные копии, тем меньше пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="42034-1307">The fewer targets (Stripe Directories, disks) to write the backup to, the lower the throughput</span></span>

<span data-ttu-id="42034-1308">Увеличить количество целевых объектов для записи можно двумя способами. Выбор того или иного варианта (и даже их сочетания) зависит от ваших потребностей.</span><span class="sxs-lookup"><span data-stu-id="42034-1308">To increase the number of targets to write to, two options can be used/combined depending on your needs:</span></span>

* <span data-ttu-id="42034-1309">Распределить содержимое целевого тома, на котором хранятся резервные копии, между несколькими дисками, чтобы увеличить на чередующемся томе количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1309">Striping the backup target volume over multiple disks in order to improve the IOPS throughput on that striped volume</span></span>
* <span data-ttu-id="42034-1310">Использовать несколько целевых каталогов, в которые будут записываться резервные копии.</span><span class="sxs-lookup"><span data-stu-id="42034-1310">Using more than one target directory to write the backup to</span></span>

#### <a name="high-availability-and-disaster-recovery"></a><span data-ttu-id="42034-1311">Высокая доступность и аварийное восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1311">High Availability and Disaster Recovery</span></span>
<span data-ttu-id="42034-1312">Microsoft Cluster Server (MSCS) не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="42034-1312">Microsoft Cluster Server (MSCS) is not supported.</span></span>

<span data-ttu-id="42034-1313">Поддерживается аварийное восстановление высокой доступности (HADR) DB2.</span><span class="sxs-lookup"><span data-stu-id="42034-1313">DB2 high availability disaster recovery (HADR) is supported.</span></span> <span data-ttu-id="42034-1314">Если в конфигурации высокой доступности виртуальные машины имеют работающее разрешение имен, настройка в Azure не будет отличаться от настройки, которая выполняется локально.</span><span class="sxs-lookup"><span data-stu-id="42034-1314">If the virtual machines of the HA configuration have working name resolution, the setup in Azure does not differ from any setup that is done on-premises.</span></span> <span data-ttu-id="42034-1315">Мы не рекомендуем полагаться только на разрешение IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="42034-1315">It is not recommended to rely on IP resolution only.</span></span>

<span data-ttu-id="42034-1316">Не используйте георепликацию для учетных записей хранения, в которых хранятся диски базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1316">Do not use Geo-Replication for the storage accounts that store the database disks.</span></span> <span data-ttu-id="42034-1317">Дополнительные сведения см. в разделах [Служба хранилища Microsoft Azure][dbms-guide-2.3] и [Высокая доступность и аварийное восстановление с использованием виртуальных машин Azure][dbms-guide-3].</span><span class="sxs-lookup"><span data-stu-id="42034-1317">For more information, refer to chapter [Microsoft Azure Storage][dbms-guide-2.3] and chapter [High Availability and Disaster Recovery with Azure VMs][dbms-guide-3].</span></span>

#### <a name="other"></a><span data-ttu-id="42034-1318">Другие</span><span class="sxs-lookup"><span data-stu-id="42034-1318">Other</span></span>
<span data-ttu-id="42034-1319">Все другие общие темы, включая группы доступности Azure и мониторинг SAP, касаются также развертывания виртуальных машин с IBM DB2 для LUW, как описано в первых трех разделах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1319">All other general topics like Azure Availability Sets or SAP monitoring apply as described in the first three chapters of this document for deployments of VMs with IBM DB2 for LUW as well.</span></span> 

<span data-ttu-id="42034-1320">Ознакомьтесь также с разделом [Общие сведения об SQL Server для SAP в Azure][dbms-guide-5.8].</span><span class="sxs-lookup"><span data-stu-id="42034-1320">Also refer to chapter [General SQL Server for SAP on Azure Summary][dbms-guide-5.8].</span></span>

## <a name="specifics-to-ibm-db2-for-luw-on-linux"></a><span data-ttu-id="42034-1321">Особенности IBM DB2 для LUW в Linux</span><span class="sxs-lookup"><span data-stu-id="42034-1321">Specifics to IBM DB2 for LUW on Linux</span></span>
<span data-ttu-id="42034-1322">Microsoft Azure позволяет легко перенести существующие приложения SAP, работающие в IBM DB2 для Linux, UNIX и Windows (LUW), на виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="42034-1322">With Microsoft Azure, you can easily migrate your existing SAP application running on IBM DB2 for Linux, UNIX, and Windows (LUW) to Azure virtual machines.</span></span> <span data-ttu-id="42034-1323">Для решений SAP на базе IBM DB2 для LUW администраторы и разработчики могут по-прежнему использовать те же средства разработки и администрирования, которые доступны локально.</span><span class="sxs-lookup"><span data-stu-id="42034-1323">With SAP on IBM DB2 for LUW, administrators and developers can still use the same development and administration tools, which are available on-premises.</span></span> <span data-ttu-id="42034-1324">Общую информацию о работе SAP Business Suite в IBM DB2 для LUW см. на сайте сообщества SAP (SCN): <https://www.sap.com/community/topic/db2-for-linux-unix-and-windows.html>.</span><span class="sxs-lookup"><span data-stu-id="42034-1324">General information about running SAP Business Suite on IBM DB2 for LUW can be found in the SAP Community Network (SCN) at <https://www.sap.com/community/topic/db2-for-linux-unix-and-windows.html>.</span></span>

<span data-ttu-id="42034-1325">Дополнительные сведения и новости о SAP в DB2 для LUW в Azure см. в примечании к SAP [2233094].</span><span class="sxs-lookup"><span data-stu-id="42034-1325">For additional information and updates about SAP on DB2 for LUW on Azure, see SAP Note [2233094].</span></span>

### <a name="ibm-db2-for-linux-unix-and-windows-version-support"></a><span data-ttu-id="42034-1326">Поддерживаемые версии IBM DB2 для Linux, UNIX и Windows</span><span class="sxs-lookup"><span data-stu-id="42034-1326">IBM DB2 for Linux, UNIX, and Windows Version Support</span></span>
<span data-ttu-id="42034-1327">SAP в IBM DB2 для LUW поддерживается в службах виртуальных машин Microsoft Azure начиная с версии DB2 10.5.</span><span class="sxs-lookup"><span data-stu-id="42034-1327">SAP on IBM DB2 for LUW on Microsoft Azure Virtual Machine Services is supported as of DB2 version 10.5.</span></span>

<span data-ttu-id="42034-1328">Дополнительные сведения о поддерживаемых продуктах SAP и типах виртуальных машин Azure см. в примечании к SAP [1928533].</span><span class="sxs-lookup"><span data-stu-id="42034-1328">For information about supported SAP products and Azure VM types, refer to SAP Note [1928533].</span></span>

### <a name="ibm-db2-for-linux-unix-and-windows-configuration-guidelines-for-sap-installations-in-azure-vms"></a><span data-ttu-id="42034-1329">Рекомендации по конфигурации IBM DB2 для Linux, UNIX и Windows для установки SAP на виртуальные машины Azure</span><span class="sxs-lookup"><span data-stu-id="42034-1329">IBM DB2 for Linux, UNIX, and Windows Configuration Guidelines for SAP Installations in Azure VMs</span></span>
#### <a name="storage-configuration"></a><span data-ttu-id="42034-1330">Конфигурация хранилища</span><span class="sxs-lookup"><span data-stu-id="42034-1330">Storage Configuration</span></span>
<span data-ttu-id="42034-1331">Все файлы базы данных должны храниться на подключенных напрямую дисках с файловой системой.</span><span class="sxs-lookup"><span data-stu-id="42034-1331">All database files must be stored on a file system based on directly attached disks.</span></span> <span data-ttu-id="42034-1332">Эти виртуальные жестки диски должны быть подключены к виртуальной машине Azure и созданы на основе хранилища страничных BLOB-объектов Azure (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) или Управляемых дисков (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span><span class="sxs-lookup"><span data-stu-id="42034-1332">These disks are mounted to the Azure VM and are based in Azure Page BLOB Storage (<https://docs.microsoft.com/rest/api/storageservices/Understanding-Block-Blobs--Append-Blobs--and-Page-Blobs>) or Managed Disks (<https://docs.microsoft.com/azure/storage/storage-managed-disks-overview>).</span></span> <span data-ttu-id="42034-1333">Сетевые диски всех типов и удаленные общие ресурсы, включая следующие файловые службы Azure, **невозможно** использовать для хранения файлов базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1333">Any kind of network drives or remote shares like the following Azure file services are **NOT** supported for database files:</span></span>

* <span data-ttu-id="42034-1334"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1334"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx></span></span>
* <span data-ttu-id="42034-1335"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span><span class="sxs-lookup"><span data-stu-id="42034-1335"><https://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/27/persisting-connections-to-microsoft-azure-files.aspx></span></span>

<span data-ttu-id="42034-1336">Если вы используете диски, созданные на основе хранилища страничных BLOB-объектов Azure, то сведения, приведенные в этом документе в разделе [Структура развертывания реляционной СУБД][dbms-guide-2], относятся также к развертываниям с базой данных IBM DB2 для LUW.</span><span class="sxs-lookup"><span data-stu-id="42034-1336">If you are using disks based on Azure Page BLOB Storage, the statements made in this document in chapter [Structure of an RDBMS Deployment][dbms-guide-2] also apply to deployments with the IBM DB2 for LUW Database.</span></span>

<span data-ttu-id="42034-1337">Как упомянуто в общей части этого документа, для дисков существуют квоты на количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1337">As explained earlier in the general part of the document, quotas on IOPS throughput for disks exist.</span></span> <span data-ttu-id="42034-1338">Квоты зависят от типа используемой виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="42034-1338">The exact quotas depend on the VM type used.</span></span> <span data-ttu-id="42034-1339">Список типов виртуальных машин с соответствующими квотами приведен [здесь (Linux)][virtual-machines-sizes-linux] и [здесь (Windows)][virtual-machines-sizes-windows].</span><span class="sxs-lookup"><span data-stu-id="42034-1339">A list of VM types with their quotas can be found [here (Linux)][virtual-machines-sizes-linux] and [here (Windows)][virtual-machines-sizes-windows].</span></span>

<span data-ttu-id="42034-1340">Если текущего количества операций ввода-вывода в секунду для каждого диска достаточно, все файлы базы данных можно хранить на одном диске.</span><span class="sxs-lookup"><span data-stu-id="42034-1340">As long as the current IOPS quota per disk is sufficient, it is possible to store all the database files on one single disk.</span></span>

<span data-ttu-id="42034-1341">Рекомендации по повышению производительности можно также найти в руководствах по установке SAP в разделе о рекомендациях по безопасности данных и повышению производительности в каталогах баз данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1341">For performance considerations also refer to chapter “Data Safety and Performance Considerations for Database Directories” in SAP installation guides.</span></span>

<span data-ttu-id="42034-1342">Кроме того, можно использовать диспетчер логических томов или MDADM, как описано в разделе [Программный RAID-массив][dbms-guide-2.2] этого документа, чтобы создать одно большое логическое устройство из нескольких дисков.</span><span class="sxs-lookup"><span data-stu-id="42034-1342">Alternatively, you can use LVM (Logical Volume Manager) or MDADM as described in chapter [Software RAID][dbms-guide-2.2] of this document to create one large logical device over multiple disks.</span></span>
<span data-ttu-id="42034-1343">Для дисков, на которых хранятся данные (sapdata) и временные каталоги (saptmp) SAP DB2, в качестве размера сектора физического диска необходимо указать 512 КБ.</span><span class="sxs-lookup"><span data-stu-id="42034-1343">For the disks containing the DB2 storage paths for your sapdata and saptmp directories, you must specify a physical disk sector size of 512 KB.</span></span>

#### <a name="backuprestore"></a><span data-ttu-id="42034-1344">Резервное копирование и восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1344">Backup/Restore</span></span>
<span data-ttu-id="42034-1345">Функции архивации и восстановления для IBM DB2 для LUW поддерживаются так же, как в стандартных локальных средах Linux.</span><span class="sxs-lookup"><span data-stu-id="42034-1345">The backup/restore functionality for IBM DB2 for LUW is supported in the same way as on standard Linux installation on-premises.</span></span>

<span data-ttu-id="42034-1346">У вас обязательно должна быть надежная стратегия резервного копирования базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1346">You must make sure that you have a valid database backup strategy in place.</span></span>

<span data-ttu-id="42034-1347">Как и при развертывании на сервер без операционной системы, скорость резервного копирования и восстановления зависит от количества томов, которые могут считываться параллельно, а также от пропускной способности этих томов.</span><span class="sxs-lookup"><span data-stu-id="42034-1347">As in bare-metal deployments, backup/restore performance depends on how many volumes can be read in parallel and what the throughput of those volumes might be.</span></span> <span data-ttu-id="42034-1348">Кроме того, загрузка ЦП при сжатии резервной копии может играть значительную роль на виртуальных машинах, имеющих не более восьми потоков ЦП.</span><span class="sxs-lookup"><span data-stu-id="42034-1348">In addition, the CPU consumption used by backup compression may play a significant role on VMs with just up to eight CPU threads.</span></span> <span data-ttu-id="42034-1349">Исходя из сказанного выше, можно сделать следующие выводы.</span><span class="sxs-lookup"><span data-stu-id="42034-1349">Therefore, one can assume:</span></span>

* <span data-ttu-id="42034-1350">Чем меньше дисков используется для хранения устройств базы данных, тем меньше общая пропускная способность при чтении.</span><span class="sxs-lookup"><span data-stu-id="42034-1350">The fewer the number of disks used to store the database devices, the smaller the overall throughput in reading</span></span>
* <span data-ttu-id="42034-1351">Чем меньше потоков ЦП на виртуальной машине, тем сильнее влияние сжатия резервной копии.</span><span class="sxs-lookup"><span data-stu-id="42034-1351">The smaller the number of CPU threads in the VM, the more severe the impact of backup compression</span></span>
* <span data-ttu-id="42034-1352">Чем меньше целевых объектов (чередующиеся каталоги, диски), на которые записываются резервные копии, тем меньше пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="42034-1352">The fewer targets (Stripe Directories, disks) to write the backup to, the lower the throughput</span></span>

<span data-ttu-id="42034-1353">Увеличить количество целевых объектов для записи можно двумя способами. Выбор того или иного варианта (и даже их сочетания) зависит от ваших потребностей.</span><span class="sxs-lookup"><span data-stu-id="42034-1353">To increase the number of targets to write to, two options can be used/combined depending on your needs:</span></span>

* <span data-ttu-id="42034-1354">Распределить содержимое целевого тома, на котором хранятся резервные копии, между несколькими дисками, чтобы увеличить на чередующемся томе количество операций ввода-вывода в секунду.</span><span class="sxs-lookup"><span data-stu-id="42034-1354">Striping the backup target volume over multiple disks in order to improve the IOPS throughput on that striped volume</span></span>
* <span data-ttu-id="42034-1355">Использовать несколько целевых каталогов, в которые будут записываться резервные копии.</span><span class="sxs-lookup"><span data-stu-id="42034-1355">Using more than one target directory to write the backup to</span></span>

#### <a name="high-availability-and-disaster-recovery"></a><span data-ttu-id="42034-1356">Высокая доступность и аварийное восстановление</span><span class="sxs-lookup"><span data-stu-id="42034-1356">High Availability and Disaster Recovery</span></span>
<span data-ttu-id="42034-1357">Поддерживается аварийное восстановление высокой доступности (HADR) DB2.</span><span class="sxs-lookup"><span data-stu-id="42034-1357">DB2 high availability disaster recovery (HADR) is supported.</span></span> <span data-ttu-id="42034-1358">Если в конфигурации высокой доступности виртуальные машины имеют работающее разрешение имен, настройка в Azure не будет отличаться от настройки, которая выполняется локально.</span><span class="sxs-lookup"><span data-stu-id="42034-1358">If the virtual machines of the HA configuration have working name resolution, the setup in Azure does not differ from any setup that is done on-premises.</span></span> <span data-ttu-id="42034-1359">Мы не рекомендуем полагаться только на разрешение IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="42034-1359">It is not recommended to rely on IP resolution only.</span></span>

<span data-ttu-id="42034-1360">Не используйте георепликацию для учетных записей хранения, в которых хранятся диски базы данных.</span><span class="sxs-lookup"><span data-stu-id="42034-1360">Do not use Geo-Replication for the storage accounts that store the database disks.</span></span> <span data-ttu-id="42034-1361">Дополнительные сведения см. в разделах [Служба хранилища Microsoft Azure][dbms-guide-2.3] и [Высокая доступность и аварийное восстановление с использованием виртуальных машин Azure][dbms-guide-3].</span><span class="sxs-lookup"><span data-stu-id="42034-1361">For more information, refer to chapter [Microsoft Azure Storage][dbms-guide-2.3] and chapter [High Availability and Disaster Recovery with Azure VMs][dbms-guide-3].</span></span>

#### <a name="other"></a><span data-ttu-id="42034-1362">Другие</span><span class="sxs-lookup"><span data-stu-id="42034-1362">Other</span></span>
<span data-ttu-id="42034-1363">Все другие общие темы, включая группы доступности Azure и мониторинг SAP, касаются также развертывания виртуальных машин с IBM DB2 для LUW, как описано в первых трех разделах этого документа.</span><span class="sxs-lookup"><span data-stu-id="42034-1363">All other general topics like Azure Availability Sets or SAP monitoring apply as described in the first three chapters of this document for deployments of VMs with IBM DB2 for LUW as well.</span></span>

<span data-ttu-id="42034-1364">Ознакомьтесь также с разделом [Общие сведения об SQL Server для SAP в Azure][dbms-guide-5.8].</span><span class="sxs-lookup"><span data-stu-id="42034-1364">Also refer to chapter [General SQL Server for SAP on Azure Summary][dbms-guide-5.8].</span></span>

