---
title: "Как сохранить постоянный виртуальный IP-адрес для облачной службы Azure | Документация Майкрософт"
description: "Узнайте, как сохранить постоянный виртуальный IP-адрес (VIP) облачной службы Azure."
services: visual-studio-online
documentationcenter: na
author: kraigb
manager: ghogen
editor: 
ms.assetid: 4a58e2c6-7a79-4051-8a2c-99182ff8b881
ms.service: multiple
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: multiple
ms.date: 03/21/2017
ms.author: kraigb
ms.openlocfilehash: a76bcba5ab4ca8e1a4899e4aa28f734c09af2aa9
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="retain-a-constant-virtual-ip-address-for-an-azure-cloud-service"></a><span data-ttu-id="38608-103">Сохранение постоянного виртуального IP-адреса для облачной службы Azure</span><span class="sxs-lookup"><span data-stu-id="38608-103">Retain a constant virtual IP address for an Azure cloud service</span></span>
<span data-ttu-id="38608-104">При обновлении облачной службы, размещенной в Azure, необходимо убедиться в том, что виртуальный IP-адрес (VIP) службы не изменяется.</span><span class="sxs-lookup"><span data-stu-id="38608-104">When you update a cloud service that's hosted in Azure, you might need to ensure that the virtual IP address (VIP) of the service doesn't change.</span></span> <span data-ttu-id="38608-105">Многие службы управления доменом используют службу доменных имен (DNS) для регистрации доменных имен.</span><span class="sxs-lookup"><span data-stu-id="38608-105">Many domain management services use the Domain Name System (DNS) for registering domain names.</span></span> <span data-ttu-id="38608-106">Регистрация с помощью DNS возможна, только если виртуальный IP-адрес остается неизменным.</span><span class="sxs-lookup"><span data-stu-id="38608-106">DNS works only if the VIP remains the same.</span></span> <span data-ttu-id="38608-107">Проверить, изменяется ли виртуальный IP-адрес облачной службы при обновлении, можно с помощью **мастера публикации** в инструментах Azure.</span><span class="sxs-lookup"><span data-stu-id="38608-107">You can use the **Publish Wizard** in Azure Tools to ensure that the VIP of your cloud service doesn’t change when you update it.</span></span> <span data-ttu-id="38608-108">Дополнительные сведения об управлении доменами DNS для облачных служб см. в статье [Настройка пользовательского доменного имени для облачной службы Azure](cloud-services/cloud-services-custom-domain-name.md).</span><span class="sxs-lookup"><span data-stu-id="38608-108">For more information about how to use DNS domain management for cloud services, see [Configuring a custom domain name for an Azure cloud service](cloud-services/cloud-services-custom-domain-name.md).</span></span>

## <a name="publish-a-cloud-service-without-changing-its-vip"></a><span data-ttu-id="38608-109">Публикация облачной службы без изменения ее виртуального IP-адреса</span><span class="sxs-lookup"><span data-stu-id="38608-109">Publish a cloud service without changing its VIP</span></span>
<span data-ttu-id="38608-110">Виртуальный IP-адрес (VIP) облачной службы назначается при первом развертывании службы в Azure в конкретной среде, например в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="38608-110">The VIP of a cloud service is allocated when you first deploy it to Azure in a particular environment, such as the production environment.</span></span> <span data-ttu-id="38608-111">Виртуальный IP-адрес изменяется, только если развертывание удаляется явно или если оно удаляется неявно в процессе обновления.</span><span class="sxs-lookup"><span data-stu-id="38608-111">The VIP changes only if you delete the deployment explicitly or the deployment is implicitly deleted by the deployment update process.</span></span> <span data-ttu-id="38608-112">Чтобы сохранить виртуальный IP-адрес, нельзя удалять развертывание. Кроме того, необходимо убедиться, что Visual Studio не удаляет развертывание автоматически.</span><span class="sxs-lookup"><span data-stu-id="38608-112">To retain the VIP, you must not delete your deployment, and you must make sure that Visual Studio doesn’t delete your deployment automatically.</span></span> 

<span data-ttu-id="38608-113">Можно указать параметры развертывания в **мастере публикации**, который поддерживает несколько вариантов развертывания.</span><span class="sxs-lookup"><span data-stu-id="38608-113">You can specify deployment settings in the **Publish Wizard**, which supports several deployment options.</span></span> <span data-ttu-id="38608-114">Можно указать новое развертывание или развертывание обновления, которое может быть добавочным или одновременным.</span><span class="sxs-lookup"><span data-stu-id="38608-114">You can specify a fresh deployment or an update deployment, which can be incremental or simultaneous.</span></span> <span data-ttu-id="38608-115">Оба вида развертывания обновления сохраняют виртуальный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="38608-115">Both kinds of update deployment retain the VIP.</span></span> <span data-ttu-id="38608-116">Определение разных типов развертывания см. в статье [Мастер публикации приложений Azure](vs-azure-tools-publish-azure-application-wizard.md).</span><span class="sxs-lookup"><span data-stu-id="38608-116">For definitions of these different types of deployment, see [Publish Azure Application Wizard](vs-azure-tools-publish-azure-application-wizard.md).</span></span> <span data-ttu-id="38608-117">Кроме того, можно указать, нужно ли удалять предыдущее развертывание облачной службы при возникновении ошибки.</span><span class="sxs-lookup"><span data-stu-id="38608-117">In addition, you can control whether the previous deployment of a cloud service is deleted if an error occurs.</span></span> <span data-ttu-id="38608-118">Виртуальный IP-адрес может неожиданно измениться, если этот параметр не задан правильно.</span><span class="sxs-lookup"><span data-stu-id="38608-118">If you don't set that option correctly, the VIP might change unexpectedly.</span></span>

## <a name="update-a-cloud-service-without-changing-its-vip"></a><span data-ttu-id="38608-119">Обновление облачной службы без изменения ее виртуального IP-адреса</span><span class="sxs-lookup"><span data-stu-id="38608-119">Update a cloud service without changing its VIP</span></span>
1. <span data-ttu-id="38608-120">Создайте или откройте проект облачной службы Azure в среде Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="38608-120">Create or open an Azure cloud service project in Visual Studio.</span></span> 

2. <span data-ttu-id="38608-121">В **обозревателе решений** щелкните проект правой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="38608-121">In **Solution Explorer**, right-click the project.</span></span> <span data-ttu-id="38608-122">В контекстном меню выберите **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="38608-122">On the shortcut menu, select **Publish**.</span></span>

    ![Меню публикации](./media/vs-azure-tools-cloud-service-retain-a-constant-virtual-ip-address/solution-explorer-publish-menu.png)

3. <span data-ttu-id="38608-124">В диалоговом окне **Опубликовать приложение Azure** выберите подписку Azure, в которую требуется выполнить развертывание.</span><span class="sxs-lookup"><span data-stu-id="38608-124">In the **Publish Azure Application** dialog box, select the Azure subscription to which you want to deploy.</span></span> <span data-ttu-id="38608-125">При необходимости войдите в систему и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="38608-125">Sign in if necessary, and select **Next**.</span></span>

    ![Публикация приложения Azure: страница входа](./media/vs-azure-tools-cloud-service-retain-a-constant-virtual-ip-address/azure-publish-signin.png)

4. <span data-ttu-id="38608-127">На вкладке **Общие параметры** проверьте правильность имени облачной службы, для которой выполняется развертывание, а также значений параметров **Среда**, **Конфигурация сборки** и **Конфигурация службы**.</span><span class="sxs-lookup"><span data-stu-id="38608-127">On the **Common Settings** tab, verify that the name of the cloud service to which you’re deploying, the **Environment**, the **Build configuration**, and the **Service configuration** are all correct.</span></span>

    ![Публикация приложения Azure: вкладка "Общие параметры"](./media/vs-azure-tools-cloud-service-retain-a-constant-virtual-ip-address/azure-publish-common-settings.png)

5. <span data-ttu-id="38608-129">На вкладке **Дополнительные параметры** убедитесь, что значения **Метка развертывания** и **Учетная запись хранения** указаны правильно.</span><span class="sxs-lookup"><span data-stu-id="38608-129">On the **Advanced Settings** tab, verify that the **Deployment label** and the **Storage account** are correct.</span></span> <span data-ttu-id="38608-130">Убедитесь, что флажок **Удалить развертывание при сбое** снят, а флажок **Обновление развертывания** установлен.</span><span class="sxs-lookup"><span data-stu-id="38608-130">Verify that the **Delete deployment on failure** check box is cleared, and verify that the **Deployment update** check box is selected.</span></span> <span data-ttu-id="38608-131">Снятый флажок **Удалить развертывание при сбое** гарантирует, что виртуальный IP-адрес не будет потерян при возникновении ошибки во время развертывания.</span><span class="sxs-lookup"><span data-stu-id="38608-131">By clearing the **Delete deployment on failure** check box, you ensure that your VIP isn't lost if an error occurs during deployment.</span></span> <span data-ttu-id="38608-132">Установленный флажок **Обновление развертывания** гарантирует, что развертывание не будет удалено, а виртуальный IP-адрес не будет потерян при повторной публикации приложения.</span><span class="sxs-lookup"><span data-stu-id="38608-132">By selecting the **Deployment update** check box, you ensure that your deployment isn't deleted and your VIP isn't lost when you republish your application.</span></span> 

    ![Публикация приложения Azure: вкладка "Дополнительные параметры"](./media/vs-azure-tools-cloud-service-retain-a-constant-virtual-ip-address/azure-publish-advanced-settings.png)

6. <span data-ttu-id="38608-134">Чтобы указать способ обновления в дальнейшем, щелкните **Параметры** рядом с флажком **Обновление развертывания**.</span><span class="sxs-lookup"><span data-stu-id="38608-134">To further specify how you want the roles to be updated, select **Settings** next to **Deployment update**.</span></span> <span data-ttu-id="38608-135">Затем выберите **Добавочное обновление** или **Одновременное обновление**. Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="38608-135">Select either **Incremental update** or **Simultaneous update**, and select **OK**.</span></span> <span data-ttu-id="38608-136">Если выбрать **Добавочное обновление**, то все экземпляры приложения будут обновляться по очереди, обеспечивая доступность приложения в любое время.</span><span class="sxs-lookup"><span data-stu-id="38608-136">Choose **Incremental update** to update each instance of your application, one after another, so that the application is always available.</span></span> <span data-ttu-id="38608-137">Если выбрать **Одновременное обновление**, то все экземпляры приложения будут обновляться одновременно.</span><span class="sxs-lookup"><span data-stu-id="38608-137">Choose **Simultaneous update** to update all instances of your application at the same time.</span></span> <span data-ttu-id="38608-138">Одновременное обновление выполняется быстрее, но служба может быть недоступна во время обновления.</span><span class="sxs-lookup"><span data-stu-id="38608-138">Simultaneous updating is faster, but your service might not be available during the update process.</span></span> <span data-ttu-id="38608-139">По завершении нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="38608-139">When you are finished, select **Next**.</span></span>

    ![Публикация приложения Azure: страница "Параметры развертывания"](./media/vs-azure-tools-cloud-service-retain-a-constant-virtual-ip-address/azure-publish-deployment-update-settings.png)

7. <span data-ttu-id="38608-141">В диалоговом окне **Опубликовать приложение Azure** нажимайте кнопку **Далее**, пока не отобразится страница **Сводка**.</span><span class="sxs-lookup"><span data-stu-id="38608-141">In the **Publish Azure Application** dialog box, select **Next** until the **Summary** page is displayed.</span></span> <span data-ttu-id="38608-142">Проверьте параметры и нажмите кнопку **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="38608-142">Verify your settings, and then select **Publish**.</span></span>
   
    ![Публикация приложения Azure: страница "Сводка"](./media/vs-azure-tools-cloud-service-retain-a-constant-virtual-ip-address/azure-publish-summary.png)

## <a name="next-steps"></a><span data-ttu-id="38608-144">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="38608-144">Next steps</span></span>
- [<span data-ttu-id="38608-145">Использование мастера публикации приложений Azure в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="38608-145">Using the Visual Studio Publish Azure Application Wizard</span></span>](vs-azure-tools-publish-azure-application-wizard.md)

