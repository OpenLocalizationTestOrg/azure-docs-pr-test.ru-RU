---
title: "Особенности использования BGP с VPN-шлюзами Azure | Документация Майкрософт"
description: "В статье описывается использование BGP с VPN-шлюзами Azure."
services: vpn-gateway
documentationcenter: na
author: yushwang
manager: rossort
editor: 
tags: 
ms.assetid: f8c3985c-c128-4f34-835c-0e88742bf36e
ms.service: vpn-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/12/2017
ms.author: yushwang
ms.openlocfilehash: 60d8dd45ecbd4a075721c25acadb21d4e2fd5448
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="overview-of-bgp-with-azure-vpn-gateways"></a>Обзор использования BGP с VPN-шлюзами Azure 
В этой статье описываются особенности использования протокола BGP для VPN-шлюзов Azure.

Стандартный протокол маршрутизации BGP обычно используется в Интернете для обмена данными о маршрутизации и доступности между двумя или несколькими сетями. В контексте виртуальных сетей Azure протокол BGP используется VPN-шлюзами Azure и локальными VPN-устройствами (так называемые узлы BGP) для обмена данными о маршрутах. Это позволяет информировать участников обмена о доступности и возможности передавать префиксы через шлюзы или маршрутизаторы. Также BGP позволяет передавать трафик транзитом через несколько сетей. Для этого шлюз BGP распространяет на все известные ему узлы BGP информацию о маршрутах, полученную от остальных узлов BGP. 

## <a name="why-use-bgp"></a>Почему именно BGP?
BGP не является обязательным протоколом для VPN-шлюзов Azure с использованием маршрутов. Также до включения протокола BGP следует убедиться, что ваши локальные VPN-устройства поддерживают его. Вы можете продолжать использовать VPN-шлюзы Azure и локальные VPN-устройства без протокола BGP. Для обмена данными между сетями и Azure можно использовать статические маршруты (без BGP) *или* динамическую маршрутизацию по протоколу BGP.

Преимущества и возможности протокола BGP:

### <a name="support-automatic-and-flexible-prefix-updates"></a>Поддержка автоматического и гибкого обновления префиксов
Если используется протокол BGP, достаточно объявить минимальный префикс для определенного узла BGP через VPN-туннель IPsec S2S. Это может быть даже небольшой префикс узла (/32) для IP-адреса узла BGP на локальном VPN-устройстве. Вы можете выбирать, какие из локальных префиксов будут объявлены в Azure, чтобы виртуальная сеть Azure получила к ним доступ.

Также можно объявлять более крупные префиксы, в том числе некоторые префиксы адресов виртуальной сети, например большое пространство частных IP-адресов (10.0.0.0/8 и т. д.). Обратите внимание, что эти префиксы не должны совпадать с префиксами виртуальной сети. Маршруты, идентичные префиксам виртуальной сети, будут отклонены.

### <a name="support-multiple-tunnels-between-a-vnet-and-an-on-premises-site-with-automatic-failover-based-on-bgp"></a>Поддержка нескольких туннелей между виртуальной сетью и локальным сайтом с автоматической отработкой отказа на основе BGP
Вы можете создавать несколько подключений между виртуальной сетью Azure и локальными VPN-устройствами в одном расположении. Это позволяет использовать между двумя сетями несколько туннелей (путей) в режиме "активный — активный". Если один из туннелей отключится, BGP отзовет соответствующие маршруты и трафик автоматически переместится в действующие туннели.

Следующая схема содержит простой пример настройки с высокой доступностью.

![Несколько активных путей](./media/vpn-gateway-bgp-overview/multiple-active-tunnels.png)

### <a name="support-transit-routing-between-your-on-premises-networks-and-multiple-azure-vnets"></a>Поддержка транзитной маршрутизации между локальными сетями и несколькими виртуальными сетями Azure
BGP позволяет нескольким шлюзам получать и распространять префиксы из разных сетей, подключенных к ним напрямую или опосредованно. Благодаря этому возможна транзитная маршрутизация через VPN-шлюзы Azure между локальными сайтами или несколькими виртуальными сетями Azure.

Следующая схема содержит пример многоскачковой топологии с несколькими путями, по которым трафик может проходить между двумя локальными сетями через VPN-шлюзы Azure в сети Microsoft.

![Многоскачковый транзит](./media/vpn-gateway-bgp-overview/full-mesh-transit.png)

## <a name="bgp-faq"></a>Часто задаваемые вопросы о BGP
[!INCLUDE [vpn-gateway-bgp-faq-include](../../includes/vpn-gateway-bpg-faq-include.md)]

## <a name="next-steps"></a>Дальнейшие действия
Действия по настройке BGP для межсистемных подключений и подключений между виртуальными сетями описаны в разделе [Настройка BGP на VPN-шлюзах Azure с помощью Azure Resource Manager и PowerShell](vpn-gateway-bgp-resource-manager-ps.md) .

