---
title: "Создание оповещений журнала действий | Документация Майкрософт"
description: "Уведомление посредством SMS, веб-перехватчика и электронной почты при возникновении определенных событий в журнале действий."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: johnkem
ms.openlocfilehash: 3885469ec0e1fcc31386dd0ad7fe6cb5d03ab28e
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="create-activity-log-alerts"></a>Создание оповещений журнала действий

## <a name="overview"></a>Обзор
Оповещения журнала действий создаются в тех случаях, когда происходит новое событие, записываемое в журнал действий, которое соответствует определенным условиям для оповещения. Они являются ресурсами Azure, поэтому их можно создать с помощью шаблона Azure Resource Manager. Их также можно создать, обновить или удалить на портале Azure. В этой статье описаны принципы работы оповещений журнала действий. В ней также показано, как использовать портал Azure, чтобы настроить оповещения о событиях журнала действий.

Обычно оповещения журнала действий создаются для получения уведомлений в таких случаях:

* Внесение определенных изменений в ресурсы в вашей подписке Azure. Как правило, это конкретные группы ресурсов или ресурсы. Например, можно получать уведомления при удалении любой виртуальной машины в группе ресурсов myProductionResourceGroup. Или может потребоваться получать уведомления при назначении каких-либо новых ролей пользователю в вашей подписке.
* Возникновение события работоспособности службы. События работоспособности службы включают в себя уведомления об инцидентах и событиях обслуживания, относящихся к ресурсам в подписке.

В любом случае оповещения журнала действий позволяют отслеживать только события в подписке, в которой создается оповещение.

Оповещения журнала действий можно настроить на основе любого свойства верхнего уровня в объекте JSON для события журнала действий. Тем не менее на портале показаны наиболее распространенные варианты:

- **Категория.** Возможные значения: "Административный", "Работоспособность службы", "Автомасштабирование" или "Рекомендация". Дополнительные сведения см. в разделе [Категории в журнале действий](./monitoring-overview-activity-logs.md#categories-in-the-activity-log). Дополнительные сведения о событиях службы работоспособности см. в статье [Создание оповещений журнала действий для уведомлений службы](./monitoring-activity-log-alerts-on-service-notifications.md).
- **Группа ресурсов**
- **Ресурс**
- **Тип ресурса**
- **Имя операции.** Имя операции управления доступом на основе ролей диспетчера ресурсов.
- **Уровень.** Уровень серьезности события ("Подробный", "Информационное", "Предупреждение", "Ошибка" или "Критическое").
- **Состояние.** Состояние события, обычно "Запущено", "Сбой" или "Успешно".
- **Кем инициировано событие.** Это условие также называется "вызывающей стороной". Адрес электронной почты или идентификатор Azure Active Directory пользователя, выполнившего операцию.

>[!NOTE]
>В оповещении нужно указать по крайней мере два из указанных выше условий, одним из которых должна быть категория. Вы не можете создать оповещение, которое активируется каждый раз при создании события в журнале действий.
>
>

При активации оповещения журнала действий используется группа действий для создания действий или уведомлений. Группа действий — это многократно используемый набор приемников уведомлений, таких как адреса электронной почты, URL-адреса веб-перехватчиков или номера телефонов для отправки SMS. На приемники можно ссылаться из нескольких уведомлений, чтобы централизовать и группировать каналы уведомлений. Есть два способа определения оповещения журнала действий. Вы можете:

* Использовать имеющуюся группу действий в оповещении журнала действий. 
* Создать группу действий. 

Дополнительные сведения о группах действия см. в статье [Создание групп действий и управление ими на портале Azure](monitoring-action-groups.md).

Дополнительные сведения об уведомлениях о работоспособности службы см. в статье [Создание оповещений журнала действий для уведомлений службы](monitoring-activity-log-alerts-on-service-notifications.md).

## <a name="create-an-alert-on-an-activity-log-event-with-a-new-action-group-by-using-the-azure-portal"></a>Создание оповещения для событий журнала действий с новой группой действий с помощью портала Azure
1. На [портале](https://portal.azure.com) выберите **Монитор**.

    ![Служба "Монитор"](./media/monitoring-activity-log-alerts/home-monitor.png)
2. В разделе **Журнал действий** выберите **Оповещения**.

    ![Вкладка "Оповещения"](./media/monitoring-activity-log-alerts/alerts-blades.png)
3. Выберите **Add activity log alert** (Добавить оповещение журнала действий) и заполните поля.

4. Введите имя в поле **Activity log alert name** (Имя оповещения журнала действий), а затем выберите **Описание**.

    ![Команда Add activity log alert (Добавить оповещение журнала действий)](./media/monitoring-activity-log-alerts/add-activity-log-alert.png)

5. Поле **Подписка** автоматически заполняется вашей текущей подпиской. В этой подписке сохраняются группы действий. Кроме того, в ней будет развернут ресурс оповещения и будут отслеживаться события журнала действий.

    ![Диалоговое окно Add activity log alert (Добавить оповещение журнала действий)](./media/monitoring-activity-log-alerts/activity-log-alert-new-action-group.png)

6. Выберите **группу ресурсов**, в которой создается ресурс оповещения. Эта группа ресурсов не отслеживается в оповещении. В ней расположен ресурс оповещения.

7. При необходимости выберите **Категория событий**, чтобы изменить отобразившиеся дополнительные фильтры. Для административных событий есть такие фильтры, как **Группа ресурсов**, **Ресурс**, **Тип ресурса**, **Имя операции**, **Уровень**, **Состояние** и **Event initiated by** (Кем инициировано событие). Эти значения определяют, какие события должны отслеживать это предупреждение.

    >[!NOTE]
    >В оповещении необходимо указать хотя бы одно из описанных выше условий. Вы не можете создать оповещение, которое активируется каждый раз при создании события в журнале действий.
    >
    >

8. Введите имя в поля **Action group name** (Имя группы действий) и **Short name** (Короткое имя). Короткое имя используется вместо полного имени группы действий при отправке уведомлений с помощью этой группы.

9.  Определите список действий, указав для каждого из них следующие данные:

    а. **Имя.** Введите имя, псевдоним или идентификатор действия.

    b. **Тип действия.** Выберите SMS, электронную почту или веб-перехватчик.

    c. **Подробные сведения.** В зависимости от выбранного типа действия укажите номер телефона, адрес электронной почты или универсальный код ресурса (URI) веб-перехватчика.

10. Нажмите кнопку **ОК**, чтобы создать оповещение.

Может потребоваться несколько минут на полное распространение оповещения, после чего оно становится активным. Оповещение активируется, когда новые события соответствуют его условиям.

Дополнительные сведения см. в статье [Объекты webhook для оповещений журнала действий Azure](monitoring-activity-log-alerts-webhook.md).

>[!NOTE]
>Группу действий, определенную при выполнении этих шагов, можно использовать повторно в качестве имеющейся группы действий для всех будущих определений оповещений.
>
>

## <a name="create-an-alert-on-an-activity-log-event-for-an-existing-action-group-by-using-the-azure-portal"></a>Создание оповещения для событий журнала действий для имеющейся группы действий с помощью портала Azure
1. Выполните шаги 1–7 в предыдущем разделе для создания оповещения журнала действий.

2. В разделе **Notify via** (Уведомить по) нажмите кнопку группы действий **Существующий**. Выберите имеющуюся группу действий из списка.

3. Нажмите кнопку **ОК**, чтобы создать оповещение.

Может потребоваться несколько минут на полное распространение оповещения, после чего оно становится активным. Оповещение активируется, когда новые события соответствуют его условиям.

## <a name="manage-your-alerts"></a>Управление оповещениями

Созданное оповещение отображается в разделе "Оповещения" в колонке "Монитор". Выберите оповещение, которым нужно управлять, чтобы получить возможность:

* Изменить его.
* Удалить его.
* Отключить и включить его, если нужно временно остановить или возобновить получение уведомлений для этого оповещения.

## <a name="next-steps"></a>Дальнейшие действия
- Ознакомьтесь с [обзором оповещений](monitoring-overview-alerts.md).
- Дополнительные сведения об ограничении частоты отправки уведомлений см. в статье [Ограничение частоты отправки для SMS, сообщений электронной почты и вызовов Webhook](monitoring-alerts-rate-limiting.md).
- Просмотрите схему веб-перехватчика оповещений журнала действий в статье [Объекты webhook для оповещений журнала действий Azure](monitoring-activity-log-alerts-webhook.md).
- Дополнительные сведения о группах действий см. в статье [Создание групп действий и управление ими на портале Azure](monitoring-action-groups.md).  
- Дополнительные сведения об уведомлениях о работоспособности службы см. в [этой статье](monitoring-service-notifications.md).
- Создайте [оповещение журнала действий, чтобы отслеживать все операции системы автомасштабирования в своей подписке](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert).
- Создайте [оповещение журнала действий, чтобы отслеживать все ошибки автомасштабирования в своей подписке](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).
