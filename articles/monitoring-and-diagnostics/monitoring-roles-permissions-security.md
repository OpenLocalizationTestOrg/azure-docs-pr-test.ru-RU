---
title: "aaaGet работы с ролями, разрешения и безопасности с помощью монитора Azure | Документы Microsoft"
description: "Узнайте, как встроенные роли и разрешения toorestrict монитора toouse Azure доступ к ресурсам toomonitoring."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 2686e53b-72f0-4312-bcd3-3dc1b4a9b912
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2016
ms.author: johnkem
ms.openlocfilehash: 44fdf2a697050309480dfc164ebab51445b19bc8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="get-started-with-roles-permissions-and-security-with-azure-monitor"></a><span data-ttu-id="4cc17-103">Приступая к работе с ролями, разрешениями и системой безопасности с помощью Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="4cc17-103">Get started with roles, permissions, and security with Azure Monitor</span></span>
<span data-ttu-id="4cc17-104">Многие команды требуется toostrictly регулировать доступ toomonitoring данные и параметры.</span><span class="sxs-lookup"><span data-stu-id="4cc17-104">Many teams need toostrictly regulate access toomonitoring data and settings.</span></span> <span data-ttu-id="4cc17-105">Например, если участники команды, работающие только на наблюдение за (инженеры службы поддержки, специалисты devops) или если используется поставщик управляемых услуг, вы можете toogrant им доступа tooonly наблюдение за данными, ограничивая их возможности toocreate при, изменить, или Удаление ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4cc17-105">For example, if you have team members who work exclusively on monitoring (support engineers, devops engineers) or if you use a managed service provider, you may want toogrant them access tooonly monitoring data while restricting their ability toocreate, modify, or delete resources.</span></span> <span data-ttu-id="4cc17-106">В этой статье показано, как tooquickly применяются встроенные мониторинга RBAC роли tooa пользователя в Azure или построить пользовательские роли для пользователя, которому ограниченные разрешения для мониторинга.</span><span class="sxs-lookup"><span data-stu-id="4cc17-106">This article shows how tooquickly apply a built-in monitoring RBAC role tooa user in Azure or build your own custom role for a user who needs limited monitoring permissions.</span></span> <span data-ttu-id="4cc17-107">Он затем рассматриваются вопросы безопасности для ресурсов, связанных с монитором Azure и как можно ограничить доступ к данным toohello они содержат.</span><span class="sxs-lookup"><span data-stu-id="4cc17-107">It then discusses security considerations for your Azure Monitor-related resources and how you can limit access toohello data they contain.</span></span>

## <a name="built-in-monitoring-roles"></a><span data-ttu-id="4cc17-108">Встроенные роли мониторинга</span><span class="sxs-lookup"><span data-stu-id="4cc17-108">Built-in monitoring roles</span></span>
<span data-ttu-id="4cc17-109">Встроенные роли Azure монитор отвечают спроектированный toohelp ограничение доступа tooresources в подписке, то же время позволяя те, для мониторинга инфраструктуры tooobtain и настройте hello данные, которые им необходимы.</span><span class="sxs-lookup"><span data-stu-id="4cc17-109">Azure Monitor’s built-in roles are designed toohelp limit access tooresources in a subscription while still enabling those responsible for monitoring infrastructure tooobtain and configure hello data they need.</span></span> <span data-ttu-id="4cc17-110">Azure Monitor предоставляет две готовые роли: Monitoring Reader и Monitoring Contributor.</span><span class="sxs-lookup"><span data-stu-id="4cc17-110">Azure Monitor provides two out-of-the-box roles: A Monitoring Reader and a Monitoring Contributor.</span></span>

### <a name="monitoring-reader"></a><span data-ttu-id="4cc17-111">Роль Monitoring Reader</span><span class="sxs-lookup"><span data-stu-id="4cc17-111">Monitoring Reader</span></span>
<span data-ttu-id="4cc17-112">Назначить роль чтения мониторинга hello людей можно просматривать все данные наблюдения в подписке, но нельзя изменить любой ресурс или изменить какие-либо параметры toomonitoring связанные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="4cc17-112">People assigned hello Monitoring Reader role can view all monitoring data in a subscription but cannot modify any resource or edit any settings related toomonitoring resources.</span></span> <span data-ttu-id="4cc17-113">Эту роль подходит для пользователей в организации, например операций или поддержки инженеров, которым требуется возможность toobe:</span><span class="sxs-lookup"><span data-stu-id="4cc17-113">This role is appropriate for users in an organization, such as support or operations engineers, who need toobe able to:</span></span>

* <span data-ttu-id="4cc17-114">Просмотр информационных панелей мониторинга портала hello и создать свои собственные закрытый информационных панелей мониторинга.</span><span class="sxs-lookup"><span data-stu-id="4cc17-114">View monitoring dashboards in hello portal and create their own private monitoring dashboards.</span></span>
* <span data-ttu-id="4cc17-115">Запрос для метрик с помощью hello [API REST Azure монитор](https://msdn.microsoft.com/library/azure/dn931930.aspx), [командлеты PowerShell](insights-powershell-samples.md), или [CLI кросс платформенных](insights-cli-samples.md).</span><span class="sxs-lookup"><span data-stu-id="4cc17-115">Query for metrics using hello [Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931930.aspx), [PowerShell cmdlets](insights-powershell-samples.md), or [cross-platform CLI](insights-cli-samples.md).</span></span>
* <span data-ttu-id="4cc17-116">Запрос hello журнал действий с помощью портала hello, API REST Azure монитор, командлеты PowerShell или кросс платформенных CLI.</span><span class="sxs-lookup"><span data-stu-id="4cc17-116">Query hello Activity Log using hello portal, Azure Monitor REST API, PowerShell cmdlets, or cross-platform CLI.</span></span>
* <span data-ttu-id="4cc17-117">Представление hello [параметров диагностики](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) для ресурса.</span><span class="sxs-lookup"><span data-stu-id="4cc17-117">View hello [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.</span></span>
* <span data-ttu-id="4cc17-118">Представление hello [входа профиль](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) для подписки.</span><span class="sxs-lookup"><span data-stu-id="4cc17-118">View hello [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.</span></span>
* <span data-ttu-id="4cc17-119">Просмотр параметров автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="4cc17-119">View autoscale settings.</span></span>
* <span data-ttu-id="4cc17-120">Просмотр действий и параметров оповещений.</span><span class="sxs-lookup"><span data-stu-id="4cc17-120">View alert activity and settings.</span></span>
* <span data-ttu-id="4cc17-121">Доступ к данным Application Insights и просмотр данных в Application Insights Analytics.</span><span class="sxs-lookup"><span data-stu-id="4cc17-121">Access Application Insights data and view data in AI Analytics.</span></span>
* <span data-ttu-id="4cc17-122">Поиск данных рабочей области анализа журналов (OMS), включая данные об использовании для hello рабочей области.</span><span class="sxs-lookup"><span data-stu-id="4cc17-122">Search Log Analytics (OMS) workspace data including usage data for hello workspace.</span></span>
* <span data-ttu-id="4cc17-123">Просмотр групп управления Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-123">View Log Analytics (OMS) management groups.</span></span>
* <span data-ttu-id="4cc17-124">Получить схему поиска hello аналитика журналов (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-124">Retrieve hello Log Analytics (OMS) search schema.</span></span>
* <span data-ttu-id="4cc17-125">Вывод списка пакетов интеллектуализации Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-125">List Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="4cc17-126">Извлечение и выполнение сохраненных поисков Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-126">Retrieve and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="4cc17-127">Получить конфигурацию хранилища hello аналитика журналов (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-127">Retrieve hello Log Analytics (OMS) storage configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="4cc17-128">Эта роль не позволяет получить данные toolog доступ для чтения потоковых tooan концентратора событий или хранятся в учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="4cc17-128">This role does not give read access toolog data that has been streamed tooan event hub or stored in a storage account.</span></span> <span data-ttu-id="4cc17-129">[См. ниже](#security-considerations-for-monitoring-data) сведения о настройке доступа к ресурсам toothese.</span><span class="sxs-lookup"><span data-stu-id="4cc17-129">[See below](#security-considerations-for-monitoring-data) for information on configuring access toothese resources.</span></span>
> 
> 

### <a name="monitoring-contributor"></a><span data-ttu-id="4cc17-130">Monitoring Contributor</span><span class="sxs-lookup"><span data-stu-id="4cc17-130">Monitoring Contributor</span></span>
<span data-ttu-id="4cc17-131">Сотрудникам hello мониторинга участника роли могут просматривать все данные мониторинга для подписки и создать или изменить параметры наблюдения, но также могут изменять другие ресурсы.</span><span class="sxs-lookup"><span data-stu-id="4cc17-131">People assigned hello Monitoring Contributor role can view all monitoring data in a subscription and create or modify monitoring settings, but cannot modify any other resources.</span></span> <span data-ttu-id="4cc17-132">Эта роль является надмножеством роль чтения мониторинга hello и подходит для членов группы мониторинга и управляемые поставщики служб, кроме разрешения toohello выше, также должны toobe возможность организации:</span><span class="sxs-lookup"><span data-stu-id="4cc17-132">This role is a superset of hello Monitoring Reader role, and is appropriate for members of an organization’s monitoring team or managed service providers who, in addition toohello permissions above, also need toobe able to:</span></span>

* <span data-ttu-id="4cc17-133">Публикация панелей мониторинга для совместного использования.</span><span class="sxs-lookup"><span data-stu-id="4cc17-133">Publish monitoring dashboards as a shared dashboard.</span></span>
* <span data-ttu-id="4cc17-134">Настройка [параметров диагностики](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) для ресурса.*</span><span class="sxs-lookup"><span data-stu-id="4cc17-134">Set [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.*</span></span>
* <span data-ttu-id="4cc17-135">Набор hello [входа профиль](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) для subscription.*</span><span class="sxs-lookup"><span data-stu-id="4cc17-135">Set hello [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.*</span></span>
* <span data-ttu-id="4cc17-136">Настройка действий и параметров оповещений.</span><span class="sxs-lookup"><span data-stu-id="4cc17-136">Set alert activity and settings.</span></span>
* <span data-ttu-id="4cc17-137">Создание веб-тестов и компонентов Application Insights.</span><span class="sxs-lookup"><span data-stu-id="4cc17-137">Create Application Insights web tests and components.</span></span>
* <span data-ttu-id="4cc17-138">Вывод списка общих ключей рабочей области Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-138">List Log Analytics (OMS) workspace shared keys.</span></span>
* <span data-ttu-id="4cc17-139">Включение или отключение пакетов интеллектуализации Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-139">Enable or disable Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="4cc17-140">Создание и удаление сохраненных поисков Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-140">Create and delete and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="4cc17-141">Создание и удаление конфигурации хранилища hello аналитика журналов (OMS).</span><span class="sxs-lookup"><span data-stu-id="4cc17-141">Create and delete hello Log Analytics (OMS) storage configuration.</span></span>

<span data-ttu-id="4cc17-142">* пользователя отдельно также должно быть предоставлено разрешение ListKeys hello целевого ресурса (хранилища учетной записи или событие пространство имен концентратора) tooset профиля журнала или параметра диагностики.</span><span class="sxs-lookup"><span data-stu-id="4cc17-142">*user must also separately be granted ListKeys permission on hello target resource (storage account or event hub namespace) tooset a log profile or diagnostic setting.</span></span>

> [!NOTE]
> <span data-ttu-id="4cc17-143">Эта роль не позволяет получить данные toolog доступ для чтения потоковых tooan концентратора событий или хранятся в учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="4cc17-143">This role does not give read access toolog data that has been streamed tooan event hub or stored in a storage account.</span></span> <span data-ttu-id="4cc17-144">[См. ниже](#security-considerations-for-monitoring-data) сведения о настройке доступа к ресурсам toothese.</span><span class="sxs-lookup"><span data-stu-id="4cc17-144">[See below](#security-considerations-for-monitoring-data) for information on configuring access toothese resources.</span></span>
> 
> 

## <a name="monitoring-permissions-and-custom-rbac-roles"></a><span data-ttu-id="4cc17-145">Разрешения мониторинга и настраиваемые роли RBAC</span><span class="sxs-lookup"><span data-stu-id="4cc17-145">Monitoring permissions and custom RBAC roles</span></span>
<span data-ttu-id="4cc17-146">Если hello выше встроенных ролей не отвечают hello потребностей вашей команды, вы можете [Создание пользовательской роли RBAC](../active-directory/role-based-access-control-custom-roles.md) с более детализированные разрешения.</span><span class="sxs-lookup"><span data-stu-id="4cc17-146">If hello above built-in roles don’t meet hello exact needs of your team, you can [create a custom RBAC role](../active-directory/role-based-access-control-custom-roles.md) with more granular permissions.</span></span> <span data-ttu-id="4cc17-147">Ниже приведены hello общих операций Azure монитор RBAC с описаниями.</span><span class="sxs-lookup"><span data-stu-id="4cc17-147">Below are hello common Azure Monitor RBAC operations with their descriptions.</span></span>

| <span data-ttu-id="4cc17-148">Операция</span><span class="sxs-lookup"><span data-stu-id="4cc17-148">Operation</span></span> | <span data-ttu-id="4cc17-149">Описание</span><span class="sxs-lookup"><span data-stu-id="4cc17-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="4cc17-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="4cc17-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span></span> |<span data-ttu-id="4cc17-151">Чтение, запись и удаление правила генерации оповещений.</span><span class="sxs-lookup"><span data-stu-id="4cc17-151">Read/write/delete alert rules.</span></span> |
| <span data-ttu-id="4cc17-152">Microsoft.Insights/AlertRules/Incidents/Read</span><span class="sxs-lookup"><span data-stu-id="4cc17-152">Microsoft.Insights/AlertRules/Incidents/Read</span></span> |<span data-ttu-id="4cc17-153">Список инцидентов (журнал запустилась правило генерации оповещений hello) для правил оповещения.</span><span class="sxs-lookup"><span data-stu-id="4cc17-153">List incidents (history of hello alert rule being triggered) for alert rules.</span></span> <span data-ttu-id="4cc17-154">Это относится только toohello портала.</span><span class="sxs-lookup"><span data-stu-id="4cc17-154">This only applies toohello portal.</span></span> |
| <span data-ttu-id="4cc17-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="4cc17-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="4cc17-156">Чтение, запись и удаление параметров автомасштабирования.</span><span class="sxs-lookup"><span data-stu-id="4cc17-156">Read/write/delete autoscale settings.</span></span> |
| <span data-ttu-id="4cc17-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="4cc17-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="4cc17-158">Чтение, запись и удаление параметров диагностики.</span><span class="sxs-lookup"><span data-stu-id="4cc17-158">Read/write/delete diagnostic settings.</span></span> |
| <span data-ttu-id="4cc17-159">Microsoft.Insights/eventtypes/digestevents/Read</span><span class="sxs-lookup"><span data-stu-id="4cc17-159">Microsoft.Insights/eventtypes/digestevents/Read</span></span> |<span data-ttu-id="4cc17-160">Это разрешение необходимо для пользователей, которым требуется доступ к журналам tooActivity через портал hello.</span><span class="sxs-lookup"><span data-stu-id="4cc17-160">This permission is necessary for users who need access tooActivity Logs via hello portal.</span></span> |
| <span data-ttu-id="4cc17-161">Microsoft.Insights/eventtypes/values/Read</span><span class="sxs-lookup"><span data-stu-id="4cc17-161">Microsoft.Insights/eventtypes/values/Read</span></span> |<span data-ttu-id="4cc17-162">Вывод списка событий журнала действий (событий управления) в подписке.</span><span class="sxs-lookup"><span data-stu-id="4cc17-162">List Activity Log events (management events) in a subscription.</span></span> <span data-ttu-id="4cc17-163">Это разрешение — программный и портала доступ применимо tooboth toohello журнал действий.</span><span class="sxs-lookup"><span data-stu-id="4cc17-163">This permission is applicable tooboth programmatic and portal access toohello Activity Log.</span></span> |
| <span data-ttu-id="4cc17-164">Microsoft.Insights/LogDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="4cc17-164">Microsoft.Insights/LogDefinitions/Read</span></span> |<span data-ttu-id="4cc17-165">Это разрешение необходимо для пользователей, которым требуется доступ к журналам tooActivity через портал hello.</span><span class="sxs-lookup"><span data-stu-id="4cc17-165">This permission is necessary for users who need access tooActivity Logs via hello portal.</span></span> |
| <span data-ttu-id="4cc17-166">Microsoft.Insights/MetricDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="4cc17-166">Microsoft.Insights/MetricDefinitions/Read</span></span> |<span data-ttu-id="4cc17-167">Чтение определений метрик (вывод списка доступных типов метрик для ресурса).</span><span class="sxs-lookup"><span data-stu-id="4cc17-167">Read metric definitions (list of available metric types for a resource).</span></span> |
| <span data-ttu-id="4cc17-168">Microsoft.Insights/Metrics/Read</span><span class="sxs-lookup"><span data-stu-id="4cc17-168">Microsoft.Insights/Metrics/Read</span></span> |<span data-ttu-id="4cc17-169">Чтение метрик для ресурса.</span><span class="sxs-lookup"><span data-stu-id="4cc17-169">Read metrics for a resource.</span></span> |

> [!NOTE]
> <span data-ttu-id="4cc17-170">Tooalerts доступ, параметры диагностики и метрики для ресурса требуется этот hello пользователь имеет доступ на чтение toohello ресурса типа и области действия ресурса.</span><span class="sxs-lookup"><span data-stu-id="4cc17-170">Access tooalerts, diagnostic settings, and metrics for a resource requires that hello user has Read access toohello resource type and scope of that resource.</span></span> <span data-ttu-id="4cc17-171">Создание («написать отзыв») диагностики параметр журнала профиль или что архивы tooa хранилища учетной записи или в потоки tooevent концентраторов требует tooalso пользователя hello разрешение ListKeys на hello целевого ресурса.</span><span class="sxs-lookup"><span data-stu-id="4cc17-171">Creating (“write”) a diagnostic setting or log profile that archives tooa storage account or streams tooevent hubs requires hello user tooalso have ListKeys permission on hello target resource.</span></span>
> 
> 

<span data-ttu-id="4cc17-172">Например с помощью hello над таблицей удалось создать пользовательской роли RBAC «действие чтения журнала» следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4cc17-172">For example, using hello above table you could create a custom RBAC role for an “Activity Log Reader” like this:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Activity Log Reader"
$role.Description = "Can view activity logs."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Insights/eventtypes/*")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription")
New-AzureRmRoleDefinition -Role $role 
```

## <a name="security-considerations-for-monitoring-data"></a><span data-ttu-id="4cc17-173">Вопросы безопасности данных мониторинга</span><span class="sxs-lookup"><span data-stu-id="4cc17-173">Security considerations for monitoring data</span></span>
<span data-ttu-id="4cc17-174">Данные мониторинга, в особенности файлы журналов, могут содержать конфиденциальные сведения, такие как IP-адреса или имена пользователей.</span><span class="sxs-lookup"><span data-stu-id="4cc17-174">Monitoring data—particularly log files—can contain sensitive information, such as IP addresses or user names.</span></span> <span data-ttu-id="4cc17-175">Данные мониторинга поступают из Azure в трех основных формах:</span><span class="sxs-lookup"><span data-stu-id="4cc17-175">Monitoring data from Azure comes in three basic forms:</span></span>

1. <span data-ttu-id="4cc17-176">Здравствуйте, журнал действий, который описывает все действия плоскости управления в своей подписке Azure.</span><span class="sxs-lookup"><span data-stu-id="4cc17-176">hello Activity Log, which describes all control-plane actions on your Azure subscription.</span></span>
2. <span data-ttu-id="4cc17-177">журналы диагностики, выдаваемые ресурсом;</span><span class="sxs-lookup"><span data-stu-id="4cc17-177">Diagnostic Logs, which are logs emitted by a resource.</span></span>
3. <span data-ttu-id="4cc17-178">метрики, выдаваемые ресурсами.</span><span class="sxs-lookup"><span data-stu-id="4cc17-178">Metrics, which are emitted by resources.</span></span>

<span data-ttu-id="4cc17-179">Все три из этих типов данных может храниться в учетной записи хранилища, или передавать их потоком tooEvent концентратора, которые являются общего назначения ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="4cc17-179">All three of these data types can be stored in a storage account or streamed tooEvent Hub, both of which are general-purpose Azure resources.</span></span> <span data-ttu-id="4cc17-180">Так как это универсальные ресурсы, то их создание, удаление и доступ к ним являются привилегированными операциями, которые обычно зарезервированы для администратора.</span><span class="sxs-lookup"><span data-stu-id="4cc17-180">Because these are general-purpose resources, creating, deleting, and accessing them is a privileged operation usually reserved for an administrator.</span></span> <span data-ttu-id="4cc17-181">Мы рекомендуем использовать методы неправильное использование ресурсов, связанных с мониторингом tooprevent hello:</span><span class="sxs-lookup"><span data-stu-id="4cc17-181">We suggest that you use hello following practices for monitoring-related resources tooprevent misuse:</span></span>

* <span data-ttu-id="4cc17-182">Используйте отдельную учетную запись хранения для данных мониторинга.</span><span class="sxs-lookup"><span data-stu-id="4cc17-182">Use a single, dedicated storage account for monitoring data.</span></span> <span data-ttu-id="4cc17-183">Если вам требуется tooseparate данных мониторинга на несколько учетных записей хранилища, никогда не используют использование учетной записи хранилища между мониторинга и данные, отличных от наблюдения, что случайно дать тех, кто только требуется доступ к данным toomonitoring (например)</span><span class="sxs-lookup"><span data-stu-id="4cc17-183">If you need tooseparate monitoring data into multiple storage accounts, never share usage of a storage account between monitoring and non-monitoring data, as this may inadvertently give those who only need access toomonitoring data (eg.</span></span> <span data-ttu-id="4cc17-184">сторонние SIEM) доступ к данным мониторинга toonon.</span><span class="sxs-lookup"><span data-stu-id="4cc17-184">a third-party SIEM) access toonon-monitoring data.</span></span>
* <span data-ttu-id="4cc17-185">Используйте единый, выделенных имен Service Bus или концентратор событий во всех параметров диагностики для hello же причинам, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="4cc17-185">Use a single, dedicated Service Bus or Event Hub namespace across all diagnostic settings for hello same reason as above.</span></span>
* <span data-ttu-id="4cc17-186">Ограничения, сохраняя их в отдельной группе ресурсов, учетные записи хранения, связанные с toomonitoring доступа или концентраторов событий и [использовать область](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) на ролях мониторинга toolimit получить доступ к tooonly данной группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4cc17-186">Limit access toomonitoring-related storage accounts or event hubs by keeping them in a separate resource group, and [use scope](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) on your monitoring roles toolimit access tooonly that resource group.</span></span>
* <span data-ttu-id="4cc17-187">Предоставьте разрешение ListKeys hello учетным записям хранения или концентраторов событий в области видимости подписки никогда не в том случае, когда пользователю требуется только доступ к данным toomonitoring.</span><span class="sxs-lookup"><span data-stu-id="4cc17-187">Never grant hello ListKeys permission for either storage accounts or event hubs at subscription scope when a user only needs access toomonitoring data.</span></span> <span data-ttu-id="4cc17-188">Вместо этого предоставьте пользователя toohello эти разрешения на ресурс или группа ресурсов (если имеется отдельная группа ресурсов мониторинга) области.</span><span class="sxs-lookup"><span data-stu-id="4cc17-188">Instead, give these permissions toohello user at a resource or resource group (if you have a dedicated monitoring resource group) scope.</span></span>

### <a name="limiting-access-toomonitoring-related-storage-accounts"></a><span data-ttu-id="4cc17-189">Ограничение учетных записей хранения, связанные с toomonitoring доступа</span><span class="sxs-lookup"><span data-stu-id="4cc17-189">Limiting access toomonitoring-related storage accounts</span></span>
<span data-ttu-id="4cc17-190">Когда пользователь или приложение должно получить доступ к toomonitoring данные в учетной записи хранилища, следует [создать SAS для учетной записи](https://msdn.microsoft.com/library/azure/mt584140.aspx) в учетной записи хранения hello, содержащий данные наблюдения с хранилищем tooblob доступа только для чтения на уровне службы.</span><span class="sxs-lookup"><span data-stu-id="4cc17-190">When a user or application needs access toomonitoring data in a storage account, you should [generate an Account SAS](https://msdn.microsoft.com/library/azure/mt584140.aspx) on hello storage account that contains monitoring data with service-level read-only access tooblob storage.</span></span> <span data-ttu-id="4cc17-191">В PowerShell это может выглядеть следующим образом.</span><span class="sxs-lookup"><span data-stu-id="4cc17-191">In PowerShell, this might look like:</span></span>

```powershell
$context = New-AzureStorageContext -ConnectionString "[connection string for your monitoring Storage Account]"
$token = New-AzureStorageAccountSASToken -ResourceType Service -Service Blob -Permission "rl" -Context $context
```

<span data-ttu-id="4cc17-192">После этого можно предоставить hello маркера toohello сущность, которая должна tooread из этой учетной записи хранилища, и его можно перечислить и считывать все большие двоичные объекты в этой учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="4cc17-192">You can then give hello token toohello entity that needs tooread from that storage account, and it can list and read from all blobs in that storage account.</span></span>

<span data-ttu-id="4cc17-193">Кроме того при необходимости это разрешение с помощью RBAC toocontrol можно предоставить этой сущности hello Microsoft.Storage/storageAccounts/listkeys/action разрешение для этой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="4cc17-193">Alternatively, if you need toocontrol this permission with RBAC, you can grant that entity hello Microsoft.Storage/storageAccounts/listkeys/action permission on that particular storage account.</span></span> <span data-ttu-id="4cc17-194">Это необходимо для пользователей, которым нужно будет tooset toobe диагностики параметр или журнала профиль tooarchive tooa учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="4cc17-194">This is necessary for users who need toobe able tooset a diagnostic setting or log profile tooarchive tooa storage account.</span></span> <span data-ttu-id="4cc17-195">Например можно создать следующие пользовательские RBAC роль для пользователя или приложения, нужно только tooread из одну учетную запись хранения hello:</span><span class="sxs-lookup"><span data-stu-id="4cc17-195">For example, you could create hello following custom RBAC role for a user or application that only needs tooread from one storage account:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Monitoring Storage Account Reader"
$role.Description = "Can get hello storage account keys for a monitoring storage account."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Storage/storageAccounts/listkeys/action")
$role.Actions.Add("Microsoft.Storage/storageAccounts/Read")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/myMonitoringStorageAccount")
New-AzureRmRoleDefinition -Role $role 
```

> [!WARNING]
> <span data-ttu-id="4cc17-196">Hello разрешение ListKeys позволяет hello пользователя toolist hello первичные и вторичные ключи учетной записи.</span><span class="sxs-lookup"><span data-stu-id="4cc17-196">hello ListKeys permission enables hello user toolist hello primary and secondary storage account keys.</span></span> <span data-ttu-id="4cc17-197">Эти ключи предоставьте hello все подписанные разрешения (чтение, запись, создание больших двоичных объектов, удалите BLOB-объектов, т. д.) по всем подпись службы (больших двоичных объектов, очередей, таблицы, файла) в этой учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="4cc17-197">These keys grant hello user all signed permissions (read, write, create blobs, delete blobs, etc.) across all signed services (blob, queue, table, file) in that storage account.</span></span> <span data-ttu-id="4cc17-198">Рекомендуется при возможности использовать SAS учетной записи, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="4cc17-198">We recommend using an Account SAS described above when possible.</span></span>
> 
> 

### <a name="limiting-access-toomonitoring-related-event-hubs"></a><span data-ttu-id="4cc17-199">Ограничение доступа концентраторы событий, связанных с toomonitoring</span><span class="sxs-lookup"><span data-stu-id="4cc17-199">Limiting access toomonitoring-related event hubs</span></span>
<span data-ttu-id="4cc17-200">Той же модели, которые можно выполнять с концентраторами событий, но сначала необходимо toocreate выделенное правила авторизации прослушивания.</span><span class="sxs-lookup"><span data-stu-id="4cc17-200">A similar pattern can be followed with event hubs, but first you need toocreate a dedicated Listen authorization rule.</span></span> <span data-ttu-id="4cc17-201">Если требуется toogrant доступ tooan приложение, которое нужно только концентраторов событий, связанных с toomonitoring toolisten hello следующие:</span><span class="sxs-lookup"><span data-stu-id="4cc17-201">If you want toogrant access tooan application that only needs toolisten toomonitoring-related event hubs, do hello following:</span></span>

1. <span data-ttu-id="4cc17-202">Создайте политики общего доступа на hello концентраторы событий, созданные для мониторинга данных с помощью только прослушивания утверждения.</span><span class="sxs-lookup"><span data-stu-id="4cc17-202">Create a shared access policy on hello event hub(s) that were created for streaming monitoring data with only Listen claims.</span></span> <span data-ttu-id="4cc17-203">Это можно сделать на портале hello.</span><span class="sxs-lookup"><span data-stu-id="4cc17-203">This can be done in hello portal.</span></span> <span data-ttu-id="4cc17-204">Например, можно назвать ее monitoringReadOnly.</span><span class="sxs-lookup"><span data-stu-id="4cc17-204">For example, you might call it “monitoringReadOnly.”</span></span> <span data-ttu-id="4cc17-205">Если это возможно требуется toogive, непосредственно ключа toohello потребителя и пропустить следующий шаг hello.</span><span class="sxs-lookup"><span data-stu-id="4cc17-205">If possible, you will want toogive that key directly toohello consumer and skip hello next step.</span></span>
2. <span data-ttu-id="4cc17-206">Если потребитель hello должен toobe может tooget hello ключа компьютер компьютер, предоставьте hello hello ListKeys для действия пользователя этот концентратор событий.</span><span class="sxs-lookup"><span data-stu-id="4cc17-206">If hello consumer needs toobe able tooget hello key ad-hoc, grant hello user hello ListKeys action for that event hub.</span></span> <span data-ttu-id="4cc17-207">Это также необходимо для пользователей, которым требуется доступ tooset toobe параметра диагностики или журнала концентраторов tooevent toostream профиля.</span><span class="sxs-lookup"><span data-stu-id="4cc17-207">This is also necessary for users who need toobe able tooset a diagnostic setting or log profile toostream tooevent hubs.</span></span> <span data-ttu-id="4cc17-208">Например, можно создать правило RBAC, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="4cc17-208">For example, you might create an RBAC rule:</span></span>
   
   ```powershell
   $role = Get-AzureRmRoleDefinition "Reader"
   $role.Id = $null
   $role.Name = "Monitoring Event Hub Listener"
   $role.Description = "Can get hello key toolisten tooan event hub streaming monitoring data."
   $role.Actions.Clear()
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/authorizationrules/listkeys/action")
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/Read")
   $role.AssignableScopes.Clear()
   $role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.ServiceBus/namespaces/mySBNameSpace")
   New-AzureRmRoleDefinition -Role $role 
   ```

## <a name="next-steps"></a><span data-ttu-id="4cc17-209">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="4cc17-209">Next steps</span></span>
* [<span data-ttu-id="4cc17-210">Прочитайте о RBAC и разрешениях в Resource Manager</span><span class="sxs-lookup"><span data-stu-id="4cc17-210">Read about RBAC and permissions in Resource Manager</span></span>](../active-directory/role-based-access-control-what-is.md)
* [<span data-ttu-id="4cc17-211">Обзор hello мониторинга в Azure</span><span class="sxs-lookup"><span data-stu-id="4cc17-211">Read hello overview of monitoring in Azure</span></span>](monitoring-overview.md)

