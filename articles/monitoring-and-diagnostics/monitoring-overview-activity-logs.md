---
title: "aaaOverview из hello журнал действий Azure | Документы Microsoft"
description: "Узнайте, какие hello имеет журнал действий Azure и способы ее toounderstand событиями, происходящими в подписке Azure."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: c274782f-039d-4c28-9ddb-f89ce21052c7
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/02/2017
ms.author: johnkem
ms.openlocfilehash: cba79b7f6dc0833ef588382e763761fd77d43307
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-subscription-activity-with-hello-azure-activity-log"></a><span data-ttu-id="44364-103">Мониторинг подписки hello журнал действий Azure</span><span class="sxs-lookup"><span data-stu-id="44364-103">Monitor Subscription Activity with hello Azure Activity Log</span></span>
<span data-ttu-id="44364-104">Hello **журнал действий Azure** — это журнал подписки, позволяет контролировать уровень подписки события, которые произошли в Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-104">hello **Azure Activity Log** is a subscription log that provides insight into subscription-level events that have occurred in Azure.</span></span> <span data-ttu-id="44364-105">Это включает диапазон данных из диспетчера ресурсов Azure tooupdates рабочие данные о событиях службы работоспособности.</span><span class="sxs-lookup"><span data-stu-id="44364-105">This includes a range of data, from Azure Resource Manager operational data tooupdates on Service Health events.</span></span> <span data-ttu-id="44364-106">Журнал действий Hello ранее была известна как «Журналы аудита» или «Операционные журналы» с момента события отчетов плоскости управления hello административную категорию для ваших подписок.</span><span class="sxs-lookup"><span data-stu-id="44364-106">hello Activity Log was previously known as “Audit Logs” or “Operational Logs,” since hello Administrative category reports control-plane events for your subscriptions.</span></span> <span data-ttu-id="44364-107">С помощью hello журнал действий, можно определить hello ", который и когда" для любой записи операции (PUT, POST, удаление), затраченное на hello ресурсам в подписке.</span><span class="sxs-lookup"><span data-stu-id="44364-107">Using hello Activity Log, you can determine hello ‘what, who, and when’ for any write operations (PUT, POST, DELETE) taken on hello resources in your subscription.</span></span> <span data-ttu-id="44364-108">Вы также можете понимать hello состояние операции hello и другие соответствующие свойства.</span><span class="sxs-lookup"><span data-stu-id="44364-108">You can also understand hello status of hello operation and other relevant properties.</span></span> <span data-ttu-id="44364-109">Журнал действий Hello не включает операций чтения (GET) или операций для ресурсов, использующих классический hello / модели «RDFE».</span><span class="sxs-lookup"><span data-stu-id="44364-109">hello Activity Log does not include read (GET) operations or operations for resources that use hello Classic/"RDFE" model.</span></span>

![<span data-ttu-id="44364-110">Журналы действий и другие типы журналов</span><span class="sxs-lookup"><span data-stu-id="44364-110">Activity Logs vs other types of logs</span></span> ](./media/monitoring-overview-activity-logs/Activity_Log_vs_other_logs_v5.png)

<span data-ttu-id="44364-111">Рис. 1. Журналы действий и другие типы журналов</span><span class="sxs-lookup"><span data-stu-id="44364-111">Figure 1: Activity Logs vs other types of logs</span></span>

<span data-ttu-id="44364-112">Hello журнал действий отличается от [журналы диагностики](monitoring-overview-of-diagnostic-logs.md).</span><span class="sxs-lookup"><span data-stu-id="44364-112">hello Activity Log differs from [Diagnostic Logs](monitoring-overview-of-diagnostic-logs.md).</span></span> <span data-ttu-id="44364-113">Журналы действий предоставляют данные о hello операций над ресурсом из hello за пределами (hello «плоскости управления»).</span><span class="sxs-lookup"><span data-stu-id="44364-113">Activity Logs provide data about hello operations on a resource from hello outside (hello "control plane").</span></span> <span data-ttu-id="44364-114">Журналы диагностики передаются каким-либо ресурсом и приводятся сведения об операции hello этого ресурса (hello «плоскости данных»).</span><span class="sxs-lookup"><span data-stu-id="44364-114">Diagnostics Logs are emitted by a resource and provide information about hello operation of that resource (hello "data plane").</span></span>

<span data-ttu-id="44364-115">События можно извлечь из действия журналов с помощью hello портал Azure CLI, командлеты PowerShell и API REST Azure монитора.</span><span class="sxs-lookup"><span data-stu-id="44364-115">You can retrieve events from your Activity Log using hello Azure portal, CLI, PowerShell cmdlets, and Azure Monitor REST API.</span></span>


> [!WARNING]
> <span data-ttu-id="44364-116">Журнал действий Azure Hello используется главным образом для действия, которые происходят в диспетчере ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-116">hello Azure Activity Log is primarily for activities that occur in Azure Resource Manager.</span></span> <span data-ttu-id="44364-117">Она не отслеживает ресурсов с помощью модели классический/RDFE hello.</span><span class="sxs-lookup"><span data-stu-id="44364-117">It does not track resources using hello Classic/RDFE model.</span></span> <span data-ttu-id="44364-118">Для некоторых классических типов ресурсов в Azure Resource Manager имеется прокси-поставщик ресурсов (например, Microsoft.ClassicCompute).</span><span class="sxs-lookup"><span data-stu-id="44364-118">Some Classic resource types have a proxy resource provider in Azure Resource Manager (for example, Microsoft.ClassicCompute).</span></span> <span data-ttu-id="44364-119">Если взаимодействовать с типом ресурса классического посредством Azure Resource Manager с помощью этих поставщиков ресурсов прокси-сервера, hello операций отображаются в hello журнал действий.</span><span class="sxs-lookup"><span data-stu-id="44364-119">If you interact with a Classic resource type through Azure Resource Manager using these proxy resource providers, hello operations appear in hello Activity Log.</span></span> <span data-ttu-id="44364-120">При взаимодействие с классический ресурс типа hello классическом портале или в противном случае значение за пределами hello прокси диспетчера ресурсов Azure, ваши действия только регистрируются в hello журнала операций.</span><span class="sxs-lookup"><span data-stu-id="44364-120">If you interact with a Classic resource type in hello Classic portal or otherwise outside of hello Azure Resource Manager proxies, your actions are only recorded in hello Operation Log.</span></span> <span data-ttu-id="44364-121">Hello журнала операций будет доступен только в классическом портале hello.</span><span class="sxs-lookup"><span data-stu-id="44364-121">hello Operation Log is accessible only in hello Classic portal.</span></span>
>
>

<span data-ttu-id="44364-122">Представление hello следующие видео Знакомство с приложением hello журнал действий.</span><span class="sxs-lookup"><span data-stu-id="44364-122">View hello following video introducing hello Activity Log.</span></span>
> [!VIDEO https://channel9.msdn.com/Blogs/Seth-Juarez/Logs-John-Kemnetz/player]
> 
>

## <a name="categories-in-hello-activity-log"></a><span data-ttu-id="44364-123">Категории в hello журнал действий</span><span class="sxs-lookup"><span data-stu-id="44364-123">Categories in hello Activity Log</span></span>
<span data-ttu-id="44364-124">Журнал действий Hello содержит несколько категорий данных.</span><span class="sxs-lookup"><span data-stu-id="44364-124">hello Activity Log contains several categories of data.</span></span> <span data-ttu-id="44364-125">Подробные сведения о hello схем из этих категорий [см. в статье](monitoring-activity-log-schema.md).</span><span class="sxs-lookup"><span data-stu-id="44364-125">For full details on hello schemata of these categories, [see this article](monitoring-activity-log-schema.md).</span></span> <span data-ttu-id="44364-126">В частности, описаны такие возможности:</span><span class="sxs-lookup"><span data-stu-id="44364-126">These include:</span></span>
* <span data-ttu-id="44364-127">**Административные** — эта категория содержит запись hello всех создавать, выполнять операции обновления, удаления и action через диспетчер ресурсов.</span><span class="sxs-lookup"><span data-stu-id="44364-127">**Administrative** - This category contains hello record of all create, update, delete, and action operations performed through Resource Manager.</span></span> <span data-ttu-id="44364-128">Примеры типов событий, отображаемые в этой категории относятся hello «создайте виртуальную машину» и «удалить сетевую группу безопасности «всех действий, выполненных пользователем или приложения с помощью диспетчера ресурсов моделируется как операцию для определенного типа ресурсов.</span><span class="sxs-lookup"><span data-stu-id="44364-128">Examples of hello types of events you would see in this category include "create virtual machine" and "delete network security group" Every action taken by a user or application using Resource Manager is modeled as an operation on a particular resource type.</span></span> <span data-ttu-id="44364-129">Если тип операции hello записи, Delete или действие, hello начала hello и успех или сбой данной операции записываются в hello административную категорию.</span><span class="sxs-lookup"><span data-stu-id="44364-129">If hello operation type is Write, Delete, or Action, hello records of both hello start and success or fail of that operation are recorded in hello Administrative category.</span></span> <span data-ttu-id="44364-130">Административная категория Hello также включает любой элемент управления доступом на основе toorole изменения в подписку.</span><span class="sxs-lookup"><span data-stu-id="44364-130">hello Administrative category also includes any changes toorole-based access control in a subscription.</span></span>
* <span data-ttu-id="44364-131">**Работоспособность службы** — эта категория содержит запись hello любой службы работоспособности инцидентов, произошедших в Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-131">**Service Health** - This category contains hello record of any service health incidents that have occurred in Azure.</span></span> <span data-ttu-id="44364-132">Пример hello тип события, отображаемые в этой категории — «SQL Azure в регионе Восток США испытывает времени простоя».</span><span class="sxs-lookup"><span data-stu-id="44364-132">An example of hello type of event you would see in this category is "SQL Azure in East US is experiencing downtime."</span></span> <span data-ttu-id="44364-133">События работоспособности службы бывают пять видов: требуется действие вспомогательная восстановления, инцидент, обслуживания, сведения и безопасности и появятся только при наличии ресурсов, в подписке hello, которое бы повлиять hello событий.</span><span class="sxs-lookup"><span data-stu-id="44364-133">Service health events come in five varieties: Action Required, Assisted Recovery, Incident, Maintenance, Information, or Security, and only appear if you have a resource in hello subscription that would be impacted by hello event.</span></span>
* <span data-ttu-id="44364-134">**Предупреждения** — эта категория содержит hello записи для всех активаций оповещения Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-134">**Alert** - This category contains hello record of all activations of Azure alerts.</span></span> <span data-ttu-id="44364-135">Пример hello тип события, отображаемые в этой категории — «% ЦП на myVM был более чем на 80 для hello за последние 5 минут.»</span><span class="sxs-lookup"><span data-stu-id="44364-135">An example of hello type of event you would see in this category is "CPU % on myVM has been over 80 for hello past 5 minutes."</span></span> <span data-ttu-id="44364-136">Различные системы Azure работают по принципу оповещений, то есть вы можете определить какое-то правило, и система будет направлять вам уведомление, когда условия этого правила выполняются.</span><span class="sxs-lookup"><span data-stu-id="44364-136">A variety of Azure systems have an alerting concept -- you can define a rule of some sort and receive a notification when conditions match that rule.</span></span> <span data-ttu-id="44364-137">Каждый раз, поддерживаемых Azure тип оповещения «активирует,» или hello условия выполнены toogenerate уведомление, запись активации hello также помещается toothis категории hello журнал действий.</span><span class="sxs-lookup"><span data-stu-id="44364-137">Each time a supported Azure alert type 'activates,' or hello conditions are met toogenerate a notification, a record of hello activation is also pushed toothis category of hello Activity Log.</span></span>
* <span data-ttu-id="44364-138">**Автомасштабирование** — эта категория содержит запись hello любой операции toohello связанные события подсистемы автомасштабирования hello соответствии с параметрами автоматического масштабирования, определены в вашей подписке.</span><span class="sxs-lookup"><span data-stu-id="44364-138">**Autoscale** - This category contains hello record of any events related toohello operation of hello autoscale engine based on any autoscale settings you have defined in your subscription.</span></span> <span data-ttu-id="44364-139">Пример hello тип события, отображаемые в этой категории — «Автомасштабирования масштабирования вверх не удалось выполнить действие».</span><span class="sxs-lookup"><span data-stu-id="44364-139">An example of hello type of event you would see in this category is "Autoscale scale up action failed."</span></span> <span data-ttu-id="44364-140">С помощью автоматического масштабирования, можно автоматически масштабировать или масштабирования в hello число экземпляров в типе поддерживаемых ресурсов на основе времени дня и/или загрузки данных (метрики), с помощью параметров автоматического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="44364-140">Using autoscale, you can automatically scale out or scale in hello number of instances in a supported resource type based on time of day and/or load (metric) data using an autoscale setting.</span></span> <span data-ttu-id="44364-141">При выполнении условий hello tooscale вверх или вниз, hello start и успешном или неудачном события записываются в эту категорию.</span><span class="sxs-lookup"><span data-stu-id="44364-141">When hello conditions are met tooscale up or down, hello start and succeeded or failed events are recorded in this category.</span></span>
* <span data-ttu-id="44364-142">**Рекомендация**. Эта категория содержит события рекомендации из определенных типов ресурсов, таких как веб-сайты и серверы SQL Server.</span><span class="sxs-lookup"><span data-stu-id="44364-142">**Recommendation** - This category contains recommendation events from certain resource types, such as web sites and SQL servers.</span></span> <span data-ttu-id="44364-143">Эти события предоставляют рекомендации по toobetter использование ресурсов.</span><span class="sxs-lookup"><span data-stu-id="44364-143">These events offer recommendations for how toobetter utilize your resources.</span></span> <span data-ttu-id="44364-144">Вы будете получать события этого типа, только если у вас будут ресурсы, которые генерируют рекомендации.</span><span class="sxs-lookup"><span data-stu-id="44364-144">You only receive events of this type if you have resources that emit recommendations.</span></span>
* <span data-ttu-id="44364-145">**Политика, Безопасность и Работоспособность ресурсов**. Эти категории не содержат никаких событий. Они зарезервированы для использования в будущем.</span><span class="sxs-lookup"><span data-stu-id="44364-145">**Policy, Security, and Resource Health** - These categories do not contain any events; they are reserved for future use.</span></span>

## <a name="event-schema-per-category"></a><span data-ttu-id="44364-146">Схема событий по категориям</span><span class="sxs-lookup"><span data-stu-id="44364-146">Event schema per category</span></span>
[<span data-ttu-id="44364-147">См. Эта схема статьи toounderstand hello журналом событий по категориям.</span><span class="sxs-lookup"><span data-stu-id="44364-147">See this article toounderstand hello Activity Log event schema per category.</span></span>](monitoring-activity-log-schema.md)

## <a name="what-you-can-do-with-hello-activity-log"></a><span data-ttu-id="44364-148">Что делать с hello журнал действий</span><span class="sxs-lookup"><span data-stu-id="44364-148">What you can do with hello Activity Log</span></span>
<span data-ttu-id="44364-149">Ниже приведены некоторые hello вещей, которые можно выполнить с hello журнал действий.</span><span class="sxs-lookup"><span data-stu-id="44364-149">Here are some of hello things you can do with hello Activity Log:</span></span>

![Журнал действий Azure](./media/monitoring-overview-activity-logs/Activity_Log_Overview_v3.png)


* <span data-ttu-id="44364-151">Запрос и просмотреть его в hello **портал Azure**.</span><span class="sxs-lookup"><span data-stu-id="44364-151">Query and view it in hello **Azure portal**.</span></span>
* [<span data-ttu-id="44364-152">Создание оповещения о событии журнала действий Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-152">Create an alert on an Activity Log event.</span></span>](monitoring-activity-log-alerts.md)
* <span data-ttu-id="44364-153">[Потоковую передачу tooan **концентратора событий** ](monitoring-stream-activity-logs-event-hubs.md) продукты для использования службой сторонних или пользовательских analytics решение, например PowerBI.</span><span class="sxs-lookup"><span data-stu-id="44364-153">[Stream it tooan **Event Hub**](monitoring-stream-activity-logs-event-hubs.md) for ingestion by a third-party service or custom analytics solution such as PowerBI.</span></span>
* <span data-ttu-id="44364-154">Анализировать их в PowerBI, с помощью hello [ **пакет содержимого для PowerBI**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/).</span><span class="sxs-lookup"><span data-stu-id="44364-154">Analyze it in PowerBI using hello [**PowerBI content pack**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/).</span></span>
* <span data-ttu-id="44364-155">[Сохраните его tooa **учетной записи хранилища** проверка архивации или вручную](monitoring-archive-activity-log.md).</span><span class="sxs-lookup"><span data-stu-id="44364-155">[Save it tooa **Storage Account** for archival or manual inspection](monitoring-archive-activity-log.md).</span></span> <span data-ttu-id="44364-156">Можно указать срок хранения по hello (в днях) с помощью hello **профиля журнала**.</span><span class="sxs-lookup"><span data-stu-id="44364-156">You can specify hello retention time (in days) using hello **Log Profile**.</span></span>
* <span data-ttu-id="44364-157">Обращение к журналу с помощью командлетов PowerShell, интерфейса командной строки или REST API.</span><span class="sxs-lookup"><span data-stu-id="44364-157">Query it via PowerShell Cmdlet, CLI, or REST API.</span></span>

## <a name="query-hello-activity-log-in-hello-azure-portal"></a><span data-ttu-id="44364-158">Запрос hello журнал действий в hello портал Azure</span><span class="sxs-lookup"><span data-stu-id="44364-158">Query hello Activity Log in hello Azure portal</span></span>
<span data-ttu-id="44364-159">В пределах hello портал Azure можно просмотреть журнал действий в нескольких местах:</span><span class="sxs-lookup"><span data-stu-id="44364-159">Within hello Azure portal you can view your Activity Log in several places:</span></span>
* <span data-ttu-id="44364-160">Hello **журнал действий колонке**, к которому можно получить путем поиска hello журнал действий в группе «Более службы» hello левой панели навигации.</span><span class="sxs-lookup"><span data-stu-id="44364-160">hello **Activity Log blade**, which you can access by searching for hello Activity Log under "More Services" in hello left-hand navigation pane.</span></span>
* <span data-ttu-id="44364-161">Hello **монитор колонке**, который отображается по умолчанию hello левой панели навигации.</span><span class="sxs-lookup"><span data-stu-id="44364-161">hello **Monitor blade**, which appears by default in hello left-hand navigation pane.</span></span> <span data-ttu-id="44364-162">Hello журнал действий — один раздел эту колонку монитора Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-162">hello Activity Log is one section of this Azure Monitor blade.</span></span>
* <span data-ttu-id="44364-163">Любой ресурс **колонки ресурсов**, например hello колонке конфигурации для виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="44364-163">Any resource's **resource blade**, for example, hello configuration blade for a Virtual Machine.</span></span> <span data-ttu-id="44364-164">Hello журнал действий быть один из разделов hello для большинства из этих ресурсов колонок и щелкнув его автоматически фильтрует события hello toothose связанные toothat конкретный ресурс.</span><span class="sxs-lookup"><span data-stu-id="44364-164">hello Activity Log is be one of hello sections on most of these resource blades, and clicking on it automatically filters hello events toothose related toothat specific resource.</span></span>

<span data-ttu-id="44364-165">В hello портал Azure можно выполнить фильтрацию в журнал действий по этим полям:</span><span class="sxs-lookup"><span data-stu-id="44364-165">In hello Azure portal, you can filter your Activity Log by these fields:</span></span>
* <span data-ttu-id="44364-166">TimeSpan - hello начального и конечного времени для события.</span><span class="sxs-lookup"><span data-stu-id="44364-166">Timespan - hello start and end time for events.</span></span>
* <span data-ttu-id="44364-167">Категория - hello категории событий, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="44364-167">Category - hello event category as described above.</span></span>
* <span data-ttu-id="44364-168">"Подписка": одно или несколько имен подписок Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-168">Subscription - One or more Azure subscription names.</span></span>
* <span data-ttu-id="44364-169">"Группа ресурсов": одна или несколько групп ресурсов в этих подписках.</span><span class="sxs-lookup"><span data-stu-id="44364-169">Resource group - One or more resource groups within those subscriptions.</span></span>
* <span data-ttu-id="44364-170">Ресурс (имя) — имя hello определенного ресурса.</span><span class="sxs-lookup"><span data-stu-id="44364-170">Resource (name) - hello name of a specific resource.</span></span>
* <span data-ttu-id="44364-171">Тип ресурса - hello тип ресурса, например, Microsoft.Compute/virtualmachines.</span><span class="sxs-lookup"><span data-stu-id="44364-171">Resource type - hello type of resource, for example, Microsoft.Compute/virtualmachines.</span></span>
* <span data-ttu-id="44364-172">Имя операции - hello имя операции диспетчера ресурсов Azure, например, Microsoft.SQL/servers/Write.</span><span class="sxs-lookup"><span data-stu-id="44364-172">Operation name - hello name of an Azure Resource Manager operation, for example, Microsoft.SQL/servers/Write.</span></span>
* <span data-ttu-id="44364-173">Важность - hello степень серьезности события hello (информационные сообщения, предупреждения, ошибки, критическое).</span><span class="sxs-lookup"><span data-stu-id="44364-173">Severity - hello severity level of hello event (Informational, Warning, Error, Critical).</span></span>
* <span data-ttu-id="44364-174">Событие, инициированное - вызывающий «hello» или пользователя, выполнившего операцию hello.</span><span class="sxs-lookup"><span data-stu-id="44364-174">Event initiated by - hello 'caller,' or user who performed hello operation.</span></span>
* <span data-ttu-id="44364-175">"Открыть поиск": текстовое поле поиска, с помощью которого можно искать указанную строку во всех полях всех событий.</span><span class="sxs-lookup"><span data-stu-id="44364-175">Open search - This is an open text search box that searches for that string across all fields in all events.</span></span>

<span data-ttu-id="44364-176">После того как определен набор фильтров, его можно сохранить как запрос, в которой сохраняется между сеансами, если требуется tooperform hello же запрос, с этими фильтрами применен повторно, в будущем hello.</span><span class="sxs-lookup"><span data-stu-id="44364-176">Once you have defined a set of filters, you can save it as a query that is persisted across sessions if you ever need tooperform hello same query with those filters applied again in hello future.</span></span> <span data-ttu-id="44364-177">Можно также закрепить запроса tooyour панель мониторинга Azure tooalways keep внимание на определенных событий.</span><span class="sxs-lookup"><span data-stu-id="44364-177">You can also pin a query tooyour Azure dashboard tooalways keep an eye on specific events.</span></span>

<span data-ttu-id="44364-178">Если щелкнуть "Применить", будет выполнен запрос и показаны все соответствующие ему события.</span><span class="sxs-lookup"><span data-stu-id="44364-178">Clicking "Apply" runs your query and show all matching events.</span></span> <span data-ttu-id="44364-179">Щелкнув по любому событию в hello перечисляются hello Сводка этого события, а также hello полной необработанные JSON этого события.</span><span class="sxs-lookup"><span data-stu-id="44364-179">Clicking on any event in hello list shows hello summary of that event as well as hello full raw JSON of that event.</span></span>

<span data-ttu-id="44364-180">Еще больше сократить щелкните hello **поиска журналов** значок, который отображает данные журнала действий в hello [действия журнала журнала аналитика Analytics решения](../log-analytics/log-analytics-activity.md).</span><span class="sxs-lookup"><span data-stu-id="44364-180">For even more power, you can click hello **Log Search** icon, which displays your Activity Log data in hello [Log Analytics Activity Log Analytics solution](../log-analytics/log-analytics-activity.md).</span></span> <span data-ttu-id="44364-181">Журнал действий колонке Hello предлагает возможности основные фильтр/обзора на журналы, но служба аналитики журналов позволяет toopivot, выполнения запросов и визуализации данных более мощные функции.</span><span class="sxs-lookup"><span data-stu-id="44364-181">hello Activity Log blade offers a basic filter/browse experience on logs, but Log Analytics enables you toopivot, query, and visualize your data in more powerful ways.</span></span>

## <a name="export-hello-activity-log-with-a-log-profile"></a><span data-ttu-id="44364-182">Экспортировать журнал действий с профилем журнала hello</span><span class="sxs-lookup"><span data-stu-id="44364-182">Export hello Activity Log with a Log Profile</span></span>
<span data-ttu-id="44364-183">**Профиль журнала** определяет, как экспортируется журнал действий.</span><span class="sxs-lookup"><span data-stu-id="44364-183">A **Log Profile** controls how your Activity Log is exported.</span></span> <span data-ttu-id="44364-184">С помощью профиля журнала вы можете настроить следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="44364-184">Using a Log Profile, you can configure:</span></span>

* <span data-ttu-id="44364-185">Когда следует отправлять hello журнал действий (учетной записи хранилища или концентраторов событий)</span><span class="sxs-lookup"><span data-stu-id="44364-185">Where hello Activity Log should be sent (Storage Account or Event Hubs)</span></span>
* <span data-ttu-id="44364-186">Какие категории событий будут отправляться (запись, удаление, действие).</span><span class="sxs-lookup"><span data-stu-id="44364-186">Which event categories (Write, Delete, Action) should be sent.</span></span> <span data-ttu-id="44364-187">*значение «Категория» в профилях журнал и журнал событий Hello отличается. В hello журнала профиль «Категория» представляет тип операции hello (, удаление, запись). В событии журнал действий свойство «категория» hello представляет источник hello или типом события (например, администрирования, ServiceHealth, предупреждение и более).*</span><span class="sxs-lookup"><span data-stu-id="44364-187">*hello meaning of "category" in Log Profiles and Activity Log events is different. In hello Log Profile, "Category" represents hello operation type (Write, Delete, Action). In an Activity Log event, hello "category" property represents hello source or type of event (for example, Administration, ServiceHealth, Alert, and more).*</span></span>
* <span data-ttu-id="44364-188">Какие регионы (расположения) будут экспортированы.</span><span class="sxs-lookup"><span data-stu-id="44364-188">Which regions (locations) should be exported.</span></span> <span data-ttu-id="44364-189">Убедиться, что tooinclude убедитесь «глобальные», поскольку существует множество событий в журнал действий hello глобальные события.</span><span class="sxs-lookup"><span data-stu-id="44364-189">Make sure tooinclude "global," as many events in hello Activity Log are global events.</span></span>
* <span data-ttu-id="44364-190">Как долго следует хранить hello журнал действий в учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="44364-190">How long hello Activity Log should be retained in a Storage Account.</span></span>
    - <span data-ttu-id="44364-191">Срок хранения 0 дней означает, что журналы хранятся неограниченно долго.</span><span class="sxs-lookup"><span data-stu-id="44364-191">A retention of zero days means logs are kept forever.</span></span> <span data-ttu-id="44364-192">В противном случае — значение hello может быть любое число дней от 1 до 2147483647.</span><span class="sxs-lookup"><span data-stu-id="44364-192">Otherwise, hello value can be any number of days between 1 and 2147483647.</span></span>
    - <span data-ttu-id="44364-193">Если заданы политики хранения, но сохранения журналов в учетной записи хранения отключена (например, если только выбраны параметры концентраторов событий или OMS), политики хранения hello не действуют.</span><span class="sxs-lookup"><span data-stu-id="44364-193">If retention policies are set but storing logs in a Storage Account is disabled (for example, if only Event Hubs or OMS options are selected), hello retention policies have no effect.</span></span>
    - <span data-ttu-id="44364-194">Политики хранения, примененных в день, поэтому hello регистрирует конец дня (UTC), с датой hello, что теперь находится за пределами hello политику хранения, удаляются.</span><span class="sxs-lookup"><span data-stu-id="44364-194">Retention policies are applied per-day, so at hello end of a day (UTC), logs from hello day that is now beyond hello retention policy are deleted.</span></span> <span data-ttu-id="44364-195">Например если у вас есть политика хранения продолжительностью в один день, в начале hello сегодня день hello hello журналы из позавчерашнего дня hello, будет удален.</span><span class="sxs-lookup"><span data-stu-id="44364-195">For example, if you had a retention policy of one day, at hello beginning of hello day today hello logs from hello day before yesterday would be deleted.</span></span>

<span data-ttu-id="44364-196">Можно использовать учетную запись хранения или пространство имен концентратора событий, который не находится в той же подписке hello, как hello одного выпуска журналы.</span><span class="sxs-lookup"><span data-stu-id="44364-196">You can use a storage account or event hub namespace that is not in hello same subscription as hello one emitting logs.</span></span> <span data-ttu-id="44364-197">Hello пользователь, настраивающий приветствия должен иметь hello соответствующие RBAC доступа tooboth подписки.</span><span class="sxs-lookup"><span data-stu-id="44364-197">hello user who configures hello setting must have hello appropriate RBAC access tooboth subscriptions.</span></span>

<span data-ttu-id="44364-198">Эти параметры можно настроить через параметр «Export» hello в колонке журнал действий hello hello портала.</span><span class="sxs-lookup"><span data-stu-id="44364-198">These settings can be configured via hello “Export” option in hello Activity Log blade in hello portal.</span></span> <span data-ttu-id="44364-199">Их можно также настроить программно [с помощью API REST Azure монитора "hello"](https://msdn.microsoft.com/library/azure/dn931927.aspx), командлеты PowerShell или интерфейс командной строки.</span><span class="sxs-lookup"><span data-stu-id="44364-199">They can also be configured programmatically [using hello Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931927.aspx), PowerShell cmdlets, or CLI.</span></span> <span data-ttu-id="44364-200">Для каждой подписки может существовать только один профиль журнала.</span><span class="sxs-lookup"><span data-stu-id="44364-200">A subscription can only have one log profile.</span></span>

### <a name="configure-log-profiles-using-hello-azure-portal"></a><span data-ttu-id="44364-201">Настроить профили журнала с помощью портала Azure hello</span><span class="sxs-lookup"><span data-stu-id="44364-201">Configure log profiles using hello Azure portal</span></span>
<span data-ttu-id="44364-202">Можно потока tooan журнал действий hello концентратора событий или сохранять их в учетной записи хранилища с помощью параметра «Export» hello hello портал Azure.</span><span class="sxs-lookup"><span data-stu-id="44364-202">You can stream hello Activity Log tooan Event Hub or store them in a Storage Account by using hello “Export” option in hello Azure portal.</span></span>

1. <span data-ttu-id="44364-203">Перейдите toohello **журнал действий** колонки, с помощью меню hello на hello левая сторона hello портала.</span><span class="sxs-lookup"><span data-stu-id="44364-203">Navigate toohello **Activity Log** blade using hello menu on hello left side of hello portal.</span></span>

    ![Перейдите tooActivity журнала на портале](./media/monitoring-overview-activity-logs/activity-logs-portal-navigate.png)
2. <span data-ttu-id="44364-205">Нажмите кнопку hello **Экспорт** кнопку hello верхней части колонки hello.</span><span class="sxs-lookup"><span data-stu-id="44364-205">Click hello **Export** button at hello top of hello blade.</span></span>

    ![Кнопка экспорта на портале](./media/monitoring-overview-activity-logs/activity-logs-portal-export.png)
3. <span data-ttu-id="44364-207">В колонке hello, которое отображается можно выбрать:</span><span class="sxs-lookup"><span data-stu-id="44364-207">In hello blade that appears, you can select:</span></span>  
  * <span data-ttu-id="44364-208">области, для которых вы хотите tooexport события</span><span class="sxs-lookup"><span data-stu-id="44364-208">regions for which you would like tooexport events</span></span>
  * <span data-ttu-id="44364-209">Здравствуйте, хотелось бы toosave события toowhich учетной записи хранилища</span><span class="sxs-lookup"><span data-stu-id="44364-209">hello Storage Account toowhich you would like toosave events</span></span>
  * <span data-ttu-id="44364-210">Hello число дней, требуется tooretain этих событий в хранилище.</span><span class="sxs-lookup"><span data-stu-id="44364-210">hello number of days you want tooretain these events in storage.</span></span> <span data-ttu-id="44364-211">Значение, равное 0 дней сохраняет журналы hello навсегда.</span><span class="sxs-lookup"><span data-stu-id="44364-211">A setting of 0 days retains hello logs forever.</span></span>
  * <span data-ttu-id="44364-212">Hello пространство имен служебной шины в которой вы хотите toobe концентратора событий, созданные для потоковой передачи этих событий.</span><span class="sxs-lookup"><span data-stu-id="44364-212">hello Service Bus Namespace in which you would like an Event Hub toobe created for streaming these events.</span></span>

     ![Колонка экспорта журнала действий](./media/monitoring-overview-activity-logs/activity-logs-portal-export-blade.png)
4. <span data-ttu-id="44364-214">Нажмите кнопку **Сохранить** toosave эти параметры.</span><span class="sxs-lookup"><span data-stu-id="44364-214">Click **Save** toosave these settings.</span></span> <span data-ttu-id="44364-215">Параметры Hello немедленно быть применен tooyour подписки.</span><span class="sxs-lookup"><span data-stu-id="44364-215">hello settings are immediately be applied tooyour subscription.</span></span>

### <a name="configure-log-profiles-using-hello-azure-powershell-cmdlets"></a><span data-ttu-id="44364-216">Настроить профили журнала с помощью командлетов Azure PowerShell hello</span><span class="sxs-lookup"><span data-stu-id="44364-216">Configure log profiles using hello Azure PowerShell Cmdlets</span></span>
#### <a name="get-existing-log-profile"></a><span data-ttu-id="44364-217">Получение существующего профиля журнала</span><span class="sxs-lookup"><span data-stu-id="44364-217">Get existing log profile</span></span>
```
Get-AzureRmLogProfile
```

#### <a name="add-a-log-profile"></a><span data-ttu-id="44364-218">Добавление профиля журнала</span><span class="sxs-lookup"><span data-stu-id="44364-218">Add a log profile</span></span>
```
Add-AzureRmLogProfile -Name my_log_profile -StorageAccountId /subscriptions/s1/resourceGroups/myrg1/providers/Microsoft.Storage/storageAccounts/my_storage -serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey -Locations global,westus,eastus -RetentionInDays 90 -Categories Write,Delete,Action
```

| <span data-ttu-id="44364-219">Свойство</span><span class="sxs-lookup"><span data-stu-id="44364-219">Property</span></span> | <span data-ttu-id="44364-220">Обязательно</span><span class="sxs-lookup"><span data-stu-id="44364-220">Required</span></span> | <span data-ttu-id="44364-221">Description (Описание)</span><span class="sxs-lookup"><span data-stu-id="44364-221">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="44364-222">Name (Имя)</span><span class="sxs-lookup"><span data-stu-id="44364-222">Name</span></span> |<span data-ttu-id="44364-223">Да</span><span class="sxs-lookup"><span data-stu-id="44364-223">Yes</span></span> |<span data-ttu-id="44364-224">Имя профиля журнала.</span><span class="sxs-lookup"><span data-stu-id="44364-224">Name of your log profile.</span></span> |
| <span data-ttu-id="44364-225">StorageAccountId</span><span class="sxs-lookup"><span data-stu-id="44364-225">StorageAccountId</span></span> |<span data-ttu-id="44364-226">Нет</span><span class="sxs-lookup"><span data-stu-id="44364-226">No</span></span> |<span data-ttu-id="44364-227">Идентификатор ресурса hello toowhich hello учетной записи хранения журнала активности должен быть сохранен.</span><span class="sxs-lookup"><span data-stu-id="44364-227">Resource ID of hello Storage Account toowhich hello Activity Log should be saved.</span></span> |
| <span data-ttu-id="44364-228">serviceBusRuleId</span><span class="sxs-lookup"><span data-stu-id="44364-228">serviceBusRuleId</span></span> |<span data-ttu-id="44364-229">Нет</span><span class="sxs-lookup"><span data-stu-id="44364-229">No</span></span> |<span data-ttu-id="44364-230">Код правила шины службы для пространства имен Service Bus hello хотелось бы toohave концентраторов событий, созданных в.</span><span class="sxs-lookup"><span data-stu-id="44364-230">Service Bus Rule ID for hello Service Bus namespace you would like toohave event hubs created in.</span></span> <span data-ttu-id="44364-231">Это строка в таком формате: `{service bus resource ID}/authorizationrules/{key name}`.</span><span class="sxs-lookup"><span data-stu-id="44364-231">Is a string with this format: `{service bus resource ID}/authorizationrules/{key name}`.</span></span> |
| <span data-ttu-id="44364-232">Расположения</span><span class="sxs-lookup"><span data-stu-id="44364-232">Locations</span></span> |<span data-ttu-id="44364-233">Да</span><span class="sxs-lookup"><span data-stu-id="44364-233">Yes</span></span> |<span data-ttu-id="44364-234">Разделенные запятыми список регионов, для которых вы хотите toocollect журналом событий.</span><span class="sxs-lookup"><span data-stu-id="44364-234">Comma-separated list of regions for which you would like toocollect Activity Log events.</span></span> |
| <span data-ttu-id="44364-235">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="44364-235">RetentionInDays</span></span> |<span data-ttu-id="44364-236">Да</span><span class="sxs-lookup"><span data-stu-id="44364-236">Yes</span></span> |<span data-ttu-id="44364-237">Количество дней, в течение которых будут храниться события: от 1 до 2 147 483 647.</span><span class="sxs-lookup"><span data-stu-id="44364-237">Number of days for which events should be retained, between 1 and 2147483647.</span></span> <span data-ttu-id="44364-238">Нулевое значение хранятся журналы hello бесконечно (навсегда).</span><span class="sxs-lookup"><span data-stu-id="44364-238">A value of zero stores hello logs indefinitely (forever).</span></span> |
| <span data-ttu-id="44364-239">Категории</span><span class="sxs-lookup"><span data-stu-id="44364-239">Categories</span></span> |<span data-ttu-id="44364-240">Нет</span><span class="sxs-lookup"><span data-stu-id="44364-240">No</span></span> |<span data-ttu-id="44364-241">Разделенный запятыми список категорий событий, которые будут собираться.</span><span class="sxs-lookup"><span data-stu-id="44364-241">Comma-separated list of event categories that should be collected.</span></span> <span data-ttu-id="44364-242">Возможные значения: Write, Delete или Action.</span><span class="sxs-lookup"><span data-stu-id="44364-242">Possible values are Write, Delete, and Action.</span></span> |

#### <a name="remove-a-log-profile"></a><span data-ttu-id="44364-243">Удаление профиля журнала</span><span class="sxs-lookup"><span data-stu-id="44364-243">Remove a log profile</span></span>
```
Remove-AzureRmLogProfile -name my_log_profile
```

### <a name="configure-log-profiles-using-hello-azure-cross-platform-cli"></a><span data-ttu-id="44364-244">Настроить профили журнала Using hello Azure кросс-платформенных CLI</span><span class="sxs-lookup"><span data-stu-id="44364-244">Configure log profiles Using hello Azure Cross-Platform CLI</span></span>
#### <a name="get-existing-log-profile"></a><span data-ttu-id="44364-245">Получение существующего профиля журнала</span><span class="sxs-lookup"><span data-stu-id="44364-245">Get existing log profile</span></span>
```
azure insights logprofile list
```
```
azure insights logprofile get --name my_log_profile
```
<span data-ttu-id="44364-246">Hello `name` свойство должно быть именем hello профиля журнала.</span><span class="sxs-lookup"><span data-stu-id="44364-246">hello `name` property should be hello name of your log profile.</span></span>

#### <a name="add-a-log-profile"></a><span data-ttu-id="44364-247">Добавление профиля журнала</span><span class="sxs-lookup"><span data-stu-id="44364-247">Add a log profile</span></span>
```
azure insights logprofile add --name my_log_profile --storageId /subscriptions/s1/resourceGroups/insights-integration/providers/Microsoft.Storage/storageAccounts/my_storage --serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey --locations global,westus,eastus,northeurope --retentionInDays 90 –categories Write,Delete,Action
```

| <span data-ttu-id="44364-248">Свойство</span><span class="sxs-lookup"><span data-stu-id="44364-248">Property</span></span> | <span data-ttu-id="44364-249">Обязательно</span><span class="sxs-lookup"><span data-stu-id="44364-249">Required</span></span> | <span data-ttu-id="44364-250">Description (Описание)</span><span class="sxs-lookup"><span data-stu-id="44364-250">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="44364-251">name</span><span class="sxs-lookup"><span data-stu-id="44364-251">name</span></span> |<span data-ttu-id="44364-252">Да</span><span class="sxs-lookup"><span data-stu-id="44364-252">Yes</span></span> |<span data-ttu-id="44364-253">Имя профиля журнала.</span><span class="sxs-lookup"><span data-stu-id="44364-253">Name of your log profile.</span></span> |
| <span data-ttu-id="44364-254">storageId</span><span class="sxs-lookup"><span data-stu-id="44364-254">storageId</span></span> |<span data-ttu-id="44364-255">Нет</span><span class="sxs-lookup"><span data-stu-id="44364-255">No</span></span> |<span data-ttu-id="44364-256">Идентификатор ресурса hello toowhich hello учетной записи хранения журнала активности должен быть сохранен.</span><span class="sxs-lookup"><span data-stu-id="44364-256">Resource ID of hello Storage Account toowhich hello Activity Log should be saved.</span></span> |
| <span data-ttu-id="44364-257">serviceBusRuleId</span><span class="sxs-lookup"><span data-stu-id="44364-257">serviceBusRuleId</span></span> |<span data-ttu-id="44364-258">Нет</span><span class="sxs-lookup"><span data-stu-id="44364-258">No</span></span> |<span data-ttu-id="44364-259">Код правила шины службы для пространства имен Service Bus hello хотелось бы toohave концентраторов событий, созданных в.</span><span class="sxs-lookup"><span data-stu-id="44364-259">Service Bus Rule ID for hello Service Bus namespace you would like toohave event hubs created in.</span></span> <span data-ttu-id="44364-260">Это строка в таком формате: `{service bus resource ID}/authorizationrules/{key name}`.</span><span class="sxs-lookup"><span data-stu-id="44364-260">Is a string with this format: `{service bus resource ID}/authorizationrules/{key name}`.</span></span> |
| <span data-ttu-id="44364-261">locations</span><span class="sxs-lookup"><span data-stu-id="44364-261">locations</span></span> |<span data-ttu-id="44364-262">Да</span><span class="sxs-lookup"><span data-stu-id="44364-262">Yes</span></span> |<span data-ttu-id="44364-263">Разделенные запятыми список регионов, для которых вы хотите toocollect журналом событий.</span><span class="sxs-lookup"><span data-stu-id="44364-263">Comma-separated list of regions for which you would like toocollect Activity Log events.</span></span> |
| <span data-ttu-id="44364-264">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="44364-264">retentionInDays</span></span> |<span data-ttu-id="44364-265">Да</span><span class="sxs-lookup"><span data-stu-id="44364-265">Yes</span></span> |<span data-ttu-id="44364-266">Количество дней, в течение которых будут храниться события: от 1 до 2 147 483 647.</span><span class="sxs-lookup"><span data-stu-id="44364-266">Number of days for which events should be retained, between 1 and 2147483647.</span></span> <span data-ttu-id="44364-267">Нулевое значение хранятся журналы hello бесконечно (навсегда).</span><span class="sxs-lookup"><span data-stu-id="44364-267">A value of zero stores hello logs indefinitely (forever).</span></span> |
| <span data-ttu-id="44364-268">Категории</span><span class="sxs-lookup"><span data-stu-id="44364-268">categories</span></span> |<span data-ttu-id="44364-269">Нет</span><span class="sxs-lookup"><span data-stu-id="44364-269">No</span></span> |<span data-ttu-id="44364-270">Разделенный запятыми список категорий событий, которые будут собираться.</span><span class="sxs-lookup"><span data-stu-id="44364-270">Comma-separated list of event categories that should be collected.</span></span> <span data-ttu-id="44364-271">Возможные значения: Write, Delete или Action.</span><span class="sxs-lookup"><span data-stu-id="44364-271">Possible values are Write, Delete, and Action.</span></span> |

#### <a name="remove-a-log-profile"></a><span data-ttu-id="44364-272">Удаление профиля журнала</span><span class="sxs-lookup"><span data-stu-id="44364-272">Remove a log profile</span></span>
```
azure insights logprofile delete --name my_log_profile
```

## <a name="next-steps"></a><span data-ttu-id="44364-273">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="44364-273">Next Steps</span></span>
* [<span data-ttu-id="44364-274">Дополнительные сведения о hello журнал действий (прежнее название — журналы аудита)</span><span class="sxs-lookup"><span data-stu-id="44364-274">Learn more about hello Activity Log (formerly Audit Logs)</span></span>](../azure-resource-manager/resource-group-audit.md)
* [<span data-ttu-id="44364-275">Поток tooEvent журнал действий Azure hello концентраторы</span><span class="sxs-lookup"><span data-stu-id="44364-275">Stream hello Azure Activity Log tooEvent Hubs</span></span>](monitoring-stream-activity-logs-event-hubs.md)
