---
title: "aaaOverview из hello журнал действий Azure | Документы Microsoft"
description: "Узнайте, какие hello имеет журнал действий Azure и способы ее toounderstand событиями, происходящими в подписке Azure."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: c274782f-039d-4c28-9ddb-f89ce21052c7
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/02/2017
ms.author: johnkem
ms.openlocfilehash: cba79b7f6dc0833ef588382e763761fd77d43307
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-subscription-activity-with-hello-azure-activity-log"></a>Мониторинг подписки hello журнал действий Azure
Hello **журнал действий Azure** — это журнал подписки, позволяет контролировать уровень подписки события, которые произошли в Azure. Это включает диапазон данных из диспетчера ресурсов Azure tooupdates рабочие данные о событиях службы работоспособности. Журнал действий Hello ранее была известна как «Журналы аудита» или «Операционные журналы» с момента события отчетов плоскости управления hello административную категорию для ваших подписок. С помощью hello журнал действий, можно определить hello ", который и когда" для любой записи операции (PUT, POST, удаление), затраченное на hello ресурсам в подписке. Вы также можете понимать hello состояние операции hello и другие соответствующие свойства. Журнал действий Hello не включает операций чтения (GET) или операций для ресурсов, использующих классический hello / модели «RDFE».

![Журналы действий и другие типы журналов ](./media/monitoring-overview-activity-logs/Activity_Log_vs_other_logs_v5.png)

Рис. 1. Журналы действий и другие типы журналов

Hello журнал действий отличается от [журналы диагностики](monitoring-overview-of-diagnostic-logs.md). Журналы действий предоставляют данные о hello операций над ресурсом из hello за пределами (hello «плоскости управления»). Журналы диагностики передаются каким-либо ресурсом и приводятся сведения об операции hello этого ресурса (hello «плоскости данных»).

События можно извлечь из действия журналов с помощью hello портал Azure CLI, командлеты PowerShell и API REST Azure монитора.


> [!WARNING]
> Журнал действий Azure Hello используется главным образом для действия, которые происходят в диспетчере ресурсов Azure. Она не отслеживает ресурсов с помощью модели классический/RDFE hello. Для некоторых классических типов ресурсов в Azure Resource Manager имеется прокси-поставщик ресурсов (например, Microsoft.ClassicCompute). Если взаимодействовать с типом ресурса классического посредством Azure Resource Manager с помощью этих поставщиков ресурсов прокси-сервера, hello операций отображаются в hello журнал действий. При взаимодействие с классический ресурс типа hello классическом портале или в противном случае значение за пределами hello прокси диспетчера ресурсов Azure, ваши действия только регистрируются в hello журнала операций. Hello журнала операций будет доступен только в классическом портале hello.
>
>

Представление hello следующие видео Знакомство с приложением hello журнал действий.
> [!VIDEO https://channel9.msdn.com/Blogs/Seth-Juarez/Logs-John-Kemnetz/player]
> 
>

## <a name="categories-in-hello-activity-log"></a>Категории в hello журнал действий
Журнал действий Hello содержит несколько категорий данных. Подробные сведения о hello схем из этих категорий [см. в статье](monitoring-activity-log-schema.md). В частности, описаны такие возможности:
* **Административные** — эта категория содержит запись hello всех создавать, выполнять операции обновления, удаления и action через диспетчер ресурсов. Примеры типов событий, отображаемые в этой категории относятся hello «создайте виртуальную машину» и «удалить сетевую группу безопасности «всех действий, выполненных пользователем или приложения с помощью диспетчера ресурсов моделируется как операцию для определенного типа ресурсов. Если тип операции hello записи, Delete или действие, hello начала hello и успех или сбой данной операции записываются в hello административную категорию. Административная категория Hello также включает любой элемент управления доступом на основе toorole изменения в подписку.
* **Работоспособность службы** — эта категория содержит запись hello любой службы работоспособности инцидентов, произошедших в Azure. Пример hello тип события, отображаемые в этой категории — «SQL Azure в регионе Восток США испытывает времени простоя». События работоспособности службы бывают пять видов: требуется действие вспомогательная восстановления, инцидент, обслуживания, сведения и безопасности и появятся только при наличии ресурсов, в подписке hello, которое бы повлиять hello событий.
* **Предупреждения** — эта категория содержит hello записи для всех активаций оповещения Azure. Пример hello тип события, отображаемые в этой категории — «% ЦП на myVM был более чем на 80 для hello за последние 5 минут.» Различные системы Azure работают по принципу оповещений, то есть вы можете определить какое-то правило, и система будет направлять вам уведомление, когда условия этого правила выполняются. Каждый раз, поддерживаемых Azure тип оповещения «активирует,» или hello условия выполнены toogenerate уведомление, запись активации hello также помещается toothis категории hello журнал действий.
* **Автомасштабирование** — эта категория содержит запись hello любой операции toohello связанные события подсистемы автомасштабирования hello соответствии с параметрами автоматического масштабирования, определены в вашей подписке. Пример hello тип события, отображаемые в этой категории — «Автомасштабирования масштабирования вверх не удалось выполнить действие». С помощью автоматического масштабирования, можно автоматически масштабировать или масштабирования в hello число экземпляров в типе поддерживаемых ресурсов на основе времени дня и/или загрузки данных (метрики), с помощью параметров автоматического масштабирования. При выполнении условий hello tooscale вверх или вниз, hello start и успешном или неудачном события записываются в эту категорию.
* **Рекомендация**. Эта категория содержит события рекомендации из определенных типов ресурсов, таких как веб-сайты и серверы SQL Server. Эти события предоставляют рекомендации по toobetter использование ресурсов. Вы будете получать события этого типа, только если у вас будут ресурсы, которые генерируют рекомендации.
* **Политика, Безопасность и Работоспособность ресурсов**. Эти категории не содержат никаких событий. Они зарезервированы для использования в будущем.

## <a name="event-schema-per-category"></a>Схема событий по категориям
[См. Эта схема статьи toounderstand hello журналом событий по категориям.](monitoring-activity-log-schema.md)

## <a name="what-you-can-do-with-hello-activity-log"></a>Что делать с hello журнал действий
Ниже приведены некоторые hello вещей, которые можно выполнить с hello журнал действий.

![Журнал действий Azure](./media/monitoring-overview-activity-logs/Activity_Log_Overview_v3.png)


* Запрос и просмотреть его в hello **портал Azure**.
* [Создание оповещения о событии журнала действий Azure.](monitoring-activity-log-alerts.md)
* [Потоковую передачу tooan **концентратора событий** ](monitoring-stream-activity-logs-event-hubs.md) продукты для использования службой сторонних или пользовательских analytics решение, например PowerBI.
* Анализировать их в PowerBI, с помощью hello [ **пакет содержимого для PowerBI**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/).
* [Сохраните его tooa **учетной записи хранилища** проверка архивации или вручную](monitoring-archive-activity-log.md). Можно указать срок хранения по hello (в днях) с помощью hello **профиля журнала**.
* Обращение к журналу с помощью командлетов PowerShell, интерфейса командной строки или REST API.

## <a name="query-hello-activity-log-in-hello-azure-portal"></a>Запрос hello журнал действий в hello портал Azure
В пределах hello портал Azure можно просмотреть журнал действий в нескольких местах:
* Hello **журнал действий колонке**, к которому можно получить путем поиска hello журнал действий в группе «Более службы» hello левой панели навигации.
* Hello **монитор колонке**, который отображается по умолчанию hello левой панели навигации. Hello журнал действий — один раздел эту колонку монитора Azure.
* Любой ресурс **колонки ресурсов**, например hello колонке конфигурации для виртуальной машины. Hello журнал действий быть один из разделов hello для большинства из этих ресурсов колонок и щелкнув его автоматически фильтрует события hello toothose связанные toothat конкретный ресурс.

В hello портал Azure можно выполнить фильтрацию в журнал действий по этим полям:
* TimeSpan - hello начального и конечного времени для события.
* Категория - hello категории событий, как описано выше.
* "Подписка": одно или несколько имен подписок Azure.
* "Группа ресурсов": одна или несколько групп ресурсов в этих подписках.
* Ресурс (имя) — имя hello определенного ресурса.
* Тип ресурса - hello тип ресурса, например, Microsoft.Compute/virtualmachines.
* Имя операции - hello имя операции диспетчера ресурсов Azure, например, Microsoft.SQL/servers/Write.
* Важность - hello степень серьезности события hello (информационные сообщения, предупреждения, ошибки, критическое).
* Событие, инициированное - вызывающий «hello» или пользователя, выполнившего операцию hello.
* "Открыть поиск": текстовое поле поиска, с помощью которого можно искать указанную строку во всех полях всех событий.

После того как определен набор фильтров, его можно сохранить как запрос, в которой сохраняется между сеансами, если требуется tooperform hello же запрос, с этими фильтрами применен повторно, в будущем hello. Можно также закрепить запроса tooyour панель мониторинга Azure tooalways keep внимание на определенных событий.

Если щелкнуть "Применить", будет выполнен запрос и показаны все соответствующие ему события. Щелкнув по любому событию в hello перечисляются hello Сводка этого события, а также hello полной необработанные JSON этого события.

Еще больше сократить щелкните hello **поиска журналов** значок, который отображает данные журнала действий в hello [действия журнала журнала аналитика Analytics решения](../log-analytics/log-analytics-activity.md). Журнал действий колонке Hello предлагает возможности основные фильтр/обзора на журналы, но служба аналитики журналов позволяет toopivot, выполнения запросов и визуализации данных более мощные функции.

## <a name="export-hello-activity-log-with-a-log-profile"></a>Экспортировать журнал действий с профилем журнала hello
**Профиль журнала** определяет, как экспортируется журнал действий. С помощью профиля журнала вы можете настроить следующие параметры.

* Когда следует отправлять hello журнал действий (учетной записи хранилища или концентраторов событий)
* Какие категории событий будут отправляться (запись, удаление, действие). *значение «Категория» в профилях журнал и журнал событий Hello отличается. В hello журнала профиль «Категория» представляет тип операции hello (, удаление, запись). В событии журнал действий свойство «категория» hello представляет источник hello или типом события (например, администрирования, ServiceHealth, предупреждение и более).*
* Какие регионы (расположения) будут экспортированы. Убедиться, что tooinclude убедитесь «глобальные», поскольку существует множество событий в журнал действий hello глобальные события.
* Как долго следует хранить hello журнал действий в учетной записи хранилища.
    - Срок хранения 0 дней означает, что журналы хранятся неограниченно долго. В противном случае — значение hello может быть любое число дней от 1 до 2147483647.
    - Если заданы политики хранения, но сохранения журналов в учетной записи хранения отключена (например, если только выбраны параметры концентраторов событий или OMS), политики хранения hello не действуют.
    - Политики хранения, примененных в день, поэтому hello регистрирует конец дня (UTC), с датой hello, что теперь находится за пределами hello политику хранения, удаляются. Например если у вас есть политика хранения продолжительностью в один день, в начале hello сегодня день hello hello журналы из позавчерашнего дня hello, будет удален.

Можно использовать учетную запись хранения или пространство имен концентратора событий, который не находится в той же подписке hello, как hello одного выпуска журналы. Hello пользователь, настраивающий приветствия должен иметь hello соответствующие RBAC доступа tooboth подписки.

Эти параметры можно настроить через параметр «Export» hello в колонке журнал действий hello hello портала. Их можно также настроить программно [с помощью API REST Azure монитора "hello"](https://msdn.microsoft.com/library/azure/dn931927.aspx), командлеты PowerShell или интерфейс командной строки. Для каждой подписки может существовать только один профиль журнала.

### <a name="configure-log-profiles-using-hello-azure-portal"></a>Настроить профили журнала с помощью портала Azure hello
Можно потока tooan журнал действий hello концентратора событий или сохранять их в учетной записи хранилища с помощью параметра «Export» hello hello портал Azure.

1. Перейдите toohello **журнал действий** колонки, с помощью меню hello на hello левая сторона hello портала.

    ![Перейдите tooActivity журнала на портале](./media/monitoring-overview-activity-logs/activity-logs-portal-navigate.png)
2. Нажмите кнопку hello **Экспорт** кнопку hello верхней части колонки hello.

    ![Кнопка экспорта на портале](./media/monitoring-overview-activity-logs/activity-logs-portal-export.png)
3. В колонке hello, которое отображается можно выбрать:  
  * области, для которых вы хотите tooexport события
  * Здравствуйте, хотелось бы toosave события toowhich учетной записи хранилища
  * Hello число дней, требуется tooretain этих событий в хранилище. Значение, равное 0 дней сохраняет журналы hello навсегда.
  * Hello пространство имен служебной шины в которой вы хотите toobe концентратора событий, созданные для потоковой передачи этих событий.

     ![Колонка экспорта журнала действий](./media/monitoring-overview-activity-logs/activity-logs-portal-export-blade.png)
4. Нажмите кнопку **Сохранить** toosave эти параметры. Параметры Hello немедленно быть применен tooyour подписки.

### <a name="configure-log-profiles-using-hello-azure-powershell-cmdlets"></a>Настроить профили журнала с помощью командлетов Azure PowerShell hello
#### <a name="get-existing-log-profile"></a>Получение существующего профиля журнала
```
Get-AzureRmLogProfile
```

#### <a name="add-a-log-profile"></a>Добавление профиля журнала
```
Add-AzureRmLogProfile -Name my_log_profile -StorageAccountId /subscriptions/s1/resourceGroups/myrg1/providers/Microsoft.Storage/storageAccounts/my_storage -serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey -Locations global,westus,eastus -RetentionInDays 90 -Categories Write,Delete,Action
```

| Свойство | Обязательно | Description (Описание) |
| --- | --- | --- |
| Name (Имя) |Да |Имя профиля журнала. |
| StorageAccountId |Нет |Идентификатор ресурса hello toowhich hello учетной записи хранения журнала активности должен быть сохранен. |
| serviceBusRuleId |Нет |Код правила шины службы для пространства имен Service Bus hello хотелось бы toohave концентраторов событий, созданных в. Это строка в таком формате: `{service bus resource ID}/authorizationrules/{key name}`. |
| Расположения |Да |Разделенные запятыми список регионов, для которых вы хотите toocollect журналом событий. |
| RetentionInDays |Да |Количество дней, в течение которых будут храниться события: от 1 до 2 147 483 647. Нулевое значение хранятся журналы hello бесконечно (навсегда). |
| Категории |Нет |Разделенный запятыми список категорий событий, которые будут собираться. Возможные значения: Write, Delete или Action. |

#### <a name="remove-a-log-profile"></a>Удаление профиля журнала
```
Remove-AzureRmLogProfile -name my_log_profile
```

### <a name="configure-log-profiles-using-hello-azure-cross-platform-cli"></a>Настроить профили журнала Using hello Azure кросс-платформенных CLI
#### <a name="get-existing-log-profile"></a>Получение существующего профиля журнала
```
azure insights logprofile list
```
```
azure insights logprofile get --name my_log_profile
```
Hello `name` свойство должно быть именем hello профиля журнала.

#### <a name="add-a-log-profile"></a>Добавление профиля журнала
```
azure insights logprofile add --name my_log_profile --storageId /subscriptions/s1/resourceGroups/insights-integration/providers/Microsoft.Storage/storageAccounts/my_storage --serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey --locations global,westus,eastus,northeurope --retentionInDays 90 –categories Write,Delete,Action
```

| Свойство | Обязательно | Description (Описание) |
| --- | --- | --- |
| name |Да |Имя профиля журнала. |
| storageId |Нет |Идентификатор ресурса hello toowhich hello учетной записи хранения журнала активности должен быть сохранен. |
| serviceBusRuleId |Нет |Код правила шины службы для пространства имен Service Bus hello хотелось бы toohave концентраторов событий, созданных в. Это строка в таком формате: `{service bus resource ID}/authorizationrules/{key name}`. |
| locations |Да |Разделенные запятыми список регионов, для которых вы хотите toocollect журналом событий. |
| RetentionInDays |Да |Количество дней, в течение которых будут храниться события: от 1 до 2 147 483 647. Нулевое значение хранятся журналы hello бесконечно (навсегда). |
| Категории |Нет |Разделенный запятыми список категорий событий, которые будут собираться. Возможные значения: Write, Delete или Action. |

#### <a name="remove-a-log-profile"></a>Удаление профиля журнала
```
azure insights logprofile delete --name my_log_profile
```

## <a name="next-steps"></a>Дальнейшие действия
* [Дополнительные сведения о hello журнал действий (прежнее название — журналы аудита)](../azure-resource-manager/resource-group-audit.md)
* [Поток tooEvent журнал действий Azure hello концентраторы](monitoring-stream-activity-logs-event-hubs.md)
