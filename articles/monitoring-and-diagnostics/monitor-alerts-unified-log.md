---
title: "Журнал предупреждений в мониторе Azure - оповещения (Предварительная версия) | Документы Microsoft"
description: "Триггер сообщения электронной почты, уведомления, вызовите URL-адреса веб-сайтов (веб-перехватчиков) или автоматизации при соблюдении заданных условий сложный запрос для оповещения Azure (Предварительная версия)."
author: msvijayn
manager: kmadnani1
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: f7457655-ced6-4102-a9dd-7ddf2265c0e2
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/12/2017
ms.author: vinagara
ms.openlocfilehash: 99d222102ab0245c7c4dc8603eaedcfc88ae7a66
ms.sourcegitcommit: b7adce69c06b6e70493d13bc02bd31e06f291a91
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/19/2017
---
# <a name="log-alerts-in-azure-monitor---alerts-preview"></a>Журнал предупреждений в мониторе Azure - оповещения (Предварительная версия)
В этой статье подробно описаны правила как оповещений в Analytics рабочих запросов в Azure Alerts (Предварительная версия) и приведены различия между различными типами правил оповещения журнала.
В настоящее время Azure Alerts (Предварительная версия) поддерживает только журнал на запросы из [Azure Log Analytics](../log-analytics/log-analytics-tutorial-viewdata.md) языке [языка запросов нового анализа журналов](../log-analytics/log-analytics-log-search-upgrade.md)

> [!WARNING]
> Оповещения Azure (Предварительная версия) — предупреждения журнала, в настоящее время не поддерживает запросы между рабочей или нескольких приложений. 

## <a name="log-alert-rules"></a>Правила генерации оповещений журнала

Предупреждения создаются с помощью Azure Alerts (Предварительная версия) автоматически выполнять запросы журнала через регулярные интервалы.  Если результаты запроса журнала соответствует конкретным условиям, создается запись предупреждений. Правило может автоматически выполните одно или несколько действий, которые необходимо заранее уведомлением об оповещении или вызвать другой процесс, например выполняющиеся модули Runbook, с помощью [группы действий](monitoring-action-groups.md).  В каждом типе правил генерации оповещений используется определенная логика выполнения этого анализа.

Правила генерации оповещений определяются следующими сведениями:

- **Журнал запросов**.  Это запрос, который будет запускаться каждый раз при срабатывании правила генерации оповещений.  Записей, возвращаемых этим запросом, используются для определения того, создается ли предупреждение.
- **Временное окно**.  Указывает диапазон времени для запроса.  Запрос возвращает только те записи, которые были созданы в течение этого периода, предшествующего настоящему времени.  Временное окно может иметь любое значение от 5 минут до 1440 минут или 24 часа. Например, если временное окно равно 60 минутам, а запрос выполняется в 13:15, то возвращаются только записи, созданные между 12:15 и 13:15.
- **Частота**.  Указывает, как часто должен выполняться запрос. Это значение может составлять от 5 минут до 24 часов. Оно должно быть меньше или равно временному окну.  Если значение больше, чем временное окно, появляется риск пропуска записей.<br>Например, рассмотрим временное окно в 30 минут и частоту в 60 минут.  Если запрос выполняется в 13:00, он возвращает записи между 12:30 и 13:00.  В следующий раз этот запрос будет выполнен в 14:00, а записи возвратятся между 13:30 и 14:00.  Записи, созданные между 13:00 и 13:30, не будут учитываться.
- **Пороговое значение**.  Чтобы определить, следует ли создавать оповещение, оцениваются результаты поиска по журналам.  Для каждого типа правил генерации оповещений определяется собственное пороговое значение.

Каждое правило генерации оповещений в Log Analytics относится к одному из двух типов.  Каждый из этих типов подробно описан в последующих разделах.

- **[Число результатов](#number-of-results-alert-rules)**. Если число записей, возвращенных в результатах поиска по журналам, превышает указанное количество, создается оповещение.
- **[Измерение метрик](#metric-measurement-alert-rules)**.  Оповещение, созданное для каждого объекта в результатах поиска по журналам со значением, превышающим указанное пороговое значение.

Ниже приведены различия между типами правил генерации оповещений.

- **Количество результатов** правило генерации оповещений всегда создает один предупреждения while **метрической** оповещения правило создает оповещение для каждого объекта, превышает пороговое значение.
- Правило генерации оповещений **Число результатов** создает оповещение при одноразовом превышении порогового значения. Правило генерации оповещений **Измерение метрик** может создавать оповещение при превышении порогового значения определенное количество раз за указанный интервал времени.

## <a name="number-of-results-alert-rules"></a>Правило генерации оповещений "Число результатов"
Правила генерации оповещений **Число результатов** создают одно оповещение, если количество записей, возвращенных в результатах поискового запроса, превышает указанное пороговое значение.

**Пороговое значение**: пороговое значение для **число результатов** правило генерации оповещений, больше или меньше, чем определенное значение.  Если число записей, возвращенных в результатах поиска по журналам, соответствует этому критерию, создается оповещение.

### <a name="scenarios"></a>Сценарии

#### <a name="events"></a>События
Этот тип правила генерации оповещений идеально подходит для работы с такими событиями, как журналы событий Windows, системный журнал и настраиваемые журналы.  Вам может потребоваться создать оповещение, когда создается конкретное событие ошибки или при создании нескольких событий ошибки в определенном временном окне.

Для создания предупреждения по одному событию значение больше 0 и частоту и интервал времени до пяти минут количество результатов.  Каждые пять минут и проверить наличие вхождения одиночного события, созданные с момента последнего выполнения запроса, который выполняет запрос.  Уменьшение частоты может привести к увеличению интервала между сбором данных о событии и созданием оповещения.

Некоторые приложения могут вносить в журнал нерегулярную ошибку, которая не обязательно должна вызывать оповещение.  Например, приложение может повторно запустить процесс, который создал событие ошибки и затем успешно завершил работу при следующем выполнении.  В этом случае вам может потребоваться создавать оповещение только в случае возникновения нескольких событий за определенное временное окно.  

В некоторых случаях может потребоваться создать оповещение в случае отсутствия события.  Например, процесс может регистрировать регулярные события, чтобы указать, что он работает правильно.  Если он не регистрирует одно из таких событий в пределах определенного временного окна, следует создать оповещение.  В этом случае вам нужно задать пороговое значение **менее 1**.

## <a name="metric-measurement-alert-rules"></a>Metric measurement alert rules (Измерение метрики для правила генерации оповещений)

Правила генерации оповещений **Измерение метрик** создают оповещение для каждого объекта в запросе со значением, превышающим указанное пороговое значение.  Ниже приведены их четко выраженные отличия от правил генерации оповещений **Число результатов**.

**Агрегатная функция**: определяет вычисление, которое выполняется и потенциально числового поля для статистической обработки.  Например **count()** возвращает число записей в запросе, **avg(CounterValue)** возвращает среднее значение для поля значения CounterValue за интервал.

**Группировка по полю**: создается запись с сводное значение для каждого экземпляра это поле, а предупреждение может быть создано для каждого.  Например, если вы хотите создать предупреждение для каждого компьютера, можно использовать **по компьютерам**   

**Интервал**: Определяет интервал времени, по которому выполняется статистическое вычисление данных.  Например, если вы указали **пять минут**, приведет к созданию записи для каждого экземпляра поля группы суммарный каждые 5 минут за период, указанный для предупреждения.

**Пороговое значение**: пороговое значение для правил оповещения метрической определяется статистическое значение и число нарушений.  Если любая точка данных в результатах поиска по журналам превышает это значение, она рассматривается как нарушение.  Когда число нарушений в результатах для любого объекта превышает указанное значение, для этого объекта создается оповещение.

#### <a name="example"></a>Пример
Рассмотрим ситуацию, где оповещение должно создаваться, когда использование процессора на компьютере превышает 90 % три раза в течение 30 минут.  Вы создадите правило генерации оповещений со следующими параметрами:  

**Запрос:** производительности | где имя_объекта == «Процессор» and CounterName == «% Processor Time» | суммировать AggregatedValue = avg(CounterValue) по bin (TimeGenerated, 5 m), компьютер<br>
**Интервал времени:** 30 минут<br>
**Частота предупреждений:** пять минут<br>
**Статистические значения:** больше 90<br>
**На основе триггера предупреждение:** всего нарушений больше 5<br>

Среднее значение для каждого компьютера создать запрос каждые 5 минут.  Этот запрос выполняется каждые 5 минут для данных, собранных в течение предыдущих 30 минут.  Ниже приведен пример данных для трех компьютеров.

![Результаты выполнения примера запроса](../log-analytics/media/log-analytics-alerts/metrics-measurement-sample-graph.png)

В этом примере отдельные оповещения создаются для компьютеров srv02 и srv03, так как за указанное временное окно они 3 раза превысили пороговое значение в 90 %.  Если **на основе триггера предупреждение:** были изменены для **Фальцовка** то оповещения будут создаваться только для srv03, так как он нарушения порогового значения для трех последовательных выборок.


## <a name="next-steps"></a>Дальнейшие действия
* [Обзор Azure Alerts (Предварительная версия)](monitoring-overview-unified-alerts.md) 
* Дополнительные сведения о [предупреждений с помощью Azure (Предварительная версия)](monitor-alerts-unified-usage.md)
* Дополнительные сведения о [Log Analytics](../log-analytics/log-analytics-overview.md).    
