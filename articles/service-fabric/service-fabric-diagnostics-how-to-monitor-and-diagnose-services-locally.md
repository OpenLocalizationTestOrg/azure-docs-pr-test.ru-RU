---
title: "aaaDebug микрослужбами Azure в Windows | Документы Microsoft"
description: "Узнайте, как toomonitor и диагностики вашей службы, написанные с помощью Microsoft Azure Service Fabric на локальном компьютере разработчика."
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: edcc0631-ed2d-45a3-851d-2c4fa0f4a326
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/24/2017
ms.author: dekapur
ms.openlocfilehash: 24868aa194b8a28fa3e6de95c1de5506d912a544
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-and-diagnose-services-in-a-local-machine-development-setup"></a><span data-ttu-id="b22f5-103">Мониторинг и диагностика состояния служб в локальной среде разработки</span><span class="sxs-lookup"><span data-stu-id="b22f5-103">Monitor and diagnose services in a local machine development setup</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="b22f5-104">Windows</span><span class="sxs-lookup"><span data-stu-id="b22f5-104">Windows</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)
> * [<span data-ttu-id="b22f5-105">Linux</span><span class="sxs-lookup"><span data-stu-id="b22f5-105">Linux</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally-linux.md)
> 
> 

<span data-ttu-id="b22f5-106">Мониторинг, обнаружение, диагностика и устранение неполадок позволяют toocontinue служб с минимальными нарушениями toohello пользователями.</span><span class="sxs-lookup"><span data-stu-id="b22f5-106">Monitoring, detecting, diagnosing, and troubleshooting allow for services toocontinue with minimal disruption toohello user experience.</span></span> <span data-ttu-id="b22f5-107">Хотя наблюдение и диагностику, важно в реальной производственной в развернутой среде, будут зависеть от эффективности hello заимствование аналогичной модели во время разработки tooensure служб, которыми они работают, при перемещении установки реальных tooa.</span><span class="sxs-lookup"><span data-stu-id="b22f5-107">While monitoring and diagnostics are critical in an actual deployed production environment, hello efficiency will depend on adopting a similar model during development of services tooensure they work when you move tooa real-world setup.</span></span> <span data-ttu-id="b22f5-108">Service Fabric упрощает диагностику tooimplement разработчики службы, можно легко работайте с одним компьютером локальная разработка настройки и настройки кластера реальных рабочих.</span><span class="sxs-lookup"><span data-stu-id="b22f5-108">Service Fabric makes it easy for service developers tooimplement diagnostics that can seamlessly work across both single-machine local development setups and real-world production cluster setups.</span></span>

## <a name="event-tracing-for-windows"></a><span data-ttu-id="b22f5-109">Трассировка событий Windows</span><span class="sxs-lookup"><span data-stu-id="b22f5-109">Event Tracing for Windows</span></span>
<span data-ttu-id="b22f5-110">[Трассировка событий Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) — hello, рекомендуется использовать технологии для сообщения трассировки в Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b22f5-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) is hello recommended technology for tracing messages in Service Fabric.</span></span> <span data-ttu-id="b22f5-111">Преимущества использования трассировки событий Windows:</span><span class="sxs-lookup"><span data-stu-id="b22f5-111">Some benefits of using ETW are:</span></span>

* <span data-ttu-id="b22f5-112">**ETW работает быстро.**</span><span class="sxs-lookup"><span data-stu-id="b22f5-112">**ETW is fast.**</span></span> <span data-ttu-id="b22f5-113">Технология разработана таким образом, что время выполнения кода практически не меняется.</span><span class="sxs-lookup"><span data-stu-id="b22f5-113">It was built as a tracing technology that has minimal impact on code execution times.</span></span>
* <span data-ttu-id="b22f5-114">**Трассировка событий Windows одинаково работает в локальных средах разработки и в рабочем кластере.**</span><span class="sxs-lookup"><span data-stu-id="b22f5-114">**ETW tracing works seamlessly across local development environments and also real-world cluster setups.**</span></span> <span data-ttu-id="b22f5-115">Это означает, что у вас нет кода трассировки при готовности toodeploy toorewrite реальные кластера tooa кода.</span><span class="sxs-lookup"><span data-stu-id="b22f5-115">This  means you don't have toorewrite your tracing code when you are ready toodeploy your code tooa real cluster.</span></span>
* <span data-ttu-id="b22f5-116">**Для внутренней трассировки системного кода Service Fabric также используется ETW.**</span><span class="sxs-lookup"><span data-stu-id="b22f5-116">**Service Fabric system code also uses ETW for internal tracing.**</span></span> <span data-ttu-id="b22f5-117">Это позволяет tooview трассировок приложения перемежаться Service Fabric трассировки системы.</span><span class="sxs-lookup"><span data-stu-id="b22f5-117">This allows you tooview your application traces interleaved with Service Fabric system traces.</span></span> <span data-ttu-id="b22f5-118">Он также помогает toomore легко понять последовательностей hello и взаимосвязи между кодом приложения и события в базовой системе hello.</span><span class="sxs-lookup"><span data-stu-id="b22f5-118">It also helps you toomore easily understand hello sequences and interrelationships between your application code and events in hello underlying system.</span></span>
* <span data-ttu-id="b22f5-119">**Нет встроенной поддержки в набор средств Visual Studio структуры службы tooview события трассировки событий Windows.**</span><span class="sxs-lookup"><span data-stu-id="b22f5-119">**There is built-in support in Service Fabric Visual Studio tools tooview ETW events.**</span></span> <span data-ttu-id="b22f5-120">События трассировки событий Windows отображаются в hello представление события диагностики Visual Studio после Visual Studio неправильно настроена в Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b22f5-120">ETW events appear in hello Diagnostic Events view of Visual Studio once Visual Studio is correctly configured with Service Fabric.</span></span> 

## <a name="view-service-fabric-system-events-in-visual-studio"></a><span data-ttu-id="b22f5-121">Просмотр системных событий Service Fabric в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b22f5-121">View Service Fabric system events in Visual Studio</span></span>
<span data-ttu-id="b22f5-122">Service Fabric создает toohelp разработчикам понять, что произошло в платформе hello события трассировки событий Windows.</span><span class="sxs-lookup"><span data-stu-id="b22f5-122">Service Fabric emits ETW events toohelp application developers understand what's happening in hello platform.</span></span> <span data-ttu-id="b22f5-123">Если это еще не сделано, загрузив и следуйте указаниям hello [создание первого приложения в Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="b22f5-123">If you haven't already done so, go ahead and follow hello steps in [Creating your first application in Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span></span> <span data-ttu-id="b22f5-124">Эти сведения помогут вы получаете приложение работает с hello средство просмотра событий диагностики, показывающий hello сообщений трассировки.</span><span class="sxs-lookup"><span data-stu-id="b22f5-124">This information will help you get an application up and running with hello Diagnostics Events Viewer showing hello trace messages.</span></span>

1. <span data-ttu-id="b22f5-125">Если Диагностика hello событий не отображается автоматически, они оказались toohello **представление** в Visual Studio, щелкните **другие окна** и затем **диагностические средства просмотра событий**.</span><span class="sxs-lookup"><span data-stu-id="b22f5-125">If hello diagnostics events window does not automatically show, Go toohello **View** tab in Visual Studio, choose **Other Windows** and then **Diagnostic Events Viewer**.</span></span>
2. <span data-ttu-id="b22f5-126">Каждое событие получает информацию о стандартных метаданных, о том, что событие hello hello узла, приложения и службы, от которого поступил.</span><span class="sxs-lookup"><span data-stu-id="b22f5-126">Each event has standard metadata information that tells you hello node, application and service hello event is coming from.</span></span> <span data-ttu-id="b22f5-127">Также можно фильтровать список hello событий с помощью hello **фильтровать события** поле hello верхней части окна событий hello.</span><span class="sxs-lookup"><span data-stu-id="b22f5-127">You can also filter hello list of events by using hello **Filter events** box at hello top of hello events window.</span></span> <span data-ttu-id="b22f5-128">Например, вы можете выполнить фильтрацию по **имени узла** или **имени службы**.</span><span class="sxs-lookup"><span data-stu-id="b22f5-128">For example, you can filter on **Node Name** or **Service Name.**</span></span> <span data-ttu-id="b22f5-129">И при просмотре сведений о событии, можно также приостановить с помощью hello **приостановить** кнопку hello верхней части окна событий hello и возобновить позже без потери событий.</span><span class="sxs-lookup"><span data-stu-id="b22f5-129">And when you're looking at event details, you can also pause by using hello **Pause** button at hello top of hello events window and resume later without any loss of events.</span></span>
   
   ![Средство просмотра событий диагностики Visual Studio](./media/service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally/DiagEventsExamples2.png)

## <a name="add-your-own-custom-traces-toohello-application-code"></a><span data-ttu-id="b22f5-131">Добавьте свой код приложения toohello пользовательские трассировки</span><span class="sxs-lookup"><span data-stu-id="b22f5-131">Add your own custom traces toohello application code</span></span>
<span data-ttu-id="b22f5-132">шаблоны проектов Service Fabric Visual Studio Hello содержится пример кода.</span><span class="sxs-lookup"><span data-stu-id="b22f5-132">hello Service Fabric Visual Studio project templates contain sample code.</span></span> <span data-ttu-id="b22f5-133">Hello кода показано, как tooadd прикладной код трассировки событий Windows отслеживает где показано копирование в средстве просмотра событий Windows Visual Studio hello вместе с система трассировки из Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b22f5-133">hello code shows how tooadd custom application code ETW traces that show up in hello Visual Studio ETW viewer alongside system traces from Service Fabric.</span></span> <span data-ttu-id="b22f5-134">Hello преимущество этого способа заключается в том tootraces автоматически добавляются метаданные hello Visual Studio диагностическое средство просмотра событий уже настроен toodisplay их.</span><span class="sxs-lookup"><span data-stu-id="b22f5-134">hello advantage of this method is that metadata is automatically added tootraces, and hello Visual Studio Diagnostic Events Viewer is already configured toodisplay them.</span></span>

<span data-ttu-id="b22f5-135">Для проектов, созданных из hello **шаблонов службы** (без сохранения состояния или с отслеживанием состояния) точно так же, поиск hello `RunAsync` реализации:</span><span class="sxs-lookup"><span data-stu-id="b22f5-135">For projects created from hello **service templates** (stateless or stateful) just search for hello `RunAsync` implementation:</span></span>

1. <span data-ttu-id="b22f5-136">Здравствуйте вызов слишком`ServiceEventSource.Current.ServiceMessage` в hello `RunAsync` метод является примером пользовательские трассировку ETW из кода приложения hello.</span><span class="sxs-lookup"><span data-stu-id="b22f5-136">hello call too`ServiceEventSource.Current.ServiceMessage` in hello `RunAsync` method shows an example of a custom ETW trace from hello application code.</span></span>
2. <span data-ttu-id="b22f5-137">В hello **ServiceEventSource.cs** файл, вы обнаружите перегрузку для hello `ServiceEventSource.ServiceMessage` метод, который должен использоваться для событий с высокой частотой из-за причин tooperformance.</span><span class="sxs-lookup"><span data-stu-id="b22f5-137">In hello **ServiceEventSource.cs** file, you will find an overload for hello `ServiceEventSource.ServiceMessage` method that should be used for high-frequency events due tooperformance reasons.</span></span>

<span data-ttu-id="b22f5-138">Для проектов, созданных из hello **шаблоны субъекта** (без сохранения состояния или с отслеживанием состояния):</span><span class="sxs-lookup"><span data-stu-id="b22f5-138">For projects created from hello **actor templates** (stateless or stateful):</span></span>

1. <span data-ttu-id="b22f5-139">Откройте hello **.cs «Имя_проекта»** файл where *ProjectName* является именем hello, выбранным для проекта Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b22f5-139">Open hello **"ProjectName".cs** file where *ProjectName* is hello name you chose for your Visual Studio project.</span></span>  
2. <span data-ttu-id="b22f5-140">Поиск кода hello `ActorEventSource.Current.ActorMessage(this, "Doing Work");` в hello *DoWorkAsync* метод.</span><span class="sxs-lookup"><span data-stu-id="b22f5-140">Find hello code `ActorEventSource.Current.ActorMessage(this, "Doing Work");` in hello *DoWorkAsync* method.</span></span>  <span data-ttu-id="b22f5-141">Это пример пользовательской точки трассировки ETW из кода приложения.</span><span class="sxs-lookup"><span data-stu-id="b22f5-141">This is an example of a custom ETW trace written from application code.</span></span>  
3. <span data-ttu-id="b22f5-142">В файле **ActorEventSource.cs**, вы обнаружите перегрузку для hello `ActorEventSource.ActorMessage` метод, который должен использоваться для событий с высокой частотой из-за причин tooperformance.</span><span class="sxs-lookup"><span data-stu-id="b22f5-142">In file **ActorEventSource.cs**, you will find an overload for hello `ActorEventSource.ActorMessage` method that should be used for high-frequency events due tooperformance reasons.</span></span>

<span data-ttu-id="b22f5-143">После добавления трассировка кода службы tooyour пользовательские трассировки событий Windows, можно построения, развертывания и запуска приложения hello снова toosee вашей события в hello диагностические средства просмотра событий.</span><span class="sxs-lookup"><span data-stu-id="b22f5-143">After adding custom ETW tracing tooyour service code, you can build, deploy, and run hello application again toosee your event(s) in hello Diagnostic Events Viewer.</span></span> <span data-ttu-id="b22f5-144">При отладке приложения hello с **F5**, hello диагностических событий в средстве просмотра автоматически.</span><span class="sxs-lookup"><span data-stu-id="b22f5-144">If you debug hello application with **F5**, hello Diagnostic Events Viewer will open automatically.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b22f5-145">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b22f5-145">Next steps</span></span>
<span data-ttu-id="b22f5-146">Hello же трассировка кода, добавленного tooyour приложения выше для локального диагностики будет работать со средствами, которые можно использовать tooview эти события при выполнении приложения в кластере Azure.</span><span class="sxs-lookup"><span data-stu-id="b22f5-146">hello same tracing code that you added tooyour application above for local diagnostics will work with tools that you can use tooview these events when running your application on an Azure cluster.</span></span> <span data-ttu-id="b22f5-147">Извлечь эти статьи, которые обсуждаются различные варианты hello средства hello и описывают, каким образом можно настроить их.</span><span class="sxs-lookup"><span data-stu-id="b22f5-147">Check out these articles that discuss hello different options for hello tools and describe how you can set them up.</span></span>

* [<span data-ttu-id="b22f5-148">Каким образом toocollect ведет журнал диагностики Azure</span><span class="sxs-lookup"><span data-stu-id="b22f5-148">How toocollect logs with Azure Diagnostics</span></span>](service-fabric-diagnostics-how-to-setup-wad.md)
* [<span data-ttu-id="b22f5-149">Агрегирование и сбор событий с помощью EventFlow</span><span class="sxs-lookup"><span data-stu-id="b22f5-149">Event aggregation and collection using EventFlow</span></span>](service-fabric-diagnostics-event-aggregation-eventflow.md)

