---
title: "Диагностика и мониторинг в Azure Service Fabric | Документация Майкрософт"
description: "В этой статье описаны функции мониторинга производительности в среде выполнения Service Fabric Reliable ServiceRemoting, такие как генерируемые ею счетчики производительности."
services: service-fabric
documentationcenter: .net
author: suchiagicha
manager: timlt
editor: suchiagicha
ms.assetid: 1c229923-670a-4634-ad59-468ff781ad18
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: suchiagicha
ms.openlocfilehash: f54e157654fb15d2f7ff48ddc666c6c8803c75a2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="diagnostics-and-performance-monitoring-for-reliable-service-remoting"></a><span data-ttu-id="7b013-103">Диагностика и мониторинг производительности в модели Reliable Service Remoting</span><span class="sxs-lookup"><span data-stu-id="7b013-103">Diagnostics and performance monitoring for Reliable Service Remoting</span></span>
<span data-ttu-id="7b013-104">Среда выполнения Reliable ServiceRemoting генерирует [счетчики производительности](https://msdn.microsoft.com/library/system.diagnostics.performancecounter.aspx).</span><span class="sxs-lookup"><span data-stu-id="7b013-104">The Reliable ServiceRemoting runtime emits  [performance counters](https://msdn.microsoft.com/library/system.diagnostics.performancecounter.aspx).</span></span> <span data-ttu-id="7b013-105">Они содержат полезную информацию о работоспособности ServiceRemoting и помогают устранять неполадки и контролировать производительность.</span><span class="sxs-lookup"><span data-stu-id="7b013-105">These provide insights into how the ServiceRemoting is operating and help with troubleshooting and performance monitoring.</span></span>


## <a name="performance-counters"></a><span data-ttu-id="7b013-106">Счетчики производительности</span><span class="sxs-lookup"><span data-stu-id="7b013-106">Performance counters</span></span>
<span data-ttu-id="7b013-107">Среда выполнения Reliable ServiceRemoting определяет указанные ниже категории счетчиков производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-107">The Reliable ServiceRemoting runtime defines the following performance counter categories:</span></span>

| <span data-ttu-id="7b013-108">Категория</span><span class="sxs-lookup"><span data-stu-id="7b013-108">Category</span></span> | <span data-ttu-id="7b013-109">Описание</span><span class="sxs-lookup"><span data-stu-id="7b013-109">Description</span></span> |
| --- | --- |
| <span data-ttu-id="7b013-110">Service Fabric Service</span><span class="sxs-lookup"><span data-stu-id="7b013-110">Service Fabric Service</span></span> |<span data-ttu-id="7b013-111">Счетчики, относящиеся к Azure Service Fabric Service Remoting, например счетчик среднего времени, затраченного на обработку запроса.</span><span class="sxs-lookup"><span data-stu-id="7b013-111">Counters specific to Azure Service Fabric Service Remoting , for example, average time taken to process request</span></span> |
| <span data-ttu-id="7b013-112">Service Fabric Service Method</span><span class="sxs-lookup"><span data-stu-id="7b013-112">Service Fabric Service Method</span></span> |<span data-ttu-id="7b013-113">Счетчики, относящиеся к методам, которые реализуются Service Fabric Remoting Service, например выявляющие частоту вызова того или иного метода службы.</span><span class="sxs-lookup"><span data-stu-id="7b013-113">Counters specific to methods implemented by Service Fabric Remoting Service, for example, how often a service method is invoked</span></span> |

<span data-ttu-id="7b013-114">В каждой категории предусмотрен как минимум один счетчик.</span><span class="sxs-lookup"><span data-stu-id="7b013-114">Each of the preceding categories has one or more counters.</span></span>

<span data-ttu-id="7b013-115">Для сбора и просмотра данных счетчиков производительности можно использовать [системный монитор Windows](https://technet.microsoft.com/library/cc749249.aspx) , доступный по умолчанию в операционной системе Windows.</span><span class="sxs-lookup"><span data-stu-id="7b013-115">The [Windows Performance Monitor](https://technet.microsoft.com/library/cc749249.aspx) application that is available by default in the Windows operating system can be used to collect and view performance counter data.</span></span> <span data-ttu-id="7b013-116">[Диагностика Azure](../cloud-services/cloud-services-dotnet-diagnostics.md) , в свою очередь, позволяет не только собирать данные счетчиков производительности, но и загружать их в таблицы Azure.</span><span class="sxs-lookup"><span data-stu-id="7b013-116">[Azure Diagnostics](../cloud-services/cloud-services-dotnet-diagnostics.md) is another option for collecting performance counter data and uploading it to Azure tables.</span></span>

### <a name="performance-counter-instance-names"></a><span data-ttu-id="7b013-117">Имена экземпляров счетчиков производительности</span><span class="sxs-lookup"><span data-stu-id="7b013-117">Performance counter instance names</span></span>
<span data-ttu-id="7b013-118">В кластере, содержащем большое количество служб или секций ServiceRemoting, находится большое количество экземпляров счетчиков производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-118">A cluster that has a large number of  ServiceRemoting services or partitions have a large number of  performance counter instances.</span></span> <span data-ttu-id="7b013-119">Имя экземпляра счетчика производительности помогает определить конкретную секцию и метод службы (если применимо), с которыми связан этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="7b013-119">The performance counter instance names can help in identifying the specific partition and Service method (if applicable) that the performance counter instance is associated with.</span></span>

#### <a name="service-fabric-service-category"></a><span data-ttu-id="7b013-120">Категория Service Fabric Service</span><span class="sxs-lookup"><span data-stu-id="7b013-120">Service Fabric Service category</span></span>
<span data-ttu-id="7b013-121">Экземпляры счетчиков в категории `Service Fabric Service`имеют имена в следующем формате:</span><span class="sxs-lookup"><span data-stu-id="7b013-121">For the category `Service Fabric Service`, the counter instance names are in the following format:</span></span>

`ServiceFabricPartitionID_ServiceReplicaOrInstanceId_ServiceRuntimeInternalID`

<span data-ttu-id="7b013-122">*ServiceFabricPartitionID* — это строка идентификатора секции Service Fabric, c которой связан экземпляр счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-122">*ServiceFabricPartitionID* is the string representation of the Service Fabric partition ID that the performance counter instance is associated with.</span></span> <span data-ttu-id="7b013-123">Это идентификатор GUID, строковое представление которого создается методом [`Guid.ToString`](https://msdn.microsoft.com/library/97af8hh4.aspx) с использованием описателя формата D.</span><span class="sxs-lookup"><span data-stu-id="7b013-123">The partition ID is a GUID, and its string representation is generated through the [`Guid.ToString`](https://msdn.microsoft.com/library/97af8hh4.aspx) method with format specifier "D".</span></span>

<span data-ttu-id="7b013-124">*ServiceReplicaOrInstanceId* — это строковое представление идентификатора реплики или экземпляра Service Fabric, c которой связан экземпляр счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-124">*ServiceReplicaOrInstanceId* is the string representation of the Service Fabric Replica/Instance ID that the performance counter instance is associated with.</span></span>

<span data-ttu-id="7b013-125">*ServiceRuntimeInternalID* — это строковое представление 64-разрядного целого числа. Оно создается средой выполнения Fabric Service для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="7b013-125">*ServiceRuntimeInternalID* is the string representation of a 64-bit integer that is generated by the Fabric Service runtime for its internal use.</span></span> <span data-ttu-id="7b013-126">В имя экземпляра счетчика производительности оно включается для того, чтобы обеспечить его уникальность и избежать конфликтов с именами других экземпляров счетчиков производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-126">This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names.</span></span> <span data-ttu-id="7b013-127">Пользователям не следует пытаться интерпретировать эту часть имени экземпляра счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-127">Users should not try to interpret this portion of the performance counter instance name.</span></span>

<span data-ttu-id="7b013-128">Пример имени экземпляра счетчика, относящегося к категории `Service Fabric Service` :</span><span class="sxs-lookup"><span data-stu-id="7b013-128">The following is an example of a counter instance name for a counter that belongs to the `Service Fabric Service` category:</span></span>

`2740af29-78aa-44bc-a20b-7e60fb783264_635650083799324046_5008379932`

<span data-ttu-id="7b013-129">В предыдущем примере `2740af29-78aa-44bc-a20b-7e60fb783264` — это строковое представление идентификатора секции Service Fabric, `635650083799324046` — строковое представление идентификатора реплики или экземпляра, а `5008379932`— 64-разрядный идентификатор, создаваемый средой выполнения для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="7b013-129">In the preceding example, `2740af29-78aa-44bc-a20b-7e60fb783264` is the string representation of the Service Fabric partition ID, `635650083799324046` is string representation of Replica/InstanceId and `5008379932` is the 64-bit ID that is generated for the runtime's internal use.</span></span>

#### <a name="service-fabric-service-method-category"></a><span data-ttu-id="7b013-130">Категория Service Fabric Service Method</span><span class="sxs-lookup"><span data-stu-id="7b013-130">Service Fabric Service Method category</span></span>
<span data-ttu-id="7b013-131">Экземпляры счетчиков в категории `Service Fabric Service Method`имеют имена в следующем формате:</span><span class="sxs-lookup"><span data-stu-id="7b013-131">For the category `Service Fabric Service Method`, the counter instance names are in the following format:</span></span>

`MethodName_ServiceRuntimeMethodId_ServiceFabricPartitionID_ServiceReplicaOrInstanceId_ServiceRuntimeInternalID`

<span data-ttu-id="7b013-132">*MethodName* — это имя метода службы, с которым связан экземпляр счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-132">*MethodName* is the name of the service method that the performance counter instance is associated with.</span></span> <span data-ttu-id="7b013-133">Формат имени метода определяется на основе логики в среде выполнения Fabric Service, которая органично сочетает удобочитаемость с ограничениями Windows на максимальную длину имен экземпляров счетчиков производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-133">The format of the method name is determined based on some logic in the Fabric Service runtime that balances the readability of the name with constraints on the maximum length of the performance counter instance names on Windows.</span></span>

<span data-ttu-id="7b013-134">*ServiceRuntimeMethodId* — это строковое представление 32-разрядного целого числа. Оно создается средой выполнения Fabric Service для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="7b013-134">*ServiceRuntimeMethodId* is the string representation of a 32-bit integer that is generated by the Fabric Service runtime for its internal use.</span></span> <span data-ttu-id="7b013-135">В имя экземпляра счетчика производительности оно включается для того, чтобы обеспечить его уникальность и избежать конфликтов с именами других экземпляров счетчиков производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-135">This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names.</span></span> <span data-ttu-id="7b013-136">Пользователям не следует пытаться интерпретировать эту часть имени экземпляра счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-136">Users should not try to interpret this portion of the performance counter instance name.</span></span>

<span data-ttu-id="7b013-137">*ServiceFabricPartitionID* — это строка идентификатора секции Service Fabric, c которой связан экземпляр счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-137">*ServiceFabricPartitionID* is the string representation of the Service Fabric partition ID that the performance counter instance is associated with.</span></span> <span data-ttu-id="7b013-138">Это идентификатор GUID, строковое представление которого создается методом [`Guid.ToString`](https://msdn.microsoft.com/library/97af8hh4.aspx) с использованием описателя формата D.</span><span class="sxs-lookup"><span data-stu-id="7b013-138">The partition ID is a GUID, and its string representation is generated through the [`Guid.ToString`](https://msdn.microsoft.com/library/97af8hh4.aspx) method with format specifier "D".</span></span>

<span data-ttu-id="7b013-139">*ServiceReplicaOrInstanceId* — это строковое представление идентификатора реплики или экземпляра Service Fabric, c которой связан экземпляр счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-139">*ServiceReplicaOrInstanceId* is the string representation of the Service Fabric Replica/Instance ID that the performance counter instance is associated with.</span></span>

<span data-ttu-id="7b013-140">*ServiceRuntimeInternalID* — это строковое представление 64-разрядного целого числа. Оно создается средой выполнения Fabric Service для внутреннего использования.</span><span class="sxs-lookup"><span data-stu-id="7b013-140">*ServiceRuntimeInternalID* is the string representation of a 64-bit integer that is generated by the Fabric Service runtime for its internal use.</span></span> <span data-ttu-id="7b013-141">В имя экземпляра счетчика производительности оно включается для того, чтобы обеспечить его уникальность и избежать конфликтов с именами других экземпляров счетчиков производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-141">This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names.</span></span> <span data-ttu-id="7b013-142">Пользователям не следует пытаться интерпретировать эту часть имени экземпляра счетчика производительности.</span><span class="sxs-lookup"><span data-stu-id="7b013-142">Users should not try to interpret this portion of the performance counter instance name.</span></span>

<span data-ttu-id="7b013-143">Пример имени экземпляра счетчика, относящегося к категории `Service Fabric Service Method` :</span><span class="sxs-lookup"><span data-stu-id="7b013-143">The following is an example of a counter instance name for a counter that belongs to the `Service Fabric Service Method` category:</span></span>

`ivoicemailboxservice.leavemessageasync_2_89383d32-e57e-4a9b-a6ad-57c6792aa521_635650083804480486_5008380`

<span data-ttu-id="7b013-144">В предыдущем примере `ivoicemailboxservice.leavemessageasync` — это имя метода, `2` — 32-разрядный идентификатор, создаваемый для внутреннего использования средой выполнения, `89383d32-e57e-4a9b-a6ad-57c6792aa521` — строковое представление идентификатора секции Service Fabric, `635650083804480486` — строковое представление идентификатора реплики или экземпляра Service Fabric, а `5008380` — 64-разрядный идентификатор, создаваемый для внутреннего использования средой выполнения.</span><span class="sxs-lookup"><span data-stu-id="7b013-144">In the preceding example, `ivoicemailboxservice.leavemessageasync` is the method name, `2` is the 32-bit ID generated for the runtime's internal use, `89383d32-e57e-4a9b-a6ad-57c6792aa521` is the string representation of the Service Fabric partition ID,`635650083804480486` is the string representation of the Service Fabric Replica/Instance ID and `5008380` is the 64-bit ID generated for the runtime's internal use.</span></span>

## <a name="list-of-performance-counters"></a><span data-ttu-id="7b013-145">Список счетчиков производительности</span><span class="sxs-lookup"><span data-stu-id="7b013-145">List of Performance counters</span></span>
### <a name="service-method-performance-counters"></a><span data-ttu-id="7b013-146">Счетчики производительности метода службы</span><span class="sxs-lookup"><span data-stu-id="7b013-146">Service method performance counters</span></span>

<span data-ttu-id="7b013-147">Среда выполнения Reliable Service публикует следующие счетчики производительности, связанные с выполнением методов службы.</span><span class="sxs-lookup"><span data-stu-id="7b013-147">The Reliable Service runtime publishes the following performance counters related to the execution of service methods.</span></span>

| <span data-ttu-id="7b013-148">Имя категории</span><span class="sxs-lookup"><span data-stu-id="7b013-148">Category name</span></span> | <span data-ttu-id="7b013-149">Имя счетчика</span><span class="sxs-lookup"><span data-stu-id="7b013-149">Counter name</span></span> | <span data-ttu-id="7b013-150">Описание</span><span class="sxs-lookup"><span data-stu-id="7b013-150">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7b013-151">Service Fabric Service Method</span><span class="sxs-lookup"><span data-stu-id="7b013-151">Service Fabric Service Method</span></span> |<span data-ttu-id="7b013-152">Вызовов в секунду</span><span class="sxs-lookup"><span data-stu-id="7b013-152">Invocations/Sec</span></span> |<span data-ttu-id="7b013-153">Количество вызовов метода службы в секунду</span><span class="sxs-lookup"><span data-stu-id="7b013-153">Number of times that the  service method is invoked per second</span></span> |
| <span data-ttu-id="7b013-154">Service Fabric Service Method</span><span class="sxs-lookup"><span data-stu-id="7b013-154">Service Fabric Service Method</span></span> |<span data-ttu-id="7b013-155">Среднее время вызова (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-155">Average milliseconds per invocation</span></span> |<span data-ttu-id="7b013-156">Время, затраченное на выполнение метода службы, в миллисекундах</span><span class="sxs-lookup"><span data-stu-id="7b013-156">Time taken to execute the service method in milliseconds</span></span> |
| <span data-ttu-id="7b013-157">Service Fabric Service Method</span><span class="sxs-lookup"><span data-stu-id="7b013-157">Service Fabric Service Method</span></span> |<span data-ttu-id="7b013-158">Исключений в секунду</span><span class="sxs-lookup"><span data-stu-id="7b013-158">Exceptions thrown/Sec</span></span> |<span data-ttu-id="7b013-159">Количество исключений, порожденных методом службы, в секунду</span><span class="sxs-lookup"><span data-stu-id="7b013-159">Number of times that the service method threw an exception per second</span></span> |

### <a name="service-request-processing-performance-counters"></a><span data-ttu-id="7b013-160">Счетчики производительности обработки запросов службы</span><span class="sxs-lookup"><span data-stu-id="7b013-160">Service request processing performance counters</span></span>
<span data-ttu-id="7b013-161">Когда клиент вызывает метод через объект прокси службы, это приводит к отправке по сети сообщения запроса в Remoting Service.</span><span class="sxs-lookup"><span data-stu-id="7b013-161">When a client invokes a method via a service proxy object, it results in a request message being sent over the network to the remoting service.</span></span> <span data-ttu-id="7b013-162">Служба обрабатывает сообщение запроса и отправляет ответ обратно клиенту.</span><span class="sxs-lookup"><span data-stu-id="7b013-162">The service processes the request message and sends a response back to the client.</span></span> <span data-ttu-id="7b013-163">Среда выполнения Reliable ServiceRemoting публикует следующие счетчики производительности, связанные с обработкой запросов службы.</span><span class="sxs-lookup"><span data-stu-id="7b013-163">The Reliable ServiceRemoting runtime publishes the following performance counters related to service request processing.</span></span>

| <span data-ttu-id="7b013-164">Имя категории</span><span class="sxs-lookup"><span data-stu-id="7b013-164">Category name</span></span> | <span data-ttu-id="7b013-165">Имя счетчика</span><span class="sxs-lookup"><span data-stu-id="7b013-165">Counter name</span></span> | <span data-ttu-id="7b013-166">Описание</span><span class="sxs-lookup"><span data-stu-id="7b013-166">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7b013-167">Service Fabric Service</span><span class="sxs-lookup"><span data-stu-id="7b013-167">Service Fabric Service</span></span> |<span data-ttu-id="7b013-168">Число невыполненных запросов</span><span class="sxs-lookup"><span data-stu-id="7b013-168"># of outstanding requests</span></span> |<span data-ttu-id="7b013-169">Число запросов, обрабатываемых в службе</span><span class="sxs-lookup"><span data-stu-id="7b013-169">Number of requests being processed in the service</span></span> |
| <span data-ttu-id="7b013-170">Service Fabric Service</span><span class="sxs-lookup"><span data-stu-id="7b013-170">Service Fabric Service</span></span> |<span data-ttu-id="7b013-171">Среднее время запроса (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-171">Average milliseconds per request</span></span> |<span data-ttu-id="7b013-172">Время обработки запроса службой (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-172">Time taken (in milliseconds) by the service to process a request</span></span> |
| <span data-ttu-id="7b013-173">Service Fabric Service</span><span class="sxs-lookup"><span data-stu-id="7b013-173">Service Fabric Service</span></span> |<span data-ttu-id="7b013-174">Среднее время десериализации запроса (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-174">Average milliseconds for request deserialization</span></span> |<span data-ttu-id="7b013-175">Время десериализации сообщения запроса службы при получении его службой (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-175">Time taken (in milliseconds) to deserialize service request message when it is received at the service</span></span> |
| <span data-ttu-id="7b013-176">Service Fabric Service</span><span class="sxs-lookup"><span data-stu-id="7b013-176">Service Fabric Service</span></span> |<span data-ttu-id="7b013-177">Среднее время сериализации ответа (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-177">Average milliseconds for response serialization</span></span> |<span data-ttu-id="7b013-178">Время сериализации ответного сообщения службы в службе до отправки ответа клиенту (мс)</span><span class="sxs-lookup"><span data-stu-id="7b013-178">Time taken (in milliseconds) to serialize the service response message at the service before the response is sent to the client</span></span> |

## <a name="next-steps"></a><span data-ttu-id="7b013-179">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="7b013-179">Next steps</span></span>
* [<span data-ttu-id="7b013-180">Пример кода</span><span class="sxs-lookup"><span data-stu-id="7b013-180">Sample code</span></span>](https://github.com/Azure/servicefabric-samples)
* [<span data-ttu-id="7b013-181">Поставщики EventSource в PerfView</span><span class="sxs-lookup"><span data-stu-id="7b013-181">EventSource providers in PerfView</span></span>](https://blogs.msdn.microsoft.com/vancem/2012/07/09/introduction-tutorial-logging-etw-events-in-c-system-diagnostics-tracing-eventsource/)
