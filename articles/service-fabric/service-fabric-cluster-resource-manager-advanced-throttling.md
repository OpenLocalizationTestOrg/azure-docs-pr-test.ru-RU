---
title: "aaaThrottling в диспетчер ресурсов кластера Service Fabric hello | Документы Microsoft"
description: "Дополнительные интервалы повтора tooconfigure hello, предоставляемые hello диспетчер ресурсов кластера Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 4a44678b-a5aa-4d30-958f-dc4332ebfb63
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f418536911d3e3814e78a4d9f057dfb867ca7c63
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="throttling-hello-service-fabric-cluster-resource-manager"></a><span data-ttu-id="c24f1-103">Регулирование hello диспетчер ресурсов кластера Service Fabric</span><span class="sxs-lookup"><span data-stu-id="c24f1-103">Throttling hello Service Fabric Cluster Resource Manager</span></span>
<span data-ttu-id="c24f1-104">Даже если вы настроили hello диспетчер ресурсов кластера неправильно, можно получить разрыва hello кластера.</span><span class="sxs-lookup"><span data-stu-id="c24f1-104">Even if you’ve configured hello Cluster Resource Manager correctly, hello cluster can get disrupted.</span></span> <span data-ttu-id="c24f1-105">Например может быть одновременных узла и отказоустойчивость домена отказов - что произойдет, если возникшее во время обновления? Hello диспетчер ресурсов кластера всегда пытается toofix все потребление ресурсов кластера hello попытки tooreorganize и исправление hello кластера.</span><span class="sxs-lookup"><span data-stu-id="c24f1-105">For example, there could be simultaneous node and fault domain failures - what would happen if that occurred during an upgrade? hello Cluster Resource Manager always tries toofix everything, consuming hello cluster's resources trying tooreorganize and fix hello cluster.</span></span> <span data-ttu-id="c24f1-106">Регулирования обеспечивают поддержку, чтобы hello кластера можно использовать ресурсы toostabilize - вернитесь узлы hello, автоматическое восстановление секций сети hello, исправленный bits развертывается.</span><span class="sxs-lookup"><span data-stu-id="c24f1-106">Throttles help provide a backstop so that hello cluster can use resources toostabilize - hello nodes come back, hello network partitions heal, corrected bits get deployed.</span></span>

<span data-ttu-id="c24f1-107">toohelp такого рода ситуациях hello диспетчер ресурсов кластера Service Fabric включает несколько регулирования.</span><span class="sxs-lookup"><span data-stu-id="c24f1-107">toohelp with these sorts of situations, hello Service Fabric Cluster Resource Manager includes several throttles.</span></span> <span data-ttu-id="c24f1-108">Все это достаточно масштабные средства.</span><span class="sxs-lookup"><span data-stu-id="c24f1-108">These throttles are all fairly large hammers.</span></span> <span data-ttu-id="c24f1-109">Обычно они не должны изменяться без тщательного планирования и тестирования.</span><span class="sxs-lookup"><span data-stu-id="c24f1-109">Generally they shouldn’t be changed without careful planning and testing.</span></span>

<span data-ttu-id="c24f1-110">При изменении ограничителей hello диспетчер ресурсов кластера его необходимо настроить их tooyour ожидаемый реальную нагрузку.</span><span class="sxs-lookup"><span data-stu-id="c24f1-110">If you change hello Cluster Resource Manager's throttles, you should tune them tooyour expected actual load.</span></span> <span data-ttu-id="c24f1-111">Можно определить, необходимые toohave некоторые регулирует на месте, даже если это означает, что кластера hello занимает больше времени, toostabilize в некоторых ситуациях.</span><span class="sxs-lookup"><span data-stu-id="c24f1-111">You may determine you need toohave some throttles in place, even if it means hello cluster takes longer toostabilize in some situations.</span></span> <span data-ttu-id="c24f1-112">Проверка является обязательным toodetermine hello правильные значения для регулирования.</span><span class="sxs-lookup"><span data-stu-id="c24f1-112">Testing is required toodetermine hello correct values for throttles.</span></span> <span data-ttu-id="c24f1-113">Интервалы повтора должны toobe находится достаточно высоко tooallow hello кластера toorespond toochanges в разумные сроки, а нижнее достаточно tooactually предотвращения слишком большой объем потребления ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c24f1-113">Throttles need toobe high enough tooallow hello cluster toorespond toochanges in a reasonable amount of time, and low enough tooactually prevent too much resource consumption.</span></span> 

<span data-ttu-id="c24f1-114">Большую часть времени hello, мы видели клиентов используйте ограничителей которого она была, так как они уже были в ограниченной среде ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c24f1-114">Most of hello time we’ve seen customers use throttles it has been because they were already in a resource constrained environment.</span></span> <span data-ttu-id="c24f1-115">Некоторые примеры, будет ограниченной пропускной способности сети для отдельных узлов или диски, которые не могут toobuild много реплики с отслеживанием состояния в параллельных из-за ограничения toothroughput.</span><span class="sxs-lookup"><span data-stu-id="c24f1-115">Some examples would be limited network bandwidth for individual nodes, or disks that aren't able toobuild many stateful replicas in parallel due toothroughput limitations.</span></span> <span data-ttu-id="c24f1-116">Без регулирования операции может переполнить эти ресурсы, вызывая toofail операций или медленно.</span><span class="sxs-lookup"><span data-stu-id="c24f1-116">Without throttles, operations could overwhelm these resources, causing operations toofail or be slow.</span></span> <span data-ttu-id="c24f1-117">В таких ситуациях пользователи используется ограничителей и знал, что они расширение hello количество времени, потребуется tooreach кластера hello стабильного состояния.</span><span class="sxs-lookup"><span data-stu-id="c24f1-117">In these situations customers used throttles and knew they were extending hello amount of time it would take hello cluster tooreach a stable state.</span></span> <span data-ttu-id="c24f1-118">и что регулирование может привести к понижению общей надежности.</span><span class="sxs-lookup"><span data-stu-id="c24f1-118">Customers also understood they could end up running at lower overall reliability while they were throttled.</span></span>


## <a name="configuring-hello-throttles"></a><span data-ttu-id="c24f1-119">Настройка регулирования hello</span><span class="sxs-lookup"><span data-stu-id="c24f1-119">Configuring hello throttles</span></span>

<span data-ttu-id="c24f1-120">Service Fabric имеет два механизма регулирования hello число перемещений реплики.</span><span class="sxs-lookup"><span data-stu-id="c24f1-120">Service Fabric has two mechanisms for throttling hello number of replica movements.</span></span> <span data-ttu-id="c24f1-121">механизм по умолчанию Hello, существовавшие до Service Fabric 5.7 представляет регулирования в виде абсолютного числа перемещений разрешено.</span><span class="sxs-lookup"><span data-stu-id="c24f1-121">hello default mechanism that existed before Service Fabric 5.7 represents throttling as an absolute number of moves allowed.</span></span> <span data-ttu-id="c24f1-122">Это подходит не для всех размеров кластеров.</span><span class="sxs-lookup"><span data-stu-id="c24f1-122">This does not work for clusters of all sizes.</span></span> <span data-ttu-id="c24f1-123">В частности для больших кластеров hello значения по умолчанию значение может быть слишком мал, значительно замедляя Балансировка даже в том случае, когда это необходимо, при необходимости в более мелкие кластеры не влияет.</span><span class="sxs-lookup"><span data-stu-id="c24f1-123">In particular, for large clusters hello default value can be too small, significantly slowing down balancing even when it is necessary, while having no effect in smaller clusters.</span></span> <span data-ttu-id="c24f1-124">Этот механизм предыдущих был заменен по проценту регулирования, масштабирует лучше при динамической кластеров, в какой номер hello служб и регулярно менять узлов.</span><span class="sxs-lookup"><span data-stu-id="c24f1-124">This prior mechanism has been superseded by percentage-based throttling, which scales better with dynamic clusters in which hello number of services and nodes change regularly.</span></span>

<span data-ttu-id="c24f1-125">Hello ограничителей основаны на процент hello число реплик в кластерах hello.</span><span class="sxs-lookup"><span data-stu-id="c24f1-125">hello throttles are based on a percentage of hello number of replicas in hello clusters.</span></span> <span data-ttu-id="c24f1-126">Производится на основе Percetage включить выражения hello правило: «не перемещать более 10% реплик в течение 10 минут», например.</span><span class="sxs-lookup"><span data-stu-id="c24f1-126">Percetage based throttles enable expressing hello rule: "do not move more than 10% of replicas in a 10 minute interval", for example.</span></span>

<span data-ttu-id="c24f1-127">параметры конфигурации Hello процентных регулирования не:</span><span class="sxs-lookup"><span data-stu-id="c24f1-127">hello configuration settings for percentage-based throttling are:</span></span>

  - <span data-ttu-id="c24f1-128">GlobalMovementThrottleThresholdPercentage - максимальное число перемещений допускается в кластер в любое время, выраженное в процентном допустимое количество реплик в кластере hello.</span><span class="sxs-lookup"><span data-stu-id="c24f1-128">GlobalMovementThrottleThresholdPercentage - Maximum number of movements allowed in cluster at any time, expressed as percentage of total number of replicas in hello cluster.</span></span> <span data-ttu-id="c24f1-129">Значение 0 означает, что ограничения отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="c24f1-129">0 indicates no limit.</span></span> <span data-ttu-id="c24f1-130">значение по умолчанию Hello — 0.</span><span class="sxs-lookup"><span data-stu-id="c24f1-130">hello default value is 0.</span></span> <span data-ttu-id="c24f1-131">Если GlobalMovementThrottleThreshold и этот параметр заданы, то hello меньшем ограничение будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="c24f1-131">If both this setting and GlobalMovementThrottleThreshold are specified, then hello more conservative limit is used.</span></span>
  - <span data-ttu-id="c24f1-132">GlobalMovementThrottleThresholdPercentageForPlacement - максимальное число перемещений допускается во время фазы размещения hello, выраженное в процентах общему количеству реплики в кластере hello.</span><span class="sxs-lookup"><span data-stu-id="c24f1-132">GlobalMovementThrottleThresholdPercentageForPlacement - Maximum number of movements allowed during hello placement phase, expressed as percentage of total number of replicas in hello cluster.</span></span> <span data-ttu-id="c24f1-133">Значение 0 означает, что ограничения отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="c24f1-133">0 indicates no limit.</span></span> <span data-ttu-id="c24f1-134">значение по умолчанию Hello — 0.</span><span class="sxs-lookup"><span data-stu-id="c24f1-134">hello default value is 0.</span></span> <span data-ttu-id="c24f1-135">Если GlobalMovementThrottleThresholdForPlacement и этот параметр заданы, то hello меньшем ограничение будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="c24f1-135">If both this setting and GlobalMovementThrottleThresholdForPlacement are specified, then hello more conservative limit is used.</span></span>
  - <span data-ttu-id="c24f1-136">GlobalMovementThrottleThresholdPercentageForBalancing - максимальное число перемещений, разрешены в ходе hello балансировки этап, выраженное в процентах общему количеству реплики в кластере hello.</span><span class="sxs-lookup"><span data-stu-id="c24f1-136">GlobalMovementThrottleThresholdPercentageForBalancing - Maximum number of movements allowed during hello balancing phase, expressed as percentage of total number of replicas in hello cluster.</span></span> <span data-ttu-id="c24f1-137">Значение 0 означает, что ограничения отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="c24f1-137">0 indicates no limit.</span></span> <span data-ttu-id="c24f1-138">значение по умолчанию Hello — 0.</span><span class="sxs-lookup"><span data-stu-id="c24f1-138">hello default value is 0.</span></span> <span data-ttu-id="c24f1-139">Если GlobalMovementThrottleThresholdForBalancing и этот параметр заданы, то hello меньшем ограничение будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="c24f1-139">If both this setting and GlobalMovementThrottleThresholdForBalancing are specified, then hello more conservative limit is used.</span></span>

<span data-ttu-id="c24f1-140">При указании hello скорости в процентах, следует указать как 0,05 5%.</span><span class="sxs-lookup"><span data-stu-id="c24f1-140">When specifying hello throttle percentage, you'd specify 5% as 0.05.</span></span> <span data-ttu-id="c24f1-141">Интервал приветствия, на котором определены эти регулирования — hello GlobalMovementThrottleCountingInterval, который указывается в секундах.</span><span class="sxs-lookup"><span data-stu-id="c24f1-141">hello interval on which these throttles are governed is hello GlobalMovementThrottleCountingInterval, which is specified in seconds.</span></span>


``` xml
<Section Name="PlacementAndLoadBalancing">
     <Parameter Name="GlobalMovementThrottleThresholdPercentage" Value="0" />
     <Parameter Name="GlobalMovementThrottleThresholdPercentageForPlacement" Value="0" />
     <Parameter Name="GlobalMovementThrottleThresholdPercentageForBalancing" Value="0" />
     <Parameter Name="GlobalMovementThrottleCountingInterval" Value="600" />
</Section>
```

<span data-ttu-id="c24f1-142">Для автономных развертываний используется ClusterConfig.json, а для размещенных в Azure кластеров — Template.json.</span><span class="sxs-lookup"><span data-stu-id="c24f1-142">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "PlacementAndLoadBalancing",
    "parameters": [
      {
          "name": "GlobalMovementThrottleThresholdPercentage",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleThresholdPercentageForPlacement",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleThresholdPercentageForBalancing",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleCountingInterval",
          "value": "600"
      }
    ]
  }
]
```

### <a name="default-count-based-throttles"></a><span data-ttu-id="c24f1-143">Регулирование на основе количества по умолчанию</span><span class="sxs-lookup"><span data-stu-id="c24f1-143">Default count based throttles</span></span>
<span data-ttu-id="c24f1-144">Эти сведения предоставляются на случай, если у вас имеются устаревшие кластеры или в обновленных кластерах по-прежнему используются такие конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c24f1-144">This information is provided in case you have older clusters or still retain these configurations in clusters that have since been upgraded.</span></span> <span data-ttu-id="c24f1-145">Как правило рекомендуется, они заменяются hello процентных ограничителей выше.</span><span class="sxs-lookup"><span data-stu-id="c24f1-145">In general, it is recommended that these are replaced with hello percentage-based throttles above.</span></span> <span data-ttu-id="c24f1-146">Так процентных регулирования отключена по умолчанию, эти регулирования остаются hello регулирования по умолчанию для кластера, пока отключаются и заменены ограничителей процентных hello.</span><span class="sxs-lookup"><span data-stu-id="c24f1-146">Since percentage-based throttling is disabled by default, these throttles remain hello default throttles for a cluster until they are disabled and replaced with hello percentage-based throttles.</span></span> 

  - <span data-ttu-id="c24f1-147">GlobalMovementThrottleThreshold — этот параметр управляет hello общее число перемещений в кластере hello через некоторое время.</span><span class="sxs-lookup"><span data-stu-id="c24f1-147">GlobalMovementThrottleThreshold – this setting controls hello total number of movements in hello cluster over some time.</span></span> <span data-ttu-id="c24f1-148">Hello количество времени, указывается в секундах в виде hello GlobalMovementThrottleCountingInterval.</span><span class="sxs-lookup"><span data-stu-id="c24f1-148">hello amount of time is specified in seconds as hello GlobalMovementThrottleCountingInterval.</span></span> <span data-ttu-id="c24f1-149">значение по умолчанию Hello hello GlobalMovementThrottleThreshold равно 1000 и значение по умолчанию hello hello GlobalMovementThrottleCountingInterval равно 600.</span><span class="sxs-lookup"><span data-stu-id="c24f1-149">hello default value for hello GlobalMovementThrottleThreshold is 1000 and hello default value for hello GlobalMovementThrottleCountingInterval is 600.</span></span>
  - <span data-ttu-id="c24f1-150">MovementPerPartitionThrottleThreshold — этот параметр управляет hello общее число перемещений для любого раздела службы через некоторое время.</span><span class="sxs-lookup"><span data-stu-id="c24f1-150">MovementPerPartitionThrottleThreshold – this setting controls hello total number of movements for any service partition over some time.</span></span> <span data-ttu-id="c24f1-151">Hello количество времени, указывается в секундах в виде hello MovementPerPartitionThrottleCountingInterval.</span><span class="sxs-lookup"><span data-stu-id="c24f1-151">hello amount of time is specified in seconds as hello MovementPerPartitionThrottleCountingInterval.</span></span> <span data-ttu-id="c24f1-152">значение по умолчанию Hello hello MovementPerPartitionThrottleThreshold равно 50 и значение по умолчанию hello hello MovementPerPartitionThrottleCountingInterval равно 600.</span><span class="sxs-lookup"><span data-stu-id="c24f1-152">hello default value for hello MovementPerPartitionThrottleThreshold is 50 and hello default value for hello MovementPerPartitionThrottleCountingInterval is 600.</span></span>

<span data-ttu-id="c24f1-153">Конфигурация Hello эти hello следующим регулирования, же шаблон как hello процентных регулирования.</span><span class="sxs-lookup"><span data-stu-id="c24f1-153">hello configuration for these throttles follows hello same pattern as hello percentage-based throttling.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c24f1-154">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c24f1-154">Next steps</span></span>
- <span data-ttu-id="c24f1-155">toofind out о управляет hello диспетчер ресурсов кластера и балансировку нагрузки в кластере hello Извлеките hello статьи на [балансировки нагрузки](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="c24f1-155">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="c24f1-156">Hello диспетчер ресурсов кластера позволяет настраивать различные параметры для описания кластера hello.</span><span class="sxs-lookup"><span data-stu-id="c24f1-156">hello Cluster Resource Manager has many options for describing hello cluster.</span></span> <span data-ttu-id="c24f1-157">toofind подробные сведения о них, извлеките в этой статье на [описания кластера Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="c24f1-157">toofind out more about them, check out this article on [describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
