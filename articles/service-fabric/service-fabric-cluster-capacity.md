---
title: "Планирование загрузки кластера Service Fabric | Документация Майкрософт"
description: "Рекомендации по планированию загрузки кластера Service Fabric. NodeTypes, устойчивость и уровни надежности"
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: 4c584f4a-cb1f-400c-b61f-1f797f11c982
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/24/2017
ms.author: chackdan
ms.openlocfilehash: 36b96360fabdcc64ffd2356540c580594637d48e
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="service-fabric-cluster-capacity-planning-considerations"></a><span data-ttu-id="baf01-104">Рекомендации по планированию загрузки кластера Service Fabric</span><span class="sxs-lookup"><span data-stu-id="baf01-104">Service Fabric cluster capacity planning considerations</span></span>
<span data-ttu-id="baf01-105">Для любой рабочей развернутой службы важным шагом является планирование загрузки.</span><span class="sxs-lookup"><span data-stu-id="baf01-105">For any production deployment, capacity planning is an important step.</span></span> <span data-ttu-id="baf01-106">Ниже приведено несколько факторов, которые необходимо учитывать при этом.</span><span class="sxs-lookup"><span data-stu-id="baf01-106">Here are some of the items that you have to consider as a part of that process.</span></span>

* <span data-ttu-id="baf01-107">Количество типов узлов, с которыми создается кластер</span><span class="sxs-lookup"><span data-stu-id="baf01-107">The number of node types your cluster needs to start out with</span></span>
* <span data-ttu-id="baf01-108">Свойства каждого типа узла (размер, первичный узел, доступ к Интернету, количество виртуальных машин и т. п.).</span><span class="sxs-lookup"><span data-stu-id="baf01-108">The properties of each of node type (size, primary, internet facing, number of VMs, etc.)</span></span>
* <span data-ttu-id="baf01-109">Надежность и устойчивость характеристик кластера.</span><span class="sxs-lookup"><span data-stu-id="baf01-109">The reliability and durability characteristics of the cluster</span></span>

<span data-ttu-id="baf01-110">Кратко рассмотрим каждый из пунктов.</span><span class="sxs-lookup"><span data-stu-id="baf01-110">Let us briefly review each of these items.</span></span>

## <a name="the-number-of-node-types-your-cluster-needs-to-start-out-with"></a><span data-ttu-id="baf01-111">Количество типов узлов, с которыми создается кластер</span><span class="sxs-lookup"><span data-stu-id="baf01-111">The number of node types your cluster needs to start out with</span></span>
<span data-ttu-id="baf01-112">Во-первых, необходимо выяснить, для чего будет использоваться создаваемый кластер и какие виды приложений планируется в нем развернуть.</span><span class="sxs-lookup"><span data-stu-id="baf01-112">First, you need to figure out what the cluster you are creating is going to be used for and what kinds of applications you are planning to deploy into this cluster.</span></span> <span data-ttu-id="baf01-113">Если назначение кластера не ясно, скорее всего, вы еще не готовы перейти к планированию загрузки.</span><span class="sxs-lookup"><span data-stu-id="baf01-113">If you are not clear on the purpose of the cluster, you are most likely not yet ready to enter the capacity planning process.</span></span>

<span data-ttu-id="baf01-114">Определите количество типов узлов, с которыми нужно создать кластер.</span><span class="sxs-lookup"><span data-stu-id="baf01-114">Establish the number of node types your cluster needs to start out with.</span></span>  <span data-ttu-id="baf01-115">Каждый тип узла соответствует набору масштабирования виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="baf01-115">Each node type is mapped to a Virtual Machine Scale Set.</span></span> <span data-ttu-id="baf01-116">Каждый тип узла поддерживает возможность независимого масштабирования, имеет разные наборы открытых портов и собственные метрики емкости.</span><span class="sxs-lookup"><span data-stu-id="baf01-116">Each node type can then be scaled up or down independently, have different sets of ports open, and can have different capacity metrics.</span></span> <span data-ttu-id="baf01-117">Поэтому решение о числе типов узлов, в сущности, сводится к следующему.</span><span class="sxs-lookup"><span data-stu-id="baf01-117">So the decision of the number of node types essentially comes down to the following considerations:</span></span>

* <span data-ttu-id="baf01-118">Есть ли у вашего приложения несколько служб, среди которых есть службы, которые должны быть общедоступными или доступными из Интернета?</span><span class="sxs-lookup"><span data-stu-id="baf01-118">Does your application have multiple services, and do any of them need to be public or internet facing?</span></span> <span data-ttu-id="baf01-119">Типичные приложения содержат интерфейсную службу шлюза, которая получает входные данные от клиента, и одну или несколько внутренних служб, взаимодействующих с интерфейсными службами.</span><span class="sxs-lookup"><span data-stu-id="baf01-119">Typical applications contain a front-end gateway service that receives input from a client, and one or more back-end services that communicate with the front-end services.</span></span> <span data-ttu-id="baf01-120">Поэтому в этом случае требуется как минимум два типа узлов.</span><span class="sxs-lookup"><span data-stu-id="baf01-120">So in this case, you end up having at least two node types.</span></span>
* <span data-ttu-id="baf01-121">У служб (составляющих приложение) различные требования к инфраструктуре, например больше ОЗУ или тактов центрального процессора?</span><span class="sxs-lookup"><span data-stu-id="baf01-121">Do your services (that make up your application) have different infrastructure needs such as greater RAM or higher CPU cycles?</span></span> <span data-ttu-id="baf01-122">Предположим, что приложение, которое вам необходимо развернуть, содержит интерфейсную и внутреннюю службы.</span><span class="sxs-lookup"><span data-stu-id="baf01-122">For example, let us assume that the application that you want to deploy contains a front-end service and a back-end service.</span></span> <span data-ttu-id="baf01-123">Интерфейсная служба может выполняться на виртуальных машинах меньшего размера (например, D2) с портами, открытыми для доступа через Интернет.</span><span class="sxs-lookup"><span data-stu-id="baf01-123">The front-end service can run on smaller VMs (VM sizes like D2) that have ports open to the internet.</span></span>  <span data-ttu-id="baf01-124">Однако внутренняя служба, которая будет выполнять вычисления, должна размещаться на более крупных виртуальных машинах (D4, D6, D15) без выхода в Интернет.</span><span class="sxs-lookup"><span data-stu-id="baf01-124">The back-end service, however, is computation intensive and needs to run on larger VMs (with VM sizes like D4, D6, D15) that are not internet facing.</span></span>
  
  <span data-ttu-id="baf01-125">Хотя вы можете поместить все эти службы на узлы одного типа, в этом примере их лучше всего поместить в кластер с двумя типами узлов.</span><span class="sxs-lookup"><span data-stu-id="baf01-125">In this example, although you can decide to put all the services on one node type, we recommended that you place them in a cluster with two node types.</span></span>  <span data-ttu-id="baf01-126">Так у каждого типа узла будут свои собственные свойства, например возможность подключения к Интернету или размер виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="baf01-126">This allows for each node type to have distinct properties such as internet connectivity or VM size.</span></span> <span data-ttu-id="baf01-127">Кроме того, можно будет независимо менять число виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="baf01-127">The number of VMs can be scaled independently, as well.</span></span>  
* <span data-ttu-id="baf01-128">Так как нельзя предсказать будущее, исходите из известных вам фактов и решите, какое число типов узлов требуется, чтобы начать использовать приложения.</span><span class="sxs-lookup"><span data-stu-id="baf01-128">Since you cannot predict the future, go with facts you know of and decide on the number of node types that your applications need to start with.</span></span> <span data-ttu-id="baf01-129">Вы всегда сможете добавить или удалить типы узлов позже.</span><span class="sxs-lookup"><span data-stu-id="baf01-129">You can always add or remove node types later.</span></span> <span data-ttu-id="baf01-130">У кластера Service Fabric должен быть по крайней мере один тип узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-130">A Service Fabric cluster must have at least one node type.</span></span>

## <a name="the-properties-of-each-node-type"></a><span data-ttu-id="baf01-131">Свойства каждого типа узла</span><span class="sxs-lookup"><span data-stu-id="baf01-131">The properties of each node type</span></span>
<span data-ttu-id="baf01-132">**Тип узла** можно считать эквивалентом роли в облачных службах.</span><span class="sxs-lookup"><span data-stu-id="baf01-132">The **node type** can be seen as equivalent to roles in Cloud Services.</span></span> <span data-ttu-id="baf01-133">Он определяет размер виртуальных машин, их количество и свойства.</span><span class="sxs-lookup"><span data-stu-id="baf01-133">Node types define the VM sizes, the number of VMs, and their properties.</span></span> <span data-ttu-id="baf01-134">Каждый тип узла, определенный в кластере Service Fabric, настроен как отдельный набор масштабирования виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="baf01-134">Every node type that is defined in a Service Fabric cluster is set up as a separate virtual machine scale set.</span></span> <span data-ttu-id="baf01-135">Масштабируемые наборы виртуальных машин относятся к вычислительным ресурсам Azure. Их можно использовать для развертывания коллекции виртуальных машин и управления ею как набором.</span><span class="sxs-lookup"><span data-stu-id="baf01-135">Virtual machine scale set is an Azure compute resource you can use to deploy and manage a collection of virtual machines as a set.</span></span> <span data-ttu-id="baf01-136">Будучи определенным как отдельный набор масштабирования виртуальных машин, каждый тип узла поддерживает возможность независимого масштабирования, имеет разные наборы открытых портов и собственные метрики загрузки.</span><span class="sxs-lookup"><span data-stu-id="baf01-136">Being defined as distinct virtual machine scale set, each node type can then be scaled up or down independently, have different sets of ports open, and can have different capacity metrics.</span></span>

<span data-ttu-id="baf01-137">Прочтите [этот документ](service-fabric-cluster-nodetypes.md), чтобы больше узнать о взаимосвязи типов узлов и набора масштабирования виртуальных машин, а также о том, как подключиться к одному из экземпляров с помощью протокола RDP, открыть новые порты и т. д.</span><span class="sxs-lookup"><span data-stu-id="baf01-137">Read [this document](service-fabric-cluster-nodetypes.md) for more details on the relationship of Nodetypes to virtual machine scale set, how to RDP into one of the instances, open new ports etc.</span></span>

<span data-ttu-id="baf01-138">Кластер может содержать узлы нескольких типов, однако тип первичного узла (тот, который вы задали на портале) должен включать в себя не менее пяти виртуальных машин для кластеров, используемых для рабочих нагрузок в рабочей среде (или не менее трех виртуальных машин для тестовых кластеров).</span><span class="sxs-lookup"><span data-stu-id="baf01-138">Your cluster can have more than one node type, but the primary node type (the first one that you define on the portal) must have at least five VMs for clusters used for production workloads (or at least three VMs for test clusters).</span></span> <span data-ttu-id="baf01-139">Если вы создаете кластер с помощью шаблона Resource Manager, то ищите в определении типа узла атрибут **is Primary**.</span><span class="sxs-lookup"><span data-stu-id="baf01-139">If you are creating the cluster using a Resource Manager template, then look for **is Primary** attribute under the node type definition.</span></span> <span data-ttu-id="baf01-140">Тип первичного узла — это тип узла, на котором размещены системные службы Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="baf01-140">The primary node type is the node type where Service Fabric system services are placed.</span></span>  

### <a name="primary-node-type"></a><span data-ttu-id="baf01-141">Тип первичного узла</span><span class="sxs-lookup"><span data-stu-id="baf01-141">Primary node type</span></span>
<span data-ttu-id="baf01-142">Для кластера с несколькими типами узлов необходимо выбрать, какой из них будет первичным.</span><span class="sxs-lookup"><span data-stu-id="baf01-142">For a cluster with multiple node types, you need to choose one of them to be primary.</span></span> <span data-ttu-id="baf01-143">Ниже приведены характеристики типа первичного узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-143">Here are the characteristics of a primary node type:</span></span>

* <span data-ttu-id="baf01-144">**Минимальный размер виртуальных машин** для типа первичного узла зависит от выбранного **уровня устойчивости**.</span><span class="sxs-lookup"><span data-stu-id="baf01-144">The **minimum size of VMs** for the primary node type is determined by the **durability tier** you choose.</span></span> <span data-ttu-id="baf01-145">Значение по умолчанию для уровня устойчивости — Bronze.</span><span class="sxs-lookup"><span data-stu-id="baf01-145">The default for the durability tier is Bronze.</span></span> <span data-ttu-id="baf01-146">Прокрутите вниз, чтобы прочитать об уровне устойчивости и его значениях.</span><span class="sxs-lookup"><span data-stu-id="baf01-146">Scroll down for details on what the durability tier is and the values it can take.</span></span>  
* <span data-ttu-id="baf01-147">**Минимальное количество виртуальных машин** для типа первичного узла зависит от выбранного **уровня надежности**.</span><span class="sxs-lookup"><span data-stu-id="baf01-147">The **minimum number of VMs** for the primary node type is determined by the **reliability tier** you choose.</span></span> <span data-ttu-id="baf01-148">Значение по умолчанию для уровня надежности — Silver.</span><span class="sxs-lookup"><span data-stu-id="baf01-148">The default for the reliability tier is Silver.</span></span> <span data-ttu-id="baf01-149">Прокрутите вниз, чтобы прочитать об уровне надежности и его значениях.</span><span class="sxs-lookup"><span data-stu-id="baf01-149">Scroll down for details on what the reliability tier is and the values it can take.</span></span> 


* <span data-ttu-id="baf01-150">Системные службы Service Fabric (например, служба диспетчера кластера или служба хранилища образов) размещаются на первичных узлах, поэтому надежность и устойчивость кластера определяется значениями уровней надежности и устойчивости, выбранными для типа первичного узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-150">The Service Fabric system services (for example, the Cluster Manager service or Image Store service) are placed on the primary node type and so the reliability and durability of the cluster is determined by the reliability tier value and durability tier value you select for the primary node type.</span></span>

![<span data-ttu-id="baf01-151">Снимок экрана с двумя типами узлов</span><span class="sxs-lookup"><span data-stu-id="baf01-151">Screen shot of a cluster that has two Node Types</span></span> ][SystemServices]

### <a name="non-primary-node-type"></a><span data-ttu-id="baf01-152">Тип вторичного узла</span><span class="sxs-lookup"><span data-stu-id="baf01-152">Non-primary node type</span></span>
<span data-ttu-id="baf01-153">В кластере с несколькими типами узлов имеется один тип первичного узла, а остальные — типы вторичных узлов.</span><span class="sxs-lookup"><span data-stu-id="baf01-153">For a cluster with multiple node types, there is one primary node type and the rest of them are non-primary.</span></span> <span data-ttu-id="baf01-154">Ниже приведены характеристики типа вторичного узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-154">Here are the characteristics of a non-primary node type:</span></span>

* <span data-ttu-id="baf01-155">Минимальный размер виртуальных машин для этого типа узла зависит от выбранного уровня устойчивости.</span><span class="sxs-lookup"><span data-stu-id="baf01-155">The minimum size of VMs for this node type is determined by the durability tier you choose.</span></span> <span data-ttu-id="baf01-156">Значение по умолчанию для уровня устойчивости — Bronze.</span><span class="sxs-lookup"><span data-stu-id="baf01-156">The default for the durability tier is Bronze.</span></span> <span data-ttu-id="baf01-157">Прокрутите вниз, чтобы прочитать об уровне устойчивости и его значениях.</span><span class="sxs-lookup"><span data-stu-id="baf01-157">Scroll down for details on what the durability tier is and the values it can take.</span></span>  
* <span data-ttu-id="baf01-158">Минимальным количеством виртуальных машин для этого типа узла может быть одна виртуальная машина.</span><span class="sxs-lookup"><span data-stu-id="baf01-158">The minimum number of VMs for this node type can be one.</span></span> <span data-ttu-id="baf01-159">Тем не менее это число следует выбирать, руководствуясь количеством реплик приложения или служб, которые вы хотите запустить на узле этого типа.</span><span class="sxs-lookup"><span data-stu-id="baf01-159">However you should choose this number based on the number of replicas of the application/services that you would like to run in this node type.</span></span> <span data-ttu-id="baf01-160">После развертывания кластера число виртуальных машин для типа узла можно увеличить.</span><span class="sxs-lookup"><span data-stu-id="baf01-160">The number of VMs in a node type can be increased after you have deployed the cluster.</span></span>

## <a name="the-durability-characteristics-of-the-cluster"></a><span data-ttu-id="baf01-161">Характеристики устойчивости кластера</span><span class="sxs-lookup"><span data-stu-id="baf01-161">The durability characteristics of the cluster</span></span>
<span data-ttu-id="baf01-162">Уровень устойчивости используется, чтобы указать системе привилегии, имеющиеся у виртуальных машин в базовой инфраструктуре Azure.</span><span class="sxs-lookup"><span data-stu-id="baf01-162">The durability tier is used to indicate to the system the privileges that your VMs have with the underlying Azure infrastructure.</span></span> <span data-ttu-id="baf01-163">Для типа первичного узла эта привилегия позволяет Service Fabric приостановить любой запрос инфраструктуры на уровне виртуальной машины (например, перезагрузку, переустановку из образа или перенос виртуальной машины), который влияет на требования к кворуму, установленные для системных служб и ваших служб с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="baf01-163">In the primary node type, this privilege allows Service Fabric to pause any VM level infrastructure request (such as a VM reboot, VM reimage, or VM migration) that impact the quorum requirements for the system services and your stateful services.</span></span> <span data-ttu-id="baf01-164">Для типов вторичных узлов эта привилегия позволяет Service Fabric приостановить любой запрос инфраструктуры на уровне виртуальной машины, например перезагрузку, переустановку из образа или перенос виртуальной машины и т. д., который влияет на требования к кворуму, установленные для ваших служб с отслеживанием состояния, которые в ней запущены.</span><span class="sxs-lookup"><span data-stu-id="baf01-164">In the non-primary node types, this privilege allows Service Fabric to pause any VM level infrastructure requests like VM reboot, VM reimage, VM migration etc., that impact the quorum requirements for your stateful services running in it.</span></span>

<span data-ttu-id="baf01-165">Эта привилегия обозначается следующими значениями.</span><span class="sxs-lookup"><span data-stu-id="baf01-165">This privilege is expressed in the following values:</span></span>

* <span data-ttu-id="baf01-166">Gold: задания инфраструктуры могут быть приостановлены в течение двух часов для UD.</span><span class="sxs-lookup"><span data-stu-id="baf01-166">Gold - The infrastructure Jobs can be paused for a duration of two hours per UD.</span></span> <span data-ttu-id="baf01-167">Устойчивость Gold можно включить только для номеров SKU виртуальных машин полных узлов, например D15_V2, G5 и т. д.</span><span class="sxs-lookup"><span data-stu-id="baf01-167">Gold durability can be enabled only on full node VM skus like D15_V2, G5 etc.</span></span>
* <span data-ttu-id="baf01-168">Silver. Задания инфраструктуры могут быть приостановлены на 10 минут для UD. Они доступны на всех стандартных виртуальных машинах, содержащих одно или больше ядер.</span><span class="sxs-lookup"><span data-stu-id="baf01-168">Silver - The infrastructure Jobs can be paused for a duration of 10 minutes per UD and is available on all standard VMs of single core and above.</span></span>
* <span data-ttu-id="baf01-169">Bronze: привилегии отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="baf01-169">Bronze - No privileges.</span></span> <span data-ttu-id="baf01-170">Это уровень по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="baf01-170">This is the default.</span></span> <span data-ttu-id="baf01-171">Используйте этот уровень устойчивости только для типов узлов, на которых выполняются _только_ рабочие нагрузки без учета состояния.</span><span class="sxs-lookup"><span data-stu-id="baf01-171">Only use this durability level for Node Types that run _only_ stateless workloads.</span></span> 

> [!WARNING]
> <span data-ttu-id="baf01-172">Типы узлов, выполняющиеся с устойчивостью Bronze, _не получают привилегий_.</span><span class="sxs-lookup"><span data-stu-id="baf01-172">NodeTypes running with Bronze durability obtain _no privileges_.</span></span> <span data-ttu-id="baf01-173">Это означает, что задания инфраструктуры, которые влияют рабочие нагрузки без отслеживания состояния, не будут остановлены или отложены.</span><span class="sxs-lookup"><span data-stu-id="baf01-173">This means that infrastructure jobs that impact your stateless workloads will not be stopped or delayed.</span></span> <span data-ttu-id="baf01-174">Возможно, такие задания все же будут влиять на ваши рабочие нагрузки, приводя к простою или другим проблемам.</span><span class="sxs-lookup"><span data-stu-id="baf01-174">It is possible that such jobs can still impact your workloads, causing downtime or other issues.</span></span> <span data-ttu-id="baf01-175">Для выполнения любого вида производственной рабочей нагрузки рекомендуется использовать по крайней мере устойчивость Silver.</span><span class="sxs-lookup"><span data-stu-id="baf01-175">For any sort of production workload, running with at least Silver is recommended.</span></span> 
> 

<span data-ttu-id="baf01-176">Вы можете выбрать уровень устойчивости для каждого типа узла. В одном кластере можно выбрать уровень устойчивости Gold или Silver для одного типа узла и Bronze — для другого. **Необходимо не менее 5 узлов любого типа с устойчивостью Gold или Silver**.</span><span class="sxs-lookup"><span data-stu-id="baf01-176">You get to choose durability level for each of your node-types.You can choose one node-type to have a durability level of Gold or silver and the other have Bronze in the same cluster.**You must maintain a minimum count of 5 nodes for any node-type that has a durability of Gold or silver**.</span></span> 

<span data-ttu-id="baf01-177">**Преимущества использования уровней устойчивости Silver или Gold**</span><span class="sxs-lookup"><span data-stu-id="baf01-177">**Advantages of using Silver or Gold durability levels**</span></span>
 
1. <span data-ttu-id="baf01-178">Сокращение обязательных действий в операции свертывания (т. е. деактивация узла и Remove-ServiceFabricNodeState вызываются автоматически).</span><span class="sxs-lookup"><span data-stu-id="baf01-178">Reduces the number of required steps in a scale-in operation (that is, node deactivation and Remove-ServiceFabricNodeState is called automatically)</span></span>
2. <span data-ttu-id="baf01-179">Уменьшение риска потери данных из-за операций инфраструктуры Azure или инициированных клиентом внутренних операций изменения номера SKU виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="baf01-179">Reduces the risk of data loss due to a customer-initiated in-place VM SKU change operation or Azure infrastructure operations.</span></span>
     
<span data-ttu-id="baf01-180">**Недостатки использования уровней устойчивости Silver или Gold**</span><span class="sxs-lookup"><span data-stu-id="baf01-180">**Disadvantages of using Silver or Gold durability levels**</span></span>
 
1. <span data-ttu-id="baf01-181">Развертывания в масштабируемый набор виртуальных машин (и другие связанные ресурсы Azure) могут быть задержаны, просрочены или полностью заблокированы из-за проблем в кластере или на уровне инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="baf01-181">Deployments to your Virtual Machine Scale Set and other related Azure resources) can be delayed, can time out, or can be blocked entirely by problems in your cluster or at the infrastructure level.</span></span> 
2. <span data-ttu-id="baf01-182">Увеличивается число [событий жизненного цикла реплики](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle ) (например, переключений первичного узла) из-за автоматизированной деактивации узлов во время операций инфраструктуры Azure.</span><span class="sxs-lookup"><span data-stu-id="baf01-182">Increases the number of [replica lifecycle events](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle ) (for example, primary swaps) due to automated node deactivations during Azure infrastructure operations.</span></span>

### <a name="recommendations-on-when-to-use-silver-or-gold-durability-levels"></a><span data-ttu-id="baf01-183">Рекомендации по использованию уровней устойчивости Silver или Gold</span><span class="sxs-lookup"><span data-stu-id="baf01-183">Recommendations on when to use Silver or Gold durability levels</span></span>

<span data-ttu-id="baf01-184">Используйте уровни устойчивости Silver или Gold для всех типов узлов со службами с отслеживанием состояния, предполагающими частое свертывание (уменьшение числа экземпляров виртуальных машин), если вам предпочтительнее задержка операций развертывания за счет упрощения этих операций масштабирования.</span><span class="sxs-lookup"><span data-stu-id="baf01-184">Use Silver or Gold durability for all node types that host stateful services you expect to scale-in (reduce VM instance count) frequently, and you would prefer that deployment operations be delayed in favor of simplifying these scale-in operations.</span></span> <span data-ttu-id="baf01-185">Сценарии развертывания (добавления экземпляров виртуальных машин) не влияют на выбор уровня устойчивости, только сценарии свертывания.</span><span class="sxs-lookup"><span data-stu-id="baf01-185">The scale-out scenarios (adding VMs instances) do not play into your choice of the durability tier, only scale-in does.</span></span>

### <a name="operational-recommendations-for-the-node-type-that-you-have-set-to-silver-or-gold-durability-level"></a><span data-ttu-id="baf01-186">Рекомендации по эксплуатации для типа узла, для которого установлен уровень устойчивости Silver или Gold</span><span class="sxs-lookup"><span data-stu-id="baf01-186">Operational Recommendations for the node type that you have set to silver or gold durability level.</span></span>

1. <span data-ttu-id="baf01-187">Поддерживайте постоянную работоспособность кластера и приложений и проверяйте, своевременно ли реагируют приложения на все [события жизненного цикла реплики службы](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (например, задержку сборки реплики).</span><span class="sxs-lookup"><span data-stu-id="baf01-187">Keep your cluster and applications healthy at all times, and make sure that applications respond to all [Service replica lifecycle events](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (like replica in build is stuck) in a timely fashion.</span></span>
2. <span data-ttu-id="baf01-188">Реализуйте более безопасные способы изменения номера SKU виртуальной машины (масштабирования). Изменение номера SKU виртуальной машины для масштабируемого набора виртуальных машин по своей сути является небезопасной операцией, поэтому рекомендуется по возможности ее избегать.</span><span class="sxs-lookup"><span data-stu-id="baf01-188">Adopt safer ways to make a VM SKU change (Scale up/down): Changing the VM SKU of a Virtual Machine Scale Set is inherently an unsafe operation and so should be avoided if possible.</span></span> <span data-ttu-id="baf01-189">Ниже описывается, как избежать распространенных проблем.</span><span class="sxs-lookup"><span data-stu-id="baf01-189">Here is the process you can follow to avoid common issues.</span></span>
    - <span data-ttu-id="baf01-190">**Для типов узлов, не являющихся первичными:** рекомендуется создать масштабируемый набор виртуальных машин, изменить ограничение размещения служб, чтобы добавить новый тип узла для масштабируемого набора виртуальных машин, а затем сократить число экземпляров старого масштабируемого набора до 0, удаляя по одному узлу (так удаление узлов не повлияет на надежность кластера).</span><span class="sxs-lookup"><span data-stu-id="baf01-190">**For non-primary nodetypes:** It is recommended that you create new Virtual Machine Scale Set, modify the service placement constraint to include the new Virtual Machine Scale Set/node type and then reduce the old Virtual Machine Scale Set instance count to 0, one node at a time (this is to make sure that removal of the nodes do not impact the reliability of the cluster).</span></span>
    - <span data-ttu-id="baf01-191">**Для типа первичного узла:** рекомендуется не изменять номер SKU виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="baf01-191">**For the primary nodetype:** Our recommendation is that you do not change VM SKU of the primary node type.</span></span> <span data-ttu-id="baf01-192">Если причиной создания номера SKU является увеличение емкости, то мы рекомендуем добавить экземпляры или, если это возможно, создать новый кластер.</span><span class="sxs-lookup"><span data-stu-id="baf01-192">If the reason for the new SKU is capacity, we recommend adding more instances or if possible, create a new cluster.</span></span> <span data-ttu-id="baf01-193">Если у вас нет выбора, то внесите изменения в определение модели масштабируемого набора виртуальных машин, указав новую конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="baf01-193">If you have no choice, then make modifications to the Virtual Machine Scale Set Model definition to reflect the new SKU.</span></span> <span data-ttu-id="baf01-194">Если в кластере используется только один тип узла, то убедитесь, что все приложения с отслеживанием состояния своевременно реагируют на все [события жизненного цикла реплики службы](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (например, задержку сборки реплики) и длительность восстановления реплики службы не превышает пяти минут (для уровня устойчивости Silver).</span><span class="sxs-lookup"><span data-stu-id="baf01-194">If your cluster has only one nodetype, then make sure that all your stateful applications respond to all [Service replica lifecycle events](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (like replica in build is stuck) in a timely fashion and that your service replica rebuild duration is less than five minutes (for Silver durability level).</span></span> 


> [!WARNING]
> <span data-ttu-id="baf01-195">Изменять размер (номер SKU) виртуальной машины для масштабируемого набора виртуальных машин, для которого не используется по крайней мере устойчивость Silver, не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="baf01-195">Changing the VM SKU Size for VM Scale Sets not running at least Silver durability is not recommened.</span></span> <span data-ttu-id="baf01-196">Изменение размера (номера SKU) виртуальной машины — внутренняя операция инфраструктуры, которая может привести к потере данных.</span><span class="sxs-lookup"><span data-stu-id="baf01-196">Changing VM SKU Size is a data-destructive in-place infrastructure operation.</span></span> <span data-ttu-id="baf01-197">Без хоть какой-либо возможности отложить или отследить это изменение вероятна ситуация, в которой операция приведет к потере данных служб с отслеживанием состояния или вызовет другие непредвиденные проблемы в работе, даже для рабочих нагрузок без отслеживания состояния.</span><span class="sxs-lookup"><span data-stu-id="baf01-197">Without at least some ability to delay or monitor this change, it is possible that the operation can cause dataloss for stateful services or cause other unforseen operational issues, even for stateless workloads.</span></span> 
> 
    
3. <span data-ttu-id="baf01-198">Обеспечьте как минимум пять узлов для любого масштабируемого набора виртуальных машин с включенной функцией MR.</span><span class="sxs-lookup"><span data-stu-id="baf01-198">Maintain a minimum count of five nodes for any Virtual Machine Scale Set that has MR enabled</span></span>
4. <span data-ttu-id="baf01-199">Не удаляйте случайные экземпляры виртуальных машин. Всегда используйте функцию уменьшения масштаба масштабируемого набора виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="baf01-199">Do not delete random VM instances, always use Virtual Machine Scale Set scale down feature.</span></span> <span data-ttu-id="baf01-200">Удаление случайных экземпляров виртуальной машины может нарушить баланс в распределении экземпляров виртуальной машины в домене обновления и домене сбоя.</span><span class="sxs-lookup"><span data-stu-id="baf01-200">The deletion of random VM instances has a potential of creating imbalances in the VM instance spread across UD and FD.</span></span> <span data-ttu-id="baf01-201">Этот дисбаланс может негативно повлиять на возможность системы правильно распределять нагрузку между экземплярами служб или репликами служб.</span><span class="sxs-lookup"><span data-stu-id="baf01-201">This imbalance could adversely affect the systems ability to properly load balance amongst the service instances/Service replicas.</span></span>
6. <span data-ttu-id="baf01-202">При использовании автомасштабирования установите правила таким образом, чтобы свертывание (удаление экземпляров виртуальной машины) выполнялось одновременно только на одном узле.</span><span class="sxs-lookup"><span data-stu-id="baf01-202">If using Autoscale, then set the rules such that scale in (removing of VM instances) are done only one node at a time.</span></span> <span data-ttu-id="baf01-203">Одновременно уменьшать масштаб более одного экземпляра небезопасно.</span><span class="sxs-lookup"><span data-stu-id="baf01-203">Scaling down more than one instance at a time is not safe.</span></span>
7. <span data-ttu-id="baf01-204">При уменьшении масштаба типа первичного узла никогда не следует задавать значение ниже, чем допускается уровнем надежности.</span><span class="sxs-lookup"><span data-stu-id="baf01-204">If Scaling down a primary node type, you should never scale it down more than what the reliability tier allows.</span></span>


## <a name="the-reliability-characteristics-of-the-cluster"></a><span data-ttu-id="baf01-205">Характеристики надежности кластера</span><span class="sxs-lookup"><span data-stu-id="baf01-205">The reliability characteristics of the cluster</span></span>
<span data-ttu-id="baf01-206">Уровень надежности используется для задания числа реплик системных служб, которые будут выполняться в этом кластере на первичных узлах.</span><span class="sxs-lookup"><span data-stu-id="baf01-206">The reliability tier is used to set the number of replicas of the system services that you want to run in this cluster on the primary node type.</span></span> <span data-ttu-id="baf01-207">Чем больше реплик, тем надежнее системные службы в кластере.</span><span class="sxs-lookup"><span data-stu-id="baf01-207">The more the number of replicas, the more reliable the system services are in your cluster.</span></span>  

<span data-ttu-id="baf01-208">Уровень надежности может принимать следующие значения:</span><span class="sxs-lookup"><span data-stu-id="baf01-208">The reliability tier can take the following values:</span></span>

* <span data-ttu-id="baf01-209">Platinum: запуск системных служб с целевым набором из 9 реплик.</span><span class="sxs-lookup"><span data-stu-id="baf01-209">Platinum - Run the System services with a target replica set count of 9</span></span>
* <span data-ttu-id="baf01-210">Gold: запуск системных служб с целевым набором из 7 реплик.</span><span class="sxs-lookup"><span data-stu-id="baf01-210">Gold - Run the System services with a target replica set count of 7</span></span>
* <span data-ttu-id="baf01-211">Silver: запуск системных служб с целевым набором из 5 реплик.</span><span class="sxs-lookup"><span data-stu-id="baf01-211">Silver - Run the System services with a target replica set count of 5</span></span> 
* <span data-ttu-id="baf01-212">Bronze: запуск системных служб с целевым набором из 3 реплик.</span><span class="sxs-lookup"><span data-stu-id="baf01-212">Bronze - Run the System services with a target replica set count of 3</span></span>

> [!NOTE]
> <span data-ttu-id="baf01-213">Выбранный уровень надежности определяет минимальное количество узлов для типа первичного узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-213">The reliability tier you choose determines the minimum number of nodes your primary node type must have.</span></span> 
> 
> 


### <a name="recommendations-for-the-reliability-tier"></a><span data-ttu-id="baf01-214">Рекомендации по уровню надежности.</span><span class="sxs-lookup"><span data-stu-id="baf01-214">Recommendations for the reliability tier.</span></span>

 <span data-ttu-id="baf01-215">При увеличении или уменьшении размера кластера (суммы экземпляров виртуальных машин во всех типах узлов) необходимо изменить уровень надежности кластера с одного на другой.</span><span class="sxs-lookup"><span data-stu-id="baf01-215">When you increase or decrease the size of your cluster (the sum of VM instances in all node types), you must update the reliability of your cluster from one tier to another.</span></span> <span data-ttu-id="baf01-216">Это активирует обновления кластера, необходимые для изменения числа реплик системных служб.</span><span class="sxs-lookup"><span data-stu-id="baf01-216">Doing this triggers the cluster upgrades needed to change the system services replica set count.</span></span> <span data-ttu-id="baf01-217">Подождите, пока обновление не будет завершено, прежде чем вносить другие изменения в кластер, например добавлять узлы.</span><span class="sxs-lookup"><span data-stu-id="baf01-217">Wait for the upgrade in progress to complete before making any other changes to the cluster, like adding nodes.</span></span>  <span data-ttu-id="baf01-218">Ход выполнения обновления можно отслеживать в Service Fabric Explorer или с помощью командлета [Get-ServiceFabricClusterUpgrade](/powershell/module/servicefabric/get-servicefabricclusterupgrade?view=azureservicefabricps).</span><span class="sxs-lookup"><span data-stu-id="baf01-218">You can monitor the progress of the upgrade on Service Fabric Explorer or by running [Get-ServiceFabricClusterUpgrade](/powershell/module/servicefabric/get-servicefabricclusterupgrade?view=azureservicefabricps)</span></span>

<span data-ttu-id="baf01-219">Ниже приведены рекомендации по выбору уровня надежности.</span><span class="sxs-lookup"><span data-stu-id="baf01-219">Here is the recommendation on choosing the reliability tier.</span></span>

| <span data-ttu-id="baf01-220">**Размер кластера**</span><span class="sxs-lookup"><span data-stu-id="baf01-220">**Cluster Size**</span></span> | <span data-ttu-id="baf01-221">**Уровень надежности**</span><span class="sxs-lookup"><span data-stu-id="baf01-221">**Reliability Tier**</span></span> |
| --- | --- |
| <span data-ttu-id="baf01-222">1</span><span class="sxs-lookup"><span data-stu-id="baf01-222">1</span></span> |<span data-ttu-id="baf01-223">Не указывайте параметр уровня надежности, система рассчитает его сама</span><span class="sxs-lookup"><span data-stu-id="baf01-223">Do not specify the Reliability Tier parameter, the system calculates it</span></span> |
| <span data-ttu-id="baf01-224">3</span><span class="sxs-lookup"><span data-stu-id="baf01-224">3</span></span> |<span data-ttu-id="baf01-225">Bronze</span><span class="sxs-lookup"><span data-stu-id="baf01-225">Bronze</span></span> |
| <span data-ttu-id="baf01-226">5 или 6</span><span class="sxs-lookup"><span data-stu-id="baf01-226">5 or 6</span></span>|<span data-ttu-id="baf01-227">Silver</span><span class="sxs-lookup"><span data-stu-id="baf01-227">Silver</span></span> |
| <span data-ttu-id="baf01-228">7 или 8</span><span class="sxs-lookup"><span data-stu-id="baf01-228">7 or 8</span></span> |<span data-ttu-id="baf01-229">Gold</span><span class="sxs-lookup"><span data-stu-id="baf01-229">Gold</span></span> |
| <span data-ttu-id="baf01-230">9 и более</span><span class="sxs-lookup"><span data-stu-id="baf01-230">9 and up</span></span> |<span data-ttu-id="baf01-231">Platinum</span><span class="sxs-lookup"><span data-stu-id="baf01-231">Platinum</span></span> |




## <a name="primary-node-type---capacity-guidance"></a><span data-ttu-id="baf01-232">Рекомендации по загрузке для типа первичного узла</span><span class="sxs-lookup"><span data-stu-id="baf01-232">Primary node type - Capacity Guidance</span></span>

<span data-ttu-id="baf01-233">Ниже приведены рекомендации по планированию загрузки для типа первичного узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-233">Here is the guidance for planning the primary node type capacity</span></span>

1. <span data-ttu-id="baf01-234">**Количество экземпляров виртуальных машин для выполнения любой рабочей нагрузки в Azure:** необходимо указать минимальный размер для типа первичного узла, равный 5.</span><span class="sxs-lookup"><span data-stu-id="baf01-234">**Number of VM instances to run any production workload in Azure:** You must specify a minimum Primary Node type size of 5.</span></span> 
2. <span data-ttu-id="baf01-235">**Количество экземпляров виртуальных машин для запуска тестов рабочих нагрузок в Azure:** можно указать минимальный размер для типа первичного узла, равный 1 или 3.</span><span class="sxs-lookup"><span data-stu-id="baf01-235">**Number of VM instances to run test workloads in Azure** You can specify a minimum primary node type size of 1 or 3.</span></span> <span data-ttu-id="baf01-236">Одноузловой кластер работает со специальной конфигурацией, поэтому масштабирование этого кластера не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="baf01-236">The one node cluster, runs with a special configuration and so, scale out of that cluster is not supported.</span></span> <span data-ttu-id="baf01-237">Одноузловой кластер не является надежным, поэтому в шаблоне Resource Manager нужно удалить или не указывать эту конфигурацию (не задавать значение конфигурации будет недостаточно).</span><span class="sxs-lookup"><span data-stu-id="baf01-237">The one node cluster, has no reliability and so in your Resource Manager template, you have to remove/not specify that configuration (not setting the configuration value is not enough).</span></span> <span data-ttu-id="baf01-238">Если одноузловой кластер настраивается через портал, то конфигурация задается автоматически.</span><span class="sxs-lookup"><span data-stu-id="baf01-238">If you set up the one node cluster set up via portal, then the configuration is automatically taken care of.</span></span> <span data-ttu-id="baf01-239">Одно- и трехузловые кластеры не поддерживаются для выполнения производственных задач.</span><span class="sxs-lookup"><span data-stu-id="baf01-239">1 and 3 node clusters are not supported for running production workloads.</span></span> 
3. <span data-ttu-id="baf01-240">**Номер SKU виртуальной машины:** тип первичного узла используется для запуска системных служб, поэтому выбранный для него номер SKU виртуальной машины должен обеспечивать достаточно ресурсов для общей пиковой загрузки, которую вы планируете разместить в кластере.</span><span class="sxs-lookup"><span data-stu-id="baf01-240">**VM SKU:** Primary node type is where the system services run, so the VM SKU you choose for it, must take into account the overall peak load you plan to place into the cluster.</span></span> <span data-ttu-id="baf01-241">Чтобы пояснить, что имеется ввиду, приведу аналогию. Представьте, что тип первичного узла — ваши легкие, которые снабжают кислородом мозг. Поэтому, если мозг не получает достаточно кислорода, то тело страдает.</span><span class="sxs-lookup"><span data-stu-id="baf01-241">Here is an analogy to illustrate what I mean here - Think of the primary node type as your "Lungs", it is what provides oxygen to your brain, and so if the brain does not get enough oxygen, your body suffers.</span></span> 

<span data-ttu-id="baf01-242">Необходимая загрузка кластера определяется рабочей нагрузкой, которую планируется в нем выполнять. Поэтому мы не можем дать качественные рекомендации именно для вашей рабочей нагрузки, однако ниже приведены общие рекомендации, которые помогут приступить к работе.</span><span class="sxs-lookup"><span data-stu-id="baf01-242">Since the capacity needs of a cluster is determined by workload you plan to run in the cluster, we cannot provide you with qualitative guidance for your specific workload, however here is the broad guidance to help you get started</span></span>

<span data-ttu-id="baf01-243">Для производственных рабочих нагрузок</span><span class="sxs-lookup"><span data-stu-id="baf01-243">For production workloads</span></span> 


- <span data-ttu-id="baf01-244">Рекомендуемый номер SKU виртуальной машины — Standard D3, Standard D3_V2 или их аналог, обеспечивающий не менее 14 ГБ на локальном SSD.</span><span class="sxs-lookup"><span data-stu-id="baf01-244">The recommended VM SKU is Standard D3 or Standard D3_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span>
- <span data-ttu-id="baf01-245">Минимальный поддерживаемый номер SKU виртуальной машины — Standard D1, Standard D1_V2 или их аналог, обеспечивающий не менее 14 ГБ на локальном SSD.</span><span class="sxs-lookup"><span data-stu-id="baf01-245">The minimum supported use VM SKU is Standard D1 or Standard D1_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span> 
- <span data-ttu-id="baf01-246">Номера SKU виртуальных машин с неполным числом ядер (например, Standard A0) для производственных рабочих нагрузок не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="baf01-246">Partial core VM SKUs like Standard A0 are not supported for production workloads.</span></span>
- <span data-ttu-id="baf01-247">Номер SKU Standard A1 не поддерживается для производственных рабочих нагрузок по соображениям производительности.</span><span class="sxs-lookup"><span data-stu-id="baf01-247">Standard A1 SKU is not supported for production workloads for performance reasons.</span></span>


## <a name="non-primary-node-type---capacity-guidance-for-stateful-workloads"></a><span data-ttu-id="baf01-248">Рекомендации по производительности для рабочих нагрузок с отслеживанием состояния для прочих типов узлов</span><span class="sxs-lookup"><span data-stu-id="baf01-248">Non-Primary node type - Capacity Guidance for stateful workloads</span></span>

<span data-ttu-id="baf01-249">Эти рекомендации предназначены для рабочих нагрузок с отслеживанием состояния, использующих в Service Fabric интерфейсы [Reliable Collections или Reliable Actors](service-fabric-choose-framework.md), которые выполняются в типах узлов, не являющихся первичными.</span><span class="sxs-lookup"><span data-stu-id="baf01-249">This guidance is for stateful Workloads using Service fabric [reliable collections or reliable Actors](service-fabric-choose-framework.md) that you are running in the non-primary node type.</span></span>


<span data-ttu-id="baf01-250">**Количество экземпляров виртуальных машин:** рабочие нагрузки с отслеживанием состояния рекомендуется запускать как минимум на 5 репликах, задав это количество целевым.</span><span class="sxs-lookup"><span data-stu-id="baf01-250">**Number of VM instances:** For production workloads that are stateful, it is recommended that you run them with a minimum and target replica count of 5.</span></span> <span data-ttu-id="baf01-251">Это означает, что в стабильном состоянии в каждом домене сбоя и домене обновления будет по реплике (из набора реплик).</span><span class="sxs-lookup"><span data-stu-id="baf01-251">This means that in steady state you end up with a replica (from a replica set) in each fault domain and upgrade domain.</span></span> <span data-ttu-id="baf01-252">Весь принцип уровня надежности для типа первичного узла состоит в том, чтобы просто задать этот параметр для системных служб.</span><span class="sxs-lookup"><span data-stu-id="baf01-252">The whole reliability tier concept for the primary node type is a way to specify this setting for system services.</span></span> <span data-ttu-id="baf01-253">Та же рекомендация относится к службам с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="baf01-253">So the same consideration applies to your stateful services as well.</span></span>

<span data-ttu-id="baf01-254">Таким образом для производственных рабочих нагрузок минимальный рекомендуемый размер для типа узла, не являющегося первичным, равен 5, если этот тип используется для выполнения рабочих нагрузок с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="baf01-254">So for production workloads, the minimum recommended non-Primary Node type size is 5, if you are running stateful workloads in it.</span></span>


<span data-ttu-id="baf01-255">**Номер SKU виртуальной машины:** этот тип узла используется для выполнения служб приложения, поэтому выбранный для него номер SKU виртуальной машины должен обеспечивать достаточно ресурсов для общей пиковой загрузки, которую вы планируете разместить в каждом узле.</span><span class="sxs-lookup"><span data-stu-id="baf01-255">**VM SKU:** This is the node type where your application services are running, so the VM SKU you choose for it, must take into account the peak load you plan to place into each Node.</span></span> <span data-ttu-id="baf01-256">Необходимая загрузка для типа узла определяется рабочей нагрузкой, которую планируется выполнять в кластере. Поэтому мы не можем дать качественные рекомендации именно для вашей рабочей нагрузки, однако ниже приведены общие рекомендации, которые помогут приступить к работе.</span><span class="sxs-lookup"><span data-stu-id="baf01-256">The capacity needs of the nodetype, is determined by workload you plan to run in the cluster, so we cannot provide you with qualitative guidance for your specific workload, however here is the broad guidance to help you get started</span></span>

<span data-ttu-id="baf01-257">Для производственных рабочих нагрузок</span><span class="sxs-lookup"><span data-stu-id="baf01-257">For production workloads</span></span> 

- <span data-ttu-id="baf01-258">Рекомендуемый номер SKU виртуальной машины — Standard D3, Standard D3_V2 или их аналог, обеспечивающий не менее 14 ГБ на локальном SSD.</span><span class="sxs-lookup"><span data-stu-id="baf01-258">The recommended VM SKU is Standard D3 or Standard D3_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span>
- <span data-ttu-id="baf01-259">Минимальный поддерживаемый номер SKU виртуальной машины — Standard D1, Standard D1_V2 или их аналог, обеспечивающий не менее 14 ГБ на локальном SSD.</span><span class="sxs-lookup"><span data-stu-id="baf01-259">The minimum supported use VM SKU is Standard D1 or Standard D1_V2 or equivalent with a minimum of 14 GB of local SSD.</span></span> 
- <span data-ttu-id="baf01-260">Номера SKU виртуальных машин с неполным числом ядер (например, Standard A0) для производственных рабочих нагрузок не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="baf01-260">Partial core VM SKUs like Standard A0 are not supported for production workloads.</span></span>
- <span data-ttu-id="baf01-261">В частности, номер SKU Standard A1 не поддерживается для производственных рабочих нагрузок по соображениям производительности.</span><span class="sxs-lookup"><span data-stu-id="baf01-261">Standard A1 SKU is specifically not supported for production workloads for performance reasons.</span></span>


## <a name="non-primary-node-type---capacity-guidance-for-stateless-workloads"></a><span data-ttu-id="baf01-262">Рекомендации по производительности для рабочих нагрузок без отслеживания состояния для прочих типов узлов</span><span class="sxs-lookup"><span data-stu-id="baf01-262">Non-Primary node type - Capacity Guidance for stateless workloads</span></span>

<span data-ttu-id="baf01-263">Эти рекомендации предназначены для рабочих нагрузок без отслеживания состояния, которые выполняются в типах узлов, не являющихся первичными.</span><span class="sxs-lookup"><span data-stu-id="baf01-263">This guidance of stateless Workloads that you are running on the non-primary nodetype.</span></span>

<span data-ttu-id="baf01-264">**Количество экземпляров виртуальных машин:** для рабочих нагрузок без отслеживания состояния минимальное поддерживаемое количество для типа узла, не являющегося первичным, равно 2.</span><span class="sxs-lookup"><span data-stu-id="baf01-264">**Number of VM instances:** For production workloads that are stateless, the minimum supported non-Primary Node type size is 2.</span></span> <span data-ttu-id="baf01-265">Это дает возможность запустить два экземпляра приложения без отслеживания состояния и позволяет службе перенести потерю экземпляра виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="baf01-265">This allows you to run you two stateless instances of your application and allowing your service to survive the loss of a VM instance.</span></span> 

> [!NOTE]
> <span data-ttu-id="baf01-266">Если кластер работает в Service Fabric версии ниже 5.6, то из-за дефекта в среде выполнения (который исправлен в версии 5.6) масштабирование узла, не являющегося первичным, до числа реплик меньше 5 приводит к утрате работоспособности кластера, которая не восстановится, пока вы не выполните команду [Remove ServiceFabricNodeState cmd](https://docs.microsoft.com/powershell/servicefabric/vlatest/Remove-ServiceFabricNodeState), указав имя соответствующего узла.</span><span class="sxs-lookup"><span data-stu-id="baf01-266">If your cluster is running on a service fabric version less than 5.6, due to a defect in the runtime (this issue is fixed in 5.6), scaling down a non-primary node type to less than 5, results in cluster health turning unhealthy, till you call [Remove-ServiceFabricNodeState cmd](https://docs.microsoft.com/powershell/servicefabric/vlatest/Remove-ServiceFabricNodeState) with the appropriate node name.</span></span> <span data-ttu-id="baf01-267">Чтобы узнать больше, прочитайте раздел [Масштабирование кластера Service Fabric с помощью правил автомасштабирования](service-fabric-cluster-scale-up-down.md).</span><span class="sxs-lookup"><span data-stu-id="baf01-267">Read [perform Service Fabric cluster in or out](service-fabric-cluster-scale-up-down.md) for more details</span></span>
> 
>

<span data-ttu-id="baf01-268">**Номер SKU виртуальной машины:** этот тип узла используется для выполнения служб приложения, поэтому выбранный для него номер SKU виртуальной машины должен обеспечивать достаточно ресурсов для общей пиковой загрузки, которую вы планируете разместить в каждом узле.</span><span class="sxs-lookup"><span data-stu-id="baf01-268">**VM SKU:** This is the node type where your application services are running, so the VM SKU you choose for it, must take into account the peak load you plan to place into each Node.</span></span> <span data-ttu-id="baf01-269">Необходимая загрузка для типа узла определяется рабочей нагрузкой, которую планируется выполнять в кластере. Поэтому мы не можем дать качественные рекомендации именно для вашей рабочей нагрузки, однако ниже приведены общие рекомендации, которые помогут приступить к работе.</span><span class="sxs-lookup"><span data-stu-id="baf01-269">The capacity needs of the nodetype, is determined by workload you plan to run in the cluster, So we cannot provide you with qualitative guidance for your specific workload, however here is the broad guidance to help you get started</span></span>

<span data-ttu-id="baf01-270">Для производственных рабочих нагрузок</span><span class="sxs-lookup"><span data-stu-id="baf01-270">For production workloads</span></span> 


- <span data-ttu-id="baf01-271">Рекомендуемый номер SKU виртуальной машины — Standard D3, Standard D3_V2 или их аналог.</span><span class="sxs-lookup"><span data-stu-id="baf01-271">The recommended VM SKU is Standard D3 or Standard D3_V2 or equivalent.</span></span> 
- <span data-ttu-id="baf01-272">Минимальный поддерживаемый номер SKU виртуальной машины — Standard D1, Standard D1_V2 или их аналог.</span><span class="sxs-lookup"><span data-stu-id="baf01-272">The minimum supported use VM SKU is Standard D1 or Standard D1_V2 or equivalent.</span></span> 
- <span data-ttu-id="baf01-273">Номера SKU виртуальных машин с неполным числом ядер (например, Standard A0) для производственных рабочих нагрузок не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="baf01-273">Partial core VM SKUs like Standard A0 are not supported for production workloads.</span></span>
- <span data-ttu-id="baf01-274">Номер SKU Standard A1 не поддерживается для производственных рабочих нагрузок по соображениям производительности.</span><span class="sxs-lookup"><span data-stu-id="baf01-274">Standard A1 SKU is not supported for production workloads for performance reasons.</span></span>

<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->

## <a name="next-steps"></a><span data-ttu-id="baf01-275">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="baf01-275">Next steps</span></span>
<span data-ttu-id="baf01-276">Завершив планирование загрузки и настройку кластера, прочитайте следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="baf01-276">Once you finish your capacity planning and set up a cluster, read the following:</span></span>

* [<span data-ttu-id="baf01-277">Защита кластера Service Fabric</span><span class="sxs-lookup"><span data-stu-id="baf01-277">Service Fabric cluster security</span></span>](service-fabric-cluster-security.md)
* [<span data-ttu-id="baf01-278">Общие сведения о наблюдении за работоспособностью системы в Service Fabric</span><span class="sxs-lookup"><span data-stu-id="baf01-278">Service Fabric health model introduction</span></span>](service-fabric-health-introduction.md)
* [<span data-ttu-id="baf01-279">Связь между типами узлов Service Fabric и масштабируемыми наборами виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="baf01-279">Relationship of Nodetypes to Virtual machine scale set</span></span>](service-fabric-cluster-nodetypes.md)

<!--Image references-->
[SystemServices]: ./media/service-fabric-cluster-capacity/SystemServices.png
