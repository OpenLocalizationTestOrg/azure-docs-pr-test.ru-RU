---
title: "hello aaaPlanning емкость кластера Service Fabric | Документы Microsoft"
description: "Рекомендации по планированию загрузки кластера Service Fabric. NodeTypes, устойчивость и уровни надежности"
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: 4c584f4a-cb1f-400c-b61f-1f797f11c982
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/24/2017
ms.author: chackdan
ms.openlocfilehash: 83272ce7fefe698eef755cf66493c2874cc3b120
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-cluster-capacity-planning-considerations"></a>Рекомендации по планированию загрузки кластера Service Fabric
Для любой рабочей развернутой службы важным шагом является планирование загрузки. Вот некоторые из элементов hello наличие tooconsider в рамках этого процесса.

* номер узла Hello типы toostart кластера потребностей out с
* Hello свойства каждого типа узла (размер, основной сети Интернет, количество виртуальных машин и т. д.)
* Здравствуйте, надежность и устойчивость характеристики кластера hello

Кратко рассмотрим каждый из пунктов.

## <a name="hello-number-of-node-types-your-cluster-needs-toostart-out-with"></a>номер узла Hello типы toostart кластера потребностей out с
Во-первых, требуется toofigure какие hello кластера, вы создаете будет toobe для и определяет, какие типы приложений планирование toodeploy в этом кластере. Если не очистить на hello назначением кластера hello, вы скорее всего, еще не готовы процесс планирования емкости hello tooenter.

Установите номер hello типов узлов кластера должна toostart out с.  Каждый узел является сопоставленных tooa набора масштабирования виртуальных машин. Каждый тип узла поддерживает возможность независимого масштабирования, имеет разные наборы открытых портов и собственные метрики емкости. Поэтому решение hello hello числа типов узлов по существу сводится toohello следующие вопросы:

* Приложение имеет несколько служб, для них любой из них требуется открытый toobe или из Интернета? Обычно приложения содержат служба шлюза переднего плана, которая получает входные данные от клиента и один или несколько служб, взаимодействующих с hello службы интерфейса. Поэтому в этом случае требуется как минимум два типа узлов.
* У служб (составляющих приложение) различные требования к инфраструктуре, например больше ОЗУ или тактов центрального процессора? Например предположим, требуется toodeploy содержит службы интерфейса и внутренняя служба приложения hello. Hello переднего плана, можно запустить службу на более мелкие ВМ (размеры виртуальных Машин как D2), быть toohello открыты порты Интернета.  Hello внутренней службы, однако вычисления интенсивно использующих и потребностей toorun на больше виртуальных машин (с размеры виртуальных Машин как D15 D4 D6,), не internet обращен.
  
  В этом примере несмотря на то, что вы можете tooput все hello служб на один узел типа, рекомендуется разместить их в кластере с двумя типами узлов.  Это позволяет для каждого узла типа toohave различные свойства, такие как подключение к Интернету или размер виртуальной Машины. Hello число виртуальных машин может масштабироваться независимо друг от друга, а также.  
* Поскольку нельзя предсказать будущие hello, переход с фактов, которые известны и принять решение о hello число типов узлов, которые приложения должны toostart с. Вы всегда сможете добавить или удалить типы узлов позже. У кластера Service Fabric должен быть по крайней мере один тип узла.

## <a name="hello-properties-of-each-node-type"></a>Hello свойства каждого типа узла
Hello **тип узла** можно рассматривать как эквивалент tooroles в облачных службах. Типы узлов определяют размеры виртуальных Машин hello, hello число виртуальных машин и их свойства. Каждый тип узла, определенный в кластере Service Fabric, настроен как отдельный набор масштабирования виртуальных машин. Набор масштабирования виртуальной машины — это ресурс вычислений Azure, вы можете использовать toodeploy и управлять коллекции виртуальных машин в качестве набора. Будучи определенным как отдельный набор масштабирования виртуальных машин, каждый тип узла поддерживает возможность независимого масштабирования, имеет разные наборы открытых портов и собственные метрики загрузки.

Чтение [в этом документе](service-fabric-cluster-nodetypes.md) Дополнительные сведения о связи hello Nodetypes toovirtual машины масштабного набора как tooRDP в один из экземпляров Привет открыть новые порты и т. д.

Кластер может иметь более одного типа узла, но тип основного узла hello (hello первое заданное вами на портале hello) должен иметь по крайней мере пять виртуальных машин для кластеров, используемые для рабочих нагрузок (или по крайней мере три виртуальные машины для теста кластеров). Если вы создаете с помощью шаблона диспетчера ресурсов кластера hello, искать **является основным** атрибута в разделе определения типа узла hello. Тип основного узла Hello — тип узла hello там, где размещены службы system Service Fabric.  

### <a name="primary-node-type"></a>Тип первичного узла
Кластер с несколькими типами узлов необходимо toochoose один из них toobe первичной. Ниже приведены характеристики hello тип основного узла.

* Hello **минимальный размер виртуальных машин** тип основного узла hello определяется hello **уровень устойчивости** выборе. по умолчанию Hello hello уровень устойчивости, бронза. Прокрутите страницу вниз, сведения о какой уровень устойчивости hello и значения hello он может занять.  
* Hello **минимальное число виртуальных машин** тип основного узла hello определяется hello **уровень надежности** выборе. по умолчанию Hello hello уровень надежности, серебряный. Прокрутите страницу вниз, сведения о какой уровень надежности hello и значения hello он может занять. 


* Hello Service Fabric системных служб (например, службы диспетчера кластеров hello или службы хранилища образов) помещаются в тип основного узла hello и поэтому hello надежность и устойчивость hello кластера определяется hello уровня значение и устойчивость уровень надежности значение, выбираемые для hello тип основного узла.

![Снимок экрана с двумя типами узлов ][SystemServices]

### <a name="non-primary-node-type"></a>Тип вторичного узла
Кластер с несколькими типами узлов есть один тип основного узла и неосновной rest hello из них. Ниже приведены характеристики типа узла неосновной hello.

* Минимальный размер виртуальных машин для данного типа узла Hello определяется уровень устойчивости hello выбрать. по умолчанию Hello hello уровень устойчивости, бронза. Прокрутите страницу вниз, сведения о какой уровень устойчивости hello и значения hello он может занять.  
* Hello минимальное число виртуальных машин для данного типа узла может быть один. Однако следует выбирать это число в зависимости от числа hello реплик hello приложений или служб, желательно toorun в этот тип узла. После развертывания кластера hello можно увеличить Hello число виртуальных машин в тип узла.

## <a name="hello-durability-characteristics-of-hello-cluster"></a>характеристики устойчивых Hello hello кластера
уровень устойчивости Hello имеет права доступа hello используется tooindicate toohello системы, виртуальные машины с базовой инфраструктуры Azure hello. В типе основного узла hello оно позволяет toopause Service Fabric запрос уровня инфраструктуры виртуальной Машины (таких как перезагрузка виртуальной Машины, повторное создание образа виртуальной Машины или миграцию виртуальной Машины), который влияет hello кворума требования для hello системных служб и служб с отслеживанием состояния. В типы узлов неосновной hello данное право доступа позволяет toopause Service Fabric любой виртуальной Машины уровня инфраструктуры запросов, например перезагрузка виртуальной Машины, повторное создание образа виртуальной Машины, миграцию виртуальной Машины и т.д., которые влияют на требования hello кворума для служб с отслеживанием состояния в нем.

Эта привилегия представляется в формате hello следующие значения:

* Золотой - задания может быть приостановлена в течение двух часов в UD инфраструктура hello. Устойчивость Gold можно включить только для номеров SKU виртуальных машин полных узлов, например D15_V2, G5 и т. д.
* Серебряный - hello инфраструктуры задания может быть приостановлена и длительностью 10 минут на UD и доступна на всех стандартных виртуальных машин из одного ядра и более поздних версий.
* Bronze: привилегии отсутствуют. Это значение по умолчанию hello. Используйте этот уровень устойчивости только для типов узлов, на которых выполняются _только_ рабочие нагрузки без учета состояния. 

> [!WARNING]
> Типы узлов, выполняющиеся с устойчивостью Bronze, _не получают привилегий_. Это означает, что задания инфраструктуры, которые влияют рабочие нагрузки без отслеживания состояния, не будут остановлены или отложены. Возможно, такие задания все же будут влиять на ваши рабочие нагрузки, приводя к простою или другим проблемам. Для выполнения любого вида производственной рабочей нагрузки рекомендуется использовать по крайней мере устойчивость Silver. 
> 

Получить уровень надежности toochoose для каждого из типов узлов. Можно выбрать один тип узла toohave уровень устойчивости золотом или silver и других hello имеет бронза в hello одного кластера. **Необходимо поддерживать минимальное число 5 узлов для узла типа, который имеет устойчивость Gold или silver**. 

**Преимущества использования уровней устойчивости Silver или Gold**
 
1. Уменьшает количество hello действия в операции масштабирования (то есть узел деактивация и удаление ServiceFabricNodeState вызывается автоматически)
2. Уменьшает hello риск потери данных из-за tooa инициирована клиентом на месте SKU ВМ операции изменения или операций инфраструктуры Azure.
     
**Недостатки использования уровней устойчивости Silver или Gold**
 
1. Tooyour развертываний набора масштабирования виртуальных машин и других связанных ресурсов Azure) может быть отложено, может истечь время или может быть заблокирован полностью проблем в кластере или на уровне инфраструктуры hello. 
2. Здравствуйте, увеличивается число [события жизненного цикла реплики](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle ) (например, основной операции замены) из-за tooautomated деактивации узла во время операций инфраструктуры Azure.

### <a name="recommendations-on-when-toouse-silver-or-gold-durability-levels"></a>Рекомендации по toouse серебряные и золотые уровни устойчивости

Используйте серебряные и золотые устойчивости для все типы узлов с отслеживанием состояния, узел службы вы ожидали увидеть в tooscale (уменьшить число экземпляров виртуальных Машин) часто, и вы хотите использовать, что операции развертывания быть задержана пользу упрощение этих операций масштабирования в. сценарии масштабирования Hello (добавление экземпляров виртуальных машин) не воспроизводятся в выборе hello уровень устойчивости, только в шкалы не.

### <a name="operational-recommendations-for-hello-node-type-that-you-have-set-toosilver-or-gold-durability-level"></a>Оперативной рекомендации для hello узла типа, который установлен toosilver или gold устойчивость уровня.

1. Сохранить кластера и приложений работоспособном состоянии постоянно и убедитесь в том, что приложения отвечают tooall [события жизненного цикла реплики службы](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (например, реплика в построении застряла) в течение отведенного времени.
2. Принять более безопасных способов toomake изменение SKU ВМ (масштабирования вверх или вниз): изменение hello SKU виртуальной Машины набора масштабирования виртуальных машин является потенциально небезопасные операции и поэтому следует избегать по возможности. Далее описывается процесс hello, можно выполнить tooavoid распространенных проблем.
    - **Для nodetypes неосновной:** рекомендуется создать новый набор масштабирования виртуальных машин, изменить hello службы размещения tooinclude hello новый узел набора масштабирования виртуальных машин тип ограничения и затем сокращают hello, старый набор масштабирования виртуальных машин экземпляр счетчика too0, один узел одновременно (это toomake том, что удаление узлов hello не оказывают влияния на надежность hello hello кластера).
    - **Для первичного nodetype hello:** рекомендуется не изменять номера SKU hello тип основного узла виртуальной Машины. Если hello причина для hello новая Конфигурация имеет емкость, мы рекомендуем добавить дополнительные экземпляры или по возможности создайте новый кластер. Если у вас нет выбора, внесите изменения модели набора масштабирования виртуальной машины toohello определение tooreflect hello новая Конфигурация. Если кластер имеет только один тип узла, убедитесь, что все приложения с отслеживанием состояния отвечать tooall [события жизненного цикла реплики службы](service-fabric-reliable-services-advanced-usage.md#stateful-service-replica-lifecycle) (например, реплика в построении застряла) с в отведенное время и что перестроить реплики вашей службы Продолжительность составляет менее пяти минут (уровень устойчивости серебряный). 


> [!WARNING]
> Изменение hello размер виртуальной Машины SKU для набора масштабирования виртуальных Машин не работает по крайней мере серебристом устойчивость не рекомендуется. Изменение размера (номера SKU) виртуальной машины — внутренняя операция инфраструктуры, которая может привести к потере данных. Без хотя бы некоторые возможности toodelay или монитор это изменение возможна, hello операции можно вызвать dataloss для служб с отслеживанием состояния или других непредвиденных проблемы в работе, даже без отслеживания состояния рабочих нагрузок. 
> 
    
3. Обеспечьте как минимум пять узлов для любого масштабируемого набора виртуальных машин с включенной функцией MR.
4. Не удаляйте случайные экземпляры виртуальных машин. Всегда используйте функцию уменьшения масштаба масштабируемого набора виртуальных машин. Удаление Hello случайных экземпляров виртуальной Машины имеет потенциально создания ставит в экземпляре виртуальной Машины hello распределены UD и FD. Это дисбаланс может негативно повлиять на балансировку нагрузки tooproperly возможности систем hello среди реплик экземпляров или службы для службы hello.
6. Если с помощью автоматического масштабирования, задайте правила hello таким образом, что масштаб (удаление экземпляров виртуальной Машины) выполняются одновременно только один узел. Одновременно уменьшать масштаб более одного экземпляра небезопасно.
7. При масштабировании с уменьшением тип основного узла, вы никогда не должны масштабировать работу более чем позволяет какой уровень надежности hello.


## <a name="hello-reliability-characteristics-of-hello-cluster"></a>Здравствуйте, надежность характеристики кластера hello
Hello уровень надежности используется tooset hello количество реплик hello системных служб, которые должны toorun в этом кластере на тип основного узла hello. Здравствуйте, дополнительные hello число реплик, hello надежнее hello системные службы находятся в кластере.  

уровень надежности Hello может принимать следующие значения hello.

* Platinum - выполнения hello системных служб и целевой реплики набора число 9
* Золотой - выполнения hello системных служб и целевой реплики набора число 7
* Серебряный - выполнения hello системных служб и целевой реплики набора число 5 
* Бронзовый - выполнения hello системных служб и целевой реплики набора число 3

> [!NOTE]
> уровень надежности Hello выбранного определяет hello минимальное число узлов, которые должны быть типа первичного узла. 
> 
> 


### <a name="recommendations-for-hello-reliability-tier"></a>Рекомендации для уровня надежности hello.

 При увеличении или уменьшении hello размер кластера (sum hello экземпляров виртуальной Машины во всех типах узла), необходимо обновить кластер из одного уровня tooanother надежность hello. Это запускает hello обновления необходимые toochange hello системы служб реплики набора числа кластеров. Дождитесь обновления hello в toocomplete выполняется перед выполнением других кластера toohello изменения, такие как добавление узлов.  Можно отслеживать ход hello hello обновления Service Fabric Explorer или выполняется [Get ServiceFabricClusterUpgrade](/powershell/module/servicefabric/get-servicefabricclusterupgrade?view=azureservicefabricps)

Вот hello рекомендации по выбору hello уровень надежности.

| **Размер кластера** | **Уровень надежности** |
| --- | --- |
| 1 |Не указывайте Здравствуйте параметр уровень надежности, он вычисляется hello системы |
| 3 |Bronze |
| 5 или 6|Silver |
| 7 или 8 |Gold |
| 9 и более |Platinum |




## <a name="primary-node-type---capacity-guidance"></a>Рекомендации по загрузке для типа первичного узла

Вот hello руководство по планированию емкости тип основного узла hello

1. **Количество виртуальных Машин экземпляров toorun любой рабочей нагрузки в Azure:** необходимо указать минимальный размер типа первичного узла 5. 
2. **Количество виртуальных Машин экземпляров toorun тестовые нагрузки в Azure** можно указать размер типа минимальное основного узла 1 или 3. Здравствуйте одного узла кластера, запуск с помощью специальной настройки и поэтому, масштаб из этого кластера не поддерживается. Hello одного узла кластера, содержит не надежность и поэтому в шаблоне диспетчера ресурсов имеется tooremove или не указывать этой конфигурации (не Установка значения конфигурации hello недостаточно). Если вы настроили Привет одному узлу кластера, настроить через портал, а затем hello конфигурации будет автоматически решать. Одно- и трехузловые кластеры не поддерживаются для выполнения производственных задач. 
3. **Конфигурация виртуальной Машины:** тип основного узла работает где hello системных служб, поэтому hello SKU ВМ, выберите для него, необходимо взять в учетной записи hello в целом пиковых загрузить вы планирование tooplace в кластер hello. Вот tooillustrate аналогию, что я имею в виду-считать тип основного узла hello вашей «легких» является содержание кислорода tooyour мозг и поэтому если мозг hello не получает достаточно кислорода, теле подвергается атаке. 

Поскольку потребностей в емкости hello кластера определяется рабочей нагрузки планирование toorun в кластере hello, мы не можем предоставить вам качественное рекомендации для конкретной рабочей нагрузки, однако здесь toohelp hello широкий руководства вам начать работу

Для производственных рабочих нагрузок 


- Hello рекомендуемая Конфигурация виртуальной Машины — это стандартная D3 Стандартная D3_V2 или эквивалент с не менее 14 ГБ локальный SSD.
- Минимальная Hello поддерживается SKU ВМ используется стандартная D1 или стандартный D1_V2 или в эквивалентной с не менее 14 ГБ локальный SSD. 
- Номера SKU виртуальных машин с неполным числом ядер (например, Standard A0) для производственных рабочих нагрузок не поддерживаются.
- Номер SKU Standard A1 не поддерживается для производственных рабочих нагрузок по соображениям производительности.


## <a name="non-primary-node-type---capacity-guidance-for-stateful-workloads"></a>Рекомендации по производительности для рабочих нагрузок с отслеживанием состояния для прочих типов узлов

Это руководство предназначено для рабочих нагрузок с отслеживанием состояния, с помощью Service fabric [надежного коллекции или службы reliable Actor](service-fabric-choose-framework.md) используемой неосновной узел типа hello.


**Количество экземпляров виртуальных машин:** рабочие нагрузки с отслеживанием состояния рекомендуется запускать как минимум на 5 репликах, задав это количество целевым. Это означает, что в стабильном состоянии в каждом домене сбоя и домене обновления будет по реплике (из набора реплик). Концепция уровня целиком надежность Hello для типа первичного узла hello является toospecify способом этот параметр для системных служб. Так же hello соображения tooyour служб с отслеживанием состояния также.

Таким образом для рабочих нагрузок размера типа hello минимальный рекомендуемый не - основного узла — 5, при выполнении рабочих нагрузок с отслеживанием состояния в нем.


**Конфигурация виртуальной Машины:** это тип узла hello запущенным служб приложения, поэтому hello SKU ВМ выберите для него, необходимо учитывать пиковой нагрузки hello учетной записи вы планирование tooplace в каждом узле. Здравствуйте потребностях hello nodetype, определяется рабочей нагрузки плана toorun в кластере hello, поэтому мы не можем предоставить вам качественное рекомендации для конкретной рабочей нагрузки, однако Вот toohelp hello широкий руководства вам начать работу

Для производственных рабочих нагрузок 

- Hello рекомендуемая Конфигурация виртуальной Машины — это стандартная D3 Стандартная D3_V2 или эквивалент с не менее 14 ГБ локальный SSD.
- Минимальная Hello поддерживается SKU ВМ используется стандартная D1 или стандартный D1_V2 или в эквивалентной с не менее 14 ГБ локальный SSD. 
- Номера SKU виртуальных машин с неполным числом ядер (например, Standard A0) для производственных рабочих нагрузок не поддерживаются.
- В частности, номер SKU Standard A1 не поддерживается для производственных рабочих нагрузок по соображениям производительности.


## <a name="non-primary-node-type---capacity-guidance-for-stateless-workloads"></a>Рекомендации по производительности для рабочих нагрузок без отслеживания состояния для прочих типов узлов

Это руководство без отслеживания состояния рабочих нагрузок, выполняющихся на неосновной nodetype hello.

**Количество экземпляров виртуальных Машин:** для рабочих нагрузок, которые не имеют состояния, минимальное hello поддерживается без основной узел типа размер равен 2. Это позволяет toorun вы два без сохранения состояния экземпляра приложения и позволяя вашей службы toosurvive hello потери экземпляр виртуальной Машины. 

> [!NOTE]
> Если кластер работает под управлением структуры обновления меньше, чем 5.6, из-за tooa дефект в hello среды выполнения (эта проблема исправлена в 5.6), масштабирование вниз сборки типа узла неосновной больше 5, приведет к работоспособности кластера Включение неработоспособен, пока не вызывается [ Удаление ServiceFabricNodeState cmd](https://docs.microsoft.com/powershell/servicefabric/vlatest/Remove-ServiceFabricNodeState) с именем hello соответствующего узла. Чтобы узнать больше, прочитайте раздел [Масштабирование кластера Service Fabric с помощью правил автомасштабирования](service-fabric-cluster-scale-up-down.md).
> 
>

**Конфигурация виртуальной Машины:** это тип узла hello запущенным служб приложения, поэтому hello SKU ВМ выберите для него, необходимо учитывать пиковой нагрузки hello учетной записи вы планирование tooplace в каждом узле. Здравствуйте потребностях hello nodetype, определяется рабочей нагрузки плана toorun в кластере hello, поэтому мы не можем предоставить вам качественное рекомендации для конкретной рабочей нагрузки, однако Вот toohelp hello широкий руководства вам начать работу

Для производственных рабочих нагрузок 


- Hello рекомендуемые SKU ВМ — Стандартная D3 или стандартный D3_V2 или наличие эквивалентных прав. 
- Минимальная Hello поддерживается SKU ВМ используется стандартная D1 или стандартный D1_V2 или наличие эквивалентных прав. 
- Номера SKU виртуальных машин с неполным числом ядер (например, Standard A0) для производственных рабочих нагрузок не поддерживаются.
- Номер SKU Standard A1 не поддерживается для производственных рабочих нагрузок по соображениям производительности.

<!--Every topic should have next steps and links toohello next logical set of content tookeep hello customer engaged-->

## <a name="next-steps"></a>Дальнейшие действия
После завершения планирования емкости и настроить кластер чтения hello следующее:

* [Защита кластера Service Fabric](service-fabric-cluster-security.md)
* [Общие сведения о наблюдении за работоспособностью системы в Service Fabric](service-fabric-health-introduction.md)
* [Установите связь между масштабирования машины tooVirtual Nodetypes](service-fabric-cluster-nodetypes.md)

<!--Image references-->
[SystemServices]: ./media/service-fabric-cluster-capacity/SystemServices.png
