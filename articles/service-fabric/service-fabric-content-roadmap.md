---
title: "Описание Azure Service Fabric | Документация Майкрософт"
description: "Основные понятия и аспекты Azure Service Fabric. Эта статья предоставляет расширенные сведения о Service Fabric и создании микрослужб."
services: service-fabric
documentationcenter: .net
author: rwike77
manager: timlt
editor: 
ms.assetid: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 12/08/2017
ms.author: ryanwi
ms.openlocfilehash: 9360d29eb30171651b0bcc688fe7884614b50cf4
ms.sourcegitcommit: a5f16c1e2e0573204581c072cf7d237745ff98dc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2017
---
# <a name="so-you-want-to-learn-about-service-fabric"></a>Что бы вы хотели узнать о Service Fabric?
Azure Service Fabric — это платформа распределенных систем, которая дает возможность не только легко упаковывать и развертывать масштабируемые и надежные микрослужбы, но и управлять ими.  Service Fabric имеет большую контактную зону и вы можете многому научиться.  Здесь представлен краткий обзор Service Fabric и описаны основные понятия, модели программирования, жизненный цикл приложения, тестирование, кластеры и мониторинг работоспособности. Обзор и сведения о том, как создавать микрослужбы с помощью Service Fabric, см. в статьях [Общие сведения о Service Fabric](service-fabric-overview.md) и [Разработка приложений с использованием микрослужб](service-fabric-overview-microservices.md). Эта статья не содержит полный список связанной документации, но предоставляет ссылки на руководства по началу работы для каждой области Service Fabric. 

## <a name="core-concepts"></a>Ключевые понятия
Разделы [Терминология Service Fabric](service-fabric-technical-overview.md), [Модель приложения](service-fabric-application-model.md) и [Поддерживаемые модели программирования](service-fabric-choose-framework.md) содержат дополнительные понятия и их описание, но основы приведены в этой статье.

<table><tr><th>Ключевые понятия</th><th>Время разработки</th><th>Во время выполнения</th></tr>
<tr><td><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tbuZM46yC_5206218965">
<img src="./media/service-fabric-content-roadmap/CoreConceptsVid.png" WIDTH="240" HEIGHT="162"></a></td>
<td><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tlkI046yC_2906218965"><img src="./media/service-fabric-content-roadmap/RunTimeVid.png" WIDTH="240" HEIGHT="162"></a></td>
<td><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=x7CVH56yC_1406218965">
<img src="./media/service-fabric-content-roadmap/RunTimeVid.png" WIDTH="240" HEIGHT="162"></a></td></tr>
</table>

### <a name="design-time-application-type-service-type-application-package-and-manifest-service-package-and-manifest"></a>Время разработки: тип приложения, тип службы, пакет приложения и манифест, пакет службы и манифест
Тип приложения — имя и версия, назначенные коллекции типов служб. Это определяется в файле *ApplicationManifest.xml*, внедренном в каталог пакета приложения. Затем пакет приложения копируется в хранилище образов кластера Service Fabric. Вы сможете создать именованное приложение этого типа для запуска в кластере. 

Тип службы — имя и версия, назначенные пакетам кода, пакетам данных и пакетам конфигурации службы. Это определяется в файле ServiceManifest.xml, внедренном в каталог пакета службы. Затем на каталог пакета службы ссылается файл *ApplicationManifest.xml* пакета приложения. Создав именованное приложение, вы можете создать в кластере именованную службу, используя для этого один из типов служб соответствующего типа приложения. Тип службы описывается в файле *ServiceManifest.xml*. Он состоит из параметров конфигурации службы исполняемого кода, которые загружаются во время выполнения, и статических данных, которые используются этой службой.

![Типы служб и типы приложений Service Fabric][cluster-imagestore-apptypes]

Пакет приложения — это каталог на диске, содержащий файл *ApplicationManifest.xml* типа приложения, который ссылается на пакеты службы для каждого типа службы, входящего в тип приложения. Например, пакет почтового приложения может содержать ссылки на пакет службы очередей, пакет службы внешнего интерфейса и пакет службы базы данных. Файлы в каталоге пакета приложения копируются в хранилище образов кластера Service Fabric. 

Пакет службы — каталог на диске, содержащий файл *ServiceManifest.xml* типа службы, который ссылается на код, статические данные и пакеты конфигурации для типа службы. На файлы в каталоге пакета службы ссылается файл *ApplicationManifest.xml* для соответствующего типа приложения. Например, в пакете службы могут быть указаны ссылки на пакеты кода, статических данных и конфигураций, определяющие службу баз данных.

### <a name="run-time-clusters-and-nodes-named-applications-named-services-partitions-and-replicas"></a>Время выполнения: кластеры и узлы, именованные приложения, именованные службы, секции и реплики
[Кластер Service Fabric](service-fabric-deploy-anywhere.md) — это подключенный к сети набор виртуальных машин или физических компьютеров, в котором вы развертываете микрослужбы и управляете ими. Кластеры можно масштабировать до нескольких тысяч машин.

Узлом называется компьютер или виртуальная машина, которая входит в состав кластера. Каждому узлу назначается имя (строка). Узлы имеют свои характеристики, в частности свойства размещения. Каждый компьютер или виртуальная машина имеет автоматически запускаемую службу Windows, `FabricHost.exe`. Она запускается после загрузки системы и запускает два исполняемых файла: `Fabric.exe` и `FabricGateway.exe`. Эти два файла формируют узел. В сценариях разработки или тестирования на одном компьютере или виртуальной машине можно разместить несколько узлов, запустив несколько экземпляров `Fabric.exe` и `FabricGateway.exe`.

Именованное приложение представляет собой коллекцию составляющих его именованных служб, которые выполняют определенные функции. Служба выполняет завершенную и отдельную функцию (она может запускаться и работать независимо от других служб) и состоит из кода, конфигурации и данных. Когда пакет приложения будет скопирован в хранилище образов, вы сможете создать в кластере экземпляр приложения. Для этого нужно указать тип приложения в пакете приложения (имя и версию). Каждому экземпляру приложения этого типа назначается универсальный код ресурса (URI), который выглядит следующим образом: *fabric:/MyNamedApp*. Из одного типа приложения в кластере можно создать несколько именованных приложений. Именованные приложения можно также создавать из разных типов приложений. Для каждого именованного приложения управление и контроль версий выполняются отдельно.

Создав именованное приложение, вы можете создать в кластере экземпляр одной из его служб определенного типа (именованную службу), используя для этого соответствующий тип службы (имя и версию). Каждому экземпляру службы определенного типа назначается код URI, частью которого будет URI именованного приложения. Например, если в именованном приложении MyNamedApp вы создадите именованную службу MyDatabase, ее универсальный код ресурса (URI) будет выглядеть так: *fabric:/MyNamedApp/MyDatabase*. В именованном приложении можно создать одну или несколько именованных служб. У каждой именованной службы может быть своя схема секционирования и свое количество реплик и экземпляров. 

Существуют два типа службы: с отслеживанием состояния и без него. Службы без отслеживания состояния могут сохранять устойчивое состояние во внешней службе хранилища, например в службе хранилища Azure, базе данных SQL Azure или Azure Cosmos DB. Службу без отслеживания состояния следует использовать, когда у службы нет постоянного хранилища. Служба с отслеживанием состояния используется, когда нужно, чтобы платформа Service Fabric управляла состоянием службы через модели программирования Reliable Collections или Reliable Actors. 

При создании именованной службы указывается схема секционирования. Службы с большим количеством состояний разделяют данные по секциям. Каждая секция отвечает за часть полного состояния службы. Эти секции распределены между узлами кластера.  

На следующей диаграмме отображается отношение между приложениями и экземплярами службы, разделами и репликами.

![Разделы и реплики в службе][cluster-application-instances]

### <a name="partitioning-scaling-and-availability"></a>Секционирование, масштабирование и доступность
[Секционирование](service-fabric-concepts-partitioning.md) не является уникальной особенностью Service Fabric. Распространенный пример секционирования — это секционирование данных или сегментирование. Службы с отслеживанием состояния с большим количеством состояний разделяют данные по секциям. Каждая секция отвечает за часть полного состояния службы. 

Реплики каждой секции распределяются по узлам в кластере. Это позволяет состоянию именованной службы [масштабироваться](service-fabric-concepts-scalability.md). По мере роста объема данных размер секций увеличивается, и Service Fabric перераспределяет секции между узлами для максимально эффективного использования аппаратных ресурсов. Если вы добавите новые узлы в кластер, реплики секции подвергнутся повторной балансировке с учетом этих узлов. Общая производительность приложения улучшится, а конфликт доступа к памяти уменьшится. При неэффективном использовании узлов в кластере вы можете уменьшить их количество. Service Fabric снова перераспределит реплики секции по меньшему количеству узлов, чтобы эффективно использовать оборудование на каждом узле.

В пределах одной секции именованные службы без отслеживания состояния хранят экземпляры, а именованные службы с отслеживанием состояния — реплики. Как правило, именованные службы без отслеживания состояния используют только одну секцию, так как у них нет внутреннего состояния. Экземпляры в секциях обеспечивают [доступность](service-fabric-availability-services.md). Если один экземпляр выходит из строя, другие продолжают работать обычным образом, а Service Fabric создает новый экземпляр. Именованные службы с отслеживанием состояния хранят сведения о своем состоянии в репликах, и у каждой секции есть свой набор реплик. Операции чтения и записи выполняются в одной реплике (которая называется первичной). Изменения в состоянии, вызванные операциями записи, реплицируются на множество других реплик (которые называются активными вторичными репликами). Если в реплике возникает сбой, Service Fabric создает новую реплику из существующих.

## <a name="stateless-and-stateful-microservices-for-service-fabric"></a>Микрослужбы Service Fabric с отслеживанием и без отслеживания состояния
Service Fabric позволяет создавать приложения, состоящие из микрослужб или контейнеров. Микрослужбы без отслеживания состояния (протоколы шлюзов, веб-прокси и т. д.) не поддерживают изменяемые состояния без обработки запроса службой. К службам без отслеживания состояния можно отнести рабочие роли в облачных службах Azure. Микрослужбы с отслеживанием состояния (учетные записи пользователей, базы данных, устройства, корзины интернет-магазинов, очереди и т. д.) поддерживают изменяемые достоверные состояния без обработки запроса службой. Современные веб-приложения могут одновременно содержать микрослужбы с отслеживанием состояния и без него. 

Ключевое отличие Service Fabric — активная ориентация на создание служб с отслеживанием состояния на основе [встроенных моделей программирования ](service-fabric-choose-framework.md) или контейнерных служб с отслеживанием состояния. В [сценариях приложений](service-fabric-application-scenarios.md) описаны ситуации, в которых используются службы с отслеживанием состояния.

Зачем существуют микрослужбы с отслеживанием состояния наряду с микрослужбами без отслеживания состояния? Основных преимуществ два.

* Вы можете создавать службы оперативной обработки транзакций (OLTP) с высокой пропускной способностью, низкой задержкой и хорошей отказоустойчивостью, размещая программы и данные рядом на одной виртуальной машине. В качестве примеров таких служб можно привести онлайн-магазины, службы поиска, системы Интернета вещей, торговые системы, системы обработки кредитных карт и обнаружения мошенничества, а также службы управления персональными данными.
* Вы можете упростить разработку приложений. Микрослужбы с отслеживанием состояния устраняют необходимость в дополнительных очередях и кэшах, которые обычно требуются для обеспечения доступности и минимизации задержек в приложениях без отслеживания состояния. Для служб с отслеживанием состояния изначально характерны высокая доступность и минимальные задержки, поэтому приложением в целом будет проще управлять.

## <a name="supported-programming-models"></a>Поддерживаемые модели программирования
Service Fabric предлагает несколько способов записи и управления службами. Службы могут использовать API-интерфейсы платформы Service Fabric, чтобы в полной мере использовать компоненты платформы и платформы приложений. Службы также могут представлять любую скомпилированную исполняемую программу, написанную на любом языке и размещенную в кластере Service Fabric. Дополнительные сведения см. в разделе [Поддерживаемые модели программирования](service-fabric-choose-framework.md).

### <a name="containers"></a>Контейнеры
По умолчанию Service Fabric развертывает и активирует службы как процессы. Service Fabric также позволяет развертывать службы в [контейнерах](service-fabric-containers-overview.md). Главное, что вы можете объединять эти два подхода, используя в одном приложении службы с процессами и контейнерами. Service Fabric поддерживает развертывание контейнеров Linux и контейнеров Windows на Windows Server 2016. В контейнерах можно развернуть имеющиеся приложения, службы без отслеживания состояния или службы с отслеживанием состояния. 

### <a name="reliable-services"></a>Надежные службы
[Reliable Services](service-fabric-reliable-services-introduction.md) — это облегченная платформа для записи служб, которые интегрируются с платформой Service Fabric и используют весь набор функций платформы. Службы Reliable Services могут быть без отслеживания состояния, как и большинство платформ служб, таких как веб-серверы или рабочие роли в облачных службах Azure. При этом состояние сохраняется во внешнем решении, таком как база данных Azure или хранилище таблиц Azure. Службы Reliable Services могут также быть с отслеживанием состояния. При этом состояние сохраняется прямо в службу с использованием Reliable Collections. Состояние становится [высокодоступным](service-fabric-availability-services.md) за счет репликации и распределения путем [секционирования](service-fabric-concepts-partitioning.md), которыми автоматически управляет Service Fabric.

### <a name="reliable-actors"></a>Надежные субъекты
Платформа [Reliable Actor](service-fabric-reliable-actors-introduction.md), построенная на базе Reliable Services, представляет собой платформу приложений, реализующую модель Virtual Actor на основе шаблона проектирования субъектов. Платформа надежных субъектов использует независимые единицы вычислений и состояний с однопоточным выполнением, которые называются субъектами. Платформа надежных субъектов обеспечивает встроенное взаимодействие для субъектов, а также предустановленное сохранение состояния и масштабируемые конфигурации.

### <a name="aspnet-core"></a>ASP.NET Core;
Service Fabric интегрируется с [ASP.NET Core](service-fabric-reliable-services-communication-aspnetcore.md) в качестве модели программирования первого класса для создания веб-приложений и приложений API.  ASP.NET Core можно использовать двумя различными способами в Service Fabric:

- Разместить в виде гостевого исполняемого файла. В основном это используется для запуска существующих приложений ASP.NET Core в Service Fabric без изменения кода.
- Выполнить в службе Reliable Service. Это обеспечивает более эффективную интеграцию со средой выполнения Service Fabric и позволяет использовать службы ASP.NET Core с отслеживанием состояния.

### <a name="guest-executables"></a>Гостевые исполняемые файлы
[Гостевой исполняемый файл](service-fabric-deploy-existing-app.md) — это произвольный существующий исполняемый файл (написанный на любом языке), который размещен в кластере Service Fabric среди других служб. Гостевые исполняемые файлы не интегрируются с интерфейсами API Service Fabric напрямую. Однако они по-прежнему используют преимущества предлагаемых платформой функций, такие как настраиваемые отчеты о работоспособности и загрузке, а также возможности обнаружения службы путем вызова REST API. Они также имеют поддержку полного жизненного цикла приложения. 

## <a name="application-lifecycle"></a>Жизненный цикл приложения
Как и в случае с другими платформами, приложение в Service Fabric обычно проходит следующие фазы: проектирование, разработка, тестирование, развертывание, обновление, техническое обслуживание и удаление. Service Fabric предоставляет первоклассную поддержку полного жизненного цикла приложений в облаке: от разработки, развертывания, ежедневного управления и технического обслуживания до вывода приложения из эксплуатации. Модель службы использует несколько различных ролей для независимого участия в жизненном цикле приложения. [Жизненный цикл приложения в Service Fabric](service-fabric-application-lifecycle.md) представляет обзор интерфейсов API, а также их использование различными ролями на протяжении всех фаз жизненного цикла приложения в Service Fabric. 

Жизненный цикл всего приложения можно управлять при помощи [командлеты PowerShell](/powershell/module/ServiceFabric/), [команды CLI](service-fabric-sfctl.md), [C# API-интерфейсы](/dotnet/api/system.fabric.fabricclient.applicationmanagementclient), [API-интерфейсы Java](/java/api/system.fabric._application_management_client), и [ API-интерфейс REST](/rest/api/servicefabric/). Вы также можете настроить конвейеры непрерывной интеграции и разработки с помощью средств [Visual Studio Team Services](service-fabric-set-up-continuous-integration.md) или [Jenkins](service-fabric-cicd-your-linux-applications-with-jenkins.md).

В следующем видео от Академии Microsoft Virtual Academy также описывается процесс управления жизненным циклом приложения: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=My3Ka56yC_6106218965">
<img src="./media/service-fabric-content-roadmap/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center>

## <a name="test-applications-and-services"></a>Тестирование приложений и служб
Чтобы создать службы именно в масштабах облака, очень важно, чтобы приложения и службы были устойчивы к реальным сбоям. Служба анализа сбоев предназначена для проверки служб, созданных на платформе Service Fabric. Вместе с [Fault Analysis Service](service-fabric-testability-overview.md) она позволяет вызывать значимые ошибки и запускать в приложениях тестовые сценарии. Вызываемые ошибки и сценарии позволяют воспроизвести и проверить в контролируемых, безопасных и согласованных условиях разные состояния и переходы, происходящие со службой в течение ее жизненного цикла.

[Действия](service-fabric-testability-actions.md) выполняются в службе для ее тестирования с использованием отдельных ошибок. Разработчик службы может использовать их в качестве стандартных блоков для создания сложных сценариев. Ниже приведены примеры моделирования ошибок.

* Перезапустите узел для моделирования любого количества ситуаций, в которых выполняется перезагрузка компьютера или виртуальной машины.
* Переместите реплики службы с отслеживанием состояния для имитации балансировки нагрузки, отработки отказа или обновления приложения.
* Вызовите потерю кворума в службе с отслеживанием состояния, чтобы создать ситуацию, в которой операции записи невозможны, так как отсутствуют "резервные" или "вторичные" реплики, необходимые для приема новых данных.
* Вызовите потерю данных в службе с отслеживанием состояния, чтобы создать ситуацию, в которой все данные о состоянии в памяти полностью уничтожаются.

[Сценарии](service-fabric-testability-scenarios.md) — это сложные операции, состоящие из одного или нескольких действий. Служба анализа сбоев включает два полных встроенных сценария:

* [Сценарий хаотического тестирования](service-fabric-controlled-chaos.md) моделирует в кластере непрерывные сбои, чередуя как нормальные, так и ненормальные ошибки, на протяжении долгого периода времени.
* [Сценарий отработки отказа](service-fabric-testability-scenarios.md#failover-test) — это версия сценария хаотического тестирования, предназначенная для конкретной секции службы, при котором другие службы не затрагиваются.

## <a name="clusters"></a>Кластеры
[Кластер Service Fabric](service-fabric-deploy-anywhere.md) — это подключенный к сети набор виртуальных машин или физических компьютеров, в котором вы развертываете микрослужбы и управляете ими. Кластеры можно масштабировать до нескольких тысяч машин. Узлом кластера называется компьютер или виртуальная машина, которая входит в состав кластера. Каждому узлу назначается имя (строка). Узлы имеют свои характеристики, в частности свойства размещения. У каждого компьютера или виртуальной машины есть автоматически запускаемая служба `FabricHost.exe`. Она запускается после загрузки системы и запускает два исполняемых файла: Fabric.exe и FabricGateway.exe. Эти два файла формируют узел. В целях тестирования на одном компьютере или виртуальной машине можно разместить несколько узлов, запустив несколько экземпляров `Fabric.exe` и `FabricGateway.exe`.

Кластеры Service Fabric можно создать на виртуальных или физических компьютерах под управлением Windows Server или Linux. Вы можете развертывать и запускать приложения Service Fabric в любой среде с набором подключенных друг к другу компьютеров под управлением Windows Server или Linux как локально, так и в облаке Microsoft Azure или другого поставщика облачных служб.

Кластеры Service Fabric представлены в следующем видео Microsoft Virtual Academy: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tbuZM46yC_5206218965">
<img src="./media/service-fabric-content-roadmap/ClusterOverview.png" WIDTH="360" HEIGHT="244">
</a></center>

### <a name="clusters-on-azure"></a>Кластеры в Azure
Выполнение кластеров Service Fabric в Azure обеспечивает интеграцию с другими функциями и службами Azure, благодаря чему эксплуатировать кластер и управлять им проще и надежнее. Так как кластер является ресурсом Azure Resource Manager, вы можете моделировать его, как и любой другой ресурс в Azure. Resource Manager также предоставляет простое управление всеми ресурсами, которые кластер использует как единое целое. В Azure возможна интеграция кластеров с системой диагностики Azure и Log Analytics. Типы узлов кластера являются [масштабируемыми наборами виртуальных машин](/azure/virtual-machine-scale-sets/index), поэтому функция автомасштабирования является встроенной.

Вы можете создать кластер в Azure на [портале Azure](service-fabric-cluster-creation-via-portal.md) с помощью [шаблона](service-fabric-cluster-creation-via-arm.md) или [Visual Studio](service-fabric-cluster-creation-via-visual-studio.md).

Service Fabric для Linux дает возможность создавать, развертывать высокодоступные приложения с высокой масштабируемостью и управлять ими в Linux так же, как и в Windows. Платформы Service Fabric (Reliable Services и Reliable Actors) в Linux доступны для программирования на языках Java и C# (.NET Core). Также можно создавать [гостевые исполняемые службы](service-fabric-deploy-existing-app.md) , используя любой язык или платформу. Также поддерживается оркестрация контейнеров Docker. В контейнерах Docker могут выполняться гостевые исполняемые файлы или собственные службы Service Fabric, использующие платформы Service Fabric. Чтобы узнать больше, прочитайте о [Service Fabric в Azure](service-fabric-deploy-anywhere.md).

Некоторые функции Service Fabric поддерживаются в Windows, но не поддерживаются в Linux. Дополнительные сведения см. в статье [Различия между Service Fabric для Linux (предварительная версия) и Windows (общедоступная версия)](service-fabric-linux-windows-differences.md).

### <a name="standalone-clusters"></a>Изолированные кластеры
Для Service Fabric предусмотрен пакет установки, с помощью которого можно создать автономный кластер Service Fabric в локальной среде и у любого поставщика облачных служб. Автономные кластеры можно размещать в любом расположении. Если данные ограничены нормативными требованиями или вы хотите хранить их локально, вы можете разместить собственный кластер и приложения. Приложения Service Fabric можно запускать в различных средах размещения без изменений, так что знания о создании приложений сохраняют свою актуальность при переходе из одной среды размещения в другую. 

[Создание первого изолированного кластера Service Fabric](service-fabric-get-started-standalone-cluster.md)

Автономные кластеры Linux пока не поддерживаются.

### <a name="cluster-security"></a>Безопасность кластера
Кластеры должны быть защищены для предотвращения подключения к ним неавторизованных пользователей, особенно в тех случаях, когда на кластере выполняются рабочие нагрузки в рабочей среде. Существует возможность создания незащищенного кластера, однако стоит учитывать, что это позволит анонимным пользователям подключаться к нему, если конечные точки управления общедоступны через Интернет. Вы не сможете включить безопасность для незащищенного кластера через некоторое время, так как ее можно включить только в процессе создания кластера.

Сценарии обеспечения безопасности кластера:
* безопасность обмена данными между узлами;
* безопасность обмена данными между клиентами и узлами;
* Управление доступом на основе ролей (RBAC)

Дополнительные сведения см. в статье [Сценарии защиты кластера Service Fabric](service-fabric-cluster-security.md).

### <a name="scaling"></a>Масштабирование
Если вы добавите новые узлы в кластер, реплики секции подвергнутся повторной балансировке Service Fabric с учетом этих узлов. Общая производительность приложения улучшится, а конфликт доступа к памяти уменьшится. При неэффективном использовании узлов в кластере вы можете уменьшить их количество. Service Fabric снова перераспределит реплики и экземпляры секции по меньшему количеству узлов, чтобы эффективно использовать оборудование на каждом узле. Кластеры в Azure можно масштабировать [вручную](service-fabric-cluster-scale-up-down.md) или [программным способом](service-fabric-cluster-programmatic-scaling.md). Автономные кластеры можно масштабировать [вручную](service-fabric-cluster-windows-server-add-remove-nodes.md).

### <a name="cluster-upgrades"></a>Обновления кластера
Периодически выпускаются новые версии среды выполнения Service Fabric. При запуске среды выполнения или Service Fabric кластер обновляется, так что вы всегда используете [поддерживаемую версию](service-fabric-support.md). Кроме обновлений Service Fabric вы можете также обновить конфигурацию кластера, например сертификаты или порты приложения.

Кластер Service Fabric представляет собой ресурс, который принадлежит вам, но частично управляется корпорацией Майкрософт. Корпорация Майкрософт отвечает за исправления базовой операционной системы и обновления Service Fabric в кластере. Вы можете настроить для кластера автоматическое обновление Service Fabric по мере выпуска новых версий корпорацией Майкрософт или же выбрать нужную версию в списке поддерживаемых. Обновления Service Fabric и конфигурации можно настроить с помощью портала Azure или Resource Manager. Дополнительные сведения см. в статье [Обновление кластера Azure Service Fabric](service-fabric-cluster-upgrade.md). 

Автономный кластер является ресурсом, который полностью принадлежит вам. Вы отвечаете за исправления базовой операционной системы и запуск обновлений Service Fabric. Если кластер может подключиться к [https://www.microsoft.com/download](https://www.microsoft.com/download), вы можете настроить автоматическое скачивание и подготовку нового пакета среды выполнения Service Fabric. Затем можно инициировать само обновление. Если же кластер не может получить доступ к [https://www.microsoft.com/download](https://www.microsoft.com/download), вы можете вручную скачать новый пакет среды выполнения, используя компьютер с доступом к Интернету, а затем запустить обновление. Дополнительные сведения см. в статье [Обновление автономного кластера Azure Service Fabric в Windows Server](service-fabric-cluster-upgrade-windows-server.md).

## <a name="health-monitoring"></a>Мониторинг работоспособности
В Service Fabric представлена [модель работоспособности](service-fabric-health-introduction.md), которая предназначена для обозначения условий неработоспособности кластеров или приложений в отдельных сущностях (например, узлах кластера и репликах служб). В этой модели используются информаторы о работоспособности (системные компоненты и устройства наблюдения). Их целью является простая и быстрая диагностика и восстановление. Создатели службы должны предупреждать проблемы работоспособности и [создавать отчеты о состоянии](service-fabric-report-health.md#design-health-reporting). Любые условия, которые могут повлиять на работоспособность, должны регистрироваться, особенно в случаях, если это может помочь выяснить причину возникновения проблем. Когда система будет настроена и запущена в рабочей среде, получаемая информация о работоспособности позволит сэкономить время и усилия, требуемые для анализа и отладки.

Докладчики Service Fabric отслеживают определенные условия. Они сообщают об этих условиях на основе своего локального представления. В [хранилище данных о работоспособности](service-fabric-health-introduction.md#health-store) собираются данные о работоспособности, отправленные всеми информаторами, что помогает определять глобальную работоспособность сущностей. Модель оптимизирована, она гибкая и простая в использовании. Качество отчетов о работоспособности определяет точность представления данных о работоспособности кластера. Ложные положительные результаты, которые неправильно отображают проблемы работоспособности, могут отрицательно повлиять на обновления или другие службы, использующие данные о работоспособности. В качестве примеров можно вспомнить службы восстановления и механизмы предупреждений. Поэтому нужно тщательно обдумать, как получить отчеты с отображением только нужных условий.

Отчет можно создать с помощью приведенных ниже компонентов.
* Отслеживаемая реплика службы Service Fabric или ее экземпляр.
* Внутренние устройства наблюдения, развернутые как служба Service Fabric (например, служба без отслеживания состояния Service Fabric, которая проверяет условия и формирует отчеты). Модули наблюдения можно развернуть на всех узлах или сгруппировать с отслеживаемой службой.
* Внутренние устройства наблюдения, которые запускаются на узлах Service Fabric, но не реализованы как службы Service Fabric.
* Внешние устройства наблюдения, которые зондируют ресурс за пределами кластера Service Fabric (например, служба отслеживания Gomez и другие).

Готовые к использованию компоненты Service Fabric поддерживают создание отчетов о работоспособности по всем сущностям в кластере. [В отчетах о работоспособности системы](service-fabric-understand-and-troubleshoot-with-system-health-reports.md) отражаются показатели функциональности кластеров и приложений, а также отмечаются проблемы с работоспособностью. Что касается приложений и служб, отчеты о работоспособности системы проверяют правильность реализации и поведения сущностей на уровне среды выполнения Service Fabric. Отчеты не обеспечивают отслеживание работоспособности бизнес-логики службы или обнаружение зависших процессов. Чтобы добавить сведения о работоспособности конкретно для логики вашей службы, ознакомьтесь со статьей о [добавлении настраиваемых отчетов о работоспособности Service Fabric](service-fabric-report-health.md).

Service Fabric предоставляет несколько способов [просмотра отчетов о работоспособности](service-fabric-view-entities-aggregated-health.md), объединенных в хранилище данных о работоспособности.
* [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md) или другие средства визуализации;
* Запросов о работоспособности (через [PowerShell](/powershell/module/ServiceFabric/), [CLI](service-fabric-sfctl.md), [API-интерфейсы для C# FabricClient](/dotnet/api/system.fabric.fabricclient.healthclient) и [API-интерфейсы Java FabricClient](/java/api/system.fabric._health_client), или [REST API-интерфейсы](/rest/api/servicefabric)).
* Общие запросы, возвращающее список сущностей, которые имеют работоспособности в качестве одного из свойств (с помощью PowerShell, CLI, API-интерфейсы или REST).

В следующем видеоролике Microsoft Virtual Academy рассматривается модель работоспособности Service Fabric и принципы ее использования: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tevZw56yC_1906218965">
<img src="./media/service-fabric-content-roadmap/HealthIntroVid.png" WIDTH="360" HEIGHT="244">
</a></center>

## <a name="monitoring-and-diagnostics"></a>Мониторинг и диагностика.
[Мониторинг и диагностика](service-fabric-diagnostics-overview.md) крайне важны для разработки, тестирования и развертывания приложений и служб в любой среде. Оптимальная работа решений Service Fabric зависит от эффективного планирования и реализации мониторинга и диагностики, которые помогают обеспечить правильную работу приложений и служб в локальной среде разработки или в производственной среде.

Основные цели мониторинга и диагностики:

- обнаружение и диагностика проблем с оборудованием и инфраструктурой;
- выявление проблем с программным обеспечением и приложениями, а также сокращение времени простоя служб;
- анализ потребления ресурсов и помощь в принятии решений, связанных с выполнением операций;
- оптимизация производительности приложений, служб и инфраструктуры;
- создание бизнес-аналитики и определение областей для оптимизации.
 
Общий рабочий процесс мониторинга и диагностики состоит из трех этапов.

1. Генерирование событий: события (журналов, трассировок, пользовательские события) в нем инфраструктуры (кластер), платформы и уровень приложений / служба
2. Статистическая обработка событий: созданные события должны быть собираются и статистически обрабатываются, прежде чем они могут быть показаны
3. Анализ: события должны быть Визуализированный и доступен в некоторых формате, чтобы разрешить для анализа и при необходимости отображать

Доступны разные продукты с поддержкой этих трех областей, и вы можете использовать разные инструменты для реализации каждого из этапов. Дополнительные сведения см. в статье [наблюдения и диагностики для Azure Service Fabric](service-fabric-diagnostics-overview.md).

## <a name="next-steps"></a>Дальнейшие действия
* Узнайте, как создать [кластер в Azure](service-fabric-cluster-creation-via-portal.md) или [автономный кластер в Windows](service-fabric-cluster-creation-for-windows-server.md).
* Попробуйте создать службу с помощью модели программирования [Reliable Services](service-fabric-reliable-services-quick-start.md) или [Reliable Actors](service-fabric-reliable-actors-get-started.md).
* Узнайте, [как выполнять миграцию из облачных служб](service-fabric-cloud-services-migration-differences.md).
* Научитесь [отслеживать и диагностировать состояние служб](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md). 
* Узнайте [о тестировании приложений и служб](service-fabric-testability-overview.md).
* Ознакомьтесь со сведениями [об оркестрации ресурсов кластера и управлении ими](service-fabric-cluster-resource-manager-introduction.md).
* Просмотрите [примеры кода для Service Fabric](http://aka.ms/servicefabricsamples).
* Узнайте о [вариантах поддержки Service Fabric](service-fabric-support.md).
* Просматривайте статьи и обновления в [блоге группы разработчиков](https://blogs.msdn.microsoft.com/azureservicefabric/).


[cluster-application-instances]: media/service-fabric-content-roadmap/cluster-application-instances.png
[cluster-imagestore-apptypes]: ./media/service-fabric-content-roadmap/cluster-imagestore-apptypes.png
