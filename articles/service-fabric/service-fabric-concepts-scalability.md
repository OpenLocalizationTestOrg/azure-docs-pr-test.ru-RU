---
title: "Масштабируемость служб Service Fabric | Документация Майкрософт"
description: "Описывает процесс выполнения служб структурой служб"
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: ed324f23-242f-47b7-af1a-e55c839e7d5d
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: e2dd48341499b18ebd1433611063746e95a5ac62
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="scaling-in-service-fabric"></a><span data-ttu-id="1b1a8-103">Масштабирование в Service Fabric</span><span class="sxs-lookup"><span data-stu-id="1b1a8-103">Scaling in Service Fabric</span></span>
<span data-ttu-id="1b1a8-104">Azure Service Fabric упрощает создание масштабируемых приложений, обеспечивая управление службами, секциями и репликами на узлах кластера.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-104">Azure Service Fabric makes it easy to build scalable applications by managing the services, partitions, and replicas on the nodes of a cluster.</span></span> <span data-ttu-id="1b1a8-105">Выполнение множества рабочих нагрузок на одном и том же оборудовании обеспечивает не только максимальное использование ресурсов, но и гибкость в выборе способа масштабирования рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-105">Running many workloads on the same hardware enables maximum resource utilization, but also provides flexibility in terms of how you choose to scale your workloads.</span></span> 

<span data-ttu-id="1b1a8-106">В Service Fabric масштабирования осуществляется несколькими способами:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-106">Scaling in Service Fabric is accomplished several different ways:</span></span>

1. <span data-ttu-id="1b1a8-107">масштабирование путем создания или удаления экземпляров службы без отслеживания состояния;</span><span class="sxs-lookup"><span data-stu-id="1b1a8-107">Scaling by creating or removing stateless service instances</span></span>
2. <span data-ttu-id="1b1a8-108">масштабирование путем создания или удаления новых именованных служб;</span><span class="sxs-lookup"><span data-stu-id="1b1a8-108">Scaling by creating or removing new named services</span></span>
3. <span data-ttu-id="1b1a8-109">масштабирование путем создания или удаления новых именованных экземпляров приложений;</span><span class="sxs-lookup"><span data-stu-id="1b1a8-109">Scaling by creating or removing new named application instances</span></span>
4. <span data-ttu-id="1b1a8-110">масштабирование с использованием секционированных служб;</span><span class="sxs-lookup"><span data-stu-id="1b1a8-110">Scaling by using partitioned services</span></span>
5. <span data-ttu-id="1b1a8-111">масштабирование путем добавления и удаления узлов кластера;</span><span class="sxs-lookup"><span data-stu-id="1b1a8-111">Scaling by adding and removing nodes from the cluster</span></span> 
6. <span data-ttu-id="1b1a8-112">масштабирование с помощью метрик диспетчера кластерных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-112">Scaling by using Cluster Resource Manager metrics</span></span>

## <a name="scaling-by-creating-or-removing-stateless-service-instances"></a><span data-ttu-id="1b1a8-113">Масштабирование путем создания или удаления экземпляров службы без отслеживания состояния</span><span class="sxs-lookup"><span data-stu-id="1b1a8-113">Scaling by creating or removing stateless service instances</span></span>
<span data-ttu-id="1b1a8-114">Один из самых простых способов масштабирования в Service Fabric применяется для служб без отслеживания состояния.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-114">One of the simplest ways to scale within Service Fabric works with stateless services.</span></span> <span data-ttu-id="1b1a8-115">При создании службы без отслеживания состояния вы получаете возможность определить `InstanceCount`.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-115">When you create a stateless service, you get a chance to define an `InstanceCount`.</span></span> <span data-ttu-id="1b1a8-116">`InstanceCount` определяет, сколько работающих копий кода этой службы создается при ее запуске.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-116">`InstanceCount` defines how many running copies of that service's code are created when the service starts up.</span></span> <span data-ttu-id="1b1a8-117">Предположим, например, что в кластере имеется 100 узлов.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-117">Let's say, for example, that there are 100 nodes in the cluster.</span></span> <span data-ttu-id="1b1a8-118">Предположим также, что служба создается с параметром `InstanceCount`, равным 10.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-118">Let's also say that a service is created with an `InstanceCount` of 10.</span></span> <span data-ttu-id="1b1a8-119">Во время выполнения все эти 10 работающих копий кода могут стать слишком нагруженными (или недостаточно нагруженными).</span><span class="sxs-lookup"><span data-stu-id="1b1a8-119">During runtime, those 10 running copies of the code could all become too busy (or could be not busy enough).</span></span> <span data-ttu-id="1b1a8-120">Один из способов масштабирования рабочей нагрузки — изменение количества экземпляров.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-120">One way to scale that workload is to change the number of instances.</span></span> <span data-ttu-id="1b1a8-121">Например, некоторые части кода мониторинга и управления могут изменить существующее число экземпляров на 50 или 5 экземпляров в зависимости от того, следует ли свернуть или развернуть рабочую нагрузку в соответствии с нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-121">For example, some piece of monitoring or management code can change the existing number of instances to 50, or to 5, depending on whether the workload needs to scale in or out based on the load.</span></span> 

<span data-ttu-id="1b1a8-122">C#:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-122">C#:</span></span>

```csharp
StatelessServiceUpdateDescription updateDescription = new StatelessServiceUpdateDescription(); 
updateDescription.InstanceCount = 50;
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="1b1a8-123">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-123">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateless -ServiceName $serviceName -InstanceCount 50
```
### <a name="using-dynamic-instance-count"></a><span data-ttu-id="1b1a8-124">Использование динамического числа экземпляров</span><span class="sxs-lookup"><span data-stu-id="1b1a8-124">Using Dynamic Instance Count</span></span>
<span data-ttu-id="1b1a8-125">Специально для служб без отслеживания состояния Service Fabric предлагает автоматическое изменение количества экземпляров.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-125">Specifically for stateless services, Service Fabric offers an automatic way to change the instance count.</span></span> <span data-ttu-id="1b1a8-126">Это обеспечивает динамическое масштабирование службы в пределах доступных узлов.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-126">This allows the service to scale dynamically with the number of nodes that are available.</span></span> <span data-ttu-id="1b1a8-127">Чтобы использовать такой режим, следует задать число экземпляров, равное -1.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-127">The way to opt into this behavior is to set the instance count = -1.</span></span> <span data-ttu-id="1b1a8-128">InstanceCount = -1 является инструкцией для Service Fabric, которая предписывает запуск службы без отслеживания состояния на каждом узле.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-128">InstanceCount = -1 is an instruction to Service Fabric that says "Run this stateless service on every node."</span></span> <span data-ttu-id="1b1a8-129">При изменении количества узлов Service Fabric автоматически изменяет число экземпляров соответствующим образом, чтобы служба выполнялась на всех действительных узлах.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-129">If the number of nodes changes, Service Fabric automatically changes the instance count to match, ensuring that the service is running on all valid nodes.</span></span> 

<span data-ttu-id="1b1a8-130">C#:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-130">C#:</span></span>

```csharp
StatelessServiceDescription serviceDescription = new StatelessServiceDescription();
//Set other service properties necessary for creation....
serviceDescription.InstanceCount = -1;
await fc.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="1b1a8-131">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-131">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName -Stateless -PartitionSchemeSingleton -InstanceCount "-1"
```

## <a name="scaling-by-creating-or-removing-new-named-services"></a><span data-ttu-id="1b1a8-132">масштабирование путем создания или удаления новых именованных служб;</span><span class="sxs-lookup"><span data-stu-id="1b1a8-132">Scaling by creating or removing new named services</span></span>
<span data-ttu-id="1b1a8-133">Именованный экземпляр службы представляет собой экземпляр определенного типа службы (см. статью [Жизненный цикл приложения Service Fabric](service-fabric-application-lifecycle.md)) в каком-либо именованном экземпляре приложения в кластере.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-133">A named service instance is a specific instance of a service type (see [Service Fabric application life cycle](service-fabric-application-lifecycle.md)) within some named application instance in the cluster.</span></span> 

<span data-ttu-id="1b1a8-134">Новые именованные экземпляры службы могут создаваться (или удаляться) при повышении (или снижении) нагрузки службы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-134">New named service instances can be created (or removed) as services become more or less busy.</span></span> <span data-ttu-id="1b1a8-135">Это позволяет распределять запросы между несколькими экземплярами службы, что, как правило, дает возможность снизить нагрузку существующих служб.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-135">This allows requests to be spread across more service instances, usually allowing load on existing services to decrease.</span></span> <span data-ttu-id="1b1a8-136">При создании служб диспетчер кластерных ресурсов Service Fabric распределяет их по кластеру.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-136">When creating services, the Service Fabric Cluster Resource Manager places the services in the cluster in a distributed fashion.</span></span> <span data-ttu-id="1b1a8-137">Точные решения о размещении определяются [метриками](service-fabric-cluster-resource-manager-metrics.md) в кластере и другими правилами размещения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-137">The exact decisions are governed by the [metrics](service-fabric-cluster-resource-manager-metrics.md) in the cluster and other placement rules.</span></span> <span data-ttu-id="1b1a8-138">Службы могут быть созданы несколькими способами, однако чаще всего они создаются с помощью административных действий, таких как вызов [`New-ServiceFabricService`](https://docs.microsoft.com/en-us/powershell/module/servicefabric/new-servicefabricservice?view=azureservicefabricps), или кода, вызывающего [`CreateServiceAsync`](https://docs.microsoft.com/en-us/dotnet/api/system.fabric.fabricclient.servicemanagementclient.createserviceasync?view=azure-dotnet).</span><span class="sxs-lookup"><span data-stu-id="1b1a8-138">Services can be created several different ways, but the most common are either through administrative actions like someone calling [`New-ServiceFabricService`](https://docs.microsoft.com/en-us/powershell/module/servicefabric/new-servicefabricservice?view=azureservicefabricps), or by code calling [`CreateServiceAsync`](https://docs.microsoft.com/en-us/dotnet/api/system.fabric.fabricclient.servicemanagementclient.createserviceasync?view=azure-dotnet).</span></span> <span data-ttu-id="1b1a8-139">`CreateServiceAsync` можно даже вызвать из других служб, выполняющихся в кластере.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-139">`CreateServiceAsync` can even be called from within other services running in the cluster.</span></span>

<span data-ttu-id="1b1a8-140">Динамическое создание служб можно использовать во всех видах сценариев, это общепринятая практика.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-140">Creating services dynamically can be used in all sorts of scenarios, and is a common pattern.</span></span> <span data-ttu-id="1b1a8-141">Например, рассмотрим службу с отслеживанием состояния, которая представляет определенный рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-141">For example, consider a stateful service that represents a particular workflow.</span></span> <span data-ttu-id="1b1a8-142">К этой службе будут поступать вызовы, представляющие работу, и она будет выполнять действия рабочего процесса и записывать ход выполнения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-142">Calls representing work are going to show up to this service, and this service is going to execute the steps to that workflow and record progress.</span></span> 

<span data-ttu-id="1b1a8-143">Как же масштабировать эту службу?</span><span class="sxs-lookup"><span data-stu-id="1b1a8-143">How would you make this particular service scale?</span></span> <span data-ttu-id="1b1a8-144">Служба может быть мультитенантной, она может принимать вызовы и одновременно выполнять действия для многих экземпляров одного рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-144">The service could be multi-tenant in some form, and accept calls and kick off steps for many different instances of the same workflow all at once.</span></span> <span data-ttu-id="1b1a8-145">Тем не менее, это может усложнить код, так как теперь необходимо контролировать несколько разных экземпляров одного рабочего процесса, которые находятся на разных этапах и относятся к разным клиентам.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-145">However, that can make the code more complex, since now it has to worry about many different instances of the same workflow, all at different stages and from different customers.</span></span> <span data-ttu-id="1b1a8-146">Кроме того, одновременная обработка нескольких рабочих процессов не устранит проблему масштаба.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-146">Also, handling multiple workflows at the same time doesn't solve the scale problem.</span></span> <span data-ttu-id="1b1a8-147">Причина этого заключается в том, что в определенный момент эта служба начнет потреблять слишком много ресурсов, чтобы быть размещенной на отдельном компьютере.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-147">This is because at some point this service will consume too many resources to fit on a particular machine.</span></span> <span data-ttu-id="1b1a8-148">Многие службы, которые изначально не были предназначены для этой схемы, также испытывают сложности из-за унаследованных узких мест или замедляющих частей в своем коде.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-148">Many services not built for this pattern in the first place also experience difficulty due to some inherent bottleneck or slowdown in their code.</span></span> <span data-ttu-id="1b1a8-149">Подобные проблемы также нарушают работу службы, если увеличивается число параллельных рабочих процессов, которые она отслеживает.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-149">These types of issues cause the service not to work as well when the number of concurrent workflows it is tracking gets larger.</span></span>  

<span data-ttu-id="1b1a8-150">Решением является создание экземпляра данной службы для каждого отдельного экземпляра рабочего процесса, который нужно отслеживать. Это отличная схема, которая подходит для служб без отслеживания состояния и служб с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-150">A solution is to create an instance of this service for every different instance of the workflow you want to track. This is a great pattern and works whether the service is stateless or stateful.</span></span> <span data-ttu-id="1b1a8-151">Для работы этой схемы, как правило, используется еще одна служба, которая выступает в роли "службы диспетчера рабочих нагрузок".</span><span class="sxs-lookup"><span data-stu-id="1b1a8-151">For this pattern to work, there's usually another service that acts as a "Workload Manager Service".</span></span> <span data-ttu-id="1b1a8-152">Задача этой службы — получать запросы и перенаправлять их к другим службам.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-152">The job of this service is to receive requests and to route those requests to other services.</span></span> <span data-ttu-id="1b1a8-153">Диспетчер может динамически создать экземпляр службы рабочей нагрузки, когда он получит сообщение, и затем передать запрос этой службе.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-153">The manager can dynamically create an instance of the workload service when it receives the message, and then pass on requests to those services.</span></span> <span data-ttu-id="1b1a8-154">Служба диспетчера может также получать обратные вызовы, когда заданная служба рабочего процесса завершает свое задание.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-154">The manager service could also receive callbacks when a given workflow service completes its job.</span></span> <span data-ttu-id="1b1a8-155">Когда диспетчер получает эти обратные вызовы, он может удалить данный экземпляр службы рабочего процесса или оставить его, если ожидаются дополнительные вызовы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-155">When the manager receives these callbacks it could delete that instance of the workflow service, or leave it if more calls are expected.</span></span> 

<span data-ttu-id="1b1a8-156">Расширенные версии диспетчера этого типа могут даже создавать пулы служб, которыми он управляет.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-156">Advanced versions of this type of manager can even create pools of the services that it manages.</span></span> <span data-ttu-id="1b1a8-157">Пул позволяет устранить ожидание запуска соответствующей службы при поступлении нового запроса.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-157">The pool helps ensure that when a new request comes in it doesn't have to wait for the service to spin up.</span></span> <span data-ttu-id="1b1a8-158">Вместо этого диспетчер может просто выбрать из пула службу рабочего процесса, которая в настоящее время не используется, или направить запрос произвольным образом.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-158">Instead, the manager can just pick a workflow service that is not currently busy from the pool, or route randomly.</span></span> <span data-ttu-id="1b1a8-159">Использование пула доступных служб ускоряет обработку новых запросов, так как снижает вероятность того, что запрос будет ожидать, пока запустится новая служба.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-159">Keeping a pool of services available makes handling new requests faster, since it is less likely that the request has to wait for a new service to be spun up.</span></span> <span data-ttu-id="1b1a8-160">Новые службы создаются быстро, но не бесплатно и не мгновенно.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-160">Creating new services is quick, but not free or instantaneous.</span></span> <span data-ttu-id="1b1a8-161">Пул помогает свести к минимуму время ожидания запроса перед обслуживанием.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-161">The pool helps minimize the amount of time the request has to wait before being serviced.</span></span> <span data-ttu-id="1b1a8-162">Приведенная схема с диспетчером и пулом часто используется в системах, в которых наиболее важно время отклика.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-162">You'll often see this manager and pool pattern when response times matter the most.</span></span> <span data-ttu-id="1b1a8-163">В еще одной распространенной схеме диспетчера запрос добавляется в очередь, служба создается в фоновом режиме, а _затем_ этот запрос передается ей. То есть службы создаются и удаляются в соответствии с отслеживаемым объемом работы, ожидающим эту службу в настоящее время.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-163">Queuing the request and creating the service in the background and _then_ passing it on is also a popular manager pattern, as is creating and deleting services based on some tracking of the amount of work that service currently has pending.</span></span> 

## <a name="scaling-by-creating-or-removing-new-named-application-instances"></a><span data-ttu-id="1b1a8-164">Масштабирование путем создания или удаления новых именованных экземпляров приложений</span><span class="sxs-lookup"><span data-stu-id="1b1a8-164">Scaling by creating or removing new named application instances</span></span>
<span data-ttu-id="1b1a8-165">Создание и удаление экземпляров приложения целиком аналогично схеме создания и удаления служб.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-165">Creating and deleting whole application instances is similar to the pattern of creating and deleting services.</span></span> <span data-ttu-id="1b1a8-166">В этой схеме присутствует служба диспетчера, которая принимает решения на основе запросов, которые она обнаруживает, и информации, которую она получает от других служб в кластере.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-166">For this pattern, there's some manager service that is making the decision based on the requests that it is seeing and the information it is receiving from the other services inside the cluster.</span></span> 

<span data-ttu-id="1b1a8-167">В каких случаях должен создаваться новый именованный экземпляр приложения, а не новые именованные экземпляры службы в существующем приложении?</span><span class="sxs-lookup"><span data-stu-id="1b1a8-167">When should creating a new named application instance be used instead of creating a new named service instances in some already existing application?</span></span> <span data-ttu-id="1b1a8-168">Таких случаев несколько.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-168">There's a few cases:</span></span>

  * <span data-ttu-id="1b1a8-169">Новый экземпляр приложения для клиента, код которого должен выполняться с использованием определенного удостоверения или параметров безопасности.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-169">The new application instance is for a customer whose code needs to run under some particular identity or security settings.</span></span>
    * <span data-ttu-id="1b1a8-170">Service Fabric дает возможность определить разные пакеты кода для запуска с помощью определенных удостоверений.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-170">Service Fabric allows defining different code packages to run under particular identities.</span></span> <span data-ttu-id="1b1a8-171">Чтобы запустить один и тот же пакет кода с использованием разных удостоверений, необходимо выполнить активацию в разных экземплярах приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-171">In order to launch the same code package under different identities, the activations need to occur in different application instances.</span></span> <span data-ttu-id="1b1a8-172">Предположим, в вашей среде развернуты рабочие нагрузки клиента.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-172">Consider a case where you have an existing customer's workloads deployed.</span></span> <span data-ttu-id="1b1a8-173">Они могут выполняться с использованием конкретного удостоверения, чтобы можно было отслеживать и контролировать их доступ к другим ресурсам, например удаленным базам данных или другим системам.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-173">These may be running under a particular identity so you can monitor and control their access to other resources, such as remote databases or other systems.</span></span> <span data-ttu-id="1b1a8-174">В этом случае при регистрации нового клиента, вероятно, вы не захотите активировать его код в том же контексте (пространстве процесса).</span><span class="sxs-lookup"><span data-stu-id="1b1a8-174">In this case, when a new customer signs up, you probably don't want to activate their code in the same context (process space).</span></span> <span data-ttu-id="1b1a8-175">Вы могли бы это сделать, но это усложнило бы выполнение кода службы в контексте определенного удостоверения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-175">While you could, this makes it harder for your service code to act within the context of a particular identity.</span></span> <span data-ttu-id="1b1a8-176">Обычно требуется дополнительный код для защиты, изоляции и управления удостоверениями.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-176">You typically must have more security, isolation, and identity management code.</span></span> <span data-ttu-id="1b1a8-177">Вместо того, чтобы использовать различные именованные экземпляры службы в одном экземпляре приложения и, следовательно, в одном пространстве процесса, можно использовать разные именованные экземпляры приложения Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-177">Instead of using different named service instances within the same application instance and hence the same process space, you can use different named Service Fabric Application instances.</span></span> <span data-ttu-id="1b1a8-178">Это упрощает определение разных контекстов удостоверений.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-178">This makes it easier to define different identity contexts.</span></span>
  * <span data-ttu-id="1b1a8-179">Новый экземпляр приложения выступает также в роли средства настройки.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-179">The new application instance also serves as a means of configuration</span></span>
    * <span data-ttu-id="1b1a8-180">По умолчанию все именованные экземпляры конкретной службы определенного типа в экземпляре приложения будут выполняться в одном процессе на заданном узле.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-180">By default, all of the named service instances of a particular service type within an application instance will run in the same process on a given node.</span></span> <span data-ttu-id="1b1a8-181">Это означает, что хотя каждый экземпляр службы можно настроить по-разному, сделать это сложно.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-181">What this means is that while you can configure each service instance differently, doing so is complicated.</span></span> <span data-ttu-id="1b1a8-182">Службы должны использовать какой-либо токен для поиска своей конфигурации в пакете конфигурации.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-182">Services must have some token they use to look up their config within a configuration package.</span></span> <span data-ttu-id="1b1a8-183">Обычно это просто имя службы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-183">Usually this is just the service's name.</span></span> <span data-ttu-id="1b1a8-184">Это хороший способ, но он привязывает конфигурацию к именам отдельных именованных экземпляров службы в пределах данного экземпляра приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-184">This works fine, but it couples the configuration to the names of the individual named service instances within that application instance.</span></span> <span data-ttu-id="1b1a8-185">Это может внести путаницу и усложнить управление, так как конфигурация обычно является артефактом времени разработки со значениями, относящимися к экземпляру приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-185">This can be confusing and hard to manage since configuration is normally a design time artifact with application instance specific values.</span></span> <span data-ttu-id="1b1a8-186">Создание дополнительных служб всегда означает дополнительные обновления приложения, необходимые для изменения информации в пакетах конфигурации или развертывания новых пакетов конфигурации, в которых новые службы смогут найти относящуюся к ним информацию.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-186">Creating more services always means more application upgrades to change the information within the config packages or to deploy new ones so that the new services can look up their specific information.</span></span> <span data-ttu-id="1b1a8-187">Часто бывает проще создать абсолютно новый именованный экземпляр приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-187">It's often easier to create a whole new named application instance.</span></span> <span data-ttu-id="1b1a8-188">Затем можно использовать параметры приложения, чтобы задать требуемую конфигурацию для служб.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-188">Then you can use the application parameters to set whatever configuration is necessary for the services.</span></span> <span data-ttu-id="1b1a8-189">Таким образом все службы, созданные в именованном экземпляре приложения, могут наследовать определенные параметры конфигурации.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-189">This way all of the services that are created within that named application instance can inherit particular configuration settings.</span></span> <span data-ttu-id="1b1a8-190">Например, вместо использования одного файла конфигурации с параметрами и настройками для каждого клиента (например, это могут быть секреты или ограничения ресурсов на клиента), можно создать отдельные экземпляры приложения для каждого клиента, переопределив эти параметры.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-190">For example, instead of having a single configuration file with the settings and customizations for every customer, such as secrets or per customer resource limits, you'd instead have a different application instance for each customer with these settings overridden.</span></span> 
  * <span data-ttu-id="1b1a8-191">Новое приложение служит в качестве границы обновления.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-191">The new application serves as an upgrade boundary</span></span>
    * <span data-ttu-id="1b1a8-192">В Service Fabric разные именованные экземпляры приложения служат в качестве границы для обновления.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-192">Within Service Fabric, different named application instances serve as boundaries for upgrade.</span></span> <span data-ttu-id="1b1a8-193">Обновление одного именованного экземпляра приложения не повлияет на код, который выполняет другой именованный экземпляр приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-193">An upgrade of one named application instance will not impact the code that another named application instance is running.</span></span> <span data-ttu-id="1b1a8-194">В итоге разные приложения будут выполнять разные версии одного кода на одних и тех же узлах.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-194">The different applications will end up running different versions of the same code on the same nodes.</span></span> <span data-ttu-id="1b1a8-195">Это может повлиять на принятие решения о масштабировании, так как можно выбрать, должен ли новый код быть обновлен, как и другая служба.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-195">This can be a factor when you need to make a scaling decision because you can choose whether the new code should follow the same upgrades as another service or not.</span></span> <span data-ttu-id="1b1a8-196">Например, предположим, в службу диспетчера, который отвечает за масштабирование рабочих нагрузок конкретного клиента путем динамического создания и удаления служб, поступает вызов.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-196">For example, say that a call arrives at the manager service that is responsible for scaling a particular customer's workloads by creating and deleting services dynamically.</span></span> <span data-ttu-id="1b1a8-197">В этом случае, однако, вызов направлен к рабочей нагрузке, связанной с _новым_ клиентом.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-197">In this case however, the call is for a workload associated with a _new_ customer.</span></span> <span data-ttu-id="1b1a8-198">Большинство клиентов стремится изолироваться друг от друга не только по соображениям безопасности и настройки, приведенным ранее. Это обеспечивает большую гибкость для выполнения специальных версий программного обеспечения и выбора момента для их обновления.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-198">Most customers like being isolated from each other not just for the security and configuration reasons listed previously, but because it provides more flexibility in terms of running specific versions of the software and choosing when they get upgraded.</span></span> <span data-ttu-id="1b1a8-199">Можно также создать новый экземпляр приложения и создать в нем службу, чтобы еще больше секционировать службы, которые затронет какое-либо обновление.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-199">You may also create a new application instance and create the service there simply to further partition the amount of your services that any one upgrade will touch.</span></span> <span data-ttu-id="1b1a8-200">Отдельные экземпляры приложения обеспечивают большую детализацию при обновлении приложений, а также позволяют использовать тестирование A/B и развертывания Blue-Green.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-200">Separate application instances provide greater granularity when doing application upgrades, and also enable A/B testing and Blue/Green deployments.</span></span> 
  * <span data-ttu-id="1b1a8-201">Существующий экземпляр приложения заполнен.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-201">The existing application instance is full</span></span>
    * <span data-ttu-id="1b1a8-202">В Service Fabric [емкость приложения](service-fabric-cluster-resource-manager-application-groups.md) — это понятие, которое можно использовать для управления объемом ресурсов, доступных для конкретных экземпляров приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-202">In Service Fabric, [application capacity](service-fabric-cluster-resource-manager-application-groups.md) is a concept that you can use to control the amount of resources available for particular application instances.</span></span> <span data-ttu-id="1b1a8-203">Например, вы можете решить, что для данной службы требуется создать еще один экземпляр, чтобы увеличить ее масштаб.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-203">For example, you may decide that a given service needs to have another instance created in order to scale.</span></span> <span data-ttu-id="1b1a8-204">Однако этот экземпляр приложения превышает емкость для определенной метрики.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-204">However, this application instance is out of capacity for a certain metric.</span></span> <span data-ttu-id="1b1a8-205">Если этому клиенту или рабочей нагрузке все же требуется предоставить больше ресурсов, то можно либо увеличить емкость для данного приложения, либо создать новое приложение.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-205">If this particular customer or workload should still be granted more resources, then you could either increase the existing capacity for that application or create a new application.</span></span> 

## <a name="scaling-at-the-partition-level"></a><span data-ttu-id="1b1a8-206">Масштабирование на уровне раздела</span><span class="sxs-lookup"><span data-stu-id="1b1a8-206">Scaling at the partition level</span></span>
<span data-ttu-id="1b1a8-207">Service Fabric поддерживает секционирование.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-207">Service Fabric supports partitioning.</span></span> <span data-ttu-id="1b1a8-208">Секционирование позволяет разделить службы на несколько логических и физических секций, каждая из которых работает независимо друг от друга.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-208">Partitioning splits a service into several logical and physical sections, each of which operates independently.</span></span> <span data-ttu-id="1b1a8-209">Это удобно использовать для служб с отслеживанием состояния, так как ни один набор реплик не должен обрабатывать все вызовы и оперировать всеми состояниями одновременно.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-209">This is useful with stateful services, since no one set of replicas has to handle all the calls and manipulate all of the state at once.</span></span> <span data-ttu-id="1b1a8-210">В разделе [Обзор по разделам](service-fabric-concepts-partitioning.md) содержится информация о поддерживаемых типах схем секционирования на разделы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-210">The [partitioning overview](service-fabric-concepts-partitioning.md) provides information on the types of partitioning schemes that are supported.</span></span> <span data-ttu-id="1b1a8-211">Реплики каждой секции распределены между узлами в кластере. Это позволяет распределить нагрузку данной службы и предотвратить появление единых точек отказа как во всей службе, так и в любой секции.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-211">The replicas of each partition are spread across the nodes in a cluster, distributing that service's load and ensuring that neither the service as a whole or any partition has a single point of failure.</span></span> 

<span data-ttu-id="1b1a8-212">Рассмотрим службу, использующую схему секционирования по диапазонам, в которой нижний ключ равен 0, верхний ключ равен 99, а количество разделов равно 4.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-212">Consider a service that uses a ranged partitioning scheme with a low key of 0, a high key of 99, and a partition count of 4.</span></span> <span data-ttu-id="1b1a8-213">В кластере с тремя узлами служба может состоять из четырех реплик, совместно использующих ресурсы каждого узла, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-213">In a three-node cluster, the service might be laid out with four replicas that share the resources on each node as shown here:</span></span>

<span data-ttu-id="1b1a8-214"><center>
![Распределение разделов с тремя узлами](./media/service-fabric-concepts-scalability/layout-three-nodes.png)
</center></span><span class="sxs-lookup"><span data-stu-id="1b1a8-214"><center>
![Partition layout with three nodes](./media/service-fabric-concepts-scalability/layout-three-nodes.png)
</center></span></span>

<span data-ttu-id="1b1a8-215">Если вы увеличите число узлов, Service Fabric переместит на них несколько существующих реплик.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-215">If you increase the number of nodes, Service Fabric will move some of the existing replicas there.</span></span> <span data-ttu-id="1b1a8-216">Например, предположим, что количество узлов увеличивается до четырех и реплики перераспределяются.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-216">For example, let's say the number of nodes increases to four and the replicas get redistributed.</span></span> <span data-ttu-id="1b1a8-217">Теперь у службы три реплики, которые выполняются на каждом узле и относятся к разным секциям.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-217">Now the service now has three replicas running on each node, each belonging to different partitions.</span></span> <span data-ttu-id="1b1a8-218">Это обеспечивает более эффективное использование ресурсов, так как новый узел также нагружен.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-218">This allows better resource utilization since the new node isn't cold.</span></span> <span data-ttu-id="1b1a8-219">Как правило, это также повышает производительность, так как каждой службе доступно больше ресурсов.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-219">Typically, it also improves performance as each service has more resources available to it.</span></span>

<span data-ttu-id="1b1a8-220"><center>
![Распределение разделов с четырьмя узлами](./media/service-fabric-concepts-scalability/layout-four-nodes.png)
</center></span><span class="sxs-lookup"><span data-stu-id="1b1a8-220"><center>
![Partition layout with four nodes](./media/service-fabric-concepts-scalability/layout-four-nodes.png)
</center></span></span>

## <a name="scaling-by-using-the-service-fabric-cluster-resource-manager-and-metrics"></a><span data-ttu-id="1b1a8-221">Масштабирование с помощью диспетчера кластерных ресурсов Service Fabric и метрик</span><span class="sxs-lookup"><span data-stu-id="1b1a8-221">Scaling by using the Service Fabric Cluster Resource Manager and metrics</span></span>
<span data-ttu-id="1b1a8-222">[Метрики](service-fabric-cluster-resource-manager-metrics.md) выражают потребление службами ресурсов в Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-222">[Metrics](service-fabric-cluster-resource-manager-metrics.md) are how services express their resource consumption to Service Fabric.</span></span> <span data-ttu-id="1b1a8-223">С помощью метрик диспетчер кластерных ресурсов может реорганизовывать и оптимизировать структуру кластера.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-223">Using metrics gives the Cluster Resource Manager an opportunity to reorganize and optimize the layout of the cluster.</span></span> <span data-ttu-id="1b1a8-224">Например, в кластере может быть большое количество ресурсов, но они могут быть не выделены службам, которые в настоящее время выполняют работу.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-224">For example, there may be plenty of resources in the cluster, but they might not be allocated to the services that are currently doing work.</span></span> <span data-ttu-id="1b1a8-225">С помощью метрик диспетчер кластерных ресурсов может реорганизовать кластер, чтобы предоставить службам доступные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-225">Using metrics allows the Cluster Resource Manager to reorganize the cluster to ensure that services have access to the available resources.</span></span> 


## <a name="scaling-by-adding-and-removing-nodes-from-the-cluster"></a><span data-ttu-id="1b1a8-226">Масштабирование путем добавления и удаления узлов кластера</span><span class="sxs-lookup"><span data-stu-id="1b1a8-226">Scaling by adding and removing nodes from the cluster</span></span> 
<span data-ttu-id="1b1a8-227">Еще один вариант масштабирования в Service Fabric — изменение размера кластера.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-227">Another option for scaling with Service Fabric is to change the size of the cluster.</span></span> <span data-ttu-id="1b1a8-228">Изменение размера кластера означает добавление или удаление узлов одного или нескольких типов в кластере.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-228">Changing the size of the cluster means adding or removing nodes for one or more of the node types in the cluster.</span></span> <span data-ttu-id="1b1a8-229">Например, рассмотрим случай, в котором все узлы в кластере нагружены.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-229">For example, consider a case where all of the nodes in the cluster are hot.</span></span> <span data-ttu-id="1b1a8-230">Это означает, что ресурсы кластера почти полностью использованы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-230">This means that the cluster's resources are almost all consumed.</span></span> <span data-ttu-id="1b1a8-231">В этом случае лучшим способом масштабирования является добавление узлов в кластер.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-231">In this case, adding more nodes to the cluster is the best way to scale.</span></span> <span data-ttu-id="1b1a8-232">После присоединения новых узлов к кластеру диспетчер кластерных ресурсов Service Fabric переместит на них службы, что снизит общую нагрузку на существующие узлы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-232">Once the new nodes join the cluster the Service Fabric Cluster Resource Manager moves services to them, resulting in less total load on the existing nodes.</span></span> <span data-ttu-id="1b1a8-233">Для служб без отслеживания состояния с числом экземпляров, равным -1, дополнительные экземпляры службы создаются автоматически.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-233">For stateless services with instance count = -1, more service instances are automatically created.</span></span> <span data-ttu-id="1b1a8-234">Это позволяет перенести некоторые вызовы с существующих узлов на новые узлы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-234">This allows some calls to move from the existing nodes to the new nodes.</span></span> 

<span data-ttu-id="1b1a8-235">Добавление и удаление узлов в кластере можно выполнять с помощью модуля PowerShell для Azure Resource Manager Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-235">Adding and removing nodes to the cluster can be accomplished via the Service Fabric Azure Resource Manager PowerShell module.</span></span>

```posh
Add-AzureRmServiceFabricNode -ResourceGroupName $resourceGroupName -Name $clusterResourceName -NodeType $nodeTypeName  -NumberOfNodesToAdd 5 
Remove-AzureRmServiceFabricNode -ResourceGroupName $resourceGroupName -Name $clusterResourceName -NodeType $nodeTypeName -NumberOfNodesToRemove 5
```

## <a name="putting-it-all-together"></a><span data-ttu-id="1b1a8-236">Сборка</span><span class="sxs-lookup"><span data-stu-id="1b1a8-236">Putting it all together</span></span>
<span data-ttu-id="1b1a8-237">Давайте рассмотрим все идеи, которые мы уже обсудили, на следующем примере.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-237">Let's take all the ideas that we've discussed here and talk through an example.</span></span> <span data-ttu-id="1b1a8-238">Предположим, что вы пытаетесь создать службу, которая выступает в качестве адресной книги для хранения имен и контактной информации.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-238">Consider the following service: you are trying to build a service that acts as an address book, holding on to names and contact information.</span></span> 

<span data-ttu-id="1b1a8-239">Перед вами стоит ряд вопросов, связанных с масштабированием: сколько пользователей будет у этой службы?</span><span class="sxs-lookup"><span data-stu-id="1b1a8-239">Right up front you have a bunch of questions related to scale: How many users are you going to have?</span></span> <span data-ttu-id="1b1a8-240">Сколько контактов будет хранить каждый пользователь?</span><span class="sxs-lookup"><span data-stu-id="1b1a8-240">How many contacts will each user store?</span></span> <span data-ttu-id="1b1a8-241">Непросто ответить на все эти вопросы при первом развертывании службы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-241">Trying to figure this all out when you are standing up your service for the first time is difficult.</span></span> <span data-ttu-id="1b1a8-242">Предположим, вы собирались создать отдельную статическую службу с определенным количеством секций.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-242">Let's say you were going to go with a single static service with a specific partition count.</span></span> <span data-ttu-id="1b1a8-243">Неправильный выбор числа разделов может позже привести к серьезным проблемам с масштабированием.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-243">The consequences of picking the wrong partition count could cause you to have scale issues later.</span></span> <span data-ttu-id="1b1a8-244">Аналогичным образом, даже если вы выберете правильное количество, этой информации может быть недостаточно.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-244">Similarly, even if you pick the right count you might not have all the information you need.</span></span> <span data-ttu-id="1b1a8-245">Например, необходимо также заранее выбрать размер кластера, то есть количество узлов и их размеры.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-245">For example, you also have to decide the size of the cluster up front, both in terms of the number of nodes and their sizes.</span></span> <span data-ttu-id="1b1a8-246">Обычно сложно спрогнозировать, сколько ресурсов служба будет использовать в течение своего времени существования.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-246">It's usually hard to predict how many resources a service is going to consume over its lifetime.</span></span> <span data-ttu-id="1b1a8-247">Кроме того, может быть трудно узнать заранее схему трафика, обрабатываемого службой.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-247">It can also be hard to know ahead of time the traffic pattern that the service actually sees.</span></span> <span data-ttu-id="1b1a8-248">Например, пользователи могут с самого утра первым делом добавлять и удалять контакты или эти действия могут быть распределены равномерно на протяжении дня.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-248">For example, maybe people add and remove their contacts only first thing in the morning, or maybe it's distributed evenly over the course of the day.</span></span> <span data-ttu-id="1b1a8-249">Ввиду этого может потребоваться динамическое масштабирование.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-249">Based on this you might need to scale out and in dynamically.</span></span> <span data-ttu-id="1b1a8-250">Возможно, вы научитесь прогнозировать необходимость в развертывании и свертывании ресурсов, но вам наверняка понадобится реагировать на изменение потребления ресурсов службой.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-250">Maybe you can learn to predict when you're going to need to scale out and in, but either way you're probably going to need to react to changing resource consumption by your service.</span></span> <span data-ttu-id="1b1a8-251">Это может быть изменение размера кластера для предоставления ей дополнительных ресурсов, когда реорганизации использования существующих ресурсов недостаточно.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-251">This can involve changing the size of the cluster in order to provide more resources when reorganizing use of existing resources isn't enough.</span></span> 

<span data-ttu-id="1b1a8-252">Но нужно ли нам выбирать для всех пользователей единую схему секционирования?</span><span class="sxs-lookup"><span data-stu-id="1b1a8-252">But why even try to pick a single partition scheme out for all users?</span></span> <span data-ttu-id="1b1a8-253">Зачем ограничиваться одной службой и одним статическим кластером?</span><span class="sxs-lookup"><span data-stu-id="1b1a8-253">Why limit yourself to one service and one static cluster?</span></span> <span data-ttu-id="1b1a8-254">Как правило, реальная ситуация более динамична.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-254">The real situation is usually more dynamic.</span></span> 

<span data-ttu-id="1b1a8-255">При проектировании масштабирования рассмотрите приведенную ниже динамическую схему.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-255">When building for scale, consider the following dynamic pattern.</span></span> <span data-ttu-id="1b1a8-256">Возможно, ее нужно будет адаптировать к вашей ситуации.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-256">You may need to adapt it to your situation:</span></span>

1. <span data-ttu-id="1b1a8-257">Не пытайтесь сразу выбрать единственно верную и универсальную схему секционирования, а создайте службу диспетчера.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-257">Instead of trying to pick a partitioning scheme for everyone up front, build a "manager service".</span></span>
2. <span data-ttu-id="1b1a8-258">Эта служба будет изучать информацию о каждом клиенте, который регистрируется в вашей основной службе.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-258">The job of the manager service is to look at customer information when they sign up for your service.</span></span> <span data-ttu-id="1b1a8-259">На основе этой информации служба диспетчера создает экземпляр _реальной_ службы хранилища контактов _только для этого клиента_.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-259">Then depending on that information the manager service create an instance of your _actual_ contact-storage service _just for that customer_.</span></span> <span data-ttu-id="1b1a8-260">Если клиенту требуется особая конфигурация, изоляция или обновления, для него можно также запустить экземпляр приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-260">If they require particular configuration, isolation, or upgrades, you can also decide to spin up an Application instance for this customer.</span></span> 

<span data-ttu-id="1b1a8-261">Эта схема динамического создания имеет множество преимуществ.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-261">This dynamic creation pattern many benefits:</span></span>

  - <span data-ttu-id="1b1a8-262">Вам не нужно точно предугадывать правильное число разделов для всех пользователей или создавать отдельную службу, которая является бесконечно масштабируемой.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-262">You're not trying to guess the correct partition count for all users up front or build a single service that is infinitely scalable all on its own.</span></span> 
  - <span data-ttu-id="1b1a8-263">Разные пользователи могут использовать отличающиеся количества секций и реплик, ограничения размещения, метрики, нагрузки по умолчанию, имена служб, параметры DNS или какие-либо другие свойства, указанное на уровне службы или приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-263">Different users don't have to have the same partition count, replica count, placement constraints, metrics, default loads, service names, dns settings, or any of the other properties specified at the service or application level.</span></span> 
  - <span data-ttu-id="1b1a8-264">Это обеспечивает дополнительную сегментацию данных.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-264">You gain additional data segmentation.</span></span> <span data-ttu-id="1b1a8-265">Каждый клиент использует свою собственную копию службы.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-265">Each customer has their own copy of the service</span></span>
    - <span data-ttu-id="1b1a8-266">Каждую службу клиента можно настроить по-разному и предоставить ей больше или меньше ресурсов, например, выделив большее или меньшее число секций или реплик с учетом прогнозируемого масштаба.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-266">Each customer service can be configured differently and granted more or fewer resources, with more or fewer partitions or replicas as necessary based on their expected scale.</span></span>
      - <span data-ttu-id="1b1a8-267">Например, предположим, что клиент оплатил уровень Gold. Он может получить большее число реплик или секций и, в перспективе, ресурсов, выделяемых службам на основе метрик и емкостей приложения.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-267">For example, say the customer paid for the "Gold" tier - they could get more replicas or greater partition count, and potentially resources dedicated to their services via metrics and application capacities.</span></span>
      - <span data-ttu-id="1b1a8-268">Если же данные, предоставленные клиентом, предполагают относительно небольшое число контактов, то для него можно использовать малое число секций или даже поместить его службу в общий пул служб, совместно используемый другими клиентами.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-268">Or say they provided information indicating the number of contacts they needed was "Small" - they would get only a few partitions, or could even be put into a shared service pool with other customers.</span></span>
  - <span data-ttu-id="1b1a8-269">Вам не нужно поддерживать множество экземпляров или реплик службы, пока не появились клиенты.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-269">You're not running a bunch of service instances or replicas while you're waiting for customers to show up</span></span>
  - <span data-ttu-id="1b1a8-270">Если клиент откажется от ваших услуг, то для удаления его информации из вашей службы достаточно, чтобы служба диспетчера удалила созданную для этого клиента службу или приложение.</span><span class="sxs-lookup"><span data-stu-id="1b1a8-270">If a customer ever leaves, then removing their information from your service is as simple as having the manager delete that service or application that it created.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1b1a8-271">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="1b1a8-271">Next steps</span></span>
<span data-ttu-id="1b1a8-272">Дополнительные сведения о понятиях Service Fabric см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="1b1a8-272">For more information on Service Fabric concepts, see the following articles:</span></span>

* [<span data-ttu-id="1b1a8-273">Доступность служб структуры служб</span><span class="sxs-lookup"><span data-stu-id="1b1a8-273">Availability of Service Fabric services</span></span>](service-fabric-availability-services.md)
* [<span data-ttu-id="1b1a8-274">Разделение служб Service Fabric</span><span class="sxs-lookup"><span data-stu-id="1b1a8-274">Partitioning Service Fabric services</span></span>](service-fabric-concepts-partitioning.md)
