---
title: "Планирование приложения Service Fabric aaaCapacity | Документы Microsoft"
description: "Описывает, каким образом tooidentify hello количество вычислительных узлов, необходимых для приложения Service Fabric"
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: markfuss
editor: 
ms.assetid: 9fa47be0-50a2-4a51-84a5-20992af94bea
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 44a69e9d8ec5efcc43122dc42e8f923ef37378f2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="capacity-planning-for-service-fabric-applications"></a><span data-ttu-id="c6784-103">Планирование емкости для приложений Service Fabric</span><span class="sxs-lookup"><span data-stu-id="c6784-103">Capacity planning for Service Fabric applications</span></span>
<span data-ttu-id="c6784-104">В этом документе объясняется, как tooestimate hello объем ресурсов (ЦП, оперативной памяти, дискового хранилища) требуется toorun приложения Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="c6784-104">This document teaches you how tooestimate hello amount of resources (CPUs, RAM, disk storage) you need toorun your Azure Service Fabric applications.</span></span> <span data-ttu-id="c6784-105">Довольно часто toochange требования вашего ресурса со временем.</span><span class="sxs-lookup"><span data-stu-id="c6784-105">It is common for your resource requirements toochange over time.</span></span> <span data-ttu-id="c6784-106">Как правило, при разработке или тестировании службы требуется незначительное количество ресурсов. Но при переходе в рабочую среду и росте популярности приложения объем ресурсов возрастает.</span><span class="sxs-lookup"><span data-stu-id="c6784-106">You typically require few resources as you develop/test your service, and then require more resources as you go into production and your application grows in popularity.</span></span> <span data-ttu-id="c6784-107">При разработке приложения следует продумать долгосрочные требования hello и выбрать параметры, позволяющие вашей службы tooscale toomeet высокий спрос.</span><span class="sxs-lookup"><span data-stu-id="c6784-107">When you design your application, think through hello long-term requirements and make choices that allow your service tooscale toomeet high customer demand.</span></span>

 <span data-ttu-id="c6784-108">При создании кластера Service Fabric, необходимо решить, какие виды виртуальных машин (ВМ) составляют hello кластера.</span><span class="sxs-lookup"><span data-stu-id="c6784-108">When you create a Service Fabric cluster, you decide what kinds of virtual machines (VMs) make up hello cluster.</span></span> <span data-ttu-id="c6784-109">Каждая виртуальная машина поставляется с ограниченным объемом ресурсов в форме hello процессоров (ядра и скорости), пропускную способность сети, оперативной памяти и дискового хранилища.</span><span class="sxs-lookup"><span data-stu-id="c6784-109">Each VM comes with a limited amount of resources in hello form of CPUs (cores and speed), network bandwidth, RAM, and disk storage.</span></span> <span data-ttu-id="c6784-110">При увеличении службы со временем вы можете обновить tooVMs, которые обеспечивают больший объем ресурсов и добавить дополнительные виртуальные машины tooyour кластера.</span><span class="sxs-lookup"><span data-stu-id="c6784-110">As your service grows over time, you can upgrade tooVMs that offer greater resources and/or add more VMs tooyour cluster.</span></span> <span data-ttu-id="c6784-111">последний hello toodo, необходимо сконструировать службы изначально, он может использовать преимущества новых виртуальных машин, которые динамически Станьте toohello кластера.</span><span class="sxs-lookup"><span data-stu-id="c6784-111">toodo hello latter, you must architect your service initially so it can take advantage of new VMs that get dynamically added toohello cluster.</span></span>

<span data-ttu-id="c6784-112">Некоторые службы управления мало данных toono на hello виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="c6784-112">Some services manage little toono data on hello VMs themselves.</span></span> <span data-ttu-id="c6784-113">Таким образом для этих служб следует обращать внимание в первую очередь на производительность, это означает выбор hello для оптимизации производительности соответствующие процессоров (ядра и скорость) hello виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="c6784-113">Therefore, capacity planning for these services should focus primarily on performance, which means selecting hello appropriate CPUs (cores and speed) of hello VMs.</span></span> <span data-ttu-id="c6784-114">Кроме того, также следует учесть пропускную способность сети, включая частоту передачи данных и объем передаваемых данных.</span><span class="sxs-lookup"><span data-stu-id="c6784-114">In addition, you should consider network bandwidth, including how frequently network transfers are occurring and how much data is being transferred.</span></span> <span data-ttu-id="c6784-115">Если службе нужна tooperform, а также увеличивается использование службы, можно добавить дополнительные виртуальные машины toohello кластера и запросы сети hello распределения нагрузки между всеми виртуальными машинами hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-115">If your service needs tooperform well as service usage increases, you can add more VMs toohello cluster and load balance hello network requests across all hello VMs.</span></span>

<span data-ttu-id="c6784-116">Для службы, которые управляют большими объемами данных hello виртуальных машин планирования загрузки должна быть направлена в основном на размер.</span><span class="sxs-lookup"><span data-stu-id="c6784-116">For services that manage large amounts of data on hello VMs, capacity planning should focus primarily on size.</span></span> <span data-ttu-id="c6784-117">Таким образом необходимо тщательно рассмотреть hello объем оперативной памяти и диска хранилища виртуальной Машины hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-117">Thus, you should carefully consider hello capacity of hello VM's RAM and disk storage.</span></span> <span data-ttu-id="c6784-118">Система управления Hello виртуальной памяти в системе Windows делает выглядеть код tooapplication оперативной памяти на диске.</span><span class="sxs-lookup"><span data-stu-id="c6784-118">hello virtual memory management system in Windows makes disk space look like RAM tooapplication code.</span></span> <span data-ttu-id="c6784-119">Кроме того среда выполнения Service Fabric hello предоставляет технология smart paging хранения только горячих данных в памяти и скользящего toodisk hello холодных данных.</span><span class="sxs-lookup"><span data-stu-id="c6784-119">In addition, hello Service Fabric runtime provides smart paging keeping only hot data in memory and moving hello cold data toodisk.</span></span> <span data-ttu-id="c6784-120">Таким образом, приложения могут использовать больше памяти, чем доступно физически на hello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="c6784-120">Applications can thus use more memory than is physically available on hello VM.</span></span> <span data-ttu-id="c6784-121">ОЗУ просто увеличивает производительность, поскольку hello виртуальную Машину можно сохранить несколько дискового хранилища в оперативной памяти.</span><span class="sxs-lookup"><span data-stu-id="c6784-121">Having more RAM simply increases performance, since hello VM can keep more disk storage in RAM.</span></span> <span data-ttu-id="c6784-122">Hello выбора виртуальной Машины должен иметь данные hello достаточно большой toostore диска, на hello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="c6784-122">hello VM you select should have a disk large enough toostore hello data that you want on hello VM.</span></span> <span data-ttu-id="c6784-123">Аналогичным образом hello виртуальной Машины должен иметь достаточно tooprovide ОЗУ с hello производительности, которые необходимы.</span><span class="sxs-lookup"><span data-stu-id="c6784-123">Similarly, hello VM should have enough RAM tooprovide you with hello performance you desire.</span></span> <span data-ttu-id="c6784-124">Если к службе данных растет со временем, можно добавить дополнительные виртуальные машины toohello кластером и секционирования hello данных между всеми виртуальными машинами hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-124">If your service's data grows over time, you can add more VMs toohello cluster and partition hello data across all hello VMs.</span></span>

## <a name="determine-how-many-nodes-you-need"></a><span data-ttu-id="c6784-125">Определение количества необходимых узлов</span><span class="sxs-lookup"><span data-stu-id="c6784-125">Determine how many nodes you need</span></span>
<span data-ttu-id="c6784-126">Секционирование службы обеспечивает tooscale к службе данных.</span><span class="sxs-lookup"><span data-stu-id="c6784-126">Partitioning your service allows you tooscale out your service's data.</span></span> <span data-ttu-id="c6784-127">Дополнительные сведения о секционировании см. в статье [Секционирование служб Reliable Services в Service Fabric](service-fabric-concepts-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="c6784-127">For more information on partitioning, see [Partitioning Service Fabric](service-fabric-concepts-partitioning.md).</span></span> <span data-ttu-id="c6784-128">Каждая секция должна помещаться на одной виртуальной машине. Однако на одной виртуальной машине также можно разместить несколько небольших секций.</span><span class="sxs-lookup"><span data-stu-id="c6784-128">Each partition must fit within a single VM, but multiple (small) partitions can be placed on a single VM.</span></span> <span data-ttu-id="c6784-129">Следовательно, наличие большего количества небольших секций обеспечивает большую гибкость, чем небольшое количество более крупных секций.</span><span class="sxs-lookup"><span data-stu-id="c6784-129">So, having more small partitions gives you greater flexibility than having a few larger partitions.</span></span> <span data-ttu-id="c6784-130">компромисс Hello — много секций увеличивает нагрузку Service Fabric и нельзя выполнять операции с поддержкой транзакций в секциях.</span><span class="sxs-lookup"><span data-stu-id="c6784-130">hello trade-off is that having lots of partitions increases Service Fabric overhead and you cannot perform transacted operations across partitions.</span></span> <span data-ttu-id="c6784-131">Имеется также несколько потенциальных сетевого трафика, если код службы часто требуется tooaccess, живущих в разных секций данных.</span><span class="sxs-lookup"><span data-stu-id="c6784-131">There is also more potential network traffic if your service code frequently needs tooaccess pieces of data that live in different partitions.</span></span> <span data-ttu-id="c6784-132">При разработке службы, следует рассмотреть эти преимущества и недостатки tooarrive в эффективной стратегии секционирования.</span><span class="sxs-lookup"><span data-stu-id="c6784-132">When designing your service, you should carefully consider these pros and cons tooarrive at an effective partitioning strategy.</span></span>

<span data-ttu-id="c6784-133">Предположим, что приложение имеет единой службы с отслеживанием состояния, имеет размер хранилища, что предполагается toogrow tooDB_Size ГБ в год.</span><span class="sxs-lookup"><span data-stu-id="c6784-133">Let's assume your application has a single stateful service that has a store size that you expect toogrow tooDB_Size GB in a year.</span></span> <span data-ttu-id="c6784-134">Доступны пойти tooadd несколько приложений (и разделов) как возникают рост за этот год.</span><span class="sxs-lookup"><span data-stu-id="c6784-134">You are willing tooadd more applications (and partitions) as you experience growth beyond that year.</span></span>  <span data-ttu-id="c6784-135">Hello репликации коэффициент (RF), который определяет hello число реплик, для вашей службы влияние hello общее DB_Size.</span><span class="sxs-lookup"><span data-stu-id="c6784-135">hello replication factor (RF), which determines hello number of replicas for your service impacts hello total DB_Size.</span></span> <span data-ttu-id="c6784-136">Hello общее DB_Size во всех репликах — коэффициент репликации, умноженное на DB_Size hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-136">hello total DB_Size across all replicas is hello Replication Factor multiplied by DB_Size.</span></span>  <span data-ttu-id="c6784-137">Node_Size представляет hello дискового пространства и ОЗУ на каждом узле необходимо toouse для службы.</span><span class="sxs-lookup"><span data-stu-id="c6784-137">Node_Size represents hello disk space/RAM per node you want toouse for your service.</span></span> <span data-ttu-id="c6784-138">Для наилучшей производительности hello DB_Size следует помещаются в памяти в кластере hello и Node_Size, вокруг hello ОЗУ из приветствия виртуальная машина должна быть указана.</span><span class="sxs-lookup"><span data-stu-id="c6784-138">For best performance, hello DB_Size should fit into memory across hello cluster, and a Node_Size that is around hello RAM of hello VM should be chosen.</span></span> <span data-ttu-id="c6784-139">Выделяется Node_Size, размер которого превышает емкость ОЗУ hello, зависит от hello разбиения на страницы, предоставляемые средой выполнения Service Fabric hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-139">By allocating a Node_Size that is larger than hello RAM capacity, you are relying on hello paging provided by hello Service Fabric runtime.</span></span> <span data-ttu-id="c6784-140">Таким образом производительность может оказаться оптимальна, если все данные считается toobe горячей (с момента затем приветствия данные выгружаются/out).</span><span class="sxs-lookup"><span data-stu-id="c6784-140">Thus, your performance may not be optimal if your entire data is considered toobe hot (since then hello data is paged in/out).</span></span> <span data-ttu-id="c6784-141">Тем не менее для многих служб, где активна только часть данных hello, более экономичным.</span><span class="sxs-lookup"><span data-stu-id="c6784-141">However, for many services where only a fraction of hello data is hot, it is more cost-effective.</span></span>

<span data-ttu-id="c6784-142">Hello количество узлов, необходимое для достижения максимальной производительности, можно вычислить следующим образом:</span><span class="sxs-lookup"><span data-stu-id="c6784-142">hello number of nodes required for maximum performance can be computed as follows:</span></span>

```
Number of Nodes = (DB_Size * RF)/Node_Size

```


## <a name="account-for-growth"></a><span data-ttu-id="c6784-143">Действия с учетом расширения службы</span><span class="sxs-lookup"><span data-stu-id="c6784-143">Account for growth</span></span>
<span data-ttu-id="c6784-144">Вы можете toocompute hello число узлов на основании hello, предполагается, что toogrow вашей службы, кроме DB_Size toohello DB_Size, начинающийся с.</span><span class="sxs-lookup"><span data-stu-id="c6784-144">You may want toocompute hello number of nodes based on hello DB_Size that you expect your service toogrow to, in addition toohello DB_Size that you began with.</span></span> <span data-ttu-id="c6784-145">Затем увеличиваться hello количество узлов, при увеличении службы, чтобы не являются избыточная Подготовка hello количество узлов.</span><span class="sxs-lookup"><span data-stu-id="c6784-145">Then, grow hello number of nodes as your service grows so that you are not over-provisioning hello number of nodes.</span></span> <span data-ttu-id="c6784-146">Но hello количество секций должен быть основан hello число узлов, которые необходимы при запуске службы на максимальное увеличение размера.</span><span class="sxs-lookup"><span data-stu-id="c6784-146">But hello number of partitions should be based on hello number of nodes that are needed when you're running your service at maximum growth.</span></span>

<span data-ttu-id="c6784-147">Он является хорошим toohave некоторых дополнительных машин, доступных в любое время, что может обрабатывать любой непредвиденными скачками или сбоя (например, если несколько виртуальных машин вышли из строя).</span><span class="sxs-lookup"><span data-stu-id="c6784-147">It is good toohave some extra machines available at any time so that you can handle any unexpected spikes or failure (for example, if a few VMs go down).</span></span>  <span data-ttu-id="c6784-148">Хотя hello лишние емкости должно определяться с помощью вашей ожидаемый пики, отправной точкой является tooreserve несколько дополнительных виртуальных машин (5 – 10 процентов лишние).</span><span class="sxs-lookup"><span data-stu-id="c6784-148">While hello extra capacity should be determined by using your expected spikes, a starting point is tooreserve a few extra VMs (5-10 percent extra).</span></span>

<span data-ttu-id="c6784-149">Hello выше предполагается одной службы с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="c6784-149">hello preceding assumes a single stateful service.</span></span> <span data-ttu-id="c6784-150">При наличии нескольких служб с отслеживанием состояния, у вас есть hello tooadd DB_Size, связанный с hello других служб в уравнение hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-150">If you have more than one stateful service, you have tooadd hello DB_Size associated with hello other services into hello equation.</span></span> <span data-ttu-id="c6784-151">Кроме того можно вычислить hello количество узлов отдельно для каждой службы с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="c6784-151">Alternatively, you can compute hello number of nodes separately for each stateful service.</span></span>  <span data-ttu-id="c6784-152">У службы могут быть реплики или секции, которые не сбалансированы.</span><span class="sxs-lookup"><span data-stu-id="c6784-152">Your service may have replicas or partitions that aren't balanced.</span></span> <span data-ttu-id="c6784-153">Имейте в виду, что одни секции также могут содержать больше данных, чем другие.</span><span class="sxs-lookup"><span data-stu-id="c6784-153">Keep in mind that partitions may also have more data than others.</span></span> <span data-ttu-id="c6784-154">Дополнительные сведения о секционировании см. в статье [Секционирование служб Reliable Services в Service Fabric](service-fabric-concepts-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="c6784-154">For more information on partitioning, see [partitioning article on best practices](service-fabric-concepts-partitioning.md).</span></span> <span data-ttu-id="c6784-155">Однако hello выше формула записана в секции и реплики важен, поскольку Service Fabric гарантирует, что реплики hello распределено между узлами hello с оптимизацией.</span><span class="sxs-lookup"><span data-stu-id="c6784-155">However, hello preceding equation is partition and replica agnostic, because Service Fabric ensures that hello replicas are spread out among hello nodes in an optimized manner.</span></span>

## <a name="use-a-spreadsheet-for-cost-calculation"></a><span data-ttu-id="c6784-156">Использование таблицы для расчета стоимости</span><span class="sxs-lookup"><span data-stu-id="c6784-156">Use a spreadsheet for cost calculation</span></span>
<span data-ttu-id="c6784-157">Теперь давайте поместить некоторые вещественных чисел в формуле hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-157">Now let's put some real numbers in hello formula.</span></span> <span data-ttu-id="c6784-158">[Электронной таблицы примере](https://servicefabricsdkstorage.blob.core.windows.net/publicrelease/SF%20VM%20Cost%20calculator-NEW.xlsx) показано, как tooplan hello емкости для приложения, которое содержит три типа объектов данных.</span><span class="sxs-lookup"><span data-stu-id="c6784-158">An [example spreadsheet](https://servicefabricsdkstorage.blob.core.windows.net/publicrelease/SF%20VM%20Cost%20calculator-NEW.xlsx) shows how tooplan hello capacity for an application that contains three types of data objects.</span></span> <span data-ttu-id="c6784-159">Для каждого объекта приблизительного размера и количества объектов, что ожидается, что toohave.</span><span class="sxs-lookup"><span data-stu-id="c6784-159">For each object, we approximate its size and how many objects we expect toohave.</span></span> <span data-ttu-id="c6784-160">Мы также выбираем требуемое количество реплик каждого типа объекта.</span><span class="sxs-lookup"><span data-stu-id="c6784-160">We also select how many replicas we want of each object type.</span></span> <span data-ttu-id="c6784-161">Электронная таблица Hello вычисляет общий объем памяти toobe, хранящейся в кластере hello hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-161">hello spreadsheet calculates hello total amount of memory toobe stored in hello cluster.</span></span>

<span data-ttu-id="c6784-162">Затем мы вводим размер виртуальной машины и ежемесячные расходы.</span><span class="sxs-lookup"><span data-stu-id="c6784-162">Then we enter a VM size and monthly cost.</span></span> <span data-ttu-id="c6784-163">На основании hello размер виртуальной Машины, электронная таблица hello сообщает, что hello минимальное число секций, необходимо использовать toosplit вашей toophysically данные помещаются на узлах hello.</span><span class="sxs-lookup"><span data-stu-id="c6784-163">Based on hello VM size, hello spreadsheet tells you hello minimum number of partitions you must use toosplit your data toophysically fit on hello nodes.</span></span> <span data-ttu-id="c6784-164">Может требоваться больше tooaccommodate разделы, необходимые для вашего приложения конкретного вычислений и сетевого трафика.</span><span class="sxs-lookup"><span data-stu-id="c6784-164">You may desire a larger number of partitions tooaccommodate your application's specific computation and network traffic needs.</span></span> <span data-ttu-id="c6784-165">Электронная таблица Hello показывает hello количество секций, управляющих объектов профиля пользователя hello увеличилось из одного toosix.</span><span class="sxs-lookup"><span data-stu-id="c6784-165">hello spreadsheet shows hello number of partitions that are managing hello user profile objects has increased from one toosix.</span></span>

<span data-ttu-id="c6784-166">Теперь на основе этой информации электронной таблицы hello показано получение всех данных hello с hello требуемого разделов и реплик на кластере узлов 26 физически.</span><span class="sxs-lookup"><span data-stu-id="c6784-166">Now, based on all this information, hello spreadsheet shows that you could physically get all hello data with hello desired partitions and replicas on a 26-node cluster.</span></span> <span data-ttu-id="c6784-167">Тем не менее, этот кластер должен быть месте плотно упакованы, поэтому некоторые обновления и сбоев узлов tooaccommodate дополнительные узлы можно.</span><span class="sxs-lookup"><span data-stu-id="c6784-167">However, this cluster would be densely packed, so you may want some additional nodes tooaccommodate node failures and upgrades.</span></span> <span data-ttu-id="c6784-168">Hello электронной таблицы также показывает, что более 57 узлов предоставляет без дополнительных значений так, как будет иметь пустые узлы.</span><span class="sxs-lookup"><span data-stu-id="c6784-168">hello spreadsheet also shows that having more than 57 nodes provides no additional value because you would have empty nodes.</span></span> <span data-ttu-id="c6784-169">Опять же вы можете toogo выше 57 узлы все равно tooaccommodate сбоев узлов и обновления.</span><span class="sxs-lookup"><span data-stu-id="c6784-169">Again, you may want toogo above 57 nodes anyway tooaccommodate node failures and upgrades.</span></span> <span data-ttu-id="c6784-170">Можно настроить электронную таблицу toomatch hello конкретных потребностей вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="c6784-170">You can tweak hello spreadsheet toomatch your application's specific needs.</span></span>   

![Таблица для расчета стоимости][Image1]

## <a name="next-steps"></a><span data-ttu-id="c6784-172">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c6784-172">Next steps</span></span>
<span data-ttu-id="c6784-173">Извлечение [служб Service Fabric секционирование] [ 10] toolearn Дополнительные общие сведения о секционировании службы.</span><span class="sxs-lookup"><span data-stu-id="c6784-173">Check out [Partitioning Service Fabric services][10] toolearn more about partitioning your service.</span></span>

<!--Image references-->
[Image1]: ./media/SF-Cost.png

<!--Link references--In actual articles, you only need a single period before hello slash-->
[10]: service-fabric-concepts-partitioning.md
