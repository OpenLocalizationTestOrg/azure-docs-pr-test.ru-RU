---
title: "Архитектура службы aaaReliable | Документы Microsoft"
description: "Общие сведения об архитектуре hello надежной службы для служб с отслеживанием состояния и без сохранения состояния"
services: service-fabric
documentationcenter: .net
author: AlanWarwick
manager: timlt
editor: vturecek
ms.assetid: af002ae6-7f6d-4769-b049-82aa1ba0891b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 03/30/2016
ms.author: alanwar
redirect_url: /azure/service-fabric/service-fabric-reliable-services-introduction
ms.openlocfilehash: d2d0ec9600275ae248ab7717be269cc7204a1e4d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="architecture-for-stateful-and-stateless-reliable-services"></a>Архитектура надежных служб с отслеживанием и без отслеживания состояния
Надежная служба Azure Service Fabric может быть с отслеживанием или без отслеживания состояния. Каждый тип службы выполняется в конкретной архитектуре. Эти архитектуры описаны в данной статье.
В разделе hello [Обзор надежные службы](service-fabric-reliable-services-introduction.md) Дополнительные сведения об отличиях hello ручную и автоматическую служб.

## <a name="stateful-reliable-services"></a>Надежные службы с отслеживанием состояния
### <a name="architecture-of-a-stateful-service"></a>Архитектура службы с отслеживанием состояния
![Схема архитектуры службы с отслеживанием состояния](./media/service-fabric-reliable-services-platform-architecture/reliable-stateful-service-architecture.png)

### <a name="stateful-reliable-service"></a>Надежная служба с отслеживанием состояния
С отслеживанием состояния надежной службы могут наследовать от hello StatefulService или StatefulServiceBase класса. Оба этих базовых класса предоставляются платформой Service Fabric. Они предоставляют различные уровни поддержки и абстракции для hello toointerface службы с отслеживанием состояния с Service Fabric — и tooparticipate как служба кластера Service Fabric hello.

Класс StatefulService является производным от класса StatefulServiceBase. StatefulServiceBase предлагает службы большую гибкость, но требует понимания несколько внутренних hello Service Fabric.
. В разделе hello [Обзор надежной службы](service-fabric-reliable-services-introduction.md) и [надежной службы расширенное использование](service-fabric-reliable-services-advanced-usage.md) Дополнительные сведения о hello особенности написания служб с использованием классов StatefulService и StatefulServiceBase hello .

Оба базовых класса управление временем существования hello и роли hello реализации службы. Реализация службы Hello может переопределить виртуальные методы базового класса либо, если реализация службы hello toodo рабочих в эти моменты в жизненный цикл реализацию службы hello — или ему toocreate прослушивателя объекта связи. Обратите внимание, что несмотря на то, что реализация службы может реализовать собственный объект прослушивателя связи, предоставление доступа к ICommunicationListener, hello схеме выше, hello связи прослушиватель реализуется посредством Service Fabric — hello реализация службы использует прослушиватель взаимодействия, реализуемого классом Service Fabric.

С отслеживанием состояния надежной службы использует hello надежного состояния диспетчера tootake преимуществами надежной коллекций. Надежные коллекций структуры локальные данные, которые службы высокой надежности toohello--, они доступны всегда, независимо от того, переход на другой ресурс службы. Каждый тип надежной коллекции реализуется поставщиком надежных состояний.
Дополнительные сведения о надежных коллекций см. в разделе hello [Обзор коллекций надежного](service-fabric-reliable-services-reliable-collections.md).

### <a name="reliable-state-manager-and-state-providers"></a>Диспетчер надежных состояний и поставщики состояний
Диспетчер надежного состояния Hello — hello объект, который управляет поставщики надежного состояния. Он имеет toocreate функции hello, удалять, перечислять и убедитесь, что поставщики надежного состояния hello сохраняемым и высокой доступности. Поставщик надежных состояний — это хранимая структура данных с высокой надежностью, например словарь или очередь.

Каждый поставщик надежного состояние предоставляет интерфейс, который используется toointeract службы с отслеживанием состояния с hello состояние надежного поставщика. Например IReliableDictionary — используется toointerface со словарем надежного hello, а IReliableQueue — используется toointerface надежные очереди сообщений hello. Все состояния Надежные поставщики реализуют интерфейс IReliableState hello.

Диспетчер надежного состояния Hello содержит интерфейс с именем IReliableStateManager, что позволяет tooit доступа из службы с отслеживанием состояния. Поставщики состояния tooreliable интерфейсы возвращаются с помощью IReliableStateManager.

Диспетчер надежного состояния Hello использует архитектуру подключаемых модулей, чтобы новые типы надежного коллекций можно подключить динамически.

словарь надежного Hello и надежной очереди построено hello реализации высокой производительности, с версиями разностного хранилища.

### <a name="transactional-replicator"></a>Репликатор транзакций
Hello транзакционный Репликатор компонент отвечает за обеспечению согласованности hello состояние службы (т. е состояние hello в диспетчер надежного состояния hello и надежного коллекций hello) во всех репликах службой hello. Это также гарантирует, что в журнале hello сохраняется состояние hello. интерфейсы диспетчер надежного состояние Hello с hello транзакционный Репликатор через механизм закрытый.

Транзакционный Репликатор Hello использует протокол toocommunicate сети состояние с другими репликами hello экземпляр службы, чтобы у всех реплик, сведения о состоянии в актуальном состоянии.

Транзакционный Репликатор Hello использует сведения о состоянии журнала toopersist, таким образом, сведения о состоянии hello нечувствительным к процессу или аварийно завершает работу узла. Hello интерфейс toohello журнала — через механизм закрытый.

### <a name="log"></a>Журнал
компонент Hello журнала предоставляет постоянного хранилища высокой производительности, могут быть оптимизированы для записи toospinning или жесткие диски.  Hello hello журнала является для постоянного хранения hello (т. е. жесткие диски) toobe toohello локальных узлов под управлением службы с отслеживанием состояния hello. Это позволяет низкой задержкой и высокой пропускной способности, как сравниваются tooremote постоянного хранилища, не являющийся toohello локального узла.

Hello журнала компонент использует несколько файлов журналов. Отсутствует узел всей общий файл журнала, использовать все реплики, поскольку он обеспечивает наименьшую задержку hello и высокая пропускная способность для хранения данных о состоянии. По умолчанию hello общего журнала помещается в hello Service Fabric узел рабочий каталог, но настроенный toobe помещается в другое расположение, в идеале на диске, зарезервированный для журнала hello общего также может. Каждой реплики для hello службы также содержит файл журнала выделенный и hello выделенный журнала помещается внутри службы hello рабочий каталог. Нет нет механизма tooconfigure hello выделенного журнала toobe помещаются в другое место.

Hello общего журнала является область переходные hello реплика сведений о состоянии, при hello выделенный журнал hello конечное место назначения, где он сохранен. В таком случае сведения о состоянии hello первый файл журнала запись toohello общего и неактивно перемещен toohello выделенного файла журнала в фоновом режиме hello. Таким образом hello общего журнала записи toohello бы hello Наименьшая задержка и высокая пропускная способность, что позволяет быстрее выполняется toomake hello службы.

Считывает и записывает toohello общего журнала выполняются через прямой ввод-вывод toopreallocated на диске hello hello общего файла журнала. tooallow оптимального использования места на диске hello с выделенной журналы, hello выделенный файл журнала создается как разреженный файл NTFS. Обратите внимание, что это позволит избыточного объема места на диске hello ОС будет показывать все файлы журнала hello выделенного с помощью гораздо больше дискового пространства, чем в действительности используется.

Помимо журналов toohello интерфейс минимальное пользовательского режима hello журнал записывается как драйвер режима ядра. С помощью записи драйвер режима ядра hello журнале могут присутствовать hello наивысшая производительность tooall служб, которые его используют.

Дополнительные сведения о настройке журнала hello см. в разделе [Настройка надежных служб с отслеживанием состояния](service-fabric-reliable-services-configuration.md).

## <a name="stateless-reliable-service"></a>Надежная служба без отслеживания состояния
### <a name="architecture-of-a-stateless-service"></a>Архитектура службы без отслеживания состояния
![Схема архитектуры службы без отслеживания состояния](./media/service-fabric-reliable-services-platform-architecture/reliable-stateless-service-architecture.png)

### <a name="stateless-reliable-service"></a>Надежная служба без отслеживания состояния
Реализации службы без учета состояния являются производными от hello StatelessService или StatelessServiceBase класса. Класс StatelessServiceBase Hello позволяет большую гибкость, чем hello StatelessService класса.
Оба базовых класса управление временем существования hello и роли службы.

Реализация службы Hello может переопределить виртуальные методы базового класса либо если hello службы рабочих toodo в эти моменты в жизненный цикл службы hello — или ему toocreate прослушивателя объекта связи. Обратите внимание, что несмотря на то, что служба hello может реализовать собственный объект прослушивателя связи, предоставление доступа к ICommunicationListener, hello схеме выше, hello связи прослушивателя реализуется посредством Service Fabric, реализация службы использует связи прослушиватель, который реализуется Service Fabric.

. В разделе hello [Обзор надежной службы](service-fabric-reliable-services-introduction.md) и [надежной службы расширенное использование](service-fabric-reliable-services-advanced-usage.md) Дополнительные сведения о hello особенности написания служб с использованием классов StatelessService и StatelessServiceBase hello .

<!--Every topic should have next steps and links toohello next logical set of content tookeep hello customer engaged-->
## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о Service Fabric см. в таких статьях:

[Обзор надежных служб](service-fabric-reliable-services-introduction.md)

[Быстрый запуск](service-fabric-reliable-services-quick-start.md)

[Обзор надежных коллекций](service-fabric-reliable-services-reliable-collections.md)

[Продвинутое использование надежных служб](service-fabric-reliable-services-advanced-usage.md)

[Настройка надежных служб](service-fabric-reliable-services-configuration.md)  

