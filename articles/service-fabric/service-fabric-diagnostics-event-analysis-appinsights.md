---
title: "Анализ событий структуры службы с помощью Application Insights aaaAzure | Документы Microsoft"
description: "Ознакомьтесь со сведениями о визуализации и анализе событий с использованием Application Insights для мониторинга и диагностики кластеров Azure Service Fabric."
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/26/2017
ms.author: dekapur
ms.openlocfilehash: 59bb5a409f2951e5b2034049e782dd0da67f933c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="event-analysis-and-visualization-with-application-insights"></a><span data-ttu-id="e8242-103">Анализ и визуализация событий с помощью Application Insights</span><span class="sxs-lookup"><span data-stu-id="e8242-103">Event analysis and visualization with Application Insights</span></span>

<span data-ttu-id="e8242-104">Azure Application Insights — это расширяемая платформа для отслеживания и диагностики приложений.</span><span class="sxs-lookup"><span data-stu-id="e8242-104">Azure Application Insights is an extensible platform for application monitoring and diagnostics.</span></span> <span data-ttu-id="e8242-105">Она включает в себя эффективное средство аналитики и запросов, настраиваемую панель мониторинга, визуализации и дополнительные параметры, включая автоматическое оповещение.</span><span class="sxs-lookup"><span data-stu-id="e8242-105">It includes a powerful analytics and querying tool, customizable dashboard and visualizations, and further options including automated alerting.</span></span> <span data-ttu-id="e8242-106">Это hello, рекомендуется использовать платформу для наблюдения и диагностики для приложения Service Fabric и службы.</span><span class="sxs-lookup"><span data-stu-id="e8242-106">It is hello recommended platform for monitoring and diagnostics for Service Fabric applications and services.</span></span>

## <a name="setting-up-application-insights"></a><span data-ttu-id="e8242-107">Настройка Application Insights</span><span class="sxs-lookup"><span data-stu-id="e8242-107">Setting up Application Insights</span></span>

### <a name="creating-an-ai-resource"></a><span data-ttu-id="e8242-108">Создание ресурса Application Insights</span><span class="sxs-lookup"><span data-stu-id="e8242-108">Creating an AI Resource</span></span>

<span data-ttu-id="e8242-109">ресурс toocreate AI, головной через toohello Azure Marketplace и выполните поиск «Application Insights».</span><span class="sxs-lookup"><span data-stu-id="e8242-109">toocreate an AI resource, head over toohello Azure Marketplace, and search for "Application Insights".</span></span> <span data-ttu-id="e8242-110">Оно должно отображаться hello первое решение (он находится в категории «Mobile Web +»).</span><span class="sxs-lookup"><span data-stu-id="e8242-110">It should show up as hello first solution (it is under category "Web + Mobile").</span></span> <span data-ttu-id="e8242-111">Нажмите кнопку **создать** при просмотре ресурса hello (Убедитесь, что путь к соответствует hello изображении ниже).</span><span class="sxs-lookup"><span data-stu-id="e8242-111">Click **Create** when you are looking at hello right resource (confirm that your path matches hello image below).</span></span>

![Новый ресурс Application Insights](media/service-fabric-diagnostics-event-analysis-appinsights/create-new-ai-resource.png)

<span data-ttu-id="e8242-113">Необходимо будет toofill некоторые сведения tooprovision hello ресурс правильно.</span><span class="sxs-lookup"><span data-stu-id="e8242-113">You will need toofill out some information tooprovision hello resource correctly.</span></span> <span data-ttu-id="e8242-114">В hello *тип приложения* поля, используйте «Веб-приложение ASP.NET» при использовании любого из Service Fabric модели программирования или публикации кластера toohello приложений .NET.</span><span class="sxs-lookup"><span data-stu-id="e8242-114">In hello *Application Type* field, use "ASP.NET web application" if you will be using any of Service Fabric's programming models or publishing a .NET application toohello cluster.</span></span> <span data-ttu-id="e8242-115">Выберите значение "Общее", если вы будете развертывать гостевые исполняемые файлы и контейнеры.</span><span class="sxs-lookup"><span data-stu-id="e8242-115">Use "General" if you will be deploying guest executables and containers.</span></span> <span data-ttu-id="e8242-116">В общем случае tookeep «Веб-приложение ASP.NET» по умолчанию toousing варианты откройте в будущем hello.</span><span class="sxs-lookup"><span data-stu-id="e8242-116">In general, default toousing "ASP.NET web application" tookeep your options open in hello future.</span></span> <span data-ttu-id="e8242-117">Имя Hello работает tooyour предпочтений и группы ресурсов hello и подписки, возможность изменения после развертывания hello ресурса.</span><span class="sxs-lookup"><span data-stu-id="e8242-117">hello name is up tooyour preference, and both hello resource group and subscription are changeable post-deployment of hello resource.</span></span> <span data-ttu-id="e8242-118">Мы рекомендуем ресурса AI возможности hello же группе ресурсов кластера.</span><span class="sxs-lookup"><span data-stu-id="e8242-118">We recommend that your AI resource is in hello same resource group as your cluster.</span></span> <span data-ttu-id="e8242-119">Если вам требуются дополнительные сведения, ознакомьтесь с разделом [Создание ресурса Application Insights](../application-insights/app-insights-create-new-resource.md).</span><span class="sxs-lookup"><span data-stu-id="e8242-119">If you need more information, please see [Create an Application Insights resource](../application-insights/app-insights-create-new-resource.md)</span></span>

<span data-ttu-id="e8242-120">Требуется ключ инструментирования AI hello tooconfigure AI со средством статистической обработки событий.</span><span class="sxs-lookup"><span data-stu-id="e8242-120">You need hello AI Instrumentation Key tooconfigure AI with your event aggregation tool.</span></span> <span data-ttu-id="e8242-121">После настройки ресурса AI (занимает несколько минут после проверки hello развертывания), перейдите tooit и найти hello **свойства** раздел на панели навигации слева hello.</span><span class="sxs-lookup"><span data-stu-id="e8242-121">Once your AI resource is set up (takes a few minutes after hello deployment is validated), navigate tooit and find hello **Properties** section on hello left navigation bar.</span></span> <span data-ttu-id="e8242-122">Откроется новая колонка с *ключом инструментирования*.</span><span class="sxs-lookup"><span data-stu-id="e8242-122">A new blade will open up that shows an *INSTRUMENTATION KEY*.</span></span> <span data-ttu-id="e8242-123">Если требуется toochange hello подписка или группа ресурсов для ресурса hello, это можно сделать здесь также.</span><span class="sxs-lookup"><span data-stu-id="e8242-123">If you need toochange hello subscription or resource group of hello resource, it can be done here as well.</span></span>

### <a name="configuring-ai-with-wad"></a><span data-ttu-id="e8242-124">Настройка Application Insights с помощью WAD</span><span class="sxs-lookup"><span data-stu-id="e8242-124">Configuring AI with WAD</span></span>

<span data-ttu-id="e8242-125">Существует два основных способа toosend данные из WAD tooAzure AI, что можно сделать, добавив AI приемник toohello конфигурация WAD, как описано в [в этой статье](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span><span class="sxs-lookup"><span data-stu-id="e8242-125">There are two primary ways toosend data from WAD tooAzure AI, which is achieved by adding an AI sink toohello WAD configuration, as detailed in [this article](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span></span>

#### <a name="add-an-ai-instrumentation-key-when-creating-a-cluster-in-azure-portal"></a><span data-ttu-id="e8242-126">Добавление ключа инструментирования Application Insights при создании кластера на портале Azure</span><span class="sxs-lookup"><span data-stu-id="e8242-126">Add an AI Instrumentation Key when creating a cluster in Azure portal</span></span>

![Добавление AIKey](media/service-fabric-diagnostics-event-analysis-appinsights/azure-enable-diagnostics.png)

<span data-ttu-id="e8242-128">При создании кластера, если Диагностика включен «», tooenter необязательное поле отображается ключ инструментирования аналитики приложений.</span><span class="sxs-lookup"><span data-stu-id="e8242-128">When creating a cluster, if Diagnostics is turned "On", an optional field tooenter an Application Insights Instrumentation key will show.</span></span> <span data-ttu-id="e8242-129">При вставке здесь вашей IKey AI hello AI приемник будет автоматически настроена для hello шаблона диспетчера ресурсов, используемых toodeploy кластера.</span><span class="sxs-lookup"><span data-stu-id="e8242-129">If you paste your AI IKey here, hello AI sink will be automatically configured for you in hello Resource Manager template that is used toodeploy your cluster.</span></span>

#### <a name="add-hello-ai-sink-toohello-resource-manager-template"></a><span data-ttu-id="e8242-130">Добавить шаблон диспетчера ресурсов toohello приемников AI hello</span><span class="sxs-lookup"><span data-stu-id="e8242-130">Add hello AI Sink toohello Resource Manager template</span></span>

<span data-ttu-id="e8242-131">В hello «WadCfg «hello шаблона диспетчера ресурсов Добавьте «Приемник», включая hello, следующие два изменения:</span><span class="sxs-lookup"><span data-stu-id="e8242-131">In hello "WadCfg" of hello Resource Manager template, add a "Sink" by including hello following two changes:</span></span>

1. <span data-ttu-id="e8242-132">Добавьте конфигурацию приемник hello:</span><span class="sxs-lookup"><span data-stu-id="e8242-132">Add hello sink configuration:</span></span>

    ```json
    "SinksConfig": {
        "Sink": [
            {
                "name": "applicationInsights",
                "ApplicationInsights": "***ADD INSTRUMENTATION KEY HERE***"
            }
        ]
    }

    ```

2. <span data-ttu-id="e8242-133">Включите hello приемник в hello DiagnosticMonitorConfiguration, добавление hello, следующей строкой в «DiagnosticMonitorConfiguration» hello «WadCfg»:</span><span class="sxs-lookup"><span data-stu-id="e8242-133">Include hello Sink in hello DiagnosticMonitorConfiguration by adding hello following line in "DiagnosticMonitorConfiguration" of hello "WadCfg":</span></span>

    ```json
    "sinks": "applicationInsights"
    ```

<span data-ttu-id="e8242-134">В обоих фрагментах кода hello выше hello приемник hello используется toodescribe было имя «applicationInsights».</span><span class="sxs-lookup"><span data-stu-id="e8242-134">In both hello code snippets above, hello name "applicationInsights" was used toodescribe hello sink.</span></span> <span data-ttu-id="e8242-135">Это не является обязательным, и при условии, что имя hello приемника hello включается в «приемники», можно задать строку tooany имени hello.</span><span class="sxs-lookup"><span data-stu-id="e8242-135">This is not a requirement and as long as hello name of hello sink is included in "sinks", you can set hello name tooany string.</span></span>

<span data-ttu-id="e8242-136">В настоящее время журналов из кластера hello отображаются как трассировки в средстве просмотра журналов в AI.</span><span class="sxs-lookup"><span data-stu-id="e8242-136">Currently, logs from hello cluster will show up as traces in AI's log viewer.</span></span> <span data-ttu-id="e8242-137">Поскольку большинство hello трассировок, поступающих из платформы hello имеют уровень «Информационный», можно также рассмотреть изменение hello приемник конфигурации tooonly отправки журналов типа «Критическое» или «Ошибка».</span><span class="sxs-lookup"><span data-stu-id="e8242-137">Since most of hello traces coming from hello platform are of level "Informational", you can also consider changing hello sink configuration tooonly send logs of type "Critical" or "Error".</span></span> <span data-ttu-id="e8242-138">Это можно сделать путем добавления приемника tooyour «Каналы», как показано в [в этой статье](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span><span class="sxs-lookup"><span data-stu-id="e8242-138">This can be done by adding "Channels" tooyour sink, as demonstrated in [this article](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span></span>

>[!NOTE]
><span data-ttu-id="e8242-139">При использовании неверные IKey AI на портале или в шаблон диспетчера ресурсов, необходимо будет toomanually изменение ключа hello и обновление кластера hello / выполнить его повторное развертывание.</span><span class="sxs-lookup"><span data-stu-id="e8242-139">If you use an incorrect AI IKey either in portal or in your Resource Manager template, you will have toomanually change hello key and update hello cluster / redeploy it.</span></span> 

### <a name="configuring-ai-with-eventflow"></a><span data-ttu-id="e8242-140">Настройка Application Insights с помощью EventFlow</span><span class="sxs-lookup"><span data-stu-id="e8242-140">Configuring AI with EventFlow</span></span>

<span data-ttu-id="e8242-141">При использовании EventFlow tooaggregate события, убедитесь, что hello tooimport `Microsoft.Diagnostics.EventFlow.Output.ApplicationInsights`пакет NuGet.</span><span class="sxs-lookup"><span data-stu-id="e8242-141">If you are using EventFlow tooaggregate events, make sure tooimport hello `Microsoft.Diagnostics.EventFlow.Output.ApplicationInsights`NuGet package.</span></span> <span data-ttu-id="e8242-142">Hello следующие имеет состава hello toobe *выводит* раздел hello *eventFlowConfig.json*:</span><span class="sxs-lookup"><span data-stu-id="e8242-142">hello following has toobe included in hello *outputs* section of hello *eventFlowConfig.json*:</span></span>

```json
"outputs": [
    {
        "type": "ApplicationInsights",
        // (replace hello following value with your AI resource's instrumentation key)
        "instrumentationKey": "00000000-0000-0000-0000-000000000000"
    }
]
```

<span data-ttu-id="e8242-143">Внесите изменения hello требуется убедиться, что toomake фильтрах, а также включать другие входные данные (вместе с соответствующими пакетами NuGet).</span><span class="sxs-lookup"><span data-stu-id="e8242-143">Make sure toomake hello required changes in your filters, as well as include any other inputs (along with their respective NuGet packages).</span></span>

## <a name="aisdk"></a><span data-ttu-id="e8242-144">AI.SDK</span><span class="sxs-lookup"><span data-stu-id="e8242-144">AI.SDK</span></span>

<span data-ttu-id="e8242-145">Обычно рекомендуется toouse EventFlow и WAD как решения статистической обработки, так как они позволяют более удобным toodiagnostics подход и наблюдения, т. е. Если требуется toochange вашей выходные данные EventFlow, требуется не фактические изменения tooyour инструментирование, просто файл конфигурации tooyour простое изменение.</span><span class="sxs-lookup"><span data-stu-id="e8242-145">It is generally recommended toouse EventFlow and WAD as aggregation solutions, because they allow for a more modular approach toodiagnostics and monitoring, i.e. if you want toochange your outputs from EventFlow, it requires no change tooyour actual instrumentation, just a simple modification tooyour config file.</span></span> <span data-ttu-id="e8242-146">Если, тем не менее, решить tooinvest с помощью Application Insights и не являются скорее всего toochange tooa другой платформы, следует ознакомиться с помощью аналитики Активов в новый пакет SDK для статистической обработки событий и отправки их tooAI.</span><span class="sxs-lookup"><span data-stu-id="e8242-146">If, however, you decide tooinvest in using Application Insights and are not likely toochange tooa different platform, you should look into using AI's new SDK for aggregating events and sending them tooAI.</span></span> <span data-ttu-id="e8242-147">Это означает, что больше не будет tooconfigure EventFlow toosend вашей tooAI данных, но вместо этого будет установить пакет Service Fabric NuGet hello ApplicationInsight.</span><span class="sxs-lookup"><span data-stu-id="e8242-147">This means that you will no longer have tooconfigure EventFlow toosend your data tooAI, but instead will install hello ApplicationInsight's Service Fabric NuGet package.</span></span> <span data-ttu-id="e8242-148">Можно найти сведения о пакете hello [здесь](https://github.com/Microsoft/ApplicationInsights-ServiceFabric).</span><span class="sxs-lookup"><span data-stu-id="e8242-148">Details on hello package can be found [here](https://github.com/Microsoft/ApplicationInsights-ServiceFabric).</span></span>

<span data-ttu-id="e8242-149">[Поддержка Application Insights Микрослужбами и контейнеры](https://azure.microsoft.com/app-insights-microservices/) показаны некоторые новые функции hello, над которыми ведется работа на (по-прежнему присутствующие в бета-версия), которой позволяют toohave всестороннее out of box параметры мониторинга с помощью аналитики Активов.</span><span class="sxs-lookup"><span data-stu-id="e8242-149">[Application Insights support for Microservices and Containers](https://azure.microsoft.com/app-insights-microservices/) shows you some of hello new features that are being worked on (currently still in beta), which allow you toohave richer out-of-the-box monitoring options with AI.</span></span> <span data-ttu-id="e8242-150">Эти условия включают отслеживание зависимостей (используется для построения служб и приложений в кластере и hello обмен данными между ними AppMap) и более корреляцию трассировок, поступающих от служб (помогает в более точное проблемы в hello рабочий процесс приложения или службы).</span><span class="sxs-lookup"><span data-stu-id="e8242-150">These include dependency tracking (used in building an AppMap of all your services and applications in a cluster and hello communication between them), and better correlation of traces coming from your services (helps in better pinpointing an issue in hello workflow of an app or service).</span></span>

<span data-ttu-id="e8242-151">Если разработка в .NET и, вероятно, с помощью некоторых моделей программирования Service Fabric и являются пойти toouse AI качестве платформы для визуализации и анализа событий и журналов, рекомендуется перейти через hello AI SDK для маршрута наблюдение и рабочий процесс диагностики.</span><span class="sxs-lookup"><span data-stu-id="e8242-151">If you are developing in .NET and will likely be using some of Service Fabric's programming models, and are willing toouse AI as your platform for visualizing and analyzing event and log data, then we recommend that you go via hello AI SDK route as your monitoring and diagnostics workflow.</span></span> <span data-ttu-id="e8242-152">Чтение [это](../application-insights/app-insights-asp-net-more.md) и [это](../application-insights/app-insights-asp-net-trace-logs.md) tooget работу с помощью функции AI toocollect и отображения журналов.</span><span class="sxs-lookup"><span data-stu-id="e8242-152">Read [this](../application-insights/app-insights-asp-net-more.md) and [this](../application-insights/app-insights-asp-net-trace-logs.md) tooget started with using AI toocollect and display your logs.</span></span>

## <a name="navigating-hello-ai-resource-in-azure-portal"></a><span data-ttu-id="e8242-153">Перемещение ресурса AI hello на портале Azure</span><span class="sxs-lookup"><span data-stu-id="e8242-153">Navigating hello AI resource in Azure portal</span></span>

<span data-ttu-id="e8242-154">После настройки аналитики Активов в качестве выходных данных для событий и журналов сведения должно быть запущено tooshow в ресурса AI через несколько минут.</span><span class="sxs-lookup"><span data-stu-id="e8242-154">Once you have configured AI as an output for your events and logs, information should start tooshow up in your AI resource in a few minutes.</span></span> <span data-ttu-id="e8242-155">Перейдите ресурса AI toohello, которая перенаправит вас toohello AI панели мониторинга ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e8242-155">Navigate toohello AI resource, which will take you toohello AI resource dashboard.</span></span> <span data-ttu-id="e8242-156">Нажмите кнопку **поиска** в hello AI задач toosee hello последние трассировки, которые он получил и может toofilter toobe через них.</span><span class="sxs-lookup"><span data-stu-id="e8242-156">Click **Search** in hello AI taskbar toosee hello latest traces that it has received, and toobe able toofilter through them.</span></span>

<span data-ttu-id="e8242-157">*Обозреватель метрик* — это полезное средство для создания пользовательских панелей мониторинга на основе метрик, которые могут предоставляться приложениями, службами и кластером.</span><span class="sxs-lookup"><span data-stu-id="e8242-157">*Metrics Explorer* is a useful tool for creating custom dashboards based on metrics that your applications, services, and cluster may be reporting.</span></span> <span data-ttu-id="e8242-158">В разделе [изучение метрики в Application Insights](../application-insights/app-insights-metrics-explorer.md) tooset копирование несколько диаграмм для текущего пользователя на основе hello данных собираются.</span><span class="sxs-lookup"><span data-stu-id="e8242-158">See [Exploring Metrics in Application Insights](../application-insights/app-insights-metrics-explorer.md) tooset up a few charts for yourself based on hello data you are collecting.</span></span>

<span data-ttu-id="e8242-159">Щелкнув **Analytics** вы перейдете toohello приложения аналитика Analytics портал, где вы можете запрашивать события и трассировки с большей областью и дополнительные возможности.</span><span class="sxs-lookup"><span data-stu-id="e8242-159">Clicking **Analytics** will take you toohello Application Insights Analytics portal, where you can query events and traces with greater scope and optionality.</span></span> <span data-ttu-id="e8242-160">Дополнительные сведения см. в статье [Аналитика в Application Insights](../application-insights/app-insights-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="e8242-160">Read more about this at [Analytics in Application Insights](../application-insights/app-insights-analytics.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="e8242-161">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="e8242-161">Next steps</span></span>

* <span data-ttu-id="e8242-162">[Настройка оповещений в AI](../application-insights/app-insights-alerts.md) toobe уведомления об изменениях в производительности или использования</span><span class="sxs-lookup"><span data-stu-id="e8242-162">[Set up Alerts in AI](../application-insights/app-insights-alerts.md) toobe notified about changes in performance or usage</span></span>
* <span data-ttu-id="e8242-163">[Смарт-обнаружение в Application Insights](../application-insights/app-insights-proactive-diagnostics.md) выполняет упреждающее анализ телеметрии hello, отправляемых tooAI toowarn о потенциальных проблем с производительностью</span><span class="sxs-lookup"><span data-stu-id="e8242-163">[Smart Detection in Application Insights](../application-insights/app-insights-proactive-diagnostics.md) performs a proactive analysis of hello telemetry being sent tooAI toowarn you of potential performance problems</span></span>
