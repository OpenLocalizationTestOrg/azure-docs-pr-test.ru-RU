---
title: "Предоставление доступа к базе данных SQL Azure | Документация Майкрософт"
description: "Предоставление доступа к базе данных SQL Microsoft Azure."
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: 
tags: 
ms.assetid: 8e71b04c-bc38-4153-8f83-f2b14faa31d9
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 02/06/2017
ms.author: rickbyh
ms.openlocfilehash: 0ca1ccd273317d67537d31724d566625a4eb2c85
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="azure-sql-database-access-control"></a><span data-ttu-id="d174e-103">Контроль доступа к базе данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="d174e-103">Azure SQL Database access control</span></span>
<span data-ttu-id="d174e-104">Чтобы обеспечить безопасность, база данных SQL управляет доступом с помощью правил брандмауэра, ограничивающих подключение по IP-адресу, механизмов проверки подлинности, требующих удостоверений пользователей, и методов авторизации, ограничивающих действия и данные для пользователей.</span><span class="sxs-lookup"><span data-stu-id="d174e-104">To provide security, SQL Database controls access with firewall rules limiting connectivity by IP address, authentication mechanisms requiring users to prove their identity, and authorization mechanisms limiting users to specific actions and data.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="d174e-105">Обзор функций защиты в базе данных SQL см. в [этой статье](sql-database-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-105">For an overview of the SQL Database security features, see [SQL security overview](sql-database-security-overview.md).</span></span> <span data-ttu-id="d174e-106">Ознакомьтесь с руководством [Защита базы данных SQL Azure](sql-database-security-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-106">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>

## <a name="firewall-and-firewall-rules"></a><span data-ttu-id="d174e-107">Брандмауэр и правила брандмауэра</span><span class="sxs-lookup"><span data-stu-id="d174e-107">Firewall and firewall rules</span></span>
<span data-ttu-id="d174e-108">База данных SQL Microsoft Azure предоставляет службу реляционных баз данных для Azure и других интернет-приложений.</span><span class="sxs-lookup"><span data-stu-id="d174e-108">Microsoft Azure SQL Database provides a relational database service for Azure and other Internet-based applications.</span></span> <span data-ttu-id="d174e-109">Чтобы защитить ваши данные, брандмауэр запрещает любой доступ к серверу базы данных, пока вы не укажете компьютеры, у которых есть разрешение на доступ.</span><span class="sxs-lookup"><span data-stu-id="d174e-109">To help protect your data, firewalls prevent all access to your database server until you specify which computers have permission.</span></span> <span data-ttu-id="d174e-110">Брандмауэр предоставляет доступ к базам данным на основе исходного IP-адреса каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="d174e-110">The firewall grants access to databases based on the originating IP address of each request.</span></span> <span data-ttu-id="d174e-111">Дополнительные сведения см. в статье [Обзор правил брандмауэра базы данных SQL Azure](sql-database-firewall-configure.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-111">For more information, see [Overview of Azure SQL Database firewall rules](sql-database-firewall-configure.md)</span></span>

<span data-ttu-id="d174e-112">Служба Базы данных SQL Microsoft Azure доступна только на TCP-порте 1433.</span><span class="sxs-lookup"><span data-stu-id="d174e-112">The Azure SQL Database service is only available through TCP port 1433.</span></span> <span data-ttu-id="d174e-113">Для получения доступа к базе данных Azure со своего компьютера убедитесь, что брандмауэр клиентского компьютера пропускает исходящие подключения по протоколу TCP через порт 1433.</span><span class="sxs-lookup"><span data-stu-id="d174e-113">To access a SQL Database from your computer, ensure that your client computer firewall allows outgoing TCP communication on TCP port 1433.</span></span> <span data-ttu-id="d174e-114">Заблокируйте входящие подключения по протоколу TCP через порт 1433, если они не требуются для других приложений.</span><span class="sxs-lookup"><span data-stu-id="d174e-114">If not needed for other applications, block inbound connections on TCP port 1433.</span></span> 

<span data-ttu-id="d174e-115">В рамках процесса подключения все подключения от виртуальных машин Azure будут перенаправлены на другой IP-адрес и порт, уникальный для каждой рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="d174e-115">As part of the connection process, connections from Azure virtual machines are redirected to a different IP address and port, unique for each worker role.</span></span> <span data-ttu-id="d174e-116">Номер порта находится в диапазоне от 11000 до 11999.</span><span class="sxs-lookup"><span data-stu-id="d174e-116">The port number is in the range from 11000 to 11999.</span></span> <span data-ttu-id="d174e-117">Дополнительные сведения о TCP-портах см. в статье [Порты для ADO.NET 4.5, отличные от порта 1433](sql-database-develop-direct-route-ports-adonet-v12.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-117">For more information about TCP ports, see [Ports beyond 1433 for ADO.NET 4.5 and SQL Database2](sql-database-develop-direct-route-ports-adonet-v12.md).</span></span>

## <a name="authentication"></a><span data-ttu-id="d174e-118">Аутентификация</span><span class="sxs-lookup"><span data-stu-id="d174e-118">Authentication</span></span>

<span data-ttu-id="d174e-119">База данных SQL поддерживает два типа аутентификации:</span><span class="sxs-lookup"><span data-stu-id="d174e-119">SQL Database supports two types of authentication:</span></span>

* <span data-ttu-id="d174e-120">**Проверка подлинности SQL** с использованием имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="d174e-120">**SQL Authentication**, which uses a username and password.</span></span> <span data-ttu-id="d174e-121">При создании логического сервера для базы данных вы указали имя для входа "Администратор сервера" и пароль.</span><span class="sxs-lookup"><span data-stu-id="d174e-121">When you created the logical server for your database, you specified a "server admin" login with a username and password.</span></span> <span data-ttu-id="d174e-122">Используя эти учетные данные, можно выполнить проверку подлинности для любой базы данных на этом сервере в качестве владельца базы данных (или "dbo").</span><span class="sxs-lookup"><span data-stu-id="d174e-122">Using these credentials, you can authenticate to any database on that server as the database owner, or "dbo."</span></span> 
* <span data-ttu-id="d174e-123">**Проверка подлинности Azure Active Directory** с использованием удостоверений, контролируемых Azure Active Directory, которая поддерживается управляемыми и интегрированными доменами.</span><span class="sxs-lookup"><span data-stu-id="d174e-123">**Azure Active Directory Authentication**, which uses identities managed by Azure Active Directory and is supported for managed and integrated domains.</span></span> <span data-ttu-id="d174e-124">[По возможности](https://docs.microsoft.com/sql/relational-databases/security/choose-an-authentication-mode) используйте проверку подлинности Active Directory (встроенная безопасность).</span><span class="sxs-lookup"><span data-stu-id="d174e-124">Use Active Directory authentication (integrated security) [whenever possible](https://docs.microsoft.com/sql/relational-databases/security/choose-an-authentication-mode).</span></span> <span data-ttu-id="d174e-125">Если вы хотите использовать аутентификацию Azure Active Directory, необходимо создать другого администратора сервера с именем Azure AD admin, которому разрешено администрировать пользователей и группы Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d174e-125">If you want to use Azure Active Directory Authentication, you must create another server admin called the "Azure AD admin," which is allowed to administer Azure AD users and groups.</span></span> <span data-ttu-id="d174e-126">Этот администратор также может выполнять все операции, доступные обычному администратору.</span><span class="sxs-lookup"><span data-stu-id="d174e-126">This admin can also perform all operations that a regular server admin can.</span></span> <span data-ttu-id="d174e-127">В разделе [Подключение к базе данных SQL с использованием проверки подлинности Azure Active Directory](sql-database-aad-authentication.md) содержится пошаговое руководство по созданию администратора Azure AD для включения аутентификации Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d174e-127">See [Connecting to SQL Database By Using Azure Active Directory Authentication](sql-database-aad-authentication.md) for a walkthrough of how to create an Azure AD admin to enable Azure Active Directory Authentication.</span></span>

<span data-ttu-id="d174e-128">Ядро СУБД закрывает подключения, которые оставались неактивными более 30 минут.</span><span class="sxs-lookup"><span data-stu-id="d174e-128">The Database Engine closes connections that remain idle for more than 30 minutes.</span></span> <span data-ttu-id="d174e-129">Перед использованием подключения необходимо выполнить вход повторно.</span><span class="sxs-lookup"><span data-stu-id="d174e-129">The connection must login again before it can be used.</span></span> <span data-ttu-id="d174e-130">Для постоянных активных подключений к базе данных SQL требуется повторная авторизация (выполняется ядром СУБД) по крайней мере каждые 10 часов.</span><span class="sxs-lookup"><span data-stu-id="d174e-130">Continuously active connections to SQL Database require reauthorization (performed by the database engine) at least every 10 hours.</span></span> <span data-ttu-id="d174e-131">Ядро СУБД пытается пройти повторную авторизацию с помощью изначально предоставленного пароля и не требует выполнения каких-либо действий со стороны пользователя.</span><span class="sxs-lookup"><span data-stu-id="d174e-131">The database engine attempts reauthorization using the originally submitted password and no user input is required.</span></span> <span data-ttu-id="d174e-132">Для повышения производительности после сброса пароля в Базе данных SQL повторная аутентификация подключения не выполняется, даже если это подключение сброшено из-за пула подключений.</span><span class="sxs-lookup"><span data-stu-id="d174e-132">For performance reasons, when a password is reset in SQL Database, the connection is not be reauthenticated, even if the connection is reset due to connection pooling.</span></span> <span data-ttu-id="d174e-133">В этом состоит отличие от поведения локального экземпляра SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d174e-133">This is different from the behavior of on-premises SQL Server.</span></span> <span data-ttu-id="d174e-134">Если со времени первой авторизации подключения пароль был изменен, произойдет разрыв подключения, а новое подключение будет установлено с использованием нового пароля.</span><span class="sxs-lookup"><span data-stu-id="d174e-134">If the password has been changed since the connection was initially authorized, the connection must be terminated and a new connection made using the new password.</span></span> <span data-ttu-id="d174e-135">Пользователь с разрешением `KILL DATABASE CONNECTION` может явно разорвать подключение к базе данных SQL с помощью команды [KILL](https://docs.microsoft.com/sql/t-sql/language-elements/kill-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d174e-135">A user with the `KILL DATABASE CONNECTION` permission can explicitly terminate a connection to SQL Database by using the [KILL](https://docs.microsoft.com/sql/t-sql/language-elements/kill-transact-sql) command.</span></span>

<span data-ttu-id="d174e-136">Учетные записи пользователей можно создать в базе данных master (и предоставить им разрешения во всех базах данных на сервере) или в самой базе данных (так называемые автономные пользователи).</span><span class="sxs-lookup"><span data-stu-id="d174e-136">User accounts can be created in the master database and can be granted permissions in all databases on the server, or they can be created in the database itself (called contained users).</span></span> <span data-ttu-id="d174e-137">Сведения о создании имен для входа и управлении ими см. в [этой статье](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-137">For information on creating and managing logins, see [Manage logins](sql-database-manage-logins.md).</span></span> <span data-ttu-id="d174e-138">Для улучшения переносимости и масштабируемости используйте пользователей автономной базы данных.</span><span class="sxs-lookup"><span data-stu-id="d174e-138">To enhance portability and scalabilty, use contained database users to enhance scalability.</span></span> <span data-ttu-id="d174e-139">Дополнительные сведения об автономных пользователях см. в статьях [Пользователи автономной базы данных — создание переносимой базы данных](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable), [CREATE USER (Transact-SQL)](https://docs.microsoft.com/sql/t-sql/statements/create-user-transact-sql) и [Автономные базы данных](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases).</span><span class="sxs-lookup"><span data-stu-id="d174e-139">For more information on contained users, see [Contained Database Users - Making Your Database Portable](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable), [CREATE USER (Transact-SQL)](https://docs.microsoft.com/sql/t-sql/statements/create-user-transact-sql), and [Contained Databases](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases).</span></span>

<span data-ttu-id="d174e-140">Но рекомендуется, чтобы приложение использовало отдельную учетную запись для проверки подлинности. Это позволит ограничить разрешения, предоставляемые приложению, и снизить риски вредоносных действий в случае, если оно уязвимо для атак путем внедрения кода SQL.</span><span class="sxs-lookup"><span data-stu-id="d174e-140">As a best practice your application should use a dedicated account to authenticate -- this way you can limit the permissions granted to the application and reduce the risks of malicious activity in case your application code is vulnerable to a SQL injection attack.</span></span> <span data-ttu-id="d174e-141">В этом случае мы рекомендуем создать [пользователя автономной базы данных](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable), что позволяет приложению выполнять проверку подлинности непосредственно в базе данных.</span><span class="sxs-lookup"><span data-stu-id="d174e-141">The recommended approach is to create a [contained database user](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable), which allows your app to authenticate directly to the database.</span></span> 

## <a name="authorization"></a><span data-ttu-id="d174e-142">Авторизация</span><span class="sxs-lookup"><span data-stu-id="d174e-142">Authorization</span></span>

<span data-ttu-id="d174e-143">Авторизация подразумевает набор действий, которые пользователь может выполнять в базе данных SQL Azure. Такой набор действий определяется принадлежностью к [ролям](https://docs.microsoft.com/sql/relational-databases/security/authentication-access/database-level-roles) базы данных учетной записи пользователя и [разрешениями на уровне объектов](https://docs.microsoft.com/sql/relational-databases/security/permissions-database-engine).</span><span class="sxs-lookup"><span data-stu-id="d174e-143">Authorization refers to what a user can do within an Azure SQL Database, and this is controlled by your user account's database [role memberships](https://docs.microsoft.com/sql/relational-databases/security/authentication-access/database-level-roles) and [object-level permissions](https://docs.microsoft.com/sql/relational-databases/security/permissions-database-engine).</span></span> <span data-ttu-id="d174e-144">Обычно пользователям рекомендуется предоставлять наименьшие необходимые привилегии.</span><span class="sxs-lookup"><span data-stu-id="d174e-144">As a best practice, you should grant users the least privileges necessary.</span></span> <span data-ttu-id="d174e-145">Учетной записи администратора сервера, которая используется для подключения, присвоена роль db_owner, обладатель которой может выполнять любые действия в базе данных.</span><span class="sxs-lookup"><span data-stu-id="d174e-145">The server admin account you are connecting with is a member of db_owner, which has authority to do anything within the database.</span></span> <span data-ttu-id="d174e-146">Сохраните эту учетную запись для развертывания обновлений схемы и выполнения других действий по управлению.</span><span class="sxs-lookup"><span data-stu-id="d174e-146">Save this account for deploying schema upgrades and other management operations.</span></span> <span data-ttu-id="d174e-147">Для подключения к базе данных из приложения с использованием наименьших привилегий, необходимых приложению, используйте учетную запись "ApplicationUser" с более ограниченными разрешениями.</span><span class="sxs-lookup"><span data-stu-id="d174e-147">Use the "ApplicationUser" account with more limited permissions to connect from your application to the database with the least privileges needed by your application.</span></span> <span data-ttu-id="d174e-148">Дополнительные сведения см. в статье [Проверка подлинности и авторизация в базе данных SQL: предоставление доступа](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-148">For more information, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="d174e-149">Как правило, доступ к базе данных `master` нужен только администраторам.</span><span class="sxs-lookup"><span data-stu-id="d174e-149">Typically, only administrators need access to the `master` database.</span></span> <span data-ttu-id="d174e-150">Постоянный доступ к каждой пользовательской базе данных должен обеспечиваться через пользователей автономной базы данных, созданных в каждой базе данных и не являющихся администраторами.</span><span class="sxs-lookup"><span data-stu-id="d174e-150">Routine access to each user database should be through non-administrator contained database users created in each database.</span></span> <span data-ttu-id="d174e-151">В этом случае создавать имена входа в базе данных `master` не требуется.</span><span class="sxs-lookup"><span data-stu-id="d174e-151">When you use contained database users, you do not need to create logins in the `master` database.</span></span> <span data-ttu-id="d174e-152">Дополнительные сведения см. в статье [Пользователи автономной базы данных — создание переносимой базы данных](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable).</span><span class="sxs-lookup"><span data-stu-id="d174e-152">For more information, see [Contained Database Users - Making Your Database Portable](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable).</span></span>

<span data-ttu-id="d174e-153">Ознакомьтесь со следующими возможностями, которые можно использовать, чтобы ограничить или расширить права:</span><span class="sxs-lookup"><span data-stu-id="d174e-153">You should familiarize yourself with the following features that can be used to limit or elevate permissions:</span></span>   
* <span data-ttu-id="d174e-154">Чтобы безопасно временно повысить уровень разрешений, можно использовать [олицетворение](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server) и [подписание модулей](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/signing-stored-procedures-in-sql-server).</span><span class="sxs-lookup"><span data-stu-id="d174e-154">[Impersonation](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server) and [module-signing](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/signing-stored-procedures-in-sql-server) can be used to securely elevate permissions temporarily.</span></span>
* <span data-ttu-id="d174e-155">[Безопасности на уровне строк](https://docs.microsoft.com/sql/relational-databases/security/row-level-security) может использоваться, чтобы ограничить доступ пользователя к строкам.</span><span class="sxs-lookup"><span data-stu-id="d174e-155">[Row-Level Security](https://docs.microsoft.com/sql/relational-databases/security/row-level-security) can be used limit which rows a user can access.</span></span>
* <span data-ttu-id="d174e-156">[Маскирование данных](sql-database-dynamic-data-masking-get-started.md) позволяет снизить уязвимость конфиденциальных данных.</span><span class="sxs-lookup"><span data-stu-id="d174e-156">[Data Masking](sql-database-dynamic-data-masking-get-started.md) can be used to limit exposure of sensitive data.</span></span>
* <span data-ttu-id="d174e-157">[хранимые процедуры](https://docs.microsoft.com/sql/relational-databases/stored-procedures/stored-procedures-database-engine) .</span><span class="sxs-lookup"><span data-stu-id="d174e-157">[Stored procedures](https://docs.microsoft.com/sql/relational-databases/stored-procedures/stored-procedures-database-engine) can be used to limit the actions that can be taken on the database.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d174e-158">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d174e-158">Next steps</span></span>

- <span data-ttu-id="d174e-159">Обзор функций защиты в базе данных SQL см. в [этой статье](sql-database-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-159">For an overview of the SQL Database security features, see [SQL security overview](sql-database-security-overview.md).</span></span>
- <span data-ttu-id="d174e-160">Общие сведения о правилах брандмауэра см. в [этой статье](sql-database-firewall-configure.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-160">To learn more about firewall rules, see [Firewall rules](sql-database-firewall-configure.md).</span></span>
- <span data-ttu-id="d174e-161">Сведения о пользователях и имена для входа см. в статье [Проверка подлинности и авторизация в базе данных SQL: предоставление доступа](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-161">To learn about users and logins, see [Manage logins](sql-database-manage-logins.md).</span></span> 
- <span data-ttu-id="d174e-162">Описание упреждающего мониторинга см. во вводных статьях об [аудите базы данных](sql-database-auditing.md) и [системе обнаружения угроз базы данных SQL](sql-database-threat-detection.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-162">For a discussion of proactive monitoring, see [Database Auditing](sql-database-auditing.md) and [SQL Database Threat Detection](sql-database-threat-detection.md).</span></span>
- <span data-ttu-id="d174e-163">Ознакомьтесь с руководством [Защита базы данных SQL Azure](sql-database-security-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="d174e-163">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>
