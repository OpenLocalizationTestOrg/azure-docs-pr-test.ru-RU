---
title: "aaaOperating хранилище запросов в базе данных SQL Azure"
description: "Узнайте, как toooperate hello хранилище запросов в базе данных SQL Azure"
keywords: 
services: sql-database
documentationcenter: 
author: bonova
manager: jhubbard
editor: 
ms.assetid: 0cccf6bd-1327-44f7-a6f9-8eff0c210463
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: sqldb-performance
ms.workload: data-management
ms.date: 11/08/2016
ms.author: bonova
ms.openlocfilehash: ab741e49685bf6df3bceab219aaf57ea51cdb25d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="operating-hello-query-store-in-azure-sql-database"></a>Hello работы хранилища запросов в базе данных SQL Azure
Хранилище запросов в Azure является полностью управляемой службой базы данных, которая непрерывно собирает и предоставляет подробные статистические сведения обо всех запросах. О хранилище запросов можно представить как аналогичные самолет tooan бортовому регистратору данных, значительно упрощает производительность запросов, устранение неполадок для облачных и локальных клиентов. В этой статье объясняются некоторые аспекты управления хранилищем запросов в Azure. С помощью предварительно собранных данных о запросах можно быстро диагностировать и устранять проблемы с производительностью, что позволяет уделять больше времени основным рабочим задачам. 

Хранилище запросов [глобально доступно](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) в базе данных SQL Azure с ноября 2015 г. Хранилище запросов — основа hello для анализа производительности и настройки компонентов, таких как [помощник по настройке ядра базы данных SQL и панели мониторинга производительности](https://azure.microsoft.com/updates/sqldatabaseadvisorga/). На момент публикации в этой статье hello хранилище запросов работает в более чем 200 000 пользовательских баз данных в Azure, сбор данных, связанных с запросами, для нескольких месяцев, без прерывания.

> [!IMPORTANT]
> Корпорация Майкрософт обладает hello процесс активации хранилище запросов для всех баз данных Azure SQL (существующие и новые). 
> 
> 

## <a name="optimal-query-store-configuration"></a>Оптимальная конфигурация хранилища запросов
В этом разделе описываются значения по умолчанию для обеспечения оптимальной, спроектированный tooensure надежной работы хранилища запросов hello и зависимые компоненты, такие как [помощник по настройке ядра базы данных SQL и панели мониторинга производительности](https://azure.microsoft.com/updates/sqldatabaseadvisorga/). По умолчанию конфигурация оптимизирована для постоянного сбора данных, т. е. для минимальной продолжительности состояний "Отключено" и "Только для чтения".

| Конфигурация | Description (Описание) | значение по умолчанию | Комментарий |
| --- | --- | --- | --- |
| MAX_STORAGE_SIZE_MB |Указывает hello предельный объем пространства данных hello, который может занимать хранилище запросов в базу данных клиентов z |100 |Принудительно для новых баз данных |
| INTERVAL_LENGTH_MINUTES |Определяет время, в течение которого объединяются и сохраняются собранные статистические данные среды выполнения по планам запросов. Для каждого активного плана запроса в течение периода, заданного в этом параметре, будет сохраняться только одна строка. |60 |Принудительно для новых баз данных |
| STALE_QUERY_THRESHOLD_DAYS |Политика очистки на основе времени, которая управляет hello сроком хранения статистики среды выполнения и неактивных запросов |30 |Принудительно для новых баз данных и баз данных с предыдущим значением по умолчанию (367) |
| SIZE_BASED_CLEANUP_MODE |Указывает, является ли автоматическая очистка имеет место при исчерпании размер хранилища запросов данные hello |AUTO (АВТОМАТИЧЕСКИ) |Принудительно для всех баз данных |
| QUERY_CAPTURE_MODE |Указывает, следует ли отслеживать все запросы или только определенное подмножество. |AUTO (АВТОМАТИЧЕСКИ) |Принудительно для всех баз данных |
| FLUSH_INTERVAL_SECONDS |Указывает максимальный период, в течение которого записанный среды выполнения статистику в памяти, перед сбросом toodisk |900 |Принудительно для новых баз данных |
|  | | | |

> [!IMPORTANT]
> Эти значения по умолчанию будут автоматически применяться hello заключительном этапе активации хранилище запросов во всех базах данных Azure SQL (см. выше важное примечание). После этой точки зрения копии базы данных SQL Azure не будут изменены значения конфигурации, установленные клиентами, если только они негативно сказаться на основную рабочую нагрузку или надежных операций hello хранилища запросов.
> 
> 

Toostay с помощью настраиваемых параметров, используйте [инструкции ALTER DATABASE с помощью параметров хранилища запросов](https://msdn.microsoft.com/library/bb522682.aspx) toorevert конфигурации toohello предыдущее состояние. Извлечение [Best Practices with hello хранилище запросов](https://msdn.microsoft.com/library/mt604821.aspx) в порядке toolearn как верхний выбрать оптимальную конфигурацию параметров.

## <a name="next-steps"></a>Дальнейшие действия
[Анализ производительности базы данных SQL](sql-database-performance.md)

## <a name="additional-resources"></a>Дополнительные ресурсы
Дополнительные сведения о получение для изменения hello в следующих статьях:

* [Query Store: A flight data recorder for your database (Хранилище запросов: "бортовой самописец" для вашей базы данных)](https://azure.microsoft.com/blog/query-store-a-flight-data-recorder-for-your-database) 
* [Мониторинг производительности с помощью хранилища запросов hello](https://msdn.microsoft.com/library/dn817826.aspx)
* [Query Store Usage Scenarios (Сценарии использования хранилища запросов)](https://msdn.microsoft.com/library/mt614796.aspx)
* [Мониторинг производительности с помощью хранилища запросов hello](https://msdn.microsoft.com/library/dn817826.aspx) 

