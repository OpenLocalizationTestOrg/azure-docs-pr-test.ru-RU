---
title: "Применение рекомендаций по производительности для Базы данных SQL Azure | Документация Майкрософт"
description: "Рекомендации по производительности, позволяющие оптимизировать работу Базы данных SQL Azure или устранить обнаруженные проблемы в рабочей нагрузке, можно найти на портале Azure."
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: cda8a646-0584-4368-b28a-85cdd9b54fcd
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/05/2017
ms.author: sstein
ms.openlocfilehash: 018afaa8b08bd001e55693390e80c8e2c4f33a30
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="find-and-apply-performance-recommendations"></a>Поиск и применение рекомендаций по производительности

Рекомендации по производительности, позволяющие оптимизировать работу Базы данных SQL Azure или устранить обнаруженные проблемы в рабочей нагрузке, можно найти на портале Azure. На странице **Рекомендации по производительности** на портале Azure можно найти лучшие рекомендации, упорядоченные по потенциальному воздействию. 

## <a name="viewing-recommendations"></a>Просмотр рекомендаций

Чтобы просмотреть и применить рекомендации по производительности, необходимо изменить разрешения [управления доступом на основе ролей](../active-directory/role-based-access-control-what-is.md) в Azure. Разрешения **Читатель** и **Участник баз данных SQL** необходимы для просмотра рекомендаций, а разрешения **Владелец**, **Участник баз данных SQL** необходимы для выполнения действий: создание, удаление индекса и отмена создания индекса.

Чтобы найти рекомендации по производительности на портале Azure, выполните следующее.

1. Войдите на [портал Azure](https://portal.azure.com/).
2. Щелкните **Больше служб** > **Базы данных SQL** и выберите свою базу данных.
3. Перейдите на страницу **Рекомендации по производительности**, чтобы просмотреть доступные рекомендации для выбранной базы данных.

Рекомендации по производительности показаны в таблице, как на приведенном ниже рисунке.

![Рекомендации](./media/sql-database-advisor-portal/recommendations.png)

Рекомендации сортируются по их возможному влиянию на производительность и делятся на следующие категории:

| Влияние | Описание |
|:--- |:--- |
| Высокий |Рекомендации с высоким уровнем влияния должны обеспечить наиболее значимое изменение производительности. |
| Средний |Рекомендации со средним уровнем влияния должны улучшить производительность, но не существенным образом. |
| Низкий |Рекомендации с низким уровнем влияния должны улучшить производительность, но улучшения не будут значительными. |


> [!NOTE]
> Базе данных SQL Azure требуется отслеживать действия по крайней в течение дня, чтобы определить некоторые рекомендации. База данных SQL Azure может обеспечить более эффективную оптимизацию при стабильном потоке запросов, чем на основе случайных всплесков активности. Если доступных рекомендаций в настоящее время нет, на странице **Рекомендации по производительности** будет указана причина.
> 

Здесь же можно увидеть состояние последних операций. Выберите рекомендацию или состояние, чтобы увидеть дополнительные сведения.

Ниже приведен пример рекомендации по созданию индекса на портале Azure.

![Создание индекса](./media/sql-database-advisor-portal/sql-database-performance-recommendation.png)

## <a name="applying-recommendations"></a>Применение рекомендаций
База данных SQL Azure предоставляет полный контроль над применением рекомендаций с помощью следующих трех параметров: 

* применять отдельные рекомендаций по одной;
* включить автоматическую настройку для автоматического применения рекомендаций;
* запустить рекомендованный сценарий T-SQL для выполнения рекомендации в базе данных вручную.

Выберите рекомендацию, чтобы просмотреть ее описание, и щелкните **Показать скрипт**, чтобы узнать, как будет создана рекомендация.

База данных остается в сети, пока применяется рекомендация. Применение рекомендации по производительности или автоматическая настройка никогда не отключает базу данных от сети.

### <a name="apply-an-individual-recommendation"></a>Применение отдельной рекомендации
Рекомендации можно просматривать и применять по одной.

1. В колонке **Рекомендации** щелкните рекомендацию.
2. В колонке **Сведения** нажмите кнопку **Применить**.
   
    ![Применить рекомендацию](./media/sql-database-advisor-portal/apply.png)

Выбранная рекомендация будет применена к базе данных.

### <a name="removing-recommendations-from-the-list"></a>Удаление рекомендаций из списка
Если какие-либо рекомендации в списке нужно удалить, отклоните соответствующую рекомендацию, выполнив описанные ниже действия.

1. Выберите рекомендацию из списка **Рекомендации**, чтобы открыть сведения о ней.
2. Щелкните **Отклонить** в колонке **Сведения**.

При необходимости отклоненные рекомендации можно вернуть в список **Рекомендации** , выполнив следующие действия.

1. В колонке **Рекомендации** щелкните **Представление отклонено**.
2. Выберите отклоненный элемент из списка, чтобы просмотреть сведения о нем.
3. При необходимости щелкните **Отменить отклонение**, чтобы вернуть индекс обратно в основной список рекомендаций в колонке **Рекомендации**.


### <a name="enable-automatic-tuning"></a>Включение автоматической настройки
Базу данных SQL Azure можно настроить для автоматического применения рекомендаций. В этом случае появляющиеся рекомендации будут применяться автоматически. Как и для всех рекомендаций, управляемых службой, если выполнение рекомендации ведет к ухудшению производительности, она отменяется.

1. В колонке **Рекомендации** щелкните **Автоматизация**.
   
    ![Настройки помощника](./media/sql-database-advisor-portal/settings.png)
2. Выберите действия для автоматизации.
   
    ![Рекомендованные индексы](./media/sql-database-advisor-portal/automation.png)

### <a name="manually-run-the-recommended-t-sql-script"></a>Выполнение рекомендованного сценария T-SQL вручную
Выберите рекомендацию и щелкните **Показать скрипт**. Выполните этот сценарий для базы данных, чтобы применить рекомендацию вручную.

*Для индексов, созданных вручную, не выполняется мониторинг и проверка влияния на производительность службы,* поэтому после создания индекса убедитесь в том, что он действительно повысил производительность, и при необходимости измените или удалите этот индекс. Дополнительные сведения о создании индексов см. в статье [CREATE INDEX (Transact-SQL)](https://msdn.microsoft.com/library/ms188783.aspx).

### <a name="canceling-recommendations"></a>Отмена рекомендаций
Рекомендации с состоянием **Ожидание**, **Проверка** или **Успешно** можно отменить. Рекомендация с состоянием **Выполняется** не может быть отменена.

1. Выберите рекомендацию в области **Журнал настройки**, чтобы открыть колонку **сведений о рекомендации**.
2. Щелкните **Отменить** , чтобы прервать процесс применения рекомендации.

## <a name="monitoring-operations"></a>Мониторинг операций
Применение рекомендаций может происходить не мгновенно. Портал предоставляет сведения о состоянии рекомендации. Ниже перечислены состояния, в которых может находиться индекс.

| Состояние | Описание |
|:--- |:--- |
| Ожидает |Команда на применение рекомендации получена и запланирована для выполнения. |
| Выполняется |Идет применение рекомендации. |
| Проверка |Рекомендация успешно применена, и служба он оценивает полученные преимущества. |
| Успешно |Рекомендация успешно применена, и преимущества были оценены. |
| Ошибка |В процессе применения рекомендации возникла ошибка. Это может быть временной проблемой, либо это может быть результатом изменения схемы, в результате чего скрипт больше не работает. |
| Возврат |Рекомендация была применена, но не дала существенного улучшения и была автоматически отменена. |
| Отмена |Рекомендация была отменена. |

Щелкните внутрипроцессную рекомендацию в списке, чтобы увидеть дополнительные сведения о ней:

![Рекомендованные индексы](./media/sql-database-advisor-portal/operations.png)

### <a name="reverting-a-recommendation"></a>Отмена рекомендации
Если для применения рекомендации использовалась страница "Рекомендации по производительности" (то есть вы не запускали сценарий T-SQL вручную), эта рекомендация будет автоматически отменена, если выяснится, что она понизила производительность. Если по какой-то причине рекомендацию необходимо отменить, выполните указанные ниже действия.

1. Выберите успешно примененную рекомендацию в области **Журнал настройки** .
2. Щелкните **Отменить** в колонке **сведений о рекомендации**.

![Рекомендованные индексы](./media/sql-database-advisor-portal/details.png)

## <a name="monitoring-performance-impact-of-index-recommendations"></a>Мониторинг влияния рекомендаций по индексам на производительность
После успешного применения рекомендаций (в настоящее время доступны только рекомендации по операциям с индексами и параметризации запросов) щелкните **Подробные сведения о запросе** в колонке сведений о рекомендации, чтобы отобразить [анализ производительности запросов](sql-database-query-performance.md) и просмотреть влияние на производительность ваших основных запросов.

![Мониторинг влияния на производительность](./media/sql-database-advisor-portal/query-insights.png)

## <a name="summary"></a>Сводка
База данных SQL Azure предоставляет рекомендации по производительности базы данных SQL. Благодаря сценариям T-SQL, а также возможностям индивидуального или полностью автоматизированного управления вы получаете помощь в оптимизации базы данных и, таким образом, можете значительно повысить производительность запросов.

## <a name="next-steps"></a>Дальнейшие действия
Отслеживайте рекомендации и продолжайте применять их для повышения производительности. Рабочие нагрузки базы данных являются динамическими и меняются непрерывно. База данных SQL Azure продолжит отслеживать работу и давать рекомендации, которые могут повысить производительность базы данных. 

* Прочитайте раздел [Автоматическая настройка](sql-database-automatic-tuning.md), чтобы узнать больше об автоматической настройке в базе данных SQL Azure.
* Общие сведения о рекомендациях по производительности базы данных SQL Azure см. в статье [Помощник по работе с базами данных SQL](sql-database-advisor.md).
* См. статью [Анализ производительности запросов базы данных Azure SQL](sql-database-query-performance.md), чтобы узнать о том, как просмотреть влияние на производительность основных запросов.

## <a name="additional-resources"></a>Дополнительные ресурсы
* [Хранилище запросов](https://msdn.microsoft.com/library/dn817826.aspx)
* [CREATE INDEX](https://msdn.microsoft.com/library/ms188783.aspx)
* [Контроль доступа на основе ролей](../active-directory/role-based-access-control-what-is.md)

