---
title: "aaaFailover групп и активной георепликации - базы данных SQL Azure | Документы Microsoft"
description: "Группы автоматического перехода на другой ресурс с активной георепликации позволяет toosetup 4 реплик базы данных в любом hello центрами обработки данных Azure и отработки отказа autoomatically hello для события сбоя."
services: sql-database
documentationcenter: na
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 2a29f657-82fb-4283-9a83-e14a144bfd93
ms.service: sql-database
ms.custom: business continuity
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: NA
ms.date: 07/10/2017
ms.author: sashan
ms.openlocfilehash: 7a39af8505624c0f19c5abccff051af836b1f9bc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="overview-failover-groups-and-active-geo-replication"></a><span data-ttu-id="38f89-103">Обзор. Группы отработки отказа и активная георепликация</span><span class="sxs-lookup"><span data-stu-id="38f89-103">Overview: Failover groups and active geo-replication</span></span>
<span data-ttu-id="38f89-104">Активная георепликация обеспечивает tooconfigure копирование toofour для чтения базы данных-получатели hello тот же или другой центр обработки данных расположения (регионы).</span><span class="sxs-lookup"><span data-stu-id="38f89-104">Active geo-replication enables you tooconfigure up toofour readable secondary databases in hello same or different data center locations (regions).</span></span> <span data-ttu-id="38f89-105">Базы данных-получатели доступны для запросов, а также для перехода на другой ресурс в случае hello данных center простоя или hello невозможности tooconnect toohello базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="38f89-105">Secondary databases are available for querying and for failover in hello case of a data center outage or hello inability tooconnect toohello primary database.</span></span> <span data-ttu-id="38f89-106">Hello перехода на другой ресурс инициируется вручную hello приложения hello пользователя.</span><span class="sxs-lookup"><span data-stu-id="38f89-106">hello failover must be initiated manually by hello application of hello user.</span></span> <span data-ttu-id="38f89-107">После отработки отказа новый основной hello имеет конечную точку соединения для различных.</span><span class="sxs-lookup"><span data-stu-id="38f89-107">After failover, hello new primary has a different connection end-point.</span></span> 

> [!NOTE]
> <span data-ttu-id="38f89-108">Активная георепликация доступна для всех баз данных и всех уровней обслуживания во всех регионах.</span><span class="sxs-lookup"><span data-stu-id="38f89-108">Active geo-replication is available for all databases in all service tiers in all regions.</span></span>
>  

<span data-ttu-id="38f89-109">Групп автоматического перехода на другой ресурс базы данных SQL Azure (в предварительного просмотра) — Управление tooautomatically функция, предназначенная базы данных SQL георепликации, подключение и переход на другой ресурс в масштабе.</span><span class="sxs-lookup"><span data-stu-id="38f89-109">Azure SQL Database auto-failover groups (in-preview) is a SQL Database feature designed tooautomatically manage geo-replication relationship, connectivity, and failover at scale.</span></span> <span data-ttu-id="38f89-110">С его помощью hello клиентов прибыль hello возможность tooautomatically восстановление связанных баз данных в дополнительный регион hello после разрушительного сбоя региональные или других незапланированных событий, которые приводят к полной или частичной потере hello служба базы данных SQL доступность в основном регионе hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-110">With it, hello customers gain hello ability tooautomatically recover multiple related databases in hello secondary region after catastrophic regional failures or other unplanned events that result in full or partial loss of hello SQL Database service’s availability in hello primary region.</span></span> <span data-ttu-id="38f89-111">Кроме того они могут использовать hello баз данных-получателей для чтения toooffload нагрузкам только для чтения.</span><span class="sxs-lookup"><span data-stu-id="38f89-111">Additionally, they can use hello readable secondary databases toooffload read-only workloads.</span></span>  <span data-ttu-id="38f89-112">Так как автоматического перехода на другой ресурс группы включают несколько баз данных они должны быть настроены на сервере-источнике hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-112">Because auto-failover groups involve multiple databases they must be configured on hello primary server.</span></span> <span data-ttu-id="38f89-113">Основной и дополнительный серверы должны находиться в hello одной подписке.</span><span class="sxs-lookup"><span data-stu-id="38f89-113">Both primary and secondary servers must be in hello same subscription.</span></span> <span data-ttu-id="38f89-114">Автоматического перехода на другой ресурс группы поддержки репликации всех баз данных в hello группы tooonly один сервер-получатель в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="38f89-114">Auto-failover groups support replication of all databases in hello group tooonly one secondary server in a different region.</span></span> <span data-ttu-id="38f89-115">Активная георепликация, без автоматического перехода на другой ресурс групп, позволяет копирование баз данных-получателей too4 в любом регионе.</span><span class="sxs-lookup"><span data-stu-id="38f89-115">Active geo-replication, without auto-failover groups, allows up too4 secondaries in any region.</span></span>

<span data-ttu-id="38f89-116">Если вы используете активной георепликации и для любой базы данных-источника выполняется с ошибкой или просто toobe потребности, переводятся в автономный режим может инициировать tooany отработки отказа баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-116">If you are using active geo-replication and for any reason your primary database fails, or simply needs toobe taken offline, you can initiate failover tooany of your secondary databases.</span></span> <span data-ttu-id="38f89-117">При активации tooone баз данных-получателей hello отработки отказа все получатели являются автоматически компоноваться toohello новом сервере-источнике.</span><span class="sxs-lookup"><span data-stu-id="38f89-117">When failover is activated tooone of hello secondary databases, all other secondaries are automatically linked toohello new primary.</span></span> <span data-ttu-id="38f89-118">При использовании автоматического перехода на другой ресурс группы восстановления базы данных (в предварительного просмотра) toomanage и любого сбоя, влияет на одно или несколько баз данных hello в hello группы приводит к автоматической отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-118">If you are using auto-failover groups (in-preview) toomanage database recovery and any outage that impacts one or several of hello databases in hello group results in automatic failover.</span></span> <span data-ttu-id="38f89-119">Можно настроить политику hello автоматического перехода на другой ресурс, который лучше всего соответствует требованиям приложения, или можно отказаться от участия и использовать активации вручную.</span><span class="sxs-lookup"><span data-stu-id="38f89-119">You can configure hello auto-failover policy that best meets your application needs, or you can opt out and use manual activation.</span></span> <span data-ttu-id="38f89-120">Кроме того, группы автоматической отработки отказа (в предварительной версии) предоставляют конечные точки прослушивателя только для чтения и для чтения-записи, которые во время отработки отказа не изменяются.</span><span class="sxs-lookup"><span data-stu-id="38f89-120">In addition, auto-failover groups (in-preview) provide read-write and read-only listener end-points that remain unchanged during failovers.</span></span> <span data-ttu-id="38f89-121">Используется ли активация ручной или автоматический переход на другой ресурс, переход на другой ресурс коммутаторами всех баз данных-получателей tooprimary группы hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-121">Whether you use manual or automatic failover activation, failover switches all secondary databases in hello group tooprimary.</span></span> <span data-ttu-id="38f89-122">После завершения отработки отказа базы данных hello hello DNS-запись — новый регион конечных точек hello toohello tooredirect автоматически обновляются.</span><span class="sxs-lookup"><span data-stu-id="38f89-122">After hello database failover is completed, hello DNS record is automatically updated tooredirect hello end-points toohello new region.</span></span>

<span data-ttu-id="38f89-123">Вы можете управлять репликацией и отработкой отказа отдельной базы данных или набора баз данных на сервере или в эластичном пуле с помощью активной георепликации.</span><span class="sxs-lookup"><span data-stu-id="38f89-123">You can manage replication and failover of an individual database or a set of databases on a server or in an elastic pool using active geo-replication.</span></span> <span data-ttu-id="38f89-124">Можно сделать при помощи этого hello [портал Azure](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), или hello [API-интерфейса REST](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span><span class="sxs-lookup"><span data-stu-id="38f89-124">You can do that using hello [Azure portal](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), or hello [REST API](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span></span> <span data-ttu-id="38f89-125">После отработки отказа убедитесь, что hello требования проверки подлинности для сервера и базы данных можно настроить на новом сервере-источнике hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-125">After failover, ensure hello authentication requirements for your server and database are configured on hello new primary.</span></span> <span data-ttu-id="38f89-126">Дополнительные сведения см. в разделе [Безопасность базы данных SQL после аварийного восстановления](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-126">For details, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> <span data-ttu-id="38f89-127">Это относится обе tooactive георепликации и автоматического перехода на другой ресурс группы (в предварительного просмотра).</span><span class="sxs-lookup"><span data-stu-id="38f89-127">This applies both tooactive geo-replication and auto-failover groups (in-preview).</span></span>

<span data-ttu-id="38f89-128">Hello использует активную георепликацию [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) технологии SQL Server tooasynchronously репликации зафиксированных транзакций на hello базы данных-источника tooa баз данных-получателей с помощью изоляции моментального снимка зафиксированного чтения (RCSI).</span><span class="sxs-lookup"><span data-stu-id="38f89-128">Active geo-replication leverages hello [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) technology of SQL Server tooasynchronously replicate committed transactions on hello primary database tooa secondary database using read committed snapshot isolation (RCSI).</span></span> <span data-ttu-id="38f89-129">Автоматического перехода на другой ресурс группы предоставляют семантику hello группы на основе активной георепликации, но hello используется тот же механизм асинхронной репликации.</span><span class="sxs-lookup"><span data-stu-id="38f89-129">Auto-failover groups provide hello group semantics on top of active geo-replication but hello same asynchronous replication mechanism is used.</span></span> <span data-ttu-id="38f89-130">Хотя в любой момент hello базу данных-получатель может отстать от базы данных-источника hello, база данных-получатель hello гарантированно toonever того частичного транзакции.</span><span class="sxs-lookup"><span data-stu-id="38f89-130">While at any given point, hello secondary database might be slightly behind hello primary database, hello secondary data is guaranteed toonever have partial transactions.</span></span> <span data-ttu-id="38f89-131">Избыточность в различных регионах позволяет восстановить tooquickly приложения после непоправимого весь центр обработки данных или части центра обработки данных, вызванные стихийные бедствия, разрушительного человеческой ошибки или злонамеренного действия.</span><span class="sxs-lookup"><span data-stu-id="38f89-131">Cross-region redundancy enables applications tooquickly recover from a permanent loss of an entire datacenter or parts of a datacenter caused by natural disasters, catastrophic human errors, or malicious acts.</span></span> <span data-ttu-id="38f89-132">Hello RPO данных можно найти в [Общие сведения о непрерывности](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-132">hello specific RPO data can be found at [Overview of Business Continuity](sql-database-business-continuity.md).</span></span>

<span data-ttu-id="38f89-133">Hello на этом рисунке показан пример активной георепликации настроен с основной области hello North Central US и получателей в регионе hello в США.</span><span class="sxs-lookup"><span data-stu-id="38f89-133">hello following figure shows an example of active geo-replication configured with a primary in hello North Central US region and secondary in hello South Central US region.</span></span>

![Отношение георепликации](./media/sql-database-active-geo-replication/geo-replication-relationship.png)

<span data-ttu-id="38f89-135">Поскольку hello баз данных-получателей для чтения, они могут быть используется toooffload рабочих нагрузок только для чтения, например задания отчетности.</span><span class="sxs-lookup"><span data-stu-id="38f89-135">Because hello secondary databases are readable, they can be used toooffload read-only workloads such as reporting jobs.</span></span> <span data-ttu-id="38f89-136">Если вы используете активной георепликации, это возможных toocreate hello базы данных-получателя в hello совпадают с основной hello, но она не увеличивает сбоев toocatastrophic устойчивости приложения hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-136">If you are using active geo-replication, it is possible toocreate hello secondary database in hello same region with hello primary, but it does not increase hello application's resilience toocatastrophic failures.</span></span> <span data-ttu-id="38f89-137">Если вы используете группы автоматической отработки отказа (в предварительной версии), база данных-получатель всегда будет создаваться в другом регионе.</span><span class="sxs-lookup"><span data-stu-id="38f89-137">If you are using auto-failover groups (in-preview), your secondary database is always created in a different region.</span></span>

<span data-ttu-id="38f89-138">В дополнение к этому toodisaster восстановления активной георепликации можно использовать в hello следующие сценарии:</span><span class="sxs-lookup"><span data-stu-id="38f89-138">In addition toodisaster recovery active geo-replication can be used in hello following scenarios:</span></span>

* <span data-ttu-id="38f89-139">**Миграция базы данных**: toomigrate активной георепликации базы данных с одного сервера tooanother сети можно использовать с минимальным временем простоя.</span><span class="sxs-lookup"><span data-stu-id="38f89-139">**Database migration**: You can use active geo-replication toomigrate a database from one server tooanother online with minimum downtime.</span></span>
* <span data-ttu-id="38f89-140">**Обновления приложения**: при обновлении приложения вы можете создать дополнительную базу данных-получатель как резервную копию на случай сбоя.</span><span class="sxs-lookup"><span data-stu-id="38f89-140">**Application upgrades**: You can create an extra secondary as a fail back copy during application upgrades.</span></span>

<span data-ttu-id="38f89-141">tooachieve настоящей непрерывности, добавление избыточности базы данных между центрами обработки данных является частью решения hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-141">tooachieve real business continuity, adding database redundancy between datacenters is only part of hello solution.</span></span> <span data-ttu-id="38f89-142">Восстановление приложения (служба)-законченный после разрушительного сбоя требуется восстановление всех компонентов, которые составляют службу hello и все зависимые службы.</span><span class="sxs-lookup"><span data-stu-id="38f89-142">Recovering an application (service) end-to-end after a catastrophic failure requires recovery of all components that constitute hello service and any dependent services.</span></span> <span data-ttu-id="38f89-143">Эти компоненты примеры hello клиентское программное обеспечение (например, браузер с пользовательским кодом JavaScript), интерфейсные веб-серверы, хранилища и DNS.</span><span class="sxs-lookup"><span data-stu-id="38f89-143">Examples of these components include hello client software (for example, a browser with a custom JavaScript), web front ends, storage, and DNS.</span></span> <span data-ttu-id="38f89-144">Очень важно, что все компоненты гибкой toohello же ошибки и становятся доступными в течение целевого времени восстановления hello (RTO) вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="38f89-144">It is critical that all components are resilient toohello same failures and become available within hello recovery time objective (RTO) of your application.</span></span> <span data-ttu-id="38f89-145">Таким образом требуется tooidentify всех зависимых служб и понять гарантии hello и возможностях, которые они предоставляют.</span><span class="sxs-lookup"><span data-stu-id="38f89-145">Therefore, you need tooidentify all dependent services and understand hello guarantees and capabilities they provide.</span></span> <span data-ttu-id="38f89-146">Затем необходимо выполнить соответствующие действия tooensure, функциональные возможности службы во время hello hello служб, от которых он зависит.</span><span class="sxs-lookup"><span data-stu-id="38f89-146">Then, you must take adequate steps tooensure that your service functions during hello failover of hello services on which it depends.</span></span> <span data-ttu-id="38f89-147">Дополнительные сведения о проектировании решений для аварийного восстановления см. в статье о [разработке облачных решений для аварийного восстановления с помощью активной георепликации](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-147">For more information about designing solutions for disaster recovery, see [Designing Cloud Solutions for Disaster Recovery Using active geo-replication](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

## <a name="active-geo-replication-capabilities"></a><span data-ttu-id="38f89-148">Возможности активной георепликации</span><span class="sxs-lookup"><span data-stu-id="38f89-148">Active geo-replication capabilities</span></span>
<span data-ttu-id="38f89-149">функция активной георепликации Hello предоставляет hello следующие возможности:</span><span class="sxs-lookup"><span data-stu-id="38f89-149">hello active geo-replication feature provides hello following essential capabilities:</span></span>
* <span data-ttu-id="38f89-150">**Автоматическая асинхронная репликация**: базы данных-получателя можно создать только путем добавления tooan существующей базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-150">**Automatic Asynchronous Replication**: You can only create a secondary database by adding tooan existing database.</span></span> <span data-ttu-id="38f89-151">Hello получателя могут создаваться в любом сервере базы данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="38f89-151">hello secondary can be created in any Azure SQL Database server.</span></span> <span data-ttu-id="38f89-152">После создания базы данных-получателя hello заполняется hello данные, скопированные из базы данных-источника hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-152">Once created, hello secondary database is populated with hello data copied from hello primary database.</span></span> <span data-ttu-id="38f89-153">Этот процесс называется заполнением.</span><span class="sxs-lookup"><span data-stu-id="38f89-153">This process is known as seeding.</span></span> <span data-ttu-id="38f89-154">После создания и заполнения базы данных-получателя, обновления базы данных-источника toohello асинхронно, автоматически реплицируются toohello баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-154">After secondary database has been created and seeded, updates toohello primary database are asynchronously replicated toohello secondary database automatically.</span></span> <span data-ttu-id="38f89-155">Асинхронная репликация означает, что транзакции фиксируются в базе данных-источнике hello до их toohello реплицированных баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-155">Asynchronous replication means that transactions are committed on hello primary database before they are replicated toohello secondary database.</span></span> 
* <span data-ttu-id="38f89-156">**Для чтения базы данных-получатели**: приложение может получить доступ к базы данных-получателя для операций чтения с помощью hello таким же или субъекты безопасности, используемый для доступа к базе данных-источнике hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-156">**Readable secondary databases**: An application can access a secondary database for read-only operations using hello same or different security principals used for accessing hello primary database.</span></span> <span data-ttu-id="38f89-157">Hello баз данных-получателей работать с уровнем изоляции snapshot, запросы, выполняемые в hello получателей не задержка репликации tooensure режим обновления hello hello основной (воспроизведение журнала).</span><span class="sxs-lookup"><span data-stu-id="38f89-157">hello secondary databases operate in snapshot isolation mode tooensure replication of hello updates of hello primary (log replay) is not delayed by queries executed on hello secondary.</span></span>

   > [!NOTE]
   > <span data-ttu-id="38f89-158">Воспроизведение журнала Hello отложена hello базы данных-получателя в случае наличия обновления схемы, он получает из источников, который требуется заблокировать схему базы данных-получателя hello hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-158">hello log replay is delayed on hello secondary database if there are schema updates that it is receiving from hello Primary that require a schema lock on hello secondary database.</span></span> 
   > 

* <span data-ttu-id="38f89-159">**Несколько серверов-получателей для чтения**: два или более базы данных-получатели улучшают избыточность и уровень защиты для базы данных-источника hello и приложения.</span><span class="sxs-lookup"><span data-stu-id="38f89-159">**Multiple readable secondaries**: Two or more secondary databases increase redundancy and level of protection for hello primary database and application.</span></span> <span data-ttu-id="38f89-160">Если существует несколько баз данных-получателей, приложение hello остается защищенным даже в случае сбоя одной из баз данных-получателей hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-160">If multiple secondary databases exist, hello application remains protected even if one of hello secondary databases fails.</span></span> <span data-ttu-id="38f89-161">Если имеется только одна база данных-получатель и происходит сбой, приложение hello подвергается toohigher риск до создания новой базы данных-получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-161">If there is only one secondary database, and it fails, hello application is exposed toohigher risk until a new secondary database is created.</span></span>

   > [!NOTE]
   > <span data-ttu-id="38f89-162">Если вы используете активной георепликации toobuild глобально распределенного приложения и требуется toodata в регионах более 4 доступ к tooprovide только для чтения, можно создать дополнительного получателя (называемого цепочки).</span><span class="sxs-lookup"><span data-stu-id="38f89-162">If you are using active geo-replication toobuild a globally distributed application and need tooprovide read-only access toodata in more than 4 regions, you can create secondary of a secondary (a process known as chaining).</span></span> <span data-ttu-id="38f89-163">Это гарантирует виртуально неограниченное масштабирование репликации базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-163">This way you can achieve virtually unlimited scale of database replication.</span></span> <span data-ttu-id="38f89-164">Кроме того цепочки сокращает количество служебных hello репликации из базы данных-источника hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-164">In addition, chaining reduces hello overhead of replication from hello primary database.</span></span> <span data-ttu-id="38f89-165">Hello компромисс заключается hello отставания увеличивается трафик репликации для hello конечного большинство баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-165">hello trade-off is hello increased replication lag on hello leaf-most secondary databases.</span></span> <span data-ttu-id="38f89-166">.</span><span class="sxs-lookup"><span data-stu-id="38f89-166">.</span></span> 
   >

* <span data-ttu-id="38f89-167">**Поддержка баз данных эластичного пула.** Активную георепликацию можно настроить для любой базы данных в любом эластичном пуле.</span><span class="sxs-lookup"><span data-stu-id="38f89-167">**Support of elastic pool databases**: Active geo-replication can be configured for any database in any elastic pool.</span></span> <span data-ttu-id="38f89-168">Hello баз данных-получателей может быть в другом пуле эластичных БД.</span><span class="sxs-lookup"><span data-stu-id="38f89-168">hello secondary database can be in another elastic pool.</span></span> <span data-ttu-id="38f89-169">Для обычных баз данных hello получателей можно эластичного пула и наоборот, пока hello уровням обслуживания относятся hello таким же.</span><span class="sxs-lookup"><span data-stu-id="38f89-169">For regular databases, hello secondary can be an elastic pool and vice versa as long as hello service tiers are hello same.</span></span> 
* <span data-ttu-id="38f89-170">**Уровень производительности, можно настроить базу данных-получатель hello**: базы данных-получателя может быть создан с низкой производительностью, чем hello первичной.</span><span class="sxs-lookup"><span data-stu-id="38f89-170">**Configurable performance level of hello secondary database**: A secondary database can be created with lower performance level than hello primary.</span></span> <span data-ttu-id="38f89-171">Первичных и вторичных баз данных необходимы toohave hello же уровень обслуживания.</span><span class="sxs-lookup"><span data-stu-id="38f89-171">Both primary and secondary databases are required toohave hello same service tier.</span></span> <span data-ttu-id="38f89-172">Этот параметр не рекомендуется для приложений с высокой активности записи из-за увеличения Запаздывание hello увеличения hello риск потери значительной данных после отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-172">This option is not recommended for applications with high database write activity because hello increased replication lag increases hello risk of substantial data loss after a failover.</span></span> <span data-ttu-id="38f89-173">Кроме того после влияет на производительность приложения hello отработки отказа до hello новый первичный обновленного tooa более высокая производительность уровня.</span><span class="sxs-lookup"><span data-stu-id="38f89-173">In addition, after failover hello application’s performance is impacted until hello new primary is upgraded tooa higher performance level.</span></span> <span data-ttu-id="38f89-174">Hello диаграммы процент операций ввода-ВЫВОДА журнала на портал Azure предоставляет tooestimate хорошим способом hello уровень минимальной производительности hello получателей, загрузка репликации требуется toosustain hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-174">hello log IO percentage chart on Azure portal provides a good way tooestimate hello minimal performance level of hello secondary that is required toosustain hello replication load.</span></span> <span data-ttu-id="38f89-175">Например, если ваш основной базой данных является P6 (1000 DTU) и ее журнала операций ввода-ВЫВОДА % 50% hello получателей toobe требуется не менее P4 (500 DTU).</span><span class="sxs-lookup"><span data-stu-id="38f89-175">For example, if your Primary database is P6 (1000 DTU) and its log IO percent is 50% hello secondary needs toobe at least P4 (500 DTU).</span></span> <span data-ttu-id="38f89-176">Можно также получить с помощью hello журнала операции ввода-ВЫВОДА данных [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) или [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) представления базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-176">You can also retrieve hello log IO data using [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) or [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) database views.</span></span>  <span data-ttu-id="38f89-177">Дополнительные сведения об уровнях производительности базы данных SQL hello см. в разделе [параметры базы данных SQL и производительности](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-177">For more information on hello SQL Database performance levels, see [SQL Database options and performance](sql-database-service-tiers.md).</span></span> 
* <span data-ttu-id="38f89-178">**Управляемое пользователем при сбое и**: в любое время hello приложением или пользователем hello базы данных-получателя можно будет явным образом коммутируемых toohello первичной роли.</span><span class="sxs-lookup"><span data-stu-id="38f89-178">**User-controlled failover and failback**: A secondary database can explicitly be switched toohello primary role at any time by hello application or hello user.</span></span> <span data-ttu-id="38f89-179">Во время hello реальные сбоя «Незапланированная» параметр должен использоваться, немедленно позволяет основного получателя toobe hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-179">During a real outage hello “unplanned” option should be used, which immediately promotes a secondary toobe hello primary.</span></span> <span data-ttu-id="38f89-180">При неудачных основной hello восстанавливает и доступны еще раз, hello система автоматически hello метки восстановлен основной как получателя и переведите его в новом сервере-источнике hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-180">When hello failed primary recovers and is available again, hello system automatically marks hello recovered primary as a secondary and bring it up-to-date with hello new primary.</span></span> <span data-ttu-id="38f89-181">Из-за характера асинхронной toohello репликации небольшой объем данных могут быть потеряны во время внеплановой отработки отказа при сбое основного перед репликацией hello самые последние изменения toohello получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-181">Due toohello asynchronous nature of replication, a small amount of data can be lost during unplanned failovers if a primary fails before it replicates hello most recent changes toohello secondary.</span></span> <span data-ttu-id="38f89-182">При сбое основного несколько получателей hello системы автоматически настроит hello связей репликации и вновь оставшихся баз данных-получателей toohello hello ссылки переданы основной без вмешательства пользователя.</span><span class="sxs-lookup"><span data-stu-id="38f89-182">When a primary with multiple secondaries fails over, hello system automatically reconfigures hello replication relationships and links hello remaining secondaries toohello newly promoted primary without requiring any user intervention.</span></span> <span data-ttu-id="38f89-183">После устраняется hello сбоя, вызвавшего hello перехода на другой ресурс может быть желательным tooreturn приложения hello toohello основной регион.</span><span class="sxs-lookup"><span data-stu-id="38f89-183">After hello outage that caused hello failover is mitigated, it may be desirable tooreturn hello application toohello primary region.</span></span> <span data-ttu-id="38f89-184">toodo, что команда отработки отказа hello должны вызываться с hello «запланированное «параметр.</span><span class="sxs-lookup"><span data-stu-id="38f89-184">toodo that, hello failover command should be invoked with hello “planned” option.</span></span> 
* <span data-ttu-id="38f89-185">**Синхронизации учетных данных и правила брандмауэра**: мы рекомендуем использовать [правила брандмауэра базы данных](sql-database-firewall-configure.md) для географической репликации баз данных, эти правила могут быть реплицированы с tooensure hello базы данных все получатели имеют Здравствуйте же правила брандмауэра как основной hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-185">**Keeping credentials and firewall rules in sync**: We recommend using [database firewall rules](sql-database-firewall-configure.md) for geo-replicated databases so these rules can be replicated with hello database tooensure all secondary databases have hello same firewall rules as hello primary.</span></span> <span data-ttu-id="38f89-186">Это способ исключает необходимость hello клиентов toomanually настроить и поддерживать правила брандмауэра на серверах, где размещаются как hello первичных и вторичных баз данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-186">This approach eliminates hello need for customers toomanually configure and maintain firewall rules on servers hosting both hello primary and secondary databases.</span></span> <span data-ttu-id="38f89-187">Аналогично, использование [пользователей автономной базы данных](sql-database-manage-logins.md) данных доступ обеспечивает для первичных и вторичных баз данных всегда имеют hello того же пользователя учетные данные, поэтому во время отработки отказа, не нарушений в работе из-за toomismatches с именами входа и пароли.</span><span class="sxs-lookup"><span data-stu-id="38f89-187">Similarly, using [contained database users](sql-database-manage-logins.md) for data access ensures both primary and secondary databases always have hello same user credentials so during a failover, there is no disruptions due toomismatches with logins and passwords.</span></span> <span data-ttu-id="38f89-188">С добавлением hello [Azure Active Directory](../active-directory/active-directory-whatis.md), клиенты могут управлять пользователя tooboth первичных и вторичных баз данных access и устраняя hello требуются для управления учетными данными в базах данных полностью.</span><span class="sxs-lookup"><span data-stu-id="38f89-188">With hello addition of [Azure Active Directory](../active-directory/active-directory-whatis.md), customers can manage user access tooboth primary and secondary databases and eliminating hello need for managing credentials in databases altogether.</span></span>

## <a name="auto-failover-group-capabilities"></a><span data-ttu-id="38f89-189">Возможности группы автоматической отработки отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-189">Auto-failover group capabilities</span></span>

<span data-ttu-id="38f89-190">Группы автоматической отработки отказа обеспечивают расширенную абстракцию активной георепликации за счет поддержки репликации на уровне группы и автоматической отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-190">Auto-failover groups feature provides a powerful abstraction of active geo-replication by supporting group level replication and automatic failover.</span></span> <span data-ttu-id="38f89-191">Кроме того она удаляет строку подключения SQL hello toochange hello необходимость после отработки отказа, предоставляя конечные точки hello дополнительного прослушивателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-191">In addition, it removes hello necessity toochange hello SQL connection string after failover by providing hello additional listener end-points.</span></span> 

* <span data-ttu-id="38f89-192">**Группа отработки отказа.** Вы можете создать одну или несколько групп отработки отказа между двумя серверами в различных регионах (для основного сервера и сервера-получателя).</span><span class="sxs-lookup"><span data-stu-id="38f89-192">**Failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="38f89-193">Каждая группа может включать один или несколько баз данных, которые восстанавливаются как единое целое, в случае, если все или некоторые базы данных-источники становятся недоступными из-за сбоя tooan в основном регионе hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-193">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due tooan outage in hello primary region.</span></span>  
* <span data-ttu-id="38f89-194">**Сервер-источник**: сервер, на котором размещена hello базы данных-источники в группе hello отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-194">**Primary server**: A server that hosts hello primary databases in hello failover group.</span></span>
* <span data-ttu-id="38f89-195">**Сервер-получатель**: сервер, на котором размещена hello базы данных-получатели hello отработки отказа группой.</span><span class="sxs-lookup"><span data-stu-id="38f89-195">**Secondary server**: A server that hosts hello secondary databases in hello failover group.</span></span> <span data-ttu-id="38f89-196">сервер-получатель Hello не может быть в hello же регионе, что основной сервер hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-196">hello secondary server cannot be in hello same region as hello primary server.</span></span>
* <span data-ttu-id="38f89-197">**Добавление группы баз данных toofailover**: можно поместить несколько баз данных на сервере или в переменной ширины пула в hello же отработки отказа группой.</span><span class="sxs-lookup"><span data-stu-id="38f89-197">**Adding databases toofailover group**: You can put several databases within a server or within an elastic pool into hello same failover group.</span></span> <span data-ttu-id="38f89-198">При добавлении базы данных toohello отдельной группы, он автоматически создает базы данных-получателя с помощью того же уровня производительности и выпуск "hello".</span><span class="sxs-lookup"><span data-stu-id="38f89-198">If you add a standalone database toohello group, it automatically creates a secondary database using hello same edition and performance level.</span></span> <span data-ttu-id="38f89-199">Если в пуле эластичных hello базы данных-источника, hello получателя автоматически создается в hello эластичного пула с hello таким же именем.</span><span class="sxs-lookup"><span data-stu-id="38f89-199">If hello primary database is in an elastic pool, hello secondary is automatically created in hello elastic pool with hello same name.</span></span> <span data-ttu-id="38f89-200">При добавлении в базе данных уже имеются базы данных-получателя в hello сервера-получателя, что георепликация наследуется hello группы.</span><span class="sxs-lookup"><span data-stu-id="38f89-200">If you add a database that already has a secondary database in hello secondary server, that geo-replication is inherited by hello group.</span></span>

   > [!NOTE]
   > <span data-ttu-id="38f89-201">При добавлении в базе данных уже имеются базы данных-получателя на сервере, который не является частью группы отказоустойчивого hello в hello сервера-получателя создается новом сервере-получателе.</span><span class="sxs-lookup"><span data-stu-id="38f89-201">When adding a database that already has a secondary database in a server that is not part of hello failover group, a new secondary is created in hello secondary server.</span></span> 
   >

* <span data-ttu-id="38f89-202">**Прослушиватель чтения и записи отработки отказа группы**: запись CNAME DNS сформировано как  **&lt;перехода на другой ресурс group-name&gt;. database.windows.net** , указывающий toohello текущей основной URL-адрес сервера.</span><span class="sxs-lookup"><span data-stu-id="38f89-202">**Failover group read-write listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.database.windows.net** that points toohello current primary server URL.</span></span> <span data-ttu-id="38f89-203">Он позволяет hello приложений SQL чтения и записи tootransparently повторного подключения базы данных-источника toohello при изменении основной hello после отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-203">It allows hello read-write SQL applications tootransparently reconnect toohello primary database when hello primary changes after failover.</span></span> 
* <span data-ttu-id="38f89-204">**Переход на другой ресурс прослушивателя группы только для чтения**: DNS запись CNAME сформировано как  **&lt;перехода на другой ресурс group-name&gt;. secondary.database.windows.net** , который указывает URL-адрес дополнительного сервера toohello.</span><span class="sxs-lookup"><span data-stu-id="38f89-204">**Failover group read-only listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.secondary.database.windows.net** that points toohello secondary server’s URL.</span></span> <span data-ttu-id="38f89-205">Он позволяет hello tootransparently подключения только для чтения приложений SQL toohello баз данных-получателей с помощью hello указанного правила балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="38f89-205">It allows hello read-only SQL applications tootransparently connect toohello secondary database using hello specified load-balancing rules.</span></span> <span data-ttu-id="38f89-206">Также можно указать, если требуется hello только для чтения трафик toobe автоматически перенаправляться toohello основной сервер когда недоступен сервер-получатель hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-206">Optionally you can specify if you want hello read-only traffic toobe automatically re-directed toohello primary server when hello secondary server is not available.</span></span>
* <span data-ttu-id="38f89-207">**Политика автоматического перехода на другой ресурс**: по умолчанию hello перехода на другой ресурс группа настроена политика автоматического перехода на другой ресурс.</span><span class="sxs-lookup"><span data-stu-id="38f89-207">**Automatic failover policy**: By default, hello failover group is configured with an automatic failover policy.</span></span> <span data-ttu-id="38f89-208">система Hello инициирует переход на другой ресурс, как можно скорее hello обнаружена ошибка.</span><span class="sxs-lookup"><span data-stu-id="38f89-208">hello system triggers failover as soon as hello failure is detected.</span></span> <span data-ttu-id="38f89-209">Если требуется, чтобы рабочий процесс отработки отказа hello toocontrol из приложения hello, можно отключить автоматический переход на другой ресурс.</span><span class="sxs-lookup"><span data-stu-id="38f89-209">If you want toocontrol hello failover workflow from hello application, you can turn off automatic failover.</span></span> 
* <span data-ttu-id="38f89-210">**Отработка отказа вручную**: может инициировать отработку отказа вручную в любое время независимо от конфигурации автоматического перехода на другой ресурс hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-210">**Manual failover**: You can initiate failover manually at any time regardless of hello automatic failover configuration.</span></span> <span data-ttu-id="38f89-211">Если политика автоматического перехода на другой ресурс не настроенный отработка отказа вручную не базы данных требуется toorecover hello перехода на другой ресурс группы.</span><span class="sxs-lookup"><span data-stu-id="38f89-211">If automatic failover policy is not configured manual failover is required toorecover databases in hello failover group.</span></span> <span data-ttu-id="38f89-212">Вы можете запустить принудительную отработку отказа или адаптированную (с полной синхронизацией данных).</span><span class="sxs-lookup"><span data-stu-id="38f89-212">You can initiate forced or friendly failover (with full data synchronization).</span></span> <span data-ttu-id="38f89-213">последний Hello может быть основной регион toohello active server используется toorelocate hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-213">hello latter could be used toorelocate hello active server toohello primary region.</span></span> <span data-ttu-id="38f89-214">После завершения перехода на другой ресурс hello DNS-записи являются автоматически обновляются tooensure подключения toohello правильный сервер.</span><span class="sxs-lookup"><span data-stu-id="38f89-214">When failover is completed hello DNS records are automatically updated tooensure connectivity toohello correct server.</span></span>
* <span data-ttu-id="38f89-215">**Льготный период с потерей данных**: поскольку hello первичные и вторичные базы данных синхронизированы с использованием асинхронной репликации hello перехода на другой ресурс может привести к потере данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-215">**Grace period with data loss**: Because hello primary and secondary databases are synchronized using asynchronous replication hello failover may result in data loss.</span></span> <span data-ttu-id="38f89-216">Можно настроить политики tooreflect hello автоматический переход на другой потери toodata отклонения вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="38f89-216">You can customize hello automatic failover policy tooreflect your application’s tolerance toodata loss.</span></span> <span data-ttu-id="38f89-217">Настроив **GracePeriodWithDataLossHours**, можно задать время ожидания hello системы перед запуском отработки отказа hello, скорее всего, tooresult потеря данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-217">By configuring **GracePeriodWithDataLossHours**, you can control how long hello system waits before initiating hello failover that is likely tooresult data loss.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="38f89-218">Когда система обнаруживает, базы данных hello в группе hello, все еще в сети (например, сбоя hello только влияет на плоскости управления hello службы), немедленно активируется hello переход на другой ресурс полная синхронизация данных (понятное отработки отказа) независимо от значения hello задается **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="38f89-218">When system detects that hello databases in hello group are still online (for example, hello outage only impacted hello service control plane), it immediately activates hello failover with full data synchronization (friendly failover) regardless of hello value set by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="38f89-219">Такое поведение гарантирует, что не происходит потери данных во время восстановления hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-219">This behavior ensures that there is no data loss during hello recovery.</span></span> <span data-ttu-id="38f89-220">период отсрочки Hello вступает в силу только в том случае, если понятное отработки отказа не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="38f89-220">hello grace period takes effect only when a friendly failover is not possible.</span></span> <span data-ttu-id="38f89-221">Если сбой hello, уменьшается до истечения этого периода отсрочки hello, hello перехода на другой ресурс не активирована.</span><span class="sxs-lookup"><span data-stu-id="38f89-221">If hello outage is mitigated before hello grace period expires, hello failover is not activated.</span></span>
   >

* <span data-ttu-id="38f89-222">**Несколько групп отработки отказа**: можно настроить несколько групп отработки отказа для hello одной паре серверов toocontrol hello масштаб переход на другой ресурс.</span><span class="sxs-lookup"><span data-stu-id="38f89-222">**Multiple failover groups**: You can configure multiple failover groups for hello same pair of servers toocontrol hello scale of failovers.</span></span> <span data-ttu-id="38f89-223">Каждая группа выполняет отработку отказа независимо от других групп.</span><span class="sxs-lookup"><span data-stu-id="38f89-223">Each group fails over independently.</span></span> <span data-ttu-id="38f89-224">Если ваше мультитенантное приложение использует эластичные пулы, это возможность toomix первичных и вторичных баз данных можно использовать в каждом пуле.</span><span class="sxs-lookup"><span data-stu-id="38f89-224">If your multi-tenant application uses elastic pools, you can use this capability toomix primary and secondary databases in each pool.</span></span> <span data-ttu-id="38f89-225">Таким образом можно сократить влияние сбоя tooonly hello половины hello клиентов.</span><span class="sxs-lookup"><span data-stu-id="38f89-225">This way you can reduce hello impact of an outage tooonly half of hello tenants.</span></span>

## <a name="best-practices-of-building-highly-available-service"></a><span data-ttu-id="38f89-226">Рекомендации по созданию службы высокой доступности</span><span class="sxs-lookup"><span data-stu-id="38f89-226">Best practices of building highly available service</span></span>

<span data-ttu-id="38f89-227">toobuild высокой доступности службы, использующей клиенты hello базы данных Azure SQL придерживаться следующих правил:</span><span class="sxs-lookup"><span data-stu-id="38f89-227">toobuild a highly available service that uses Azure SQL database hello customers should follow these guidelines:</span></span>
- <span data-ttu-id="38f89-228">**Использование группы отработки отказа.** Вы можете создать одну или несколько групп отработки отказа между двумя серверами (источником и получателем) в разных регионах.</span><span class="sxs-lookup"><span data-stu-id="38f89-228">**Use failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="38f89-229">Каждая группа может включать один или несколько баз данных, которые восстанавливаются как единое целое, в случае, если все или некоторые базы данных-источники становятся недоступными из-за сбоя tooan в основном регионе hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-229">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due tooan outage in hello primary region.</span></span> <span data-ttu-id="38f89-230">Hello отработки отказа группой создает базы данных-получателя geo с таким же службы как hello основной целью hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-230">hello failover group creates geo-secondary database with hello same service objective as hello primary.</span></span> <span data-ttu-id="38f89-231">При добавлении существующего георепликации связь toohello перехода на другой ресурс группы убедитесь убедиться, что hello geo-вторичной реплики настроен с таким же службы цель уровня как hello hello первичной.</span><span class="sxs-lookup"><span data-stu-id="38f89-231">If you add an existing geo-replication relationship toohello failover group make sure hello geo-secondary is configured with hello same service level objective as hello primary.</span></span>
- <span data-ttu-id="38f89-232">**Использование прослушивателя чтения и записи для рабочей нагрузки OLTP**: при выполнении операции используйте OLTP  **&lt;перехода на другой ресурс group-name&gt;. database.windows.net** как URL-адрес сервера hello и hello подключений будет автоматически, направленным toohello первичной.</span><span class="sxs-lookup"><span data-stu-id="38f89-232">**Use read-write listener for OLTP workload**: When performing OLTP operations use **&lt;failover-group-name&gt;.database.windows.net** as hello server URL and hello connections will be automatically directed toohello primary.</span></span> <span data-ttu-id="38f89-233">Этот URL-адрес не будет изменен после отработки отказа hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-233">This URL will not change after hello failover.</span></span>  
<span data-ttu-id="38f89-234">Примечание hello перехода на другой ресурс включает в себя обновления записи DNS, поэтому hello клиентских подключений будет перенаправленный toohello новый основной только после того, клиент hello обновляется кэш DNS приветствия.</span><span class="sxs-lookup"><span data-stu-id="38f89-234">Note hello failover involves updating hello DNS record so hello client connections will be redirected toohello new primary only after hello client DNS cache is refreshed.</span></span>
- <span data-ttu-id="38f89-235">**Использовать только для чтения прослушивателя для рабочей нагрузки только для чтения**: при наличии логически изолированный только для чтения рабочей нагрузке, нечувствительный к ошибкам toocertain устареванием данных можно использовать базы данных-получателя hello в приложение hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-235">**Use read-only listener for read-only workload**: If you have a logically isolated read-only workload that is tolerant toocertain staleness of data, you can use hello secondary database in hello application.</span></span> <span data-ttu-id="38f89-236">Для использования сеансов только для чтения  **&lt;перехода на другой ресурс group-name&gt;. secondary.database.windows.net** как URL-адрес сервера hello и hello подключение будет автоматически, направленным toohello получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-236">For read-only sessions use **&lt;failover-group-name&gt;.secondary.database.windows.net** as hello server URL and hello connection will be automatically directed toohello secondary.</span></span> <span data-ttu-id="38f89-237">Кроме того, мы рекомендуем указать режим только для чтения прямо в строке подключения, добавив аргумент **ApplicationIntent=ReadOnly**.</span><span class="sxs-lookup"><span data-stu-id="38f89-237">It is also recommended that you indicate in connection string read intent by using **ApplicationIntent=ReadOnly**.</span></span> 
- <span data-ttu-id="38f89-238">**Можно подготовиться к снижению производительности**: не зависит от hello остальной части приложения hello или других служб, используемых принятия решений для перехода на другой ресурс SQL.</span><span class="sxs-lookup"><span data-stu-id="38f89-238">**Be prepared for perf degradation**: SQL failover decision is independent from hello rest of hello application or other services used.</span></span> <span data-ttu-id="38f89-239">приложение Hello может быть «mixed» с некоторых компонентов в одной области, а часть — в другом.</span><span class="sxs-lookup"><span data-stu-id="38f89-239">hello application may be “mixed” with some components in one region and some in another.</span></span> <span data-ttu-id="38f89-240">снижение hello tooavoid, обеспечить развертывание избыточных приложения hello в регионе hello аварийного восстановления и рекомендации hello в этой статье.</span><span class="sxs-lookup"><span data-stu-id="38f89-240">tooavoid hello degradation, ensure hello redundant application deployment in hello DR region and follow hello guidelines in this article.</span></span>  
<span data-ttu-id="38f89-241">Приложение hello Примечание в регионе аварийного восстановления hello не имеет toouse отдельную строку подключения.</span><span class="sxs-lookup"><span data-stu-id="38f89-241">Note hello application in hello DR region does not have toouse a different connection string.</span></span>  
- <span data-ttu-id="38f89-242">**Подготовка к потере данных**: при обнаружении сбоя SQL автоматически запускает отработку отказа чтения и записи, если наш знаний лучше ноль toohello потери данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-242">**Prepare for data loss**: If an outage is detected, SQL automatically triggers read-write failover if there is zero data loss toohello best of our knowledge.</span></span> <span data-ttu-id="38f89-243">В противном случае он ожидает период hello, заданный при **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="38f89-243">Otherwise, it waits for hello period you specified by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="38f89-244">Если вы указали параметр **GracePeriodWithDataLossHours**, будьте готовы к потере данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-244">If you specified **GracePeriodWithDataLossHours**, be prepared for data loss.</span></span> <span data-ttu-id="38f89-245">Во время сбоев Azure, как правило, повышает доступность.</span><span class="sxs-lookup"><span data-stu-id="38f89-245">In general, during outages, Azure favors availability.</span></span> <span data-ttu-id="38f89-246">Если не может допустить потери данных, убедитесь, что tooset **GracePeriodWithDataLossHours** tooa достаточно большое число, например 24 часа.</span><span class="sxs-lookup"><span data-stu-id="38f89-246">If you cannot afford data loss, make sure tooset **GracePeriodWithDataLossHours** tooa sufficiently large number, such as 24 hours.</span></span> 


## <a name="upgrading-or-downgrading-a-primary-database"></a><span data-ttu-id="38f89-247">Повышение или понижение уровня производительности базы данных-источника</span><span class="sxs-lookup"><span data-stu-id="38f89-247">Upgrading or downgrading a primary database</span></span>
<span data-ttu-id="38f89-248">Можно повысить или понизить уровень производительности базы данных-источника tooa (в пределах hello же службы для уровня использования) без отключения баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-248">You can upgrade or downgrade a primary database tooa different performance level (within hello same service tier) without disconnecting any secondary databases.</span></span> <span data-ttu-id="38f89-249">При обновлении, рекомендуется сначала обновить базы данных-получателя hello и затем обновить основной hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-249">When upgrading, we recommend that you upgrade hello secondary database first, and then upgrade hello primary.</span></span> <span data-ttu-id="38f89-250">При понижении, в обратном порядке hello: сначала понизить основной hello и затем понизить hello получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-250">When downgrading, reverse hello order: downgrade hello primary first, and then downgrade hello secondary.</span></span> <span data-ttu-id="38f89-251">Эта рекомендация применяется при повысить или понизить уровень другую службу tooa hello базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-251">When you upgrade or downgrade hello database tooa different service tier this recommendation is enforced.</span></span> 

> [!NOTE]
> <span data-ttu-id="38f89-252">Если вы создали базу данных-получатель как часть конфигурации группы отказоустойчивого hello не рекомендуемые toodowngrade hello баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-252">If you created secondary database as part of hello failover group configuration it is not recommended toodowngrade hello secondary database.</span></span> <span data-ttu-id="38f89-253">Это tooensure уровень данных, имеет достаточно мощности tooprocess обычную рабочую нагрузку после отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-253">This is tooensure your data tier has sufficient capacity tooprocess your regular workload after failover is activated.</span></span> 
>

## <a name="preventing-hello-loss-of-critical-data"></a><span data-ttu-id="38f89-254">Предотвращение hello потери важных данных</span><span class="sxs-lookup"><span data-stu-id="38f89-254">Preventing hello loss of critical data</span></span>
<span data-ttu-id="38f89-255">Из-за toohello высокой задержки глобальных сетей непрерывная копи использует механизм асинхронной репликации.</span><span class="sxs-lookup"><span data-stu-id="38f89-255">Due toohello high latency of wide area networks, continuous copy uses an asynchronous replication mechanism.</span></span> <span data-ttu-id="38f89-256">Ввиду асинхронной репликации потеря данных в случае сбоя неизбежна.</span><span class="sxs-lookup"><span data-stu-id="38f89-256">Asynchronous replication makes some data loss unavoidable if a failure occurs.</span></span> <span data-ttu-id="38f89-257">Тем не менее для некоторых приложений терять данные недопустимо.</span><span class="sxs-lookup"><span data-stu-id="38f89-257">However, some applications may require no data loss.</span></span> <span data-ttu-id="38f89-258">tooprotect эти важные обновления, разработчик приложения может вызвать hello [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) системная процедура сразу же после фиксации транзакции hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-258">tooprotect these critical updates, an application developer can call hello [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) system procedure immediately after committing hello transaction.</span></span> <span data-ttu-id="38f89-259">Вызов **sp_wait_for_database_copy_sync** вызова потоков, до последней зафиксированной транзакции hello hello блоки передаются toohello баз данных-получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-259">Calling **sp_wait_for_database_copy_sync** blocks hello calling thread until hello last committed transaction has been transmitted toohello secondary database.</span></span> <span data-ttu-id="38f89-260">Тем не менее он не ожидает hello передачи транзакции toobe воспроизведения и зафиксирована в hello получателей.</span><span class="sxs-lookup"><span data-stu-id="38f89-260">However, it does not wait for hello transmitted transactions toobe replayed and committed on hello secondary.</span></span> <span data-ttu-id="38f89-261">**sp_wait_for_database_copy_sync** — с областью tooa определенной связи непрерывной копии.</span><span class="sxs-lookup"><span data-stu-id="38f89-261">**sp_wait_for_database_copy_sync** is scoped tooa specific continuous copy link.</span></span> <span data-ttu-id="38f89-262">Эту процедуру можно вызывать любой пользователь, имеющий hello подключения права toohello базы данных-источника.</span><span class="sxs-lookup"><span data-stu-id="38f89-262">Any user with hello connection rights toohello primary database can call this procedure.</span></span>

> [!NOTE]
> <span data-ttu-id="38f89-263">Процедура **sp_wait_for_database_copy_sync** предотвратит потерю данных после отработки отказа, но не гарантирует полную синхронизацию для доступа на чтение.</span><span class="sxs-lookup"><span data-stu-id="38f89-263">**sp_wait_for_database_copy_sync** will prevent data loss after failover, but it will not guarantee full synchronization for read access.</span></span> <span data-ttu-id="38f89-264">Здравствуйте, задержка, вызванная **sp_wait_for_database_copy_sync** вызов процедуры могут оказаться значительными и зависит от размера hello hello журнала транзакций во время вызова hello hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-264">hello delay caused by a **sp_wait_for_database_copy_sync** procedure call can be significant and depends on hello size of hello transaction log at hello time of hello call.</span></span> 
> 

## <a name="programmatically-managing-failover-groups-and-active-geo-replication"></a><span data-ttu-id="38f89-265">Программное управление группами отработки отказа и активной георепликацией</span><span class="sxs-lookup"><span data-stu-id="38f89-265">Programmatically managing failover groups and active geo-replication</span></span>
<span data-ttu-id="38f89-266">Как отмечалось ранее, групп автоматического перехода на другой ресурс (в просмотр) и активных географической репликации также можно управлять программно с помощью Azure PowerShell и hello REST API.</span><span class="sxs-lookup"><span data-stu-id="38f89-266">As discussed previously, auto-failover groups (in-preview) and active geo-replication can also be managed programmatically using Azure PowerShell and hello REST API.</span></span> <span data-ttu-id="38f89-267">Hello следующие таблицы описывают hello набор доступных команд.</span><span class="sxs-lookup"><span data-stu-id="38f89-267">hello following tables describe hello set of commands available.</span></span>

<span data-ttu-id="38f89-268">**API диспетчера ресурсов Azure и безопасности на основе ролей**: активная георепликация включает в себя набор API диспетчера ресурсов Azure для управления, включая hello [API REST для базы данных SQL Azure](https://docs.microsoft.com/rest/api/sql/) и [Azure Командлеты PowerShell](https://docs.microsoft.com/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="38f89-268">**Azure Resource Manager API and role-based security**: Active geo-replication includes a set of Azure Resource Manager APIs for management, including hello [Azure SQL Database REST API](https://docs.microsoft.com/rest/api/sql/) and [Azure PowerShell cmdlets](https://docs.microsoft.com/powershell/azure/overview).</span></span> <span data-ttu-id="38f89-269">Эти API-интерфейсы требуют hello использование групп ресурсов и поддерживают безопасность на основе ролей (RBAC).</span><span class="sxs-lookup"><span data-stu-id="38f89-269">These APIs require hello use of resource groups and support role-based security (RBAC).</span></span> <span data-ttu-id="38f89-270">Дополнительные сведения о как tooimplement доступ к роли см. в разделе [контроля доступа](../active-directory/role-based-access-control-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-270">For more information on how tooimplement access roles, see [Azure Role-Based Access Control](../active-directory/role-based-access-control-what-is.md).</span></span>

> [!NOTE]
> <span data-ttu-id="38f89-271">Многие новые функции активной георепликации поддерживаются только в [REST API SQL Azure](../azure-resource-manager/resource-group-overview.md) и [командлетах PowerShell базы данных SQL Azure](https://msdn.microsoft.com/library/azure/mt163571.aspx) на основе [Azure Resource Manager](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span><span class="sxs-lookup"><span data-stu-id="38f89-271">Many new features of active geo-replication are only supported using [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) based [Azure SQL REST API](https://msdn.microsoft.com/library/azure/mt163571.aspx) and [Azure SQL Database PowerShell cmdlets](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span></span> <span data-ttu-id="38f89-272">Hello [(классической) API-интерфейса REST](https://msdn.microsoft.com/library/azure/dn505719.aspx) и [командлеты базы данных SQL Azure (классические)](https://msdn.microsoft.com/library/azure/dn546723.aspx) поддерживаются для обеспечения обратной совместимости, поэтому использование hello, рекомендуется использовать API на основе диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="38f89-272">hello [(classic) REST API](https://msdn.microsoft.com/library/azure/dn505719.aspx) and [Azure SQL Database (classic) cmdlets](https://msdn.microsoft.com/library/azure/dn546723.aspx) are supported for backward compatibility so using hello Azure Resource Manager-based APIs are recommended.</span></span> 
> 

## <a name="manage-sql-database-failover-using-using-transact-sql"></a><span data-ttu-id="38f89-273">Управление SQL базы данных отработки отказа с помощью с помощью Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="38f89-273">Manage SQL database failover using using Transact-SQL</span></span>

| <span data-ttu-id="38f89-274">Команда</span><span class="sxs-lookup"><span data-stu-id="38f89-274">Command</span></span> | <span data-ttu-id="38f89-275">Описание</span><span class="sxs-lookup"><span data-stu-id="38f89-275">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="38f89-276">ALTER DATABASE (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-276">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="38f89-277">Добавление сервера-ПОЛУЧАТЕЛЯ ON аргумент toocreate базы данных-получателя для существующей базы данных и запускает репликацию данных</span><span class="sxs-lookup"><span data-stu-id="38f89-277">Use ADD SECONDARY ON SERVER argument toocreate a secondary database for an existing database and starts data replication</span></span> |
| [<span data-ttu-id="38f89-278">ALTER DATABASE (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-278">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="38f89-279">Использовать переход на другой РЕСУРС или FORCE_FAILOVER_ALLOW_DATA_LOSS tooswitch toobe tooinitiate основной базы данных-получателя отработки отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-279">Use FAILOVER or FORCE_FAILOVER_ALLOW_DATA_LOSS tooswitch a secondary database toobe primary tooinitiate failover</span></span> |
| [<span data-ttu-id="38f89-280">ALTER DATABASE (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-280">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="38f89-281">С помощью удаления сервера-ПОЛУЧАТЕЛЯ ON tooterminate репликацию данных между базой данных SQL и hello указанной базы данных-получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-281">Use REMOVE SECONDARY ON SERVER tooterminate a data replication between a SQL Database and hello specified secondary database.</span></span> |
| [<span data-ttu-id="38f89-282">sys.geo_replication_links (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-282">sys.geo_replication_links (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575501.aspx) |<span data-ttu-id="38f89-283">Возвращает сведения о всех связей репликации для каждой базы данных на логическом сервере hello базы данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="38f89-283">Returns information about all existing replication links for each database on hello Azure SQL Database logical server.</span></span> |
| [<span data-ttu-id="38f89-284">sys.dm_geo_replication_link_status (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-284">sys.dm_geo_replication_link_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575504.aspx) |<span data-ttu-id="38f89-285">Возвращает hello последнее время репликации, последний Запаздывание репликации и другие сведения о hello связь репликации для базы данных SQL.</span><span class="sxs-lookup"><span data-stu-id="38f89-285">Gets hello last replication time, last replication lag, and other information about hello replication link for a given SQL database.</span></span> |
| [<span data-ttu-id="38f89-286">sys.dm_operation_status (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-286">sys.dm_operation_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn270022.aspx) |<span data-ttu-id="38f89-287">Отображается состояние всех операций базы данных, включая состояние связи репликации hello hello hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-287">Shows hello status for all database operations including hello status of hello replication links.</span></span> |
| [<span data-ttu-id="38f89-288">sp_wait_for_database_copy_sync (база данных SQL Azure)</span><span class="sxs-lookup"><span data-stu-id="38f89-288">sp_wait_for_database_copy_sync (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn467644.aspx) |<span data-ttu-id="38f89-289">вызывает toowait приложения hello, пока все зафиксированные транзакции будут реплицированы и подтверждается hello активную вторичную базу данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-289">causes hello application toowait until all committed transactions are replicated and acknowledged by hello active secondary database.</span></span> |
|  | |

## <a name="manage-sql-database-failover-using-using-powershell"></a><span data-ttu-id="38f89-290">Управление SQL базы данных отработки отказа с помощью с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="38f89-290">Manage SQL database failover using using PowerShell</span></span>

| <span data-ttu-id="38f89-291">Командлет</span><span class="sxs-lookup"><span data-stu-id="38f89-291">Cmdlet</span></span> | <span data-ttu-id="38f89-292">Описание</span><span class="sxs-lookup"><span data-stu-id="38f89-292">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="38f89-293">Get-AzureRmSqlDatabase</span><span class="sxs-lookup"><span data-stu-id="38f89-293">Get-AzureRmSqlDatabase</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabase) |<span data-ttu-id="38f89-294">Получает одну или несколько баз данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-294">Gets one or more databases.</span></span> |
| [<span data-ttu-id="38f89-295">New-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="38f89-295">New-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/new-azurermsqldatabasesecondary) |<span data-ttu-id="38f89-296">Создает базу данных-получатель для существующей базы данных и начинает репликацию данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-296">Creates a secondary database for an existing database and starts data replication.</span></span> |
| [<span data-ttu-id="38f89-297">Set-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="38f89-297">Set-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasesecondary) |<span data-ttu-id="38f89-298">Переключает основной tooinitiate toobe отработки отказа базы данных-получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-298">Switches a secondary database toobe primary tooinitiate failover.</span></span> |
| [<span data-ttu-id="38f89-299">Remove-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="38f89-299">Remove-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasesecondary) |<span data-ttu-id="38f89-300">Завершает репликацию данных между базой данных SQL и hello указанной базы данных-получателя.</span><span class="sxs-lookup"><span data-stu-id="38f89-300">Terminates data replication between a SQL Database and hello specified secondary database.</span></span> |
| [<span data-ttu-id="38f89-301">Get-AzureRmSqlDatabaseReplicationLink</span><span class="sxs-lookup"><span data-stu-id="38f89-301">Get-AzureRmSqlDatabaseReplicationLink</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasereplicationlink) |<span data-ttu-id="38f89-302">Получает ссылки hello географическую репликацию данных между базы данных SQL Azure и группы ресурсов или SQL Server.</span><span class="sxs-lookup"><span data-stu-id="38f89-302">Gets hello geo-replication links between an Azure SQL Database and a resource group or SQL Server.</span></span> |
| [<span data-ttu-id="38f89-303">New-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="38f89-303">New-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="38f89-304">Создает группу отработки отказа и регистрирует ее на основном сервере и сервере-получателе.</span><span class="sxs-lookup"><span data-stu-id="38f89-304">This command creates a failover group and registers it on both primary and secondary servers</span></span>|
| [<span data-ttu-id="38f89-305">Remove-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="38f89-305">Remove-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasefailovergroup) | <span data-ttu-id="38f89-306">Удаляются hello отработки отказа группой hello сервера и всех баз данных-получателей включены hello группы</span><span class="sxs-lookup"><span data-stu-id="38f89-306">Removes hello failover group from hello server and deletes all secondary databases included hello group</span></span> |
| [<span data-ttu-id="38f89-307">Get-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="38f89-307">Get-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasefailovergroup) | <span data-ttu-id="38f89-308">Получает конфигурацию группы hello отработки отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-308">Retrieves hello failover group configuration</span></span> |
| [<span data-ttu-id="38f89-309">Set-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="38f89-309">Set-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="38f89-310">Изменяет конфигурацию hello hello перехода на другой ресурс группы</span><span class="sxs-lookup"><span data-stu-id="38f89-310">Modifies hello configuration of hello failover group</span></span> |
| [<span data-ttu-id="38f89-311">Switch-AzureRMSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="38f89-311">Switch-AzureRMSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/switch-azurermsqldatabasefailovergroup) | <span data-ttu-id="38f89-312">Отработка отказа триггеры hello перехода на другой ресурс группы toohello сервера-получателя</span><span class="sxs-lookup"><span data-stu-id="38f89-312">Triggers failover of hello failover group toohello secondary server</span></span> |
|  | |

> [!IMPORTANT]
> <span data-ttu-id="38f89-313">Дополнительные сведения о примерах сценариев см. в статьях [Настройка активной георепликации для отдельной базы данных SQL Azure с помощью PowerShell](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Настройка активной георепликации для базы данных SQL Azure в составе пула с помощью PowerShell](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), а также [Use PowerShell to configure an active geo-replication failover group for a single Azure SQL database](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md) (Использование PowerShell для настройки группы отработки отказа активной георепликации для отдельной базы данных SQL Azure (предварительная версия)).</span><span class="sxs-lookup"><span data-stu-id="38f89-313">For sample scripts, see [Configure and failover a single database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Configure and failover a pooled database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), and  [Configure and failover a failover group for a single database (preview)](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md.</span></span>
>

## <a name="manage-sql-database-failover-using-hello-rest-api"></a><span data-ttu-id="38f89-314">Управлять переключением базы данных SQL с помощью API-интерфейса REST hello</span><span class="sxs-lookup"><span data-stu-id="38f89-314">Manage SQL database failover using hello REST API</span></span>
| <span data-ttu-id="38f89-315">API</span><span class="sxs-lookup"><span data-stu-id="38f89-315">API</span></span> | <span data-ttu-id="38f89-316">Описание</span><span class="sxs-lookup"><span data-stu-id="38f89-316">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="38f89-317">Создание или обновление базы данных (createMode=Restore)</span><span class="sxs-lookup"><span data-stu-id="38f89-317">Create or Update Database (createMode=Restore)</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="38f89-318">Создает, обновляет или восстанавливает базу данных-источник или базу данных-получатель.</span><span class="sxs-lookup"><span data-stu-id="38f89-318">Creates, updates, or restores a primary or a secondary database.</span></span> |
| [<span data-ttu-id="38f89-319">Получение, создание или обновление состояния базы данных</span><span class="sxs-lookup"><span data-stu-id="38f89-319">Get Create or Update Database Status</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="38f89-320">Возвращает состояние hello во время операции создания.</span><span class="sxs-lookup"><span data-stu-id="38f89-320">Returns hello status during a create operation.</span></span> |
| [<span data-ttu-id="38f89-321">Задание базы данных-получателя в качестве базы данных-источника (плановая отработка отказа)</span><span class="sxs-lookup"><span data-stu-id="38f89-321">Set Secondary Database as Primary (Planned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinkss#ReplicationLinks_Failover) |<span data-ttu-id="38f89-322">Задает, какой реплики базы данных является первичным, нужно выполнить переход из hello текущей первичной реплики базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-322">Sets which replica database is primary by failing over from hello current primary replica database.</span></span> |
| [<span data-ttu-id="38f89-323">Задание базы данных-получателя в качестве базы данных-источника (внеплановая отработка отказа)</span><span class="sxs-lookup"><span data-stu-id="38f89-323">Set Secondary Database as Primary (Unplanned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinks#ReplicationLinks_FailoverAllowDataLoss) |<span data-ttu-id="38f89-324">Задает, какой реплики базы данных является первичным, нужно выполнить переход из hello текущей первичной реплики базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-324">Sets which replica database is primary by failing over from hello current primary replica database.</span></span> <span data-ttu-id="38f89-325">Эта операция может привести к потере данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-325">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="38f89-326">Получение связи репликации</span><span class="sxs-lookup"><span data-stu-id="38f89-326">Get Replication Link</span></span>](/rest/api/sql/replicationlinks/get) |<span data-ttu-id="38f89-327">Получает определенную связь репликации для заданной базы данных SQL, участвующей в партнерстве георепликации.</span><span class="sxs-lookup"><span data-stu-id="38f89-327">Gets a specific replication link for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="38f89-328">Он извлекает hello сведения, отображаемые в представлении каталога sys.geo_replication_links hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-328">It retrieves hello information visible in hello sys.geo_replication_links catalog view.</span></span> |
| <span data-ttu-id="38f89-329">[Replication Links - List By Database](/rest/api/sql/replicationlinks/listbydatabase) (Ссылки для репликации: вывод списка по базе данных)</span><span class="sxs-lookup"><span data-stu-id="38f89-329">[Replication Links - List By Database](/rest/api/sql/replicationlinks/listbydatabase)</span></span> | <span data-ttu-id="38f89-330">Получает все связи репликации для заданной базы данных SQL, участвующей в партнерстве георепликации.</span><span class="sxs-lookup"><span data-stu-id="38f89-330">Gets all replication links for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="38f89-331">Он извлекает hello сведения, отображаемые в представлении каталога sys.geo_replication_links hello.</span><span class="sxs-lookup"><span data-stu-id="38f89-331">It retrieves hello information visible in hello sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="38f89-332">Удаление связей репликации</span><span class="sxs-lookup"><span data-stu-id="38f89-332">Delete Replication Link</span></span>](/rest/api/sql/databases/delete) | <span data-ttu-id="38f89-333">Удаляет связь репликации базы данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-333">Deletes a database replication link.</span></span> <span data-ttu-id="38f89-334">Невозможно выполнить во время отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-334">Cannot be done during failover.</span></span> |
| <span data-ttu-id="38f89-335">[Создание или обновление групп отработки отказа]/rest/api/sql/failovergroups/createorupdate)</span><span class="sxs-lookup"><span data-stu-id="38f89-335">[Create or Update Failover Group]/rest/api/sql/failovergroups/createorupdate)</span></span> | <span data-ttu-id="38f89-336">Создает или обновляет группу отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-336">Creates or updates a failover group</span></span> |
| [<span data-ttu-id="38f89-337">Удаление группы отработки отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-337">Delete Failover Group</span></span>](/rest/api/sql/failovergroups/delete) | <span data-ttu-id="38f89-338">Удаляет группу hello отработки отказа из сервера hello</span><span class="sxs-lookup"><span data-stu-id="38f89-338">Removes hello failover group from hello server</span></span> |
| [<span data-ttu-id="38f89-339">Плановая отработка отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-339">Failover (Planned)</span></span>](/rest/api/sql/failovergroups/failover) | <span data-ttu-id="38f89-340">При сбое hello текущего сервера toothis сервера-источника.</span><span class="sxs-lookup"><span data-stu-id="38f89-340">Fails over from hello current primary server toothis server.</span></span> |
| [<span data-ttu-id="38f89-341">Принудительная отработка отказа (возможна потеря данных)</span><span class="sxs-lookup"><span data-stu-id="38f89-341">Force Failover Allow Data Loss</span></span>](/rest/api/sql/failovergroups/forcefailoverallowdataloss) |<span data-ttu-id="38f89-342">ails над hello текущего сервера toothis сервера-источника.</span><span class="sxs-lookup"><span data-stu-id="38f89-342">ails over from hello current primary server toothis server.</span></span> <span data-ttu-id="38f89-343">Эта операция может привести к потере данных.</span><span class="sxs-lookup"><span data-stu-id="38f89-343">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="38f89-344">Получение группы отработки отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-344">Get Failover Group</span></span>](/rest/api/sql/failovergroups/get) | <span data-ttu-id="38f89-345">Получает группу отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-345">Gets a failover group.</span></span> |
| [<span data-ttu-id="38f89-346">Вывод списка групп отработки отказа с фильтрацией по серверу</span><span class="sxs-lookup"><span data-stu-id="38f89-346">List Failover Groups By Server</span></span>](/rest/api/sql/failovergroups/listbyserver) | <span data-ttu-id="38f89-347">Список групп hello перехода на другой ресурс на сервере.</span><span class="sxs-lookup"><span data-stu-id="38f89-347">Lists hello failover groups in a server.</span></span> |
| [<span data-ttu-id="38f89-348">Обновление группы отработки отказа</span><span class="sxs-lookup"><span data-stu-id="38f89-348">Update Failover Group</span></span>](/rest/api/sql/failovergroups/update) | <span data-ttu-id="38f89-349">Обновляет группу отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="38f89-349">Updates a failover group.</span></span> |
|  | |

## <a name="next-steps"></a><span data-ttu-id="38f89-350">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="38f89-350">Next steps</span></span>
* <span data-ttu-id="38f89-351">Ознакомьтесь с примерами скриптов в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="38f89-351">For sample scripts, see:</span></span>
   - [<span data-ttu-id="38f89-352">Настройка активной георепликации для отдельной базы данных SQL Azure с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="38f89-352">Configure and failover a single database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
   - [<span data-ttu-id="38f89-353">Настройка активной георепликации для базы данных SQL Azure в составе пула с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="38f89-353">Configure and failover a pooled database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md)
   - <span data-ttu-id="38f89-354">[Use PowerShell to configure an active geo-replication failover group for a single Azure SQL database](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md) (Использование PowerShell для настройки группы отработки отказа активной георепликации для отдельной базы данных SQL Azure (предварительная версия)).</span><span class="sxs-lookup"><span data-stu-id="38f89-354">[Configure and failover a failover group for a single database (preview)](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md)</span></span>
* <span data-ttu-id="38f89-355">Сведения об обеспечении непрерывности бизнес-процессов и возможные сценарии описаны в [обзоре непрерывности бизнес-процессов](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="38f89-355">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="38f89-356">toolearn о резервных копиях автоматических базы данных SQL Azure, в разделе [базы данных SQL автоматическое резервное копирование](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-356">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="38f89-357">toolearn об использовании автоматического создания резервных копий для восстановления, в разделе [восстановление базы данных из резервных копий, инициируемых службой hello](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-357">toolearn about using automated backups for recovery, see [Restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="38f89-358">toolearn о требования к проверке подлинности для нового основного сервера и базы данных, в разделе [безопасности базы данных SQL после аварийного восстановления](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="38f89-358">toolearn about authentication requirements for a new primary server and database, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

