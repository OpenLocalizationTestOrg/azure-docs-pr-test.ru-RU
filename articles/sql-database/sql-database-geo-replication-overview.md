---
title: "aaaFailover групп и активной георепликации - базы данных SQL Azure | Документы Microsoft"
description: "Группы автоматического перехода на другой ресурс с активной георепликации позволяет toosetup 4 реплик базы данных в любом hello центрами обработки данных Azure и отработки отказа autoomatically hello для события сбоя."
services: sql-database
documentationcenter: na
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 2a29f657-82fb-4283-9a83-e14a144bfd93
ms.service: sql-database
ms.custom: business continuity
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: NA
ms.date: 07/10/2017
ms.author: sashan
ms.openlocfilehash: 7a39af8505624c0f19c5abccff051af836b1f9bc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="overview-failover-groups-and-active-geo-replication"></a>Обзор. Группы отработки отказа и активная георепликация
Активная георепликация обеспечивает tooconfigure копирование toofour для чтения базы данных-получатели hello тот же или другой центр обработки данных расположения (регионы). Базы данных-получатели доступны для запросов, а также для перехода на другой ресурс в случае hello данных center простоя или hello невозможности tooconnect toohello базы данных-источника. Hello перехода на другой ресурс инициируется вручную hello приложения hello пользователя. После отработки отказа новый основной hello имеет конечную точку соединения для различных. 

> [!NOTE]
> Активная георепликация доступна для всех баз данных и всех уровней обслуживания во всех регионах.
>  

Групп автоматического перехода на другой ресурс базы данных SQL Azure (в предварительного просмотра) — Управление tooautomatically функция, предназначенная базы данных SQL георепликации, подключение и переход на другой ресурс в масштабе. С его помощью hello клиентов прибыль hello возможность tooautomatically восстановление связанных баз данных в дополнительный регион hello после разрушительного сбоя региональные или других незапланированных событий, которые приводят к полной или частичной потере hello служба базы данных SQL доступность в основном регионе hello. Кроме того они могут использовать hello баз данных-получателей для чтения toooffload нагрузкам только для чтения.  Так как автоматического перехода на другой ресурс группы включают несколько баз данных они должны быть настроены на сервере-источнике hello. Основной и дополнительный серверы должны находиться в hello одной подписке. Автоматического перехода на другой ресурс группы поддержки репликации всех баз данных в hello группы tooonly один сервер-получатель в другом регионе. Активная георепликация, без автоматического перехода на другой ресурс групп, позволяет копирование баз данных-получателей too4 в любом регионе.

Если вы используете активной георепликации и для любой базы данных-источника выполняется с ошибкой или просто toobe потребности, переводятся в автономный режим может инициировать tooany отработки отказа баз данных-получателей. При активации tooone баз данных-получателей hello отработки отказа все получатели являются автоматически компоноваться toohello новом сервере-источнике. При использовании автоматического перехода на другой ресурс группы восстановления базы данных (в предварительного просмотра) toomanage и любого сбоя, влияет на одно или несколько баз данных hello в hello группы приводит к автоматической отработки отказа. Можно настроить политику hello автоматического перехода на другой ресурс, который лучше всего соответствует требованиям приложения, или можно отказаться от участия и использовать активации вручную. Кроме того, группы автоматической отработки отказа (в предварительной версии) предоставляют конечные точки прослушивателя только для чтения и для чтения-записи, которые во время отработки отказа не изменяются. Используется ли активация ручной или автоматический переход на другой ресурс, переход на другой ресурс коммутаторами всех баз данных-получателей tooprimary группы hello. После завершения отработки отказа базы данных hello hello DNS-запись — новый регион конечных точек hello toohello tooredirect автоматически обновляются.

Вы можете управлять репликацией и отработкой отказа отдельной базы данных или набора баз данных на сервере или в эластичном пуле с помощью активной георепликации. Можно сделать при помощи этого hello [портал Azure](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), или hello [API-интерфейса REST](https://msdn.microsoft.com/library/azure/mt163685.aspx). После отработки отказа убедитесь, что hello требования проверки подлинности для сервера и базы данных можно настроить на новом сервере-источнике hello. Дополнительные сведения см. в разделе [Безопасность базы данных SQL после аварийного восстановления](sql-database-geo-replication-security-config.md). Это относится обе tooactive георепликации и автоматического перехода на другой ресурс группы (в предварительного просмотра).

Hello использует активную георепликацию [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) технологии SQL Server tooasynchronously репликации зафиксированных транзакций на hello базы данных-источника tooa баз данных-получателей с помощью изоляции моментального снимка зафиксированного чтения (RCSI). Автоматического перехода на другой ресурс группы предоставляют семантику hello группы на основе активной георепликации, но hello используется тот же механизм асинхронной репликации. Хотя в любой момент hello базу данных-получатель может отстать от базы данных-источника hello, база данных-получатель hello гарантированно toonever того частичного транзакции. Избыточность в различных регионах позволяет восстановить tooquickly приложения после непоправимого весь центр обработки данных или части центра обработки данных, вызванные стихийные бедствия, разрушительного человеческой ошибки или злонамеренного действия. Hello RPO данных можно найти в [Общие сведения о непрерывности](sql-database-business-continuity.md).

Hello на этом рисунке показан пример активной георепликации настроен с основной области hello North Central US и получателей в регионе hello в США.

![Отношение георепликации](./media/sql-database-active-geo-replication/geo-replication-relationship.png)

Поскольку hello баз данных-получателей для чтения, они могут быть используется toooffload рабочих нагрузок только для чтения, например задания отчетности. Если вы используете активной георепликации, это возможных toocreate hello базы данных-получателя в hello совпадают с основной hello, но она не увеличивает сбоев toocatastrophic устойчивости приложения hello. Если вы используете группы автоматической отработки отказа (в предварительной версии), база данных-получатель всегда будет создаваться в другом регионе.

В дополнение к этому toodisaster восстановления активной георепликации можно использовать в hello следующие сценарии:

* **Миграция базы данных**: toomigrate активной георепликации базы данных с одного сервера tooanother сети можно использовать с минимальным временем простоя.
* **Обновления приложения**: при обновлении приложения вы можете создать дополнительную базу данных-получатель как резервную копию на случай сбоя.

tooachieve настоящей непрерывности, добавление избыточности базы данных между центрами обработки данных является частью решения hello. Восстановление приложения (служба)-законченный после разрушительного сбоя требуется восстановление всех компонентов, которые составляют службу hello и все зависимые службы. Эти компоненты примеры hello клиентское программное обеспечение (например, браузер с пользовательским кодом JavaScript), интерфейсные веб-серверы, хранилища и DNS. Очень важно, что все компоненты гибкой toohello же ошибки и становятся доступными в течение целевого времени восстановления hello (RTO) вашего приложения. Таким образом требуется tooidentify всех зависимых служб и понять гарантии hello и возможностях, которые они предоставляют. Затем необходимо выполнить соответствующие действия tooensure, функциональные возможности службы во время hello hello служб, от которых он зависит. Дополнительные сведения о проектировании решений для аварийного восстановления см. в статье о [разработке облачных решений для аварийного восстановления с помощью активной георепликации](sql-database-designing-cloud-solutions-for-disaster-recovery.md).

## <a name="active-geo-replication-capabilities"></a>Возможности активной георепликации
функция активной георепликации Hello предоставляет hello следующие возможности:
* **Автоматическая асинхронная репликация**: базы данных-получателя можно создать только путем добавления tooan существующей базы данных. Hello получателя могут создаваться в любом сервере базы данных SQL Azure. После создания базы данных-получателя hello заполняется hello данные, скопированные из базы данных-источника hello. Этот процесс называется заполнением. После создания и заполнения базы данных-получателя, обновления базы данных-источника toohello асинхронно, автоматически реплицируются toohello баз данных-получателей. Асинхронная репликация означает, что транзакции фиксируются в базе данных-источнике hello до их toohello реплицированных баз данных-получателей. 
* **Для чтения базы данных-получатели**: приложение может получить доступ к базы данных-получателя для операций чтения с помощью hello таким же или субъекты безопасности, используемый для доступа к базе данных-источнике hello. Hello баз данных-получателей работать с уровнем изоляции snapshot, запросы, выполняемые в hello получателей не задержка репликации tooensure режим обновления hello hello основной (воспроизведение журнала).

   > [!NOTE]
   > Воспроизведение журнала Hello отложена hello базы данных-получателя в случае наличия обновления схемы, он получает из источников, который требуется заблокировать схему базы данных-получателя hello hello. 
   > 

* **Несколько серверов-получателей для чтения**: два или более базы данных-получатели улучшают избыточность и уровень защиты для базы данных-источника hello и приложения. Если существует несколько баз данных-получателей, приложение hello остается защищенным даже в случае сбоя одной из баз данных-получателей hello. Если имеется только одна база данных-получатель и происходит сбой, приложение hello подвергается toohigher риск до создания новой базы данных-получателя.

   > [!NOTE]
   > Если вы используете активной георепликации toobuild глобально распределенного приложения и требуется toodata в регионах более 4 доступ к tooprovide только для чтения, можно создать дополнительного получателя (называемого цепочки). Это гарантирует виртуально неограниченное масштабирование репликации базы данных. Кроме того цепочки сокращает количество служебных hello репликации из базы данных-источника hello. Hello компромисс заключается hello отставания увеличивается трафик репликации для hello конечного большинство баз данных-получателей. . 
   >

* **Поддержка баз данных эластичного пула.** Активную георепликацию можно настроить для любой базы данных в любом эластичном пуле. Hello баз данных-получателей может быть в другом пуле эластичных БД. Для обычных баз данных hello получателей можно эластичного пула и наоборот, пока hello уровням обслуживания относятся hello таким же. 
* **Уровень производительности, можно настроить базу данных-получатель hello**: базы данных-получателя может быть создан с низкой производительностью, чем hello первичной. Первичных и вторичных баз данных необходимы toohave hello же уровень обслуживания. Этот параметр не рекомендуется для приложений с высокой активности записи из-за увеличения Запаздывание hello увеличения hello риск потери значительной данных после отработки отказа. Кроме того после влияет на производительность приложения hello отработки отказа до hello новый первичный обновленного tooa более высокая производительность уровня. Hello диаграммы процент операций ввода-ВЫВОДА журнала на портал Azure предоставляет tooestimate хорошим способом hello уровень минимальной производительности hello получателей, загрузка репликации требуется toosustain hello. Например, если ваш основной базой данных является P6 (1000 DTU) и ее журнала операций ввода-ВЫВОДА % 50% hello получателей toobe требуется не менее P4 (500 DTU). Можно также получить с помощью hello журнала операции ввода-ВЫВОДА данных [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) или [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) представления базы данных.  Дополнительные сведения об уровнях производительности базы данных SQL hello см. в разделе [параметры базы данных SQL и производительности](sql-database-service-tiers.md). 
* **Управляемое пользователем при сбое и**: в любое время hello приложением или пользователем hello базы данных-получателя можно будет явным образом коммутируемых toohello первичной роли. Во время hello реальные сбоя «Незапланированная» параметр должен использоваться, немедленно позволяет основного получателя toobe hello. При неудачных основной hello восстанавливает и доступны еще раз, hello система автоматически hello метки восстановлен основной как получателя и переведите его в новом сервере-источнике hello. Из-за характера асинхронной toohello репликации небольшой объем данных могут быть потеряны во время внеплановой отработки отказа при сбое основного перед репликацией hello самые последние изменения toohello получателя. При сбое основного несколько получателей hello системы автоматически настроит hello связей репликации и вновь оставшихся баз данных-получателей toohello hello ссылки переданы основной без вмешательства пользователя. После устраняется hello сбоя, вызвавшего hello перехода на другой ресурс может быть желательным tooreturn приложения hello toohello основной регион. toodo, что команда отработки отказа hello должны вызываться с hello «запланированное «параметр. 
* **Синхронизации учетных данных и правила брандмауэра**: мы рекомендуем использовать [правила брандмауэра базы данных](sql-database-firewall-configure.md) для географической репликации баз данных, эти правила могут быть реплицированы с tooensure hello базы данных все получатели имеют Здравствуйте же правила брандмауэра как основной hello. Это способ исключает необходимость hello клиентов toomanually настроить и поддерживать правила брандмауэра на серверах, где размещаются как hello первичных и вторичных баз данных. Аналогично, использование [пользователей автономной базы данных](sql-database-manage-logins.md) данных доступ обеспечивает для первичных и вторичных баз данных всегда имеют hello того же пользователя учетные данные, поэтому во время отработки отказа, не нарушений в работе из-за toomismatches с именами входа и пароли. С добавлением hello [Azure Active Directory](../active-directory/active-directory-whatis.md), клиенты могут управлять пользователя tooboth первичных и вторичных баз данных access и устраняя hello требуются для управления учетными данными в базах данных полностью.

## <a name="auto-failover-group-capabilities"></a>Возможности группы автоматической отработки отказа

Группы автоматической отработки отказа обеспечивают расширенную абстракцию активной георепликации за счет поддержки репликации на уровне группы и автоматической отработки отказа. Кроме того она удаляет строку подключения SQL hello toochange hello необходимость после отработки отказа, предоставляя конечные точки hello дополнительного прослушивателя. 

* **Группа отработки отказа.** Вы можете создать одну или несколько групп отработки отказа между двумя серверами в различных регионах (для основного сервера и сервера-получателя). Каждая группа может включать один или несколько баз данных, которые восстанавливаются как единое целое, в случае, если все или некоторые базы данных-источники становятся недоступными из-за сбоя tooan в основном регионе hello.  
* **Сервер-источник**: сервер, на котором размещена hello базы данных-источники в группе hello отработки отказа.
* **Сервер-получатель**: сервер, на котором размещена hello базы данных-получатели hello отработки отказа группой. сервер-получатель Hello не может быть в hello же регионе, что основной сервер hello.
* **Добавление группы баз данных toofailover**: можно поместить несколько баз данных на сервере или в переменной ширины пула в hello же отработки отказа группой. При добавлении базы данных toohello отдельной группы, он автоматически создает базы данных-получателя с помощью того же уровня производительности и выпуск "hello". Если в пуле эластичных hello базы данных-источника, hello получателя автоматически создается в hello эластичного пула с hello таким же именем. При добавлении в базе данных уже имеются базы данных-получателя в hello сервера-получателя, что георепликация наследуется hello группы.

   > [!NOTE]
   > При добавлении в базе данных уже имеются базы данных-получателя на сервере, который не является частью группы отказоустойчивого hello в hello сервера-получателя создается новом сервере-получателе. 
   >

* **Прослушиватель чтения и записи отработки отказа группы**: запись CNAME DNS сформировано как  **&lt;перехода на другой ресурс group-name&gt;. database.windows.net** , указывающий toohello текущей основной URL-адрес сервера. Он позволяет hello приложений SQL чтения и записи tootransparently повторного подключения базы данных-источника toohello при изменении основной hello после отработки отказа. 
* **Переход на другой ресурс прослушивателя группы только для чтения**: DNS запись CNAME сформировано как  **&lt;перехода на другой ресурс group-name&gt;. secondary.database.windows.net** , который указывает URL-адрес дополнительного сервера toohello. Он позволяет hello tootransparently подключения только для чтения приложений SQL toohello баз данных-получателей с помощью hello указанного правила балансировки нагрузки. Также можно указать, если требуется hello только для чтения трафик toobe автоматически перенаправляться toohello основной сервер когда недоступен сервер-получатель hello.
* **Политика автоматического перехода на другой ресурс**: по умолчанию hello перехода на другой ресурс группа настроена политика автоматического перехода на другой ресурс. система Hello инициирует переход на другой ресурс, как можно скорее hello обнаружена ошибка. Если требуется, чтобы рабочий процесс отработки отказа hello toocontrol из приложения hello, можно отключить автоматический переход на другой ресурс. 
* **Отработка отказа вручную**: может инициировать отработку отказа вручную в любое время независимо от конфигурации автоматического перехода на другой ресурс hello. Если политика автоматического перехода на другой ресурс не настроенный отработка отказа вручную не базы данных требуется toorecover hello перехода на другой ресурс группы. Вы можете запустить принудительную отработку отказа или адаптированную (с полной синхронизацией данных). последний Hello может быть основной регион toohello active server используется toorelocate hello. После завершения перехода на другой ресурс hello DNS-записи являются автоматически обновляются tooensure подключения toohello правильный сервер.
* **Льготный период с потерей данных**: поскольку hello первичные и вторичные базы данных синхронизированы с использованием асинхронной репликации hello перехода на другой ресурс может привести к потере данных. Можно настроить политики tooreflect hello автоматический переход на другой потери toodata отклонения вашего приложения. Настроив **GracePeriodWithDataLossHours**, можно задать время ожидания hello системы перед запуском отработки отказа hello, скорее всего, tooresult потеря данных. 

   > [!NOTE]
   > Когда система обнаруживает, базы данных hello в группе hello, все еще в сети (например, сбоя hello только влияет на плоскости управления hello службы), немедленно активируется hello переход на другой ресурс полная синхронизация данных (понятное отработки отказа) независимо от значения hello задается **GracePeriodWithDataLossHours**. Такое поведение гарантирует, что не происходит потери данных во время восстановления hello. период отсрочки Hello вступает в силу только в том случае, если понятное отработки отказа не поддерживается. Если сбой hello, уменьшается до истечения этого периода отсрочки hello, hello перехода на другой ресурс не активирована.
   >

* **Несколько групп отработки отказа**: можно настроить несколько групп отработки отказа для hello одной паре серверов toocontrol hello масштаб переход на другой ресурс. Каждая группа выполняет отработку отказа независимо от других групп. Если ваше мультитенантное приложение использует эластичные пулы, это возможность toomix первичных и вторичных баз данных можно использовать в каждом пуле. Таким образом можно сократить влияние сбоя tooonly hello половины hello клиентов.

## <a name="best-practices-of-building-highly-available-service"></a>Рекомендации по созданию службы высокой доступности

toobuild высокой доступности службы, использующей клиенты hello базы данных Azure SQL придерживаться следующих правил:
- **Использование группы отработки отказа.** Вы можете создать одну или несколько групп отработки отказа между двумя серверами (источником и получателем) в разных регионах. Каждая группа может включать один или несколько баз данных, которые восстанавливаются как единое целое, в случае, если все или некоторые базы данных-источники становятся недоступными из-за сбоя tooan в основном регионе hello. Hello отработки отказа группой создает базы данных-получателя geo с таким же службы как hello основной целью hello. При добавлении существующего георепликации связь toohello перехода на другой ресурс группы убедитесь убедиться, что hello geo-вторичной реплики настроен с таким же службы цель уровня как hello hello первичной.
- **Использование прослушивателя чтения и записи для рабочей нагрузки OLTP**: при выполнении операции используйте OLTP  **&lt;перехода на другой ресурс group-name&gt;. database.windows.net** как URL-адрес сервера hello и hello подключений будет автоматически, направленным toohello первичной. Этот URL-адрес не будет изменен после отработки отказа hello.  
Примечание hello перехода на другой ресурс включает в себя обновления записи DNS, поэтому hello клиентских подключений будет перенаправленный toohello новый основной только после того, клиент hello обновляется кэш DNS приветствия.
- **Использовать только для чтения прослушивателя для рабочей нагрузки только для чтения**: при наличии логически изолированный только для чтения рабочей нагрузке, нечувствительный к ошибкам toocertain устареванием данных можно использовать базы данных-получателя hello в приложение hello. Для использования сеансов только для чтения  **&lt;перехода на другой ресурс group-name&gt;. secondary.database.windows.net** как URL-адрес сервера hello и hello подключение будет автоматически, направленным toohello получателя. Кроме того, мы рекомендуем указать режим только для чтения прямо в строке подключения, добавив аргумент **ApplicationIntent=ReadOnly**. 
- **Можно подготовиться к снижению производительности**: не зависит от hello остальной части приложения hello или других служб, используемых принятия решений для перехода на другой ресурс SQL. приложение Hello может быть «mixed» с некоторых компонентов в одной области, а часть — в другом. снижение hello tooavoid, обеспечить развертывание избыточных приложения hello в регионе hello аварийного восстановления и рекомендации hello в этой статье.  
Приложение hello Примечание в регионе аварийного восстановления hello не имеет toouse отдельную строку подключения.  
- **Подготовка к потере данных**: при обнаружении сбоя SQL автоматически запускает отработку отказа чтения и записи, если наш знаний лучше ноль toohello потери данных. В противном случае он ожидает период hello, заданный при **GracePeriodWithDataLossHours**. Если вы указали параметр **GracePeriodWithDataLossHours**, будьте готовы к потере данных. Во время сбоев Azure, как правило, повышает доступность. Если не может допустить потери данных, убедитесь, что tooset **GracePeriodWithDataLossHours** tooa достаточно большое число, например 24 часа. 


## <a name="upgrading-or-downgrading-a-primary-database"></a>Повышение или понижение уровня производительности базы данных-источника
Можно повысить или понизить уровень производительности базы данных-источника tooa (в пределах hello же службы для уровня использования) без отключения баз данных-получателей. При обновлении, рекомендуется сначала обновить базы данных-получателя hello и затем обновить основной hello. При понижении, в обратном порядке hello: сначала понизить основной hello и затем понизить hello получателя. Эта рекомендация применяется при повысить или понизить уровень другую службу tooa hello базы данных. 

> [!NOTE]
> Если вы создали базу данных-получатель как часть конфигурации группы отказоустойчивого hello не рекомендуемые toodowngrade hello баз данных-получателей. Это tooensure уровень данных, имеет достаточно мощности tooprocess обычную рабочую нагрузку после отработки отказа. 
>

## <a name="preventing-hello-loss-of-critical-data"></a>Предотвращение hello потери важных данных
Из-за toohello высокой задержки глобальных сетей непрерывная копи использует механизм асинхронной репликации. Ввиду асинхронной репликации потеря данных в случае сбоя неизбежна. Тем не менее для некоторых приложений терять данные недопустимо. tooprotect эти важные обновления, разработчик приложения может вызвать hello [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) системная процедура сразу же после фиксации транзакции hello. Вызов **sp_wait_for_database_copy_sync** вызова потоков, до последней зафиксированной транзакции hello hello блоки передаются toohello баз данных-получателей. Тем не менее он не ожидает hello передачи транзакции toobe воспроизведения и зафиксирована в hello получателей. **sp_wait_for_database_copy_sync** — с областью tooa определенной связи непрерывной копии. Эту процедуру можно вызывать любой пользователь, имеющий hello подключения права toohello базы данных-источника.

> [!NOTE]
> Процедура **sp_wait_for_database_copy_sync** предотвратит потерю данных после отработки отказа, но не гарантирует полную синхронизацию для доступа на чтение. Здравствуйте, задержка, вызванная **sp_wait_for_database_copy_sync** вызов процедуры могут оказаться значительными и зависит от размера hello hello журнала транзакций во время вызова hello hello. 
> 

## <a name="programmatically-managing-failover-groups-and-active-geo-replication"></a>Программное управление группами отработки отказа и активной георепликацией
Как отмечалось ранее, групп автоматического перехода на другой ресурс (в просмотр) и активных географической репликации также можно управлять программно с помощью Azure PowerShell и hello REST API. Hello следующие таблицы описывают hello набор доступных команд.

**API диспетчера ресурсов Azure и безопасности на основе ролей**: активная георепликация включает в себя набор API диспетчера ресурсов Azure для управления, включая hello [API REST для базы данных SQL Azure](https://docs.microsoft.com/rest/api/sql/) и [Azure Командлеты PowerShell](https://docs.microsoft.com/powershell/azure/overview). Эти API-интерфейсы требуют hello использование групп ресурсов и поддерживают безопасность на основе ролей (RBAC). Дополнительные сведения о как tooimplement доступ к роли см. в разделе [контроля доступа](../active-directory/role-based-access-control-what-is.md).

> [!NOTE]
> Многие новые функции активной георепликации поддерживаются только в [REST API SQL Azure](../azure-resource-manager/resource-group-overview.md) и [командлетах PowerShell базы данных SQL Azure](https://msdn.microsoft.com/library/azure/mt163571.aspx) на основе [Azure Resource Manager](https://msdn.microsoft.com/library/azure/mt574084.aspx). Hello [(классической) API-интерфейса REST](https://msdn.microsoft.com/library/azure/dn505719.aspx) и [командлеты базы данных SQL Azure (классические)](https://msdn.microsoft.com/library/azure/dn546723.aspx) поддерживаются для обеспечения обратной совместимости, поэтому использование hello, рекомендуется использовать API на основе диспетчера ресурсов Azure. 
> 

## <a name="manage-sql-database-failover-using-using-transact-sql"></a>Управление SQL базы данных отработки отказа с помощью с помощью Transact-SQL

| Команда | Описание |
| --- | --- |
| [ALTER DATABASE (база данных SQL Azure)](https://msdn.microsoft.com/library/mt574871.aspx) |Добавление сервера-ПОЛУЧАТЕЛЯ ON аргумент toocreate базы данных-получателя для существующей базы данных и запускает репликацию данных |
| [ALTER DATABASE (база данных SQL Azure)](https://msdn.microsoft.com/library/mt574871.aspx) |Использовать переход на другой РЕСУРС или FORCE_FAILOVER_ALLOW_DATA_LOSS tooswitch toobe tooinitiate основной базы данных-получателя отработки отказа |
| [ALTER DATABASE (база данных SQL Azure)](https://msdn.microsoft.com/library/mt574871.aspx) |С помощью удаления сервера-ПОЛУЧАТЕЛЯ ON tooterminate репликацию данных между базой данных SQL и hello указанной базы данных-получателя. |
| [sys.geo_replication_links (база данных SQL Azure)](https://msdn.microsoft.com/library/mt575501.aspx) |Возвращает сведения о всех связей репликации для каждой базы данных на логическом сервере hello базы данных SQL Azure. |
| [sys.dm_geo_replication_link_status (база данных SQL Azure)](https://msdn.microsoft.com/library/mt575504.aspx) |Возвращает hello последнее время репликации, последний Запаздывание репликации и другие сведения о hello связь репликации для базы данных SQL. |
| [sys.dm_operation_status (база данных SQL Azure)](https://msdn.microsoft.com/library/dn270022.aspx) |Отображается состояние всех операций базы данных, включая состояние связи репликации hello hello hello. |
| [sp_wait_for_database_copy_sync (база данных SQL Azure)](https://msdn.microsoft.com/library/dn467644.aspx) |вызывает toowait приложения hello, пока все зафиксированные транзакции будут реплицированы и подтверждается hello активную вторичную базу данных. |
|  | |

## <a name="manage-sql-database-failover-using-using-powershell"></a>Управление SQL базы данных отработки отказа с помощью с помощью PowerShell

| Командлет | Описание |
| --- | --- |
| [Get-AzureRmSqlDatabase](/powershell/module/azurerm.sql/get-azurermsqldatabase) |Получает одну или несколько баз данных. |
| [New-AzureRmSqlDatabaseSecondary](/powershell/module/azurerm.sql/new-azurermsqldatabasesecondary) |Создает базу данных-получатель для существующей базы данных и начинает репликацию данных. |
| [Set-AzureRmSqlDatabaseSecondary](/powershell/module/azurerm.sql/set-azurermsqldatabasesecondary) |Переключает основной tooinitiate toobe отработки отказа базы данных-получателя. |
| [Remove-AzureRmSqlDatabaseSecondary](/powershell/module/azurerm.sql/remove-azurermsqldatabasesecondary) |Завершает репликацию данных между базой данных SQL и hello указанной базы данных-получателя. |
| [Get-AzureRmSqlDatabaseReplicationLink](/powershell/module/azurerm.sql/get-azurermsqldatabasereplicationlink) |Получает ссылки hello географическую репликацию данных между базы данных SQL Azure и группы ресурсов или SQL Server. |
| [New-AzureRmSqlDatabaseFailoverGroup](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   Создает группу отработки отказа и регистрирует ее на основном сервере и сервере-получателе.|
| [Remove-AzureRmSqlDatabaseFailoverGroup](/powershell/module/azurerm.sql/remove-azurermsqldatabasefailovergroup) | Удаляются hello отработки отказа группой hello сервера и всех баз данных-получателей включены hello группы |
| [Get-AzureRmSqlDatabaseFailoverGroup](/powershell/module/azurerm.sql/get-azurermsqldatabasefailovergroup) | Получает конфигурацию группы hello отработки отказа |
| [Set-AzureRmSqlDatabaseFailoverGroup](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   Изменяет конфигурацию hello hello перехода на другой ресурс группы |
| [Switch-AzureRMSqlDatabaseFailoverGroup](/powershell/module/azurerm.sql/switch-azurermsqldatabasefailovergroup) | Отработка отказа триггеры hello перехода на другой ресурс группы toohello сервера-получателя |
|  | |

> [!IMPORTANT]
> Дополнительные сведения о примерах сценариев см. в статьях [Настройка активной георепликации для отдельной базы данных SQL Azure с помощью PowerShell](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Настройка активной георепликации для базы данных SQL Azure в составе пула с помощью PowerShell](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), а также [Use PowerShell to configure an active geo-replication failover group for a single Azure SQL database](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md) (Использование PowerShell для настройки группы отработки отказа активной георепликации для отдельной базы данных SQL Azure (предварительная версия)).
>

## <a name="manage-sql-database-failover-using-hello-rest-api"></a>Управлять переключением базы данных SQL с помощью API-интерфейса REST hello
| API | Описание |
| --- | --- |
| [Создание или обновление базы данных (createMode=Restore)](/rest/api/sql/Databases/CreateOrUpdate) |Создает, обновляет или восстанавливает базу данных-источник или базу данных-получатель. |
| [Получение, создание или обновление состояния базы данных](/rest/api/sql/Databases/CreateOrUpdate) |Возвращает состояние hello во время операции создания. |
| [Задание базы данных-получателя в качестве базы данных-источника (плановая отработка отказа)](https://docs.microsoft.com/rest/api/sql/replicationlinkss#ReplicationLinks_Failover) |Задает, какой реплики базы данных является первичным, нужно выполнить переход из hello текущей первичной реплики базы данных. |
| [Задание базы данных-получателя в качестве базы данных-источника (внеплановая отработка отказа)](https://docs.microsoft.com/rest/api/sql/replicationlinks#ReplicationLinks_FailoverAllowDataLoss) |Задает, какой реплики базы данных является первичным, нужно выполнить переход из hello текущей первичной реплики базы данных. Эта операция может привести к потере данных. |
| [Получение связи репликации](/rest/api/sql/replicationlinks/get) |Получает определенную связь репликации для заданной базы данных SQL, участвующей в партнерстве георепликации. Он извлекает hello сведения, отображаемые в представлении каталога sys.geo_replication_links hello. |
| [Replication Links - List By Database](/rest/api/sql/replicationlinks/listbydatabase) (Ссылки для репликации: вывод списка по базе данных) | Получает все связи репликации для заданной базы данных SQL, участвующей в партнерстве георепликации. Он извлекает hello сведения, отображаемые в представлении каталога sys.geo_replication_links hello. |
| [Удаление связей репликации](/rest/api/sql/databases/delete) | Удаляет связь репликации базы данных. Невозможно выполнить во время отработки отказа. |
| [Создание или обновление групп отработки отказа]/rest/api/sql/failovergroups/createorupdate) | Создает или обновляет группу отработки отказа. |
| [Удаление группы отработки отказа](/rest/api/sql/failovergroups/delete) | Удаляет группу hello отработки отказа из сервера hello |
| [Плановая отработка отказа](/rest/api/sql/failovergroups/failover) | При сбое hello текущего сервера toothis сервера-источника. |
| [Принудительная отработка отказа (возможна потеря данных)](/rest/api/sql/failovergroups/forcefailoverallowdataloss) |ails над hello текущего сервера toothis сервера-источника. Эта операция может привести к потере данных. |
| [Получение группы отработки отказа](/rest/api/sql/failovergroups/get) | Получает группу отработки отказа. |
| [Вывод списка групп отработки отказа с фильтрацией по серверу](/rest/api/sql/failovergroups/listbyserver) | Список групп hello перехода на другой ресурс на сервере. |
| [Обновление группы отработки отказа](/rest/api/sql/failovergroups/update) | Обновляет группу отработки отказа. |
|  | |

## <a name="next-steps"></a>Дальнейшие действия
* Ознакомьтесь с примерами скриптов в следующих статьях:
   - [Настройка активной георепликации для отдельной базы данных SQL Azure с помощью PowerShell](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
   - [Настройка активной георепликации для базы данных SQL Azure в составе пула с помощью PowerShell](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md)
   - [Use PowerShell to configure an active geo-replication failover group for a single Azure SQL database](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md) (Использование PowerShell для настройки группы отработки отказа активной георепликации для отдельной базы данных SQL Azure (предварительная версия)).
* Сведения об обеспечении непрерывности бизнес-процессов и возможные сценарии описаны в [обзоре непрерывности бизнес-процессов](sql-database-business-continuity.md)
* toolearn о резервных копиях автоматических базы данных SQL Azure, в разделе [базы данных SQL автоматическое резервное копирование](sql-database-automated-backups.md).
* toolearn об использовании автоматического создания резервных копий для восстановления, в разделе [восстановление базы данных из резервных копий, инициируемых службой hello](sql-database-recovery-using-backups.md).
* toolearn о требования к проверке подлинности для нового основного сервера и базы данных, в разделе [безопасности базы данных SQL после аварийного восстановления](sql-database-geo-replication-security-config.md).

