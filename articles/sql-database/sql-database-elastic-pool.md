---
title: "Управление несколькими базами данных SQL с помощью эластичных пулов Azure | Документация Майкрософт"
description: "Управление несколькими базами данных SQL (сотнями и тысячами) и их масштабирование с помощью эластичных пулов. Фиксированная цена за ресурсы, которые можно распределить туда, где они нужны."
keywords: "несколько баз данных, ресурсы базы данных, производительность базы данных"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: b46e7fdc-2238-4b3b-a944-8ab36c5bdb8e
ms.service: sql-database
ms.custom: DBs & servers
ms.devlang: NA
ms.date: 10/11/2017
ms.author: carlrab
ms.workload: Active
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 2f1ff7a7c2ecf04069ffa6afcc66e2f0f9915b35
ms.sourcegitcommit: dfd49613fce4ce917e844d205c85359ff093bb9c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="elastic-pools-help-you-manage-and-scale-multiple-azure-sql-databases"></a>Управление несколькими базами данных SQL Azure и их масштабирование с помощью эластичных пулов

Эластичные пулы баз данных SQL — это простое и экономичное решение для администрирования и масштабирования нескольких баз данных с отличными и непредсказуемыми требованиями к ресурсам. Базы данных в составе эластичного пула размещены на одном сервере базы данных SQL Azure и совместно используют определенный набор ресурсов ([единицы транзакций эластичных баз данных](sql-database-what-is-a-dtu.md) (eDTU)) по фиксированной цене. Пулы эластичных БД в базе данных SQL Azure позволяют разработчикам SaaS оптимизировать соотношение цены и производительности для группы баз данных с назначенным бюджетом и при этом обеспечить эластичность производительности для каждой базы данных. 

> [!NOTE]
> Пулы эластичных БД общедоступны во всех регионах Azure, кроме западной Индии, где сейчас доступна только предварительная версия. Общедоступные пулы эластичных БД появятся в этом регионе в самое ближайшее время.
>

## <a name="what-are-sql-elastic-pools"></a>Что такое эластичные пулы SQL? 

Разработчики SaaS создают приложения на основе уровней данных большого размера, состоящих из нескольких баз данных. Обычно для каждого клиента подготавливается одна база данных. Но нередко разные клиенты по-разному и непредсказуемо используют приложения, в связи с этим трудно спрогнозировать требования к ресурсам каждого отдельного пользователя базы данных. Обычно имеется два варианта: 

- избыточная подготовка ресурсов в соответствии с пиковой нагрузкой и переплата или
- подготовка недостаточного числа ресурсов в целях экономии в ущерб производительности и удовлетворенности клиентов во время всплесков загрузки. 

Эластичные пулы устраняют эту проблему, обеспечивая базы данных необходимыми ресурсами производительности, когда они нужны. Они предоставляют простой механизм распределения ресурсов в рамках прогнозируемого бюджета. Дополнительные сведения о шаблонах разработки для приложений SaaS, использующих пулы эластичных БД, см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием базы данных Azure SQL](sql-database-design-patterns-multi-tenancy-saas-applications.md).

> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Elastic-databases-helps-SaaS-developers-tame-explosive-growth/player]
>

Эластичные пулы позволяют разработчикам покупать [единицы транзакций эластичных баз данных](sql-database-what-is-a-dtu.md) (eDTU) для пула, который совместно используется несколькими базами данных, чтобы обеспечить работу отдельных баз данных в непрогнозируемые периоды использования. Требование к DTU для пула определяется совокупным использованием его баз данных. Число единиц eDTU, доступных для пула, определяется бюджетом разработчика. Разработчик просто добавляет базы данных в пул, задает минимальное и максимальное число eDTU для баз данных и затем задает значение eDTU для пула на основе своего бюджета. С помощью пулов разработчик может легко перевести качество своих услуг с уровня небольшой новой компании на уровень состоявшегося бизнеса с возможностями роста.

Отдельным базам данных в пуле предоставляется возможность гибкого автоматического масштабирования в рамках заданных параметров. В условиях интенсивной нагрузки база данных может использовать дополнительные единицы eDTU для удовлетворения потребности в ресурсах. При небольших нагрузках базы данных используют меньше ресурсов (eDTU), а при отсутствии нагрузок не используют их вовсе. Подготовка ресурсов для всего пула, а не для отдельной базы данных упрощает задачи управления. Кроме того, используя пул, вы можете спрогнозировать расходы. Добавить дополнительные единицы eDTU в существующий пул можно без простоя баз данных. Однако чтобы предоставить дополнительные вычислительные ресурсы для нового резервирования eDTU может понадобиться переместить базы данных. Точно так же, если eDTU больше не нужны, они могут быть удалены из существующего пула в любой момент времени. Вы также можете добавлять базы данных в пул или удалять их из него. Если у базы данных прогнозируемо низкие показатели использования ресурсов, ее можно удалить.

## <a name="when-should-you-consider-a-sql-database-elastic-pool"></a>Когда следует использовать эластичный пул базы данных SQL?

Пулы хорошо подходят для большого числа баз данных с конкретными закономерностями использования. Для заданной базы данных эта закономерность характеризуется низким средним использованием с относительно редкими пиками использования.

Чем больше баз данных можно добавить в пул, тем больше экономия. Но в зависимости от закономерности использования приложения можно сэкономить средства при наличии всего двух баз данных уровня S3. 

Следующие разделы помогут вам понять, как оценить преимущества, связанные с использованием пула с определенным набором баз данных. В примерах используются пулы уровня Стандартный, однако эти же принципы применимы к пулам уровней Базовый и Премиум.

### <a name="assessing-database-utilization-patterns"></a>Оценка закономерностей использования баз данных

На следующем рисунке показан пример базы данных, которая большую часть времени находится в режиме ожидания, но также у нее периодически возникают пики активности. Такая модель использования хорошо подходит для пула:

   ![отдельная база данных, подходящая для пула](./media/sql-database-elastic-pool/one-database.png)

В течение пяти минут пики базы данных DB1 достигают 90 DTU, но общее среднее использование составляет менее 5 DTU. Для запуска этой рабочей нагрузки в одной базе данных требуется уровень производительности S3, но при этом большая часть ресурсов останется неиспользуемой в периоды низкой активности.

Пул позволяет разделить эти незадействованные единицы DTU между несколькими базами данных, тем самым сокращая общее число необходимых единиц DTU и, следовательно, расходы.

На основе предыдущего примера предположим, что существуют дополнительные базы данных с закономерностями использования, схожими с закономерностью использования базы данных DB1. На следующих двух рисунках показано использование четырех и двадцати баз данных на одной диаграмме, чтобы продемонстрировать, что их использование не пересекается во времени:

   ![четыре базы данных с закономерностями использования, подходящими для пула](./media/sql-database-elastic-pool/four-databases.png)

   ![двадцать баз данных с закономерностями использования, подходящими для пула](./media/sql-database-elastic-pool/twenty-databases.png)

Совокупное использование DTU для всех 20 баз данных представлено черной линией на рисунке выше. На рисунке видно, что совокупное использование DTU никогда не превышает 100 DTU, и показано, что 20 баз данных могут совместно использовать 100 eDTU в этом периоде времени. Это приводит к 20-кратному сокращению количества единиц DTU и 13-кратному снижению цены по сравнению с размещением каждой базы данных на уровнях производительности S3 для отдельных баз данных.

Этот пример является идеальным по следующим причинам.

* Существует большая разница между пиковым использованием и средним использованием для каждой базы данных. 
* Пиковое использование для каждой базы данных возникает в разное время.
* eDTU совместно используются многими базами данных.

Цена пула зависит от количества eDTU в пуле. Хотя цена единицы eDTU для пула в 1,5 раза выше цены единицы DTU для отдельной базы данных, **единицы eDTU пула могут совместно использоваться множеством баз данных, следовательно, требуется меньшее общее число единиц eDTU**. Эти различия в цене и совместное использование единиц eDTU является основой возможности экономии, которую может предоставить пул. 

Следующие практические правила в отношении количества баз данных и их использования помогут гарантировать, что стоимость использования пула будет ниже по сравнению со стоимостью уровней производительности для отдельных баз данных.

### <a name="minimum-number-of-databases"></a>Минимальное число баз данных

Если сумма DTU уровней производительности для одной базы данных превышает 1,5 единицы eDTU, необходимых для пула, использовать эластичный пул будет более экономично. Доступные размеры см. в разделе [eDTU и размеры хранилища для эластичных баз данных и пулов эластичных баз данных](sql-database-resource-limits.md#elastic-pool-storage-sizes-and-performance-levels).

***Пример***<br>
Чтобы использование пула было более экономичным, чем использование уровней производительности для отдельных баз данных, требуется не менее двух баз данных уровня S3 или не менее 15 баз данных уровня S0 для пула со 100 единицами eDTU.

### <a name="maximum-number-of-concurrently-peaking-databases"></a>Максимальное число баз данных с одновременными пиками

Из-за совместного использования единиц eDTU не все базы данных в пуле могут одновременно использовать предельные значения единиц eDTU, которые доступны при использовании уровней производительности для отдельных баз данных. Чем меньше баз данных с одновременными пиками, тем меньше значение для единиц eDTU, которое можно задавать, и тем более экономичным становится пул. Как правило, в пуле должно быть не более 2/3 (или 67 %) от всего числа баз данных с одновременным пиком до предельных значений единиц eDTU.

***Пример***<br>
Чтобы сократить затраты для трех баз данных уровня S3 в пуле с 200 единицами eDTU, одновременно испытывать пиковые нагрузки должны не более двух баз данных в пуле. В противном случае, если пиковую нагрузку одновременно испытывают более двух из этих четырех баз данных уровня S3, размер пула необходимо увеличить, так чтобы количество единиц eDTU было больше 200. Если значение размера пула превышает 200 единиц eDTU, необходимо добавить больше баз данных S3, чтобы расходы были ниже, чем на уровни производительности для отдельных баз данных.

Обратите внимание, что в данном примере не учитывается использование других баз данных в пуле. Если все базы данных используются в любой заданной временной точке, тогда одновременно испытывать пиковую нагрузку могут менее 2/3 (или 67 %) от числа баз данных.

### <a name="dtu-utilization-per-database"></a>Использование единиц DTU на одну базу данных
Большая разница между пиковым и средним использованием базы данных указывает на продолжительные периоды низкого уровня использования и короткие периоды высокого уровня использования. Эта закономерность использования идеально подходит для совместного использования ресурсов несколькими базами данных. Следует рассматривать помещение базы данных в пул, если ее загрузка пикового использования в 1,5 раза больше загрузки среднего использования.

***Пример***<br>
База данных уровня S3 с пиковым использованием 100 единиц DTU и средним использованием до 67 единиц DTU хорошо подходит для совместного использования единиц eDTU в пуле. Кроме того, база данных уровня S1 с пиковым использованием 20 единиц DTU и средним использованием 13 единиц DTU или менее хорошо подходит для пула.

## <a name="how-do-i-choose-the-correct-pool-size"></a>Как выбрать пул правильного размера?

Наилучший размер пула зависит от совокупного количества единиц eDTU и ресурсов хранения, необходимых для всех баз данных в пуле. Для этого необходимо определить наибольшую из следующих двух величин:

* Максимальное число единиц DTU, используемых всеми базами данных в пуле.
* Максимальное число байтов памяти, используемых всеми базами данных в пуле.

Доступные размеры см. в разделе [eDTU и размеры хранилища для эластичных баз данных и пулов эластичных баз данных](sql-database-resource-limits.md#elastic-pool-storage-sizes-and-performance-levels).

База данных SQL автоматически оценивает историю использования ресурсов баз данных на существующем сервере баз данных SQL и рекомендует подходящую конфигурацию пула в портале Azure. В дополнение к рекомендациям существуют встроенные возможности по оценке использования единиц eDTU для пользовательских групп баз данных на сервере. Это позволяет выполнить анализ "что если", интерактивно добавляя базы данных в пул и удаляя их, а также получить аналитические данные об использовании ресурсов и изменить размер перед выполнением изменений на практике. Инструкции см. в статье [Мониторинг пула эластичных баз данных и управление им на портале Azure](sql-database-elastic-pool-manage-portal.md).

В случаях, когда невозможно использовать инструменты, вы сможете оценить экономность пула по сравнению с отдельными базами данных, выполнив следующие пошаговые инструкции:

1. Оцените количество единиц eDTU, необходимых для пула, следующим образом:

   MAX(<*общее число баз данных* X *среднее использование DTU на базу данных*>,<br>
   <*количество баз данных с одновременными пиками* X *пиковое использование единиц DTU на базу данных*)
2. Оцените пространство хранилища, необходимое для пула, сложив количество байтов, необходимых для всех баз данных в пуле. Затем определите размер пула eDTU, который предоставляет этот объем хранилища. Ограничения хранилища пула по размеру пула в eDTU см. в разделе [eDTU и размеры хранилища для эластичных баз данных и пулов эластичных баз данных](sql-database-resource-limits.md#elastic-pool-storage-sizes-and-performance-levels).
3. Выберите максимальную из оценок количества единиц eDTU, полученных на шаге 1 и шаге 2.
4. Загляните на [страницу цен для баз данных SQL](https://azure.microsoft.com/pricing/details/sql-database/) и найдите наименьшее количество единиц eDTU для пула, которое будет больше оценки, полученной на шаге 3.
5. Сравните стоимость пула из шага 5 со стоимостью использования подходящих уровней производительности отдельных баз данных.

## <a name="using-other-sql-database-features-with-elastic-pools"></a>Использование других функций базы данных SQL с эластичными пулами

### <a name="elastic-jobs-and-elastic-pools"></a>Эластичные задания и эластичные пулы

Пул упрощает выполнение задач управления, так как позволяет выполнять сценарии в **[заданиях обработки эластичных БД](sql-database-elastic-jobs-overview.md)**. Задания обработки эластичных БД позволяют сократить объем трудоемких операций, связанных с управлением большим количеством баз данных. Сведения о начале работы см. в статье [Начало работы с заданиями обработки эластичных баз данных](sql-database-elastic-jobs-getting-started.md).

Дополнительные сведения о других средствах баз данных для работы с несколькими базами данных см. в статье [Развертывание с помощью Базы данных SQL Azure](sql-database-elastic-scale-introduction.md).

### <a name="business-continuity-options-for-databases-in-an-elastic-pool"></a>Возможности обеспечения непрерывности бизнес-процессов для баз данных в эластичных пулах
Базы данных в составе пула поддерживают те же [возможности по обеспечению непрерывности бизнес-процессов](sql-database-business-continuity.md), что и отдельные базы данных.

- **Восстановление до точки во времени.** При восстановлении до точки во времени используются создаваемые автоматически резервные копии баз данных, чтобы восстановить базу данных в пуле на определенный момент времени. Ознакомьтесь с разделом [Восстановление до точки во времени](sql-database-recovery-using-backups.md#point-in-time-restore)

- **Геовосстановление.** Геовосстановление используется по умолчанию, когда база данных недоступна из-за происшествия в регионе, где она размещена. Ознакомьтесь с разделом [Восстановление базы данных SQL Azure или переход на базу данных-получатель при отказе](sql-database-disaster-recovery.md)

- **Активная георепликация.** Для приложений c более высокими требованиями к восстановлению по сравнению с возможностями геовосстановления настройте [активную георепликацию](sql-database-geo-replication-overview.md).

## <a name="manage-elastic-pools-and-databases-using-the-azure-portal"></a>Управление эластичными пулами и базами данных с помощью портала Azure

### <a name="creating-a-new-sql-database-elastic-pool-using-the-azure-portal"></a>Создание нового эластичного пула базы данных SQL с помощью портала Azure

На портале Azure эластичный пул можно создать двумя способами. Если вы знаете требуемые настройки пула, вы можете создать его с нуля, или же можно следовать рекомендациям службы. База данных SQL автоматически предоставляет интеллектуальные рекомендации по настройке эластичного пула, если это экономически выгодно для вас с учетом последних данных телеметрии об использовании баз данных. 

Чтобы создать эластичный пул и переместить в него имеющиеся базы данных, проще всего использовать страницу имеющегося сервера на портале. Вы также можете создать эластичный пул, выполнив поиск по строке **пул эластичных БД SQL** в **Marketplace** или нажав кнопку **Добавить** на странице "Пулы эластичных БД SQL". В процессе подготовки пула вы можете создать новый сервер или указать существующий.

> [!NOTE]
> На сервере можно создать несколько пулов, но в один пул нельзя добавлять базы данных с разных серверов.
> 

Ценовая категория пула определяет функции, которые будут доступны для эластичных баз данных в пуле, максимальное количество единиц eDTU (eDTU MAX) и объем хранилища (в гигабайтах) для каждой базы данных. Дополнительные сведения см. в разделе [Уровни служб и уровни производительности](sql-database-resource-limits.md#elastic-pool-storage-sizes-and-performance-levels).

Чтобы изменить ценовую категорию для пула, щелкните **Ценовая категория**, укажите нужную категорию и нажмите кнопку **Выбрать**.

> [!IMPORTANT]
> Если вы выбрали ценовую категорию и подтвердили изменения нажатием кнопки **ОК** на последнем шаге, изменить ценовую категорию пула будет невозможно. Чтобы изменить ценовую категорию для существующего эластичного пула, создайте новый эластичный пул в нужной ценовой категории и перенесите в него базы данных.
>

Если базы данных, с которыми вы работаете, содержат достаточно данных телеметрии об использовании за прошедший период, график **Estimated eDTU and GB usage** (Примерный объем использования eDTU и ГБ) и линейчатая диаграмма **Actual eDTU usage** (Фактический объем использования eDTU) будут обновляться, помогая вам принимать решения относительно конфигурации. Кроме того, служба может предоставить вам рекомендации, которые помогут выбрать правильный размер пула.

Служба базы данных SQL оценивает историю использования и рекомендует один или несколько пулов, если этот вариант экономичнее, чем отдельные базы данных. Для предоставления каждой рекомендации используется уникальное подмножество баз данных на сервере, которое лучше всего подходит для формирования пула.

![рекомендуемый пул](./media/sql-database-elastic-pool-create-portal/recommended-pool.png) 

Рекомендация для пула включает следующие аспекты:

- ценовая категория для пула ("Базовый", "Стандартный", "Премиум" или "Премиум RS").
- соответствующее количество **единиц eDTU пула** (также называемое максимальным количеством единиц eDTU для одного пула);
- **максимальное** и **минимальное количество единиц eDTU** для каждой базы данных;
- список рекомендуемых баз данных для пула.

> [!IMPORTANT]
> При составлении рекомендаций для пула служба учитывает данные телеметрии за последние 30 дней. Чтобы база данных рассматривалась для включения в эластичный пул, она должна существовать не менее 7 дней. Базы данных, которые уже находятся в эластичном пуле, не рассматриваются в качестве кандидатов для рекомендуемого добавления в пул.
>

Служба оценивает потребность в ресурсах и экономичность перемещения каждой отдельной базы данных на каждом уровне службы в пулы того же уровня. Например, все базы данных Standard на сервере оцениваются на предмет возможности их добавления в пул эластичных баз данных уровня Standard. Это означает, что служба не предоставляет кросс-уровневые рекомендации, такие как перемещение базы данных Standard в пул Premium.

После того как вы добавите базы данных в пул, на основе сведений об использовании выбранных баз данных будут динамически создаваться рекомендации. Эти рекомендации отображаются в диаграмме использования (со значениями eDTU и ГБ), а также на баннере рекомендаций в верхней части страницы **Настроить пул**. Эти рекомендации помогут вам создать эластичный пул, оптимизированный для конкретных баз данных.

![Динамические рекомендации](./media/sql-database-elastic-pool-create-portal/dynamic-recommendation.png)

### <a name="manage-and-monitor-an-elastic-pool"></a>Мониторинг эластичного пула и управление им

На портале Azure можно отслеживать использование эластичного пула и баз данных в этом пуле. Можно также внести ряд изменений в эластичный пул и отправить все изменения одновременно. К таким изменениям относятся добавление или удаление баз данных, изменение параметров эластичного пула и изменение параметров базы данных.

Ниже показан пример эластичного пула. Представление включает в себя следующие компоненты.

* Диаграммы для мониторинга использования ресурсов эластичного пула и содержащихся в нем баз данных.
* Кнопка пула **Настроить** для внесения изменений в эластичный пул.
* Кнопка **Создать базу данных**, которая создает базу данных и добавляет ее в текущий эластичный пул.
* Задания обработки эластичных БД, которые помогают управлять большим количеством баз данных, запуская скрипты Transact-SQL для всех баз данных в списке.

![Представление пула](./media/sql-database-elastic-pool-manage-portal/basic.png)

Можно перейти к определенному пулу, чтобы просмотреть использование его ресурсов. По умолчанию для пула настроено отображение использования хранилища и eDTU за последний час. Диаграмму можно настроить для отображения разных показателей за разные периоды времени. Щелкните диаграмму **Использование ресурсов** в разделе **Наблюдение за пулами эластичных БД**, чтобы отобразить подробное представление выбранных метрик за указанный период.

![Мониторинг эластичного пула](./media/sql-database-elastic-pool-manage-portal/basic-2.png)

![Страница метрики](./media/sql-database-elastic-pool-manage-portal/metric.png)

### <a name="to-customize-the-chart-display"></a>Настройка внешнего вида диаграммы

Вы можете отредактировать диаграмму и страницу метрики для отображения других метрик, включая процент использования ЦП, процент операций ввода-вывода данных и операций ввода-вывода журнала.

![Щелкните "Изменить".](./media/sql-database-elastic-pool-manage-portal/edit-metric.png)

В форме **Изменение диаграммы** выберите диапазон времени (последний час, текущий день или последняя неделя) или нажмите кнопку **Пользовательский**, чтобы выбрать любой диапазон времени в пределах двух последних недель. Выберите тип диаграммы (гистограмма или график), а затем выберите ресурсы для мониторинга.

> [!Note]
> Диаграмма может одновременно показывать несколько метрик с одинаковыми единицами измерения. Например, если вы выберете "Процент eDTU", дополнительно можно выбрать только те метрики, которые измеряются в процентах.
>

![Щелкните "Изменить".](./media/sql-database-elastic-pool-manage-portal/edit-chart.png)

### <a name="manage-and-monitor-databases-in-an-elastic-pool"></a>Мониторинг баз данных в эластичном пуле и управление ими

Отдельные базы данных также можно отслеживать на наличие потенциальных проблем. В разделе **Мониторинг эластичных баз данных**есть диаграмма, на которой отображаются метрики для пяти баз данных. По умолчанию на диаграмме отображаются пять основных баз данных в пуле по среднему использованию eDTU за последний час. 

![Мониторинг эластичного пула](./media/sql-database-elastic-pool-manage-portal/basic-3.png)

Щелкните диаграмму **eDTU usage for databases for the past hour** (Использование eDTU баз данных за последний час) в разделе **Наблюдение за эластичными базами данных**. При этом откроется колонка **Использование ресурсов базы данных** с подробным представлением использования базы данных в пуле. Сетка в нижней части страницы позволяет выбрать любые базы данных в пуле, чтобы отобразить их использование на диаграмме (до пяти баз данных). Вы можете также настроить метрики и окно времени, отображаемые на диаграмме. Для этого щелкните **Изменить диаграмму**.

![Страница "Использование ресурсов базы данных"](./media/sql-database-elastic-pool-manage-portal/db-utilization.png)

### <a name="to-customize-the-view"></a>Настройка представления

Можно изменить диаграмму и выбрать диапазон времени (последний час или последние сутки) или нажать кнопку **Пользовательский**, чтобы выбрать другой день в пределах последних 2 недель.

![Элемент управления "Изменение диаграммы"](./media/sql-database-elastic-pool-manage-portal/db-utilization-blade.png)

![Элемент управления "Пользовательский"](./media/sql-database-elastic-pool-manage-portal/editchart-date-time.png)

Вы также можете щелкнуть раскрывающийся список **Сравнить базы данных по**, чтобы выбрать другую метрику для использования при сравнении баз данных.

![Изменение диаграммы](./media/sql-database-elastic-pool-manage-portal/edit-comparison-metric.png)

### <a name="to-select-databases-to-monitor"></a>Выбор баз данных для мониторинга

В списке баз данных на странице **Использование ресурсов базы данных** можно найти определенные базы данных, просматривая страницы списка или вводя имя базы данных. Установите флажок, чтобы выбрать нужную базу данных.

![Поиск баз данных для мониторинга](./media/sql-database-elastic-pool-manage-portal/select-dbs.png)


### <a name="add-an-alert-to-an-elastic-pool-resource"></a>Добавление оповещения для ресурса эластичного пула

К эластичному пулу можно добавить правила для отправки сообщений электронной почты конкретным людям или строк оповещений на конкретные конечные точки URL-адресов, когда для эластичного пула достигается пороговое значение использования.

**Добавление оповещения в ресурс.**

1. Щелкните диаграмму **Использование ресурсов**, чтобы открыть страницу **Метрика**, нажмите кнопку **Добавить оповещение**, а затем введите сведения на странице **Добавление правила оповещения** (в качестве **ресурса** автоматически устанавливается используемый пул).
2. Введите **имя** и **описание** оповещения для вас и получателей.
3. Из списка выберите **метрику** для оповещения.

   На диаграмме динамически отображается использование ресурсов для этой метрики, на основе которых вы можете выбрать пороговое значение.

4. Выберите **Условие** (больше, меньше и т. д.) и **Пороговое значение**.
5. Выберите **период** времени, в течение которого метрика правила должна выполнять условие, прежде чем будет активировано оповещение.
6. Нажмите кнопку **ОК**.

Дополнительные сведения см. в статье [Создание оповещений для базы данных SQL Azure с помощью портала Azure](sql-database-insights-alerts-portal.md).

### <a name="move-a-database-into-an-elastic-pool"></a>Перемещение базы данных в пул эластичных БД

Вы можете добавить или удалить базы данных из существующего пула. Базы данных могут находиться в других пулах. Однако добавлять можно только базы данных, которые находятся на одном логическом сервере.

 ![Щелкните "Настроить пул".](./media/sql-database-elastic-pool-manage-portal/configure-pool.png)

![Щелкните "Добавить в пул".](./media/sql-database-elastic-pool-manage-portal/add-to-pool.png)

![Выберите добавляемые базы данных.](./media/sql-database-elastic-pool-manage-portal/add-databases-pool.png)

![Добавление в пул в состоянии ожидания.](./media/sql-database-elastic-pool-manage-portal/pending-additions.png)

![Щелкните Сохранить](./media/sql-database-elastic-pool-manage-portal/click-save.png)

### <a name="move-a-database-out-of-an-elastic-pool"></a>Перемещение базы данных из пула эластичных БД

![список баз данных](./media/sql-database-elastic-pool-manage-portal/select-pools-removal.png)

### <a name="change-performance-settings-of-an-elastic-pool"></a>Изменение параметров производительности эластичного пула

Наблюдая за использованием ресурсов эластичного пула, вы можете обнаружить, что требуются дополнительные корректировки. Возможно, для пула потребуется изменить ограничения на производительность или хранение. Может возникнуть необходимость изменить параметры баз данных в пуле. Чтобы добиться оптимального баланса производительности и стоимости, настройку пула можно изменить в любое время. Дополнительные сведения см. в статье [Когда следует использовать пул эластичных баз данных?](sql-database-elastic-pool.md)

Изменение числа eDTU или ограничений хранения на пул, а также числа eDTU на базу данных

![Использование ресурсов пула эластичных БД](./media/sql-database-elastic-pool-manage-portal/resize-pool.png)

## <a name="manage-elastic-pools-and-databases-using-powershell"></a>Управление эластичными пулами и базами данных с помощью PowerShell

Для создания эластичных пулов базы данных SQL и управления ими с помощью Azure PowerShell используйте приведенные ниже командлеты PowerShell. Если вам нужно выполнить установку или обновление PowerShell, прочитайте статью [об установке модуля Azure PowerShell](/powershell/azure/install-azurerm-ps). Дополнительные сведения о создании и администрировании баз данных, серверов и правил брандмауэра см. в разделе [Управление серверами SQL Azure, базами данных и брандмауэрами с помощью PowerShell](sql-database-servers-databases.md#manage-azure-sql-servers-databases-and-firewalls-using-powershell). 

> [!TIP]
> Образцы скриптов PowerShell см. в статьях [Создание эластичных пулов и перемещение баз данных между пулами и из пула с помощью PowerShell](scripts/sql-database-move-database-between-pools-powershell.md) и [Отслеживание и масштабирование эластичного пула SQL в Базе данных SQL Azure с помощью PowerShell](scripts/sql-database-monitor-and-scale-pool-powershell.md).
>

| Командлет | Описание |
| --- | --- |
|[New-AzureRmSqlElasticPool](/powershell/module/azurerm.sql/new-azurermsqlelasticpool)|Создает пул эластичных баз данных на логическом сервере SQL.|
|[Get-AzureRmSqlElasticPool](/powershell/module/azurerm.sql/get-azurermsqlelasticpool)|Получает пулы эластичных баз данных и значения их свойств на логическом сервере SQL.|
|[Set-AzureRmSqlElasticPool](/powershell/module/azurerm.sql/set-azurermsqlelasticpool)|Изменяет свойства пула эластичных баз данных на логическом сервере SQL. Например, используйте свойство **StorageMB** для изменения максимального размера хранилища эластичного пула.|
|[Remove-AzureRmSqlElasticPool](/powershell/module/azurerm.sql/remove-azurermsqlelasticpool)|Удаляет пул эластичных баз данных на логическом сервере SQL.|
|[Get-AzureRmSqlElasticPoolActivity](/powershell/module/azurerm.sql/get-azurermsqlelasticpoolactivity)|Получает состояние операций в эластичном пуле на логическом сервере SQL.|
|[New-AzureRmSqlDatabase](/powershell/module/azurerm.sql/new-azurermsqldatabase)|Создает новую базу данных в существующем пуле или отдельную базу данных. |
|[Get-AzureRmSqlDatabase](/powershell/module/azurerm.sql/get-azurermsqldatabase)|Получает одну или несколько баз данных.|
|[Set-AzureRmSqlDatabase](/powershell/module/azurerm.sql/set-azurermsqldatabase)|Определяет свойства базы данных или перемещает ее в эластичный пул, из пула либо между пулами.|
|[Remove-AzureRmSqlDatabase](/powershell/module/azurerm.sql/remove-azurermsqldatabase)|Удаляет базу данных.|


> [!TIP]
> Создание большого количества баз данных в эластичном пуле может занять некоторое время, если эта операция выполняется с помощью портала или командлетов PowerShell, которые создают базы данных поочередно. Сведения об автоматическом создании баз данных в эластичном пуле см. в документе [CreateOrUpdateElasticPoolAndPopulate](https://gist.github.com/billgib/d80c7687b17355d3c2ec8042323819ae).
>

## <a name="manage-elastic-pools-and-databases-using-the-azure-cli"></a>Управление эластичными пулами и базами данных с помощью Azure CLI

Для создания эластичных пулов базы данных SQL с помощью [Azure CLI](/cli/azure/overview) используйте приведенные ниже команды [Azure CLI для базы данных SQL](/cli/azure/sql/db). Запускайте интерфейс командной строки в браузере с помощью [Cloud Shell](/azure/cloud-shell/overview) либо [установите](/cli/azure/install-azure-cli) его на платформе macOS, Linux или Windows. 

> [!TIP]
> Примеры скриптов для Azure CLI см. в статьях [Перемещение базы данных Azure SQL в эластичном пуле SQL с помощью интерфейса командной строки](scripts/sql-database-move-database-between-pools-cli.md) и [Масштабирование эластичного пула SQL в Базе данных SQL Azure с помощью Azure CLI](scripts/sql-database-scale-pool-cli.md).
>

| Командлет | Описание |
| --- | --- |
|[az sql elastic-pool create](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_create)|Создает эластичный пул.|
|[az sql elastic-pool list](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_list)|Возвращает список эластичных пулов на сервере.|
|[az sql elastic-pool list-dbs](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_list_dbs)|Возвращает список баз данных в пуле эластичных баз данных.|
|[az sql elastic-pool list-editions](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_list_editions)|Также содержит параметры доступных DTU пула, ограничений хранилища и параметры отдельных баз данных. Чтобы снизить уровень детализации, ограничения дополнительного хранилища и параметры каждой базы данных скрыты по умолчанию.|
|[az sql elastic-pool update](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_update)|Обновляет эластичный пул.|
|[az sql elastic-pool delete](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_delete)|Удаляет эластичный пул.|

## <a name="manage-databases-within-elastic-pools-using-transact-sql"></a>Управление базами данных в эластичных пулах с помощью Transact-SQL

Для создания и перемещения баз данных в существующих эластичных пулах или для возвращения сведений о пуле эластичных баз данных SQL с помощью Transact-SQL используйте следующие команды T-SQL. Можно выполнить эти команды на портале Azure, в [SQL Server Management Studio](/sql/ssms/use-sql-server-management-studio), [Visual Studio Code](https://code.visualstudio.com/docs) или любой другой программе, которая может подключаться к серверу базы данных SQL Azure и передавать команды Transact-SQL. Дополнительные сведения о создании и администрировании баз данных, серверов и правил брандмауэра см. в разделе [Управление серверами SQL Azure, базами данных и брандмауэрами с помощью Transact-SQL](sql-database-servers-databases.md#manage-azure-sql-servers-databases-and-firewalls-using-transact-sql).

> [!IMPORTANT]
> С помощью Transact-SQL невозможно создать, обновить или удалить пул эластичных баз данных SQL Azure. Вы можете добавить или удалить базы данных из эластичного пула, а также вернуть сведения о существующих эластичных пулах, используя динамические административные представления.
>

| Команда | Описание |
| --- | --- |
|[CREATE DATABASE (база данных SQL Azure)](/sql/t-sql/statements/create-database-azure-sql-database)|Создает новую базу данных в существующем пуле или отдельную базу данных. Для создания базы данных требуется подключение к базе данных master.|
| [ALTER DATABASE (база данных SQL Azure)](/sql/t-sql/statements/alter-database-azure-sql-database) |Перемещает базы данных из, в или между эластичными пулами.|
|[DROP DATABASE (Transact-SQL)](/sql/t-sql/statements/drop-database-transact-sql)|Удаляет базу данных.|
|[sys.elastic_pool_resource_stats (база данных SQL Azure)](/sql/relational-databases/system-catalog-views/sys-elastic-pool-resource-stats-azure-sql-database)|Возвращает статистику использования ресурсов для всех пулов эластичных баз данных на логическом сервере. Для каждого пула эластичной базы данных имеется одна строка на каждые 15 секунд окна отчета (четыре строки в минуту). Сюда входят сведения об использовании ЦП, хранилища, операциях ввода-вывода, журнал, а также использование параллельных запросов и сеансов всеми базами данных в пуле.|
|[sys.database_service_objectives (база данных SQL Azure)](/sql/relational-databases/system-catalog-views/sys-database-service-objectives-azure-sql-database)|Возвращает сведения о выпуске (уровень служб), целевой службе (ценовую категорию), а также имя эластичного пула (при наличии) для базы данных SQL Azure или хранилища данных SQL Azure. В системе базы данных master на сервере базы данных SQL Azure возвращает сведения обо всех базах данных. Для использования хранилища данных SQL Azure необходимо подключиться к базе данных master.|

## <a name="manage-elastic-pools-and-databases-using-the-rest-api"></a>Управление эластичными пулами и базами данных с помощью REST API

Для создания эластичных пулов базы данных SQL и управления ими используйте эти запросы REST API.

| Команда | Описание |
| --- | --- |
|[Создание или обновление эластичных пулов](/rest/api/sql/elasticpools/createorupdate)|Создает эластичный пул или обновляет имеющийся.|
|[Удаление эластичных пулов](/rest/api/sql/elasticpools/delete)|Удаляет эластичный пул.|
|[Получение эластичных пулов](/rest/api/sql/elasticpools/get)|Получает эластичный пул.|
|[Список эластичных пулов на сервере](/rest/api/sql/elasticpools/listbyserver)|Возвращает список эластичных пулов на сервере.|
|[Обновление эластичных пулов](/rest/api/sql/elasticpools/update)|Обновляет имеющийся эластичный пул.|
|[Получение рекомендуемых эластичных пулов](/rest/api/sql/recommendedelasticpools/get)|Получает рекомендуемый эластичный пул.|
|[Список рекомендуемых эластичных пулов на сервере](/rest/api/sql/recommendedelasticpools/listbyserver)|Возвращает рекомендуемые эластичные пулы.|
|[Список метрик рекомендуемых эластичных пулов](/rest/api/sql/recommendedelasticpools/listmetrics)|Возвращает метрики рекомендуемых эластичных пулов.|
|[Действия эластичного пула](/rest/api/sql/elasticpoolactivities)|Возвращает действия эластичного пула.|
|[Действия базы данных в эластичном пуле](/rest/api/sql/elasticpooldatabaseactivities)|Возвращает действия баз данных в эластичном пуле.|
|[Создание или обновление баз данных](/rest/api/sql/databases/createorupdate)|Создает новую базу данных или обновляет имеющуюся.|
|[Базы данных: получение](/rest/api/sql/databases/get)|Получает базу данных.|
|[Базы данных: получение по эластичному пулу](/rest/api/sql/databases/getbyelasticpool)|Получает базу данных в эластичном пуле.|
|[Базы данных: получение по рекомендуемому эластичному пулу](/rest/api/sql/databases/getbyrecommendedelasticpool)|Получает базу данных в рекомендуемом эластичном пуле.|
|[Базы данных: вывод списка по эластичному пулу](/rest/api/sql/databases/listbyelasticpool)|Возвращает список баз данных в пуле эластичных баз данных.|
|[Базы данных: вывод списка по рекомендуемому эластичному пулу](/rest/api/sql/databases/listbyrecommendedelasticpool)|Возвращает список баз данных в рекомендуемом эластичном пуле.|
|[Базы данных: вывод списка по серверу](/rest/api/sql/databases/listbyserver)|Возвращает список баз данных на сервере.|
|[Базы данных: обновление](/rest/api/sql/databases/update)|Обновляет имеющуюся базу данных.|

## <a name="next-steps"></a>Дальнейшие действия

* Мы рекомендуем просмотреть [видеокурс о возможностях эластичной базы данных SQL Azure на сайте Microsoft Virtual Academy](https://mva.microsoft.com/training-courses/elastic-database-capabilities-with-azure-sql-db-16554).
* Дополнительные сведения о шаблонах разработки для приложений SaaS, использующих пулы эластичных БД, см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием базы данных Azure SQL](sql-database-design-patterns-multi-tenancy-saas-applications.md).
* Дополнительные сведения об эластичных пулах см. в статье [Общие сведения о приложении SaaS Wingtip](sql-database-wtp-overview.md).
