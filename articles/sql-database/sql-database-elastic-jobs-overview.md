---
title: "базы данных горизонтально масштабируемого облака aaaManaging | Документы Microsoft"
description: "Иллюстрирует hello службы заданий эластичных баз данных"
metakeywords: azure sql database elastic databases
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 6fa47cf2-1162-4534-a206-6e2d95b78580
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: b6d330cd712421b8cba781e835830772e6e5b77e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="managing-scaled-out-cloud-databases"></a>Управление масштабируемыми облачными базами данных
Здравствуйте, toomanage масштабируемых сегментированных баз данных **заданий эластичных баз данных** (Предварительная версия) обеспечивает вы tooreliably выполнения скрипта Transact-SQL (T-SQL) между несколькими базами данных, включая:

* пользовательское семейство баз данных (см. ниже);
* все базы данных в [эластичном пуле](sql-database-elastic-pool.md);
* набор сегментов (созданный с помощью [клиентской библиотеки эластичной базы данных](sql-database-elastic-database-client-library.md)). 

## <a name="documentation"></a>Документация
* [Установить компоненты задания hello эластичной базы данных](sql-database-elastic-jobs-service-installation.md). 
* [Приступая к работе с инструментами эластичных баз данных](sql-database-elastic-jobs-getting-started.md).
* [Создание и управление заданиями с помощью PowerShell](sql-database-elastic-jobs-powershell.md).
* [Создание развернутых баз данных SQL Azure и управление ими](sql-database-elastic-jobs-getting-started.md)

**Заданий эластичных баз данных** клиента Azure облачной службы, размещенной в, обеспечивающую выполнение кода hello ad-hoc и запланированные административные задачи, которые называются является в настоящее время **задания**. С заданиями можно легко и надежно управлять больших групп баз данных SQL Azure, запуская скрипты Transact-SQL: tooperform административные операции. 

![Служба заданий обработки эластичных баз данных][1]

## <a name="why-use-jobs"></a>Зачем использовать задания?
**Управление**

Удобство управления изменениями схемы, учетными данными, обновлением эталонных данных, сбором сведений о производительности и клиентских данных телеметрии.

**Отчеты**

Сбор данных из семейства баз данных SQL Azure в одну целевую таблицу.

**Уменьшение нагрузки**

Как правило необходимо подключение базы данных tooeach независимо друг от друга в инструкции Transact-SQL toorun заказа или выполнять другие задачи администрирования. Задание обрабатывает задачу hello ведения журнала в базе данных tooeach в целевой группе hello. Также определите, поддерживать и сохранения toobe скриптов Transact-SQL, выполняется между несколькими базами данных SQL Azure.

**Учет**

Задания выполняются hello скрипта и журнала hello состояние выполнения для каждой базы данных. При сбое действие автоматически выполняется повторно.

**Гибкость**

Определение пользовательских групп для баз данных SQL Azure и определение расписаний для запуска задания.

> [!NOTE]
> В hello портал Azure лишь часть функций ограниченные tooSQL Azure эластичных пулов доступна. С помощью API-интерфейсов PowerShell tooaccess hello полного набора функциональных возможностей текущей hello.
> 
> 

## <a name="applications"></a>Приложения
* Выполнение административных задач, таких как развертывание новой схемы.
* Обновление эталонных данных (например, сведений о продукте, которые являются общими для всех баз данных). Планируйте автоматические обновления на нерабочие часы в будни.
* Перестройте производительность запросов индексов tooimprove. Перестроение Hello может быть настроенный tooexecute по набору баз данных на регулярной основе, таких как часы с наименьшей загрузкой.
* Собирайте результаты запросов из набора баз данных в центральную таблицу на постоянной основе. Производительность запросов может выполняться непрерывно и настроить toobe дополнительные задачи tootrigger выполнена.
* Выполнение длительности выполнения запросов обработки данных между большим набором баз данных, например hello коллекцию телеметрии клиента. Результаты собираются в одну целевую таблицу для дальнейшего анализа.

## <a name="elastic-database-jobs-end-to-end"></a>Работа с заданиями обработки эластичных баз данных
1. Установка hello **заданий эластичных баз данных** компонентов. Дополнительные сведения см. в статье [Обзор установки заданий обработки эластичных баз данных](sql-database-elastic-jobs-service-installation.md). Если происходит сбой установки hello, см. раздел [как toouninstall](sql-database-elastic-jobs-uninstall.md).
2. Используйте API-интерфейсов PowerShell tooaccess hello дополнительные функциональные возможности, например, для создания пользовательских баз данных коллекций, добавление расписаний и/или сбора результирующих наборов. Используйте портал hello для простой установки и создания и отслеживанием заданий ограничены tooexecution от **эластичного пула**. 
3. Создайте зашифрованные учетные данные для выполнения заданий и [Добавление hello пользователь (или роль) tooeach базы данных в группе hello](sql-database-security-overview.md).
4. Создайте скрипт T-SQL, который можно запустить для каждой базы данных в группе hello идемпотентными. 
5. Выполните эти действия toocreate задания, с помощью портала Azure hello: [Создание и управление заданиями эластичной базы данных](sql-database-elastic-jobs-create-and-manage.md). 
6. Вы также можете воспользоваться сценариями PowerShell. См. статью [Создание заданий обработки эластичных баз данных для базы данных SQL и управление ими с помощью PowerShell (предварительная версия)](sql-database-elastic-jobs-powershell.md).

## <a name="idempotent-scripts"></a>Идемпотентные сценарии
Hello сценарии должны быть [идемпотентными](https://en.wikipedia.org/wiki/Idempotence). Другими словами «идемпотентными» означает, что если hello скрипта завершается успешно, и снова запустите, hello того же результата выполняется. Сценарий может завершиться ошибкой из-за проблемы с сетью tootransient. В этом случае задания hello автоматически повторит попытку выполняемого сценария hello предустановленную несколько раз перед desisting. Сценарий идемпотентными имеет hello же результат, даже если была успешно выполнена дважды. 

Простой способ — tootest для hello существование объекта перед его созданием.  

    IF NOT EXIST (some_object)
    -- Create hello object 
    -- If it exists, drop hello object before recreating it.

Аналогичным образом скрипт должен быть tooexecute может успешно логически тестирование для и вопреки любые условия находит.

## <a name="failures-and-logs"></a>Сбои и журналы
При сбое скрипта после нескольких попыток задания hello запись об ошибке hello и продолжается. После завершения задания (то есть выполняются для всех баз данных в группе hello), можно проверить свой список неудачных попыток входа. журналы Hello подробно toodebug неисправный скриптов. 

## <a name="group-types-and-creation"></a>Типы групп и их создание
Группы бывают двух типов: 

1. наборы сегментов;
2. настраиваемые группы.

Группы в наборе сегментов создаются с помощью hello [эластичной базы данных средства](sql-database-elastic-scale-introduction.md). При создании группы набор сегментов баз данных добавляются или удаляются из группы hello автоматически. Например новый сегмент будет автоматически в группе hello при ее добавлении toohello карты сегментов. Для группы hello можно затем запустить задание.

Настраиваемые группы на Здравствуйте другой стороны, строго определены. В таких группах базы данных нужно добавлять и удалять явно. При удалении базы данных в группе hello hello задания будет предпринята скрипт hello toorun hello базе данных, что привело к возможному сбою. Группы, созданные с помощью hello портал Azure в настоящее время — настраиваемые группы. 

## <a name="components-and-pricing"></a>Компоненты и цены
Hello следующие компоненты совместно toocreate Azure облачную службу, обеспечивающую выполнение специальных административных заданий. компоненты Hello установлена и настроена автоматически во время установки в вашей подписке. Hello служб можно определить, как все они имеют hello же автоматически формируемым именем. Hello имя является уникальным и состоит из префикса hello «edj» следуют 21 случайных символов.

* **Облачная служба Azure**: заданий эластичных баз данных (Предварительная версия) поставляется как клиент размещенного облака Azure задачи запрошено выполнение службы tooperform hello. Из портала hello hello служба развертывается и размещенные в вашей подписке Microsoft Azure. службы развертывания по умолчанию Hello выполняется с hello минимум два рабочих ролей для обеспечения высокой доступности. размер по умолчанию Hello каждой рабочей роли (ElasticDatabaseJobWorker) работает на экземпляре A0. Сведения о ценах на облачные службы см. [здесь](https://azure.microsoft.com/pricing/details/cloud-services/). 
* **База данных SQL Azure**: hello служба использует базы данных SQL Azure называется hello **базы данных системы управления** toostore все метаданные задания hello. уровень обслуживания по умолчанию Hello является S0. Сведения о ценах на базы данных SQL см. [здесь](https://azure.microsoft.com/pricing/details/sql-database/).
* **Azure Service Bus**: Azure Service Bus предназначен для координации работы hello в hello Azure облачной службы. Сведения о ценах на служебную шину см. [здесь](https://azure.microsoft.com/pricing/details/service-bus/).
* **Хранилище Azure**: учетная запись хранилища Azure используется toostore диагностических выходных данных ведения журнала в событии hello, проблема не может быть делегировать отладку (см. [включение диагностики в облачных службах Azure и виртуальных машин](../cloud-services/cloud-services-dotnet-diagnostics.md)). Сведения о ценах на хранилище Azure см. [здесь](https://azure.microsoft.com/pricing/details/storage/).

## <a name="how-elastic-database-jobs-work"></a>Как работают задания обработки эластичных баз данных
1. Базе данных SQL Azure назначается **управляющая база данных** , в которой хранятся все метаданные и сведения о состоянии.
2. доступ к базе данных управления Hello hello **служба заданий** toolaunch и отслеживания tooexecute заданий.
3. Двух разных ролей соединяются с базой данных управления hello. 
   * Контроллер: Определяет, какие задания требуют задачи tooperform hello запрошенную путем создания новых рабочих заданий и задания неудачных попыток.
   * Задания выполнения задачи: Выполняет hello рабочих заданий.

### <a name="job-task-types"></a>Типы задач
Существует несколько типов задач, которые выполняют задания:

* ShardMapRefresh: Запросы hello toodetermine карты сегментов, все базы данных hello использовать в качестве сегментов
* ScriptSplit: Разбивает один скрипт hello «Перейти» инструкций на пакеты
* ExpandJob: создает дочерние задачи для каждой базы данных из задачи, которая направлена на группу баз данных
* ScriptExecution: выполняет сценарий для определенной базы данных с использованием заданных учетных данных
* DACPAC: Применяет DACPAC tooa определенной базы данных с использованием определенного учетных данных

## <a name="end-to-end-job-execution-work-flow"></a>Полный рабочий процесс выполнения заданий
1. С помощью портала hello или hello PowerShell API, задание будет вставлен hello **базы данных системы управления**. Задание Hello запрашивает выполнение скрипта Transact-SQL для группы баз данных с помощью определенных учетных данных.
2. Hello контроллера определяет новое задание hello. Задачи задания создаются и выполнить скрипт toosplit hello и toorefresh hello группы баз данных. И, наконец новое задание создается и выполняется задание tooexpand hello и создать новый дочерний объект задания, где указанный tooexecute hello сценарий Transact-SQL для отдельной базы данных в группе hello каждого дочернего задания.
3. Hello контроллера определяет hello созданы дочерние задания. Для каждого задания контроллера hello создает и запускает задачи задания tooexecute hello сценарий в базе данных. 
4. После завершения всех задач задания, контроллер hello обновляет состояние tooa завершения задания hello. 
   В любой момент во время выполнения задания hello PowerShell API может быть используется tooview hello текущее состояние выполнения задания. Все значения времени, возвращенных hello API-интерфейсов PowerShell представлены в формате UTC. При желании запрос отмены может быть инициализирован toostop задания. 

## <a name="next-steps"></a>Дальнейшие действия
[Установить компоненты hello](sql-database-elastic-jobs-service-installation.md), затем [создайте и добавьте журнал базы данных в группе hello баз данных tooeach](sql-database-manage-logins.md). toofurther понимать при создании заданий и управления см. в разделе [Создание и управление заданиями эластичной базы данных](sql-database-elastic-jobs-create-and-manage.md). См. также статью [Начало работы с заданиями обработки эластичных баз данных](sql-database-elastic-jobs-getting-started.md).

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Image references-->
[1]: ./media/sql-database-elastic-jobs-overview/elastic-jobs.png
<!--anchors-->


