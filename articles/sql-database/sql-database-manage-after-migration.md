---
title: "Управление базой данных после ее переноса в базу данных SQL Azure | Документация Майкрософт"
description: "Сведения о том, как управлять базой данных после ее переноса в базу данных SQL Azure."
services: sql-database
documentationcenter: 
author: joesackmsft
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: migrate
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Inactive
ms.date: 12/06/2016
ms.author: Joe.Sack
ms.suite: sql
ms.prod_service: sql-database
ms.component: migration
ms.openlocfilehash: b65236fb2d11473d626ee2602237ed4a49380702
ms.sourcegitcommit: b07d06ea51a20e32fdc61980667e801cb5db7333
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2017
---
# <a name="new-dba-in-the-cloud--managing-your-database-in-azure-sql-database"></a>Новый администратор базы данных в облаке — управление базой данных в базе данных SQL Azure

Переход от традиционных самостоятельно управлять, самостоятельно контролируемой среде, в среде PaaS может показаться немного невозможной сначала. Как разработчик приложения или администратору базы данных нужно знать основные возможности платформы, которая помогает поддерживать приложении, производительными, безопасности и надежность - всегда. Эта статья призвана именно это сделать. Статья четко организует ресурсы и предоставляет некоторые рекомендации о том, как лучше всего использовать основные возможности базы данных SQL для управления и прерывать выполнение приложения эффективно и достижения оптимальных результатов в облаке. Типичная аудитория для этой статьи будет тех, кто:-
- Оценке переноса их приложений к базе данных SQL Azure — модернизация приложений.
- Находятся в процессе переноса их приложений — сценарий миграции на постоянной основе.
- Недавно выполнен перенос в базу данных SQL Azure, новый администратор базы данных в облаке.

В этой статье рассматриваются некоторые из основных характеристик базу данных SQL Azure как платформы, которое можно легко использовать. Они перечислены ниже:- 
- Business непрерывности и аварийного восстановления (BCDR)
- Безопасность и соответствие требованиям
- Интеллектуальная базы данных мониторинга и обслуживания
- Перемещение данных


## <a name="business-continuity-and-disaster-recovery-bcdr"></a>Business непрерывности и аварийного восстановления (BCDR)
Возможности бизнеса, обеспечения непрерывности и аварийного восстановления позволяют продолжить вашей организации, как обычно, в случае аварии. Сбоя может быть событий уровня базы данных (например, кто-то по ошибке удаляет таблицу решающее значение) или центр обработки данных событий уровня (региональные происшествий, например tsunami). 

### <a name="how-do-i-create-and-manage-backups-on-sql-database"></a>Как создавать резервные копии в базе данных SQL и управлять ими?
Не создавайте резервные копии в базе данных SQL Azure и, так как не нужно. База данных SQL автоматически создает резервную копию базы данных, поэтому можно больше не нужно волноваться по поводу планирование, создание и управление резервными копиями. Платформа принимает полное резервное копирование каждую неделю, разностное резервное копирование каждые несколько минут и журнал резервное копирование каждые 5 минут, чтобы убедиться, что эффективна, аварийное восстановление и минимальной потерей данных. Первой полной резервной копии происходит сразу после создания базы данных. Эти резервные копии доступны в течение определенного периода называется «Срок хранения» и зависит от уровня производительности, выбрать.  База данных SQL обеспечивает возможность восстановить до любого момента времени в пределах этой хранения периода с помощью [точки в время восстановления (возможности PITR)](sql-database-recovery-using-backups.md#point-in-time-restore).

|Уровень производительности|Период хранения в днях|
|---|:---:|
|базовая;|7|
|Стандартная|35|
|Премиум|35|
|||

Кроме того [долгосрочного хранения (LTR)](sql-database-long-term-retention.md) позволяет удерживать файлы резервной копии в течение гораздо больше времени, в частности, до 10 лет и восстановить данные из этих резервных копий в любой момент в течение указанного периода. Кроме того резервные копии баз данных, хранятся в геореплицированном хранилище, чтобы обеспечить устойчивость от региональных поломки. Можно также восстановить эти резервные копии в любом регионе Azure, в любой момент времени в пределах срока хранения. Дополнительные сведения см. в статье [Обзор обеспечения непрерывности бизнес-процессов с помощью базы данных SQL Azure](sql-database-business-continuity.md).

### <a name="how-do-i-ensure-business-continuity-in-the-event-of-a-datacenter-level-disaster-or-regional-catastrophe"></a>Как обеспечить непрерывность бизнеса в случае аварии на уровне центра обработки данных или региональных поломки?
Поскольку резервные копии базы данных хранятся в подсистеме геореплицированном хранилище, чтобы убедиться, что в случае региональной аварии, можно восстановить резервную копию в другой регион Azure. Это называется геовосстановления. Целевая точка восстановления (цель точки восстановления) для этого обычно используется < 1 час и ERT (предполагаемое время восстановления — несколько минут до часов).

Для ответственных баз данных база данных SQL Azure предлагает активной георепликации. Что это фактически делает создается георепликацией вторичную копию исходной базы данных в другую область. Например если базы данных первоначально размещены в Azure Запад США и требуется устойчивости региональной аварии. Вы создадите active geo реплику базы данных на Западе США, можно сказать, восток США. При довода сохранилась на Запад США, то можно переключить регионе Восток США. Их настройка в группе автоматического перехода на другой ресурс — еще лучше, так как это гарантирует, что база данных автоматически переходит на сервер-получатель в регионе Восток США в случае аварии. Целевая точка восстановления для этого является < 5 секунд и ERT < 30 секунд.

Если группа автоматической отработки отказа не настроена, ваше приложение должно активно отслеживать возникновение сбоя и инициировать переход на другой ресурс. Можно создать до 4 таких active географических реплик в разных регионах Azure. Все еще лучше. Также можно получить доступ к этих active geo репликах для доступа только для чтения. Это сообщение появляется очень удобен для сокращения задержки для сценария географически распределенных приложений. 

### <a name="how-does-my-disaster-recovery-plan-change-from-on-premises-to-sql-database"></a>Как план аварийного восстановления изменяет из локальной базы данных SQL?
Таким образом программа установки SQL Server в локальном требовалось активно управлять доступности с помощью функций, таких как отказоустойчивая кластеризация, зеркальное отображение базы данных, репликация транзакций, и т.д., доставка журналов и поддерживать и управлять резервные копии, чтобы обеспечить Непрерывность бизнес-процессов. С базой данных SQL платформы управляет их, чтобы вы могли сосредоточиться на разработке и оптимизации приложений баз данных и не беспокоиться об управлении аварийного максимально возможную. Может иметь резервного копирования и настроить планы аварийного восстановления и работе с помощью нескольких щелчков на портале Azure (или несколько команд, с помощью API-интерфейсов PowerShell). 

Дополнительные сведения об аварийном восстановлении см. в разделе: [Azure SQL Db аварийного восстановления 101](https://azure.microsoft.com/blog/azure-sql-databases-disaster-recovery-101/)

## <a name="security-and-compliance"></a>Безопасность и соответствие требованиям
База данных SQL безопасность и конфиденциальность очень серьезно. Безопасности в базе данных SQL доступны на уровне базы данных и на уровне платформы и воспринимается лучше всего при разделены на несколько уровней. На каждом уровне вы получаете для управления и обеспечения оптимальной безопасности приложения. Слои являются:
- Службы идентификации и проверки подлинности ([проверка подлинности Windows или SQL и Azure Active Directory [AAD]](sql-database-control-access.md)).
- Наблюдение за активностью ([аудита](sql-database-auditing.md) и [обнаружение угроз](sql-database-threat-detection.md)).
- Защита фактических данных ([прозрачное шифрование данных [TDE]](/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql) и [постоянного шифрования [AE]](/sql/relational-databases/security/encryption/always-encrypted-database-engine)). 
- Управление доступом к конфиденциальным и привилегированных данных ([безопасности на уровне строки](/sql/relational-databases/security/row-level-security) и [динамической маскировки данных](/sql/relational-databases/security/dynamic-data-masking)).

[Центр безопасности Azure](https://azure.microsoft.com/services/security-center/) предоставляет возможности централизованного управления безопасностью рабочих нагрузок в Azure, в локальной среде и в других облаках. Можно просмотреть ли основные защиты базы данных SQL, таких как [аудита](sql-database-auditing.md) и [прозрачное шифрование данных [TDE]](/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql) настроены на всех ресурсах и создания политик на основе собственных требований.

### <a name="what-user-authentication-methods-are-offered-in-sql-database"></a>Поддерживаемые методы проверки подлинности пользователя предлагаются в базе данных SQL?
Существуют [два метода проверки подлинности](sql-database-control-access.md#authentication) предлагаемых в базе данных SQL: 
- [Проверка подлинности Azure Active Directory](sql-database-aad-authentication.md)
- Проверка подлинности SQL. 

Проверка подлинности windows, традиционных не поддерживается. Azure Active Directory (AD) — это централизованная служба управления удостоверениями и доступом. С этим можно очень легко предоставить единого входа для доступа (SSO) все сотрудники в вашей организации. Это значит, что учетные данные являются общими для всех служб Azure для простой проверки подлинности. Поддерживает AAD [многофакторной проверки Подлинности (многофакторную проверку подлинности)](sql-database-ssms-mfa-authentication.md) и с [нескольких щелчков](../active-directory/connect/active-directory-aadconnect-get-started-express.md) AAD можно интегрировать с Windows Server Active Directory. Проверка подлинности SQL работает такие же вы уже использовали его в прошлом. Укажите имя пользователя и пароль, и может проверять подлинность пользователей в любой базе данных на заданном сервере логических. Это также позволяет базе данных SQL и хранилищу данных SQL предлагать многофакторную проверку подлинности и гостевые учетные записи пользователей в домене Azure AD. При наличии Active Directory в локальной среде вы можете создать федерацию каталога с Azure Active Directory, чтобы расширить свой каталог до Azure.

|**Если вы...**|**База данных SQL или хранилище данных SQL**|
|---|---|
|Предпочитаете не использовать Azure Active Directory (AD) в Azure|Используйте [проверку подлинности SQL](sql-database-security-overview.md).|
|Использовали AD на локальном сервере SQL Server|[Создайте федерацию AD с Azure AD](../active-directory/connect/active-directory-aadconnect.md) и используйте проверку подлинности Azure AD. В таком случае можно использовать единый вход.|
|Требуется принудительная многофакторная проверка подлинности|Требуйте выполнения многофакторной проверки подлинности в качестве политики с помощью [условного доступа Майкрософт](sql-database-conditional-access.md) и используйте [универсальную проверку подлинности Azure AD с поддержкой многофакторной проверки подлинности](sql-database-ssms-mfa-authentication.md).|
|Имеете гостевые учетные данные из учетных записей Майкрософт (live.com, outlook.com) или других доменов (gmail.com)|Используйте [универсальную проверку подлинности Azure AD](sql-database-ssms-mfa-authentication.md) в хранилище базы данных и в базе данных SQL, которая использует [службу совместной работы Azure AD B2B](../active-directory/active-directory-b2b-what-is-azure-ad-b2b.md).|
|Входите в систему Windows с помощью учетных данных Azure Active Directory из федеративного домена|Используйте [встроенную проверку подлинности Azure AD](sql-database-aad-authentication-configure.md).|
|Входите в систему Windows с помощью учетных данных из домена, который не включен в федерацию с Azure|Используйте [встроенную проверку подлинности Azure AD](sql-database-aad-authentication-configure.md).|
|Службы среднего уровня, которым необходимо подключиться к базе данных SQL или хранилище данных SQL|Используйте [встроенную проверку подлинности Azure AD](sql-database-aad-authentication-configure.md).|
|||

### <a name="how-do-i-limit-or-control-connectivity-access-to-my-database"></a>Как ограничить или контролировать доступ на подключение к базе данных?
Существует несколько методов в вашем распоряжении, который можно использовать для достижения оптимальной подключения организации для вашего приложения. 
- Правила брандмауэра
- Конечные точки службы виртуальной сети
- Зарезервированные IP-адреса

#### <a name="firewall"></a>Брандмауэр
Брандмауэр блокирует доступ к серверу внешней сущности, разрешив только определенным сущностям доступ для логического сервера. По умолчанию все подключения и базы данных в логическом сервере запрещены, за исключением соединений, поступающие от других служб Azure. С правилом брандмауэра можно открыть доступ к серверу только к сущностям (например, разработчик компьютера), для подтверждения, позволяя IP-адрес этого компьютера через брандмауэр. Он также позволяет указать диапазон IP-адресов, необходимо разрешить доступ к логического сервера. Например разработчик IP-адресов компьютеров в вашей организации можно добавить сразу путем указания диапазона на странице параметров брандмауэра. 

Можно создавать правила брандмауэра на уровне сервера или на уровне базы данных. Правила брандмауэра уровня сервера можно либо создать на портале или с помощью среды SSMS. Для получения дополнительных сведений о настройке сервера и правила брандмауэра на уровне базы данных, см.: [создавать правила брандмауэра в базе данных SQL](sql-database-security-tutorial.md#create-a-server-level-firewall-rule-in-the-azure-portal).

#### <a name="service-endpoints"></a>Конечные точки службы
По умолчанию используется база данных SQL «разрешить всем службам Azure» — то есть любой виртуальной машине в Azure может попытаться подключиться к базе данных. Эти попытки все равно необходимо выполнить проверку подлинности. Однако если вы не хотите базы данных должны быть доступны все IP-адреса Azure, можно отключить, «Разрешить всем службам Azure». Кроме того, можно настроить [конечных точек службы виртуальной сети](sql-database-vnet-service-endpoint-rule-overview.md).

Конечные точки службы (SE) позволяют предоставлять важные ресурсы Azure только для собственной частной виртуальной сети в Azure. Таким образом, по существу исключить общий доступ к ресурсам. Трафик между виртуальной сети в Azure остается Azure магистральной сети. Без SE получить Принудительное туннелирование маршрутизации пакетов. Виртуальная сеть принудительно Интернет-трафик в вашей организации и трафика службы Azure для перехода через тот же маршрут. Конечными точками вы можете оптимизировать это с момента потока пакетов прямо из виртуальной сети к службе Azure магистральной сети.

![Конечные точки службы виртуальной сети](./media/sql-database-manage-after-migration/vnet-service-endpoints.png) 

#### <a name="reserved-ips"></a>Зарезервированные IP-адреса
Другой вариант — подготовки [зарезервированные IP-адреса](../virtual-network/virtual-networks-reserved-public-ip.md) для виртуальных машин и белого списка для тех конкретных ВМ IP-адреса в сервере параметры брандмауэра. Назначая зарезервированные IP-адреса, вы избавляетесь от необходимости обновления правил брандмауэра при изменении IP-адресов.

### <a name="what-port-do-i-connect-to-sql-database-on"></a>Определение порта подключиться к базе данных SQL на?

Порт 1433. База данных SQL обменивается данными через этот порт. Для подключения из корпоративной сети, необходимо добавить правило для исходящего трафика в параметрах брандмауэра организации. Как правило Избегайте предоставления доступа к порту 1433 вне среды Azure. Можно запустить в Azure с помощью SSMS [Azure RemoteApp](https://www.microsoft.com/cloud-platform/azure-remoteapp-client-apps). Это не требуется для открытия исходящих подключений к порту 1433, IP-адрес является статическим, поэтому базы данных может быть открыт только к RemoteApp и он поддерживает Multi Factor Authentication (MFA).

### <a name="how-can-i-monitor-and-regulate-activity-on-my-server-and-database-in-sql-database"></a>Как отслеживать и контролировать действия на my server и базы данных в базе данных SQL
#### <a name="sql-database-auditing"></a>Аудит базы данных SQL
С базой данных SQL можно включить аудит ON для отслеживания событий базы данных. [Аудит базы данных SQL](sql-database-auditing.md) записи о событиях базы данных и записывает их в файл журнала аудита вашей учетной записи хранилища Azure. Аудит — особенно полезен, если для лучшего понимания возможных нарушений безопасности и политики, поддерживать соответствие нормативным требованиям и т. д. Он позволяет определить и настроить определенные категории событий, которые можно объяснить требуются аудита и на основе, что может получить готовые отчеты и панели мониторинга для просмотра событий, происходящих в базе данных. Можно применить эти политики аудита на уровне базы данных или на уровне сервера. Руководство о том, как включить аудит сервера или базы данных, см.: [включить аудит базы данных SQL](sql-database-security-tutorial.md#enable-sql-database-auditing-if-necessary).

#### <a name="threat-detection"></a>Обнаружение угроз
С [обнаружение угроз](sql-database-threat-detection.md), вы получаете возможность обработки нарушений безопасности или политики, обнаруженные аудит очень легко. Не нужно быть специалист устранения потенциальных угроз и нарушений в системе безопасности. Обнаружение угроз также содержит некоторые встроенные функции, такие как обнаружение путем внедрения кода SQL. Внедрение кода SQL — попытка изменения или поставить под угрозу данные и довольно распространенным способом для взлома приложения базы данных в целом. Функция обнаружения угроз в базе данных SQL выполняет множество наборов алгоритмов, которые обнаруживают потенциальные уязвимости и атаки путем внедрения кода SQL, а также аномальные шаблоны доступа к базе данных (например, доступ из необычного расположения или незнакомым субъектом). Сотрудники службы безопасности или другие назначенные администраторы получают уведомление по электронной почте, если в базе данных обнаружена угроза. Каждое уведомление содержит сведения о подозрительном действии и рекомендации по дальнейшему исследованию и снижению угрозы. Дополнительные сведения о включении обнаружения угроз см. в разделе: [включения обнаружения угроз базы данных SQL](sql-database-security-tutorial.md#enable-sql-database-threat-detection). 
### <a name="how-do-i-protect-my-data-in-general-on-sql-database"></a>Как защитить данные в целом в базе данных SQL?
Шифрование обеспечивает надежный механизм защиты и защиты конфиденциальных данных от несанкционированного доступа. Зашифрованные данные будут не используется для злоумышленника без ключа расшифровки. Таким образом он добавляет дополнительный уровень защиты на основе существующих уровни безопасности, встроенные в базе данных SQL. Существует два аспекта для защиты данных в базе данных SQL. 
- Данные, статических файлов данных и журнала 
- Обрабатываемых данных. 

В базе данных SQL, по умолчанию хранятся в файлах данных и журналов в подсистеме хранения полностью и не всегда зашифрованные данные через [прозрачное шифрование данных [TDE]](/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql). Резервные копии, также шифруются. С помощью прозрачного шифрования данных не меняются необходимые со стороны вашего приложения, получает доступ к этим данным. Шифрование и расшифровка происходит прозрачно; Поэтому имя. Для защиты конфиденциальных данных лету и при хранении база данных SQL обеспечивает функцию, называемую [Always Encrypted (AE)](/sql/relational-databases/security/encryption/always-encrypted-database-engine). AE представляет собой форму клиентские шифрования, который шифрует конфиденциальные столбцы в базе данных (то есть они находятся в зашифрованных данных несанкционированного пользователям и администраторам баз данных). Сервер начинается с получает зашифрованные данные. Ключ для постоянного шифрования, также сохраняются на стороне клиента, поэтому конфиденциальных столбцов можно было расшифровать только авторизованным клиентам. Сервера и Администраторы данных не может видеть конфиденциальные данные, поскольку ключи шифрования хранятся на клиентском компьютере. AE шифрует конфиденциальные столбцы в таблице сквозного, от несанкционированного использования клиентами на физический диск. AE в настоящее время поддерживает сравнения на равенство, так что администраторы баз данных могут продолжать запросы к зашифрованным столбцам в рамках SQL-команд. Она может использоваться с различными вариантами хранения ключей, например с [Azure Key Vault](sql-database-always-encrypted-azure-key-vault.md), хранилищем сертификатов Windows и локальными аппаратными модулями безопасности.

|**Характеристики**|**Always Encrypted**|**Transparent Data Encryption (Прозрачное шифрование данных)**|
|---|---|---|
|**Диапазон шифрования**|Законченное решение|Статических данных|
|**Сервер базы данных может обращаться к конфиденциальным данным**|Нет |Да, так как шифрование для статических данных|
|**Разрешенные операции T-SQL**|Сравнение на равенство|Доступен всем контактной зоны T-SQL|
|**Приложение изменения, необходимые для использования функции**|Минимальная|Минимальный|
|**Гранулярность шифрования**|На уровне столбца|Уровень базы данных|
||||

### <a name="how-can-i-limit-access-to-sensitive-data-in-my-database"></a>Как ограничить доступ к конфиденциальным данным в базе данных?
Каждое приложение имеет немного конфиденциальные данные в базе данных, необходимо защитить невидимым для всех пользователей. Некоторые персонала в организации необходимо для просмотра этих данных, однако другие не должен иметь возможность просматривать эти данные. Например, зарплат сотрудников. Руководитель потребуется доступ к сведениям ставка своих непосредственных подчиненных тем не менее, отдельных участников группы не должны иметь доступ к информации заработной плате своих коллег. Другим случаем является данных разработчики, которые могут взаимодействовать с конфиденциальными данными этапах разработки или тестирования, например, SSN клиентов. Еще раз не нужно предоставлять доступ к разработчику. В таких случаях конфиденциальные данные либо должен быть скрыт или быть недоступным во всех. База данных SQL предлагает два такого подхода, чтобы запретить неавторизованным пользователям возможность просматривать конфиденциальные данные.

[Динамическое маскирование данных](sql-database-dynamic-data-masking-get-started.md) является функция маски данных, которая позволяет ограничить раскрытия конфиденциальных данных, маскируя их для непривилегированных пользователей на уровне приложения. Определить правило маскирования, который можно создать шаблон маски (например, чтобы показать только последние четыре цифры national SSN идентификатор: XXX-XX-0000 и пометьте его как Xs большинство) и определите, какие пользователи должны быть исключены из правило маскирования. Маски происходит на лету, и для разных категорий данных доступны различные функции маскировки. Динамическое маскирование данных позволяет автоматически обнаруживать конфиденциальные данные в базе данных и к нему применяются маски.

[Безопасности на уровне строк](/sql/relational-databases/security/row-level-security) дает возможность управлять доступом на уровне строк. Это означает, что некоторые строки в таблице базы данных, в зависимости от пользователя, выполняющего запрос (группа членство или контекст выполнения), скрыты. Ограничение доступа выполняется на уровне базы данных вместо уровня приложения, чтобы упростить логику приложения. Сначала нужно создать предикат фильтра, фильтрации строк, которые не предоставляется и безопасности политики Далее определение, имеющий доступ к этим строкам. И, наконец конечный пользователь выполняет их запрос и, в зависимости от прав доступа пользователя, просматривать только те строки, или не могут их видеть вообще.

### <a name="how-do-i-manage-encryption-keys-in-the-cloud"></a>Как управлять ключи шифрования в облаке?

Существуют возможности управления ключами и для Always Encrypted (шифрование на стороне клиента), и для прозрачного шифрования данных (шифрование при хранении). Рекомендуется регулярно изменение ключей шифрования. Частота смены должны быть выровнены с правилами внутреннюю структуру и нормативные требования.

**Прозрачное шифрование данных**. В TDE существует иерархия с двумя ключами. Данные в каждой пользовательской базе данных шифруются с помощью симметричного ключа шифрования AES-256 (DEK), уникального для базы данных, который, в свою очередь, зашифрован с помощью главного асимметричного ключа RSA 2048, уникального для сервера. Главный ключ может быть либо управлять:
- Автоматически платформой - базы данных SQL.
- Или вы используете [хранилище ключей Azure](sql-database-always-encrypted-azure-key-vault.md) как хранилища ключей.

По умолчанию для удобства главным ключом для прозрачного шифрования данных управляет служба базы данных SQL. Если вашей организации хотелось бы контроль над главного ключа, есть возможность использовать в качестве хранилища ключей Azure ключ Vault](sql-database-always-encrypted-azure-key-vault.md). С помощью Azure Key Vault ваша организация берет на себя управление подготовкой, сменой ключей и разрешениями. [Смена или изменение типа главного ключа прозрачного шифрования данных](/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql-key-rotation) выполняется быстро, так как повторно шифруется только ключ шифрования. Для организаций с разделение ролей между безопасностью и управления данными администратору безопасности может подготовить материал ключа для прозрачного шифрования данных главного ключа в хранилище ключей Azure и предоставляют администратору базы данных для идентификатора ключа хранилища ключей Azure шифрование, находящихся на сервере. Хранилище ключей разработан таким образом, что корпорация Майкрософт не см или извлечь ключи шифрования. Можно также получить централизованное управление ключами для вашей организации. 

**Постоянное шифрование**: также [иерархии два ключа](/sql/relational-databases/security/encryption/overview-of-key-management-for-always-encrypted) в постоянное шифрование: столбец конфиденциальных данных зашифрован ключ шифрования столбца AES 256 (CEK), которая в свою очередь, шифруется главным ключом столбца (CMK). Клиентские драйверы, предоставленные для Always Encrypted, не имеют ограничений на длину CMK. Зашифрованное значение CEK сохраняется в базе данных, а CMK хранится в хранилище доверенных ключей, таком как хранилище сертификатов Windows, Azure Key Vault или аппаратный модуль безопасности. 
- [CEK и CMK](/sql/relational-databases/security/encryption/rotate-always-encrypted-keys-using-powershell) можно менять. 
- Ключ CEK Смена — размер операции с данными и может быть много времени в зависимости от размера таблиц, содержащего зашифрованные столбцы. Поэтому рекомендуется распланировать поворотов CEK. 
- Смена ключей CMK не влияет на производительность базы данных, но можно сделать с помощью отдельных ролей.
На схеме ниже показаны варианты хранилища ключей для главных ключей столбца при использовании Always Encrypted.

![Поставщики хранилища CMK для Always Encrypted](./media/sql-database-manage-after-migration/always-encrypted.png)

### <a name="how-can-i-optimize-and-secure-the-traffic-between-my-organization-and-sql-database"></a>Как оптимизировать и защита трафика между моей организации и базы данных SQL?
Обычно сетевой трафик между вашей организацией и базы данных SQL будет направлено по публичной сети. Тем не менее если вы решили оптимизировать этот путь и сделать его более безопасным, можно найти в Express Route. Express route фактически позволяет расширить корпоративной сети в платформе Azure через подключение к частной. Таким образом, вы не проходят через общедоступный Интернет. Можно также получить большую безопасность, надежность и маршрутизации оптимизации, который преобразуется в меньшую задержку сети и намного быстрее скоростью, чем можно будет обычно возможности, идущие через общедоступный Интернет. Если вы планируете переносить значительные фрагмент данных между вашей организацией и Azure, с помощью Express Route может обеспечить сокращение затрат. Для выбора из трех моделей различные подключения для подключения из вашей организации в Azure: 
- [Совместное размещение в облаке Exchange](../expressroute/expressroute-connectivity-models.md#CloudExchange)
- [Any к any](../expressroute/expressroute-connectivity-models.md#IPVPN)
- [Точка-точка](../expressroute/expressroute-connectivity-models.md#Ethernet)

Express Route также позволяет прорыв в два раза ограничение пропускной способности, приобретения без дополнительной платы. Можно также настроить межрегиональное подключение с помощью Express Route. Список поставщиков подключений аварийного восстановления см. в разделе: [Express Route партнеры и одноранговые расположения](../expressroute/expressroute-locations.md). В следующих статьях описывается Express Route более подробно:
- [Обзор ExpressRoute](../expressroute/expressroute-introduction.md)
- [Предварительные требования](../expressroute/expressroute-prerequisites.md)
- [Рабочие процессы](../expressroute/expressroute-workflows.md)

### <a name="is-sql-database-compliant-with-any-regulatory-requirements-and-how-does-that-help-with-my-own-organizations-compliance"></a>Совместима ли база данных SQL с какими-либо нормативными требованиями и как это помогает соблюдению требований моей собственной организации?
База данных SQL является совместимым с диапазоном законодательным нормам. Чтобы просмотреть последние набор сообщения, которые были выполнены, посетите [Центр управления безопасностью Microsoft](https://www.microsoft.com/trustcenter/compliance/complianceofferings) и детализировать сообщения, которые важны для вашей организации, чтобы увидеть, если база данных SQL включается в списке совместимых служб Azure. Это важно отметить, что несмотря на то, что база данных SQL может пройти сертификацию на совместимой службы, оно помогает при соответствии службы организации, но не гарантирует его автоматически.

## <a name="intelligent-database-monitoring-and-maintenance-after-migration"></a>Интеллектуальная базы данных мониторинга и обслуживания после миграции

После переноса базы данных в базу данных SQL вы захотите выполнять мониторинг базы данных (для примера, удостоверьтесь в том, как использование ресурсов как или DBCC проверяет) и выполнения регулярного обслуживания (например, перестроение или реорганизация индексов, статистики и т. д.). К счастью база данных SQL является интеллектуальный в том смысле, что он использует динамику и записанные метрик и статистические данные помогут упреждающего мониторинга и обслуживания базы данных, чтобы оптимально всегда работает приложение. В некоторых случаях база данных SQL Azure может автоматически выполнить задачи обслуживания, в зависимости от настроек конфигурации. Существует три аспектов мониторинга базы данных в базе данных SQL.
- Мониторинг производительности и оптимизации.
- Оптимизация безопасности.
- Оптимизацию издержек.

**Мониторинг производительности и оптимизации**: с помощью запроса подробных сведений о производительности, можно получить рекомендации специально настроенные для рабочей нагрузки базы данных, чтобы приложения могут продолжать работать на оптимальном уровне — всегда. Можно также настроить его, чтобы эти рекомендации применяются автоматически, и нет необходимости использоваться выполнение задач обслуживания. Вы можете автоматически реализовать рекомендации по индексам в зависимости от рабочей нагрузки помощник по индексам, — этот процесс называется автоматической настройки. Рекомендации по развивать изменении рабочей нагрузки приложения с наиболее важные варианты. Предусмотрена также возможность вручную, эти рекомендации и применять их по своему усмотрению.  

**Оптимизация безопасности**: база данных SQL предоставляет рекомендации по безопасности, готовые к работе по защите данных и для обнаружения угроз для выявления и изучения подозрительных баз данных действий, которые могут представлять потенциальных потока, в котором База данных. [Оценки уязвимости SQL](sql-vulnerability-assessment.md) — это база данных, проверку и отчетов службы, которая позволяет отслеживать состояние безопасности баз данных в масштабе и выявлять угрозы безопасности и смещения из базового плана безопасности, определенные пользователем. После каждого сканирования предоставляется индивидуальный список практических действий и скрипты исправлений, а также отчет об оценке, который можно использовать для обеспечения соответствия.

С центром обеспечения безопасности в Azure вы определите рекомендации по обеспечению безопасности по доске и применить их одним щелчком. 

**Оптимизацию издержек**: платформу Azure SQL анализирует журнал использования в нескольких базах данных, чтобы оценивают и рекомендуют варианты оптимизации затрат на сервере. Этот анализ обычно занимает fortnight для анализа и построения практические рекомендации. Эластичный пул имеет один параметр. На портале отображается рекомендаций в виде заголовка:

![рекомендации для эластичного пула](./media/sql-database-manage-after-migration/elastic-pool-recommendations.png) 

Этот анализ также можно просмотреть в разделе «Консультант»:

![рекомендации для эластичного пула-advisor](./media/sql-database-manage-after-migration/advisor-section.png)

### <a name="how-do-i-monitor-the-performance-and-resource-utilization-in-sql-database"></a>Как отслеживать производительность и использование ресурсов в базе данных SQL?

В базе данных SQL можно использовать интеллектуальной аналитики платформы для наблюдения за производительностью и настройте соответствующим образом. Можно отслеживать производительность и использование ресурсов в базе данных SQL с помощью следующих методов:
- **Портал Azure**. На портале можно отслеживать использование отдельной базы данных. Для этого нужно выбрать базу данных и щелкнуть диаграмму в области "Обзор". Вы можете настроить отображение на диаграмме нескольких показателей, включая процент использования CPU, процент DTU, процент данных операций ввода-вывода, процент сеансов и процент размера базы данных.

   ![Диаграмма мониторинга](./media/sql-database-manage-after-migration/monitoring-chart.png)

   ![Диаграмма мониторинга 2](./media/sql-database-manage-after-migration/chart.png)

Из этой диаграммы можно также настроить предупреждения по ресурсам. Эти оповещения позволяют соблюдения условий ресурсов с адресом электронной почты, запись в конечную точку HTTPS или HTTP или выполнения действий. В разделе [наблюдение за производительностью базы данных в базе данных SQL](sql-database-single-database-monitor.md) подробные инструкции.

- **Динамические административные представления**: вы можете запросить [sys.dm_db_resource_stats](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-resource-stats-azure-sql-database) динамическое административное представление возвращаемые за последний час журнал статистики потребления ресурсов и [sys.resource_stats ](/sql/relational-databases/system-catalog-views/sys-resource-stats-azure-sql-database) представления системного каталога для получения журнала за последние 14 дней.
- **Анализ производительности запросов**. [Этот инструмент](sql-database-query-performance.md) позволяет просмотреть историю наиболее ресурсоемких и длительных запросов для конкретной базы данных. Можно быстро определить запросы с использования ресурсов, продолжительности и частоты выполнения. Можно отслеживать запросы и обнаружить регрессии. Для этой функции требуется включить [хранилище запросов](/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store) в базе данных.

   ![анализ производительности запросов](./media/sql-database-manage-after-migration/query-performance-insight.png)

- **Аналитика Azure SQL (Предварительная версия) в службе анализа журналов**: [Azure Log Analytics](../log-analytics/log-analytics-azure-sql.md) позволяет собирать и наглядного представления ключевых метрик производительности Azure SQL Azure, поддерживает до 150 000 баз данных SQL и 5000 SQL эластичные пулы на Рабочая область. Ее можно использовать для отслеживания и получения уведомлений. Можно отслеживать в несколько подписок Azure и пулов эластичных баз данных SQL и метрики эластичного пула и может использоваться для выявления проблем на каждом уровне стека приложений.

### <a name="i-am-noticing-performance-issues-how-does-my-sql-database-troubleshooting-methodology-differ-from-sql-server"></a>Я отметить проблем с производительностью: чем Моя база данных SQL по устранению неполадок методологии отличается от SQL Server?
Основной части по устранению проблем используется для диагностики запроса и проблем производительности базы данных остаются неизменными. После того же SQL Server engine лежащих в основе облака. Тем не менее платформа - база данных SQL Azure есть встроенные «intelligence». Он может помочь диагностики и устранения проблем с производительностью, даже проще. Его можно также выполнять некоторые из этих действий по исправлению от вашего имени, а в некоторых случаях, заблаговременно устранить их - автоматически. 

Ваш подхода для устранения неполадок производительности значительно можно обеспечить с помощью интеллектуальные функции, такие как [Insight(QPI) производительности запросов](sql-database-query-performance.md) и [ядра СУБД](sql-database-advisor.md) вместе и Поэтому разница в методологии отличается тем, что относительно — вам больше не нужно вручную работу пробуксовывать, важные сведения, которые могут помочь устранить проблему под рукой. Платформа выполняет самое сложное. Примером этого является QPI. С QPI можно детализировать вплоть до уровня запроса и посмотрите на тренды предыстории и выяснить, когда произошло Снижение точности запроса. Помощник по настройке ядра базы данных позволяет рекомендации на вещей, которые могут помочь повысить общую производительность в целом как - отсутствующих индексов, удаление индексов, параметризация запросов и т. д. 

Устранение неполадок производительности, важно определить ли она только одно приложение или дублирует базы данных, который, влияющие на производительность приложений. Часто состоит проблема производительности на уровне приложения. Это может быть архитектуры или шаблоне доступа. Например рассмотрим, что у вас есть «многословных» приложения, которое зависит от задержки в сети. В этом случае приложение несет, так как будет много короткие запросы, поступающие вперед и назад («нестабильной») между приложением и сервером, а также в перегруженной сети, эти обращения сложить fast. Чтобы повысить производительность в этом случае, можно использовать [пакетные запросы](sql-database-performance-guidance.md#batch-queries). Использование пакетов помогает невероятно, так как теперь запросы обрабатываться в пакете; Таким образом помогает сократить задержку обмена данными и повысить производительность приложений. 

Кроме того, если вы нашли снижению общей производительности базы данных, вы можете отслеживать [sys.dm_db_resource_stats](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-resource-stats-azure-sql-database) и [sys.resource_stats](/sql/relational-databases/system-catalog-views/sys-resource-stats-azure-sql-database) динамические административные представления для понимание использования ЦП, ввода-вывода и памяти. Производительность может быть затронуты, так как базы данных является испытывает существенной нехватки ресурсов. Возможно, что может потребоваться изменение уровня производительности и/или служба уровня, на основании расширение и сжатие рабочих нагрузок. 

Полный набор рекомендации по настройке проблем с производительностью, см.: [настройки базы данных](sql-database-performance-guidance.md#tune-your-database).

### <a name="how-do-i-ensure-i-am-using-the-appropriate-service-tier-and-performance-level"></a>Как убедиться, что используется соответствующий уровень служб и производительности?
База данных SQL предлагает различные уровни обслуживания Basic, Standard и Premium. Каждая служба, вы получаете гарантированную прогнозируемую производительность, привязан до этого уровня службы. В зависимости от рабочей нагрузки может иметь всплески активности, где использование ресурсов может достигнуть предела производительности, текущего уровня производительности, что вы являетесь. В таких случаях полезно предварительного запуска, оценивая ли необходимость настройки может помочь (например, добавления или изменения индекса и т. д.). Если по-прежнему возникают проблемы предел, следует переместить на высокий уровень производительности или уровня обслуживания. 

|**Уровень обслуживания**|**Распространенных сценариев использования**|
|---|---|
|**базовая;**|Приложения с несколько пользователей и базы данных, не имеют высокие требования к параллелизма, масштаб и производительность. |
|**Стандартный**|Приложений с помощью значительные требования параллелизма, масштаб и производительность связана со средним требования ввода-ВЫВОДА с низким. |
|**Премиальный**|Требует ввода-ВЫВОДА приложений с большим количеством одновременных пользователей, высокий уровень ЦП и памяти и высокий. Высокий уровень параллелизма, высокая пропускная способность и задержка конфиденциальные приложения могут использовать уровень Premium. |
|||

Убедиться, что вы используете правильный уровень производительности, можно выполнять мониторинг потребления ресурсов запроса и базы данных посредством одного из вышеперечисленных способов «Как обеспечить отслеживание производительности и использовании ресурсов в базе данных SQL». Следует обнаружится запросы или базы данных постоянно выполняется горячей на ЦП и памяти т. д., рассмотрите возможность вертикальное масштабирование на более высокий уровень производительности. Аналогичным образом Если вы Обратите внимание, что даже во время в часы максимальной нагрузки, не удается использовать ресурсы столько; Рассмотрите возможность уменьшения масштаба из текущего уровня производительности. 

Если у вас есть шаблон приложения SaaS или в сценариях консолидации базы данных, рассмотрите возможность использования эластичного пула для оптимизации затрат. Эластичный пул — это отличный способ повышения объединение базы данных и оптимизации затрат. Чтобы получить дополнительные сведения об управлении несколькими базами данных эластичного пула, в разделе: [Управление пулами и баз данных](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-the-azure-portal). 

### <a name="how-often-do-i-need-to-run-database-integrity-checks-for-my-database"></a>Как часто нужно выполнить проверку целостности базы данных для базы данных?
База данных SQL использует некоторые смарт-методы, которые позволяют его для обработки определенных классов повреждения данных, автоматически и без потери данных. Эти методы, встроенных в службы и используется службой при возникновении. На регулярной основе резервные копии базы данных между службами, проверены, их восстановление и выполнение инструкции DBCC CHECKDB на нем. Если возникли проблемы, база данных SQL заранее адреса их. [Автоматическое восстановление страниц](/sql/sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring) используется для исправления страниц, повреждены, или проблемы целостности данных. Страниц базы данных всегда проверяются с помощью контрольной СУММЫ, по умолчанию проверяет целостность страницы. База данных SQL заранее отслеживает и проверяет целостность данных базы данных и, при возникновении проблем, адресов их с наивысшим приоритетом. Помимо этого можно при необходимости выполнить собственную проверку целостности на ваш будут.  Дополнительные сведения см. в разделе [целостности данных в базе данных SQL](https://azure.microsoft.com/blog/data-integrity-in-azure-sql-database/)

## <a name="data-movement-after-migration"></a>Перемещение данных после переноса

### <a name="how-do-i-export-and-import-data-as-bacpac-files-from-sql-database"></a>Как экспортировать и импортировать данные в виде файлов BACPAC из базы данных SQL?

- **Экспорт**: база данных Azure SQL можно экспортировать как файл BACPAC из портала Azure

   ![Экспорт базы данных](./media/sql-database-export/database-export.png)

- **Импорт**: также можно импортировать данные как BACPAC-файл в базу данных с помощью портала Azure.

   ![Импорт базы данных](./media/sql-database-import/import.png)

### <a name="how-do-i-synchronize-data-between-sql-database-and-sql-server"></a>Способ синхронизации данных между базой данных SQL и SQL Server?
У вас есть несколько способов достижения этого: 
- **[Синхронизация данных](sql-database-sync-data.md)**  — эта функция позволяет синхронизировать данные двунаправленную между несколькими локальными базами данных SQL Server и базы данных SQL. Чтобы синхронизировать с локальными базами данных SQL Server, необходимо установить и настроить агент синхронизации на локальном компьютере и открыть исходящий порт TCP 1433.
- **[Репликация транзакций](https://azure.microsoft.com/en-us/blog/transactional-replication-to-azure-sql-database-is-now-generally-available/)**  — с репликацией транзакций вы можете синхронизировать данные из локальной базы данных SQL Azure с локальной издателя и подписчиков базу данных SQL Azure. Сейчас поддерживается только для этой установки. Дополнительные сведения о том, как перенести данные из локального в Azure SQL с минимальным временем простоя см. в разделе: [использования репликации транзакций](sql-database-cloud-migrate.md#method-2-use-transactional-replication)

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о [базы данных SQL](sql-database-technical-overview.md).

