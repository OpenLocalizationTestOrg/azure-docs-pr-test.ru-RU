---
title: "aaaDeploy и исследовать hello многопользовательского Wingtip SaaS приложения, использующего базу данных SQL Azure | Документы Microsoft"
description: "Развернуть и изучить hello Wingtip SaaS многопользовательскому приложению, демонстрирующий шаблоны SaaS, с использованием базы данных SQL Azure."
keywords: "руководство по базе данных sql"
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: 7c528ee19472d3b8c7a285b2f86013945e8f4bf4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="deploy-and-explore-a-multi-tenant-application-that-uses-azure-sql-database---wingtip-saas"></a>Развертывание и изучение мультитенантного приложения, использующего базу данных SQL Azure — SaaS Wingtip

В этом учебнике развертывание и просмотр приложения Wingtip SaaS hello. приложение Hello использует базы данных отдельных клиентов, модель приложения SaaS, tooservice нескольких клиентов. приложение Hello — спроектированный tooshowcase функции базы данных SQL Azure, которые упрощают Включение сценарии SaaS.

Здравствуйте, пять минут после нажатия кнопки *развертывание tooAzure* кнопку ниже, у вас есть многопользовательскому приложению SaaS, используя базу данных SQL, до и работающими в облаке hello. приложение Hello развертывается с тремя клиентами образца, каждый из которых свою собственную базу данных, все развернутые в пул эластичных БД SQL. Это приложение Hello развернутой tooyour подписки Azure, предоставляя полный доступ tooexplore и работа с hello отдельных компонентов приложения. Hello приложения исходного кода и сценариев управления доступны в репозитории WingtipSaaS GitHub hello.


Из этого руководства вы узнаете следующее:

> [!div class="checklist"]

> * Как toodeploy hello приложения Wingtip SaaS
> * Где tooget hello исходный код приложения и скрипты управления
> * О серверах hello, пулы и баз данных, составляющих приложение hello
> * Как клиенты сопоставляются tootheir данных с помощью hello *каталога*
> * Как tooprovision нового клиента
> * Как toomonitor клиента действия в приложение hello

tooexplore различных SaaS проектирования и управления шаблонов, [серию учебников, связанных](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) доступен, созданы на основе этого первоначального развертывания. Во время с помощью учебников hello, подробно рассмотреть hello предоставленные сценарии и проверьте реализации различных шаблонов SaaS hello. Пошаговое выполнение сценариев hello в каждой учебника toogain более глубокого понимания, как tooimplement hello многие базы данных SQL преимущества упростить разработку приложений SaaS.

## <a name="prerequisites"></a>Предварительные требования

toocomplete завершения этого учебника, убедитесь, что hello следующие предварительные требования:

* Установите Azure PowerShell. Дополнительные сведения см. в статье [Начало работы с Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).

## <a name="deploy-hello-wingtip-saas-application"></a>Развертывание приложения Wingtip SaaS hello

Разверните приложение hello Wingtip SaaS:

1. Выбрав hello **развертывание tooAzure** кнопка открывает шаблон развертывания hello Azure портала toohello Wingtip SaaS. Hello шаблона требуется указать значения параметров; имя для новой группы ресурсов и имя пользователя, являющийся отличительным признаком данного развертывания от других развертываний приложение Wingtip SaaS hello. Следующий шаг Hello подробные сведения о настройке этих значений.

   Убедиться, что toonote hello точных значений, используемых вами убедитесь в том случае, поскольку его нужно будет tooenter их в конфигурацию позднее файл.

   <a href="http://aka.ms/deploywtpapp" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>

1. Введите значения обязательного параметра для hello развертывания:

    > [!IMPORTANT]
    > Некоторые проверки подлинности и брандмауэры сервера не защищены специально, так как предназначены для демонстрации. **Создайте группу ресурсов** и не используйте имеющиеся группы ресурсов, серверы или пулы. Не используйте это приложение или ресурсы, которые оно создает, для рабочей среды. Удалить этот ресурс группы при завершении работы с toostop приложения hello, связанные с выставления счетов.

    * **Группа ресурсов** — выберите **создать новый** и предоставить **имя** для группы ресурсов hello. Выберите **расположение** из раскрывающегося списка hello.
    * **Пользователь** — для некоторых ресурсов требуются глобально уникальные имена. уникальность tooensure каждый раз при развертывании приложения hello предоставлять значение toodifferentiate ресурсов, создать, от ресурсов, созданных любое другое развертывание приложения Wingtip hello. Рекомендуется toouse короткие **пользователя** имя, например инициалы вместе с номером (например, *bg1*) и используйте его в поле имя группы ресурсов hello (например, *wingtip-bg1*). Параметр **Пользователь** может содержать только буквы, цифры и дефисы (без пробелов). Hello первый и последний символ должен быть буквой или цифрой (рекомендуется использовать все строчные).


1. **Развертывание приложения hello**.

    * Щелкните tooagree toohello условий.
    * Щелкните **Приобрести**.

1. Мониторинг состояния развертывания, щелкнув **уведомления** (значок колокольчика hello справа от поля поиска hello). Развертывание приложения Wingtip SaaS hello занимает приблизительно пять минут.

   ![Развертывание выполнено](media/sql-database-saas-tutorial/succeeded.png)

## <a name="download-and-unblock-hello-wingtip-saas-scripts"></a>Загрузите и разблокировать сценарии Wingtip SaaS hello

При развертывании приложения hello, загрузите hello исходного кода и сценариев управления.

> [!IMPORTANT]
> Исполняемое содержимое (скрипты, библиотеки DLL) может быть заблокировано Windows, в то время как ZIP-файлы можно загрузить с внешнего источника, а затем извлечь их содержимое. При извлечении hello скрипты из ZIP-файл, выполните действия hello ниже toounblock hello ZIP-файл перед извлечением. Это гарантирует, что hello сценарии могут toorun.

1. Обзор слишком[Wingtip SaaS hello в репозитории github](https://github.com/Microsoft/WingtipSaaS).
1. Выберите **Clone or download** (Клонировать или скачать).
1. Нажмите кнопку **загрузить ZIP** и сохраните файл hello.
1. Щелкните правой кнопкой мыши hello **WingtipSaaS master.zip** правой кнопкой мыши и выберите **свойства**.
1. На hello **Общие** выберите **Unblock**и нажмите кнопку **применить**.
1. Нажмите кнопку **ОК**.
1. Извлеките файлы hello.

Скрипты, расположенные в hello *... \\WingtipSaaS master\\модулей обучения* папки.

## <a name="update-hello-configuration-file-for-this-deployment"></a>Обновить файл конфигурации hello для этого развертывания

Перед запуском любых других скриптов, настройте hello *группы ресурсов* и *пользователя* значения в **UserConfig.psm1**. Эти переменные задайте toohello значения, заданные во время развертывания.

1. Открыть... \\Модулей обучения\\*UserConfig.psm1* в hello *интегрированной среды Сценариев PowerShell*
1. Обновление *ResourceGroupName* и *имя* с определенными значениями hello для развертывания (в строках, 10 и 11 только).
1. Сохраните изменения hello!

Установка этого параметра здесь просто позволяет избежать tooupdate эти значения относящиеся к развертыванию в каждом сценарии.

## <a name="run-hello-application"></a>Запустите приложение hello

приложение Hello, демонстрирующий местоположения, такие как совместно помещениям, Поднимите настроение трефы спортивных трефы, на котором размещена события. Местоположения регистрации в качестве клиентов (или клиенты) hello Wingtip платформы, для событий toolist легко и продажу билетов. Каждый проведения возвращает toomanage персонализированной web app и перечислены события, их и продажу билетов, независимые и изолирован от других клиентов. На деле hello каждый клиент получает базы данных SQL, развернутой в пул эластичных БД SQL.

Центральный **концентратора событий** предоставляет список клиентов, URL-адреса tooyour конкретного развертывания.

1. Откройте hello _концентратора событий_ в веб-браузере: http://events.wtp.&lt; ПОЛЬЗОВАТЕЛЬ&gt;. trafficmanager.net (Замените именем пользователя развертывания):

    ![Концентратор событий](media/sql-database-saas-tutorial/events-hub.png)

1. Щелкните **Fabrikam Jazz Club** в *концентраторе событий*.

   ![События](./media/sql-database-saas-tutorial/fabrikam.png)


Распределение hello toocontrol входящие запросы, приложение использует hello [ *диспетчера трафика Azure*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview). события страницы приветствия, которые зависят от конкретного клиента, требуют включения имен клиента в URL-адресах hello. Все hello клиента URL-адреса включают конкретных *пользователя* значение и соответствует этому формату: http://events.wtp.&lt; ПОЛЬЗОВАТЕЛЬ&gt;.trafficmanager.net/*fabrikamjazzclub*. приложение Hello события выполняет синтаксический анализ имени клиента hello hello URL-адресу и использует его toocreate ключа tooaccess каталога с помощью [ *управления карты сегментов*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management). Здравствуйте hello ключа toohello каталога карты клиента расположение базы данных. Hello **концентратора событий** использует расширенные метаданные в имя tooretrieve hello hello каталога клиента, связанные с каждой базы данных tooprovide hello список URL-адресов.

В рабочей среде обычно бы создать запись CNAME DNS для [ *направление домена Интернета компании* ](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) в профиле диспетчера трафика hello.

## <a name="start-generating-load-on-hello-tenant-databases"></a>Приступить к созданию нагрузки на базы данных клиента hello

Теперь, когда hello развертывается приложение, скажем toowork! Hello *LoadGenerator Демонстрация* сценарий PowerShell запускает относительно рабочей нагрузки для всех баз данных клиента. Hello реальной нагрузки на многих приложений SaaS, обычно является случайные и непредсказуемым. toosimulate этот тип нагрузки, генератор hello выводятся нагрузки, распределенные по всем клиентам, случайного увеличениям на каждого клиента, происходящих случайного интервалы. По этой причине, необходимое tooemerge шаблон нагрузки hello через несколько минут в этом случае наилучшим генератор hello toolet, запустите для по крайней мере трех или четырех минут, прежде чем мониторинга hello нагрузки.

1. В hello *интегрированной среды Сценариев PowerShell*откройте hello... \\Модулей обучения\\программы\\*LoadGenerator.ps1 Демонстрация* сценария.
1. Нажмите клавишу **F5** запустить сценарий hello и запустить генератор нагрузки hello (оставьте hello значения параметров по умолчанию сейчас).

> [!IMPORTANT]
> toorun других сценариев, откройте новое окно интегрированной среды Сценариев PowerShell. Генератор нагрузки Hello выполняется как ряд заданий в локальном сеансе PowerShell. Hello *LoadGenerator.ps1 Демонстрация* сценария начинается hello реальную нагрузку генератор скрипта, который выполняется как задача переднего плана, а также ряд создание нагрузки фоновых заданий. Задание генератор нагрузки вызывается для каждой базы данных, зарегистрированные в каталоге hello. задания Hello выполняются в локальном сеансе PowerShell, чтобы закрыть сеанс PowerShell hello останавливает все задания. Если приостановить работу компьютера, создание нагрузки будет приостановлено и будет возобновлено после включения компьютера.

После того, как генератор нагрузки hello вызывает создание нагрузки задания для каждого клиента, задача переднего плана hello остается в состоянии вызова задания, где он запускает дополнительные фоновых заданий для любого новых клиентов, которые впоследствии провизионируются. Можно использовать *Ctrl-C* или нажмите клавишу hello *остановить* кнопку toostop hello основной задачи, но существующие фонового задания будут продолжать для создания нагрузки на каждой базе данных. Если нужно toomonitor и управлять hello фоновых заданий, используйте *Get-Job*, *Receive-Job* и *Stop-Job*. Пока выполняется задача переднего плана hello не может использовать hello же tooexecute сеанса PowerShell других сценариев. toorun других сценариев, откройте новое окно интегрированной среды Сценариев PowerShell.

Чтобы сеанс toorestart hello нагрузки генератора, например с разными параметрами, можно остановить hello задача переднего плана, а затем повторно запустите hello *LoadGenerator.ps1 Демонстрация* сценария. Повторный запуск *LoadGenerator.ps1 Демонстрация* сначала останавливает все выполняемые задания, а затем перезапуск hello генератор, который запускает новый набор заданий с использованием текущих параметров hello.

Пока оставьте генератор нагрузки hello в состоянии вызова задания hello.


## <a name="provision-a-new-tenant"></a>Подготовка нового клиента

Hello первоначального развертывания создает три образца клиента, но давайте создадим другой toosee клиента как это влияет на приложения hello развертывания. рабочий процесс подготовки клиентов Wingtip SaaS Hello подробно описан в hello [учебника подготовки и каталога](sql-database-saas-tutorial-provision-and-catalog.md). На этом шаге вы сможете быстро создать клиент.

1. Открыть... \\Modules\Provision обучения и каталога\\*Демонстрация ProvisionAndCatalog.ps1* в hello *интегрированной среды Сценариев PowerShell*.
1. Нажмите клавишу **F5** для выполнения сценария hello (оставьте значения по умолчанию hello сейчас).

   > [!NOTE]
   > Использовать много сценариев Wingtip SaaS *$PSScriptRoot* tooallow перемещение папки toocall функции в других сценариях. Эта переменная вычисляется только при выполнении скрипта hello, нажав клавишу **F5**.  Если выделить несколько скриптов и запустить их (**F8**), может произойти ошибка, поэтому нажмите клавишу **F5** при выполнении скриптов.

Hello новой базы данных клиента создается в пуле эластичных БД SQL, инициализированы и зарегистрированы в каталоге hello. После успешной подготовки нового клиента hello продажи билетов *событий* в браузере откроется сайт:

![Новый клиент](./media/sql-database-saas-tutorial/red-maple-racing.png)

Обновить hello *концентратора событий* и новый клиент hello появится в списке hello.


## <a name="explore-hello-servers-pools-and-tenant-databases"></a>Просмотр серверов hello, пулы и клиентов баз данных

Теперь, когда вы начали запущенного нагрузки для hello коллекцию клиентов, рассмотрим некоторые hello ресурсы, которые были развернуты.

1. В [портал Azure](http://portal.azure.com)tooyour список серверов SQL Server перейдите и откройте **каталога -&lt;пользователя&gt;**  сервера. сервер каталога Hello содержит две базы данных. Hello **tenantcatalog**и hello **basetenantdb** (пустой *золотой* или шаблона базы данных, скопированных toocreate новых клиентов).

   ![databases](./media/sql-database-saas-tutorial/databases.png)

1. Вернитесь tooyour список серверов SQL Server и откройте hello **tenants1 -&lt;пользователя&gt;**  сервер, содержащий базы данных клиента hello. Каждая клиентская база данных является эластичной базой данных _уровня "Стандартный"_ в пуле уровня "Стандартный" на 50 eDTU. Также Обратите внимание, _трассировки клен Red_ базы данных, базы данных клиента hello подготовлены в ранее.

   ![server](./media/sql-database-saas-tutorial/server.png)

## <a name="monitor-hello-pool"></a>Монитор hello пула

Если генератор нагрузки hello выполнения в течение нескольких минут, достаточно данных должны быть доступны toostart обзор некоторых hello мониторингу встроены в пулы и баз данных.

1. Обзор сервера toohello **tenants1 -&lt;пользователя&gt;**и нажмите кнопку **Pool1** об использовании ресурсов для пула hello (генератор нагрузки hello запускали часа в hello следующие диаграммы) :

   ![Отслеживание пула](./media/sql-database-saas-tutorial/monitor-pool.png)

На этих диаграммах хорошо видно, насколько хорошо подходят эластичные пулы и база данных SQL для рабочих нагрузок приложения SaaS. Четырех баз данных, которые каждого всплеск tooas почти так же легко, поддерживаемых edtu, которое 40 50 eDTU пула. Если они были подготовлены как автономные базы данных, они бы каждой необходимости toobe S2 (50 DTU) toosupport hello пакетами. стоимость Hello 4 S2 автономные базы данных могут быть цены hello почти 3 раза пула hello и hello пула по-прежнему содержит удовлетворяя многие дополнительные базы данных. В реальных ситуациях пользователям баз данных SQL в данный момент выполняются копирование баз данных too500 в 200 eDTU пулы. Дополнительные сведения см. в разделе hello [наблюдение за учебника](sql-database-saas-tutorial-performance-monitoring.md).


## <a name="next-steps"></a>Дальнейшие действия

Из этого руководства вы узнали следующее:

> [!div class="checklist"]

> * Как toodeploy hello приложения Wingtip SaaS
> * О серверах hello, пулы и баз данных, составляющих приложение hello
> * Клиенты, сопоставленные tootheir данных с помощью hello *каталога*
> * Как tooprovision новых клиентов
> * Как toomonitor использование пула tooview клиента действия
> * Взаимосвязь toostop ресурсы образец toodelete выставления счетов

Теперь попробуйте hello [учебника подготовки и каталога](sql-database-saas-tutorial-provision-and-catalog.md)



## <a name="additional-resources"></a>Дополнительные ресурсы

* Дополнительные [учебники, созданных на основе hello приложения Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)
* в разделе toolearn о пулах эластичных БД [ *возможности пуле эластичных БД Azure SQL*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool)
* toolearn о эластичной заданиях см [ *базы данных горизонтально масштабируемого облака управление*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview)
* toolearn о приложения SaaS с несколькими клиентами, в разделе [ *шаблоны многопользовательских приложений SaaS проектирования*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)
