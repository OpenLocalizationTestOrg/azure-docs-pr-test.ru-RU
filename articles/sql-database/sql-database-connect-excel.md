---
title: "Подключение Excel к базе данных SQL | Документация Майкрософт"
description: "Узнайте, как подключить Microsoft Excel к базе данных SQL Azure в облаке. Импортируйте данные в Excel для создания отчетов и просмотра данных."
services: sql-database
keywords: "подключение excel к sql, импорт данных в excel"
documentationcenter: 
author: joseidz
manager: jhubbard
editor: 
ms.assetid: 906924bc-2707-48d3-bac6-397976a0409d
ms.service: sql-database
ms.custom: develop apps
ms.workload: On Demand
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/10/2017
ms.author: jhubbard
ms.openlocfilehash: 34ff5c479cfcf1e861a82205eef93dfee01cb4a2
ms.sourcegitcommit: e5355615d11d69fc8d3101ca97067b3ebb3a45ef
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="connect-excel-to-an-azure-sql-database-and-create-a-report"></a>Подключение Excel к базе данных SQL Azure и создание отчета

Подключите Excel к базе данных SQL в облаке для импорта данных, а также создания таблиц и диаграмм на основе значений в базе данных. Работая с этим руководством, вы установите подключение между Excel и таблицей базы данных, сохраните файл, в котором хранятся данные и сведения о соединении для Excel, а затем создадите сводную диаграмму на основе значений базы данных.

Чтобы начать работу, вам понадобится база данных SQL в Azure. Если база данных отсутствует, чтобы настроить ее с помощью демонстрационных данных, см. статью [Руководство по базам данных SQL: создание базы данных SQL за несколько минут с помощью портала Azure](sql-database-get-started-portal.md). Следуя инструкциям в этой статье, вы импортируете демонстрационные данные в Excel, но те же действия можно выполнять и с собственными данными.

Вам также понадобится копия Excel. В этой статье используется [Microsoft Excel 2016](https://products.office.com/).

## <a name="connect-excel-to-a-sql-database-and-create-an-odc-file"></a>Подключение Excel к базе данных SQL и создание ODC-файла
1. Чтобы подключить Excel к базе данных SQL, откройте программу Excel, а затем создайте новую книгу или откройте существующую.
2. В строке меню в верхней части страницы щелкните **Данные**, **Из других источников** и **С сервера SQL Server**.
   
   ![Выберите источник данных: подключите Excel к базе данных SQL.](./media/sql-database-connect-excel/excel_data_source.png)
   
   Откроется мастер подключения данных.
3. В диалоговом окне **Подключение к серверу баз данных** введите **имя сервера** базы данных SQL, к которому нужно подключиться, в формате <*имя_сервера*>**.database.windows.net**. Например, **adworkserver.database.windows.net**.
4. В разделе **Учетные сведения** установите переключатель **Использовать следующие имя пользователя и пароль**, введите **имя пользователя** и **пароль**, заданные для сервера базы данных SQL во время его создания, и нажмите кнопку **Далее**.
   
   ![Ввод имени сервера и учетных данных для входа](./media/sql-database-connect-excel/connect-to-server.png)
   
   > [!TIP]
   > В зависимости от сетевой среды, возможно, вам не удастся подключиться или соединение будет разорвано, если сервер базы данных SQL не разрешает трафик с IP-адреса клиента. Перейдите на [портал Azure](https://portal.azure.com/), щелкните "Серверы SQL Server", выберите свой сервер, в разделе "Параметры" щелкните "Брандмауэр" и добавьте IP-адрес клиента. Дополнительные сведения см. в статье [Настройка правила брандмауэра уровня сервера базы данных SQL Azure с помощью портала Azure](sql-database-configure-firewall-settings.md).
   > 
   > 
5. В диалоговом окне **Выбор базы данных и таблицы** выберите в списке нужную базу данных и щелкните нужные таблицы или представления (мы выбрали **vGetAllCategories**), а затем нажмите кнопку **Далее**.
   
    ![Выберите базу данных и таблицу.](./media/sql-database-connect-excel/select-database-and-table.png)
   
    Откроется диалоговое окно **Сохранение файла подключения данных и завершение** , где вы можете предоставить сведения о файле подключения (*.odc) базы данных Microsoft Office, который использует программа Excel. Можно оставить значения по умолчанию или выбрать свои параметры.
6. Вы можете оставить значения по умолчанию, но обратите внимание на **имя файла**. Поля **Описание**, **Понятное имя** и **Ключевые слова поиска** помогут вам и другим пользователям не только запомнить объект, к которому вы подключаетесь, но и найти это подключение. Щелкните **Всегда пытаться использовать этот файл для обновления данных**, если нужно сохранить сведения о подключении в ODC-файле, чтобы его можно было обновить после подключения. Затем нажмите кнопку **Готово**.
   
    ![Сохранение ODC-файла](./media/sql-database-connect-excel/save-odc-file.png)
   
    Откроется диалоговое окно **Импорт данных** .

## <a name="import-the-data-into-excel-and-create-a-pivot-chart"></a>Импорт данных в Excel и создание сводной диаграммы
Теперь, когда вы установили подключение, а также создали файл с данными и сведениями о подключении, можно приступать к импорту данных.

1. В диалоговом окне **Импорт данных** выберите нужный вариант представления данных на листе и нажмите кнопку **ОК**. Мы выбрали режим **Сводная диаграмма**. Кроме того, можно создать **новый лист** или **добавить эти сведения в модель данных**. Дополнительные сведения о моделях данных см. в статье [Создание модели данных в Excel](https://support.office.com/article/Create-a-Data-Model-in-Excel-87E7A54C-87DC-488E-9410-5C75DBCB0F7B). Щелкните **Свойства**, чтобы просмотреть сведения об ODC-файле, созданном на предыдущем шаге, и выбрать параметры для обновления данных.
   
    ![Выбор формата данных в Excel](./media/sql-database-connect-excel/import-data.png)
   
    Лист теперь содержит пустую сводную таблицу и диаграмму.
2. В разделе **Поля сводной таблицы**установите все флажки для полей, которые требуется просмотреть.
   
    ![Настройте отчет базы данных.](./media/sql-database-connect-excel/power-pivot-results.png)

> [!TIP]
> Чтобы подключить к базе данных другие книги и листы Excel, щелкните **Данные**, **Подключения**, **Добавить**, выберите в списке созданное подключение и нажмите кнопку **Открыть**.
> ![Открытие подключения из другой книги](./media/sql-database-connect-excel/open-from-another-workbook.png)
> 
> 

## <a name="next-steps"></a>Дальнейшие действия
* Узнайте, как [подключаться к базе данных SQL с помощью SQL Server Management Studio](sql-database-connect-query-ssms.md) для выполнения сложных запросов и анализа.
* Узнайте о преимуществах использования [пулов эластичных БД](sql-database-elastic-pool.md).
* Узнайте, как [создавать веб-приложения, которые подключаются к базе данных SQL в серверной части](../app-service/app-service-web-tutorial-dotnet-sqldatabase.md).

