---
title: "Высокий уровень доступности - служба базы данных SQL Azure | Документы Microsoft"
description: "Дополнительные сведения о возможности высокого уровня доступности службы базы данных SQL Azure и компоненты"
keywords: 
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
ms.assetid: 
ms.service: sql-database
ms.custom: 
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Inactive
ms.date: 12/13/2017
ms.author: sashan
ms.reviewer: carlrab
ms.openlocfilehash: c0a140c959f14c2e8ceaddad5d323f0900be5d2f
ms.sourcegitcommit: fa28ca091317eba4e55cef17766e72475bdd4c96
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2017
---
# <a name="high-availability-and-azure-sql-database"></a>База данных SQL высокого уровня доступности и Azure
С момента создания базы данных SQL Azure PaaS предложения корпорация Майкрософт внесла обещание нашим клиентам, которые высокого уровня доступности (HA) встроен в службы и не может быть необходимо для работы, добавьте специальную логику для клиентов или принимать решения по высокой ДОСТУПНОСТИ. Корпорация Майкрософт предлагает клиентам соглашения об уровне ОБСЛУЖИВАНИЯ и сохранить полный контроль над высокого уровня ДОСТУПНОСТИ конфигурации системы и операции. Применяет к базе данных SQL в области высокой ДОСТУПНОСТИ соглашения об уровне ОБСЛУЖИВАНИЯ и не обеспечивает защиту в случае сбоя общий регион, вызванные факторами, неподконтрольными нашей (например, выступает стихийного бедствия, войны, терроризм, riots, государственных действие или сети или Сбой устройства наших центров обработки данных, включая на сайте заказчика, а также между сайта заказчика и нашим центром данных).

Чтобы упростить проблему пространство высокого уровня ДОСТУПНОСТИ, корпорация Майкрософт использует следующие:
1.  Избежать их сбои оборудования и программного обеспечения
2.  Персонал оперативной допущены, привести к сбоям
3.  Операции запланированного обслуживания причиной простоев 

Хотя такие отдельные события происходят редко, при масштабировании в облаке, они каждую неделю, если не каждый день. 

## <a name="fault-tolerant-sql-databases"></a>Отказоустойчивое баз данных SQL
Пользователям всего его интересуют гибкости собственные базы данных и менее интересны гибкости службы базы данных SQL в целом. 99,99% времени работы службы не имеет смысла, если «Моя база данных» является частью 0,01% баз данных, которые не работают. Каждой базы данных должен быть отказоустойчивой, и устранение ошибок никогда не должно привести к потере зафиксированной транзакции. 

Для данных база данных SQL использует локальное хранилище (LS) в основании прямой подключенных дисков и VHD и удаленном хранилище (RS) на основании страничные большие двоичные объекты в хранилище Azure класса Premium. 
- Локальное хранилище используется в расширенных баз данных и пулы, которые предназначены для OLTP-приложений с высокие требования к операций ввода-ВЫВОДА. 
- Удаленное хранилище используется для уровней Basic и Standard службы предназначены для небольших холодные и больших баз данных, которые требуется хранилище и вычислительной мощности для масштабирования независимо друг от друга. Они используют один страничный большой двоичный объект базы данных и журнала файлов и хранения встроенные механизмы репликации и отработки отказа.

В обоих случаях репликации, функция обнаружения сбоев и механизмы отработки отказа базы данных SQL полностью автоматизировать и выполняться без вмешательства человека. Эта архитектура позволяет убедитесь, что зафиксированные данные не теряются и что надежность данных имеет приоритет над всех остальных.

Основные преимущества:
- Клиенты получить максимальную выгоду от использования реплицируемых баз данных без необходимости настройки или обслуживания сложных оборудования, программного обеспечения, операционной системы или среды виртуализации.
- Весь пакет ACID свойства реляционных баз данных сохраняются в системе.
- Переход на другой ресурс являются полностью автоматизировать без потери зафиксированных данных.
- Маршрутизации подключений к первичной реплике динамически управляет службы с использованием логики приложения, не требуется.
- Высокий уровень автоматической избыточности предоставляется без дополнительной платы.

> [!NOTE]
> Архитектура описанных высокий уровень доступности не может быть изменено без предварительного уведомления. 

## <a name="data-redundancy"></a>Избыточность данных

Решение высокого уровня доступности базы данных SQL на основе [AlwaysON](/sql/database-engine/availability-groups/windows/always-on-availability-groups-sql-server) технологию SQL Server и делает его работы для LS и RS баз данных с минимальными отличиями. В конфигурации LS AlwaysON используется для сохранения состояния в службы Reporting Services используется для обеспечения доступности (низкий RTO). 

## <a name="local-storage"></a>Локальное хранилище

В случае LS каждая база данных переводится в оперативный службой управления (мс) в пределах элемента управления кольца. Одну первичную реплику и по крайней мере двух вторичных реплик (кворуме) находятся в пределах кольца клиента, которая охватывает три независимых физических подсистемах в одном центре обработки данных. Все операции чтения и записи, отправленных шлюза (GW) с первичной репликой и операции записи асинхронно реплицируются во вторичные реплики. База данных SQL использует схему фиксации на основе кворума, где данные записываются на первичную и по крайней мере одна вторичная реплика перед фиксацией транзакций.

[Service Fabric](/azure/service-fabric/service-fabric-overview.md) система отработки отказа автоматически перестраивает реплик как отказа узлов и обслуживает установлен кворум членства, как узлы отклоняются и присоедините системы. Плановое обслуживание координируется тщательно во избежание установлен кворум выхода из строя ниже реплики минимальное количество (обычно 2). Эта модель хорошо подходит для баз данных Premium, но требует избыточность компонентов вычислений и хранения, а также приводит к более высокая стоимость.

## <a name="remote-storage"></a>Удаленное хранилище

Для удаленного хранилища конфигураций (уровней Basic и Standard) ровно одну копию базы данных сохраняется в хранилище BLOB-объектов, возможности системы хранения для устойчивости, избыточность и потери битов — обнаружение. 

Следующей схеме показана архитектура высокого уровня доступности.
 
![Архитектура высокого уровня доступности](./media/sql-database-high-availability/high-availability-architecture.png)

## <a name="failure-detection--recovery"></a>Функция обнаружения сбоев и восстановление 
Крупномасштабных распределенных систем требуется система обнаружения сбоя высокую степень доступности, обнаружение сбоев надежно и быстро и как можно ближе к клиенту. База данных SQL эта система рассчитывается на основе Azure Service Fabric. 

С первичной репликой он сразу становятся очевидными при первичной реплики завершилась с ошибкой и рабочих невозможна, так как все операции чтения и записи выполняются в первичной реплике первую. Повышение уровня вторичную реплику в состояние основной процесс имеет время восстановления (RTO) = 30 секунд и целевую точку восстановления (RPO) = 0. Чтобы снизить влияние на 30 секунд RTO, рекомендуется повторить попытку подключения несколько раз с меньшее время ожидания для количества неудачных попыток соединения.

В случае сбоя вторичной реплики базы данных опускается до минимальной кворума набор, с не резервами. Служба структуры инициирует процесс перенастройки похожа на процедуру после сбоя первичной реплики, поэтому после короткого ожидания для определения, является постоянным, является ли сбой другая вторичная реплика создается. В случаев временные состояния ожидания обслуживания, например Фатальный сбой операционной системы или обновление новая реплика не создан немедленно разрешающее неисправного узла вместо перезапуск. 

Для настройки удаленного хранилища базы данных SQL использует функциональность AlwaysON для отработки отказа базы данных во время обновления. Для этого экземпляра SQL отделившийся заранее в рамках запланированного обновления события, и он присоединяет и восстанавливает файл базы данных из внешнего хранилища. В случае сбоев процесса или других незапланированных событий Windows Fabric управляет доступность экземпляра и в качестве последнего шага восстановления прикрепляет файл удаленной базы данных.

## <a name="conclusion"></a>Заключение
База данных SQL Azure тесно интегрирован с платформой Azure и определяется высокой Service Fabric для обнаружения сбоя и восстановления и больших двоичных объектах хранилища Azure для защиты данных. В то же время базы данных Azure SQL использует технологию AlwaysOn из поля продукта SQL Server для репликации и отработки отказа. Сочетание этих технологий позволяет приложениям полностью использовать преимущества модели смешанного хранения, а также поддерживают наиболее ресурсоемких соглашений об уровне обслуживания. 

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [службы структуры](/azure/service-fabric/service-fabric-overview.md)
- Дополнительные сведения о [диспетчер трафика Azure](/traffic-manager/traffic-manager-overview.md) 
