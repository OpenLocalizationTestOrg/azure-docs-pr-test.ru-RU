---
title: "Автоматическая настройка базы данных SQL | Документация Майкрософт"
description: "База данных SQL анализирует SQL-запрос и автоматически подстраивается под рабочую нагрузку пользователей."
services: sql-database
documentationcenter: 
author: jovanpop-msft
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/05/2017
ms.author: jovanpop
ms.openlocfilehash: f5552793db2d89542782b7d9e8f996314f62e429
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="automatic-tuning"></a>Автоматическая настройка

База данных SQL Azure — это полностью управляемая служба данных, которая отслеживает запросы, выполняемые в базе данных и может автоматически повышать производительность рабочей нагрузки. База данных SQL Azure имеет встроенный механизм, который может автоматически настраивать и повышать производительность запросов путем динамической адаптации базы данных к рабочей нагрузке. Автоматическая настройка в базе данных SQL Azure может быть одной из самых важных функций, которые можно включить в базе данных SQL Azure для оптимизации производительности запросов.

Инструкции о том, как включить автоматическую настройку с помощью портала Azure, см. в [этой статье](sql-database-automatic-tuning-enable.md).

## <a name="why-automatic-tuning"></a>Почему автоматическая настройка

Одна из основных задач при администрировании классической базы данных — это мониторинг рабочей нагрузки, определение важных запросов SQL, индексов, которые нужно добавить для повышения производительности и редко используемых индексов. База данных SQL Azure обеспечивает точное представление о запросах и индексах, которые необходимо отслеживать. Однако постоянный мониторинг базы данных — это сложная и трудоемкая задача, особенно при работе с несколькими базами данных. Эффективное управление огромным числом баз данных невозможно даже с учетом всех доступных средств и отчетов, предоставленных базой данных SQL Azure и порталом Azure. Вместо того чтобы вручную выполнять мониторинг и настройку базы данных, мы рекомендуем делегировать некоторые действия по настройке и мониторингу базе данных SQL Azure с помощью автоматической функции настройки. 


> [!VIDEO https://channel9.msdn.com/Blogs/Azure-in-the-Enterprise/Enabling-Azure-SQL-Database-Auto-Tuning-at-Scale-for-Microsoft-IT/player]
>

## <a name="how-does-automatic-tuning-work"></a>Как работает автоматическая настройка

В базе данных SQL Azure есть процессы непрерывного мониторинга производительности и анализа, которые постоянно отслеживают характеристики рабочей нагрузки, а также определяют потенциальные проблемы и возможные улучшения.

![Процесс автоматической настройки](./media/sql-database-automatic-tuning/tuning-process.png)

Этот процесс позволяет базе данных SQL Azure динамически адаптироваться к рабочей нагрузке, находя индексы и планы, которые могут способствовать повышению производительности рабочей нагрузки, а также индексы, влияющие на рабочую нагрузку. На основании этих данных автоматическая настройка применяет действия по настройке производительности при рабочей нагрузке. Кроме того, база данных SQL Azure постоянно отслеживает производительность после любых изменений, внесенных автоматической настройкой, чтобы убедиться в том, что они повышают производительность рабочей нагрузки. Любое действие, которое не повысило производительность, автоматически отменяется. Процесс проверки является ключевой возможностью, которая гарантирует, что любые изменения, сделанные автоматической настройкой, не приведут к снижению производительности рабочей нагрузки.

В базе данных SQL Azure есть две функции автоматической настройки:

 -  **Автоматическое управление индексами**: определяет индексы, которые необходимо добавить в базу данных или удалить.
 -  **Автоматическое изменение плана**: определяет проблемные планы и исправляет проблемы производительности плана SQL (ожидается в ближайшее время, уже доступна в SQL Server 2017).

## <a name="automatic-index-management"></a>Автоматическое управление индексами

В базе данных SQL Azure управлять индексами легко, так как база данных SQL Azure отслеживает рабочую нагрузку и всегда обеспечивает оптимальную индексацию данных. Правильное проектирование индекса имеет решающее значение для обеспечения оптимальной производительности при рабочей нагрузке. Автоматическое управление индексами поможет оптимизировать их. Автоматическое управление индексами может как устранять проблемы с производительностью в неправильно индексированных базах данных, так и поддерживать и оптимизировать индексы в существующей схеме базы данных. 

### <a name="why-do-you-need-index-management"></a>Для чего необходимо управление индексами

Индексы ускоряют некоторые запросы на чтение данных из таблиц. Тем не менее, они могут снизить производительность запросов, используемых для обновления данных. Необходимо тщательно проанализировать необходимость создания индекса и какие столбцы нужно включать в него. Некоторые индексы могут оказаться ненужными через некоторое время. Таким образом, необходимо периодически определять индексы, которые не приносят никаких преимуществ, и удалять их. Если вы будете игнорировать неиспользуемые индексы, производительность запросов, которые обновляют данные может уменьшиться без каких-либо преимуществ для запросов, которые считывают данные. Неиспользуемые индексы также влияют на общую производительность системы, так как дополнительные обновления требуют ненужного ведения журнала.

Поиск оптимального набора индексов, повышающего производительность запросов, которые считывают данные из таблиц и оказывают минимальное влияние на обновления, может потребовать непрерывного и сложного анализа.

База данных SQL Azure использует встроенную аналитику и расширенные фильтры, которые анализируют запросы, определяют индексы, которые оптимально подходили бы для вашей текущей рабочей нагрузки, а также индексы, которые можно удалить. База данных Azure SQL гарантирует, что у вас есть минимально необходимый набор индексов, оптимизирующих запросы, которые считывают данные, с минимальным воздействием на другие запросы.

### <a name="how-to-identify-indexes-that-need-to-be-changed-in-your-database"></a>Как определить в базе данных индексы, которые необходимо изменить

База данных SQL Azure упрощает процесс управления индексами. Вместо трудоемкого процесса анализа рабочей нагрузки вручную и мониторинга индекса, база данных SQL Azure анализирует рабочую нагрузку, определяет запросы, которые могут выполняться быстрее с новым индексом, а также неиспользуемые или повторяющиеся индексы. Дополнительные сведения об идентификации индексов, которые необходимо изменить, см. в статье [Использование помощника по базам данных SQL на портале Azure](sql-database-advisor-portal.md).

### <a name="automatic-index-management-considerations"></a>Рекомендации по автоматическому управлению индексами

Если обнаружится, что встроенные правила повышают производительность базы данных, можно разрешить базе данных SQL Azure автоматически управлять индексами.

Действия, которые нужны для создания необходимых индексов в базах данных SQL Azure, могут потреблять ресурсы и временно повлиять на производительность рабочей нагрузки. Чтобы свести влияние процесса создания индекса на производительность при рабочей нагрузке к минимуму, база данных SQL Azure находит соответствующее временное окно для любой операции управления индексом. Действия по настройке будут отложены, если базе данных необходимы ресурсы для выполнения рабочей нагрузки, и запустятся, когда у базы данных будет достаточно неиспользуемых ресурсов, которые могут использоваться для задач обслуживания. Одна из важных функций автоматического управления индексами — это проверка действий. Если база данных SQL Azure создает или удаляет индекс, процесс мониторинга анализирует производительность при рабочей нагрузке, чтобы убедиться, что производительность действительно улучшилась. Если действие не привело к значительным улучшениям, оно немедленно отменяется. Таким образом, база данных SQL Azure гарантирует, что автоматические действия не снижают производительность при рабочей нагрузке. Индексы, созданные автоматической настройкой, прозрачны для операции обслуживания в базовой схеме. Изменения схемы, например удаление или переименование столбцов, не блокируются при наличии автоматически созданных индексов. Индексы, которые были автоматически созданы базой данных SQL Azure, немедленно удаляются при удалении связанных таблиц или столбцов.

## <a name="automatic-plan-choice-correction"></a>Автоматическое исправление выбора плана

Автоматическое исправление плана — это новая функция автоматической настройки, добавленная в SQL Server 2017 CTP 2.0, которая определяет неправильное поведение планов SQL. Функция автоматической настройки будет добавлена в ближайшее время в базе данных SQL Azure. Дополнительные сведения см.в статье [Автоматическая настройка](https://docs.microsoft.com/sql/relational-databases/automatic-tuning/automatic-tuning).

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о том, как включить автоматическую настройку в Базе данных SQL Azure и позволить ей полностью управлять рабочей нагрузкой, см. в [этой статье](sql-database-automatic-tuning-enable.md).
- Дополнительные сведения о ручной настройке для повышения производительности запросов см. в статье [Использование помощника по базам данных SQL на портале Azure](sql-database-advisor-portal.md).
