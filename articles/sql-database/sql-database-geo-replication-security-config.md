---
title: "безопасность базы данных SQL Azure для аварийного восстановления aaaConfigure | Документы Microsoft"
description: "В этом разделе объясняется вопросы безопасности для настройки и управления безопасностью после восстановления базы данных или отработки отказа tooa сервер-получатель hello для события сбоя центра обработки данных или иного сбоя"
services: sql-database
documentationcenter: na
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: c7c898c9-69d4-4e16-8b7e-720bbb3353dd
ms.service: sql-database
ms.custom: business continuity
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 10/13/2016
ms.author: sashan
ms.openlocfilehash: c3172568e1b8ad2a53958200aa6cf19b4a9434ea
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="configure-and-manage-azure-sql-database-security-for-geo-restore-or-failover"></a>Настройка безопасности Базы данных SQL Azure и управление ею для геовосстановления или отработки отказа 

> [!NOTE]
> [Активная георепликация](sql-database-geo-replication-overview.md) теперь доступна для всех баз данных и всех уровней обслуживания.
>  

## <a name="overview-of-authentication-requirements-for-disaster-recovery"></a>Обзор требований к проверке подлинности для аварийного восстановления
В этом разделе описываются требования tooconfigure hello проверки подлинности и управления [активной георепликации](sql-database-geo-replication-overview.md) и hello шагов требуется tooset копирование пользовательского доступа toohello баз данных-получателей. В нем также рассматриваются как включить восстановленной базы данных toohello доступа после использования [геовосстановление](sql-database-recovery-using-backups.md#geo-restore). Дополнительные сведения о вариантах восстановления см. в статье [Обзор обеспечения непрерывности бизнес-процессов с помощью базы данных SQL Azure](sql-database-business-continuity.md).

## <a name="disaster-recovery-with-contained-users"></a>Аварийное восстановление с поддержкой автономных пользователей
В отличие от традиционных пользователей, который должен быть сопоставлен toologins в базе данных master hello, автономного пользователя полностью управляется самой базы данных hello. Это имеет два преимущества. В сценарии аварийного восстановления hello hello пользователи могут продолжать tooconnect toohello новой основной базы данных или восстановить с использованием геовосстановления без дополнительной настройки, поскольку hello базы данных управляет hello пользователями базы данных hello. Кроме этого, с точки зрения входа такая конфигурация потенциально может иметь преимущества масштабируемости и производительности. Дополнительные сведения см. в статье [Пользователи автономной базы данных — создание переносимой базы данных](https://msdn.microsoft.com/library/ff929188.aspx). 

Основной недостаток Hello, что управление hello процесса аварийного восстановления в масштабе более сложной задачей. При наличии нескольких баз данных, используйте приветствия содержится имя пользователя, обслуживание hello учетные данные с помощью пользователей в нескольких базах данных могут поставить под сомнение hello преимущества автономных пользователей. Например политику смены паролей hello требует выполняться единообразно в нескольких базах данных, а не как hello при смене пароля для имени входа hello один раз в базе данных master hello. По этой причине, если имеется несколько баз данных, используйте hello же имя пользователя и пароль, не рекомендуется использование автономных пользователей. 

## <a name="how-tooconfigure-logins-and-users"></a>Как tooconfigure имена входа и пользователи
При использовании имен входа и пользователей (а не автономных пользователей), необходимо выполнить дополнительные шаги tooinsure hello, этот же входа существуют в базе данных master hello. Hello следующих разделах рассматриваются вопросы участвующих и дополнительные действия hello.

### <a name="set-up-user-access-tooa-secondary-or-recovered-database"></a>Настройка пользователя tooa получателей или восстанавливать базы данных access
Для hello баз данных-получателей toobe можно использовать как только для чтения базы данных-получателя и tooensure права доступа toohello новой первичной базы данных или hello базы данных восстановлен с помощью географическое восстановление hello главной базы данных hello целевого сервера должен иметь hello соответствующую конфигурацию безопасности на месте до восстановления hello.

Далее в этом разделе описываются Hello конкретные разрешения для каждого шага.

Подготовка tooa доступ пользователя получателя географической репликации должно выполняться в рамках настройки георепликации. Подготовку доступа пользователей базы данных восстановлена geo toohello должна выполняться в любое время, когда hello исходный сервер подключен к сети (например, в составе детализации hello аварийного восстановления).

> [!NOTE]
> Если не over или географическое восстановление сервера tooa, у которого нет имен входа, правильно настроен, tooit доступ будет toohello ограниченной учетной записи администратора сервера.
> 
> 

Настройка имен входа на целевом сервере hello включает следующие три действия:

#### <a name="1-determine-logins-with-access-toohello-primary-database"></a>1. Определение входных данных для доступа к toohello базы данных-источника:
Первым шагом Hello hello процесса является имя входа, которое необходимо копировать на целевом сервере hello toodetermine. Это можно сделать с помощью двух инструкций SELECT, в hello логической базе данных master на исходном сервере hello и в hello основной базы данных.

Здравствуйте, только администратор сервера или членом hello **LoginManager** серверной роли можно определить приветствия имен входа на исходном сервере hello с hello, следующем за инструкцией SELECT. 

    SELECT [name], [sid] 
    FROM [sys].[sql_logins] 
    WHERE [type_desc] = 'SQL_Login'

Только членом роли базы данных db_owner hello, hello пользователь dbo или администратор сервера может определять всех участников пользователя hello базы данных в базе данных-источнике hello.

    SELECT [name], [sid]
    FROM [sys].[database_principals]
    WHERE [type_desc] = 'SQL_USER'

#### <a name="2-find-hello-sid-for-hello-logins-identified-in-step-1"></a>2. Найти hello SID для имен входа hello, определенных на шаге 1:
Сравнивая выходные данные hello hello запросов из предыдущего раздела hello и сопоставления hello идентификаторы безопасности, можно сопоставить пользователя toodatabase входа сервера hello. Имена входа, имеющие пользователя базы данных с соответствующими SID иметь базы данных toothat доступ пользователей в качестве участника-пользователя. 

Hello следующий запрос может быть используется toosee всех участников-пользователей hello и их SID в базе данных. Этот запрос может выполнять только члены hello db_owner базы данных роли или администратор сервера.

    SELECT [name], [sid]
    FROM [sys].[database_principals]
    WHERE [type_desc] = 'SQL_USER'

> [!NOTE]
> Hello **INFORMATION_SCHEMA** и **sys** пользователи имеют *NULL* идентификаторы безопасности и hello **гостевой** SID является **0x00**. Hello **dbo** SID может начинаться с *0x01060000000001648000000000048454*, если создатель базы данных hello Здравствуйте, администратор сервера вместо членом **DbManager**.
> 
> 

#### <a name="3-create-hello-logins-on-hello-target-server"></a>3. Создайте имена входа hello на целевом сервере hello:
Hello последний шаг toogo toohello целевой сервер или серверы, а создать имена входа hello с hello соответствующие идентификаторы безопасности. Hello базовый синтаксис выглядит следующим образом.

    CREATE LOGIN [<login name>]
    WITH PASSWORD = <login password>,
    SID = <desired login SID>

> [!NOTE]
> Если требуется toohello доступ пользователя toogrant получателя, но не toohello первичной, это можно сделать путем изменения hello имя входа пользователя на сервере-источнике hello, используя синтаксис hello.
> 
> ALTER LOGIN <login name> DISABLE
> 
> DISABLE не изменяет пароль hello, поэтому можно всегда включить его при необходимости.
> 
> 

## <a name="next-steps"></a>Дальнейшие действия
* Дополнительные сведения об управлении доступом к базе данных и именами для входа см. в статье [Проверка подлинности и авторизация в базе данных SQL: предоставление доступа](sql-database-manage-logins.md).
* Дополнительные сведения о пользователях автономной базы данных см. в статье [Пользователи автономной базы данных — создание переносимой базы данных](https://msdn.microsoft.com/library/ff929188.aspx).
* Сведения об использовании и настройке активной георепликации см. в статье [Обзор. Группы отработки отказа и активная георепликация](sql-database-geo-replication-overview.md).
* Сведения об использовании геовосстановления см. в [этом разделе](sql-database-recovery-using-backups.md#geo-restore).

