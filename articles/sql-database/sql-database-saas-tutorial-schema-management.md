---
title: "aaaManage схемы базы данных SQL Azure в приложении несколькими клиентами | Документы Microsoft"
description: "Управление схемой для нескольких клиентов в мультитенантном приложении, использующем базу данных SQL Azure"
keywords: "руководство по базе данных sql"
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2017
ms.author: billgib; sstein
ms.openlocfilehash: ea946e556808dabd60dd39cb8173d0512d4bddec
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="manage-schema-for-multiple-tenants-in-hello-wingtip-saas-application"></a><span data-ttu-id="96b0b-104">Управление схемой для нескольких клиентов в приложение Wingtip SaaS hello</span><span class="sxs-lookup"><span data-stu-id="96b0b-104">Manage schema for multiple tenants in hello Wingtip SaaS application</span></span>

<span data-ttu-id="96b0b-105">Hello [первом учебнике Wingtip SaaS](sql-database-saas-tutorial.md) показано, как приложение hello можно подготовить базы данных клиента и зарегистрировать его в каталоге hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-105">hello [first Wingtip SaaS tutorial](sql-database-saas-tutorial.md) shows how hello app can provision a tenant database and register it in hello catalog.</span></span> <span data-ttu-id="96b0b-106">Как и любое приложение приветствия приложению Wingtip SaaS будет меняться со временем и в некоторых случаях потребуется базы данных toohello изменения.</span><span class="sxs-lookup"><span data-stu-id="96b0b-106">Like any application, hello Wingtip SaaS app will evolve over time, and at times will require changes toohello database.</span></span> <span data-ttu-id="96b0b-107">Изменения могут включать новые или измененные схему, новые или измененные ссылочных данных и сопоставление базы данных обслуживания задачи tooensure оптимальной производительности приложения.</span><span class="sxs-lookup"><span data-stu-id="96b0b-107">Changes may include new or changed schema, new or changed reference data, and routine database maintenance tasks tooensure optimal app performance.</span></span> <span data-ttu-id="96b0b-108">В приложениях SaaS эти изменения должны toobe, развернутого в виде согласованных на потенциально больших флот баз данных клиента.</span><span class="sxs-lookup"><span data-stu-id="96b0b-108">With a SaaS application, these changes need toobe deployed in a coordinated manner across a potentially massive fleet of tenant databases.</span></span> <span data-ttu-id="96b0b-109">Эти изменения toobe в будущем клиента базы данных, они должны toobe включены в процесс подготовки hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-109">For these changes toobe in future tenant databases, they need toobe incorporated into hello provisioning process.</span></span>

<span data-ttu-id="96b0b-110">Этот учебник рассматриваются два сценария - развертывания обновлений ссылку данных для всех клиентов и retuning индекса для hello таблицы содержат данные ссылок hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-110">This tutorial explores two scenarios - deploying reference data updates for all tenants, and retuning an index on hello table containing hello reference data.</span></span> <span data-ttu-id="96b0b-111">Hello [эластичной задания](sql-database-elastic-jobs-overview.md) компонент является используется tooexecute эти операции для всех клиентов и hello *золотой* базы данных клиента, используемый в качестве шаблона для новых баз данных.</span><span class="sxs-lookup"><span data-stu-id="96b0b-111">hello [Elastic jobs](sql-database-elastic-jobs-overview.md) feature is used tooexecute these operations across all tenants, and hello *golden* tenant database that is used as a template for new databases.</span></span>

<span data-ttu-id="96b0b-112">Из этого руководства вы узнаете, как выполнить следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="96b0b-112">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="96b0b-113">Создание учетной записи заданий.</span><span class="sxs-lookup"><span data-stu-id="96b0b-113">Create a job account</span></span>
> * <span data-ttu-id="96b0b-114">Выполнение запроса к нескольким клиентам.</span><span class="sxs-lookup"><span data-stu-id="96b0b-114">Query across multiple tenants</span></span>
> * <span data-ttu-id="96b0b-115">Обновление данных во всех клиентских базах данных.</span><span class="sxs-lookup"><span data-stu-id="96b0b-115">Update data in all tenant databases</span></span>
> * <span data-ttu-id="96b0b-116">Создание индекса для таблицы во всех базах данных клиента.</span><span class="sxs-lookup"><span data-stu-id="96b0b-116">Create an index on a table in all tenant databases</span></span>


<span data-ttu-id="96b0b-117">toocomplete этого учебника, убедитесь, что hello следующие необходимые условия выполнены:</span><span class="sxs-lookup"><span data-stu-id="96b0b-117">toocomplete this tutorial, make sure hello following prerequisites are met:</span></span>

* <span data-ttu-id="96b0b-118">приложение Wingtip SaaS Hello развертывается.</span><span class="sxs-lookup"><span data-stu-id="96b0b-118">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="96b0b-119">toodeploy менее чем за пять минут. в разделе [развертывание и просмотр приложения Wingtip SaaS hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="96b0b-119">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="96b0b-120">Установите Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="96b0b-120">Azure PowerShell is installed.</span></span> <span data-ttu-id="96b0b-121">Дополнительные сведения см. в статье [Начало работы с Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="96b0b-121">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>
* <span data-ttu-id="96b0b-122">будет установлена последняя версия Hello объекта SQL Server Management Studio (SSMS).</span><span class="sxs-lookup"><span data-stu-id="96b0b-122">hello latest version of SQL Server Management Studio (SSMS) is installed.</span></span> <span data-ttu-id="96b0b-123">[Download SQL Server Management Studio (SSMS)](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms) (Скачивание SQL Server Management Studio (SSMS))</span><span class="sxs-lookup"><span data-stu-id="96b0b-123">[Download and Install SSMS](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms)</span></span>

<span data-ttu-id="96b0b-124">*В этом учебнике используется компоненты hello служба базы данных SQL, которые находятся в ограниченной предварительной версии (заданий эластичных баз данных). Если вы хотите toodo этого учебника, укажите идентификатор своей подписки tooSaaSFeedback@microsoft.com с темой = предварительной версией гибкого заданий. После получения подтверждения, что подписки была включена, [загрузить и установить новые командлеты заданий предварительного выпуска hello](https://github.com/jaredmoo/azure-powershell/releases). Это ограниченная предварительная версия, поэтому вы можете задать вопросы и получить поддержку, написав по адресу SaaSFeedback@microsoft.com.*</span><span class="sxs-lookup"><span data-stu-id="96b0b-124">*This tutorial uses features of hello SQL Database service that are in a limited preview (Elastic Database jobs). If you wish toodo this tutorial, provide your subscription id tooSaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install hello latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>


## <a name="introduction-toosaas-schema-management-patterns"></a><span data-ttu-id="96b0b-125">Введение tooSaaS управление схемой шаблонов</span><span class="sxs-lookup"><span data-stu-id="96b0b-125">Introduction tooSaaS Schema Management patterns</span></span>

<span data-ttu-id="96b0b-126">Hello каждой базы данных для одного клиента SaaS шаблона преимущества во многом от изоляции данных hello, полученный, но в hello одновременно возникают hello дополнительную сложность, обслуживание и управление много баз данных.</span><span class="sxs-lookup"><span data-stu-id="96b0b-126">hello single tenant per database SaaS pattern benefits in many ways from hello data isolation that results, but at hello same time introduces hello additional complexity of maintaining and managing many databases.</span></span> <span data-ttu-id="96b0b-127">[Эластичный задания](sql-database-elastic-jobs-overview.md) облегчает Администрирование и управление hello уровня данных SQL.</span><span class="sxs-lookup"><span data-stu-id="96b0b-127">[Elastic Jobs](sql-database-elastic-jobs-overview.md) facilitates administration and management of hello SQL data tier.</span></span> <span data-ttu-id="96b0b-128">Задания позволяют toosecurely и надежно и выполнения задач (сценарии T-SQL) независимо от взаимодействия с пользователем или входные данные, для группы баз данных.</span><span class="sxs-lookup"><span data-stu-id="96b0b-128">Jobs enable you toosecurely and reliably, run tasks (T-SQL scripts) independent of user interaction or input, against a group of databases.</span></span> <span data-ttu-id="96b0b-129">Этот метод можно использовать toodeploy схемы и общих изменений в ссылочных данных распределяются по всем клиентам в приложении.</span><span class="sxs-lookup"><span data-stu-id="96b0b-129">This method can be used toodeploy schema and common reference data changes across all tenants in an application.</span></span> <span data-ttu-id="96b0b-130">Эластичный задания могут быть также используется toomaintain *золотой* использует копию базы данных hello toocreate новых клиентов, гарантируя тем самым, он всегда hello последнюю схему и ссылочных данных.</span><span class="sxs-lookup"><span data-stu-id="96b0b-130">Elastic Jobs can also be used toomaintain a *golden* copy of hello database used toocreate new tenants, ensuring it always has hello latest schema and reference data.</span></span>

![экран](media/sql-database-saas-tutorial-schema-management/schema-management.png)


## <a name="elastic-jobs-limited-preview"></a><span data-ttu-id="96b0b-132">Ограниченная предварительная версия заданий обработки эластичных БД</span><span class="sxs-lookup"><span data-stu-id="96b0b-132">Elastic Jobs limited preview</span></span>

<span data-ttu-id="96b0b-133">Существует новая версия заданий обработки эластичных БД, которая является интегрированным компонентом баз данных SQL и не требует дополнительных служб или компонентов.</span><span class="sxs-lookup"><span data-stu-id="96b0b-133">There is a new version of Elastic Jobs that is now an integrated feature of Azure SQL Database (that requires no additional services or components).</span></span> <span data-ttu-id="96b0b-134">Сейчас новая версия заданий обработки эластичных БД находится на этапе ограниченной предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="96b0b-134">This new version of Elastic Jobs is currently in limited preview.</span></span> <span data-ttu-id="96b0b-135">В настоящее время это ограниченная Предварительная версия поддерживает учетные записи задания toocreate PowerShell и toocreate T-SQL и управления заданиями.</span><span class="sxs-lookup"><span data-stu-id="96b0b-135">This limited preview currently supports PowerShell toocreate job accounts, and T-SQL toocreate and manage jobs.</span></span>

> [!NOTE]
> <span data-ttu-id="96b0b-136">*В этом учебнике используется компоненты hello служба базы данных SQL, которые находятся в ограниченной предварительной версии (заданий эластичных баз данных). Если вы хотите toodo этого учебника, укажите идентификатор своей подписки tooSaaSFeedback@microsoft.com с темой = предварительной версией гибкого заданий. После получения подтверждения, что подписки была включена, [загрузить и установить новые командлеты заданий предварительного выпуска hello](https://github.com/jaredmoo/azure-powershell/releases). Это ограниченная предварительная версия, поэтому вы можете задать вопросы и получить поддержку, написав по адресу SaaSFeedback@microsoft.com.*</span><span class="sxs-lookup"><span data-stu-id="96b0b-136">*This tutorial uses features of hello SQL Database service that are in a limited preview (Elastic Database jobs). If you wish toodo this tutorial, provide your subscription id tooSaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install hello latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>

## <a name="get-hello-wingtip-application-scripts"></a><span data-ttu-id="96b0b-137">Получение скриптов приложения Wingtip hello</span><span class="sxs-lookup"><span data-stu-id="96b0b-137">Get hello Wingtip application scripts</span></span>

<span data-ttu-id="96b0b-138">Hello Wingtip SaaS скриптов и исходный код приложения были доступны в hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) в репозитории github.</span><span class="sxs-lookup"><span data-stu-id="96b0b-138">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="96b0b-139">[Действия скриптов Wingtip SaaS hello toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="96b0b-139">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="create-a-job-account-database-and-new-job-account"></a><span data-ttu-id="96b0b-140">Создание базы данных учетных записей заданий и учетной записи задания</span><span class="sxs-lookup"><span data-stu-id="96b0b-140">Create a job account database and new job account</span></span>

<span data-ttu-id="96b0b-141">Этот учебник требуется использовать PowerShell toocreate hello Задание учетной записи базы данных и задание учетной записи.</span><span class="sxs-lookup"><span data-stu-id="96b0b-141">This tutorial requires you use PowerShell toocreate hello job account database and job account.</span></span> <span data-ttu-id="96b0b-142">Как в базе данных MSDB и агента SQL Server использует эластичной заданий Azure SQL базы данных, toostore определения заданий, состояние задания и журнал.</span><span class="sxs-lookup"><span data-stu-id="96b0b-142">Like MSDB and SQL Agent, Elastic Jobs uses an Azure SQL database toostore job definitions, job status, and history.</span></span> <span data-ttu-id="96b0b-143">После создания учетной записи hello задания можно создавать и отслеживать задания немедленно.</span><span class="sxs-lookup"><span data-stu-id="96b0b-143">Once hello job account is created, you can create and monitor jobs immediately.</span></span>

1. <span data-ttu-id="96b0b-144">Открыть... \\Модулей обучения\\управление схемой\\*Демонстрация SchemaManagement.ps1* в hello **интегрированной среды Сценариев PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="96b0b-144">Open …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* in hello **PowerShell ISE**.</span></span>
1. <span data-ttu-id="96b0b-145">Нажмите клавишу **F5** toorun hello скрипта.</span><span class="sxs-lookup"><span data-stu-id="96b0b-145">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="96b0b-146">Hello *Демонстрация SchemaManagement.ps1* hello вызовов сценария *развернуть SchemaManagement.ps1* скрипт toocreate *S2* базы данных с именем **jobaccount** на сервере каталога hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-146">hello *Demo-SchemaManagement.ps1* script calls hello *Deploy-SchemaManagement.ps1* script toocreate an *S2* database named **jobaccount** on hello catalog server.</span></span> <span data-ttu-id="96b0b-147">Затем он создает задание учетной записи hello, передача базы данных jobaccount hello как вызов создания toohello задания параметров учетной записи.</span><span class="sxs-lookup"><span data-stu-id="96b0b-147">It then creates hello job account, passing hello jobaccount database as a parameter toohello job account creation call.</span></span>

## <a name="create-a-job-toodeploy-new-reference-data-tooall-tenants"></a><span data-ttu-id="96b0b-148">Создать задание toodeploy новых ссылку данных tooall клиентов</span><span class="sxs-lookup"><span data-stu-id="96b0b-148">Create a job toodeploy new reference data tooall tenants</span></span>

<span data-ttu-id="96b0b-149">Каждая база данных клиента включает набор проведения типы, определяющие тип события, которые размещаются на место проведения hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-149">Each tenant database includes a set of venue types that define hello kind of events that are hosted at a venue.</span></span> <span data-ttu-id="96b0b-150">В этом упражнении вы развертывать обновления tooall hello клиента баз данных tooadd два дополнительных проведения типов: *мотоцикла трассировки* и *сообщество бассейне*.</span><span class="sxs-lookup"><span data-stu-id="96b0b-150">In this exercise, you deploy an update tooall hello tenant databases tooadd two additional venue types: *Motorcycle Racing* and *Swimming Club*.</span></span> <span data-ttu-id="96b0b-151">Эти типы проведения соответствуют toohello фонового изображения, отображаемые в приложении события hello клиента.</span><span class="sxs-lookup"><span data-stu-id="96b0b-151">These venue types correspond toohello background image you see in hello tenant events app.</span></span>

<span data-ttu-id="96b0b-152">Нажмите кнопку раскрывающегося меню типа проведения hello и проверить, что только 10 проведения тип доступны и в частности, «Мотоцикла трассировки» и «Бассейне сообщество» не включаются в список hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-152">Click hello Venue Type drop down menu and validate that only 10 venue type options are available, and specifically that ‘Motorcycle Racing’ and ‘Swimming Club’ are not included in hello list.</span></span>

<span data-ttu-id="96b0b-153">Теперь давайте создадим hello задания tooupdate *VenueTypes* во всех базах данных клиента hello и добавить новые типы проведения hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-153">Now let’s create a job tooupdate hello *VenueTypes* table in all hello tenant databases and add hello new venue types.</span></span>

<span data-ttu-id="96b0b-154">toocreate новое задание, мы используем набор заданий системные хранимые процедуры, созданные в базе данных jobaccount hello при создании учетной записи задания hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-154">toocreate a new job, we use a set of jobs system stored procedures created in hello jobaccount database when hello job account was created.</span></span>

1. <span data-ttu-id="96b0b-155">Откройте SSMS и подключите сервер каталога toohello: каталог -\<пользователя\>. database.windows.net сервера</span><span class="sxs-lookup"><span data-stu-id="96b0b-155">Open SSMS and connect toohello catalog server: catalog-\<user\>.database.windows.net server</span></span>
1. <span data-ttu-id="96b0b-156">Также подключения сервера клиента toohello: tenants1 -\<пользователя\>. database.windows.net</span><span class="sxs-lookup"><span data-stu-id="96b0b-156">Also connect toohello tenant server: tenants1-\<user\>.database.windows.net</span></span>
1. <span data-ttu-id="96b0b-157">Обзор toohello *contosoconcerthall* базы данных на hello *tenants1* сервера и запрос hello *VenueTypes* tooconfirm таблицы, *мотоцикла трассировки*  и *сообщество бассейне* **не** в списке результатов hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-157">Browse toohello *contosoconcerthall* database on hello *tenants1* server and query hello *VenueTypes* table tooconfirm that *Motorcycle Racing* and *Swimming Club* **are not** in hello results list.</span></span>
1. <span data-ttu-id="96b0b-158">Привет открыть файл... \\Модулях обучения\\управление схемой\\DeployReferenceData.sql</span><span class="sxs-lookup"><span data-stu-id="96b0b-158">Open hello file …\\Learning Modules\\Schema Management\\DeployReferenceData.sql</span></span>
1. <span data-ttu-id="96b0b-159">Измените инструкцию hello: ЗАДАТЬ @wtpUser = &lt;пользователя&gt; и замените значение hello пользователя, используемое при развертывании приложения Wingtip hello</span><span class="sxs-lookup"><span data-stu-id="96b0b-159">Modify hello statement: SET @wtpUser = &lt;user&gt; and substitute hello User value used when you deployed hello Wingtip app</span></span>
1. <span data-ttu-id="96b0b-160">Убедитесь, база данных jobaccount подключенных toohello и нажмите клавишу **F5** для выполнения сценария hello</span><span class="sxs-lookup"><span data-stu-id="96b0b-160">Ensure you are connected toohello jobaccount database and press **F5** to run hello script</span></span>

* <span data-ttu-id="96b0b-161">**SP\_добавить\_целевой\_группы** создает имя целевой группы hello DemoServerGroup, теперь мы должны tooadd целевые элементы.</span><span class="sxs-lookup"><span data-stu-id="96b0b-161">**sp\_add\_target\_group** creates hello target group name DemoServerGroup, now we need tooadd target members.</span></span>
* <span data-ttu-id="96b0b-162">**SP\_добавить\_целевой\_группы\_член** добавляет *сервера* целевой тип члена, который рассматривается всех баз данных в пределах сервера (Обратите внимание, это hello tenants1-&lt; Пользователь&gt; сервер, содержащий базы данных клиента hello) во время задания выполнения должны быть включены в задание hello hello второй состоит в добавлении *базы данных* целевой тип члена, в частности Здравствуйте, «золотого» базы данных ( basetenantdb), находящийся в каталоге -&lt;пользователя&gt; server и наконец другой *базы данных* целевой группы член типа tooinclude hello adhocanalytics базы данных, используемый в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="96b0b-162">**sp\_add\_target\_group\_member** adds a *server* target member type, which deems all databases within that server (note this is hello tenants1-&lt;User&gt; server containing hello tenant databases) at time of job execution should be included in hello job, hello second is adding a *database* target member type, specifically hello ‘golden’ database (basetenantdb) that resides on catalog-&lt;User&gt; server, and lastly another *database* target group member type tooinclude hello adhocanalytics database that is used in a later tutorial.</span></span>
* <span data-ttu-id="96b0b-163">**sp\_add\_job** — создает задание с названием "Развертывание справочных данных".</span><span class="sxs-lookup"><span data-stu-id="96b0b-163">**sp\_add\_job** creates a job called “Reference Data Deployment”</span></span>
* <span data-ttu-id="96b0b-164">**SP\_добавить\_шага задания** создает шаг задания hello, содержащий T-SQL текст tooupdate hello ссылку таблицы команд, VenueTypes</span><span class="sxs-lookup"><span data-stu-id="96b0b-164">**sp\_add\_jobstep** creates hello job step containing T-SQL command text tooupdate hello reference table, VenueTypes</span></span>
* <span data-ttu-id="96b0b-165">Оставшиеся представления Hello в скрипте hello отображают существование hello hello объектов и монитор выполнения задания.</span><span class="sxs-lookup"><span data-stu-id="96b0b-165">hello remaining views in hello script display hello existence of hello objects and monitor job execution.</span></span> <span data-ttu-id="96b0b-166">Используйте эти значения состояния hello tooreview запросы в hello **жизненного цикла** toodetermine столбца по завершении задания hello успешно для всех баз данных клиента и hello два дополнительных баз данных, содержащих hello ссылочной таблицы.</span><span class="sxs-lookup"><span data-stu-id="96b0b-166">Use these queries tooreview hello status value in hello **lifecycle** column toodetermine when hello job has successfully finished on all tenant databases and hello two additional databases containing hello reference table.</span></span>

1. <span data-ttu-id="96b0b-167">В SSMS, найдите toohello *contosoconcerthall* базы данных на hello *tenants1* сервера и запрос hello *VenueTypes* tooconfirm таблицы, *мотоцикла Трассировки* и *сообщество бассейне* **,** теперь в списке результатов hello.</span><span class="sxs-lookup"><span data-stu-id="96b0b-167">In SSMS, browse toohello *contosoconcerthall* database on hello *tenants1* server and query hello *VenueTypes* table tooconfirm that *Motorcycle Racing* and *Swimming Club* **are** now in hello results list.</span></span>


## <a name="create-a-job-toomanage-hello-reference-table-index"></a><span data-ttu-id="96b0b-168">Создание индекса таблицы toomanage hello задания ссылка</span><span class="sxs-lookup"><span data-stu-id="96b0b-168">Create a job toomanage hello reference table index</span></span>

<span data-ttu-id="96b0b-169">Аналогичные toohello предыдущее упражнение, в этом упражнении создается индекс hello toorebuild задания на первичный ключ таблицы ссылок hello, операция управления обычной базой данных администратор может выполняться после загрузки больших объемов данных в таблицу.</span><span class="sxs-lookup"><span data-stu-id="96b0b-169">Similar toohello previous exercise, this exercise creates a job toorebuild hello index on hello reference table primary key, a typical database management operation an administrator might perform after a large data load into a table.</span></span>

<span data-ttu-id="96b0b-170">Создание задания с помощью hello же заданий «система» хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="96b0b-170">Create a job using hello same jobs 'system' stored procedures.</span></span>

1. <span data-ttu-id="96b0b-171">Откройте SSMS и подключите каталог toohello -&lt;пользователя&gt;. database.windows.net сервера</span><span class="sxs-lookup"><span data-stu-id="96b0b-171">Open SSMS and connect toohello catalog-&lt;User&gt;.database.windows.net server</span></span>
1. <span data-ttu-id="96b0b-172">Привет открыть файл... \\Модулях обучения\\управление схемой\\OnlineReindex.sql</span><span class="sxs-lookup"><span data-stu-id="96b0b-172">Open hello file …\\Learning Modules\\Schema Management\\OnlineReindex.sql</span></span>
1. <span data-ttu-id="96b0b-173">Щелкните правой кнопкой мыши, выберите соединение и подключения toohello каталога -&lt;пользователя&gt;. database.windows.net сервер, если еще не подключены</span><span class="sxs-lookup"><span data-stu-id="96b0b-173">Right click, select Connection, and connect toohello catalog-&lt;User&gt;.database.windows.net server, if not already connected</span></span>
1. <span data-ttu-id="96b0b-174">Убедитесь, базы данных jobaccount подключенных toohello и нажмите клавишу F5 toorun hello сценария</span><span class="sxs-lookup"><span data-stu-id="96b0b-174">Ensure you are connected toohello jobaccount database and press F5 toorun hello script</span></span>

* <span data-ttu-id="96b0b-175">sp\_add\_job создает новое задание "Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885".</span><span class="sxs-lookup"><span data-stu-id="96b0b-175">sp\_add\_job creates a new job called “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”</span></span>
* <span data-ttu-id="96b0b-176">SP\_добавить\_шага задания создает шаг задания hello, содержащий индекс hello tooupdate текст команды T-SQL</span><span class="sxs-lookup"><span data-stu-id="96b0b-176">sp\_add\_jobstep creates hello job step containing T-SQL command text tooupdate hello index</span></span>




## <a name="next-steps"></a><span data-ttu-id="96b0b-177">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="96b0b-177">Next steps</span></span>

<span data-ttu-id="96b0b-178">Из этого руководства вы узнали, как выполнять такие задачи:</span><span class="sxs-lookup"><span data-stu-id="96b0b-178">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="96b0b-179">Создание учетной записи задания tooquery нескольких клиентов</span><span class="sxs-lookup"><span data-stu-id="96b0b-179">Create a job account tooquery across multiple tenants</span></span>
> * <span data-ttu-id="96b0b-180">Обновление данных во всех клиентских базах данных.</span><span class="sxs-lookup"><span data-stu-id="96b0b-180">Update data in all tenant databases</span></span>
> * <span data-ttu-id="96b0b-181">Создание индекса для таблицы во всех базах данных клиента.</span><span class="sxs-lookup"><span data-stu-id="96b0b-181">Create an index on a table in all tenant databases</span></span>

<span data-ttu-id="96b0b-182">[Ad-hoc analytics tutorial](sql-database-saas-tutorial-adhoc-analytics.md) (Руководство по аналитике Ad-hoc)</span><span class="sxs-lookup"><span data-stu-id="96b0b-182">[Ad-hoc analytics tutorial](sql-database-saas-tutorial-adhoc-analytics.md)</span></span>


## <a name="additional-resources"></a><span data-ttu-id="96b0b-183">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="96b0b-183">Additional resources</span></span>

* [<span data-ttu-id="96b0b-184">Дополнительные учебники, которые созданы на основе hello Wingtip SaaS развертывания приложения</span><span class="sxs-lookup"><span data-stu-id="96b0b-184">Additional tutorials that build upon hello Wingtip SaaS application deployment</span></span>](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)
* [<span data-ttu-id="96b0b-185">Управление масштабируемыми облачными базами данных</span><span class="sxs-lookup"><span data-stu-id="96b0b-185">Managing scaled-out cloud databases</span></span>](sql-database-elastic-jobs-overview.md)
* [<span data-ttu-id="96b0b-186">Создание развернутых баз данных SQL Azure и управление ими с помощью заданий обработки эластичных БД (предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="96b0b-186">Create and manage scaled-out cloud databases</span></span>](sql-database-elastic-jobs-create-and-manage.md)
