---
title: "Настройка Многофакторной идентификации для SQL Azure | Документация Майкрософт"
description: "Использование Многофакторной идентификации с SSMS для базы данных SQL и хранилища данных SQL."
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: 
tags: 
ms.assetid: 
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/17/2017
ms.author: rickbyh
ms.openlocfilehash: fd78b34e8bbefdaa79a73d69ff2a0e3c1c342e98
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="configure-multi-factor-authentication-for-sql-server-management-studio-and-azure-ad"></a><span data-ttu-id="7e433-103">Настройка Многофакторной идентификации для SQL Server Management Studio и Azure AD</span><span class="sxs-lookup"><span data-stu-id="7e433-103">Configure multi-factor authentication for SQL Server Management Studio and Azure AD</span></span>

<span data-ttu-id="7e433-104">В этом разделе показано, как настроить Многофакторную идентификацию (MFA) Azure Active Directory для SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="7e433-104">This topic shows you how to use Azure Active Directory multi-factor authentication (MFA) with SQL Server Management Studio.</span></span> <span data-ttu-id="7e433-105">Многофакторная идентификация Azure AD может использоваться при подключении SSMS или SqlPackage.exe к Базе данных SQL Azure и хранилищу данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="7e433-105">Azure AD MFA can be used when connecting SSMS or SqlPackage.exe to Azure SQL Database and Azure SQL Data Warehouse.</span></span>

<span data-ttu-id="7e433-106">Обзор Многофакторной идентификации базы данных SQL Azure приведен в разделе [Универсальная проверка подлинности для Базы данных SQL и хранилища данных SQL (поддержка SSMS для MFA)](sql-database-ssms-mfa-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-106">For an overview of Azure SQL Database multi-factor authentication, see [Universal Authentication with SQL Database and SQL Data Warehouse (SSMS support for MFA)](sql-database-ssms-mfa-authentication.md).</span></span>

## <a name="configuration-steps"></a><span data-ttu-id="7e433-107">Этапы настройки</span><span class="sxs-lookup"><span data-stu-id="7e433-107">Configuration steps</span></span>

1. <span data-ttu-id="7e433-108">**Настройка Azure Active Directory.** Дополнительные сведения см. в статьях [Управление каталогом Azure AD](https://msdn.microsoft.com/library/azure/hh967611.aspx), [Интеграция локальных удостоверений с Azure Active Directory](../active-directory/active-directory-aadconnect.md) и [AzureADHelp](https://msdn.microsoft.com/library/azure/jj151815.aspx) и записях блога [Add your own domain name to Azure AD](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/) (Добавление собственного имени домена в Azure AD) и [Microsoft Azure now supports federation with Windows Server Active Directory](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/) (Microsoft Azure теперь поддерживает федерацию с Windows Server Active Directory).</span><span class="sxs-lookup"><span data-stu-id="7e433-108">**Configure an Azure Active Directory** - For more information, see [Administering your Azure AD directory](https://msdn.microsoft.com/library/azure/hh967611.aspx), [Integrating your on-premises identities with Azure Active Directory](../active-directory/active-directory-aadconnect.md), [Add your own domain name to Azure AD](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/), [Microsoft Azure now supports federation with Windows Server Active Directory](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/), and [Manage Azure AD using Windows PowerShell](https://msdn.microsoft.com/library/azure/jj151815.aspx).</span></span>
2. <span data-ttu-id="7e433-109">**Настройка MFA.** Пошаговые инструкции см. в разделах [Что такое Azure Multi-factor Authentication?](../multi-factor-authentication/multi-factor-authentication.md) и [Условный доступ (MFA) и база данных SQL Azure и хранилище данных](sql-database-conditional-access.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-109">**Configure MFA** - For step-by-step instructions, see [What is Azure Multi-Factor Authentication?](../multi-factor-authentication/multi-factor-authentication.md), [Conditional Access (MFA) with Azure SQL Database and Data Warehouse](sql-database-conditional-access.md).</span></span> <span data-ttu-id="7e433-110">(Для полнофункционального условного доступа требуется Azure Active Directory (Azure AD) Premium.</span><span class="sxs-lookup"><span data-stu-id="7e433-110">(Full conditional access requires a Premium Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="7e433-111">Azure AD Standard обеспечивает ограниченные возможности MFA).</span><span class="sxs-lookup"><span data-stu-id="7e433-111">Limited MFA is available with a standard Azure AD.)</span></span>
3. <span data-ttu-id="7e433-112">**Настройка базы данных SQL или хранилища данных SQL для аутентификации Azure AD.** Пошаговые инструкции см. в статье [Подключение к базе данных SQL или хранилищу данных SQL c использованием проверки подлинности Azure Active Directory](sql-database-aad-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-112">**Configure SQL Database or SQL Data Warehouse for Azure AD Authentication** - For step-by-step instructions, see [Connecting to SQL Database or SQL Data Warehouse By Using Azure Active Directory Authentication](sql-database-aad-authentication.md).</span></span>
4. <span data-ttu-id="7e433-113">**Скачивание SSMS.** Скачайте последнюю версию SSMS на клиентский компьютер, воспользовавшись страницей [Скачивание SQL Server Management Studio (SSMS)](https://msdn.microsoft.com/library/mt238290.aspx).</span><span class="sxs-lookup"><span data-stu-id="7e433-113">**Download SSMS** - On the client computer, download the latest SSMS, from [Download SQL Server Management Studio (SSMS)](https://msdn.microsoft.com/library/mt238290.aspx).</span></span> <span data-ttu-id="7e433-114">Для всех функций в этом разделе используйте по крайней мере версию 17.2 за июль 2017 года.</span><span class="sxs-lookup"><span data-stu-id="7e433-114">For all the features in this topic, use at least July 2017, version 17.2.</span></span>  

## <a name="connecting-by-using-universal-authentication-with-ssms"></a><span data-ttu-id="7e433-115">Подключение с помощью универсальной аутентификации и SSMS</span><span class="sxs-lookup"><span data-stu-id="7e433-115">Connecting by using universal authentication with SSMS</span></span>

<span data-ttu-id="7e433-116">Приведенные ниже инструкции описывают, как подключиться к базе данных SQL или хранилищу данных SQL с помощью последней версии SSMS.</span><span class="sxs-lookup"><span data-stu-id="7e433-116">The following steps show how to connect to SQL Database or SQL Data Warehouse by using the latest SSMS.</span></span>

1. <span data-ttu-id="7e433-117">Чтобы подключиться с использованием универсальной аутентификации, в диалоговом окне **Соединение с сервером** выберите **Active Directory — универсальная с поддержкой MFA**.</span><span class="sxs-lookup"><span data-stu-id="7e433-117">To connect using Universal Authentication, on the **Connect to Server** dialog box, select **Active Directory - Universal with MFA support**.</span></span> <span data-ttu-id="7e433-118">(Если отображается параметр **Универсальная проверка подлинности Active Directory**, значит, у вас не самая последняя версия SSMS.)</span><span class="sxs-lookup"><span data-stu-id="7e433-118">(If you see **Active Directory Universal Authentication** you are not on the latest version of SSMS.)</span></span>  
   <span data-ttu-id="7e433-119">![1mfa-universal-connect][1]</span><span class="sxs-lookup"><span data-stu-id="7e433-119">![1mfa-universal-connect][1]</span></span>  
2. <span data-ttu-id="7e433-120">Заполните поле **Имя пользователя** учетными данными Azure Active Directory в формате `user_name@domain.com`.</span><span class="sxs-lookup"><span data-stu-id="7e433-120">Complete the **User name** box with the Azure Active Directory credentials, in the format `user_name@domain.com`.</span></span>  
   <span data-ttu-id="7e433-121">![1mfa-universal-connect-user](./media/sql-database-ssms-mfa-auth/1mfa-universal-connect-user.png)</span><span class="sxs-lookup"><span data-stu-id="7e433-121">![1mfa-universal-connect-user](./media/sql-database-ssms-mfa-auth/1mfa-universal-connect-user.png)</span></span>   
3. <span data-ttu-id="7e433-122">При подключении от имени гостевого пользователя необходимо нажать кнопку **Параметры** и в диалоговом окне **Свойства соединения** заполнить поле **Доменное имя AD или идентификатор клиента**.</span><span class="sxs-lookup"><span data-stu-id="7e433-122">If you are connecting as a guest user, you must click **Options**, and on the **Connection Property** dialog box, complete the **AD domain name or tenant ID** box.</span></span> <span data-ttu-id="7e433-123">Дополнительные сведения см. в разделе [Универсальная проверка подлинности для Базы данных SQL и хранилища данных SQL (поддержка SSMS для MFA)](sql-database-ssms-mfa-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-123">For more information, see [Universal Authentication with SQL Database and SQL Data Warehouse (SSMS support for MFA)](sql-database-ssms-mfa-authentication.md).</span></span>
   <span data-ttu-id="7e433-124">![mfa-tenant-ssms](./media/sql-database-ssms-mfa-auth/mfa-tenant-ssms.png)</span><span class="sxs-lookup"><span data-stu-id="7e433-124">![mfa-tenant-ssms](./media/sql-database-ssms-mfa-auth/mfa-tenant-ssms.png)</span></span>   
4. <span data-ttu-id="7e433-125">Как и для базы данных SQL и хранилища данных SQL, необходимо щелкнуть **Параметры** и указать базу данных в диалоговом окне **Параметры**.</span><span class="sxs-lookup"><span data-stu-id="7e433-125">As usual for SQL Database and SQL Data Warehouse, you must click **Options** and specify the database on the **Options** dialog box.</span></span> <span data-ttu-id="7e433-126">(Если подключенный пользователь является гостевым (т. е. joe@outlook.com), нужно установить флажок и добавить текущее доменное имя AD или идентификатор клиента как часть параметров.)</span><span class="sxs-lookup"><span data-stu-id="7e433-126">(If the connected user is a guest user ( i.e. joe@outlook.com), you must check the box and add the current AD domain name or tenant ID as part of Options.</span></span> <span data-ttu-id="7e433-127">Ознакомьтесь с разделом [Универсальная проверка подлинности для Базы данных SQL и хранилища данных SQL (поддержка SSMS для MFA)]()(sql-database-ssms-mfa-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-127">See [Universal Authentication with SQL Database and SQL Data Warehouse (SSMS support for MFA)]()(sql-database-ssms-mfa-authentication.md.</span></span> <span data-ttu-id="7e433-128">Щелкните **Подключить**.</span><span class="sxs-lookup"><span data-stu-id="7e433-128">Then click **Connect**.</span></span>  
5. <span data-ttu-id="7e433-129">Когда откроется диалоговое окно **Вход в учетную запись** , укажите учетную запись и пароль своего удостоверения Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7e433-129">When the **Sign in to your account** dialog box appears, provide the account and password of your Azure Active Directory identity.</span></span> <span data-ttu-id="7e433-130">Пароль не требуется, если пользователь является частью домена в федерации с Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7e433-130">No password is required if a user is part of a domain federated with Azure AD.</span></span>  
   <span data-ttu-id="7e433-131">![2mfa-sign-in][2]</span><span class="sxs-lookup"><span data-stu-id="7e433-131">![2mfa-sign-in][2]</span></span>  

   > [!NOTE]
   > <span data-ttu-id="7e433-132">Если для этой учетной записи не требуется MFA, то на этом этапе универсальной аутентификации устанавливается подключение.</span><span class="sxs-lookup"><span data-stu-id="7e433-132">For Universal Authentication with an account that does not require MFA, you connect at this point.</span></span> <span data-ttu-id="7e433-133">Пользователям, которым требуется MFA, следует выполнить приведенные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="7e433-133">For users requiring MFA, continue with the following steps:</span></span>
   >  
   
6. <span data-ttu-id="7e433-134">Могут отобразиться два диалоговых окна настройки MFA.</span><span class="sxs-lookup"><span data-stu-id="7e433-134">Two MFA setup dialog boxes might appear.</span></span> <span data-ttu-id="7e433-135">Эта одноразовая операция зависит от параметра администратора MFA, то есть может быть необязательной.</span><span class="sxs-lookup"><span data-stu-id="7e433-135">This one time operation depends on the MFA administrator setting, and therefore may be optional.</span></span> <span data-ttu-id="7e433-136">Для домена с поддержкой MFA этот шаг иногда бывает предварительно определен (например, домен требует от пользователя использовать смарт-карту и ПИН-код).</span><span class="sxs-lookup"><span data-stu-id="7e433-136">For an MFA enabled domain this step is sometimes pre-defined (for example, the domain requires users to use a smartcard and pin).</span></span>  
   ![3mfa-setup][3]  
7. <span data-ttu-id="7e433-138">В диалоговом окне второй одноразовой операции можно выбрать параметры метода аутентификации.</span><span class="sxs-lookup"><span data-stu-id="7e433-138">The second possible one time dialog box allows you to select the details of your authentication method.</span></span> <span data-ttu-id="7e433-139">Возможные параметры настраиваются администратором.</span><span class="sxs-lookup"><span data-stu-id="7e433-139">The possible options are configured by your administrator.</span></span>  
   ![4mfa-verify-1][4]  
8. <span data-ttu-id="7e433-141">Azure Active Directory отправляет вам информациею о подтверждении.</span><span class="sxs-lookup"><span data-stu-id="7e433-141">The Azure Active Directory sends the confirming information to you.</span></span> <span data-ttu-id="7e433-142">Получив код проверки, введите его в поле **Введите проверочный код** и нажмите кнопку **Вход**.</span><span class="sxs-lookup"><span data-stu-id="7e433-142">When you receive the verification code, enter it into the **Enter verification code** box, and click **Sign in**.</span></span>  
   <span data-ttu-id="7e433-143">![5mfa-verify-2][5]</span><span class="sxs-lookup"><span data-stu-id="7e433-143">![5mfa-verify-2][5]</span></span>  

<span data-ttu-id="7e433-144">Обычно по завершении проверки выполняется подключение SSMS при условии, что указаны действительные учетные данные и в брандмауэре разрешен доступ.</span><span class="sxs-lookup"><span data-stu-id="7e433-144">When verification is complete, SSMS connects normally presuming valid credentials and firewall access.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7e433-145">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="7e433-145">Next steps</span></span>

* <span data-ttu-id="7e433-146">Обзор Многофакторной идентификации базы данных SQL Azure приведен в разделе [Универсальная проверка подлинности для Базы данных SQL и хранилища данных SQL (поддержка SSMS для MFA)](sql-database-ssms-mfa-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-146">For an overview of Azure SQL Database multi-factor authentication, see Universal Authentication with [SQL Database and SQL Data Warehouse (SSMS support for MFA)](sql-database-ssms-mfa-authentication.md).</span></span>
* <span data-ttu-id="7e433-147">Предоставьте другим пользователям доступ к своей базе данных: [Проверка подлинности и авторизация в базе данных SQL: предоставление доступа](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-147">Grant others access to your database: [SQL Database Authentication and Authorization: Granting Access](sql-database-manage-logins.md)</span></span>  
<span data-ttu-id="7e433-148">Предоставьте другим пользователям возможность подключаться через брандмауэр: [Настройка правила брандмауэра уровня сервера базы данных SQL Azure с помощью портала Azure](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="7e433-148">Make sure others can connect through the firewall: [Configure an Azure SQL Database server-level firewall rule using the Azure portal](sql-database-configure-firewall-settings.md)</span></span>


[1]: ./media/sql-database-ssms-mfa-auth/1mfa-universal-connect.png
[2]: ./media/sql-database-ssms-mfa-auth/2mfa-sign-in.png
[3]: ./media/sql-database-ssms-mfa-auth/3mfa-setup.png
[4]: ./media/sql-database-ssms-mfa-auth/4mfa-verify-1.png
[5]: ./media/sql-database-ssms-mfa-auth/5mfa-verify-2.png

