---
title: "обновление приложения aaaRolling - базы данных SQL Azure | Документы Microsoft"
description: "Узнайте, как обновления документации toosupport toouse георепликации для базы данных SQL Azure облачные приложения."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 58f42859-1e37-463c-a3d8-a3ca2e867148
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 07/16/2016
ms.author: sashan
ms.openlocfilehash: 18c56300916d129bff141624cc5c416b500408d4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="managing-rolling-upgrades-of-cloud-applications-using-sql-database-active-geo-replication"></a>Управление последовательными обновлениями для облачных приложений с помощью активной георепликации базы данных SQL
> [!NOTE]
> [Активная георепликация](sql-database-geo-replication-overview.md) теперь доступна для всех баз данных и всех уровней.
> 

Узнайте, как toouse [георепликации](sql-database-geo-replication-overview.md) в базе данных SQL tooenable последовательных обновлений облачного приложения. Так как обновление представляет собой нарушающую работу операцию, оно должно учитываться при планировании и проектировании непрерывности бизнес-процессов. В этой статье мы рассмотрим два метода оркестрация hello процесса обновления и рассматриваются преимущества hello и преимущества и недостатки каждого варианта. Для целей hello данной статьи мы будем использовать простое приложение, которое состоит из веб-сайта подключенных tooa одну базу данных в качестве уровня данных. Наша цель — tooupgrade версии 1 tooversion приложения hello 2 без любой значительное влияние на взаимодействие с пользователем hello. 

При оценке hello параметры обновления необходимо учитывать следующие факторы hello.

* Влияние на доступность приложения во время обновления. Как долго функции приложения hello может ограничены или сниженной активности.
* Возможность tooroll обратно в случае сбоя обновления.
* Уязвимость приложения hello, если несвязанные авария происходит во время обновления hello.
* Общие денежные затраты.  Сюда входят дополнительная избыточность и добавочные затраты hello временные компоненты, используемые процессом обновления hello. 

## <a name="upgrading-applications-that-rely-on-database-backups-for-disaster-recovery"></a>Обновление приложений, полагающихся на резервные копии базы данных в случае аварийного восстановления
Если приложение зависит от резервных копий баз данных автоматически и использует географическое восстановление для аварийного восстановления, это обычно развернутой tooa один регион Azure. В этом случае процесс обновления hello включает в себя создание резервной копии развертывания всех компонентов приложения, участвующие в обновлении hello. toominimize hello перерывов в работе пользователей будет использовать диспетчер трафика Azure (WATM) с профилем hello отработки отказа.  Hello, следующая схема иллюстрирует процесс обновления предыдущих toohello операционной среде hello. Здравствуйте, конечная точка <i>contoso 1.azurewebsites.net</i> представляет производственный слот приложения hello, которое требуется обновить toobe. tooroll возможности hello tooenable обратно Здравствуйте обновление, необходимо создать слот рабочей области с полностью синхронизированной копии приложения hello. Hello следующие шаги, необходимые tooprepare hello приложения для обновления hello:

1. Создайте слот рабочей области для обновления hello. toodo, создание базы данных-получателя (1) и развертывание идентичные веб-сайта в hello же регионе Azure. Мониторинга получателей toosee hello, если hello заполнения процесс завершается.
2. Создайте профиль отработки отказа в WATM, используя <i>contoso-1.azurewebsites.net</i> в качестве работающей конечной точки и <i>contoso-2.azurewebsites.net</i> в качестве отключенной. 

> [!NOTE]
> Действия по подготовке hello Примечание не повлияет на приложение hello в производственный слот hello и он может работать в режиме полного доступа.
>  

![Настройка георепликации базы данных SQL. Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option1-1.png)

После завершения действия по подготовке hello приложения hello готова для hello фактического обновления. Следующая схема Hello приведены шаги hello в процессе обновления hello. 

1. Задать hello базы данных-источника в hello производственный слот tooread режиме (3). Это гарантирует, что hello экземпляр производственного приложения hello (V1) останется только для чтения во время обновления hello, предотвращая hello расхождение данных между hello V1 и V2 экземпляров баз данных.  
2. Отключите hello баз данных-получателей с помощью режима запланированное уничтожение hello (4). Она создаст полностью синхронизированных независимая копия базы данных-источника hello. Эта база данных будет обновлена.
3. Включение режима записи tooread hello базы данных-источника и запустите сценарий обновления hello в слоте этап hello (5).     

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option1-2.png)

При успешном завершении обновления hello вы находитесь hello готов tooswitch hello конечным пользователям toohello промежуточное хранение копии приложения. Теперь оно станет hello производственный слот приложения hello.  Это включает в себя несколько дополнительных действий, как показано на hello следующие схемы.

1. Переключение hello работающую конечную точку в профиль WATM hello слишком<i>contoso 2.azurewebsites.net</i>, какая версия toohello V2 точек hello веб-сайта (6). Превращается hello производственный слот с hello приложения V2 и трафика конечных пользователей hello направленной tooit.  
2. Если компоненты приложения hello V1 больше не нужна, можно безопасно удалите их (7).   

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option1-3.png)

Если hello процесс обновления завершается неудачно, например из-за ошибки tooan в сценарий обновления hello, слот этап hello считается скомпрометирован. tooroll резервное hello toohello до обновления состояния приложения вы просто восстановить приложение hello в hello производственный слот toofull доступа. Hello шаги показаны на следующей схеме hello.    

1. Режим hello базы данных копирования записи tooread (8). Это позволит восстановить hello полный V1 функционально в производственный слот hello.
2. Выполнить анализ основных причин hello и удалите компоненты скомпрометированы hello в слоте этап hello (9). 

На этом этапе приложение hello осуществляется в полном объеме и может повторяться hello этапы обновления.

> [!NOTE]
> Hello отката не требует изменений в профиль WATM, он уже точки слишком<i>contoso 1.azurewebsites.net</i> как hello активной конечной точки.
> 
> 

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option1-4.png)

ключ Hello **преимущества** этого параметра является можно обновить приложения в одном регионе с помощью набора простых шагов. стоимость в долларах Hello обновления hello, сравнительно мало. основной Hello **компромисс** —, при возникновении сбоя во время hello обновления hello toohello восстановления до обновления состояния для этого потребуется повторное развертывание приложения hello в другом регионе и восстановлении базы данных hello из резервное копирование с использованием геовосстановления. Этот процесс приведет к значительному простою.   

## <a name="upgrading-applications-that-rely-on-database-geo-replication-for-disaster-recovery"></a>Обновление приложений, полагающихся на геовосстановление базы данных в случае аварийного восстановления
Если приложение использует географическую репликацию для обеспечения непрерывности бизнеса, это развернутой tooat как минимум два разных регионах активное развертывание в основном регионе и резервный развертывания в регионе резервного копирования. В дополнение к этому toohello коэффициенты упоминалось ранее, hello процесса обновления необходимо гарантировать, что:

* приложение Hello остается защищенным от критическим сбоям постоянно во время обновления hello
* обновления компонентов географически избыточная Hello приложения hello параллельно с компонентами active hello

tooachieve этих целей, будет использовать диспетчер трафика Azure (WATM) с помощью отработки отказа hello профиль с одно активное и три резервных конечных точек.  Hello, следующая схема иллюстрирует процесс обновления предыдущих toohello операционной среде hello. Здравствуйте, веб-сайтов <i>contoso 1.azurewebsites.net</i> и <i>contoso dr.azurewebsites.net</i> представляют производственный слот приложения hello с полной географическую избыточность. tooroll возможности hello tooenable обратно Здравствуйте обновление, необходимо создать слот рабочей области с полностью синхронизированной копии приложения hello. Поскольку потребуются tooensure, приложение hello быстро можно восстановить на случай сбоя во время обновления hello слот hello рабочей области должен toobe географически избыточная также. Hello следующие шаги, необходимые tooprepare hello приложения для обновления hello:

1. Создайте слот рабочей области для обновления hello. toodo, создание базы данных-получателя (1) и развертывание идентичную копию hello веб-сайта в hello же регионе Azure. Мониторинга получателей toosee hello, если hello заполнения процесс завершается.
2. Создание географически избыточной базы данных-получателя в слоте этап hello, копируя geo hello баз данных-получателей toohello резервного копирования области (называется «связанные георепликации»). Мониторинг резервного копирования вторичной toosee hello hello заполнения процесса в случае завершенного (3).
3. Создайте резервной копии hello веб-сайта в области резервного копирования hello и связать его toohello географически избыточная получателя (4).  
4. Добавить дополнительные конечные точки hello <i>contoso 2.azurewebsites.net</i> и <i>contoso 3.azurewebsites.net</i> toohello профиля отработки отказа в WATM как автономные конечные точки (5). 

> [!NOTE]
> Действия по подготовке hello Примечание не повлияет на приложение hello в производственный слот hello и он может работать в режиме полного доступа.
> 
> 

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option2-1.png)

После завершения действия по подготовке hello слот этап hello готовое к обновлению hello. Привет, следующая схема иллюстрирует hello этапы обновления.

1. Задать hello базы данных-источника в hello производственный слот tooread режиме (6). Это гарантирует, что hello экземпляр производственного приложения hello (V1) останется только для чтения во время обновления hello, предотвращая hello расхождение данных между hello V1 и V2 экземпляров баз данных.  
2. Отключение базы данных-получателя hello hello же региона с помощью hello запланированное уничтожение режим (7). Она создаст полностью синхронизированных независимая копия hello базы данных-источника, который автоматически станет основной после прекращения hello. Эта база данных будет обновлена.
3. Включить hello базы данных-источника в режиме записи tooread слот этап hello и запустите сценарий обновления hello (8).    

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option2-2.png)

Если hello обновление успешно завершено теперь не готов tooswitch конечным пользователям hello toohello V2 версии приложения hello. Следующая схема Hello приведены шаги hello.

1. Переключение hello активную конечную точку в профиль WATM hello слишком<i>contoso 2.azurewebsites.net</i>, которой теперь указывает версию toohello V2 hello веб-сайта (9). Она превращается в слоте продукции с hello приложения V2 и конечным пользователем трафика направленной tooit. 
2. Если приложение hello V1 больше не нужна, можно безопасно удалите (10 и 11).  

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option2-3.png)

Если hello процесс обновления завершается неудачно, например из-за ошибки tooan в сценарий обновления hello, слот этап hello считается скомпрометирован. tooroll резервное hello toohello до обновления состояния приложения можно просто восстановить приложение hello toousing в производственный слот hello с полным доступом. Hello шаги показаны на следующей схеме hello.    

1. Набор hello копии базы данных-источника в рабочем слоте hello tooread записи режиме (12). Это позволит восстановить hello полный V1 функционально в производственный слот hello.
2. Выполнить анализ основных причин hello и удалите компоненты скомпрометированы hello в слоте этап hello (13 и 14). 

На этом этапе приложение hello осуществляется в полном объеме и может повторяться hello этапы обновления.

> [!NOTE]
> Hello отката не требует изменений в профиль WATM, он уже точки слишком <i>contoso 1.azurewebsites.net</i> как hello активной конечной точки.
> 
> 

![Настройка георепликации базы данных SQL Аварийное восстановление облака.](media/sql-database-manage-application-rolling-upgrade/Option2-4.png)

ключ Hello **преимущества** этого параметра — без ущерба для вашего непрерывность бизнес-процессов во время обновления hello можно обновить приложения hello и ее географически избыточной копии в параллельном режиме. основной Hello **компромисс** — оно требует двойной избыточности каждого компонента приложения и поэтому влечет за собой выше стоимость в долларах. Кроме того, этот вариант подразумевает более сложный рабочий процесс. 

## <a name="summary"></a>Сводка
методы Hello два обновления, описанные в статье hello отличаются по сложности и hello доллара затрат, но они оба сосредоточиться на минимизация hello время, когда конечный пользователь hello ограниченный tooread операций. Это время определяется непосредственно hello длительность hello скрипта обновления. Он не зависит от размера базы данных hello, уровня службы hello, вы выбрали, Настройка веб-сайтов hello и другие факторы, которые невозможно легко управлять. Это потому, что все действия по подготовке hello связаны с этапы обновления hello и может выполняться без ущерба для производственного приложения hello. эффективность Hello hello сценария обновления является ключевым фактором hello, определяющую hello взаимодействие с пользователем во время обновления. Поэтому hello его можно увеличить рекомендуется сосредоточиться на создании скрипта обновления hello максимально эффективные усилий.  

## <a name="next-steps"></a>Дальнейшие действия
* Сведения об обеспечении непрерывности бизнес-процессов и возможные сценарии описаны в [обзоре непрерывности бизнес-процессов](sql-database-business-continuity.md).
* toolearn о резервных копиях автоматических базы данных SQL Azure, в разделе [базы данных SQL автоматическое резервное копирование](sql-database-automated-backups.md).
* toolearn об использовании автоматического создания резервных копий для восстановления, в разделе [восстановить базу данных из автоматических архивов](sql-database-recovery-using-backups.md).
* toolearn о быстрее параметры восстановления, в разделе [активной георепликации](sql-database-geo-replication-overview.md).


