---
title: "Обзор эластичной запросов базы данных SQL aaaAzure | Документы Microsoft"
description: "Общие сведения о возможности эластичного запроса hello"
services: sql-database
documentationcenter: 
manager: jhubbard
author: MladjoA
ms.assetid: a8bf0e2c-bc74-44d0-9b1e-bcc9a6aa2e33
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/27/2016
ms.author: mlandzic
ms.openlocfilehash: db17f551882cfcae0da67fdda12708baeb6db81c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-sql-database-elastic-query-overview-preview"></a><span data-ttu-id="7475f-103">Обзор эластичных запросов к базе данных SQL Azure (предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="7475f-103">Azure SQL Database elastic query overview (preview)</span></span>
<span data-ttu-id="7475f-104">функция эластичной запроса Hello (в предварительной версии) позволяет toorun запрос Transact-SQL, которая охватывает несколько баз данных в базе данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="7475f-104">hello elastic query feature (in preview) enables you toorun a Transact-SQL query that spans multiple databases in Azure SQL Database.</span></span> <span data-ttu-id="7475f-105">Оно позволяет tooperform межбазовые запросы tooaccess удаленных таблиц и tooquery tooconnect Майкрософт и сторонние средства (Excel, PowerBI, Tableau, т. д.) по уровням данных с несколькими базами данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-105">It allows you tooperform cross-database queries tooaccess remote tables, and tooconnect Microsoft and third party tools (Excel, PowerBI, Tableau, etc.) tooquery across data tiers with multiple databases.</span></span> <span data-ttu-id="7475f-106">Используя эту возможность, можно масштабировать уровни данных toolarge запросы в базе данных SQL и визуализировать результаты hello в отчетов бизнес-аналитики (BI).</span><span class="sxs-lookup"><span data-stu-id="7475f-106">Using this feature, you can scale out queries toolarge data tiers in SQL Database and visualize hello results in business intelligence (BI) reports.</span></span>


## <a name="why-use-elastic-queries"></a><span data-ttu-id="7475f-107">Почему рекомендуется использовать эластичные запросы?</span><span class="sxs-lookup"><span data-stu-id="7475f-107">Why use elastic queries?</span></span>

<span data-ttu-id="7475f-108">**база данных SQL Azure;**</span><span class="sxs-lookup"><span data-stu-id="7475f-108">**Azure SQL Database**</span></span>

<span data-ttu-id="7475f-109">Выполняйте запросы к нескольким базам данных SQL Azure только в T-SQL.</span><span class="sxs-lookup"><span data-stu-id="7475f-109">Query across Azure SQL databases completely in T-SQL.</span></span> <span data-ttu-id="7475f-110">Это позволяет отправлять в удаленные базы данных запросы только для чтения.</span><span class="sxs-lookup"><span data-stu-id="7475f-110">This allows for read-only querying of remote databases.</span></span> <span data-ttu-id="7475f-111">Это позволяет для текущей локальной приложений toomigrate клиентов SQL Server, с помощью трех и четырех частей имен или tooSQL связанного сервера базы данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-111">This provides an option for current on-premises SQL Server customers toomigrate applications using three- and four-part names or linked server tooSQL DB.</span></span>

<span data-ttu-id="7475f-112">**Доступность на уровне "Стандартный"**</span><span class="sxs-lookup"><span data-stu-id="7475f-112">**Available on standard tier**</span></span>

<span data-ttu-id="7475f-113">Эластичный запросов поддерживается на уровне Standard производительности hello в уровень производительности Premium toohello сложения.</span><span class="sxs-lookup"><span data-stu-id="7475f-113">Elastic query is supported on hello Standard performance tier in addition toohello Premium performance tier.</span></span> <span data-ttu-id="7475f-114">В разделе hello на ограничения предварительной версии, приведенные на ограничения производительности для уровней ниже производительности.</span><span class="sxs-lookup"><span data-stu-id="7475f-114">See hello section on Preview Limitations below on performance limitations for lower performance tiers.</span></span>

<span data-ttu-id="7475f-115">**Принудительная tooremote баз данных**</span><span class="sxs-lookup"><span data-stu-id="7475f-115">**Push tooremote databases**</span></span>

<span data-ttu-id="7475f-116">Эластичный запросы теперь можно передать параметры toohello удаленной базы данных SQL для выполнения.</span><span class="sxs-lookup"><span data-stu-id="7475f-116">Elastic queries can now push SQL parameters toohello remote databases for execution.</span></span>

<span data-ttu-id="7475f-117">**Выполнение хранимой процедуры**</span><span class="sxs-lookup"><span data-stu-id="7475f-117">**Stored procedure execution**</span></span>

<span data-ttu-id="7475f-118">Выполнить вызовы удаленных хранимых процедур или удаленных функций можно с помощью процедуры [sp\_execute\_remote](https://msdn.microsoft.com/library/mt703714).</span><span class="sxs-lookup"><span data-stu-id="7475f-118">Execute remote stored procedure calls or remote functions using [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714).</span></span>

<span data-ttu-id="7475f-119">**Гибкость**</span><span class="sxs-lookup"><span data-stu-id="7475f-119">**Flexibility**</span></span>

<span data-ttu-id="7475f-120">Внешних таблиц, эластичной запроса теперь можно ссылаться tooremote таблиц с разными схемами или имя таблицы.</span><span class="sxs-lookup"><span data-stu-id="7475f-120">External tables with elastic query can now refer tooremote tables with a different schema or table name.</span></span>

## <a name="elastic-query-scenarios"></a><span data-ttu-id="7475f-121">Сценарии применения эластичных запросов</span><span class="sxs-lookup"><span data-stu-id="7475f-121">Elastic query scenarios</span></span>

<span data-ttu-id="7475f-122">Задача Hello — toofacilitate запросов в сценариях, где несколько баз данных участие строк в общий результат.</span><span class="sxs-lookup"><span data-stu-id="7475f-122">hello goal is toofacilitate querying scenarios where multiple databases contribute rows into a single overall result.</span></span> <span data-ttu-id="7475f-123">Hello запрос можно либо создавать hello пользователем или приложением напрямую или косвенно через средства, которые toohello подключенной базы данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-123">hello query can either be composed by hello user or application directly, or indirectly through tools that are connected toohello database.</span></span> <span data-ttu-id="7475f-124">Это особенно полезно при создании отчетов с помощью коммерческих средств бизнес-аналитики, интеграции данных или любого приложения, которое нельзя изменить.</span><span class="sxs-lookup"><span data-stu-id="7475f-124">This is especially useful when creating reports, using commercial BI or data integration tools—or any application that cannot be changed.</span></span> <span data-ttu-id="7475f-125">С помощью эластичных запроса можно выполнять запросы между несколькими базами данных с помощью hello знакомый интерфейс подключения к SQL Server в средствах, например Excel, PowerBI, Tableau или Cognos.</span><span class="sxs-lookup"><span data-stu-id="7475f-125">With an elastic query, you can query across several databases using hello familiar SQL Server connectivity experience in tools such as Excel, PowerBI, Tableau, or Cognos.</span></span>
<span data-ttu-id="7475f-126">Запрос эластичной позволяет удобно tooan всю коллекцию баз данных с помощью запросов, выданных SQL Server Management Studio или Visual Studio и позволяет межбазовые запросы Entity Framework или другие среды ORM.</span><span class="sxs-lookup"><span data-stu-id="7475f-126">An elastic query allows easy access tooan entire collection of databases through queries issued by SQL Server Management Studio or Visual Studio, and facilitates cross-database querying from Entity Framework or other ORM environments.</span></span> <span data-ttu-id="7475f-127">Рис. 1 показан сценарий, где существующего облачные приложения (с использованием hello [клиентской библиотеке эластичной базы данных](sql-database-elastic-database-client-library.md)) уровня сборок на масштабируемых данных и гибко запрос используется для создания отчетов между базами данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-127">Figure 1 shows a scenario where an existing cloud application (which uses hello [elastic database client library](sql-database-elastic-database-client-library.md)) builds on a scaled-out data tier, and an elastic query is used for cross-database reporting.</span></span>

<span data-ttu-id="7475f-128">**Рисунок 1.** Эластичный запрос на уровне масштабируемых данных</span><span class="sxs-lookup"><span data-stu-id="7475f-128">**Figure 1** Elastic query used on scaled-out data tier</span></span>

![Эластичный запрос на уровне масштабируемых данных][1]

<span data-ttu-id="7475f-130">Пользовательские сценарии для эластичного запроса характеризуются hello следующих топологий:</span><span class="sxs-lookup"><span data-stu-id="7475f-130">Customer scenarios for elastic query are characterized by hello following topologies:</span></span>

* <span data-ttu-id="7475f-131">**Вертикальное секционирование - межбазовые запросы** (топологии 1): hello данные секционируются по вертикали между число баз данных на уровне данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-131">**Vertical partitioning - Cross-database queries** (Topology 1): hello data is partitioned vertically between a number of databases in a data tier.</span></span> <span data-ttu-id="7475f-132">Как правило, разные наборы таблиц расположены в разных базах данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-132">Typically, different sets of tables reside on different databases.</span></span> <span data-ttu-id="7475f-133">Это означает, что в этой схеме hello отличается на разных базах данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-133">That means that hello schema is different on different databases.</span></span> <span data-ttu-id="7475f-134">Например, все таблицы, связанные с данными инвентаризации, хранятся в одной базе данных, а таблицы, связанные с учетом, — в другой.</span><span class="sxs-lookup"><span data-stu-id="7475f-134">For instance, all tables for inventory are on one database while all accounting-related tables are on a second database.</span></span> <span data-ttu-id="7475f-135">Распространенные примеры в этой топологии требуется один tooquery через или toocompile отчеты по таблицам в нескольких базах данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-135">Common use cases with this topology require one tooquery across or toocompile reports across tables in several databases.</span></span>
* <span data-ttu-id="7475f-136">**Горизонтальное секционирование - сегментирования** (топологии 2): данные секционируются горизонтально уровня строк toodistribute горизонтальным масштабированием данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-136">**Horizontal Partitioning - Sharding** (Topology 2): Data is partitioned horizontally toodistribute rows across a scaled out data tier.</span></span> <span data-ttu-id="7475f-137">При таком подходе hello схемы идентичны для всех участвующих баз данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-137">With this approach, hello schema is identical on all participating databases.</span></span> <span data-ttu-id="7475f-138">Такой подход также называется сегментированием.</span><span class="sxs-lookup"><span data-stu-id="7475f-138">This approach is also called “sharding”.</span></span> <span data-ttu-id="7475f-139">Сегментирования могут быть выполнены и управляются с помощью библиотек инструментов эластичной базы данных hello (1) или (2) самостоятельное сегментирование.</span><span class="sxs-lookup"><span data-stu-id="7475f-139">Sharding can be performed and managed using (1) hello elastic database tools libraries or (2) self-sharding.</span></span> <span data-ttu-id="7475f-140">Эластичный запрос является используемых tooquery или компиляции отчетов по сегментам много.</span><span class="sxs-lookup"><span data-stu-id="7475f-140">An elastic query is used tooquery or compile reports across many shards.</span></span>

> [!NOTE]
> <span data-ttu-id="7475f-141">Эластичный запроса оптимально подходит для случайные сценариях отчетов, где большинство hello обработки может выполняться на уровне данных hello.</span><span class="sxs-lookup"><span data-stu-id="7475f-141">Elastic query works best for occasional reporting scenarios where most of hello processing can be performed on hello data tier.</span></span> <span data-ttu-id="7475f-142">Для сценариев, предусматривающих высокие рабочие нагрузки отчетности или хранение данных с более сложными запросами, вы можете использовать [хранилище данных SQL Azure](https://azure.microsoft.com/services/sql-data-warehouse/).</span><span class="sxs-lookup"><span data-stu-id="7475f-142">For heavy reporting workloads or data warehousing scenarios with more complex queries, also consider using [Azure SQL Data Warehouse](https://azure.microsoft.com/services/sql-data-warehouse/).</span></span>
>  

## <a name="vertical-partitioning---cross-database-queries"></a><span data-ttu-id="7475f-143">Вертикальное секционирование — межбазовые запросы</span><span class="sxs-lookup"><span data-stu-id="7475f-143">Vertical partitioning - cross-database queries</span></span>

<span data-ttu-id="7475f-144">toobegin кодированию см. в разделе [Приступая к работе с запросом между базами данных (вертикальное секционирование)](sql-database-elastic-query-getting-started-vertical.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-144">toobegin coding, see [Getting started with cross-database query (vertical partitioning)](sql-database-elastic-query-getting-started-vertical.md).</span></span>

<span data-ttu-id="7475f-145">Эластичный запрос может быть используется toomake данные, находящиеся в базе данных SQL доступны tooother баз данных SQL.</span><span class="sxs-lookup"><span data-stu-id="7475f-145">An elastic query can be used toomake data located in a SQL database available tooother SQL databases.</span></span> <span data-ttu-id="7475f-146">Это позволяет запросов из одного tootables toorefer базы данных в любой другой удаленной базы данных SQL.</span><span class="sxs-lookup"><span data-stu-id="7475f-146">This allows queries from one database toorefer tootables in any other remote SQL database.</span></span> <span data-ttu-id="7475f-147">Hello первым шагом является toodefine внешнего источника данных для каждой удаленной базы данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-147">hello first step is toodefine an external data source for each remote database.</span></span> <span data-ttu-id="7475f-148">Hello внешний источник данных определяется в hello локальной базы данных, из которого нужно tootables toogain доступа, расположенных на hello удаленной базы данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-148">hello external data source is defined in hello local database from which you want toogain access tootables located on hello remote database.</span></span> <span data-ttu-id="7475f-149">Изменения не требуются hello удаленную базу данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-149">No changes are necessary on hello remote database.</span></span> <span data-ttu-id="7475f-150">В вертикальной секционирования скриптах где другой базы данных имеют различные схемы эластичной запросы можно использовать tooimplement распространенных вариантов использования, например tooreference доступ к данным и межбазовые запросы.</span><span class="sxs-lookup"><span data-stu-id="7475f-150">For typical vertical partitioning scenarios where different databases have different schemas, elastic queries can be used tooimplement common use cases such as access tooreference data and cross-database querying.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7475f-151">Требуется наличие разрешения ALTER ANY EXTERNAL DATA SOURCE.</span><span class="sxs-lookup"><span data-stu-id="7475f-151">You must possess ALTER ANY EXTERNAL DATA SOURCE permission.</span></span> <span data-ttu-id="7475f-152">Это разрешение входит в состав hello разрешение ALTER DATABASE.</span><span class="sxs-lookup"><span data-stu-id="7475f-152">This permission is included with hello ALTER DATABASE permission.</span></span> <span data-ttu-id="7475f-153">Разрешения ALTER ANY EXTERNAL DATA SOURCE, необходимые toorefer toohello базового источника данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-153">ALTER ANY EXTERNAL DATA SOURCE permissions are needed toorefer toohello underlying data source.</span></span>
>

<span data-ttu-id="7475f-154">**Ссылочные данные**: hello топологии используется для управления эталонными данными.</span><span class="sxs-lookup"><span data-stu-id="7475f-154">**Reference data**: hello topology is used for reference data management.</span></span> <span data-ttu-id="7475f-155">Hello рисунке две таблицы (T1 и T2) ссылочных данных, хранятся в выделенной базы данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-155">In hello figure below, two tables (T1 and T2) with reference data are kept on a dedicated database.</span></span> <span data-ttu-id="7475f-156">С помощью эластичных запроса, теперь вы можете просматривать таблицы T1 и T2 удаленно от других баз данных, как показано на рисунке hello.</span><span class="sxs-lookup"><span data-stu-id="7475f-156">Using an elastic query, you can now access tables T1 and T2 remotely from other databases, as shown in hello figure.</span></span> <span data-ttu-id="7475f-157">Топологию 1 рекомендуется использовать, если ссылочные таблицы имеют небольшой размер или если в удаленных запросах к таким таблицам используются предикаты селекции.</span><span class="sxs-lookup"><span data-stu-id="7475f-157">Use topology 1 if reference tables are small or remote queries into reference table have selective predicates.</span></span>

<span data-ttu-id="7475f-158">**На рисунке 2** вертикальное секционирование — эластичной запроса tooquery ссылочных данных</span><span class="sxs-lookup"><span data-stu-id="7475f-158">**Figure 2** Vertical partitioning - Using elastic query tooquery reference data</span></span>

![Вертикальное секционирование — эластичной запроса tooquery ссылочных данных][3]

<span data-ttu-id="7475f-160">**Межбазовые запросы**: эластичные запросы позволяют реализовывать сценарии, требующие выполнения запросов между базами данных SQL.</span><span class="sxs-lookup"><span data-stu-id="7475f-160">**Cross-database querying**: Elastic queries enable use cases that require querying across several SQL databases.</span></span> <span data-ttu-id="7475f-161">На рисунке 3 показаны четыре разных базы данных: «Управление отношениями с клиентами», «Инвентарные данные», «Управление персоналом» и «Продукты».</span><span class="sxs-lookup"><span data-stu-id="7475f-161">Figure 3 shows four different databases: CRM, Inventory, HR and Products.</span></span> <span data-ttu-id="7475f-162">Запросы, выполняемые в одной из баз данных hello также требуется доступ к tooone или все hello других баз данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-162">Queries performed in one of hello databases also need access tooone or all hello other databases.</span></span> <span data-ttu-id="7475f-163">Эластичный запрос можно настроить базу данных для этого случая, выполнив несколько простых инструкций DDL для всех четырех hello баз данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-163">Using an elastic query, you can configure your database for this case by running a few simple DDL statements on each of hello four databases.</span></span> <span data-ttu-id="7475f-164">После этого выполнить настройку удаленной таблицы tooa доступа сводится ссылается tooa локальной таблицы T-SQL-запросы или из средств бизнес-Аналитики.</span><span class="sxs-lookup"><span data-stu-id="7475f-164">After this one-time configuration, access tooa remote table is as simple as referring tooa local table from your T-SQL queries or from your BI tools.</span></span> <span data-ttu-id="7475f-165">Этот подход рекомендуется в том случае, если hello удаленные запросы не возвращают большие результаты.</span><span class="sxs-lookup"><span data-stu-id="7475f-165">This approach is recommended if hello remote queries do not return large results.</span></span>

<span data-ttu-id="7475f-166">**Рис. 3** вертикальное секционирование — с помощью tooquery эластичной запроса в различных базах данных</span><span class="sxs-lookup"><span data-stu-id="7475f-166">**Figure 3** Vertical partitioning - Using elastic query tooquery across various databases</span></span>

![Вертикальное секционирование — с помощью tooquery эластичной запроса в различных базах данных][4]

<span data-ttu-id="7475f-168">Hello следующие шаги настройки запросов эластичной базы данных для вертикальной секционирования сценариев, которые требуется найти таблицу tooa доступ для удаленных баз данных SQL с hello же схемы:</span><span class="sxs-lookup"><span data-stu-id="7475f-168">hello following steps configure elastic database queries for vertical partitioning scenarios that require access tooa table located on remote SQL databases with hello same schema:</span></span>

* <span data-ttu-id="7475f-169">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey</span><span class="sxs-lookup"><span data-stu-id="7475f-169">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey</span></span>
* <span data-ttu-id="7475f-170">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential</span><span class="sxs-lookup"><span data-stu-id="7475f-170">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential</span></span>
* <span data-ttu-id="7475f-171">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **RDBMS**</span><span class="sxs-lookup"><span data-stu-id="7475f-171">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **RDBMS**</span></span>
* <span data-ttu-id="7475f-172">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable</span><span class="sxs-lookup"><span data-stu-id="7475f-172">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable</span></span>

<span data-ttu-id="7475f-173">После выполнения инструкции DDL hello, как если бы он локальной таблицы можно открыть удаленной таблицы hello «mytable».</span><span class="sxs-lookup"><span data-stu-id="7475f-173">After running hello DDL statements, you can access hello remote table “mytable” as though it were a local table.</span></span> <span data-ttu-id="7475f-174">База данных SQL Azure автоматически открывает соединение toohello удаленной базы данных, обработку запроса hello удаленную базу данных и возвращает результаты hello.</span><span class="sxs-lookup"><span data-stu-id="7475f-174">Azure SQL Database automatically opens a connection toohello remote database, processes your request on hello remote database, and returns hello results.</span></span>

## <a name="horizontal-partitioning---sharding"></a><span data-ttu-id="7475f-175">Горизонтальное секционирование (сегментирование)</span><span class="sxs-lookup"><span data-stu-id="7475f-175">Horizontal partitioning - sharding</span></span>
<span data-ttu-id="7475f-176">Использование tooperform эластичной запроса задачи отчетов через сегментированных, т. е., горизонтально секционированы, уровень данных требует [карта сегментов эластичной базы данных](sql-database-elastic-scale-shard-map-management.md) баз данных hello toorepresent hello уровня данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-176">Using elastic query tooperform reporting tasks over a sharded, i.e., horizontally partitioned, data tier requires an [elastic database shard map](sql-database-elastic-scale-shard-map-management.md) toorepresent hello databases of hello data tier .</span></span> <span data-ttu-id="7475f-177">Как правило в этом сценарии используется только один сегмент карты и выделенная база данных с возможностями эластичной запроса (головного узла) выступает в качестве точки входа hello для запросов отчетов.</span><span class="sxs-lookup"><span data-stu-id="7475f-177">Typically, only a single shard map is used in this scenario and a dedicated database with elastic query capabilities (head node) serves as hello entry point for reporting queries.</span></span> <span data-ttu-id="7475f-178">Только этот выделенная база данных должна карта сегментов toohello доступа.</span><span class="sxs-lookup"><span data-stu-id="7475f-178">Only this dedicated database needs access toohello shard map.</span></span> <span data-ttu-id="7475f-179">На рисунке 4 показаны в этой топологии и конфигурации со схемой базы данных и сегментов эластичной запроса hello.</span><span class="sxs-lookup"><span data-stu-id="7475f-179">Figure 4 illustrates this topology and its configuration with hello elastic query database and shard map.</span></span> <span data-ttu-id="7475f-180">Hello баз данных на уровне данных hello может иметь любой базы данных SQL Azure версии или выпуска.</span><span class="sxs-lookup"><span data-stu-id="7475f-180">hello databases in hello data tier can be of any Azure SQL Database version or edition.</span></span> <span data-ttu-id="7475f-181">Дополнительные сведения о клиентской библиотеке эластичной базы данных hello и Создание карт сегментов см. в разделе [управления карты сегментов](sql-database-elastic-scale-shard-map-management.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-181">For more information about hello elastic database client library and creating shard maps, see [Shard map management](sql-database-elastic-scale-shard-map-management.md).</span></span>

<span data-ttu-id="7475f-182">**Рисунок 4.** Горизонтальное секционирование — использование эластичных запросов для создания отчетности по уровням сегментированных данных</span><span class="sxs-lookup"><span data-stu-id="7475f-182">**Figure 4** Horizontal partitioning - Using elastic query for reporting over sharded data tiers</span></span>

![Горизонтальное секционирование — использование эластичных запросов для создания отчетности по уровням сегментированных данных][5]

> [!NOTE]
> <span data-ttu-id="7475f-184">Эластичной базы данных запроса (головного узла) может быть отдельную базу данных, или он может быть hello же базы данных, карта сегментов hello узлов.</span><span class="sxs-lookup"><span data-stu-id="7475f-184">Elastic Query Database (head node) can be separate database, or it can be hello same database that hosts hello shard map.</span></span> <span data-ttu-id="7475f-185">Независимо от конфигурации, можно выбрать, убедитесь, что этого уровня службы и производительности базы данных — находится достаточно высоко toohandle hello ожидаемый объем входа и выполнении запросов.</span><span class="sxs-lookup"><span data-stu-id="7475f-185">Whatever configuration you choose, make sure that service and performance tier of that database is high enough toohandle hello expected  amount of login/query requests.</span></span>

<span data-ttu-id="7475f-186">Hello следующие шаги настройки запросов эластичной базы данных для горизонтальной секционирования сценариев, которые требуют доступа tooa набор таблиц, расположенных на (обычно) несколько удаленных баз данных SQL:</span><span class="sxs-lookup"><span data-stu-id="7475f-186">hello following steps configure elastic database queries for horizontal partitioning scenarios that require access tooa set of table that are located on (typically) several remote SQL databases:</span></span>

* <span data-ttu-id="7475f-187">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey</span><span class="sxs-lookup"><span data-stu-id="7475f-187">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey</span></span>
* <span data-ttu-id="7475f-188">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential</span><span class="sxs-lookup"><span data-stu-id="7475f-188">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential</span></span>
* <span data-ttu-id="7475f-189">Создание [карта сегментов](sql-database-elastic-scale-shard-map-management.md) представляет уровень данных, с помощью клиентской библиотеки hello эластичной базы данных.</span><span class="sxs-lookup"><span data-stu-id="7475f-189">Create a [shard map](sql-database-elastic-scale-shard-map-management.md) representing your data tier using hello elastic database client library.</span></span>   
* <span data-ttu-id="7475f-190">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **SHARD_MAP_MANAGER**</span><span class="sxs-lookup"><span data-stu-id="7475f-190">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **SHARD_MAP_MANAGER**</span></span>
* <span data-ttu-id="7475f-191">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable</span><span class="sxs-lookup"><span data-stu-id="7475f-191">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable</span></span>

<span data-ttu-id="7475f-192">После выполнения этих действий, как если бы он локальной таблицы доступны горизонтально секционированные таблицы hello «mytable».</span><span class="sxs-lookup"><span data-stu-id="7475f-192">Once you have performed these steps, you can access hello horizontally partitioned table “mytable” as though it were a local table.</span></span> <span data-ttu-id="7475f-193">База данных SQL Azure автоматически открывает несколько параллельных соединений toohello удаленных базах данных где hello таблицы хранятся физически, обрабатывает запросы hello на hello удаленных базах данных и возвращает результаты hello.</span><span class="sxs-lookup"><span data-stu-id="7475f-193">Azure SQL Database automatically opens multiple parallel connections toohello remote databases where hello tables are physically stored, processes hello requests on hello remote databases, and returns hello results.</span></span>
<span data-ttu-id="7475f-194">Дополнительные сведения о hello шаги, необходимые для можно найти в сценарии секционирования горизонтальной hello [эластичной запроса для горизонтального секционирования](sql-database-elastic-query-horizontal-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-194">More information on hello steps required for hello horizontal partitioning scenario can be found in [elastic query for horizontal partitioning](sql-database-elastic-query-horizontal-partitioning.md).</span></span>

<span data-ttu-id="7475f-195">toobegin кодированию см. в разделе [Приступая к работе с эластичной запроса для горизонтального секционирования (сегментирования)](sql-database-elastic-query-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-195">toobegin coding, see [Getting started with elastic query for horizontal partitioning (sharding)](sql-database-elastic-query-getting-started.md).</span></span>

## <a name="t-sql-querying"></a><span data-ttu-id="7475f-196">Запросы T-SQL</span><span class="sxs-lookup"><span data-stu-id="7475f-196">T-SQL querying</span></span>
<span data-ttu-id="7475f-197">После определения источников внешних данных и внешних таблиц можно использовать регулярные соединения строки tooconnect toohello баз данных SQL Server которых определены внешних таблиц.</span><span class="sxs-lookup"><span data-stu-id="7475f-197">Once you have defined your external data sources and your external tables, you can use regular SQL Server connection strings tooconnect toohello databases where you defined your external tables.</span></span> <span data-ttu-id="7475f-198">Этого можно выполнять инструкции T-SQL через внешние таблицы для этого соединения с hello ограничения, описанные ниже.</span><span class="sxs-lookup"><span data-stu-id="7475f-198">You can then run T-SQL statements over your external tables on that connection with hello limitations outlined below.</span></span> <span data-ttu-id="7475f-199">Дополнительные сведения и примеры запросов T-SQL можно найти в разделах документации hello [горизонтального секционирования](sql-database-elastic-query-horizontal-partitioning.md) и [вертикальное секционирование](sql-database-elastic-query-vertical-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-199">You can find more information and examples of T-SQL queries in hello documentation topics for [horizontal partitioning](sql-database-elastic-query-horizontal-partitioning.md) and [vertical partitioning](sql-database-elastic-query-vertical-partitioning.md).</span></span>

## <a name="connectivity-for-tools"></a><span data-ttu-id="7475f-200">Подключение для инструментов</span><span class="sxs-lookup"><span data-stu-id="7475f-200">Connectivity for tools</span></span>
<span data-ttu-id="7475f-201">Приложения и бизнес-Аналитики или данные toodatabases средств интеграции, имеют внешние таблицы можно использовать регулярные tooconnect строки подключения SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7475f-201">You can use regular SQL Server connection strings tooconnect your applications and BI or data integration tools toodatabases that have external tables.</span></span> <span data-ttu-id="7475f-202">Убедитесь, что в качестве источника данных для вашего инструмента поддерживается SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7475f-202">Make sure that SQL Server is supported as a data source for your tool.</span></span> <span data-ttu-id="7475f-203">После подключения ссылаться toohello запроса эластичной базы данных и hello внешние таблицы в этой базе данных так же, как и с другой базой данных SQL Server подключения toowith средством.</span><span class="sxs-lookup"><span data-stu-id="7475f-203">Once connected, refer toohello elastic query database and hello external tables in that database just like you would do with any other SQL Server database that you connect toowith your tool.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7475f-204">Проверка подлинности с помощью Azure Active Directory и эластичных запросов сейчас не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="7475f-204">Authentication using Azure Active Directory with elastic queries is not currently supported.</span></span>
> 
> 

## <a name="cost"></a><span data-ttu-id="7475f-205">Стоимость</span><span class="sxs-lookup"><span data-stu-id="7475f-205">Cost</span></span>
<span data-ttu-id="7475f-206">Эластичный запроса включается в стоимость hello баз данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="7475f-206">Elastic query is included into hello cost of Azure SQL Database databases.</span></span> <span data-ttu-id="7475f-207">Обратите внимание, что поддерживаются топологиях, где удаленной базы данных находятся в другом центре обработки данных, чем hello эластичной запроса конечной точки, но исходящих данных из удаленной базы данных взимается regular [тарифы Azure](https://azure.microsoft.com/pricing/details/data-transfers/).</span><span class="sxs-lookup"><span data-stu-id="7475f-207">Note that topologies where your remote databases are in a different data center than hello elastic query endpoint are supported, but data egress from remote databases are charged regular [Azure rates](https://azure.microsoft.com/pricing/details/data-transfers/).</span></span>

## <a name="preview-limitations"></a><span data-ttu-id="7475f-208">Ограничения предварительной версии</span><span class="sxs-lookup"><span data-stu-id="7475f-208">Preview limitations</span></span>
* <span data-ttu-id="7475f-209">Под управлением эластичной первого запроса может занять tooa несколько минут на уровне Standard производительности hello.</span><span class="sxs-lookup"><span data-stu-id="7475f-209">Running your first elastic query can take up tooa few minutes on hello Standard performance tier.</span></span> <span data-ttu-id="7475f-210">На этот раз будет tooload необходимые функциональные возможности hello эластичной запроса; позволяет повысить производительность загрузки с более высокими уровнями производительности.</span><span class="sxs-lookup"><span data-stu-id="7475f-210">This time is necessary tooload hello elastic query functionality; loading performance improves with higher performance tiers.</span></span>
* <span data-ttu-id="7475f-211">Сценарии для внешних источников данных или внешних таблиц из SSMS или SSDT в настоящее время не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="7475f-211">Scripting of external data sources or external tables from SSMS or SSDT is not yet supported.</span></span>
* <span data-ttu-id="7475f-212">Функции импорта и экспорта баз данных SQL в настоящее время не поддерживают внешние источники данных и внешние таблицы.</span><span class="sxs-lookup"><span data-stu-id="7475f-212">Import/Export for SQL DB does not yet support external data sources and external tables.</span></span> <span data-ttu-id="7475f-213">Если вам требуется toouse импорта и экспорта, удалить эти объекты перед экспортом и создайте их заново после импорта.</span><span class="sxs-lookup"><span data-stu-id="7475f-213">If you need toouse Import/Export, drop these objects before exporting and then re-create them after importing.</span></span>
* <span data-ttu-id="7475f-214">Эластичный query в настоящее время поддерживает только tooexternal таблиц доступ только для чтения.</span><span class="sxs-lookup"><span data-stu-id="7475f-214">Elastic query currently only supports read-only access tooexternal tables.</span></span> <span data-ttu-id="7475f-215">Однако, можно использовать возможности T-SQL в базе данных hello которой определен hello внешней таблицы.</span><span class="sxs-lookup"><span data-stu-id="7475f-215">You can, however, use full T-SQL functionality on hello database where hello external table is defined.</span></span> <span data-ttu-id="7475f-216">Это может быть полезно для, например, хранения временных результатов с помощью, например, SELECT < список_столбцов > в < local_table >, или toodefine хранимых процедур эластичной запроса hello базе данных, который tooexternal таблиц см.</span><span class="sxs-lookup"><span data-stu-id="7475f-216">This can be useful to, e.g., persist temporary results using, e.g., SELECT <column_list> INTO <local_table>, or toodefine stored procedures on hello elastic query database which refer tooexternal tables.</span></span>
* <span data-ttu-id="7475f-217">В определениях внешних таблиц типы LOB не поддерживаются, за исключением nvarchar(max).</span><span class="sxs-lookup"><span data-stu-id="7475f-217">Except for nvarchar(max), LOB types are not supported in external table definitions.</span></span> <span data-ttu-id="7475f-218">Чтобы избежать этого можно создать представление на удаленную базу данных hello приведение типа LOB hello в nvarchar(max), определения внешней таблицы через представление hello вместо базовой таблицы hello и привести его обратно в исходный тип LOB hello в запросах.</span><span class="sxs-lookup"><span data-stu-id="7475f-218">As a workaround, you can create a view on hello remote database that casts hello LOB type into nvarchar(max), define your external table over hello view instead of hello base table and then cast it back into hello original LOB type in your queries.</span></span>
* <span data-ttu-id="7475f-219">Статистика по столбцам для внешних таблиц в настоящее время не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="7475f-219">Column statistics over external tables are currently not supported.</span></span> <span data-ttu-id="7475f-220">Статистика таблиц поддерживаются, но требуется toobe созданы вручную.</span><span class="sxs-lookup"><span data-stu-id="7475f-220">Tables statistics are supported, but need toobe created manually.</span></span>

## <a name="feedback"></a><span data-ttu-id="7475f-221">Отзыв</span><span class="sxs-lookup"><span data-stu-id="7475f-221">Feedback</span></span>
<span data-ttu-id="7475f-222">Поделитесь отзыв о своем опыте работы с запросами эластичной с нами на Disqus ниже форумы MSDN hello, или на сайте Stackoverflow.</span><span class="sxs-lookup"><span data-stu-id="7475f-222">Please share feedback on your experience with elastic queries with us on Disqus below, hello MSDN forums, or on Stackoverflow.</span></span> <span data-ttu-id="7475f-223">Нас интересуют все виды отзыв о службе hello (дефектов, недоработки, функция пропуски).</span><span class="sxs-lookup"><span data-stu-id="7475f-223">We are interested in all kinds of feedback about hello service (defects, rough edges, feature gaps).</span></span>

## <a name="next-steps"></a><span data-ttu-id="7475f-224">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="7475f-224">Next steps</span></span>

* <span data-ttu-id="7475f-225">Руководств по вертикальному секционированию см. в статье [Приступая к работе с межбазовыми запросами (вертикальное секционирование) (предварительная версия)](sql-database-elastic-query-getting-started-vertical.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-225">For a vertical partitioning tutorial, see [Getting started with cross-database query (vertical partitioning)](sql-database-elastic-query-getting-started-vertical.md).</span></span>
* <span data-ttu-id="7475f-226">Описание синтаксиса и примеры запросов вертикально секционированных данных см. в разделе [Запрос к нескольким облачным базам данных с разными схемами (предварительная версия)](sql-database-elastic-query-vertical-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-226">For syntax and sample queries for vertically partitioned data, see [Querying vertically partitioned data)](sql-database-elastic-query-vertical-partitioning.md)</span></span>
* <span data-ttu-id="7475f-227">Руководство по горизонтальному секционированию (сегментированию) см. в статье [Отчеты по масштабируемым облачным базам данных (предварительная версия)](sql-database-elastic-query-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-227">For a horizontal partitioning (sharding) tutorial, see [Getting started with elastic query for horizontal partitioning (sharding)](sql-database-elastic-query-getting-started.md).</span></span>
* <span data-ttu-id="7475f-228">Описание синтаксиса и примеры запросов горизонтально секционированных данных см. в разделе [Отчеты по масштабируемым облачным базам данных (предварительная версия)](sql-database-elastic-query-horizontal-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="7475f-228">For syntax and sample queries for horizontally partitioned data, see [Querying horizontally partitioned data)](sql-database-elastic-query-horizontal-partitioning.md)</span></span>
* <span data-ttu-id="7475f-229">В описании [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714) приведена хранимая процедура, которая выполняет инструкцию Transact-SQL для отдельной удаленной базы данных SQL Azure или набора баз данных, выступающих в качестве сегментов в схеме горизонтального секционирования.</span><span class="sxs-lookup"><span data-stu-id="7475f-229">See [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714) for a stored procedure that executes a Transact-SQL statement on a single remote Azure SQL Database or set of databases serving as shards in a horizontal partitioning scheme.</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-query-overview/overview.png
[2]: ./media/sql-database-elastic-query-overview/topology1.png
[3]: ./media/sql-database-elastic-query-overview/vertpartrrefdata.png
[4]: ./media/sql-database-elastic-query-overview/verticalpartitioning.png
[5]: ./media/sql-database-elastic-query-overview/horizontalpartitioning.png

<!--anchors-->
