---
title: "Обзор эластичной запросов базы данных SQL aaaAzure | Документы Microsoft"
description: "Общие сведения о возможности эластичного запроса hello"
services: sql-database
documentationcenter: 
manager: jhubbard
author: MladjoA
ms.assetid: a8bf0e2c-bc74-44d0-9b1e-bcc9a6aa2e33
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/27/2016
ms.author: mlandzic
ms.openlocfilehash: db17f551882cfcae0da67fdda12708baeb6db81c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-sql-database-elastic-query-overview-preview"></a>Обзор эластичных запросов к базе данных SQL Azure (предварительная версия)
функция эластичной запроса Hello (в предварительной версии) позволяет toorun запрос Transact-SQL, которая охватывает несколько баз данных в базе данных SQL Azure. Оно позволяет tooperform межбазовые запросы tooaccess удаленных таблиц и tooquery tooconnect Майкрософт и сторонние средства (Excel, PowerBI, Tableau, т. д.) по уровням данных с несколькими базами данных. Используя эту возможность, можно масштабировать уровни данных toolarge запросы в базе данных SQL и визуализировать результаты hello в отчетов бизнес-аналитики (BI).


## <a name="why-use-elastic-queries"></a>Почему рекомендуется использовать эластичные запросы?

**база данных SQL Azure;**

Выполняйте запросы к нескольким базам данных SQL Azure только в T-SQL. Это позволяет отправлять в удаленные базы данных запросы только для чтения. Это позволяет для текущей локальной приложений toomigrate клиентов SQL Server, с помощью трех и четырех частей имен или tooSQL связанного сервера базы данных.

**Доступность на уровне "Стандартный"**

Эластичный запросов поддерживается на уровне Standard производительности hello в уровень производительности Premium toohello сложения. В разделе hello на ограничения предварительной версии, приведенные на ограничения производительности для уровней ниже производительности.

**Принудительная tooremote баз данных**

Эластичный запросы теперь можно передать параметры toohello удаленной базы данных SQL для выполнения.

**Выполнение хранимой процедуры**

Выполнить вызовы удаленных хранимых процедур или удаленных функций можно с помощью процедуры [sp\_execute\_remote](https://msdn.microsoft.com/library/mt703714).

**Гибкость**

Внешних таблиц, эластичной запроса теперь можно ссылаться tooremote таблиц с разными схемами или имя таблицы.

## <a name="elastic-query-scenarios"></a>Сценарии применения эластичных запросов

Задача Hello — toofacilitate запросов в сценариях, где несколько баз данных участие строк в общий результат. Hello запрос можно либо создавать hello пользователем или приложением напрямую или косвенно через средства, которые toohello подключенной базы данных. Это особенно полезно при создании отчетов с помощью коммерческих средств бизнес-аналитики, интеграции данных или любого приложения, которое нельзя изменить. С помощью эластичных запроса можно выполнять запросы между несколькими базами данных с помощью hello знакомый интерфейс подключения к SQL Server в средствах, например Excel, PowerBI, Tableau или Cognos.
Запрос эластичной позволяет удобно tooan всю коллекцию баз данных с помощью запросов, выданных SQL Server Management Studio или Visual Studio и позволяет межбазовые запросы Entity Framework или другие среды ORM. Рис. 1 показан сценарий, где существующего облачные приложения (с использованием hello [клиентской библиотеке эластичной базы данных](sql-database-elastic-database-client-library.md)) уровня сборок на масштабируемых данных и гибко запрос используется для создания отчетов между базами данных.

**Рисунок 1.** Эластичный запрос на уровне масштабируемых данных

![Эластичный запрос на уровне масштабируемых данных][1]

Пользовательские сценарии для эластичного запроса характеризуются hello следующих топологий:

* **Вертикальное секционирование - межбазовые запросы** (топологии 1): hello данные секционируются по вертикали между число баз данных на уровне данных. Как правило, разные наборы таблиц расположены в разных базах данных. Это означает, что в этой схеме hello отличается на разных базах данных. Например, все таблицы, связанные с данными инвентаризации, хранятся в одной базе данных, а таблицы, связанные с учетом, — в другой. Распространенные примеры в этой топологии требуется один tooquery через или toocompile отчеты по таблицам в нескольких базах данных.
* **Горизонтальное секционирование - сегментирования** (топологии 2): данные секционируются горизонтально уровня строк toodistribute горизонтальным масштабированием данных. При таком подходе hello схемы идентичны для всех участвующих баз данных. Такой подход также называется сегментированием. Сегментирования могут быть выполнены и управляются с помощью библиотек инструментов эластичной базы данных hello (1) или (2) самостоятельное сегментирование. Эластичный запрос является используемых tooquery или компиляции отчетов по сегментам много.

> [!NOTE]
> Эластичный запроса оптимально подходит для случайные сценариях отчетов, где большинство hello обработки может выполняться на уровне данных hello. Для сценариев, предусматривающих высокие рабочие нагрузки отчетности или хранение данных с более сложными запросами, вы можете использовать [хранилище данных SQL Azure](https://azure.microsoft.com/services/sql-data-warehouse/).
>  

## <a name="vertical-partitioning---cross-database-queries"></a>Вертикальное секционирование — межбазовые запросы

toobegin кодированию см. в разделе [Приступая к работе с запросом между базами данных (вертикальное секционирование)](sql-database-elastic-query-getting-started-vertical.md).

Эластичный запрос может быть используется toomake данные, находящиеся в базе данных SQL доступны tooother баз данных SQL. Это позволяет запросов из одного tootables toorefer базы данных в любой другой удаленной базы данных SQL. Hello первым шагом является toodefine внешнего источника данных для каждой удаленной базы данных. Hello внешний источник данных определяется в hello локальной базы данных, из которого нужно tootables toogain доступа, расположенных на hello удаленной базы данных. Изменения не требуются hello удаленную базу данных. В вертикальной секционирования скриптах где другой базы данных имеют различные схемы эластичной запросы можно использовать tooimplement распространенных вариантов использования, например tooreference доступ к данным и межбазовые запросы.

> [!IMPORTANT]
> Требуется наличие разрешения ALTER ANY EXTERNAL DATA SOURCE. Это разрешение входит в состав hello разрешение ALTER DATABASE. Разрешения ALTER ANY EXTERNAL DATA SOURCE, необходимые toorefer toohello базового источника данных.
>

**Ссылочные данные**: hello топологии используется для управления эталонными данными. Hello рисунке две таблицы (T1 и T2) ссылочных данных, хранятся в выделенной базы данных. С помощью эластичных запроса, теперь вы можете просматривать таблицы T1 и T2 удаленно от других баз данных, как показано на рисунке hello. Топологию 1 рекомендуется использовать, если ссылочные таблицы имеют небольшой размер или если в удаленных запросах к таким таблицам используются предикаты селекции.

**На рисунке 2** вертикальное секционирование — эластичной запроса tooquery ссылочных данных

![Вертикальное секционирование — эластичной запроса tooquery ссылочных данных][3]

**Межбазовые запросы**: эластичные запросы позволяют реализовывать сценарии, требующие выполнения запросов между базами данных SQL. На рисунке 3 показаны четыре разных базы данных: «Управление отношениями с клиентами», «Инвентарные данные», «Управление персоналом» и «Продукты». Запросы, выполняемые в одной из баз данных hello также требуется доступ к tooone или все hello других баз данных. Эластичный запрос можно настроить базу данных для этого случая, выполнив несколько простых инструкций DDL для всех четырех hello баз данных. После этого выполнить настройку удаленной таблицы tooa доступа сводится ссылается tooa локальной таблицы T-SQL-запросы или из средств бизнес-Аналитики. Этот подход рекомендуется в том случае, если hello удаленные запросы не возвращают большие результаты.

**Рис. 3** вертикальное секционирование — с помощью tooquery эластичной запроса в различных базах данных

![Вертикальное секционирование — с помощью tooquery эластичной запроса в различных базах данных][4]

Hello следующие шаги настройки запросов эластичной базы данных для вертикальной секционирования сценариев, которые требуется найти таблицу tooa доступ для удаленных баз данных SQL с hello же схемы:

* [CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey
* [CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential
* [CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **RDBMS**
* [CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable

После выполнения инструкции DDL hello, как если бы он локальной таблицы можно открыть удаленной таблицы hello «mytable». База данных SQL Azure автоматически открывает соединение toohello удаленной базы данных, обработку запроса hello удаленную базу данных и возвращает результаты hello.

## <a name="horizontal-partitioning---sharding"></a>Горизонтальное секционирование (сегментирование)
Использование tooperform эластичной запроса задачи отчетов через сегментированных, т. е., горизонтально секционированы, уровень данных требует [карта сегментов эластичной базы данных](sql-database-elastic-scale-shard-map-management.md) баз данных hello toorepresent hello уровня данных. Как правило в этом сценарии используется только один сегмент карты и выделенная база данных с возможностями эластичной запроса (головного узла) выступает в качестве точки входа hello для запросов отчетов. Только этот выделенная база данных должна карта сегментов toohello доступа. На рисунке 4 показаны в этой топологии и конфигурации со схемой базы данных и сегментов эластичной запроса hello. Hello баз данных на уровне данных hello может иметь любой базы данных SQL Azure версии или выпуска. Дополнительные сведения о клиентской библиотеке эластичной базы данных hello и Создание карт сегментов см. в разделе [управления карты сегментов](sql-database-elastic-scale-shard-map-management.md).

**Рисунок 4.** Горизонтальное секционирование — использование эластичных запросов для создания отчетности по уровням сегментированных данных

![Горизонтальное секционирование — использование эластичных запросов для создания отчетности по уровням сегментированных данных][5]

> [!NOTE]
> Эластичной базы данных запроса (головного узла) может быть отдельную базу данных, или он может быть hello же базы данных, карта сегментов hello узлов. Независимо от конфигурации, можно выбрать, убедитесь, что этого уровня службы и производительности базы данных — находится достаточно высоко toohandle hello ожидаемый объем входа и выполнении запросов.

Hello следующие шаги настройки запросов эластичной базы данных для горизонтальной секционирования сценариев, которые требуют доступа tooa набор таблиц, расположенных на (обычно) несколько удаленных баз данных SQL:

* [CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey
* [CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential
* Создание [карта сегментов](sql-database-elastic-scale-shard-map-management.md) представляет уровень данных, с помощью клиентской библиотеки hello эластичной базы данных.   
* [CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **SHARD_MAP_MANAGER**
* [CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable

После выполнения этих действий, как если бы он локальной таблицы доступны горизонтально секционированные таблицы hello «mytable». База данных SQL Azure автоматически открывает несколько параллельных соединений toohello удаленных базах данных где hello таблицы хранятся физически, обрабатывает запросы hello на hello удаленных базах данных и возвращает результаты hello.
Дополнительные сведения о hello шаги, необходимые для можно найти в сценарии секционирования горизонтальной hello [эластичной запроса для горизонтального секционирования](sql-database-elastic-query-horizontal-partitioning.md).

toobegin кодированию см. в разделе [Приступая к работе с эластичной запроса для горизонтального секционирования (сегментирования)](sql-database-elastic-query-getting-started.md).

## <a name="t-sql-querying"></a>Запросы T-SQL
После определения источников внешних данных и внешних таблиц можно использовать регулярные соединения строки tooconnect toohello баз данных SQL Server которых определены внешних таблиц. Этого можно выполнять инструкции T-SQL через внешние таблицы для этого соединения с hello ограничения, описанные ниже. Дополнительные сведения и примеры запросов T-SQL можно найти в разделах документации hello [горизонтального секционирования](sql-database-elastic-query-horizontal-partitioning.md) и [вертикальное секционирование](sql-database-elastic-query-vertical-partitioning.md).

## <a name="connectivity-for-tools"></a>Подключение для инструментов
Приложения и бизнес-Аналитики или данные toodatabases средств интеграции, имеют внешние таблицы можно использовать регулярные tooconnect строки подключения SQL Server. Убедитесь, что в качестве источника данных для вашего инструмента поддерживается SQL Server. После подключения ссылаться toohello запроса эластичной базы данных и hello внешние таблицы в этой базе данных так же, как и с другой базой данных SQL Server подключения toowith средством.

> [!IMPORTANT]
> Проверка подлинности с помощью Azure Active Directory и эластичных запросов сейчас не поддерживается.
> 
> 

## <a name="cost"></a>Стоимость
Эластичный запроса включается в стоимость hello баз данных SQL Azure. Обратите внимание, что поддерживаются топологиях, где удаленной базы данных находятся в другом центре обработки данных, чем hello эластичной запроса конечной точки, но исходящих данных из удаленной базы данных взимается regular [тарифы Azure](https://azure.microsoft.com/pricing/details/data-transfers/).

## <a name="preview-limitations"></a>Ограничения предварительной версии
* Под управлением эластичной первого запроса может занять tooa несколько минут на уровне Standard производительности hello. На этот раз будет tooload необходимые функциональные возможности hello эластичной запроса; позволяет повысить производительность загрузки с более высокими уровнями производительности.
* Сценарии для внешних источников данных или внешних таблиц из SSMS или SSDT в настоящее время не поддерживаются.
* Функции импорта и экспорта баз данных SQL в настоящее время не поддерживают внешние источники данных и внешние таблицы. Если вам требуется toouse импорта и экспорта, удалить эти объекты перед экспортом и создайте их заново после импорта.
* Эластичный query в настоящее время поддерживает только tooexternal таблиц доступ только для чтения. Однако, можно использовать возможности T-SQL в базе данных hello которой определен hello внешней таблицы. Это может быть полезно для, например, хранения временных результатов с помощью, например, SELECT < список_столбцов > в < local_table >, или toodefine хранимых процедур эластичной запроса hello базе данных, который tooexternal таблиц см.
* В определениях внешних таблиц типы LOB не поддерживаются, за исключением nvarchar(max). Чтобы избежать этого можно создать представление на удаленную базу данных hello приведение типа LOB hello в nvarchar(max), определения внешней таблицы через представление hello вместо базовой таблицы hello и привести его обратно в исходный тип LOB hello в запросах.
* Статистика по столбцам для внешних таблиц в настоящее время не поддерживается. Статистика таблиц поддерживаются, но требуется toobe созданы вручную.

## <a name="feedback"></a>Отзыв
Поделитесь отзыв о своем опыте работы с запросами эластичной с нами на Disqus ниже форумы MSDN hello, или на сайте Stackoverflow. Нас интересуют все виды отзыв о службе hello (дефектов, недоработки, функция пропуски).

## <a name="next-steps"></a>Дальнейшие действия

* Руководств по вертикальному секционированию см. в статье [Приступая к работе с межбазовыми запросами (вертикальное секционирование) (предварительная версия)](sql-database-elastic-query-getting-started-vertical.md).
* Описание синтаксиса и примеры запросов вертикально секционированных данных см. в разделе [Запрос к нескольким облачным базам данных с разными схемами (предварительная версия)](sql-database-elastic-query-vertical-partitioning.md).
* Руководство по горизонтальному секционированию (сегментированию) см. в статье [Отчеты по масштабируемым облачным базам данных (предварительная версия)](sql-database-elastic-query-getting-started.md).
* Описание синтаксиса и примеры запросов горизонтально секционированных данных см. в разделе [Отчеты по масштабируемым облачным базам данных (предварительная версия)](sql-database-elastic-query-horizontal-partitioning.md).
* В описании [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714) приведена хранимая процедура, которая выполняет инструкцию Transact-SQL для отдельной удаленной базы данных SQL Azure или набора баз данных, выступающих в качестве сегментов в схеме горизонтального секционирования.

<!--Image references-->
[1]: ./media/sql-database-elastic-query-overview/overview.png
[2]: ./media/sql-database-elastic-query-overview/topology1.png
[3]: ./media/sql-database-elastic-query-overview/vertpartrrefdata.png
[4]: ./media/sql-database-elastic-query-overview/verticalpartitioning.png
[5]: ./media/sql-database-elastic-query-overview/horizontalpartitioning.png

<!--anchors-->
