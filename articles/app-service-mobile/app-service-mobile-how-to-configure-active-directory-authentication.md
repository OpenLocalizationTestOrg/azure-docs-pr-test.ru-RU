---
title: "Настройка проверки подлинности Azure Active Directory для приложения служб приложений"
description: "Узнайте, как настроить проверку подлинности Azure Active Directory для приложения служб приложений."
author: mattchenderson
services: app-service
documentationcenter: 
manager: syntaxc4
editor: 
ms.assetid: 6ec6a46c-bce4-47aa-b8a3-e133baef22eb
ms.service: app-service-mobile
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 10/01/2016
ms.author: mahender
ms.openlocfilehash: fe007fa8640d5641f29dc88f8f3a8ca52a1ca8ae
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="how-to-configure-your-app-service-application-to-use-azure-active-directory-login"></a>Настройка приложения службы приложений для использования службы входа Azure Active Directory
[!INCLUDE [app-service-mobile-selector-authentication](../../includes/app-service-mobile-selector-authentication.md)]

В этом разделе показано, как настроить службы приложений Azure для использования Azure Active Directory в качестве поставщика проверки подлинности.

## <a name="express"> </a>Настройка Azure Active Directory с помощью стандартных параметров
1. На [портал Azure]перейдите к своему приложению. Щелкните **Параметры**, а затем — **Аутентификация или авторизация**.
2. Если функция аутентификации или авторизации не включена, установите переключатель в положение **Вкл**.
3. Щелкните **Azure Active Directory**, а затем в разделе **Режим управления** выберите **Экспресс**.
4. Нажмите кнопку **ОК** , чтобы зарегистрировать приложение в Azure Active Directory. При этом будет создана новая регистрация. Чтобы выбрать имеющуюся регистрацию, щелкните **Выбрать существующее приложение** и найдите имя ранее созданной регистрации в вашем клиенте.
   Щелкните регистрацию, чтобы ее выбрать, и нажмите кнопку **ОК**. Затем нажмите кнопку **ОК** в колонке параметров Azure Active Directory.
   
   ![][0]
   
   По умолчанию служба приложений обеспечивает проверку подлинности, но не ограничивает авторизованный доступ к содержимому сайта и API. Авторизация пользователей должна быть включена в код приложения.
5. (Необязательно.) Чтобы предоставить доступ к сайту только пользователям, прошедшим проверку подлинности в Azure Active Directory, установите для параметра **Предпринимаемое действие, если проверка подлинности для запроса не выполнена** значение **Войти с использованием Azure Active Directory**. В этом случае все запросы, не прошедшие проверку подлинности, направляются для проверки подлинности с помощью Azure Active Directory.
6. Щелкните **Сохранить**.

Теперь вы можете использовать Azure Active Directory для проверки подлинности в приложении.

## <a name="advanced"> </a>(Альтернативный способ) Ручная настройка расширенных параметров Azure Active Directory
Можно также указать параметры конфигурации вручную. Этот способ рекомендуется, если клиент AAD, который вы хотите использовать, отличается от клиента, с которого вы выполняете вход в Azure. Чтобы выполнить настройку, сначала необходимо создать регистрацию в Azure Active Directory, а затем предоставить некоторые сведения о регистрации службе приложений.

### <a name="register"> </a>Регистрация приложения в Azure Active Directory
1. Войдите на [портал Azure]и перейдите к своему приложению. Скопируйте свой **URL-адрес**. Он будет использоваться для настройки приложения Azure Active Directory.
2. Войдите на [классический портал Azure] и перейдите в раздел **Active Directory**.
   
    ![][2]
3. Выберите свой каталог, а затем откройте вкладку **Приложения** в верхней части окна. Щелкните **Добавить** в нижней части окна, чтобы зарегистрировать новое приложение.
4. Выберите команду **Добавить приложение, разрабатываемое моей организацией**.
5. В мастере добавления приложения введите **имя** приложения и выберите тип **Веб-приложение и/или веб-API**. Затем щелкните "Далее".
6. В поле **URL-адрес входа** вставьте скопированный ранее URL-адрес приложения. Введите этот же URL-адрес в поле **URI кода приложения** . Затем щелкните "Далее".
7. После добавления приложения щелкните вкладку **Настройка** . Измените **URL-адрес ответа** в разделе **Единый вход** на URL-адрес вашего приложения, дополненный путем */.auth/login/aad/callback*. Например, `https://contoso.azurewebsites.net/.auth/login/aad/callback`. Убедитесь, что используете схему HTTPS.
   
    ![][3]
8. Щелкните **Сохранить**. Затем скопируйте **идентификатор клиента** для приложения. Вы настроите его позднее.
9. На нижней панели команд щелкните **Просмотр конечных точек**, скопируйте URL-адрес **документа метаданных федерации** и скачайте документ или откройте его в браузере.
10. В корневом элементе **EntityDescriptor** должен быть указан атрибут **entityID** в формате `https://sts.windows.net/`, за которым следует идентификатор GUID вашего клиента (идентификатор клиента). Скопируйте это значение — оно будет использоваться в качестве вашего **URL-адреса издателя**. Вы настроите его позднее.

### <a name="secrets"> </a>Добавление сведений об Azure Active Directory в приложение
1. Снова вернитесь на [портал Azure]и перейдите к своему приложению. Щелкните **Параметры**, а затем — **Аутентификация или авторизация**.
2. Если функция аутентификации или авторизации не включена, установите переключатель в положение **Вкл**.
3. Щелкните **Azure Active Directory**, а затем в разделе **Режим управления** выберите **Дополнительно**. Вставьте значения идентификатора клиента и URL-адреса издателя, полученные ранее. Нажмите кнопку **ОК**.
   
   ![][1]
   
   По умолчанию служба приложений обеспечивает проверку подлинности, но не ограничивает авторизованный доступ к содержимому сайта и API. Авторизация пользователей должна быть включена в код приложения.
4. (Необязательно.) Чтобы предоставить доступ к сайту только пользователям, прошедшим проверку подлинности в Azure Active Directory, установите для параметра **Предпринимаемое действие, если проверка подлинности для запроса не выполнена** значение **Войти с использованием Azure Active Directory**. В этом случае все запросы, не прошедшие проверку подлинности, направляются для проверки подлинности с помощью Azure Active Directory.
5. Щелкните **Сохранить**.

Теперь вы можете использовать Azure Active Directory для проверки подлинности в приложении.

## <a name="optional-configure-a-native-client-application"></a>(Необязательно.) Настройка собственного клиентского приложения
Azure Active Directory также позволяет регистрировать собственные клиенты, что обеспечивает больший контроль над сопоставлением разрешений. Это необходимо, если вы хотите выполнять вход с помощью библиотеки, например **библиотеки аутентификации Active Directory**.

1. Перейдите в раздел **Active Directory** на [классический портал Azure].
2. Выберите свой каталог, а затем откройте вкладку **Приложения** в верхней части окна. Щелкните **Добавить** в нижней части окна, чтобы зарегистрировать новое приложение.
3. Выберите команду **Добавить приложение, разрабатываемое моей организацией**.
4. В мастере добавления приложения введите **имя** приложения и выберите тип **Собственное клиентское приложение**. Затем щелкните "Далее".
5. В поле **URI перенаправления** введите конечную точку */.auth/login/done* веб-сайта в формате HTTPS. Это значение должно быть похоже на *https://contoso.azurewebsites.net/.auth/login/done*. При создании приложения Windows в качестве URI используйте [идентификатор безопасности пакета](app-service-mobile-dotnet-how-to-use-client-library.md#package-sid) .
6. После добавления собственного приложения щелкните вкладку **Настройка** . Найдите **идентификатор клиента** и запишите его.
7. Прокрутите страницу вниз до раздела **Разрешения для других приложений** и щелкните **Добавить приложение**.
8. Найдите ранее зарегистрированное веб-приложение и щелкните значок со знаком плюс. Затем установите флажок, чтобы закрыть диалоговое окно. Если веб-приложение не удается найти, перейдите к его регистрации и добавьте новый URL-адрес ответа (например, версию HTTP текущего URL-адреса), нажмите кнопку "Сохранить", а затем повторите эти шаги. Приложение должно появиться в списке.
9. Для только что добавленной записи откройте раскрывающийся список **Делегированные разрешения** и выберите пункт **Access (appName)** (Доступ к (имя_приложения)). Нажмите кнопку **Сохранить**.

Теперь вы настроили собственное клиентское приложение, у которого есть доступ к вашему приложению службы приложений.

## <a name="related-content"> </a>Связанная информация
[!INCLUDE [app-service-mobile-related-content-get-started-users](../../includes/app-service-mobile-related-content-get-started-users.md)]

<!-- Images. -->

[0]: ./media/app-service-mobile-how-to-configure-active-directory-authentication/mobile-app-aad-express-settings.png
[1]: ./media/app-service-mobile-how-to-configure-active-directory-authentication/mobile-app-aad-advanced-settings.png
[2]: ./media/app-service-mobile-how-to-configure-active-directory-authentication/app-service-navigate-aad.png
[3]: ./media/app-service-mobile-how-to-configure-active-directory-authentication/app-service-aad-app-configure.png

<!-- URLs. -->

[портал Azure]: https://portal.azure.com/
[классический портал Azure]: https://manage.windowsazure.com/
[alternative method]:#advanced
