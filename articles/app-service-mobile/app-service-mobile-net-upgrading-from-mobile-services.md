---
title: "Обновление приложения мобильных служб до службы приложений Azure"
description: "Узнайте, как без труда обновить приложение мобильных служб до мобильного приложения службы приложений."
services: app-service\mobile
documentationcenter: 
author: ggailey777
manager: syntaxc4
editor: 
ms.assetid: 9c0ac353-afb6-462b-ab94-d91b8247322f
ms.service: app-service-mobile
ms.workload: mobile
ms.tgt_pltfrm: mobile
ms.devlang: dotnet
ms.topic: article
ms.date: 10/01/2016
ms.author: glenga
ms.openlocfilehash: 81173b34d0d3b07c5c49d867b1dc5060c7311f12
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="upgrade-your-existing-net-azure-mobile-service-to-app-service"></a><span data-ttu-id="12711-103">Обновление существующего приложения мобильной службы Azure .NET до службы приложений</span><span class="sxs-lookup"><span data-stu-id="12711-103">Upgrade your existing .NET Azure Mobile Service to App Service</span></span>
<span data-ttu-id="12711-104">Мобильное приложение службы приложений — это новый способ сборки мобильных приложений с помощью Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="12711-104">App Service Mobile is a new way to build mobile applications using Microsoft Azure.</span></span> <span data-ttu-id="12711-105">Дополнительные сведения см. в статье [Общие сведения о мобильных приложениях].</span><span class="sxs-lookup"><span data-stu-id="12711-105">To learn more, see [What are Mobile Apps?].</span></span>

<span data-ttu-id="12711-106">В этой статье описывается процесс обновления имеющегося серверного приложения .NET мобильных служб Azure до нового мобильного приложения службы приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-106">This topic describes how to upgrade an existing .NET backend application from Azure Mobile Services to a new App Service Mobile Apps.</span></span> <span data-ttu-id="12711-107">Во время обновления существующее приложение мобильных служб может продолжать работать.</span><span class="sxs-lookup"><span data-stu-id="12711-107">While you perform this upgrade, your existing Mobile Services application can continue to operate.</span></span>   <span data-ttu-id="12711-108">Если необходимо выполнить обновление серверной части приложения Node.js, см. статью [Обновление существующего приложения мобильной службы Azure Node.js до службы приложений](app-service-mobile-node-backend-upgrading-from-mobile-services.md).</span><span class="sxs-lookup"><span data-stu-id="12711-108">If you need to upgrade a Node.js backend application, refer to [Upgrading your Node.js Mobile Services](app-service-mobile-node-backend-upgrading-from-mobile-services.md).</span></span>

<span data-ttu-id="12711-109">Когда мобильное серверное приложение обновляется до службы приложений Azure, оно получает доступ ко всем возможностям службы приложений. Тарификация при этом будет осуществляться в соответствии с [ценами службы приложений], а не мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="12711-109">When a mobile backend is upgraded to Azure App Service, it has access to all App Service features and are billed according to [App Service pricing], not Mobile Services pricing.</span></span>

## <a name="migrate-vs-upgrade"></a><span data-ttu-id="12711-110">Миграция или обновление</span><span class="sxs-lookup"><span data-stu-id="12711-110">Migrate vs. upgrade</span></span>
[!INCLUDE [app-service-mobile-migrate-vs-upgrade](../../includes/app-service-mobile-migrate-vs-upgrade.md)]

> [!TIP]
> <span data-ttu-id="12711-111">Перед обновлением рекомендуется [выполнить миграцию](app-service-mobile-migrating-from-mobile-services.md) .</span><span class="sxs-lookup"><span data-stu-id="12711-111">It is recommended that you [perform a migration](app-service-mobile-migrating-from-mobile-services.md) before going through an upgrade.</span></span> <span data-ttu-id="12711-112">Таким образом, к обеим версиям приложения будет применен один тарифный план службы, и дополнительные затраты будут исключены.</span><span class="sxs-lookup"><span data-stu-id="12711-112">This way, you can put both versions of your application on the same App Service Plan and incur no additional cost.</span></span>
>
>

### <a name="improvements-in-mobile-apps-net-server-sdk"></a><span data-ttu-id="12711-113">Улучшения в пакете SDK сервера .NET мобильных приложений</span><span class="sxs-lookup"><span data-stu-id="12711-113">Improvements in Mobile Apps .NET server SDK</span></span>
<span data-ttu-id="12711-114">Обновление до новой версии [пакета SDK для мобильных приложений](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) обеспечивает перечисленные ниже преимущества.</span><span class="sxs-lookup"><span data-stu-id="12711-114">Upgrading to the new [Mobile Apps SDK](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) provides the following benefits:</span></span>

* <span data-ttu-id="12711-115">Дополнительная гибкость для зависимостей NuGet.</span><span class="sxs-lookup"><span data-stu-id="12711-115">More flexibility on NuGet dependencies.</span></span> <span data-ttu-id="12711-116">Среда размещения больше не предоставляет собственные версии пакетов NuGet, позволяя вам использовать альтернативные совместимые версии.</span><span class="sxs-lookup"><span data-stu-id="12711-116">The hosting environment no longer provides its own versions of NuGet packages, so you can use alternative compatible versions.</span></span> <span data-ttu-id="12711-117">Однако при наличии новых критических исправлений или обновлений для системы безопасности для пакета SDK мобильного сервера или зависимостей службу потребуется обновить вручную.</span><span class="sxs-lookup"><span data-stu-id="12711-117">However, if there are new critical bugfixes or security updates to the Mobile Server SDK or dependencies, you must update your service manually.</span></span>
* <span data-ttu-id="12711-118">Дополнительная гибкость пакета SDK мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-118">More flexibility in the mobile SDK.</span></span> <span data-ttu-id="12711-119">Можно явно управлять настройкой конкретных компонентов и маршрутов, таких как проверка подлинности, API таблиц и конечная точка регистрации push-уведомлений.</span><span class="sxs-lookup"><span data-stu-id="12711-119">You can explicitly control which features and routes are set up, such as authentication, table APIs, and the push registration endpoint.</span></span> <span data-ttu-id="12711-120">Дополнительные сведения см. в статье [Работа с пакетом SDK для внутреннего сервера .NET для мобильных приложений Azure](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md).</span><span class="sxs-lookup"><span data-stu-id="12711-120">To learn more, see [How to use the .NET server SDK for Azure Mobile Apps](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md).</span></span>
* <span data-ttu-id="12711-121">Поддержка других маршрутов и типов проектов ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="12711-121">Support for other ASP.NET project types and routes.</span></span> <span data-ttu-id="12711-122">Теперь вы можете размещать контроллеры MVC и веб-API в том же проекте, что и проект мобильного внутреннего сервера.</span><span class="sxs-lookup"><span data-stu-id="12711-122">You can now host MVC and Web API controllers in the same project as your mobile backend project.</span></span>
* <span data-ttu-id="12711-123">Поддержка новых функций проверки подлинности службы приложений, которые позволяют использовать общую конфигурацию проверки подлинности для веб- и мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-123">Support for new App Service authentication features, which allow you to use a common authentication configuration across your web and mobile apps.</span></span>

## <span data-ttu-id="12711-124"><a name="overview"></a>Общие сведения об обновлении</span><span class="sxs-lookup"><span data-stu-id="12711-124"><a name="overview"></a>Basic upgrade overview</span></span>
<span data-ttu-id="12711-125">Во многих случаях обновление будет представлять собой просто переход на новый пакет SDK сервера для мобильных приложений и повторную публикацию кода в новом экземпляре мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-125">In many cases, upgrading will be as simple as switching to the new Mobile Apps server SDK and republishing your code onto a new Mobile App instance.</span></span> <span data-ttu-id="12711-126">Однако существует несколько сценариев, в которых потребуется дополнительная настройка, например расширенные сценарии проверки подлинности и работа с запланированными заданиями.</span><span class="sxs-lookup"><span data-stu-id="12711-126">There are, however some scenarios which will require some additional configuration, such as advanced authentication scenarios and working with scheduled jobs.</span></span> <span data-ttu-id="12711-127">Все они описываются в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="12711-127">Each of these is covered in the later sections.</span></span>

> [!TIP]
> <span data-ttu-id="12711-128">Перед началом обновления рекомендуется полностью ознакомиться с остальной частью этого раздела.</span><span class="sxs-lookup"><span data-stu-id="12711-128">It is advised that you read and understand the rest of this topic completely before starting an upgrade.</span></span> <span data-ttu-id="12711-129">Запишите все используемые функции, которые вызываются ниже.</span><span class="sxs-lookup"><span data-stu-id="12711-129">Make note of any features you use which are called out below.</span></span>
>
>

<span data-ttu-id="12711-130">Пакеты SDK клиента для мобильных служб **не совместимы** с новым пакетом SDK сервера для мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-130">The Mobile Services client SDKs are **not** compatible with the new Mobile Apps server SDK.</span></span> <span data-ttu-id="12711-131">Чтобы обеспечить непрерывность обслуживания приложения, не следует публиковать изменения на сайте, который в настоящее время обслуживает опубликованные клиенты.</span><span class="sxs-lookup"><span data-stu-id="12711-131">In order to provide continuity of service for your app, you should not publish changes to a site currently serving published clients.</span></span> <span data-ttu-id="12711-132">Вместо этого нужно создать новое мобильное приложение, которое является дубликатом.</span><span class="sxs-lookup"><span data-stu-id="12711-132">Instead, you should create a new mobile app that serves as a duplicate.</span></span> <span data-ttu-id="12711-133">Это приложение можно включить в тот же план службы приложений, чтобы избежать дополнительных финансовых затрат.</span><span class="sxs-lookup"><span data-stu-id="12711-133">You can put this application on the same App Service plan to avoid incurring additional financial cost.</span></span>

<span data-ttu-id="12711-134">После этого у вас будет две версии приложения: одна, которая остается без изменений и обслуживает опубликованные приложения на практике, и другая, которую можно обновить и ориентировать на новый выпуск клиента.</span><span class="sxs-lookup"><span data-stu-id="12711-134">You will then have two versions of the application: one which stays the same and serves published apps in the wild, and the other which you can then upgrade and target with a new client release.</span></span> <span data-ttu-id="12711-135">Переносить и тестировать код можно в любое удобное для вас время. Однако перед этим необходимо убедиться, что внесенные исправления применены к обеим версиям.</span><span class="sxs-lookup"><span data-stu-id="12711-135">You can move and test your code at your pace, but you should make sure that any bug fixes you make get applied to both.</span></span> <span data-ttu-id="12711-136">Если вы считаете, что до последней версии уже обновлено требуемое количество клиентских приложений, при желании можно удалить исходное перенесенное приложение.</span><span class="sxs-lookup"><span data-stu-id="12711-136">Once you feel that a desired number of client apps in the wild have updated to the latest version, you can delete the original migrated app if you desire.</span></span>

<span data-ttu-id="12711-137">Полная схема процесса обновления выглядит следующим образом.</span><span class="sxs-lookup"><span data-stu-id="12711-137">The full outline for the upgrade process is as follows:</span></span>

1. <span data-ttu-id="12711-138">Создание нового мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-138">Create a new Mobile App</span></span>
2. <span data-ttu-id="12711-139">Обновление проекта для использования новых пакетов SDK для сервера.</span><span class="sxs-lookup"><span data-stu-id="12711-139">Update the project to use the new Server SDKs</span></span>
3. <span data-ttu-id="12711-140">Выпуск новой версии клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-140">Release a new version of your client application</span></span>
4. <span data-ttu-id="12711-141">(Необязательно) Удаление исходного перенесенного экземпляра миграции</span><span class="sxs-lookup"><span data-stu-id="12711-141">(Optional) Delete your original migrated instance</span></span>

## <span data-ttu-id="12711-142"><a name="mobile-app-version"></a>Создание второго экземпляра приложения</span><span class="sxs-lookup"><span data-stu-id="12711-142"><a name="mobile-app-version"></a>Creating a second application instance</span></span>
<span data-ttu-id="12711-143">Первый этап обновления — создание ресурса мобильного приложения, в котором будет размещаться новая версия вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-143">The first step in upgrading is to create the Mobile App resource which will host the new version of your application.</span></span> <span data-ttu-id="12711-144">Если вы уже перенесли существующую мобильную службу, необходимо создать эту версию в том же плане размещения.</span><span class="sxs-lookup"><span data-stu-id="12711-144">If you have already migrated an existing mobile service, you will want to create this version on the same hosting plan.</span></span> <span data-ttu-id="12711-145">Откройте [портал Azure] и перейдите к перенесенному приложению.</span><span class="sxs-lookup"><span data-stu-id="12711-145">Open the [Azure portal] and navigate to your migrated application.</span></span> <span data-ttu-id="12711-146">Запишите план службы приложений, в котором оно выполняется.</span><span class="sxs-lookup"><span data-stu-id="12711-146">Make note of the App Service Plan it is running on.</span></span>

<span data-ttu-id="12711-147">Создайте второй экземпляр приложения, следуя [инструкциям по созданию серверной части .NET](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#create-app).</span><span class="sxs-lookup"><span data-stu-id="12711-147">Next, create the second application instance by following the [.NET backend creation instructions](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#create-app).</span></span> <span data-ttu-id="12711-148">При запросе на выбор плана службы приложений или "плана размещения" выберите план перенесенного приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-148">When prompted to select you App Service Plan or "hosting plan" choose the plan of your migrated application.</span></span>

<span data-ttu-id="12711-149">Скорее всего, вы захотите использовать ту же базу данных и концентратор уведомлений, которые использовали в мобильных службах.</span><span class="sxs-lookup"><span data-stu-id="12711-149">You will likely want to use the same database and Notification Hub as you did in Mobile Services.</span></span> <span data-ttu-id="12711-150">Вы можете скопировать эти значения. Для этого откройте [портал Azure], перейдите к исходному приложению и выберите **Параметры** > **Параметры приложения**.</span><span class="sxs-lookup"><span data-stu-id="12711-150">You can copy these values by opening [Azure portal] and navigating to the original application, then click **Settings** > **Application settings**.</span></span> <span data-ttu-id="12711-151">В разделе **Строки подключения** скопируйте `MS_NotificationHubConnectionString` и `MS_TableConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="12711-151">Under **Connection Strings**, copy `MS_NotificationHubConnectionString` and `MS_TableConnectionString`.</span></span> <span data-ttu-id="12711-152">Перейдите на новый сайт обновления и вставьте эти значения, перезаписав все существующие значения.</span><span class="sxs-lookup"><span data-stu-id="12711-152">Navigate to your new upgrade site and paste them in, overwriting any existing values.</span></span> <span data-ttu-id="12711-153">Повторите эту процедуру для других необходимых параметров приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-153">Repeat this process for any other application settings your app needs.</span></span> <span data-ttu-id="12711-154">Если перенесенная служба не используется, строки подключения и параметры приложения можно просмотреть на вкладке **Настройка** раздела "Мобильные службы" на [классическом портале Azure].</span><span class="sxs-lookup"><span data-stu-id="12711-154">If not using a migrated service, you can read connection strings and app settings from the **Configure** tab of the Mobile Services section of the [Azure classic portal].</span></span>

<span data-ttu-id="12711-155">Сделайте копию проекта ASP.NET для приложения и опубликуйте его на новом сайте.</span><span class="sxs-lookup"><span data-stu-id="12711-155">Make a copy of the ASP.NET project for your application and publish it to your new site.</span></span> <span data-ttu-id="12711-156">Используя копию клиентского приложения, обновленную с помощью нового URL-адреса, убедитесь, что все работает правильно.</span><span class="sxs-lookup"><span data-stu-id="12711-156">Using a copy of your client application updated with the new URL, validate that everything works as expected.</span></span>

## <a name="updating-the-server-project"></a><span data-ttu-id="12711-157">Обновление серверного проекта</span><span class="sxs-lookup"><span data-stu-id="12711-157">Updating the server project</span></span>
<span data-ttu-id="12711-158">Мобильные приложения предоставляют новый [пакет SDK для сервера мобильных приложений] , который предоставляет практически те же функции, что и среда выполнения мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="12711-158">Mobile Apps provides a new [Mobile App Server SDK] which provides much of the same functionality as the Mobile Services runtime.</span></span> <span data-ttu-id="12711-159">Во-первых, следует удалить все ссылки на пакеты мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="12711-159">First, you should remove all references to the Mobile Services packages.</span></span> <span data-ttu-id="12711-160">В диспетчере пакетов NuGet найдите `WindowsAzure.MobileServices.Backend`.</span><span class="sxs-lookup"><span data-stu-id="12711-160">In the NuGet package manager, search for `WindowsAzure.MobileServices.Backend`.</span></span> <span data-ttu-id="12711-161">Для большинства пакетов здесь будет отображаться несколько пакетов, включая `WindowsAzure.MobileServices.Backend.Tables` и `WindowsAzure.MobileServices.Backend.Entity`.</span><span class="sxs-lookup"><span data-stu-id="12711-161">Most apps will see several packages here, including `WindowsAzure.MobileServices.Backend.Tables` and `WindowsAzure.MobileServices.Backend.Entity`.</span></span> <span data-ttu-id="12711-162">В этом случае необходимо начать удаление с пакета в самой нижней части в дереве зависимостей, такого как `Entity`.</span><span class="sxs-lookup"><span data-stu-id="12711-162">In such a case, start with the lowest package in the dependency tree, such as `Entity`, and remove it.</span></span> <span data-ttu-id="12711-163">При выводе запроса не удаляйте все зависимые пакеты.</span><span class="sxs-lookup"><span data-stu-id="12711-163">When prompted, do not remove all dependant packages.</span></span> <span data-ttu-id="12711-164">Повторяйте этот процесс, пока не будет удален сам `WindowsAzure.MobileServices.Backend` .</span><span class="sxs-lookup"><span data-stu-id="12711-164">Repeat this process until you have removed `WindowsAzure.MobileServices.Backend` itself.</span></span>

<span data-ttu-id="12711-165">На этом этапе в вашем распоряжении будет находиться проект, который больше не ссылается на пакеты SDK мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="12711-165">At this point you will have a project that no longer references Mobile Services SDKs.</span></span>

<span data-ttu-id="12711-166">Затем выполняется добавление ссылок на пакет SDK для мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-166">Next you will add references the Mobile Apps SDK.</span></span> <span data-ttu-id="12711-167">Для данного обновления большинство разработчиков будет загружать и устанавливать пакет `Microsoft.Azure.Mobile.Server.Quickstart`, тем самым извлекая весь необходимый набор.</span><span class="sxs-lookup"><span data-stu-id="12711-167">For this upgrade, most developers will want to download and install the `Microsoft.Azure.Mobile.Server.Quickstart` package, as this will pull in the entire required set.</span></span>

<span data-ttu-id="12711-168">Различия между пакетами SDK приведут к возникновению ряда ошибок компилятора, однако их легко устранить (см. оставшуюся часть этого раздела).</span><span class="sxs-lookup"><span data-stu-id="12711-168">There will be quite a few compiler errors resulting from differences between the SDKs, but these are easy to address and are covered in the rest of this section.</span></span>

### <a name="base-configuration"></a><span data-ttu-id="12711-169">Базовая конфигурация</span><span class="sxs-lookup"><span data-stu-id="12711-169">Base configuration</span></span>
<span data-ttu-id="12711-170">Затем в файле WebApiConfig.cs можно заменить</span><span class="sxs-lookup"><span data-stu-id="12711-170">Then, in WebApiConfig.cs, you can replace:</span></span>

        // Use this class to set configuration options for your mobile service
        ConfigOptions options = new ConfigOptions();

        // Use this class to set WebAPI configuration options
        HttpConfiguration config = ServiceConfig.Initialize(new ConfigBuilder(options));

<span data-ttu-id="12711-171">на</span><span class="sxs-lookup"><span data-stu-id="12711-171">with</span></span>

        HttpConfiguration config = new HttpConfiguration();
        new MobileAppConfiguration()
            .UseDefaultConfiguration()
        .ApplyTo(config);

> [!NOTE]
> <span data-ttu-id="12711-172">Дополнительные сведения о новом пакете SDK для сервера .NET и о том, как добавить или удалить компоненты из приложения, см. в статье [Работа с пакетом SDK для внутреннего сервера .NET для мобильных приложений Azure].</span><span class="sxs-lookup"><span data-stu-id="12711-172">If you wish to learn more about the new .NET server SDK and how to add/remove features from your app, please see the [How to use the .NET server SDK] topic.</span></span>
>
>

<span data-ttu-id="12711-173">Если в приложении используются функции проверки подлинности, также потребуется зарегистрировать ПО промежуточного слоя OWIN.</span><span class="sxs-lookup"><span data-stu-id="12711-173">If your app makes use of the authentication features, you will also need to register an OWIN middleware.</span></span> <span data-ttu-id="12711-174">В этом случае приведенный выше код конфигурации следует переместить в новый класс запуска OWIN.</span><span class="sxs-lookup"><span data-stu-id="12711-174">In this case, you should move the above configuration code into a new OWIN Startup class.</span></span>

1. <span data-ttu-id="12711-175">Добавьте пакет NuGet `Microsoft.Owin.Host.SystemWeb` , если он еще не добавлен в проект.</span><span class="sxs-lookup"><span data-stu-id="12711-175">Add the NuGet package `Microsoft.Owin.Host.SystemWeb` if it is not already included in your project.</span></span>
2. <span data-ttu-id="12711-176">В Visual Studio щелкните правой кнопкой мыши проект и последовательно выберите **Добавить** -> **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="12711-176">In Visual Studio, right click on your project and select **Add** -> **New Item**.</span></span> <span data-ttu-id="12711-177">Выберите **Интернет** -> **Общие** -> **Класс Startup OWIN**.</span><span class="sxs-lookup"><span data-stu-id="12711-177">Select **Web** -> **General** -> **OWIN Startup class**.</span></span>
3. <span data-ttu-id="12711-178">Перенесите приведенный выше код для MobileAppConfiguration из `WebApiConfig.Register()` в метод `Configuration()` нового класса запуска.</span><span class="sxs-lookup"><span data-stu-id="12711-178">Move the above code for MobileAppConfiguration from `WebApiConfig.Register()` to the `Configuration()` method of your new startup class.</span></span>

<span data-ttu-id="12711-179">Убедитесь, что в конце метода `Configuration()` указано следующее:</span><span class="sxs-lookup"><span data-stu-id="12711-179">Make sure the `Configuration()` method ends with:</span></span>

        app.UseWebApi(config)
        app.UseAppServiceAuthentication(config);

<span data-ttu-id="12711-180">Дополнительные изменения, связанные с проверкой подлинности, рассматриваются в разделе о полной проверке подлинности.</span><span class="sxs-lookup"><span data-stu-id="12711-180">There are additional changes related to authentication which are covered in the full authentication section below.</span></span>

### <a name="working-with-data"></a><span data-ttu-id="12711-181">Работа с данными</span><span class="sxs-lookup"><span data-stu-id="12711-181">Working with Data</span></span>
<span data-ttu-id="12711-182">В мобильных службах имя мобильного приложения являлось именем схемы по умолчанию в настройках Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="12711-182">In Mobile Services, the mobile app name served as the default schema name in the Entity Framework setup.</span></span>

<span data-ttu-id="12711-183">Чтобы убедиться, что указывается та же схема, что и прежде, используйте следующий код, чтобы задать схему в DbContext для вашего приложения:</span><span class="sxs-lookup"><span data-stu-id="12711-183">To ensure that you have the same schema being referenced as before, use the following to set the schema in the DbContext for your application:</span></span>

        string schema = System.Configuration.ConfigurationManager.AppSettings.Get("MS_MobileServiceName");

<span data-ttu-id="12711-184">В этом случае проверьте, что задан параметр MS_MobileServiceName.</span><span class="sxs-lookup"><span data-stu-id="12711-184">Please make sure you have MS_MobileServiceName set if you do the above.</span></span> <span data-ttu-id="12711-185">Если имя схемы в приложении было настроено ранее, можно также указать другое имя.</span><span class="sxs-lookup"><span data-stu-id="12711-185">You can also provide another schema name if your application customized this previously.</span></span>

### <a name="system-properties"></a><span data-ttu-id="12711-186">Свойства системы</span><span class="sxs-lookup"><span data-stu-id="12711-186">System Properties</span></span>
#### <a name="naming"></a><span data-ttu-id="12711-187">Именование</span><span class="sxs-lookup"><span data-stu-id="12711-187">Naming</span></span>
<span data-ttu-id="12711-188">В пакете SDK сервера для мобильных служб Azure свойства системы всегда содержат префикс в виде двойного символа подчеркивания (`__`) для следующих свойств:</span><span class="sxs-lookup"><span data-stu-id="12711-188">In the Azure Mobile Services server SDK, system properties always contain a double underscore (`__`) prefix for the properties:</span></span>

* <span data-ttu-id="12711-189">__createdAt</span><span class="sxs-lookup"><span data-stu-id="12711-189">__createdAt</span></span>
* <span data-ttu-id="12711-190">__updatedAt</span><span class="sxs-lookup"><span data-stu-id="12711-190">__updatedAt</span></span>
* <span data-ttu-id="12711-191">__deleted</span><span class="sxs-lookup"><span data-stu-id="12711-191">__deleted</span></span>
* <span data-ttu-id="12711-192">__version</span><span class="sxs-lookup"><span data-stu-id="12711-192">__version</span></span>

<span data-ttu-id="12711-193">Пакеты SDK клиента мобильных служб имеют специальную логику для анализа свойства системы в данном формате.</span><span class="sxs-lookup"><span data-stu-id="12711-193">The Mobile Services client SDKs have special logic for parsing system properties in this format.</span></span>

<span data-ttu-id="12711-194">В мобильных приложениях Azure свойства системы больше не имеют особого формата, и им заданы следующие имена:</span><span class="sxs-lookup"><span data-stu-id="12711-194">In Azure Mobile Apps, system properties no longer have a special format and have the following names:</span></span>

* <span data-ttu-id="12711-195">дата создания</span><span class="sxs-lookup"><span data-stu-id="12711-195">createdAt</span></span>
* <span data-ttu-id="12711-196">дата обновления</span><span class="sxs-lookup"><span data-stu-id="12711-196">updatedAt</span></span>
* <span data-ttu-id="12711-197">deleted</span><span class="sxs-lookup"><span data-stu-id="12711-197">deleted</span></span>
* <span data-ttu-id="12711-198">версия</span><span class="sxs-lookup"><span data-stu-id="12711-198">version</span></span>

<span data-ttu-id="12711-199">В пакетах SDK клиента для мобильных приложений используются новые имена свойств системы, поэтому изменять клиентский код не требуется.</span><span class="sxs-lookup"><span data-stu-id="12711-199">The Mobile Apps client SDKs use the new system properties names, so no changes are required to client code.</span></span> <span data-ttu-id="12711-200">Однако если вызовы REST к службе выполняются напрямую, следует соответствующим образом изменить запросы.</span><span class="sxs-lookup"><span data-stu-id="12711-200">However, if you are directly making REST calls to your service then you should change your queries accordingly.</span></span>

#### <a name="local-store"></a><span data-ttu-id="12711-201">Локальное хранилище</span><span class="sxs-lookup"><span data-stu-id="12711-201">Local store</span></span>
<span data-ttu-id="12711-202">Изменения имен свойств системы означают, что локальная база данных автономной синхронизации для мобильных служб не совместима с мобильными приложениями.</span><span class="sxs-lookup"><span data-stu-id="12711-202">The changes to the names of system properties mean that an offline sync local database for Mobile Services is not compatible with Mobile Apps.</span></span> <span data-ttu-id="12711-203">По возможности следует избегать обновления клиентский приложений с мобильных служб до мобильных приложений до тех пор, пока ожидающие изменения не будут отправлены на сервер.</span><span class="sxs-lookup"><span data-stu-id="12711-203">If possible, you should avoid upgrading client apps from Mobile Services to Mobile Apps until after pending changes have been sent to the server.</span></span> <span data-ttu-id="12711-204">После этого обновленное приложение должно использовать новое имя файла базы данных.</span><span class="sxs-lookup"><span data-stu-id="12711-204">Then, the upgraded app should use a new database filename.</span></span>

<span data-ttu-id="12711-205">Если клиентское приложение обновляется с мобильных служб до мобильных приложений при наличии в очереди операций ожидающих автономных изменений, системная база данных должна быть обновлена для использования новых имен столбцов.</span><span class="sxs-lookup"><span data-stu-id="12711-205">If a client app is upgraded from Mobile Services to Mobile Apps while there are pending offline changes in the operation queue, then the system database must be updated to use the new column names.</span></span> <span data-ttu-id="12711-206">В iOS изменить имена столбцов можно с помощью упрощенных миграций.</span><span class="sxs-lookup"><span data-stu-id="12711-206">On iOS, this can be achieved using lightweight migrations to change the column names.</span></span> <span data-ttu-id="12711-207">В ОС Android и управляемом клиенте .NET необходимо написать настраиваемый SQL для переименования столбцов для таблиц объектов данных.</span><span class="sxs-lookup"><span data-stu-id="12711-207">On Android and the .NET managed client, you should write custom SQL to rename the columns for your data object tables.</span></span>

<span data-ttu-id="12711-208">В iOS необходимо изменить схему основных данных для сущностей данных в соответствии с приведенными ниже условиями.</span><span class="sxs-lookup"><span data-stu-id="12711-208">On iOS, you should change your Core Data schema for your data entities to match the following.</span></span> <span data-ttu-id="12711-209">Обратите внимание, что у свойств `createdAt`, `updatedAt` и `version` больше нет префикса `ms_`.</span><span class="sxs-lookup"><span data-stu-id="12711-209">Note that the properties `createdAt`, `updatedAt` and `version` no longer have an `ms_` prefix:</span></span>

| <span data-ttu-id="12711-210">Атрибут</span><span class="sxs-lookup"><span data-stu-id="12711-210">Attribute</span></span> | <span data-ttu-id="12711-211">Тип</span><span class="sxs-lookup"><span data-stu-id="12711-211">Type</span></span> | <span data-ttu-id="12711-212">Примечание.</span><span class="sxs-lookup"><span data-stu-id="12711-212">Note</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12711-213">id</span><span class="sxs-lookup"><span data-stu-id="12711-213">id</span></span> |<span data-ttu-id="12711-214">Строка, помеченная как обязательная</span><span class="sxs-lookup"><span data-stu-id="12711-214">String, marked required</span></span> |<span data-ttu-id="12711-215">первичный ключ в удаленном хранилище</span><span class="sxs-lookup"><span data-stu-id="12711-215">primary key in remote store</span></span> |
| <span data-ttu-id="12711-216">дата создания</span><span class="sxs-lookup"><span data-stu-id="12711-216">createdAt</span></span> |<span data-ttu-id="12711-217">Дата</span><span class="sxs-lookup"><span data-stu-id="12711-217">Date</span></span> |<span data-ttu-id="12711-218">(необязательно) сопоставляется с системным свойством createdAt</span><span class="sxs-lookup"><span data-stu-id="12711-218">(optional) maps to createdAt system property</span></span> |
| <span data-ttu-id="12711-219">дата обновления</span><span class="sxs-lookup"><span data-stu-id="12711-219">updatedAt</span></span> |<span data-ttu-id="12711-220">Дата</span><span class="sxs-lookup"><span data-stu-id="12711-220">Date</span></span> |<span data-ttu-id="12711-221">(необязательно) сопоставляется с системным свойством updatedAt</span><span class="sxs-lookup"><span data-stu-id="12711-221">(optional) maps to updatedAt system property</span></span> |
| <span data-ttu-id="12711-222">версия</span><span class="sxs-lookup"><span data-stu-id="12711-222">version</span></span> |<span data-ttu-id="12711-223">Строка</span><span class="sxs-lookup"><span data-stu-id="12711-223">String</span></span> |<span data-ttu-id="12711-224">(необязательно) используется для обнаружения конфликтов, сопоставляется со свойством version</span><span class="sxs-lookup"><span data-stu-id="12711-224">(optional) used to detect conflicts, maps to version</span></span> |

#### <a name="querying-system-properties"></a><span data-ttu-id="12711-225">Выполнение запросов к свойствам системы</span><span class="sxs-lookup"><span data-stu-id="12711-225">Querying system properties</span></span>
<span data-ttu-id="12711-226">В мобильных службах Azure свойства системы не отправляются по умолчанию. Однако это происходит только в том случае, когда они запрашиваются с помощью строки запроса `__systemProperties`.</span><span class="sxs-lookup"><span data-stu-id="12711-226">In Azure Mobile Services, system properties are not sent by default, but only when they are requested using the query string `__systemProperties`.</span></span> <span data-ttu-id="12711-227">Напротив, свойства системы мобильных приложений Azure **всегда выбираются**, так как они являются частью объектной модели серверного пакета SDK.</span><span class="sxs-lookup"><span data-stu-id="12711-227">In contrast, in Azure Mobile Apps system properties are **always selected** since they are part of the server SDK object model.</span></span>

<span data-ttu-id="12711-228">Это изменение влияет главным образом на настраиваемые реализации диспетчеров доменов, такие как расширения `MappedEntityDomainManager`.</span><span class="sxs-lookup"><span data-stu-id="12711-228">This change mainly impacts custom implementations of domain managers, such as extensions of `MappedEntityDomainManager`.</span></span> <span data-ttu-id="12711-229">Если клиент в мобильных службах никогда не запрашивает свойства системы, можно использовать `MappedEntityDomainManager` , который на самом деле не сопоставляет все свойства.</span><span class="sxs-lookup"><span data-stu-id="12711-229">In Mobile Services, if a client never requests any system properties, it is possible to use a `MappedEntityDomainManager` that does not actually map all properties.</span></span> <span data-ttu-id="12711-230">Однако в мобильных приложениях Azure эти несопоставленные свойства приведут к возникновению ошибок в запросах GET.</span><span class="sxs-lookup"><span data-stu-id="12711-230">However, in Azure Mobile Apps, these unmapped properties will cause an error in GET queries.</span></span>

<span data-ttu-id="12711-231">Самым простым способом решения этой проблемы является изменение объектов DTO таким образом, чтобы они наследовали `ITableData` вместо `EntityData`.</span><span class="sxs-lookup"><span data-stu-id="12711-231">The easiest way to resolve the issue is to modify your DTOs so that they inherit from `ITableData` instead of `EntityData`.</span></span> <span data-ttu-id="12711-232">Затем добавьте атрибут `[NotMapped]` в поля, которые следует пропустить.</span><span class="sxs-lookup"><span data-stu-id="12711-232">Then, add the `[NotMapped]` attribute to the fields that should be omitted.</span></span>

<span data-ttu-id="12711-233">Например, следующий код определяет `TodoItem` без свойств системы:</span><span class="sxs-lookup"><span data-stu-id="12711-233">For example, the following defines `TodoItem` with no system properties:</span></span>

    using System.ComponentModel.DataAnnotations.Schema;

    public class TodoItem : ITableData
    {
        public string Text { get; set; }

        public bool Complete { get; set; }

        public string Id { get; set; }

        [NotMapped]
        public DateTimeOffset? CreatedAt { get; set; }

        [NotMapped]
        public DateTimeOffset? UpdatedAt { get; set; }

        [NotMapped]
        public bool Deleted { get; set; }

        [NotMapped]
        public byte[] Version { get; set; }
    }

<span data-ttu-id="12711-234">Примечание. Если возникли ошибки в `NotMapped`, добавьте ссылку на сборку `System.ComponentModel.DataAnnotations`.</span><span class="sxs-lookup"><span data-stu-id="12711-234">Note: if you get errors on `NotMapped`, add a reference to the assembly `System.ComponentModel.DataAnnotations`.</span></span>

### <a name="cors"></a><span data-ttu-id="12711-235">CORS</span><span class="sxs-lookup"><span data-stu-id="12711-235">CORS</span></span>
<span data-ttu-id="12711-236">Мобильные службы обеспечивают определенную поддержку CORS путем заключения решения ASP.NET CORS в оболочку.</span><span class="sxs-lookup"><span data-stu-id="12711-236">Mobile Services included some support for CORS by wrapping the ASP.NET CORS solution.</span></span> <span data-ttu-id="12711-237">Этот уровень заключения был удален в целях предоставления разработчикам дополнительного контроля для непосредственного использования [поддержки ASP.NET CORS](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api).</span><span class="sxs-lookup"><span data-stu-id="12711-237">This wrapping layer has been removed to give the developer more control, so you can directly leverage [ASP.NET CORS support](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api).</span></span>

<span data-ttu-id="12711-238">Основные проблемы при использовании CORS заключаются в необходимости разрешить заголовки `eTag` и `Location` для правильной работы пакетов SDK клиента.</span><span class="sxs-lookup"><span data-stu-id="12711-238">The main areas of concern if using CORS are that the `eTag` and `Location` headers must be allowed in order for the client SDKs to work properly.</span></span>

### <a name="push-notifications"></a><span data-ttu-id="12711-239">Push-уведомления</span><span class="sxs-lookup"><span data-stu-id="12711-239">Push Notifications</span></span>
<span data-ttu-id="12711-240">Для отправки основной элемент, который может отсутствовать в пакете SDK для сервера, — это класс PushRegistrationHandler.</span><span class="sxs-lookup"><span data-stu-id="12711-240">For push, the main item that you may find missing from the Server SDK is the PushRegistrationHandler class.</span></span> <span data-ttu-id="12711-241">Регистрации в мобильных приложениях обрабатываются немного по-другому, и способы регистрации без тегов включены по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="12711-241">Registrations are handled slightly differently in Mobile Apps, and tagless registrations are enabled by default.</span></span> <span data-ttu-id="12711-242">Управление тегами осуществляется с помощью пользовательских API.</span><span class="sxs-lookup"><span data-stu-id="12711-242">Managing tags may be accomplished by using custom APIs.</span></span> <span data-ttu-id="12711-243">Дополнительные сведения см. в инструкциях по [регистрации для использования тегов](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#tags).</span><span class="sxs-lookup"><span data-stu-id="12711-243">Please see the [registering for tags](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#tags) instructions for more information.</span></span>

### <a name="scheduled-jobs"></a><span data-ttu-id="12711-244">Запланированные задания</span><span class="sxs-lookup"><span data-stu-id="12711-244">Scheduled Jobs</span></span>
<span data-ttu-id="12711-245">Запланированные задания не встраиваются в мобильные приложения, поэтому все существующие задания в серверной части .NET потребуется обновлять по отдельности.</span><span class="sxs-lookup"><span data-stu-id="12711-245">Scheduled jobs are not built into Mobile Apps, so any existing jobs that you have in your .NET backend will need to be upgraded individually.</span></span> <span data-ttu-id="12711-246">Один из вариантов — создать запланированное [веб-задание] на сайте кода мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-246">One option is to create a scheduled [Web Job] on the Mobile App code site.</span></span> <span data-ttu-id="12711-247">Можно также настроить контроллер, содержащий код задания, и задать в [планировщике Azure] вызов конечной точки по ожидаемому расписанию.</span><span class="sxs-lookup"><span data-stu-id="12711-247">You could also set up a controller that holds your job code and configure the [Azure Scheduler] to hit that endpoint on the expected schedule.</span></span>

### <a name="miscellaneous-changes"></a><span data-ttu-id="12711-248">Прочие изменения</span><span class="sxs-lookup"><span data-stu-id="12711-248">Miscellaneous changes</span></span>
<span data-ttu-id="12711-249">Теперь все классы ApiController, которые будут использоваться мобильным клиентом, должны иметь атрибут `[MobileAppController]` .</span><span class="sxs-lookup"><span data-stu-id="12711-249">All ApiControllers which will be consumed by a mobile client must now have the `[MobileAppController]` attribute.</span></span> <span data-ttu-id="12711-250">Это больше не является условием по умолчанию, поэтому другие классы ApiController не будут затрагиваться мобильными средствами форматирования.</span><span class="sxs-lookup"><span data-stu-id="12711-250">This is no longer included by default so that other ApiControllers to go unaffected by the mobile formatters.</span></span>

<span data-ttu-id="12711-251">Объект `ApiServices` больше не входит в пакет SDK.</span><span class="sxs-lookup"><span data-stu-id="12711-251">The `ApiServices` object is no longer part of the SDK.</span></span> <span data-ttu-id="12711-252">Для доступа к параметрам мобильного приложения можно использовать следующее:</span><span class="sxs-lookup"><span data-stu-id="12711-252">To access Mobile App settings, you can use the following:</span></span>

    MobileAppSettingsDictionary settings = this.Configuration.GetMobileAppSettingsProvider().GetMobileAppSettings();

<span data-ttu-id="12711-253">Аналогично, теперь ведение журнала выполняется с помощью стандартной записи трассировки ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="12711-253">Similarly, logging is now accomplished using the standard ASP.NET trace writing:</span></span>

    ITraceWriter traceWriter = this.Configuration.Services.GetTraceWriter();
    traceWriter.Info("Hello, World");  

## <span data-ttu-id="12711-254"><a name="authentication"></a>Рекомендации по проверке подлинности</span><span class="sxs-lookup"><span data-stu-id="12711-254"><a name="authentication"></a>Authentication considerations</span></span>
<span data-ttu-id="12711-255">Компоненты проверки подлинности мобильных служб перемещены в функцию проверки подлинности и авторизации службы приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-255">The authentication components of Mobile Services have now been moved into the App Service Authentication/Authorization feature.</span></span> <span data-ttu-id="12711-256">Дополнительные сведения о том, как это сделать для сайта, см. в статье [Add authentication to your mobile app](app-service-mobile-ios-get-started-users.md) (Добавление проверки подлинности в мобильное приложение).</span><span class="sxs-lookup"><span data-stu-id="12711-256">You can learn about enabling this for your site by reading the [Add authentication to your mobile app](app-service-mobile-ios-get-started-users.md) topic.</span></span>

<span data-ttu-id="12711-257">При работе с некоторыми поставщиками, например AAD, Facebook и Google, требуется возможность использования существующей регистрации из копии приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-257">For some providers, such as AAD, Facebook, and Google, you should be able to leverage the existing registration from your copy application.</span></span> <span data-ttu-id="12711-258">Нужно просто перейти на портал поставщика удостоверений и добавить к регистрации новый URL-адрес перенаправления.</span><span class="sxs-lookup"><span data-stu-id="12711-258">You simply need to navigate to the identity provider's portal and add a new redirect URL to the registration.</span></span> <span data-ttu-id="12711-259">Затем настройте проверку подлинности и авторизацию службы приложений с идентификатором клиента и секретом.</span><span class="sxs-lookup"><span data-stu-id="12711-259">Then configure App Service Authentication/Authorization with the client ID and secret.</span></span>

### <a name="controller-action-authorization"></a><span data-ttu-id="12711-260">Авторизация действий контроллера</span><span class="sxs-lookup"><span data-stu-id="12711-260">Controller action authorization</span></span>
<span data-ttu-id="12711-261">Теперь все экземпляры атрибута `[AuthorizeLevel(AuthorizationLevel.User)]` необходимо изменить для использования стандартного атрибута ASP.NET `[Authorize]`.</span><span class="sxs-lookup"><span data-stu-id="12711-261">Any instances of the `[AuthorizeLevel(AuthorizationLevel.User)]` attribute must now be changed to use the standard ASP.NET `[Authorize]` attribute.</span></span> <span data-ttu-id="12711-262">Кроме того, теперь контроллеры являются анонимными по умолчанию, как и в других приложениях ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="12711-262">Additionally, controllers are now Anonymous by default, as in other ASP.NET applications.</span></span>
<span data-ttu-id="12711-263">Если вы использовали один из других параметров AuthorizeLevel, например Admin или Application, обратите внимание, что их больше нет.</span><span class="sxs-lookup"><span data-stu-id="12711-263">If you were using one of the other AuthorizeLevel options, such as Admin or Application, please note that these are gone.</span></span> <span data-ttu-id="12711-264">Вместо этого можно настроить атрибут AuthorizationFilters для общих секретов или настроить участника службы AAD для безопасного выполнения вызовов между службами.</span><span class="sxs-lookup"><span data-stu-id="12711-264">You can instead set up AuthorizationFilters for shared secrets or configure an AAD Service Principal to enable service-to-service calls securely.</span></span>

### <a name="getting-additional-user-information"></a><span data-ttu-id="12711-265">Получение дополнительных сведений о пользователе</span><span class="sxs-lookup"><span data-stu-id="12711-265">Getting additional user information</span></span>
<span data-ttu-id="12711-266">Дополнительные сведения о пользователях, включая маркеры доступа, можно получить с помощью метода `GetAppServiceIdentityAsync()` .</span><span class="sxs-lookup"><span data-stu-id="12711-266">You can get additional user information, including access tokens through the `GetAppServiceIdentityAsync()` method:</span></span>

        FacebookCredentials creds = await this.User.GetAppServiceIdentityAsync<FacebookCredentials>();

<span data-ttu-id="12711-267">Кроме того, если приложение получает зависимости в идентификаторах пользователей, например сохраняет их в базе данных, важно обратить внимание на то, что идентификаторы пользователей в мобильных службах и мобильных приложениях служб приложений отличаются.</span><span class="sxs-lookup"><span data-stu-id="12711-267">Additionally, if your application takes dependencies on user IDs, such as storing them in a database, it is important to note that the user IDs between Mobile Services and App Service Mobile Apps are different.</span></span> <span data-ttu-id="12711-268">Однако можно по-прежнему получить идентификатор пользователя мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="12711-268">You can still get the Mobile Services User ID, though.</span></span> <span data-ttu-id="12711-269">Все подклассы ProviderCredentials имеют свойство UserId.</span><span class="sxs-lookup"><span data-stu-id="12711-269">All of the ProviderCredentials subclasses have a UserId property.</span></span> <span data-ttu-id="12711-270">Продолжим с предыдущим примером:</span><span class="sxs-lookup"><span data-stu-id="12711-270">So continuing from the example before:</span></span>

        string mobileServicesUserId = creds.Provider + ":" + creds.UserId;

<span data-ttu-id="12711-271">Если ваше приложение получает зависимости от идентификаторов пользователей, важно использовать тот же способ регистрации и того же поставщика удостоверений, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="12711-271">If your app does take any dependencies on user IDs, it is important that you leverage the same registration with an identity provider if possible.</span></span> <span data-ttu-id="12711-272">Идентификаторы пользователей обычно относятся к использованному способу регистрации приложений, поэтому новый способ регистрации может вызвать проблемы с сопоставлением пользователей с их данными.</span><span class="sxs-lookup"><span data-stu-id="12711-272">User IDs are typically scoped to the application registration that was used, so introducing a new registration could create problems with matching users to their data.</span></span>

### <a name="custom-authentication"></a><span data-ttu-id="12711-273">Настраиваемая проверка подлинности</span><span class="sxs-lookup"><span data-stu-id="12711-273">Custom authentication</span></span>
<span data-ttu-id="12711-274">Если ваше приложение использует решение для настраиваемой проверки подлинности, необходимо убедиться, что обновленный сайт имеет доступ к системе.</span><span class="sxs-lookup"><span data-stu-id="12711-274">If your app is using a custom authentication solution, you will want to make sure that the upgraded site has access to the system.</span></span> <span data-ttu-id="12711-275">Инструкции по интеграции решения см. в статье [Работа с пакетом SDK для внутреннего сервера .NET для мобильных приложений Azure].</span><span class="sxs-lookup"><span data-stu-id="12711-275">Follow the new instructions for custom authentication in the [.NET server SDK overview] to integrate your solution.</span></span> <span data-ttu-id="12711-276">Обратите внимание, что компоненты настраиваемой проверки подлинности все еще находятся на стадии предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="12711-276">Please note that the custom authentication components are still in preview.</span></span>

## <span data-ttu-id="12711-277"><a name="updating-clients"></a>Обновление клиентов</span><span class="sxs-lookup"><span data-stu-id="12711-277"><a name="updating-clients"></a>Updating clients</span></span>
<span data-ttu-id="12711-278">После получения рабочей серверной части мобильных приложений вы можете работать с новой версией клиентского приложения, которое использует эту серверную часть.</span><span class="sxs-lookup"><span data-stu-id="12711-278">Once you have an operational Mobile App backend, you can work on a new version of your client application which consumes it.</span></span> <span data-ttu-id="12711-279">Мобильные приложения также содержат новую версию клиентских пакетов SDK. Поэтому, как и при обновлении сервера, перед установкой версий мобильных приложений потребуется удалить все ссылки на пакеты SDK для мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="12711-279">Mobile Apps also includes a new version of the client SDKs, and similar to the server upgrade above, you will need to remove all references to the Mobile Services SDKs before installing the Mobile Apps versions.</span></span>

<span data-ttu-id="12711-280">Одно из основных различий между версиями заключается в том, что конструкторам больше не требуется ключ приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-280">One of the main changes between the versions is that the constructors no longer require an application key.</span></span> <span data-ttu-id="12711-281">Просто передайте URL-адрес мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="12711-281">You now simply pass in the URL of your Mobile App.</span></span> <span data-ttu-id="12711-282">Например, в клиентах .NET конструктор `MobileServiceClient` теперь выглядит так:</span><span class="sxs-lookup"><span data-stu-id="12711-282">For example, on the .NET clients, the `MobileServiceClient` constructor is now:</span></span>

        public static MobileServiceClient MobileService = new MobileServiceClient(
            "https://contoso.azurewebsites.net", // URL of the Mobile App
        );

<span data-ttu-id="12711-283">Сведения об установке новых пакетов SDK и использовании новой структуры см. по ссылкам ниже:</span><span class="sxs-lookup"><span data-stu-id="12711-283">You can read about installing the new SDKs and using the new structure via the links below:</span></span>

* [<span data-ttu-id="12711-284">iOS 3.0.0 или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="12711-284">iOS version 3.0.0 or later</span></span>](app-service-mobile-ios-how-to-use-client-library.md)
* [<span data-ttu-id="12711-285">.NET (Windows/Xamarin) 2.0.0 или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="12711-285">.NET (Windows/Xamarin) version 2.0.0 or later</span></span>](app-service-mobile-dotnet-how-to-use-client-library.md)

<span data-ttu-id="12711-286">Если приложение использует push-уведомления, обратите внимание на особые инструкции по регистрации для каждой платформы, так как они немного изменились.</span><span class="sxs-lookup"><span data-stu-id="12711-286">If your application makes use of push notifications, make note of the specific registration instructions for each platform, as there have been some changes there as well.</span></span>

<span data-ttu-id="12711-287">Когда новая версия клиента будет готова, испробуйте ее в новом обновленном серверном проекте.</span><span class="sxs-lookup"><span data-stu-id="12711-287">When you have the new client version ready, try it out against your upgraded server project.</span></span> <span data-ttu-id="12711-288">После проверки ее работы вы можете предоставить новую версию приложения клиентам.</span><span class="sxs-lookup"><span data-stu-id="12711-288">After validating that it works, you can release a new version of your application to customers.</span></span> <span data-ttu-id="12711-289">Когда как клиенты смогут получить эти обновления, версию мобильных служб приложения можно удалить.</span><span class="sxs-lookup"><span data-stu-id="12711-289">Eventually, once your customers have had a chance to receive these updates, you can delete the Mobile Services version of your app.</span></span> <span data-ttu-id="12711-290">Этот шаг завершает обновление до мобильного приложения службы приложений с помощью последнего пакета SDK сервера мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="12711-290">At this point, you have completely upgraded to an App Service Mobile App using the latest Mobile Apps server SDK.</span></span>

<!-- URLs. -->

<span data-ttu-id="12711-291">[портал Azure]: https://portal.azure.com/</span><span class="sxs-lookup"><span data-stu-id="12711-291">[Azure portal]: https://portal.azure.com/</span></span>
<span data-ttu-id="12711-292">[классическом портале Azure]: https://manage.windowsazure.com/</span><span class="sxs-lookup"><span data-stu-id="12711-292">[Azure classic portal]: https://manage.windowsazure.com/</span></span>
<span data-ttu-id="12711-293">[Общие сведения о мобильных приложениях]: app-service-mobile-value-prop.md</span><span class="sxs-lookup"><span data-stu-id="12711-293">[What are Mobile Apps?]: app-service-mobile-value-prop.md</span></span>
[I already use web sites and mobile services – how does App Service help me?]: /en-us/documentation/articles/app-service-mobile-value-prop-migration-from-mobile-services
<span data-ttu-id="12711-294">[пакет SDK для сервера мобильных приложений]: http://www.nuget.org/packages/microsoft.azure.mobile.server</span><span class="sxs-lookup"><span data-stu-id="12711-294">[Mobile App Server SDK]: http://www.nuget.org/packages/microsoft.azure.mobile.server</span></span>
[Create a Mobile App]: app-service-mobile-xamarin-ios-get-started.md
[Add push notifications to your mobile app]: app-service-mobile-xamarin-ios-get-started-push.md
[Add authentication to your mobile app]: app-service-mobile-xamarin-ios-get-started-users.md
<span data-ttu-id="12711-295">[планировщике Azure]: /en-us/documentation/services/scheduler/</span><span class="sxs-lookup"><span data-stu-id="12711-295">[Azure Scheduler]: /en-us/documentation/services/scheduler/</span></span>
<span data-ttu-id="12711-296">[веб-задание]: ../app-service-web/websites-webjobs-resources.md</span><span class="sxs-lookup"><span data-stu-id="12711-296">[Web Job]: ../app-service-web/websites-webjobs-resources.md</span></span>
<span data-ttu-id="12711-297">[Работа с пакетом SDK для внутреннего сервера .NET для мобильных приложений Azure]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span><span class="sxs-lookup"><span data-stu-id="12711-297">[How to use the .NET server SDK]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span></span>
[Migrate from Mobile Services to an App Service Mobile App]: app-service-mobile-migrating-from-mobile-services.md
[Migrate your existing Mobile Service to App Service]: app-service-mobile-migrating-from-mobile-services.md
<span data-ttu-id="12711-298">[ценами службы приложений]: https://azure.microsoft.com/en-us/pricing/details/app-service/</span><span class="sxs-lookup"><span data-stu-id="12711-298">[App Service pricing]: https://azure.microsoft.com/en-us/pricing/details/app-service/</span></span>
<span data-ttu-id="12711-299">[Работа с пакетом SDK для внутреннего сервера .NET для мобильных приложений Azure]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span><span class="sxs-lookup"><span data-stu-id="12711-299">[.NET server SDK overview]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md</span></span>
