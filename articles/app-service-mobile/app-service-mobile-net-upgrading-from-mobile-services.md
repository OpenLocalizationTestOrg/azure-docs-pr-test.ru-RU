---
title: "aaaUpgrade из мобильных служб tooAzure службы приложений"
description: "Узнайте, как tooeasily обновление вашего tooan приложения мобильных служб приложение службы мобильных приложений"
services: app-service\mobile
documentationcenter: 
author: ggailey777
manager: syntaxc4
editor: 
ms.assetid: 9c0ac353-afb6-462b-ab94-d91b8247322f
ms.service: app-service-mobile
ms.workload: mobile
ms.tgt_pltfrm: mobile
ms.devlang: dotnet
ms.topic: article
ms.date: 10/01/2016
ms.author: glenga
ms.openlocfilehash: 2b75a1b824e8ef0d36c9053f2f19af051479f928
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="upgrade-your-existing-net-azure-mobile-service-tooapp-service"></a><span data-ttu-id="5fe3b-103">Обновление вашей существующей мобильной службы .NET Azure tooApp службы</span><span class="sxs-lookup"><span data-stu-id="5fe3b-103">Upgrade your existing .NET Azure Mobile Service tooApp Service</span></span>
<span data-ttu-id="5fe3b-104">Мобильные приложения службы-это новый способ toobuild мобильных приложений с помощью Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-104">App Service Mobile is a new way toobuild mobile applications using Microsoft Azure.</span></span> <span data-ttu-id="5fe3b-105">toolearn более, в разделе [Каковы мобильные приложения?].</span><span class="sxs-lookup"><span data-stu-id="5fe3b-105">toolearn more, see [What are Mobile Apps?].</span></span>

<span data-ttu-id="5fe3b-106">В этом разделе описывается способ tooupgrade существующее приложение серверной части .NET из мобильных служб Azure tooa новые мобильные приложения службы приложений.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-106">This topic describes how tooupgrade an existing .NET backend application from Azure Mobile Services tooa new App Service Mobile Apps.</span></span> <span data-ttu-id="5fe3b-107">При выполнении этого обновления существующего приложения мобильных служб можно продолжить toooperate.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-107">While you perform this upgrade, your existing Mobile Services application can continue toooperate.</span></span>   <span data-ttu-id="5fe3b-108">Если вам требуется tooupgrade Node.js внутреннее приложение, см. слишком[обновление мобильных служб Node.js](app-service-mobile-node-backend-upgrading-from-mobile-services.md).</span><span class="sxs-lookup"><span data-stu-id="5fe3b-108">If you need tooupgrade a Node.js backend application, refer too[Upgrading your Node.js Mobile Services](app-service-mobile-node-backend-upgrading-from-mobile-services.md).</span></span>

<span data-ttu-id="5fe3b-109">Когда мобильной серверной части tooAzure обновленной службы приложений, он имеет доступ tooall функции службы приложений и являются выставлен счет на слишком в соответствии с[служб приложений Ценовая], цены не мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-109">When a mobile backend is upgraded tooAzure App Service, it has access tooall App Service features and are billed according too[App Service pricing], not Mobile Services pricing.</span></span>

## <a name="migrate-vs-upgrade"></a><span data-ttu-id="5fe3b-110">Миграция или обновление</span><span class="sxs-lookup"><span data-stu-id="5fe3b-110">Migrate vs. upgrade</span></span>
[!INCLUDE [app-service-mobile-migrate-vs-upgrade](../../includes/app-service-mobile-migrate-vs-upgrade.md)]

> [!TIP]
> <span data-ttu-id="5fe3b-111">Перед обновлением рекомендуется [выполнить миграцию](app-service-mobile-migrating-from-mobile-services.md) .</span><span class="sxs-lookup"><span data-stu-id="5fe3b-111">It is recommended that you [perform a migration](app-service-mobile-migrating-from-mobile-services.md) before going through an upgrade.</span></span> <span data-ttu-id="5fe3b-112">Таким образом, можно поместить обе версии приложения hello же план службы приложений и создают без дополнительных затрат.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-112">This way, you can put both versions of your application on hello same App Service Plan and incur no additional cost.</span></span>
>
>

### <a name="improvements-in-mobile-apps-net-server-sdk"></a><span data-ttu-id="5fe3b-113">Улучшения в пакете SDK сервера .NET мобильных приложений</span><span class="sxs-lookup"><span data-stu-id="5fe3b-113">Improvements in Mobile Apps .NET server SDK</span></span>
<span data-ttu-id="5fe3b-114">Обновление нового toohello [пакет SDK для мобильных приложений](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) предоставляет hello следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-114">Upgrading toohello new [Mobile Apps SDK](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) provides hello following benefits:</span></span>

* <span data-ttu-id="5fe3b-115">Дополнительная гибкость для зависимостей NuGet.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-115">More flexibility on NuGet dependencies.</span></span> <span data-ttu-id="5fe3b-116">Hello, среда размещения больше не предоставляет собственные версии пакетов NuGet, чтобы можно было использовать альтернативные совместимые версии.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-116">hello hosting environment no longer provides its own versions of NuGet packages, so you can use alternative compatible versions.</span></span> <span data-ttu-id="5fe3b-117">Если имеются новые критические bugfixes или toohello обновлений безопасности SDK сервера мобильных или зависимости, службы необходимо обновить вручную.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-117">However, if there are new critical bugfixes or security updates toohello Mobile Server SDK or dependencies, you must update your service manually.</span></span>
* <span data-ttu-id="5fe3b-118">Более гибкие возможности hello SDK для мобильных устройств.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-118">More flexibility in hello mobile SDK.</span></span> <span data-ttu-id="5fe3b-119">Явно управлять тем, какие компоненты и маршруты настраиваются, такие как проверка подлинности, API-интерфейсы, таблицы и hello конечной точке регистрации push.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-119">You can explicitly control which features and routes are set up, such as authentication, table APIs, and hello push registration endpoint.</span></span> <span data-ttu-id="5fe3b-120">toolearn более, в разделе [как toouse hello .NET server SDK для мобильных приложений Azure](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md).</span><span class="sxs-lookup"><span data-stu-id="5fe3b-120">toolearn more, see [How toouse hello .NET server SDK for Azure Mobile Apps](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md).</span></span>
* <span data-ttu-id="5fe3b-121">Поддержка других маршрутов и типов проектов ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-121">Support for other ASP.NET project types and routes.</span></span> <span data-ttu-id="5fe3b-122">Теперь можно размещать контроллеров MVC и веб-API в hello же проект как проект мобильной серверной части.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-122">You can now host MVC and Web API controllers in hello same project as your mobile backend project.</span></span>
* <span data-ttu-id="5fe3b-123">Поддержка новой функции проверки подлинности службы приложений, позволяющих toouse общую конфигурацию проверки подлинности между веб- и мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-123">Support for new App Service authentication features, which allow you toouse a common authentication configuration across your web and mobile apps.</span></span>

## <span data-ttu-id="5fe3b-124"><a name="overview"></a>Общие сведения об обновлении</span><span class="sxs-lookup"><span data-stu-id="5fe3b-124"><a name="overview"></a>Basic upgrade overview</span></span>
<span data-ttu-id="5fe3b-125">Во многих случаях обновление будет таким же простым, как переключение toohello новые мобильные приложения SDK сервера, а также переиздание кода на новый экземпляр мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-125">In many cases, upgrading will be as simple as switching toohello new Mobile Apps server SDK and republishing your code onto a new Mobile App instance.</span></span> <span data-ttu-id="5fe3b-126">Однако существует несколько сценариев, в которых потребуется дополнительная настройка, например расширенные сценарии проверки подлинности и работа с запланированными заданиями.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-126">There are, however some scenarios which will require some additional configuration, such as advanced authentication scenarios and working with scheduled jobs.</span></span> <span data-ttu-id="5fe3b-127">Каждый из них рассматривается hello далее разделах.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-127">Each of these is covered in hello later sections.</span></span>

> [!TIP]
> <span data-ttu-id="5fe3b-128">Рекомендуется прочитать и полностью понимать hello остальной части этого раздела до начала обновления.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-128">It is advised that you read and understand hello rest of this topic completely before starting an upgrade.</span></span> <span data-ttu-id="5fe3b-129">Запишите все используемые функции, которые вызываются ниже.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-129">Make note of any features you use which are called out below.</span></span>
>
>

<span data-ttu-id="5fe3b-130">Hello клиента мобильных служб, пакеты SDK **не** совместимой с сервером новые мобильные приложения hello SDK.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-130">hello Mobile Services client SDKs are **not** compatible with hello new Mobile Apps server SDK.</span></span> <span data-ttu-id="5fe3b-131">Непрерывность tooprovide порядок службу для своего приложения не следует публиковать изменения tooa сайта в настоящее время обслуживая клиентов, опубликованной.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-131">In order tooprovide continuity of service for your app, you should not publish changes tooa site currently serving published clients.</span></span> <span data-ttu-id="5fe3b-132">Вместо этого нужно создать новое мобильное приложение, которое является дубликатом.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-132">Instead, you should create a new mobile app that serves as a duplicate.</span></span> <span data-ttu-id="5fe3b-133">Можно поместить это приложение hello же приложение службы плана tooavoid дополнительных финансовых затрат.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-133">You can put this application on hello same App Service plan tooavoid incurring additional financial cost.</span></span>

<span data-ttu-id="5fe3b-134">Затем имеется две версии приложения hello: один какие остается таким же hello и служит опубликованные приложения hello подстановки и hello в другой, которую затем можно обновить и целевой с новым выпуском клиента.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-134">You will then have two versions of hello application: one which stays hello same and serves published apps in hello wild, and hello other which you can then upgrade and target with a new client release.</span></span> <span data-ttu-id="5fe3b-135">Можно перемещать и тестирования кода в темпе, но следует убедиться в том, все исправления, внесенные get примененных tooboth.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-135">You can move and test your code at your pace, but you should make sure that any bug fixes you make get applied tooboth.</span></span> <span data-ttu-id="5fe3b-136">Если вы считаете, что требуемое число клиентских приложений в hello подстановки обновили toohello последней версии, при желании можно удалить исходный перенесенные приложение hello.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-136">Once you feel that a desired number of client apps in hello wild have updated toohello latest version, you can delete hello original migrated app if you desire.</span></span>

<span data-ttu-id="5fe3b-137">Hello полной структуры для hello процесс обновления выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-137">hello full outline for hello upgrade process is as follows:</span></span>

1. <span data-ttu-id="5fe3b-138">Создание нового мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-138">Create a new Mobile App</span></span>
2. <span data-ttu-id="5fe3b-139">Обновление hello проекта toouse hello новых пакетов SDK сервера</span><span class="sxs-lookup"><span data-stu-id="5fe3b-139">Update hello project toouse hello new Server SDKs</span></span>
3. <span data-ttu-id="5fe3b-140">Выпуск новой версии клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-140">Release a new version of your client application</span></span>
4. <span data-ttu-id="5fe3b-141">(Необязательно) Удаление исходного перенесенного экземпляра миграции</span><span class="sxs-lookup"><span data-stu-id="5fe3b-141">(Optional) Delete your original migrated instance</span></span>

## <span data-ttu-id="5fe3b-142"><a name="mobile-app-version"></a>Создание второго экземпляра приложения</span><span class="sxs-lookup"><span data-stu-id="5fe3b-142"><a name="mobile-app-version"></a>Creating a second application instance</span></span>
<span data-ttu-id="5fe3b-143">Hello первым шагом при обновлении является toocreate hello мобильное приложение ресурса, который будет размещаться новая версия приложения hello.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-143">hello first step in upgrading is toocreate hello Mobile App resource which will host hello new version of your application.</span></span> <span data-ttu-id="5fe3b-144">Если вы уже перенесли существующую мобильную службу, можно toocreate эту версию на hello же плана размещения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-144">If you have already migrated an existing mobile service, you will want toocreate this version on hello same hosting plan.</span></span> <span data-ttu-id="5fe3b-145">Откройте hello [портал Azure] и перейдите tooyour миграции приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-145">Open hello [Azure portal] and navigate tooyour migrated application.</span></span> <span data-ttu-id="5fe3b-146">Запишите hello план службы приложений, он выполняется.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-146">Make note of hello App Service Plan it is running on.</span></span>

<span data-ttu-id="5fe3b-147">Затем нужно создать второй экземпляр приложения hello, следующие hello [инструкции создания серверной части .NET](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#create-app).</span><span class="sxs-lookup"><span data-stu-id="5fe3b-147">Next, create hello second application instance by following hello [.NET backend creation instructions](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#create-app).</span></span> <span data-ttu-id="5fe3b-148">Когда запрос tooselect выбрать план служб приложений или «план размещения» hello план миграции приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-148">When prompted tooselect you App Service Plan or "hosting plan" choose hello plan of your migrated application.</span></span>

<span data-ttu-id="5fe3b-149">Скорее всего, вы будете toouse hello одной базе данных и концентратор уведомлений, как вы делали на мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-149">You will likely want toouse hello same database and Notification Hub as you did in Mobile Services.</span></span> <span data-ttu-id="5fe3b-150">Эти значения можно скопировать, открыв [портал Azure] и перемещение toohello исходного приложения, нажмите кнопку **параметры** > **параметры приложения**.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-150">You can copy these values by opening [Azure portal] and navigating toohello original application, then click **Settings** > **Application settings**.</span></span> <span data-ttu-id="5fe3b-151">В разделе **Строки подключения** скопируйте `MS_NotificationHubConnectionString` и `MS_TableConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-151">Under **Connection Strings**, copy `MS_NotificationHubConnectionString` and `MS_TableConnectionString`.</span></span> <span data-ttu-id="5fe3b-152">Перейдите tooyour нового обновления сайта и вставьте их на сервер, перезаписывая все существующие значения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-152">Navigate tooyour new upgrade site and paste them in, overwriting any existing values.</span></span> <span data-ttu-id="5fe3b-153">Повторите эту процедуру для других необходимых параметров приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-153">Repeat this process for any other application settings your app needs.</span></span> <span data-ttu-id="5fe3b-154">Если не используется перенесенной службы, можно считывать строки подключения и параметры приложения из hello **Настройка** вкладка hello мобильных служб раздел hello [классический портал Azure].</span><span class="sxs-lookup"><span data-stu-id="5fe3b-154">If not using a migrated service, you can read connection strings and app settings from hello **Configure** tab of hello Mobile Services section of hello [Azure classic portal].</span></span>

<span data-ttu-id="5fe3b-155">Создайте копию hello проекта ASP.NET для приложения и опубликовать его tooyour новый сайт.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-155">Make a copy of hello ASP.NET project for your application and publish it tooyour new site.</span></span> <span data-ttu-id="5fe3b-156">Используя копию клиентское приложение обновляется hello новый URL-адрес, проверьте, что все работает правильно.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-156">Using a copy of your client application updated with hello new URL, validate that everything works as expected.</span></span>

## <a name="updating-hello-server-project"></a><span data-ttu-id="5fe3b-157">Обновление проекта сервера hello</span><span class="sxs-lookup"><span data-stu-id="5fe3b-157">Updating hello server project</span></span>
<span data-ttu-id="5fe3b-158">Мобильные приложения предоставляет новый [пакет SDK для мобильных приложений сервера] которого содержится значительная часть hello функциональных возможностей среды выполнения hello мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-158">Mobile Apps provides a new [Mobile App Server SDK] which provides much of hello same functionality as hello Mobile Services runtime.</span></span> <span data-ttu-id="5fe3b-159">Во-первых необходимо удалить все пакеты для мобильных служб toohello ссылки.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-159">First, you should remove all references toohello Mobile Services packages.</span></span> <span data-ttu-id="5fe3b-160">В диспетчере пакетов NuGet hello, поиск `WindowsAzure.MobileServices.Backend`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-160">In hello NuGet package manager, search for `WindowsAzure.MobileServices.Backend`.</span></span> <span data-ttu-id="5fe3b-161">Для большинства пакетов здесь будет отображаться несколько пакетов, включая `WindowsAzure.MobileServices.Backend.Tables` и `WindowsAzure.MobileServices.Backend.Entity`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-161">Most apps will see several packages here, including `WindowsAzure.MobileServices.Backend.Tables` and `WindowsAzure.MobileServices.Backend.Entity`.</span></span> <span data-ttu-id="5fe3b-162">В этом случае запустите с наименьшим пакета hello в дереве зависимостей hello, например `Entity`и удалите его.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-162">In such a case, start with hello lowest package in hello dependency tree, such as `Entity`, and remove it.</span></span> <span data-ttu-id="5fe3b-163">При выводе запроса не удаляйте все зависимые пакеты.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-163">When prompted, do not remove all dependant packages.</span></span> <span data-ttu-id="5fe3b-164">Повторяйте этот процесс, пока не будет удален сам `WindowsAzure.MobileServices.Backend` .</span><span class="sxs-lookup"><span data-stu-id="5fe3b-164">Repeat this process until you have removed `WindowsAzure.MobileServices.Backend` itself.</span></span>

<span data-ttu-id="5fe3b-165">На этом этапе в вашем распоряжении будет находиться проект, который больше не ссылается на пакеты SDK мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-165">At this point you will have a project that no longer references Mobile Services SDKs.</span></span>

<span data-ttu-id="5fe3b-166">Мы добавим hello ссылки на пакет SDK для мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-166">Next you will add references hello Mobile Apps SDK.</span></span> <span data-ttu-id="5fe3b-167">Для этого обновления, большинство разработчиков будет toodownload и установить hello `Microsoft.Azure.Mobile.Server.Quickstart` пакета, как это будет опрашивать в hello весь необходимый набор.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-167">For this upgrade, most developers will want toodownload and install hello `Microsoft.Azure.Mobile.Server.Quickstart` package, as this will pull in hello entire required set.</span></span>

<span data-ttu-id="5fe3b-168">Будет довольно много ошибки компилятора, возникающие из-за различий между hello пакеты SDK, но это просто tooaddress, охваченных hello оставшейся части этого раздела.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-168">There will be quite a few compiler errors resulting from differences between hello SDKs, but these are easy tooaddress and are covered in hello rest of this section.</span></span>

### <a name="base-configuration"></a><span data-ttu-id="5fe3b-169">Базовая конфигурация</span><span class="sxs-lookup"><span data-stu-id="5fe3b-169">Base configuration</span></span>
<span data-ttu-id="5fe3b-170">Затем в файле WebApiConfig.cs можно заменить</span><span class="sxs-lookup"><span data-stu-id="5fe3b-170">Then, in WebApiConfig.cs, you can replace:</span></span>

        // Use this class tooset configuration options for your mobile service
        ConfigOptions options = new ConfigOptions();

        // Use this class tooset WebAPI configuration options
        HttpConfiguration config = ServiceConfig.Initialize(new ConfigBuilder(options));

<span data-ttu-id="5fe3b-171">на</span><span class="sxs-lookup"><span data-stu-id="5fe3b-171">with</span></span>

        HttpConfiguration config = new HttpConfiguration();
        new MobileAppConfiguration()
            .UseDefaultConfiguration()
        .ApplyTo(config);

> [!NOTE]
> <span data-ttu-id="5fe3b-172">Если вы хотите toolearn подробные сведения о новом сервере .NET SDK hello и как функции tooadd или удалить из приложения, см. в разделе hello [как toouse hello .NET server SDK] раздела.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-172">If you wish toolearn more about hello new .NET server SDK and how tooadd/remove features from your app, please see hello [How toouse hello .NET server SDK] topic.</span></span>
>
>

<span data-ttu-id="5fe3b-173">Если приложение позволяет использовать функции hello проверки подлинности, необходимо также tooregister по промежуточного слоя OWIN.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-173">If your app makes use of hello authentication features, you will also need tooregister an OWIN middleware.</span></span> <span data-ttu-id="5fe3b-174">В этом случае следует перемещать hello выше код конфигурации в новый класс запуска OWIN.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-174">In this case, you should move hello above configuration code into a new OWIN Startup class.</span></span>

1. <span data-ttu-id="5fe3b-175">Добавьте пакет NuGet hello `Microsoft.Owin.Host.SystemWeb` , если он уже не включен в проект.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-175">Add hello NuGet package `Microsoft.Owin.Host.SystemWeb` if it is not already included in your project.</span></span>
2. <span data-ttu-id="5fe3b-176">В Visual Studio щелкните правой кнопкой мыши проект и последовательно выберите **Добавить** -> **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-176">In Visual Studio, right click on your project and select **Add** -> **New Item**.</span></span> <span data-ttu-id="5fe3b-177">Выберите **Интернет** -> **Общие** -> **Класс Startup OWIN**.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-177">Select **Web** -> **General** -> **OWIN Startup class**.</span></span>
3. <span data-ttu-id="5fe3b-178">Переместить hello над кодом для MobileAppConfiguration из `WebApiConfig.Register()` toohello `Configuration()` метод запуска нового класса.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-178">Move hello above code for MobileAppConfiguration from `WebApiConfig.Register()` toohello `Configuration()` method of your new startup class.</span></span>

<span data-ttu-id="5fe3b-179">Убедитесь, что hello `Configuration()` заканчивается метод:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-179">Make sure hello `Configuration()` method ends with:</span></span>

        app.UseWebApi(config)
        app.UseAppServiceAuthentication(config);

<span data-ttu-id="5fe3b-180">Существуют дополнительные изменения связанных tooauthentication рассматривается в разделе полная проверка подлинности hello ниже.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-180">There are additional changes related tooauthentication which are covered in hello full authentication section below.</span></span>

### <a name="working-with-data"></a><span data-ttu-id="5fe3b-181">Работа с данными</span><span class="sxs-lookup"><span data-stu-id="5fe3b-181">Working with Data</span></span>
<span data-ttu-id="5fe3b-182">В мобильных службах имя мобильное приложение hello предоставлена как имя схемы по умолчанию hello в программе установки hello Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-182">In Mobile Services, hello mobile app name served as hello default schema name in hello Entity Framework setup.</span></span>

<span data-ttu-id="5fe3b-183">tooensure, у вас есть hello же схемы адресуемым как раньше hello используется следующая схема tooset hello в hello DbContext для приложения:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-183">tooensure that you have hello same schema being referenced as before, use hello following tooset hello schema in hello DbContext for your application:</span></span>

        string schema = System.Configuration.ConfigurationManager.AppSettings.Get("MS_MobileServiceName");

<span data-ttu-id="5fe3b-184">Убедитесь, что у вас есть набор, если hello выше MS_MobileServiceName.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-184">Please make sure you have MS_MobileServiceName set if you do hello above.</span></span> <span data-ttu-id="5fe3b-185">Если имя схемы в приложении было настроено ранее, можно также указать другое имя.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-185">You can also provide another schema name if your application customized this previously.</span></span>

### <a name="system-properties"></a><span data-ttu-id="5fe3b-186">Свойства системы</span><span class="sxs-lookup"><span data-stu-id="5fe3b-186">System Properties</span></span>
#### <a name="naming"></a><span data-ttu-id="5fe3b-187">Именование</span><span class="sxs-lookup"><span data-stu-id="5fe3b-187">Naming</span></span>
<span data-ttu-id="5fe3b-188">В SDK сервера мобильных служб Azure hello системные свойства всегда содержат двух символов подчеркивания (`__`) префикс для hello свойства:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-188">In hello Azure Mobile Services server SDK, system properties always contain a double underscore (`__`) prefix for hello properties:</span></span>

* <span data-ttu-id="5fe3b-189">__createdAt</span><span class="sxs-lookup"><span data-stu-id="5fe3b-189">__createdAt</span></span>
* <span data-ttu-id="5fe3b-190">__updatedAt</span><span class="sxs-lookup"><span data-stu-id="5fe3b-190">__updatedAt</span></span>
* <span data-ttu-id="5fe3b-191">__deleted</span><span class="sxs-lookup"><span data-stu-id="5fe3b-191">__deleted</span></span>
* <span data-ttu-id="5fe3b-192">__version</span><span class="sxs-lookup"><span data-stu-id="5fe3b-192">__version</span></span>

<span data-ttu-id="5fe3b-193">Клиент мобильных служб Hello SDK имеет специальную логику для синтаксического анализа системные свойства в этом формате.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-193">hello Mobile Services client SDKs have special logic for parsing system properties in this format.</span></span>

<span data-ttu-id="5fe3b-194">В мобильных приложениях Azure свойства системы больше нет специального форматирования и иметь hello следующие имена:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-194">In Azure Mobile Apps, system properties no longer have a special format and have hello following names:</span></span>

* <span data-ttu-id="5fe3b-195">дата создания</span><span class="sxs-lookup"><span data-stu-id="5fe3b-195">createdAt</span></span>
* <span data-ttu-id="5fe3b-196">дата обновления</span><span class="sxs-lookup"><span data-stu-id="5fe3b-196">updatedAt</span></span>
* <span data-ttu-id="5fe3b-197">deleted</span><span class="sxs-lookup"><span data-stu-id="5fe3b-197">deleted</span></span>
* <span data-ttu-id="5fe3b-198">версия</span><span class="sxs-lookup"><span data-stu-id="5fe3b-198">version</span></span>

<span data-ttu-id="5fe3b-199">Hello мобильные приложения клиента пакеты SDK используйте hello новых системы свойства имен, поэтому изменять не требуется tooclient кода.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-199">hello Mobile Apps client SDKs use hello new system properties names, so no changes are required tooclient code.</span></span> <span data-ttu-id="5fe3b-200">Тем не менее при работе непосредственно внесения REST вызывает службу tooyour, затем следует соответственно изменить запросы.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-200">However, if you are directly making REST calls tooyour service then you should change your queries accordingly.</span></span>

#### <a name="local-store"></a><span data-ttu-id="5fe3b-201">Локальное хранилище</span><span class="sxs-lookup"><span data-stu-id="5fe3b-201">Local store</span></span>
<span data-ttu-id="5fe3b-202">имена toohello Hello изменения системных свойств означает, что автономной синхронизации локальной базы данных для мобильных служб не совместимы с приложениями для мобильных устройств.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-202">hello changes toohello names of system properties mean that an offline sync local database for Mobile Services is not compatible with Mobile Apps.</span></span> <span data-ttu-id="5fe3b-203">Если это возможно следует избегать клиентских приложений, обновляющих tooMobile мобильных служб, приложений, пока после ожидающих изменений отправлен toohello сервера.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-203">If possible, you should avoid upgrading client apps from Mobile Services tooMobile Apps until after pending changes have been sent toohello server.</span></span> <span data-ttu-id="5fe3b-204">Затем приложение обновленной hello следует использовать новое имя файла базы данных.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-204">Then, hello upgraded app should use a new database filename.</span></span>

<span data-ttu-id="5fe3b-205">Если клиентское приложение обновляется с tooMobile мобильных служб приложений, пока имеются ожидающие изменения в автономном режиме в очередь операций hello, hello системной базы данных необходимо обновленные toouse hello новые имена столбцов.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-205">If a client app is upgraded from Mobile Services tooMobile Apps while there are pending offline changes in hello operation queue, then hello system database must be updated toouse hello new column names.</span></span> <span data-ttu-id="5fe3b-206">На iOS это можно сделать с помощью имен столбцов hello toochange упрощенных миграции.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-206">On iOS, this can be achieved using lightweight migrations toochange hello column names.</span></span> <span data-ttu-id="5fe3b-207">На Android и hello клиентских управляемых .NET следует писать пользовательские toorename SQL hello столбцов для таблиц данных объекта.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-207">On Android and hello .NET managed client, you should write custom SQL toorename hello columns for your data object tables.</span></span>

<span data-ttu-id="5fe3b-208">На iOS следует изменить схему основных данных для вашего следующего hello toomatch сущности данных.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-208">On iOS, you should change your Core Data schema for your data entities toomatch hello following.</span></span> <span data-ttu-id="5fe3b-209">Обратите внимание, что свойства hello `createdAt`, `updatedAt` и `version` больше нет `ms_` префикс:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-209">Note that hello properties `createdAt`, `updatedAt` and `version` no longer have an `ms_` prefix:</span></span>

| <span data-ttu-id="5fe3b-210">Атрибут</span><span class="sxs-lookup"><span data-stu-id="5fe3b-210">Attribute</span></span> | <span data-ttu-id="5fe3b-211">Тип</span><span class="sxs-lookup"><span data-stu-id="5fe3b-211">Type</span></span> | <span data-ttu-id="5fe3b-212">Примечание.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-212">Note</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5fe3b-213">id</span><span class="sxs-lookup"><span data-stu-id="5fe3b-213">id</span></span> |<span data-ttu-id="5fe3b-214">Строка, помеченная как обязательная</span><span class="sxs-lookup"><span data-stu-id="5fe3b-214">String, marked required</span></span> |<span data-ttu-id="5fe3b-215">первичный ключ в удаленном хранилище</span><span class="sxs-lookup"><span data-stu-id="5fe3b-215">primary key in remote store</span></span> |
| <span data-ttu-id="5fe3b-216">дата создания</span><span class="sxs-lookup"><span data-stu-id="5fe3b-216">createdAt</span></span> |<span data-ttu-id="5fe3b-217">Дата</span><span class="sxs-lookup"><span data-stu-id="5fe3b-217">Date</span></span> |<span data-ttu-id="5fe3b-218">(необязательно) maps toocreatedAt системного свойства</span><span class="sxs-lookup"><span data-stu-id="5fe3b-218">(optional) maps toocreatedAt system property</span></span> |
| <span data-ttu-id="5fe3b-219">дата обновления</span><span class="sxs-lookup"><span data-stu-id="5fe3b-219">updatedAt</span></span> |<span data-ttu-id="5fe3b-220">Дата</span><span class="sxs-lookup"><span data-stu-id="5fe3b-220">Date</span></span> |<span data-ttu-id="5fe3b-221">(необязательно) maps tooupdatedAt системного свойства</span><span class="sxs-lookup"><span data-stu-id="5fe3b-221">(optional) maps tooupdatedAt system property</span></span> |
| <span data-ttu-id="5fe3b-222">версия</span><span class="sxs-lookup"><span data-stu-id="5fe3b-222">version</span></span> |<span data-ttu-id="5fe3b-223">Строка</span><span class="sxs-lookup"><span data-stu-id="5fe3b-223">String</span></span> |<span data-ttu-id="5fe3b-224">(необязательно) используется toodetect конфликты, tooversion карты</span><span class="sxs-lookup"><span data-stu-id="5fe3b-224">(optional) used toodetect conflicts, maps tooversion</span></span> |

#### <a name="querying-system-properties"></a><span data-ttu-id="5fe3b-225">Выполнение запросов к свойствам системы</span><span class="sxs-lookup"><span data-stu-id="5fe3b-225">Querying system properties</span></span>
<span data-ttu-id="5fe3b-226">В мобильных службах Azure системные свойства не отправляются по умолчанию, но только в том случае, когда они запрашиваются с помощью строки запроса hello `__systemProperties`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-226">In Azure Mobile Services, system properties are not sent by default, but only when they are requested using hello query string `__systemProperties`.</span></span> <span data-ttu-id="5fe3b-227">В отличие от этого, в системе мобильных приложений Azure свойства являются **всегда выбран** так, как они являются частью hello server SDK объектной модели.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-227">In contrast, in Azure Mobile Apps system properties are **always selected** since they are part of hello server SDK object model.</span></span>

<span data-ttu-id="5fe3b-228">Это изменение влияет главным образом на настраиваемые реализации диспетчеров доменов, такие как расширения `MappedEntityDomainManager`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-228">This change mainly impacts custom implementations of domain managers, such as extensions of `MappedEntityDomainManager`.</span></span> <span data-ttu-id="5fe3b-229">Мобильные службы, если клиент никогда не запрашивает все системные свойства при возможных toouse `MappedEntityDomainManager` , не сопоставленный фактически все свойства.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-229">In Mobile Services, if a client never requests any system properties, it is possible toouse a `MappedEntityDomainManager` that does not actually map all properties.</span></span> <span data-ttu-id="5fe3b-230">Однако в мобильных приложениях Azure эти несопоставленные свойства приведут к возникновению ошибок в запросах GET.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-230">However, in Azure Mobile Apps, these unmapped properties will cause an error in GET queries.</span></span>

<span data-ttu-id="5fe3b-231">Здравствуйте, наиболее простым способом tooresolve hello проблема является toomodify вашей DTO, чтобы они наследуют от `ITableData` вместо `EntityData`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-231">hello easiest way tooresolve hello issue is toomodify your DTOs so that they inherit from `ITableData` instead of `EntityData`.</span></span> <span data-ttu-id="5fe3b-232">Затем добавьте hello `[NotMapped]` атрибута toohello поля, которые следует пропустить.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-232">Then, add hello `[NotMapped]` attribute toohello fields that should be omitted.</span></span>

<span data-ttu-id="5fe3b-233">Например, следующие hello определяет `TodoItem` без указания свойств системы:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-233">For example, hello following defines `TodoItem` with no system properties:</span></span>

    using System.ComponentModel.DataAnnotations.Schema;

    public class TodoItem : ITableData
    {
        public string Text { get; set; }

        public bool Complete { get; set; }

        public string Id { get; set; }

        [NotMapped]
        public DateTimeOffset? CreatedAt { get; set; }

        [NotMapped]
        public DateTimeOffset? UpdatedAt { get; set; }

        [NotMapped]
        public bool Deleted { get; set; }

        [NotMapped]
        public byte[] Version { get; set; }
    }

<span data-ttu-id="5fe3b-234">Примечание: Если вы получаете ошибки `NotMapped`, добавьте ссылочную сборку toohello `System.ComponentModel.DataAnnotations`.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-234">Note: if you get errors on `NotMapped`, add a reference toohello assembly `System.ComponentModel.DataAnnotations`.</span></span>

### <a name="cors"></a><span data-ttu-id="5fe3b-235">CORS</span><span class="sxs-lookup"><span data-stu-id="5fe3b-235">CORS</span></span>
<span data-ttu-id="5fe3b-236">Мобильные службы включены некоторую поддержку CORS, заключив hello решений ASP.NET CORS.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-236">Mobile Services included some support for CORS by wrapping hello ASP.NET CORS solution.</span></span> <span data-ttu-id="5fe3b-237">Этот уровень изоляции был удален toogive hello разработчика более широкие возможности управления, поэтому можно напрямую использовать [поддержка ASP.NET CORS](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api).</span><span class="sxs-lookup"><span data-stu-id="5fe3b-237">This wrapping layer has been removed toogive hello developer more control, so you can directly leverage [ASP.NET CORS support](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api).</span></span>

<span data-ttu-id="5fe3b-238">Hello основных проблем при использовании CORS являются этого hello `eTag` и `Location` заголовки должен быть разрешен в порядке для hello клиента SDK toowork должным образом.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-238">hello main areas of concern if using CORS are that hello `eTag` and `Location` headers must be allowed in order for hello client SDKs toowork properly.</span></span>

### <a name="push-notifications"></a><span data-ttu-id="5fe3b-239">Push-уведомления</span><span class="sxs-lookup"><span data-stu-id="5fe3b-239">Push Notifications</span></span>
<span data-ttu-id="5fe3b-240">Для принудительной отправки класс PushRegistrationHandler hello является hello основных элементов, которые могут оказаться в hello Server SDK отсутствует.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-240">For push, hello main item that you may find missing from hello Server SDK is hello PushRegistrationHandler class.</span></span> <span data-ttu-id="5fe3b-241">Регистрации в мобильных приложениях обрабатываются немного по-другому, и способы регистрации без тегов включены по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-241">Registrations are handled slightly differently in Mobile Apps, and tagless registrations are enabled by default.</span></span> <span data-ttu-id="5fe3b-242">Управление тегами осуществляется с помощью пользовательских API.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-242">Managing tags may be accomplished by using custom APIs.</span></span> <span data-ttu-id="5fe3b-243">См. в разделе hello [регистрация для тегов](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#tags) инструкции для получения дополнительной информации.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-243">Please see hello [registering for tags](app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#tags) instructions for more information.</span></span>

### <a name="scheduled-jobs"></a><span data-ttu-id="5fe3b-244">Запланированные задания</span><span class="sxs-lookup"><span data-stu-id="5fe3b-244">Scheduled Jobs</span></span>
<span data-ttu-id="5fe3b-245">Запланированные задания не встроены в мобильные приложения и все существующие задания, которые имеют в серверной части .NET потребуется toobe обновлены по отдельности.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-245">Scheduled jobs are not built into Mobile Apps, so any existing jobs that you have in your .NET backend will need toobe upgraded individually.</span></span> <span data-ttu-id="5fe3b-246">Один из вариантов — запланированного toocreate [веб-задание] на сайте кода hello мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-246">One option is toocreate a scheduled [Web Job] on hello Mobile App code site.</span></span> <span data-ttu-id="5fe3b-247">Можно также настроить контроллер, который содержит код задания и настройки hello [планировщика Azure] toohit этой конечной точки по расписанию требуется hello.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-247">You could also set up a controller that holds your job code and configure hello [Azure Scheduler] toohit that endpoint on hello expected schedule.</span></span>

### <a name="miscellaneous-changes"></a><span data-ttu-id="5fe3b-248">Прочие изменения</span><span class="sxs-lookup"><span data-stu-id="5fe3b-248">Miscellaneous changes</span></span>
<span data-ttu-id="5fe3b-249">Все ApiControllers, которые будут использоваться мобильного клиента должна иметь hello `[MobileAppController]` атрибута.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-249">All ApiControllers which will be consumed by a mobile client must now have hello `[MobileAppController]` attribute.</span></span> <span data-ttu-id="5fe3b-250">Это больше не включены по умолчанию, чтобы другие ApiControllers toogo влиянию hello мобильных модулей форматирования.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-250">This is no longer included by default so that other ApiControllers toogo unaffected by hello mobile formatters.</span></span>

<span data-ttu-id="5fe3b-251">Hello `ApiServices` объект больше не является частью пакета SDK для hello.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-251">hello `ApiServices` object is no longer part of hello SDK.</span></span> <span data-ttu-id="5fe3b-252">tooaccess параметры мобильного приложения, можно использовать следующие hello:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-252">tooaccess Mobile App settings, you can use hello following:</span></span>

    MobileAppSettingsDictionary settings = this.Configuration.GetMobileAppSettingsProvider().GetMobileAppSettings();

<span data-ttu-id="5fe3b-253">Аналогичным образом ведение журнала теперь выполняется с помощью hello Стандартная ASP.NET трассировки записи:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-253">Similarly, logging is now accomplished using hello standard ASP.NET trace writing:</span></span>

    ITraceWriter traceWriter = this.Configuration.Services.GetTraceWriter();
    traceWriter.Info("Hello, World");  

## <span data-ttu-id="5fe3b-254"><a name="authentication"></a>Рекомендации по проверке подлинности</span><span class="sxs-lookup"><span data-stu-id="5fe3b-254"><a name="authentication"></a>Authentication considerations</span></span>
<span data-ttu-id="5fe3b-255">Теперь были перемещены в компонент приложения службы проверки подлинности и авторизации hello Hello компонентов проверки подлинности мобильных служб.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-255">hello authentication components of Mobile Services have now been moved into hello App Service Authentication/Authorization feature.</span></span> <span data-ttu-id="5fe3b-256">Вы можете узнать о Включение этого узла при чтении hello [мобильное приложение добавить authentication tooyour](app-service-mobile-ios-get-started-users.md) раздела.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-256">You can learn about enabling this for your site by reading hello [Add authentication tooyour mobile app](app-service-mobile-ios-get-started-users.md) topic.</span></span>

<span data-ttu-id="5fe3b-257">Для некоторых поставщиков, например AAD и Facebook, Google должны принадлежать копии приложения могут tooleverage hello существующую регистрацию.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-257">For some providers, such as AAD, Facebook, and Google, you should be able tooleverage hello existing registration from your copy application.</span></span> <span data-ttu-id="5fe3b-258">Просто toonavigate toohello поставщика удостоверений на портале и добавьте новую регистрацию toohello URL-адрес перенаправления.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-258">You simply need toonavigate toohello identity provider's portal and add a new redirect URL toohello registration.</span></span> <span data-ttu-id="5fe3b-259">Затем настройте приложение службы проверки подлинности и авторизации идентификатор клиента hello и секрет.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-259">Then configure App Service Authentication/Authorization with hello client ID and secret.</span></span>

### <a name="controller-action-authorization"></a><span data-ttu-id="5fe3b-260">Авторизация действий контроллера</span><span class="sxs-lookup"><span data-stu-id="5fe3b-260">Controller action authorization</span></span>
<span data-ttu-id="5fe3b-261">Все экземпляры hello `[AuthorizeLevel(AuthorizationLevel.User)]` атрибут теперь должен быть измененные toouse hello Стандартная ASP.NET `[Authorize]` атрибута.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-261">Any instances of hello `[AuthorizeLevel(AuthorizationLevel.User)]` attribute must now be changed toouse hello standard ASP.NET `[Authorize]` attribute.</span></span> <span data-ttu-id="5fe3b-262">Кроме того, теперь контроллеры являются анонимными по умолчанию, как и в других приложениях ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-262">Additionally, controllers are now Anonymous by default, as in other ASP.NET applications.</span></span>
<span data-ttu-id="5fe3b-263">При использовании одного из hello другие параметры AuthorizeLevel, таких как администратор или приложения, обратите внимание, что они удалены.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-263">If you were using one of hello other AuthorizeLevel options, such as Admin or Application, please note that these are gone.</span></span> <span data-ttu-id="5fe3b-264">Вместо этого можно настроить AuthorizationFilters для общие секреты или настроить service to service участника-службы AAD tooenable вызовы безопасно.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-264">You can instead set up AuthorizationFilters for shared secrets or configure an AAD Service Principal tooenable service-to-service calls securely.</span></span>

### <a name="getting-additional-user-information"></a><span data-ttu-id="5fe3b-265">Получение дополнительных сведений о пользователе</span><span class="sxs-lookup"><span data-stu-id="5fe3b-265">Getting additional user information</span></span>
<span data-ttu-id="5fe3b-266">Можно получить дополнительные сведения, включая маркеры доступа через hello `GetAppServiceIdentityAsync()` метод:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-266">You can get additional user information, including access tokens through hello `GetAppServiceIdentityAsync()` method:</span></span>

        FacebookCredentials creds = await this.User.GetAppServiceIdentityAsync<FacebookCredentials>();

<span data-ttu-id="5fe3b-267">Кроме того Если приложение принимает зависимости пользователя идентификаторы, например для сохранения их в базе данных, очень важно toonote, hello идентификаторы пользователя мобильных служб и мобильные приложения службы приложений не совпадают.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-267">Additionally, if your application takes dependencies on user IDs, such as storing them in a database, it is important toonote that hello user IDs between Mobile Services and App Service Mobile Apps are different.</span></span> <span data-ttu-id="5fe3b-268">Вы все равно можете hello идентификатор пользователя мобильных служб, однако.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-268">You can still get hello Mobile Services User ID, though.</span></span> <span data-ttu-id="5fe3b-269">Все подклассы ProviderCredentials hello имеют свойства UserId.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-269">All of hello ProviderCredentials subclasses have a UserId property.</span></span> <span data-ttu-id="5fe3b-270">Поэтому продолжении из пример hello раньше:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-270">So continuing from hello example before:</span></span>

        string mobileServicesUserId = creds.Provider + ":" + creds.UserId;

<span data-ttu-id="5fe3b-271">Если приложение принимает все зависимости в коде пользователя, важно использовать hello аналогичной регистрации с помощью поставщика удостоверений, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-271">If your app does take any dependencies on user IDs, it is important that you leverage hello same registration with an identity provider if possible.</span></span> <span data-ttu-id="5fe3b-272">Идентификаторы пользователей являются обычно области toohello регистрации приложения, который был использован, поэтому Представляем новую регистрацию может создать проблемы с соответствующим пользователям tootheir данные.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-272">User IDs are typically scoped toohello application registration that was used, so introducing a new registration could create problems with matching users tootheir data.</span></span>

### <a name="custom-authentication"></a><span data-ttu-id="5fe3b-273">Настраиваемая проверка подлинности</span><span class="sxs-lookup"><span data-stu-id="5fe3b-273">Custom authentication</span></span>
<span data-ttu-id="5fe3b-274">Если приложение использует решение нестандартной проверки подлинности, требуется toomake hello обновленного узла содержит систему toohello доступа.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-274">If your app is using a custom authentication solution, you will want toomake sure that hello upgraded site has access toohello system.</span></span> <span data-ttu-id="5fe3b-275">Следуйте инструкциям новый hello для нестандартной проверки подлинности в hello [Обзор пакета SDK для .NET server] toointegrate решения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-275">Follow hello new instructions for custom authentication in hello [.NET server SDK overview] toointegrate your solution.</span></span> <span data-ttu-id="5fe3b-276">Обратите внимание на то, что компоненты hello нестандартной проверки подлинности все еще находятся в предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-276">Please note that hello custom authentication components are still in preview.</span></span>

## <span data-ttu-id="5fe3b-277"><a name="updating-clients"></a>Обновление клиентов</span><span class="sxs-lookup"><span data-stu-id="5fe3b-277"><a name="updating-clients"></a>Updating clients</span></span>
<span data-ttu-id="5fe3b-278">После получения рабочей серверной части мобильных приложений вы можете работать с новой версией клиентского приложения, которое использует эту серверную часть.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-278">Once you have an operational Mobile App backend, you can work on a new version of your client application which consumes it.</span></span> <span data-ttu-id="5fe3b-279">Мобильные приложения также включает в себя новую версию клиента hello пакеты SDK и аналогичные обновления сервера toohello выше, необходимо будет tooremove все ссылки toohello Mobile Services SDK перед установкой версии мобильные приложения hello.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-279">Mobile Apps also includes a new version of hello client SDKs, and similar toohello server upgrade above, you will need tooremove all references toohello Mobile Services SDKs before installing hello Mobile Apps versions.</span></span>

<span data-ttu-id="5fe3b-280">Одним из hello основные различия между версиями hello является то, что конструкторы hello больше не требуется ключ приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-280">One of hello main changes between hello versions is that hello constructors no longer require an application key.</span></span> <span data-ttu-id="5fe3b-281">Теперь просто передать URL-адрес hello мобильного приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-281">You now simply pass in hello URL of your Mobile App.</span></span> <span data-ttu-id="5fe3b-282">Например, для клиентов .NET hello, hello `MobileServiceClient` конструктор больше не:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-282">For example, on hello .NET clients, hello `MobileServiceClient` constructor is now:</span></span>

        public static MobileServiceClient MobileService = new MobileServiceClient(
            "https://contoso.azurewebsites.net", // URL of hello Mobile App
        );

<span data-ttu-id="5fe3b-283">Вы можете прочесть об установке hello новых пакетов SDK и с помощью новой структуры hello через hello ссылки ниже:</span><span class="sxs-lookup"><span data-stu-id="5fe3b-283">You can read about installing hello new SDKs and using hello new structure via hello links below:</span></span>

* [<span data-ttu-id="5fe3b-284">iOS 3.0.0 или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="5fe3b-284">iOS version 3.0.0 or later</span></span>](app-service-mobile-ios-how-to-use-client-library.md)
* [<span data-ttu-id="5fe3b-285">.NET (Windows/Xamarin) 2.0.0 или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="5fe3b-285">.NET (Windows/Xamarin) version 2.0.0 or later</span></span>](app-service-mobile-dotnet-how-to-use-client-library.md)

<span data-ttu-id="5fe3b-286">Если приложение принимает использовать push-уведомлений, запишите hello инструкции конкретной регистрации для каждой платформы, как будут внесены некоторые изменения также.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-286">If your application makes use of push notifications, make note of hello specific registration instructions for each platform, as there have been some changes there as well.</span></span>

<span data-ttu-id="5fe3b-287">При наличии hello новую версию клиента готов, попробуйте для проекта на обновленном сервере.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-287">When you have hello new client version ready, try it out against your upgraded server project.</span></span> <span data-ttu-id="5fe3b-288">После проверки того, что он работает, можно освободить новую версию toocustomers вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-288">After validating that it works, you can release a new version of your application toocustomers.</span></span> <span data-ttu-id="5fe3b-289">Со временем Если ваши клиенты уже есть tooreceive вероятность эти обновления, можно удалить версии приложения для мобильных служб hello.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-289">Eventually, once your customers have had a chance tooreceive these updates, you can delete hello Mobile Services version of your app.</span></span> <span data-ttu-id="5fe3b-290">В этот момент по окончании обновления tooan приложение службы мобильных приложений с помощью сервера последнюю мобильные приложения hello SDK.</span><span class="sxs-lookup"><span data-stu-id="5fe3b-290">At this point, you have completely upgraded tooan App Service Mobile App using hello latest Mobile Apps server SDK.</span></span>

<!-- URLs. -->

[портал Azure]: https://portal.azure.com/
[классический портал Azure]: https://manage.windowsazure.com/
[Каковы мобильные приложения?]: app-service-mobile-value-prop.md
[I already use web sites and mobile services – how does App Service help me?]: /en-us/documentation/articles/app-service-mobile-value-prop-migration-from-mobile-services
[пакет SDK для мобильных приложений сервера]: http://www.nuget.org/packages/microsoft.azure.mobile.server
[Create a Mobile App]: app-service-mobile-xamarin-ios-get-started.md
[Add push notifications tooyour mobile app]: app-service-mobile-xamarin-ios-get-started-push.md
[Add authentication tooyour mobile app]: app-service-mobile-xamarin-ios-get-started-users.md
[планировщика Azure]: /en-us/documentation/services/scheduler/
[веб-задание]: ../app-service-web/websites-webjobs-resources.md
[как toouse hello .NET server SDK]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md
[Migrate from Mobile Services tooan App Service Mobile App]: app-service-mobile-migrating-from-mobile-services.md
[Migrate your existing Mobile Service tooApp Service]: app-service-mobile-migrating-from-mobile-services.md
[служб приложений Ценовая]: https://azure.microsoft.com/en-us/pricing/details/app-service/
[Обзор пакета SDK для .NET server]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md
