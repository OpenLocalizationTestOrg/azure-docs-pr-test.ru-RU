---
title: "Что делать в случае простоя службы хранилища Azure | Документация Майкрософт"
description: "Что делать в случае простоя службы хранилища Azure"
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: 83ab487f382eb84aa64b927bdf5560eec5cbbd6d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="what-to-do-if-an-azure-storage-outage-occurs"></a><span data-ttu-id="69cab-103">Что делать в случае простоя службы хранилища Azure</span><span class="sxs-lookup"><span data-stu-id="69cab-103">What to do if an Azure Storage outage occurs</span></span>
<span data-ttu-id="69cab-104">Корпорация Майкрософт прилагает все усилия, чтобы наши службы были всегда доступны.</span><span class="sxs-lookup"><span data-stu-id="69cab-104">At Microsoft, we work hard to make sure our services are always available.</span></span> <span data-ttu-id="69cab-105">Иногда по независящим от нас обстоятельствам происходят незапланированные простои служб в одном или нескольких регионах.</span><span class="sxs-lookup"><span data-stu-id="69cab-105">Sometimes, forces beyond our control impact us in ways that cause unplanned service outages in one or more regions.</span></span> <span data-ttu-id="69cab-106">Ниже приведено общее руководство для служб хранилища Azure, которое поможет вам справиться с такими редкими ситуациями.</span><span class="sxs-lookup"><span data-stu-id="69cab-106">To help you handle these rare occurrences, we provide the following high-level guidance for Azure Storage services.</span></span>

## <a name="how-to-prepare"></a><span data-ttu-id="69cab-107">Подготовка</span><span class="sxs-lookup"><span data-stu-id="69cab-107">How to prepare</span></span>
<span data-ttu-id="69cab-108">Крайне важно, чтобы каждый клиент подготовил свой собственный план аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="69cab-108">It is critical for every customer to prepare their own disaster recovery plan.</span></span> <span data-ttu-id="69cab-109">Меры по восстановлению работоспособности приложений после простоя обычно охватывают как персонал, так и автоматизированные процедуры.</span><span class="sxs-lookup"><span data-stu-id="69cab-109">The effort to recover from a storage outage typically involves both operations personnel and automated procedures in order to reactivate your applications in a functioning state.</span></span> <span data-ttu-id="69cab-110">Обратитесь к приведенной ниже документации Azure, чтобы составить свой план аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="69cab-110">Please refer to the Azure documentation below to build your own disaster recovery plan:</span></span>

* [<span data-ttu-id="69cab-111">Аварийное восстановление и высокий уровень доступности для приложений Azure</span><span class="sxs-lookup"><span data-stu-id="69cab-111">Disaster recovery and high availability for Azure applications</span></span>](../resiliency/resiliency-disaster-recovery-high-availability-azure-applications.md)
* [<span data-ttu-id="69cab-112">Техническое руководство по обеспечению устойчивости в Azure</span><span class="sxs-lookup"><span data-stu-id="69cab-112">Azure resiliency technical guidance</span></span>](../resiliency/resiliency-technical-guidance.md)
* [<span data-ttu-id="69cab-113">Служба Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="69cab-113">Azure Site Recovery service</span></span>](https://azure.microsoft.com/services/site-recovery/)
* [<span data-ttu-id="69cab-114">Репликация службы хранилища Azure</span><span class="sxs-lookup"><span data-stu-id="69cab-114">Azure Storage replication</span></span>](storage-redundancy.md)
* [<span data-ttu-id="69cab-115">Служба архивации Azure</span><span class="sxs-lookup"><span data-stu-id="69cab-115">Azure Backup service</span></span>](https://azure.microsoft.com/services/backup/)

## <a name="how-to-detect"></a><span data-ttu-id="69cab-116">Определение</span><span class="sxs-lookup"><span data-stu-id="69cab-116">How to detect</span></span>
<span data-ttu-id="69cab-117">Чтобы определить состояние службы Azure, рекомендуется подписаться на [панель мониторинга работоспособности службы Azure](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="69cab-117">The recommended way to determine the Azure service status is to subscribe to the [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span>

## <a name="what-to-do-if-a-storage-outage-occurs"></a><span data-ttu-id="69cab-118">Что делать в случае простоя службы хранилища</span><span class="sxs-lookup"><span data-stu-id="69cab-118">What to do if a Storage outage occurs</span></span>
<span data-ttu-id="69cab-119">Если одна или несколько служб хранилища временно недоступны в одном или нескольких регионах, вы можете воспользоваться одним из двух вариантов.</span><span class="sxs-lookup"><span data-stu-id="69cab-119">If one or more Storage services are temporarily unavailable at one or more regions, there are two options for you to consider.</span></span> <span data-ttu-id="69cab-120">Если требуется немедленный доступ к данным, рассмотрите вариант 2.</span><span class="sxs-lookup"><span data-stu-id="69cab-120">If you desire immediate access to your data, please consider Option 2.</span></span>

### <a name="option-1-wait-for-recovery"></a><span data-ttu-id="69cab-121">Вариант 1. ожидание восстановления</span><span class="sxs-lookup"><span data-stu-id="69cab-121">Option 1: Wait for recovery</span></span>
<span data-ttu-id="69cab-122">В этом случае вам не нужно предпринимать какие-либо действия.</span><span class="sxs-lookup"><span data-stu-id="69cab-122">In this case, no action on your part is required.</span></span> <span data-ttu-id="69cab-123">Мы активно работаем для восстановления доступности службы Azure.</span><span class="sxs-lookup"><span data-stu-id="69cab-123">We are working diligently to restore the Azure service availability.</span></span> <span data-ttu-id="69cab-124">Текущее состояние службы можно просмотреть на [панели мониторинга работоспособности службы Azure](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="69cab-124">You can monitor the service status on the [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span>

### <a name="option-2-copy-data-from-secondary"></a><span data-ttu-id="69cab-125">Вариант 2. Копирование данных из дополнительного региона</span><span class="sxs-lookup"><span data-stu-id="69cab-125">Option 2: Copy data from secondary</span></span>
<span data-ttu-id="69cab-126">Если вы выбрали [Read-access geo-redundant storage (RA-GRS)](storage-redundancy.md#read-access-geo-redundant-storage) (Доступ для чтения данных из гео-избыточного хранилища) (рекомендуется) для учетных записей хранения, то получите доступ только для чтения к своим данным из дополнительного региона.</span><span class="sxs-lookup"><span data-stu-id="69cab-126">If you chose [Read-access geo-redundant storage (RA-GRS)](storage-redundancy.md#read-access-geo-redundant-storage) (recommended) for your storage accounts, you will have read access to your data from the secondary region.</span></span> <span data-ttu-id="69cab-127">Вы можете использовать такие средства, как [AzCopy](storage-use-azcopy.md), [Azure PowerShell](storage-powershell-guide-full.md) и [библиотека перемещения данных Azure](https://azure.microsoft.com/blog/introducing-azure-storage-data-movement-library-preview-2/), чтобы скопировать данные из дополнительного региона в другую учетную запись хранения в незатронутом регионе и затем указать эту учетную запись для приложений как доступную для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="69cab-127">You can use tools such as [AzCopy](storage-use-azcopy.md), [Azure PowerShell](storage-powershell-guide-full.md), and the [Azure Data Movement library](https://azure.microsoft.com/blog/introducing-azure-storage-data-movement-library-preview-2/) to copy data from the secondary region into another storage account in an unimpacted region, and then point your applications to that storage account for both read and write availability.</span></span>

## <a name="what-to-expect-if-a-storage-failover-occurs"></a><span data-ttu-id="69cab-128">Что произойдет в случае отработки отказа хранилища</span><span class="sxs-lookup"><span data-stu-id="69cab-128">What to expect if a Storage failover occurs</span></span>
<span data-ttu-id="69cab-129">Если вы выбрали [Геоизбыточное хранилище](storage-redundancy.md#geo-redundant-storage) или [Доступ к геоизбыточному хранилищу для чтения](storage-redundancy.md#read-access-geo-redundant-storage) (рекомендуется), служба хранилища Azure будет хранить данные устойчиво в двух регионах (основном и дополнительном).</span><span class="sxs-lookup"><span data-stu-id="69cab-129">If you chose [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) or [Read-access geo-redundant storage (RA-GRS)](storage-redundancy.md#read-access-geo-redundant-storage) (recommended), Azure Storage will keep your data durable in two regions (primary and secondary).</span></span> <span data-ttu-id="69cab-130">В обоих регионах служба хранилища Azure постоянно поддерживает несколько реплик ваших данных.</span><span class="sxs-lookup"><span data-stu-id="69cab-130">In both regions, Azure Storage constantly maintains multiple replicas of your data.</span></span>

<span data-ttu-id="69cab-131">Когда в основном регионе происходит авария, мы сначала пытаемся восстановить службу в нем.</span><span class="sxs-lookup"><span data-stu-id="69cab-131">When a regional disaster affects your primary region, we will first try to restore the service in that region.</span></span> <span data-ttu-id="69cab-132">Это зависит от характера аварии и ее последствий; в некоторых редких ситуациях мы не можем восстановить основной регион.</span><span class="sxs-lookup"><span data-stu-id="69cab-132">Dependent upon the nature of the disaster and its impacts, in some rare occasions we may not be able to restore the primary region.</span></span> <span data-ttu-id="69cab-133">В этом случае мы выполняем географическую отработку отказа.</span><span class="sxs-lookup"><span data-stu-id="69cab-133">At that point, we will perform a geo-failover.</span></span> <span data-ttu-id="69cab-134">Межрегиональная репликация данных является асинхронным процессом, который может подразумевает некоторую задержку, поэтому изменения, которые еще не были реплицированы в дополнительный регион, могут быть потеряны.</span><span class="sxs-lookup"><span data-stu-id="69cab-134">The cross-region data replication is an asynchronous process which can involve a delay, so it is possible that changes that have not yet been replicated to the secondary region may be lost.</span></span> <span data-ttu-id="69cab-135">Можно запросить ["Время последней синхронизации" учетной записи хранения](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/) для получения сведений о состоянии репликации.</span><span class="sxs-lookup"><span data-stu-id="69cab-135">You can query the ["Last Sync Time" of your storage account](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/) to get details on the replication status.</span></span>

<span data-ttu-id="69cab-136">Ряд замечаний о географической отработке отказа хранилища.</span><span class="sxs-lookup"><span data-stu-id="69cab-136">A couple of points regarding the storage geo-failover experience:</span></span>

* <span data-ttu-id="69cab-137">Географическая отработка отказа хранилища будет инициироваться только команда специалистов по службе хранилища Azure, никаких действий со стороны клиента не требуется.</span><span class="sxs-lookup"><span data-stu-id="69cab-137">Storage geo-failover will only be triggered by the Azure Storage team – there is no customer action required.</span></span>
* <span data-ttu-id="69cab-138">После отработки отказа существующие конечные точки службы хранилища для больших двоичных объектов, таблиц, очередей и файлов остаются прежними. При этом потребуется обновить запись DNS для переключения с основного региона на дополнительный.</span><span class="sxs-lookup"><span data-stu-id="69cab-138">Your existing storage service endpoints for blobs, tables, queues, and files will remain the same after the failover; the DNS entry will need to be updated to switch from the primary region to the secondary region.</span></span>
* <span data-ttu-id="69cab-139">До и во время географической отработки отказа у вас не будет доступа на запись к своей учетной записи хранения, однако вы сможете считывать данные из дополнительного региона, если ваша учетная запись хранения была настроена как RA-GRS.</span><span class="sxs-lookup"><span data-stu-id="69cab-139">Before and during the geo-failover, you won't have write access to your storage account due to the impact of the disaster but you can still read from the secondary if your storage account has been configured as RA-GRS.</span></span>
* <span data-ttu-id="69cab-140">После окончания географической отработки отказа и распространения изменений DNS доступ на чтение и запись к вашей учетной записи хранения будет восстановлен. Для этого будет использоваться дополнительная конечная точка.</span><span class="sxs-lookup"><span data-stu-id="69cab-140">When the geo-failover has been completed and the DNS changes propagated, read and write access to your storage account will be resumed; this points to what used to be your secondary endpoint.</span></span> 
* <span data-ttu-id="69cab-141">Обратите внимание, что у вас будет доступ на запись, если вы настроили хранилище GRS или RA-GRS для учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="69cab-141">Note that you will have write access if you have GRS or RA-GRS configured for the storage account.</span></span> 
* <span data-ttu-id="69cab-142">Можно запросить [Last Geo Failover Time (Время последней географической отработки отказа) учетной записи](https://msdn.microsoft.com/library/azure/ee460802.aspx) для получения дополнительных сведений.</span><span class="sxs-lookup"><span data-stu-id="69cab-142">You can query ["Last Geo Failover Time" of your storage account](https://msdn.microsoft.com/library/azure/ee460802.aspx) to get more details.</span></span>
* <span data-ttu-id="69cab-143">После отработки отказа ваша учетная запись хранения будет полностью работоспособной, однако будет находиться в состоянии пониженной функциональности из-за размещения в автономном регионе без возможности георепликации.</span><span class="sxs-lookup"><span data-stu-id="69cab-143">After the failover, your storage account will be fully functioning, but in a "degraded" status, as it is actually hosted in a standalone region with no geo-replication possible.</span></span> <span data-ttu-id="69cab-144">Чтобы уменьшить этот риск, мы восстановим исходный основной области и выполним географическую отработку отказа для восстановления исходного состояния.</span><span class="sxs-lookup"><span data-stu-id="69cab-144">To mitigate this risk, we will restore the original primary region and then do a geo-failback to restore the original state.</span></span> <span data-ttu-id="69cab-145">Если исходный основной регион не подлежит восстановлению, мы назначим другой дополнительный регион.</span><span class="sxs-lookup"><span data-stu-id="69cab-145">If the original primary region is unrecoverable, we will allocate another secondary region.</span></span>
  <span data-ttu-id="69cab-146">Дополнительные сведения об инфраструктуре георепликации службы хранилища Azure см. в статье [Варианты избыточности и RA-GRS](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/) в блоге разработчиков службы хранилища.</span><span class="sxs-lookup"><span data-stu-id="69cab-146">For more details on the infrastructure of Azure Storage geo replication, please refer to the article on the Storage team blog about [Redundancy Options and RA-GRS](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

## <a name="best-practices-for-protecting-your-data"></a><span data-ttu-id="69cab-147">Советы и рекомендации по защите данных</span><span class="sxs-lookup"><span data-stu-id="69cab-147">Best Practices for protecting your data</span></span>
<span data-ttu-id="69cab-148">Существуют некоторые рекомендуемые подходы для регулярной архивации данных в хранилище.</span><span class="sxs-lookup"><span data-stu-id="69cab-148">There are some recommended approaches to back up your storage data on a regular basis.</span></span>

* <span data-ttu-id="69cab-149">Диски виртуальной машины — используйте [службу архивации Azure](https://azure.microsoft.com/services/backup/) для архивации дисков виртуальных машин Azure.</span><span class="sxs-lookup"><span data-stu-id="69cab-149">VM Disks – Use the [Azure Backup service](https://azure.microsoft.com/services/backup/) to back up the VM disks used by your Azure virtual machines.</span></span>
* <span data-ttu-id="69cab-150">Блочные BLOB-объекты — создайте [моментальный снимок](https://msdn.microsoft.com/library/azure/hh488361.aspx) каждого блочного BLOB-объекта или скопируйте BLOB-объекты в другую учетную запись хранения, относящуюся к другому региону, с помощью [AzCopy](storage-use-azcopy.md), [Azure PowerShell](storage-powershell-guide-full.md) или [библиотеки перемещения данных Azure](https://azure.microsoft.com/blog/introducing-azure-storage-data-movement-library-preview-2/).</span><span class="sxs-lookup"><span data-stu-id="69cab-150">Block blobs –Create a [snapshot](https://msdn.microsoft.com/library/azure/hh488361.aspx) of each block blob, or copy the blobs to another storage account in another region using [AzCopy](storage-use-azcopy.md), [Azure PowerShell](storage-powershell-guide-full.md), or the [Azure Data Movement library](https://azure.microsoft.com/blog/introducing-azure-storage-data-movement-library-preview-2/).</span></span>
* <span data-ttu-id="69cab-151">Таблицы — используйте [AzCopy](storage-use-azcopy.md) для экспорта данных таблиц в другую учетную запись хранения, относящуюся к другому региону.</span><span class="sxs-lookup"><span data-stu-id="69cab-151">Tables – use [AzCopy](storage-use-azcopy.md) to export the table data into another storage account in another region.</span></span>
* <span data-ttu-id="69cab-152">Файлы — используйте [AzCopy](storage-use-azcopy.md) или [Azure PowerShell](storage-powershell-guide-full.md) для копирования файлов в другую учетную запись хранения, относящуюся к другому региону.</span><span class="sxs-lookup"><span data-stu-id="69cab-152">Files – use [AzCopy](storage-use-azcopy.md) or [Azure PowerShell](storage-powershell-guide-full.md) to copy your files to another storage account in another region.</span></span>

<span data-ttu-id="69cab-153">Сведения о создании приложений, использующих все преимущества функции RA-GRS, доступны в разделе [Проектирование высокодоступных приложений с использованием хранилища RA-GRS](storage-designing-ha-apps-with-ragrs.md).</span><span class="sxs-lookup"><span data-stu-id="69cab-153">For information about creating applications that take full advantage of the RA-GRS feature, please check out [Designing Highly Available Applications using RA-GRS Storage](storage-designing-ha-apps-with-ragrs.md)</span></span>

