---
title: "aaaAzure руководство по созданию таблицы хранилища | Документы Microsoft"
description: "Разработка масштабируемых и высокопроизводительных таблиц в табличном хранилище Azure"
services: storage
documentationcenter: na
author: jasonnewyork
manager: tadb
editor: tysonn
ms.assetid: 8e228b0c-2998-4462-8101-9f16517393ca
ms.service: storage
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage
ms.date: 02/28/2017
ms.author: jahogg
ms.openlocfilehash: bbac5e83fe994c1ba1408dd43367fbcfca6a2148
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-table-design-guide-designing-scalable-and-performant-tables"></a><span data-ttu-id="4269a-103">Руководство по разработке табличных хранилищ Azure: разработка масштабируемых и высокопроизводительных таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-103">Azure Storage Table Design Guide: Designing Scalable and Performant Tables</span></span>
[!INCLUDE [storage-table-cosmos-db-tip-include](../../includes/storage-table-cosmos-db-tip-include.md)]

<span data-ttu-id="4269a-104">toodesign масштабируемых и высокопроизводительных таблиц необходимо учитывать ряд факторов, таких как производительности, масштабируемости и затрат.</span><span class="sxs-lookup"><span data-stu-id="4269a-104">toodesign scalable and performant tables you must consider a number of factors such as performance, scalability, and cost.</span></span> <span data-ttu-id="4269a-105">Ранее разработанный схемы для реляционных баз данных, эти вопросы будут знакомы tooyou, но существуют некоторые сходства между модель хранения службы таблиц Azure hello и реляционные модели, существуют также многие важные различия.</span><span class="sxs-lookup"><span data-stu-id="4269a-105">If you have previously designed schemas for relational databases, these considerations will be familiar tooyou, but while there are some similarities between hello Azure Table service storage model and relational models, there are also many important differences.</span></span> <span data-ttu-id="4269a-106">Обычно эти отличия приводят toovery различными вариантами, может выглядеть counter-intuitive или неправильный toosomeone, знакомый с реляционными базами данных, но что следует делать хорошее представление при разработке для хранилища ключей и значений NoSQL например hello службы таблиц Azure.</span><span class="sxs-lookup"><span data-stu-id="4269a-106">These differences typically lead toovery different designs that may look counter-intuitive or wrong toosomeone familiar with relational databases, but which do make good sense if you are designing for a NoSQL key/value store such as hello Azure Table service.</span></span> <span data-ttu-id="4269a-107">Число различия в разработке будут отражать hello факт, что служба таблиц hello спроектированный toosupport масштабе облака приложений, которые могут содержать миллиарды сущностей (строк в терминах реляционных баз данных), данных или наборов данных должен поддерживать очень высокий объем транзакций: таким образом, требуется toothink по-разному о том, как хранить данные и понять, как работает hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-107">Many of your design differences will reflect hello fact that hello Table service is designed toosupport cloud-scale applications that can contain billions of entities (rows in relational database terminology) of data or for datasets that must support very high transaction volumes: therefore, you need toothink differently about how you store your data and understand how hello Table service works.</span></span> <span data-ttu-id="4269a-108">Хорошо спроектированные хранилище данных NoSQL можно включить вашего решения tooscale дальше (и при более низких затратах) чем решения, использующего реляционной базы данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-108">A well designed NoSQL data store can enable your solution tooscale much further (and at a lower cost) than a solution that uses a relational database.</span></span> <span data-ttu-id="4269a-109">Данное руководство поможет решить эти задачи.</span><span class="sxs-lookup"><span data-stu-id="4269a-109">This guide helps you with these topics.</span></span>  

## <a name="about-hello-azure-table-service"></a><span data-ttu-id="4269a-110">О hello службы таблиц Azure</span><span class="sxs-lookup"><span data-stu-id="4269a-110">About hello Azure Table service</span></span>
<span data-ttu-id="4269a-111">В этом разделе описываются некоторые функции hello ключа hello службы таблиц, особенно применимо toodesigning производительности и масштабируемости.</span><span class="sxs-lookup"><span data-stu-id="4269a-111">This section highlights some of hello key features of hello Table service that are especially relevant toodesigning for performance and scalability.</span></span> <span data-ttu-id="4269a-112">Если новый tooAzure хранилища и hello службы таблиц, сначала прочтите [tooMicrosoft введение хранилища Azure](storage-introduction.md) и [приступить к работе с хранилищем таблиц Azure, с помощью .NET](storage-dotnet-how-to-use-tables.md) перед чтением hello оставшейся части данной статья.</span><span class="sxs-lookup"><span data-stu-id="4269a-112">If you are new tooAzure Storage and hello Table service, first read [Introduction tooMicrosoft Azure Storage](storage-introduction.md) and [Get started with Azure Table Storage using .NET](storage-dotnet-how-to-use-tables.md) before reading hello remainder of this article.</span></span> <span data-ttu-id="4269a-113">Несмотря на то, что hello в этом руководстве нацелено на hello службы таблиц, сюда входят некоторые обсуждение приветствия очереди Azure и службы больших двоичных объектов, и как их можно использовать вместе с hello службы таблиц в решении.</span><span class="sxs-lookup"><span data-stu-id="4269a-113">Although hello focus of this guide is on hello Table service, it will include some discussion of hello Azure Queue and Blob services, and how you might use them along with hello Table service in a solution.</span></span>  

<span data-ttu-id="4269a-114">Что такое служба hello таблицы?</span><span class="sxs-lookup"><span data-stu-id="4269a-114">What is hello Table service?</span></span> <span data-ttu-id="4269a-115">Как и следует ожидать от имени hello, hello служба таблиц использует данных toostore табличном формате.</span><span class="sxs-lookup"><span data-stu-id="4269a-115">As you might expect from hello name, hello Table service uses a tabular format toostore data.</span></span> <span data-ttu-id="4269a-116">В стандартных терминах hello каждой строки таблицы hello представляет сущность и хранилища столбцов hello hello различные свойства этого объекта.</span><span class="sxs-lookup"><span data-stu-id="4269a-116">In hello standard terminology, each row of hello table represents an entity, and hello columns store hello various properties of that entity.</span></span> <span data-ttu-id="4269a-117">Каждая сущность имеет пару ключей toouniquely идентифицировать его и столбец типа timestamp, Здравствуйте, служба таблиц использует tootrack время последнего обновления сущности hello (это происходит автоматически и вручную перезаписать hello timestamp с произвольным значением).</span><span class="sxs-lookup"><span data-stu-id="4269a-117">Every entity has a pair of keys toouniquely identify it, and a timestamp column that hello Table service uses tootrack when hello entity was last updated (this happens automatically and you cannot manually overwrite hello timestamp with an arbitrary value).</span></span> <span data-ttu-id="4269a-118">Hello служба таблиц использует оптимистический параллелизм toomanage это отметка времени последнего изменения (LMT).</span><span class="sxs-lookup"><span data-stu-id="4269a-118">hello Table service uses this last-modified timestamp (LMT) toomanage optimistic concurrency.</span></span>  

> [!NOTE]
> <span data-ttu-id="4269a-119">операции REST API службы таблиц Hello также возвращают **ETag** значение, он является производным от последнего изменения отметок времени hello (LMT).</span><span class="sxs-lookup"><span data-stu-id="4269a-119">hello Table service REST API operations also return an **ETag** value that it derives from hello last-modified timestamp (LMT).</span></span> <span data-ttu-id="4269a-120">В этом документе мы будем использовать hello термины ETag и LMT взаимозаменяемо, так как они ссылаются toohello же базовым данным.</span><span class="sxs-lookup"><span data-stu-id="4269a-120">In this document we will use hello terms ETag and LMT interchangeably because they refer toohello same underlying data.</span></span>  
> 
> 

<span data-ttu-id="4269a-121">Hello пример toostore разработки простую таблицу employee и department и сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-121">hello following example shows a simple table design toostore employee and department entities.</span></span> <span data-ttu-id="4269a-122">Многие примеры hello, приведенные далее в этом руководстве, основаны на такой простой подход.</span><span class="sxs-lookup"><span data-stu-id="4269a-122">Many of hello examples shown later in this guide are based on this simple design.</span></span>  

<table>
<tr>
<th><span data-ttu-id="4269a-123">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4269a-123">PartitionKey</span></span></th>
<th><span data-ttu-id="4269a-124">RowKey</span><span class="sxs-lookup"><span data-stu-id="4269a-124">RowKey</span></span></th>
<th><span data-ttu-id="4269a-125">Timestamp</span><span class="sxs-lookup"><span data-stu-id="4269a-125">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-126">Marketing</span><span class="sxs-lookup"><span data-stu-id="4269a-126">Marketing</span></span></td>
<td><span data-ttu-id="4269a-127">00001</span><span class="sxs-lookup"><span data-stu-id="4269a-127">00001</span></span></td>
<td><span data-ttu-id="4269a-128">2014-08-22T00:50:32Z</span><span class="sxs-lookup"><span data-stu-id="4269a-128">2014-08-22T00:50:32Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-129">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-129">FirstName</span></span></th>
<th><span data-ttu-id="4269a-130">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-130">LastName</span></span></th>
<th><span data-ttu-id="4269a-131">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-131">Age</span></span></th>
<th><span data-ttu-id="4269a-132">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-132">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-133">Don</span><span class="sxs-lookup"><span data-stu-id="4269a-133">Don</span></span></td>
<td><span data-ttu-id="4269a-134">Hall</span><span class="sxs-lookup"><span data-stu-id="4269a-134">Hall</span></span></td>
<td><span data-ttu-id="4269a-135">34</span><span class="sxs-lookup"><span data-stu-id="4269a-135">34</span></span></td>
<td>donh@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="4269a-136">Marketing</span><span class="sxs-lookup"><span data-stu-id="4269a-136">Marketing</span></span></td>
<td><span data-ttu-id="4269a-137">00002</span><span class="sxs-lookup"><span data-stu-id="4269a-137">00002</span></span></td>
<td><span data-ttu-id="4269a-138">2014-08-22T00:50:34Z</span><span class="sxs-lookup"><span data-stu-id="4269a-138">2014-08-22T00:50:34Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-139">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-139">FirstName</span></span></th>
<th><span data-ttu-id="4269a-140">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-140">LastName</span></span></th>
<th><span data-ttu-id="4269a-141">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-141">Age</span></span></th>
<th><span data-ttu-id="4269a-142">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-142">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-143">Jun</span><span class="sxs-lookup"><span data-stu-id="4269a-143">Jun</span></span></td>
<td><span data-ttu-id="4269a-144">Cao</span><span class="sxs-lookup"><span data-stu-id="4269a-144">Cao</span></span></td>
<td><span data-ttu-id="4269a-145">47</span><span class="sxs-lookup"><span data-stu-id="4269a-145">47</span></span></td>
<td>junc@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="4269a-146">Marketing</span><span class="sxs-lookup"><span data-stu-id="4269a-146">Marketing</span></span></td>
<td><span data-ttu-id="4269a-147">Department</span><span class="sxs-lookup"><span data-stu-id="4269a-147">Department</span></span></td>
<td><span data-ttu-id="4269a-148">2014-08-22T00:50:30Z</span><span class="sxs-lookup"><span data-stu-id="4269a-148">2014-08-22T00:50:30Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-149">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="4269a-149">DepartmentName</span></span></th>
<th><span data-ttu-id="4269a-150">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="4269a-150">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="4269a-151">Marketing</span></span></td>
<td><span data-ttu-id="4269a-152">153</span><span class="sxs-lookup"><span data-stu-id="4269a-152">153</span></span></td>
</tr>
</table>
</td>
</tr>
<tr>
<td><span data-ttu-id="4269a-153">Sales</span><span class="sxs-lookup"><span data-stu-id="4269a-153">Sales</span></span></td>
<td><span data-ttu-id="4269a-154">00010</span><span class="sxs-lookup"><span data-stu-id="4269a-154">00010</span></span></td>
<td><span data-ttu-id="4269a-155">2014-08-22T00:50:44Z</span><span class="sxs-lookup"><span data-stu-id="4269a-155">2014-08-22T00:50:44Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-156">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-156">FirstName</span></span></th>
<th><span data-ttu-id="4269a-157">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-157">LastName</span></span></th>
<th><span data-ttu-id="4269a-158">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-158">Age</span></span></th>
<th><span data-ttu-id="4269a-159">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-159">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-160">Ken</span><span class="sxs-lookup"><span data-stu-id="4269a-160">Ken</span></span></td>
<td><span data-ttu-id="4269a-161">Kwok</span><span class="sxs-lookup"><span data-stu-id="4269a-161">Kwok</span></span></td>
<td><span data-ttu-id="4269a-162">23</span><span class="sxs-lookup"><span data-stu-id="4269a-162">23</span></span></td>
<td>kenk@contoso.com</td>
</tr>
</table>
</td>
</tr>
</table>


<span data-ttu-id="4269a-163">Таким образом, это выглядит аналогично tooa таблицы реляционной базы данных с hello ключевые различия hello обязательные столбцы, и hello возможность toostore нескольких сущностей типов в hello одной таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-163">So far, this looks very similar tooa table in a relational database with hello key differences being hello mandatory columns, and hello ability toostore multiple entity types in hello same table.</span></span> <span data-ttu-id="4269a-164">Кроме того, каждый из hello определяемые пользователем свойства, такие как **FirstName** или **возраст** имеет тип данных, такие как integer или string, точно так же, как и столбец в реляционной базе данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-164">In addition, each of hello user-defined properties such as **FirstName** or **Age** has a data type, such as integer or string, just like a column in a relational database.</span></span> <span data-ttu-id="4269a-165">Несмотря на то, что в отличие от реляционной базы данных, без схемы характер hello hello таблицы службы означает, что свойство не обязаны иметь hello же тип данных для каждой сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-165">Although unlike in a relational database, hello schema-less nature of hello Table service means that a property need not have hello same data type on each entity.</span></span> <span data-ttu-id="4269a-166">toostore сложных типов данных в одном свойстве, необходимо использовать сериализованный формат, например JSON или XML.</span><span class="sxs-lookup"><span data-stu-id="4269a-166">toostore complex data types in a single property, you must use a serialized format such as JSON or XML.</span></span> <span data-ttu-id="4269a-167">Дополнительные сведения о типы данных службе, такие как поддерживаемой hello таблицы, диапазоны дат, поддерживаемые, правила именования и ограничения на размер см. в разделе [hello основные сведения о модели данных службы таблиц](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-167">For more information about hello table service such as supported data types, supported date ranges, naming rules, and size constraints, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>

<span data-ttu-id="4269a-168">Как видите, выбор **PartitionKey** и **RowKey** — основные toogood конструктора таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-168">As you will see, your choice of **PartitionKey** and **RowKey** is fundamental toogood table design.</span></span> <span data-ttu-id="4269a-169">Каждая сущность, хранящаяся в таблице, должна иметь уникальное сочетание значений **PartitionKey** и **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-169">Every entity stored in a table must have a unique combination of **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="4269a-170">Как и в случае с ключами в таблице реляционной базы данных hello **PartitionKey** и **RowKey** значения: индексированные toocreate кластеризованный индекс, который обеспечивает быстрый поиск; Однако hello служба таблиц не создаются вторичные индексы, поэтому эти hello только два индексированных свойств, (некоторые шаблоны hello, описанным ниже показывают, как обойти это ограничение явной).</span><span class="sxs-lookup"><span data-stu-id="4269a-170">As with keys in a relational database table, hello **PartitionKey** and **RowKey** values are indexed toocreate a clustered index that enables fast look-ups; however, hello Table service does not create any secondary indexes so these are hello only two indexed properties (some of hello patterns described later show how you can work around this apparent limitation).</span></span>  

<span data-ttu-id="4269a-171">Таблица состоит из одной или нескольких секций и как можно будет увидеть, многие hello разработки решения, принимаемые будет вокруг Выбор подходящего **PartitionKey** и **RowKey** toooptimize решения.</span><span class="sxs-lookup"><span data-stu-id="4269a-171">A table is made up of one or more partitions, and as you will see, many of hello design decisions you make will be around choosing a suitable **PartitionKey** and **RowKey** toooptimize your solution.</span></span> <span data-ttu-id="4269a-172">В решение может входить только одна таблица, в которой все сущности упорядочены по разделам. Однако обычно решение будет состоять из нескольких таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-172">A solution could consist of just a single table that contains all your entities organized into partitions, but typically a solution will have multiple tables.</span></span> <span data-ttu-id="4269a-173">Таблицы помогают toologically организация сущностей, помогут управлять доступом toohello данных с помощью управления доступом и ее можно удалить с помощью одна операция сохранения всей таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-173">Tables help you toologically organize your entities, help you manage access toohello data using access control lists, and you can drop an entire table using a single storage operation.</span></span>  

### <a name="table-partitions"></a><span data-ttu-id="4269a-174">Разделы таблицы</span><span class="sxs-lookup"><span data-stu-id="4269a-174">Table partitions</span></span>
<span data-ttu-id="4269a-175">Имя учетной записи Hello, имя таблицы и **PartitionKey** вместе определяют hello секции в службе хранилища hello, где служба таблиц hello хранит hello сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-175">hello account name, table name and **PartitionKey** together identify hello partition within hello storage service where hello table service stores hello entity.</span></span> <span data-ttu-id="4269a-176">А также не входит в состав hello, схема для сущностей адресации, секции определения области транзакции (см. [транзакции группы сущностей](#entity-group-transactions) ниже) и как служба таблиц hello масштабирует основу hello формы.</span><span class="sxs-lookup"><span data-stu-id="4269a-176">As well as being part of hello addressing scheme for entities, partitions define a scope for transactions (see [Entity Group Transactions](#entity-group-transactions) below), and form hello basis of how hello table service scales.</span></span> <span data-ttu-id="4269a-177">Дополнительные сведения о разделах см. в статье [Целевые показатели масштабируемости и производительности службы хранилища Azure](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="4269a-177">For more information on partitions see [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md).</span></span>  

<span data-ttu-id="4269a-178">В hello службы таблиц, отдельный узел службы или более завершения секций и hello службы шкал, динамически балансировки нагрузки секций между узлами.</span><span class="sxs-lookup"><span data-stu-id="4269a-178">In hello Table service, an individual node services one or more complete partitions and hello service scales by dynamically load-balancing partitions across nodes.</span></span> <span data-ttu-id="4269a-179">Если узел находится под нагрузкой, служба таблиц hello можно *разбиение* hello диапазона секций, обслуживаемых этого узла на разных узлах; при интенсивности трафика, hello службы можно *слияния* hello секции в диапазоне от Скрытый узлы обратно на одном узле.</span><span class="sxs-lookup"><span data-stu-id="4269a-179">If a node is under load, hello table service can *split* hello range of partitions serviced by that node onto different nodes; when traffic subsides, hello service can *merge* hello partition ranges from quiet nodes back onto a single node.</span></span>  

<span data-ttu-id="4269a-180">Дополнительные сведения о hello служба таблиц внутренние сведения о hello и в частности способы hello служба управляет секций см бумаги hello [хранилища Microsoft Azure: высокой доступных облачная служба хранилища строгих согласованности](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-180">For more information about hello internal details of hello Table service, and in particular how hello service manages partitions, see hello paper [Microsoft Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span></span>  

### <a name="entity-group-transactions"></a><span data-ttu-id="4269a-181">Транзакции группы сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-181">Entity Group Transactions</span></span>
<span data-ttu-id="4269a-182">В hello службы таблиц транзакции группы сущностей (EGTs) являются hello только встроенный механизм для выполнения атомарных обновлений для нескольких сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-182">In hello Table service, Entity Group Transactions (EGTs) are hello only built-in mechanism for performing atomic updates across multiple entities.</span></span> <span data-ttu-id="4269a-183">EGTs также, который ссылается tooas *пакетной операции* некоторые документы.</span><span class="sxs-lookup"><span data-stu-id="4269a-183">EGTs are also referred tooas *batch transactions* in some documentation.</span></span> <span data-ttu-id="4269a-184">EGTs может работать только с сущностей, хранящихся в hello одной секции (общую папку hello одинаковым ключом секции в данной таблице), поэтому каждый раз, когда требуется atomic поведение транзакций для нескольких сущностей необходимо, эти сущности находятся в hello tooensure одной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-184">EGTs can only operate on entities stored in hello same partition (share hello same partition key in a given table), so anytime you need atomic transactional behavior across multiple entities you need tooensure that those entities are in hello same partition.</span></span> <span data-ttu-id="4269a-185">Это часто причина для хранения нескольких типов сущностей в hello же таблицы (и секции) и не использует несколько таблиц для различных типов сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-185">This is often a reason for keeping multiple entity types in hello same table (and partition) and not using multiple tables for different entity types.</span></span> <span data-ttu-id="4269a-186">Одна транзакция группы сущностей может работать с максимум 100 сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-186">A single EGT can operate on at most 100 entities.</span></span>  <span data-ttu-id="4269a-187">При передаче нескольких параллельных EGTs для его обработки является важным tooensure этих EGTs работают на сущности, которые являются общими между EGTs, как в противном случае обработка может быть отложено.</span><span class="sxs-lookup"><span data-stu-id="4269a-187">If you submit multiple concurrent EGTs for processing it is important tooensure  those EGTs do not operate on entities that are common across EGTs as otherwise processing can be delayed.</span></span>

<span data-ttu-id="4269a-188">EGTs риск потенциальной компромисс для tooevaluate при проектировании: использование нескольких секций улучшает масштабируемость приложения hello, так как Azure имеет больше возможностей для балансировки нагрузки запросов между узлами, но это может ограничить hello возможность атомарные транзакции tooperform приложения и поддержания строгого согласованности данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-188">EGTs also introduce a potential trade-off for you tooevaluate in your design: using more partitions will increase hello scalability of your application because Azure has more opportunities for load balancing requests across nodes, but this might limit hello ability of your application tooperform atomic transactions and maintain strong consistency for your data.</span></span> <span data-ttu-id="4269a-189">Кроме того, существуют целевые показатели масштабируемости, определенных на уровне секции, которая может ограничить пропускную способность транзакций, можно ожидать для одного узла hello hello: Дополнительные сведения о hello целевые показатели масштабируемости для учетных записей хранилища Azure и hello таблицы службы см. в разделе [целевые показатели производительности и масштабируемости хранилища Azure](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="4269a-189">Furthermore, there are specific scalability targets at hello level of a partition that might limit hello throughput of transactions you can expect for a single node: for more information about hello scalability targets for Azure storage accounts and hello table service, see [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md).</span></span> <span data-ttu-id="4269a-190">В последующих подразделах в этом руководстве рассматриваются различные разработки стратегии, которые помогают управлять компромиссы подобные, а также рассматриваются как лучше toochoose ключа секции на основе hello конкретных требований клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="4269a-190">Later sections of this guide discuss various design strategies that help you manage trade-offs such as this one, and discuss how best toochoose your partition key based on hello specific requirements of your client application.</span></span>  

### <a name="capacity-considerations"></a><span data-ttu-id="4269a-191">Рекомендации по емкости</span><span class="sxs-lookup"><span data-stu-id="4269a-191">Capacity considerations</span></span>
<span data-ttu-id="4269a-192">Hello следующей таблице перечислены некоторые toobe значения ключа hello учитывать при разработке решения службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-192">hello following table includes some of hello key values toobe aware of when you are designing a Table service solution:</span></span>  

| <span data-ttu-id="4269a-193">Общая емкость учетной записи хранения Azure</span><span class="sxs-lookup"><span data-stu-id="4269a-193">Total capacity of an Azure storage account</span></span> | <span data-ttu-id="4269a-194">500 TБ</span><span class="sxs-lookup"><span data-stu-id="4269a-194">500 TB</span></span> |
| --- | --- |
| <span data-ttu-id="4269a-195">Количество таблиц в учетной записи хранения Azure</span><span class="sxs-lookup"><span data-stu-id="4269a-195">Number of tables in an Azure storage account</span></span> |<span data-ttu-id="4269a-196">Ограничивается только емкостью hello hello учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="4269a-196">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="4269a-197">Количество разделов в таблице</span><span class="sxs-lookup"><span data-stu-id="4269a-197">Number of partitions in a table</span></span> |<span data-ttu-id="4269a-198">Ограничивается только емкостью hello hello учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="4269a-198">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="4269a-199">Количество сущностей в разделе</span><span class="sxs-lookup"><span data-stu-id="4269a-199">Number of entities in a partition</span></span> |<span data-ttu-id="4269a-200">Ограничивается только емкостью hello hello учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="4269a-200">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="4269a-201">Размер отдельной сущности</span><span class="sxs-lookup"><span data-stu-id="4269a-201">Size of an individual entity</span></span> |<span data-ttu-id="4269a-202">До too1 МБ с не более 255 свойств (включая hello **PartitionKey**, **RowKey**, и **Timestamp**)</span><span class="sxs-lookup"><span data-stu-id="4269a-202">Up too1 MB with a maximum of 255 properties (including hello **PartitionKey**, **RowKey**, and **Timestamp**)</span></span> |
| <span data-ttu-id="4269a-203">Размер hello **PartitionKey**</span><span class="sxs-lookup"><span data-stu-id="4269a-203">Size of hello **PartitionKey**</span></span> |<span data-ttu-id="4269a-204">Строка вверх too1 КБ</span><span class="sxs-lookup"><span data-stu-id="4269a-204">A string up too1 KB in size</span></span> |
| <span data-ttu-id="4269a-205">Размер hello **RowKey**</span><span class="sxs-lookup"><span data-stu-id="4269a-205">Size of hello **RowKey**</span></span> |<span data-ttu-id="4269a-206">Строка вверх too1 КБ</span><span class="sxs-lookup"><span data-stu-id="4269a-206">A string up too1 KB in size</span></span> |
| <span data-ttu-id="4269a-207">Размер транзакции группы сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-207">Size of an Entity Group Transaction</span></span> |<span data-ttu-id="4269a-208">Транзакция может включать не более 100 сущностей и hello полезных данных должно быть меньше 4 МБ.</span><span class="sxs-lookup"><span data-stu-id="4269a-208">A transaction can include at most 100 entities and hello payload must be less than 4 MB in size.</span></span> <span data-ttu-id="4269a-209">Транзакция группы сущностей может обновлять сущность только один раз.</span><span class="sxs-lookup"><span data-stu-id="4269a-209">An EGT can only update an entity once.</span></span> |

<span data-ttu-id="4269a-210">Дополнительные сведения см. в разделе [hello основные сведения о модели данных службы таблиц](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-210">For more information, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>  

### <a name="cost-considerations"></a><span data-ttu-id="4269a-211">Рекомендации по стоимости</span><span class="sxs-lookup"><span data-stu-id="4269a-211">Cost considerations</span></span>
<span data-ttu-id="4269a-212">Относительно недорогая система хранения данных таблицы, однако следует включить оценки затрат для обоих емкости использования и hello количество транзакций в процессе знакомства с любого решения, которое использует службу hello таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-212">Table storage is relatively inexpensive, but you should include cost estimates for both capacity usage and hello quantity of transactions as part of your evaluation of any solution that uses hello Table service.</span></span> <span data-ttu-id="4269a-213">Однако во многих сценариях хранение денормализованные или повторяющиеся данные в порядке tooimprove hello производительность или масштабируемость решения является tootake допустимый подход.</span><span class="sxs-lookup"><span data-stu-id="4269a-213">However, in many scenarios storing denormalized or duplicate data in order tooimprove hello performance or scalability of your solution is a valid approach tootake.</span></span> <span data-ttu-id="4269a-214">Дополнительные сведения о ценах см. на странице [Цены на хранилища Azure](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="4269a-214">For more information about pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>  

## <a name="guidelines-for-table-design"></a><span data-ttu-id="4269a-215">Рекомендации по разработке таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-215">Guidelines for table design</span></span>
<span data-ttu-id="4269a-216">Эти списки обобщения некоторые ключевые рекомендации hello, которых следует помнить при проектировании таблиц, и в этом руководстве, поможет решить их все более подробно далее.</span><span class="sxs-lookup"><span data-stu-id="4269a-216">These lists summarize some of hello key guidelines you should keep in mind when you are designing your tables, and this guide will address them all in more detail later in.</span></span> <span data-ttu-id="4269a-217">Эти рекомендации очень отличаются от hello рекомендации, которые обычно нужно выполнить для структуры реляционной базы данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-217">These guidelines are very different from hello guidelines you would typically follow for relational database design.</span></span>  

<span data-ttu-id="4269a-218">Проектирование вашей таблице службы решения toobe *чтения* эффективно:</span><span class="sxs-lookup"><span data-stu-id="4269a-218">Designing your Table service solution toobe *read* efficient:</span></span>

* <span data-ttu-id="4269a-219">***Разрабатывайте решения с учетом выполнения запросов в приложениях с большим количеством операций чтения.***</span><span class="sxs-lookup"><span data-stu-id="4269a-219">***Design for querying in read-heavy applications.***</span></span> <span data-ttu-id="4269a-220">При проектировании таблиц подумать о запросах hello (особенно hello задержка важных), которые будут выполняться, прежде чем вы думаете о как обновит сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-220">When you are designing your tables, think about hello queries (especially hello latency sensitive ones) that you will execute before you think about how you will update your entities.</span></span> <span data-ttu-id="4269a-221">Это позволит создать эффективное и высокопроизводительное решение.</span><span class="sxs-lookup"><span data-stu-id="4269a-221">This typically results in an efficient and performant solution.</span></span>  
* <span data-ttu-id="4269a-222">***Указывайте свойства PartitionKey и RowKey в запросах.***</span><span class="sxs-lookup"><span data-stu-id="4269a-222">***Specify both PartitionKey and RowKey in your queries.***</span></span> <span data-ttu-id="4269a-223">*Выберите запросы* , таких как эти hello наиболее эффективный запросов к службе таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-223">*Point queries* such as these are hello most efficient table service queries.</span></span>  
* <span data-ttu-id="4269a-224">***Рассмотрите возможность хранения повторяющихся копий сущностей.***</span><span class="sxs-lookup"><span data-stu-id="4269a-224">***Consider storing duplicate copies of entities.***</span></span> <span data-ttu-id="4269a-225">Хранилище таблиц не требует больших затрат поэтому рассмотрите возможность хранения hello одной сущности несколько раз (с разными ключами) tooenable более эффективные запросы.</span><span class="sxs-lookup"><span data-stu-id="4269a-225">Table storage is cheap so consider storing hello same entity multiple times (with different keys) tooenable more efficient queries.</span></span>  
* <span data-ttu-id="4269a-226">***Рассмотрите возможность денормализации данных.***</span><span class="sxs-lookup"><span data-stu-id="4269a-226">***Consider denormalizing your data.***</span></span> <span data-ttu-id="4269a-227">Хранилище таблиц не требует больших затрат поэтому рассмотрите возможность денормализации данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-227">Table storage is cheap so consider denormalizing your data.</span></span> <span data-ttu-id="4269a-228">Например можно хранить сводки сущности, чтобы запросы для статистической обработки данных необходим только tooaccess одной сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-228">For example, store summary entities so that queries for aggregate data only need tooaccess a single entity.</span></span>  
* <span data-ttu-id="4269a-229">***Используйте значения составного ключа.***</span><span class="sxs-lookup"><span data-stu-id="4269a-229">***Use compound key values.***</span></span> <span data-ttu-id="4269a-230">Hello только ключи, у вас есть являются **PartitionKey** и **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-230">hello only keys you have are **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="4269a-231">Например используйте tooentities пути альтернативного доступа с ключом tooenable значений составных ключей.</span><span class="sxs-lookup"><span data-stu-id="4269a-231">For example, use compound key values tooenable alternate keyed access paths tooentities.</span></span>  
* <span data-ttu-id="4269a-232">***Используйте проекции в запросах.***</span><span class="sxs-lookup"><span data-stu-id="4269a-232">***Use query projection.***</span></span> <span data-ttu-id="4269a-233">Можно уменьшить hello объем данных, передачи по сети hello с помощью запросов выберите только что hello поля.</span><span class="sxs-lookup"><span data-stu-id="4269a-233">You can reduce hello amount of data that you transfer over hello network by using queries that select just hello fields you need.</span></span>  

<span data-ttu-id="4269a-234">Проектирование вашей таблице службы решения toobe *записи* эффективно:</span><span class="sxs-lookup"><span data-stu-id="4269a-234">Designing your Table service solution toobe *write* efficient:</span></span>  

* <span data-ttu-id="4269a-235">***Не создавайте разделы с высокой нагрузкой.***</span><span class="sxs-lookup"><span data-stu-id="4269a-235">***Do not create hot partitions.***</span></span> <span data-ttu-id="4269a-236">Нажмите сочетание клавиш, позволяющие toospread запросов по нескольким секциям в любой момент времени.</span><span class="sxs-lookup"><span data-stu-id="4269a-236">Choose keys that enable you toospread your requests across multiple partitions at any point of time.</span></span>  
* <span data-ttu-id="4269a-237">***Избегайте пиковых нагрузок по трафику.***</span><span class="sxs-lookup"><span data-stu-id="4269a-237">***Avoid spikes in traffic.***</span></span> <span data-ttu-id="4269a-238">Сглаживание hello трафика за разумный период времени и исключить всплески нагрузки трафика.</span><span class="sxs-lookup"><span data-stu-id="4269a-238">Smooth hello traffic over a reasonable period of time and avoid spikes in traffic.</span></span>
* <span data-ttu-id="4269a-239">***Для каждого типа сущности не требуется создавать отдельную таблицу.***</span><span class="sxs-lookup"><span data-stu-id="4269a-239">***Don't necessarily create a separate table for each type of entity.***</span></span> <span data-ttu-id="4269a-240">Если требуются атомарные транзакции между типами сущностей, можно сохранить эти несколько типов сущностей в hello же секции в hello одной таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-240">When you require atomic transactions across entity types, you can store these multiple entity types in hello same partition in hello same table.</span></span>
* <span data-ttu-id="4269a-241">***Рассмотрите возможность hello максимальной пропускной способности, которые необходимо получить.***</span><span class="sxs-lookup"><span data-stu-id="4269a-241">***Consider hello maximum throughput you must achieve.***</span></span> <span data-ttu-id="4269a-242">Необходимо иметь в виду hello целевые показатели масштабируемости для hello службы таблиц и убедитесь, что проект не приведет tooexceed их.</span><span class="sxs-lookup"><span data-stu-id="4269a-242">You must be aware of hello scalability targets for hello Table service and ensure that your design will not cause you tooexceed them.</span></span>  

<span data-ttu-id="4269a-243">При чтении данного руководства вы увидите примеры, которые демонстрируют практическую реализацию всех этих принципов.</span><span class="sxs-lookup"><span data-stu-id="4269a-243">As you read this guide, you will see examples that put all of these principles into practice.</span></span>  

## <a name="design-for-querying"></a><span data-ttu-id="4269a-244">Разработка для запросов</span><span class="sxs-lookup"><span data-stu-id="4269a-244">Design for querying</span></span>
<span data-ttu-id="4269a-245">Может считывать решений обслуживания таблицы, интенсивно использующих, интенсивно использующих записи или сочетание двух hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-245">Table service solutions may be read intensive, write intensive, or a mix of hello two.</span></span> <span data-ttu-id="4269a-246">Этот раздел посвящен toobear вещей hello в виду при разработке службы toosupport вашей таблице, эффективно операции чтения.</span><span class="sxs-lookup"><span data-stu-id="4269a-246">This section focuses on hello things toobear in mind when you are designing your Table service toosupport read operations efficiently.</span></span> <span data-ttu-id="4269a-247">Как правило, схема, поддерживающая операции чтения, также эффективна для операций записи.</span><span class="sxs-lookup"><span data-stu-id="4269a-247">Typically, a design that supports read operations efficiently is also efficient for write operations.</span></span> <span data-ttu-id="4269a-248">Однако существуют дополнительные вопросы toobear в виду при разработке toosupport операций записи, описанные в следующем разделе hello, [разработки для изменения данных](#design-for-data-modification).</span><span class="sxs-lookup"><span data-stu-id="4269a-248">However, there are additional considerations toobear in mind when designing toosupport write operations, discussed in hello next section, [Design for data modification](#design-for-data-modification).</span></span>

<span data-ttu-id="4269a-249">Хорошей отправной точкой для разработки вашей tooenable решения службы таблицы данных tooread эффективно является tooask «какие запросы будут данные моего приложения требуется tooexecute tooretrieve hello hello службы таблиц необходимое?»</span><span class="sxs-lookup"><span data-stu-id="4269a-249">A good starting point for designing your Table service solution tooenable you tooread data efficiently is tooask "What queries will my application need tooexecute tooretrieve hello data it needs from hello Table service?"</span></span>  

> [!NOTE]
> <span data-ttu-id="4269a-250">С hello службы таблиц, очень важно заранее hello правильный разработки так как он является сложной и затратными toochange tooget его позже.</span><span class="sxs-lookup"><span data-stu-id="4269a-250">With hello Table service, it's important tooget hello design correct up front because it's difficult and expensive toochange it later.</span></span> <span data-ttu-id="4269a-251">Например, в реляционной базе данных, часто бывает tooaddress возможных проблем с производительностью, добавив индексирует tooan существующей базы данных: это не параметр с hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-251">For example, in a relational database it's often possible tooaddress performance issues simply by adding indexes tooan existing database: this is not an option with hello Table service.</span></span>  
> 
> 

<span data-ttu-id="4269a-252">Этот раздел посвящен hello основных проблем, которые необходимо учитывать при проектировании таблиц для выполнения запросов.</span><span class="sxs-lookup"><span data-stu-id="4269a-252">This section focuses on hello key issues you must address when you design your tables for querying.</span></span> <span data-ttu-id="4269a-253">Hello, описанные в этом разделе приведен список разделов:</span><span class="sxs-lookup"><span data-stu-id="4269a-253">hello topics covered in this section include:</span></span>

* [<span data-ttu-id="4269a-254">Влияние выбора свойств PartitionKey и RowKey на производительность запросов</span><span class="sxs-lookup"><span data-stu-id="4269a-254">How your choice of PartitionKey and RowKey impacts query performance</span></span>](#how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance)
* [<span data-ttu-id="4269a-255">Выбор соответствующего свойства PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4269a-255">Choosing an appropriate PartitionKey</span></span>](#choosing-an-appropriate-partitionkey)
* [<span data-ttu-id="4269a-256">Оптимизация запросов для hello службы таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-256">Optimizing queries for hello Table service</span></span>](#optimizing-queries-for-the-table-service)
* [<span data-ttu-id="4269a-257">Сортировка данных в hello службы таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-257">Sorting data in hello Table service</span></span>](#sorting-data-in-the-table-service)

### <a name="how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance"></a><span data-ttu-id="4269a-258">Влияние выбора свойств PartitionKey и RowKey на производительность запросов</span><span class="sxs-lookup"><span data-stu-id="4269a-258">How your choice of PartitionKey and RowKey impacts query performance</span></span>
<span data-ttu-id="4269a-259">Hello следующих примерах предполагается hello службы таблиц сохранение сущности employee с следующая структура hello (Большинство примеров hello опустить hello **Timestamp** свойство для ясности):</span><span class="sxs-lookup"><span data-stu-id="4269a-259">hello following examples assume hello table service is storing employee entities with hello following structure (most of hello examples omit hello **Timestamp** property for clarity):</span></span>  

| <span data-ttu-id="4269a-260">*Имя столбца*</span><span class="sxs-lookup"><span data-stu-id="4269a-260">*Column name*</span></span> | <span data-ttu-id="4269a-261">*Тип данных*</span><span class="sxs-lookup"><span data-stu-id="4269a-261">*Data type*</span></span> |
| --- | --- |
| <span data-ttu-id="4269a-262">**PartitionKey** (Название отдела)</span><span class="sxs-lookup"><span data-stu-id="4269a-262">**PartitionKey** (Department Name)</span></span> |<span data-ttu-id="4269a-263">Строка</span><span class="sxs-lookup"><span data-stu-id="4269a-263">String</span></span> |
| <span data-ttu-id="4269a-264">**RowKey** (ИД сотрудника)</span><span class="sxs-lookup"><span data-stu-id="4269a-264">**RowKey** (Employee Id)</span></span> |<span data-ttu-id="4269a-265">Строка</span><span class="sxs-lookup"><span data-stu-id="4269a-265">String</span></span> |
| <span data-ttu-id="4269a-266">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="4269a-266">**FirstName**</span></span> |<span data-ttu-id="4269a-267">Строка</span><span class="sxs-lookup"><span data-stu-id="4269a-267">String</span></span> |
| <span data-ttu-id="4269a-268">**LastName**</span><span class="sxs-lookup"><span data-stu-id="4269a-268">**LastName**</span></span> |<span data-ttu-id="4269a-269">Строка</span><span class="sxs-lookup"><span data-stu-id="4269a-269">String</span></span> |
| <span data-ttu-id="4269a-270">**Age**</span><span class="sxs-lookup"><span data-stu-id="4269a-270">**Age**</span></span> |<span data-ttu-id="4269a-271">Число</span><span class="sxs-lookup"><span data-stu-id="4269a-271">Integer</span></span> |
| <span data-ttu-id="4269a-272">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="4269a-272">**EmailAddress**</span></span> |<span data-ttu-id="4269a-273">Строка</span><span class="sxs-lookup"><span data-stu-id="4269a-273">String</span></span> |

<span data-ttu-id="4269a-274">Здравствуйте, ранее [Общие сведения о службе таблиц Azure](#overview) описываются некоторые hello основные возможности hello службы таблиц Azure, которые имеют прямое влияние на проектирование для запроса.</span><span class="sxs-lookup"><span data-stu-id="4269a-274">hello earlier section [Azure Table service overview](#overview) describes some of hello key features of hello Azure Table service that have a direct influence on designing for query.</span></span> <span data-ttu-id="4269a-275">Эти привести hello следующие общие рекомендации по созданию запросов к службе таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-275">These result in hello following general guidelines for designing Table service queries.</span></span> <span data-ttu-id="4269a-276">Обратите внимание, что синтаксис фильтра hello, используемых в следующих примерах hello из REST API службы таблиц hello дополнительная информация [запросы к сущностям](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-276">Note that hello filter syntax used in hello examples below is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

* <span data-ttu-id="4269a-277">Объект ***запроса точки*** является наиболее эффективный поиск toouse hello и рекомендуется toobe используются для уточняющих запросов большого объема и уточняющие запросы, требующие минимальной задержке.</span><span class="sxs-lookup"><span data-stu-id="4269a-277">A ***Point Query*** is hello most efficient lookup toouse and is recommended toobe used for high-volume lookups or lookups requiring lowest latency.</span></span> <span data-ttu-id="4269a-278">Такой запрос можно использовать индексы hello toolocate отдельной сущности очень эффективно, указав оба hello **PartitionKey** и **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-278">Such a query can use hello indexes toolocate an individual entity very efficiently by specifying both hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-279">Например: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span><span class="sxs-lookup"><span data-stu-id="4269a-279">For example: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span></span>  
* <span data-ttu-id="4269a-280">Во-вторых, важнее ***запрос по диапазону*** , использующий hello **PartitionKey** и фильтры в диапазон **RowKey** значения tooreturn более одной сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-280">Second best is a ***Range Query*** that uses hello **PartitionKey** and filters on a range of **RowKey** values tooreturn more than one entity.</span></span> <span data-ttu-id="4269a-281">Hello **PartitionKey** значение идентифицирует определенный раздел и hello **RowKey** значения определите подмножество hello сущностей в этой секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-281">hello **PartitionKey** value identifies a specific partition, and hello **RowKey** values identify a subset of hello entities in that partition.</span></span> <span data-ttu-id="4269a-282">Например: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span><span class="sxs-lookup"><span data-stu-id="4269a-282">For example: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span></span>  
* <span data-ttu-id="4269a-283">Третий лучшее — ***сканирования секции*** , использующий hello **PartitionKey** и фильтры для другого неключевые свойства, которые могут возвращать более одной сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-283">Third best is a ***Partition Scan*** that uses hello **PartitionKey** and filters on another non-key property and that may return more than one entity.</span></span> <span data-ttu-id="4269a-284">Hello **PartitionKey** значение идентифицирует определенный раздел, и значения свойств hello, выберите для подмножества hello сущностей в этой секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-284">hello **PartitionKey** value identifies a specific partition, and hello property values select for a subset of hello entities in that partition.</span></span> <span data-ttu-id="4269a-285">Например: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span><span class="sxs-lookup"><span data-stu-id="4269a-285">For example: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span></span>  
* <span data-ttu-id="4269a-286">Объект ***Table Scan*** не включает hello **PartitionKey** и оно очень неэффективно, так как он выполняет все секции hello, составляющих таблицу в свою очередь для любой из соответствующих сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-286">A ***Table Scan*** does not include hello **PartitionKey** and is very inefficient because it searches all of hello partitions that make up your table in turn for any matching entities.</span></span> <span data-ttu-id="4269a-287">Он будет выполнять сканирование таблицы независимо от того, используется ли фильтр использует hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-287">It will perform a table scan regardless of whether or not your filter uses hello **RowKey**.</span></span> <span data-ttu-id="4269a-288">Например: $filter=LastName eq 'Jones'</span><span class="sxs-lookup"><span data-stu-id="4269a-288">For example: $filter=LastName eq 'Jones'</span></span>  
* <span data-ttu-id="4269a-289">Запросы, возвращающие несколько сущностей, возвращают их отсортированными по свойствам **PartitionKey** и **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-289">Queries that return multiple entities return them sorted in **PartitionKey** and **RowKey** order.</span></span> <span data-ttu-id="4269a-290">Выберите tooavoid обращения hello сущностей в клиенте hello **RowKey** , определяющий порядок сортировки наиболее распространенные hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-290">tooavoid resorting hello entities in hello client, choose a **RowKey** that defines hello most common sort order.</span></span>  

<span data-ttu-id="4269a-291">Обратите внимание, что использование "**или**» на основе фильтра toospecify **RowKey** значения результатов для проверки секции и не обрабатывается как запрос диапазона.</span><span class="sxs-lookup"><span data-stu-id="4269a-291">Note that using an "**or**" toospecify a filter based on **RowKey** values results in a partition scan and is not treated as a range query.</span></span> <span data-ttu-id="4269a-292">Поэтому следует избегать запросов, использующих следующие фильтры: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322').</span><span class="sxs-lookup"><span data-stu-id="4269a-292">Therefore, you should avoid queries that use filters such as: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span></span>  

<span data-ttu-id="4269a-293">Примеры кода на стороне клиента, использующих hello клиентской библиотеки хранилища tooexecute эффективные запросы см.:</span><span class="sxs-lookup"><span data-stu-id="4269a-293">For examples of client-side code that use hello Storage Client Library tooexecute efficient queries, see:</span></span>  

* [<span data-ttu-id="4269a-294">Выполнение запроса точки с помощью клиентской библиотеки хранилища hello</span><span class="sxs-lookup"><span data-stu-id="4269a-294">Executing a point query using hello Storage Client Library</span></span>](#executing-a-point-query-using-the-storage-client-library)
* [<span data-ttu-id="4269a-295">Извлечение нескольких сущностей с помощью LINQ</span><span class="sxs-lookup"><span data-stu-id="4269a-295">Retrieving multiple entities using LINQ</span></span>](#retrieving-multiple-entities-using-linq)
* [<span data-ttu-id="4269a-296">Проекция на стороне сервера</span><span class="sxs-lookup"><span data-stu-id="4269a-296">Server-side projection</span></span>](#server-side-projection)  

<span data-ttu-id="4269a-297">Примеры кода на стороне клиента, который может обрабатывать несколько сущностей типов хранятся в hello же таблицы см. в разделе:</span><span class="sxs-lookup"><span data-stu-id="4269a-297">For examples of client-side code that can handle multiple entity types stored in hello same table, see:</span></span>  

* [<span data-ttu-id="4269a-298">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-298">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="choosing-an-appropriate-partitionkey"></a><span data-ttu-id="4269a-299">Выбор соответствующего свойства PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4269a-299">Choosing an appropriate PartitionKey</span></span>
<span data-ttu-id="4269a-300">Выбор **PartitionKey** следует учитывать необходимость hello tooenables использование hello EGTs (целостность tooensure) от toodistribute требование hello сущностей по нескольким секциям (tooensure масштабируемое решение).</span><span class="sxs-lookup"><span data-stu-id="4269a-300">Your choice of **PartitionKey** should balance hello need tooenables hello use of EGTs (tooensure consistency) against hello requirement toodistribute your entities across multiple partitions (tooensure a scalable solution).</span></span>  

<span data-ttu-id="4269a-301">С одной стороны можно сохранить все сущности в одной секции, но это может ограничить масштабируемость hello решения и могли бы помешать hello служба таблиц не могут tooload балансировать нагрузку по запросам.</span><span class="sxs-lookup"><span data-stu-id="4269a-301">At one extreme, you could store all your entities in a single partition, but this may limit hello scalability of your solution and would prevent hello table service from being able tooload-balance requests.</span></span> <span data-ttu-id="4269a-302">В hello другой стороны, можно хранить одну сущность на секцию, которой будет высокомасштабируемых позволяющее обслуживания tooload баланс hello таблицы запросов, но которой не удастся транзакции группы сущностей с помощью.</span><span class="sxs-lookup"><span data-stu-id="4269a-302">At hello other extreme, you could store one entity per partition, which would be highly scalable and which enables hello table service tooload-balance requests, but which would prevent you from using entity group transactions.</span></span>  

<span data-ttu-id="4269a-303">Идеальной **PartitionKey** то, которое позволяет toouse эффективные запросы и имеет достаточно секций tooensure решения является масштабируемым.</span><span class="sxs-lookup"><span data-stu-id="4269a-303">An ideal **PartitionKey** is one that enables you toouse efficient queries and that has sufficient partitions tooensure your solution is scalable.</span></span> <span data-ttu-id="4269a-304">Вы поймете, что сущности имеют соответствующее свойство, которое распределяет их по необходимому количеству разделов.</span><span class="sxs-lookup"><span data-stu-id="4269a-304">Typically, you will find that your entities will have a suitable property that distributes your entities across sufficient partitions.</span></span>

> [!NOTE]
> <span data-ttu-id="4269a-305">Например, в системе, где хранятся сведения о пользователях или сотрудниках, идентификатор пользователя (UserID) может быть выражен подходящим значением PartitionKey.</span><span class="sxs-lookup"><span data-stu-id="4269a-305">For example, in a system that stores information about users or employees, UserID may be a good PartitionKey.</span></span> <span data-ttu-id="4269a-306">Вы можете иметь несколько сущностей, использующих в качестве ключа секции hello данного пользователя.</span><span class="sxs-lookup"><span data-stu-id="4269a-306">You may have several entities that use a given UserID as hello partition key.</span></span> <span data-ttu-id="4269a-307">Все сущности, в которых хранятся данные о пользователе, группируются в один раздел. В результате все операции с этими сущностями выполняются через транзакции группы сущностей, но масштабируемость остается высокой.</span><span class="sxs-lookup"><span data-stu-id="4269a-307">Each entity that stores data about a user is grouped into a single partition, and so these entities are accessible via entity group transactions, while still being highly scalable.</span></span>
> 
> 

<span data-ttu-id="4269a-308">Существуют дополнительные рекомендации по своему выбору **PartitionKey** , которые связывают toohow будет вставки, обновления и удаления сущностей: hello в разделе [разработки для изменения данных](#design-for-data-modification) ниже.</span><span class="sxs-lookup"><span data-stu-id="4269a-308">There are additional considerations in your choice of **PartitionKey** that relate toohow you will insert, update, and delete entities: see hello section [Design for data modification](#design-for-data-modification) below.</span></span>  

### <a name="optimizing-queries-for-hello-table-service"></a><span data-ttu-id="4269a-309">Оптимизация запросов для hello службы таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-309">Optimizing queries for hello Table service</span></span>
<span data-ttu-id="4269a-310">Hello службы таблиц автоматически индексирует сущностей с помощью hello **PartitionKey** и **RowKey** значений в один кластеризованный индекс, поэтому hello причине что точечными запросами hello наиболее эффективный toouse .</span><span class="sxs-lookup"><span data-stu-id="4269a-310">hello Table service automatically indexes your entities using hello **PartitionKey** and **RowKey** values in a single clustered index, hence hello reason that point queries are hello most efficient toouse.</span></span> <span data-ttu-id="4269a-311">Тем не менее, есть индексов не hello кластеризованный индекс для hello отличный от того, **PartitionKey** и **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-311">However, there are no indexes other than that on hello clustered index on hello **PartitionKey** and **RowKey**.</span></span>

<span data-ttu-id="4269a-312">Во многих проектах должен удовлетворять требованиям tooenable подстановки сущностей на основе нескольких критериев.</span><span class="sxs-lookup"><span data-stu-id="4269a-312">Many designs must meet requirements tooenable lookup of entities based on multiple criteria.</span></span> <span data-ttu-id="4269a-313">Например, поиск сущностей сотрудников на основе адреса электронной почты, ИД сотрудника или фамилии.</span><span class="sxs-lookup"><span data-stu-id="4269a-313">For example, locating employee entities based on email, employee id, or last name.</span></span> <span data-ttu-id="4269a-314">Здравствуйте, следующие шаблоны в разделе "hello" [шаблоны проектирования таблицы](#table-design-patterns) устранить эти типы требований и описывают способы обходу hello фактов, что служба таблиц hello не предоставляет вторичных индексов:</span><span class="sxs-lookup"><span data-stu-id="4269a-314">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address these types of requirement and describe ways of working around hello fact that hello Table service does not provide secondary indexes:</span></span>  

* <span data-ttu-id="4269a-315">[Шаблон внутри секции вторичный индекс](#intra-partition-secondary-index-pattern) -хранение нескольких копий каждой сущности, используя различные **RowKey** значения (в hello одной секции) tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью различные **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-315">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4269a-316">[Вторичный индекс между шаблон](#inter-partition-secondary-index-pattern) — хранение нескольких копий каждой сущности, с помощью разными значениями RowKey в разные разделы или в отдельных таблицах tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью различных **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-316">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4269a-317">[Шаблон сущностей индекс](#index-entities-pattern) -обслуживание индекса сущностей tooenable эффективного поиска, возвращающих списки сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-317">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

### <a name="sorting-data-in-hello-table-service"></a><span data-ttu-id="4269a-318">Сортировка данных в hello службы таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-318">Sorting data in hello Table service</span></span>
<span data-ttu-id="4269a-319">Hello служба таблиц возвращает сущности в возрастающем порядке, основанном на **PartitionKey** , а затем по **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-319">hello Table service returns entities sorted in ascending order based on **PartitionKey** and then by **RowKey**.</span></span> <span data-ttu-id="4269a-320">Эти разделы находятся значения строк и tooensure, числовые значения сортировки правильно, необходимо преобразовать их tooa фиксированной длины и выполнить их заполнение нулями.</span><span class="sxs-lookup"><span data-stu-id="4269a-320">These keys are string values and tooensure that numeric values sort correctly, you should convert them tooa fixed length and pad them with zeroes.</span></span> <span data-ttu-id="4269a-321">Например, если hello значение идентификатора сотрудника служит hello **RowKey** — это целочисленное значение, необходимо преобразовать идентификатор сотрудника **123** слишком**00000123**.</span><span class="sxs-lookup"><span data-stu-id="4269a-321">For example, if hello employee id value you use as hello **RowKey** is an integer value, you should convert employee id **123** too**00000123**.</span></span>  

<span data-ttu-id="4269a-322">Многие приложения имеют требования toouse данные отсортированы в разном порядке: например, сортировка сотрудников по имени или присоединив даты.</span><span class="sxs-lookup"><span data-stu-id="4269a-322">Many applications have requirements toouse data sorted in different orders: for example, sorting employees by name, or by joining date.</span></span> <span data-ttu-id="4269a-323">Здравствуйте, следующие шаблоны в разделе "hello" [шаблоны проектирования таблицы](#table-design-patterns) адресов, как порядок сортировки tooalternate для сущностей:</span><span class="sxs-lookup"><span data-stu-id="4269a-323">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address how tooalternate sort orders for your entities:</span></span>  

* <span data-ttu-id="4269a-324">[Шаблон внутри секции вторичный индекс](#intra-partition-secondary-index-pattern) -хранение нескольких копий каждой сущности, с помощью разными значениями RowKey (в hello одной секции) tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью разными значениями RowKey.</span><span class="sxs-lookup"><span data-stu-id="4269a-324">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>  
* <span data-ttu-id="4269a-325">[Вторичный индекс между шаблон](#inter-partition-secondary-index-pattern) — хранение нескольких копий каждой сущности, с помощью разными значениями RowKey в разные разделы в отдельных таблицах tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью разных RowKey значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-325">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions in separate tables tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>
* <span data-ttu-id="4269a-326">[Шаблон заключительный фрагмент журнала](#log-tail-pattern) -получение hello  *n*  сущностей недавно добавленную секцию tooa с помощью **RowKey** значение, которое сортирует в обратную даты и времени заказа.</span><span class="sxs-lookup"><span data-stu-id="4269a-326">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="design-for-data-modification"></a><span data-ttu-id="4269a-327">Разработка для изменения данных</span><span class="sxs-lookup"><span data-stu-id="4269a-327">Design for data modification</span></span>
<span data-ttu-id="4269a-328">В этом разделе основное внимание уделяется hello вопросы проектирования для оптимизации операций вставки, обновления и удаления.</span><span class="sxs-lookup"><span data-stu-id="4269a-328">This section focuses on hello design considerations for optimizing inserts, updates, and deletes.</span></span> <span data-ttu-id="4269a-329">В некоторых случаях потребуется tooevaluate hello компромисс между вариантами, оптимизировать запросы по оптимизации для изменения данных так же, как в модели для реляционных баз данных (несмотря на то, что hello, обеспечивающих управление hello конструктора схем преимущества и недостатки отличаются в реляционной базе данных).</span><span class="sxs-lookup"><span data-stu-id="4269a-329">In some cases, you will need tooevaluate hello trade-off between designs that optimize for querying against designs that optimize for data modification just as you do in designs for relational databases (although hello techniques for managing hello design trade-offs are different in a relational database).</span></span> <span data-ttu-id="4269a-330">Здравствуйте, раздел [шаблоны проектирования таблицы](#table-design-patterns) описывает некоторые шаблоны проектирования подробные для hello службы таблиц и кратко описаны преимущества и недостатки.</span><span class="sxs-lookup"><span data-stu-id="4269a-330">hello section [Table Design Patterns](#table-design-patterns) describes some detailed design patterns for hello Table service and highlights some these trade-offs.</span></span> <span data-ttu-id="4269a-331">На практике вы увидите, что многие модели, оптимизированные для выполнения запросов к сущностям, также хорошо подходят для изменения сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-331">In practice, you will find that many designs optimized for querying entities also work well for modifying entities.</span></span>  

### <a name="optimizing-hello-performance-of-insert-update-and-delete-operations"></a><span data-ttu-id="4269a-332">Оптимизация производительности hello вставки, обновления и удаления операций</span><span class="sxs-lookup"><span data-stu-id="4269a-332">Optimizing hello performance of insert, update, and delete operations</span></span>
<span data-ttu-id="4269a-333">tooupdate или удалить сущность, должен быть доступ tooidentify его с помощью hello **PartitionKey** и **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-333">tooupdate or delete an entity, you must be able tooidentify it by using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-334">В этом отношении Выбор **PartitionKey** и **RowKey** указывают для изменения сущности должны следовать аналогичные toosupport выбора tooyour критериев запросы, поскольку требуется tooidentify сущности как эффективным способом.</span><span class="sxs-lookup"><span data-stu-id="4269a-334">In this respect, your choice of **PartitionKey** and **RowKey** for modifying entities should follow similar criteria tooyour choice toosupport point queries because you want tooidentify entities as efficiently as possible.</span></span> <span data-ttu-id="4269a-335">Не следует toouse неэффективным секцию или таблицу сканирования toolocate сущности в порядке toodiscover hello **PartitionKey** и **RowKey** значения требуется tooupdate или удалите его.</span><span class="sxs-lookup"><span data-stu-id="4269a-335">You do not want toouse an inefficient partition or table scan toolocate an entity in order toodiscover hello **PartitionKey** and **RowKey** values you need tooupdate or delete it.</span></span>  

<span data-ttu-id="4269a-336">Здравствуйте, следующие шаблоны в разделе "hello" [шаблоны проектирования таблицы](#table-design-patterns) адреса оптимизация производительности hello или вашей insert, update, а операции удаления:</span><span class="sxs-lookup"><span data-stu-id="4269a-336">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address optimizing hello performance or your insert, update, and delete operations:</span></span>  

* <span data-ttu-id="4269a-337">[Шаблон удаления большого объема](#high-volume-delete-pattern) -удаление hello Enable слишком большое количество сущностей, сохраняя все сущности hello для одновременного удаления в своих собственных отдельную таблицу; можно удалить сущности hello путем удаления таблицы hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-337">[High volume delete pattern](#high-volume-delete-pattern) - Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  
* <span data-ttu-id="4269a-338">[Шаблон рядов данных](#data-series-pattern) -хранилище полные данные ряда в одной сущности toominimize hello ряд запросов, можно сделать.</span><span class="sxs-lookup"><span data-stu-id="4269a-338">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  
* <span data-ttu-id="4269a-339">[Шаблон широкий сущностей](#wide-entities-pattern) -использовать несколько сущностей логической toostore физические объекты с более чем 252 свойств.</span><span class="sxs-lookup"><span data-stu-id="4269a-339">[Wide entities pattern](#wide-entities-pattern) - Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  
* <span data-ttu-id="4269a-340">[Шаблон больших сущностей](#large-entities-pattern) -использование больших двоичных объектов хранилища toostore свойство больших значений.</span><span class="sxs-lookup"><span data-stu-id="4269a-340">[Large entities pattern](#large-entities-pattern) - Use blob storage toostore large property values.</span></span>  

### <a name="ensuring-consistency-in-your-stored-entities"></a><span data-ttu-id="4269a-341">Обеспечение согласованности хранимых сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-341">Ensuring consistency in your stored entities</span></span>
<span data-ttu-id="4269a-342">Здравствуйте, другие влияет выбор ключей для оптимизации изменения данных является ключевым фактором как tooensure согласованности с помощью атомарные транзакции.</span><span class="sxs-lookup"><span data-stu-id="4269a-342">hello other key factor that influences your choice of keys for optimizing data modifications is how tooensure consistency by using atomic transactions.</span></span> <span data-ttu-id="4269a-343">Toooperate EGT можно использовать только на объекты, хранящиеся в hello одной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-343">You can only use an EGT toooperate on entities stored in hello same partition.</span></span>  

<span data-ttu-id="4269a-344">Здравствуйте, следующие шаблоны в разделе "hello" [шаблоны проектирования таблицы](#table-design-patterns) заботиться о согласовании адрес:</span><span class="sxs-lookup"><span data-stu-id="4269a-344">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address managing consistency:</span></span>  

* <span data-ttu-id="4269a-345">[Шаблон внутри секции вторичный индекс](#intra-partition-secondary-index-pattern) -хранение нескольких копий каждой сущности, используя различные **RowKey** значения (в hello одной секции) tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью различные **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-345">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4269a-346">[Вторичный индекс между шаблон](#inter-partition-secondary-index-pattern) — хранение нескольких копий каждой сущности, с помощью разными значениями RowKey в разные разделы или в отдельных таблицах tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью различных **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-346">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4269a-347">[Шаблон для согласованных транзакций](#eventually-consistent-transactions-pattern) — обеспечение согласованного поведения в рамках границ раздела или границ системы хранения с помощью запросов Azure.</span><span class="sxs-lookup"><span data-stu-id="4269a-347">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) - Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>
* <span data-ttu-id="4269a-348">[Шаблон сущностей индекс](#index-entities-pattern) -обслуживание индекса сущностей tooenable эффективного поиска, возвращающих списки сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-348">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  
* <span data-ttu-id="4269a-349">[Денормализация шаблон](#denormalization-pattern) -объединить данные, относящиеся к вместе в одной сущности tooenable tooretrieve все hello необходимо с помощью запроса одной точки данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-349">[Denormalization pattern](#denormalization-pattern) - Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  
* <span data-ttu-id="4269a-350">[Шаблон рядов данных](#data-series-pattern) -хранилище полные данные ряда в одной сущности toominimize hello ряд запросов, можно сделать.</span><span class="sxs-lookup"><span data-stu-id="4269a-350">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

<span data-ttu-id="4269a-351">Сведения о транзакции группы сущностей, в разделе hello [транзакции группы сущностей](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="4269a-351">For information about entity group transactions, see hello section [Entity Group Transactions](#entity-group-transactions).</span></span>  

### <a name="ensuring-your-design-for-efficient-modifications-facilitates-efficient-queries"></a><span data-ttu-id="4269a-352">Использование эффективных запросов в разработке для эффективных изменений</span><span class="sxs-lookup"><span data-stu-id="4269a-352">Ensuring your design for efficient modifications facilitates efficient queries</span></span>
<span data-ttu-id="4269a-353">Во многих случаях конструктора для эффективного результатов запросов в эффективный изменения, но всегда следует оценить, выполнен ли ситуация hello для конкретного сценария.</span><span class="sxs-lookup"><span data-stu-id="4269a-353">In many cases, a design for efficient querying results in efficient modifications, but you should always evaluate whether this is hello case for your specific scenario.</span></span> <span data-ttu-id="4269a-354">Некоторые шаблоны hello в разделе "hello" [шаблоны проектирования таблицы](#table-design-patterns) явно оценки компромиссы между направление запросов и изменение сущностей и всегда следует проявлять в учетной записи hello количество каждого типа операции.</span><span class="sxs-lookup"><span data-stu-id="4269a-354">Some of hello patterns in hello section [Table Design Patterns](#table-design-patterns) explicitly evaluate trade-offs between querying and modifying entities, and you should always take into account hello number of each type of operation.</span></span>  

<span data-ttu-id="4269a-355">Здравствуйте, следующие шаблоны в разделе "hello" [шаблоны проектирования таблицы](#table-design-patterns) компромиссы между проектированием для обеспечения эффективного поиска и проектирование для изменения данных для эффективного устранения:</span><span class="sxs-lookup"><span data-stu-id="4269a-355">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address trade-offs between designing for efficient queries and designing for efficient data modification:</span></span>  

* <span data-ttu-id="4269a-356">[Шаблон составного ключа](#compound-key-pattern) -использование составного **RowKey** tooenable значения toolookup клиента связанные данные с помощью запроса одной точки.</span><span class="sxs-lookup"><span data-stu-id="4269a-356">[Compound key pattern](#compound-key-pattern) - Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  
* <span data-ttu-id="4269a-357">[Шаблон заключительный фрагмент журнала](#log-tail-pattern) -получение hello  *n*  сущностей недавно добавленную секцию tooa с помощью **RowKey** значение, которое сортирует в обратную даты и времени заказа.</span><span class="sxs-lookup"><span data-stu-id="4269a-357">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="encrypting-table-data"></a><span data-ttu-id="4269a-358">Шифрование данных таблицы</span><span class="sxs-lookup"><span data-stu-id="4269a-358">Encrypting Table Data</span></span>
<span data-ttu-id="4269a-359">Здравствуйте, клиентская библиотека хранилища Azure .NET поддерживает шифрование свойств сущности строки для вставки операций и замены.</span><span class="sxs-lookup"><span data-stu-id="4269a-359">hello .NET Azure Storage Client Library supports encryption of string entity properties for insert and replace operations.</span></span> <span data-ttu-id="4269a-360">Hello зашифрованные строки хранятся в службе hello как двоичные свойства и их преобразование задней toostrings после расшифровки.</span><span class="sxs-lookup"><span data-stu-id="4269a-360">hello encrypted strings are stored on hello service as binary properties, and they are converted back toostrings after decryption.</span></span>    

<span data-ttu-id="4269a-361">Для таблиц Кроме toohello политики шифрования, пользователи должны указать toobe свойства hello зашифрованы.</span><span class="sxs-lookup"><span data-stu-id="4269a-361">For tables, in addition toohello encryption policy, users must specify hello properties toobe encrypted.</span></span> <span data-ttu-id="4269a-362">Это можно сделать путем указания атрибута [PropertyAttribute] \(для сущностей POCO, которые являются производными от TableEntity) или с помощью сопоставителя шифрования в параметрах запроса.</span><span class="sxs-lookup"><span data-stu-id="4269a-362">This can be done by either specifying an [EncryptProperty] attribute (for POCO entities that derive from TableEntity) or an encryption resolver in request options.</span></span> <span data-ttu-id="4269a-363">Сопоставитель шифрования — это делегат, который получает ключ секции, ключ строки и имя свойства, а затем возвращает логическое значение, которое указывает, следует ли это свойство шифровать.</span><span class="sxs-lookup"><span data-stu-id="4269a-363">An encryption resolver is a delegate that takes a partition key, row key, and property name and returns a Boolean that indicates whether that property should be encrypted.</span></span> <span data-ttu-id="4269a-364">Во время шифрования hello клиентской библиотеки будет использовать этот toodecide сведения ли свойства должны быть зашифрованы при записи toohello сети.</span><span class="sxs-lookup"><span data-stu-id="4269a-364">During encryption, hello client library will use this information toodecide whether a property should be encrypted while writing toohello wire.</span></span> <span data-ttu-id="4269a-365">Делегат Hello также предоставляет возможность hello логики вокруг как свойства шифруются.</span><span class="sxs-lookup"><span data-stu-id="4269a-365">hello delegate also provides for hello possibility of logic around how properties are encrypted.</span></span> <span data-ttu-id="4269a-366">(Например, если значение равно X, то шифровать свойство А; в противном случае шифровать свойства А и В.) Обратите внимание, что он является не обязательным tooprovide эти сведения при чтении или выполнения запросов к сущностям.</span><span class="sxs-lookup"><span data-stu-id="4269a-366">(For example, if X, then encrypt property A; otherwise encrypt properties A and B.) Note that it is not necessary tooprovide this information while reading or querying entities.</span></span>

<span data-ttu-id="4269a-367">Обратите внимание, что слияние в настоящее время не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="4269a-367">Note that merge is not currently supported.</span></span> <span data-ttu-id="4269a-368">Так как подмножество свойств может зашифрованные ранее с помощью другой ключ, просто слияние новых свойств hello и обновление метаданных hello приведет к потере данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-368">Since a subset of properties may have been encrypted previously using a different key, simply merging hello new properties and updating hello metadata will result in data loss.</span></span> <span data-ttu-id="4269a-369">Слияние либо требует внесения дополнительных службы вызывает tooread hello существующих сущностей из службы hello, либо с помощью нового ключа каждого свойства, которые не подходят для повышения производительности.</span><span class="sxs-lookup"><span data-stu-id="4269a-369">Merging either requires making extra service calls tooread hello pre-existing entity from hello service, or using a new key per property, both of which are not suitable for performance reasons.</span></span>     

<span data-ttu-id="4269a-370">Дополнительные сведения о шифровании данных таблицы см. в статье [Шифрование на стороне клиента для службы хранилища Microsoft Azure](storage-client-side-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="4269a-370">For information about encrypting table data, see [Client-Side Encryption and Azure Key Vault for Microsoft Azure Storage](storage-client-side-encryption.md).</span></span>  

## <a name="modelling-relationships"></a><span data-ttu-id="4269a-371">Моделирование отношений</span><span class="sxs-lookup"><span data-stu-id="4269a-371">Modelling relationships</span></span>
<span data-ttu-id="4269a-372">Построение моделей домена является ключевым моментом в hello проектирования сложных систем.</span><span class="sxs-lookup"><span data-stu-id="4269a-372">Building domain models is a key step in hello design of complex systems.</span></span> <span data-ttu-id="4269a-373">Как правило использовать hello моделирования процесса tooidentify сущностей и hello связи между ними как toounderstand способом hello бизнес-среды и уведомить hello Дизайн системы.</span><span class="sxs-lookup"><span data-stu-id="4269a-373">Typically, you use hello modelling process tooidentify entities and hello relationships between them as a way toounderstand hello business domain and inform hello design of your system.</span></span> <span data-ttu-id="4269a-374">Этот раздел посвящен как преобразовать некоторые hello в toodesigns модели домена для службы таблиц hello распространенные типы отношений.</span><span class="sxs-lookup"><span data-stu-id="4269a-374">This section focuses on how you can translate some of hello common relationship types found in domain models toodesigns for hello Table service.</span></span> <span data-ttu-id="4269a-375">Hello процесса сопоставления из логической модели данных tooa физического NoSQL на основе модели данных очень отличается от используемого при разработке реляционной базы данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-375">hello process of mapping from a logical data-model tooa physical NoSQL based data-model is very different from that used when designing a relational database.</span></span> <span data-ttu-id="4269a-376">Структура реляционных баз данных обычно предполагает процесса нормализации данных, оптимизированными для минимизации избыточность — и декларативных запросов возможность, которая краткие описания как hello реализация принципов работы hello базы данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-376">Relational databases design typically assumes a data normalization process optimized for minimizing redundancy – and a declarative querying capability that abstracts how hello implementation of how hello database works.</span></span>  

### <a name="one-to-many-relationships"></a><span data-ttu-id="4269a-377">Отношения «один-ко-многим»</span><span class="sxs-lookup"><span data-stu-id="4269a-377">One-to-many relationships</span></span>
<span data-ttu-id="4269a-378">Отношения «один-ко-многим» между бизнес-объектами являются практически самыми распространенными. Например, в одном отделе работает много сотрудников.</span><span class="sxs-lookup"><span data-stu-id="4269a-378">One-to-many relationships between business domain objects occur very frequently: for example, one department has many employees.</span></span> <span data-ttu-id="4269a-379">Имеется несколько способов tooimplement один ко многим связи на hello службы таблиц каждого с преимущества и недостатки, которые могут быть применимо toohello определенного сценария.</span><span class="sxs-lookup"><span data-stu-id="4269a-379">There are several ways tooimplement one-to-many relationships in hello Table service each with pros and cons that may be relevant toohello particular scenario.</span></span>  

<span data-ttu-id="4269a-380">Рассмотрим пример hello глобальной экономике крупного предприятия с десятками тысяч подразделений и сущности employee, где каждый отдел имеет многие сотрудники и каждого сотрудника как связанную с одного конкретного подразделения.</span><span class="sxs-lookup"><span data-stu-id="4269a-380">Consider hello example of a large multi-national corporation with tens of thousands of departments and employee entities where every department has many employees and each employee as associated with one specific department.</span></span> <span data-ttu-id="4269a-381">Одним из подходов является отдельной отдел toostore и сущности employee такие:</span><span class="sxs-lookup"><span data-stu-id="4269a-381">One approach is toostore separate department and employee entities such as these:</span></span>  

![][1]

<span data-ttu-id="4269a-382">В этом примере показано явную связь между hello типы на основании hello один ко многим **PartitionKey** значение.</span><span class="sxs-lookup"><span data-stu-id="4269a-382">This example shows an implicit one-to-many relationship between hello types based on hello **PartitionKey** value.</span></span> <span data-ttu-id="4269a-383">В каждом отделе может работать много сотрудников.</span><span class="sxs-lookup"><span data-stu-id="4269a-383">Each department can have many employees.</span></span>  

<span data-ttu-id="4269a-384">В этом примере также показано сущность department и его связанные сотрудника сущности в hello одной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-384">This example also shows a department entity and its related employee entities in hello same partition.</span></span> <span data-ttu-id="4269a-385">Можно выбрать различные секции toouse, таблицы или даже учетные записи хранения для hello различных типов сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-385">You could choose toouse different partitions, tables, or even storage accounts for hello different entity types.</span></span>  

<span data-ttu-id="4269a-386">Альтернативный подход — toodenormalize только сотрудника сущностей данных и хранилище с данными денормализованные отдела, как показано в следующий пример hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-386">An alternative approach is toodenormalize your data and store only employee entities with denormalized department data as shown in hello following example.</span></span> <span data-ttu-id="4269a-387">В данном конкретном случае этот денормализованные подход может оказаться наиболее hello при наличии подробности требования toobe может toochange hello диспетчера отдела, так как toodo это необходимо tooupdate каждого служащего в отделе hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-387">In this particular scenario, this denormalized approach may not be hello best if you have a requirement toobe able toochange hello details of a department manager because toodo this you need tooupdate every employee in hello department.</span></span>  

![][2]

<span data-ttu-id="4269a-388">Дополнительные сведения см. в разделе hello [шаблон денормализации](#denormalization-pattern) далее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="4269a-388">For more information, see hello [Denormalization pattern](#denormalization-pattern) later in this guide.</span></span>  

<span data-ttu-id="4269a-389">Hello следующей таблице приведена сводка hello преимуществ и недостатков каждого из подходов hello, описанные выше, для хранения сотрудника и отдел сущностей, которые имеют связь «один ко многим».</span><span class="sxs-lookup"><span data-stu-id="4269a-389">hello following table summarizes hello pros and cons of each of hello approaches outlined above for storing employee and department entities that have a one-to-many relationship.</span></span> <span data-ttu-id="4269a-390">Следует также учитывать, насколько часто ожидается tooperform различные операции: он может быть приемлемым toohave схема, которая включает в себя ресурсоемкой операцией, если эта операция происходит редко.</span><span class="sxs-lookup"><span data-stu-id="4269a-390">You should also consider how often you expect tooperform various operations: it may be acceptable toohave a design that includes an expensive operation if that operation only happens infrequently.</span></span>  

<table>
<tr>
<th><span data-ttu-id="4269a-391">Подход</span><span class="sxs-lookup"><span data-stu-id="4269a-391">Approach</span></span></th>
<th><span data-ttu-id="4269a-392">Преимущества</span><span class="sxs-lookup"><span data-stu-id="4269a-392">Pros</span></span></th>
<th><span data-ttu-id="4269a-393">Недостатки</span><span class="sxs-lookup"><span data-stu-id="4269a-393">Cons</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-394">Отдельные типы сущностей, один раздел, одна таблица</span><span class="sxs-lookup"><span data-stu-id="4269a-394">Separate entity types, same partition, same table</span></span></td>
<td>
<ul>
<li><span data-ttu-id="4269a-395">Сущность отдела можно обновить с помощью одной операции.</span><span class="sxs-lookup"><span data-stu-id="4269a-395">You can update a department entity with a single operation.</span></span></li>
<li><span data-ttu-id="4269a-396">Согласованность toomaintain EGT можно использовать при наличии toomodify требование сущность department всякий раз, когда вы обновление, вставка или удаление сущности employee.</span><span class="sxs-lookup"><span data-stu-id="4269a-396">You can use an EGT toomaintain consistency if you have a requirement toomodify a department entity whenever you update/insert/delete an employee entity.</span></span> <span data-ttu-id="4269a-397">Например, в случае поддержки осведомленности о количестве сотрудников в каждом отделе.</span><span class="sxs-lookup"><span data-stu-id="4269a-397">For example if you maintain a departmental employee count for each department.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="4269a-398">Для некоторых действий, клиент может потребоваться tooretrieve сотрудник и сущность department.</span><span class="sxs-lookup"><span data-stu-id="4269a-398">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="4269a-399">Выполняются операции хранилища в hello же секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-399">Storage operations happen in hello same partition.</span></span> <span data-ttu-id="4269a-400">При значительных объемах транзакций это может привести к формированию активной области.</span><span class="sxs-lookup"><span data-stu-id="4269a-400">At high transaction volumes, this may result in a hotspot.</span></span></li>
<li><span data-ttu-id="4269a-401">Не удается переместить сотрудника tooa новое подразделение с помощью EGT.</span><span class="sxs-lookup"><span data-stu-id="4269a-401">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="4269a-402">Отдельные типы сущностей, разные разделы или таблицы, или учетные записи хранилища</span><span class="sxs-lookup"><span data-stu-id="4269a-402">Separate entity types, different partitions or tables or storage accounts</span></span></td>
<td>
<ul>
<li><span data-ttu-id="4269a-403">Сущность отдела или сущность сотрудника можно обновить с помощью одной операции.</span><span class="sxs-lookup"><span data-stu-id="4269a-403">You can update a department entity or employee entity with a single operation.</span></span></li>
<li><span data-ttu-id="4269a-404">В значительными объемами транзакций, это может помочь разворота нагрузки hello в нескольких секциях.</span><span class="sxs-lookup"><span data-stu-id="4269a-404">At high transaction volumes, this may help spread hello load across more partitions.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="4269a-405">Для некоторых действий, клиент может потребоваться tooretrieve сотрудник и сущность department.</span><span class="sxs-lookup"><span data-stu-id="4269a-405">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="4269a-406">Нельзя использовать EGTs toomaintain согласованности при вы обновление, вставка или удаление сотрудника и обновление отдел.</span><span class="sxs-lookup"><span data-stu-id="4269a-406">You cannot use EGTs toomaintain consistency when you update/insert/delete an employee and update a department.</span></span> <span data-ttu-id="4269a-407">Например, для обновления количества сотрудников в сущности отдела.</span><span class="sxs-lookup"><span data-stu-id="4269a-407">For example, updating an employee count in a department entity.</span></span></li>
<li><span data-ttu-id="4269a-408">Не удается переместить сотрудника tooa новое подразделение с помощью EGT.</span><span class="sxs-lookup"><span data-stu-id="4269a-408">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="4269a-409">Денормализация в один тип сущности</span><span class="sxs-lookup"><span data-stu-id="4269a-409">Denormalize into single entity type</span></span></td>
<td>
<ul>
<li><span data-ttu-id="4269a-410">Можно получить все сведения о hello, с помощью одного запроса.</span><span class="sxs-lookup"><span data-stu-id="4269a-410">You can retrieve all hello information you need with a single request.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="4269a-411">Если вам нужна информация отдел tooupdate (для этого может потребоваться вы tooupdate все hello сотрудниками в отделе) может дорогих toomaintain согласованности.</span><span class="sxs-lookup"><span data-stu-id="4269a-411">It may be expensive toomaintain consistency if you need tooupdate department information (this would require you tooupdate all hello employees in a department).</span></span></li>
</ul>
</td>
</tr>
</table>

<span data-ttu-id="4269a-412">Как выбрать эти параметры и какие преимущества hello и недостатки наиболее важны, зависит от вашей определенные сценарии приложений.</span><span class="sxs-lookup"><span data-stu-id="4269a-412">How you choose between these options, and which of hello pros and cons are most significant, depends on your specific application scenarios.</span></span> <span data-ttu-id="4269a-413">Например как часто изменять отдел сущности; нужны ли все запросы сотрудника hello дополнительной информации отдела; насколько близко вы toohello ограничения масштабирования на секции или вашей учетной записи хранилища?</span><span class="sxs-lookup"><span data-stu-id="4269a-413">For example, how often do you modify department entities; do all your employee queries need hello additional departmental information; how close are you toohello scalability limits on your partitions or your storage account?</span></span>  

### <a name="one-to-one-relationships"></a><span data-ttu-id="4269a-414">Отношения «один-к-одному»</span><span class="sxs-lookup"><span data-stu-id="4269a-414">One-to-one relationships</span></span>
<span data-ttu-id="4269a-415">В модель предметной области могут входить отношения между сущностями «один-к-одному».</span><span class="sxs-lookup"><span data-stu-id="4269a-415">Domain models may include one-to-one relationships between entities.</span></span> <span data-ttu-id="4269a-416">Если вам требуется tooimplement отношение в hello службы таблиц, необходимо выбрать как toolink hello двух связанных объектов, при необходимости tooretrieve их обоих.</span><span class="sxs-lookup"><span data-stu-id="4269a-416">If you need tooimplement a one-to-one relationship in hello Table service, you must also choose how toolink hello two related entities when you need tooretrieve them both.</span></span> <span data-ttu-id="4269a-417">Эта ссылка может указывать, в зависимости от соглашения в значениях ключа hello, явную или неявную, сохраняя ссылку в форме hello **PartitionKey** и **RowKey** значения в каждой сущности tooits связанные сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-417">This link can be either implicit, based on a convention in hello key values, or explicit by storing a link in hello form of **PartitionKey** and **RowKey** values in each entity tooits related entity.</span></span> <span data-ttu-id="4269a-418">Следует ли хранить hello обсуждение связанные сущности в одной секции hello, см. раздел hello [один ко многим связи](#one-to-many-relationships).</span><span class="sxs-lookup"><span data-stu-id="4269a-418">For a discussion of whether you should store hello related entities in hello same partition, see hello section [One-to-many relationships](#one-to-many-relationships).</span></span>  

<span data-ttu-id="4269a-419">Обратите внимание, что существуют также вопросах реализации, которые могут привести отношения один к одному tooimplement в службе таблиц hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-419">Note that there are also implementation considerations that might lead you tooimplement one-to-one relationships in hello Table service:</span></span>  

* <span data-ttu-id="4269a-420">Обработка сущностей большого размера (дополнительные сведения см. в статье [Шаблон для сущностей больших размеров](#large-entities-pattern)).</span><span class="sxs-lookup"><span data-stu-id="4269a-420">Handling large entities (for more information, see [Large Entities Pattern](#large-entities-pattern)).</span></span>  
* <span data-ttu-id="4269a-421">Внедрение средств управления доступом (см. раздел [Управление доступом с помощью подписанных URL-адресов](#controlling-access-with-shared-access-signatures)).</span><span class="sxs-lookup"><span data-stu-id="4269a-421">Implementing access controls (for more information, see [Controlling access with Shared Access Signatures](#controlling-access-with-shared-access-signatures)).</span></span>  

### <a name="join-in-hello-client"></a><span data-ttu-id="4269a-422">Примите участие в приветствия клиента</span><span class="sxs-lookup"><span data-stu-id="4269a-422">Join in hello client</span></span>
<span data-ttu-id="4269a-423">Несмотря на то, что существуют способы toomodel связи в hello службы таблиц, не следует забывать, масштабируемость и производительность hello два основной причины использования hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-423">Although there are ways toomodel relationships in hello Table service, you should not forget that hello two prime reasons for using hello Table service are scalability and performance.</span></span> <span data-ttu-id="4269a-424">Если обнаружится, что моделирования много связей, которые представляют угрозу hello производительности и масштабируемости решения, необходимо обратиться самостоятельно при необходимости toobuild все hello отношения между данными в макет таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-424">If you find you are modelling many relationships that compromise hello performance and scalability of your solution, you should ask yourself if it is necessary toobuild all hello data relationships into your table design.</span></span> <span data-ttu-id="4269a-425">Может быть разработки может toosimplify hello и улучшения hello масштабируемости и производительности для вашего решения, если предоставляется возможность выполнить любое соединение клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="4269a-425">You may be able toosimplify hello design and improve hello scalability and performance of your solution if you let your client application perform any necessary joins.</span></span>  

<span data-ttu-id="4269a-426">Например при наличии небольших таблиц, содержащих данные, которые не очень часто изменяются, затем можно получить эти данные один раз и кэшировать его на приветствия клиента.</span><span class="sxs-lookup"><span data-stu-id="4269a-426">For example, if you have small tables that contain data that does not change very often, then you can retrieve this data once and cache it on hello client.</span></span> <span data-ttu-id="4269a-427">Это может предотвратить повторных передач tooretrieve hello и тех же данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-427">This can avoid repeated roundtrips tooretrieve hello same data.</span></span> <span data-ttu-id="4269a-428">В примерах hello, были также рассмотрены в данном руководстве hello отделов в небольшой организации это скорее всего toobe небольшие и редко становится хорошим кандидатом для данных, клиентское приложение можно загрузить один раз и кэш так же для поиска данных изменений.</span><span class="sxs-lookup"><span data-stu-id="4269a-428">In hello examples we have looked at in this guide, hello set of departments in a small organization is likely toobe small and change infrequently making it a good candidate for data that client application can download once and cache as look up data.</span></span>  

### <a name="inheritance-relationships"></a><span data-ttu-id="4269a-429">Отношения наследования</span><span class="sxs-lookup"><span data-stu-id="4269a-429">Inheritance relationships</span></span>
<span data-ttu-id="4269a-430">Если клиентское приложение использует набор классов, которые являются частью бизнес-сущности toorepresent отношение наследования, можно легко сохранить этих сущностей в hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-430">If your client application uses a set of classes that form part of an inheritance relationship toorepresent business entities, you can easily persist those entities in hello Table service.</span></span> <span data-ttu-id="4269a-431">Например, может потребоваться hello следующий набор классов, определенных в клиентском приложении где **лицо** класс является абстрактным.</span><span class="sxs-lookup"><span data-stu-id="4269a-431">For example, you might have hello following set of classes defined in your client application where **Person** is an abstract class.</span></span>

![][3]

<span data-ttu-id="4269a-432">Можно хранить экземпляры двух конкретных классов hello в hello службы таблиц с помощью одной таблицы Person, с помощью сущностей в этом выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4269a-432">You can persist instances of hello two concrete classes in hello Table service using a single Person table using entities in that look like this:</span></span>  

![][4]

<span data-ttu-id="4269a-433">Дополнительные сведения о работе с несколькими типами сущностей в hello же таблицу в клиентском коде в разделе hello [работа с типами сущностей разнородных](#working-with-heterogeneous-entity-types) далее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="4269a-433">For more information about working with multiple entity types in hello same table in client code, see hello section [Working with heterogeneous entity types](#working-with-heterogeneous-entity-types) later in this guide.</span></span> <span data-ttu-id="4269a-434">Это примеры как toorecognize hello типа сущности в клиентском коде.</span><span class="sxs-lookup"><span data-stu-id="4269a-434">This provides examples of how toorecognize hello entity type in client code.</span></span>  

## <a name="table-design-patterns"></a><span data-ttu-id="4269a-435">Шаблоны для разработки таблиц</span><span class="sxs-lookup"><span data-stu-id="4269a-435">Table Design Patterns</span></span>
<span data-ttu-id="4269a-436">В предыдущих разделах вы уже узнали подробные обсуждения как toooptimize таблицы обоих получение данных сущности, с помощью запросов и разработки для вставки, обновления и удаления данных сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-436">In previous sections, you have seen some detailed discussions about how toooptimize your table design for both retrieving entity data using queries and for inserting, updating, and deleting entity data.</span></span> <span data-ttu-id="4269a-437">В этом разделе приводится описание некоторых шаблонов, которые подходят для использования с решениями для службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-437">This section describes some patterns appropriate for use with Table service solutions.</span></span> <span data-ttu-id="4269a-438">Кроме того вы увидите, как вы можно практически устранить некоторые проблемы hello и преимущества и недостатки возникает ранее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="4269a-438">In addition, you will see how you can practically address some of hello issues and trade-offs raised previously in this guide.</span></span> <span data-ttu-id="4269a-439">Hello следующей диаграмме показаны hello связи между hello различных шаблонов:</span><span class="sxs-lookup"><span data-stu-id="4269a-439">hello following diagram summarizes hello relationships between hello different patterns:</span></span>  

![][5]

<span data-ttu-id="4269a-440">карты шаблон Hello выше представлены некоторые связи между шаблонов (синий) и антишаблоны (оранжевый), описанные в данном руководстве.</span><span class="sxs-lookup"><span data-stu-id="4269a-440">hello pattern map above highlights some relationships between patterns (blue) and anti-patterns (orange) that are documented in this guide.</span></span> <span data-ttu-id="4269a-441">Безусловно, существует множество других стоящих внимания шаблонов.</span><span class="sxs-lookup"><span data-stu-id="4269a-441">There are of course many other patterns that are worth considering.</span></span> <span data-ttu-id="4269a-442">Например, один из основных сценариев hello для службы таблиц — toouse hello [материализованные представления шаблон](https://msdn.microsoft.com/library/azure/dn589782.aspx) из hello [разделение ответственности команды запросов (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) шаблон.</span><span class="sxs-lookup"><span data-stu-id="4269a-442">For example, one of hello key scenarios for Table Service is toouse hello [Materialized View Pattern](https://msdn.microsoft.com/library/azure/dn589782.aspx) from hello [Command Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) pattern.</span></span>  

### <a name="intra-partition-secondary-index-pattern"></a><span data-ttu-id="4269a-443">Шаблон вторичного индекса внутри раздела</span><span class="sxs-lookup"><span data-stu-id="4269a-443">Intra-partition secondary index pattern</span></span>
<span data-ttu-id="4269a-444">Хранение нескольких копий каждой сущности, используя различные **RowKey** значения (в hello одной секции) tooenable быстрого и эффективного поиска и сортировки альтернативный заказы с помощью различных **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-444">Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span> <span data-ttu-id="4269a-445">Транзакции группы сущностей обеспечивают согласованность обновлений копий.</span><span class="sxs-lookup"><span data-stu-id="4269a-445">Updates between copies can be kept consistent using EGT's.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-446">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-446">Context and problem</span></span>
<span data-ttu-id="4269a-447">Hello службы таблиц автоматически индексирует сущностей с помощью hello **PartitionKey** и **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-447">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-448">Это позволяет tooretrieve клиентского приложения эффективно с использованием этих значений сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-448">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="4269a-449">Например, с помощью структуры таблицы hello, показано ниже, клиентское приложение может использовать tooretrieve запроса точки отдельного сотрудника сущности с помощью название отдела hello и идентификатор сотрудника hello (hello **PartitionKey** и  **RowKey** значения).</span><span class="sxs-lookup"><span data-stu-id="4269a-449">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="4269a-450">Клиент также может извлекать сущности, отсортированные по ИД сотрудника в каждом отделе.</span><span class="sxs-lookup"><span data-stu-id="4269a-450">A client can also retrieve entities sorted by employee id within each department.</span></span>

![][6]

<span data-ttu-id="4269a-451">Если также требуется toobe может toofind сущности employee на основе hello значения другого свойства, такие как адрес электронной почты, необходимо использовать менее эффективный toofind сканирования секции совпадения.</span><span class="sxs-lookup"><span data-stu-id="4269a-451">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="4269a-452">Это так, как служба таблиц hello не поддерживает вторичные индексы.</span><span class="sxs-lookup"><span data-stu-id="4269a-452">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="4269a-453">Кроме того, имеется не toorequest параметр список сотрудников, отсортированных в порядке, отличном от **RowKey** заказа.</span><span class="sxs-lookup"><span data-stu-id="4269a-453">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-454">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-454">Solution</span></span>
<span data-ttu-id="4269a-455">toowork вокруг hello отсутствие вторичные индексы можно хранить несколько копий каждой сущности для каждой копии с другой **RowKey** значение.</span><span class="sxs-lookup"><span data-stu-id="4269a-455">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using a different **RowKey** value.</span></span> <span data-ttu-id="4269a-456">Если сохранить сущность со структурами hello, показано ниже, получать сущности employee на основе идентификатора сотрудниках и адрес электронной почты. Здравствуйте, префиксные значения для hello **RowKey**, «empid_» и «email_» позволяют tooquery для одного сотрудника или диапазон сотрудников с помощью диапазона адресов электронной почты или идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="4269a-456">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **RowKey**, "empid_" and "email_" enable you tooquery for a single employee or a range of employees by using a range of email addresses or employee ids.</span></span>  

![][7]

<span data-ttu-id="4269a-457">Hello следующих двух условий фильтра (один поиске идентификатор сотрудника и один поиск по адресу электронной почты) и укажите точечными запросами:</span><span class="sxs-lookup"><span data-stu-id="4269a-457">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="4269a-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span><span class="sxs-lookup"><span data-stu-id="4269a-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span></span>  
* <span data-ttu-id="4269a-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="4269a-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span></span>  

<span data-ttu-id="4269a-460">При выполнении запроса для диапазона сущности employee, можно указать диапазон, отсортированных в порядке идентификатор сотрудника или диапазон, отсортированных в порядке адрес электронной почты с помощью запроса для сущностей с hello соответствующий префикс в hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-460">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="4269a-461">использовать все hello сотрудникам отдела продаж hello идентификатор сотрудника в диапазоне 000100 too000199 hello toofind: $filter = (eq PartitionKey «Продажи») и (ge RowKey «empid_000100») и (le RowKey «empid_000199»)</span><span class="sxs-lookup"><span data-stu-id="4269a-461">toofind all hello employees in hello Sales department with an employee id in hello range 000100 too000199 use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000100') and (RowKey le 'empid_000199')</span></span>  
* <span data-ttu-id="4269a-462">все hello сотрудники отдела продаж hello с адресом электронной почты, начиная с hello toofind буква «' use: $filter = (eq PartitionKey «Продажи») и (ge RowKey «email_a») и (lt RowKey «email_b»)</span><span class="sxs-lookup"><span data-stu-id="4269a-462">toofind all hello employees in hello Sales department with an email address starting with hello letter 'a' use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'email_a') and (RowKey lt 'email_b')</span></span>  
  
  <span data-ttu-id="4269a-463">Обратите внимание, что используется в примерах hello выше синтаксис фильтра hello из REST API службы таблиц hello дополнительная информация [запросы к сущностям](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-463">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-464">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-464">Issues and considerations</span></span>
<span data-ttu-id="4269a-465">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-465">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-466">Хранилище таблиц является toouse относительно требует больших затрат, поэтому hello затрат на хранение повторяющихся данных не должно быть предметом первостепенной важности.</span><span class="sxs-lookup"><span data-stu-id="4269a-466">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="4269a-467">Тем не менее следует всегда возвращают hello затрат на основе требований предполагаемого хранения проекта и добавлять повторяющиеся объекты toosupport hello запросы, которые клиентское приложение будет выполнять только.</span><span class="sxs-lookup"><span data-stu-id="4269a-467">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="4269a-468">Поскольку hello вторичный индекс сущности сохраняются в hello же секции как hello исходной сущности, вы должны убедиться, не превышает hello целевые показатели масштабируемости отдельной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-468">Because hello secondary index entities are stored in hello same partition as hello original entities, you should ensure that you do not exceed hello scalability targets for an individual partition.</span></span>  
* <span data-ttu-id="4269a-469">Повторяющиеся сущностей можно сохранить согласованность друг с другом с помощью двух копий EGTs tooupdate hello объекта hello единым блоком.</span><span class="sxs-lookup"><span data-stu-id="4269a-469">You can keep your duplicate entities consistent with each other by using EGTs tooupdate hello two copies of hello entity atomically.</span></span> <span data-ttu-id="4269a-470">Это означает, что следует хранить все копии сущности в hello одной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-470">This implies that you should store all copies of an entity in hello same partition.</span></span> <span data-ttu-id="4269a-471">Дополнительные сведения см в разделе hello [с помощью транзакции группы сущностей](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="4269a-471">For more information, see hello section [Using Entity Group Transactions](#entity-group-transactions).</span></span>  
* <span data-ttu-id="4269a-472">Здравствуйте, значение, используемое для hello **RowKey** должно быть уникальным для каждой сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-472">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="4269a-473">Рекомендуется использовать значения составного ключа.</span><span class="sxs-lookup"><span data-stu-id="4269a-473">Consider using compound key values.</span></span>  
* <span data-ttu-id="4269a-474">Заполнение числовые значения в hello **RowKey** (например, идентификатор сотрудника hello 000223) позволяет исправить сортировки и фильтрации на основе верхней и нижней границ.</span><span class="sxs-lookup"><span data-stu-id="4269a-474">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="4269a-475">Вы не обязательно tooduplicate все hello свойства сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-475">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="4269a-476">Например, если hello запросов, уточняющие сущности hello hello с помощью электронной почты адрес в hello **RowKey** не требуется значение возраста сотрудников hello, эти сущности может иметь hello следующие структуры:</span><span class="sxs-lookup"><span data-stu-id="4269a-476">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>

![][8]

* <span data-ttu-id="4269a-477">Это обычно лучше toostore повторяющиеся данные и убедитесь, что все данные hello, необходимые в рамках одного запроса можно получить, чем один запрос toolocate toouse сущностью и другой hello toolookup необходимых данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-477">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query, than toouse one query toolocate an entity and another toolookup hello required data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-478">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-478">When toouse this pattern</span></span>
<span data-ttu-id="4269a-479">Эта схема используется в том случае, когда приложению клиента, tooretrieve сущностей, используя разнообразные разных ключей, когда клиент должен tooretrieve сущностей в различными порядками сортировки и там, где можно определить каждую сущность, с помощью различных уникальных значений.</span><span class="sxs-lookup"><span data-stu-id="4269a-479">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="4269a-480">Однако должны быть убедитесь, что при выполнении сущности уточняющих запросов, с помощью различных hello не превышает ограничения масштабируемости секции hello **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-480">However, you should be sure that you do not exceed hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-481">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-481">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-482">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-482">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-483">Шаблон вторичного индекса в разных разделах;</span><span class="sxs-lookup"><span data-stu-id="4269a-483">Inter-partition secondary index pattern</span></span>](#inter-partition-secondary-index-pattern)
* [<span data-ttu-id="4269a-484">Шаблон составного ключа;</span><span class="sxs-lookup"><span data-stu-id="4269a-484">Compound key pattern</span></span>](#compound-key-pattern)
* [<span data-ttu-id="4269a-485">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-485">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="4269a-486">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-486">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="inter-partition-secondary-index-pattern"></a><span data-ttu-id="4269a-487">Шаблон вторичного индекса в разных разделах</span><span class="sxs-lookup"><span data-stu-id="4269a-487">Inter-partition secondary index pattern</span></span>
<span data-ttu-id="4269a-488">Хранение нескольких копий каждой сущности, используя различные **RowKey** значения в отдельной секции или в отдельных таблицах tooenable уточняющие запросы быстрые и эффективные и альтернативный порядок сортировки с помощью различных **RowKey**значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-488">Store multiple copies of each entity using different **RowKey** values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-489">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-489">Context and problem</span></span>
<span data-ttu-id="4269a-490">Hello службы таблиц автоматически индексирует сущностей с помощью hello **PartitionKey** и **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-490">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-491">Это позволяет tooretrieve клиентского приложения эффективно с использованием этих значений сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-491">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="4269a-492">Например, с помощью структуры таблицы hello, показано ниже, клиентское приложение может использовать tooretrieve запроса точки отдельного сотрудника сущности с помощью название отдела hello и идентификатор сотрудника hello (hello **PartitionKey** и  **RowKey** значения).</span><span class="sxs-lookup"><span data-stu-id="4269a-492">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="4269a-493">Клиент также может извлекать сущности, отсортированные по ИД сотрудника в каждом отделе.</span><span class="sxs-lookup"><span data-stu-id="4269a-493">A client can also retrieve entities sorted by employee id within each department.</span></span>  

![][9]

<span data-ttu-id="4269a-494">Если также требуется toobe может toofind сущности employee на основе hello значения другого свойства, такие как адрес электронной почты, необходимо использовать менее эффективный toofind сканирования секции совпадения.</span><span class="sxs-lookup"><span data-stu-id="4269a-494">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="4269a-495">Это так, как служба таблиц hello не поддерживает вторичные индексы.</span><span class="sxs-lookup"><span data-stu-id="4269a-495">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="4269a-496">Кроме того, имеется не toorequest параметр список сотрудников, отсортированных в порядке, отличном от **RowKey** заказа.</span><span class="sxs-lookup"><span data-stu-id="4269a-496">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

<span data-ttu-id="4269a-497">Планирование очень большой объем транзакций на эти сущности и требуется toominimize риск hello hello регулирования клиента службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-497">You are anticipating a very high volume of transactions against these entities and want toominimize hello risk of hello Table service throttling your client.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-498">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-498">Solution</span></span>
<span data-ttu-id="4269a-499">toowork вокруг hello отсутствие вторичные индексы хранение нескольких копий каждой сущности с каждой копии с помощью различных **PartitionKey** и **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-499">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using different **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-500">Если сохранить сущность со структурами hello, показано ниже, получать сущности employee на основе идентификатора сотрудниках и адрес электронной почты. Здравствуйте, префиксные значения для hello **PartitionKey**, «empid_» и «email_» позволяет tooidentify вы индекс, который хотите toouse для запроса.</span><span class="sxs-lookup"><span data-stu-id="4269a-500">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **PartitionKey**, "empid_" and "email_" enable you tooidentify which index you want toouse for a query.</span></span>  

![][10]

<span data-ttu-id="4269a-501">Hello следующих двух условий фильтра (один поиске идентификатор сотрудника и один поиск по адресу электронной почты) и укажите точечными запросами:</span><span class="sxs-lookup"><span data-stu-id="4269a-501">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="4269a-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span><span class="sxs-lookup"><span data-stu-id="4269a-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span></span>
* <span data-ttu-id="4269a-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="4269a-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span></span>  

<span data-ttu-id="4269a-504">При выполнении запроса для диапазона сущности employee, можно указать диапазон, отсортированных в порядке идентификатор сотрудника или диапазон, отсортированных в порядке адрес электронной почты с помощью запроса для сущностей с hello соответствующий префикс в hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-504">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="4269a-505">все hello сотрудников в toofind hello отдела продаж с идентификаторами в диапазоне hello **000100** слишком**000199** сортировки используется порядок идентификатор сотрудника: $filter = (PartitionKey eq ' empid_Sales') и (RowKey ge " 000100') и (le RowKey "000199")</span><span class="sxs-lookup"><span data-stu-id="4269a-505">toofind all hello employees in hello Sales department with an employee id in hello range **000100** too**000199** sorted in employee id order use: $filter=(PartitionKey eq 'empid_Sales') and (RowKey ge '000100') and (RowKey le '000199')</span></span>  
* <span data-ttu-id="4269a-506">toofind порядок использования адреса электронной почты всех hello сотрудников отдела продаж hello с адресом электронной почты, который начинается с «» в: $filter = (PartitionKey eq ' email_Sales') и (RowKey ge 'a') и (lt RowKey 'b')</span><span class="sxs-lookup"><span data-stu-id="4269a-506">toofind all hello employees in hello Sales department with an email address that starts with 'a' sorted in email address order use: $filter=(PartitionKey eq 'email_Sales') and (RowKey ge 'a') and (RowKey lt 'b')</span></span>  

<span data-ttu-id="4269a-507">Обратите внимание, что используется в примерах hello выше синтаксис фильтра hello из REST API службы таблиц hello дополнительная информация [запросы к сущностям](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-507">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-508">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-508">Issues and considerations</span></span>
<span data-ttu-id="4269a-509">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-509">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-510">Можно сохранить повторяющиеся сущностей согласованным друг с другом с помощью hello [шаблон согласованным транзакции](#eventually-consistent-transactions-pattern) toomaintain hello первичного и вторичного индекса сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-510">You can keep your duplicate entities eventually consistent with each other by using hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain hello primary and secondary index entities.</span></span>  
* <span data-ttu-id="4269a-511">Хранилище таблиц является toouse относительно требует больших затрат, поэтому hello затрат на хранение повторяющихся данных не должно быть предметом первостепенной важности.</span><span class="sxs-lookup"><span data-stu-id="4269a-511">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="4269a-512">Тем не менее следует всегда возвращают hello затрат на основе требований предполагаемого хранения проекта и добавлять повторяющиеся объекты toosupport hello запросы, которые клиентское приложение будет выполнять только.</span><span class="sxs-lookup"><span data-stu-id="4269a-512">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="4269a-513">Здравствуйте, значение, используемое для hello **RowKey** должно быть уникальным для каждой сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-513">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="4269a-514">Рекомендуется использовать значения составного ключа.</span><span class="sxs-lookup"><span data-stu-id="4269a-514">Consider using compound key values.</span></span>  
* <span data-ttu-id="4269a-515">Заполнение числовые значения в hello **RowKey** (например, идентификатор сотрудника hello 000223) позволяет исправить сортировки и фильтрации на основе верхней и нижней границ.</span><span class="sxs-lookup"><span data-stu-id="4269a-515">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="4269a-516">Вы не обязательно tooduplicate все hello свойства сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-516">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="4269a-517">Например, если hello запросов, уточняющие сущности hello hello с помощью электронной почты адрес в hello **RowKey** не требуется значение возраста сотрудников hello, эти сущности может иметь hello следующие структуры:</span><span class="sxs-lookup"><span data-stu-id="4269a-517">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>
  
  ![][11]
* <span data-ttu-id="4269a-518">Это обычно лучше toostore повторяющиеся данные и убедитесь, что можно получить все hello необходимых данных в рамках одного запроса не toolocate один запрос toouse сущности, используя hello вторичного индекса, и другой toolookup hello необходимых данных в первичном индексе hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-518">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query than toouse one query toolocate an entity using hello secondary index and another toolookup hello required data in hello primary index.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-519">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-519">When toouse this pattern</span></span>
<span data-ttu-id="4269a-520">Эта схема используется в том случае, когда приложению клиента, tooretrieve сущностей, используя разнообразные разных ключей, когда клиент должен tooretrieve сущностей в различными порядками сортировки и там, где можно определить каждую сущность, с помощью различных уникальных значений.</span><span class="sxs-lookup"><span data-stu-id="4269a-520">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="4269a-521">Использовать этот шаблон при необходимости tooavoid превышение hello секции масштабируемости при выполнении сущности уточняющих запросов, с помощью различных hello **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-521">Use this pattern when you want tooavoid exceeding hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-522">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-522">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-523">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-523">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-524">Шаблон для согласованных транзакций;</span><span class="sxs-lookup"><span data-stu-id="4269a-524">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="4269a-525">Шаблон вторичного индекса внутри раздела;</span><span class="sxs-lookup"><span data-stu-id="4269a-525">Intra-partition secondary index pattern</span></span>](#intra-partition-secondary-index-pattern)  
* [<span data-ttu-id="4269a-526">Шаблон составного ключа;</span><span class="sxs-lookup"><span data-stu-id="4269a-526">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4269a-527">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-527">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4269a-528">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-528">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="eventually-consistent-transactions-pattern"></a><span data-ttu-id="4269a-529">Шаблон для согласованных транзакций</span><span class="sxs-lookup"><span data-stu-id="4269a-529">Eventually consistent transactions pattern</span></span>
<span data-ttu-id="4269a-530">Обеспечьте согласованное поведение в рамках границ раздела или границ системы хранения с помощью запросов Azure.</span><span class="sxs-lookup"><span data-stu-id="4269a-530">Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-531">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-531">Context and problem</span></span>
<span data-ttu-id="4269a-532">EGTs включить атомарные транзакции через несколько сущностей, которые совместно используют hello же ключ секционирования.</span><span class="sxs-lookup"><span data-stu-id="4269a-532">EGTs enable atomic transactions across multiple entities that share hello same partition key.</span></span> <span data-ttu-id="4269a-533">Для производительности и масштабируемости, вы можете toostore сущностей с требованиями к согласованности в отдельной секции или в системе хранить: в этом случае нельзя использовать EGTs toomaintain согласованности.</span><span class="sxs-lookup"><span data-stu-id="4269a-533">For performance and scalability reasons, you might decide toostore entities that have consistency requirements in separate partitions or in a separate storage system: in such a scenario, you cannot use EGTs toomaintain consistency.</span></span> <span data-ttu-id="4269a-534">Например может потребоваться toomaintain требование, итоговая согласованность между:</span><span class="sxs-lookup"><span data-stu-id="4269a-534">For example, you might have a requirement toomaintain eventual consistency between:</span></span>  

* <span data-ttu-id="4269a-535">Записи, которые хранятся в двух разных секциях в hello же таблицу, в различных таблицах в в разных учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="4269a-535">Entities stored in two different partitions in hello same table, in different tables, in in different storage accounts.</span></span>  
* <span data-ttu-id="4269a-536">Сущность, хранящихся в hello службы таблиц и больших двоичных объектов, хранящихся в hello службы BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="4269a-536">An entity stored in hello Table service and a blob stored in hello Blob service.</span></span>  
* <span data-ttu-id="4269a-537">Сущность, хранящиеся в службе таблиц hello и файл в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="4269a-537">An entity stored in hello Table service and a file in a file system.</span></span>  
* <span data-ttu-id="4269a-538">Сущность хранения в hello службы таблиц еще индексированы hello службы поиска Azure.</span><span class="sxs-lookup"><span data-stu-id="4269a-538">An entity store in hello Table service yet indexed using hello Azure Search service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-539">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-539">Solution</span></span>
<span data-ttu-id="4269a-540">Используя очереди Azure, можно реализовать решение, обеспечивающее согласованность между двумя и более разделами или системами хранения.</span><span class="sxs-lookup"><span data-stu-id="4269a-540">By using Azure queues, you can implement a solution that delivers eventual consistency across two or more partitions or storage systems.</span></span>
<span data-ttu-id="4269a-541">tooillustrate это подход, предположим, имеется требование toobe может tooarchive старого сущности employee.</span><span class="sxs-lookup"><span data-stu-id="4269a-541">tooillustrate this approach, assume you have a requirement toobe able tooarchive old employee entities.</span></span> <span data-ttu-id="4269a-542">К старым сущностям сотрудников редко выполняются запросы, поэтому они должны быть исключены из любых действий, связанных с текущими сотрудниками.</span><span class="sxs-lookup"><span data-stu-id="4269a-542">Old employee entities are rarely queried and should be excluded from any activities that deal with current employees.</span></span> <span data-ttu-id="4269a-543">tooimplement это требование, сохранении активных сотрудников в hello **текущей** таблицы и старой сотрудников в hello **архив** таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-543">tooimplement this requirement you store active employees in hello **Current** table and old employees in hello **Archive** table.</span></span> <span data-ttu-id="4269a-544">Архивация сотрудник требует toodelete hello сущности из hello **текущей** и добавить сущность toohello hello **архив** таблицы, но не может использовать tooperform EGT эти две операции.</span><span class="sxs-lookup"><span data-stu-id="4269a-544">Archiving an employee requires you toodelete hello entity from hello **Current** table and add hello entity toohello **Archive** table, but you cannot use an EGT tooperform these two operations.</span></span> <span data-ttu-id="4269a-545">риск hello tooavoid, сбой приводит tooappear сущности, оба или ни одна из таблиц, операция сохранения hello должен быть согласованным.</span><span class="sxs-lookup"><span data-stu-id="4269a-545">tooavoid hello risk that a failure causes an entity tooappear in both or neither tables, hello archive operation must be eventually consistent.</span></span> <span data-ttu-id="4269a-546">Hello следующей схеме описаны шаги hello в этой операции.</span><span class="sxs-lookup"><span data-stu-id="4269a-546">hello following sequence diagram outlines hello steps in this operation.</span></span> <span data-ttu-id="4269a-547">Дополнительные сведения приведены для исключения пути в следующий текст hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-547">More detail is provided for exception paths in hello text following.</span></span>  

![][12]

<span data-ttu-id="4269a-548">Клиент инициирует операцию архив hello, размещая сообщения в очереди Azure, в этом примере tooarchive сотрудника #456.</span><span class="sxs-lookup"><span data-stu-id="4269a-548">A client initiates hello archive operation by placing a message on an Azure queue, in this example tooarchive employee #456.</span></span> <span data-ttu-id="4269a-549">Рабочая роль опрашивает очередь hello для новых сообщений; При обнаружении он считывает сообщение hello и оставляет скрытые копии очереди hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-549">A worker role polls hello queue for new messages; when it finds one, it reads hello message and leaves a hidden copy on hello queue.</span></span> <span data-ttu-id="4269a-550">Hello рабочей роли Далее извлекает копию hello сущности из hello **текущей** таблицы, вставка в hello **архив** таблицы, а затем удаляет hello исходного из hello **текущей**таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-550">hello worker role next fetches a copy of hello entity from hello **Current** table, inserts a copy in hello **Archive** table, and then deletes hello original from hello **Current** table.</span></span> <span data-ttu-id="4269a-551">И, наконец в случае ошибки из предыдущих шагов hello не hello рабочей роли удаляет hello скрытого сообщения из очереди hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-551">Finally, if there were no errors from hello previous steps, hello worker role deletes hello hidden message from hello queue.</span></span>  

<span data-ttu-id="4269a-552">В этом примере шаг 4 вставляет hello сотрудника в hello **архив** таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-552">In this example, step 4 inserts hello employee into hello **Archive** table.</span></span> <span data-ttu-id="4269a-553">Его добавить hello сотрудника tooa blob в hello службы BLOB-объектов или файл в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="4269a-553">It could add hello employee tooa blob in hello Blob service or a file in a file system.</span></span>  

#### <a name="recovering-from-failures"></a><span data-ttu-id="4269a-554">Восстановление после сбоев</span><span class="sxs-lookup"><span data-stu-id="4269a-554">Recovering from failures</span></span>
<span data-ttu-id="4269a-555">Очень важно, hello операций в шагах **4** и **5** должно быть *идемпотентными* в случае, если операции архивирования hello toorestart должен hello рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="4269a-555">It is important that hello operations in steps **4** and **5** must be *idempotent* in case hello worker role needs toorestart hello archive operation.</span></span> <span data-ttu-id="4269a-556">При использовании службы таблиц hello, для шага **4** следует использовать операцию «Вставка или замена»; для шага **5** следует использовать «удалить, если существует» операции в клиентской библиотеке hello, вы используете.</span><span class="sxs-lookup"><span data-stu-id="4269a-556">If you are using hello Table service, for step **4** you should use an "insert or replace" operation; for step **5** you should use a "delete if exists" operation in hello client library you are using.</span></span> <span data-ttu-id="4269a-557">Если используется другая система хранения данных, необходимо выполнить соответствующую идемпотентную операцию.</span><span class="sxs-lookup"><span data-stu-id="4269a-557">If you are using another storage system, you must use an appropriate idempotent operation.</span></span>  

<span data-ttu-id="4269a-558">Если рабочая роль hello никогда не завершается шаг **6**, затем после превышения времени ожидания hello снова появится на hello очереди, готовые к hello рабочей роли tootry tooreprocess его.</span><span class="sxs-lookup"><span data-stu-id="4269a-558">If hello worker role never completes step **6**, then after a timeout hello message reappears on hello queue ready for hello worker role tootry tooreprocess it.</span></span> <span data-ttu-id="4269a-559">Hello рабочей роли можно проверить, сколько раз прочтения сообщения в очереди hello и при необходимости это «подозрительных» сообщений для изучения путем отправки их tooa флаг разделения очереди.</span><span class="sxs-lookup"><span data-stu-id="4269a-559">hello worker role can check how many times a message on hello queue has been read and, if necessary, flag it is a "poison" message for investigation by sending it tooa separate queue.</span></span> <span data-ttu-id="4269a-560">Дополнительные сведения о чтении очереди сообщений и проверки hello количество вывода из очереди см. в разделе [получение сообщений](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span><span class="sxs-lookup"><span data-stu-id="4269a-560">For more information about reading queue messages and checking hello dequeue count, see [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span></span>  

<span data-ttu-id="4269a-561">Некоторые ошибки из служб таблиц и очередей hello являются временных ошибок и клиентское приложение должно включать toohandle логику повторных попыток подходящий их.</span><span class="sxs-lookup"><span data-stu-id="4269a-561">Some errors from hello Table and Queue services are transient errors, and your client application should include suitable retry logic toohandle them.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-562">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-562">Issues and considerations</span></span>
<span data-ttu-id="4269a-563">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-563">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-564">Это решение не поддерживает изоляцию транзакций.</span><span class="sxs-lookup"><span data-stu-id="4269a-564">This solution does not provide for transaction isolation.</span></span> <span data-ttu-id="4269a-565">Например, клиент может прочитать hello **текущей** и **архив** таблиц при hello рабочей роли между шагами **4** и **5**и в разделе несогласованное представление данных hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-565">For example, a client could read hello **Current** and **Archive** tables when hello worker role was between steps **4** and **5**, and see an inconsistent view of hello data.</span></span> <span data-ttu-id="4269a-566">Следует заметить, что данные hello согласованные со временем.</span><span class="sxs-lookup"><span data-stu-id="4269a-566">Note that hello data will be consistent eventually.</span></span>  
* <span data-ttu-id="4269a-567">Необходимо убедиться, что шаги 4 и 5 идемпотентными в окончательной согласованности tooensure заказа.</span><span class="sxs-lookup"><span data-stu-id="4269a-567">You must be sure that steps 4 and 5 are idempotent in order tooensure eventual consistency.</span></span>  
* <span data-ttu-id="4269a-568">Можно масштабировать hello решения с помощью нескольких очередей и экземпляры рабочих ролей.</span><span class="sxs-lookup"><span data-stu-id="4269a-568">You can scale hello solution by using multiple queues and worker role instances.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-569">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-569">When toouse this pattern</span></span>
<span data-ttu-id="4269a-570">Используйте этот шаблон при необходимости tooguarantee окончательной согласованности между сущностями, которая существует в другой секции или таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-570">Use this pattern when you want tooguarantee eventual consistency between entities that exist in different partitions or tables.</span></span> <span data-ttu-id="4269a-571">Можно расширить этот шаблон tooensure окончательной согласованности для операций на hello службы таблиц и BLOB-объектов hello и других источников данных хранилища Azure, например базы данных или hello файловой системы.</span><span class="sxs-lookup"><span data-stu-id="4269a-571">You can extend this pattern tooensure eventual consistency for operations across hello Table service and hello Blob service and other non-Azure Storage data sources such as database or hello file system.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-572">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-572">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-573">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-573">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-574">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-574">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4269a-575">Объединение или замена.</span><span class="sxs-lookup"><span data-stu-id="4269a-575">Merge or replace</span></span>](#merge-or-replace)  

> [!NOTE]
> <span data-ttu-id="4269a-576">Если уровень изоляции транзакции — tooyour важные решения, должны рассмотрите возможность повторной разработки вашей tooenable таблиц вы toouse EGTs.</span><span class="sxs-lookup"><span data-stu-id="4269a-576">If transaction isolation is important tooyour solution, you should consider redesigning your tables tooenable you toouse EGTs.</span></span>  
> 
> 

### <a name="index-entities-pattern"></a><span data-ttu-id="4269a-577">Шаблон сущностей индекса</span><span class="sxs-lookup"><span data-stu-id="4269a-577">Index Entities Pattern</span></span>
<span data-ttu-id="4269a-578">Обслуживание индекса сущностей tooenable эффективного поиска, возвращающих списки сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-578">Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-579">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-579">Context and problem</span></span>
<span data-ttu-id="4269a-580">Hello службы таблиц автоматически индексирует сущностей с помощью hello **PartitionKey** и **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-580">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-581">Это позволяет tooretrieve приложения клиента эффективно с использованием запроса точки сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-581">This enables a client application tooretrieve an entity efficiently using a point query.</span></span> <span data-ttu-id="4269a-582">Например, с помощью структуры таблицы hello, показано ниже, клиентское приложение получать отдельного сотрудника сущности с помощью название отдела hello и идентификатор сотрудника hello (hello **PartitionKey** и **RowKey** ).</span><span class="sxs-lookup"><span data-stu-id="4269a-582">For example, using hello table structure shown below, a client application can efficiently retrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey**).</span></span>  

![][13]

<span data-ttu-id="4269a-583">Если также требуется доступ tooretrieve toobe список сущности employee на основе hello значения другого свойства не являются уникальными, например фамилии, должен использовать менее эффективный раздел сканирования toofind совпадения, а не с помощью индекса toolook их непосредственно вверх.</span><span class="sxs-lookup"><span data-stu-id="4269a-583">If you also want toobe able tooretrieve a list of employee entities based on hello value of another non-unique property, such as their last name, you must use a less efficient partition scan toofind matches rather than using an index toolook them up directly.</span></span> <span data-ttu-id="4269a-584">Это так, как служба таблиц hello не поддерживает вторичные индексы.</span><span class="sxs-lookup"><span data-stu-id="4269a-584">This is because hello table service does not provide secondary indexes.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-585">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-585">Solution</span></span>
<span data-ttu-id="4269a-586">Просмотр tooenable по фамилии со структурой сущности hello, показанном выше, необходимо поддерживать списки идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="4269a-586">tooenable lookup by last name with hello entity structure shown above, you must maintain lists of employee ids.</span></span> <span data-ttu-id="4269a-587">Если требуется, чтобы сущности employee hello tooretrieve с определенной фамилией, например Джонс, сначала найдите hello список идентификаторов для сотрудников с Джонс как фамилии и затем извлечь эти сущности employee.</span><span class="sxs-lookup"><span data-stu-id="4269a-587">If you want tooretrieve hello employee entities with a particular last name, such as Jones, you must first locate hello list of employee ids for employees with Jones as their last name, and then retrieve those employee entities.</span></span> <span data-ttu-id="4269a-588">Существует три основных варианта для хранения hello списки идентификаторов:</span><span class="sxs-lookup"><span data-stu-id="4269a-588">There are three main options for storing hello lists of employee ids:</span></span>  

* <span data-ttu-id="4269a-589">Использование хранилища больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="4269a-589">Use blob storage.</span></span>  
* <span data-ttu-id="4269a-590">Создание индекса сущностей в hello же секции как сущности employee hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-590">Create index entities in hello same partition as hello employee entities.</span></span>  
* <span data-ttu-id="4269a-591">Создание сущностей индексов в отдельном разделе или таблице.</span><span class="sxs-lookup"><span data-stu-id="4269a-591">Create index entities in a separate partition or table.</span></span>  

<span data-ttu-id="4269a-592"><u>Вариант № 1. Использование хранилища больших двоичных объектов</u></span><span class="sxs-lookup"><span data-stu-id="4269a-592"><u>Option #1: Use blob storage</u></span></span>  

<span data-ttu-id="4269a-593">Для первого параметра hello, создании большого двоичного объекта для каждого уникальный фамилии и в каждом хранилище больших двоичных объектов список hello **PartitionKey** (отдел) и **RowKey** (идентификатор сотрудника) значений для сотрудников, имеющих то последнего имя.</span><span class="sxs-lookup"><span data-stu-id="4269a-593">For hello first option, you create a blob for every unique last name, and in each blob store a list of hello **PartitionKey** (department) and **RowKey** (employee id) values for employees that have that last name.</span></span> <span data-ttu-id="4269a-594">При добавлении или удалении сотрудник следует убедиться, что hello содержимое hello соответствующие большого двоичного объекта является согласованным с сущности employee hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-594">When you add or delete an employee you should ensure that hello content of hello relevant blob is eventually consistent with hello employee entities.</span></span>  

<span data-ttu-id="4269a-595"><u>Параметр #2:</u> Здравствуйте, создание индекса сущностей в одной секции</span><span class="sxs-lookup"><span data-stu-id="4269a-595"><u>Option #2:</u> Create index entities in hello same partition</span></span>  

<span data-ttu-id="4269a-596">Второй параметр hello при помощи индекса сущностей, хранящих hello следующие данные:</span><span class="sxs-lookup"><span data-stu-id="4269a-596">For hello second option, use index entities that store hello following data:</span></span>  

![][14]

<span data-ttu-id="4269a-597">Hello **EmployeeIDs** свойство содержит список идентификаторов для сотрудников с фамилией hello хранятся в hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-597">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="4269a-598">Hello ниже описывается процесс hello, которые необходимо выполнить при добавлении нового сотрудника при использовании hello второй вариант.</span><span class="sxs-lookup"><span data-stu-id="4269a-598">hello following steps outline hello process you should follow when you are adding a new employee if you are using hello second option.</span></span> <span data-ttu-id="4269a-599">В этом примере мы добавляем сотрудника с идентификатором 000152 и фамилию Джонс отдела продаж hello:</span><span class="sxs-lookup"><span data-stu-id="4269a-599">In this example, we are adding an employee with Id 000152 and a last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="4269a-600">Получить сущность hello индекса с **PartitionKey** значение «Sales» и hello **RowKey** значение «Иванов».</span><span class="sxs-lookup"><span data-stu-id="4269a-600">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span> <span data-ttu-id="4269a-601">Сохраните hello ETag toouse этой сущности на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="4269a-601">Save hello ETag of this entity toouse in step 2.</span></span>  
2. <span data-ttu-id="4269a-602">Создание транзакции группы сущностей (то есть пакетной операции), вставляет новую сущность employee hello (**PartitionKey** значение «Sales» и **RowKey** значение «000152»), и индекс сущности (helloобновлений **PartitionKey** значение «Sales» и **RowKey** значение «Иванов»), добавив hello нового сотрудника идентификатор toohello списка в поле EmployeeIDs hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-602">Create an entity group transaction (that is, a batch operation) that inserts hello new employee entity (**PartitionKey** value "Sales" and **RowKey** value "000152"), and updates hello index entity (**PartitionKey** value "Sales" and **RowKey** value "Jones") by adding hello new employee id toohello list in hello EmployeeIDs field.</span></span> <span data-ttu-id="4269a-603">Сведения о транзакциях группы сущностей см. в разделе [Транзакции группы сущностей](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="4269a-603">For more information about entity group transactions, see [Entity Group Transactions](#entity-group-transactions).</span></span>  
3. <span data-ttu-id="4269a-604">Если транзакция группы сущностей hello завершается ошибкой из-за ошибки оптимистичного параллелизма (только что другой пользователь изменил hello индекс сущности), затем понадобятся toostart через на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="4269a-604">If hello entity group transaction fails because of an optimistic concurrency error (someone else has just modified hello index entity), then you need toostart over at step 1 again.</span></span>  

<span data-ttu-id="4269a-605">При использовании hello второй вариант, можно использовать аналогичные toodeleting подход сотрудника.</span><span class="sxs-lookup"><span data-stu-id="4269a-605">You can use a similar approach toodeleting an employee if you are using hello second option.</span></span> <span data-ttu-id="4269a-606">Изменение последнего имени сотрудника немного сложнее, поскольку его нужно будет tooexecute транзакция группы сущностей, который обновляет три сущности: hello сущности employee hello индекс сущности для старого фамилии hello и сущность hello индекса для hello фамилию.</span><span class="sxs-lookup"><span data-stu-id="4269a-606">Changing an employee's last name is slightly more complex because you will need tooexecute an entity group transaction that updates three entities: hello employee entity, hello index entity for hello old last name, and hello index entity for hello new last name.</span></span> <span data-ttu-id="4269a-607">Каждая сущность должна получать перед внесением любых изменений в порядке значений ETag hello tooretrieve, можно затем использовать обновления tooperform hello, опираясь на оптимистичный параллелизм.</span><span class="sxs-lookup"><span data-stu-id="4269a-607">You must retrieve each entity before making any changes in order tooretrieve hello ETag values that you can then use tooperform hello updates using optimistic concurrency.</span></span>  

<span data-ttu-id="4269a-608">Hello ниже описывается процесс hello, которые необходимо выполнить при необходимости toolook копирование всех сотрудников hello с заданной фамилией отдела при использовании hello второй вариант.</span><span class="sxs-lookup"><span data-stu-id="4269a-608">hello following steps outline hello process you should follow when you need toolook up all hello employees with a given last name in a department if you are using hello second option.</span></span> <span data-ttu-id="4269a-609">В этом примере осуществляется поиск всех сотрудников hello Фамилия Джонс отдела продаж hello:</span><span class="sxs-lookup"><span data-stu-id="4269a-609">In this example, we are looking up all hello employees with last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="4269a-610">Получить сущность hello индекса с **PartitionKey** значение «Sales» и hello **RowKey** значение «Иванов».</span><span class="sxs-lookup"><span data-stu-id="4269a-610">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span>  
2. <span data-ttu-id="4269a-611">Синтаксический анализ списка hello коды в поле EmployeeIDs hello сотрудников.</span><span class="sxs-lookup"><span data-stu-id="4269a-611">Parse hello list of employee Ids in hello EmployeeIDs field.</span></span>  
3. <span data-ttu-id="4269a-612">Если требуются дополнительные сведения о каждом из этих сотрудников (например, адреса электронной почты), извлекать каждой сущности employee hello с помощью **PartitionKey** значение «Sales» и **RowKey** значения из Hello список сотрудников, полученный на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="4269a-612">If you need additional information about each of these employees (such as their email addresses), retrieve each of hello employee entities using **PartitionKey** value "Sales" and **RowKey** values from hello list of employees you obtained in step 2.</span></span>  

<span data-ttu-id="4269a-613"><u>Вариант 3.</u> Создание сущностей индексов в отдельном разделе или таблице</span><span class="sxs-lookup"><span data-stu-id="4269a-613"><u>Option #3:</u> Create index entities in a separate partition or table</span></span>  

<span data-ttu-id="4269a-614">Третий вариант hello при помощи индекса сущностей, хранящих hello следующие данные:</span><span class="sxs-lookup"><span data-stu-id="4269a-614">For hello third option, use index entities that store hello following data:</span></span>  

![][15]

<span data-ttu-id="4269a-615">Hello **EmployeeIDs** свойство содержит список идентификаторов для сотрудников с фамилией hello хранятся в hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-615">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="4269a-616">Третий параметр hello нельзя использовать EGTs toomaintain согласованности, поскольку hello индекс сущности находятся в отдельной секции из сущности employee hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-616">With hello third option, you cannot use EGTs toomaintain consistency because hello index entities are in a separate partition from hello employee entities.</span></span> <span data-ttu-id="4269a-617">Следует убедиться, что hello индекс сущности являются согласованным с сущности employee hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-617">You should ensure that hello index entities are eventually consistent with hello employee entities.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-618">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-618">Issues and considerations</span></span>
<span data-ttu-id="4269a-619">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-619">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-620">Это решение требует по крайней мере два запроса tooretrieve сопоставления сущностей: один tooquery hello индекс сущности tooobtain hello список **RowKey** значения, а затем отправляется запрос tooretrieve каждой сущности в списке hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-620">This solution requires at least two queries tooretrieve matching entities: one tooquery hello index entities tooobtain hello list of **RowKey** values, and then queries tooretrieve each entity in hello list.</span></span>  
* <span data-ttu-id="4269a-621">Учитывая, что отдельной сущности не может превышать 1 МБ, параметр #2, и параметр #3 в решении hello предполагается hello список идентификаторов для данной фамилии больше никогда не превышает 1 МБ.</span><span class="sxs-lookup"><span data-stu-id="4269a-621">Given that an individual entity has a maximum size of 1 MB, option #2 and option #3 in hello solution assume that hello list of employee ids for any given last name is never greater than 1 MB.</span></span> <span data-ttu-id="4269a-622">Если список идентификаторов hello скорее всего, toobe больше 1 МБ, используйте параметр #1 и хранения данных индекса hello в хранилище больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="4269a-622">If hello list of employee ids is likely toobe greater than 1 MB in size, use option #1 and store hello index data in blob storage.</span></span>  
* <span data-ttu-id="4269a-623">Если используется параметр #2 (с помощью toohandle EGTs Добавление и удаление сотрудников и изменение последнего имени сотрудника), необходимо определить Если hello объема транзакций будет достигнута ограничения масштабируемости hello в данной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-623">If you use option #2 (using EGTs toohandle adding and deleting employees, and changing an employee's last name) you must evaluate if hello volume of transactions will approach hello scalability limits in a given partition.</span></span> <span data-ttu-id="4269a-624">Если это так hello, следует рассмотреть согласованным решения (параметр #1 или параметр #3), которые используют обновление hello toohandle очередей запросов и позволяет вам toostore индекс сущностей в отдельной секции из сущности employee hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-624">If this is hello case, you should consider an eventually consistent solution (option #1 or option #3) that uses queues toohandle hello update requests and enables you toostore your index entities in a separate partition from hello employee entities.</span></span>  
* <span data-ttu-id="4269a-625">Параметр #2, в этом решении предполагается требуется toolook по фамилиям в отделе: например, вы хотите tooretrieve список сотрудников с фамилией Джонс hello отдела продаж.</span><span class="sxs-lookup"><span data-stu-id="4269a-625">Option #2 in this solution assumes that you want toolook up by last name within a department: for example, you want tooretrieve a list of employees with a last name Jones in hello Sales department.</span></span> <span data-ttu-id="4269a-626">Возможности toolook toobe копирование всех hello сотрудников с фамилией Джонс hello всей организации, используйте параметр #1 или параметр #3.</span><span class="sxs-lookup"><span data-stu-id="4269a-626">If you want toobe able toolook up all hello employees with a last name Jones across hello whole organization, use either option #1 or option #3.</span></span>
* <span data-ttu-id="4269a-627">Можно реализовать решение на основе очереди, обеспечивающая окончательной согласованности (hello в разделе [шаблон согласованным транзакции](#eventually-consistent-transactions-pattern) Дополнительные сведения).</span><span class="sxs-lookup"><span data-stu-id="4269a-627">You can implement a queue-based solution that delivers eventual consistency (see hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) for more details).</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-628">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-628">When toouse this pattern</span></span>
<span data-ttu-id="4269a-629">Используйте этот шаблон при необходимости toolookup набора сущностей, что все используют общее значение свойства, например всех сотрудников с фамилией hello Джонс.</span><span class="sxs-lookup"><span data-stu-id="4269a-629">Use this pattern when you want toolookup a set of entities that all share a common property value, such as all employees with hello last name Jones.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-630">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-630">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-631">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-631">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-632">Шаблон составного ключа;</span><span class="sxs-lookup"><span data-stu-id="4269a-632">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4269a-633">Шаблон для согласованных транзакций;</span><span class="sxs-lookup"><span data-stu-id="4269a-633">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="4269a-634">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-634">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4269a-635">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-635">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="denormalization-pattern"></a><span data-ttu-id="4269a-636">Шаблон денормализации</span><span class="sxs-lookup"><span data-stu-id="4269a-636">Denormalization pattern</span></span>
<span data-ttu-id="4269a-637">Объединение взаимосвязанные данные вместе в одной сущности tooenable tooretrieve все hello необходимо с помощью запроса одной точки данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-637">Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-638">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-638">Context and problem</span></span>
<span data-ttu-id="4269a-639">В реляционной базе данных обычно нормализовать tooremove дублирования данных, что приводит к запросы, получающие данные из нескольких таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-639">In a relational database, you typically normalize data tooremove duplication resulting in queries that retrieve data from multiple tables.</span></span> <span data-ttu-id="4269a-640">Если вы нормализовать данные в таблицах Azure, необходимо несколько циклов приема-передачи из hello клиента toohello сервера tooretrieve связанные данные.</span><span class="sxs-lookup"><span data-stu-id="4269a-640">If you normalize your data in Azure tables, you must make multiple round trips from hello client toohello server tooretrieve your related data.</span></span> <span data-ttu-id="4269a-641">Например, с табличной структурой hello, приведенные ниже, то требуется два округления приема-передачи tooretrieve hello подробные сведения об отделе: один toofetch hello отдел сущность, которая содержит идентификатор менеджера hello и еще один запрос toofetch hello manager сведения в сотрудника сущность.</span><span class="sxs-lookup"><span data-stu-id="4269a-641">For example, with hello table structure shown below you need two round trips tooretrieve hello details for a department: one toofetch hello department entity that includes hello manager's id, and then another request toofetch hello manager's details in an employee entity.</span></span>  

![][16]

#### <a name="solution"></a><span data-ttu-id="4269a-642">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-642">Solution</span></span>
<span data-ttu-id="4269a-643">Вместо сохранения данных hello в двумя отдельными сущностями, денормализации hello данных и хранить копию сведения диспетчера hello в сущность department hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-643">Instead of storing hello data in two separate entities, denormalize hello data and keep a copy of hello manager's details in hello department entity.</span></span> <span data-ttu-id="4269a-644">Например:</span><span class="sxs-lookup"><span data-stu-id="4269a-644">For example:</span></span>  

![][17]

<span data-ttu-id="4269a-645">С сущностями отдела, хранимые с этими свойствами теперь можно получить все hello сведения, необходимые о отдела, с использованием запроса точки.</span><span class="sxs-lookup"><span data-stu-id="4269a-645">With department entities stored with these properties, you can now retrieve all hello details you need about a department using a point query.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-646">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-646">Issues and considerations</span></span>
<span data-ttu-id="4269a-647">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-647">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-648">Двойное хранение некоторых данных связано с определенными издержками.</span><span class="sxs-lookup"><span data-stu-id="4269a-648">There is some cost overhead associated with storing some data twice.</span></span> <span data-ttu-id="4269a-649">Hello производительность (полученный из службы хранилища toohello меньшее число запросов) обычно перевешивает hello граничной увеличение затрат на хранение (и затрат частично смещение по снижению hello количество транзакций требуются сведения toofetch hello отдела).</span><span class="sxs-lookup"><span data-stu-id="4269a-649">hello performance benefit (resulting from fewer requests toohello storage service) typically outweighs hello marginal increase in storage costs (and this cost is partially offset by a reduction in hello number of transactions you require toofetch hello details of a department).</span></span>  
* <span data-ttu-id="4269a-650">Необходимо поддерживать согласованность hello две сущности, которые хранят сведения о диспетчерах hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-650">You must maintain hello consistency of hello two entities that store information about managers.</span></span> <span data-ttu-id="4269a-651">Можно обработать hello проблемы согласованности с помощью EGTs tooupdate несколько сущностей в одной атомарной транзакции: в этом случае сущность department hello и сущности employee hello для отдела hello хранятся в hello одной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-651">You can handle hello consistency issue by using EGTs tooupdate multiple entities in a single atomic transaction: in this case, hello department entity, and hello employee entity for hello department manager are stored in hello same partition.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-652">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-652">When toouse this pattern</span></span>
<span data-ttu-id="4269a-653">Используйте этот шаблон, если необходимо часто toolook связанные сведения.</span><span class="sxs-lookup"><span data-stu-id="4269a-653">Use this pattern when you frequently need toolook up related information.</span></span> <span data-ttu-id="4269a-654">Этот шаблон уменьшает количество запросов к клиенту необходимо выполнять tooretrieve hello данные, которые требуются в hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-654">This pattern reduces hello number of queries your client must make tooretrieve hello data it requires.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-655">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-655">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-656">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-656">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-657">Шаблон составного ключа;</span><span class="sxs-lookup"><span data-stu-id="4269a-657">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4269a-658">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-658">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4269a-659">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-659">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="compound-key-pattern"></a><span data-ttu-id="4269a-660">Шаблон составного ключа</span><span class="sxs-lookup"><span data-stu-id="4269a-660">Compound key pattern</span></span>
<span data-ttu-id="4269a-661">Использование составного **RowKey** tooenable значения toolookup клиента связанные данные с помощью запроса одной точки.</span><span class="sxs-lookup"><span data-stu-id="4269a-661">Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-662">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-662">Context and problem</span></span>
<span data-ttu-id="4269a-663">В реляционной базе данных, это вполне естественным toouse соединения в запросах tooreturn связанные фрагменты данных toohello клиента в одном запросе.</span><span class="sxs-lookup"><span data-stu-id="4269a-663">In a relational database, it is quite natural toouse joins in queries tooreturn related pieces of data toohello client in a single query.</span></span> <span data-ttu-id="4269a-664">Например можно использовать toolook идентификатор сотрудника hello список связанных сущностей, которые содержат производительности и просмотреть данные для этого сотрудника.</span><span class="sxs-lookup"><span data-stu-id="4269a-664">For example, you might use hello employee id toolook up a list of related entities that contain performance and review data for that employee.</span></span>  

<span data-ttu-id="4269a-665">Предположим, что сущности employee хранятся в службе таблиц hello через hello следующая структура:</span><span class="sxs-lookup"><span data-stu-id="4269a-665">Assume you are storing employee entities in hello Table service using hello following structure:</span></span>  

![][18]

<span data-ttu-id="4269a-666">Необходимо также toostore исторические данные, связанные с tooreviews и производительности для каждого сотрудника hello года работал для вашей организации и может tooaccess toobe эти сведения понадобятся по годам.</span><span class="sxs-lookup"><span data-stu-id="4269a-666">You also need toostore historical data relating tooreviews and performance for each year hello employee has worked for your organization and you need toobe able tooaccess this information by year.</span></span> <span data-ttu-id="4269a-667">Один из вариантов является toocreate другую таблицу для хранения сущностей с hello следующие структуры:</span><span class="sxs-lookup"><span data-stu-id="4269a-667">One option is toocreate another table that stores entities with hello following structure:</span></span>  

![][19]

<span data-ttu-id="4269a-668">Обратите внимание, что с этим подход, вы можете решить tooduplicate некоторые сведения (такие как имя и фамилия) в новый сущности tooenable hello вы tooretrieve данных с помощью одного запроса.</span><span class="sxs-lookup"><span data-stu-id="4269a-668">Notice that with this approach you may decide tooduplicate some information (such as first name and last name) in hello new entity tooenable you tooretrieve your data with a single request.</span></span> <span data-ttu-id="4269a-669">Тем не менее не может поддерживать строгая согласованность, так как нельзя использовать tooupdate EGT hello две сущности атомарным образом.</span><span class="sxs-lookup"><span data-stu-id="4269a-669">However, you cannot maintain strong consistency because you cannot use an EGT tooupdate hello two entities atomically.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-670">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-670">Solution</span></span>
<span data-ttu-id="4269a-671">Сохранить новый тип сущности в исходной таблице с помощью сущностей с hello следующие структуры:</span><span class="sxs-lookup"><span data-stu-id="4269a-671">Store a new entity type in your original table using entities with hello following structure:</span></span>  

![][20]

<span data-ttu-id="4269a-672">Обратите внимание, каким образом hello **RowKey** теперь используется составной ключ состоит из идентификатор сотрудника hello и год hello hello проверку данных, позволяющая tooretrieve hello производительности сотрудника и просматривать данные с помощью одного запроса для одной сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-672">Notice how hello **RowKey** is now a compound key made up of hello employee id and hello year of hello review data that enables you tooretrieve hello employee's performance and review data with a single request for a single entity.</span></span>  

<span data-ttu-id="4269a-673">Следующий пример Hello описаны как можно получить все данные для проверки hello для конкретного сотрудника (например, сотрудник 000123 hello отдела продаж).</span><span class="sxs-lookup"><span data-stu-id="4269a-673">hello following example outlines how you can retrieve all hello review data for a particular employee (such as employee 000123 in hello Sales department):</span></span>  

<span data-ttu-id="4269a-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span><span class="sxs-lookup"><span data-stu-id="4269a-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-675">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-675">Issues and considerations</span></span>
<span data-ttu-id="4269a-676">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-676">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-677">Следует использовать подходящий разделитель, который позволяет легко tooparse hello **RowKey** значение: например, **000123_2012**.</span><span class="sxs-lookup"><span data-stu-id="4269a-677">You should use a suitable separator character that makes it easy tooparse hello **RowKey** value: for example, **000123_2012**.</span></span>  
* <span data-ttu-id="4269a-678">Также сохранении этой сущности в секции таким же как другие сущности, содержащие соответствующие данные для hello hello же сотрудника, то есть можно использовать EGTs toomaintain строгая согласованность.</span><span class="sxs-lookup"><span data-stu-id="4269a-678">You are also storing this entity in hello same partition as other entities that contain related data for hello same employee, which means you can use EGTs toomaintain strong consistency.</span></span>
* <span data-ttu-id="4269a-679">Следует учитывать, как часто будет запрашивать данные toodetermine hello целесообразность этот шаблон.</span><span class="sxs-lookup"><span data-stu-id="4269a-679">You should consider how frequently you will query hello data toodetermine whether this pattern is appropriate.</span></span>  <span data-ttu-id="4269a-680">Например если вы получите доступ к редко hello данные для проверки и hello основные данные о сотрудниках часто следует сохранять их как отдельные сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-680">For example, if you will access hello review data infrequently and hello main employee data often you should keep them as separate entities.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-681">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-681">When toouse this pattern</span></span>
<span data-ttu-id="4269a-682">Эта схема используется в том случае, когда требуется toostore одного или нескольких связанных сущностей запросе часто.</span><span class="sxs-lookup"><span data-stu-id="4269a-682">Use this pattern when you need toostore one or more related entities that you query frequently.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-683">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-683">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-684">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-684">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-685">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-685">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4269a-686">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-686">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  
* [<span data-ttu-id="4269a-687">Шаблон для согласованных транзакций;</span><span class="sxs-lookup"><span data-stu-id="4269a-687">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  

### <a name="log-tail-pattern"></a><span data-ttu-id="4269a-688">Шаблон для заключительного фрагмента журнала</span><span class="sxs-lookup"><span data-stu-id="4269a-688">Log tail pattern</span></span>
<span data-ttu-id="4269a-689">Получить hello  *n*  сущностей недавно добавленную секцию tooa с помощью **RowKey** значение, которое сортирует в обратную даты и времени заказа.</span><span class="sxs-lookup"><span data-stu-id="4269a-689">Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-690">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-690">Context and problem</span></span>
<span data-ttu-id="4269a-691">Распространенным требованием является быть может tooretrieve hello последний созданный сущностей, например hello 10 последних заявки на компенсацию расходов переданный сотрудником.</span><span class="sxs-lookup"><span data-stu-id="4269a-691">A common requirement is be able tooretrieve hello most recently created entities, for example hello ten most recent expense claims submitted by an employee.</span></span> <span data-ttu-id="4269a-692">Таблица запросов, поддерживающих **$top** сначала запросить hello tooreturn операции  *n*  сущностей из набора: нет эквивалентный запрос операции tooreturn hello последние n сущностей в наборе.</span><span class="sxs-lookup"><span data-stu-id="4269a-692">Table queries support a **$top** query operation tooreturn hello first *n* entities from a set: there is no equivalent query operation tooreturn hello last n entities in a set.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-693">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-693">Solution</span></span>
<span data-ttu-id="4269a-694">Хранилище hello сущностей с помощью **RowKey** , естественным образом Сортировка в обратном направлении даты и времени заказа с помощью так hello самую последнюю запись всегда hello первый в таблице hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-694">Store hello entities using a **RowKey** that naturally sorts in reverse date/time order by using so hello most recent entry is always hello first one in hello table.</span></span>  

<span data-ttu-id="4269a-695">Например может tooretrieve toobe Здравствуйте 10 последних заявки на компенсацию расходов переданный сотрудником, можно использовать значение обратного тактов, производным от hello текущую дату и время.</span><span class="sxs-lookup"><span data-stu-id="4269a-695">For example, toobe able tooretrieve hello ten most recent expense claims submitted by an employee, you can use a reverse tick value derived from hello current date/time.</span></span> <span data-ttu-id="4269a-696">Hello следующий код C# показывает один из способов toocreate подходящее значение «инвертированный тактов» для **RowKey** , сортирует от последней toohello hello старой:</span><span class="sxs-lookup"><span data-stu-id="4269a-696">hello following C# code sample shows one way toocreate a suitable "inverted ticks" value for a **RowKey** that sorts from hello most recent toohello oldest:</span></span>  

`string invertedTicks = string.Format("{0:D19}", DateTime.MaxValue.Ticks - DateTime.UtcNow.Ticks);`  

<span data-ttu-id="4269a-697">Вы можете вернуться toohello значение даты и времени с помощью hello, следующий код:</span><span class="sxs-lookup"><span data-stu-id="4269a-697">You can get back toohello date time value using hello following code:</span></span>  

`DateTime dt = new DateTime(DateTime.MaxValue.Ticks - Int64.Parse(invertedTicks));`  

<span data-ttu-id="4269a-698">Таблица Hello запрос выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4269a-698">hello table query looks like this:</span></span>  

`https://myaccount.table.core.windows.net/EmployeeExpense(PartitionKey='empid')?$top=10`  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-699">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-699">Issues and considerations</span></span>
<span data-ttu-id="4269a-700">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-700">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-701">Необходимо заполнить значение обратного тактов hello в начале нулями сортирует tooensure hello строковое значение.</span><span class="sxs-lookup"><span data-stu-id="4269a-701">You must pad hello reverse tick value with leading zeroes tooensure hello string value sorts as expected.</span></span>  
* <span data-ttu-id="4269a-702">Следует иметь в виду hello целей масштабируемость на уровне hello секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-702">You must be aware of hello scalability targets at hello level of a partition.</span></span> <span data-ttu-id="4269a-703">Не создайте разделы с высокой нагрузкой.</span><span class="sxs-lookup"><span data-stu-id="4269a-703">Be careful not create hot spot partitions.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-704">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-704">When toouse this pattern</span></span>
<span data-ttu-id="4269a-705">Используйте этот шаблон при необходимости tooaccess сущностей в порядке, обратном даты и времени, а также при необходимости tooaccess hello недавно добавлено сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-705">Use this pattern when you need tooaccess entities in reverse date/time order or when you need tooaccess hello most recently added entities.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-706">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-706">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-707">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-707">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-708">Анти-шаблон, предусматривающий добавление в начало или конец;</span><span class="sxs-lookup"><span data-stu-id="4269a-708">Prepend / append anti-pattern</span></span>](#prepend-append-anti-pattern)  
* [<span data-ttu-id="4269a-709">Извлечение сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-709">Retrieving entities</span></span>](#retrieving-entities)  

### <a name="high-volume-delete-pattern"></a><span data-ttu-id="4269a-710">Шаблон для удаления больших объемов сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-710">High volume delete pattern</span></span>
<span data-ttu-id="4269a-711">Включить удаление hello слишком большое количество сущностей, сохраняя все сущности hello для одновременного удаления в своих собственных отдельную таблицу; Удалить сущности hello, удалив таблицы hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-711">Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-712">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-712">Context and problem</span></span>
<span data-ttu-id="4269a-713">Во многих приложениях удалить старые данные, которые больше не нужна toobe доступных tooa клиентское приложение или приложение hello архивации tooanother носитель.</span><span class="sxs-lookup"><span data-stu-id="4269a-713">Many applications delete old data which no longer needs toobe available tooa client application, or that hello application has archived tooanother storage medium.</span></span> <span data-ttu-id="4269a-714">Обычно необходимо указать такие данные по дате: например, имеется требование записи toodelete все запросы на вход, не более 60 дней.</span><span class="sxs-lookup"><span data-stu-id="4269a-714">You typically identify such data by a date: for example, you have a requirement toodelete records of all login requests that are more than 60 days old.</span></span>  

<span data-ttu-id="4269a-715">Один из возможных является toouse hello даты и времени запроса входа hello в hello **RowKey**:</span><span class="sxs-lookup"><span data-stu-id="4269a-715">One possible design is toouse hello date and time of hello login request in hello **RowKey**:</span></span>  

![][21]

<span data-ttu-id="4269a-716">Такой подход позволяет избежать гиперобъекты секции, так как приложение hello можно вставки и удаления сущностей имя входа для каждого пользователя в отдельной секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-716">This approach avoids partition hotspots because hello application can insert and delete login entities for each user in a separate partition.</span></span> <span data-ttu-id="4269a-717">Однако этот подход может быть дорогостоящей и много времени при наличии большого числа сущностей, поскольку сначала его нужно tooperform просмотра таблиц в порядке tooidentify все toodelete сущностей hello и удалите каждый старая сущность.</span><span class="sxs-lookup"><span data-stu-id="4269a-717">However, this approach may be costly and time consuming if you have a large number of entities because first you need tooperform a table scan in order tooidentify all hello entities toodelete, and then you must delete each old entity.</span></span> <span data-ttu-id="4269a-718">Обратите внимание, что можно уменьшить hello количество циклов приема-передачи toohello сервере требуется toodelete hello старого сущностей, пакетное выполнение нескольких запросов на удаление в EGTs.</span><span class="sxs-lookup"><span data-stu-id="4269a-718">Note that you can reduce hello number of round trips toohello server required toodelete hello old entities by batching multiple delete requests into EGTs.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-719">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-719">Solution</span></span>
<span data-ttu-id="4269a-720">Используйте отдельную таблицу для каждого дня, когда предпринимаются попытки входа с систему.</span><span class="sxs-lookup"><span data-stu-id="4269a-720">Use a separate table for each day of login attempts.</span></span> <span data-ttu-id="4269a-721">Конструктора сущностей hello выше tooavoid точки беспроводного доступа можно использовать при вставке сущности и удаление старого сущностей теперь является просто вопрос удаления одну таблицу каждый день (одна операция сохранения) вместо поиск и удаление сотен и тысяч сущности отдельного имени входа каждый день.</span><span class="sxs-lookup"><span data-stu-id="4269a-721">You can use hello entity design above tooavoid hotspots when you are inserting entities, and deleting old entities is now simply a question of deleting one table every day (a single storage operation) instead of finding and deleting hundreds and thousands of individual login entities every day.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-722">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-722">Issues and considerations</span></span>
<span data-ttu-id="4269a-723">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-723">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-724">Проект поддерживает другие возможности, приложение будет использовать данные hello, например поиск определенных сущностей, связывание с другими данными или создания статистические данные?</span><span class="sxs-lookup"><span data-stu-id="4269a-724">Does your design support other ways your application will use hello data such as looking up specific entities, linking with other data, or generating aggregate information?</span></span>  
* <span data-ttu-id="4269a-725">Ваш проект предотвращает формирование активных областей в случае вставки новых сущностей?</span><span class="sxs-lookup"><span data-stu-id="4269a-725">Does your design avoid hot spots when you are inserting new entities?</span></span>  
* <span data-ttu-id="4269a-726">Ожидается, что задержка, если требуется, чтобы tooreuse hello таким же именем таблицы после его удаления.</span><span class="sxs-lookup"><span data-stu-id="4269a-726">Expect a delay if you want tooreuse hello same table name after deleting it.</span></span> <span data-ttu-id="4269a-727">Это лучше tooalways используйте уникальными именами таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-727">It's better tooalways use unique table names.</span></span>  
* <span data-ttu-id="4269a-728">Ожидается, что некоторые регулирование во время первого использования новой таблицы при hello службы таблиц узнает шаблоны доступа к hello и распределяет секции hello по узлам.</span><span class="sxs-lookup"><span data-stu-id="4269a-728">Expect some throttling when you first use a new table while hello Table service learns hello access patterns and distributes hello partitions across nodes.</span></span> <span data-ttu-id="4269a-729">Рассмотрите, как часто требуется toocreate новых таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-729">You should consider how frequently you need toocreate new tables.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-730">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-730">When toouse this pattern</span></span>
<span data-ttu-id="4269a-731">Используйте этот шаблон, если выполняется большое количество сущностей, которые необходимо удалить в hello то же время.</span><span class="sxs-lookup"><span data-stu-id="4269a-731">Use this pattern when you have a high volume of entities that you must delete at hello same time.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-732">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-732">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-733">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-733">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-734">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-734">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="4269a-735">Изменение сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-735">Modifying entities</span></span>](#modifying-entities)  

### <a name="data-series-pattern"></a><span data-ttu-id="4269a-736">Шаблон для рядов данных</span><span class="sxs-lookup"><span data-stu-id="4269a-736">Data series pattern</span></span>
<span data-ttu-id="4269a-737">Хранилище полные данные ряда в нескольких запросов к одной сущности toominimize hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-737">Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-738">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-738">Context and problem</span></span>
<span data-ttu-id="4269a-739">Типичный сценарий предназначен для приложения toostore ряд данных, что обычно требуется tooretrieve за один раз.</span><span class="sxs-lookup"><span data-stu-id="4269a-739">A common scenario is for an application toostore a series of data that it typically needs tooretrieve all at once.</span></span> <span data-ttu-id="4269a-740">Например приложение может записи сколько Мгновенных сообщений, каждый час отправляет каждого сотрудника и затем использовать этот tooplot сведения, сколько сообщений, передаваемых каждого пользователя hello предыдущим 24 часам.</span><span class="sxs-lookup"><span data-stu-id="4269a-740">For example, your application might record how many IM messages each employee sends every hour, and then use this information tooplot how many messages each user sent over hello preceding 24 hours.</span></span> <span data-ttu-id="4269a-741">Один конструктор может быть toostore 24 сущностей для каждого сотрудника.</span><span class="sxs-lookup"><span data-stu-id="4269a-741">One design might be toostore 24 entities for each employee:</span></span>  

![][22]

<span data-ttu-id="4269a-742">Такой подход можно легко найти и обновить tooupdate hello сущности для каждого сотрудника, всякий раз, когда значение счетчика сообщение hello tooupdate необходимые приложения hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-742">With this design, you can easily locate and update hello entity tooupdate for each employee whenever hello application needs tooupdate hello message count value.</span></span> <span data-ttu-id="4269a-743">Тем не менее tooretrieve Здравствуйте сведения tooplot диаграмму активности hello для hello, последние 24 часа, необходимо получить 24 сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-743">However, tooretrieve hello information tooplot a chart of hello activity for hello preceding 24 hours, you must retrieve 24 entities.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-744">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-744">Solution</span></span>
<span data-ttu-id="4269a-745">Используйте следующие конструктора с числом сообщение hello toostore отдельные свойства для каждого часа hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-745">Use hello following design with a separate property toostore hello message count for each hour:</span></span>  

![][23]

<span data-ttu-id="4269a-746">Такой подход можно использовать сообщения число tooupdate hello слияния операций для сотрудника для определенное время.</span><span class="sxs-lookup"><span data-stu-id="4269a-746">With this design, you can use a merge operation tooupdate hello message count for an employee for a specific hour.</span></span> <span data-ttu-id="4269a-747">Теперь можно получить все сведения hello необходимы tooplot hello диаграммы с помощью запроса одной сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-747">Now, you can retrieve all hello information you need tooplot hello chart using a request for a single entity.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-748">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-748">Issues and considerations</span></span>
<span data-ttu-id="4269a-749">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-749">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-750">Если ряды полные данные не помещаются в одну сущность (сущность может иметь свойства too252), используйте в альтернативном хранилище данных как большого двоичного объекта.</span><span class="sxs-lookup"><span data-stu-id="4269a-750">If your complete data series does not fit into a single entity (an entity can have up too252 properties), use an alternative data store such as a blob.</span></span>  
* <span data-ttu-id="4269a-751">Если у вас есть несколько клиентов одновременно обновление сущности, вам потребуется toouse hello **ETag** tooimplement оптимистичного параллелизма.</span><span class="sxs-lookup"><span data-stu-id="4269a-751">If you have multiple clients updating an entity simultaneously, you will need toouse hello **ETag** tooimplement optimistic concurrency.</span></span> <span data-ttu-id="4269a-752">Большое количество клиентов может привести к высокому уровню конкуренции.</span><span class="sxs-lookup"><span data-stu-id="4269a-752">If you have many clients, you may experience high contention.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-753">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-753">When toouse this pattern</span></span>
<span data-ttu-id="4269a-754">Эта схема используется в том случае, когда необходима tooupdate и получить ряд данных, связанных с отдельной сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-754">Use this pattern when you need tooupdate and retrieve a data series associated with an individual entity.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-755">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-755">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-756">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-756">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-757">Шаблон для сущностей больших размеров</span><span class="sxs-lookup"><span data-stu-id="4269a-757">Large entities pattern</span></span>](#large-entities-pattern)  
* [<span data-ttu-id="4269a-758">Объединение или замена.</span><span class="sxs-lookup"><span data-stu-id="4269a-758">Merge or replace</span></span>](#merge-or-replace)  
* <span data-ttu-id="4269a-759">[Шаблон согласованным транзакции](#eventually-consistent-transactions-pattern) (при сохранении hello ряда данных в большой двоичный объект)</span><span class="sxs-lookup"><span data-stu-id="4269a-759">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) (if you are storing hello data series in a blob)</span></span>  

### <a name="wide-entities-pattern"></a><span data-ttu-id="4269a-760">Шаблон для масштабных сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-760">Wide entities pattern</span></span>
<span data-ttu-id="4269a-761">Используете несколько сущностей логической toostore физические объекты с более чем 252 свойств.</span><span class="sxs-lookup"><span data-stu-id="4269a-761">Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-762">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-762">Context and problem</span></span>
<span data-ttu-id="4269a-763">Отдельные сущности может иметь не более чем 252 свойств (за исключением hello обязательные системные свойства) и не может хранить более 1 МБ данных в целом.</span><span class="sxs-lookup"><span data-stu-id="4269a-763">An individual entity can have no more than 252 properties (excluding hello mandatory system properties) and cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="4269a-764">В реляционной базе данных обычно получаемому round любые ограничения на размер строки hello, добавив новую таблицу и обеспечения 1 к 1 взаимосвязи между ними.</span><span class="sxs-lookup"><span data-stu-id="4269a-764">In a relational database, you would typically get round any limits on hello size of a row by adding a new table and enforcing a 1-to-1 relationship between them.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-765">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-765">Solution</span></span>
<span data-ttu-id="4269a-766">С помощью службы таблиц hello, можно хранить несколько сущностей toorepresent объект одного крупного бизнеса с более чем 252 свойств.</span><span class="sxs-lookup"><span data-stu-id="4269a-766">Using hello Table service, you can store multiple entities toorepresent a single large business object with more than 252 properties.</span></span> <span data-ttu-id="4269a-767">Например если вы хотите toostore число hello количество Мгновенных сообщений, отправляемых для каждого сотрудника для hello последние 365 дней, можно использовать hello следующая структура, использующая две сущности с разными схемами:</span><span class="sxs-lookup"><span data-stu-id="4269a-767">For example, if you want toostore a count of hello number of IM messages sent by each employee for hello last 365 days, you could use hello following design that uses two entities with different schemas:</span></span>  

![][24]

<span data-ttu-id="4269a-768">Если вам требуется toomake изменения, требующие обновления обоих tookeep сущностей, их синхронизировано друг с другом, можно использовать EGT.</span><span class="sxs-lookup"><span data-stu-id="4269a-768">If you need toomake a change that requires updating both entities tookeep them synchronized with each other you can use an EGT.</span></span> <span data-ttu-id="4269a-769">В противном случае сообщение число tooupdate hello одного объединения операций можно использовать для определенного дня.</span><span class="sxs-lookup"><span data-stu-id="4269a-769">Otherwise, you can use a single merge operation tooupdate hello message count for a specific day.</span></span> <span data-ttu-id="4269a-770">все hello данные для отдельного сотрудника, необходимо получить обе сущности, но это можно сделать с двумя эффективный запросами, которые используются оба tooretrieve **PartitionKey** и **RowKey** значение.</span><span class="sxs-lookup"><span data-stu-id="4269a-770">tooretrieve all hello data for an individual employee you must retrieve both entities, which you can do with two efficient requests that use both a **PartitionKey** and a **RowKey** value.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-771">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-771">Issues and considerations</span></span>
<span data-ttu-id="4269a-772">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-772">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-773">Извлечение полного логическая сущность состоит по крайней мере два транзакции с хранилищем: один tooretrieve физической сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-773">Retrieving a complete logical entity involves at least two storage transactions: one tooretrieve each physical entity.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-774">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-774">When toouse this pattern</span></span>
<span data-ttu-id="4269a-775">Используйте этот шаблон при необходимости toostore сущностей, размер или число свойств превышает пределы hello для отдельной сущности hello служба таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-775">Use this pattern when  need toostore entities whose size or number of properties exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-776">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-776">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-777">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-777">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-778">Транзакции группы сущностей;</span><span class="sxs-lookup"><span data-stu-id="4269a-778">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="4269a-779">Объединение или замена.</span><span class="sxs-lookup"><span data-stu-id="4269a-779">Merge or replace</span></span>](#merge-or-replace)

### <a name="large-entities-pattern"></a><span data-ttu-id="4269a-780">Шаблон для сущностей больших размеров</span><span class="sxs-lookup"><span data-stu-id="4269a-780">Large entities pattern</span></span>
<span data-ttu-id="4269a-781">Используйте значения больших свойств toostore хранилища больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="4269a-781">Use blob storage toostore large property values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-782">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-782">Context and problem</span></span>
<span data-ttu-id="4269a-783">В отдельной сущности нельзя сохранить данные, общий объем которых превышает 1 МБ.</span><span class="sxs-lookup"><span data-stu-id="4269a-783">An individual entity cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="4269a-784">Если одно или несколько свойств хранения значений, которые приводят это значение hello общий размер вашей tooexceed сущности, нельзя хранить hello всей сущности в hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-784">If one or several of your properties store values that cause hello total size of your entity tooexceed this value, you cannot store hello entire entity in hello Table service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4269a-785">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-785">Solution</span></span>
<span data-ttu-id="4269a-786">Если сущности превышает 1 МБ, так как одно или несколько свойств содержат большой объем данных, можно сохранить данные в hello службы BLOB-объектов и затем сохранить адрес hello hello большого двоичного объекта в свойстве в сущности hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-786">If your entity exceeds 1 MB in size because one or more properties contain a large amount of data, you can store data in hello Blob service and then store hello address of hello blob in a property in hello entity.</span></span> <span data-ttu-id="4269a-787">Например, можно хранить hello фотография сотрудника в хранилище больших двоичных объектов и хранить фотографию toohello ссылку в hello **фото** свойство сущности employee:</span><span class="sxs-lookup"><span data-stu-id="4269a-787">For example, you can store hello photo of an employee in blob storage and store a link toohello photo in hello **Photo** property of your employee entity:</span></span>  

![][25]

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-788">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-788">Issues and considerations</span></span>
<span data-ttu-id="4269a-789">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-789">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-790">toomaintain окончательной согласованности между сущностью hello в hello службы таблиц и данных hello в hello BLOB-объектов, используйте hello [шаблон согласованным транзакции](#eventually-consistent-transactions-pattern) toomaintain сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-790">toomaintain eventual consistency between hello entity in hello Table service and hello data in hello Blob service, use hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain your entities.</span></span>
* <span data-ttu-id="4269a-791">Получение в завершенную сущность состоит по крайней мере два транзакции с хранилищем: одна сущность tooretrieve hello и один tooretrieve hello данные большого двоичного объекта.</span><span class="sxs-lookup"><span data-stu-id="4269a-791">Retrieving a complete entity involves at least two storage transactions: one tooretrieve hello entity and one tooretrieve hello blob data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-792">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-792">When toouse this pattern</span></span>
<span data-ttu-id="4269a-793">Используйте этот шаблон, когда нужна toostore сущностей, размер которого превышает ограничения hello для отдельной сущности в службе таблиц hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-793">Use this pattern when you need toostore entities whose size exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-794">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-794">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-795">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-795">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-796">Шаблон для согласованных транзакций;</span><span class="sxs-lookup"><span data-stu-id="4269a-796">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="4269a-797">Шаблон для масштабных сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-797">Wide entities pattern</span></span>](#wide-entities-pattern)

<a name="prepend-append-anti-pattern"></a>

### <a name="prependappend-anti-pattern"></a><span data-ttu-id="4269a-798">Анти-шаблон, предусматривающий добавление в начало или конец</span><span class="sxs-lookup"><span data-stu-id="4269a-798">Prepend/append anti-pattern</span></span>
<span data-ttu-id="4269a-799">Повышения масштабируемости, при наличии большой объем вставок, распределяя вставок hello по нескольким секциям.</span><span class="sxs-lookup"><span data-stu-id="4269a-799">Increase scalability when you have a high volume of inserts by spreading hello inserts across multiple partitions.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-800">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-800">Context and problem</span></span>
<span data-ttu-id="4269a-801">Добавляя или добавлении сущности tooyour хранимых сущностей обычно приводит к предварительного добавления новых сущностей toohello приложения hello или последней секции последовательность секций.</span><span class="sxs-lookup"><span data-stu-id="4269a-801">Prepending or appending entities tooyour stored entities typically results in hello application adding new entities toohello first or last partition of a sequence of partitions.</span></span> <span data-ttu-id="4269a-802">В этом случае все вставки hello в любой момент времени происходило в hello вставляет одного раздела, Создание активной области, который предотвращает hello таблицы службы балансировки нагрузки между несколькими узлами и возможно вызывает масштабируемость hello toohit вашего приложения целевые объекты для секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-802">In this case, all of hello inserts at any given time are taking place in hello same partition, creating a hotspot that prevents hello table service from load balancing inserts across multiple nodes, and possibly causing your application toohit hello scalability targets for partition.</span></span> <span data-ttu-id="4269a-803">Например если у вас есть приложение, доступ к сети журналы и ресурсов для сотрудников, то в итоге структуру сущности, как показано ниже hello текущий час секции становится активной области, если hello объема транзакций достигает hello цель масштабируемости для отдельные секции:</span><span class="sxs-lookup"><span data-stu-id="4269a-803">For example, if you have an application that logs network and resource access by employees, then an entity structure as shown below could result in hello current hour's partition becoming a hotspot if hello volume of transactions reaches hello scalability target for an individual partition:</span></span>  

![][26]

#### <a name="solution"></a><span data-ttu-id="4269a-804">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-804">Solution</span></span>
<span data-ttu-id="4269a-805">Hello следующая структура альтернативных сущности позволяет избежать появления гиперобъекта на любой определенной секции как события журналы приложения hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-805">hello following alternative entity structure avoids a hotspot on any particular partition as hello application logs events:</span></span>  

![][27]

<span data-ttu-id="4269a-806">Обратите внимание, в данном примере как оба hello **PartitionKey** и **RowKey** являются составными.</span><span class="sxs-lookup"><span data-stu-id="4269a-806">Notice with this example how both hello **PartitionKey** and **RowKey** are compound keys.</span></span> <span data-ttu-id="4269a-807">Hello **PartitionKey** использует отдел hello и ведения журнала для hello toodistribute идентификатор сотрудника по нескольким секциям.</span><span class="sxs-lookup"><span data-stu-id="4269a-807">hello **PartitionKey** uses both hello department and employee id toodistribute hello logging across multiple partitions.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-808">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-808">Issues and considerations</span></span>
<span data-ttu-id="4269a-809">Рассмотрим следующие точки, при определении hello как tooimplement этот шаблон:</span><span class="sxs-lookup"><span data-stu-id="4269a-809">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4269a-810">Делает клиентское приложение выполняет hello альтернативных ключевой структуры, можно избежать создания горячей секций при операции вставки эффективно hello поддерживают запросы?</span><span class="sxs-lookup"><span data-stu-id="4269a-810">Does hello alternative key structure that avoids creating hot partitions on inserts efficiently support hello queries your client application makes?</span></span>  
* <span data-ttu-id="4269a-811">Означает ли ваш предполагаемого объема транзакций, скорее всего, tooreach hello целевые показатели масштабируемости отдельной секции и регулирование службой хранения hello?</span><span class="sxs-lookup"><span data-stu-id="4269a-811">Does your anticipated volume of transactions mean that you are likely tooreach hello scalability targets for an individual partition and be throttled by hello storage service?</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4269a-812">Если toouse этот шаблон</span><span class="sxs-lookup"><span data-stu-id="4269a-812">When toouse this pattern</span></span>
<span data-ttu-id="4269a-813">Избегайте антишаблон началу append hello при тома транзакций является вероятностью tooresult регулирования службой хранения hello при доступе к горячей секции.</span><span class="sxs-lookup"><span data-stu-id="4269a-813">Avoid hello prepend/append anti-pattern when your volume of transactions is likely tooresult in throttling by hello storage service when you access a hot partition.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4269a-814">Связанные шаблоны и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-814">Related patterns and guidance</span></span>
<span data-ttu-id="4269a-815">Hello следующие шаблоны и рекомендации могут также быть актуальна при реализации данного шаблона:</span><span class="sxs-lookup"><span data-stu-id="4269a-815">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4269a-816">Шаблон составного ключа;</span><span class="sxs-lookup"><span data-stu-id="4269a-816">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4269a-817">Шаблон для заключительного фрагмента журнала;</span><span class="sxs-lookup"><span data-stu-id="4269a-817">Log tail pattern</span></span>](#log-tail-pattern)  
* [<span data-ttu-id="4269a-818">Изменение сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-818">Modifying entities</span></span>](#modifying-entities)  

### <a name="log-data-anti-pattern"></a><span data-ttu-id="4269a-819">Анти-шаблон для данных журнала</span><span class="sxs-lookup"><span data-stu-id="4269a-819">Log data anti-pattern</span></span>
<span data-ttu-id="4269a-820">Как правило следует использовать hello службы больших двоичных объектов вместо hello данные журнала toostore службы таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-820">Typically, you should use hello Blob service instead of hello Table service toostore log data.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4269a-821">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="4269a-821">Context and problem</span></span>
<span data-ttu-id="4269a-822">Обычное Сфера применения данных журнала — tooretrieve выбора записей журнала для определенной даты или диапазона: например, можно toofind все hello и критических сообщений об ошибках, зарегистрированные приложения между 15:04 и 15:06 на конкретную дату.</span><span class="sxs-lookup"><span data-stu-id="4269a-822">A common use case for log data is tooretrieve a selection of log entries for a specific date/time range: for example, you want toofind all hello error and critical messages that your application logged between 15:04 and 15:06 on a specific date.</span></span> <span data-ttu-id="4269a-823">Требуется toouse hello даты и времени hello журнала сообщений toodetermine hello секции Сохранение записей журнала в: что результаты в активном секции так, как в любой момент времени будут совместно использовать все сущности журнала hello hello же **PartitionKey** значение (в разделе hello [начале/Добавление антишаблон](#prepend-append-anti-pattern)).</span><span class="sxs-lookup"><span data-stu-id="4269a-823">You do not want toouse hello date and time of hello log message toodetermine hello partition you save log entities to: that results in a hot partition because at any given time, all hello log entities will share hello same **PartitionKey** value (see hello section [Prepend/append anti-pattern](#prepend-append-anti-pattern)).</span></span> <span data-ttu-id="4269a-824">Например hello, следующая схема сущности сообщение журнала приводит горячей секции, так как приложение hello записывает все сообщения журнала toohello секции для hello текущей даты и времени:</span><span class="sxs-lookup"><span data-stu-id="4269a-824">For example, hello following entity schema for a log message results in a hot partition because hello application writes all log messages toohello partition for hello current date and hour:</span></span>  

![][28]

<span data-ttu-id="4269a-825">В этом примере hello **RowKey** включает hello Дата и время tooensure сообщение hello журнала, что сообщения журнала хранятся в порядке даты и времени и включает идентификатор сообщения в случае, если несколько сообщений журнала совместно использовать hello же даты и времени.</span><span class="sxs-lookup"><span data-stu-id="4269a-825">In this example, hello **RowKey** includes hello date and time of hello log message tooensure that log messages are stored sorted in date/time order, and includes a message id in case multiple log messages share hello same date and time.</span></span>  

<span data-ttu-id="4269a-826">Другой подход заключается в toouse **PartitionKey** , гарантирующий, что приложение hello записывает сообщения для диапазона секций.</span><span class="sxs-lookup"><span data-stu-id="4269a-826">Another approach is toouse a **PartitionKey** that ensures that hello application writes messages across a range of partitions.</span></span> <span data-ttu-id="4269a-827">Например если hello источник сообщения журнала hello предоставляет toodistribute способом сообщений по нескольким секциям, можно использовать следующие схемы сущности hello:</span><span class="sxs-lookup"><span data-stu-id="4269a-827">For example, if hello source of hello log message provides a way toodistribute messages across many partitions, you could use hello following entity schema:</span></span>  

![][29]

<span data-ttu-id="4269a-828">Hello проблему с этой схемы то, что tooretrieve все hello сообщений журнала для определенный промежуток времени, необходимо найти каждой секции в таблице hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-828">However, hello problem with this schema is that tooretrieve all hello log messages for a specific time span you must search every partition in hello table.</span></span>

#### <a name="solution"></a><span data-ttu-id="4269a-829">Решение</span><span class="sxs-lookup"><span data-stu-id="4269a-829">Solution</span></span>
<span data-ttu-id="4269a-830">Hello предыдущего раздела выделенный hello ситуации, стараясь toouse hello записей журналов toostore службы таблиц и предлагаемые два неудовлетворительными, схем.</span><span class="sxs-lookup"><span data-stu-id="4269a-830">hello previous section highlighted hello problem of trying toouse hello Table service toostore log entries and suggested two, unsatisfactory, designs.</span></span> <span data-ttu-id="4269a-831">Одно из решений руководством tooa горячей секции с hello риск снижения производительности на запись сообщений журнала; Hello другим решением привела к низкой производительности запросов из-за требований tooscan hello каждой секции в таблице hello tooretrieve сообщениях журнала определенный промежуток времени.</span><span class="sxs-lookup"><span data-stu-id="4269a-831">One solution led tooa hot partition with hello risk of poor performance writing log messages; hello other solution resulted in poor query performance because of hello requirement tooscan every partition in hello table tooretrieve log messages for a specific time span.</span></span> <span data-ttu-id="4269a-832">Хранилище BLOB-объектов предлагает лучшим решением для такого сценария и не собирает данные hello журнала Azure аналитики хранилища хранилищ.</span><span class="sxs-lookup"><span data-stu-id="4269a-832">Blob storage offers a better solution for this type of scenario and this is how Azure Storage Analytics stores hello log data it collects.</span></span>  

<span data-ttu-id="4269a-833">В этом разделе описаны как аналитика хранилища сохраняет данные журнала в хранилище BLOB-объектов как иллюстрация подход toostoring данных, которые обычно выполняются запросы по диапазону.</span><span class="sxs-lookup"><span data-stu-id="4269a-833">This section outlines how Storage Analytics stores log data in blob storage as an illustration of this approach toostoring data that you typically query by range.</span></span>  

<span data-ttu-id="4269a-834">Служба аналитики хранилища сохраняет сообщения журнала в формате с разделителями в нескольких больших двоичных объектах.</span><span class="sxs-lookup"><span data-stu-id="4269a-834">Storage Analytics stores log messages in a delimited format in multiple blobs.</span></span> <span data-ttu-id="4269a-835">в формате с разделителями Hello упрощает для клиента данных hello tooparse приложения в журнал сообщение hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-835">hello delimited format makes it easy for a client application tooparse hello data in hello log message.</span></span>  

<span data-ttu-id="4269a-836">Аналитика хранилища используется соглашение об именовании для больших двоичных объектов, которые позволяет toolocate hello большого двоичного объекта (или большие двоичные объекты), содержащими сообщения журнала hello, поиск которых выполняется.</span><span class="sxs-lookup"><span data-stu-id="4269a-836">Storage Analytics uses a naming convention for blobs that enables you toolocate hello blob (or blobs) that contain hello log messages for which you are searching.</span></span> <span data-ttu-id="4269a-837">Например большой двоичный объект с именем «queue/2014/07/31/1800/000001.log» содержит сообщения журнала, связанные службы очередей toohello hello час, начиная с 18:00, 31 июля 2014 г.</span><span class="sxs-lookup"><span data-stu-id="4269a-837">For example, a blob named "queue/2014/07/31/1800/000001.log" contains log messages that relate toohello queue service for hello hour starting at 18:00 on 31 July 2014.</span></span> <span data-ttu-id="4269a-838">Hello «000001» указывает, что это hello первый файл журнала за этот период.</span><span class="sxs-lookup"><span data-stu-id="4269a-838">hello "000001" indicates that this is hello first log file for this period.</span></span> <span data-ttu-id="4269a-839">Аналитика хранилища также сначала записывает отметки времени hello hello и последний журнала сообщения, хранящиеся в файле hello как часть метаданных hello большого двоичного объекта.</span><span class="sxs-lookup"><span data-stu-id="4269a-839">Storage Analytics also records hello timestamps of hello first and last log messages stored in hello file as part of hello blob's metadata.</span></span> <span data-ttu-id="4269a-840">Hello API для больших двоичных объектов хранилища позволяет обнаружить большие двоичные объекты в контейнере на основе префикса имени: toolocate все hello большие двоичные объекты, содержащие очереди данных журналов для hello час, начиная с 18:00, можно использовать hello префикс «очереди/2014/07/31/1800.»</span><span class="sxs-lookup"><span data-stu-id="4269a-840">hello API for blob storage enables you locate blobs in a container based on a name prefix: toolocate all hello blobs that contain queue log data for hello hour starting at 18:00, you can use hello prefix "queue/2014/07/31/1800."</span></span>  

<span data-ttu-id="4269a-841">Аналитики хранилища внутренне буферов сообщений журнала и периодически обновлять соответствующие hello BLOB-объект или создает новый файл с последнего пакета hello записей журнала.</span><span class="sxs-lookup"><span data-stu-id="4269a-841">Storage Analytics buffers log messages internally and then periodically updates hello appropriate blob or creates a new one with hello latest batch of log entries.</span></span> <span data-ttu-id="4269a-842">Это сокращает число hello записи необходимо выполнить toohello BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="4269a-842">This reduces hello number of writes it must perform toohello blob service.</span></span>  

<span data-ttu-id="4269a-843">При реализации аналогичное решение в приложении, необходимо учитывать, как toomanage hello компромисса между надежность (записи каждого хранилища tooblob запись журнала, как это происходит), стоимости и масштабируемости (буферизации обновлений в приложении и их записи tooblob хранилища в пакетах).</span><span class="sxs-lookup"><span data-stu-id="4269a-843">If you are implementing a similar solution in your own application, you must consider how toomanage hello trade-off between reliability (writing every log entry tooblob storage as it happens) and cost and scalability (buffering updates in your application and writing them tooblob storage in batches).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4269a-844">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="4269a-844">Issues and considerations</span></span>
<span data-ttu-id="4269a-845">Примите во внимание при выборе влияние toostore журнала данных следующие точки hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-845">Consider hello following points when deciding how toostore log data:</span></span>  

* <span data-ttu-id="4269a-846">При создании схемы таблицы без потенциальных разделов с высокой нагрузкой может оказаться, что доступ к данным журнала осуществляется неэффективно.</span><span class="sxs-lookup"><span data-stu-id="4269a-846">If you create a table design that avoids potential hot partitions, you may find that you cannot access your log data efficiently.</span></span>  
* <span data-ttu-id="4269a-847">tooprocess ведения журнала данных, часто клиент должен tooload много записей.</span><span class="sxs-lookup"><span data-stu-id="4269a-847">tooprocess log data, a client often needs tooload many records.</span></span>  
* <span data-ttu-id="4269a-848">Несмотря на то, что данные журнала часто носят структурированный характер, наилучшим решением может быть хранилище больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="4269a-848">Although log data is often structured, blob storage may be a better solution.</span></span>  

### <a name="implementation-considerations"></a><span data-ttu-id="4269a-849">Рекомендации по реализации</span><span class="sxs-lookup"><span data-stu-id="4269a-849">Implementation considerations</span></span>
<span data-ttu-id="4269a-850">В этом разделе рассматриваются некоторые из toobear вопросы hello учитывать при реализации шаблонов hello, описанное в предыдущем разделе hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-850">This section discusses some of hello considerations toobear in mind when you implement hello patterns described in hello previous sections.</span></span> <span data-ttu-id="4269a-851">Большая часть этого раздела используются примеры написаны на C#, в которых используется hello клиентской библиотеки хранилища (версия 4.3.0 на момент написания статьи hello).</span><span class="sxs-lookup"><span data-stu-id="4269a-851">Most of this section uses examples written in C# that use hello Storage Client Library (version 4.3.0 at hello time of writing).</span></span>  

### <a name="retrieving-entities"></a><span data-ttu-id="4269a-852">Извлечение сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-852">Retrieving entities</span></span>
<span data-ttu-id="4269a-853">Как описано в разделе "hello" [конструктора для выполнения запросов к](#design-for-querying), hello наиболее эффективный это запрос точки.</span><span class="sxs-lookup"><span data-stu-id="4269a-853">As discussed in hello section [Design for querying](#design-for-querying), hello most efficient query is a point query.</span></span> <span data-ttu-id="4269a-854">Однако в некоторых сценариях может потребоваться tooretrieve нескольких сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-854">However, in some scenarios you may need tooretrieve multiple entities.</span></span> <span data-ttu-id="4269a-855">В этом разделе описываются некоторые общие сущности tooretrieving подходы, с помощью клиентской библиотеки хранилища hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-855">This section describes some common approaches tooretrieving entities using hello Storage Client Library.</span></span>  

#### <a name="executing-a-point-query-using-hello-storage-client-library"></a><span data-ttu-id="4269a-856">Выполнение запроса точки с помощью клиентской библиотеки хранилища hello</span><span class="sxs-lookup"><span data-stu-id="4269a-856">Executing a point query using hello Storage Client Library</span></span>
<span data-ttu-id="4269a-857">tooexecute простым способом Hello запроса точки — toouse hello **получить** табличную операцию, как показано в hello, следующий фрагмент кода C#, который извлекает сущность с **PartitionKey** значение «Sales» и  **RowKey** значения «212»:</span><span class="sxs-lookup"><span data-stu-id="4269a-857">hello easiest way tooexecute a point query is toouse hello **Retrieve** table operation as shown in hello following C# code snippet that retrieves an entity with a **PartitionKey** of value "Sales" and a **RowKey** of value "212":</span></span>  

```csharp
TableOperation retrieveOperation = TableOperation.Retrieve<EmployeeEntity>("Sales", "212");
var retrieveResult = employeeTable.Execute(retrieveOperation);
if (retrieveResult.Result != null)
{
    EmployeeEntity employee = (EmployeeEntity)retrieveResult.Result;
    ...
}  
```

<span data-ttu-id="4269a-858">Обратите внимание на то, как в этом примере ожидает hello объекта он извлекает toobe типа **EmployeeEntity**.</span><span class="sxs-lookup"><span data-stu-id="4269a-858">Notice how this example expects hello entity it retrieves toobe of type **EmployeeEntity**.</span></span>  

#### <a name="retrieving-multiple-entities-using-linq"></a><span data-ttu-id="4269a-859">Извлечение нескольких сущностей с помощью LINQ</span><span class="sxs-lookup"><span data-stu-id="4269a-859">Retrieving multiple entities using LINQ</span></span>
<span data-ttu-id="4269a-860">Для извлечения нескольких сущностей можно использовать LINQ с клиентской библиотекой хранилища, указав при этом запрос с предложением **where** .</span><span class="sxs-lookup"><span data-stu-id="4269a-860">You can retrieve multiple entities by using LINQ with Storage Client Library and specifying a query with a **where** clause.</span></span> <span data-ttu-id="4269a-861">tooavoid Просмотр таблицы, следует всегда включать hello **PartitionKey** значение в hello где предложения и по возможности hello **RowKey** значение tooavoid просмотров таблиц и разделов.</span><span class="sxs-lookup"><span data-stu-id="4269a-861">tooavoid a table scan, you should always include hello **PartitionKey** value in hello where clause, and if possible hello **RowKey** value tooavoid table and partition scans.</span></span> <span data-ttu-id="4269a-862">Hello служба таблиц поддерживает ограниченный набор операторов сравнения (больше, больше или равно, меньше чем», «меньше или равно, равно и не равно) toouse в hello где предложения.</span><span class="sxs-lookup"><span data-stu-id="4269a-862">hello table service supports a limited set of comparison operators (greater than, greater than or equal, less than, less than or equal, equal, and not equal) toouse in hello where clause.</span></span> <span data-ttu-id="4269a-863">Hello следующий фрагмент кода C# выполняет поиск всех сотрудников hello которого последнее имя начинается с «B» (при условии, что hello **RowKey** хранилищ hello Фамилия) в отдел продаж hello (при условии, что hello **PartitionKey** хранит имя hello отдела):</span><span class="sxs-lookup"><span data-stu-id="4269a-863">hello following C# code snippet finds all hello employees whose last name starts with "B" (assuming that hello **RowKey** stores hello last name) in hello sales department (assuming hello **PartitionKey** stores hello department name):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = employeeTable.CreateQuery<EmployeeEntity>();
var query = (from employee in employeeQuery
            where employee.PartitionKey == "Sales" &&
            employee.RowKey.CompareTo("B") >= 0 &&
            employee.RowKey.CompareTo("C") < 0
            select employee).AsTableQuery();
var employees = query.Execute();  
```

<span data-ttu-id="4269a-864">Обратите внимание на то, как запрос hello указывает оба **RowKey** и **PartitionKey** tooensure более высокую производительность.</span><span class="sxs-lookup"><span data-stu-id="4269a-864">Notice how hello query specifies both a **RowKey** and a **PartitionKey** tooensure better performance.</span></span>  

<span data-ttu-id="4269a-865">Hello следующий образец кода демонстрирует эквивалентную функциональность, с помощью плавного API hello (Дополнительные сведения о fluent API-интерфейсы в целом. в разделе [практические рекомендации по разработке Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span><span class="sxs-lookup"><span data-stu-id="4269a-865">hello following code sample shows equivalent functionality using hello fluent API (for more information about fluent APIs in general, see [Best Practices for Designing a Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = new TableQuery<EmployeeEntity>().Where(
    TableQuery.CombineFilters(
    TableQuery.CombineFilters(
        TableQuery.GenerateFilterCondition(
    "PartitionKey", QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.GenerateFilterCondition(
    "RowKey", QueryComparisons.GreaterThanOrEqual, "B")
),
TableOperators.And,
TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.LessThan, "C")
    )
);
var employees = employeeTable.ExecuteQuery(employeeQuery);  
```

> [!NOTE]
> <span data-ttu-id="4269a-866">Hello образец создает вложенные несколько **CombineFilters** tooinclude методы hello три условия фильтрации.</span><span class="sxs-lookup"><span data-stu-id="4269a-866">hello sample nests multiple **CombineFilters** methods tooinclude hello three filter conditions.</span></span>  
> 
> 

#### <a name="retrieving-large-numbers-of-entities-from-a-query"></a><span data-ttu-id="4269a-867">Извлечение большого количества сущностей из запроса</span><span class="sxs-lookup"><span data-stu-id="4269a-867">Retrieving large numbers of entities from a query</span></span>
<span data-ttu-id="4269a-868">Оптимальный запрос возвращает отдельные сущности на основе значений **PartitionKey** и **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-868">An optimal query returns an individual entity based on a **PartitionKey** value and a **RowKey** value.</span></span> <span data-ttu-id="4269a-869">Однако в некоторых случаях возможно tooreturn требование множество сущностей из hello же секции, или даже от большого числа секций.</span><span class="sxs-lookup"><span data-stu-id="4269a-869">However, in some scenarios you may have a requirement tooreturn many entities from hello same partition or even from many partitions.</span></span>  

<span data-ttu-id="4269a-870">Следует всегда полностью проверить производительность приложения hello в таких сценариях.</span><span class="sxs-lookup"><span data-stu-id="4269a-870">You should always fully test hello performance of your application in such scenarios.</span></span>  

<span data-ttu-id="4269a-871">Запрос к службе таблиц hello может возвращать не более 1000 сущностей одновременно и может выполняться не более 5 секунд.</span><span class="sxs-lookup"><span data-stu-id="4269a-871">A query against hello table service may return a maximum of 1,000 entities at one time and may execute for a maximum of five seconds.</span></span> <span data-ttu-id="4269a-872">Если hello результирующий набор содержит более 1000 сущностей, если hello запрос не завершен в течение 5 секунд, или если hello запрос пересекает границу секции hello, hello служба таблиц возвращает tooenable токен продолжения hello hello toorequest клиентского приложения Следующий набор сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-872">If hello result set contains more than 1,000 entities, if hello query did not complete within five seconds, or if hello query crosses hello partition boundary, hello Table service returns a continuation token tooenable hello client application toorequest hello next set of entities.</span></span> <span data-ttu-id="4269a-873">Дополнительные сведения о принципе действия маркеров продолжения см. в статье [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx) (Время ожидания запроса и разбивка на страницы).</span><span class="sxs-lookup"><span data-stu-id="4269a-873">For more information about how continuation tokens work, see [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span></span>  

<span data-ttu-id="4269a-874">При использовании клиентской библиотеки хранилища hello, он может автоматически обработки токенов продолжения автоматически при возвращении сущностей из службы таблиц hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-874">If you are using hello Storage Client Library, it can automatically handle continuation tokens for you as it returns entities from hello Table service.</span></span> <span data-ttu-id="4269a-875">Hello следующий пример кода C# с помощью клиентской библиотеки хранилища hello автоматически обрабатывает маркеры продолжения hello служба таблиц возвращает их в ответе:</span><span class="sxs-lookup"><span data-stu-id="4269a-875">hello following C# code sample using hello Storage Client Library automatically handles continuation tokens if hello table service returns them in a response:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

var employees = employeeTable.ExecuteQuery(employeeQuery);
foreach (var emp in employees)
{
        ...
}  
```

<span data-ttu-id="4269a-876">Следующий код C# Hello обрабатывает маркеры продолжения явным образом:</span><span class="sxs-lookup"><span data-stu-id="4269a-876">hello following C# code handles continuation tokens explicitly:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

TableContinuationToken continuationToken = null;

do
{
        var employees = employeeTable.ExecuteQuerySegmented(
        employeeQuery, continuationToken);
    foreach (var emp in employees)
    {
    ...
    }
    continuationToken = employees.ContinuationToken;
} while (continuationToken != null);  
```

<span data-ttu-id="4269a-877">С помощью токенов продолжения явным образом, можно управлять при получении hello следующего сегмента данных.</span><span class="sxs-lookup"><span data-stu-id="4269a-877">By using continuation tokens explicitly, you can control when your application retrieves hello next segment of data.</span></span> <span data-ttu-id="4269a-878">Например если клиентское приложение позволяет пользователям toopage через hello сущностей, хранящихся в таблице, пользователь может решить не toopage через все сущности hello, полученные запросом hello, поэтому приложение будет использовать только типа hello tooretrieve токен продолжения рядом сегмент при hello пользователя был завершен постраничный просмотр всех сущностей hello в текущем сегменте hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-878">For example, if your client application enables users toopage through hello entities stored in a table, a user may decide not toopage through all hello entities retrieved by hello query so your application would only use a continuation token tooretrieve hello next segment when hello user had finished paging through all hello entities in hello current segment.</span></span> <span data-ttu-id="4269a-879">Такой подход имеет несколько преимуществ.</span><span class="sxs-lookup"><span data-stu-id="4269a-879">This approach has several benefits:</span></span>  

* <span data-ttu-id="4269a-880">Благодаря этому можно toolimit hello объем tooretrieve данные из службы таблиц hello и переносить по сети hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-880">It enables you toolimit hello amount of data tooretrieve from hello Table service and that you move over hello network.</span></span>  
* <span data-ttu-id="4269a-881">Она позволяет вам tooperform асинхронные операции ввода-ВЫВОДА в .NET.</span><span class="sxs-lookup"><span data-stu-id="4269a-881">It enables you tooperform asynchronous IO in .NET.</span></span>  
* <span data-ttu-id="4269a-882">Благодаря этому можно tooserialize hello продолжение токена toopersistent хранилища, чтобы продолжить hello для события сбоя приложения.</span><span class="sxs-lookup"><span data-stu-id="4269a-882">It enables you tooserialize hello continuation token toopersistent storage so you can continue in hello event of an application crash.</span></span>  

> [!NOTE]
> <span data-ttu-id="4269a-883">Маркер продолжения обычно возвращает сегмент, содержащий 1000 сущностей и меньше.</span><span class="sxs-lookup"><span data-stu-id="4269a-883">A continuation token typically returns a segment containing 1,000 entities, although it may be fewer.</span></span> <span data-ttu-id="4269a-884">Это также относится hello ограничить hello количество записей, которые возвращает запрос, используя **принимать** tooreturn hello первый n сущностей, которые соответствуют условию поиска: hello таблицы служба может возвратить сегмент, содержащий менее n сущностей вдоль с tooenable токен продолжения вы tooretrieve hello оставшиеся объекты.</span><span class="sxs-lookup"><span data-stu-id="4269a-884">This is also hello case if you limit hello number of entries a query returns by using **Take** tooreturn hello first n entities that match your lookup criteria: hello table service may return a segment containing fewer than n entities along with a continuation token tooenable you tooretrieve hello remaining entities.</span></span>  
> 
> 

<span data-ttu-id="4269a-885">Hello следующий код C# показывает, как количество сущностей hello toomodify возвращаются внутри сегмента:</span><span class="sxs-lookup"><span data-stu-id="4269a-885">hello following C# code shows how toomodify hello number of entities returned inside a segment:</span></span>  

```csharp
employeeQuery.TakeCount = 50;  
```

#### <a name="server-side-projection"></a><span data-ttu-id="4269a-886">Проекция на стороне сервера</span><span class="sxs-lookup"><span data-stu-id="4269a-886">Server-side projection</span></span>
<span data-ttu-id="4269a-887">Одной сущности можно иметь свойства too255 и развертывать too1 МБ.</span><span class="sxs-lookup"><span data-stu-id="4269a-887">A single entity can have up too255 properties and be up too1 MB in size.</span></span> <span data-ttu-id="4269a-888">При запросе таблицы hello и получения сущностей, могут потребоваться не все свойства hello и можно избежать, без необходимости передачи данных (toohelp сократить задержку и уменьшить стоимость).</span><span class="sxs-lookup"><span data-stu-id="4269a-888">When you query hello table and retrieve entities, you may not need all hello properties and can avoid transferring data unnecessarily (toohelp reduce latency and cost).</span></span> <span data-ttu-id="4269a-889">Можно использовать свойства просто hello tootransfer проекции на стороне сервера, необходимые.</span><span class="sxs-lookup"><span data-stu-id="4269a-889">You can use server-side projection tootransfer just hello properties you need.</span></span> <span data-ttu-id="4269a-890">Hello следующий пример — извлекает только hello **электронной почты** свойства (вместе с **PartitionKey**, **RowKey**, **Timestamp**и  **ETag**) из сущностей hello, выбранные запросом hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-890">hello following example is retrieves just hello **Email** property (along with **PartitionKey**, **RowKey**, **Timestamp**, and **ETag**) from hello entities selected by hello query.</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
List<string> columns = new List<string>() { "Email" };
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter).Select(columns);

var entities = employeeTable.ExecuteQuery(employeeQuery);
foreach (var e in entities)
{
        Console.WriteLine("RowKey: {0}, EmployeeEmail: {1}", e.RowKey, e.Email);
}  
```

<span data-ttu-id="4269a-891">Обратите внимание, каким образом hello **RowKey** значение доступно, даже если он не был включен в список свойств tooretrieve hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-891">Notice how hello **RowKey** value is available even though it was not included in hello list of properties tooretrieve.</span></span>  

### <a name="modifying-entities"></a><span data-ttu-id="4269a-892">Изменение сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-892">Modifying entities</span></span>
<span data-ttu-id="4269a-893">Hello клиентская библиотека хранилища позволяет toomodify сущностей, хранящиеся в службе таблиц hello, вставка, удаление и обновление сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-893">hello Storage Client Library enables you toomodify your entities stored in hello table service by inserting, deleting, and updating entities.</span></span> <span data-ttu-id="4269a-894">EGTs toobatch можно использовать несколько операций вставки, обновления и delete вместе tooreduce hello количество циклов приема-передачи требуется и повысить производительность hello решения.</span><span class="sxs-lookup"><span data-stu-id="4269a-894">You can use EGTs toobatch multiple insert, update, and delete operations together tooreduce hello number of round trips required and improve hello performance of your solution.</span></span>  

<span data-ttu-id="4269a-895">Учтите, что исключения, когда hello клиентской библиотеки хранилища обычно выполняет EGT включают индекс hello hello сущность, которая вызвала toofail пакета hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-895">Note that exceptions thrown when hello Storage Client Library executes an EGT typically include hello index of hello entity that caused hello batch toofail.</span></span> <span data-ttu-id="4269a-896">Это может оказаться полезным при отладке кода, использующего транзакции группы сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-896">This is helpful when you are debugging code that uses EGTs.</span></span>  

<span data-ttu-id="4269a-897">Следует также учитывать влияние разработки на то, каким образом клиентское приложение обрабатывает операций параллелизма и обновления.</span><span class="sxs-lookup"><span data-stu-id="4269a-897">You should also consider how your design affects how your client application handles concurrency and update operations.</span></span>  

#### <a name="managing-concurrency"></a><span data-ttu-id="4269a-898">Управление параллелизмом</span><span class="sxs-lookup"><span data-stu-id="4269a-898">Managing concurrency</span></span>
<span data-ttu-id="4269a-899">По умолчанию, служба таблиц hello реализует оптимистичного параллелизма проверка на уровне hello отдельных сущностей для **вставить**, **слияния**, и **удалить** операций, Хотя допускается для типа hello tooforce клиента таблицы toobypass службы этих проверок.</span><span class="sxs-lookup"><span data-stu-id="4269a-899">By default, hello table service implements optimistic concurrency checks at hello level of individual entities for **Insert**, **Merge**, and **Delete** operations, although it is possible for a client tooforce hello table service toobypass these checks.</span></span> <span data-ttu-id="4269a-900">Дополнительные сведения об управлении параллелизмом hello службы таблиц см. в разделе [управление параллелизмом в хранилище Microsoft Azure](storage-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="4269a-900">For more information about how hello table service manages concurrency, see  [Managing Concurrency in Microsoft Azure Storage](storage-concurrency.md).</span></span>  

#### <a name="merge-or-replace"></a><span data-ttu-id="4269a-901">Объединение или замена.</span><span class="sxs-lookup"><span data-stu-id="4269a-901">Merge or replace</span></span>
<span data-ttu-id="4269a-902">Hello **заменить** метод hello **TableOperation** класса всегда заменяет hello завершенную сущность в hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-902">hello **Replace** method of hello **TableOperation** class always replaces hello complete entity in hello Table service.</span></span> <span data-ttu-id="4269a-903">Если не включено свойство в запросе hello, свойство существует в сущности хранимых hello, запрос hello удаляет хранение свойство из hello сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-903">If you do not include a property in hello request when that property exists in hello stored entity, hello request removes that property from hello stored entity.</span></span> <span data-ttu-id="4269a-904">Если не требуется tooremove свойства явным образом из хранится каждое свойство, необходимо включить в запрос hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-904">Unless you want tooremove a property explicitly from a stored entity, you must include every property in hello request.</span></span>  

<span data-ttu-id="4269a-905">Можно использовать hello **слияния** метод hello **TableOperation** класса tooreduce hello объем данных, следует отправить службе таблиц toohello при необходимости tooupdate сущности.</span><span class="sxs-lookup"><span data-stu-id="4269a-905">You can use hello **Merge** method of hello **TableOperation** class tooreduce hello amount of data that you send toohello Table service when you want tooupdate an entity.</span></span> <span data-ttu-id="4269a-906">Hello **слияния** метод заменяет все свойства в сущности hello хранимые значения свойства из сущности hello, включенных в запрос hello, но оставляет без изменений в любые свойства в hello хранится сущности, которые не включены в запрос hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-906">hello **Merge** method replaces any properties in hello stored entity with property values from hello entity included in hello request, but leaves intact any properties in hello stored entity that are not included in hello request.</span></span> <span data-ttu-id="4269a-907">Это полезно в том случае, если большие объекты и достаточно tooupdate небольшое количество свойств в запросе.</span><span class="sxs-lookup"><span data-stu-id="4269a-907">This is useful if you have large entities and only need tooupdate a small number of properties in a request.</span></span>  

> [!NOTE]
> <span data-ttu-id="4269a-908">Hello **заменить** и **слияния** способы завершаются ошибкой, если hello сущность не существует.</span><span class="sxs-lookup"><span data-stu-id="4269a-908">hello **Replace** and **Merge** methods fail if hello entity does not exist.</span></span> <span data-ttu-id="4269a-909">В качестве альтернативы можно использовать hello **InsertOrReplace** и **InsertOrMerge** методы, создать новую сущность, если он не существует.</span><span class="sxs-lookup"><span data-stu-id="4269a-909">As an alternative, you can use hello **InsertOrReplace** and **InsertOrMerge** methods that create a new entity if it doesn't exist.</span></span>  
> 
> 

### <a name="working-with-heterogeneous-entity-types"></a><span data-ttu-id="4269a-910">Работа с разными типами сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-910">Working with heterogeneous entity types</span></span>
<span data-ttu-id="4269a-911">Hello службы таблиц — *без схемы* хранилища таблиц, значит, что одной таблицы может содержать объекты различных типов, обеспечивая большую гибкость при разработке.</span><span class="sxs-lookup"><span data-stu-id="4269a-911">hello Table service is a *schema-less* table store that means that a single table can store entities of multiple types providing great flexibility in your design.</span></span> <span data-ttu-id="4269a-912">Hello следующий пример иллюстрирует таблица сотрудников и отдел сущностей:</span><span class="sxs-lookup"><span data-stu-id="4269a-912">hello following example illustrates a table storing both employee and department entities:</span></span>  

<table>
<tr>
<th><span data-ttu-id="4269a-913">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4269a-913">PartitionKey</span></span></th>
<th><span data-ttu-id="4269a-914">RowKey</span><span class="sxs-lookup"><span data-stu-id="4269a-914">RowKey</span></span></th>
<th><span data-ttu-id="4269a-915">Timestamp</span><span class="sxs-lookup"><span data-stu-id="4269a-915">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-916">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-916">FirstName</span></span></th>
<th><span data-ttu-id="4269a-917">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-917">LastName</span></span></th>
<th><span data-ttu-id="4269a-918">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-918">Age</span></span></th>
<th><span data-ttu-id="4269a-919">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-919">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-920">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-920">FirstName</span></span></th>
<th><span data-ttu-id="4269a-921">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-921">LastName</span></span></th>
<th><span data-ttu-id="4269a-922">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-922">Age</span></span></th>
<th><span data-ttu-id="4269a-923">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-923">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-924">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="4269a-924">DepartmentName</span></span></th>
<th><span data-ttu-id="4269a-925">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="4269a-925">EmployeeCount</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-926">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-926">FirstName</span></span></th>
<th><span data-ttu-id="4269a-927">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-927">LastName</span></span></th>
<th><span data-ttu-id="4269a-928">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-928">Age</span></span></th>
<th><span data-ttu-id="4269a-929">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-929">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="4269a-930">Обратите внимание, что каждая сущность должна иметь значения **PartitionKey**, **RowKey** и **Timestamp** и при этом может содержать любой набор свойств.</span><span class="sxs-lookup"><span data-stu-id="4269a-930">Note that each entity must still have **PartitionKey**, **RowKey**, and **Timestamp** values, but may have any set of properties.</span></span> <span data-ttu-id="4269a-931">Кроме того что нет tooindicate hello введите сущности, если вы не выбрали toostore где-нибудь эту информацию.</span><span class="sxs-lookup"><span data-stu-id="4269a-931">Furthermore, there is nothing tooindicate hello type of an entity unless you choose toostore that information somewhere.</span></span> <span data-ttu-id="4269a-932">Для идентификации типа сущности hello двумя способами:</span><span class="sxs-lookup"><span data-stu-id="4269a-932">There are two options for identifying hello entity type:</span></span>  

* <span data-ttu-id="4269a-933">Добавить toohello тип сущности hello **RowKey** (или возможно hello **PartitionKey**).</span><span class="sxs-lookup"><span data-stu-id="4269a-933">Prepend hello entity type toohello **RowKey** (or possibly hello **PartitionKey**).</span></span> <span data-ttu-id="4269a-934">Например, **EMPLOYEE_000123** или **DEPARTMENT_SALES** в качестве значений **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4269a-934">For example, **EMPLOYEE_000123** or **DEPARTMENT_SALES** as **RowKey** values.</span></span>  
* <span data-ttu-id="4269a-935">Используйте отдельные свойства toorecord hello тип сущности как показано в следующей таблице hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-935">Use a separate property toorecord hello entity type as shown in hello table below.</span></span>  

<table>
<tr>
<th><span data-ttu-id="4269a-936">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4269a-936">PartitionKey</span></span></th>
<th><span data-ttu-id="4269a-937">RowKey</span><span class="sxs-lookup"><span data-stu-id="4269a-937">RowKey</span></span></th>
<th><span data-ttu-id="4269a-938">Timestamp</span><span class="sxs-lookup"><span data-stu-id="4269a-938">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-939">EntityType</span><span class="sxs-lookup"><span data-stu-id="4269a-939">EntityType</span></span></th>
<th><span data-ttu-id="4269a-940">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-940">FirstName</span></span></th>
<th><span data-ttu-id="4269a-941">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-941">LastName</span></span></th>
<th><span data-ttu-id="4269a-942">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-942">Age</span></span></th>
<th><span data-ttu-id="4269a-943">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-943">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-944">Employee</span><span class="sxs-lookup"><span data-stu-id="4269a-944">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-945">EntityType</span><span class="sxs-lookup"><span data-stu-id="4269a-945">EntityType</span></span></th>
<th><span data-ttu-id="4269a-946">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-946">FirstName</span></span></th>
<th><span data-ttu-id="4269a-947">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-947">LastName</span></span></th>
<th><span data-ttu-id="4269a-948">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-948">Age</span></span></th>
<th><span data-ttu-id="4269a-949">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-949">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-950">Employee</span><span class="sxs-lookup"><span data-stu-id="4269a-950">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-951">EntityType</span><span class="sxs-lookup"><span data-stu-id="4269a-951">EntityType</span></span></th>
<th><span data-ttu-id="4269a-952">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="4269a-952">DepartmentName</span></span></th>
<th><span data-ttu-id="4269a-953">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="4269a-953">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-954">Department</span><span class="sxs-lookup"><span data-stu-id="4269a-954">Department</span></span></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4269a-955">EntityType</span><span class="sxs-lookup"><span data-stu-id="4269a-955">EntityType</span></span></th>
<th><span data-ttu-id="4269a-956">FirstName</span><span class="sxs-lookup"><span data-stu-id="4269a-956">FirstName</span></span></th>
<th><span data-ttu-id="4269a-957">LastName</span><span class="sxs-lookup"><span data-stu-id="4269a-957">LastName</span></span></th>
<th><span data-ttu-id="4269a-958">Age</span><span class="sxs-lookup"><span data-stu-id="4269a-958">Age</span></span></th>
<th><span data-ttu-id="4269a-959">Email</span><span class="sxs-lookup"><span data-stu-id="4269a-959">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4269a-960">Employee</span><span class="sxs-lookup"><span data-stu-id="4269a-960">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="4269a-961">Первый вариант Hello, добавляя hello объекта типа toohello **RowKey**, полезно, если есть вероятность, что две сущности различных типов могут появиться hello же значение ключа.</span><span class="sxs-lookup"><span data-stu-id="4269a-961">hello first option, prepending hello entity type toohello **RowKey**, is useful if there is a possibility that two entities of different types might have hello same key value.</span></span> <span data-ttu-id="4269a-962">Он также группирует сущности hello в секции hello того же типа, друг с другом.</span><span class="sxs-lookup"><span data-stu-id="4269a-962">It also groups entities of hello same type together in hello partition.</span></span>  

<span data-ttu-id="4269a-963">Hello способов, приведенных в этом разделе, обсуждение которых относится toohello [отношения наследования](#inheritance-relationships) ранее в данном руководстве в разделе "hello" [моделирования связей](#modelling-relationships).</span><span class="sxs-lookup"><span data-stu-id="4269a-963">hello techniques discussed in this section are especially relevant toohello discussion [Inheritance relationships](#inheritance-relationships) earlier in this guide in hello section [Modelling relationships](#modelling-relationships).</span></span>  

> [!NOTE]
> <span data-ttu-id="4269a-964">Следует рассмотрите возможность включения номер версии в hello типа значение tooenable клиентских приложений tooevolve POCO объектов сущностей и работать с различными версиями.</span><span class="sxs-lookup"><span data-stu-id="4269a-964">You should consider including a version number in hello entity type value tooenable client applications tooevolve POCO objects and work with different versions.</span></span>  
> 
> 

<span data-ttu-id="4269a-965">Hello остальной части этого раздела описываются некоторые функции hello в hello клиентской библиотеки хранилища, предназначенных для упрощения работы с несколькими типами сущностей в hello же таблицы.</span><span class="sxs-lookup"><span data-stu-id="4269a-965">hello remainder of this section describes some of hello features in hello Storage Client Library that facilitate working with multiple entity types in hello same table.</span></span>  

#### <a name="retrieving-heterogeneous-entity-types"></a><span data-ttu-id="4269a-966">Извлечение разных типов сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-966">Retrieving heterogeneous entity types</span></span>
<span data-ttu-id="4269a-967">При использовании клиентской библиотеки хранилища hello имеется три параметра для работы с несколькими типами сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-967">If you are using hello Storage Client Library, you have three options for working with multiple entity types.</span></span>  

<span data-ttu-id="4269a-968">Если вы знаете тип hello hello объектов с определенным **RowKey** и **PartitionKey** значения, то можно указать тип сущности hello при извлечении hello сущности, как показано в примерах hello предыдущие два получать сущностей типа **EmployeeEntity**: [выполнение запроса точки с помощью клиентской библиотеки хранилища hello](#executing-a-point-query-using-the-storage-client-library) и [извлечения нескольких сущностей с помощью LINQ](#retrieving-multiple-entities-using-linq).</span><span class="sxs-lookup"><span data-stu-id="4269a-968">If you know hello type of hello entity stored with a specific **RowKey** and **PartitionKey** values, then you can specify hello entity type when you retrieve hello entity as shown in hello previous two examples that retrieve entities of type **EmployeeEntity**: [Executing a point query using hello Storage Client Library](#executing-a-point-query-using-the-storage-client-library) and [Retrieving multiple entities using LINQ](#retrieving-multiple-entities-using-linq).</span></span>  

<span data-ttu-id="4269a-969">второй вариант Hello — toouse hello **DynamicTableEntity** типа (контейнер свойств) вместо конкретный тип сущности POCO (этот параметр может также повысить производительность, поскольку нет необходимости tooserialize и десериализации hello сущности слишком. Типы по сети).</span><span class="sxs-lookup"><span data-stu-id="4269a-969">hello second option is toouse hello **DynamicTableEntity** type (a property bag) instead of a concrete POCO entity type (this option may also improve performance because there is no need tooserialize and deserialize hello entity too.NET types).</span></span> <span data-ttu-id="4269a-970">Следующий код C# потенциально Hello получает несколько сущностей различных типов из таблицы hello, но возвращает все сущности как **DynamicTableEntity** экземпляров.</span><span class="sxs-lookup"><span data-stu-id="4269a-970">hello following C# code potentially retrieves multiple entities of different types from hello table, but returns all entities as **DynamicTableEntity** instances.</span></span> <span data-ttu-id="4269a-971">Затем он использует hello **EntityType** тип hello toodetermine свойства каждой сущности:</span><span class="sxs-lookup"><span data-stu-id="4269a-971">It then uses hello **EntityType** property toodetermine hello type of each entity:</span></span>  

```csharp
string filter = TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("PartitionKey",
    QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("RowKey",
                    QueryComparisons.GreaterThanOrEqual, "B"),
        TableOperators.And,
        TableQuery.GenerateFilterCondition("RowKey",
        QueryComparisons.LessThan, "F")
    )
);
TableQuery<DynamicTableEntity> entityQuery =
    new TableQuery<DynamicTableEntity>().Where(filter);
var employees = employeeTable.ExecuteQuery(entityQuery);

IEnumerable<DynamicTableEntity> entities = employeeTable.ExecuteQuery(entityQuery);
foreach (var e in entities)
{
EntityProperty entityTypeProperty;
if (e.Properties.TryGetValue("EntityType", out entityTypeProperty))
{
    if (entityTypeProperty.StringValue == "Employee")
    {
        // Use entityTypeProperty, RowKey, PartitionKey, Etag, and Timestamp
        }
    }
}  
```

<span data-ttu-id="4269a-972">Обратите внимание, что tooretrieve другие свойства, необходимо использовать hello **TryGetValue** метод hello **свойства** свойство hello **DynamicTableEntity** класса.</span><span class="sxs-lookup"><span data-stu-id="4269a-972">Note that tooretrieve other properties you must use hello **TryGetValue** method on hello **Properties** property of hello **DynamicTableEntity** class.</span></span>  

<span data-ttu-id="4269a-973">Третий вариант — использование hello toocombine **DynamicTableEntity** типа и **EntityResolver** экземпляра.</span><span class="sxs-lookup"><span data-stu-id="4269a-973">A third option is toocombine using hello **DynamicTableEntity** type and an **EntityResolver** instance.</span></span> <span data-ttu-id="4269a-974">Это позволяет типами POCO toomultiple tooresolve в hello того же запроса.</span><span class="sxs-lookup"><span data-stu-id="4269a-974">This enables you tooresolve toomultiple POCO types in hello same query.</span></span> <span data-ttu-id="4269a-975">В этом примере hello **EntityResolver** делегат использует hello **EntityType** toodistinguish свойство между типами hello две сущности, запрос возвращает hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-975">In this example, hello **EntityResolver** delegate is using hello **EntityType** property toodistinguish between hello two types of entity that hello query returns.</span></span> <span data-ttu-id="4269a-976">Hello **Разрешить** метод использует hello **Сопоставитель** делегировать tooresolve **DynamicTableEntity** экземпляров слишком**TableEntity** экземпляров.</span><span class="sxs-lookup"><span data-stu-id="4269a-976">hello **Resolve** method uses hello **resolver** delegate tooresolve **DynamicTableEntity** instances too**TableEntity** instances.</span></span>  

```csharp
EntityResolver<TableEntity> resolver = (pk, rk, ts, props, etag) =>
{

        TableEntity resolvedEntity = null;
        if (props["EntityType"].StringValue == "Department")
        {
        resolvedEntity = new DepartmentEntity();
        }
        else if (props["EntityType"].StringValue == "Employee")
        {
        resolvedEntity = new EmployeeEntity();
        }
        else throw new ArgumentException("Unrecognized entity", "props");

        resolvedEntity.PartitionKey = pk;
        resolvedEntity.RowKey = rk;
        resolvedEntity.Timestamp = ts;
        resolvedEntity.ETag = etag;
        resolvedEntity.ReadEntity(props, null);
        return resolvedEntity;
};

string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<DynamicTableEntity> entityQuery =
        new TableQuery<DynamicTableEntity>().Where(filter);

var entities = employeeTable.ExecuteQuery(entityQuery, resolver);
foreach (var e in entities)
{
        if (e is DepartmentEntity)
        {
    ...
        }
        if (e is EmployeeEntity)
        {
    ...
        }
}  
```

#### <a name="modifying-heterogeneous-entity-types"></a><span data-ttu-id="4269a-977">Изменение разных типов сущностей</span><span class="sxs-lookup"><span data-stu-id="4269a-977">Modifying heterogeneous entity types</span></span>
<span data-ttu-id="4269a-978">Тип сущности toodelete tooknow hello не обязательно, а всегда известен тип hello сущности при вставке его.</span><span class="sxs-lookup"><span data-stu-id="4269a-978">You do not need tooknow hello type of an entity toodelete it, and you always know hello type of an entity when you insert it.</span></span> <span data-ttu-id="4269a-979">Тем не менее, можно использовать **DynamicTableEntity** введите tooupdate сущности, не зная его типа и без использования класса сущности POCO.</span><span class="sxs-lookup"><span data-stu-id="4269a-979">However, you can use **DynamicTableEntity** type tooupdate an entity without knowing its type and without using a POCO entity class.</span></span> <span data-ttu-id="4269a-980">Hello следующий образец кода возвращает одну сущность и проверяет hello **EmployeeCount** существует свойство перед его обновлением.</span><span class="sxs-lookup"><span data-stu-id="4269a-980">hello following code sample retrieves a single entity, and checks hello **EmployeeCount** property exists before updating it.</span></span>  

```csharp
TableResult result =
        employeeTable.Execute(TableOperation.Retrieve(partitionKey, rowKey));
DynamicTableEntity department = (DynamicTableEntity)result.Result;

EntityProperty countProperty;

if (!department.Properties.TryGetValue("EmployeeCount", out countProperty))
{
        throw new
        InvalidOperationException("Invalid entity, EmployeeCount property not found.");
}
countProperty.Int32Value += 1;
employeeTable.Execute(TableOperation.Merge(department));  
```

### <a name="controlling-access-with-shared-access-signatures"></a><span data-ttu-id="4269a-981">Управление доступом с помощью подписей общего доступа</span><span class="sxs-lookup"><span data-stu-id="4269a-981">Controlling access with Shared Access Signatures</span></span>
<span data-ttu-id="4269a-982">Можно использовать подпись общего доступа (SAS) токены tooenable клиентских приложений toomodify (и запрос) сущностей таблицы напрямую без tooauthenticate необходимость hello непосредственно с hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-982">You can use Shared Access Signature (SAS) tokens tooenable client applications toomodify (and query) table entities directly without hello need tooauthenticate directly with hello table service.</span></span> <span data-ttu-id="4269a-983">Как правило существует три основных преимущества toousing SAS в приложении:</span><span class="sxs-lookup"><span data-stu-id="4269a-983">Typically, there are three main benefits toousing SAS in your application:</span></span>  

* <span data-ttu-id="4269a-984">Нет необходимости toodistribute хранилища учетной записи ключа tooan небезопасных платформы (например, мобильных устройств) в порядке tooallow tooaccess этого устройства и изменения объектов в hello службы таблиц.</span><span class="sxs-lookup"><span data-stu-id="4269a-984">You do not need toodistribute your storage account key tooan insecure platform (such as a mobile device) in order tooallow that device tooaccess and modify entities in hello Table service.</span></span>  
* <span data-ttu-id="4269a-985">Вы можете разгрузить часть работы hello веб- и рабочих ролей выполнять в управлении устройствами tooclient сущности как компьютеры конечных пользователей и мобильных устройств.</span><span class="sxs-lookup"><span data-stu-id="4269a-985">You can offload some of hello work that web and worker roles perform in managing your entities tooclient devices such as end-user computers and mobile devices.</span></span>  
* <span data-ttu-id="4269a-986">Можно назначить ограниченного и время ограниченный набор разрешений tooa клиента (например, разрешение доступа только для чтения toospecific ресурсы).</span><span class="sxs-lookup"><span data-stu-id="4269a-986">You can assign a constrained and time limited set of permissions tooa client (such as allowing read-only access toospecific resources).</span></span>  

<span data-ttu-id="4269a-987">Дополнительные сведения об использовании токенов SAS с hello службы таблиц см. в разделе [с помощью общего доступа подписи (SAS)](storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="4269a-987">For more information about using SAS tokens with hello Table service, see [Using Shared Access Signatures (SAS)](storage-dotnet-shared-access-signature-part-1.md).</span></span>  

<span data-ttu-id="4269a-988">Однако по-прежнему необходимо создать токены SAS hello, предоставляющими клиент toohello объекты приложения в службе таблиц hello: это необходимо в среде, которая имеет защищенный доступ tooyour ключи учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="4269a-988">However, you must still generate hello SAS tokens that grant a client application toohello entities in hello table service: you should do this in an environment that has secure access tooyour storage account keys.</span></span> <span data-ttu-id="4269a-989">Как правило используется веб- или рабочей роли toogenerate hello SAS маркеры и их toohello клиентские приложения, которые требуется получить доступ к tooyour сущностей.</span><span class="sxs-lookup"><span data-stu-id="4269a-989">Typically, you use a web or worker role toogenerate hello SAS tokens and deliver them toohello client applications that need access tooyour entities.</span></span> <span data-ttu-id="4269a-990">Поскольку по-прежнему издержки участвующие в создании и доставке tooclients маркеры SAS, рассмотрите возможность оптимальных tooreduce эту нагрузку, особенно в крупномасштабных системах.</span><span class="sxs-lookup"><span data-stu-id="4269a-990">Because there is still an overhead involved in generating and delivering SAS tokens tooclients, you should consider how best tooreduce this overhead, especially in high-volume scenarios.</span></span>  

<span data-ttu-id="4269a-991">Это возможно toogenerate маркер SAS, который обеспечивает доступ tooa подмножество hello сущностей в таблице.</span><span class="sxs-lookup"><span data-stu-id="4269a-991">It is possible toogenerate a SAS token that grants access tooa subset of hello entities in a table.</span></span> <span data-ttu-id="4269a-992">По умолчанию создает маркер SAS для всей таблицы, но это также возможно toospecify этой tooeither hello SAS предоставление маркера доступа диапазон **PartitionKey** значений или диапазон **PartitionKey** и  **RowKey** значения.</span><span class="sxs-lookup"><span data-stu-id="4269a-992">By default, you create a SAS token for an entire table, but it is also possible toospecify that hello SAS token grant access tooeither a range of **PartitionKey** values, or a range of **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4269a-993">Можно выбрать toogenerate маркеры SAS для отдельных пользователей системы таким образом, что маркер SAS для каждого пользователя предоставляет им доступ только служба таблиц tootheir собственные сущностей в hello.</span><span class="sxs-lookup"><span data-stu-id="4269a-993">You might choose toogenerate SAS tokens for individual users of your system such that each user's SAS token only allows them access tootheir own entities in hello table service.</span></span>  

### <a name="asynchronous-and-parallel-operations"></a><span data-ttu-id="4269a-994">Асинхронные и параллельные операции</span><span class="sxs-lookup"><span data-stu-id="4269a-994">Asynchronous and parallel operations</span></span>
<span data-ttu-id="4269a-995">Чтобы улучшить производительность и время отклика клиента в случае распределения запросов по нескольким разделам, рекомендуется обратить внимание на асинхронные и параллельные запросы.</span><span class="sxs-lookup"><span data-stu-id="4269a-995">Provided you are spreading your requests across multiple partitions, you can improve throughput and client responsiveness by using asynchronous or parallel queries.</span></span>
<span data-ttu-id="4269a-996">Например, в вашем распоряжении может быть два или несколько экземпляров рабочих ролей с параллельным доступом к таблицам.</span><span class="sxs-lookup"><span data-stu-id="4269a-996">For example, you might have two or more worker role instances accessing your tables in parallel.</span></span> <span data-ttu-id="4269a-997">Может иметь отдельные рабочие роли, ответственный за отдельные наборы разделов или просто иметь несколько экземпляров рабочей роли, каждый может tooaccess все hello секций в таблице.</span><span class="sxs-lookup"><span data-stu-id="4269a-997">You could have individual worker roles responsible for particular sets of partitions, or simply have multiple worker role instances, each able tooaccess all hello partitions in a table.</span></span>  

<span data-ttu-id="4269a-998">Повысить производительность в экземпляре клиента можно путем асинхронного выполнения операций хранения.</span><span class="sxs-lookup"><span data-stu-id="4269a-998">Within a client instance, you can improve throughput by executing storage operations asynchronously.</span></span> <span data-ttu-id="4269a-999">Hello клиентская библиотека хранилища позволяет легко toowrite асинхронные запросы и изменения.</span><span class="sxs-lookup"><span data-stu-id="4269a-999">hello Storage Client Library makes it easy toowrite asynchronous queries and modifications.</span></span> <span data-ttu-id="4269a-1000">Например можно начать с hello синхронный метод, который извлекает все сущности hello в секции, как показано в hello, следующий код C#:</span><span class="sxs-lookup"><span data-stu-id="4269a-1000">For example, you might start with hello synchronous method that retrieves all hello entities in a partition as shown in hello following C# code:</span></span>  

```csharp
private static void ManyEntitiesQuery(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

        TableContinuationToken continuationToken = null;

        do
        {
        var employees = employeeTable.ExecuteQuerySegmented(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
    {
        ...
    }
        continuationToken = employees.ContinuationToken;
        } while (continuationToken != null);
}  
```

<span data-ttu-id="4269a-1001">Этот код можно легко изменить, поэтому этот запрос hello выполняется асинхронно, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="4269a-1001">You can easily modify this code so that hello query runs asynchronously as follows:</span></span>  

```csharp
private static async Task ManyEntitiesQueryAsync(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);
        TableContinuationToken continuationToken = null;

        do
        {
        var employees = await employeeTable.ExecuteQuerySegmentedAsync(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
        {
            ...
        }
        continuationToken = employees.ContinuationToken;
            } while (continuationToken != null);
}  
```

<span data-ttu-id="4269a-1002">В этом примере асинхронного видно hello следующие изменения из hello синхронной версии:</span><span class="sxs-lookup"><span data-stu-id="4269a-1002">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="4269a-1003">Сигнатура метода Hello теперь включает hello **async** модификатор и возвращает **задачи** экземпляра.</span><span class="sxs-lookup"><span data-stu-id="4269a-1003">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="4269a-1004">Вместо вызова hello **ExecuteSegmented** tooretrieve результаты метода, теперь вызовы hello метод hello **ExecuteSegmentedAsync** метод и использует hello **await** модификатор tooretrieve приводит асинхронно.</span><span class="sxs-lookup"><span data-stu-id="4269a-1004">Instead of calling hello **ExecuteSegmented** method tooretrieve results, hello method now calls hello **ExecuteSegmentedAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="4269a-1005">клиентское приложение Hello этот метод можно вызывать несколько раз (с разными значениями hello **отдел** параметра), и каждый запрос будет выполняться в отдельном потоке.</span><span class="sxs-lookup"><span data-stu-id="4269a-1005">hello client application can call this method multiple times (with different values for hello **department** parameter), and each query will run on a separate thread.</span></span>  

<span data-ttu-id="4269a-1006">Обратите внимание, что нет асинхронную версию hello **Execute** метод в hello **TableQuery** класса, так как hello **IEnumerable** интерфейс не поддерживает асинхронные перечисление.</span><span class="sxs-lookup"><span data-stu-id="4269a-1006">Note that there is no asynchronous version of hello **Execute** method in hello **TableQuery** class because hello **IEnumerable** interface does not support asynchronous enumeration.</span></span>  

<span data-ttu-id="4269a-1007">Можно вставлять, обновлять и удалять сущности в асинхронном режиме.</span><span class="sxs-lookup"><span data-stu-id="4269a-1007">You can also insert, update, and delete entities asynchronously.</span></span> <span data-ttu-id="4269a-1008">Следующий пример на C# Hello показывает tooinsert простой, синхронный метод или замены сущности employee:</span><span class="sxs-lookup"><span data-stu-id="4269a-1008">hello following C# example shows a simple, synchronous method tooinsert or replace an employee entity:</span></span>  

```csharp
private static void SimpleEmployeeUpsert(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = employeeTable
        .Execute(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="4269a-1009">Этот код можно легко изменить, чтобы обновление hello выполняется асинхронно, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="4269a-1009">You can easily modify this code so that hello update runs asynchronously as follows:</span></span>  

```csharp
private static async Task SimpleEmployeeUpsertAsync(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = await employeeTable
        .ExecuteAsync(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="4269a-1010">В этом примере асинхронного видно hello следующие изменения из hello синхронной версии:</span><span class="sxs-lookup"><span data-stu-id="4269a-1010">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="4269a-1011">Сигнатура метода Hello теперь включает hello **async** модификатор и возвращает **задачи** экземпляра.</span><span class="sxs-lookup"><span data-stu-id="4269a-1011">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="4269a-1012">Вместо вызова hello **Execute** метод tooupdate hello сущность, теперь вызовы hello метод hello **ExecuteAsync** метод и использует hello **await** tooretrieve модификатор результаты асинхронно.</span><span class="sxs-lookup"><span data-stu-id="4269a-1012">Instead of calling hello **Execute** method tooupdate hello entity, hello method now calls hello **ExecuteAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="4269a-1013">Hello клиентское приложение может вызывать несколько асинхронных методов такого рода, и каждый вызов метода будет выполняться в отдельном потоке.</span><span class="sxs-lookup"><span data-stu-id="4269a-1013">hello client application can call multiple asynchronous methods like this one, and each method invocation will run on a separate thread.</span></span>  

### <a name="credits"></a><span data-ttu-id="4269a-1014">Баллы</span><span class="sxs-lookup"><span data-stu-id="4269a-1014">Credits</span></span>
<span data-ttu-id="4269a-1015">Мы хотели бы hello toothank следующие члены hello команды Azure их достижениями: Dominic Betts, Джейсон Хогг, Жан Ghanem, Джей Харидас, Джефф Ирвин, Vamshidhar Kommineni, Vinay Козлов и Serdar Ozler а также (Tom Hollander) из Microsoft DX.</span><span class="sxs-lookup"><span data-stu-id="4269a-1015">We would like toothank hello following members of hello Azure team for their contributions: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah and Serdar Ozler as well as  Tom Hollander from Microsoft DX.</span></span> 

<span data-ttu-id="4269a-1016">Мы также предлагаем hello toothank следующего Microsoft MVP по их мнение во время проверки циклов: Игорь Papirov и Эдвард Bakker.</span><span class="sxs-lookup"><span data-stu-id="4269a-1016">We would also like toothank hello following Microsoft MVP's for their valuable feedback during review cycles: Igor Papirov and Edward Bakker.</span></span>

[1]: ./media/storage-table-design-guide/storage-table-design-IMAGE01.png
[2]: ./media/storage-table-design-guide/storage-table-design-IMAGE02.png
[3]: ./media/storage-table-design-guide/storage-table-design-IMAGE03.png
[4]: ./media/storage-table-design-guide/storage-table-design-IMAGE04.png
[5]: ./media/storage-table-design-guide/storage-table-design-IMAGE05.png
[6]: ./media/storage-table-design-guide/storage-table-design-IMAGE06.png
[7]: ./media/storage-table-design-guide/storage-table-design-IMAGE07.png
[8]: ./media/storage-table-design-guide/storage-table-design-IMAGE08.png
[9]: ./media/storage-table-design-guide/storage-table-design-IMAGE09.png
[10]: ./media/storage-table-design-guide/storage-table-design-IMAGE10.png
[11]: ./media/storage-table-design-guide/storage-table-design-IMAGE11.png
[12]: ./media/storage-table-design-guide/storage-table-design-IMAGE12.png
[13]: ./media/storage-table-design-guide/storage-table-design-IMAGE13.png
[14]: ./media/storage-table-design-guide/storage-table-design-IMAGE14.png
[15]: ./media/storage-table-design-guide/storage-table-design-IMAGE15.png
[16]: ./media/storage-table-design-guide/storage-table-design-IMAGE16.png
[17]: ./media/storage-table-design-guide/storage-table-design-IMAGE17.png
[18]: ./media/storage-table-design-guide/storage-table-design-IMAGE18.png
[19]: ./media/storage-table-design-guide/storage-table-design-IMAGE19.png
[20]: ./media/storage-table-design-guide/storage-table-design-IMAGE20.png
[21]: ./media/storage-table-design-guide/storage-table-design-IMAGE21.png
[22]: ./media/storage-table-design-guide/storage-table-design-IMAGE22.png
[23]: ./media/storage-table-design-guide/storage-table-design-IMAGE23.png
[24]: ./media/storage-table-design-guide/storage-table-design-IMAGE24.png
[25]: ./media/storage-table-design-guide/storage-table-design-IMAGE25.png
[26]: ./media/storage-table-design-guide/storage-table-design-IMAGE26.png
[27]: ./media/storage-table-design-guide/storage-table-design-IMAGE27.png
[28]: ./media/storage-table-design-guide/storage-table-design-IMAGE28.png
[29]: ./media/storage-table-design-guide/storage-table-design-IMAGE29.png

