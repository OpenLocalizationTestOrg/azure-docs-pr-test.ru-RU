---
title: "Поиск неструктурированных данных в облачном хранилище Azure"
description: "Поиск неструктурированных данных с помощью службы поиска Azure."
author: roygara
manager: timlt
services: storage
ms.service: storage
ms.topic: tutorial
ms.date: 10/12/2017
ms.author: rogara
ms.custom: mvc
ms.openlocfilehash: 930b735eb03aea6ce701b694ca527049b4c3f24d
ms.sourcegitcommit: 9ae92168678610f97ed466206063ec658261b195
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2017
---
# <a name="search-unstructured-data-in-cloud-storage"></a>Поиск неструктурированных данных в облачном хранилище

Из этого руководства вы узнаете, как выполнять поиск неструктурированных данных с помощью службы [Поиск Azure](../../search/search-what-is-azure-search.md), используя данные, хранящиеся в больших двоичных объектах Azure. Неструктурированные данные — это данные, не упорядоченные по заранее определенным показателям, или данные, для которых не используется модель данных. Примером может служить TXT-файл.

Из этого руководства вы узнаете, как выполнить следующие задачи:

> [!div class="checklist"]
> * Создание группы ресурсов
> * Создайте учетную запись хранения.
> * Создание контейнера
> * Отправка данных в контейнер.
> * Создание службы поиска Azure с помощью портала.
> * Использование службы поиска для поиска в контейнере.

## <a name="download-the-sample"></a>Скачивание примера приложения

Для вас подготовлен пример набора данных. **Загрузите файл [clinical-trials.zip](https://github.com/Azure-Samples/storage-blob-integration-with-cdn-search-hdi/raw/master/clinical-trials.zip)** и распакуйте его в собственной папке.

Пример состоит из текстовых файлов, полученных с сайта [clinicaltrials.gov](https://clinicaltrials.gov/ct2/results). Их можно использовать в качестве примера текстовых файлов для поиска с помощью Azure.

## <a name="log-in-to-azure"></a>Вход в Azure

Войдите на [портал Azure](http://portal.azure.com).

## <a name="create-a-storage-account"></a>Создайте учетную запись хранения.

Учетная запись хранения предоставляет уникальное расположение для хранения ваших объектов данных в службе хранилища Azure и доступа к ним.

Сейчас есть два типа учетных записей хранения: **большой двоичный объект** и **общего назначения**. В рамках этого руководства вы создадите учетную запись хранения **общего назначения**.

Если вы не знакомы с процессом создания учетной записи хранения общего назначения, вот как это можно сделать:

1. В меню слева выберите **Учетные записи хранения**, а затем — **Добавить**.

2. Введите уникальное имя учетной записи хранения. 

3. Выберите **Resource Manager** в качестве **модели развертывания** и выберите **Общего назначения** в раскрывающемся списке **Account kind** (Тип учетной записи).

4. Выберите **Locally-redundant storage (LRS)** (Локально избыточное хранилище) в раскрывающемся списке **Репликация**.

5. В разделе **Группа ресурсов** выберите **Создать новый** и введите уникальное имя.

6. Выберите соответствующую подписку.

7. Выберите расположение и нажмите кнопку **Создать**

  ![Неструктурированный поиск](media/storage-unstructured-search/storagepanes2.png)

## <a name="create-a-container"></a>Создание контейнера

Контейнеры похожи на папки и используются для хранения больших двоичных объектов.

В этом руководстве используется один контейнер для хранения текстовых файлов, полученных с сайта clinicaltrials.gov.

1. Войдите в свою учетную запись хранения на портале Azure.

2. Выберите **Browse blobs** (Обзор больших двоичных объектов) в разделе **Blob Service** (Служба BLOB-объектов).

3. Добавьте новый контейнер.

4. Присвойте контейнеру имя "data" и выберите **Контейнер** для уровня общего доступа.

5. Нажмите кнопку **ОК**, чтобы создать контейнер. 

  ![Неструктурированный поиск](media/storage-unstructured-search/storageactinfo.png)

## <a name="upload-the-example-data"></a>Отправка примера данных

Теперь, когда вы создали контейнер, в него можно передать пример данных.

1. Выберите контейнер и щелкните **Отправить**.

2. Выберите значок синей папки рядом с полем "Файлы" и перейдите к локальной папке, в которую извлечен пример данных.

3. Выберите все извлеченные файлы и нажмите кнопку **Открыть**.

4. Нажмите кнопку **Отправить**, чтобы начать процесс отправки.

  ![Неструктурированный поиск](media/storage-unstructured-search/upload.png)

Процесс отправки может занять некоторое время.

После его завершения перейдите обратно в контейнер данных, чтобы подтвердить отправку текстовых файлов.

  ![Неструктурированный поиск](media/storage-unstructured-search/clinicalfolder.png)

## <a name="create-a-search-service"></a>Создание службы поиска

Поиск Azure — это облачное решение по модели "поиск как услуга", которое предоставляет разработчикам API и средства для реализации расширенных возможностей поиска в веб-, мобильных и корпоративных приложениях.

Если вы не знакомы с процессом создания службы поиска, вот как это можно сделать:

1. Войдите в свою учетную запись хранения на портале Azure.

2. Прокрутите список вниз и нажмите кнопку **Добавить Поиск Azure** в разделе **Blob Service** (Служба BLOB-объектов).

3. В разделе **Импорт данных** щелкните **Выберите свою службу**.

4. Щелкните ссылку **Щелкните здесь, чтобы создать службу поиска**.

5. В разделе **Новая служба поиска** введите уникальное имя для службы поиска в поле **URL-адрес**.

6. В разделе **Группа ресурсов** активируйте параметр **Использовать имеющийся** и выберите созданную ранее группу ресурсов.

7. Для пункта **Ценовая категория** выберите уровень **Бесплатный** и нажмите кнопку **Выбрать**.

8. Нажмите кнопку **Создать**, чтобы создать службу поиска.

  ![Неструктурированный поиск](media/storage-unstructured-search/createsearch2.png)

## <a name="connect-your-search-service-to-your-container"></a>Подключение службы поиска к контейнеру

Теперь, когда служба поиска создана, можно подключить ее к хранилищу BLOB-объектов. В этом разделе описывается процесс выбора источника данных, создания индекса и индексатора.

1. Войдите в свою учетную запись хранения.

2. Выберите **Добавить Поиск Azure** в разделе **Blob Service** (Служба BLOB-объектов).

3. Выберите **Служба поиска** в разделе **Импорт данных**, а затем щелкните службу поиска, созданную в предыдущем разделе. После этого откроется раздел **Новый источник данных**.

### <a name="new-data-source"></a>Новый источник данных

  Источник данных указывает, какие данные необходимо индексировать, а также как получить к ним доступ. Источник данных можно использовать несколько раз в одной и той же службе поиска.

1. Введите имя источника данных. В разделе **Извлекаемые данные** выберите **Контент и метаданные**. Источник данных указывает, какие части большого двоичного объекта индексируются.
    
    а. В ваших будущих сценариях вы сможете также выбрать **Только метаданные хранилища**. Этот параметр можно выбрать, если необходимо ограничить данные, которые индексируются в стандартные свойства большого двоичного объекта или определяемые пользователем свойства.
    
    b. Вы также можете выбрать **Все метаданные**, чтобы получить стандартные свойства больших двоичных объектов и метаданные *всех* типов содержимого. 

2. Так как используемые большие двоичные объекты — это текстовые файлы, задайте для параметра **Режим анализа** значение **Текстовый**.
    
    а. В своих будущих сценариях вам может потребоваться выбрать [другие режимы анализа](../../search/search-howto-indexing-azure-blob-storage.md) в зависимости от содержимого больших двоичных объектов.

  ![Неструктурированный поиск](media/storage-unstructured-search/datasources.png)

3. Выберите **Контейнер хранилища**, чтобы вывести список доступных учетных записей хранения.

4. Выберите учетную запись хранения, а затем — ранее созданный контейнер.

5. Нажмите кнопку **Выбрать**, чтобы вернуться к разделу **Новый источник данных**, а затем нажмите кнопку **ОК**, чтобы продолжить.

  ![Неструктурированный поиск](media/storage-unstructured-search/datacontainer.png)

### <a name="configure-the-index"></a>Настройка индекса

  Индекс представляет собой коллекцию полей из источника данных, по которым можно выполнять поиск. Индекс определяет способы, используемые службой поиска для выполнения поиска данных.

1. В разделе **Импорт данных** выберите **Настроить целевой индекс**.
 
2. Введите имя индекса в поле **Имя индекса**.

3. Установите флажок атрибута **Извлекаемый** в разделе **metadata_storage_name**.

  ![Неструктурированный поиск](media/storage-unstructured-search/valuestoselect.png)

4. Нажмите кнопку **ОК**, чтобы появился раздел **Создать индексатор**.

Параметры индекса и атрибуты, присваиваемые этим параметрам, имеют значение. Параметры указывают *тип* данных для хранения, а атрибуты — *способ* хранения этих данных.

Столбец **Имя поля** содержит параметры. В следующей таблице представлен список доступных атрибутов и их описания.

### <a name="field-attributes"></a>Атрибуты полей
| Атрибут | Описание |
| --- | --- |
| *Ключ* |Уникальный строковый идентификатор (ключ) каждого документа, по которому выполняется обращение к документам. У каждого индекса должен быть один ключ. Ключом может быть только одно поле; в качестве его типа должно быть задано значение Edm.String. |
| *Доступный для получения* |Указывает, возвращать ли поле в результатах поиска. |
| *Фильтруемый* |Позволяет использовать поле в запросах фильтра. |
| *Сортируемый* |Позволяет с помощью этого поля сортировать результаты поиска при запросе. |
| *Facetable* |Позволяет использовать поле в структуре фасетной навигации для автоматической фильтрации пользователем. Обычно для фасетной навигации подходят поля, содержащие повторяющиеся значения, которые можно использовать для группирования различных документов (например, если несколько документов относятся к одной и той же категории или к одному производителю). |
| *Доступный для поиска* |Помечает поле как доступное для полнотекстового поиска. |


### <a name="create-an-indexer"></a>Создание индексатора
    
  Индексатор соединяет источник данных с индексом поиска, а также предоставляет расписание для повторной индексации данных.

1. Заполните поле **Имя** и нажмите кнопку **ОК**.

  ![Неструктурированный поиск](media/storage-unstructured-search/exindexer.png)

2. Вы вернетесь в раздел **Импорт данных**. Нажмите кнопку **ОК**, чтобы завершить процесс подключения.

Вы успешно подключили большой двоичный объект к службе поиска. На портале заполнение индекса отображается с задержкой в несколько минут. Но служба поиска начинает выполнять индексирование сразу же, поэтому вы можете начать поиск прямо сейчас.

## <a name="search-your-text-files"></a>Поиск по текстовым файлам

Чтобы выполнить поиск по файлам, откройте проводник поиска в индексе только что созданной службы поиска.

Далее описывается, где можно найти обозреватель поиска, а также предоставлены некоторые примеры запросов.

1. Перейдите ко всем ресурсам и найдите только что созданную службу поиска.

  ![Неструктурированный поиск](media/storage-unstructured-search/exampleurl.png)

3. Выберите индекс, чтобы открыть его. 

  ![Неструктурированный поиск](media/storage-unstructured-search/overview.png)

4. Выберите **Проводник поиска**, чтобы открыть проводник поиска, из которого можно выполнять активные запросы данных.

  ![Неструктурированный поиск](media/storage-unstructured-search/indexespane.png)

5. Оставьте поле строки запроса пустым и выберите **Поиск**. Пустой запрос возвращает *все* данные из больших двоичных объектов.

  ![Неструктурированный поиск](media/storage-unstructured-search/emptySearch.png)

### <a name="full-text-search"></a>полнотекстовый поиск. 

Введите "Myopia" в поле **Строка запроса** и выберите **Поиск**. Будет запущен поиск содержимого файлов и возвращено их подмножество, содержащее слово "Myopia".

  ![Неструктурированный поиск](media/storage-unstructured-search/secondMyopia.png) 

### <a name="system-properties-search"></a>Поиск системных свойств

Вы можете также создавать запросы, которые выполняют поиск по системным свойствам, с помощью параметра `$select`. Введите `$select=metadata_storage_name` в строке запроса и нажмите клавишу ВВОД, чтобы было возвращено только это определенное поле.
    
Строка запроса непосредственно изменяет URL-адрес, поэтому пробелы не допускаются. Для поиска нескольких полей используйте запятую, например `$select=metadata_storage_name,metadata_storage_path`.
    
При определении индекса параметр `$select` можно использовать только с полями, помеченными как извлекаемые.

  ![Неструктурированный поиск](media/storage-unstructured-search/metadatasearchunstructured.png) 

Вы завершили ознакомление с этим руководством, и теперь у вас есть доступный для поиска набор неструктурированных данных.

## <a name="next-steps"></a>Дальнейшие действия

Из этого руководства вы узнали о поиске неструктурированных данных с помощью службы поиска Azure, а также о том, как выполнять следующие задачи:

> [!div class="checklist"]
> * Создание группы ресурсов
> * Создайте учетную запись хранения.
> * Создание контейнера
> * отправка данных в контейнер;
> * создание службы поиска;
> * использование службы поиска для поиска в контейнере.

Перейдите по ссылке, чтобы узнать больше об индексировании документов с использованием службы "Поиск Azure".

> [!div class="nextstepaction"]
> [Индексирование документов в хранилище BLOB-объектов Azure с помощью службы поиска Azure](../../search/search-howto-indexing-azure-blob-storage.md)