---
title: "руководство по безопасности хранилища aaaAzure | Документы Microsoft"
description: "Сведения о hello многие методы обеспечения безопасности хранилища Azure, включая, помимо прочего tooRBAC, шифрование службы хранилища, шифрования на стороне клиента, SMB 3.0 и шифрование диска Azure."
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 6f931d94-ef5a-44c6-b1d9-8a3c9c327fb2
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 12/08/2016
ms.author: robinsh
ms.openlocfilehash: 1f5a4e724e00ea6d16f5511b9120154f89441758
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-security-guide"></a>Руководство по безопасности службы хранилища Azure
## <a name="overview"></a>Обзор
Хранилище Azure предоставляет широкий набор возможностей безопасности, которые вместе позволяют разработчикам toobuild безопасных приложений. Учетная запись хранения Hello сам могут быть защищены с помощью управления доступом на основе ролей и Azure Active Directory. Защитить данные, передаваемые между приложением и Azure, можно с помощью [шифрования на стороне клиента](../storage-client-side-encryption.md), HTTPS или SMB 3.0. Данные могут быть определены toobe, автоматически шифруются при записи хранилища с помощью tooAzure [шифрование службы хранилища (SSE)](storage-service-encryption.md). Диски операционной системы и данных, используемым виртуальными машинами можно задать toobe, зашифрованные с помощью [шифрование диска Azure](../../security/azure-security-disk-encryption.md). Объекты данных toohello делегированный доступ в хранилище Azure можно предоставить с помощью [подписей общего доступа](../storage-dotnet-shared-access-signature-part-1.md).

В этой статье содержатся общие сведения о функциях безопасности, которые можно использовать в службе хранилища Azure. Tooarticles, вы получите подробные сведения каждого компонента, можно легко сделать, приводятся соответствующие ссылки Дальнейшее изучение проблемы на каждый раздел.

Ниже приведены hello toobe разделы, описанные в данной статье.

* [Безопасность плоскости управления](#management-plane-security) — защита учетной записи хранения

  Hello плоскости управления состоит из toomanage hello ресурсы, используемые вашей учетной записи хранилища. В этом разделе будет рассказано о модели развертывания диспетчера ресурсов Azure hello и доступом учетных записей хранения tooyour toocontrol toouse управление доступом на основе ролей (RBAC). Также мы поговорим об управлении ключами вашей учетной записи хранилища и как tooregenerate их.
* [Безопасность данных плоскости](#data-plane-security) — tooYour безопасность доступа к данным

  В этом разделе мы рассмотрим доступ toohello фактические данные объектов в вашей учетной записи хранилища больших двоичных объектов, файлов, очередей и таблиц, с помощью подписей общего доступа и хранимые политики доступа. Будут рассмотрены подписанные URL-адреса как уровня службы, так и уровня учетной записи. Мы также отображаются как toolimit доступ к tooa определенный IP-адрес (или диапазон IP-адресов), как использовать протокол hello toolimit tooHTTPS и как toorevoke a подписи общего доступа, не ожидая его tooexpire.
* [Шифрование при передаче](#encryption-in-transit)

  В этом разделе рассматриваются как toosecure данных при передаче в или из хранилища Azure. Мы рассмотрим hello, рекомендуется использовать HTTPS и hello шифрования SMB 3.0 для общих ресурсов Azure. Мы будет также рассмотрим шифрования на стороне клиента, включающий tooencrypt hello данные перед передачей в хранилище в клиентском приложении и данные hello toodecrypt после передачи из хранилища.
* [Шифрование при хранении](#encryption-at-rest)

  Мы поговорим о шифрование службы хранилища (SSE), и как можно включить для учетной записи хранения, приведет к блочные, страничные большие двоичные объекты и добавление большие двоичные объекты автоматически шифруются при записи tooAzure хранилища. Мы также рассмотрим как можно использовать шифрование диска Azure и изучите основные различия hello и варианты шифрования диска и SSE и шифрования на стороне клиента. Вкратце будут рассмотрены вопросы обеспечения соответствия FIPS на компьютерах, используемых в государственных учреждениях США.
* С помощью [аналитики хранилища](#storage-analytics) tooaudit доступа хранилища Azure

  В этом разделе рассматриваются как toofind сведения в hello аналитики хранилища журналов для запроса. Мы рассмотрим аналитики хранилища реальные данные журнала и в разделе как toodiscern ли запрос сделан с hello хранилища ключ, с подписью общего доступа, учетной записи или анонимно и является ли она успешно или с ошибкой.
* [Поддержка браузерных клиентов с помощью CORS](#Cross-Origin-Resource-Sharing-CORS)

  В этом разделе рассказывается о том, как tooallow ресурсов (CORS) для управления доступом. Мы рассмотрим междоменный доступ и как toohandle его с возможностями CORS hello построен в службе хранилища Azure.

## <a name="management-plane-security"></a>Безопасность плоскости управления
Hello плоскости управления состоит из операций, которые влияют на учетную запись хранения hello сам. Например можно создать или удалить учетную запись хранения, получения списка учетных записей хранения в подписке, получения ключей учетной записи хранения hello или повторно создать ключи учетной записи хранения hello.

При создании учетной записи хранения необходимо выбрать модель развертывания: классическую или на основе Resource Manager. Hello классической модели во время создания ресурсов Azure допускает только доступа отдельных toohello подписки и в свою очередь, hello учетной записи хранилища.

Это руководство посвящено модель диспетчера ресурсов hello hello, рекомендуется использовать средства создания учетных записей хранилища. С помощью учетных записей хранения Resource Manager hello, а не всей подписки toohello Отмена доступа можно управлять доступом на более конечного уровня toohello плоскости управления с помощью управления доступом на основе ролей (RBAC).

### <a name="how-toosecure-your-storage-account-with-role-based-access-control-rbac"></a>Как toosecure вашей учетной записи хранилища с помощью управления доступом на основе ролей (RBAC)
Рассмотрим систему управления доступом на основе ролей и способы ее использования. Каждая подписка Azure имеет каталог Azure Active Directory. Пользователи, группы и приложения из этого каталога можно предоставить доступ toomanage ресурсы hello подписки Azure, использующие модель развертывания диспетчера ресурсов hello. Это ссылка tooas управление доступом на основе ролей (RBAC). toomanage этот доступ, можно использовать hello [портал Azure](https://portal.azure.com/), hello [средства Azure CLI](../../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), или hello [API REST поставщика ресурсов хранилища Azure ](https://msdn.microsoft.com/library/azure/mt163683.aspx).

С моделью hello диспетчера ресурсов поместите hello учетной записи хранилища в ресурсов группы и контроль доступа toohello управления плоскости из этой конкретной учетной записи хранения с помощью Azure Active Directory. Например можно предоставить определенным пользователям hello возможность tooaccess hello ключи учетной записи хранения, другим пользователям можно просмотреть сведения об учетной записи хранилища hello, но не может получить доступ к hello ключи учетной записи хранения.

#### <a name="granting-access"></a>Предоставление доступа
Доступ предоставляется путем назначения hello соответствующие RBAC роли toousers, группы и приложения, в правой области hello. toogrant доступа toohello всей подписки, при назначении роли на уровне подписки hello. Посредством предоставления разрешений toohello ресурсов самой группе можно предоставить доступ tooall hello ресурсов в группе ресурсов. Можно также назначить конкретным ролям toospecific ресурсы, такие как учетные записи хранения.

Ниже приведены основные аспекты hello необходимые tooknow об использовании операций управления hello RBAC tooaccess учетной записи хранилища Azure.

* При назначении доступ, по сути назначении роли toohello учетной записью, которую toohave доступа. Можно управлять toomanage операции, используемые toohello доступ этой учетной записи хранения, но не данные toohello объекты в учетной записи hello. Например можно предоставить разрешение свойства hello tooretrieve hello учетной записи хранилища (например, резервирования), но не tooa контейнера и данных внутри контейнера в хранилище больших двоичных объектов.
* Для кого-либо разрешение tooaccess toohave hello объекты данных в учетной записи хранения hello, вы даете им ключи учетной записи разрешение tooread hello и, пользователь может использовать эти ключи tooaccess hello BLOB-объектов, очередей, таблиц и файлов.
* Роли могут назначаться tooa определенной учетной записи пользователя, группы пользователей или tooa конкретного приложения.
* Каждая роль имеет список разрешенных и запрещенных действий. Например, роль виртуальной машины участника hello имеет действие «listKeys», позволяющее считывать toobe ключи учетной записи хранилища hello. Hello участник имеет «Не действия» как обновление hello доступ для пользователей в Active Directory hello.
* Роли для хранения причинами (но не ограничиваются) hello следующее:

  * "Владелец" — может управлять всем, включая доступ.
  * Участник — это можно сделать что-либо владелец hello можно, за исключением назначение доступа. Пользователь с этой ролью можно просматривать и повторно создать ключи учетной записи хранения hello. С помощью ключей учетной записи хранилища hello они обращаются к hello объектов данных.
  * Модуль чтения — они могут просматривать сведения об учетной записи хранилища hello, за исключением секретные данные. Например при назначении роли с разрешениями чтения на toosomeone учетной записи хранилища hello, они могут просматривать свойства hello hello учетной записи хранилища, но они не могут вносить изменения в свойства toohello или просмотреть ключи учетной записи хранения hello.
  * Участник учетной записи хранилища — они могут управлять hello учетной записи хранилища — они смогут прочесть hello подписки и групп ресурсов и создавать и управлять развертывания группы ресурсов подписки. Они также могут получить hello ключи учетной записи хранилища, которые в свою очередь означает, что можно получить доступ к информационной панели hello.
  * Администратор доступа пользователя — они управляют учетная запись хранения toohello доступа пользователя. Например они могут предоставлять чтения доступа tooa конкретного пользователя.
  * Участник виртуальной машины — они могут управлять виртуальными машинами, но не hello хранилища учетной записи toowhich которому они подключены. Эту роль можно перечислить ключи учетной записи хранения hello, это означает, что hello toowhom пользователя, назначить эту роль можно обновить hello информационной панели.

    Чтобы пользователь toocreate виртуальной машины они имеют toobe может toocreate hello соответствующие VHD-файл в учетной записи хранения. toodo, что они нуждаются в хранилища hello может tooretrieve toobe ключ учетной записи и передать его API toohello Создание hello виртуальной Машины. Таким образом они должны обладать этим разрешением, поэтому их можно перечислить ключи учетной записи хранения hello.
* Hello возможность toodefine пользовательские роли — это функция, позволяющая toocompose набор действий из списка доступных действий, которые могут быть выполнены в ресурсах Azure.
* Hello пользователем toobe, Настройка в Azure Active Directory, перед тем как назначать toothem роли.
* Можно создать отчет, предоставлено или отменено какой доступ или из которого и в какой области, с помощью PowerShell или Azure CLI hello.

#### <a name="resources"></a>Ресурсы
* [Контроль доступа на основе ролей Azure Active Directory](../../active-directory/role-based-access-control-configure.md)

  В этой статье описываются hello управления доступом на основе роли Azure Active Directory и как он работает.
* [RBAC: встроенные роли](../../active-directory/role-based-access-built-in-roles.md)

  В этой статье подробно описываются hello встроенные роли, имеющиеся в RBAC.
* [Общие сведения о развертывании диспетчера ресурсов и классическом развертывании](../../azure-resource-manager/resource-manager-deployment-model.md)

  В этой статье объясняется развертывания диспетчера ресурсов hello и классическое развертывание модели и объясняет преимущества hello hello группы диспетчера ресурсов и ресурсов. Он объясняется работа hello вычислений Azure, поставщиков хранилища и сети в рамках модели hello диспетчера ресурсов.
* [Управление на основе ролей управления доступом с помощью API-интерфейса REST hello](../../active-directory/role-based-access-control-manage-access-rest.md)

  В этой статье показано, как toouse hello toomanage API-интерфейса REST RBAC.
* [Справочник по API REST поставщика ресурсов службы хранилища Azure](https://msdn.microsoft.com/library/azure/mt163683.aspx)

  Это ссылка hello для hello API-интерфейсы, можно использовать toomanage учетную запись хранилища программным образом.
* [Tooauth руководство разработчика с API диспетчера ресурсов Azure](http://www.dushyantgill.com/blog/2015/05/23/developers-guide-to-auth-with-azure-resource-manager-api/)

  В этой статье показано, как с помощью tooauthenticate hello API диспетчера ресурсов.
* [Конференция Ignite: управление доступом на основе ролей в Microsoft Azure](https://channel9.msdn.com/events/Ignite/2015/BRK2707)

  Это tooa ссылку, с конференции Ignite 2015 MS hello видео на канале 9. В этом сеансе говорить о доступа, управления и работы с отчетами Azure и рекомендации по защите доступа tooAzure подписки с помощью Azure Active Directory.

### <a name="managing-your-storage-account-keys"></a>Управление ключами учетной записи хранения
Учетной записи хранения, ключи представляют собой 512-разрядный строки, созданные Azure, наряду с hello хранилища учетная запись, имя, можно использовать tooaccess hello данных объектов, хранящихся в учетной записи хранилища hello, например большие двоичные объекты, объекты в пределах таблицы, очереди сообщений и файлов в папке файлов Azure. Управление доступа toohello хранилища учетной записи ключей управляет доступом toohello информационной панели для этой учетной записи хранилища.

Каждая учетная запись хранилища имеет два ключа называется tooas «Ключ 1» и «Ключа 2» в hello [портал Azure](http://portal.azure.com/) и в hello командлеты PowerShell. Они могут быть повторно созданы вручную, используя один из нескольких методов, включая, но не только toousing hello [портал Azure](https://portal.azure.com/), hello клиентской библиотеки хранилища .NET или hello Azure PowerShell, hello Azure CLI или программным путем с помощью REST API служб хранилища.

Существуют любое количество tooregenerate причинам ключи учетной записи хранилища.

* Вы можете регулярно создавать новые ключи в целях безопасности.
* Будет повторно создать ключи учетной записи хранилища, если кто-то управляемые toohack в приложения и получить ключ hello, жестко закодировано или сохранен в файле конфигурации, предоставляя им полный доступ к учетной записи хранилища tooyour.
* Другой случай для повторного создания ключа, если команда использует обозреватель хранилищ приложение, которое сохраняет ключ учетной записи хранения hello и оставляет один из членов команды hello. приложение Hello по-прежнему toowork, предоставляя им доступа к учетной записи хранилища tooyour после они удалены. Это фактически hello основная причина созданные ими подписей общего доступа уровня учетной записи-SAS на уровне учетной записи можно использовать вместо сохранения hello клавиши доступа в файле конфигурации.

#### <a name="key-regeneration-plan"></a>План повторного создания ключей
Вы не хотите toojust заново hello ключ, который вы используете без некоторых планирования. Если это сделать, может обрезана все доступа toothat учетной записи хранилища, что может привести к основной перебоев в работе. Именно поэтому используются два ключа. Повторно создавать ключи следует только по одному.

Прежде чем повторное создание ключей, убедитесь, что у вас есть список всех приложений, зависящих от hello учетной записи хранилища, а также любые другие службы, которую вы используете в Azure. Например при использовании служб мультимедиа Azure, которые зависят от учетной записи хранилища, необходимо повторно синхронизировать ключи доступа hello с вашей службой носителей после повторного создания ключа hello. При использовании любого приложения, такие как обозреватель хранилищ потребуется tooprovide hello новые ключи toothose приложения также. Обратите внимание, что при наличии виртуальных машин, чьи файлы виртуального жесткого диска хранятся в учетной записи хранения hello, они не затрагиваются, повторное создание ключей учетной записи хранения hello.

Можно создать повторно ключи в hello портал Azure. Если повторно создаются ключи они занимают too10 toobe минут синхронизировать во всех служб хранилища.

Когда вы будете готовы, ниже приведен общий процесс hello с подробными сведениями о том, как следует изменить ключ. В этом случае hello подразумевается, что вы используете раздел 1 и будет toochange все toouse вместо ключа 2.

1. Повторное создание ключа 2 tooensure, что он является безопасным. Это можно сделать в hello портал Azure.
2. В все приложения hello, где хранится ключ хранилища hello измените значение нового ключа toouse ключ hello хранилище 2. Тестирование и публикация приложения hello.
3. После того как все hello приложения и службы работают и запущена успешно, повторное создание ключа 1. Это гарантирует, что любой пользователь явно не предоставлены hello новый ключ toowhom больше не будут иметь доступ к учетной записи хранилища toohello.

Если вы используете ключ 2, можно использовать же процесс, но имена ключей обратного hello hello.

За несколько дней, можно перенести изменения каждого toouse приложения hello новый ключ и его публикации. После завершения всех из них должен вернуться назад и повторно создать ключ старого hello, поэтому больше не работает.

Другой вариант — ключ учетной записи хранения tooput hello в [хранилище ключей Azure](https://azure.microsoft.com/services/key-vault/) как секрет и располагать собственным ключом hello приложений извлекать из него. Затем повторно создать ключ hello и обновить hello хранилище ключей Azure, приложения hello нет необходимости повторного развертывания, так как они получат hello новый ключ из хранилища ключей Azure hello автоматически toobe. Заметьте, что вы можете прочитать раздел hello каждый раз при необходимости приложения hello, или можно кэшировать его в памяти и при невозможности использования, извлечь ключ hello снова из хранилища ключей Azure hello.

Хранилище ключей Azure обеспечивает еще один уровень безопасности для ключей к хранилищу данных. При использовании этого метода вы никогда не будет hello, ключа хранилища жестко задано в файле конфигурации, удаляющий пути, кто-то получение ключей toohello без определенного разрешения доступа.

Другое преимущество использования хранилища ключей Azure — также можно управлять tooyour клавиши доступа, с помощью Azure Active Directory. Это означает, что вы можете предоставить доступ toohello несколько приложений, которым требуется tooretrieve hello ключи из хранилища ключей Azure и известно, что другие приложения не будут может tooaccess hello ключи, не предоставляя им разрешений специально.

Примечание: рекомендуется toouse только один hello ключей во всех приложениях в hello, же время. При использовании ключа 1 в некоторых местах и 2 ключ в других, то не сможете быть ключей без потери доступа другим приложением, может toorotate.

#### <a name="resources"></a>Ресурсы
* [Об учетных записях хранения Azure](storage-create-storage-account.md#regenerate-storage-access-keys)

  В этой статье приводятся общие сведения об учетных записях хранения и рассматривается просмотр, копирование и повторное создание ключей доступа к хранилищу.
* [Справочник по API REST поставщика ресурсов службы хранилища Azure](https://msdn.microsoft.com/library/mt163683.aspx)

  Эта статья содержит ссылки toospecific статьи о получении ключей учетной записи хранения hello и идет повторное создание ключей учетной записи хранения hello для учетной записи Azure, с помощью API-интерфейса REST hello. Примечание. Это относится к учетным записям хранения Resource Manager.
* [Операции с учетными записями хранения](https://msdn.microsoft.com/library/ee460790.aspx)

  В этой статье в hello Справочник по API REST хранилища Service Manager содержит статьи toospecific ссылки на получение и повторное создание ключей учетной записи хранения hello, с помощью API-интерфейса REST hello. Примечание: Это для учетных записей хранения классический hello.
* [Произнесите goodbye tookey управления — Управление доступом tooAzure хранилища данных с помощью Azure AD](http://www.dushyantgill.com/blog/2015/04/26/say-goodbye-to-key-management-manage-access-to-azure-storage-data-using-azure-ad/)

  В этой статье показано, как toocontrol toouse Active Directory доступ к tooyour ключей хранилища Azure в хранилище ключей Azure. Здесь также показано, как toouse автоматизации Azure задания tooregenerate hello ключи на почасовой основе.

## <a name="data-plane-security"></a>Безопасность плоскости данных
Безопасность данных плоскости ссылается toohello методы, используемые toosecure hello данных объекты хранятся в хранилище Azure — hello больших двоичных объектов, очередей, таблиц и файлов. Мы рассмотрели hello данных методам tooencrypt и безопасность во время передачи данных hello, но как выполнить о разрешении доступа toohello объектов?

По сути, существует два способа для управления доступом toohello данных сами объекты. Hello сначала предусмотрено управление доступом toohello ключи учетной записи и hello второй использует объекты данных toospecific доступа toogrant подписей общего доступа на определенное время.

Один toonote исключение — разрешить общий доступ tooyour большие двоичные объекты, задав hello уровень доступа для hello контейнер, который содержит большие двоичные объекты hello соответствующим образом. Если задать доступ tooBlob контейнер или контейнер, он позволяет общий доступ на чтение для больших двоичных объектов hello в этом контейнере. Это означает, что любой пользователь, URL-адрес tooa больших двоичных объектов в этом контейнере можно открыть в браузере без с помощью подписи общего доступа или having hello ключи учетной записи хранения.

### <a name="storage-account-keys"></a>Ключи учетной записи хранения
Ключи учетной записи хранения — это 512-разрядный строки, созданные Azure, наряду с именем учетной записи хранилища hello, может быть используется tooaccess hello данных, хранящихся в учетной записи хранилища hello.

Например можно чтения больших двоичных объектов, записи tooqueues, создайте таблицы и изменять файлы. Многие из этих действий может быть выполнено с помощью hello Azure портала или с помощью одного из многих приложений обозреватель хранилищ. Также можно написать код toouse hello API-интерфейса REST или один из tooperform клиентских библиотек хранилища hello этих операций.

Как это описано в разделе "hello" на hello [безопасности плоскости управления](#management-plane-security), иметь доступ к toohello хранилища ключей для учетной записи хранения классический могут предоставляться, предоставляя toohello полного доступа к подписке Azure. Ключи хранилища toohello доступа для учетной записи хранилища с помощью модели hello диспетчера ресурсов Azure можно управлять через управление доступом на основе ролей (RBAC).

### <a name="how-toodelegate-access-tooobjects-in-your-account-using-shared-access-signatures-and-stored-access-policies"></a>Как toodelegate доступ к tooobjects в вашей учетной записи, с помощью подписей общего доступа и хранимые политики доступа
Подпись коллективного доступа является строка, содержащая маркер безопасности, который может быть присоединен tooa URI, который позволяет вам объектов toostorage toodelegate доступа и указать ограничения, такие как разрешения hello и hello диапазон даты и времени доступа.

Вы можете предоставить доступ tooblobs, контейнеры, очереди сообщений, файлов и таблиц. С таблицами вы можете фактически предоставлять разрешение tooaccess диапазон сущностей в таблице hello, указав hello секций и строк диапазонов ключей toowhich вы хотите получить доступ toohave пользователя hello. Например если у вас есть данные, хранящиеся с ключом раздела географических состояния, вы можете предоставить кто-то hello toojust доступа к данным в Калифорнии.

В другом примере может предоставить маркер SAS, который позволяет ему очереди tooa toowrite записи веб-приложения и дать исполнитель роли приложения сообщений tooget маркера SAS из hello, очереди и обрабатывать их. Или может предоставить одному клиенту маркер SAS, их можно использовать контейнер tooa tooupload изображений в хранилище больших двоичных объектов и предоставить tooread разрешений приложения web этих изображений. В обоих случаях является разделение областей ответственности — каждое приложение может быть предоставлен доступ к просто hello, требуемого в заказ tooperform своих задач. Это возможно благодаря использованию hello подписей общего доступа.

#### <a name="why-you-want-toouse-shared-access-signatures"></a>Почему нужно toouse подписей общего доступа
Для чего нужна toouse SAS вместо просто размещайте ключ учетной записи хранилища намного проще? Размещайте ключ учетной записи хранилища — такими как совместное использование ключей hello Королевство вашего хранилища. без каких-либо ограничений. Кто-то может использовать ключи и отправить их учетной записи хранения музыкальной библиотеки tooyour. Он также может заменить ваши файлы на версии, зараженные вирусами, или украсть ваши данные. Передача учетной записи хранилища tooyour неограниченный доступ — это то, которое не должно быть выполнено в незначительной степени.

С подписями коллективного доступа клиента можно присвоить только hello разрешения, необходимые для ограниченного промежутка времени. Например если кто-то отправляет tooyour учетную запись больших двоичных объектов, можно предоставить их доступ на запись для ровно столько времени tooupload hello большого двоичного объекта (в зависимости от размера hello hello большого двоичного объекта, конечно). Если вы изменили решение, то можете отозвать доступ.

Кроме того можно указать, что запросов, выполненных с помощью SAS ограниченных tooa определенных IP-адрес или IP-адрес внешнего tooAzure диапазона. Вы также можете указать, что запросы должны выполняться по определенному протоколу (HTTPS или HTTP/HTTPS). Это означает, что если требуется только tooallow HTTPS-трафика, можно задать только tooHTTPS протокола hello необходимые и HTTP-трафик будет заблокирован.

#### <a name="definition-of-a-shared-access-signature"></a>Определение подписанного URL-адреса
Подпись коллективного доступа является набор параметров запроса добавляется toohello URL-адрес, указывающий на ресурс hello

предоставляющий сведения о доступе к hello разрешено и hello продолжительность времени, для которого hello разрешен доступ. Ниже приведен пример; Этот URI предоставляет доступ на чтение tooa больших двоичных объектов на пять минут. Обратите внимание на то, что параметры запроса SAS должны иметь кодировку URL, например, двоеточие (:) должно обозначаться как %3A, а пробел — %20.

```
http://mystorage.blob.core.windows.net/mycontainer/myblob.txt (URL toohello blob)
?sv=2015-04-05 (storage service version)
&st=2015-12-10T22%3A18%3A26Z (start time, in UTC time and URL encoded)
&se=2015-12-10T22%3A23%3A26Z (end time, in UTC time and URL encoded)
&sr=b (resource is a blob)
&sp=r (read access)
&sip=168.1.5.60-168.1.5.70 (requests can only come from this range of IP addresses)
&spr=https (only allow HTTPS requests)
&sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D (signature used for hello authentication of hello SAS)
```

#### <a name="how-hello-shared-access-signature-is-authenticated-by-hello-azure-storage-service"></a>Как hello проверку подписи общего доступа hello службы хранилища Azure
Когда служба хранилища hello получает запрос hello, принимает параметры hello входного запроса и создает подпись с помощью hello того же метода, как hello вызывающей программе. Затем он сравнивает две сигнатуры hello. Если они согласны, тогда hello службы хранилища можно проверить hello хранилища службы версии toomake том, что он является допустимым, убедитесь, что hello текущую дату и время находятся в указанном окне приветствия, убедитесь, что hello доступа запрошенный соответствует toohello запрос и т. д.

Например с нашей URL-адрес выше, если hello URL-адрес указывает файл tooa вместо большого двоичного объекта, этот запрос завершится сбоем, так как он указывает, что hello подписи общего доступа, предназначен для большого двоичного объекта. Если вызывается команда REST hello tooupdate большого двоичного объекта, он бы оказался неудачным hello подписи общего доступа указывает, что разрешен доступ только для чтения.

#### <a name="types-of-shared-access-signatures"></a>Типы подписанных URL-адресов
* SAS уровня службы может быть используется tooaccess конкретных ресурсов в учетной записи хранения. Некоторые примеры получение списка больших двоичных объектов в контейнере, загрузка большого двоичного объекта, обновление сущности в таблице, добавление tooa сообщений в очереди и передача файла tooa общую папку.
* SAS на уровне учетной записи может быть используется tooaccess все, что подписанный URL-адрес уровня службы может использоваться для. Кроме того он может предоставить tooresources параметры, не допускается в отношении SAS уровня службы, такие как hello возможность toocreate контейнеров, таблиц, очередей и общих папок. Можно также указать доступа к службам toomultiple за один раз. Например можно дать кто-то доступа tooboth больших двоичных объектов и файлов в вашей учетной записи хранилища.

#### <a name="creating-an-sas-uri"></a>Создание универсального кода ресурса (URI) SAS
1. По требованию, определения всех параметров запроса hello каждый раз, можно создать нерегламентированный URI.

   Это обеспечивает гибкость, но если у вас есть логически связанный и относительно постоянный набор параметров, лучше использовать хранимую политику доступа.
2. Хранимую политику доступа можно создать для всего контейнера, общей папки, таблицы или очереди. Затем его можно использовать в качестве основы hello для hello идентификаторы URI SAS, вы создаете. Разрешения на основе хранимых политик доступа можно легко отзывать. Может иметь копию too5 политик, определенных для каждого контейнера, очереди, таблицы или общей папки.

   Например если предполагается toohave многие пользователи считывать большие двоичные объекты hello в определенном контейнере, можно создать хранимой политикой доступа с надписью «предоставить доступ для чтения» и другие параметры, которые будут hello же каждый раз. Затем можно создать универсальный код Ресурса SAS с использованием параметров hello hello хранимые политики доступа и указав hello даты и времени. Hello этой возможности является отсутствие необходимости toospecify все hello параметров запроса, каждый раз.

#### <a name="revocation"></a>Запрет доступа
Предположим, что ваш SAS был скомпрометирован, либо требуется toochange его из-за безопасности организации или нормативных требований. Как Вы отзываете доступа tooa ресурсов с помощью этого SAS Он зависит от способа создания hello универсальный код Ресурса SAS.

В случае с нерегламентированным кодом URI есть три варианта. Можно выдавать маркеры SAS с политиками срока действия короткий и просто ожидать hello SAS tooexpire. Можно переименовать или удалить ресурс hello (при условии, что маркер hello был один объект с областью tooa). Вы можете изменить hello ключи учетной записи хранения. Последний вариант может иметь большое влияние, в зависимости от того, сколько служб с помощью этой учетной записи хранения и, скорее всего, проблема не возникает необходимости toodo без некоторых планирования.

При использовании SAS, производным от хранимой политикой доступа, можно удалить доступ, отменив hello хранимые политики доступа — можно просто изменить его, уже истек, или полностью удалите его. Это изменение вступает в силу немедленно и делает недействительными все подписанные URL-адреса, использующие эту хранимую политику доступа. Обновление или удаление hello хранимой политикой доступа может повлиять на пользователей, доступ к этой конкретному контейнеру, общую папку, таблицы или очереди через SAS, но если hello клиентов записываются, поэтому они запрашивают новый SAS, когда hello старого становится недействительным, это будет работать.

Так как использование SAS, производным от хранимой политикой доступа позволяет hello toorevoke возможность, что SAS немедленно, он является hello рекомендуется tooalways лучший подход использовать политики доступа хранятся по возможности.

#### <a name="resources"></a>Ресурсы
Более подробные сведения об использовании подписей общего доступа и хранимые политики доступа, дополненный примерами см. следующие статьи toohello:

* Ниже приведены справочные статьи по hello.

  * [Подписанный URL-адрес уровня службы](https://msdn.microsoft.com/library/dn140256.aspx)

    В этой статье приводятся примеры использования подписанного URL-адреса уровня службы с BLOB-объектами, сообщениями в очереди, диапазонами в таблице и файлами.
  * [Создание подписанного URL-адреса уровня службы](https://msdn.microsoft.com/library/dn140255.aspx)
  * [Создание подписанного URL-адреса уровня учетной записи](https://msdn.microsoft.com/library/mt584140.aspx)
* Это учебники по использованию библиотеки клиента toocreate подписей общего доступа для hello .NET и хранимые политики доступа.

  * [Использование подписанных URL-адресов (SAS)](../storage-dotnet-shared-access-signature-part-1.md)
  * [Подписи коллективного доступа, часть 2: Создание и использование SAS с hello службы BLOB-объектов](../blobs/storage-dotnet-shared-access-signature-part-2.md)

    Эта статья содержит описание модели SAS hello, примеры подписей общего доступа и рекомендации для hello рекомендуется использовать SAS. Также рассматривается — отзыв hello hello данного разрешения.
* Ограничение доступа по IP-адресу (список управления доступом по IP-адресам)

  * [Список управления доступом (ACL) конечной точки](../../virtual-network/virtual-networks-acl.md)
  * [Создание подписанного URL-адреса уровня службы](https://msdn.microsoft.com/library/azure/dn140255.aspx)

    Это статье hello для SAS уровня обслуживания; он включает пример управления доступом к IP.
  * [Создание подписанного URL-адреса уровня учетной записи](https://msdn.microsoft.com/library/azure/mt584140.aspx)

    Это статье hello для SAS на уровне учетной записи; он включает пример управления доступом к IP.
* Аутентификация

  * [Проверка подлинности для служб хранилища Azure hello](https://msdn.microsoft.com/library/azure/dd179428.aspx)
* Учебник по началу работы с подписанными URL-адресами

  * [Учебник по началу работы с подписанными URL-адресами](https://github.com/Azure-Samples/storage-dotnet-sas-getting-started)

## <a name="encryption-in-transit"></a>Шифрование при передаче
### <a name="transport-level-encryption--using-https"></a>Шифрование на уровне транспорта с помощью протокола HTTPS
Еще один шаг займет tooensure hello безопасностью данных в хранилище Azure — данные hello tooencrypt между клиентом hello и хранилища Azure. Первая рекомендация Hello является tooalways использовать hello [HTTPS](https://en.wikipedia.org/wiki/HTTPS) Здравствуйте, протокола, который обеспечивает безопасный обмен данными через общедоступный Интернет.

toohave безопасного канала связи, следует всегда использовать HTTPS при вызове hello API-интерфейс REST или обращении к объектов в хранилище. Кроме того **подписей общего доступа**, которую можно использовать toodelegate доступ к объектам хранилища tooAzure, включите параметр toospecify, только hello, можно использовать протокол HTTPS, при использовании подписей общего доступа, что позволит любому пользователю отправкой статьях с токенами SAS будет использовать правильный тип протокола hello.

Можно принудительно задать hello использование протокола HTTPS во время вызова объектов tooaccess API-интерфейс REST hello в учетных записях хранения, позволяя [Безопасная передача необходимые](../storage-require-secure-transfer.md) для учетной записи хранения hello. После этого подключения по протоколу HTTP будут отклоняться.

### <a name="using-encryption-during-transit-with-azure-file-shares"></a>Использование шифрования при обмене данными с общими папками Azure
Хранилище файлов Azure поддерживает протокол HTTPS при использовании REST API hello, но наиболее часто используемых как файловый ресурс SMB подключенные tooa виртуальной Машины. SMB 2.1 не поддерживает шифрование, поэтому соединения разрешены только в пределах hello же область в Azure. Тем не менее SMB 3.0 поддерживает шифрование и оно станет доступно в Windows Server 2012 R2, Windows 8, Windows 8.1 и Windows 10, позволяя различных регионах доступ и даже доступа на рабочем столе hello.

Обратите внимание, что общих ресурсов Azure можно использовать с Unix, hello клиент Linux SMB пока не поддерживает шифрования, поэтому доступ разрешен только в пределах региона Azure. Поддержка шифрования для Linux находится на стратегия hello разработчиков Linux выполняют SMB. При добавлении шифрования, будет иметь такие же возможности для доступа к общей папке файлов Azure для Linux, как и для Windows hello.

Можно принудительно задать hello использование шифрования с hello службы файлов Azure, позволяя [Безопасная передача необходимые](../storage-require-secure-transfer.md) для учетной записи хранения hello. Если с помощью hello API-интерфейс REST, HTTPs не требуется. При использовании протокола SMB будут успешно устанавливаться только подключения, поддерживающие шифрование.

#### <a name="resources"></a>Ресурсы
* [Как toouse хранилища Azure File с Linux](../storage-how-to-use-files-linux.md)

  В этой статье показано, как предоставить доступ toomount файл Azure для Linux системы и отправки или скачивания файлов.
* [Приступая к работе с хранилищем файлов Azure в Windows](../storage-dotnet-how-to-use-files.md)

  В данной статье приводится обзор общих ресурсов Azure и как toomount и использовать их с помощью PowerShell и .NET.
* [Inside Azure File Storage](https://azure.microsoft.com/blog/inside-azure-file-storage/) (Хранилище файлов Azure: взгляд изнутри)

  В этой статье объявляет hello общей доступности хранилища Azure File и технические сведения о шифровании hello SMB 3.0.

### <a name="using-client-side-encryption-toosecure-data-that-you-send-toostorage"></a>С помощью данных toosecure шифрования на стороне клиента отправки toostorage
Еще одним средством обеспечения безопасности данных в процессе передачи между клиентским приложением и хранилищем является шифрование на стороне клиента. Hello данные шифруются перед передачей в хранилище Azure. При получении данных hello из хранилища Azure hello расшифровка данных происходит после получения hello клиентской стороны. Несмотря на то, что hello данные шифруются, перейдя по линии hello, рекомендуется использовать протокол HTTPS, как он содержит проверку целостности данных, встроенных в которой снижения влияния на целостность данных hello hello сетевых ошибок.

Шифрование на стороне клиента также является способ шифрования данных при хранении как hello данные хранятся в зашифрованном виде. Мы рассмотрим это более подробно в разделе "hello" на [шифрование неактивных](#encryption-at-rest).

## <a name="encryption-at-rest"></a>Шифрование при хранении
В Azure есть три функции, обеспечивающие шифрование при хранении. Azure шифрование диска — используется tooencrypt hello ОС и диски с данными в виртуальных машинах IaaS. Здравствуйте, другие два — шифрования на стороне клиента и SSE — работают как данные, используемые tooencrypt в хранилище Azure. Рассмотрим каждую из этих функций, а затем сравним их и посмотрим, в каких случаях их можно использовать.

При использовании данных hello tooencrypt шифрования на стороне клиента во время передачи (который также хранится в зашифрованном виде в хранилище) может предпочитают использовать toosimply HTTPS во время передачи hello и определить, какой метод для hello toobe данных, автоматически шифруются, если он является сохраняются. Существует два способа toodo это — шифрование диска Azure и SSE. Один используется toodirectly шифрования hello данных на дисках операционной системы и данных, используемых виртуальными машинами и hello других — используется tooencrypt данные, записанные tooAzure хранилища больших двоичных объектов.

### <a name="storage-service-encryption-sse"></a>шифрования службы хранилища (SSE)
SSE позволяет toorequest, службы хранилища hello автоматического шифрования hello данных при записи его tooAzure хранилища. При чтении данных hello из хранилища Azure, он будет расшифрован службой хранения hello перед возвращением. Это позволяет toosecure данных без необходимости toomodify кода или добавить приложения tooany кода.

Это является параметром, который применяется учетная запись toohello всего хранилища. Можно включить и отключить эту функцию, изменив значение hello приветствия. toodo это, можно использовать портал Azure, PowerShell, hello hello Azure CLI, hello API-интерфейса REST поставщика ресурсов хранилища или hello клиентской библиотеки хранилища .NET. По умолчанию шифрование службы хранилища отключено.

В настоящее время hello ключи, используемые для шифрования hello осуществляется корпорацией Майкрософт. Мы изначально создавать ключи hello и управление hello безопасного хранения hello ключи, а также обычных поворота hello в соответствии с определением внутренней политики Microsoft. В будущем hello получить возможность toomanage hello ключей шифрования и предоставляют пути миграции из ключей, управляемых Microsoft ключей, управляемых toocustomer.

Эта функция доступна для Standard и Premium хранилища учетных записей, созданных с помощью модели развертывания диспетчера ресурсов hello. SSE применяется только tooblock больших двоичных объектов, страничные большие двоичные объекты и добавьте больших двоичных объектов. Hello других типов данных, включая таблицы, очереди и файлы, не будут зашифрованы.

Данные шифруются только при включенном SSE и записи данных hello tooBlob хранилища. Включение или отключение шифрования службы хранилища не влияет на существующие данные. Другими словами при включении шифрования, он будет не вернуться назад и шифрования данных, которые уже существует. и не будет расшифровывать данные hello, уже существует, при отключении SSE.

Следует toouse этой функции в классическом учетная запись хранения можно создать новую учетную запись хранения диспетчера ресурсов и использовать AzCopy toocopy hello данных toohello новой учетной записи.

### <a name="client-side-encryption"></a>шифрования на стороне клиента
Мы уже упоминали шифрования на стороне клиента при обсуждении шифрования hello hello данных во время передачи. Эта функция позволяет tooprogrammatically можно шифровать данные в клиентском приложении перед его отправкой по записи tooAzure хранения toobe передачи hello и tooprogrammatically расшифровки данных после их извлечения из хранилища Azure.

Это обеспечивает шифрование во время передачи, но он также обеспечивает возможность hello шифрования при хранении. Обратите внимание, что несмотря на то, что hello данные шифруются во время передачи, по-прежнему рекомендуется использовать HTTPS tootake преимуществами проверки целостности данных hello которых снижения влияния на целостность данных hello hello сетевых ошибок.

Где его можно использовать пример — Если у вас есть веб-приложения, который хранит большие двоичные объекты и извлекает большие двоичные объекты, и требуется приложение hello и toobe данных защищено настолько, насколько это возможно. В этом случае следует применять шифрование на стороне клиента. Hello трафика между клиентом hello и hello больших двоичных объектов Azure содержит зашифрованные hello ресурсов, и никто не может интерпретировать hello данных во время передачи и восстановить его в частной BLOB-объектов.

Шифрование на стороне клиента встроено в hello Java и hello .NET клиентских библиотек хранилища, которые в свою очередь используют ключ хранилища Azure API, довольно упрощая вы tooimplement hello. процесс шифрования и расшифровки данных hello Hello использует метод конверт hello и сохраняет метаданные, используемые с помощью шифрования hello в каждом объекте хранилища. Например, для больших двоичных объектов, сохраняет его в метаданных большого двоичного объекта hello, то время как для очереди, этот элемент добавляется tooeach сообщения в очереди.

Для шифрования hello сам можно создавать и управлять ключей шифрования. Можно также использовать ключи, создаваемые hello клиентская библиотека хранилища Azure, или может иметь hello хранилище ключей Azure создания ключей hello. Ключи шифрования можно хранить в локальном хранилище ключей или в хранилище ключей Azure. Хранилище ключей Azure позволяет toogrant доступа toohello секреты в хранилище ключей Azure toospecific пользователей с помощью Azure Active Directory. Это означает, что не просто любой пользователь читает hello хранилище ключей Azure и получить ключи hello, используемого для шифрования на стороне клиента.

#### <a name="resources"></a>Ресурсы
* [Шифрование и расшифровка BLOB-объектов в хранилище Microsoft Azure с помощью хранилища ключей Azure](../blobs/storage-encrypt-decrypt-blobs-key-vault.md)

  В этой статье показано, как toouse шифрования на стороне клиента с хранилищем ключей Azure, включая toocreate hello ключа обмена Ключами и сохранить его в хранилище hello, с помощью PowerShell.
* [Шифрование на стороне клиента для службы хранилища Microsoft Azure](../storage-client-side-encryption.md)

  В этой статье объясняется, шифрования на стороне клиента и содержит примеры использования hello клиента библиотеки tooencrypt и расшифровки ресурсов хранилища из четырех служб хранилища hello. В ней также рассматривается хранилище ключей Azure.

### <a name="using-azure-disk-encryption-tooencrypt-disks-used-by-your-virtual-machines"></a>С помощью шифрования диска Azure tooencrypt диски, используемые виртуальными машинами
Шифрование дисков Azure — это новая функция. Эта функция позволяет вам tooencrypt hello ОС дисков и дисков данных, используемые в виртуальной машине IaaS. Для Windows hello диски шифруются с помощью технологии шифрования BitLocker отраслевым стандартам. Для Linux диски hello шифруются с помощью технологии hello Crypt интеллектуального анализа данных. Это интегрирован с хранилищем ключей Azure tooallow вы toocontrol и управления ключами шифрования диска hello.

решение Hello поддерживает следующие сценарии для ВМ IaaS, если они включены в Microsoft Azure hello:

* интеграция с хранилищем ключей Azure;
* виртуальные машины IaaS серий [A, D, DS, G, GS и т. д.](https://azure.microsoft.com/pricing/details/virtual-machines/) уровня "Стандартный";
* включение шифрования для виртуальных машин IaaS под управлением Windows и Linux;
* отключение шифрования дисков данных и дисков операционной системы виртуальных машин IaaS под управлением Windows;
* отключение шифрования дисков данных виртуальных машин IaaS под управлением Linux;
* включение шифрования для виртуальных машин IaaS под управлением клиентской ОС Windows;
* включение шифрования томов с путями подключения;
* включение шифрования для виртуальных машин Linux с чередованием дисков (RAID) с помощью программы mdadm;
* включение шифрования для виртуальных машин Linux с использованием диспетчера логических томов (LVM) для дисков данных;
* включение шифрования для виртуальных машин Windows, использующих дисковые пространства.
* поддерживаются все общедоступные регионы Azure.

решение Hello не поддерживает следующие сценарии, функции и технологии в выпуске hello hello:

* виртуальные машины уровня "Базовый";
* отключение шифрования диска ОС виртуальных машин IaaS под управлением Linux;
* Виртуальные машины IaaS, созданных с помощью метода создания виртуальной Машины классический hello
* интеграция с локальной службой управления ключами;
* хранилище файлов Azure (файловый ресурс Azure), NFS, динамические тома, виртуальные машины Windows с программными системами RAID.


> [!NOTE]
> Шифрование диска операционной системы Linux в настоящее время поддерживается на hello следующие дистрибутивы Linux: RHEL 7.2, CentOS 7.2n и Ubuntu 16.04.
>
>

Эта функция гарантирует, что все данные на дисках виртуальной машины шифруются при хранении в службе хранилища Azure.

#### <a name="resources"></a>Ресурсы
* [Дисковое шифрование Azure для виртуальных машин IaaS под управлением Windows и Linux](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption)

### <a name="comparison-of-azure-disk-encryption-sse-and-client-side-encryption"></a>Сравнение шифрования дисков Azure, шифрования службы хранилища и шифрования на стороне клиента
#### <a name="iaas-vms-and-their-vhd-files"></a>Виртуальные машины IaaS и их файлы VHD
Для дисков, используемых виртуальными машинами IaaS, мы рекомендуем шифрование дисков Azure. Можно включить SSE hello tooencrypt VHD-файлы, используемые tooback этих дисков в хранилище Azure, но он вновь создаваемых данные шифруются только. Это означает, что при создании виртуальной Машины и затем включите SSE hello учетной записи хранения, содержащий hello VHD-файл, будут зашифрованы только hello изменения, не hello исходный файл виртуального жесткого диска.

При создании виртуальной Машины с помощью образа из hello Azure Marketplace, Azure выполняет [shallow копирования](https://en.wikipedia.org/wiki/Object_copying) из tooyour hello изображения учетной записи хранения в хранилище Azure и не шифруются, даже при наличии SSE включена. После его hello ВМ создает и запускает обновление образа hello, SSE начнется шифрование данных hello. По этой причине это лучший toouse шифрование диска Azure на виртуальных машинах, созданные на основе изображений в hello Azure Marketplace, если их полностью зашифрован.

Вставленные предварительно зашифрованный ВМ в Azure из локального будет быть ключи шифрования tooAzure хранилища ключей для возможности tooupload hello и продолжить использование hello шифрования для этой виртуальной Машины, что использовались в локальной. Azure шифрование диска этот сценарий не включен toohandle.

При наличии без шифрования VHD из локальной можно передать его в коллекцию hello как пользовательского образа и подготовить виртуальную Машину из него. Если это делается с помощью шаблонов диспетчера ресурсов hello, вы можете запросить его tooturn на шифрование диска Azure при его загрузке hello виртуальной Машины.

При добавлении диска данных и присоединить ее на hello виртуальной Машины, можно включить шифрование диска Azure на этом диске данных. Сначала будет шифрование диска данных локально, а затем hello уровень управления службы будет выполните отложенной записи с хранилищами, поэтому содержимое хранилища hello шифруется.

#### <a name="client-side-encryption"></a>шифрования на стороне клиента
Шифрование на стороне клиента — наиболее безопасный метод hello шифрования данных, так как он шифрует его до передачи и шифрует hello статических данных. Однако он требует добавления кода tooyour приложений с помощью хранилища, который может потребоваться не toodo. В таких случаях можно было использовать HTTPs для данных во время передачи и статических данных hello tooencrypt SSE.

С помощью шифрования на стороне клиента можно шифровать сущности в таблицах, сообщения в очередях и BLOB-объекты. С помощью шифрования службы хранилища можно шифровать только большие двоичные объекты. Если вам требуется таблиц и очередей toobe данные зашифрованы, следует использовать шифрования на стороне клиента.

Шифрование на стороне клиента полностью управляется приложения hello. Это наиболее безопасный подход hello, но требуют toomake программного изменения tooyour приложения и поместить процессы управления ключами на месте. Вы бы использовать при необходимости hello дополнительную безопасность во время передачи и хотите вашей toobe хранимые данные шифруются.

Шифрования на стороне клиента является большей нагрузки на приветствия клиента, и имеется tooaccount для этого в планах масштабируемости, особенно в том случае, если вы используете шифрования и передачи большого объема данных.

#### <a name="storage-service-encryption-sse"></a>шифрования службы хранилища (SSE)
SSE управляется службой хранилища Azure. Использование инструкций SSE не обеспечивает безопасность hello hello данных во время передачи, но он производит шифрование данных hello, как написано tooAzure хранилища. Нет никакого воздействия на производительность hello при использовании этой функции.

С помощью шифрования службы хранилища можно шифровать только блочные, добавочные и страничные BLOB-объекты. Если требуется tooencrypt табличные данные или данные очереди, следует с помощью шифрования на стороне клиента.

При наличии архив или библиотеки VHD-файлов, которые можно использовать в качестве основы для создания новых виртуальных машин, можно создать новую учетную запись хранения, включить SSE и затем передать hello файлы виртуального жесткого диска toothat, учетной записи. Эти файлы VHD будут шифроваться службой хранилища Azure.

Если включено для дисков hello в виртуальной Машине и SSE, включены в учетной записи хранения hello, удерживающие файлы VHD hello шифрование диска Azure, он будет исправно; приведет все данные о только что написанный шифрования дважды.

## <a name="storage-analytics"></a>аналитики хранилища
### <a name="using-storage-analytics-toomonitor-authorization-type"></a>С помощью типа авторизации toomonitor аналитики хранилища
Для каждой учетной записи хранения можно включить ведение журнала tooperform аналитики хранилища Azure и хранения данных метрик. Это toouse мощный инструмент для метрики производительности hello toocheck учетной записи хранения, или tootroubleshoot учетной записи хранилища, так как возникли проблемы с производительностью.

Другой фрагмент данных, отображаемые в журналы аналитики хранилища hello способ hello проверки подлинности используется другим при доступе к хранилища. Например с хранилищем больших двоичных объектов, вы увидите их использовать подпись общего доступа или ключи учетной записи хранения hello ли доступ к blob hello был открытый.

Это может быть весьма полезно в том случае, если тесно защищая toostorage доступа. Например в хранилище больших двоичных объектов можно задать все контейнеры tooprivate hello и реализован hello используйте службы SAS в приложениях. Затем можно проверить журналы hello регулярно toosee Если BLOB-объектов осуществляется с помощью hello ключи учетной записи хранения, которые могут указывать на нарушение безопасности, или если hello большие двоичные объекты являются открытыми, но они не должны быть.

#### <a name="what-do-hello-logs-look-like"></a>Как hello журналы выглядят?
После включения hello метрики учетной записи хранения и ведения журнала через портал Azure hello, аналитические данные будут tooaccumulate быстрого запуска. Ведение журнала Hello и метрики для каждой службы раздельно. Ведение журнала Hello записывается только в том случае, когда активность в этой учетной записи хранилища, пока hello показатели будут регистрироваться каждую минуту, каждый час или каждый день, в зависимости от способа настройки.

Hello журналы хранятся в блочных больших двоичных объектов в контейнере, который называется $logs в учетной записи хранения hello. Этот контейнер создается автоматически при включении аналитики хранилища. После того как этот контейнер создан, удалить его нельзя, но можно очистить его содержимое.

В контейнере hello $logs папка для каждой службы, и затем существуют вложенные папки для hello год/месяц/день/часа. В час просто нумеруются журналы hello. Это связано с какой hello будет выглядеть структуру каталогов:

![Просмотр файлов журнала](./media/storage-security-guide/image1.png)

Войти в каждый запрос tooAzure хранилища. Ниже приведен снимок файла журнала, показывающая hello первый несколько полей.

![Моментальный снимок файла журнала](./media/storage-security-guide/image2.png)

Вы увидите, которые можно использовать журналы tootrack hello любого типа учетной записи хранилища tooa вызовов.

#### <a name="what-are-all-of-those-fields-for"></a>Для чего нужны все эти поля?
Нет перечисленные ниже ресурсы hello статьи, которая содержит список hello hello много полей в журналы hello и их назначение. Ниже приведен список hello по порядку:

![Моментальный снимок полей в файле журнала](./media/storage-security-guide/image3.png)

Нас интересует hello записи для GetBlob и о том, как они проходят проверку подлинности, поэтому нам нужна toolook для операций с типом операции «Get-BLOB-объект» и проверьте состояние запроса hello (4<sup>й</sup> столбца) и тип авторизации hello (8<sup>й</sup> столбца).

Например, в hello первые несколько строк, в приведенном выше списке hello, состояние запроса hello является «Успешно» и тип авторизации hello» проверки подлинности». Это означает, что запрос hello был проверен с помощью ключа учетной записи хранения hello.

#### <a name="how-are-my-blobs-being-authenticated"></a>Как производится проверка подлинности BLOB-объектов?
Нас интересуют три случая.

1. Hello большой двоичный объект является открытым и осуществляется с помощью URL-адреса без подписи общего доступа. В этом случае состояние запроса hello является «AnonymousSuccess» и тип авторизации hello «anonymous».

   1.0;2015-11-17T02:01:29.0488963Z;GetBlob;**AnonymousSuccess**;200;124;37;**anonymous**;;mystorage…
2. Hello большой двоичный объект является закрытым и используется подпись общего доступа. В этом случае состояние запроса hello является «SASSuccess» и hello авторизации тип «sas».

   1.0;2015-11-16T18:30:05.6556115Z;GetBlob;**SASSuccess**;200;416;64;**sas**;;mystorage…
3. Hello большой двоичный объект является закрытым и ключ хранилища hello был используется tooaccess его. В этом случае состояние запроса hello является «**успех**«и имеет тип авторизации hello»**с проверкой подлинности**».

   1.0;2015-11-16T18:32:24.3174537Z;GetBlob;**Success**;206;59;22;**authenticated**;mystorage…

Можно использовать Microsoft Message Analyzer tooview hello и анализировать эти журналы. В нем есть функции поиска и фильтрации. Например, может потребоваться toosearch для экземпляров toosee GetBlob в случае использования hello ожидаемому результату, т. е. toomake убедиться, что кто-то не имеет доступа к вашей учетной записи хранилища неправильно.

#### <a name="resources"></a>Ресурсы
* [Аналитика службы хранилища](../storage-analytics.md)

  В этой статье приведен обзор аналитики хранилища и как tooenable их.
* [Формат журналов аналитик хранилища](https://msdn.microsoft.com/library/azure/hh343259.aspx)

  В этой статье рассмотрены hello формат журнала аналитики хранилища и подробности hello поля, доступные в этом документе, включая проверку подлинности тип, который указывает тип проверки подлинности, используемый для запроса hello hello.
* [Отслеживание учетной записи хранилища в hello портал Azure](../storage-monitor-storage-account.md)

  В этой статье показано, как tooconfigure мониторинг метрик и ведения журнала для учетной записи хранения.
* [Комплексный поиск и устранение неполадок с помощью метрик хранилища Azure и ведения журнала, AzCopy и анализатора сообщений](../storage-e2e-troubleshooting.md)

  В этой статье рассказывается об устранении неполадок с помощью hello аналитики хранилища и показывает, как toouse hello Microsoft Message Analyzer.
* [Руководство по работе с анализатором сообщений (Майкрософт)](https://technet.microsoft.com/library/jj649776.aspx)

  В этой статье — hello Справочник по Microsoft Message Analyzer hello и включает учебника tooa ссылки, краткое и Сводка функций.

## <a name="cross-origin-resource-sharing-cors"></a>Общий доступ к ресурсам независимо от источника (CORS)
### <a name="cross-domain-access-of-resources"></a>Междоменный доступ к ресурсам
Когда из веб-браузера, работающего в одном домене, отправляется HTTP-запрос на получение ресурса из другого домена, такой запрос называется HTTP-запросом, не зависящим от источника. Например, с HTML-страницы, предоставляемой из домена contoso.com, выполняется запрос на получение JPEG-файла, размещенного в домене fabrikam.blob.core.windows.net. В целях безопасности браузеры блокируют не зависящие от источника HTTP-запросы, инициированные из скриптов, например на языке JavaScript. Это означает, что запросу кода JavaScript на веб-странице для contoso.com, jpeg на fabrikam.blob.core.windows.net hello браузера не позволит hello запросу.

Что делает это имеют toodo со службой хранилища Azure? Также, при сохранении статических ресурсов, таких как файлы данных JSON или XML в хранилище больших двоичных объектов с помощью учетной записи хранилища с именем Fabrikam hello домена для средств hello будет fabrikam.blob.core.windows.net и hello contoso.com веб-приложение не будет возможности tooaccess их с помощью JavaScript, так как hello домены различны. Это значение true, если вы пытаетесь toocall один из служб хранилища Azure — например, хранилище таблиц — hello, возвращающих toobe данные JSON, обрабатываемых hello клиента JavaScript.

#### <a name="possible-solutions"></a>Возможные решения
Одним из способов tooresolve это tooassign пользовательский домен, как toofabrikam.blob.core.windows.net «storage.contoso.com». Hello проблема заключается в, можно назначить только этой учетной записи хранения tooone пользовательского домена. Что делать, если hello ресурсы хранятся в нескольких учетных записей хранения?

Другой способ tooresolve это toohave hello web приложения act как прокси для hello вызовов хранилища. Это означает, что при отправке файла tooBlob хранилища hello веб-приложения будет либо записать их локально и скопировать его tooBlob хранилища, или будет считывать все его в память и записать их tooBlob хранилища. Кроме того можно написать выделенный веб-приложения (например, веб-API), отправляет hello файлы локально и записывает их tooBlob хранилища. В любом случае имеются tooaccount для этой функции требуется определение hello масштабируемости.

#### <a name="how-can-cors-help"></a>Как может помочь CORS?
Хранилище Azure позволяет tooenable CORS — Cross источника общий доступ к ресурсам. Для каждой учетной записи хранения можно указать домены, которые могут обращаться к ресурсам hello этой учетной записи хранения. Например в нашем случае выше мы можно включить CORS в учетной записи хранения fabrikam.blob.core.windows.net hello и настроить его toocontoso.com tooallow доступа. Затем contoso.com приложения hello web могут напрямую обращаться к ресурсам hello fabrikam.blob.core.windows.net.

Один toonote вещь — CORS разрешает доступ, что он не поддерживает проверку подлинности, которая является обязательным для всех доступа, кроме public ресурсов хранилища. Это означает, что доступны только большие двоичные объекты, если они являются открытыми и включает подпись общего доступа предоставляя hello соответствующее разрешение. Таблицы, очереди и файлы не могут быть общедоступными и требуют подписанного URL-адреса.

По умолчанию механизм CORS отключен для всех служб. CORS можно включить с помощью hello API-интерфейса REST или hello хранилища клиента библиотеки toocall один из политики службы hello tooset методы hello. При этом необходимо включить правило CORS в формате XML. Ниже приведен пример правила CORS, которое было задано с помощью операции Set Service Properties hello для hello службы BLOB-объектов для учетной записи хранения. Можно выполнять операции с помощью клиентской библиотеки хранилища hello или hello API-интерфейс REST для службы хранилища Azure.

```xml
<Cors>    
    <CorsRule>
        <AllowedOrigins>http://www.contoso.com, http://www.fabrikam.com</AllowedOrigins>
        <AllowedMethods>PUT,GET</AllowedMethods>
        <AllowedHeaders>x-ms-meta-data*,x-ms-meta-target*,x-ms-meta-abc</AllowedHeaders>
        <ExposedHeaders>x-ms-meta-*</ExposedHeaders>
        <MaxAgeInSeconds>200</MaxAgeInSeconds>
    </CorsRule>
<Cors>
```

Вот что означает каждая строка:

* **AllowedOrigins** это показывает, какие домены несоответствующий можно запрашивать и получать данные из службы хранилища hello. В этом примере указано, что и домен contoso.com, и домен fabrikam.com могут запрашивать данные из хранилища BLOB-объектов для учетной записи хранения. Можно также задать этот шаблон tooa (\*) запрашивает все домены tooaccess tooallow.
* **AllowedMethods** это список hello методы (команды HTTP-запросов), которые могут использоваться при выполнении запроса hello. В этом примере разрешены только методы PUT и GET. Можно задать этот шаблон tooa (\*) использовать все методы toobe tooallow.
* **AllowedHeaders** запроса hello, заголовки, которые hello исходный домен можно указать при выполнении запроса hello. В этом примере разрешены все заголовки метаданных, которые начинаются с x-ms-meta-data, x-ms-meta-target и x-ms-meta-abc. Здравствуйте, подстановочный знак (\*) указывает, что все заголовки, начинающиеся со слова hello указан префикс допускается.
* **ExposedHeaders** сообщает, какие заголовки ответа должен быть предоставлен поставщиком запрос toohello браузера hello. В этом примере это любые заголовки, начинающиеся с "x-ms-meta-".
* **MaxAgeInSeconds** это максимальный период времени, что браузер будет кэшировать Предварительный запрос OPTIONS hello hello. (Дополнительные сведения о hello Предварительный запрос проверьте hello первой статье ниже).

#### <a name="resources"></a>Ресурсы
Дополнительные сведения о CORS и как tooenable, проверьте перечисленные ниже ресурсы.

* [Поддержка общего доступа к ресурсам независимо от источника (CORS) для служб хранилища Azure на Azure.com hello](../storage-cors-support.md)

  Приводятся общие сведения о CORS и работе tooset hello правил для служб хранилища различных hello.
* [Поддержка общего доступа к ресурсам независимо от источника (CORS) для hello служб хранилища Azure на MSDN](https://msdn.microsoft.com/library/azure/dn535601.aspx)

  Это hello справочную документацию по поддержка CORS для служб хранилища Azure hello. Это tooarticles ссылок, применения tooeach службы хранилища и показан пример и описание каждого элемента в файле CORS hello.
* [Служба хранилища Microsoft Azure: знакомство с CORS](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/02/03/windows-azure-storage-introducing-cors.aspx)

  Это статье ссылку toohello начальной блог объявляет о CORS и отображение как toouse его.

## <a name="frequently-asked-questions-about-azure-storage-security"></a>Часто задаваемые вопросы о безопасности службы хранилища Azure
1. **Как проверять целостность hello hello больших двоичных объектов, который я передачи в или из хранилища Azure, использования протокола HTTPS hello**

   Если для какой-либо причине требуется toouse HTTP вместо HTTPS и вы работаете с блочных больших двоичных объектов может использовать проверка MD5 toohelp проверки целостности hello hello BLOB-объектов, передаваемых. Это поможет защититься от ошибок транспортного и сетевого уровня, но не обязательно предотвратит атаки промежуточного уровня.

   Если можно использовать протокол HTTPS, который обеспечивает безопасность на транспортном уровне, то применение проверки MD5 является избыточным и ненужным.

   Дополнительные сведения можно найти hello [обзоре MD5 подписей больших двоичных объектов Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/02/18/windows-azure-blob-md5-overview.aspx).
2. **Как насчет соответствия FIPS для США hello США?**

   Hello США федеральным сведения обработки Standard (FIPS) определяет алгоритмы шифрования, утвержденные для использования в США Федеральным правительством компьютерах hello защиты конфиденциальных данных. Включение FIPS режима в Windows server или рабочего стола сообщает hello ОС, должны использоваться только проверка FIPS алгоритмы шифрования. Если приложение использует-совместимые алгоритмы, hello приложения будет приостановлено. Построенной при помощи.NET Framework версии 4.5.2 или более поздней версии, приложение hello автоматически переключается алгоритмы toouse FIPS-совместимые алгоритмы шифрования hello при hello компьютер находится в режиме FIPS.

   Корпорация Майкрософт оставляет ее вверх toodecide клиента tooeach ли tooenable режиме FIPS. Мы надеемся, что нет никаких веских причин для клиентов, которые не являются режим FIPS tooenable нормам toogovernment тема по умолчанию.

   **Ресурсы**

* [Почему мы больше не рекомендуем использовать режим FIPS](http://blogs.technet.com/b/secguide/archive/2014/04/07/why-we-re-not-recommending-fips-mode-anymore.aspx)

  В этой записи блога приводятся общие сведения о FIPS и объясняется, почему режим FIPS не включен по умолчанию.
* [Проверка на соответствие стандарту FIPS 140](https://technet.microsoft.com/library/cc750357.aspx)

  Эта статья содержит сведения о как продукты корпорации Майкрософт и криптографических модулей соответствует стандарту FIPS hello для США hello правительства США.
* ["System cryptography: Use FIPS compliant algorithms for encryption, hashing, and signing" security settings effects in Windows XP and in later versions of Windows](https://support.microsoft.com/kb/811833) (Влияние параметров безопасности "Системная криптография: использовать FIPS-совместимые алгоритмы для шифрования, хэширования и подписывания" в Windows XP и более поздних версиях Windows)

  В этой статье рассказывается о hello использовать режим FIPS в более старых компьютерах Windows.
