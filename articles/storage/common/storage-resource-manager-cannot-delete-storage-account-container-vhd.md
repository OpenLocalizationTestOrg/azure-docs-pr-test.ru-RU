---
title: "aaaTroubleshoot ошибки при удалении учетных записей хранилища Azure, контейнера или виртуальные жесткие диски | Документы Microsoft"
description: "Устранение ошибок при удалении учетных записей хранения Azure, контейнеров или виртуальных жестких дисков"
services: storage
documentationcenter: 
author: genlin
manager: cshepard
editor: na
tags: storage
ms.assetid: 17403aa1-fe8d-45ec-bc33-2c0b61126286
ms.service: storage
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: genli
ms.openlocfilehash: 33261562a2dd2614b35bc1118924513f8c624d6a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-errors-when-you-delete-azure-storage-accounts-containers-or-vhds"></a>Устранение ошибок при удалении учетных записей хранения Azure, контейнеров или виртуальных жестких дисков

Могут возникать ошибки при попытке toodelete учетной записи хранилища Azure, контейнера или виртуального жесткого диска (VHD) в hello [портал Azure](https://portal.azure.com). Эта статья содержит неполадок руководство toohelp resolve hello в развертывании диспетчера ресурсов Azure.

Если в данной статье не освещаются Azure, посетите hello форумы Azure на [MSDN и переполнения стека](https://azure.microsoft.com/support/forums/). Проблему можно опубликовать на следующих форумах или too@AzureSupport в Twitter. Кроме того, можно зарегистрировать запрос поддержки Azure, выбрав **получение поддержки** на hello [поддержки Azure](https://azure.microsoft.com/support/options/) сайта.

## <a name="symptoms"></a>Симптомы
### <a name="scenario-1"></a>Сценарий 1
Hello следующие сообщение об ошибке появляется при попытке toodelete VHD в учетной записи хранения в развертывании диспетчера ресурсов:

**Не удалось выполнить toodelete BLOB-объект «vhds/BlobName.vhd». Ошибка: В настоящее время отсутствует аренду на большой двоичный объект hello и идентификатор аренды не был указан в запросе hello.**

Эта проблема может возникнуть, так как в виртуальной машины (VM) на hello виртуального жесткого диска, что вы пытаетесь toodelete аренды.

### <a name="scenario-2"></a>Сценарий 2
Hello следующие сообщение об ошибке появляется при попытке toodelete контейнера в учетной записи хранения в развертывании диспетчера ресурсов:

**Не удалось выполнить виртуальные жесткие диски «toodelete хранилища контейнера». Ошибка: В настоящее время отсутствует аренду для контейнера hello и идентификатор аренды не был указан в запросе hello.**

Эта проблема может возникнуть из-за VHD, который заблокирован в hello состояние аренды контейнера hello.

### <a name="scenario-3"></a>Сценарий 3
Hello следующие сообщение об ошибке появляется при попытке toodelete учетной записи хранения в развертывании диспетчера ресурсов:

**Не удалось выполнить toodelete учетной записи хранения «StorageAccountName». Ошибка: hello учетной записи хранилища нельзя удалить из-за tooits артефакты используются.**

Эта проблема может возникнуть, поскольку учетная запись хранения hello содержит виртуальный жесткий ДИСК, который находится в состоянии аренды hello.

## <a name="solution"></a>Решение 
tooresolve эти проблемы, необходимо определить hello виртуального жесткого диска, вызвавших ошибки hello и hello связанных виртуальных Машин. Затем отсоединить hello виртуального жесткого диска из hello виртуальной Машины (для дисков данных) или удалить hello виртуальной Машины, использующей hello виртуального жесткого диска (для дисков операционной системы). Это удаляет hello аренды из hello виртуального жесткого диска и позволяет удалить toobe. 

toodo, воспользуйтесь одним из следующих методов hello:

### <a name="method-1---use-azure-storage-explorer"></a>Метод 1. Использование обозревателя хранилищ Azure

### <a name="step-1-identify-hello-vhd-that-prevent-deletion-of-hello-storage-account"></a>Шаг 1 выявление hello виртуального жесткого диска, для предотвращения удаления учетной записи хранения hello

1. При удалении учетной записи хранилища hello, появится диалоговое окно сообщения hello ниже: 

    ![При удалении учетной записи хранилища hello сообщение об ошибке](././media/storage-resource-manager-cannot-delete-storage-account-container-vhd/delete-storage-error.png) 

2. Проверьте hello **URL-адрес диск** tooidentify учетной записи хранилища hello и hello виртуального жесткого диска, который не позволяет удалить учетную запись хранения hello. В следующем примере hello, hello строки перед «. blob.core.windows.net "hello имя учетной записи хранилища, который «SCCM2012-2015-08-28.vhd» hello имени виртуального жесткого диска.  

        https://portalvhds73fmhrw5xkp43.blob.core.windows.net/vhds/SCCM2012-2015-08-28.vhd

### <a name="step-2-delete-hello-vhd-by-using-azure-storage-explorer"></a>Шаг 2 Delete hello виртуального жесткого диска с помощью обозревателя хранилищ Azure

1. Загрузка и установка hello последнюю версию [обозреватель хранилищ Azure](http://storageexplorer.com/). Этот инструмент представляет отдельное приложение от Майкрософт, которая позволяет вам tooeasily работу с данными хранилища Azure для Windows, macOS и Linux.
2. Откройте обозреватель хранилищ Azure, щелкните ![значок учетной записи](./media/storage-resource-manager-cannot-delete-storage-account-container-vhd/account.png) на левой панели hello выберите среду Azure и войдите в нее.

3. Выберите все подписки или подписки hello, содержащий hello, требуется toodelete учетной записи хранилища.

    ![Добавление подписки](./media/storage-resource-manager-cannot-delete-storage-account-container-vhd/addsub.png)

4. Go toohello учетной записи хранилища, которые были получены из hello диска URL-адрес ранее, установите hello **контейнеров больших двоичных объектов** > **виртуальных жестких дисков** и выполните поиск hello виртуального жесткого диска, который не позволяет удалить учетную запись хранилища hello.
5. Если обнаруживается hello виртуального жесткого диска, проверьте hello **имя виртуальной Машины** hello toofind столбца виртуальной Машине, которая использует этот виртуальный жесткий ДИСК.

    ![Поиск виртуальной машины](./media/storage-resource-manager-cannot-delete-storage-account-container-vhd/check-vm.png)

6. Удалите hello аренды из hello виртуального жесткого диска с помощью портала Azure. Дополнительные сведения см. в разделе [аренды hello удалить из виртуального жесткого диска hello](#remove-the-lease-from-the-vhd). 

7. Перейти toohello обозреватель хранилища Azure, щелкните правой кнопкой мыши hello виртуального жесткого диска, а затем выберите Удалить.

8. Удалите учетную запись хранения hello.

### <a name="method-2---use-azure-portal"></a>Метод 2. Использование портала Azure 

#### <a name="step-1-identify-hello-vhd-that-prevent-deletion-of-hello-storage-account"></a>Шаг 1: Определение hello виртуального жесткого диска, для предотвращения удаления учетной записи хранения hello

1. При удалении учетной записи хранилища hello, появится диалоговое окно сообщения hello ниже: 

    ![При удалении учетной записи хранилища hello сообщение об ошибке](././media/storage-resource-manager-cannot-delete-storage-account-container-vhd/delete-storage-error.png) 

2. Проверьте hello **URL-адрес диск** tooidentify учетной записи хранилища hello и hello виртуального жесткого диска, который не позволяет удалить учетную запись хранения hello. В следующем примере hello, hello строки перед «. blob.core.windows.net "hello имя учетной записи хранилища, который «SCCM2012-2015-08-28.vhd» hello имени виртуального жесткого диска.  

        https://portalvhds73fmhrw5xkp43.blob.core.windows.net/vhds/SCCM2012-2015-08-28.vhd

2. Войдите в toohello [портал Azure](https://portal.azure.com).
3. Выберите меню концентратора hello **все ресурсы**. Перейти toohello учетной записи хранилища, а затем выберите **большие двоичные объекты** > **виртуальные жесткие диски**.

    ![Снимок экрана: hello портала, с учетной записью хранения hello и выделяются контейнера «vhds» hello](./media/storage-resource-manager-cannot-delete-storage-account-container-vhd/opencontainer.png)

4. Найдите hello виртуального жесткого диска, были получены из URL-адреса диска hello ранее. После этого определить, какие виртуальной Машины с помощью hello виртуального жесткого диска. Как правило можно определить, удерживающий hello виртуального жесткого диска, проверив имя hello виртуального жесткого диска виртуальной Машины:

Виртуальная машина в модели разработки Resource Manager

   * Диски ОС используют следующее соглашение об именовании: "Имя_ВМ-YYYY-MM-DD-HHMMSS.vhd".
   * Диски данных используют следующее соглашение об именовании: "Имя_ВМ-YYYY-MM-DD-HHMMSS.vhd".

Виртуальная машина в классической модели разработки

   * Диски ОС используют следующее соглашение об именовании: "имя_облачной_службы-имя_ВМ-YYYY-MM-DD-HHMMSS.vhd".
   * Диски данных используют следующее соглашение об именовании: "имя_облачной_службы-имя_ВМ-YYYY-MM-DD-HHMMSS.vhd".

#### <a name="step-2-remove-hello-lease-from-hello-vhd"></a>Шаг 2: Удаление hello аренды из hello виртуального жесткого диска

[Удалите hello аренды из hello VHD](#remove-the-lease-from-the-vhd)и удалите учетную запись хранения hello.

## <a name="what-is-a-lease"></a>Общие сведения об аренде
Аренда — блокировку, которая может быть большого двоичного объекта tooa используется toocontrol доступа (например, VHD). При большой двоичный объект арендован, только владельцы hello аренды hello могут обращаться к hello большого двоичного объекта. Аренда важно для hello следующих причин:

* Предотвращает повреждение данных, если несколько владельцев повторите toowrite toohello один и тот же hello большого двоичного объекта в hello то же время.
* Они препятствуют hello большой двоичный объект удаляется, если что-то активно используется (например, виртуальная машина).
* Учетная запись хранения hello предотвращает удаляются, если что-то активно используется (например, виртуальная машина).

### <a name="remove-hello-lease-from-hello-vhd"></a>Удалите hello аренды из hello виртуального жесткого диска
Если hello виртуального жесткого диска на диск операционной системы, необходимо удалить аренды hello tooremove ВМ hello:

1. Войдите в toohello [портал Azure](https://portal.azure.com).
2. На hello **концентратора** последовательно выберите пункты **виртуальные машины**.
3. Выберите hello виртуальной Машине, которая удерживает аренды hello виртуального жесткого диска.
4. Убедитесь, что ничего не активно использует hello виртуальной машины, и что больше не нужна hello виртуальной машины.
5. Вверху hello hello **виртуальной Машины сведений** колонке выберите **удаление**и нажмите кнопку **Да** tooconfirm.
6. Hello ВМ должны быть удалены, но могут храниться hello виртуального жесткого диска. Однако hello виртуального жесткого диска не должны иметь аренду на нем. Он может занять несколько минут для освобождения toobe аренды hello. выпущена tooverify, hello аренды, перейдите в слишком**все ресурсы** > **имя учетной записи хранения** > **большие двоичные объекты**  >  **виртуальные жесткие диски**. В hello **больших двоичных объектов свойств** области, hello **состояние аренды** значение должно быть **разблокировано**.

Если hello виртуального жесткого диска является диском с данными, отсоедините hello виртуального жесткого диска из hello ВМ tooremove hello аренды.

1. Войдите в toohello [портал Azure](https://portal.azure.com).
2. На hello **концентратора** последовательно выберите пункты **виртуальные машины**.
3. Выберите hello виртуальной Машине, которая удерживает аренды hello виртуального жесткого диска.
4. Выберите **дисков** на hello **виртуальной Машины сведений** колонку.
5. Выберите диск данных hello, удерживает аренды hello виртуального жесткого диска. Можно определить, какие VHD, подключенный в диск hello, проверьте URL-адрес hello hello виртуального жесткого диска.
6. Определите точно, что ничего не активно использует диск данных hello.
7. Нажмите кнопку **отсоединения** на hello **диск сведения** колонку.
8. диск Hello, теперь должны быть отсоединены от hello виртуальной Машины и hello виртуального жесткого диска не должны иметь аренду на нем. Он может занять несколько минут для освобождения toobe аренды hello. выпущена tooverify, hello аренды, перейдите в слишком**все ресурсы** > **имя учетной записи хранения** > **большие двоичные объекты**  >  **виртуальные жесткие диски**. В hello **больших двоичных объектов свойств** области, hello **состояние аренды** значение должно быть **разблокировано**.

## <a name="next-steps"></a>Дальнейшие действия
* [Удаление учетной записи хранения](storage-create-storage-account.md#delete-a-storage-account)
* [Как toobreak hello заблокирован аренды хранилища больших двоичных объектов в Microsoft Azure (PowerShell)](https://gallery.technet.microsoft.com/scriptcenter/How-to-break-the-locked-c2cd6492)
