---
title: "профили aaaScoring (Azure поиска REST API версия 2015-02-28-Preview) | Документы Microsoft"
description: "Поиск Azure — это размещенная облачная служба поиска, которая поддерживает настройку ранжированных результатов на основе определяемых пользователем профилей повышения."
services: search
documentationcenter: 
author: HeidiSteen
manager: jhubbard
editor: 
ms.assetid: bfd62649-13d7-40b3-a8fa-85521a15084d
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.author: heidist
ms.date: 10/27/2016
ms.openlocfilehash: 17f83fdf6818dc6ffcc3e04f5d0185c6f646b63d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="scoring-profiles-azure-search-rest-api-version-2015-02-28-preview"></a>Профили оценки (API REST службы "Поиск Azure", версия 2015-02-28-Preview)
> [!NOTE]
> В этой статье описывается профилей оценки в hello [2015-02-28-Preview](search-api-2015-02-28-preview.md). В настоящее время нет никаких различий между hello `2016-09-01` версии, указанные в [MSDN](http://msdn.microsoft.com/library/azure/mt183328.aspx) и hello `2015-02-28-Preview` версии описанные здесь, и мы в этом документе все равно в покрытие tooprovide документа через hello все API.
>
>

## <a name="overview"></a>Обзор
Оценка — toohello вычисления оценки поиска для всех элементов, возвращенных в результатах поиска. Оценка Hello является индикатором релевантности элемента в контексте hello hello текущей операции поиска. Здравствуйте, высокая оценка hello, hello большей степени hello элемента. В результатах поиска элементы являются ранг, начиная от высокой toolow, в зависимости от оценки поиска hello, вычисленных для каждого элемента.

Поиск Azure использует оценки toocompute начальная оценка по умолчанию, но вы можете настроить вычисление hello с помощью профиля оценки. Профили оценки предоставляют больший контроль над hello ранжирования элементов в результатах поиска. Например может требуется tooboost элементов на основании потенциальный доход, повысить более новые элементы или возможно повысить приоритет элементов, которые были на складе слишком долго.

Профиль повышения является частью определения индекса hello, состоящий из полей, функций и параметров.

toogive вас о том, что профиль оценки, как выглядит, hello следующем примере показан простой профиль с именем «geo». Повышает приоритет элементов, содержащих условие поиска hello в hello `hotelName` поля. Она также использует hello `distance` функции toofavor элементов в пределах 10 км от текущего расположения hello. Если кто-то ищет hello термин «ИНН» и «ИНН» toobe часть hello в название отеля, документы, содержащие слово «ИНН» будут выше в результатах поиска hello.

    "scoringProfiles": [
      {
        "name": "geo",
        "text": {
          "weights": { "hotelName": 5 }
        },
        "functions": [
          {
            "type": "distance",
            "boost": 5,
            "fieldName": "location",
            "interpolation": "logarithmic",
            "distance": {
              "referencePointParameter": "currentLocation",
              "boostingDistance": 10
            }
          }
        ]
      }
    ]

toouse — этот профиль оценки запрос создан профиль toospecify hello в строке запроса hello. Ниже запрос hello, обратите внимание, в параметр запроса hello, `scoringProfile=geo` в запросе hello.

    GET /indexes/hotels/docs?search=inn&scoringProfile=geo&scoringParameter=currentLocation--122.123,44.77233&api-version=2015-02-28-Preview

Этот запрос выполняет поиск по hello термин «ИНН» и передает в текущем расположении hello. Обратите внимание, что этот запрос содержит другие параметры, такие как `scoringParameter`. Параметры запроса описаны в [разделе, в котором рассматривается поиск документов (API службы "Поиск Azure")](search-api-2015-02-28-preview.md#SearchDocs).

Нажмите кнопку [пример](#example) tooreview более подробный пример профиля оценки.

## <a name="what-is-default-scoring"></a>Что такое оценка по умолчанию?
В процессе оценки вычисляется оценка поиска для каждого элемента в упорядоченном по рангу результирующем наборе. Каждый элемент в наборе результатов поиска назначается Оценка поиска, то toolowest высоким рангом. Элементы с более высокой оценкой hello возвращаются toohello приложения. По умолчанию hello возвращаются первые 50, но можно использовать hello `$top` tooreturn параметр меньшее или большее число элементов (вверх too1000 в одном ответе).

По умолчанию оценка поиска вычисляется на основе статистических свойств данных hello и hello запроса. Поиск Azure находит документы, содержащие условия поиска hello в строке запроса hello (некоторые или все, в зависимости от `searchMode`), отдавая предпочтение документам, которые содержат несколько экземпляров hello поисковому запросу. Оценка поиска Hello поднимается выше даже если между hello совокупности данных, но часто — внутри документа hello редких hello термин. основой Hello релевантности toocomputing этот подход известен как TF-IDF или (частота термина обратная частота документа).

Если предположить, что пользовательская сортировка не применяется, результаты ранжируются по оценке поиска, прежде чем они будут возвращены вызывающему приложению toohello. Если `$top` не указан, 50 элементов с hello наибольший поиска возвращаются оценки.

Значения оценки поиска в результирующем наборе могут повторяться. Например, может быть 10 элементов с оценкой 1,2, 20 элементов с оценкой 1,0 и 20 элементов с оценкой 0,5. При нескольких имеют hello одинаковая Оценка поиска, hello упорядочение элементов не определен и может быть нестабильным. Снова запустите запрос hello и могут отображаться элементы смещается положение. Если есть два элемента с одинаковой оценкой, невозможно определить, какой из них отобразится первым.

## <a name="when-toouse-custom-scoring"></a>Когда toouse пользовательские оценки
Если ранжирования поведение по умолчанию hello не перейти в достаточной степени удовлетворяет вашим бизнес-целям, следует создать один или несколько профилей оценки. Например, вы можете решить, что при поиске следует предпочитать вновь добавленные элементы. Аналогично, у вас может быть поле, содержащее удельную прибыль, или другое поле, указывающее потенциальный доход. Повышение приоритета элементов, которые дают преимущества tooyour бизнеса может быть важным фактором при решении toouse профилей оценки.

Упорядочивание на основе релевантности также реализуется с помощью профилей оценки. Рассмотрите возможность страниц, которые вы использовали в прошлом hello, позволяющие сортировать по цене, дате, оценка или релевантности результатов поиска. В поиске Azure профили оценки диска параметр «релевантности» hello. Вы, необходимом toodeliver по бизнес-целями и типом результатов поиска hello допустимому Hello определение релевантности.

<a name="example"></a>

## <a name="example"></a>Пример
Как отмечалось ранее, пользовательская оценка реализуется с профилей оценки, определенных в схеме индекса.

В этом примере показано hello схема индекса с двумя профилями оценки (`boostGenre`, `newAndHighlyRated`). Любой запрос к этому индексу, включающий профиль в качестве параметра запроса будет использовать hello профиль tooscore hello результирующий набор.

    {
      "name": "musicstoreindex",
      "fields": [
        { "name": "key", "type": "Edm.String", "key": true },
        { "name": "albumTitle", "type": "Edm.String" },
        { "name": "albumUrl", "type": "Edm.String", "filterable": false },
        { "name": "genre", "type": "Edm.String" },
        { "name": "genreDescription", "type": "Edm.String", "filterable": false },
        { "name": "artistName", "type": "Edm.String" },
        { "name": "orderableOnline", "type": "Edm.Boolean" },
        { "name": "rating", "type": "Edm.Int32" },
        { "name": "tags", "type": "Collection(Edm.String)" },
        { "name": "price", "type": "Edm.Double", "filterable": false },
        { "name": "margin", "type": "Edm.Int32", "retrievable": false },
        { "name": "inventory", "type": "Edm.Int32" },
        { "name": "lastUpdated", "type": "Edm.DateTimeOffset" }
      ],
      "scoringProfiles": [
        {
          "name": "boostGenre",
          "text": {
            "weights": {
              "albumTitle": 1.5,
              "genre": 5,
              "artistName": 2
            }
          }
        },
        {
          "name": "newAndHighlyRated",
          "functions": [
            {
              "type": "freshness",
              "fieldName": "lastUpdated",
              "boost": 10,
              "interpolation": "quadratic",
              "freshness": {
                "boostingDuration": "P365D"
              }
            },
            {
              "type": "magnitude",
              "fieldName": "rating",
              "boost": 10,
              "interpolation": "linear",
              "magnitude": {
                "boostingRangeStart": 1,
                "boostingRangeEnd": 5,
                "constantBoostBeyondRange": false
              }
            }
          ]
        }
      ],
      "suggesters": [
        {
          "name": "sg",
          "searchMode": "analyzingInfixMatching",
          "sourceFields": ["albumTitle", "artistName"]
        }
      ]
    }


## <a name="workflow"></a>Рабочий процесс
tooimplement пользовательские оценки поведение, добавить схему toohello профиль оценки, определяющую hello индекса. Можно создать до too16 профилей оценки в индексе (см. [ограничения служб](search-limits-quotas-capacity.md)), но одновременно в одном запросе можно указать только один профиль.

Начать с hello [шаблона](#bkmk_template) приведенные в этом разделе.

Введите имя. Профили оценки являются обязательными, но при добавлении одного hello имя является обязательным. Быть убедиться, что toofollow hello соглашения об именовании полей (начинается с буквы, позволяет избежать специальных символов и зарезервированных слов). Правила именования приведены в статье [Правила именования](http://msdn.microsoft.com/library/azure/dn857353.aspx) .

текст Hello hello профиль оценки состоит из взвешенных полей и функций.

### <a name="weights"></a>Weights
Hello `weights` пары имя значение, присвоить полю относительный вес tooa указывает свойства профиля. В hello [пример](#example), поля albumTitle, genre и artistName hello: повышенного 1.5, 5 и 2, соответственно. Почему для genre приоритет повышен намного больше, чем другие hello? Если выполняется поиск данных, несколько однородных (как это бывает hello «жанр» в hello `musicstoreindex`), может потребоваться большая Вариативность в относительный вес hello. Например, в hello `musicstoreindex`, «рок» появляется как жанр и в идентично сформулированных описаниях жанра. Описание жанра toooutweigh следует hello жанра, полю genre потребуется гораздо больший относительный вес.

### <a name="functions"></a>Функции
Функции используются, когда необходимы дополнительные вычисления для определенных контекстов. Допустимые типы функций: `freshness`, `magnitude`, `distance` и `tag`. Каждая функция имеет параметры, которые являются уникальными tooit.

* `freshness`можно использовать при необходимости — tooboost с нового или старого элемента. Эта функция может использоваться только с полями типа "дата и время" (`Edm.DataTimeOffset`). Примечание hello `boostingDuration` атрибут используется только с функцией актуальность hello.
* `magnitude`можно использовать при необходимости — tooboost на основе как большими или очень маленькими числовые значения. К сценариям, в которых может вызваться эта функция, относится повышение приоритета на основе прибыли, наибольшей цены, наименьшей цены или числа загрузок. Можно изменить диапазон hello, высокой toolow, если требуется hello инвертированную схему (например, tooboost более низкой стоимостью элементов больше, чем более дорогими элементами). Данный диапазон цен от 100 слишком $1, необходимо установить `boostingRangeStart` 100 и `boostingRangeEnd` элементы более низкой стоимостью 1 tooboost hello. Эта функция может использоваться только с полями типа double и integer.
* `distance`следует использовать при необходимости tooboost по близости или географическому расположению. Эта функция может использоваться только с полями типа `Edm.GeographyPoint` .
* `tag`следует использовать при необходимости tooboost по тегам общих между документами и поисковые запросы. Эта функция может использоваться только с полями `Edm.String` и `Collection(Edm.String)`.

#### <a name="rules-for-using-functions"></a>Правила использования функции
* Тип функции (freshness, magnitude, distance, tag) необходимо указывать в нижнем регистре.
* Функции не могут содержать значения NULL или пустые значения. В частности, если добавить поле fieldname, у вас есть tooset его toosomething.
* Функции могут быть только примененных toofilterable поля. Дополнительные сведения о фильтруемых полях см. в разделе [Создание индекса](search-api-2015-02-28-preview.md#CreateIndex).
* Функции могут быть только примененных toofields, определенные в коллекции fields hello индекса.

После определения индекса hello постройте индекс hello, загрузив схему индекса hello, и документы. Инструкции по этим операциям приведены в разделах [Создание индекса](search-api-2015-02-28-preview.md#CreateIndex) и [Добавление или обновление документов](search-api-2015-02-28-preview.md#AddOrUpdateDocuments). После построения индекса hello необходим работающий профиль оценки, который работает с данными поиска.

<a name="bkmk_template"></a>

## <a name="template"></a>Шаблон
В этом разделе показано hello синтаксис и шаблон для профилей оценки. См. слишком[индекса ссылка на атрибут](#bkmk_indexref) в следующем разделе hello для описания атрибутов hello.

    ...
    "scoringProfiles": [
      {
        "name": "name of scoring profile",
        "text": (optional, only applies toosearchable fields) {
          "weights": {
            "searchable_field_name": relative_weight_value (positive #'s),
            ...
          }
        },
        "functions": (optional) [
          {
            "type": "magnitude | freshness | distance | tag",
            "boost": # (positive number used as multiplier for raw score != 1),
            "fieldName": "...",
            "interpolation": "constant | linear (default) | quadratic | logarithmic",

            "magnitude": {
              "boostingRangeStart": #,
              "boostingRangeEnd": #,
              "constantBoostBeyondRange": true | false (default)
            }

            // (- or -)

            "freshness": {
              "boostingDuration": "..." (value representing timespan over which boosting occurs)
            }

            // (- or -)

            "distance": {
              "referencePointParameter": "...", (parameter toobe passed in queries toouse as reference location)
              "boostingDistance": # (hello distance in kilometers from hello reference location where hello boosting range ends)
            }

            // (- or -)

            "tag": {
              "tagsParameter": "..." (parameter toobe passed in queries toospecify list of tags toocompare against target field)
            }
          }
        ],
        "functionAggregation": (optional, applies only when functions are specified)
            "sum (default) | average | minimum | maximum | firstMatching"
      }
    ],
    "defaultScoringProfile": (optional) "...",
    ...

<a name="bkmk_indexref"></a>

## <a name="scoring-profile-property-reference"></a>Справочник по свойствам профиля повышения
> [!NOTE]
> Функция оценки может быть только примененных toofields, которые можно использовать.
>
>

| Свойство | Описание |
| --- | --- |
| `name` |Обязательный элемент. Это имя hello hello профиль оценки. Он же соглашения об именах поля hello следующим образом. Оно должно начинаться с буквы, не может содержать точки, двоеточия или @ символов и не может начинаться с фразы hello строки «azureSearch» (с учетом регистра). |
| `text` |Содержит свойство hello весовые коэффициенты. |
| `weights` |необязательный параметр. Пара "имя-значение", указывающая имя поля и относительный вес. Относительный вес должен быть положительным целым числом или числом с плавающей запятой. Можно указать имя поля hello без соответствующего веса. Веса — это важность hello используется tooindicate относительный tooanother одно поле. |
| `functions` |необязательный параметр. Обратите внимание, что функция оценки может быть только примененных toofields, которые можно использовать. |
| `type` |Требуется для функций оценки. Указывает тип toouse функции hello. Допустимые значения: `magnitude`, `freshness`, `distance` и `tag`. В каждый профиль оценки можно включить несколько функций. имя функции Hello должен состоять из строчных букв. |
| `boost` |Требуется для функций оценки. Положительное число, используемое в качестве множителя для необработанной оценки. Он не может быть равно too1. |
| `fieldName` |Требуется для функций оценки. Функция оценки может быть только примененных toofields, которые являются частью коллекции полей hello hello индекса и таблицы, которые можно использовать. Кроме того, каждый тип функции накладывает дополнительные ограничения (freshness используется с полями типа datetime, magnitude — с полями типа integer или double, distance — с полями типа location, а tag — с полями типа string или string collection). В определении функции можно указать только одно поле. Для примера toouse magnitude дважды в Здравствуйте того же профиля, потребовалось бы tooinclude два определения magnitude, по одному для каждого поля. |
| `interpolation` |Требуется для функций оценки. Определяет наклон hello, для которых hello повышения приоритета оценки от начала hello hello диапазон toohello конец диапазона hello. Допустимые значения: `linear` (по умолчанию), `constant`, `quadratic` и `logarithmic`. Дополнительные сведения см. в разделе [Настройка интерполяций](#bkmk_interpolation). |
| `magnitude` |функция оценки magnitude Hello — используется tooalter оценок на основании hello диапазон значений для числового поля. Ниже приведены некоторые hello наиболее распространенные примеры этого.<ul><li>Оценки: Alter hello оценки на основе hello значения в поле «Оценка по звездам» hello. Если два элемента релевантны, hello элемент с более высоким рейтингом hello будет отображаться первым.</li><li>Поля: Если два документа релевантны, розничный торговец может повышать tooboost документы, которые более высокой маржой.</li><li>Число нажатий: для приложений, которые отслеживают нажмите tooproducts действия или страницам, можно использовать величина tooboost элементов, которые tooget hello большая часть трафика.</li><li>Число загрузок: для приложений, которые отслеживают загрузки, Здравствуйте, функция magnitude позволяет повысить приоритет элементов, имеющих hello большинство файлов для загрузки.</li></ul> |
| `magnitude:boostingRangeStart` |Наборы hello начальное значение диапазона "hello", по которому вычисляется амплитуда. Hello значение должно быть целое число или число с плавающей запятой. Для оценок по звездам от 1 до 4 — 1. Для маржи более 50 % — 50. |
| `magnitude:boostingRangeEnd` |Задает конечное значение диапазона hello, по которому вычисляется амплитуда hello. Hello значение должно быть целое число или число с плавающей запятой. Для оценок по звездам от 1 до 4 — 4. |
| `magnitude:constantBoostBeyondRange` |Допустимые значения: true или false (по умолчанию). Если значение tootrue, hello полное повышение продолжит toodocuments tooapply, имеющих значение для hello целевого поля выше, чем верхнее hello hello диапазона. Если значение равно false, повышение функции hello не будет применен toodocuments, имеющим значение для hello целевого поля, находящееся за пределами диапазона hello. |
| `freshness` |функция оценки freshness Hello — используется tooalter ранжирования оценки элементов на основании значений полей DateTimeOffset. Например, элемент с более близкой датой может классифицироваться выше, чем старые элементы. (Обратите внимание, что также возможно toorank элементы как события календаря с даты в будущем, таким образом, что элементы ближе toohello присутствует может классифицироваться выше, чем дополнительные элементы в будущем hello.) В текущей версии службы hello один конец диапазона hello будет исправлена toohello текущее время. Hello другого элемента — это период, в основании hello последние hello `boostingDuration`. диапазон времени в будущем hello tooboost используйте отрицательное `boostingDuration`. частота Hello, на какие hello повышение приоритета изменений для минимального и максимального диапазона определяется toohello интерполяции применения hello профиль оценки (см. на следующем рисунке hello). tooreverse Здравствуйте направление коэффициента, выберите коэффициент повышения приоритета, меньше 1. |
| `freshness:boostingDuration` |Задает срок действия, после которого повышение приоритета перестает применяться для определенного документа. В разделе [задать boostingDuration](#bkmk_boostdur) в следующем разделе, синтаксис и примеры hello. |
| `distance` |функция оценки distance Hello — используется tooaffect hello, оценки документов на основе о том, как закрыть или далеко их относительные tooa контрольного географического расположения. Hello эталонное расположение предоставляется как часть запроса hello в параметре (с помощью hello `scoringParameter` параметр запроса) в аргументе lon, LAT.. |
| `distance:referencePointParameter` |Toobe параметр, переданный в toouse запросов в качестве расположения ссылки. scoringParameter — это параметр запроса. Описание параметров запроса см. в разделе о [поиске документов](search-api-2015-02-28-preview.md#SearchDocs). |
| `distance:boostingDistance` |Число, указывающее hello расстояние в километрах от расположения ссылок hello, где заканчивается hello, повышая диапазона. |
| `tag` |Hello функция оценки используется тег tooaffect hello оценки документов на основе тегов в документах и запросах поиска. Документы, имеющие теги вместе с hello поисковый запрос будет увеличен. Здравствуйте теги для оценки параметра в каждом запросе поиска предоставляется hello поискового запроса (с помощью hello `scoringParameter` параметр запроса). |
| `tag:tagsParameter` |Toobe параметр передается в запросах toospecify тегов для определенного запроса. `scoringParameter` — это параметр запроса. Описание параметров запроса см. в разделе о [поиске документов](search-api-2015-02-28-preview.md#SearchDocs). |
| `functionAggregation` |необязательный параметр. Применяется, только если указаны функции. Допустимые значения: `sum` (по умолчанию), `average`, `minimum`, `maximum` и `firstMatching`. Оценка поиска — это одиночное значение, которое вычисляется на основе нескольких переменных, включая несколько функций. Эти атрибуты указывает, каким образом показателях hello всех функций hello объединяются в один статистические boost, то применяется toohello базовый индекс документа. Hello Базовая оценка основана на значение tf-idf hello, вычисленное на документ hello и hello поискового запроса. |
| `defaultScoringProfile` |Если при выполнении поискового запроса профиль оценки не указан, используется оценка по умолчанию (только tf-idf). Имя профиля оценки по умолчанию здесь можно указать, что вызывает toouse поиска Azure этот профиль, когда другой профиль предоставляется в запросе поиска hello. |

<a name="bkmk_interpolation"></a>

## <a name="set-interpolations"></a>Настройка интерполяций
Интерполяции позволяют toodefine hello наклон, для которых hello повышения приоритета оценки от начала hello hello диапазон toohello конец диапазона hello. можно использовать следующие интерполяции Hello.

* `Linear`: Для элементов, которые находятся в диапазоне min и hello max элемент toohello hello применяется только в постоянно убывающая величина. Линейной интерполяции по умолчанию hello для оценки профиля.
* `Constant`: Для элементов, которые находятся в пределах hello начальным и конечным диапазонами Постоянное повышение будет применен toohello результаты ранжирования.
* `Quadratic`: В tooa сравнения линейной интерполяцией с постоянно убывающим повышением приоритета квадратичная интерполяционная функция сначала уменьшается на более мелкие месте и затем мере приближения hello конец диапазона, уменьшается на гораздо большую величину. Этот тип интерполяции невозможно использовать в функциях оценки tag.
* `Logarithmic`: В tooa сравнения линейной интерполяцией с постоянно убывающим повышением приоритета логарифмическая интерполяционная функция сначала уменьшается быстрее, и затем мере приближения hello конец диапазона, уменьшается на гораздо меньшую величину. Этот тип интерполяции невозможно использовать в функциях оценки tag.

<a name="Figure1"></a> ![][1]

<a name="bkmk_boostdur"></a>

## <a name="set-boostingduration"></a>Настройка boostingDuration
`boostingDuration`— Это атрибут функции hello актуальность. Используется tooset прекратит срока, после которого повышение для определенного документа. Например tooboost строку продукта или фирменной символики для 10-дневного периода, указать hello 10-дневный период как «P10D» для соответствующих документов. Либо укажите tooboost предстоящих событий в hello следующей неделе»-P7D».

`boostingDuration` необходимо отформатировать как XSD-значение dayTimeDuration (ограниченное подмножество значения длительности ISO 8601). Hello схема выглядит следующим образом: `[-]P[nD][T[nH][nM][nS]]`.

в следующей таблице Hello содержит несколько примеров.

| Duration | boostingDuration |
| --- | --- |
| 1 день |"P1D" |
| 2 дня и 12 часов |"P2DT12H" |
| 15 минут |"PT15M" |
| 30 дней, 5 часов, 10 минут и 6,334 секунды |"P30DT5H10M6.334S" |

Дополнительные примеры см. в [документе о типах данных в схеме XML (веб-сайт W3.org)](http://www.w3.org/TR/xmlschema11-2/).

**Ознакомьтесь также с разделом** 
[Azure Search Service REST](http://msdn.microsoft.com/library/azure/dn798935.aspx) (REST службы поиска Azure) на сайте MSDN. <br/>
[Создание индекса (API Поиска Azure)](http://msdn.microsoft.com/library/azure/dn798941.aspx) (на сайте MSDN).<br/>
[Добавить оценки индекса для поиска профиля tooa](http://msdn.microsoft.com/library/azure/dn798928.aspx) на сайте MSDN<br/>

<!--Image references-->
[1]: ./media/search-api-scoring-profiles-2015-02-28-Preview/scoring_interpolations.png
