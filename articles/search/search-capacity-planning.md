---
title: "Планирование для службы поиска Azure aaaCapacity | Документы Microsoft"
description: "Настройка вычислительных ресурсов секций и реплик в Поиске Azure, в которых каждый ресурс оценивается в оплачиваемых единицах поиска."
services: search
documentationcenter: 
author: HeidiSteen
manager: jhubbard
editor: 
tags: azure-portal
ms.assetid: 1dc16afe-56f9-439d-8874-1733ae1a2b74
ms.service: search
ms.devlang: NA
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 02/08/2017
ms.author: heidist
ms.openlocfilehash: 4bbbb929a36b932ea7af12e494ca095d98b9005e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="scale-resource-levels-for-query-and-indexing-workloads-in-azure-search"></a>Масштабирование уровней ресурсов для рабочих нагрузок запросов и индексирования в Поиске Azure
По окончании [выберите ценовую категорию](search-sku-tier.md) и [Подготовка службы поиска](search-create-service-portal.md), hello следующим шагом является toooptionally увеличение hello количество реплик или разделы, используемые службой. Каждый уровень предоставляет фиксированное число единиц выставления счетов. В этой статье объясняется, как tooallocate эти единицы tooachieve оптимальной конфигурации, в котором будут сбалансированы требований для выполнения запроса, индексирование и хранилища.

Ресурс конфигурации доступна при настройке службы на hello [базового уровня](http://aka.ms/azuresearchbasic) или один из hello [стандартного уровней](search-limits-quotas-capacity.md). Для всех платных служб на этих уровнях емкость приобретается в *единицах поиска*, где каждая секция и реплика принимается за одну единицу поиска. 

Чем меньше используется единиц поиска, тем меньше выставляется счет. Выставление счетов для действует при условии, что настройка службы hello. Если временно не используются службы, единственным способом hello выставления счетов tooavoid является служба hello удаления и повторного создания его при необходимости.

> [!Note]
> Удаление службы приводит к удалению всех связанных с ней компонентов. В службе поиска Azure отсутствуют возможности резервного копирования и восстановления сохраненных данных для поиска. tooredeploy существующего индекса для новой службы, запустите toocreate программа, используемая hello и загрузить его изначально. 

## <a name="terminology-partitions-and-replicas"></a>Терминология: секции и реплики
Секции и реплики представляют hello основными ресурсами, которые поддерживают службы поиска.

| Ресурс | Определение |
|----------|------------|
|*Секции* | Служат для хранения индексов и ввода-вывода данных для операций чтения и записи (например, при повторном создании или обновлении индексов).|
|*Реплики* | Экземпляры службы поиска hello, используемых в основном tooload баланс запросов операций. На каждой реплике всегда размещается одна копия индекса. При наличии 12 реплики, вы получите 12 копии каждый индекс, загруженной на службу hello.|

> [!NOTE]
> Нет способа toodirectly управления на реплике, какие индексы или управления ею. Одна копия каждого индекса в каждой реплике является частью архитектуры служб hello.
>

## <a name="how-tooallocate-partitions-and-replicas"></a>Как tooallocate разделов и реплик
В Поиске Azure для службы поиска изначально выделяется минимальный уровень ресурсов, состоящий из одного раздела и одной реплики. Для уровней, которые поддерживают службу, вы можете постепенно корректировать вычислительные ресурсы, увеличивая количество секций, если вам нужно больше места для хранения и операций ввода-вывода, или добавляя реплики, чтобы увеличить объем запросов или повысить производительность. Одна служба должен иметь достаточно ресурсов toohandle всех рабочих нагрузок (индексирования и запросов). Нельзя разделить рабочие нагрузки между несколькими службами.

tooincrease или изменение выделения hello реплик и секции, мы рекомендуем использовать портал Azure hello. портал Hello применяет ограничения на допустимые сочетания, которые остаются под максимальные ограничения:

1. Войдите в toohello [портал Azure](https://portal.azure.com/) и выберите службу поиска hello.
2. В **параметры**откройте hello **шкалы** колонки и использование hello tooincrease ползунки или уменьшите значение hello разделов и реплик.

Здравствуйте, если требуется, чтобы на основе сценария или на основе кода инициализации подход, [API REST управления](https://msdn.microsoft.com/library/azure/dn832687.aspx) представляет собой альтернативный toohello портал.

Как правило поиска нужен несколько реплик, чем в секциях, особенно в том случае, если операции службы hello краткость рабочих нагрузок запросов. Здравствуйте, раздел на [высокий уровень доступности](#HA) объясняет, почему.

> [!NOTE]
> После подготовки службы не может быть обновленного tooa выше SKU. Может потребоваться toocreate службы поиска в новый уровень hello и перезагрузите индексах. В разделе [Создание службы поиска Azure на портале hello](search-create-service-portal.md) для справки при подготовке службы.
>
>

<a id="HA"></a>

## <a name="high-availability"></a>высокую доступность;
Так, как легко и относительно быстро tooscale вверх, обычно рекомендуется начать с одним разделом и одной или двух реплик, а затем масштабирования в виде запроса сборки. Для многих служб на уровнях Basic или S1 hello один раздел предоставляет достаточно хранилища и ввода-вывода (на 15 миллионов документов на секцию).

Рабочие нагрузки запросов в основном выполняются с репликами. Для повышения пропускной способности или обеспечения высокого уровня доступности вам, скорее всего, потребуется больше реплик.

Ниже приведены общие рекомендации для обеспечения высокой доступности.

* Две реплики для обеспечения высокой доступности рабочих нагрузок для чтения (запросов).
* Три или более реплик для обеспечения высокого уровня доступности рабочих нагрузок чтения и записи (запросов и индексирования по мере добавления, обновления или удаления отдельных документов).

Соглашения об уровне обслуживания для Поиска Azure используются для операций запросов и обновления индекса, которые состоят из добавления, обновления или удаления документов.

### <a name="index-availability-during-a-rebuild"></a>Доступность индексов во время повторного создания

Высокий уровень доступности для службы поиска Azure относится tooqueries и индекс обновления, которые не используют перестроения индекса. Если удалить поле, изменить тип данных или переименовать поле, необходимо будет toorebuild hello индекса. Индекс toorebuild hello, необходимо удалить hello индекса, повторного создания индекса hello и загружать данные hello.

> [!NOTE]
> Можно добавить новый индекс поиска Azure tooan поля без перестроения индекса hello. значение Hello hello новое поле будет иметь значение null для всех документов, уже в индексе hello.

toomaintain индекс доступности во время перестроения, необходимо иметь копию hello индекса с другим именем на hello одинаковые службы, или копию hello индекса с hello таким же именем на другую службу, а затем укажите перенаправления или отработки отказа логикой в вашем коде.

## <a name="disaster-recovery"></a>Аварийное восстановление
В настоящее время встроенного механизма для аварийного восстановления не предусмотрено. Добавление секции и реплики будет hello неправильный стратегия удовлетворения целей аварийного восстановления. Hello наиболее распространенным подходом является tooadd избыточности на уровне службы hello, настроив второй службы поиска в другом регионе. Как и в случае доступности во время перестроения индекса перенаправления hello и логика отработки отказа должны поступать из кода.

## <a name="increase-query-performance-with-replicas"></a>Увеличение производительности запросов с помощью реплик
Признаком необходимости добавления дополнительных реплик является задержка обработки запросов. Как правило первым шагом к улучшению производительности запросов является несколько tooadd этого ресурса. По мере добавления реплик дополнительные копии индекса hello, переводятся в режим online toosupport больше рабочих нагрузок запросов и hello баланс tooload запросы через hello несколько реплик.

Мы не можем предоставить жестких оценок для запросов в секунду (QPS): запросов, производительность зависит от сложности hello hello конкурирующих рабочих нагрузок и запросов. В среднем реплика на SKU уровня "Базовый" или S1 обслуживает около 15 запросов в секунду, но фактическая пропускная способность будет немного выше или ниже в зависимости от сложности запросов (фасетные запросы являются более сложными) и задержки сети. Кроме того, важно toorecognize, хотя Добавление реплик определенно повысит масштабируемость и производительность, hello результат не является строго линейным: добавление трех реплик не гарантирует увеличения пропускной способности втрое.

toolearn о QPS, включая способы оценки QPS для рабочих нагрузок, в разделе [управление службой поиска](search-manage.md).

## <a name="increase-indexing-performance-with-partitions"></a>Увеличение производительности индексирования с помощью секций
Приложениям поиска, которым требуется обновления данных в режиме, близком к реальному времени, понадобится пропорционально больше секций, чем реплик. При добавлении секций операции чтения-записи распределяются среди большего количества вычислительных ресурсов. Оно также обеспечивает больше дискового пространства для хранения дополнительных индексов и документов.

Больше индексов уходит больше времени tooquery. Поэтому может оказаться, что каждое добавочное увеличение числа секций потребует меньшего, но пропорционального увеличения числа реплик. Hello сложность запросов и запросов необходимо учитывать скорость выполнения запросов поворачивается.

## <a name="basic-tier-partition-and-replica-combinations"></a>Уровень "Базовый": сочетания разделов и реплик
Базовая служба может иметь только одну секцию и до toothree реплик, для которого установлено ограничение три SUs. только изменяемые ресурс Hello — реплик. Требуется не менее двух реплик, чтобы обеспечить высокий уровень доступности при обработке запросов.

<a id="chart"></a>

## <a name="standard-tiers-partition-and-replica-combinations"></a>Уровень "Стандартный": сочетания разделов и реплик
В этой таблице показаны сочетания необходимые toosupport SUs hello реплик и секции, ограничение 36 SU toohello субъекта для всех стандартных уровней.

|   | **1 секция** | **2 секции** | **3 секции** | **4 секции** | **6 секций** | **12 секций** |
| --- | --- | --- | --- | --- | --- | --- |
| **1 реплика** |1 ЕП |2 ЕП |3 ЕП |4 ЕП |6 ЕП |12 ЕП |
| **2 реплики** |2 ЕП |4 ЕП |6 ЕП |8 ЕП |12 ЕП |24 ЕП |
| **3 реплики** |3 ЕП |6 ЕП |9 ЕП |12 ЕП |18 ЕП |36 ЕП |
| **4 реплики** |4 ЕП |8 ЕП |12 ЕП |16 ЕП |24 ЕП |Недоступно |
| **5 реплик** |5 ЕП |10 ЕП |15 ЕП |20 ЕП |30 ЕП |Недоступно |
| **6 реплик** |6 ЕП |12 ЕП |18 ЕП |24 ЕП |36 ЕП |Недоступно |
| **12 реплик** |12 ЕП |24 ЕП |36 ЕП |Недоступно |Недоступно |Недоступно |

SUs, цены и емкость подробно описываются на веб-сайте Azure hello. Дополнительные сведения см. на [странице с ценами](https://azure.microsoft.com/pricing/details/search/).

> [!NOTE]
> число Hello реплик и секций равномерно делится на 12 (в частности, 1, 2, 3, 4, 6, 12). Это связано с тем, что Поиск Azure предварительно делит каждый индекс на 12 сегментов, которые можно распределить равными частями по разделам. Например если ваша служба имеет три секции, и для создания индекса, каждая секция будет содержать четыре сегментов hello индекса. Описывается способ поиска Azure делит индекс на сегменты является элементом реализации, toochange субъекта в будущих выпусках. Несмотря на то, что номер hello — 12 сегодня, не следует ожидается, что, число tooalways быть будущих 12 hello.
>
>

## <a name="billing-formula-for-replica-and-partition-resources"></a>Формула выставления счетов за ресурсы реплик и секций
Hello формула для вычисления, сколько SUs используются для конкретных комбинаций — совокупность hello реплик и секции, или (R X P = SU). Например, три реплики, умноженные на три секции, оплачиваются как девять единиц поиска.

Стоимость SU определяется уровнем hello, с более низкой скоростью выставления счетов за единицу для Basic, чем для стандартных. Расценки для каждого уровня см. в разделе [Сведения о ценах](https://azure.microsoft.com/pricing/details/search/).
