---
title: "aaaHow tooimplement фасетная Навигация в поиске Azure | Документы Microsoft"
description: "Добавьте tooapplications Фасетная навигация, которые интегрируются с поиском Azure, размещенной облачной службой поиска в Microsoft Azure."
services: search
documentationcenter: 
author: HeidiSteen
manager: mblythe
editor: 
ms.assetid: cdf98fd4-63fd-4b50-b0b0-835cb08ad4d3
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 3/10/2017
ms.author: heidist
ms.openlocfilehash: c1e6bf9dc55d0044525db79e37d35a50ded5a736
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooimplement-faceted-navigation-in-azure-search"></a><span data-ttu-id="66c2a-103">Как tooimplement фасетная Навигация в поиске Azure</span><span class="sxs-lookup"><span data-stu-id="66c2a-103">How tooimplement faceted navigation in Azure Search</span></span>
<span data-ttu-id="66c2a-104">Фасетная навигация представляет собой механизм фильтрации, обеспечивающий самоуправляемую детализированную навигацию в приложениях поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-104">Faceted navigation is a filtering mechanism that provides self-directed drilldown navigation in search applications.</span></span> <span data-ttu-id="66c2a-105">может быть незнакомо Hello термин «фасетная навигация», но вы вероятно использовали ее ранее.</span><span class="sxs-lookup"><span data-stu-id="66c2a-105">hello term 'faceted navigation' may be unfamiliar, but you've probably used it before.</span></span> <span data-ttu-id="66c2a-106">Как hello следующий пример показывает фасетная Навигация — это ничто иное hello категории, используемые toofilter результаты.</span><span class="sxs-lookup"><span data-stu-id="66c2a-106">As hello following example shows, faceted navigation is nothing more than hello categories used toofilter results.</span></span>

 ![Демоверсия портала поиска работы, использующего Поиск Azure][1]

<span data-ttu-id="66c2a-108">Фасетная Навигация является toosearch точки альтернативных запись.</span><span class="sxs-lookup"><span data-stu-id="66c2a-108">Faceted navigation is an alternative entry point toosearch.</span></span> <span data-ttu-id="66c2a-109">Он обеспечивает удобный альтернативный tootyping сложных выражений вручную.</span><span class="sxs-lookup"><span data-stu-id="66c2a-109">It offers a convenient alternative tootyping complex search expressions by hand.</span></span> <span data-ttu-id="66c2a-110">С помощью фасетов вы можете найти нужные данные. Вероятность нулевого результата практически исключена.</span><span class="sxs-lookup"><span data-stu-id="66c2a-110">Facets can help you find what you're looking for, while ensuring that you don’t get zero results.</span></span> <span data-ttu-id="66c2a-111">Как разработчик аспекты позволяют предоставлять hello чаще условия поиска для перемещения по вашей корпуса поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-111">As a developer, facets let you expose hello most useful search criteria for navigating your search corpus.</span></span> <span data-ttu-id="66c2a-112">В интерактивных приложениях для розничного торговли в фасетной навигации часто используются такие категории, как торговые марки, отделы (например, "Детская обувь"), размер, цена, популярность и оценки.</span><span class="sxs-lookup"><span data-stu-id="66c2a-112">In online retail applications, faceted navigation is often built over brands, departments (kid’s shoes), size, price, popularity, and ratings.</span></span> 

<span data-ttu-id="66c2a-113">Способ реализации фасетной навигации зависит от технологии поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-113">Implementing faceted navigation differs across search technologies.</span></span> <span data-ttu-id="66c2a-114">В службе поиска Azure фасетная навигация реализуется при отправке запроса с использованием полей атрибутов, ранее указанных в схеме.</span><span class="sxs-lookup"><span data-stu-id="66c2a-114">In Azure Search, faceted navigation is built at query time, using fields that you previously attributed in your schema.</span></span>

-   <span data-ttu-id="66c2a-115">В запросах hello, при построении приложения, необходимо отправить запрос *параметров запроса аспекта* значения фильтра tooget hello аспекта, доступные для этого документа результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="66c2a-115">In hello queries that your application builds, a query must send *facet query parameters* tooget hello available facet filter values for that document result set.</span></span>

-   <span data-ttu-id="66c2a-116">tooactually усечение hello документа результирующего набора, необходимо также установить приложение hello `$filter` выражение.</span><span class="sxs-lookup"><span data-stu-id="66c2a-116">tooactually trim hello document result set, hello application must also apply a `$filter` expression.</span></span>

<span data-ttu-id="66c2a-117">При разработке приложений написания кода, который создает запросы составляет массового hello hello работы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-117">In your application development, writing code that constructs queries constitutes hello bulk of hello work.</span></span> <span data-ttu-id="66c2a-118">Многие поведения приложения hello, которые можно ожидать от фасетная Навигация предоставляются службой hello, включая встроенную поддержку для определения диапазонов и получение счетчиков для результатах аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-118">Many of hello application behaviors that you would expect from faceted navigation are provided by hello service, including built-in support for defining ranges and getting counts for facet results.</span></span> <span data-ttu-id="66c2a-119">Служба Hello также включает допустимых значений по умолчанию, которые помогают избежать структуры навигации громоздким.</span><span class="sxs-lookup"><span data-stu-id="66c2a-119">hello service also includes sensible defaults that help you avoid unwieldy navigation structures.</span></span> 

## <a name="sample-code-and-demo"></a><span data-ttu-id="66c2a-120">Пример кода и демонстрация</span><span class="sxs-lookup"><span data-stu-id="66c2a-120">Sample code and demo</span></span>
<span data-ttu-id="66c2a-121">В этой статье в качестве примера используется портал поиска работы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-121">This article uses a job search portal as an example.</span></span> <span data-ttu-id="66c2a-122">пример Hello реализуется как приложение ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="66c2a-122">hello example is implemented as an ASP.NET MVC application.</span></span>

-   <span data-ttu-id="66c2a-123">. В разделе и тестирования hello рабочего образца через Интернет в [Демонстрация портала задания поиска Azure](http://azjobsdemo.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="66c2a-123">See and test hello working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="66c2a-124">Загружать код hello из hello [Azure примерами в репозитории на GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="66c2a-124">Download hello code from hello [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

## <a name="get-started"></a><span data-ttu-id="66c2a-125">Начало работы</span><span class="sxs-lookup"><span data-stu-id="66c2a-125">Get started</span></span>
<span data-ttu-id="66c2a-126">Если вы при разработке новых проектов toosearch hello лучшим способом toothink аспекта навигации —, которое содержит возможности hello самостоятельно расширенного поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-126">If you're new toosearch development, hello best way toothink of faceted navigation is that it shows hello possibilities for self-directed search.</span></span> <span data-ttu-id="66c2a-127">Это тип детализированного поиска на основе предопределенных фильтров, который позволяет быстро сузить результаты поиска с помощью интерактивных действий.</span><span class="sxs-lookup"><span data-stu-id="66c2a-127">It’s a type of drill-down search experience, based on predefined filters, used for quickly narrowing down search results through point-and-click actions.</span></span> 

### <a name="interaction-model"></a><span data-ttu-id="66c2a-128">Модель взаимодействия</span><span class="sxs-lookup"><span data-stu-id="66c2a-128">Interaction model</span></span>

<span data-ttu-id="66c2a-129">Давайте начнем с изучения его как последовательность запросов, развертывать в ответные меры toouser итеративный, Hello поисковый интерфейс для фасетная Навигация.</span><span class="sxs-lookup"><span data-stu-id="66c2a-129">hello search experience for faceted navigation is iterative, so let’s start by understanding it as a sequence of queries that unfold in response toouser actions.</span></span>

<span data-ttu-id="66c2a-130">Привет, начальная точка является страницу приложения, который предоставляет фасетная навигация, обычно размещаются на периферии hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-130">hello starting point is an application page that provides faceted navigation, typically placed on hello periphery.</span></span> <span data-ttu-id="66c2a-131">Часто фасетная навигации представляет из себя древовидную структуру с флажками для каждого значения или текстом, который можно щелкнуть.</span><span class="sxs-lookup"><span data-stu-id="66c2a-131">Faceted navigation is often a tree structure, with checkboxes for each value, or clickable text.</span></span> 

1. <span data-ttu-id="66c2a-132">Запрос, отправленный tooAzure поиска определяет структуру фасетная Навигация hello через один или несколько параметров запроса аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-132">A query sent tooAzure Search specifies hello faceted navigation structure via one or more facet query parameters.</span></span> <span data-ttu-id="66c2a-133">Для экземпляра hello запрос может содержать `facet=Rating`, возможно, с `:values` или `:sort` toofurther параметр уточнения hello презентации.</span><span class="sxs-lookup"><span data-stu-id="66c2a-133">For instance, hello query might include `facet=Rating`, perhaps with a `:values` or `:sort` option toofurther refine hello presentation.</span></span>
2. <span data-ttu-id="66c2a-134">уровень представления Hello отображает страницу поиска, которая предоставляет фасетная навигация, с помощью аспектов hello, указанный в запросе hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-134">hello presentation layer renders a search page that provides faceted navigation, using hello facets specified on hello request.</span></span>
3. <span data-ttu-id="66c2a-135">Имея фасетная Навигация структуры, содержащей рейтинг, щелкните tooindicate «4», которое будет отображаться только те продукты, оценка 4 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="66c2a-135">Given a faceted navigation structure that includes Rating, you click "4" tooindicate that only products with a rating of 4 or higher should be shown.</span></span> 
4. <span data-ttu-id="66c2a-136">В результате приложение hello отправляет запрос, включающий`$filter=Rating ge 4`</span><span class="sxs-lookup"><span data-stu-id="66c2a-136">In response, hello application sends a query that includes `$filter=Rating ge 4`</span></span> 
5. <span data-ttu-id="66c2a-137">Hello презентации слоя hello страницы обновления отображение сокращенный результирующий набор, содержащий только те элементы, удовлетворяющие критериям новый hello (в этом случае продуктов рейтингом 4 и выше).</span><span class="sxs-lookup"><span data-stu-id="66c2a-137">hello presentation layer updates hello page, showing a reduced result set, containing just those items that satisfy hello new criteria (in this case, products rated 4 and up).</span></span>

<span data-ttu-id="66c2a-138">Фасет — это параметр запроса. Однако его не следует путать с входными данными запроса.</span><span class="sxs-lookup"><span data-stu-id="66c2a-138">A facet is a query parameter, but do not confuse it with query input.</span></span> <span data-ttu-id="66c2a-139">Он никогда не используется в качестве критериев выбора в запросе.</span><span class="sxs-lookup"><span data-stu-id="66c2a-139">It is never used as selection criteria in a query.</span></span> <span data-ttu-id="66c2a-140">Вместо этого считаете параметры запроса аспекта структуру навигации toohello входных данных, который возвращается в ответе hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-140">Instead, think of facet query parameters as inputs toohello navigation structure that comes back in hello response.</span></span> <span data-ttu-id="66c2a-141">Для каждого параметра запроса аспекта, предоставленные вами поиска Azure оценивает, сколько документов в hello частичные результаты для каждого значения аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-141">For each facet query parameter you provide, Azure Search evaluates how many documents are in hello partial results for each facet value.</span></span>

<span data-ttu-id="66c2a-142">Обратите внимание hello `$filter` на шаге 4.</span><span class="sxs-lookup"><span data-stu-id="66c2a-142">Notice hello `$filter` in step 4.</span></span> <span data-ttu-id="66c2a-143">Фильтр Hello является важным аспектом фасетная Навигация.</span><span class="sxs-lookup"><span data-stu-id="66c2a-143">hello filter is an important aspect of faceted navigation.</span></span> <span data-ttu-id="66c2a-144">Несмотря на то, что в hello API независимы аспекты и фильтры, необходимо взаимодействие hello обоих toodeliver, которую вы намерены.</span><span class="sxs-lookup"><span data-stu-id="66c2a-144">Although facets and filters are independent in hello API, you need both toodeliver hello experience you intend.</span></span> 

### <a name="app-design-pattern"></a><span data-ttu-id="66c2a-145">Конструктивный шаблон приложения</span><span class="sxs-lookup"><span data-stu-id="66c2a-145">App design pattern</span></span>

<span data-ttu-id="66c2a-146">В коде приложения hello шаблон — toouse аспекта запроса параметров tooreturn hello фасетная Навигация структура вместе с аспекта результаты, а также выражения $filter.</span><span class="sxs-lookup"><span data-stu-id="66c2a-146">In application code, hello pattern is toouse facet query parameters tooreturn hello faceted navigation structure along with facet results, plus a $filter expression.</span></span>  <span data-ttu-id="66c2a-147">hello дескрипторы выражение фильтра Hello щелкните событие на значение аспекта hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-147">hello filter expression handles hello click event on hello facet value.</span></span> <span data-ttu-id="66c2a-148">Представьте hello `$filter` выражение в качестве кода hello фактическое усечения hello результаты поиска возвращаются toohello уровня представления.</span><span class="sxs-lookup"><span data-stu-id="66c2a-148">Think of hello `$filter` expression as hello code behind hello actual trimming of search results returned toohello presentation layer.</span></span> <span data-ttu-id="66c2a-149">Имея аспекта цветов, щелкните красный цвет hello реализуется с помощью `$filter` выражение, которое выбирает только те элементы, которые имеют красный цвет.</span><span class="sxs-lookup"><span data-stu-id="66c2a-149">Given a Colors facet, clicking hello color Red is implemented through a `$filter` expression that selects only those items that have a color of red.</span></span> 

### <a name="query-basics"></a><span data-ttu-id="66c2a-150">Основы запросов</span><span class="sxs-lookup"><span data-stu-id="66c2a-150">Query basics</span></span>

<span data-ttu-id="66c2a-151">В службе поиска Azure запрос указывается с помощью одного или нескольких параметров запроса (описание каждого из них приведено в [статье, посвященной поиску документов](http://msdn.microsoft.com/library/azure/dn798927.aspx) ).</span><span class="sxs-lookup"><span data-stu-id="66c2a-151">In Azure Search, a request is specified through one or more query parameters (see [Search Documents](http://msdn.microsoft.com/library/azure/dn798927.aspx) for a description of each one).</span></span> <span data-ttu-id="66c2a-152">Ни один из параметров запроса hello являются обязательными, но необходимо иметь по крайней мере один в порядке для запроса toobe допустимым.</span><span class="sxs-lookup"><span data-stu-id="66c2a-152">None of hello query parameters are required, but you must have at least one in order for a query toobe valid.</span></span>

<span data-ttu-id="66c2a-153">Точность, распознанное при hello toofilter возможность ожидания играет попаданий достигается с помощью одного или обоих этих выражений:</span><span class="sxs-lookup"><span data-stu-id="66c2a-153">Precision, understood as hello ability toofilter out irrelevant hits, is achieved through one or both of these expressions:</span></span>

-   <span data-ttu-id="66c2a-154">**search=**</span><span class="sxs-lookup"><span data-stu-id="66c2a-154">**search=**</span></span>  
    <span data-ttu-id="66c2a-155">значение этого параметра Hello составляет выражение поиска hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-155">hello value of this parameter constitutes hello search expression.</span></span> <span data-ttu-id="66c2a-156">Это может быть текстовый фрагмент или сложное выражение поиска, которое включает в себя несколько условий и операторов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-156">It might be a single piece of text, or a complex search expression that includes multiple terms and operators.</span></span> <span data-ttu-id="66c2a-157">На сервере hello искомое выражение используется для полнотекстового поиска, запрос для поиска полей в индексе hello для сопоставления условий, возврат результатов по шкале.</span><span class="sxs-lookup"><span data-stu-id="66c2a-157">On hello server, a search expression is used for full-text search, querying searchable fields in hello index for matching terms, returning results in rank order.</span></span> <span data-ttu-id="66c2a-158">Если задать `search` toonull, выполнение запроса не по всему индексу hello (то есть, `search=*`).</span><span class="sxs-lookup"><span data-stu-id="66c2a-158">If you set `search` toonull, query execution is over hello entire index (that is, `search=*`).</span></span> <span data-ttu-id="66c2a-159">In this Case, запросить hello другие элементы, такие как `$filter` или профиль оценки, hello основной факторы, влияющие на документов, которые возвращаются `($filter`) и в каком порядке (`scoringProfile` или `$orderby`).</span><span class="sxs-lookup"><span data-stu-id="66c2a-159">In this case, other elements of hello query, such as a `$filter` or scoring profile, are hello primary factors affecting which documents are returned `($filter`) and in what order (`scoringProfile` or `$orderby`).</span></span>

-   <span data-ttu-id="66c2a-160">**$filter=**</span><span class="sxs-lookup"><span data-stu-id="66c2a-160">**$filter=**</span></span>  
    <span data-ttu-id="66c2a-161">Фильтр очень мощный механизм для ограничения размера hello результатов поиска на основе значений hello атрибутов определенного документа.</span><span class="sxs-lookup"><span data-stu-id="66c2a-161">A filter is a powerful mechanism for limiting hello size of search results based on hello values of specific document attributes.</span></span> <span data-ttu-id="66c2a-162">Объект `$filter` вычисляется в первую очередь, следуют аспекты логику, которая приводит к возникновению ошибки hello доступных значений, а также соответствующие счетчики для каждого значения</span><span class="sxs-lookup"><span data-stu-id="66c2a-162">A `$filter` is evaluated first, followed by faceting logic that generates hello available values and corresponding counts for each value</span></span>

<span data-ttu-id="66c2a-163">Выражения поиска в сложных снижают производительность hello hello запроса.</span><span class="sxs-lookup"><span data-stu-id="66c2a-163">Complex search expressions decrease hello performance of hello query.</span></span> <span data-ttu-id="66c2a-164">Там, где это возможно, используется точность tooincrease хорошо сконструированный фильтра выражений и повысить производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-164">Where possible, use well-constructed filter expressions tooincrease precision and improve query performance.</span></span>

<span data-ttu-id="66c2a-165">toobetter понять, как фильтр добавляет большую точность, сравните tooone выражение сложного поиска, которая включает выражение фильтра:</span><span class="sxs-lookup"><span data-stu-id="66c2a-165">toobetter understand how a filter adds more precision, compare a complex search expression tooone that includes a filter expression:</span></span>

-   `GET /indexes/hotel/docs?search=lodging budget +Seattle –motel +parking`
-   `GET /indexes/hotel/docs?search=lodging&$filter=City eq ‘Seattle’ and Parking and Type ne ‘motel’`

<span data-ttu-id="66c2a-166">Оба запроса являются допустимыми, но hello второй является предпочтительной, если вы ищете не ловушкам с парковки в Сиэтле.</span><span class="sxs-lookup"><span data-stu-id="66c2a-166">Both queries are valid, but hello second is superior if you’re looking for non-motels with parking in Seattle.</span></span>
-   <span data-ttu-id="66c2a-167">первый запрос Hello зависит от этих слов, упомянутые или не упоминается в поля строки, такие как имя, описание и другие поля, содержащего данные с возможностью поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-167">hello first query relies on those specific words being mentioned or not mentioned in string fields like Name, Description, and any other field containing searchable data.</span></span>
-   <span data-ttu-id="66c2a-168">второй запрос Hello осуществляется более точны, скорее всего, toobe и точного совпадения в структурированных данных.</span><span class="sxs-lookup"><span data-stu-id="66c2a-168">hello second query looks for precise matches on structured data and is likely toobe much more accurate.</span></span>

<span data-ttu-id="66c2a-169">В приложениях, содержащих фасетную навигацию, необходимо убедиться, что все действия, которые выполняет пользователь со структурой фасетной навигации, сопровождаются сужением результатов поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-169">In applications that include faceted navigation, make sure that each user action over a faceted navigation structure is accompanied by a narrowing of search results.</span></span> <span data-ttu-id="66c2a-170">toonarrow результаты, используйте выражение фильтра.</span><span class="sxs-lookup"><span data-stu-id="66c2a-170">toonarrow results, use a filter expression.</span></span>

<a name="howtobuildit"></a>

## <a name="build-a-faceted-navigation-app"></a><span data-ttu-id="66c2a-171">Создание приложения с фасетной навигацией</span><span class="sxs-lookup"><span data-stu-id="66c2a-171">Build a faceted navigation app</span></span>
<span data-ttu-id="66c2a-172">Фасетная Навигация с поиском Azure реализовать в коде приложения, создающий hello поискового запроса.</span><span class="sxs-lookup"><span data-stu-id="66c2a-172">You implement faceted navigation with Azure Search in your application code that builds hello search request.</span></span> <span data-ttu-id="66c2a-173">фасетная Навигация Hello использует элементы в схеме, которое было определено ранее.</span><span class="sxs-lookup"><span data-stu-id="66c2a-173">hello faceted navigation relies on elements in your schema that you defined previously.</span></span>

<span data-ttu-id="66c2a-174">Предопределенные в индексе поиска — hello `Facetable [true|false]` атрибут index, установить на выбранных полей tooenable или отключить их использование в структуре фасетная Навигация.</span><span class="sxs-lookup"><span data-stu-id="66c2a-174">Predefined in your search index is hello `Facetable [true|false]` index attribute, set on selected fields tooenable or disable their use in a faceted navigation structure.</span></span> <span data-ttu-id="66c2a-175">Если поле не содержит атрибута `"Facetable" = true`, его невозможно использовать в фасетной навигации.</span><span class="sxs-lookup"><span data-stu-id="66c2a-175">Without `"Facetable" = true`, a field cannot be used in facet navigation.</span></span>

<span data-ttu-id="66c2a-176">уровень представления Hello в коде обеспечивает взаимодействие с пользователем hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-176">hello presentation layer in your code provides hello user experience.</span></span> <span data-ttu-id="66c2a-177">Он должен содержать hello составные части фасетная Навигация hello, такие как метки hello, значения, флажки и число hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-177">It should list hello constituent parts of hello faceted navigation, such as hello label, values, check boxes, and hello count.</span></span> <span data-ttu-id="66c2a-178">Hello REST API поиска Azure не зависит от платформы, поэтому следует использовать язык и требуется платформа.</span><span class="sxs-lookup"><span data-stu-id="66c2a-178">hello Azure Search REST API is platform agnostic, so use whatever language and platform you want.</span></span> <span data-ttu-id="66c2a-179">Hello важно tooinclude элементы пользовательского интерфейса, поддерживающих добавочные обновления, с обновленное состояние пользовательского интерфейса как выбрать каждый дополнительный аспект.</span><span class="sxs-lookup"><span data-stu-id="66c2a-179">hello important thing is tooinclude UI elements that support incremental refresh, with updated UI state as each additional facet is selected.</span></span> 

<span data-ttu-id="66c2a-180">Во время запроса, код приложения создает запрос, содержащий `facet=[string]`, параметр запроса, который предоставляет hello toofacet поле по.</span><span class="sxs-lookup"><span data-stu-id="66c2a-180">At query time, your application code creates a request that includes `facet=[string]`, a request parameter that provides hello field toofacet by.</span></span> <span data-ttu-id="66c2a-181">Запрос может содержать несколько фасетов, таких как `&facet=color&facet=category&facet=rating`, которые разделяются символов "амперсанд" (&).</span><span class="sxs-lookup"><span data-stu-id="66c2a-181">A query can have multiple facets, such as `&facet=color&facet=category&facet=rating`, each one separated by an ampersand (&) character.</span></span>

<span data-ttu-id="66c2a-182">Код приложения необходимо также создать `$filter` hello toohandle выражение события щелчка в фасетная Навигация.</span><span class="sxs-lookup"><span data-stu-id="66c2a-182">Application code must also construct a `$filter` expression toohandle hello click events in faceted navigation.</span></span> <span data-ttu-id="66c2a-183">Объект `$filter` сокращает количество результатов поиска hello, используя значение аспекта hello в качестве критерия фильтра.</span><span class="sxs-lookup"><span data-stu-id="66c2a-183">A `$filter` reduces hello search results, using hello facet value as filter criteria.</span></span>

<span data-ttu-id="66c2a-184">Поиск Azure возвращает результаты поиска hello, на основе одного или нескольких условий, введите, вместе со структурой фасетная Навигация toohello обновлений.</span><span class="sxs-lookup"><span data-stu-id="66c2a-184">Azure Search returns hello search results, based on one or more terms that you enter, along with updates toohello faceted navigation structure.</span></span> <span data-ttu-id="66c2a-185">В службе поиска Azure фасетная навигация представляет из себя одноуровневую структуру со значениями фасетов и количеством результаты, найденных для каждого из них.</span><span class="sxs-lookup"><span data-stu-id="66c2a-185">In Azure Search, faceted navigation is a single-level construction, with facet values, and counts of how many results are found for each one.</span></span>

<span data-ttu-id="66c2a-186">В следующих разделах hello, мы рассмотрим ближе как toobuild каждой части.</span><span class="sxs-lookup"><span data-stu-id="66c2a-186">In hello following sections, we take a closer look at how toobuild each part.</span></span>

<a name="buildindex"></a>

## <a name="build-hello-index"></a><span data-ttu-id="66c2a-187">Создание индекса hello</span><span class="sxs-lookup"><span data-stu-id="66c2a-187">Build hello index</span></span>
<span data-ttu-id="66c2a-188">Аспекты включена для каждого поля, с hello индекс, с помощью этого атрибута индекса: `"Facetable": true`.</span><span class="sxs-lookup"><span data-stu-id="66c2a-188">Faceting is enabled on a field-by-field basis in hello index, via this index attribute: `"Facetable": true`.</span></span>  
<span data-ttu-id="66c2a-189">Для всех типов полей, которые можно использовать в фасетной навигации, по умолчанию устанавливается значение `Facetable` .</span><span class="sxs-lookup"><span data-stu-id="66c2a-189">All field types that could possibly be used in faceted navigation are `Facetable` by default.</span></span> <span data-ttu-id="66c2a-190">Такие типы полей включают `Edm.String`, `Edm.DateTimeOffset`, и все hello числовых типов полей (по существу, все типы полей, facetable за исключением `Edm.GeographyPoint`, который не может использоваться в фасетная Навигация).</span><span class="sxs-lookup"><span data-stu-id="66c2a-190">Such field types include `Edm.String`, `Edm.DateTimeOffset`, and all hello numeric field types (essentially, all field types are facetable except `Edm.GeographyPoint`, which can’t be used in faceted navigation).</span></span> 

<span data-ttu-id="66c2a-191">При построении индекса, рекомендуется для фасетная Навигация отключено аспекты Включение tooexplicitly для полей, которые не должны использоваться в качестве аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-191">When building an index, a best practice for faceted navigation is tooexplicitly turn faceting off for fields that should never be used as a facet.</span></span>  <span data-ttu-id="66c2a-192">В частности, строка поля для одинарных значений, такие как имя идентификатора или продукта, задавайте слишком`"Facetable": false` tooprevent их случайного (и неэффективными) использование в фасетная Навигация.</span><span class="sxs-lookup"><span data-stu-id="66c2a-192">In particular, string fields for singleton values, such as an ID or product name, should be set too`"Facetable": false` tooprevent their accidental (and ineffective) use in faceted navigation.</span></span> <span data-ttu-id="66c2a-193">Включение аспекты off, где он не нужен помогает поддерживать небольшой размер hello индекса hello и обычно повышает производительность.</span><span class="sxs-lookup"><span data-stu-id="66c2a-193">Turning faceting off where you don’t need it helps keep hello size of hello index small, and typically improves performance.</span></span>

<span data-ttu-id="66c2a-194">Следующее является частью схемы hello для hello задания портала нашего примера образец приложения обрезаются размер hello tooreduce некоторые атрибуты:</span><span class="sxs-lookup"><span data-stu-id="66c2a-194">Following is part of hello schema for hello Job Portal Demo sample app, trimmed of some attributes tooreduce hello size:</span></span>

```json
{
  ...
  "name": "nycjobs",
  "fields": [
    { “name”: "id",                 "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "job_id",             "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "agency",              "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "posting_type",        "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "num_of_positions",    "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "business_title",      "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "civil_service_title", "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "title_code_no",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "level",               "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_from",   "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_to",     "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_frequency",    "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "work_location",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
…
    { “name”: "geo_location",        "type": "Edm.GeographyPoint",     "searchable": false, "filterable": true, ...  "facetable": false, ... },
    { “name”: "tags",                "type": "Collection(Edm.String)", "searchable": true,  "filterable": true, ...  "facetable": true, ...  }
  ],
…
}
```

<span data-ttu-id="66c2a-195">Как видно в схеме образец hello `Facetable` отключена для строковых полей, которые не следует использовать в качестве аспектов, таких как значения Идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-195">As you can see in hello sample schema, `Facetable` is turned off for string fields that shouldn’t be used as facets, such as ID values.</span></span> <span data-ttu-id="66c2a-196">Включение аспекты off, где он не нужен помогает поддерживать небольшой размер hello индекса hello и обычно повышает производительность.</span><span class="sxs-lookup"><span data-stu-id="66c2a-196">Turning faceting off where you don’t need it helps keep hello size of hello index small, and typically improves performance.</span></span>

> [!TIP]
> <span data-ttu-id="66c2a-197">Рекомендуется включите hello полный набор атрибутов индекса для каждого поля.</span><span class="sxs-lookup"><span data-stu-id="66c2a-197">As a best practice, include hello full set of index attributes for each field.</span></span> <span data-ttu-id="66c2a-198">Несмотря на то что `Facetable` включен по умолчанию для почти всех полей, специально задание каждый атрибут может помочь при через hello последствия каждого решения схемы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-198">Although `Facetable` is on by default for almost all fields, purposely setting each attribute can help you think through hello implications of each schema decision.</span></span> 

<a name="checkdata"></a>

## <a name="check-hello-data"></a><span data-ttu-id="66c2a-199">Проверка данных hello</span><span class="sxs-lookup"><span data-stu-id="66c2a-199">Check hello data</span></span>
<span data-ttu-id="66c2a-200">Hello качества данных имеет прямое влияние на ли структура фасетная Навигация hello материализует как ожидается.</span><span class="sxs-lookup"><span data-stu-id="66c2a-200">hello quality of your data has a direct effect on whether hello faceted navigation structure materializes as you expect it to.</span></span> <span data-ttu-id="66c2a-201">Он также влияет на hello Простота создания фильтров tooreduce hello результирующий набор.</span><span class="sxs-lookup"><span data-stu-id="66c2a-201">It also affects hello ease of constructing filters tooreduce hello result set.</span></span>

<span data-ttu-id="66c2a-202">Если требуется, чтобы toofacet фирменной символики или цены, каждый документ должен содержать значения для *название фирмы-производителя* и *ProductPrice* , допустимый согласованность и производительность как параметр фильтра.</span><span class="sxs-lookup"><span data-stu-id="66c2a-202">If you want toofacet by Brand or Price, each document should contain values for *BrandName* and *ProductPrice* that are valid, consistent, and productive as a filter option.</span></span>

<span data-ttu-id="66c2a-203">Ниже приведены несколько напоминаний какие tooscrub для:</span><span class="sxs-lookup"><span data-stu-id="66c2a-203">Here are a few reminders of what tooscrub for:</span></span>

* <span data-ttu-id="66c2a-204">Для каждого поля, которое требуется toofacet по спросите себя, содержит ли он может использоваться как фильтры значений в собственной расширенного поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-204">For every field that you want toofacet by, ask yourself whether it contains values that are suitable as filters in self-directed search.</span></span> <span data-ttu-id="66c2a-205">Hello значения должны быть короткие, описательные и достаточно различение toooffer Выбор между конкурирующих параметры.</span><span class="sxs-lookup"><span data-stu-id="66c2a-205">hello values should be short, descriptive, and sufficiently distinctive toooffer a clear choice between competing options.</span></span>
* <span data-ttu-id="66c2a-206">Опечатки или близкие значения.</span><span class="sxs-lookup"><span data-stu-id="66c2a-206">Misspellings or nearly matching values.</span></span> <span data-ttu-id="66c2a-207">Если аспекта на цвет и значениях полей включают оранжевый и Ornage (ошибке): как будет взять аспект, на основе поля цвет hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-207">If you facet on Color, and field values include Orange and Ornage (a misspelling), a facet based on hello Color field would pick up both.</span></span>
* <span data-ttu-id="66c2a-208">Использование текста, написанного прописными и строчными буквами, также может негативно отразиться на фасетной навигации, так как элементы orange и Orange будут считаться двумя разными значениями.</span><span class="sxs-lookup"><span data-stu-id="66c2a-208">Mixed case text can also wreak havoc in faceted navigation, with orange and Orange appearing as two different values.</span></span> 
* <span data-ttu-id="66c2a-209">Одно- и во множественном числе версии приветствия одинаковое значение может привести к отдельной аспекта для каждого.</span><span class="sxs-lookup"><span data-stu-id="66c2a-209">Single and plural versions of hello same value can result in a separate facet for each.</span></span>

<span data-ttu-id="66c2a-210">Как можно себе представить, экспертизы при подготовке данных hello является важным аспектом действующие фасетная Навигация.</span><span class="sxs-lookup"><span data-stu-id="66c2a-210">As you can imagine, diligence in preparing hello data is an essential aspect of effective faceted navigation.</span></span>

<a name="presentationlayer"></a>

## <a name="build-hello-ui"></a><span data-ttu-id="66c2a-211">Построение hello пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="66c2a-211">Build hello UI</span></span>
<span data-ttu-id="66c2a-212">Работа с уровнем представления hello можно выявить требования, в противном случае могут быть пропущены и понять, какие возможности будут essential toohello справки функции поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-212">Working back from hello presentation layer can help you uncover requirements that might be missed otherwise, and understand which capabilities are essential toohello search experience.</span></span>

<span data-ttu-id="66c2a-213">С точки зрения фасетная Навигация на страницу веб- или приложения отображает структуру фасетная Навигация hello, обнаруживает ввод данных пользователем на странице приветствия и вставляет элементы изменены hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-213">In terms of faceted navigation, your web or application page displays hello faceted navigation structure, detects user input on hello page, and inserts hello changed elements.</span></span> 

<span data-ttu-id="66c2a-214">Для веб-приложений AJAX обычно используется в слой представления hello так как она допускает toorefresh добавочные изменения.</span><span class="sxs-lookup"><span data-stu-id="66c2a-214">For web applications, AJAX is commonly used in hello presentation layer because it allows you toorefresh incremental changes.</span></span> <span data-ttu-id="66c2a-215">Можно также использовать ASP.NET MVC или любой другой платформы визуализации, можно подключиться tooan службы поиска Azure по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="66c2a-215">You could also use ASP.NET MVC or any other visualization platform that can connect tooan Azure Search service over HTTP.</span></span> <span data-ttu-id="66c2a-216">Пример приложения Hello ссылки в этой статье--hello **Демонстрация портала задания поиска Azure** — происходит toobe приложения ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="66c2a-216">hello sample application referenced throughout this article -- hello **Azure Search Job Portal Demo** – happens toobe an ASP.NET MVC application.</span></span>

<span data-ttu-id="66c2a-217">В образце hello фасетная Навигация встроено в hello страницы результатов поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-217">In hello sample, faceted navigation is built into hello search results page.</span></span> <span data-ttu-id="66c2a-218">Следующий пример, взяты из hello Hello `index.cshtml` файла образца приложения hello, структура hello статических показано HTML для отображения фасетная Навигация hello поиск на страницы результатов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-218">hello following example, taken from hello `index.cshtml` file of hello sample application, shows hello static HTML structure for displaying faceted navigation on hello search results page.</span></span> <span data-ttu-id="66c2a-219">Список Hello аспектов строятся или перестраиваются динамически, после отправки условия поиска, или установите или снимите аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-219">hello list of facets is built or rebuilt dynamically when you submit a search term, or select or clear a facet.</span></span>

```html
<div class="widget sidebar-widget jobs-filter-widget">
  <h5 class="widget-title">Filter Results</h5>
    <p id="filterReset"></p>
    <div class="widget-content">

      <h6 id="businessTitleFacetTitle">Business Title</h6>
      <ul class="filter-list" id="business_title_facets">
      </ul>

      <h6>Location</h6>
      <ul class="filter-list" id="posting_type_facets">
      </ul>

      <h6>Posting Type</h6>
      <ul class="filter-list" id="posting_type_facets"></ul>

      <h6>Minimum Salary</h6>
      <ul class="filter-list" id="salary_range_facets">
      </ul>

  </div>
</div>
```

<span data-ttu-id="66c2a-220">Здравствуйте, следующий фрагмент кода hello `index.cshtml` страницы динамически создает hello HTML toodisplay hello первый аспекта, название организации.</span><span class="sxs-lookup"><span data-stu-id="66c2a-220">hello following code snippet from hello `index.cshtml` page dynamically builds hello HTML toodisplay hello first facet, Business Title.</span></span> <span data-ttu-id="66c2a-221">Другие аспекты hello HTML для hello динамически создавать аналогичные функции.</span><span class="sxs-lookup"><span data-stu-id="66c2a-221">Similar functions dynamically build hello HTML for hello other facets.</span></span> <span data-ttu-id="66c2a-222">Каждый аспект имеет метку и счетчика, отображающий hello число элементов, найденных для этого аспекта результата.</span><span class="sxs-lookup"><span data-stu-id="66c2a-222">Each facet has a label and a count, which displays hello number of items found for that facet result.</span></span>

```js
function UpdateBusinessTitleFacets(data) {
  var facetResultsHTML = '';
  for (var i = 0; i < data.length; i++) {
    facetResultsHTML += '<li><a href="javascript:void(0)" onclick="ChooseBusinessTitleFacet(\'' + data[i].Value + '\');">' + data[i].Value + ' (' + data[i].Count + ')</span></a></li>';
  }

  $("#business_title_facets").html(facetResultsHTML);
}
```

> [!TIP]
> <span data-ttu-id="66c2a-223">При проектировании страницы результатов поиска hello помните tooadd механизм очистки аспектов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-223">When you design hello search results page, remember tooadd a mechanism for clearing facets.</span></span> <span data-ttu-id="66c2a-224">При добавлении флажки, можно легко увидеть, как фильтры tooclear hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-224">If you add check boxes, you can easily see how tooclear hello filters.</span></span> <span data-ttu-id="66c2a-225">Для других структур может понадобиться шаблон навигации или другой нестандартный элемент.</span><span class="sxs-lookup"><span data-stu-id="66c2a-225">For other layouts, you might need a breadcrumb pattern or another creative approach.</span></span> <span data-ttu-id="66c2a-226">Например, в hello портала поиска заданий образец приложения, можно щелкнуть hello `[X]` после аспект hello tooclear выбранного аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-226">For example, in hello Job Search Portal sample application, you can click hello `[X]` after a selected facet tooclear hello facet.</span></span>

<a name="buildquery"></a>

## <a name="build-hello-query"></a><span data-ttu-id="66c2a-227">Построить запрос hello</span><span class="sxs-lookup"><span data-stu-id="66c2a-227">Build hello query</span></span>
<span data-ttu-id="66c2a-228">Hello код, написанный для построения запросов должен указывать, что все части допустимый запрос, включая выражения поиска, аспекты, фильтры, оценки профили — что-либо использовать tooformulate запрос.</span><span class="sxs-lookup"><span data-stu-id="66c2a-228">hello code that you write for building queries should specify all parts of a valid query, including search expressions, facets, filters, scoring profiles– anything used tooformulate a request.</span></span> <span data-ttu-id="66c2a-229">В этом разделе мы расскажем, где аспекты помещаются в запрос и использование фильтров с toodeliver аспекты понижение результирующего набора.</span><span class="sxs-lookup"><span data-stu-id="66c2a-229">In this section, we explore where facets fit into a query, and how filters are used with facets toodeliver a reduced result set.</span></span>

<span data-ttu-id="66c2a-230">Обратите внимание, что фасеты являются неотъемлемой частью этого примера приложения.</span><span class="sxs-lookup"><span data-stu-id="66c2a-230">Notice that facets are integral in this sample application.</span></span> <span data-ttu-id="66c2a-231">возможности поиска Hello в hello Демонстрация портала задания построена фасетная навигация и фильтры.</span><span class="sxs-lookup"><span data-stu-id="66c2a-231">hello search experience in hello Job Portal Demo is designed around faceted navigation and filters.</span></span> <span data-ttu-id="66c2a-232">Hello Показательным размещение фасетная Навигация на странице приветствия демонстрирует его значимость.</span><span class="sxs-lookup"><span data-stu-id="66c2a-232">hello prominent placement of faceted navigation on hello page demonstrates its importance.</span></span> 

<span data-ttu-id="66c2a-233">Например, часто toobegin лучше всего.</span><span class="sxs-lookup"><span data-stu-id="66c2a-233">An example is often a good place toobegin.</span></span> <span data-ttu-id="66c2a-234">Следующий пример, взяты из hello Hello `JobsSearch.cs` файл построений, в запросе, создающем навигации аспекта, основываясь на название организации, расположение, тип учета и минимум заработной платы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-234">hello following example, taken from hello `JobsSearch.cs` file, builds a request that creates facet navigation based on Business Title, Location, Posting Type, and Minimum Salary.</span></span> 

```cs
SearchParameters sp = new SearchParameters()
{
  ...
  // Add facets
  Facets = new List<String>() { "business_title", "posting_type", "level", "salary_range_from,interval:50000" },
};
```

<span data-ttu-id="66c2a-235">Аспект параметра запроса устанавливается tooa поле и в зависимости от типа данных hello, параметризации могут использоваться дополнительные разделенный запятыми список, включающий `count:<integer>`, `sort:<>`, `interval:<integer>`, и `values:<list>`.</span><span class="sxs-lookup"><span data-stu-id="66c2a-235">A facet query parameter is set tooa field and depending on hello data type, can be further parameterized by comma-delimited list that includes `count:<integer>`, `sort:<>`, `interval:<integer>`, and `values:<list>`.</span></span> <span data-ttu-id="66c2a-236">Список значений, создаваемый при настройке диапазонов, поддерживает числовые данные.</span><span class="sxs-lookup"><span data-stu-id="66c2a-236">A values list is supported for numeric data when setting up ranges.</span></span> <span data-ttu-id="66c2a-237">Дополнительные сведения об использовании см. в статье [Поиск документов (API REST службы поиска Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span><span class="sxs-lookup"><span data-stu-id="66c2a-237">See [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx) for usage details.</span></span>

<span data-ttu-id="66c2a-238">Вместе с аспектами hello запрос создан для приложения также должны использовать фильтры toonarrow вниз hello набор документов-кандидатов на основе выделения значение аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-238">Along with facets, hello request formulated by your application should also build filters toonarrow down hello set of candidate documents based on a facet value selection.</span></span> <span data-ttu-id="66c2a-239">Магазина велосипедов, фасетная Навигация доступны, такие как подсказки tooquestions *какие цвета, производители и типов велосипедов доступны?*.</span><span class="sxs-lookup"><span data-stu-id="66c2a-239">For a bike store, faceted navigation provides clues tooquestions like *What colors, manufacturers, and types of bikes are available?*.</span></span> <span data-ttu-id="66c2a-240">Используя фильтрацию, вы можете найти, к примеру, *горные велосипеды красного цвета в указанном ценовом диапазоне*.</span><span class="sxs-lookup"><span data-stu-id="66c2a-240">Filtering answers questions like *Which exact bikes are red, mountain bikes, in this price range?*.</span></span> <span data-ttu-id="66c2a-241">При нажатии кнопки tooindicate «Red», которое будет отображаться только продукты красного, отправляет hello Далее приложения hello запроса включает `$filter=Color eq ‘Red’`.</span><span class="sxs-lookup"><span data-stu-id="66c2a-241">When you click "Red" tooindicate that only Red products should be shown, hello next query hello application sends includes `$filter=Color eq ‘Red’`.</span></span>

<span data-ttu-id="66c2a-242">Здравствуйте, следующий фрагмент кода hello `JobsSearch.cs` страницы добавляется фильтр toohello hello выбран название организации, если выбрать значение аспекта hello название организации.</span><span class="sxs-lookup"><span data-stu-id="66c2a-242">hello following code snippet from hello `JobsSearch.cs` page adds hello selected Business Title toohello filter if you select a value from hello Business Title facet.</span></span>

```cs
if (businessTitleFacet != "")
  filter = "business_title eq '" + businessTitleFacet + "'";
```

<a name="tips"></a> 

## <a name="tips-and-best-practices"></a><span data-ttu-id="66c2a-243">Советы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="66c2a-243">Tips and best practices</span></span>

### <a name="indexing-tips"></a><span data-ttu-id="66c2a-244">Советы по индексированию</span><span class="sxs-lookup"><span data-stu-id="66c2a-244">Indexing tips</span></span>
<span data-ttu-id="66c2a-245">**Повышение эффективности индекса, если не используется поле поиска**</span><span class="sxs-lookup"><span data-stu-id="66c2a-245">**Improve index efficiency if you don't use a Search box**</span></span>

<span data-ttu-id="66c2a-246">Если приложение использует фасетная Навигация в монопольном режиме (то есть не поле поиска), можно пометить поле hello как `searchable=false`, `facetable=true` tooproduce более компактным индекса.</span><span class="sxs-lookup"><span data-stu-id="66c2a-246">If your application uses faceted navigation exclusively (that is, no search box), you can mark hello field as `searchable=false`, `facetable=true` tooproduce a more compact index.</span></span> <span data-ttu-id="66c2a-247">Кроме того индексирование выполняется только на весь аспекта значений, в которых нет разбиения или индексирования hello составных частей значения нескольких слов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-247">In addition, indexing occurs only on whole facet values, with no word-break or indexing of hello component parts of a multi-word value.</span></span>

<span data-ttu-id="66c2a-248">**Определение полей, которые можно использовать в качестве аспектов**</span><span class="sxs-lookup"><span data-stu-id="66c2a-248">**Specify which fields can be used as facets**</span></span>

<span data-ttu-id="66c2a-249">Помните, что hello схемы индекса hello определяет поля, доступные toouse как аспект.</span><span class="sxs-lookup"><span data-stu-id="66c2a-249">Recall that hello schema of hello index determines which fields are available toouse as a facet.</span></span> <span data-ttu-id="66c2a-250">Предположим, что поле является facetable, запрос hello указывает toofacet какие поля по.</span><span class="sxs-lookup"><span data-stu-id="66c2a-250">Assuming a field is facetable, hello query specifies which fields toofacet by.</span></span> <span data-ttu-id="66c2a-251">поле Hello, с помощью которого вы являетесь аспекты включает hello значений, которые отображаются под названием hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-251">hello field by which you are faceting provides hello values that appear below hello label.</span></span> 

<span data-ttu-id="66c2a-252">Hello значения, которые отображаются в каждой метке извлекаются из индекса hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-252">hello values that appear under each label are retrieved from hello index.</span></span> <span data-ttu-id="66c2a-253">Например, если hello поле аспект является *цвет*, возможные значения hello дополнительной фильтрации: hello значений для этого поля - красный, черный и т. д.</span><span class="sxs-lookup"><span data-stu-id="66c2a-253">For example, if hello facet field is *Color*, hello values available for additional filtering are hello values for that field - Red, Black, and so forth.</span></span>

<span data-ttu-id="66c2a-254">Для числовых и DateTime только значения, можно явно задать значения в поле аспекта hello (например, `facet=Rating,values:1|2|3|4|5`).</span><span class="sxs-lookup"><span data-stu-id="66c2a-254">For Numeric and DateTime values only, you can explicitly set values on hello facet field (for example, `facet=Rating,values:1|2|3|4|5`).</span></span> <span data-ttu-id="66c2a-255">Список значений допустим для этих полей типов toosimplify hello разделение результатах аспекта в смежных диапазоны (либо диапазоны на основании числовых значений или периодам времени).</span><span class="sxs-lookup"><span data-stu-id="66c2a-255">A values list is allowed for these field types toosimplify hello separation of facet results into contiguous ranges (either ranges based on numeric values or time periods).</span></span> 

<span data-ttu-id="66c2a-256">**По умолчанию можно использовать только один уровень фасетной навигации**</span><span class="sxs-lookup"><span data-stu-id="66c2a-256">**By default you can only have one level of faceted navigation**</span></span> 

<span data-ttu-id="66c2a-257">Как уже упоминалось, фасеты невозможно непосредственно вкладывать в иерархию.</span><span class="sxs-lookup"><span data-stu-id="66c2a-257">As noted, there is no direct support for nesting facets in a hierarchy.</span></span> <span data-ttu-id="66c2a-258">По умолчанию фасетная навигация в службе поиска Azure поддерживает только один уровень фильтров.</span><span class="sxs-lookup"><span data-stu-id="66c2a-258">By default, faceted navigation in Azure Search only supports one level of filters.</span></span> <span data-ttu-id="66c2a-259">Однако это ограничение можно обойти.</span><span class="sxs-lookup"><span data-stu-id="66c2a-259">However, workarounds do exist.</span></span> <span data-ttu-id="66c2a-260">Вы можете кодировать иерархическую структуру фасета в `Collection(Edm.String)` с одной точкой входа для одной иерархии.</span><span class="sxs-lookup"><span data-stu-id="66c2a-260">You can encode a hierarchical facet structure in a `Collection(Edm.String)` with one entry point per hierarchy.</span></span> <span data-ttu-id="66c2a-261">Реализации этого способа выходит за рамки данной статьи hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-261">Implementing this workaround is beyond hello scope of this article.</span></span> 

### <a name="querying-tips"></a><span data-ttu-id="66c2a-262">Советы по выполнению запросов</span><span class="sxs-lookup"><span data-stu-id="66c2a-262">Querying tips</span></span>
<span data-ttu-id="66c2a-263">**Проверка полей**</span><span class="sxs-lookup"><span data-stu-id="66c2a-263">**Validate fields**</span></span>

<span data-ttu-id="66c2a-264">При построении hello список аспектов динамически, основываясь на входе недоверенному пользователю Проверьте правильность hello имена полей аспекта hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-264">If you build hello list of facets dynamically based on untrusted user input, validate that hello names of hello faceted fields are valid.</span></span> <span data-ttu-id="66c2a-265">Или, при формировании URL-адресов с помощью escape-имена hello `Uri.EscapeDataString()` в .NET или эквивалента в вашей платформе hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-265">Or, escape hello names when building URLs by using either `Uri.EscapeDataString()` in .NET, or hello equivalent in your platform of choice.</span></span>

### <a name="filtering-tips"></a><span data-ttu-id="66c2a-266">Советы по фильтрации</span><span class="sxs-lookup"><span data-stu-id="66c2a-266">Filtering tips</span></span>
<span data-ttu-id="66c2a-267">**Повышение точности поиска с помощью фильтров**</span><span class="sxs-lookup"><span data-stu-id="66c2a-267">**Increase search precision with filters**</span></span>

<span data-ttu-id="66c2a-268">Используйте фильтры.</span><span class="sxs-lookup"><span data-stu-id="66c2a-268">Use filters.</span></span> <span data-ttu-id="66c2a-269">Если вы полагаетесь на просто выражения поиска, сама по себе, морфологический поиск может привести к toobe документа вернул, не содержащее значение аспекта точный hello в любом из его полей.</span><span class="sxs-lookup"><span data-stu-id="66c2a-269">If you rely on just search expressions alone, stemming could cause a document toobe returned that doesn’t have hello precise facet value in any of its fields.</span></span>

<span data-ttu-id="66c2a-270">**Повышение производительности поиска с помощью фильтров**</span><span class="sxs-lookup"><span data-stu-id="66c2a-270">**Increase search performance with filters**</span></span>

<span data-ttu-id="66c2a-271">Фильтры сузить hello набор документов-кандидатов для поиска и исключить их из ранжирования.</span><span class="sxs-lookup"><span data-stu-id="66c2a-271">Filters narrow down hello set of candidate documents for search and exclude them from ranking.</span></span> <span data-ttu-id="66c2a-272">Если у вас имеется большой набор документов, фасетная детализация с использованием выбранных фасетов часто повышает эффективность поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-272">If you have a large set of documents, using a selective facet drill-down often gives you better performance.</span></span>
  
<span data-ttu-id="66c2a-273">**Фильтрация полей hello аспекта**</span><span class="sxs-lookup"><span data-stu-id="66c2a-273">**Filter only hello faceted fields**</span></span>

<span data-ttu-id="66c2a-274">Фасетная перехода, обычно требуется tooonly документы, содержащие значение аспекта hello в определенные поля (аспекта), не в любом среди всех полей с возможностью поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-274">In faceted drill-down, you typically want tooonly include documents that have hello facet value in a specific (faceted) field, not anywhere across all searchable fields.</span></span> <span data-ttu-id="66c2a-275">Добавление фильтра для более глубокого hello целевого поля, предложив hello toosearch службы только в поля аспекта hello для соответствующего значения.</span><span class="sxs-lookup"><span data-stu-id="66c2a-275">Adding a filter reinforces hello target field by directing hello service toosearch only in hello faceted field for a matching value.</span></span>

<span data-ttu-id="66c2a-276">**Обрезание результатов аспекта с помощью дополнительных фильтров**</span><span class="sxs-lookup"><span data-stu-id="66c2a-276">**Trim facet results with more filters**</span></span>

<span data-ttu-id="66c2a-277">Аспект результаты являются документами, найдено в результатах поиска hello, соответствующими условиям аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-277">Facet results are documents found in hello search results that match a facet term.</span></span> <span data-ttu-id="66c2a-278">В следующий пример, в результатах поиска для hello *облачные вычисления*, 254 элементы также имеют *внутренней спецификации* как тип содержимого.</span><span class="sxs-lookup"><span data-stu-id="66c2a-278">In hello following example, in search results for *cloud computing*, 254 items also have *internal specification* as a content type.</span></span> <span data-ttu-id="66c2a-279">Элементы не обязательно взаимно исключают друг друга.</span><span class="sxs-lookup"><span data-stu-id="66c2a-279">Items are not necessarily mutually exclusive.</span></span> <span data-ttu-id="66c2a-280">Если элемент соответствует критериям hello оба фильтра, то она учитывается в каждом из них.</span><span class="sxs-lookup"><span data-stu-id="66c2a-280">If an item meets hello criteria of both filters, it is counted in each one.</span></span> <span data-ttu-id="66c2a-281">Это дублирование возможна, если аспекты на `Collection(Edm.String)` полей, которые часто используются tooimplement тегов документа.</span><span class="sxs-lookup"><span data-stu-id="66c2a-281">This duplication is possible when faceting on `Collection(Edm.String)` fields, which are often used tooimplement document tagging.</span></span>

        Search term: "cloud computing"
        Content type
           Internal specification (254)
           Video (10) 

<span data-ttu-id="66c2a-282">Как правило Если обнаружится, что результаты аспекта постоянно слишком велики, мы рекомендуем добавить более фильтрует пользователей toogive Дополнительные параметры для сокращения hello поиска.</span><span class="sxs-lookup"><span data-stu-id="66c2a-282">In general, if you find that facet results are consistently too large, we recommend that you add more filters toogive users more options for narrowing hello search.</span></span>

### <a name="tips-about-result-count"></a><span data-ttu-id="66c2a-283">Советы по числу результатов</span><span class="sxs-lookup"><span data-stu-id="66c2a-283">Tips about result count</span></span>

<span data-ttu-id="66c2a-284">**Максимальное число элементов в области навигации аспекта hello hello**</span><span class="sxs-lookup"><span data-stu-id="66c2a-284">**Limit hello number of items in hello facet navigation**</span></span>

<span data-ttu-id="66c2a-285">Для каждого поля аспекта в дереве навигации hello имеется ограничение по умолчанию, равное 10 значений.</span><span class="sxs-lookup"><span data-stu-id="66c2a-285">For each faceted field in hello navigation tree, there is a default limit of 10 values.</span></span> <span data-ttu-id="66c2a-286">Это значение по умолчанию имеет смысл для навигации структур, так как он сохраняет значения hello контролируемым размером tooa список.</span><span class="sxs-lookup"><span data-stu-id="66c2a-286">This default makes sense for navigation structures because it keeps hello values list tooa manageable size.</span></span> <span data-ttu-id="66c2a-287">По умолчанию hello можно переопределить путем назначения toocount значение.</span><span class="sxs-lookup"><span data-stu-id="66c2a-287">You can override hello default by assigning a value toocount.</span></span>

* <span data-ttu-id="66c2a-288">`&facet=city,count:5`Указывает, что только hello первые пять городов в hello высокоприоритетных результаты возвращаются в виде результата аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-288">`&facet=city,count:5` specifies that only hello first five cities found in hello top ranked results are returned as a facet result.</span></span> <span data-ttu-id="66c2a-289">Предположим, вы задали условие поиска airport (аэропорт) и получили 32 совпадения.</span><span class="sxs-lookup"><span data-stu-id="66c2a-289">Consider a sample query with a search term of “airport” and 32 matches.</span></span> <span data-ttu-id="66c2a-290">Если запрос hello указывает `&facet=city,count:5`только первые пять уникальных городов hello с hello большинство документов в результатах поиска hello включаются в hello результатах аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-290">If hello query specifies `&facet=city,count:5`, only hello first five unique cities with hello most documents in hello search results are included in hello facet results.</span></span>

<span data-ttu-id="66c2a-291">Обратите внимание hello различие между результатов поиска и результатах аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-291">Notice hello distinction between facet results and search results.</span></span> <span data-ttu-id="66c2a-292">Результаты поиска будут все документы hello, соответствующих запросу hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-292">Search results are all hello documents that match hello query.</span></span> <span data-ttu-id="66c2a-293">Аспект результаты будут hello совпадений для каждого значения аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-293">Facet results are hello matches for each facet value.</span></span> <span data-ttu-id="66c2a-294">В примере hello результаты поиска включают названия городов, не входящие в список классификаций аспекта hello (5 в нашем примере).</span><span class="sxs-lookup"><span data-stu-id="66c2a-294">In hello example, search results include City names that are not in hello facet classification list (5 in our example).</span></span> <span data-ttu-id="66c2a-295">Результаты, которые фильтруются посредством фасетной навигации, отображаются пользователям, когда они удаляют фасеты или выбирают другие фасеты помимо City (Город).</span><span class="sxs-lookup"><span data-stu-id="66c2a-295">Results that are filtered out through faceted navigation become visible when you clear facets, or choose other facets besides City.</span></span> 

> [!NOTE]
> <span data-ttu-id="66c2a-296">Если имеются фасеты несколько типов, параметр `count` может привести к отображению различных данных.</span><span class="sxs-lookup"><span data-stu-id="66c2a-296">Discussing `count` when there is more than one type can be confusing.</span></span> <span data-ttu-id="66c2a-297">Hello Следующая таблица содержит краткий обзор использования термина hello в API поиска Azure, образец кода и документации.</span><span class="sxs-lookup"><span data-stu-id="66c2a-297">hello following table offers a brief summary of how hello term is used in Azure Search API, sample code, and documentation.</span></span> 

* `@colorFacet.count`<br/>
  <span data-ttu-id="66c2a-298">В коде презентации вы увидите параметр счетчика для аспекта hello, число используемых toodisplay hello аспекта результатов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-298">In presentation code, you should see a count parameter on hello facet, used toodisplay hello number of facet results.</span></span> <span data-ttu-id="66c2a-299">В результатах аспекта число обозначает hello количество документов, которые соответствуют термин аспекта hello или диапазон.</span><span class="sxs-lookup"><span data-stu-id="66c2a-299">In facet results, count indicates hello number of documents that match on hello facet term or range.</span></span>
* `&facet=City,count:12`<br/>
  <span data-ttu-id="66c2a-300">В запроса аспекта можно задать значение tooa числа.</span><span class="sxs-lookup"><span data-stu-id="66c2a-300">In a facet query, you can set count tooa value.</span></span>  <span data-ttu-id="66c2a-301">по умолчанию Hello 10, но можно задать его выше или ниже.</span><span class="sxs-lookup"><span data-stu-id="66c2a-301">hello default is 10, but you can set it higher or lower.</span></span> <span data-ttu-id="66c2a-302">Параметр `count:12` возвращает hello рангом 12 в результатах аспекта по количеству документов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-302">Setting `count:12` gets hello top 12 matches in facet results by document count.</span></span>
* <span data-ttu-id="66c2a-303">"`@odata.count`"</span><span class="sxs-lookup"><span data-stu-id="66c2a-303">"`@odata.count`"</span></span><br/>
  <span data-ttu-id="66c2a-304">В ответ на запрос hello это значение указывает hello количество найденных элементов в результатах поиска hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-304">In hello query response, this value indicates hello number of matching items in hello search results.</span></span> <span data-ttu-id="66c2a-305">В среднем больше, чем сумма всех результатах аспекта вместе, из-за наличия toohello элементов, соответствующих поисковому запросу hello, hello, однако совпадений значение аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-305">On average, it’s larger than hello sum of all facet results combined, due toohello presence of items that match hello search term, but have no facet value matches.</span></span>

<span data-ttu-id="66c2a-306">**Получение числа результатов для аспекта**</span><span class="sxs-lookup"><span data-stu-id="66c2a-306">**Get counts in facet results**</span></span>

<span data-ttu-id="66c2a-307">При добавлении запроса аспекта tooa фильтра, может потребоваться tooretain hello аспекта инструкции (например, `facet=Rating&$filter=Rating ge 4`).</span><span class="sxs-lookup"><span data-stu-id="66c2a-307">When you add a filter tooa faceted query, you might want tooretain hello facet statement (for example, `facet=Rating&$filter=Rating ge 4`).</span></span> <span data-ttu-id="66c2a-308">С технической точки зрения аспекта = оценки не требуется, но его возвращает счетчики hello аспекта значений для оценки, 4 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="66c2a-308">Technically, facet=Rating isn’t needed, but keeping it returns hello counts of facet values for ratings 4 and higher.</span></span> <span data-ttu-id="66c2a-309">Например, если после нажатия кнопки «4» Здравствуйте, запрос содержит фильтр для больше или равно слишком «4», возвращаются числа для каждой оценки, 4 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="66c2a-309">For example, if you click "4" and hello query includes a filter for greater or equal too"4", counts are returned for each rating that is 4 and higher.</span></span>  

<span data-ttu-id="66c2a-310">**Обеспечение точного числа результатов для аспекта**</span><span class="sxs-lookup"><span data-stu-id="66c2a-310">**Make sure you get accurate facet counts**</span></span>

<span data-ttu-id="66c2a-311">При определенных обстоятельствах может выясниться, что счетчики аспекта не совпадают hello результирующих наборов (см. [Фасетная Навигация в поиске Azure (сообщение на форуме)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span><span class="sxs-lookup"><span data-stu-id="66c2a-311">Under certain circumstances, you might find that facet counts do not match hello result sets (see [Faceted navigation in Azure Search (forum post)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span></span>

<span data-ttu-id="66c2a-312">Количество аспект может быть неточной из-за toohello архитектуру сегментирования.</span><span class="sxs-lookup"><span data-stu-id="66c2a-312">Facet counts can be inaccurate due toohello sharding architecture.</span></span> <span data-ttu-id="66c2a-313">Каждый индекс поиска имеет несколько сегментов, и каждый сегмент сообщает hello N основных аспектов по количеству документов, который затем объединяются в единый результат.</span><span class="sxs-lookup"><span data-stu-id="66c2a-313">Every search index has multiple shards, and each shard reports hello top N facets by document count, which is then combined into a single result.</span></span> <span data-ttu-id="66c2a-314">У некоторых сегментов множество совпадающих значений, тогда как другие содержат меньшее число, возможно, некоторые значения аспекта отсутствуют или в группе подсчет количества результатов hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-314">If some shards have many matching values, while others have fewer, you may find that some facet values are missing or under-counted in hello results.</span></span>

<span data-ttu-id="66c2a-315">Несмотря на то, что это поведение можно изменить в любое время, если сегодня возникновение такой ситуации, можно обойти ее, искусственно дало бы ошибку счетчик hello:<number> tooa большое число tooenforce полный отчетов от каждого сегмента.</span><span class="sxs-lookup"><span data-stu-id="66c2a-315">Although this behavior could change at any time, if you encounter this behavior today, you can work around it by artificially inflating hello count:<number> tooa large number tooenforce full reporting from each shard.</span></span> <span data-ttu-id="66c2a-316">Если hello значение счетчика: больше или равно toohello числом уникальных значений в поле hello гарантируется точные результаты.</span><span class="sxs-lookup"><span data-stu-id="66c2a-316">If hello value of count: is greater than or equal toohello number of unique values in hello field, you are guaranteed accurate results.</span></span> <span data-ttu-id="66c2a-317">Однако если имеется очень много документов, производительность снижается, поэтому выполняйте эти действия рассудительно.</span><span class="sxs-lookup"><span data-stu-id="66c2a-317">However, when document counts are high, there is a performance penalty, so use this option judiciously.</span></span>

### <a name="user-interface-tips"></a><span data-ttu-id="66c2a-318">Советы по пользовательскому интерфейсу</span><span class="sxs-lookup"><span data-stu-id="66c2a-318">User interface tips</span></span>
<span data-ttu-id="66c2a-319">**Используя фасетную навигацию, добавляйте метки для всех полей.**</span><span class="sxs-lookup"><span data-stu-id="66c2a-319">**Add labels for each field in facet navigation**</span></span>

<span data-ttu-id="66c2a-320">Метки обычно определяются в форме или hello HTML (`index.cshtml` в пример приложения hello).</span><span class="sxs-lookup"><span data-stu-id="66c2a-320">Labels are typically defined in hello HTML or form (`index.cshtml` in hello sample application).</span></span> <span data-ttu-id="66c2a-321">В службе поиска Azure не предусмотрен интерфейс API для работы с метками фасетной навигации или другими метаданными.</span><span class="sxs-lookup"><span data-stu-id="66c2a-321">There is no API in Azure Search for facet navigation labels or any other metadata.</span></span>

<a name="rangefacets"></a>

## <a name="filter-based-on-a-range"></a><span data-ttu-id="66c2a-322">Фильтрация по диапазону значений</span><span class="sxs-lookup"><span data-stu-id="66c2a-322">Filter based on a range</span></span>
<span data-ttu-id="66c2a-323">В приложениях поиска часто используется фасетная навигация на основе диапазонов значений.</span><span class="sxs-lookup"><span data-stu-id="66c2a-323">Faceting over ranges of values is a common search application requirement.</span></span> <span data-ttu-id="66c2a-324">Поддерживаются диапазоны числовых данных, а также значений даты и времени.</span><span class="sxs-lookup"><span data-stu-id="66c2a-324">Ranges are supported for numeric data and DateTime values.</span></span> <span data-ttu-id="66c2a-325">Каждый подход подробно описан в [статье, посвященной поиску документов с помощью интерфейса API службы поиска Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span><span class="sxs-lookup"><span data-stu-id="66c2a-325">You can read more about each approach in [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span></span>

<span data-ttu-id="66c2a-326">Служба поиска Azure упрощает создание диапазонов, обеспечивая два способа их вычисления.</span><span class="sxs-lookup"><span data-stu-id="66c2a-326">Azure Search simplifies range construction by providing two approaches for computing a range.</span></span> <span data-ttu-id="66c2a-327">Для обоих подходов поиска Azure создает hello соответствующие диапазоны, на основе hello входных данных, предоставленных вами.</span><span class="sxs-lookup"><span data-stu-id="66c2a-327">For both approaches, Azure Search creates hello appropriate ranges given hello inputs you’ve provided.</span></span> <span data-ttu-id="66c2a-328">Например, если указать диапазон значений 10|20|30, будут автоматически созданы диапазоны 0–10, 10–20, 20–30–10, 10–20 и 20–30.</span><span class="sxs-lookup"><span data-stu-id="66c2a-328">For instance, if you specify range values of 10|20|30, it automatically creates ranges of 0-10, 10-20, 20-30.</span></span> <span data-ttu-id="66c2a-329">Приложение может при необходимости удалить все пустые интервалы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-329">Your application can optionally remove any intervals that are empty.</span></span> 

<span data-ttu-id="66c2a-330">**Способ 1: Используйте параметр интервала hello**</span><span class="sxs-lookup"><span data-stu-id="66c2a-330">**Approach 1: Use hello interval parameter**</span></span>  
<span data-ttu-id="66c2a-331">аспекты цены tooset с приращением 10 долларов США, необходимо указать:`&facet=price,interval:10`</span><span class="sxs-lookup"><span data-stu-id="66c2a-331">tooset price facets in $10 increments, you would specify: `&facet=price,interval:10`</span></span>

<span data-ttu-id="66c2a-332">**Способ 2. Использование списка значений**</span><span class="sxs-lookup"><span data-stu-id="66c2a-332">**Approach 2: Use a values list**</span></span>  
<span data-ttu-id="66c2a-333">Для числовых данных можно использовать список значений.</span><span class="sxs-lookup"><span data-stu-id="66c2a-333">For numeric data, you can use a values list.</span></span>  <span data-ttu-id="66c2a-334">Рассмотрим hello аспекта диапазона для `listPrice` поля, преобразован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="66c2a-334">Consider hello facet range for a `listPrice` field, rendered as follows:</span></span>

  ![Пример списка значений][5]

<span data-ttu-id="66c2a-336">toospecify диапазона аспекта, например hello в предшествующих снимок экрана приветствия используйте список значений:</span><span class="sxs-lookup"><span data-stu-id="66c2a-336">toospecify a facet range like hello one in hello preceding screen shot, use a values list:</span></span>

    facet=listPrice,values:10|25|100|500|1000|2500

<span data-ttu-id="66c2a-337">Каждый диапазон строится с помощью 0 в качестве отправной точки, значения из списка hello в качестве конечной точки и затем обрезаются hello предыдущих toocreate дискретные интервалы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-337">Each range is built using 0 as a starting point, a value from hello list as an endpoint, and then trimmed of hello previous range toocreate discrete intervals.</span></span> <span data-ttu-id="66c2a-338">Служба поиска Azure выполняет эти действия в рамках фасетной навигации.</span><span class="sxs-lookup"><span data-stu-id="66c2a-338">Azure Search does these things as part of faceted navigation.</span></span> <span data-ttu-id="66c2a-339">У вас toowrite код для структуризации каждого интервала.</span><span class="sxs-lookup"><span data-stu-id="66c2a-339">You do not have toowrite code for structuring each interval.</span></span>

### <a name="build-a-filter-for-a-range"></a><span data-ttu-id="66c2a-340">Создание фильтра для диапазона</span><span class="sxs-lookup"><span data-stu-id="66c2a-340">Build a filter for a range</span></span>
<span data-ttu-id="66c2a-341">toofilter документов на основе выбора диапазона, можно использовать hello `"ge"` и `"lt"` операторы в выражении двух частей, которое определяет конечные точки hello hello диапазона фильтров.</span><span class="sxs-lookup"><span data-stu-id="66c2a-341">toofilter documents based on a range you select, you can use hello `"ge"` and `"lt"` filter operators in a two-part expression that defines hello endpoints of hello range.</span></span> <span data-ttu-id="66c2a-342">Например, при выборе hello диапазон 10-25 `listPrice` поле фильтра hello бы `$filter=listPrice ge 10 and listPrice lt 25`.</span><span class="sxs-lookup"><span data-stu-id="66c2a-342">For example, if you choose hello range 10-25 for a `listPrice` field, hello filter would be `$filter=listPrice ge 10 and listPrice lt 25`.</span></span> <span data-ttu-id="66c2a-343">В примере кода hello использует выражение фильтра hello **priceFrom** и **priceTo** параметры tooset hello, конечные точки.</span><span class="sxs-lookup"><span data-stu-id="66c2a-343">In hello sample code, hello filter expression uses **priceFrom** and **priceTo** parameters tooset hello endpoints.</span></span> 

  ![Запрос для диапазона значений][6]

<a name="geofacets"></a> 

## <a name="filter-based-on-distance"></a><span data-ttu-id="66c2a-345">Фильтрация по расстоянию</span><span class="sxs-lookup"><span data-stu-id="66c2a-345">Filter based on distance</span></span>
<span data-ttu-id="66c2a-346">Общие toosee фильтры, помогающие выбрать магазина, ресторана или назначения, в зависимости от текущего расположения tooyour близости.</span><span class="sxs-lookup"><span data-stu-id="66c2a-346">It’s common toosee filters that help you choose a store, restaurant, or destination based on its proximity tooyour current location.</span></span> <span data-ttu-id="66c2a-347">Хотя фильтр такого типа похож на фасетную навигацию, он является всего лишь обычным фильтром.</span><span class="sxs-lookup"><span data-stu-id="66c2a-347">While this type of filter might look like faceted navigation, it’s just a filter.</span></span> <span data-ttu-id="66c2a-348">Этот вопрос упоминается здесь для пользователей, которым нужно решить проблему с реализацией этого компонента.</span><span class="sxs-lookup"><span data-stu-id="66c2a-348">We mention it here for those of you who are specifically looking for implementation advice for that particular design problem.</span></span>

<span data-ttu-id="66c2a-349">Поиск Azure поддерживает две геопространственные функции: **geo.distance** и **geo.intersects**.</span><span class="sxs-lookup"><span data-stu-id="66c2a-349">There are two Geospatial functions in Azure Search, **geo.distance** and **geo.intersects**.</span></span>

* <span data-ttu-id="66c2a-350">Hello **geo.distance** функция возвращает hello расстояния в километрах между двумя точками.</span><span class="sxs-lookup"><span data-stu-id="66c2a-350">hello **geo.distance** function returns hello distance in kilometers between two points.</span></span> <span data-ttu-id="66c2a-351">Одна точка — это поле, а другой — константа, переданная как часть фильтра hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-351">One point is a field and other is a constant passed as part of hello filter.</span></span> 
* <span data-ttu-id="66c2a-352">Hello **geo.intersects** функция возвращает значение true, если заданная точка находится в пределах заданного многоугольника.</span><span class="sxs-lookup"><span data-stu-id="66c2a-352">hello **geo.intersects** function returns true if a given point is within a given polygon.</span></span> <span data-ttu-id="66c2a-353">Hello точка — это поле и hello многоугольник задается как константа список координаты, переданная как часть фильтра hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-353">hello point is a field and hello polygon is specified as a constant list of coordinates passed as part of hello filter.</span></span>

<span data-ttu-id="66c2a-354">Примеры фильтров приведены в статье [Синтаксис выражений OData для поиска Azure](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span><span class="sxs-lookup"><span data-stu-id="66c2a-354">You can find filter examples in [OData expression syntax (Azure Search)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span></span>

<a name="tryitout"></a>

## <a name="try-hello-demo"></a><span data-ttu-id="66c2a-355">Повторите Демонстрация hello</span><span class="sxs-lookup"><span data-stu-id="66c2a-355">Try hello demo</span></span>
<span data-ttu-id="66c2a-356">Hello задания портала Azure поиска Демонстрация примеры hello в этой статье.</span><span class="sxs-lookup"><span data-stu-id="66c2a-356">hello Azure Search Job Portal Demo contains hello examples referenced in this article.</span></span>

-   <span data-ttu-id="66c2a-357">. В разделе и тестирования hello рабочего образца через Интернет в [Демонстрация портала задания поиска Azure](http://azjobsdemo.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="66c2a-357">See and test hello working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="66c2a-358">Загружать код hello из hello [Azure примерами в репозитории на GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="66c2a-358">Download hello code from hello [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

<span data-ttu-id="66c2a-359">При работе с результатами поиска, просмотра hello URL-адрес для изменения структуры запроса.</span><span class="sxs-lookup"><span data-stu-id="66c2a-359">As you work with search results, watch hello URL for changes in query construction.</span></span> <span data-ttu-id="66c2a-360">Это приложение происходит toohello аспекты tooappend URI, по мере выбора каждого из них.</span><span class="sxs-lookup"><span data-stu-id="66c2a-360">This application happens tooappend facets toohello URI as you select each one.</span></span>

1. <span data-ttu-id="66c2a-361">функциональность сопоставления hello toouse нашего примера приложения hello, получение ключа Bing Maps из hello [Центр разработчиков Bing Maps](https://www.bingmapsportal.com/).</span><span class="sxs-lookup"><span data-stu-id="66c2a-361">toouse hello mapping functionality of hello demo app, get a Bing Maps key from hello [Bing Maps Dev Center](https://www.bingmapsportal.com/).</span></span> <span data-ttu-id="66c2a-362">Вставьте его поверх существующего ключа hello в hello `index.cshtml` страницы.</span><span class="sxs-lookup"><span data-stu-id="66c2a-362">Paste it over hello existing key in hello `index.cshtml` page.</span></span> <span data-ttu-id="66c2a-363">Hello `BingApiKey` в hello `Web.config` файл не используется.</span><span class="sxs-lookup"><span data-stu-id="66c2a-363">hello `BingApiKey` setting in hello `Web.config` file is not used.</span></span> 

2. <span data-ttu-id="66c2a-364">Запустите приложение hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-364">Run hello application.</span></span> <span data-ttu-id="66c2a-365">Ознакомьтесь с необязательным hello или закрыть диалоговое окно «hello».</span><span class="sxs-lookup"><span data-stu-id="66c2a-365">Take hello optional tour, or dismiss hello dialog box.</span></span>
   
3. <span data-ttu-id="66c2a-366">Введите условие поиска, такие как «аналитика» и щелкните значок поиска hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-366">Enter a search term, such as "analyst", and click hello Search icon.</span></span> <span data-ttu-id="66c2a-367">Hello запрос выполняется быстро.</span><span class="sxs-lookup"><span data-stu-id="66c2a-367">hello query executes quickly.</span></span>
   
   <span data-ttu-id="66c2a-368">Структура фасетная Навигация также возвращается с результатами поиска hello.</span><span class="sxs-lookup"><span data-stu-id="66c2a-368">A faceted navigation structure is also returned with hello search results.</span></span> <span data-ttu-id="66c2a-369">На странице результатов поиска hello структура фасетная Навигация hello включает счетчики для каждого результата аспекта.</span><span class="sxs-lookup"><span data-stu-id="66c2a-369">In hello search result page, hello faceted navigation structure includes counts for each facet result.</span></span> <span data-ttu-id="66c2a-370">Фасеты не выбраны, поэтому возвращаются все соответствующие результаты.</span><span class="sxs-lookup"><span data-stu-id="66c2a-370">No facets are selected, so all matching results are returned.</span></span>
   
   ![Результаты поиска до выбора фасетов][11]

4. <span data-ttu-id="66c2a-372">Щелкните фасеты Business Title (Должность в компании), Location (Расположение) или Minimum Salary (Минимальная заработная плата).</span><span class="sxs-lookup"><span data-stu-id="66c2a-372">Click a Business Title, Location, or Minimum Salary.</span></span> <span data-ttu-id="66c2a-373">Аспекты были значение null у первоначального поискового hello, но, как они принимают значения, результаты поиска hello усекаются элементов, которые не соответствуют.</span><span class="sxs-lookup"><span data-stu-id="66c2a-373">Facets were null on hello initial search, but as they take on values, hello search results are trimmed of items that no longer match.</span></span>
   
   ![Результаты поиска после выбора фасетов][12]

5. <span data-ttu-id="66c2a-375">результат запроса tooclear hello, попробуйте выполнить другой запрос поведения, щелкните hello `[X]` после hello аспекты tooclear hello аспектов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-375">tooclear hello faceted query so that you can try different query behaviors, click hello `[X]` after hello selected facets tooclear hello facets.</span></span>
   
<a name="nextstep"></a>

## <a name="learn-more"></a><span data-ttu-id="66c2a-376">Подробнее</span><span class="sxs-lookup"><span data-stu-id="66c2a-376">Learn more</span></span>
<span data-ttu-id="66c2a-377">Просмотрите видео [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410) (Подробный обзор Поиска Azure).</span><span class="sxs-lookup"><span data-stu-id="66c2a-377">Watch [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410).</span></span> <span data-ttu-id="66c2a-378">45:25, отсутствует на демонстрацию о том, как tooimplement аспектов.</span><span class="sxs-lookup"><span data-stu-id="66c2a-378">At 45:25, there is a demo on how tooimplement facets.</span></span>

<span data-ttu-id="66c2a-379">Дополнительные сведения о принципах разработки фасетная Навигация рекомендуется hello ссылкам:</span><span class="sxs-lookup"><span data-stu-id="66c2a-379">For more insights on design principles for faceted navigation, we recommend hello following links:</span></span>

* [<span data-ttu-id="66c2a-380">Разработка решения для поиска с использованием фасетов</span><span class="sxs-lookup"><span data-stu-id="66c2a-380">Designing for Faceted Search</span></span>](http://www.uie.com/articles/faceted_search/)
* [<span data-ttu-id="66c2a-381">Шаблоны разработки: фасетная навигация</span><span class="sxs-lookup"><span data-stu-id="66c2a-381">Design Patterns: Faceted Navigation</span></span>](http://alistapart.com/article/design-patterns-faceted-navigation)


<!--Anchors-->
[How toobuild it]: #howtobuildit
[Build hello presentation layer]: #presentationlayer
[Build hello index]: #buildindex
[Check for data quality]: #checkdata
[Build hello query]: #buildquery
[Tips on how toocontrol faceted navigation]: #tips
[Faceted navigation based on range values]: #rangefacets
[Faceted navigation based on GeoPoints]: #geofacets
[Try it out]: #tryitout

<!--Image references-->
[1]: ./media/search-faceted-navigation/azure-search-faceting-example.PNG
[2]: ./media/search-faceted-navigation/Facet-2-CSHTML.PNG
[3]: ./media/search-faceted-navigation/Facet-3-schema.PNG
[4]: ./media/search-faceted-navigation/Facet-4-SearchMethod.PNG
[5]: ./media/search-faceted-navigation/Facet-5-Prices.PNG
[6]: ./media/search-faceted-navigation/Facet-6-buildfilter.PNG
[7]: ./media/search-faceted-navigation/Facet-7-appstart.png
[8]: ./media/search-faceted-navigation/Facet-8-appbike.png
[9]: ./media/search-faceted-navigation/Facet-9-appbikefaceted.png
[10]: ./media/search-faceted-navigation/Facet-10-appTitle.png
[11]: ./media/search-faceted-navigation/faceted-search-before-facets.png
[12]: ./media/search-faceted-navigation/faceted-search-after-facets.png

<!--Link references-->
[Designing for Faceted Search]: http://www.uie.com/articles/faceted_search/
[Design Patterns: Faceted Navigation]: http://alistapart.com/article/design-patterns-faceted-navigation
[Create your first application]: search-create-first-solution.md
[OData expression syntax (Azure Search)]: http://msdn.microsoft.com/library/azure/dn798921.aspx
[Azure Search Adventure Works Demo]: https://azuresearchadventureworksdemo.codeplex.com/
[http://www.odata.org/documentation/odata-version-2-0/overview/]: http://www.odata.org/documentation/odata-version-2-0/overview/ 
[Faceting on Azure Search forum post]: ../faceting-on-azure-search.md?forum=azuresearch
[Search Documents (Azure Search API)]: http://msdn.microsoft.com/library/azure/dn798927.aspx

