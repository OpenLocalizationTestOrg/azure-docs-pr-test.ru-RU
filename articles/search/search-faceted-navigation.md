---
title: "aaaHow tooimplement фасетная Навигация в поиске Azure | Документы Microsoft"
description: "Добавьте tooapplications Фасетная навигация, которые интегрируются с поиском Azure, размещенной облачной службой поиска в Microsoft Azure."
services: search
documentationcenter: 
author: HeidiSteen
manager: mblythe
editor: 
ms.assetid: cdf98fd4-63fd-4b50-b0b0-835cb08ad4d3
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 3/10/2017
ms.author: heidist
ms.openlocfilehash: c1e6bf9dc55d0044525db79e37d35a50ded5a736
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooimplement-faceted-navigation-in-azure-search"></a>Как tooimplement фасетная Навигация в поиске Azure
Фасетная навигация представляет собой механизм фильтрации, обеспечивающий самоуправляемую детализированную навигацию в приложениях поиска. может быть незнакомо Hello термин «фасетная навигация», но вы вероятно использовали ее ранее. Как hello следующий пример показывает фасетная Навигация — это ничто иное hello категории, используемые toofilter результаты.

 ![Демоверсия портала поиска работы, использующего Поиск Azure][1]

Фасетная Навигация является toosearch точки альтернативных запись. Он обеспечивает удобный альтернативный tootyping сложных выражений вручную. С помощью фасетов вы можете найти нужные данные. Вероятность нулевого результата практически исключена. Как разработчик аспекты позволяют предоставлять hello чаще условия поиска для перемещения по вашей корпуса поиска. В интерактивных приложениях для розничного торговли в фасетной навигации часто используются такие категории, как торговые марки, отделы (например, "Детская обувь"), размер, цена, популярность и оценки. 

Способ реализации фасетной навигации зависит от технологии поиска. В службе поиска Azure фасетная навигация реализуется при отправке запроса с использованием полей атрибутов, ранее указанных в схеме.

-   В запросах hello, при построении приложения, необходимо отправить запрос *параметров запроса аспекта* значения фильтра tooget hello аспекта, доступные для этого документа результирующего набора.

-   tooactually усечение hello документа результирующего набора, необходимо также установить приложение hello `$filter` выражение.

При разработке приложений написания кода, который создает запросы составляет массового hello hello работы. Многие поведения приложения hello, которые можно ожидать от фасетная Навигация предоставляются службой hello, включая встроенную поддержку для определения диапазонов и получение счетчиков для результатах аспекта. Служба Hello также включает допустимых значений по умолчанию, которые помогают избежать структуры навигации громоздким. 

## <a name="sample-code-and-demo"></a>Пример кода и демонстрация
В этой статье в качестве примера используется портал поиска работы. пример Hello реализуется как приложение ASP.NET MVC.

-   . В разделе и тестирования hello рабочего образца через Интернет в [Демонстрация портала задания поиска Azure](http://azjobsdemo.azurewebsites.net/).

-   Загружать код hello из hello [Azure примерами в репозитории на GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).

## <a name="get-started"></a>Начало работы
Если вы при разработке новых проектов toosearch hello лучшим способом toothink аспекта навигации —, которое содержит возможности hello самостоятельно расширенного поиска. Это тип детализированного поиска на основе предопределенных фильтров, который позволяет быстро сузить результаты поиска с помощью интерактивных действий. 

### <a name="interaction-model"></a>Модель взаимодействия

Давайте начнем с изучения его как последовательность запросов, развертывать в ответные меры toouser итеративный, Hello поисковый интерфейс для фасетная Навигация.

Привет, начальная точка является страницу приложения, который предоставляет фасетная навигация, обычно размещаются на периферии hello. Часто фасетная навигации представляет из себя древовидную структуру с флажками для каждого значения или текстом, который можно щелкнуть. 

1. Запрос, отправленный tooAzure поиска определяет структуру фасетная Навигация hello через один или несколько параметров запроса аспекта. Для экземпляра hello запрос может содержать `facet=Rating`, возможно, с `:values` или `:sort` toofurther параметр уточнения hello презентации.
2. уровень представления Hello отображает страницу поиска, которая предоставляет фасетная навигация, с помощью аспектов hello, указанный в запросе hello.
3. Имея фасетная Навигация структуры, содержащей рейтинг, щелкните tooindicate «4», которое будет отображаться только те продукты, оценка 4 или более поздней версии. 
4. В результате приложение hello отправляет запрос, включающий`$filter=Rating ge 4` 
5. Hello презентации слоя hello страницы обновления отображение сокращенный результирующий набор, содержащий только те элементы, удовлетворяющие критериям новый hello (в этом случае продуктов рейтингом 4 и выше).

Фасет — это параметр запроса. Однако его не следует путать с входными данными запроса. Он никогда не используется в качестве критериев выбора в запросе. Вместо этого считаете параметры запроса аспекта структуру навигации toohello входных данных, который возвращается в ответе hello. Для каждого параметра запроса аспекта, предоставленные вами поиска Azure оценивает, сколько документов в hello частичные результаты для каждого значения аспекта.

Обратите внимание hello `$filter` на шаге 4. Фильтр Hello является важным аспектом фасетная Навигация. Несмотря на то, что в hello API независимы аспекты и фильтры, необходимо взаимодействие hello обоих toodeliver, которую вы намерены. 

### <a name="app-design-pattern"></a>Конструктивный шаблон приложения

В коде приложения hello шаблон — toouse аспекта запроса параметров tooreturn hello фасетная Навигация структура вместе с аспекта результаты, а также выражения $filter.  hello дескрипторы выражение фильтра Hello щелкните событие на значение аспекта hello. Представьте hello `$filter` выражение в качестве кода hello фактическое усечения hello результаты поиска возвращаются toohello уровня представления. Имея аспекта цветов, щелкните красный цвет hello реализуется с помощью `$filter` выражение, которое выбирает только те элементы, которые имеют красный цвет. 

### <a name="query-basics"></a>Основы запросов

В службе поиска Azure запрос указывается с помощью одного или нескольких параметров запроса (описание каждого из них приведено в [статье, посвященной поиску документов](http://msdn.microsoft.com/library/azure/dn798927.aspx) ). Ни один из параметров запроса hello являются обязательными, но необходимо иметь по крайней мере один в порядке для запроса toobe допустимым.

Точность, распознанное при hello toofilter возможность ожидания играет попаданий достигается с помощью одного или обоих этих выражений:

-   **search=**  
    значение этого параметра Hello составляет выражение поиска hello. Это может быть текстовый фрагмент или сложное выражение поиска, которое включает в себя несколько условий и операторов. На сервере hello искомое выражение используется для полнотекстового поиска, запрос для поиска полей в индексе hello для сопоставления условий, возврат результатов по шкале. Если задать `search` toonull, выполнение запроса не по всему индексу hello (то есть, `search=*`). In this Case, запросить hello другие элементы, такие как `$filter` или профиль оценки, hello основной факторы, влияющие на документов, которые возвращаются `($filter`) и в каком порядке (`scoringProfile` или `$orderby`).

-   **$filter=**  
    Фильтр очень мощный механизм для ограничения размера hello результатов поиска на основе значений hello атрибутов определенного документа. Объект `$filter` вычисляется в первую очередь, следуют аспекты логику, которая приводит к возникновению ошибки hello доступных значений, а также соответствующие счетчики для каждого значения

Выражения поиска в сложных снижают производительность hello hello запроса. Там, где это возможно, используется точность tooincrease хорошо сконструированный фильтра выражений и повысить производительность запросов.

toobetter понять, как фильтр добавляет большую точность, сравните tooone выражение сложного поиска, которая включает выражение фильтра:

-   `GET /indexes/hotel/docs?search=lodging budget +Seattle –motel +parking`
-   `GET /indexes/hotel/docs?search=lodging&$filter=City eq ‘Seattle’ and Parking and Type ne ‘motel’`

Оба запроса являются допустимыми, но hello второй является предпочтительной, если вы ищете не ловушкам с парковки в Сиэтле.
-   первый запрос Hello зависит от этих слов, упомянутые или не упоминается в поля строки, такие как имя, описание и другие поля, содержащего данные с возможностью поиска.
-   второй запрос Hello осуществляется более точны, скорее всего, toobe и точного совпадения в структурированных данных.

В приложениях, содержащих фасетную навигацию, необходимо убедиться, что все действия, которые выполняет пользователь со структурой фасетной навигации, сопровождаются сужением результатов поиска. toonarrow результаты, используйте выражение фильтра.

<a name="howtobuildit"></a>

## <a name="build-a-faceted-navigation-app"></a>Создание приложения с фасетной навигацией
Фасетная Навигация с поиском Azure реализовать в коде приложения, создающий hello поискового запроса. фасетная Навигация Hello использует элементы в схеме, которое было определено ранее.

Предопределенные в индексе поиска — hello `Facetable [true|false]` атрибут index, установить на выбранных полей tooenable или отключить их использование в структуре фасетная Навигация. Если поле не содержит атрибута `"Facetable" = true`, его невозможно использовать в фасетной навигации.

уровень представления Hello в коде обеспечивает взаимодействие с пользователем hello. Он должен содержать hello составные части фасетная Навигация hello, такие как метки hello, значения, флажки и число hello. Hello REST API поиска Azure не зависит от платформы, поэтому следует использовать язык и требуется платформа. Hello важно tooinclude элементы пользовательского интерфейса, поддерживающих добавочные обновления, с обновленное состояние пользовательского интерфейса как выбрать каждый дополнительный аспект. 

Во время запроса, код приложения создает запрос, содержащий `facet=[string]`, параметр запроса, который предоставляет hello toofacet поле по. Запрос может содержать несколько фасетов, таких как `&facet=color&facet=category&facet=rating`, которые разделяются символов "амперсанд" (&).

Код приложения необходимо также создать `$filter` hello toohandle выражение события щелчка в фасетная Навигация. Объект `$filter` сокращает количество результатов поиска hello, используя значение аспекта hello в качестве критерия фильтра.

Поиск Azure возвращает результаты поиска hello, на основе одного или нескольких условий, введите, вместе со структурой фасетная Навигация toohello обновлений. В службе поиска Azure фасетная навигация представляет из себя одноуровневую структуру со значениями фасетов и количеством результаты, найденных для каждого из них.

В следующих разделах hello, мы рассмотрим ближе как toobuild каждой части.

<a name="buildindex"></a>

## <a name="build-hello-index"></a>Создание индекса hello
Аспекты включена для каждого поля, с hello индекс, с помощью этого атрибута индекса: `"Facetable": true`.  
Для всех типов полей, которые можно использовать в фасетной навигации, по умолчанию устанавливается значение `Facetable` . Такие типы полей включают `Edm.String`, `Edm.DateTimeOffset`, и все hello числовых типов полей (по существу, все типы полей, facetable за исключением `Edm.GeographyPoint`, который не может использоваться в фасетная Навигация). 

При построении индекса, рекомендуется для фасетная Навигация отключено аспекты Включение tooexplicitly для полей, которые не должны использоваться в качестве аспекта.  В частности, строка поля для одинарных значений, такие как имя идентификатора или продукта, задавайте слишком`"Facetable": false` tooprevent их случайного (и неэффективными) использование в фасетная Навигация. Включение аспекты off, где он не нужен помогает поддерживать небольшой размер hello индекса hello и обычно повышает производительность.

Следующее является частью схемы hello для hello задания портала нашего примера образец приложения обрезаются размер hello tooreduce некоторые атрибуты:

```json
{
  ...
  "name": "nycjobs",
  "fields": [
    { “name”: "id",                 "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "job_id",             "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "agency",              "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "posting_type",        "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "num_of_positions",    "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "business_title",      "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "civil_service_title", "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "title_code_no",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "level",               "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_from",   "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_to",     "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_frequency",    "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "work_location",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
…
    { “name”: "geo_location",        "type": "Edm.GeographyPoint",     "searchable": false, "filterable": true, ...  "facetable": false, ... },
    { “name”: "tags",                "type": "Collection(Edm.String)", "searchable": true,  "filterable": true, ...  "facetable": true, ...  }
  ],
…
}
```

Как видно в схеме образец hello `Facetable` отключена для строковых полей, которые не следует использовать в качестве аспектов, таких как значения Идентификаторов. Включение аспекты off, где он не нужен помогает поддерживать небольшой размер hello индекса hello и обычно повышает производительность.

> [!TIP]
> Рекомендуется включите hello полный набор атрибутов индекса для каждого поля. Несмотря на то что `Facetable` включен по умолчанию для почти всех полей, специально задание каждый атрибут может помочь при через hello последствия каждого решения схемы. 

<a name="checkdata"></a>

## <a name="check-hello-data"></a>Проверка данных hello
Hello качества данных имеет прямое влияние на ли структура фасетная Навигация hello материализует как ожидается. Он также влияет на hello Простота создания фильтров tooreduce hello результирующий набор.

Если требуется, чтобы toofacet фирменной символики или цены, каждый документ должен содержать значения для *название фирмы-производителя* и *ProductPrice* , допустимый согласованность и производительность как параметр фильтра.

Ниже приведены несколько напоминаний какие tooscrub для:

* Для каждого поля, которое требуется toofacet по спросите себя, содержит ли он может использоваться как фильтры значений в собственной расширенного поиска. Hello значения должны быть короткие, описательные и достаточно различение toooffer Выбор между конкурирующих параметры.
* Опечатки или близкие значения. Если аспекта на цвет и значениях полей включают оранжевый и Ornage (ошибке): как будет взять аспект, на основе поля цвет hello.
* Использование текста, написанного прописными и строчными буквами, также может негативно отразиться на фасетной навигации, так как элементы orange и Orange будут считаться двумя разными значениями. 
* Одно- и во множественном числе версии приветствия одинаковое значение может привести к отдельной аспекта для каждого.

Как можно себе представить, экспертизы при подготовке данных hello является важным аспектом действующие фасетная Навигация.

<a name="presentationlayer"></a>

## <a name="build-hello-ui"></a>Построение hello пользовательского интерфейса
Работа с уровнем представления hello можно выявить требования, в противном случае могут быть пропущены и понять, какие возможности будут essential toohello справки функции поиска.

С точки зрения фасетная Навигация на страницу веб- или приложения отображает структуру фасетная Навигация hello, обнаруживает ввод данных пользователем на странице приветствия и вставляет элементы изменены hello. 

Для веб-приложений AJAX обычно используется в слой представления hello так как она допускает toorefresh добавочные изменения. Можно также использовать ASP.NET MVC или любой другой платформы визуализации, можно подключиться tooan службы поиска Azure по протоколу HTTP. Пример приложения Hello ссылки в этой статье--hello **Демонстрация портала задания поиска Azure** — происходит toobe приложения ASP.NET MVC.

В образце hello фасетная Навигация встроено в hello страницы результатов поиска. Следующий пример, взяты из hello Hello `index.cshtml` файла образца приложения hello, структура hello статических показано HTML для отображения фасетная Навигация hello поиск на страницы результатов. Список Hello аспектов строятся или перестраиваются динамически, после отправки условия поиска, или установите или снимите аспекта.

```html
<div class="widget sidebar-widget jobs-filter-widget">
  <h5 class="widget-title">Filter Results</h5>
    <p id="filterReset"></p>
    <div class="widget-content">

      <h6 id="businessTitleFacetTitle">Business Title</h6>
      <ul class="filter-list" id="business_title_facets">
      </ul>

      <h6>Location</h6>
      <ul class="filter-list" id="posting_type_facets">
      </ul>

      <h6>Posting Type</h6>
      <ul class="filter-list" id="posting_type_facets"></ul>

      <h6>Minimum Salary</h6>
      <ul class="filter-list" id="salary_range_facets">
      </ul>

  </div>
</div>
```

Здравствуйте, следующий фрагмент кода hello `index.cshtml` страницы динамически создает hello HTML toodisplay hello первый аспекта, название организации. Другие аспекты hello HTML для hello динамически создавать аналогичные функции. Каждый аспект имеет метку и счетчика, отображающий hello число элементов, найденных для этого аспекта результата.

```js
function UpdateBusinessTitleFacets(data) {
  var facetResultsHTML = '';
  for (var i = 0; i < data.length; i++) {
    facetResultsHTML += '<li><a href="javascript:void(0)" onclick="ChooseBusinessTitleFacet(\'' + data[i].Value + '\');">' + data[i].Value + ' (' + data[i].Count + ')</span></a></li>';
  }

  $("#business_title_facets").html(facetResultsHTML);
}
```

> [!TIP]
> При проектировании страницы результатов поиска hello помните tooadd механизм очистки аспектов. При добавлении флажки, можно легко увидеть, как фильтры tooclear hello. Для других структур может понадобиться шаблон навигации или другой нестандартный элемент. Например, в hello портала поиска заданий образец приложения, можно щелкнуть hello `[X]` после аспект hello tooclear выбранного аспекта.

<a name="buildquery"></a>

## <a name="build-hello-query"></a>Построить запрос hello
Hello код, написанный для построения запросов должен указывать, что все части допустимый запрос, включая выражения поиска, аспекты, фильтры, оценки профили — что-либо использовать tooformulate запрос. В этом разделе мы расскажем, где аспекты помещаются в запрос и использование фильтров с toodeliver аспекты понижение результирующего набора.

Обратите внимание, что фасеты являются неотъемлемой частью этого примера приложения. возможности поиска Hello в hello Демонстрация портала задания построена фасетная навигация и фильтры. Hello Показательным размещение фасетная Навигация на странице приветствия демонстрирует его значимость. 

Например, часто toobegin лучше всего. Следующий пример, взяты из hello Hello `JobsSearch.cs` файл построений, в запросе, создающем навигации аспекта, основываясь на название организации, расположение, тип учета и минимум заработной платы. 

```cs
SearchParameters sp = new SearchParameters()
{
  ...
  // Add facets
  Facets = new List<String>() { "business_title", "posting_type", "level", "salary_range_from,interval:50000" },
};
```

Аспект параметра запроса устанавливается tooa поле и в зависимости от типа данных hello, параметризации могут использоваться дополнительные разделенный запятыми список, включающий `count:<integer>`, `sort:<>`, `interval:<integer>`, и `values:<list>`. Список значений, создаваемый при настройке диапазонов, поддерживает числовые данные. Дополнительные сведения об использовании см. в статье [Поиск документов (API REST службы поиска Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).

Вместе с аспектами hello запрос создан для приложения также должны использовать фильтры toonarrow вниз hello набор документов-кандидатов на основе выделения значение аспекта. Магазина велосипедов, фасетная Навигация доступны, такие как подсказки tooquestions *какие цвета, производители и типов велосипедов доступны?*. Используя фильтрацию, вы можете найти, к примеру, *горные велосипеды красного цвета в указанном ценовом диапазоне*. При нажатии кнопки tooindicate «Red», которое будет отображаться только продукты красного, отправляет hello Далее приложения hello запроса включает `$filter=Color eq ‘Red’`.

Здравствуйте, следующий фрагмент кода hello `JobsSearch.cs` страницы добавляется фильтр toohello hello выбран название организации, если выбрать значение аспекта hello название организации.

```cs
if (businessTitleFacet != "")
  filter = "business_title eq '" + businessTitleFacet + "'";
```

<a name="tips"></a> 

## <a name="tips-and-best-practices"></a>Советы и рекомендации

### <a name="indexing-tips"></a>Советы по индексированию
**Повышение эффективности индекса, если не используется поле поиска**

Если приложение использует фасетная Навигация в монопольном режиме (то есть не поле поиска), можно пометить поле hello как `searchable=false`, `facetable=true` tooproduce более компактным индекса. Кроме того индексирование выполняется только на весь аспекта значений, в которых нет разбиения или индексирования hello составных частей значения нескольких слов.

**Определение полей, которые можно использовать в качестве аспектов**

Помните, что hello схемы индекса hello определяет поля, доступные toouse как аспект. Предположим, что поле является facetable, запрос hello указывает toofacet какие поля по. поле Hello, с помощью которого вы являетесь аспекты включает hello значений, которые отображаются под названием hello. 

Hello значения, которые отображаются в каждой метке извлекаются из индекса hello. Например, если hello поле аспект является *цвет*, возможные значения hello дополнительной фильтрации: hello значений для этого поля - красный, черный и т. д.

Для числовых и DateTime только значения, можно явно задать значения в поле аспекта hello (например, `facet=Rating,values:1|2|3|4|5`). Список значений допустим для этих полей типов toosimplify hello разделение результатах аспекта в смежных диапазоны (либо диапазоны на основании числовых значений или периодам времени). 

**По умолчанию можно использовать только один уровень фасетной навигации** 

Как уже упоминалось, фасеты невозможно непосредственно вкладывать в иерархию. По умолчанию фасетная навигация в службе поиска Azure поддерживает только один уровень фильтров. Однако это ограничение можно обойти. Вы можете кодировать иерархическую структуру фасета в `Collection(Edm.String)` с одной точкой входа для одной иерархии. Реализации этого способа выходит за рамки данной статьи hello. 

### <a name="querying-tips"></a>Советы по выполнению запросов
**Проверка полей**

При построении hello список аспектов динамически, основываясь на входе недоверенному пользователю Проверьте правильность hello имена полей аспекта hello. Или, при формировании URL-адресов с помощью escape-имена hello `Uri.EscapeDataString()` в .NET или эквивалента в вашей платформе hello.

### <a name="filtering-tips"></a>Советы по фильтрации
**Повышение точности поиска с помощью фильтров**

Используйте фильтры. Если вы полагаетесь на просто выражения поиска, сама по себе, морфологический поиск может привести к toobe документа вернул, не содержащее значение аспекта точный hello в любом из его полей.

**Повышение производительности поиска с помощью фильтров**

Фильтры сузить hello набор документов-кандидатов для поиска и исключить их из ранжирования. Если у вас имеется большой набор документов, фасетная детализация с использованием выбранных фасетов часто повышает эффективность поиска.
  
**Фильтрация полей hello аспекта**

Фасетная перехода, обычно требуется tooonly документы, содержащие значение аспекта hello в определенные поля (аспекта), не в любом среди всех полей с возможностью поиска. Добавление фильтра для более глубокого hello целевого поля, предложив hello toosearch службы только в поля аспекта hello для соответствующего значения.

**Обрезание результатов аспекта с помощью дополнительных фильтров**

Аспект результаты являются документами, найдено в результатах поиска hello, соответствующими условиям аспекта. В следующий пример, в результатах поиска для hello *облачные вычисления*, 254 элементы также имеют *внутренней спецификации* как тип содержимого. Элементы не обязательно взаимно исключают друг друга. Если элемент соответствует критериям hello оба фильтра, то она учитывается в каждом из них. Это дублирование возможна, если аспекты на `Collection(Edm.String)` полей, которые часто используются tooimplement тегов документа.

        Search term: "cloud computing"
        Content type
           Internal specification (254)
           Video (10) 

Как правило Если обнаружится, что результаты аспекта постоянно слишком велики, мы рекомендуем добавить более фильтрует пользователей toogive Дополнительные параметры для сокращения hello поиска.

### <a name="tips-about-result-count"></a>Советы по числу результатов

**Максимальное число элементов в области навигации аспекта hello hello**

Для каждого поля аспекта в дереве навигации hello имеется ограничение по умолчанию, равное 10 значений. Это значение по умолчанию имеет смысл для навигации структур, так как он сохраняет значения hello контролируемым размером tooa список. По умолчанию hello можно переопределить путем назначения toocount значение.

* `&facet=city,count:5`Указывает, что только hello первые пять городов в hello высокоприоритетных результаты возвращаются в виде результата аспекта. Предположим, вы задали условие поиска airport (аэропорт) и получили 32 совпадения. Если запрос hello указывает `&facet=city,count:5`только первые пять уникальных городов hello с hello большинство документов в результатах поиска hello включаются в hello результатах аспекта.

Обратите внимание hello различие между результатов поиска и результатах аспекта. Результаты поиска будут все документы hello, соответствующих запросу hello. Аспект результаты будут hello совпадений для каждого значения аспекта. В примере hello результаты поиска включают названия городов, не входящие в список классификаций аспекта hello (5 в нашем примере). Результаты, которые фильтруются посредством фасетной навигации, отображаются пользователям, когда они удаляют фасеты или выбирают другие фасеты помимо City (Город). 

> [!NOTE]
> Если имеются фасеты несколько типов, параметр `count` может привести к отображению различных данных. Hello Следующая таблица содержит краткий обзор использования термина hello в API поиска Azure, образец кода и документации. 

* `@colorFacet.count`<br/>
  В коде презентации вы увидите параметр счетчика для аспекта hello, число используемых toodisplay hello аспекта результатов. В результатах аспекта число обозначает hello количество документов, которые соответствуют термин аспекта hello или диапазон.
* `&facet=City,count:12`<br/>
  В запроса аспекта можно задать значение tooa числа.  по умолчанию Hello 10, но можно задать его выше или ниже. Параметр `count:12` возвращает hello рангом 12 в результатах аспекта по количеству документов.
* "`@odata.count`"<br/>
  В ответ на запрос hello это значение указывает hello количество найденных элементов в результатах поиска hello. В среднем больше, чем сумма всех результатах аспекта вместе, из-за наличия toohello элементов, соответствующих поисковому запросу hello, hello, однако совпадений значение аспекта.

**Получение числа результатов для аспекта**

При добавлении запроса аспекта tooa фильтра, может потребоваться tooretain hello аспекта инструкции (например, `facet=Rating&$filter=Rating ge 4`). С технической точки зрения аспекта = оценки не требуется, но его возвращает счетчики hello аспекта значений для оценки, 4 и более поздних версий. Например, если после нажатия кнопки «4» Здравствуйте, запрос содержит фильтр для больше или равно слишком «4», возвращаются числа для каждой оценки, 4 и более поздних версий.  

**Обеспечение точного числа результатов для аспекта**

При определенных обстоятельствах может выясниться, что счетчики аспекта не совпадают hello результирующих наборов (см. [Фасетная Навигация в поиске Azure (сообщение на форуме)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).

Количество аспект может быть неточной из-за toohello архитектуру сегментирования. Каждый индекс поиска имеет несколько сегментов, и каждый сегмент сообщает hello N основных аспектов по количеству документов, который затем объединяются в единый результат. У некоторых сегментов множество совпадающих значений, тогда как другие содержат меньшее число, возможно, некоторые значения аспекта отсутствуют или в группе подсчет количества результатов hello.

Несмотря на то, что это поведение можно изменить в любое время, если сегодня возникновение такой ситуации, можно обойти ее, искусственно дало бы ошибку счетчик hello:<number> tooa большое число tooenforce полный отчетов от каждого сегмента. Если hello значение счетчика: больше или равно toohello числом уникальных значений в поле hello гарантируется точные результаты. Однако если имеется очень много документов, производительность снижается, поэтому выполняйте эти действия рассудительно.

### <a name="user-interface-tips"></a>Советы по пользовательскому интерфейсу
**Используя фасетную навигацию, добавляйте метки для всех полей.**

Метки обычно определяются в форме или hello HTML (`index.cshtml` в пример приложения hello). В службе поиска Azure не предусмотрен интерфейс API для работы с метками фасетной навигации или другими метаданными.

<a name="rangefacets"></a>

## <a name="filter-based-on-a-range"></a>Фильтрация по диапазону значений
В приложениях поиска часто используется фасетная навигация на основе диапазонов значений. Поддерживаются диапазоны числовых данных, а также значений даты и времени. Каждый подход подробно описан в [статье, посвященной поиску документов с помощью интерфейса API службы поиска Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).

Служба поиска Azure упрощает создание диапазонов, обеспечивая два способа их вычисления. Для обоих подходов поиска Azure создает hello соответствующие диапазоны, на основе hello входных данных, предоставленных вами. Например, если указать диапазон значений 10|20|30, будут автоматически созданы диапазоны 0–10, 10–20, 20–30–10, 10–20 и 20–30. Приложение может при необходимости удалить все пустые интервалы. 

**Способ 1: Используйте параметр интервала hello**  
аспекты цены tooset с приращением 10 долларов США, необходимо указать:`&facet=price,interval:10`

**Способ 2. Использование списка значений**  
Для числовых данных можно использовать список значений.  Рассмотрим hello аспекта диапазона для `listPrice` поля, преобразован следующим образом:

  ![Пример списка значений][5]

toospecify диапазона аспекта, например hello в предшествующих снимок экрана приветствия используйте список значений:

    facet=listPrice,values:10|25|100|500|1000|2500

Каждый диапазон строится с помощью 0 в качестве отправной точки, значения из списка hello в качестве конечной точки и затем обрезаются hello предыдущих toocreate дискретные интервалы. Служба поиска Azure выполняет эти действия в рамках фасетной навигации. У вас toowrite код для структуризации каждого интервала.

### <a name="build-a-filter-for-a-range"></a>Создание фильтра для диапазона
toofilter документов на основе выбора диапазона, можно использовать hello `"ge"` и `"lt"` операторы в выражении двух частей, которое определяет конечные точки hello hello диапазона фильтров. Например, при выборе hello диапазон 10-25 `listPrice` поле фильтра hello бы `$filter=listPrice ge 10 and listPrice lt 25`. В примере кода hello использует выражение фильтра hello **priceFrom** и **priceTo** параметры tooset hello, конечные точки. 

  ![Запрос для диапазона значений][6]

<a name="geofacets"></a> 

## <a name="filter-based-on-distance"></a>Фильтрация по расстоянию
Общие toosee фильтры, помогающие выбрать магазина, ресторана или назначения, в зависимости от текущего расположения tooyour близости. Хотя фильтр такого типа похож на фасетную навигацию, он является всего лишь обычным фильтром. Этот вопрос упоминается здесь для пользователей, которым нужно решить проблему с реализацией этого компонента.

Поиск Azure поддерживает две геопространственные функции: **geo.distance** и **geo.intersects**.

* Hello **geo.distance** функция возвращает hello расстояния в километрах между двумя точками. Одна точка — это поле, а другой — константа, переданная как часть фильтра hello. 
* Hello **geo.intersects** функция возвращает значение true, если заданная точка находится в пределах заданного многоугольника. Hello точка — это поле и hello многоугольник задается как константа список координаты, переданная как часть фильтра hello.

Примеры фильтров приведены в статье [Синтаксис выражений OData для поиска Azure](http://msdn.microsoft.com/library/azure/dn798921.aspx).

<a name="tryitout"></a>

## <a name="try-hello-demo"></a>Повторите Демонстрация hello
Hello задания портала Azure поиска Демонстрация примеры hello в этой статье.

-   . В разделе и тестирования hello рабочего образца через Интернет в [Демонстрация портала задания поиска Azure](http://azjobsdemo.azurewebsites.net/).

-   Загружать код hello из hello [Azure примерами в репозитории на GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).

При работе с результатами поиска, просмотра hello URL-адрес для изменения структуры запроса. Это приложение происходит toohello аспекты tooappend URI, по мере выбора каждого из них.

1. функциональность сопоставления hello toouse нашего примера приложения hello, получение ключа Bing Maps из hello [Центр разработчиков Bing Maps](https://www.bingmapsportal.com/). Вставьте его поверх существующего ключа hello в hello `index.cshtml` страницы. Hello `BingApiKey` в hello `Web.config` файл не используется. 

2. Запустите приложение hello. Ознакомьтесь с необязательным hello или закрыть диалоговое окно «hello».
   
3. Введите условие поиска, такие как «аналитика» и щелкните значок поиска hello. Hello запрос выполняется быстро.
   
   Структура фасетная Навигация также возвращается с результатами поиска hello. На странице результатов поиска hello структура фасетная Навигация hello включает счетчики для каждого результата аспекта. Фасеты не выбраны, поэтому возвращаются все соответствующие результаты.
   
   ![Результаты поиска до выбора фасетов][11]

4. Щелкните фасеты Business Title (Должность в компании), Location (Расположение) или Minimum Salary (Минимальная заработная плата). Аспекты были значение null у первоначального поискового hello, но, как они принимают значения, результаты поиска hello усекаются элементов, которые не соответствуют.
   
   ![Результаты поиска после выбора фасетов][12]

5. результат запроса tooclear hello, попробуйте выполнить другой запрос поведения, щелкните hello `[X]` после hello аспекты tooclear hello аспектов.
   
<a name="nextstep"></a>

## <a name="learn-more"></a>Подробнее
Просмотрите видео [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410) (Подробный обзор Поиска Azure). 45:25, отсутствует на демонстрацию о том, как tooimplement аспектов.

Дополнительные сведения о принципах разработки фасетная Навигация рекомендуется hello ссылкам:

* [Разработка решения для поиска с использованием фасетов](http://www.uie.com/articles/faceted_search/)
* [Шаблоны разработки: фасетная навигация](http://alistapart.com/article/design-patterns-faceted-navigation)


<!--Anchors-->
[How toobuild it]: #howtobuildit
[Build hello presentation layer]: #presentationlayer
[Build hello index]: #buildindex
[Check for data quality]: #checkdata
[Build hello query]: #buildquery
[Tips on how toocontrol faceted navigation]: #tips
[Faceted navigation based on range values]: #rangefacets
[Faceted navigation based on GeoPoints]: #geofacets
[Try it out]: #tryitout

<!--Image references-->
[1]: ./media/search-faceted-navigation/azure-search-faceting-example.PNG
[2]: ./media/search-faceted-navigation/Facet-2-CSHTML.PNG
[3]: ./media/search-faceted-navigation/Facet-3-schema.PNG
[4]: ./media/search-faceted-navigation/Facet-4-SearchMethod.PNG
[5]: ./media/search-faceted-navigation/Facet-5-Prices.PNG
[6]: ./media/search-faceted-navigation/Facet-6-buildfilter.PNG
[7]: ./media/search-faceted-navigation/Facet-7-appstart.png
[8]: ./media/search-faceted-navigation/Facet-8-appbike.png
[9]: ./media/search-faceted-navigation/Facet-9-appbikefaceted.png
[10]: ./media/search-faceted-navigation/Facet-10-appTitle.png
[11]: ./media/search-faceted-navigation/faceted-search-before-facets.png
[12]: ./media/search-faceted-navigation/faceted-search-after-facets.png

<!--Link references-->
[Designing for Faceted Search]: http://www.uie.com/articles/faceted_search/
[Design Patterns: Faceted Navigation]: http://alistapart.com/article/design-patterns-faceted-navigation
[Create your first application]: search-create-first-solution.md
[OData expression syntax (Azure Search)]: http://msdn.microsoft.com/library/azure/dn798921.aspx
[Azure Search Adventure Works Demo]: https://azuresearchadventureworksdemo.codeplex.com/
[http://www.odata.org/documentation/odata-version-2-0/overview/]: http://www.odata.org/documentation/odata-version-2-0/overview/ 
[Faceting on Azure Search forum post]: ../faceting-on-azure-search.md?forum=azuresearch
[Search Documents (Azure Search API)]: http://msdn.microsoft.com/library/azure/dn798927.aspx

