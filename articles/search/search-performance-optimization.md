---
title: "вопросы производительности и оптимизации поиска aaaAzure | Документы Microsoft"
description: "Настройка производительности Поиска Azure и выбор оптимального масштаба"
services: search
documentationcenter: 
author: LiamCavanagh
manager: pablocas
editor: 
ms.assetid: 4d3cd864-29d2-4921-be0d-a3f1a819de46
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 05/01/2017
ms.author: liamca
ms.openlocfilehash: 725149ba32773ab6b4c9d4b441424aba78db7c42
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-search-performance-and-optimization-considerations"></a><span data-ttu-id="b4bc0-103">Рекомендации по производительности и оптимизации Поиска Azure</span><span class="sxs-lookup"><span data-stu-id="b4bc0-103">Azure Search performance and optimization considerations</span></span>
<span data-ttu-id="b4bc0-104">Значительные поисковый интерфейс является ключа toosuccess многих мобильных и веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-104">A great search experience is a key toosuccess for many mobile and web applications.</span></span> <span data-ttu-id="b4bc0-105">Из недвижимость tooused автомобиль рынков tooonline каталогов, быстрый поиск и соответствующие запросу результаты повлияет hello качества.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-105">From real estate, tooused car marketplaces tooonline catalogs, fast search and relevant results will affect hello customer experience.</span></span> <span data-ttu-id="b4bc0-106">Данный документ является предполагаемым toohelp, ознакомьтесь с рекомендациями для как hello tooget наиболее эффективно использовать службы поиска Azure, особенно для сложных сценариев с сложные требования к масштабируемости, поддержка нескольких языков или пользовательские ранжирования.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-106">This document is intended toohelp you discover best practices for how tooget hello most out of Azure Search, especially for advanced scenarios with sophisticated requirements for scalability, multi-language support, or custom ranking.</span></span>  <span data-ttu-id="b4bc0-107">Кроме того, в этом документе описаны внутренние механизмы и рассмотрены подходы, которые эффективно работают в реальных клиентских приложениях.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-107">In addition, this document outlines internals and covers approaches that work effectively in real-world customer apps.</span></span>

## <a name="performance-and-scale-tuning-for-search-services"></a><span data-ttu-id="b4bc0-108">Настройка производительности и масштабирования для служб поиска</span><span class="sxs-lookup"><span data-stu-id="b4bc0-108">Performance and scale tuning for Search services</span></span>
<span data-ttu-id="b4bc0-109">Не все используемые toosearch ядра, например Bing и Google и hello высокая производительность, они предоставляют.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-109">We are all used toosearch engines such as Bing and Google and hello high performance they offer.</span></span>  <span data-ttu-id="b4bc0-110">В результате, когда клиенты используют ваше мобильное или веб-приложение с функцией поиска, они ожидают подобных характеристик производительности.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-110">As a result, when customers use your search-enabled web or mobile application, they will expect similar performance characteristics.</span></span>  <span data-ttu-id="b4bc0-111">При оптимизации для повышения производительности поиска одним из оптимальных способов hello является toofocus на задержки — hello время, затрачиваемое toocomplete и возврат результатов запроса.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-111">When optimizing for search performance, one of hello best approaches is toofocus on latency, which is hello time a query takes toocomplete and return results.</span></span>  <span data-ttu-id="b4bc0-112">При оптимизации задержки при поиске важно следующее.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-112">When optimizing for search latency it is important to:</span></span>

1. <span data-ttu-id="b4bc0-113">Выберите целевой задержкой (или максимальное количество времени), запрос на поиск типичных требуемого toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-113">Pick a target latency (or maximum amount of time) that a typical search request should take toocomplete.</span></span>
2. <span data-ttu-id="b4bc0-114">Создайте и протестируйте эти курсы задержки реальными рабочими нагрузками для службы поиска с toomeasure реалистичный набор данных.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-114">Create and test a real workload against your search service with a realistic dataset toomeasure these latency rates.</span></span>
3. <span data-ttu-id="b4bc0-115">Начните с небольшое количество запросов в секунду (QPS) и продолжить число hello tooincrease, выполненных в тесте hello, пока целевой задержкой запроса hello задержки падает ниже hello.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-115">Start with a low number of queries per second (QPS) and continue tooincrease hello number executed in hello test until hello query latency drops below hello defined target latency.</span></span>  <span data-ttu-id="b4bc0-116">Это важные тестирования toohelp, спланируйте горизонтальное масштабирование по мере роста приложения в использовании.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-116">This is an important benchmark toohelp you plan for scale as your application grows in usage.</span></span>
4. <span data-ttu-id="b4bc0-117">По возможности повторно используйте подключения HTTP.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-117">Wherever possible, reuse HTTP connections.</span></span>  <span data-ttu-id="b4bc0-118">Если вы используете пакет SDK Azure Search .NET hello, это означает, следует использовать экземпляр или [SearchIndexClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchindexclient) экземпляром и если вы используете hello REST API, следует использовать один HttpClient.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-118">If you are using hello Azure Search .NET SDK, this means you should reuse an instance or [SearchIndexClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchindexclient) instance, and if you are using hello REST API, you should reuse a single HttpClient.</span></span>

<span data-ttu-id="b4bc0-119">При создании этих проверка рабочих нагрузок, существуют некоторые характеристики tookeep поиска Azure в виду.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-119">While creating these test workloads, there are some characteristics of Azure Search tookeep in mind:</span></span>

1. <span data-ttu-id="b4bc0-120">Это возможно, toopush поиска такого большого количества запросов за один раз, будет переполниться hello доступные ресурсы в службе поиска Azure.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-120">It is possible toopush so many search queries at one time, that hello resources available in your Azure Search service will be overwhelmed.</span></span>  <span data-ttu-id="b4bc0-121">В этом случае вы увидите коды ответов HTTP 503.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-121">When this happens, you will see HTTP 503 response codes.</span></span>  <span data-ttu-id="b4bc0-122">По этой причине это лучший toostart с различными диапазонами различия hello toosee запросов поиска курсов задержки при добавлении нескольких запросов на поиск.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-122">For this reason, it is best toostart with various ranges of search requests toosee hello differences in latency rates as you add more search requests.</span></span>
2. <span data-ttu-id="b4bc0-123">Передача содержимого tooAzure, которые влияют на поиск hello общую производительность и задержка hello службы поиска Azure.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-123">Uploading of content tooAzure Search will impact hello overall performance and latency of hello Azure Search service.</span></span>  <span data-ttu-id="b4bc0-124">Если ожидается, что toosend данных при выполнении поиска пользователей, это важные tootake этой рабочей нагрузки в учетной записи в тестах.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-124">If you expect toosend data while users are performing searches, it is important tootake this workload into account in your tests.</span></span>
3. <span data-ttu-id="b4bc0-125">Не каждый запрос поиска будет выполнять на hello же уровни производительности.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-125">Not every search query will perform at hello same performance levels.</span></span>  <span data-ttu-id="b4bc0-126">Например, поиск документа или предложение по поиску обычно будет выполняться быстрее, чем запрос со значительным количеством аспектов и фильтров.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-126">For example, a document lookup or search suggestion will typically perform faster than a query with a significant number of facets and filters.</span></span>  <span data-ttu-id="b4bc0-127">Это наиболее hello tootake различных запросов, которые предполагается, что toosee в учетной записи при построении тестов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-127">It is best tootake hello various queries you expect toosee into account when building your tests.</span></span>  
4. <span data-ttu-id="b4bc0-128">Вариант поисковых запросов важен, поскольку при выполнении постоянно hello же поиска запросов, кэширование данных производительности toomake начала выглядит лучше, чем они могут с помощью запроса более разнородных заданы.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-128">Variation of search requests is important because if you continually execute hello same search requests, caching of data will start toomake performance look better than it might with a more disparate query set.</span></span>

> [!NOTE]
> <span data-ttu-id="b4bc0-129">[Тестирование нагрузки Visual Studio](https://www.visualstudio.com/docs/test/performance-testing/run-performance-tests-app-before-release) является очень удобным способом tooperform вашего теста производительности тесты как с ее помощью можно tooexecute HTTP-запросов, чем потребовалось для выполнения запросов к поиска Azure и позволяет осуществлять параллельный запросов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-129">[Visual Studio Load Testing](https://www.visualstudio.com/docs/test/performance-testing/run-performance-tests-app-before-release) is a really good way tooperform your benchmark tests as it allows you tooexecute HTTP requests as you would need for executing queries against Azure Search and enables parallelization of requests.</span></span>
> 
> 

## <a name="scaling-azure-search-for-high-query-rates-and-throttled-requests"></a><span data-ttu-id="b4bc0-130">Масштабирование Поиска Azure для обработки высокой частоты запросов и регулируемых запросов</span><span class="sxs-lookup"><span data-stu-id="b4bc0-130">Scaling Azure Search for high query rates and throttled requests</span></span>
<span data-ttu-id="b4bc0-131">При получают слишком много регулируемые запросы или превышать целевой тарифы задержки загрузки запроса на повышение ставки toodecrease задержки могут быть одним из двух способов:</span><span class="sxs-lookup"><span data-stu-id="b4bc0-131">When you are receiving too many throttled requests or exceed your target latency rates from an increased query load, you can look toodecrease latency rates in one of two ways:</span></span>

1. <span data-ttu-id="b4bc0-132">**Увеличение реплики:** реплика является как копия разрешение запросов баланс tooload поиска Azure для hello несколько копий данных.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-132">**Increase Replicas:**  A replica is like a copy of your data allowing Azure Search tooload balance requests against hello multiple copies.</span></span>  <span data-ttu-id="b4bc0-133">Все Балансировка нагрузки и репликация данных между репликами управляется поиска Azure и hello число реплик, выделенные для службы в любое время можно изменить.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-133">All load balancing and replication of data across replicas is managed by Azure Search and you can alter hello number of replicas allocated for your service at any time.</span></span>  <span data-ttu-id="b4bc0-134">Можно выделить too12 реплик в стандартную службу поиска и 3 реплик службы Basic поиска.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-134">You can allocate up too12 replicas in a Standard search service and 3 replicas in a Basic search service.</span></span> <span data-ttu-id="b4bc0-135">Реплики может быть скорректирована, либо из hello [портал Azure](search-create-service-portal.md) или [PowerShell](search-manage-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-135">Replicas can be adjusted either from hello [Azure portal](search-create-service-portal.md) or [PowerShell](search-manage-powershell.md).</span></span>
2. <span data-ttu-id="b4bc0-136">**Повысьте уровень поиска**. Поиск Azure поставляется на [нескольких уровнях](https://azure.microsoft.com/pricing/details/search/), и каждый из них предлагает различные уровни производительности.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-136">**Increase Search Tier:**  Azure Search comes in a [number of tiers](https://azure.microsoft.com/pricing/details/search/) and each of these tiers offers different levels of performance.</span></span>  <span data-ttu-id="b4bc0-137">В некоторых случаях возможно этого уровня hello, на которые не может предоставить ставки достаточно низкой задержкой, даже в том случае, если израсходован реплик такого большого количества запросов.  В этом случае вы можете tooconsider, используя один из hello более высоких уровней поиска, такие как уровень hello S3 поиска Azure, который хорошо подходит для сценариев с большим количеством документов и рабочих нагрузок очень большое число запросов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-137">In some cases, you may have so many queries that hello tier you are on cannot provide sufficiently low latency rates, even when replicas are maxed out.  In this case, you may want tooconsider leveraging one of hello higher search tiers such as hello Azure Search S3 tier that is well suited for scenarios with large numbers of documents and extremely high query workloads.</span></span>

## <a name="scaling-azure-search-for-slow-individual-queries"></a><span data-ttu-id="b4bc0-138">Масштабирование Поиска Azure для медленных отдельных запросов</span><span class="sxs-lookup"><span data-stu-id="b4bc0-138">Scaling Azure Search for slow individual queries</span></span>
<span data-ttu-id="b4bc0-139">Другая причина, почему ставки задержка может быть медленным состоит из одного запроса занимает слишком много времени toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-139">Another reason why latency rates can be slow is from a single query taking too long toocomplete.</span></span>  <span data-ttu-id="b4bc0-140">В этом случае добавление реплик не понизит задержки.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-140">In this case, adding replicas will not improve latency rates.</span></span>  <span data-ttu-id="b4bc0-141">Доступны два варианта.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-141">For this case there are two options available:</span></span>

1. <span data-ttu-id="b4bc0-142">**Увеличьте число секций**. Секция представляет собой механизм разделения данных между дополнительными ресурсами.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-142">**Increase Partitions** A partition is a mechanism for splitting your data across extra resources.</span></span>  <span data-ttu-id="b4bc0-143">Поэтому при добавлении второй секции данные делятся на две части.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-143">For this reason, when you add a second partition, your data gets split into two.</span></span>  <span data-ttu-id="b4bc0-144">Третья секция разделит ваш индекс на три и т. д.  Это также приводит hello, в некоторых случаях медленных запросов выполняется быстрее из-за toohello параллелизации вычислений.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-144">A third partition splits your index into three, etc.  This also has hello effect that in some cases, slow queries will perform faster due toohello parallelization of computation.</span></span>  <span data-ttu-id="b4bc0-145">Существует ряд примеров, в которых распараллеливание было чрезвычайно эффективно при выполнении запросов, содержащих запросы с низкой селективностью.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-145">There are a few examples of where we have seen this parallelization work extremely well with queries that have low selectivity queries.</span></span>  <span data-ttu-id="b4bc0-146">Сюда входят запросы, задающие большое число документов или необходимости аспекты tooprovide подсчитывает через большое количество документов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-146">This consists of queries that match many documents or when faceting needs tooprovide counts over large numbers of documents.</span></span>  <span data-ttu-id="b4bc0-147">Так как она большой объем вычислений нужен релевантности hello tooscore hello документов или toocount hello количеством документов, для добавления дополнительных секций может помочь tooprovide дополнительных вычислений.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-147">Since there is a lot of computation needed tooscore hello relevancy of hello documents or toocount hello numbers of documents, adding extra partitions can help tooprovide additional computation.</span></span>  
   
   <span data-ttu-id="b4bc0-148">Может быть более 12 разделов в стандартную службу поиска и 1 раздела в службе поиска basic hello.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-148">There can be a maximum of 12 partitions in Standard search service and 1 partition in hello basic search service.</span></span>  <span data-ttu-id="b4bc0-149">Секции могут быть изменены из hello [портал Azure](search-create-service-portal.md) или [PowerShell](search-manage-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-149">Partitions can be adjusted either from hello [Azure portal](search-create-service-portal.md) or [PowerShell](search-manage-powershell.md).</span></span>
2. <span data-ttu-id="b4bc0-150">**Ограничение высокий уровень количества элементов поля:** поле большого количества элементов состоит из facetable или фильтруемых поля, со значительным числом уникальных значений и в результате его место занимает большую часть ресурсов toocompute результаты.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-150">**Limit High Cardinality Fields:** A high cardinality field consists of a facetable or filterable field that has a significant number of unique values, and as a result, takes a lot of resources toocompute results over.</span></span>   <span data-ttu-id="b4bc0-151">Например настройкой поля Product ID или описание поддерживает фильтрацию или facetable сделает для большого количества элементов потому, что большинство значений hello из документа toodocument являются уникальными.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-151">For example, setting a Product ID or Description field as facetable/filterable would make for high cardinality because most of hello values from document toodocument are unique.</span></span> <span data-ttu-id="b4bc0-152">По возможности ограничить количество hello полей большого количества элементов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-152">Wherever possible, limit hello number of high cardinality fields.</span></span>
3. <span data-ttu-id="b4bc0-153">**Увеличьте уровень поиска:** движении tooa выше уровня поиска Azure может быть другим способом tooimprove производительность медленных запросов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-153">**Increase Search Tier:**  Moving up tooa higher Azure Search tier can be another way tooimprove performance of slow queries.</span></span>  <span data-ttu-id="b4bc0-154">Более высокий уровень также предоставляет более быстрые процессоры и больше памяти, что может положительно повлиять на производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-154">Each higher tier also provides faster CPU’s and more memory which can have a positive impact on query performance.</span></span>

## <a name="scaling-for-availability"></a><span data-ttu-id="b4bc0-155">Масштабирование для обеспечения доступности</span><span class="sxs-lookup"><span data-stu-id="b4bc0-155">Scaling for availability</span></span>
<span data-ttu-id="b4bc0-156">Реплики не только уменьшают задержки при обработке запросов, но и могут обеспечить высокий уровень доступности.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-156">Replicas not only help reduce query latency but can also allow for high availability.</span></span>  <span data-ttu-id="b4bc0-157">С одной реплики следует ожидать периодического время простоя из-за перезагрузки tooserver после обновления программного обеспечения или для других событий обслуживания, которые будут внесены.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-157">With a single replica, you should expect periodic downtime due tooserver reboots after software updates or for other maintenance events that will occur.</span></span>  <span data-ttu-id="b4bc0-158">В результате является важным tooconsider приложению требуется высокий уровень доступности поисковых запросов (запросов) и записи (индексирования событий).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-158">As a result, it is important tooconsider if your application requires high availability of searches (queries) as well as writes (indexing events).</span></span>  <span data-ttu-id="b4bc0-159">Поиск Azure предоставляет параметры соглашения об уровне ОБСЛУЖИВАНИЯ на всех hello платной поиска предложений с hello следующие атрибуты.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-159">Azure Search offers SLA options on all hello paid search offerings with hello following attributes:</span></span>

* <span data-ttu-id="b4bc0-160">2 реплики для обеспечения высокой доступности рабочих нагрузок для чтения (запросов).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-160">2 replicas for high availability of read-only workloads (queries)</span></span>
* <span data-ttu-id="b4bc0-161">3 или более реплики для обеспечения высокой доступности рабочих нагрузок чтения и записи (запросов и индексирования).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-161">3 or more replicas for high availability of read-write workloads (queries and indexing)</span></span>

<span data-ttu-id="b4bc0-162">Дополнительные сведения об этой веб-сайте hello [соглашении об уровне обслуживания Azure поиска](https://azure.microsoft.com/support/legal/sla/search/v1_0/).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-162">For more details on this, please visit hello [Azure Search Service Level Agreement](https://azure.microsoft.com/support/legal/sla/search/v1_0/).</span></span>

<span data-ttu-id="b4bc0-163">Поскольку реплик копии данных, имеющих несколько реплик позволяет после перезагрузки компьютера toodo поиска Azure и обслуживания с одной реплики, одновременно поддерживая запрашивает toobe toocontinue выполняться hello другими репликами.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-163">Since replicas are copies of your data, having multiple replicas allows Azure Search toodo machine reboots and maintenance against one replica at a time while allowing queries toocontinue toobe executed against hello other replicas.</span></span>  <span data-ttu-id="b4bc0-164">По этой причине необходимо также tooconsider влияние перерыву hello запросы, которые теперь имеют toobe выполняться меньше одной копии данных hello.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-164">For that reason, you will also need tooconsider how this downtime may impact hello queries that now have toobe executed against one less copy of hello data.</span></span>

## <a name="scaling-geo-distributed-workloads-and-provide-geo-redundancy"></a><span data-ttu-id="b4bc0-165">Масштабирование геораспределенных рабочих нагрузок и обеспечение геоизбыточности</span><span class="sxs-lookup"><span data-stu-id="b4bc0-165">Scaling geo-distributed workloads and provide geo-redundancy</span></span>
<span data-ttu-id="b4bc0-166">Для географически распределенных рабочих нагрузок вы обнаружите, у пользователей, расположенный далеко от hello центра обработки данных, где службы поиска Azure высокоскоростных задержки.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-166">For geo-distributed workloads, you will find that users located far from hello data center where your Azure Search service is hosted will have higher latency rates.</span></span>  <span data-ttu-id="b4bc0-167">По этой причине часто бывает важные toohave поиска несколько служб в области, которые находятся в ближе близости toothese пользователей.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-167">For this reason, it is often important toohave multiple search services in regions that are in closer proximity toothese users.</span></span>  <span data-ttu-id="b4bc0-168">Поиск Azure в настоящее время не предоставить метод автоматических географическая репликация индексов поиска Azure по регионам, но существуют некоторые методы, которые можно использовать, можно сделать это tooimplement простой процесс и управлять ими.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-168">Azure Search does not currently provide an automated method of geo-replicating Azure Search indexes across regions, but there are some techniques that can be used that can make this process simple tooimplement and manage.</span></span> <span data-ttu-id="b4bc0-169">Они показаны на hello следующие несколько разделов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-169">These are outlined in hello next few sections.</span></span>

<span data-ttu-id="b4bc0-170">Hello цель набор географически распределенных служб поиска — toohave два или несколько индексов, доступных в два или несколько областей, где пользователь не будет направлено toohello службы поиска Azure, которая обеспечивает наименьшую задержку hello, как показано в этом примере:</span><span class="sxs-lookup"><span data-stu-id="b4bc0-170">hello goal of a geo-distributed set of search services is toohave two or more indexes available in two or more regions where a user will be routed toohello Azure Search service that provides hello lowest latency as seen in this example:</span></span>

   ![Перекрестные запросы к службам по региону][1]

### <a name="keeping-data-in-sync-across-multiple-azure-search-services"></a><span data-ttu-id="b4bc0-172">Синхронизация данных между несколькими службами Поиска Azure</span><span class="sxs-lookup"><span data-stu-id="b4bc0-172">Keeping data in sync across multiple Azure Search services</span></span>
<span data-ttu-id="b4bc0-173">Существует два варианта хранения распределенной службы поиска синхронизацию которых состоит из либо с помощью hello [индексатор поиска Azure](search-indexer-overview.md) или hello Push-API (также называется tooas hello [REST API поиска Azure](https://docs.microsoft.com/rest/api/searchservice/)).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-173">There are two options for keeping your distributed search services in sync which consist of either using hello [Azure Search Indexer](search-indexer-overview.md) or hello Push API (also referred tooas hello [Azure Search REST API](https://docs.microsoft.com/rest/api/searchservice/)).</span></span>  

### <a name="azure-search-indexers"></a><span data-ttu-id="b4bc0-174">Индексаторы Поиска Azure</span><span class="sxs-lookup"><span data-stu-id="b4bc0-174">Azure Search Indexers</span></span>
<span data-ttu-id="b4bc0-175">При использовании hello индексатор поиска Azure уже выполняется импорт изменений данных из центрального хранилища данных, таких как база данных SQL Azure или Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-175">If you are using hello Azure Search Indexer, you are already importing data changes from a central datastore such as Azure SQL DB or Azure Cosmos DB.</span></span> <span data-ttu-id="b4bc0-176">При создании нового поиска службы, можно просто создать новый индексатор поиска Azure для этой службы, toothis точки же хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-176">When you create a new search Service, you simply also create a new Azure Search Indexer for that service that points toothis same datastore.</span></span> <span data-ttu-id="b4bc0-177">Таким образом, каждый раз, когда поступают новые изменения в хранилище данных hello, они вновь будут проиндексирован hello различных индексаторов.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-177">That way, whenever new changes come into hello data store, they will then be indexed by hello various Indexers.</span></span>  

<span data-ttu-id="b4bc0-178">Ниже приведен пример этой архитектуры.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-178">Here is an example of what that architecture would look like.</span></span>

   ![Один источник данных с сочетаниями распределенного индексатора и службы][2]

### <a name="push-api"></a><span data-ttu-id="b4bc0-180">API Push</span><span class="sxs-lookup"><span data-stu-id="b4bc0-180">Push API</span></span>
<span data-ttu-id="b4bc0-181">Если вы используете hello Push API поиска Azure слишком[обновление содержимого в индекс поиска Azure](https://docs.microsoft.com/rest/api/searchservice/update-index), можно сохранить различными службами поиска синхронизацию с помощью принудительной отправки изменений служб поиска tooall всякий раз, когда требуется выполнить обновление.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-181">If you are using hello Azure Search Push API too[update content in your Azure Search index](https://docs.microsoft.com/rest/api/searchservice/update-index), you can keep your various search services in sync by pushing changes tooall search services whenever an update is required.</span></span>  <span data-ttu-id="b4bc0-182">При этом это toomake важно убедиться, что toohandle случаев, когда служба поиска tooone обновления не и успешного выполнения одного или нескольких обновлений.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-182">When doing this it is important toomake sure toohandle cases where an update tooone search service fails and one or more updates succeed.</span></span>

## <a name="leveraging-azure-traffic-manager"></a><span data-ttu-id="b4bc0-183">Использование диспетчера трафика Azure</span><span class="sxs-lookup"><span data-stu-id="b4bc0-183">Leveraging Azure Traffic Manager</span></span>
<span data-ttu-id="b4bc0-184">[Диспетчер трафика Azure](../traffic-manager/traffic-manager-overview.md) позволяет tooroute запросов toomultiple расположенный geo веб-сайтов, затем поддерживаемый несколько служб поиска Azure.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-184">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) allows you tooroute requests toomultiple geo-located websites that are then backed by multiple Azure Search Services.</span></span>  <span data-ttu-id="b4bc0-185">Одно из преимуществ hello диспетчера трафика является можно производить tooensure поиска Azure, что он доступен и маршрутизации пользователей служб поиска tooalternate hello события времени простоя.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-185">One advantage of hello Traffic Manager is that it can probe Azure Search tooensure that it is available and route users tooalternate search services in hello event of downtime.</span></span>  <span data-ttu-id="b4bc0-186">Кроме того если маршрутизация выполняется поиск запросы через веб-сайтов Azure, диспетчер трафика Azure позволяет tooload баланс случаях, когда веб-сайт hello копии, но не для поиска Azure.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-186">In addition, if you are routing search requests through Azure Web Sites, Azure Traffic Manager allows you tooload balance cases where hello Website is up but not Azure Search.</span></span>  <span data-ttu-id="b4bc0-187">Ниже приведен пример какие hello архитектуру, которая использует диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-187">Here is an example of what hello architecture that leverages Traffic Manager.</span></span>

   ![Перекрестные запросы к службам по региону с использованием диспетчера трафика][3]

## <a name="monitoring-performance"></a><span data-ttu-id="b4bc0-189">Мониторинг производительности</span><span class="sxs-lookup"><span data-stu-id="b4bc0-189">Monitoring performance</span></span>
<span data-ttu-id="b4bc0-190">Поиск Azure обеспечивает hello возможность tooanalyze и монитор hello производительность службы с помощью [аналитика трафика поиска (STA)](search-traffic-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-190">Azure Search offers hello ability tooanalyze and monitor hello performance of your service through [Search Traffic Analytics (STA)](search-traffic-analytics.md).</span></span> <span data-ttu-id="b4bc0-191">Через STA вы можете при необходимости войти hello поиска отдельных операций, а также учетную запись хранилища Azure сводные показатели tooan, затем можно обработать для анализа или визуализации Power BI.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-191">Through STA, you can optionally log hello individual search operations as well as aggregated metrics tooan Azure Storage account that can then be processed for analysis or visualized in Power BI.</span></span>  <span data-ttu-id="b4bc0-192">С помощью метрик STA можно просмотреть статистику производительности, например среднее количество запросов или время ответа на запрос.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-192">Using STA metrics, you can review performance statistics such as average number of queries or query response times.</span></span>  <span data-ttu-id="b4bc0-193">Кроме того ведение журнала hello операции можно toodrill в подробные сведения об операциях поиска.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-193">In addition, hello operation logging allows you toodrill into details of specific search operations.</span></span>

<span data-ttu-id="b4bc0-194">STA является ставки задержки ценным инструментом toounderstand с этой точки зрения поиска Azure.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-194">STA is a valuable tool toounderstand latency rates from that Azure Search perspective.</span></span>  <span data-ttu-id="b4bc0-195">Поскольку журнал метрики производительности запросов hello основаны на времени hello запрос выполняется toobe полностью обработан в поиске Azure (от hello времени это запрошенный toowhen отправкой), то может toouse этот toodetermine одинаковых проблемы задержки с hello службы поиска Azure параллельное или за пределами hello service, например, от задержки в сети.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-195">Since hello query performance metrics logged are based on hello time a query takes toobe fully processed in Azure Search (from hello time it is requested toowhen it is sent out), you are able toouse this toodetermine if latency issues are from hello Azure Search service side or outside of hello service, such as from network latency.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="b4bc0-196">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b4bc0-196">Next steps</span></span>
<span data-ttu-id="b4bc0-197">toolearn Дополнительные сведения о hello цены уровни и ограничения служб для каждого из них, в разделе [службы ограничения в поиске Azure](search-limits-quotas-capacity.md).</span><span class="sxs-lookup"><span data-stu-id="b4bc0-197">toolearn more about hello pricing tiers and services limits for each one, see [Service limits in Azure Search](search-limits-quotas-capacity.md).</span></span>

<span data-ttu-id="b4bc0-198">Посетите [планирования емкости](search-capacity-planning.md) toolearn Дополнительные сведения о сочетаниях секции и реплики.</span><span class="sxs-lookup"><span data-stu-id="b4bc0-198">Visit [Capacity planning](search-capacity-planning.md) toolearn more about partition and replica combinations.</span></span>

<span data-ttu-id="b4bc0-199">Дополнительные углубленной детализации на производительность и toosee некоторые демонстрации tooimplement Здравствуйте оптимизации, как описано в этом разделе можно отслеживать следующие видео hello:</span><span class="sxs-lookup"><span data-stu-id="b4bc0-199">For more drilldown on performance and toosee some demonstrations of how tooimplement hello optimizations discussed in this article, watch hello following video:</span></span>

> [!VIDEO https://channel9.msdn.com/Events/Microsoft-Azure/AzureCon-2015/ACON319/player]
> 
> 

<!--Image references-->
[1]: ./media/search-performance-optimization/geo-redundancy.png
[2]: ./media/search-performance-optimization/scale-indexers.png
[3]: ./media/search-performance-optimization/geo-search-traffic-mgr.png
