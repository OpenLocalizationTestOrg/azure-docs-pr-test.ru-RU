---
title: "aaaModeling Мультитенантность в поиске Azure | Документы Microsoft"
description: "Узнайте о распространенных шаблонах разработки мультитенантных приложений SaaS с использованием Поиска Azure."
services: search
manager: jhubbard
author: ashmaka
documentationcenter: 
ms.assetid: 72e9696a-553b-47dc-9e05-a82db0ebf094
ms.service: search
ms.devlang: NA
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 10/26/2016
ms.author: ashmaka
ms.openlocfilehash: dd46cda772d32566b9aaa18d407f12fdf178bd43
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="design-patterns-for-multitenant-saas-applications-and-azure-search"></a>Шаблоны разработки для мультитенантных приложений SaaS и Поиска Azure
Многопользовательского приложения, является hello же служб и возможностей tooany количество клиентов, которые не отображаются, и совместно использовать данные hello любым другим клиентом. В этом документе рассматриваются стратегии изоляции клиентов в мультитенантных приложениях на основе Поиска Azure.

## <a name="azure-search-concepts"></a>Основные понятия Поиска Azure
Как решение поиска как службы поиска Azure позволяет разработчикам tooadd широкие возможности поиска возникает tooapplications без управления любой инфраструктуры, и полезные советы при поиске. Данные отправлены toohello службы, а затем сохраняются в облаке hello. С помощью простых запросов toohello API поиска Azure, hello данных можно затем изменить и поиск. Общие сведения о службе hello можно найти в [в этой статье](http://aka.ms/whatisazsearch). Прежде чем обсуждать шаблоны проектирования, это важно toounderstand некоторые основные понятия в поиске Azure.

### <a name="search-services-indexes-fields-and-documents"></a>Службы поиска, индексы, поля и документы
При использовании службы поиска Azure, один подписывается tooa *службы поиска*. Как отправленный tooAzure поиска данных, он хранится в *индекс* в службе поиска hello. В одной службе может существовать множество индексов. toouse hello знакомых концепций баз данных службы поиска hello могут быть приравнены tooa базы данных, если индексы hello в службе могут быть приравнены tootables в базе данных.

Каждый индекс в службе поиска имеет свою собственную схему, которая определяется рядом настраиваемых *полей*. Данные в форме hello отдельных добавляется индекс поиска Azure tooan *документов*. Каждый документ должен быть загруженного tooa определенного индекса и должны соответствовать схеме индекса. При поиске данных с помощью поиска Azure, запросы полнотекстового поиска hello выдаются с определенного индекса.  toocompare toothose эти основные понятия базы данных, поля могут быть приравнены toocolumns в таблице и документы могут быть приравнены toorows.

### <a name="scalability"></a>Масштабируемость
Любой службы поиска Azure в hello Standard [ценовой категории](https://azure.microsoft.com/pricing/details/search/) можно масштабировать в два измерения: хранение и доступность.

* *Секции* можно добавить хранилище hello tooincrease службы поиска.
* *Реплики* можно добавить tooa службы tooincrease hello пропускную способность запросов, которые могут обрабатывать службы поиска.

Добавление и удаление разделов и реплик на позволит hello емкость hello toogrow службы поиска с объемом данных и трафика требований приложения hello hello. Чтобы для поиска службы tooachieve чтения [соглашения об уровне ОБСЛУЖИВАНИЯ](https://azure.microsoft.com/support/legal/sla/search/v1_0/), требует двух реплик. В порядок tooachieve службы для чтения и записи [соглашения об уровне ОБСЛУЖИВАНИЯ](https://azure.microsoft.com/support/legal/sla/search/v1_0/), требуется три реплики.

### <a name="service-and-index-limits-in-azure-search"></a>Ограничения служб и индексов в Поиске Azure
Несколько отличаются [ценовым категориям](https://azure.microsoft.com/pricing/details/search/) в поиске Azure, каждый из уровней hello имеет другие [ограничения и квоты](search-limits-quotas-capacity.md). Некоторые из этих ограничений подвергаются hello уровня обслуживания, некоторые являются на уровне индексов hello, а некоторые — на уровне секции hello.

|  | Basic | Standard1 | Standard2 | Standard3 | Standard3 HD |
| --- | --- | --- | --- | --- | --- |
| Максимальное число реплик на службу |3 |12 |12 |12 |12 |
| Максимальное число секций на службу |1 |12 |12 |12 |1 |
| Максимальное число единиц поиска ((число реплик) * (число секций)) на службу |3 |36 |36 |36 |36 (максимум 3 секции) |
| Максимальное число документов на службу |1 млн |180 млн |720 млн |1,4 млрд |600 млн |
| Максимальный объем хранилища на службу |2 ГБ |300 ГБ |1,2 ТБ |2,4 ТБ |600 ГБ |
| Максимальное число документов на секцию |1 млн |15 млн |60 млн |120 млн |200 млн |
| Максимальный объем хранилища на секцию |2 ГБ |25 ГБ |100 ГБ |200 ГБ |200 ГБ |
| Максимальное число индексов на службу |5 |50 |200 |200 |3000 (максимум 1000 индексов на секцию) |

#### <a name="s3-high-density"></a>S3, высокая плотность
В ценовой категории S3 поиска Azure имеется параметр для режима высокой плотности (HD) hello, разработанных специально для многопользовательских сценариев. Во многих случаях бывает необходимо toosupport большое количество небольших клиентов в одной службы tooachieve hello преимущества простоты и экономичности.

S3 HD позволяет hello toobe много небольших индексов упаковываются в группе управления hello службы единого поиска с торговыми hello tooscale возможность ожидания индексы, используя разделы для hello возможность toohost большего числа индексов в одной службы.

В частности S3 службе может быть между 1 и 200 индексы, которые может размещаться совместно too1.4 миллиардов документов. S3 HD на hello позволит другой стороны, tooonly отдельных индексов наверх too1 миллионов документов, но она может обрабатывать копирование индексов too1000 на секцию (вверх too3000 каждой службы) и документа общее число 200 миллионов на раздел (копирование too600 миллионов на службы).

## <a name="considerations-for-multitenant-applications"></a>Рекомендации для мультитенантных приложений
Многопользовательские приложения должны эффективно распространять ресурсы среди клиентов hello, сохраняя определенный уровень секретности hello различных клиентов. Существуют некоторые особенности при разработке hello архитектуры для такого приложения:

* *Изоляции клиентов:* разработчики приложений должны tootake tooensure соответствующие меры, не клиенты имеют доступ запрещен и нежелательных toohello доступа к данным других клиентов. Помимо hello точки зрения обеспечения конфиденциальности данных стратегии изоляции клиента требуется эффективное управление общими ресурсами и защиту от шумный соседей.
* *Стоимость облачных ресурсов.* Как и любое другое приложение, программные решения должны обладать конкурентоспособной ценой в составе мультитенантного приложения.
* *Простота операций:* при разработке многопользовательской архитектуры, hello влияние на операции приложения hello и сложности является важным аспектом. Поиск Azure реализует [соглашение об уровне обслуживания 99,9 %](https://azure.microsoft.com/support/legal/sla/search/v1_0/).
* *Глобальные занимаемое место:* многопользовательских приложений может потребоваться tooeffectively serve клиентов, которые распределяются по всему миру hello.
* *Масштабируемость:* разработчики приложений должны tooconsider, как они согласовать между обслуживание достаточно низкий уровень сложности и проектирование tooscale приложения hello с количеством клиентов и hello размер данных клиентов и Рабочая нагрузка.

Поиск Azure предлагает несколько границ, которые можно использовать tooisolate клиентов данных и рабочей нагрузки.

## <a name="modeling-multitenancy-with-azure-search"></a>Моделирование мультитенантности с использованием Поиска Azure
В случае hello многопользовательском сценарии разработчик приложения hello использует один или несколько служб поиска и разделить их клиентов между службами и индексы. При моделировании мультитенантного сценария для Поиска Azure применяется несколько распространенных шаблонов.

1. *Индекс на каждого клиента*. Каждый клиент имеет собственный индекс в службе поиска, используемой совместно с другими клиентами.
2. *Служба на каждого клиента*. Каждый клиент имеет собственную выделенную службу Поиска Azure, что обеспечивает высочайший уровень разделения данных и рабочих нагрузок.
3. *Сочетание обоих вариантов*. Более активным клиентам большого размера назначаются выделенные службы, а небольшим клиентам назначаются отдельные индексы в общих службах.

## <a name="1-index-per-tenant"></a>1. Индекс на каждого клиента
![Portrayal модели hello индекс для клиента](./media/search-modeling-multitenant-saas-applications/azure-search-index-per-tenant.png)

В модели с индексом на каждого клиента несколько клиентов занимают одну службу Поиска Azure, в которой у каждого клиента есть собственный индекс.

Это обеспечивает изоляцию данных клиентов, так как все запросы на поиск и операции с документами выполняются на уровне индекса в Поиске Azure. В уровне приложения hello имеется hello необходимость учета toodirect hello соответствующие индексы различных клиентов трафика toohello управление ресурсами на уровне службы hello распределяются по всем клиентам.

Ключевой атрибут модели hello индекс для клиента — возможность hello емкости hello toooversubscribe разработчика приложения hello службы поиска среди клиентов приложения hello. Если клиенты hello неравномерное распределение рабочей нагрузки, оптимальное сочетание hello клиенты могут распределяться по службы поиска индексирует tooaccommodate число очень активно, интенсивно клиентов для при обслуживании хвоста одновременно менее активных клиентов. компромисс Hello — невозможность hello hello модели toohandle ситуациях, когда каждый клиент одновременно высокой активностью.

Hello индекс для клиента модель предоставляет основу hello модель переменных затрат, где все службы поиска Azure приобретаемое авансовых и впоследствии заполнен с клиентами. Это позволяет назначить для пробных версий и учетные записи свободных toobe неиспользуемого пространства.

Для приложений с помощью глобальной памяти модель hello индекс для клиента не может быть наиболее эффективный hello. Если клиенты приложения распределены по всему миру hello, отдельная служба может потребоваться для каждого региона, в котором могут дублировать затраты по каждой из них.

Поиск Azure обеспечивает масштаб hello hello отдельных индексов и общее количество индексов toogrow hello. Если соответствующий ценовой уровень выбора разделы и реплики можно добавить toohello всей операции поиска службы при конкретному индексу, в службе hello становится слишком большим, с точки зрения хранилища или трафика.

Если общее число индексов hello становится слишком большим для одной службы, другая служба имеет tooaccommodate toobe подготовить hello новых клиентов. Если индексы имеют toobe перемещать между служб поиска по мере добавления новых служб, hello данным из индекса hello есть toobe, вручную скопированные из других один индекс toohello как поиск Azure не разрешено для индекса toobe перемещен.

## <a name="2-service-per-tenant"></a>2. Служба на каждого клиента
![Portrayal hello модели службы для клиента](./media/search-modeling-multitenant-saas-applications/azure-search-service-per-tenant.png)

В архитектуре со службой на каждого клиента каждый клиент имеет свою собственную службу поиска.

В этой модели приложения hello достигает hello максимальный уровень изоляции для его клиентов. Каждая служба имеет выделенное хранилище и пропускную способность для обработки запросов на поиск, а также отдельные ключи API.

Для приложений, где каждый клиент имеет большого объема или hello рабочей нагрузки содержит мало особенностей из клиента tootenant hello модели службы для клиента является эффективным выбором как ресурсы, не являются общими для различных клиентов рабочих нагрузок.

Службы, каждой модели клиента также предлагает преимущество hello прогнозируемый, фиксированную стоимость модели. Нет без предварительных инвестиций в службе поиска всего до toofill клиента, однако hello стоимость каждого клиента больше, чем модель индекс для клиента.

Hello модели службы для клиента является эффективным выбором для приложений с помощью глобальной памяти. С географически распределенными клиентами, это легко toohave службы каждого клиента в соответствующую область hello.

Hello трудности в масштабировании этот шаблон возникают, когда отдельными пользователями превышают их службы. Поиск Azure в настоящее время не поддерживает обновление hello в ценовой категории службы поиска, поэтому все данные новой службы tooa toobe вручную скопировать.

## <a name="3-mixing-both-models"></a>3. Совмещение обеих моделей
Еще один шаблон для моделирования мультитенантности подразумевает совмещение модели с индексом на каждый клиента и модели со службой на каждый клиент.

Смешиванием hello двух шаблонов, клиенты большого приложения может занимать выделенные службы во время hello долго заключительным фрагментом менее активно, более мелкие клиенты могут занимать индексов в общих служб. Эта модель обеспечивает hello наибольшее клиентов постоянно высокой производительности от службы hello продолжая tooprotect hello меньшего размера клиентов с любой шумный соседей.

Тем не менее, для реализации этой стратегии понадобится спрогнозировать, каким клиентам потребуется выделенная служба, а каким — индекс в общей службе. Возрастает сложность приложения hello необходимость toomanage оба этих мультитенантности моделей.

## <a name="achieving-even-finer-granularity"></a>Достижение большей степени детализации
Hello выше многопользовательских сценарии разработки шаблонов toomodel в поиске Azure предполагается универсальный области, где каждый клиент является весь экземпляр приложения. Однако иногда приложения могут обрабатывать несколько областей меньшего размера.

Если модели службы для клиента и индекс для клиента не слишком мало областей, это возможных toomodel tooachieve индекс еще более точно степень гранулярности.

toohave один индекс ведут себя по-разному для различных клиентских конечных точек, поле может быть добавлено tooan индекс, который задает определенное значение для каждого клиента можно. Каждый раз, клиент вызывает tooquery поиска Azure или изменить индекс, кода hello из клиентского приложения hello указывает hello соответствующее значение для этого поля с помощью поиска Azure [фильтра](https://msdn.microsoft.com/library/azure/dn798921.aspx) возможность во время выполнения запроса.

Этот метод может быть функции используется tooachieve отдельных учетных записей пользователей, отдельные уровни и даже полностью отдельных приложений.

> [!NOTE]
> Используя подход hello описанном выше tooconfigure tooserve один индекс hello релевантность клиентов влияет на результаты поиска. Релевантности поиска вычисляются на уровне индексов область, не области уровня клиента, поэтому данные всех клиентов будет включено в степени соответствия hello базовые статистические данные, такие как частота термина.
> 
> 

## <a name="next-steps"></a>Дальнейшие действия
Поиск Azure — привлекательным выбором для многих приложений [более подробные сведения о службе hello мощные возможности](http://aka.ms/whatisazsearch). При оценке hello, различными создавать шаблоны для многопользовательских приложений, рассмотрите возможность hello [различные ценовые категории](https://azure.microsoft.com/pricing/details/search/) и соответствующих hello [службы ограничения](search-limits-quotas-capacity.md) toobest адаптировать toofit поиска Azure рабочие нагрузки приложений и архитектуры для всех размеров.

Вопросы поиска Azure и сценариях для нескольких клиентов могут быть отправлены tooazuresearch_contact@microsoft.com.

