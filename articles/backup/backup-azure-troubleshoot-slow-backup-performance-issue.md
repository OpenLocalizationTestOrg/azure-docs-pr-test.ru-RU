---
title: "aaaTroubleshoot медленно резервного копирования файлов и папок в службе архивации Azure | Документы Microsoft"
description: "Предоставляет разрешение toohelp руководство диагностики hello причиной проблем с производительностью резервного копирования Azure"
services: backup
documentationcenter: 
author: genlin
manager: cshepard
editor: 
ms.assetid: e379180a-db13-4e0c-90e4-28e5dd6f5b14
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: genli
ms.openlocfilehash: 21d79bbd03c2706bc43fcc7c14020cffd6b919c7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-slow-backup-of-files-and-folders-in-azure-backup"></a>Устранение неполадок, связанных с низкой производительностью архивации файлов и папок в службе архивации Azure
Эта статья содержит рекомендации по устранению неполадок toohelp диагностике hello причиной низкой производительностью резервного копирования для файлов и папок при использовании резервного копирования Azure. При копировании файлов Azure Backup agent tooback hello, hello процесс резервного копирования может занять больше времени, чем ожидалось. Эта задержка может быть вызвано один или несколько из следующих hello:

* [Узких мест производительности на компьютере hello, который выполняется резервное копирование.](#cause1)
* [Другой процесс или антивирусная программа мешает hello процесс резервного копирования Azure.](#cause2)
* [Hello резервного копирования агент работает на виртуальной машине Azure (ВМ).](#cause3)  
* [Архивация большого количества файлов (нескольких миллионов)](#cause4)

Прежде чем начать, устранение неполадок, рекомендуется загрузить и установить hello [последнюю версию агента резервного копирования Azure](http://aka.ms/azurebackup_agent). Мы произвести toofix агента резервного копирования toohello частыми обновлениями различные проблемы, добавьте компоненты и повысить производительность.

Также настоятельно рекомендуется изучить hello [службы архивации Azure часто задаваемые вопросы о](backup-azure-backup-faq.md) toomake убедиться, что не возникли hello распространенные проблемы конфигурации.

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

<a id="cause1"></a>

## <a name="cause-performance-bottlenecks-on-hello-computer"></a>Причина: Узкие места производительности на компьютере hello
Узкие места на компьютере hello, который выполняется резервное копирование может привести к задержкам. Данные toosend доступную пропускную способность сети hello, могут возникать узкие места или Здравствуйте, например, toodisk tooread или записи возможности компьютера.

Windows предоставляет встроенное средство, которое называется [монитора производительности](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) toodetect (Perfmon) эти узкие места.

Ниже приведены некоторые счетчики производительности и диапазоны, которые могут оказаться полезными при обнаружении узких мест производительности для оптимизации архивации.

| Счетчик | Состояние |
| --- | --- |
| Логический диск (физический диск) — % времени простоя |• 100% простоя too50% простоя = Исправен</br>• 49% простоя too20% простоя = предупреждения или монитора</br>• простоя too0 19% % простоя = критическое состояние или из спецификации |
| Логический диск (физический диск) — среднее время выполнения операции чтения или записи на диске |• 0,001 ms too0.015 ms = Исправен</br>• 0.015 ms too0.025 ms = предупреждения или монитора</br>• 0,026 мс или больше — критическое или недопустимое состояние. |
| Логический диск (физический диск) — текущая длина очереди диска (для всех экземпляров) |80 запросов в течение более 6 минут |
| Память — байт в невыгружаемом пуле |• Потребление менее 60 % ресурсов пула — работоспособное состояние.<br>• 61% too80% пула потребляет = предупреждения или монитора</br>• Более 80 % — критическое или недопустимое состояние. |
| Память — байт в выгружаемом пуле |• Потребление менее 60 % ресурсов пула — работоспособное состояние.</br>• 61% too80% пула потребляет = предупреждения или монитора</br>• Более 80 % — критическое или недопустимое состояние. |
| Доступная память (МБ) |• 50 % свободной памяти или больше — работоспособное состояние.</br>• 25 % свободной памяти — состояние отслеживания.</br>• 10 % свободной памяти — состояние предупреждения.</br>• Менее 100 МБ или 5 % свободной памяти — критическое или недопустимое состояние. |
| Процессор — \% загруженности процессора (все экземпляры) |• Менее 60 % — работоспособное состояние.</br>• 61% too90% потребляет = монитор или предупреждение</br>• 91% too100% потребляет = критическое |

> [!NOTE]
> Если выяснится, что инфраструктура hello причиной hello, рекомендуется выполнить дефрагментацию дисков hello регулярно для повышения производительности.
>
>

<a id="cause2"></a>

## <a name="cause-another-process-or-antivirus-software-interfering-with-azure-backup"></a>Причина: на работу службы архивации Azure влияет другой процесс или антивирусная программа
Мы видели несколько экземпляров, где другие процессы в системе Windows hello снизиться производительность hello процесс агента Azure Backup. Например использовать агент Azure Backup hello и другой программы tooback копии данных, или если антивирусная программа и блокировка файлов toobe которого резервного копирования, hello несколько блокировок файлов может привести к конкуренции. В этом случае hello резервного копирования может завершиться ошибкой или hello задания может занять больше времени, чем ожидалось.

Здравствуйте, лучшие рекомендации в этом случае является tooturn off hello ли hello время резервного копирования для hello Azure Backup agent изменяет toosee другие программы резервного копирования. Как правило, убедившись, что нескольких заданий резервного копирования не выполняется то же время является достаточно tooprevent hello их влияния на друг с другом.

Антивирусные программы, рекомендуется исключить следующие hello файлов и расположений:

* процесс C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe;
* папки C:\Program Files\Microsoft Azure Recovery Services Agent\;
* Область временных файлов расположение (Если вы не используете hello стандартное расположение)

<a id="cause3"></a>

## <a name="cause-backup-agent-running-on-an-azure-virtual-machine"></a>Причина: агент службы архивации запущен на виртуальной машине Azure
Если вы используете hello агента резервного копирования на виртуальной Машине, будет работать медленнее, чем при запуске на физическом компьютере. Это происходит из-за ограничения tooIOPS.  Тем не менее производительность hello можно оптимизировать с помощью переключения hello дисков с данными, архивируемых tooAzure хранилище Premium. Мы работаем над исправления этой проблемы и исправление hello будут доступны в будущих выпусках.

<a id="cause4"></a>

## <a name="cause-backing-up-a-large-number-millions-of-files"></a>Причина: архивация большого количества файлов (нескольких миллионов)
Перемещение большого объема данных занимает больше времени, чем перемещение меньшего объема данных. В некоторых случаях связана время резервного копирования toonot только hello размер данных hello, но hello количество файлов или папок. Это особенно важно при миллионы небольших файлов (несколько байт tooa несколько килобайт) были созданы резервные копии.

Это происходит потому, что во время резервного копирования данных hello и переносит его tooAzure, Azure одновременно создания каталога файлов. В некоторых редких случаях операция с каталогом hello может занять больше времени, чем ожидалось.

следующие индикаторы Hello может помочь понять hello узким местом и соответствующим образом работать с hello дальнейшие действия:

* **Пользовательский Интерфейс отображается ход выполнения для передачи данных hello**. по-прежнему передаются данные Hello. пропускная способность сети Hello или hello размер данных вызывает задержки.
* **Пользовательский Интерфейс не отображается ход выполнения для передачи данных hello**. Привет Открыть журналы, расположенный Agent\Temp служб восстановления Azure C:\Microsoft, затем проверьте наличие hello FileProvider::EndData запись в журналы hello. Эта запись означает, что hello передача данных завершена, и происходит операция с каталогом hello. Не отменять hello задания резервного копирования. Вместо этого дождитесь немного больше toofinish операции каталога hello. Если hello проблема будет повторяться, обратитесь в службу [поддержки Azure](https://portal.azure.com/#create/Microsoft.Support).
