---
title: "Рекомендации по использованию хранилища данных SQL Azure | Документация Майкрософт"
description: "Рекомендации, которые следует учитывать при разработке решений для хранилища данных SQL Azure. Они помогут вам обеспечить эффективную работу."
services: sql-data-warehouse
documentationcenter: NA
author: shivaniguptamsft
manager: jhubbard
editor: 
ms.assetid: 7b698cad-b152-4d33-97f5-5155dfa60f79
ms.service: sql-data-warehouse
ms.devlang: NA
ms.topic: get-started-article
ms.tgt_pltfrm: NA
ms.workload: data-services
ms.custom: performance
ms.date: 10/31/2016
ms.author: shigu;barbkess
ms.openlocfilehash: c1fb0d8790d8c97ac45db02ac76403e7a80fae5d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="best-practices-for-azure-sql-data-warehouse"></a><span data-ttu-id="b0c92-104">Рекомендации по использованию хранилища данных SQL Azure</span><span class="sxs-lookup"><span data-stu-id="b0c92-104">Best practices for Azure SQL Data Warehouse</span></span>
<span data-ttu-id="b0c92-105">В этой статье содержится множество рекомендаций, которые помогут достичь оптимальной производительности хранилища данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b0c92-105">This article is a collection of many best practices that will help you to achieve optimal performance from your Azure SQL Data Warehouse.</span></span>  <span data-ttu-id="b0c92-106">Некоторые понятия, рассмотренные в этой статье, достаточно простые и понятные, но есть и понятия, предназначенные для более опытных пользователей, поэтому они рассмотрены лишь в общих чертах.</span><span class="sxs-lookup"><span data-stu-id="b0c92-106">Some of the concepts in this article are basic and easy to explain, other concepts are more advanced and we just scratch the surface in this article.</span></span>  <span data-ttu-id="b0c92-107">Здесь представлены основные рекомендации и сведения относительно важных моментов, которые следует учитывать при создании хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="b0c92-107">The purpose of this article is to give you some basic guidance and to raise awareness of important areas to focus as you build your data warehouse.</span></span>  <span data-ttu-id="b0c92-108">В каждом разделе содержится краткое описание определенных понятий и ссылки на статьи с более подробными сведениями.</span><span class="sxs-lookup"><span data-stu-id="b0c92-108">Each section introduces you to a concept and then point you to more detailed articles which cover the concept in more depth.</span></span>

<span data-ttu-id="b0c92-109">Если вы еще мало знакомы с хранилищем данных SQL Azure, некоторые разделы могут показаться вам очень сложными.</span><span class="sxs-lookup"><span data-stu-id="b0c92-109">If you are just getting started with Azure SQL Data Warehouse, do not let this article overwhelm you.</span></span>  <span data-ttu-id="b0c92-110">Разделы здесь в основном расположены в порядке важности.</span><span class="sxs-lookup"><span data-stu-id="b0c92-110">The sequence of the topics is mostly in the order of importance.</span></span>  <span data-ttu-id="b0c92-111">Если сперва вы уделите внимание нескольким первым основным понятиям, то будете подготовлены к дальнейшему материалу.</span><span class="sxs-lookup"><span data-stu-id="b0c92-111">If you start by focusing on the first few concepts, you'll be in good shape.</span></span>  <span data-ttu-id="b0c92-112">Набравшись опыта работы с хранилищем данных SQL, вы можете приступить к изучению следующих понятий.</span><span class="sxs-lookup"><span data-stu-id="b0c92-112">As you get more familiar and comfortable with using SQL Date Warehouse, come back and look at a few more concepts.</span></span>  <span data-ttu-id="b0c92-113">Вам не понадобится много времени, чтобы разобраться с этими вопросами.</span><span class="sxs-lookup"><span data-stu-id="b0c92-113">It won't take long for everything to make sense.</span></span>

## <a name="reduce-cost-with-pause-and-scale"></a><span data-ttu-id="b0c92-114">Снижение расходов за счет приостановки и масштабирования ресурсов</span><span class="sxs-lookup"><span data-stu-id="b0c92-114">Reduce cost with pause and scale</span></span>
<span data-ttu-id="b0c92-115">В хранилище данных SQL предоставляется возможность приостановить ресурсы, если вы их не используете. Счет выставляется только за используемые вычислительные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="b0c92-115">A key feature of SQL Data Warehouse is the ability to pause when you are not using it, which stops the billing of compute resources.</span></span>  <span data-ttu-id="b0c92-116">Еще одной ключевой возможностью выступает масштабирование ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-116">Another key feature is the ability to scale resources.</span></span>  <span data-ttu-id="b0c92-117">Приостановить работу и выполнить масштабирование ресурсов можно с помощью портала Azure или команд PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b0c92-117">Pausing and Scaling can be done via the Azure portal or through PowerShell commands.</span></span>  <span data-ttu-id="b0c92-118">Изучите эти возможности, так как они позволяют существенно снизить расходы на хранилище данных, когда оно не используется.</span><span class="sxs-lookup"><span data-stu-id="b0c92-118">Become familiar with these features as they can greatly reduce the cost of your data warehouse when it is not in use.</span></span>  <span data-ttu-id="b0c92-119">Чтобы сохранять постоянную доступность хранилища данных, вместо приостановки работы можно уменьшить его размер (до размера DW100).</span><span class="sxs-lookup"><span data-stu-id="b0c92-119">If you always want your data warehouse accessible, you may want to consider scaling it down to the smallest size, a DW100 rather than pausing.</span></span>

<span data-ttu-id="b0c92-120">Ознакомьтесь с дополнительными сведениями о [приостановке][Pause compute resources] и [возобновлении][Resume compute resources] использования вычислительных ресурсов, а также об их [масштабировании].</span><span class="sxs-lookup"><span data-stu-id="b0c92-120">See also [Pause compute resources][Pause compute resources], [Resume compute resources][Resume compute resources], [Scale compute resources].</span></span>

## <a name="drain-transactions-before-pausing-or-scaling"></a><span data-ttu-id="b0c92-121">Очистка транзакций перед приостановкой использования и масштабированием вычислительных ресурсов</span><span class="sxs-lookup"><span data-stu-id="b0c92-121">Drain transactions before pausing or scaling</span></span>
<span data-ttu-id="b0c92-122">В случае приостановки или масштабирования хранилища данных SQL, когда вы отправите запрос на приостановку или масштабирование, остальные ваши запросы будут отменены.</span><span class="sxs-lookup"><span data-stu-id="b0c92-122">When you pause or scale your SQL Data Warehouse, behind the scenes your queries are canceled when you initiate the pause or scale request.</span></span>  <span data-ttu-id="b0c92-123">Отмена типичного запроса SELECT выполняется очень быстро и почти не влияет на время, необходимое для приостановки работы или масштабирования экземпляра.</span><span class="sxs-lookup"><span data-stu-id="b0c92-123">Canceling a simple SELECT query is a quick operation and has almost no impact to the time it takes to pause or scale your instance.</span></span>  <span data-ttu-id="b0c92-124">Однако остановка транзакционных запросов, с помощью которых изменяются данные или их структура, занимает длительное время.</span><span class="sxs-lookup"><span data-stu-id="b0c92-124">However, transactional queries, which modify your data or the structure of the data, may not be able to stop quickly.</span></span>  <span data-ttu-id="b0c92-125">**Транзакционные запросы по определению должны полностью завершиться или выполнить откат изменений.**</span><span class="sxs-lookup"><span data-stu-id="b0c92-125">**Transactional queries, by definition, must either complete in their entirety or rollback their changes.**</span></span>  <span data-ttu-id="b0c92-126">На откат изменений, выполненных с помощью транзакционных запросов, требуется столько же времени (или даже больше), как и на выполнение самих изменений.</span><span class="sxs-lookup"><span data-stu-id="b0c92-126">Rolling back the work completed by a transactional query can take as long, or even longer, than the original change the query was applying.</span></span>  <span data-ttu-id="b0c92-127">Например, если отменить запрос на удаление строк, который уже выполняется в течение часа, системе понадобится столько же времени, чтобы вставить удаленные строки обратно.</span><span class="sxs-lookup"><span data-stu-id="b0c92-127">For example, if you cancel a query which was deleting rows and has already been running for an hour, it could take the system an hour to insert back the rows which were deleted.</span></span>  <span data-ttu-id="b0c92-128">Процесс приостановки работы и масштабирования ресурсов во время выполнения транзакционных запросов займет более длительное время, так как он не начнется, пока не будет выполнен откат изменений.</span><span class="sxs-lookup"><span data-stu-id="b0c92-128">If you run pause or scaling while transactions are in flight, your pause or scaling may seem to take a long time because pausing and scaling has to wait for the rollback to complete before it can proceed.</span></span>

<span data-ttu-id="b0c92-129">Дополнительные сведения см. в статьях [Транзакции в хранилище данных SQL][Understanding transactions] и [Оптимизация транзакций для хранилища данных SQL][Optimizing transactions].</span><span class="sxs-lookup"><span data-stu-id="b0c92-129">See also [Understanding transactions][Understanding transactions], [Optimizing transactions][Optimizing transactions]</span></span>

## <a name="maintain-statistics"></a><span data-ttu-id="b0c92-130">Обеспечение статистики</span><span class="sxs-lookup"><span data-stu-id="b0c92-130">Maintain statistics</span></span>
<span data-ttu-id="b0c92-131">В отличие от SQL Server, который автоматически обнаруживает и создает или обновляет статистику в столбцах, в хранилище данных SQL этот процесс необходимо выполнять самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="b0c92-131">Unlike SQL Server, which automatically detects and creates or updates statistics on columns, SQL Data Warehouse requires manual maintenance of statistics.</span></span>  <span data-ttu-id="b0c92-132">В будущем мы планируем решить эту проблему. Однако пока вам понадобится вести статистику, чтобы обеспечивать оптимизацию планов хранилища данных SQL.</span><span class="sxs-lookup"><span data-stu-id="b0c92-132">While we do plan to change this in the future, for now you will want to maintain your statistics to ensure that the SQL Data Warehouse plans are optimized.</span></span>  <span data-ttu-id="b0c92-133">Планы, созданные с помощью оптимизатора, зависят от доступной статистики.</span><span class="sxs-lookup"><span data-stu-id="b0c92-133">The plans created by the optimizer are only as good as the available statistics.</span></span>  <span data-ttu-id="b0c92-134">**Проще всего приступить к работе со статистикой, создав статистику для каждого столбца.**</span><span class="sxs-lookup"><span data-stu-id="b0c92-134">**Creating sampled statistics on every column is an easy way to get started with statistics.**</span></span>  <span data-ttu-id="b0c92-135">Не менее важно также обновлять статистику, так как данные могут быть существенно изменены.</span><span class="sxs-lookup"><span data-stu-id="b0c92-135">It's equally important to update statistics as significant changes happen to your data.</span></span>  <span data-ttu-id="b0c92-136">Рекомендуется выполнять обновление статистики ежедневно или после каждой загрузки.</span><span class="sxs-lookup"><span data-stu-id="b0c92-136">A conservative approach may be to update your statistics daily or after each load.</span></span>  <span data-ttu-id="b0c92-137">Однако всегда есть компромиссы между производительностью и затратами на создание и обновление статистики.</span><span class="sxs-lookup"><span data-stu-id="b0c92-137">There are always trade-offs between performance and the cost to create and update statistics.</span></span> <span data-ttu-id="b0c92-138">Если ведение статистики занимает слишком много времени, нужно выбирать отдельные столбцы, для которых необходимо создавать статистику, или столбцы, требующие частого обновления статистики.</span><span class="sxs-lookup"><span data-stu-id="b0c92-138">If you find it is taking too long to maintain all of your statistics, you may want to try to be more selective about which columns have statistics or which columns need frequent updating.</span></span>  <span data-ttu-id="b0c92-139">Например, можно ежедневно обновлять столбцы дат, в которые добавляются новые значения.</span><span class="sxs-lookup"><span data-stu-id="b0c92-139">For example, you might want to update date columns, where new values may be added, daily.</span></span> <span data-ttu-id="b0c92-140">**Статистику рекомендуется вести в столбцах, которые являются частью объединения, используются в предложении WHERE или GROUP BY**.</span><span class="sxs-lookup"><span data-stu-id="b0c92-140">**You will gain the most benefit by having statistics on columns involved in joins, columns used in the WHERE clause and columns found in GROUP BY.**</span></span>

<span data-ttu-id="b0c92-141">Дополнительные сведения см. в статьях [Управление статистикой таблиц в хранилище данных SQL][Manage table statistics], [CREATE STATISTICS (Transact-SQL)][CREATE STATISTICS] и [UPDATE STATISTICS (Transact-SQL)][UPDATE STATISTICS].</span><span class="sxs-lookup"><span data-stu-id="b0c92-141">See also [Manage table statistics][Manage table statistics], [CREATE STATISTICS][CREATE STATISTICS], [UPDATE STATISTICS][UPDATE STATISTICS]</span></span>

## <a name="group-insert-statements-into-batches"></a><span data-ttu-id="b0c92-142">Объединение инструкций INSERT в группы</span><span class="sxs-lookup"><span data-stu-id="b0c92-142">Group INSERT statements into batches</span></span>
<span data-ttu-id="b0c92-143">Одноразовую загрузку в небольшую таблицу или даже периодическую перезагрузку результатов поиска рекомендуется выполнять, используя такой синтаксис инструкции INSERT: `INSERT INTO MyLookup VALUES (1, 'Type 1')`.</span><span class="sxs-lookup"><span data-stu-id="b0c92-143">A one-time load to a small table with an INSERT statement or even a periodic reload of a look-up may perform just fine for your needs with a statement like `INSERT INTO MyLookup VALUES (1, 'Type 1')`.</span></span>  <span data-ttu-id="b0c92-144">Однако для загрузки тысяч или миллионов строк на протяжении дня одноэлементных инструкций INSERT может быть недостаточно.</span><span class="sxs-lookup"><span data-stu-id="b0c92-144">However, if you need to load thousands or millions of rows throughout the day, you might find that singleton INSERTS just can't keep up.</span></span>  <span data-ttu-id="b0c92-145">Вместо них можно создать процессы, которые будут записывать инструкции INSERT в файл и периодически загружать его.</span><span class="sxs-lookup"><span data-stu-id="b0c92-145">Instead, develop your processes so that they write to a file and another process periodically comes along and loads this file.</span></span>

<span data-ttu-id="b0c92-146">Дополнительные сведения см. в статье [Инструкция INSERT (Transact-SQL)][INSERT].</span><span class="sxs-lookup"><span data-stu-id="b0c92-146">See also [INSERT][INSERT]</span></span>

## <a name="use-polybase-to-load-and-export-data-quickly"></a><span data-ttu-id="b0c92-147">Быстрая загрузка и экспорт данных с помощью PolyBase</span><span class="sxs-lookup"><span data-stu-id="b0c92-147">Use PolyBase to load and export data quickly</span></span>
<span data-ttu-id="b0c92-148">Хранилище данных SQL поддерживает загрузку и экспорт данных при помощи нескольких инструментов, включая фабрику данных Azure, PolyBase и BCP.</span><span class="sxs-lookup"><span data-stu-id="b0c92-148">SQL Data Warehouse supports loading and exporting data through several tools including Azure Data Factory, PolyBase, and BCP.</span></span>  <span data-ttu-id="b0c92-149">При работе с данными небольшого объема, что не требует высокой производительности, можно использовать любой инструмент.</span><span class="sxs-lookup"><span data-stu-id="b0c92-149">For small amounts of data where performance isn't critical, any tool may be sufficient for your needs.</span></span>  <span data-ttu-id="b0c92-150">Однако для загрузки или экспорта данных большого объема, что требует высокой производительности, лучше всего использовать PolyBase.</span><span class="sxs-lookup"><span data-stu-id="b0c92-150">However, when you are loading or exporting large volumes of data or fast performance is needed, PolyBase is the best choice.</span></span>  <span data-ttu-id="b0c92-151">Этот инструмент использует архитектуру вычислений с массовым параллелизмом (MPP) хранилища данных SQL. Поэтому загрузка и экспорт данных с его помощью выполняется быстрее.</span><span class="sxs-lookup"><span data-stu-id="b0c92-151">PolyBase is designed to leverage the MPP (Massively Parallel Processing) architecture of SQL Data Warehouse and will therefore load and export data magnitudes faster than any other tool.</span></span>  <span data-ttu-id="b0c92-152">Загрузку данных с помощью PolyBase можно выполнить, используя команды CTAS или INSERT INTO.</span><span class="sxs-lookup"><span data-stu-id="b0c92-152">PolyBase loads can be run using CTAS or INSERT INTO.</span></span>  <span data-ttu-id="b0c92-153">**Команда CTAS позволяет свести к минимуму нагрузку ведения журнала транзакций и быстрее всего выполнить загрузку данных.**</span><span class="sxs-lookup"><span data-stu-id="b0c92-153">**Using CTAS will minimize transaction logging and the fastest way to load your data.**</span></span>  <span data-ttu-id="b0c92-154">Фабрика данных Azure также поддерживает загрузку данных с помощью PolyBase.</span><span class="sxs-lookup"><span data-stu-id="b0c92-154">Azure Data Factory also supports PolyBase loads.</span></span>  <span data-ttu-id="b0c92-155">PolyBase поддерживает различные форматы файлов, включая формат GZIP.</span><span class="sxs-lookup"><span data-stu-id="b0c92-155">PolyBase supports a variety of file formats including Gzip files.</span></span>  <span data-ttu-id="b0c92-156">**Чтобы максимально повысить пропускную способность при использовании текстовых файлов в формате GZIP, необходимо разбить файлы на 60 или больше частей. Это позволит достичь максимальной степени параллелизма загрузки.**</span><span class="sxs-lookup"><span data-stu-id="b0c92-156">**To maximize throughput when using gzip text files, break files up into 60 or more files to maximize parallelism of your load.**</span></span>  <span data-ttu-id="b0c92-157">Кроме того, для повышения общей пропускной способности можно загружать данные одновременно.</span><span class="sxs-lookup"><span data-stu-id="b0c92-157">For faster total throughput, consider loading data concurrently.</span></span>

<span data-ttu-id="b0c92-158">Дополнительные сведения см. в статьях [Загрузка данных в хранилище данных Azure SQL][Load data], [Руководство по использованию PolyBase в хранилище данных SQL][Guide for using PolyBase], [Azure SQL Data Warehouse loading patterns and strategies][Azure SQL Data Warehouse loading patterns and strategies] (Стратегии и шаблоны загрузки данных в хранилище данных SQL Azure), [Загрузка данных в хранилище данных SQL с помощью фабрики данных][Load Data with Azure Data Factory], [Перемещение данных в хранилище данных Azure SQL и из него с помощью фабрики данных Azure][Move data with Azure Data Factory], [Создание формата внешнего файла (Transact-SQL)][CREATE EXTERNAL FILE FORMAT] и [Функция Create Table As Select (CTAS) в хранилище данных SQL][Create table as select (CTAS)].</span><span class="sxs-lookup"><span data-stu-id="b0c92-158">See also [Load data][Load data], [Guide for using PolyBase][Guide for using PolyBase], [Azure SQL Data Warehouse loading patterns and strategies][Azure SQL Data Warehouse loading patterns and strategies], [Load Data with Azure Data Factory][Load Data with Azure Data Factory], [Move data with Azure Data Factory][Move data with Azure Data Factory], [CREATE EXTERNAL FILE FORMAT][CREATE EXTERNAL FILE FORMAT], [Create table as select (CTAS)][Create table as select (CTAS)]</span></span>

## <a name="load-then-query-external-tables"></a><span data-ttu-id="b0c92-159">Загрузка внешних таблиц и отправка запросов к ним</span><span class="sxs-lookup"><span data-stu-id="b0c92-159">Load then query external tables</span></span>
<span data-ttu-id="b0c92-160">Технология Polybase (т. н. внешние таблицы), возможно, является самым быстрым способом загрузки данных, но она не оптимальна с точки зрения запросов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-160">While Polybase, also known as external tables, can be the fastest way to load data, it is not optimal for queries.</span></span> <span data-ttu-id="b0c92-161">В настоящее время таблицы Polybase хранилища данных SQL поддерживают только файлы больших двоичных объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="b0c92-161">SQL Data Warehouse Polybase tables currently only support Azure blob files.</span></span> <span data-ttu-id="b0c92-162">Эти файлы не обслуживаются какими-либо вычислительными ресурсами.</span><span class="sxs-lookup"><span data-stu-id="b0c92-162">These files do not have any compute resources backing them.</span></span>  <span data-ttu-id="b0c92-163">Поэтому хранилище данных SQL не может разгрузить эту операцию, и ему требуется прочитать файл целиком, загрузив его в базу данных tempdb, чтобы считать данные.</span><span class="sxs-lookup"><span data-stu-id="b0c92-163">As a result, SQL Data Warehouse cannot offload this work and therefore must read the entire file by loading it to tempdb in order to read the data.</span></span>  <span data-ttu-id="b0c92-164">Таким образом, если будет отправлено несколько запросов к этим данным, то лучше один раз загрузить их в локальную таблицу и предоставить ее для выполнения запросов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-164">Therefore, if you have several queries that will be querying this data, it is better to load this data once and have queries use the local table.</span></span>

<span data-ttu-id="b0c92-165">Ознакомьтесь также с [руководством по использованию PolyBase][Guide for using PolyBase].</span><span class="sxs-lookup"><span data-stu-id="b0c92-165">See also [Guide for using PolyBase][Guide for using PolyBase]</span></span>

## <a name="hash-distribute-large-tables"></a><span data-ttu-id="b0c92-166">Хэш-распределение больших таблиц</span><span class="sxs-lookup"><span data-stu-id="b0c92-166">Hash distribute large tables</span></span>
<span data-ttu-id="b0c92-167">По умолчанию таблицы распределяются по методу циклического перебора.</span><span class="sxs-lookup"><span data-stu-id="b0c92-167">By default, tables are Round Robin distributed.</span></span>  <span data-ttu-id="b0c92-168">Это позволяет упростить процесс создания таблиц, так как пользователям не нужно принимать решение о типе распределения.</span><span class="sxs-lookup"><span data-stu-id="b0c92-168">This makes it easy for users to get started creating tables without having to decide how their tables should be distributed.</span></span>  <span data-ttu-id="b0c92-169">Таблицы с распределением по методу циклического перебора могут вполне годиться для некоторых рабочих нагрузок, но в большинстве случаев намного эффективнее использовать столбец распределения.</span><span class="sxs-lookup"><span data-stu-id="b0c92-169">Round Robin tables may perform sufficiently for some workloads, but in most cases selecting a distribution column will perform much better.</span></span>  <span data-ttu-id="b0c92-170">Наглядно это превосходство можно увидеть при объединении больших таблиц фактов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-170">The most common example of when a table distributed by a column will far outperform a Round Robin table is when two large fact tables are joined.</span></span>  <span data-ttu-id="b0c92-171">Например, во время выполнения запроса на объединение таблицы Orders, распределенной по идентификатору order_id, с таблицей Transactions, распределенной по тому же идентификатору, этот запрос превращается в запрос к серверу, что исключает выполнение операций перемещения данных.</span><span class="sxs-lookup"><span data-stu-id="b0c92-171">For example, if you have an orders table, which is distributed by order_id, and a transactions table, which is also distributed by order_id, when you join your orders table to your transactions table on order_id, this query becomes a pass-through query, which means we eliminate data movement operations.</span></span>  <span data-ttu-id="b0c92-172">Чем меньше в запросе действий, тем быстрее он выполняется.</span><span class="sxs-lookup"><span data-stu-id="b0c92-172">Fewer steps mean a faster query.</span></span>  <span data-ttu-id="b0c92-173">Скорость выполнения запроса также зависит от объема перемещаемых данных.</span><span class="sxs-lookup"><span data-stu-id="b0c92-173">Less data movement also makes for faster queries.</span></span>  <span data-ttu-id="b0c92-174">В этом разделе представлены только общие сведения.</span><span class="sxs-lookup"><span data-stu-id="b0c92-174">This explanation just scratches the surface.</span></span> <span data-ttu-id="b0c92-175">При загрузке распределенной таблицы входящие данные не должны быть отсортированы по ключу распределения, так как это замедлит процесс загрузки.</span><span class="sxs-lookup"><span data-stu-id="b0c92-175">When loading a distributed table, be sure that your incoming data is not sorted on the distribution key as this will slow down your loads.</span></span>  <span data-ttu-id="b0c92-176">Ниже приведены ссылки на статьи, содержащие сведения о том, как с помощью столбца распределения можно улучшить производительность и как определить распределенную таблицу в предложение WITH инструкции CREATE TABLES.</span><span class="sxs-lookup"><span data-stu-id="b0c92-176">See the below links for much more details on how selecting a distribution column can improve performance as well as how to define a distributed table in the WITH clause of your CREATE TABLES statement.</span></span>

<span data-ttu-id="b0c92-177">Дополнительные сведения см. в статьях [Общие сведения о таблицах в хранилище данных SQL][Table overview], [Распределение таблиц в хранилище данных SQL][Table distribution], [Создание таблицы (хранилище данных Azure SQL)][CREATE TABLE] и [Создание TABLE AS SELECT (хранилище данных Azure SQL)][CREATE TABLE AS SELECT], а также в статье, посвященной [выбору распределения таблицы][Selecting table distribution].</span><span class="sxs-lookup"><span data-stu-id="b0c92-177">See also [Table overview][Table overview], [Table distribution][Table distribution], [Selecting table distribution][Selecting table distribution], [CREATE TABLE][CREATE TABLE], [CREATE TABLE AS SELECT][CREATE TABLE AS SELECT]</span></span>

## <a name="do-not-over-partition"></a><span data-ttu-id="b0c92-178">Недопущение избыточного секционирования</span><span class="sxs-lookup"><span data-stu-id="b0c92-178">Do not over-partition</span></span>
<span data-ttu-id="b0c92-179">Не смотря на то, что секционирование данных — это эффективный способ управления данными, который реализуется благодаря переключению секций или оптимизации сканирования путем исключения секций, наличие большого количества секций может повлиять на производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-179">While partitioning data can be very effective for maintaining your data through partition switching or optimizing scans by with partition elimination, having too many partitions can slow down your queries.</span></span>  <span data-ttu-id="b0c92-180">Стратегия разделения данных на большое количество секций, как правило, эффективна в SQL Server, но она не всегда работает в хранилище данных SQL.</span><span class="sxs-lookup"><span data-stu-id="b0c92-180">Often a high granularity partitioning strategy which may work well on SQL Server may not work well on SQL Data Warehouse.</span></span>  <span data-ttu-id="b0c92-181">Слишком большое количество секций снижает эффективность кластеризованных индексов Columnstore, если в секции содержится менее миллиона строк.</span><span class="sxs-lookup"><span data-stu-id="b0c92-181">Having too many partitions can also reduce the effectiveness of clustered columnstore indexes if each partition has fewer than 1 million rows.</span></span>  <span data-ttu-id="b0c92-182">Помните, что в хранилище данных SQL данные секционируются на 60 баз данных, поэтому при создании таблицы с 100 секциями фактически будет создана таблица с 6000 секций.</span><span class="sxs-lookup"><span data-stu-id="b0c92-182">Keep in mind that behind the scenes, SQL Data Warehouse partitions your data for you into 60 databases, so if you create a table with 100 partitions, this actually results in 6000 partitions.</span></span>  <span data-ttu-id="b0c92-183">Все рабочие нагрузки отличаются, поэтому рекомендуется поэкспериментировать с секционированием, чтобы выбрать наиболее подходящее количество секций для вашей рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="b0c92-183">Each workload is different so the best advice is to experiment with partitioning to see what works best for your workload.</span></span>  <span data-ttu-id="b0c92-184">В хранилище данных SQL можно использовать меньшее количество секций, чем в SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b0c92-184">Consider lower granularity than what may have worked for you in SQL Server.</span></span>  <span data-ttu-id="b0c92-185">Например, попробуйте использовать еженедельные или ежемесячные секции вместо ежедневных.</span><span class="sxs-lookup"><span data-stu-id="b0c92-185">For example, consider using weekly or monthly partitions rather than daily partitions.</span></span>

<span data-ttu-id="b0c92-186">Дополнительные сведения см. в статье [Секционирование таблиц в хранилище данных SQL][Table partitioning].</span><span class="sxs-lookup"><span data-stu-id="b0c92-186">See also [Table partitioning][Table partitioning]</span></span>

## <a name="minimize-transaction-sizes"></a><span data-ttu-id="b0c92-187">Уменьшение размера транзакций</span><span class="sxs-lookup"><span data-stu-id="b0c92-187">Minimize transaction sizes</span></span>
<span data-ttu-id="b0c92-188">Инструкции INSERT, UPDATE и DELETE выполняются в транзакциях. В случае сбоя их необходимо откатить.</span><span class="sxs-lookup"><span data-stu-id="b0c92-188">INSERT, UPDATE, and DELETE statements run in a transaction and when they fail they must be rolled back.</span></span>  <span data-ttu-id="b0c92-189">Чтобы сократить время выполнения отката, необходимо по возможности уменьшить размеры транзакций.</span><span class="sxs-lookup"><span data-stu-id="b0c92-189">To minimize the potential for a long rollback, minimize transaction sizes whenever possible.</span></span>  <span data-ttu-id="b0c92-190">Это можно сделать, разделив инструкции INSERT, UPDATE и DELETE на части.</span><span class="sxs-lookup"><span data-stu-id="b0c92-190">This can be done by dividing INSERT, UPDATE, and DELETE statements into parts.</span></span>  <span data-ttu-id="b0c92-191">Например, если на выполнение инструкции INSERT требуется 1 час, рекомендуется разделить ее на 4 части. Таким образом, каждая часть будет выполняться 15 минут.</span><span class="sxs-lookup"><span data-stu-id="b0c92-191">For example, if you have an INSERT which you expect to take 1 hour, if possible, break the INSERT up into 4 parts, which will each run in 15 minutes.</span></span>  <span data-ttu-id="b0c92-192">К пустым таблицам можно применять специальные операции, которые сопровождаются записью в журнал минимальных сведений, (такие как CTAS, TRUNCATE, DROP TABLE или INSERT), чтобы снизить риск отката.</span><span class="sxs-lookup"><span data-stu-id="b0c92-192">Leverage special Minimal Logging cases, like CTAS, TRUNCATE, DROP TABLE or INSERT to empty tables, to reduce rollback risk.</span></span>  <span data-ttu-id="b0c92-193">Устранить откаты также можно, используя для управления данными только операции с метаданными (например, переключение секций).</span><span class="sxs-lookup"><span data-stu-id="b0c92-193">Another way to eliminate rollbacks is to use Metadata Only operations like partition switching for data management.</span></span>  <span data-ttu-id="b0c92-194">Например, вместо выполнения инструкции DELETE для удаления всех строк в таблице, упорядоченной по идентификатору order_date (октябрь 2001 г.), данные можно секционировать ежемесячно, а потом переключить секцию с данными на пустую секцию из другой таблицы (см. примеры использования инструкции ALTER TABLE).</span><span class="sxs-lookup"><span data-stu-id="b0c92-194">For example, rather than execute a DELETE statement to delete all rows in a table where the order_date was in October of 2001, you could partition your data monthly and then switch out the partition with data for an empty partition from another table (see ALTER TABLE examples).</span></span>  <span data-ttu-id="b0c92-195">Используя инструкцию CTAS вместо DELETE, можно записать данные, которые необходимо сохранить в несекционированной таблице.</span><span class="sxs-lookup"><span data-stu-id="b0c92-195">For unpartitioned tables consider using a CTAS to write the data you want to keep in a table rather than using DELETE.</span></span>  <span data-ttu-id="b0c92-196">Если на выполнение этих двух инструкций требуется одинаковое количество времени, целесообразно использовать инструкцию CTAS, так как для ее выполнения необходима минимальная нагрузка ведения журнала транзакций, и ее можно быстро отменить.</span><span class="sxs-lookup"><span data-stu-id="b0c92-196">If a CTAS takes the same amount of time, it is a much safer operation to run as it has very minimal transaction logging and can be canceled quickly if needed.</span></span>

<span data-ttu-id="b0c92-197">Дополнительные сведения см. в статьях [Транзакции в хранилище данных SQL][Understanding transactions], [Оптимизация транзакций для хранилища данных SQL][Optimizing transactions], [Секционирование таблиц в хранилище данных SQL][Table partitioning], а также в статьях об инструкциях [TRUNCATE TABLE][TRUNCATE TABLE] и [ALTER TABLE][ALTER TABLE] и статье [Функция Create Table As Select (CTAS) в хранилище данных SQL][Create table as select (CTAS)].</span><span class="sxs-lookup"><span data-stu-id="b0c92-197">See also [Understanding transactions][Understanding transactions], [Optimizing transactions][Optimizing transactions], [Table partitioning][Table partitioning], [TRUNCATE TABLE][TRUNCATE TABLE], [ALTER TABLE][ALTER TABLE], [Create table as select (CTAS)][Create table as select (CTAS)]</span></span>

## <a name="use-the-smallest-possible-column-size"></a><span data-ttu-id="b0c92-198">Использование минимального размера столбца</span><span class="sxs-lookup"><span data-stu-id="b0c92-198">Use the smallest possible column size</span></span>
<span data-ttu-id="b0c92-199">При определении DDL рекомендуется использовать поддерживаемый тип данных с наименьшим размером. Это позволит повысить производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-199">When defining your DDL, using the smallest data type which will support your data will improve query performance.</span></span>  <span data-ttu-id="b0c92-200">Это особенно важно для столбцов CHAR и VARCHAR.</span><span class="sxs-lookup"><span data-stu-id="b0c92-200">This is especially important for CHAR and VARCHAR columns.</span></span>  <span data-ttu-id="b0c92-201">Если самое длинное значение в столбце состоит из 25 знаков, столбец необходимо определить как VARCHAR(25).</span><span class="sxs-lookup"><span data-stu-id="b0c92-201">If the longest value in a column is 25 characters, then define your column as VARCHAR(25).</span></span>  <span data-ttu-id="b0c92-202">Не рекомендуется использовать по умолчанию длинные значения столбцов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-202">Avoid defining all character columns to a large default length.</span></span>  <span data-ttu-id="b0c92-203">Кроме того, по возможности определяйте столбцы как VARCHAR, а не NVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="b0c92-203">In addition, define columns as VARCHAR when that is all that is needed rather than use NVARCHAR.</span></span>

<span data-ttu-id="b0c92-204">Дополнительные сведения см. в статьях, посвященных [общим сведениям о таблицах][Table overview], [типам данных таблиц][Table data types] и [инструкции CREATE TABLE][CREATE TABLE].</span><span class="sxs-lookup"><span data-stu-id="b0c92-204">See also [Table overview][Table overview], [Table data types][Table data types], [CREATE TABLE][CREATE TABLE]</span></span>

## <a name="use-temporary-heap-tables-for-transient-data"></a><span data-ttu-id="b0c92-205">Использование временных таблиц без кластеризованных индексов для хранения временных данных</span><span class="sxs-lookup"><span data-stu-id="b0c92-205">Use temporary heap tables for transient data</span></span>
<span data-ttu-id="b0c92-206">Если вам необходимо временно разместить данные в хранилище данных SQL, использование таблицы без кластеризованных индексов может существенно сократить время загрузки данных.</span><span class="sxs-lookup"><span data-stu-id="b0c92-206">When you are temporarily landing data on SQL Data Warehouse, you may find that using a heap table will make the overall process faster.</span></span>  <span data-ttu-id="b0c92-207">Загрузка таблицы в таблицу без кластеризованных индексов перед выполнением преобразования данных выполняется намного быстрее, чем загрузка данных в таблицу с кластеризованными индексами Columnstore.</span><span class="sxs-lookup"><span data-stu-id="b0c92-207">If you are loading data only to stage it before running more transformations, loading the table to heap table will be much faster than loading the data to a clustered columnstore table.</span></span>  <span data-ttu-id="b0c92-208">Кроме того, загрузка данных во временную таблицу выполняется гораздо быстрее, чем загрузка таблицы в постоянное хранилище.</span><span class="sxs-lookup"><span data-stu-id="b0c92-208">In addition, loading data to a temp table will also load much faster than loading a table to permanent storage.</span></span>  <span data-ttu-id="b0c92-209">Временные таблицы начинаются с # и доступны только сеансам, в которых они были созданы, поэтому они могут работать в ограниченном числе сценариев.</span><span class="sxs-lookup"><span data-stu-id="b0c92-209">Temporary tables start with a "#" and are only accessible by the session which created it, so they may only work in limited scenarios.</span></span>   <span data-ttu-id="b0c92-210">Таблицы без кластеризованных индексов определены в предложении WITH инструкции CREATE TABLE.</span><span class="sxs-lookup"><span data-stu-id="b0c92-210">Heap tables are defined in the WITH clause of a CREATE TABLE.</span></span>  <span data-ttu-id="b0c92-211">При использовании временной таблицы рекомендуется создавать в ней статистику.</span><span class="sxs-lookup"><span data-stu-id="b0c92-211">If you do use a temporary table, remember to create statistics on that temporary table too.</span></span>

<span data-ttu-id="b0c92-212">Дополнительные сведения см. в статьях о [временных таблицах][Temporary tables], [инструкциях CREATE TABLE][CREATE TABLE] и [CREATE TABLE AS SELECT][CREATE TABLE AS SELECT].</span><span class="sxs-lookup"><span data-stu-id="b0c92-212">See also [Temporary tables][Temporary tables], [CREATE TABLE][CREATE TABLE], [CREATE TABLE AS SELECT][CREATE TABLE AS SELECT]</span></span>

## <a name="optimize-clustered-columnstore-tables"></a><span data-ttu-id="b0c92-213">Оптимизация таблиц с кластеризованными индексами columnstore</span><span class="sxs-lookup"><span data-stu-id="b0c92-213">Optimize clustered columnstore tables</span></span>
<span data-ttu-id="b0c92-214">Использование кластеризованных индексов Columnstore — это один из наиболее эффективных способов для хранения данных в хранилище данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b0c92-214">Clustered columnstore indexes are one of the most efficient ways you can store your data in Azure SQL Data Warehouse.</span></span>  <span data-ttu-id="b0c92-215">По умолчанию в хранилище данных SQL используются таблицы с кластеризованными индексами Columnstore.</span><span class="sxs-lookup"><span data-stu-id="b0c92-215">By default, tables in SQL Data Warehouse are created as Clustered ColumnStore.</span></span>  <span data-ttu-id="b0c92-216">Качество кластеризованного сегмента Columnstore существенно влияет на эффективность выполнения запросов в таблицах с кластеризованными индексами Columnstore.</span><span class="sxs-lookup"><span data-stu-id="b0c92-216">To get the best performance for queries on columnstore tables, having good segment quality is important.</span></span>  <span data-ttu-id="b0c92-217">Если во время записи строк в таблицы Columnstore возникает нехватка памяти, качество сегмента Columnstore может ухудшиться.</span><span class="sxs-lookup"><span data-stu-id="b0c92-217">When rows are written to columnstore tables under memory pressure, columnstore segment quality may suffer.</span></span>  <span data-ttu-id="b0c92-218">Качество сегмента можно изменить по числу строк в сжатой группе строк.</span><span class="sxs-lookup"><span data-stu-id="b0c92-218">Segment quality can be measured by number of rows in a compressed Row Group.</span></span>  <span data-ttu-id="b0c92-219">Дополнительные сведения об определении и улучшении качества сегмента для таблиц с кластеризованными индексами columnstore см. в разделе [Причины низкого качества индекса Columnstore][Causes of poor columnstore index quality] статьи [Индексирование таблиц в хранилище данных SQL][Table indexes].</span><span class="sxs-lookup"><span data-stu-id="b0c92-219">See the [Causes of poor columnstore index quality][Causes of poor columnstore index quality] in the [Table indexes][Table indexes] article for step by step instructions on detecting and improving segment quality for clustered columnstore tables.</span></span>  <span data-ttu-id="b0c92-220">Так как высококачественные сегменты columnstore важны, рекомендуется использовать идентификаторы пользователей, которым назначен класс ресурсов среднего или большого размера для загрузки данных.</span><span class="sxs-lookup"><span data-stu-id="b0c92-220">Because high quality columnstore segments is important, it's a good idea to use users ids which are in the medium or large resource class for loading data.</span></span>  <span data-ttu-id="b0c92-221">Чем меньше DWU используется, тем больший размер ресурсов может понадобиться для пользователя, выполняющего загрузку.</span><span class="sxs-lookup"><span data-stu-id="b0c92-221">The fewer DWUs you use, the larger the resource class you will want to assign to your loading user.</span></span>

<span data-ttu-id="b0c92-222">В основном таблицы Columnstore не передают данные в сжатый сегмент Columnstore, пока количество строк в каждой таблице не превысит миллион, а каждая таблица хранилища данных SQL не будет секционирована на 60 таблиц. Поэтому нецелесообразно применять к таблицам Columnstore запросы до тех пор, пока количество строк в таблице не превысит 60 миллионов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-222">Since columnstore tables generally won't push data into a compressed columnstore segment until there are more than 1 million rows per table and each SQL Data Warehouse table is partitioned into 60 tables, as a rule of thumb, columnstore tables won't benefit a query unless the table has more than 60 million rows.</span></span>  <span data-ttu-id="b0c92-223">Поэтому нецелесообразно применять к таблицам Columnstore запросы до тех пор, пока количество строк в таблице не превысит 60 миллионов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-223">For table with less than 60 million rows, it may not make any sense to have a columnstore index.</span></span>  <span data-ttu-id="b0c92-224">Для таблицы с количеством строк менее 60 миллионов бессмысленно использовать индекс Columnstore, хотя он и не повлияет на производительность.</span><span class="sxs-lookup"><span data-stu-id="b0c92-224">It also may not hurt.</span></span>  <span data-ttu-id="b0c92-225">Более того, чтобы воспользоваться преимуществами кластеризованного индекса Columnstore при секционировании данных, каждая секция должна состоять из миллиона строк.</span><span class="sxs-lookup"><span data-stu-id="b0c92-225">Furthermore, if you partition your data, then you will want to consider that each partition will need to have 1 million rows to benefit from a clustered columnstore index.</span></span>  <span data-ttu-id="b0c92-226">Если таблица состоит из 100 секций, чтобы использовать кластеризованный индекс Columnstore, она должна состоять из как минимум 6 миллиардов строк (60 распределений * 100 секций * 1 миллион строк).</span><span class="sxs-lookup"><span data-stu-id="b0c92-226">If a table has 100 partitions, then it will need to have at least 6 billion rows to benefit from a clustered columns store (60 distributions * 100 partitions * 1 million rows).</span></span>  <span data-ttu-id="b0c92-227">Если таблица не содержит такого количества строк, рекомендуется уменьшить количество секций или использовать таблицу без кластеризованных индексов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-227">If your table does not have 6 billion rows in this example, either reduce the number of partitions or consider using a heap table instead.</span></span>  <span data-ttu-id="b0c92-228">Чтобы получить более высокую производительность, возможно, вместо кластеризованной таблицы стоит использовать таблицу без кластеризованных индексов, содержащую вторичные индексы.</span><span class="sxs-lookup"><span data-stu-id="b0c92-228">It also may be worth experimenting to see if better performance can be gained with a heap table with secondary indexes rather than a columnstore table.</span></span>  <span data-ttu-id="b0c92-229">Таблицы ColumnStore еще не поддерживают вторичные индексы.</span><span class="sxs-lookup"><span data-stu-id="b0c92-229">Columnstore tables do not yet support secondary indexes.</span></span>

<span data-ttu-id="b0c92-230">Если выбрать только необходимые столбцы, запросы к таблице ColumnStore будут выполняться быстрее.</span><span class="sxs-lookup"><span data-stu-id="b0c92-230">When querying a columnstore table, queries will run faster if you select only the columns you need.</span></span>  

<span data-ttu-id="b0c92-231">Ознакомьтесь также со статьями [Индексирование таблиц в хранилище данных SQL][Table indexes], [Руководство по индексам columnstore][Columnstore indexes guide] и разделом с [описанием повторной сборки индексов columnstore][Rebuilding columnstore indexes].</span><span class="sxs-lookup"><span data-stu-id="b0c92-231">See also [Table indexes][Table indexes], [Columnstore indexes guide][Columnstore indexes guide], [Rebuilding columnstore indexes][Rebuilding columnstore indexes]</span></span>

## <a name="use-larger-resource-class-to-improve-query-performance"></a><span data-ttu-id="b0c92-232">Использование класса ресурсов большого размера для повышения производительности запросов</span><span class="sxs-lookup"><span data-stu-id="b0c92-232">Use larger resource class to improve query performance</span></span>
<span data-ttu-id="b0c92-233">Чтобы выделить память для выполнения запросов, в хранилище данных SQL используются группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b0c92-233">SQL Data Warehouse uses resource groups as a way to allocate memory to queries.</span></span>  <span data-ttu-id="b0c92-234">По умолчанию для всех пользователей настроен класс ресурсов небольшого размера, предусматривающий 100 МБ памяти для каждого распределения.</span><span class="sxs-lookup"><span data-stu-id="b0c92-234">Out of the box, all users are assigned to the small resource class which grants 100 MB of memory per distribution.</span></span>  <span data-ttu-id="b0c92-235">В хранилище данных SQL содержится 60 распределений, на каждое из которых выделяется как минимум 100 МБ памяти. Поэтому в целом для системы выделяется 6000 МБ памяти (около 6 ГБ).</span><span class="sxs-lookup"><span data-stu-id="b0c92-235">Since there are always 60 distributions and each distribution is given a minimum of 100 MB, system wide the total memory allocation is 6,000 MB, or just under 6 GB.</span></span>  <span data-ttu-id="b0c92-236">На выполнение некоторых запросов (например, на объединение таблиц с кластеризованными индексами Columnstore или добавления в них данных) требуется больше памяти.</span><span class="sxs-lookup"><span data-stu-id="b0c92-236">Certain queries, like large joins or loads to clustered columnstore tables, will benefit from larger memory allocations.</span></span>  <span data-ttu-id="b0c92-237">На выполнение некоторых запросов, таких как запросы на обычное сканирование, память не требуется.</span><span class="sxs-lookup"><span data-stu-id="b0c92-237">Some queries, like pure scans, will see no benefit.</span></span>  <span data-ttu-id="b0c92-238">В тоже время перед перемещением всех пользователей в класс ресурсов большего размера следует учитывать, что использование такого класса влияет на параллелизм.</span><span class="sxs-lookup"><span data-stu-id="b0c92-238">On the flip side, utilizing larger resource classes impacts concurrency, so you will want to take this into consideration before moving all of your users to a large resource class.</span></span>

<span data-ttu-id="b0c92-239">Дополнительные сведения см. в статье [Управление параллелизмом и рабочей нагрузкой в хранилище данных SQL][Concurrency and workload management].</span><span class="sxs-lookup"><span data-stu-id="b0c92-239">See also [Concurrency and workload management][Concurrency and workload management]</span></span>

## <a name="use-smaller-resource-class-to-increase-concurrency"></a><span data-ttu-id="b0c92-240">Использование класса ресурсов небольшого размера для увеличения параллелизма</span><span class="sxs-lookup"><span data-stu-id="b0c92-240">Use Smaller Resource Class to Increase Concurrency</span></span>
<span data-ttu-id="b0c92-241">Если во время выполнения пользовательских запросов возникают длительные задержки, возможно, используются классы ресурсов большого размера или превышено количество одновременно используемых слотов выдачи. В таком случае запросы помещаются в очередь.</span><span class="sxs-lookup"><span data-stu-id="b0c92-241">If you are noticing that user queries seem to have a long delay, it could be that your users are running in larger resource classes and are consuming a lot of concurrency slots causing other queries to queue up.</span></span>  <span data-ttu-id="b0c92-242">Чтобы посмотреть очередь выполнения пользовательских запросов, выполните команду `SELECT * FROM sys.dm_pdw_waits`, которая позволяет просмотреть возвращенные строки.</span><span class="sxs-lookup"><span data-stu-id="b0c92-242">To see if users queries are queued, run `SELECT * FROM sys.dm_pdw_waits` to see if any rows are returned.</span></span>

<span data-ttu-id="b0c92-243">Дополнительные сведения см. в статьях [Управление параллелизмом и рабочей нагрузкой в хранилище данных SQL][Concurrency and workload management] и [sys.dm_pdw_waits (Transact-SQL)][sys.dm_pdw_waits].</span><span class="sxs-lookup"><span data-stu-id="b0c92-243">See also [Concurrency and workload management][Concurrency and workload management], [sys.dm_pdw_waits][sys.dm_pdw_waits]</span></span>

## <a name="use-dmvs-to-monitor-and-optimize-your-queries"></a><span data-ttu-id="b0c92-244">Использование динамических административных представлений для отслеживания и оптимизации запросов</span><span class="sxs-lookup"><span data-stu-id="b0c92-244">Use DMVs to monitor and optimize your queries</span></span>
<span data-ttu-id="b0c92-245">В хранилище данных SQL содержится несколько динамических административных представлений, которые можно использовать для отслеживания выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="b0c92-245">SQL Data Warehouse has several DMVs which can be used to monitor query execution.</span></span>  <span data-ttu-id="b0c92-246">В первой статье в списке ниже предоставлены пошаговые инструкции по отслеживанию выполнения запроса.</span><span class="sxs-lookup"><span data-stu-id="b0c92-246">The monitoring article below walks through step-by-step instructions on how to look at the details of an executing query.</span></span>  <span data-ttu-id="b0c92-247">Чтобы быстро определить запросы в динамических административных представлениях, используйте в запросах параметр LABEL.</span><span class="sxs-lookup"><span data-stu-id="b0c92-247">To quickly find queries in these DMVs, using the LABEL option with your queries can help.</span></span>

<span data-ttu-id="b0c92-248">Дополнительные сведения см. в статьях [Мониторинг рабочей нагрузки с помощью динамических административных представлений][Monitor your workload using DMVs], [Использование меток для инструментирования запросов в хранилище данных SQL][LABEL], [Предложение OPTION (Transact-SQL)][OPTION], [sys.dm_exec_sessions (Transact-SQL)][sys.dm_exec_sessions], [sys.dm_pdw_exec_requests (Transact-SQL)][sys.dm_pdw_exec_requests], [sys.dm_pdw_request_steps][sys.dm_pdw_request_steps], [sys.dm_pdw_request_steps (Transact-SQL)][sys.dm_pdw_sql_requests], [ys.dm_pdw_dms_workers (Transact-SQL)], [DBCC PDW_SHOWEXECUTIONPLAN (Transact-SQL)][DBCC PDW_SHOWEXECUTIONPLAN] и [sys.dm_pdw_waits (Transact-SQL)][sys.dm_pdw_waits].</span><span class="sxs-lookup"><span data-stu-id="b0c92-248">See also [Monitor your workload using DMVs][Monitor your workload using DMVs], [LABEL][LABEL], [OPTION][OPTION], [sys.dm_exec_sessions][sys.dm_exec_sessions], [sys.dm_pdw_exec_requests][sys.dm_pdw_exec_requests], [sys.dm_pdw_request_steps][sys.dm_pdw_request_steps], [sys.dm_pdw_sql_requests][sys.dm_pdw_sql_requests], [sys.dm_pdw_dms_workers], [DBCC PDW_SHOWEXECUTIONPLAN][DBCC PDW_SHOWEXECUTIONPLAN], [sys.dm_pdw_waits][sys.dm_pdw_waits]</span></span>

## <a name="other-resources"></a><span data-ttu-id="b0c92-249">Другие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="b0c92-249">Other resources</span></span>
<span data-ttu-id="b0c92-250">Дополнительные сведения о распространенных проблемах и способах их решения см. в статье [Устранение неполадок хранилища данных SQL Azure][Troubleshooting].</span><span class="sxs-lookup"><span data-stu-id="b0c92-250">Also see our [Troubleshooting][Troubleshooting] article for common issues and solutions.</span></span>

<span data-ttu-id="b0c92-251">Если вы не нашли нужных сведений в этой статье, попробуйте использовать поиск по документации в левой части страницы, чтобы найти все документы, связанные с хранилищем данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b0c92-251">If you didn't find what you were looking for in this article, try using the "Search for docs" on the left side of this page to search all of the Azure SQL Data Warehouse documents.</span></span>  <span data-ttu-id="b0c92-252">На [форуме по хранилищу данных SQL Azure на портале MSDN][Azure SQL Data Warehouse MSDN Forum] можно задать вопросы другим пользователям и разработчикам хранилища данных SQL.</span><span class="sxs-lookup"><span data-stu-id="b0c92-252">The [Azure SQL Data Warehouse MSDN Forum][Azure SQL Data Warehouse MSDN Forum] was create as a place for you to ask questions to other users and to the SQL Data Warehouse Product Group.</span></span>  <span data-ttu-id="b0c92-253">Мы регулярно просматриваем этот форум и следим за тем, чтобы другие пользователи или наши специалисты ответили на интересующие вас вопросы.</span><span class="sxs-lookup"><span data-stu-id="b0c92-253">We actively monitor this forum to ensure that your questions are answered either by another user or one of us.</span></span>  <span data-ttu-id="b0c92-254">Вопросы также можно задавать на [форуме по хранилищу данных SQL Azure на сайте Stack Overflow][Azure SQL Data Warehouse Stack Overflow Forum].</span><span class="sxs-lookup"><span data-stu-id="b0c92-254">If you prefer to ask your questions on Stack Overflow, we also have an [Azure SQL Data Warehouse Stack Overflow Forum][Azure SQL Data Warehouse Stack Overflow Forum].</span></span>

<span data-ttu-id="b0c92-255">Наконец, используйте страницу [отзывов о хранилище данных SQL Azure][Azure SQL Data Warehouse Feedback], чтобы оставить запросы на функции.</span><span class="sxs-lookup"><span data-stu-id="b0c92-255">Finally, please do use the [Azure SQL Data Warehouse Feedback][Azure SQL Data Warehouse Feedback] page to make feature requests.</span></span>  <span data-ttu-id="b0c92-256">Ваши отзывы и голоса за отзывы, оставленные другими пользователями, помогут нам определить, какие улучшения функций наиболее приоритетные.</span><span class="sxs-lookup"><span data-stu-id="b0c92-256">Adding your requests or up-voting other requests really helps us prioritize features.</span></span>

<!--Image references-->

<!--Article references-->
[Create a support ticket]: ./sql-data-warehouse-get-started-create-support-ticket.md
[Concurrency and workload management]: ./sql-data-warehouse-develop-concurrency.md
[Create table as select (CTAS)]: ./sql-data-warehouse-develop-ctas.md
[Table overview]: ./sql-data-warehouse-tables-overview.md
[Table data types]: ./sql-data-warehouse-tables-data-types.md
[Table distribution]: ./sql-data-warehouse-tables-distribute.md
[Table indexes]: ./sql-data-warehouse-tables-index.md
[Causes of poor columnstore index quality]: ./sql-data-warehouse-tables-index.md#causes-of-poor-columnstore-index-quality
[Rebuilding columnstore indexes]: ./sql-data-warehouse-tables-index.md#rebuilding-indexes-to-improve-segment-quality
[Table partitioning]: ./sql-data-warehouse-tables-partition.md
[Manage table statistics]: ./sql-data-warehouse-tables-statistics.md
[Temporary tables]: ./sql-data-warehouse-tables-temporary.md
[Guide for using PolyBase]: ./sql-data-warehouse-load-polybase-guide.md
[Load data]: ./sql-data-warehouse-overview-load.md
[Move data with Azure Data Factory]: ../data-factory/data-factory-azure-sql-data-warehouse-connector.md
[Load data with Azure Data Factory]: ./sql-data-warehouse-get-started-load-with-azure-data-factory.md
[Load data with bcp]: ./sql-data-warehouse-load-with-bcp.md
[Load data with PolyBase]: ./sql-data-warehouse-get-started-load-with-polybase.md
[Monitor your workload using DMVs]: ./sql-data-warehouse-manage-monitor.md
[Pause compute resources]: ./sql-data-warehouse-manage-compute-overview.md#pause-compute-bk
[Resume compute resources]: ./sql-data-warehouse-manage-compute-overview.md#resume-compute-bk
<span data-ttu-id="b0c92-257">[масштабировании]: ./sql-data-warehouse-manage-compute-overview.md#scale-compute</span><span class="sxs-lookup"><span data-stu-id="b0c92-257">[Scale compute resources]: ./sql-data-warehouse-manage-compute-overview.md#scale-compute</span></span>
[Understanding transactions]: ./sql-data-warehouse-develop-transactions.md
[Optimizing transactions]: ./sql-data-warehouse-develop-best-practices-transactions.md
[Troubleshooting]: ./sql-data-warehouse-troubleshoot.md
[LABEL]: ./sql-data-warehouse-develop-label.md

<!--MSDN references-->
[ALTER TABLE]: https://msdn.microsoft.com/library/ms190273.aspx
[CREATE EXTERNAL FILE FORMAT]: https://msdn.microsoft.com/library/dn935026.aspx
[CREATE STATISTICS]: https://msdn.microsoft.com/library/ms188038.aspx
[CREATE TABLE]: https://msdn.microsoft.com/library/mt203953.aspx
[CREATE TABLE AS SELECT]: https://msdn.microsoft.com/library/mt204041.aspx
[DBCC PDW_SHOWEXECUTIONPLAN]: https://msdn.microsoft.com/library/mt204017.aspx
[INSERT]: https://msdn.microsoft.com/library/ms174335.aspx
[OPTION]: https://msdn.microsoft.com/library/ms190322.aspx
[TRUNCATE TABLE]: https://msdn.microsoft.com/library/ms177570.aspx
[UPDATE STATISTICS]: https://msdn.microsoft.com/library/ms187348.aspx
[sys.dm_exec_sessions]: https://msdn.microsoft.com/library/ms176013.aspx
[sys.dm_pdw_exec_requests]: https://msdn.microsoft.com/library/mt203887.aspx
[sys.dm_pdw_request_steps]: https://msdn.microsoft.com/library/mt203913.aspx
[sys.dm_pdw_sql_requests]: https://msdn.microsoft.com/library/mt203889.aspx
<span data-ttu-id="b0c92-258">[ys.dm_pdw_dms_workers (Transact-SQL)]: https://msdn.microsoft.com/library/mt203878.aspx</span><span class="sxs-lookup"><span data-stu-id="b0c92-258">[sys.dm_pdw_dms_workers]: https://msdn.microsoft.com/library/mt203878.aspx</span></span>
[sys.dm_pdw_waits]: https://msdn.microsoft.com/library/mt203893.aspx
[Columnstore indexes guide]: https://msdn.microsoft.com/library/gg492088.aspx

<!--Other Web references-->
[Selecting table distribution]: https://blogs.msdn.microsoft.com/sqlcat/2015/08/11/choosing-hash-distributed-table-vs-round-robin-distributed-table-in-azure-sql-dw-service/
[Azure SQL Data Warehouse Feedback]: https://feedback.azure.com/forums/307516-sql-data-warehouse
[Azure SQL Data Warehouse MSDN Forum]: https://social.msdn.microsoft.com/Forums/sqlserver/home?forum=AzureSQLDataWarehouse
[Azure SQL Data Warehouse Stack Overflow Forum]:  http://stackoverflow.com/questions/tagged/azure-sqldw
[Azure SQL Data Warehouse loading patterns and strategies]: https://blogs.msdn.microsoft.com/sqlcat/2016/02/06/azure-sql-data-warehouse-loading-patterns-and-strategies
