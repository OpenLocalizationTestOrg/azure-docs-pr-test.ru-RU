---
title: "aaaHow распределенных данных работает в хранилище данных SQL Azure | Документы Microsoft"
description: "Дополнительные сведения, распределение данных для расширенной параллельной обработке (MPP) и hello варианты распределения таблиц в хранилище данных SQL Azure и параллельных хранилищ данных."
services: sql-data-warehouse
documentationcenter: NA
author: jrowlandjones
manager: jhubbard
editor: 
ms.assetid: bae494a6-7ac5-4c38-8ca3-ab2696c63a9f
ms.service: sql-data-warehouse
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-services
ms.custom: tables
ms.date: 07/12/2017
ms.author: jrj;barbkess
ms.openlocfilehash: 9a712d8d5251e4391ede245105918283aaa4b193
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-data-and-distributed-tables-for-massively-parallel-processing-mpp"></a><span data-ttu-id="03409-103">Распределенные данные и распределенные таблицы для вычислений с массовым параллелизмом (MPP)</span><span class="sxs-lookup"><span data-stu-id="03409-103">Distributed data and distributed tables for Massively Parallel Processing (MPP)</span></span>
<span data-ttu-id="03409-104">Сведения о распределении пользовательских данных в хранилище данных SQL Azure и хранилище Parallel Data Warehouse, системах Майкрософт для вычислений с массовым параллелизмом (MPP).</span><span class="sxs-lookup"><span data-stu-id="03409-104">Learn how user data is distributed in Azure SQL Data Warehouse and Parallel Data Warehouse, which are Microsoft's Massively Parallel Processing (MPP) systems.</span></span> <span data-ttu-id="03409-105">Проектирование вашей toouse хранилища данных распределенных данных фактически помогает вам tooachieve hello обработки запросов преимущества архитектуры MPP hello.</span><span class="sxs-lookup"><span data-stu-id="03409-105">Designing your data warehouse toouse distributed data effectively helps you tooachieve hello query processing benefits of hello MPP architecture.</span></span> <span data-ttu-id="03409-106">Выбор правильных вариантов при проектировании базы данных может иметь значительное влияние на повышение производительности запросов.</span><span class="sxs-lookup"><span data-stu-id="03409-106">A few database design choices can have a significant impact on improving query performance.</span></span>  

> [!NOTE]
> <span data-ttu-id="03409-107">Хранилище данных SQL Azure и используйте hello Parallel Data Warehouse разработки же расширенной параллельной обработке (MPP), но они имеют ряд различий из-за hello базовой платформы.</span><span class="sxs-lookup"><span data-stu-id="03409-107">Azure SQL Data Warehouse and Parallel Data Warehouse use hello same Massively Parallel Processing (MPP) design, but they have a few differences because of hello underlying platform.</span></span> <span data-ttu-id="03409-108">Хранилище данных SQL — это платформа как услуга (PaaS), работающая на базе Azure.</span><span class="sxs-lookup"><span data-stu-id="03409-108">SQL Data Warehouse is a Platform as a Service (PaaS) that runs on Azure.</span></span> <span data-ttu-id="03409-109">Хранилище Parallel Data Warehouse работает на базе Analytics Platform System (APS), локального модуля на базе Windows Server.</span><span class="sxs-lookup"><span data-stu-id="03409-109">Parallel Data Warehouse runs on Analytics Platform System (APS) which is an on-premises appliance that runs on Windows Server.</span></span>
> 
> 

## <a name="what-is-distributed-data"></a><span data-ttu-id="03409-110">Что такое распределенные данные?</span><span class="sxs-lookup"><span data-stu-id="03409-110">What is distributed data?</span></span>
<span data-ttu-id="03409-111">В хранилище данных SQL и параллельных хранилищ данных распределенных данных относится toouser данные, которые хранятся в нескольких местах hello MPP системы.</span><span class="sxs-lookup"><span data-stu-id="03409-111">In SQL Data Warehouse and Parallel Data Warehouse, distributed data refers toouser data that is stored in multiple locations across hello MPP system.</span></span> <span data-ttu-id="03409-112">Каждый из этих расположений функционирует как независимые хранения и обработки единица, которая выполняет запросы в его части данных hello.</span><span class="sxs-lookup"><span data-stu-id="03409-112">Each of those locations functions as an independent storage and processing unit that runs queries on its portion of hello data.</span></span> <span data-ttu-id="03409-113">Распределенные данные — это основные toorunning запросы в параллельных tooachieve высокую производительность запросов.</span><span class="sxs-lookup"><span data-stu-id="03409-113">Distributed data is fundamental toorunning queries in parallel tooachieve high query performance.</span></span>

<span data-ttu-id="03409-114">toodistribute данных, хранилище данных hello назначает каждой строки таблицы tooone распределенных местонахождение пользователя.</span><span class="sxs-lookup"><span data-stu-id="03409-114">toodistribute data, hello data warehouse assigns each row of a user table tooone distributed location.</span></span>  <span data-ttu-id="03409-115">Таблицы можно распределять с помощью метода хэш-распределения или метода циклического перебора.</span><span class="sxs-lookup"><span data-stu-id="03409-115">You can distribute tables with a hash-distribution method or a round-robin method.</span></span> <span data-ttu-id="03409-116">метод распространения Hello указывается в инструкции CREATE TABLE hello.</span><span class="sxs-lookup"><span data-stu-id="03409-116">hello distribution method is specified in hello CREATE TABLE statement.</span></span> 

## <a name="hash-distributed-tables"></a><span data-ttu-id="03409-117">Таблицы с хэш-распределением</span><span class="sxs-lookup"><span data-stu-id="03409-117">Hash-distributed tables</span></span>
<span data-ttu-id="03409-118">Hello, следующая диаграмма иллюстрирует, как полная (таблица нераспределенный) возвращает хранящейся в виде таблицы распределенных хэш.</span><span class="sxs-lookup"><span data-stu-id="03409-118">hello following diagram illustrates how a full (non-distributed table) gets stored as a hash-distributed table.</span></span> <span data-ttu-id="03409-119">Детерминированные функции присваивает каждой распределение tooone toobelong строк.</span><span class="sxs-lookup"><span data-stu-id="03409-119">A deterministic function assigns each row toobelong tooone distribution.</span></span> <span data-ttu-id="03409-120">В определении таблицы hello один из столбцов hello обозначается как столбец распределения hello.</span><span class="sxs-lookup"><span data-stu-id="03409-120">In hello table definition, one of hello columns is designated as hello distribution column.</span></span> <span data-ttu-id="03409-121">хэш-функции Hello использует значение hello в столбец tooassign hello распространения распространения tooa каждой строки.</span><span class="sxs-lookup"><span data-stu-id="03409-121">hello hash function uses hello value in hello distribution column tooassign each row tooa distribution.</span></span>

<span data-ttu-id="03409-122">Существуют особенности производительности для выбора hello столбца распределения, например различимости, Рассогласование данных и типов запросов, выполняемых в системе hello hello.</span><span class="sxs-lookup"><span data-stu-id="03409-122">There are performance considerations for hello selection of a distribution column, such as distinctness, data skew, and hello types of queries run on hello system.</span></span>

<span data-ttu-id="03409-123">![Распределенная таблица](media/sql-data-warehouse-distributed-data/hash-distributed-table.png "Распределенная таблица")</span><span class="sxs-lookup"><span data-stu-id="03409-123">![Distributed table](media/sql-data-warehouse-distributed-data/hash-distributed-table.png "Distributed table")</span></span>  

* <span data-ttu-id="03409-124">Каждая строка принадлежит tooone распространения.</span><span class="sxs-lookup"><span data-stu-id="03409-124">Each row belongs tooone distribution.</span></span>  
* <span data-ttu-id="03409-125">Детерминированные хэш-алгоритм назначает каждой tooone распределение строк.</span><span class="sxs-lookup"><span data-stu-id="03409-125">A deterministic hash algorithm assigns each row tooone distribution.</span></span>  
* <span data-ttu-id="03409-126">Hello количество строк таблицы на распространения зависит с hello различные размеры таблиц, как показано.</span><span class="sxs-lookup"><span data-stu-id="03409-126">hello number of table rows per distribution varies as shown by hello different sizes of tables.</span></span>

## <a name="round-robin-distributed-tables"></a><span data-ttu-id="03409-127">Таблицы с распределением методом циклического перебора</span><span class="sxs-lookup"><span data-stu-id="03409-127">Round-robin distributed tables</span></span>
<span data-ttu-id="03409-128">Циклический перебор распределенные таблицы равномерно распределяет строки hello, назначив распространения tooa каждой строки в последовательном порядке.</span><span class="sxs-lookup"><span data-stu-id="03409-128">A round-robin distributed table distributes hello rows by assigning each row tooa distribution in a sequential manner.</span></span> <span data-ttu-id="03409-129">Это быстрый tooload данные в таблицу циклический перебор, но производительность запроса может быть медленнее.</span><span class="sxs-lookup"><span data-stu-id="03409-129">It is quick tooload data into a round-robin table, but query performance might be slower.</span></span>  <span data-ttu-id="03409-130">Для присоединения таблицы циклического обычно требуется передвижения hello строк tooenable hello запроса tooproduce точный результат, который занимает время.</span><span class="sxs-lookup"><span data-stu-id="03409-130">Joining a round-robin table usually requires reshuffling hello rows tooenable hello query tooproduce an accurate result, which takes time.</span></span>

## <a name="distributed-storage-locations-are-called-distributions"></a><span data-ttu-id="03409-131">Распределенные расположения хранения называются распределениями</span><span class="sxs-lookup"><span data-stu-id="03409-131">Distributed storage locations are called distributions</span></span>
<span data-ttu-id="03409-132">Каждое распределенное расположение называется распределением.</span><span class="sxs-lookup"><span data-stu-id="03409-132">Each distributed location is called a distribution.</span></span> <span data-ttu-id="03409-133">При выполнении запроса в параллельном режиме, его часть данных hello каждого распределения выполняет SQL-запроса.</span><span class="sxs-lookup"><span data-stu-id="03409-133">When a query runs in parallel, each distribution performs a SQL query on its portion of hello data.</span></span> <span data-ttu-id="03409-134">Хранилище данных SQL использует запрос hello toorun базы данных SQL.</span><span class="sxs-lookup"><span data-stu-id="03409-134">SQL Data Warehouse uses SQL Database toorun hello query.</span></span> <span data-ttu-id="03409-135">Параллельное хранилище данных используется запрос hello toorun SQL Server.</span><span class="sxs-lookup"><span data-stu-id="03409-135">Parallel Data Warehouse uses SQL Server toorun hello query.</span></span> <span data-ttu-id="03409-136">Этот архитектура общих nothing является фундаментальные tooachieving масштабирования параллельных вычислений.</span><span class="sxs-lookup"><span data-stu-id="03409-136">This shared-nothing architecture design is fundamental tooachieving scale-out parallel computing.</span></span>

### <a name="can-i-view-hello-distributions"></a><span data-ttu-id="03409-137">Можно просмотреть распределения hello</span><span class="sxs-lookup"><span data-stu-id="03409-137">Can I view hello distributions?</span></span>
<span data-ttu-id="03409-138">Каждого распределения имеет идентификатор распространителя и отображается в системных представлениях, которые относятся tooSQL хранилища данных и параллельных хранилищ данных.</span><span class="sxs-lookup"><span data-stu-id="03409-138">Each distribution has a distribution ID and is visible in system views that pertain tooSQL Data Warehouse and Parallel Data Warehouse.</span></span> <span data-ttu-id="03409-139">Можно использовать производительность запросов tootroubleshoot идентификатор распространителя hello и других проблем.</span><span class="sxs-lookup"><span data-stu-id="03409-139">You can use hello distribution ID tootroubleshoot query performance and other problems.</span></span> <span data-ttu-id="03409-140">Список системных представлений hello см. в разделе hello [MPP системное представление](sql-data-warehouse-reference-tsql-statements.md).</span><span class="sxs-lookup"><span data-stu-id="03409-140">For a list of hello system views, see hello [MPP system view](sql-data-warehouse-reference-tsql-statements.md).</span></span>

## <a name="difference-between-a-distribution-and-a-compute-node"></a><span data-ttu-id="03409-141">Различия между распределением и вычислительным узлом</span><span class="sxs-lookup"><span data-stu-id="03409-141">Difference between a distribution and a Compute node</span></span>
<span data-ttu-id="03409-142">Распределение является основной единицей hello для хранения распределенных данных и обработки параллельных запросов.</span><span class="sxs-lookup"><span data-stu-id="03409-142">A distribution is hello basic unit for storing distributed data and processing parallel queries.</span></span> <span data-ttu-id="03409-143">Распределения объединяются в вычислительные узлы.</span><span class="sxs-lookup"><span data-stu-id="03409-143">Distributions are grouped into Compute nodes.</span></span> <span data-ttu-id="03409-144">Каждый вычислительный узел отслеживает одно или несколько распределений.</span><span class="sxs-lookup"><span data-stu-id="03409-144">Each Compute node tracks one or more distributions.</span></span>  

* <span data-ttu-id="03409-145">Система платформы аналитики использует вычислительные узлы как компонент центра возможностей hello оборудования архитектуры и масштабирования.</span><span class="sxs-lookup"><span data-stu-id="03409-145">Analytics Platform System uses Compute nodes as a central component of hello hardware architecture and scale-out capabilities.</span></span> <span data-ttu-id="03409-146">Всегда использует восемь распределения по вычислительных узлов, как показано на диаграмме hello для распределенных хэш таблиц.</span><span class="sxs-lookup"><span data-stu-id="03409-146">It always uses eight distributions per Compute node, as shown in hello diagram for hash-distributed tables.</span></span> <span data-ttu-id="03409-147">Здравствуйте, количество вычислительных узлов и поэтому Здравствуйте, количество распространением, определяется hello количество вычислительных узлов, приобретения для hello устройства.</span><span class="sxs-lookup"><span data-stu-id="03409-147">hello number of Compute nodes, and therefore hello number of distributions, is determined by hello number of Compute nodes you purchase for hello appliance.</span></span> <span data-ttu-id="03409-148">Например, при покупке восьми вычислительных узлов пользователь получает 64 распределения (8 вычислительных узлов x 8 распределений на узел).</span><span class="sxs-lookup"><span data-stu-id="03409-148">For example, if you purchase eight Compute nodes, you get 64 distributions (8 Compute nodes x 8 distributions/node).</span></span> 
* <span data-ttu-id="03409-149">Хранилище данных SQL использует фиксированное количество распределений, равное 60, и переменное количество вычислительных узлов.</span><span class="sxs-lookup"><span data-stu-id="03409-149">SQL Data Warehouse has a fixed number of 60 distributions and a flexible number of Compute nodes.</span></span> <span data-ttu-id="03409-150">Вычислительные узлы Hello реализуются с ресурсами Azure вычислений и хранения.</span><span class="sxs-lookup"><span data-stu-id="03409-150">hello Compute nodes are implemented with Azure computing and storage resources.</span></span> <span data-ttu-id="03409-151">Hello количество вычислительных узлов можно изменить соответствующим рабочей нагрузки toohello серверной службы и hello вычислительные мощности (Dwu) укажите hello хранилища данных.</span><span class="sxs-lookup"><span data-stu-id="03409-151">hello number of Compute nodes can change according toohello backend service workload and hello computing capacity (DWUs) you specify for hello data warehouse.</span></span> <span data-ttu-id="03409-152">При изменении hello количество вычислительных узлов, hello количество распространением на вычислительном узле также изменяется.</span><span class="sxs-lookup"><span data-stu-id="03409-152">When hello number of Compute nodes changes, hello number of distributions per Compute node also changes.</span></span> 

### <a name="can-i-view-hello-compute-nodes"></a><span data-ttu-id="03409-153">Можно просмотреть hello вычислительных узлов</span><span class="sxs-lookup"><span data-stu-id="03409-153">Can I view hello Compute nodes?</span></span>
<span data-ttu-id="03409-154">Каждый вычислительный узел содержит идентификатор узла и является видимым в системных представлениях, которые относятся tooSQL хранилища данных и параллельных хранилищ данных.</span><span class="sxs-lookup"><span data-stu-id="03409-154">Each Compute node has a node ID and is visible in system views that pertain tooSQL Data Warehouse and Parallel Data Warehouse.</span></span>  <span data-ttu-id="03409-155">Вы увидите hello вычислительных узлов, просматривая hello node_id столбец в системных представлениях, имена которых начинаются с sys.pdw_nodes.</span><span class="sxs-lookup"><span data-stu-id="03409-155">You can see hello Compute node by looking for hello node_id column in system views whose names begin with sys.pdw_nodes.</span></span> <span data-ttu-id="03409-156">Список системных представлений hello см. в разделе hello [MPP системное представление](sql-data-warehouse-reference-tsql-statements.md).</span><span class="sxs-lookup"><span data-stu-id="03409-156">For a list of hello system views, see hello [MPP system view](sql-data-warehouse-reference-tsql-statements.md).</span></span>

## <span data-ttu-id="03409-157"><a name="Replicated"></a>Реплицированные таблицы</span><span class="sxs-lookup"><span data-stu-id="03409-157"><a name="Replicated"></a>Replicated Tables</span></span>
<span data-ttu-id="03409-158">Содержит таблицу, которая реплицируется полностью копии hello таблицы хранятся на каждом вычислительном узле.</span><span class="sxs-lookup"><span data-stu-id="03409-158">A table that is replicated has a fully copy of hello table stored on each Compute node.</span></span> <span data-ttu-id="03409-159">Таблицы репликации удаляет данные tootransfer необходимость hello среди вычислительных узлов перед соединения или статистической обработки.</span><span class="sxs-lookup"><span data-stu-id="03409-159">Replicating a table removes hello need tootransfer data among Compute nodes before a join or aggregation.</span></span> <span data-ttu-id="03409-160">Реплицированные таблицы осуществимы только с небольших таблиц из-за hello дополнительного места требуется toostore hello всю таблицу на каждом вычислительном узле.</span><span class="sxs-lookup"><span data-stu-id="03409-160">Replicated tables are only feasible with small tables because of hello extra storage required toostore hello full table on each compute node.</span></span>  

<span data-ttu-id="03409-161">Hello следующей диаграмме показан реплицируемой таблицы, которые хранятся на каждом вычислительном узле.</span><span class="sxs-lookup"><span data-stu-id="03409-161">hello following diagram shows a replicated table that is stored on each Compute node.</span></span> <span data-ttu-id="03409-162">Для хранилища данных SQL hello реплицируемой таблицы является полностью копируются tooa базы данных распространителя на каждом вычислительном узле.</span><span class="sxs-lookup"><span data-stu-id="03409-162">For SQL Data Warehouse, hello replicated table is fully copied tooa distribution database on each Compute node.</span></span> <span data-ttu-id="03409-163">Parallel Data Warehouse hello реплицируемой таблицы хранятся на всех дисках, назначенный toohello вычислительных узлов.</span><span class="sxs-lookup"><span data-stu-id="03409-163">For Parallel Data Warehouse, hello replicated table is stored across all disks assigned toohello Compute node.</span></span>  <span data-ttu-id="03409-164">Такая стратегия работы с дисками реализуется с помощью файловых групп SQL Server.</span><span class="sxs-lookup"><span data-stu-id="03409-164">This disk strategy is implemented by using SQL Server filegroups.</span></span>  

<span data-ttu-id="03409-165">![Реплицируемая таблица](media/sql-data-warehouse-distributed-data/replicated-table.png "Реплицируемая таблица")</span><span class="sxs-lookup"><span data-stu-id="03409-165">![Replicated table](media/sql-data-warehouse-distributed-data/replicated-table.png "Replicated table")</span></span> 

## <a name="next-steps"></a><span data-ttu-id="03409-166">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="03409-166">Next steps</span></span>
<span data-ttu-id="03409-167">toouse распределенных таблиц см. по сути, [распределение таблиц в хранилище данных SQL](sql-data-warehouse-tables-distribute.md)</span><span class="sxs-lookup"><span data-stu-id="03409-167">toouse distributed tables effectively, see [Distributing tables in SQL Data Warehouse](sql-data-warehouse-tables-distribute.md)</span></span>  

