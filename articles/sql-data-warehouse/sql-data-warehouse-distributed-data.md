---
title: "Как распределенные данные обрабатываются в хранилище данных SQL Azure | Документация Майкрософт"
description: "Сведения о распределении данных для вычислений с массовым параллелизмом (MPP), а также о параметрах для распределения таблиц в хранилище данных SQL Azure и хранилище Parallel Data Warehouse."
services: sql-data-warehouse
documentationcenter: NA
author: jrowlandjones
manager: jhubbard
editor: 
ms.assetid: bae494a6-7ac5-4c38-8ca3-ab2696c63a9f
ms.service: sql-data-warehouse
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-services
ms.custom: tables
ms.date: 07/12/2017
ms.author: jrj;barbkess
ms.openlocfilehash: 3c166acb17193caae32d7bad133ec510ff679353
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="distributed-data-and-distributed-tables-for-massively-parallel-processing-mpp"></a>Распределенные данные и распределенные таблицы для вычислений с массовым параллелизмом (MPP)
Сведения о распределении пользовательских данных в хранилище данных SQL Azure и хранилище Parallel Data Warehouse, системах Майкрософт для вычислений с массовым параллелизмом (MPP). Проектирование хранилища данных с учетом эффективного использования распределенных данных помогает использовать преимущества архитектуры MPP при обработке запросов. Выбор правильных вариантов при проектировании базы данных может иметь значительное влияние на повышение производительности запросов.  

> [!NOTE]
> Хранилище данных SQL Azure и хранилище Parallel Data Warehouse используют одинаковую схему вычислений с массовым параллелизмом (MPP), но есть и ряд различий, обусловленных базовой платформой. Хранилище данных SQL — это платформа как услуга (PaaS), работающая на базе Azure. Хранилище Parallel Data Warehouse работает на базе Analytics Platform System (APS), локального модуля на базе Windows Server.
> 
> 

## <a name="what-is-distributed-data"></a>Что такое распределенные данные?
В хранилище данных SQL и хранилище Parallel Data Warehouse понятие "распределенные данные" означает пользовательские данные, которые хранятся в нескольких расположениях в системе MPP. Каждое из этих расположений работает как независимое хранилище и процессор, выполняющий запросы для своей части данных. Распределенные данные являются основой для параллельного выполнения запросов и достижения их высокой производительности.

Для распределения данных хранилище присваивает каждую строку пользовательской таблицы одному распределенному расположению.  Таблицы можно распределять с помощью метода хэш-распределения или метода циклического перебора. Метод распространения указывается в инструкции CREATE TABLE. 

## <a name="hash-distributed-tables"></a>Таблицы с хэш-распределением
На следующей схеме показано, как полная (нераспределенная) таблица хранится в качестве хэш-распределенной. Детерминированная функция присваивает каждую строку одному распределению. В определении таблицы один из столбцов определяется как столбец распределения. Хэш-функция использует значение в столбце распределения для присвоения каждой строки распределению.

Существуют влияющие на производительность факторы, которые учитываются при выборе столбца распределения. Например, определенность, неравномерное смещение данных и типы запросов, выполняемых в системе.

![Распределенная таблица](media/sql-data-warehouse-distributed-data/hash-distributed-table.png "Распределенная таблица")  

* Каждая строка относится к одному распределению.  
* Детерминированный хэш-алгоритм присваивает каждую строку одному распределению.  
* Количество строк таблицы в распределении зависит от размеров таблиц (как показано на схеме).

## <a name="round-robin-distributed-tables"></a>Таблицы с распределением методом циклического перебора
Распределенная таблица, использующая метод циклического перебора, распределяет строки путем назначения каждой строки распределению в последовательном порядке. Данные в такую таблицу загружаются быстро, но выполнение запросов может быть медленным.  Для объединения таблицы с циклическим перебором обычно требуется перегруппировка строк, чтобы запрос вернул точный результат. А для этого требуется время.

## <a name="distributed-storage-locations-are-called-distributions"></a>Распределенные расположения хранения называются распределениями
Каждое распределенное расположение называется распределением. При параллельном выполнении запроса каждое распределение выполняет запрос SQL к своей части данных. Хранилище данных SQL использует базу данных SQL для выполнения запроса. Хранилище Parallel Data Warehouse использует для выполнения запроса SQL Server. Такая неразделяемая архитектура является принципиальной для обеспечения масштабируемых параллельных вычислений.

### <a name="can-i-view-the-distributions"></a>Можно ли просматривать распределения?
У каждого распределения есть идентификатор, отображаемый в системных представлениях, которые относятся к хранилищу данных SQL и Parallel Data Warehouse. Идентификатор распределения можно использовать для устранения неполадок производительности запросов и других проблем. Список системных представлений см. в [системном представление MPP](sql-data-warehouse-reference-tsql-statements.md).

## <a name="difference-between-a-distribution-and-a-compute-node"></a>Различия между распределением и вычислительным узлом
Распределение — это базовая единица хранения распределенных данных и обработки параллельных запросов. Распределения объединяются в вычислительные узлы. Каждый вычислительный узел отслеживает одно или несколько распределений.  

* Система Analytics Platform System использует вычислительные узлы в качестве центрального компонента аппаратной архитектуры и возможностей масштабирования. В ней всегда используется восемь распределений на один вычислительный узел, как показано на диаграмме для таблиц с хэш-распределением. Количество вычислительных узлов и, следовательно, число распределений, зависит от количества вычислительных узлов, приобретенных пользователем для устройства. Например, при покупке восьми вычислительных узлов пользователь получает 64 распределения (8 вычислительных узлов x 8 распределений на узел). 
* Хранилище данных SQL использует фиксированное количество распределений, равное 60, и переменное количество вычислительных узлов. Вычислительные узлы реализованы с использованием ресурсов вычисления и хранения Azure. Количество вычислительных узлов может изменяться в зависимости от рабочей нагрузки серверной службы и вычислительной мощности (DWU), указанной для хранилища данных. При изменении количества вычислительных узлов изменяется и количество распределений на один вычислительный узел. 

### <a name="can-i-view-the-compute-nodes"></a>Можно ли просматривать вычислительные узлы?
У каждого вычислительного узла есть идентификатор, отображаемый в системных представлениях, которые относятся к хранилищу данных SQL и Parallel Data Warehouse.  Вычислительные узлы можно увидеть в столбце node_id в системных представлениях, имена которых начинаются с sys.pdw_nodes. Список системных представлений см. в [системном представление MPP](sql-data-warehouse-reference-tsql-statements.md).

## <a name="Replicated"></a>Реплицированные таблицы
Полная копия реплицированной таблицы хранится на каждом вычислительном узле. Репликация таблицы устраняет необходимость передавать данные между вычислительными узлами перед операциями соединения или агрегирования. Реплицированные таблицы подходят только для работы с небольшими таблицами из-за дополнительного пространства для хранения всей таблицы на каждом вычислительном узле.  

На схеме ниже показана реплицированная таблица, которая хранится на каждом вычислительном узле. Для хранилища данных SQL реплицируемая таблица полностью копируется в базу данных распространителя на каждом вычислительном узле. Для Parallel Data Warehouse реплицированная таблица хранится на всех дисках, назначенных вычислительному узлу.  Такая стратегия работы с дисками реализуется с помощью файловых групп SQL Server.  

![Реплицируемая таблица](media/sql-data-warehouse-distributed-data/replicated-table.png "Реплицируемая таблица") 

## <a name="next-steps"></a>Дальнейшие действия
Чтобы эффективно использовать распределенные таблицы, см. инструкции в статье [Distributing tables in SQL Data Warehouse](sql-data-warehouse-tables-distribute.md) (Распределение таблиц в хранилище данных SQL).  

