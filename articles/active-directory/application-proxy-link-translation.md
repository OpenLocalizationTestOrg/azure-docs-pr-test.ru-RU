---
title: "Преобразование ссылок и URL-адресов прокси приложения Azure AD | Документация Майкрософт"
description: "Основные сведения о соединителях прокси приложения Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/10/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: 57218346d236b376d2227e0ffaea6c6dd5ebe855
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="redirect-hardcoded-links-for-apps-published-with-azure-ad-application-proxy"></a><span data-ttu-id="be024-103">Перенаправление встроенных ссылок для приложений, опубликованных с помощью прокси приложения Azure AD</span><span class="sxs-lookup"><span data-stu-id="be024-103">Redirect hardcoded links for apps published with Azure AD Application Proxy</span></span>

<span data-ttu-id="be024-104">С помощью прокси приложения Azure AD ваши локальные приложения доступны удаленным пользователям или пользователям со своими устройствами.</span><span class="sxs-lookup"><span data-stu-id="be024-104">Azure AD Application Proxy makes your on-premises apps available to users who are remote or on their own devices.</span></span> <span data-ttu-id="be024-105">Тем не менее, некоторые приложения были разработаны с помощью локальных ссылок, внедренных в HTML-код.</span><span class="sxs-lookup"><span data-stu-id="be024-105">Some apps, however, were developed with local links embedded in the HTML.</span></span> <span data-ttu-id="be024-106">Эти ссылки могут работать некорректно при использовании приложения удаленно.</span><span class="sxs-lookup"><span data-stu-id="be024-106">These links don't work correctly when the app is used remotely.</span></span> <span data-ttu-id="be024-107">Если несколько локальных приложений указывают друг на друга, то пользователям требуется, чтобы ссылки продолжали работать, когда их нет в офисе.</span><span class="sxs-lookup"><span data-stu-id="be024-107">When you have several on-premises applications point to each other, your users expect the links to keep working when they're not at the office.</span></span> 

<span data-ttu-id="be024-108">Чтобы гарантировать работу ссылок как внутри корпоративной сети, так и за ее пределами, лучше всего настроить внешние URL-адреса приложений таким образом, чтобы они совпадали с их внутренними URL-адресами.</span><span class="sxs-lookup"><span data-stu-id="be024-108">The best way to make sure that links work the same both inside and outside of your corporate network is to configure the external URLs of your apps to be the same as their internal URLs.</span></span> <span data-ttu-id="be024-109">При настройке внешних URL-адресов используйте [личные домены](active-directory-application-proxy-custom-domains.md), чтобы вместо домена прокси приложения по умолчанию адреса содержали ваше корпоративное доменное имя.</span><span class="sxs-lookup"><span data-stu-id="be024-109">Use [custom domains](active-directory-application-proxy-custom-domains.md) to configure your external URLs to have your corporate domain name instead of the default application proxy domain.</span></span>

<span data-ttu-id="be024-110">Если в своем клиенте вы не можете использовать личные домены, то функция преобразования ссылок в прокси приложения будет поддерживать работу ссылок независимо от того, где находятся ваши пользователи.</span><span class="sxs-lookup"><span data-stu-id="be024-110">If you can't use custom domains in your tenant, then the link translation feature of Application Proxy keeps your links working no matter where your users are.</span></span> <span data-ttu-id="be024-111">При наличии приложений, которые указывают непосредственно на внутренние конечные точки или порты, эти внутренние URL-адреса можно сопоставить с опубликованными внешними URL-адресами прокси приложения.</span><span class="sxs-lookup"><span data-stu-id="be024-111">When you have apps that point directly to internal endpoints or ports, you can map these internal URLs to the published external Application Proxy URLs.</span></span> <span data-ttu-id="be024-112">Когда преобразование ссылок включено, прокси приложения выполняет поиск по HTML, CSS и выбирает теги JavaScript для опубликованных внутренних ссылок.</span><span class="sxs-lookup"><span data-stu-id="be024-112">When link translation is enabled, and Application Proxy searches through HTML, CSS, and select JavaScript tags for published internal links.</span></span> <span data-ttu-id="be024-113">Затем служба прокси приложения преобразует их, чтобы пользователи могли не прерывать работу.</span><span class="sxs-lookup"><span data-stu-id="be024-113">Then the Application Proxy service translates them so that your users get an uninterrupted experience.</span></span>

>[!NOTE]
><span data-ttu-id="be024-114">Функция преобразования ссылок предназначена для клиентов, которые по какой-либо причине не могут использовать личные домены, имеющие те же внутренние и внешние URL-адреса в своих приложениях.</span><span class="sxs-lookup"><span data-stu-id="be024-114">The link translation feature is for tenants that, for whatever reason, can't use custom domains to have the same internal and external URLs for their apps.</span></span> <span data-ttu-id="be024-115">Прежде чем включать эту функцию, проверьте, можете ли вы использовать [личные домены в прокси приложения Azure AD](active-directory-application-proxy-custom-domains.md).</span><span class="sxs-lookup"><span data-stu-id="be024-115">Before you enable this feature, see if [custom domains in Azure AD Application Proxy](active-directory-application-proxy-custom-domains.md) can work for you.</span></span>
>
><span data-ttu-id="be024-116">А если преобразование ссылок необходимо настроить в приложении SharePoint, то см. статью [Настройка альтернативных сопоставлений доступа для SharePoint 2013](https://technet.microsoft.com/library/cc263208.aspx), где описан другой подход к сопоставлению ссылок.</span><span class="sxs-lookup"><span data-stu-id="be024-116">Or, if the application you need to configure with link translation is SharePoint, see [Configure alternate access mappings for SharePoint 2013](https://technet.microsoft.com/library/cc263208.aspx) for another approach to mapping links.</span></span>

## <a name="how-link-translation-works"></a><span data-ttu-id="be024-117">Как работает преобразование ссылок</span><span class="sxs-lookup"><span data-stu-id="be024-117">How link translation works</span></span>

<span data-ttu-id="be024-118">После проверки подлинности, когда прокси-сервер передает данные приложения пользователю, прокси приложения проверяет приложение на наличие встроенных ссылок и заменяет их соответствующими опубликованными внешними URL-адресами.</span><span class="sxs-lookup"><span data-stu-id="be024-118">After authentication, when the proxy server passes the application data to the user, Application Proxy scans the application for hardcoded links and replaces them with their respective, published external URLs.</span></span>

<span data-ttu-id="be024-119">Прокси приложения предполагает, что приложения имеют кодировку UTF-8.</span><span class="sxs-lookup"><span data-stu-id="be024-119">Application Proxy assumes that applications are encoded in UTF-8.</span></span> <span data-ttu-id="be024-120">Если это не так, то укажите тип кодировки в HTTP-заголовке ответа, например `Content-Type:text/html;charset=utf-8`.</span><span class="sxs-lookup"><span data-stu-id="be024-120">If that's not the case, specify the encoding type in an http response header, like `Content-Type:text/html;charset=utf-8`.</span></span>

### <a name="which-links-are-affected"></a><span data-ttu-id="be024-121">Какие ссылки будут затронуты</span><span class="sxs-lookup"><span data-stu-id="be024-121">Which links are affected?</span></span>

<span data-ttu-id="be024-122">Функция преобразования ссылок ищет только ссылки, которые находятся в тегах кода в основной части приложения.</span><span class="sxs-lookup"><span data-stu-id="be024-122">The link translation feature only looks for links that are in code tags in the body of an app.</span></span> <span data-ttu-id="be024-123">Прокси приложения имеет отдельную функцию для преобразования файлов cookie и URL-адресов в заголовках.</span><span class="sxs-lookup"><span data-stu-id="be024-123">Application Proxy has a separate feature for translating cookies or URLs in headers.</span></span> 

<span data-ttu-id="be024-124">Существует два общих типа внутренних ссылок в локальных приложениях:</span><span class="sxs-lookup"><span data-stu-id="be024-124">There are two common types of internal links in on-premises applications:</span></span>

- <span data-ttu-id="be024-125">**Относительные внутренние ссылки**, которые указывают на общедоступный ресурс в локальной структуре файлов, такой как `/claims/claims.html`.</span><span class="sxs-lookup"><span data-stu-id="be024-125">**Relative internal links** that point to a shared resource in a local file structure like `/claims/claims.html`.</span></span> <span data-ttu-id="be024-126">Эти ссылки автоматически работают в приложениях, которые опубликованы через прокси приложения, и продолжают работать с преобразованием или без него.</span><span class="sxs-lookup"><span data-stu-id="be024-126">These links automatically work in apps that are published through Application Proxy, and continue to work with or without link translation.</span></span> 
- <span data-ttu-id="be024-127">**Встроенные внутренние ссылки** на другие локальные приложения, такие как `http://expenses`, или опубликованные файлы, например `http://expenses/logo.jpg`.</span><span class="sxs-lookup"><span data-stu-id="be024-127">**Hardcoded internal links** to other on-premises apps like `http://expenses` or published files like `http://expenses/logo.jpg`.</span></span> <span data-ttu-id="be024-128">Функция преобразования ссылок работает со встроенными внутренними ссылками и изменяет их для указания на внешние URL-адреса, по которым могут пройти удаленные пользователи.</span><span class="sxs-lookup"><span data-stu-id="be024-128">The link translation feature works on hardcoded internal links, and changes them to point to the external URLs that remote users need to go through.</span></span>

### <a name="how-do-apps-link-to-each-other"></a><span data-ttu-id="be024-129">Как приложения ссылаются друг на друга</span><span class="sxs-lookup"><span data-stu-id="be024-129">How do apps link to each other?</span></span>

<span data-ttu-id="be024-130">Преобразование ссылок включено для каждого приложения, чтобы у вас был контроль над работой пользователя на уровне отдельных приложений.</span><span class="sxs-lookup"><span data-stu-id="be024-130">Link translation is enabled for each application, so that you have control over the user experience at the per-app level.</span></span> <span data-ttu-id="be024-131">Включите преобразование ссылок для приложения, если необходимо, чтобы преобразовывались ссылки *из* этого приложения, а не ссылки *на* него.</span><span class="sxs-lookup"><span data-stu-id="be024-131">Turn on link translation for an app when you want the links *from* that app to be translated, not links *to* that app.</span></span> 

<span data-ttu-id="be024-132">Например, предположим, имеется три приложения, которые опубликованы через прокси приложения и содержат ссылки друг на друга: "Преимущества", "Расходы" и "Путешествия".</span><span class="sxs-lookup"><span data-stu-id="be024-132">For example, suppose that you have three applications published through Application Proxy that all link to each other: Benefits, Expenses, and Travel.</span></span> <span data-ttu-id="be024-133">Имеется четвертое приложение, "Отзыв", которое не опубликовано через прокси приложения.</span><span class="sxs-lookup"><span data-stu-id="be024-133">There's a fourth app, Feedback, that isn't published through Application Proxy.</span></span>

<span data-ttu-id="be024-134">При включении преобразования ссылок для приложения "Преимущества" ссылки на "Расходы" и "Путешествия" перенаправляются на внешние URL-адреса этих приложений, но ссылка на "Отзывы" не перенаправляется, так как у нее нет внешнего URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="be024-134">When you enable link translation for the Benefits app, the links to Expenses and Travel are redirected to the external URLs for those apps, but the link to Feedback is not redirected because there is no external URL.</span></span> <span data-ttu-id="be024-135">Ссылки из приложений "Расходы" и "Путешествия" обратно в "Преимущества" не работают из-за того, что для этих двух приложений не было включено преобразование.</span><span class="sxs-lookup"><span data-stu-id="be024-135">Links from Expenses and Travel back to Benefits don't work, because link translation has not been enabled for those two apps.</span></span>

![Ссылки из приложения "Преимущества" на другие приложения при включенном преобразовании ссылок](./media/application-proxy-link-translation/one_app.png)

### <a name="which-links-arent-translated"></a><span data-ttu-id="be024-137">Какие ссылки не преобразовываются</span><span class="sxs-lookup"><span data-stu-id="be024-137">Which links aren't translated?</span></span>

<span data-ttu-id="be024-138">Для повышения производительности и безопасности некоторые ссылки не преобразовываются:</span><span class="sxs-lookup"><span data-stu-id="be024-138">To improve performance and security, some links aren't translated:</span></span>

- <span data-ttu-id="be024-139">Ссылки вне тегов кода.</span><span class="sxs-lookup"><span data-stu-id="be024-139">Links not inside of code tags.</span></span> 
- <span data-ttu-id="be024-140">Ссылки в формате, отличном от HTML, CSS или JavaScript.</span><span class="sxs-lookup"><span data-stu-id="be024-140">Links not in HTML, CSS, or JavaScript.</span></span> 
- <span data-ttu-id="be024-141">Внутренние ссылки, открываемые из других программ.</span><span class="sxs-lookup"><span data-stu-id="be024-141">Internal links opened from other programs.</span></span> <span data-ttu-id="be024-142">Ссылки, отправленные по электронной почте или через мгновенные сообщения либо включенные в другие документы.</span><span class="sxs-lookup"><span data-stu-id="be024-142">Links sent through email or instant message, or included in other documents, won't be translated.</span></span> <span data-ttu-id="be024-143">Пользователи должны знать, как переходить по внешним URL-адресам.</span><span class="sxs-lookup"><span data-stu-id="be024-143">The users need to know to go to the external URL.</span></span>

<span data-ttu-id="be024-144">Если вам необходима поддержка одного из этих двух сценариев, то вместо преобразования ссылок используйте одинаковые внутренние и внешние URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="be024-144">If you need to support one of these two scenarios, use the same internal and external URLs instead of link translation.</span></span>  

## <a name="enable-link-translation"></a><span data-ttu-id="be024-145">Включение преобразования ссылок</span><span class="sxs-lookup"><span data-stu-id="be024-145">Enable link translation</span></span>

<span data-ttu-id="be024-146">Приступить к работе с преобразованием ссылок очень просто:</span><span class="sxs-lookup"><span data-stu-id="be024-146">Getting started with link translation is as easy as clicking a button:</span></span>

1. <span data-ttu-id="be024-147">Войдите на [портал Azure](https://portal.azure.com) с использованием учетной записи администратора.</span><span class="sxs-lookup"><span data-stu-id="be024-147">Sign in to the [Azure portal](https://portal.azure.com) as an administrator.</span></span>
2. <span data-ttu-id="be024-148">Перейдите в **Azure Active Directory** > **Корпоративные приложения** > **Приложения** > приложение, которым необходимо управлять > **Прокси приложения**.</span><span class="sxs-lookup"><span data-stu-id="be024-148">Go to **Azure Active Directory** > **Enterprise applications** > **All applications** > select the app you want to manage > **Application proxy**.</span></span>
3. <span data-ttu-id="be024-149">Переведите переключатель **Translate URLs in application body** (Преобразовывать URL-адреса в коде приложения) в состояние **Да**.</span><span class="sxs-lookup"><span data-stu-id="be024-149">Turn **Translate URLs in application body** to **Yes**.</span></span>

   ![Выберите "Да" для преобразования URL-адресов в коде приложения](./media/application-proxy-link-translation/select_yes.png)<span data-ttu-id="be024-151">.</span><span class="sxs-lookup"><span data-stu-id="be024-151">.</span></span>
4. <span data-ttu-id="be024-152">Щелкните **Сохранить**, чтобы применить изменения.</span><span class="sxs-lookup"><span data-stu-id="be024-152">Select **Save** to apply your changes.</span></span>

<span data-ttu-id="be024-153">Теперь, когда пользователи получают доступ к этому приложению, прокси будет автоматически проверять внутренние ссылки, которые были опубликованы через прокси приложения на вашем клиенте.</span><span class="sxs-lookup"><span data-stu-id="be024-153">Now, when your users access this application, the proxy will automatically scan for internal URLs that have been published through Application Proxy on your tenant.</span></span>

## <a name="send-feedback"></a><span data-ttu-id="be024-154">Отправка отзывов</span><span class="sxs-lookup"><span data-stu-id="be024-154">Send feedback</span></span>

<span data-ttu-id="be024-155">Нам нужна ваша помощь, чтобы обеспечить работу функции во всех ваших приложениях.</span><span class="sxs-lookup"><span data-stu-id="be024-155">We want your help to make this feature work for all your apps.</span></span> <span data-ttu-id="be024-156">Мы поддерживаем поиск более 30 тегов в HTML и CSS, а также рассматриваем, в каких случаях поддерживать JavaScript.</span><span class="sxs-lookup"><span data-stu-id="be024-156">We search over 30 tags in HTML and CSS, and are considering which JavaScript cases to support.</span></span> <span data-ttu-id="be024-157">Если у вас есть пример созданных ссылок, которые не были преобразованы, отправьте фрагмент кода [сюда](mailto:aadapfeedback@microsoft.com).</span><span class="sxs-lookup"><span data-stu-id="be024-157">If you have an example of generated links that aren't being translated, send a code snippet to [Application Proxy Feedback](mailto:aadapfeedback@microsoft.com).</span></span> 

## <a name="next-steps"></a><span data-ttu-id="be024-158">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="be024-158">Next steps</span></span>
<span data-ttu-id="be024-159">[Работа с пользовательскими доменами в прокси приложения Azure AD](active-directory-application-proxy-custom-domains.md)</span><span class="sxs-lookup"><span data-stu-id="be024-159">[Use custom domains with Azure AD Application Proxy](active-directory-application-proxy-custom-domains.md) to have the same internal and external URL</span></span>

[<span data-ttu-id="be024-160">Настройка альтернативных сопоставлений доступа для SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="be024-160">Configure alternate access mappings for SharePoint 2013</span></span>](https://technet.microsoft.com/library/cc263208.aspx)
