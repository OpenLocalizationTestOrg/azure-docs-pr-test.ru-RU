---
title: "Объекты приложения и субъекта-службы в Azure Active Directory | Документация Майкрософт"
description: "Сведения о связи между объектами приложений и субъектов-служб в Azure Active Directory"
documentationcenter: dev-center-name
author: dstrockis
manager: mbaldwin
services: active-directory
editor: 
ms.assetid: adfc0569-dc91-48fe-92c3-b5b4833703de
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/28/2016
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 4c75ade5f4e47ef64ccc0fe8af4b174c377dc7bc
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="application-and-service-principal-objects-in-azure-active-directory-azure-ad"></a><span data-ttu-id="5a957-103">Объекты приложения и субъекта-службы в Azure Active Directory (Azure AD)</span><span class="sxs-lookup"><span data-stu-id="5a957-103">Application and service principal objects in Azure Active Directory (Azure AD)</span></span>
<span data-ttu-id="5a957-104">Иногда значение термина "приложение" может быть неправильно понято при использовании в контексте Azure AD.</span><span class="sxs-lookup"><span data-stu-id="5a957-104">Sometimes the meaning of the term "application" can be misunderstood when used in the context of Azure AD.</span></span> <span data-ttu-id="5a957-105">Цель этой статьи — объяснить понятие приложения Azure Active Directory, а также определить концептуальные и практические аспекты его интеграции. Кроме того, здесь продемонстрирована регистрация [мультитенантного приложения](active-directory-dev-glossary.md#multi-tenant-application) и предоставление соответствующих разрешений.</span><span class="sxs-lookup"><span data-stu-id="5a957-105">The goal of this article is to make it clearer, by clarifying conceptual and concrete aspects of Azure AD application integration, with an illustration of registration and consent for a [multi-tenant application](active-directory-dev-glossary.md#multi-tenant-application).</span></span>

## <a name="overview"></a><span data-ttu-id="5a957-106">Обзор</span><span class="sxs-lookup"><span data-stu-id="5a957-106">Overview</span></span>
<span data-ttu-id="5a957-107">Приложение, интегрированное с Azure AD, это более широкое понятие, чем просто компонент программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="5a957-107">An application that has been integrated with Azure AD has implications that go beyond the software aspect.</span></span> <span data-ttu-id="5a957-108">Это общий термин, который включает в себя не только программное обеспечение, но и процесс регистрации приложения в Azure AD и роль при обмене данными во время проверки подлинности и авторизации в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="5a957-108">"Application" is frequently used as a conceptual term, referring to not only the the application software, but also its Azure AD registration and role in authentication/authorization "conversations" at runtime.</span></span> <span data-ttu-id="5a957-109">По определению приложение можно развернуть в роли [клиента](active-directory-dev-glossary.md#client-application) (потребление ресурсов), [сервера ресурсов](active-directory-dev-glossary.md#resource-server) (предоставление API для клиентов) или в обеих ролях.</span><span class="sxs-lookup"><span data-stu-id="5a957-109">By definition, an application can function in a [client](active-directory-dev-glossary.md#client-application) role (consuming a resource), a [resource server](active-directory-dev-glossary.md#resource-server) role (exposing APIs to clients), or even both.</span></span> <span data-ttu-id="5a957-110">Протокол общения определяется [потоком предоставления кода авторизации OAuth 2.0](active-directory-dev-glossary.md#authorization-grant). Он используется для предоставления клиенту или ресурсу доступа к данным ресурса или разрешения на их защиту.</span><span class="sxs-lookup"><span data-stu-id="5a957-110">The conversation protocol is defined by an [OAuth 2.0 Authorization Grant flow](active-directory-dev-glossary.md#authorization-grant), allowing the client/resource to access/protect a resource's data respectively.</span></span> <span data-ttu-id="5a957-111">Теперь давайте рассмотрим приложение Azure AD более детально и узнаем, что оно собой представляет в процессе разработки и во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5a957-111">Now let's go a level deeper, and see how the Azure AD application model represents an application at design-time and run-time.</span></span> 

## <a name="application-registration"></a><span data-ttu-id="5a957-112">Регистрация приложения</span><span class="sxs-lookup"><span data-stu-id="5a957-112">Application registration</span></span>
<span data-ttu-id="5a957-113">При регистрации приложения Azure AD на [портале Azure][AZURE-Portal] в клиенте Azure AD создаются два объекта: объект приложения и объект субъекта-службы.</span><span class="sxs-lookup"><span data-stu-id="5a957-113">When you register an Azure AD application in the [Azure portal][AZURE-Portal], two objects are created in your Azure AD tenant: an application object, and a service principal object.</span></span>

#### <a name="application-object"></a><span data-ttu-id="5a957-114">Объект приложения</span><span class="sxs-lookup"><span data-stu-id="5a957-114">Application object</span></span>
<span data-ttu-id="5a957-115">Объект приложения представляет определение вашего приложения Azure AD. Единственный экземпляр объекта приложения размещается в главном клиенте Azure AD приложения (то есть в клиенте, в котором зарегистрировано приложение).</span><span class="sxs-lookup"><span data-stu-id="5a957-115">An Azure AD application is defined by its one and only application object, which resides in the Azure AD tenant where the application was registered, known as the application's "home" tenant.</span></span> <span data-ttu-id="5a957-116">Схема для свойств объекта приложения определяется в [сущности приложения][AAD-Graph-App-Entity] Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="5a957-116">The Azure AD Graph [Application entity][AAD-Graph-App-Entity] defines the schema for an application object's properties.</span></span> 

#### <a name="service-principal-object"></a><span data-ttu-id="5a957-117">Объект субъекта-службы</span><span class="sxs-lookup"><span data-stu-id="5a957-117">Service principal object</span></span>
<span data-ttu-id="5a957-118">Объект субъекта-службы определяет политику и разрешения для использования приложения в определенном клиенте. Это основа для создания субъекта безопасности, используемого для представления приложения во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5a957-118">The service principal object defines the policy and permissions for an application's use in a specific tenant, providing the basis for a security principal to represent the application at run-time.</span></span> <span data-ttu-id="5a957-119">Схема для свойств объекта субъекта-службы определяется в [сущности ServicePrincipal][AAD-Graph-Sp-Entity] Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="5a957-119">The Azure AD Graph [ServicePrincipal entity][AAD-Graph-Sp-Entity] defines the schema for a service principal object's properties.</span></span> 

#### <a name="application-and-service-principal-relationship"></a><span data-ttu-id="5a957-120">Отношение приложения и субъекта-службы</span><span class="sxs-lookup"><span data-stu-id="5a957-120">Application and service principal relationship</span></span>
<span data-ttu-id="5a957-121">В некотором роде объект приложения является *глобальным* представлением вашего приложения (для использования во всех клиентах), а субъект-служба — *локальным* (для использования в определенных клиентах).</span><span class="sxs-lookup"><span data-stu-id="5a957-121">Consider the application object as the *global* representation of your application for use across all tenants, and the service principal as the *local* representation for use in a specific tenant.</span></span> <span data-ttu-id="5a957-122">Объект приложения служит шаблоном, который *определяет* общие свойства и свойства по умолчанию, используемые для создания соответствующих объектов субъекта-службы.</span><span class="sxs-lookup"><span data-stu-id="5a957-122">The application object serves as the template from which common and default properties are *derived* for use in creating corresponding service principal objects.</span></span> <span data-ttu-id="5a957-123">Между объектом приложения и самим приложением устанавливается отношение 1:1, а между объектом приложения и соответствующими субъектами-службами — отношение "один ко многим".</span><span class="sxs-lookup"><span data-stu-id="5a957-123">An application object therefore has a 1:1 relationship with the software application, and a 1:many relationship with its corresponding service principal object(s).</span></span>

<span data-ttu-id="5a957-124">Субъект-службу необходимо создать в каждом клиенте, где будет использоваться приложение, чтобы установить поставщика удостоверений для входа в систему и доступа к ресурсам, защищенным с помощью клиента.</span><span class="sxs-lookup"><span data-stu-id="5a957-124">A service principal must be created in each tenant where the application will be used, enabling it to establish an identity for sign-in and/or access to resources being secured by the tenant.</span></span> <span data-ttu-id="5a957-125">Приложение с одним клиентом будет иметь только один субъект-службу (в домашнем клиенте), который обычно создается (и на который дается согласие на использование) во время регистрации приложения.</span><span class="sxs-lookup"><span data-stu-id="5a957-125">A single-tenant application will have only one service principal (in its home tenant), usually created and consented for use during application registration.</span></span> <span data-ttu-id="5a957-126">Для мультитенантного веб-приложения или API также будет создан субъект-служба в каждом клиенте, пользователь которого даст согласие на его использование.</span><span class="sxs-lookup"><span data-stu-id="5a957-126">A multi-tenant Web application/API will also have a service principal created in each tenant where a user from that tenant has consented to its use.</span></span>  

> [!NOTE]
> <span data-ttu-id="5a957-127">Любые изменения объекта приложения также отражаются в объекте субъекта-службы, размещенном в главном клиенте приложения (то есть в клиенте, в котором зарегистрировано приложение).</span><span class="sxs-lookup"><span data-stu-id="5a957-127">Any changes you make to your application object, are also reflected in its service principal object in the application's home tenant only (the tenant where it was registered).</span></span> <span data-ttu-id="5a957-128">При использовании мультитенантных приложений изменения объекта приложения не отражаются в объектах субъекта-службы клиента-потребителя до тех пор, пока с [помощью панели доступа к приложениям](https://myapps.microsoft.com) доступ не будет отменен и предоставлен снова.</span><span class="sxs-lookup"><span data-stu-id="5a957-128">For multi-tenant applications, changes to the application object are not reflected in any consumer tenants' service principal objects, until the access is removed via the [Application Access Panel](https://myapps.microsoft.com) and granted again.</span></span>
><br>  
> <span data-ttu-id="5a957-129">Обратите также внимание, что собственные приложения по умолчанию регистрируются как мультитенантные.</span><span class="sxs-lookup"><span data-stu-id="5a957-129">Also note that native applications are registered as multi-tenant by default.</span></span>
> 
> 

## <a name="example"></a><span data-ttu-id="5a957-130">Пример</span><span class="sxs-lookup"><span data-stu-id="5a957-130">Example</span></span>
<span data-ttu-id="5a957-131">На следующей схеме показана связь между объектом приложения и соответствующими объектами субъекта-службы в контексте образца мультитенантного приложения под названием **Приложение по управлению персоналом**.</span><span class="sxs-lookup"><span data-stu-id="5a957-131">The following diagram illustrates the relationship between an application's application object and corresponding service principal objects, in the context of a sample multi-tenant application called **HR app**.</span></span> <span data-ttu-id="5a957-132">В этом сценарии используются три клиента Azure AD.</span><span class="sxs-lookup"><span data-stu-id="5a957-132">There are three Azure AD tenants in this scenario:</span></span> 

* <span data-ttu-id="5a957-133">**Adatum** — клиент, который использует компания, разработавшая **приложение по управлению персоналом**.</span><span class="sxs-lookup"><span data-stu-id="5a957-133">**Adatum** - the tenant used by the company that developed the **HR app**</span></span>
* <span data-ttu-id="5a957-134">**Contoso** — клиент, который использует компания Contoso, потребляющая **приложение по управлению персоналом**.</span><span class="sxs-lookup"><span data-stu-id="5a957-134">**Contoso** - the tenant used by the Contoso organization, which is a consumer of the **HR app**</span></span>
* <span data-ttu-id="5a957-135">**Fabrikam** — клиент, который использует компания Fabrikam, также потребляющая **приложение по управлению персоналом**.</span><span class="sxs-lookup"><span data-stu-id="5a957-135">**Fabrikam** - the tenant used by the Fabrikam organization, which also consumes the **HR app**</span></span>

![Связь между объектом приложения и объектом субъекта-службы](./media/active-directory-application-objects/application-objects-relationship.png)

<span data-ttu-id="5a957-137">На предыдущей схеме шаг 1 — это процесс создания объектов приложения и субъекта-службы в главном клиенте приложения.</span><span class="sxs-lookup"><span data-stu-id="5a957-137">In the previous diagram, Step 1 is the process of creating the application and service principal objects in the application's home tenant.</span></span>

<span data-ttu-id="5a957-138">На шаге 2 при согласии администраторов компании Contoso и Fabrikam в клиенте Azure AD компании создается объект субъекта-службы, и ему назначаются разрешения, предоставленные администратором.</span><span class="sxs-lookup"><span data-stu-id="5a957-138">In Step 2, when Contoso and Fabrikam administrators complete consent, a service principal object is created in their company's Azure AD tenant and assigned the permissions that the administrator granted.</span></span> <span data-ttu-id="5a957-139">Обратите внимание, что приложение по управлению персоналом можно создать или настроить для отдельных пользователей.</span><span class="sxs-lookup"><span data-stu-id="5a957-139">Also note that the HR app could be configured/designed to allow consent by users for individual use.</span></span>

<span data-ttu-id="5a957-140">На шаге 3 каждый из клиентов-потребителей приложения по управлению персоналом (Contoso и Fabrikam) имеет собственный объект субъекта-службы.</span><span class="sxs-lookup"><span data-stu-id="5a957-140">In Step 3, the consumer tenants of the HR application (Contoso and Fabrikam) each have their own service principal object.</span></span> <span data-ttu-id="5a957-141">И каждый из них представляет использование экземпляра приложения во время выполнения. Это использование зависит от разрешений, предоставленных соответствующим администратором.</span><span class="sxs-lookup"><span data-stu-id="5a957-141">Each represents their use of an instance of the application at runtime, governed by the permissions consented by the respective administrator.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5a957-142">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="5a957-142">Next steps</span></span>
<span data-ttu-id="5a957-143">Доступ к объекту приложения можно получить через API Azure AD Graph, с помощью редактора манифеста приложения на [портале Azure][AZURE-Portal] или с помощью [командлетов Azure AD PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azureadps-2.0), как определено в [сущности приложения][AAD-Graph-App-Entity] OData.</span><span class="sxs-lookup"><span data-stu-id="5a957-143">An application's application object can be accessed via the Azure AD Graph API, the [Azure portal's][AZURE-Portal] application manifest editor, or [Azure AD PowerShell cmdlets](https://docs.microsoft.com/powershell/azure/overview?view=azureadps-2.0), as represented by its OData [Application entity][AAD-Graph-App-Entity].</span></span>

<span data-ttu-id="5a957-144">Доступ к объекту субъекта-службы приложения можно получить через API Azure AD Graph или с помощью [командлетов Azure AD PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azureadps-2.0), как определено в [сущности субъекта-службы][AAD-Graph-Sp-Entity] OData.</span><span class="sxs-lookup"><span data-stu-id="5a957-144">An application's service principal object can be accessed via the Azure AD Graph API or [Azure AD PowerShell cmdlets](https://docs.microsoft.com/powershell/azure/overview?view=azureadps-2.0), as represented by its OData [ServicePrincipal entity][AAD-Graph-Sp-Entity].</span></span>

<span data-ttu-id="5a957-145">[Проводник Azure AD Graph](https://graphexplorer.azurewebsites.net/) полезен для запросов как объектов приложения, так и объектов субъекта-службы.</span><span class="sxs-lookup"><span data-stu-id="5a957-145">The [Azure AD Graph Explorer](https://graphexplorer.azurewebsites.net/) is useful for querying both the application and service principal objects.</span></span>

<!--Image references-->

<!--Reference style links -->
[AAD-Graph-App-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#application-entity
[AAD-Graph-Sp-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity
[AZURE-Portal]: https://portal.azure.com
