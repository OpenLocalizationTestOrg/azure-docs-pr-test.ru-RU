---
title: "Чем отличается конечная точка Azure AD версии 2.0? | Документация Майкрософт"
description: "Сравнение первоначальной версии Azure AD и конечных точек версии 2.0."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 5060da46-b091-4e25-9fa8-af4ae4359b6c
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/01/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 81de65b0e825dec64383f52b02c5ee56c9434807
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="whats-different-about-the-v20-endpoint"></a><span data-ttu-id="93531-104">В чем отличия конечной точки версии 2.0?</span><span class="sxs-lookup"><span data-stu-id="93531-104">What's different about the v2.0 endpoint?</span></span>
<span data-ttu-id="93531-105">Если вы знакомы с Azure Active Directory или интегрировали приложения с Azure AD в прошлом, то можете столкнуться с некоторыми неожиданными отличиями в конечной точке версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="93531-105">If you're familiar with Azure Active Directory or have integrated apps with Azure AD in the past, there may be some differences in the v2.0 endpoint that you would not expect.</span></span>  <span data-ttu-id="93531-106">Они описаны в этом документе.</span><span class="sxs-lookup"><span data-stu-id="93531-106">This document calls out those differences for your understanding.</span></span>

> [!NOTE]
> <span data-ttu-id="93531-107">Не все сценарии и компоненты Azure Active Directory поддерживаются конечной точкой версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="93531-107">Not all Azure Active Directory scenarios & features are supported by the v2.0 endpoint.</span></span>  <span data-ttu-id="93531-108">Чтобы определить, следует ли вам использовать конечную точку 2.0, ознакомьтесь с [ограничениями версии 2.0](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="93531-108">To determine if you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>

## <a name="microsoft-accounts-and-azure-ad-accounts"></a><span data-ttu-id="93531-109">Учетные записи Майкрософт и Azure AD</span><span class="sxs-lookup"><span data-stu-id="93531-109">Microsoft accounts and Azure AD accounts</span></span>
<span data-ttu-id="93531-110">Конечная точка версии 2.0 позволяет разработчикам создавать приложения, поддерживающие вход с учетными записями Майкрософт и Azure AD с использованием одной конечной точки проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="93531-110">The v2.0 endpoint allow developers to write apps that accept sign-in from both Microsoft Accounts and Azure AD accounts, using a single auth endpoint.</span></span>  <span data-ttu-id="93531-111">Это дает возможность разрабатывать приложения, которые полностью не зависят от учетных записей.</span><span class="sxs-lookup"><span data-stu-id="93531-111">This gives you the ability to write your app completely account-agnostic; it can be ignorant of the type of account that the user signs in with.</span></span>  <span data-ttu-id="93531-112">Конечно, *можно* сообщить приложению, какая учетная запись используется в сеансе, но это необязательно.</span><span class="sxs-lookup"><span data-stu-id="93531-112">Of course, you *can* make your app aware of the type of account being used in a particular session, but you don't have to.</span></span>

<span data-ttu-id="93531-113">Например, если приложение вызывает [Microsoft Graph](https://graph.microsoft.io), корпоративным пользователям будут доступны некоторые дополнительные функции и данные, такие как сайты SharePoint или данные каталога.</span><span class="sxs-lookup"><span data-stu-id="93531-113">For instance, if your app calls the [Microsoft Graph](https://graph.microsoft.io), some additional functionality and data will be available to enterprise users, such as their SharePoint sites or Directory data.</span></span>  <span data-ttu-id="93531-114">Но многие действия, такие как [чтение почты пользователя](https://graph.microsoft.io/docs/api-reference/v1.0/resources/message), можно выполнять с помощью одного кода для учетных записей Майкрософт и Azure AD.</span><span class="sxs-lookup"><span data-stu-id="93531-114">But for many actions, such as [Reading a user's mail](https://graph.microsoft.io/docs/api-reference/v1.0/resources/message), the code can be written exactly the same for both Microsoft Accounts and Azure AD accounts.</span></span>  

<span data-ttu-id="93531-115">Теперь интеграция приложения с учетными записями Майкрософт и Azure AD — один простой процесс.</span><span class="sxs-lookup"><span data-stu-id="93531-115">Integrating your app with Microsoft Accounts and Azure AD accounts is now one simple process.</span></span>  <span data-ttu-id="93531-116">Вы можете использовать один набор конечных точек, одну библиотеку и один процесс регистрации приложения для получения доступа как к потребительскому, так и корпоративному миру.</span><span class="sxs-lookup"><span data-stu-id="93531-116">You can use a single set of endpoints, a single library, and a single app registration to gain access to both the consumer and enterprise worlds.</span></span>  <span data-ttu-id="93531-117">Дополнительные сведения о конечной точке версии 2.0 см. в этом [обзоре](active-directory-appmodel-v2-overview.md).</span><span class="sxs-lookup"><span data-stu-id="93531-117">To learn more about the v2.0 endpoint, check out [the overview](active-directory-appmodel-v2-overview.md).</span></span>

## <a name="new-app-registration-portal"></a><span data-ttu-id="93531-118">Новый портал регистрации приложений</span><span class="sxs-lookup"><span data-stu-id="93531-118">New app registration portal</span></span>
<span data-ttu-id="93531-119">Чтобы зарегистрировать приложение, которое работает с конечной точкой версии 2.0, необходимо использовать новый портал регистрации приложения: [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList).</span><span class="sxs-lookup"><span data-stu-id="93531-119">To register an app that works with the v2.0 endpoint, you must use a new app registration portal: [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList).</span></span>  <span data-ttu-id="93531-120">Это портал, где вы можете получить идентификатор приложения, настроить внешний вид страницы входа приложения и т. д.</span><span class="sxs-lookup"><span data-stu-id="93531-120">This is the portal where you can obtain an application ID, customize the appearance of your app's sign-in page, and more.</span></span>  <span data-ttu-id="93531-121">Для доступа к порталу нужна только учетная запись Майкрософт — личная, рабочая или учебная.</span><span class="sxs-lookup"><span data-stu-id="93531-121">All you need to access the portal is a Microsoft powered account - either personal or work/school account.</span></span>

## <a name="one-app-id-for-all-platforms"></a><span data-ttu-id="93531-122">Один идентификатор приложения для всех платформ</span><span class="sxs-lookup"><span data-stu-id="93531-122">One app ID for all platforms</span></span>
<span data-ttu-id="93531-123">Если вы использовали Azure Active Directory, вы, вероятно, зарегистрировали несколько различных приложений для одного проекта.</span><span class="sxs-lookup"><span data-stu-id="93531-123">If you've used Azure Active Directory, you've probably registered several different apps for a single project.</span></span>  <span data-ttu-id="93531-124">Например, если вы создали и веб-сайт, и приложение для iOS, вам было необходимо зарегистрировать их отдельно с использованием двух различных идентификаторов приложений.</span><span class="sxs-lookup"><span data-stu-id="93531-124">For example, if you built both a website and an iOS app, you had to register them separately, using two different Application Ids.</span></span> <span data-ttu-id="93531-125">Портал регистрации приложения Azure AD требует отдельной регистрации.</span><span class="sxs-lookup"><span data-stu-id="93531-125">The Azure AD app registration portal forced you to make this distinction during registration:</span></span>

![Старый пользовательский интерфейс регистрации приложения](../../media/active-directory-v2-flows/old_app_registration.PNG)

<span data-ttu-id="93531-127">Точно так же, если у вас был веб-сайт и серверный веб-API, вы могли зарегистрировать их как отдельные приложения в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="93531-127">Similarly, if you had a website and a backend web api, you might have registered each as a separate app in Azure AD.</span></span>  <span data-ttu-id="93531-128">Если же у вас было приложение для iOS и Android, вы также могли зарегистрировать два различных приложения.</span><span class="sxs-lookup"><span data-stu-id="93531-128">Or if you had an iOS app and an Android app, you also might have registered two different apps.</span></span>  <span data-ttu-id="93531-129">Регистрация каждого компонента приложения привела бы к непредсказуемой работе для разработчиков и клиентов:</span><span class="sxs-lookup"><span data-stu-id="93531-129">Registering each component of an application led to some unexpected behaviors for developers and their customers:</span></span>

* <span data-ttu-id="93531-130">Каждый компонент отображался бы как отдельное приложение в клиенте Azure Active Directory каждого пользователя.</span><span class="sxs-lookup"><span data-stu-id="93531-130">Each component appeared as a separate app in the Azure Active Directory tenant of each customer.</span></span>
* <span data-ttu-id="93531-131">При попытке администратора клиента применить политику для приложения, управлять доступом к приложению или удалить приложение — все эти операции пришлось бы выполнять отдельно для каждого компонента приложения.</span><span class="sxs-lookup"><span data-stu-id="93531-131">When a tenant administrator attempted to apply policy to, manage access to, or delete an app, they would have to do so for each component of the app.</span></span>
* <span data-ttu-id="93531-132">Если бы клиенты предоставили свое согласие на такое использование приложения, каждый компонент появился бы на экране согласия как отдельное приложение.</span><span class="sxs-lookup"><span data-stu-id="93531-132">When customers consented to an application, each component would appear in the consent screen as a distinct application.</span></span>

<span data-ttu-id="93531-133">С конечной точкой версии 2.0 теперь можно зарегистрировать все компоненты проекта вместе, а также использовать один идентификатор приложения для всего проекта.</span><span class="sxs-lookup"><span data-stu-id="93531-133">With the v2.0 endpoint, you can now register all components of your project as a single app registration, and use a single Application Id for your entire project.</span></span>  <span data-ttu-id="93531-134">Можно добавить несколько "платформ" для каждого проекта и предоставить соответствующие данные для каждой добавляемой платформы.</span><span class="sxs-lookup"><span data-stu-id="93531-134">You can add several "platforms" to a each project, and provide the appropriate data for each platform you add.</span></span>  <span data-ttu-id="93531-135">Конечно, вы можете создавать столько приложений, сколько хотите, в зависимости от требований, но в большинстве случаев потребуется только один идентификатор приложения.</span><span class="sxs-lookup"><span data-stu-id="93531-135">Of course, you can create as many apps as you like depending on your requirements, but for the majority of cases only one Application Id should be necessary.</span></span>

<span data-ttu-id="93531-136">Мы стремимся к тому, чтобы упростить управление приложениями и их разработку, а также создать консолидированное представление проекта, с которым вы можете работать.</span><span class="sxs-lookup"><span data-stu-id="93531-136">Our aim is that this will lead to a more simplified app management and development experience, and create a more consolidated view of a single project that you might be working on.</span></span>

## <a name="scopes-not-resources"></a><span data-ttu-id="93531-137">Области, а не ресурсы</span><span class="sxs-lookup"><span data-stu-id="93531-137">Scopes, not resources</span></span>
<span data-ttu-id="93531-138">В Azure Active Directory приложение может вести себя как **ресурс** или получатель маркеров.</span><span class="sxs-lookup"><span data-stu-id="93531-138">In Azure Active Directory, an app can behave as a **resource**, or a recipient of tokens.</span></span>  <span data-ttu-id="93531-139">Ресурс может определить несколько **областей** или **разрешений oAuth2**, которые он распознает, позволяя клиентским приложениям запрашивать маркеры к этому ресурсу для определенного набора областей.</span><span class="sxs-lookup"><span data-stu-id="93531-139">A resource can define a number of **scopes** or **oAuth2Permissions** that it understands, allowing client apps to request tokens to that resource for a certain set of scopes.</span></span>  <span data-ttu-id="93531-140">Рассмотрим API Azure AD Graph в качестве примера ресурса.</span><span class="sxs-lookup"><span data-stu-id="93531-140">Consider the Azure AD Graph API as an example of a resource:</span></span>

* <span data-ttu-id="93531-141">Идентификатор ресурса или `AppID URI`: `https://graph.windows.net/`</span><span class="sxs-lookup"><span data-stu-id="93531-141">Resource Identifier, or `AppID URI`: `https://graph.windows.net/`</span></span>
* <span data-ttu-id="93531-142">Области или `OAuth2Permissions`: `Directory.Read`, `Directory.Write` и т. п.</span><span class="sxs-lookup"><span data-stu-id="93531-142">Scopes, or `OAuth2Permissions`: `Directory.Read`, `Directory.Write`, etc.</span></span>  

<span data-ttu-id="93531-143">Все это справедливо и для конечной точки версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="93531-143">All of this holds true for the the v2.0 endpoint.</span></span>  <span data-ttu-id="93531-144">Приложение по-прежнему может вести себя как ресурс, определять области и идентифицироваться по URI.</span><span class="sxs-lookup"><span data-stu-id="93531-144">An app can still behave as resource, define scopes, and be identified by a URI.</span></span>  <span data-ttu-id="93531-145">Клиентские приложения по-прежнему могут запрашивать доступ к этим областям.</span><span class="sxs-lookup"><span data-stu-id="93531-145">Client apps can still request access to those scopes.</span></span>  <span data-ttu-id="93531-146">Однако способ запроса клиентами этих разрешений изменился.</span><span class="sxs-lookup"><span data-stu-id="93531-146">However, the way in which a client requests those permissions has changed.</span></span>  <span data-ttu-id="93531-147">В прошлом запрос авторизации OAuth 2.0 в Azure AD выглядел так:</span><span class="sxs-lookup"><span data-stu-id="93531-147">In the past, an OAuth 2.0 authorize request to Azure AD might have looked like:</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&resource=https%3A%2F%2Fgraph.windows.net%2F
...
```

<span data-ttu-id="93531-148">где параметр **resource** указывает, к какому ресурсу клиентское приложение запрашивает авторизацию.</span><span class="sxs-lookup"><span data-stu-id="93531-148">where the **resource** parameter indicated which resource the client app is requesting authorization for.</span></span>  <span data-ttu-id="93531-149">Служба Azure AD определяла разрешения, необходимые приложению, на основе статической конфигурации на портале Azure и выдавала маркеры соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="93531-149">Azure AD computed the permissions required by the app based on static configuration in the Azure Portal, and issued tokens accordingly.</span></span>  <span data-ttu-id="93531-150">Теперь же запрос авторизации OAuth 2.0 выглядит так:</span><span class="sxs-lookup"><span data-stu-id="93531-150">Now, the same OAuth 2.0 authorize request looks like:</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

<span data-ttu-id="93531-151">где параметр **scope** указывает, для каких ресурсов и разрешений приложение запрашивает авторизацию.</span><span class="sxs-lookup"><span data-stu-id="93531-151">where the **scope** parameter indicates which resource and permissions the app is requesting authorization for.</span></span> <span data-ttu-id="93531-152">Нужный ресурс по-прежнему присутствует в запросе — просто он состоит из каждого значения параметра области.</span><span class="sxs-lookup"><span data-stu-id="93531-152">The desired resource is still very present in the request - it is simply encompassed in each of the values of the scope parameter.</span></span>  <span data-ttu-id="93531-153">Используя параметр области таким образом, конечная точка версии 2.0 обладает улучшенной совместимостью со спецификацией OAuth 2.0 и улучшенной поддержкой отраслевых стандартов.</span><span class="sxs-lookup"><span data-stu-id="93531-153">Using the scope parameter in this manner allows the v2.0 endpoint to be more compliant with the OAuth 2.0 specification, and aligns more closely with common industry practices.</span></span>  <span data-ttu-id="93531-154">Это также позволяет приложениям реализовать [добавочное согласие](#incremental-and-dynamic-consent), описанное в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="93531-154">It also enables apps to perform [incremental consent](#incremental-and-dynamic-consent), which is described in the next section.</span></span>

## <a name="incremental-and-dynamic-consent"></a><span data-ttu-id="93531-155">Добавочное и динамическое согласие</span><span class="sxs-lookup"><span data-stu-id="93531-155">Incremental and dynamic consent</span></span>
<span data-ttu-id="93531-156">Приложения, зарегистрированные ранее в Azure AD, должны были указывать необходимые разрешения OAuth 2.0 на портале Azure во время создания приложения:</span><span class="sxs-lookup"><span data-stu-id="93531-156">Apps registered in Azure AD previously needed to specify their required OAuth 2.0 permissions in the Azure Portal, at app creation time:</span></span>

![Пользовательский интерфейс регистрации разрешений](../../media/active-directory-v2-flows/app_reg_permissions.PNG)

<span data-ttu-id="93531-158">Разрешения, необходимые приложению, настраивались **статически**.</span><span class="sxs-lookup"><span data-stu-id="93531-158">The permissions an app required were configured **statically**.</span></span>  <span data-ttu-id="93531-159">Хотя это позволяло хранить конфигурацию приложения на портале и упрощало код, для разработчиков появлялись определенные сложности.</span><span class="sxs-lookup"><span data-stu-id="93531-159">While this allowed configuration of the app to exist in the Azure Portal and kept the code nice and simple, it presents a few issues for developers:</span></span>

* <span data-ttu-id="93531-160">Приложению должны были быть известны все разрешения, которые могли понадобиться во время создания приложения.</span><span class="sxs-lookup"><span data-stu-id="93531-160">An app had to know all of the permissions it would ever need at app creation time.</span></span>  <span data-ttu-id="93531-161">Добавить разрешения в дальнейшем было не так просто.</span><span class="sxs-lookup"><span data-stu-id="93531-161">Adding permissions over time was a difficult process.</span></span>
* <span data-ttu-id="93531-162">Приложению заранее должны были быть известны все ресурсы, к которым оно будет обращаться.</span><span class="sxs-lookup"><span data-stu-id="93531-162">An app had to know all of the resources it would ever access ahead of time.</span></span>  <span data-ttu-id="93531-163">Было трудно создавать приложения, использующие произвольное количество ресурсов.</span><span class="sxs-lookup"><span data-stu-id="93531-163">It was difficult to create apps that could access an arbitrary number of resources.</span></span>
* <span data-ttu-id="93531-164">Приложение должно было запрашивать все разрешения, которые могли потребоваться при первом входе пользователя в систему.</span><span class="sxs-lookup"><span data-stu-id="93531-164">An app had to request all the permissions it would ever need upon the user's first sign-in.</span></span>  <span data-ttu-id="93531-165">В некоторых случаях это приводило к получению большого списка разрешений, из-за чего пользователи не разрешали приложению доступ при первоначальном входе.</span><span class="sxs-lookup"><span data-stu-id="93531-165">In some cases this led to a very long list of permissions, which discouraged end-users from approving the app's access on initial sign-in.</span></span>

<span data-ttu-id="93531-166">В конечной точке версии 2.0 можно указывать разрешения, необходимые приложению, **динамически**во время обычного использования приложения.</span><span class="sxs-lookup"><span data-stu-id="93531-166">With the v2.0 endpoint, you can specify the permissions your app needs **dynamically**, at runtime, during regular usage of your app.</span></span>  <span data-ttu-id="93531-167">Для этого можно указать области, требуемые приложению в любой момент времени, включив их в параметр `scope` авторизации запроса:</span><span class="sxs-lookup"><span data-stu-id="93531-167">To do so, you can specify the scopes your app needs at any given point in time by including them in the `scope` parameter of an authorization request:</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

<span data-ttu-id="93531-168">Пример выше запрашивает разрешение на чтение данных каталога пользователя Azure AD, а также на запись данных в каталог.</span><span class="sxs-lookup"><span data-stu-id="93531-168">The above requests permission for the app to read an Azure AD user's directory data, as well as write data to their directory.</span></span>  <span data-ttu-id="93531-169">Если пользователи предоставили эти разрешения в прошлом для этого конкретного приложения, они просто введут свои учетные данные и войдут в приложение.</span><span class="sxs-lookup"><span data-stu-id="93531-169">If the user has consented to those permissions in the past for this particular app, they will simply enter their credentials and be signed into the app.</span></span>  <span data-ttu-id="93531-170">Если пользователи не предоставили какие-либо из этих разрешений, конечная точка версии 2.0 запросит у пользователя эти разрешения.</span><span class="sxs-lookup"><span data-stu-id="93531-170">If the user has not consented to any of these permissions, the v2.0 endpoint will ask the user for consent to those permissions.</span></span>  <span data-ttu-id="93531-171">Дополнительные сведения см. в статье [Области, разрешения и предоставление согласия для конечной точки версии 2.0](active-directory-v2-scopes.md).</span><span class="sxs-lookup"><span data-stu-id="93531-171">To learn more, you can read up on [permissions, consent, and scopes](active-directory-v2-scopes.md).</span></span>

<span data-ttu-id="93531-172">Возможность приложения динамически запрашивать разрешения с помощью параметра `scope` дает вам полный контроль над взаимодействием с пользователями.</span><span class="sxs-lookup"><span data-stu-id="93531-172">Allowing an app to request permissions dynamically via the `scope` parameter gives you full control over your user's experience.</span></span>  <span data-ttu-id="93531-173">При желании можно запросить все разрешения в первоначальном запросе авторизации.</span><span class="sxs-lookup"><span data-stu-id="93531-173">If you wish, you can choose to frontload your consent experience and ask for all permissions in one initial authorization request.</span></span>  <span data-ttu-id="93531-174">Или же, если приложению требуется множество разрешений, вы можете запрашивать их у пользователей постепенно, когда они попытаются применять некоторые функции приложения с течением времени.</span><span class="sxs-lookup"><span data-stu-id="93531-174">Or if your app requires a large number of permissions, you can choose to gather those permissions from the user incrementally, as they attempt to use certain features of your app over time.</span></span>

## <a name="well-known-scopes"></a><span data-ttu-id="93531-175">Хорошо известные области</span><span class="sxs-lookup"><span data-stu-id="93531-175">Well-known scopes</span></span>
#### <a name="offline-access"></a><span data-ttu-id="93531-176">Автономный доступ</span><span class="sxs-lookup"><span data-stu-id="93531-176">Offline access</span></span>
<span data-ttu-id="93531-177">Приложениям, использующим конечную точку версии 2.0, могут потребоваться новые хорошо известные разрешения для приложений — область `offline_access`.</span><span class="sxs-lookup"><span data-stu-id="93531-177">Apps using the v2.0 endpoint may require the use of a new well-known permission for apps - the `offline_access` scope.</span></span>  <span data-ttu-id="93531-178">Всем приложения требуется запросить это разрешение, если им необходимо доступ к ресурсам от имени пользователя в течение длительного времени, даже если пользователь не работает с приложением активно.</span><span class="sxs-lookup"><span data-stu-id="93531-178">All apps will need to request this permission if they need to access resources on the behalf of a user for a prolonged period of time, even when the user may not be actively using the app.</span></span>  <span data-ttu-id="93531-179">Область `offline_access` отображается в диалоговых окнах запроса согласия как разрешение "Доступ к данным в автономном режиме", которое пользователь должен принять.</span><span class="sxs-lookup"><span data-stu-id="93531-179">The `offline_access` scope will appear to the user in consent dialogs as "Access your data offline", which the user must agree to.</span></span>  <span data-ttu-id="93531-180">Запрос разрешения `offline_access` позволит веб-приложению получать маркеры обновления OAuth 2.0 от конечной точки версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="93531-180">Requesting the `offline_access` permission will enable your web app to receive OAuth 2.0 refresh_tokens from the v2.0 endpoint.</span></span>  <span data-ttu-id="93531-181">У маркеров обновления длительный срок действия, и их можно заменить на новые маркеры доступа OAuth 2.0 на значительные периоды доступа.</span><span class="sxs-lookup"><span data-stu-id="93531-181">Refresh_tokens are long-lived, and can be exchanged for new OAuth 2.0 access_tokens for extended periods of access.</span></span>  

<span data-ttu-id="93531-182">Если приложение не запрашивает область `offline_access`, оно не получит маркеры обновления.</span><span class="sxs-lookup"><span data-stu-id="93531-182">If your app does not request the `offline_access` scope, it will not receive refresh_tokens.</span></span>  <span data-ttu-id="93531-183">Это значит, что при использовании кода авторизации в потоке кода авторизации OAuth 2.0 вы получите только маркер доступа из конечной точки `/token`.</span><span class="sxs-lookup"><span data-stu-id="93531-183">This means that when you redeem an authorization_code in the OAuth 2.0 authorization code flow, you will only receive back an access_token from the `/token` endpoint.</span></span>  <span data-ttu-id="93531-184">Маркер доступа будет действительным короткое время (обычно один час), но в конечном итоге срок его действия истечет.</span><span class="sxs-lookup"><span data-stu-id="93531-184">That access_token will remain valid for a short period of time (typically one hour), but will eventually expire.</span></span>  <span data-ttu-id="93531-185">В этот момент приложение будет необходимо перенаправить пользователя обратно в конечную точку `/authorize`, чтобы получить новый код авторизации.</span><span class="sxs-lookup"><span data-stu-id="93531-185">At that point in time, your app will need to redirect the user back to the `/authorize` endpoint to retrieve a new authorization_code.</span></span>  <span data-ttu-id="93531-186">При этом пользователю может потребоваться повторно ввести учетные данные или повторно предоставить разрешения в зависимости от типа приложения.</span><span class="sxs-lookup"><span data-stu-id="93531-186">During this redirect, the user may or may not need to enter their credentials again or re-consent to permissions, depending on the the type of app.</span></span>

<span data-ttu-id="93531-187">Подробнее о протоколе OAuth 2.0, маркерах обновления и доступа см. в [справочнике по протоколу версии 2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="93531-187">To learn more about OAuth 2.0, refresh_tokens, and access_tokens, check out the [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

#### <a name="openid-profile-and-email"></a><span data-ttu-id="93531-188">OpenID, профиль и электронная почта</span><span class="sxs-lookup"><span data-stu-id="93531-188">OpenID, profile and email</span></span>
<span data-ttu-id="93531-189">Самый простой поток входа в систему OpenID Connect с помощью Azure Active Directory содержит массу информации о пользователе в результирующем маркере идентификации (id_token).</span><span class="sxs-lookup"><span data-stu-id="93531-189">Historically, the most basic OpenID Connect sign-in flow with Azure Active Directory would provide a wealth of information about the user in the resulting id_token.</span></span>  <span data-ttu-id="93531-190">Утверждения в id_token могут содержать имя пользователя, предпочтительное имя пользователя, адрес электронной почты, идентификатор объекта и другие сведения.</span><span class="sxs-lookup"><span data-stu-id="93531-190">The claims in an id_token can include the user's name, preferred username, email address, object ID, and more.</span></span>

<span data-ttu-id="93531-191">Сейчас мы ограничиваем сведения, доступные вашему приложению с помощью области `openid`.</span><span class="sxs-lookup"><span data-stu-id="93531-191">We are now restricting the information that the `openid` scope affords your app access to.</span></span>  <span data-ttu-id="93531-192">Теперь область "openid" позволит пользователю только войти в приложение и получить соответствующий идентификатор.</span><span class="sxs-lookup"><span data-stu-id="93531-192">The ‘openid’ scope will only allow your app to sign the user in, and receive an app-specific identifier for the user.</span></span>  <span data-ttu-id="93531-193">Чтобы получить личные сведения о пользователе в приложении, приложение должно запросить дополнительные разрешения у пользователя.</span><span class="sxs-lookup"><span data-stu-id="93531-193">If you want to obtain personally identifiable information (PII) about the user in your app, your app will need to request additional permissions from the user.</span></span>  <span data-ttu-id="93531-194">Мы представляем две новые области — `email` и `profile`, которые позволяют сделать это.</span><span class="sxs-lookup"><span data-stu-id="93531-194">We are introducing two new scopes – the `email` and `profile` scopes – which allow you to do so.</span></span>

<span data-ttu-id="93531-195">Область `email` довольно проста. С ее помощью приложение получает доступ к основному адресу электронной почты пользователя через утверждение `email` в маркере id_token.</span><span class="sxs-lookup"><span data-stu-id="93531-195">The `email` scope is very straightforward – it allows your app access to the user’s primary email address via the `email` claim in the id_token.</span></span>  <span data-ttu-id="93531-196">С помощью области `profile` приложение может получить другие основные сведения о пользователе: имя, предпочтительное имя пользователя, идентификатор объекта и т. д.</span><span class="sxs-lookup"><span data-stu-id="93531-196">The `profile` scope affords your app access to all other basic information about the user – their name, preferred username, object ID, and so on.</span></span>

<span data-ttu-id="93531-197">Это позволяет создать код приложения с минимальным разглашением сведений. Вы можете запросить у пользователя только те сведения, которые необходимы приложению для выполнения задания.</span><span class="sxs-lookup"><span data-stu-id="93531-197">This allows you to code your app in a minimal-disclosure fashion – you can only ask the user for the set of information that your app requires to do its job.</span></span>  <span data-ttu-id="93531-198">Дополнительные сведения об этих областях см. в [справочнике по области версии 2.0](active-directory-v2-scopes.md).</span><span class="sxs-lookup"><span data-stu-id="93531-198">For more information on these scopes, refer to [the v2.0 scope reference](active-directory-v2-scopes.md).</span></span>

## <a name="token-claims"></a><span data-ttu-id="93531-199">Утверждения маркера</span><span class="sxs-lookup"><span data-stu-id="93531-199">Token Claims</span></span>
<span data-ttu-id="93531-200">Утверждения в маркерах, выданных конечной точкой версии 2.0, не совпадают с маркерами, выданными конечными точками общедоступной службы Azure AD — приложения, переходящие на новую службу, не должны предполагать, что конкретное утверждение будет существовать в маркерах удостоверения или доступа.</span><span class="sxs-lookup"><span data-stu-id="93531-200">The claims in tokens issued by the v2.0 endpoint will not be identical to tokens issued by the generally available Azure AD endpoints - apps migrating to the new service should not assume a particular claim will exist in id_tokens or access_tokens.</span></span> <span data-ttu-id="93531-201">Подробнее об утверждениях, выдаваемых в маркерах версии 2.0, см. в [справочнике по маркерам версии 2.0](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="93531-201">To learn about the specific claims emitted in v2.0 tokens, see the [v2.0 token reference](active-directory-v2-tokens.md).</span></span>

## <a name="limitations"></a><span data-ttu-id="93531-202">Ограничения</span><span class="sxs-lookup"><span data-stu-id="93531-202">Limitations</span></span>
<span data-ttu-id="93531-203">Существует несколько ограничений, которые следует учитывать при использовании точки версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="93531-203">There are a few restrictions to be aware of when using the v2.0 point.</span></span>  <span data-ttu-id="93531-204">Изучите [документ об ограничениях версии 2.0](active-directory-v2-limitations.md) , чтобы узнать, применимы ли эти ограничения к вашему сценарию.</span><span class="sxs-lookup"><span data-stu-id="93531-204">Please refer to the [v2.0 limitations doc](active-directory-v2-limitations.md) to see if any of these restrictions apply to your particular scenario.</span></span>
