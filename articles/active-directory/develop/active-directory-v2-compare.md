---
title: "aaaWhat отличается в конечной точке v2.0 hello Azure AD? | Документация Майкрософт"
description: "Сравнение hello Azure AD, исходные и конечные точки v2.0 hello."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 5060da46-b091-4e25-9fa8-af4ae4359b6c
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/01/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: e7ed196f9053fc21db799cd6bc513ba5c2b92885
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="whats-different-about-hello-v20-endpoint"></a>Что такое различных о конечной точке v2.0 hello?
Если вы уже знакомы с Azure Active Directory или интеграцией приложений с Azure AD в прошлом hello, возможно, некоторые отличия в конечной точке v2.0 hello, который не ожидается.  Они описаны в этом документе.

> [!NOTE]
> Не все сценарии Azure Active Directory и возможности поддерживаются hello v2.0 конечной точкой.  toodetermine, если необходимо использовать конечную точку v2.0 hello, прочтите сведения о [ограничения v2.0](active-directory-v2-limitations.md).
>

## <a name="microsoft-accounts-and-azure-ad-accounts"></a>Учетные записи Майкрософт и Azure AD
Конечная точка v2.0 Hello позволяют разработчикам toowrite приложения, принимающие вход с учетными записями Майкрософт и Azure AD учетных записей, через конечную точку одного проверки подлинности.  Это дает hello toowrite возможности приложения полностью учетной записи независимой от; Это может быть игнорирующих hello типа учетной записи, которая hello пользователь входит в систему.  Конечно, вы *можно* создания приложения с учетом типа "hello" учетная запись, используемая в отдельном сеансе, но не требуется.

Например если приложение вызывает hello [Microsoft Graph](https://graph.microsoft.io), некоторые дополнительные функциональные возможности и данные будут доступны tooenterprise пользователей, например их сайтам SharePoint или данных каталога.  Но для многих действий таких как [чтение почты пользователя](https://graph.microsoft.io/docs/api-reference/v1.0/resources/message), точно можно написать код hello hello одинаково для учетных записей и учетных записей Майкрософт и Azure AD.  

Теперь интеграция приложения с учетными записями Майкрософт и Azure AD — один простой процесс.  Можно использовать один набор конечных точек, отдельную библиотеку и одно приложение регистрации toogain доступа tooboth hello потребителя и предприятия миров.  Дополнительные сведения о toolearn hello v2.0 конечной точки, ознакомьтесь с [hello Обзор](active-directory-appmodel-v2-overview.md).

## <a name="new-app-registration-portal"></a>Новый портал регистрации приложений
tooregister приложение, которое работает с конечной точкой v2.0 hello, необходимо использовать новый портал регистрации приложения: [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList).  Это hello портал, где можно получить идентификатор приложения, настроить внешний вид hello страница входа в приложения и многое другое.  Все, что нужно tooaccess hello портала — учетная запись на платформе Microsoft - личных или рабочих или учебную учетную запись.

## <a name="one-app-id-for-all-platforms"></a>Один идентификатор приложения для всех платформ
Если вы использовали Azure Active Directory, вы, вероятно, зарегистрировали несколько различных приложений для одного проекта.  Например, при построении веб-сайт и приложение iOS, необходимо было tooregister их отдельно, используя два разных идентификатора приложения. портал регистрации приложения Hello Azure AD принудительно во время регистрации вы toomake это различие:

![Старый пользовательский интерфейс регистрации приложения](../../media/active-directory-v2-flows/old_app_registration.PNG)

Точно так же, если у вас был веб-сайт и серверный веб-API, вы могли зарегистрировать их как отдельные приложения в Azure AD.  Если же у вас было приложение для iOS и Android, вы также могли зарегистрировать два различных приложения.  Регистрация каждый компонент приложения, ставших toosome непредсказуемого поведения для разработчиков и своих клиентов:

* Каждый компонент появлялись как отдельные приложения в клиенте Azure Active Directory hello каждого клиента.
* При попытке администратора клиента tooapply политики для управления доступом к или удалить приложение, они бы toodo Да для каждого компонента приложения hello.
* Когда клиенты соглашается tooan приложения, каждого компонента будет отображаются в экран согласия hello различных приложений.

С конечной точкой v2.0 hello теперь можно зарегистрировать все компоненты проекта как регистрации одного приложения и использовать один идентификатор приложения для всего проекта.  Можно добавить несколько tooa «платформы» каждого проекта и предоставить hello соответствующие данные для каждой платформы, которые можно добавить.  Конечно можно создать столько приложения, в зависимости от требований, но для большинства случаев hello только один идентификатор приложения не требуется.

Нашей целью является что это будет привести tooa дополнительные упрощенное управление приложениями и процесс разработки и создавать более объединенное представление отдельного проекта, вы можете работать на.

## <a name="scopes-not-resources"></a>Области, а не ресурсы
В Azure Active Directory приложение может вести себя как **ресурс** или получатель маркеров.  Ресурс можно определить несколько **областей** или **oAuth2Permissions** , он понимает, позволяя ресурс toothat toorequest маркеры для набор областей клиентских приложений.  Рассмотрим hello API Azure AD Graph в качестве примера ресурса.

* Идентификатор ресурса или `AppID URI`: `https://graph.windows.net/`
* Области или `OAuth2Permissions`: `Directory.Read`, `Directory.Write` и т. п.  

Все это справедливо и для конечной точки v2.0 hello hello.  Приложение по-прежнему может вести себя как ресурс, определять области и идентифицироваться по URI.  Клиентские приложения по-прежнему можно запросить toothose области доступа.  Тем не менее был изменен способом hello, в котором клиент запрашивает эти разрешения.  В прошлом hello OAuth 2.0 авторизация tooAzure запрос, который может выглядела AD.

```
GET https://login.microsoftonline.com/common/oauth2/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&resource=https%3A%2F%2Fgraph.windows.net%2F
...
```

Здравствуйте, где **ресурсов** параметр указывает, какой ресурс hello клиентское приложение запрашивает авторизацию для.  Azure AD, рассчитанное hello разрешениях, необходимых для приложения hello на основании статической конфигурации в hello портал Azure и соответствующим образом выданных маркеров.  Теперь hello же OAuth 2.0 авторизовать запрос выглядит:

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

Здравствуйте, где **область** параметр указывает, какой ресурс и разрешения приложения hello запрашивает авторизацию. Hello требуемого ресурса по-прежнему очень наличие в запросе hello — просто указан в каждом hello значений параметра области hello.  С помощью параметра области hello таким способом позволяет hello v2.0 конечной точки toobe более совместимый со спецификацией hello OAuth 2.0, а более точно с распространенные приемы отрасли.  Она также позволяет приложениям tooperform [добавочное согласия](#incremental-and-dynamic-consent), который описан в следующем разделе hello.

## <a name="incremental-and-dynamic-consent"></a>Добавочное и динамическое согласие
Приложения зарегистрирована в Azure AD ранее необходимости toospecify необходимые разрешения OAuth 2.0 в hello портала Azure во время создания приложения:

![Пользовательский интерфейс регистрации разрешений](../../media/active-directory-v2-flows/app_reg_permissions.PNG)

необходимые приложения были настроены разрешения Hello **статически**.  Хотя это допускается настройка tooexist приложения hello в hello портала Azure и сохранять hello кода, работы с низким приоритетом и простой, он возвращает несколько проблем для разработчиков:

* Приложение было tooknow все разрешения hello, когда-либо потребуется во время создания приложения.  Добавить разрешения в дальнейшем было не так просто.
* Приложение было tooknow все ресурсы hello, никогда не будет доступа к заранее.  Было трудно toocreate приложений, которые может получить доступ к произвольное количество ресурсов.
* Приложение было toorequest все hello разрешения, которые когда-либо потребуется после hello пользователя первый вход в систему.  В некоторых случаях это привело tooa очень длинный список разрешений, которые конечные пользователи из утверждение приложение hello доступ на начальной вход, не рекомендуется.

С конечной точкой v2.0 hello, вы можете указать разрешения hello потребностей приложения **динамически**, во время выполнения во время регулярного использования приложения.  toodo таким образом, можно указать hello областей потребностям приложения в любой момент времени, включая их в hello `scope` параметр запроса авторизации:

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

Hello выше запрашивает разрешение для tooread приложения hello пользователя Azure AD данных каталога, а также каталог tootheir записи данных.  Если hello пользователь согласился toothose разрешений в прошлом hello для конкретного приложения, они просто будут вводить свои учетные данные и войти в приложение hello.  Если пользователь hello не согласился tooany эти разрешения, конечная точка v2.0 hello запросит пользователя hello согласия toothose разрешения.  Дополнительные toolearn, можно получить на [разрешений, согласия и областей](active-directory-v2-scopes.md).

Позволяет приложению разрешения toorequest динамически посредством hello `scope` параметр дает полный контроль над вашей пользователем.  При желании вы можете toofrontload вашего согласия возникать и запросить все разрешения в одном запросе начальной авторизации.  Или, если вашему приложению требуется большое количество разрешений, можно выбрать toogather эти разрешения пользователя hello постепенно, как они пытаются toouse некоторые возможности приложения со временем.

## <a name="well-known-scopes"></a>Хорошо известные области
#### <a name="offline-access"></a>Автономный доступ
Приложения с помощью конечной точки v2.0 hello могут требовать hello использования нового хорошо известного разрешения для приложений - hello `offline_access` области.  Все приложения потребуется toorequest это разрешение в случае необходимости tooaccess ресурсов на hello имени пользователя в течение длительного времени, даже если hello пользователя может активно не используется приложение hello.  Hello `offline_access` область будет отображаться пользователю toohello согласию диалоговые окна как «Доступ к данным вне сети», какие hello пользователь должен принять.  Запрашивающий hello `offline_access` разрешение позволит вашей tooreceive приложения web refresh_tokens OAuth 2.0 от конечной точки v2.0 hello.  У маркеров обновления длительный срок действия, и их можно заменить на новые маркеры доступа OAuth 2.0 на значительные периоды доступа.  

Если приложение не запрашивает hello `offline_access` области, он не будет получать refresh_tokens.  Это означает, что когда вы активируете значение authorization_code потока кода авторизации OAuth 2.0 hello, вы будете получать обратно access_token из hello `/token` конечной точки.  Маркер доступа будет действительным короткое время (обычно один час), но в конечном итоге срок его действия истечет.  На момент времени, вашему приложению потребуется tooredirect hello пользователя задней toohello `/authorize` конечная точка tooretrieve новое значение authorization_code.  Во время этого перенаправления hello пользователь может или могут не tooenter свои учетные данные требуются еще раз или повторно согласия toopermissions, в зависимости от типа приложения hello hello.

Дополнительные сведения об OAuth 2.0, refresh_tokens и access_tokens, извлечение hello toolearn [v2.0 протокола ссылка](active-directory-v2-protocols.md).

#### <a name="openid-profile-and-email"></a>OpenID, профиль и электронная почта
Исторически hello основным OpenID Connect входа потока в Azure Active Directory предоставляет множество сведений о пользователе hello в id_token полученный hello.  правила Hello в id_token могут включать hello пользователя имя, предпочтительным имя пользователя, адрес электронной почты, идентификатор объекта и многое другое.

Приносим теперь ограничение hello, hello `openid` область позволяет вашему приложению доступ к.  область «openid» Hello только разрешить пользователей приложения toosign hello в и получать идентификатор конкретного приложения для пользователя hello.  Если требуется tooobtain персональные данные (PII) о пользователе hello в приложении, вашему приложению потребуется toorequest дополнительные разрешения у пользователя hello.  Мы представляем две новые области — hello `email` и `profile` областей — позволяющих toodo таким образом.

Hello `email` область очень проста – он позволяет вашего приложения доступа toohello основной адрес электронной почты пользователя через hello `email` утверждения в hello id_token.  Hello `profile` область предоставляет доступ вашего приложения tooall другие основные сведения о hello пользователей и их имя, предпочтительным username, идентификатор объекта и т. д.

Это позволяет toocode приложения в режиме минимальной раскрытие — можно только запросить пользователя hello hello набор сведений, что приложение требуется toodo свою работу.  Дополнительные сведения об этих областей, см. в разделе слишком[hello ссылку область v2.0](active-directory-v2-scopes.md).

## <a name="token-claims"></a>Утверждения маркера
Hello утверждений в токены, выданные конечной точки v2.0 hello не будет идентичные tootokens выданный hello Azure AD, обычно доступные конечные точки — перенос toohello новые службы приложений не следует считать, что определенный утверждения будет существовать в id_tokens или access_tokens. toolearn о hello конкретных утверждений в токены v2.0 разделе hello [ссылку на маркер v2.0](active-directory-v2-tokens.md).

## <a name="limitations"></a>Ограничения
Существует несколько ограничений toobe учитывать при использовании точки v2.0 hello.  См. toohello [doc ограничения v2.0](active-directory-v2-limitations.md) toosee, если применим один из этих ограничений tooyour определенного сценария.
