---
title: "Вопросы безопасности и конфиденциальности Cloud App Discovery | Документация Майкрософт"
description: "В этой статье рассматриваются вопросы безопасности и конфиденциальности Cloud App Discovery."
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
ms.assetid: 2fce5c82-d3de-4097-808f-40214768df9e
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/05/2017
ms.author: markvi
ms.reviewer: nigu
ms.openlocfilehash: 1510b7a91d7eea4d16d781299bc9948da4324c51
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="cloud-app-discovery-security-and-privacy-considerations"></a><span data-ttu-id="29447-103">Вопросы безопасности и конфиденциальности Cloud App Discovery</span><span class="sxs-lookup"><span data-stu-id="29447-103">Cloud App Discovery Security and Privacy Considerations</span></span>
<span data-ttu-id="29447-104">Корпорация Майкрософт заботится о вашей конфиденциальности и безопасности ваших данных, выпуская программное обеспечение и службы, которые помогают вам управлять безопасностью своей организации.</span><span class="sxs-lookup"><span data-stu-id="29447-104">Microsoft is committed to protecting your privacy and securing your data, while delivering software and services that help you manage the security of your organization.</span></span>  
<span data-ttu-id="29447-105">Мы понимаем: когда вы доверяете свои данные сторонним организациям, это доверие должно подкрепляться инвестициями в надежные технологии безопасности и соответствующим опытом.</span><span class="sxs-lookup"><span data-stu-id="29447-105">We recognize that when you entrust your data to others, that trust requires rigorous security engineering investments and expertise to back it.</span></span>
<span data-ttu-id="29447-106">Корпорация Майкрософт следует строгим нормативным требованиям и правилам безопасности — от надежных методов разработки программного обеспечения до эксплуатации служб.</span><span class="sxs-lookup"><span data-stu-id="29447-106">Microsoft adheres to strict compliance and security guidelines from secure software development lifecycle practices to operating a service.</span></span>  
<span data-ttu-id="29447-107">Безопасность и защита данных — главный приоритет корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="29447-107">Securing and protecting data is a top priority at Microsoft.</span></span>

<span data-ttu-id="29447-108">В этой статье описывается сбор, обработка и защита данных в агенте Cloud App Discovery службы Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="29447-108">This topic explains how data is collected, processed, and secured within Azure Active Directory Cloud App Discovery</span></span>

## <a name="overview"></a><span data-ttu-id="29447-109">Обзор</span><span class="sxs-lookup"><span data-stu-id="29447-109">Overview</span></span>
<span data-ttu-id="29447-110">Cloud App Discovery — это компонент Azure AD, размещенный в Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="29447-110">Cloud App Discovery is a feature of Azure AD and is hosted in Microsoft Azure.</span></span>  
<span data-ttu-id="29447-111">Агент Cloud App Discovery Endpoint Agent используется для сбора данных об обнаружении приложений от компьютеров, которыми управляет ИТ-подразделение.</span><span class="sxs-lookup"><span data-stu-id="29447-111">The Cloud App Discovery endpoint agent is used to collect application discovery data from IT managed machines.</span></span>  
<span data-ttu-id="29447-112">Собранные данные безопасно отправляются по зашифрованному каналу в службу Cloud App Discovery Azure AD.</span><span class="sxs-lookup"><span data-stu-id="29447-112">The collected data is sent securely over an encrypted channel to the Azure AD Cloud App Discovery service.</span></span>  
<span data-ttu-id="29447-113">Затем данные Cloud App Discovery для организации отображаются на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="29447-113">The Cloud App Discovery data for an organization is then visible in the Azure portal.</span></span> 

![Как работает Cloud App Discovery](./media/active-directory-cloudappdiscovery-security-and-privacy-considerations/cad01.png) 

<span data-ttu-id="29447-115">В следующих разделах рассматривается защита потока данных во время его перемещения из вашей организации в службу Cloud App Discovery и в конечном счете на портал Cloud App Discovery.</span><span class="sxs-lookup"><span data-stu-id="29447-115">The following sections follow the flow of information and describe how it is secured as it moves from your organization to the Cloud App Discovery service and ultimately to the Cloud App Discovery portal.</span></span>

## <a name="collecting-data-from-your-organization"></a><span data-ttu-id="29447-116">Сбор данных из вашей организации</span><span class="sxs-lookup"><span data-stu-id="29447-116">Collecting data from your organization</span></span>
<span data-ttu-id="29447-117">Чтобы использовать компонент Cloud App Discovery службы Azure Active Directory для получения представления о приложениях, используемых сотрудниками в организации, необходимо сначала развернуть агент Cloud App Discovery Endpoint Agent службы Azure AD на компьютерах в организации.</span><span class="sxs-lookup"><span data-stu-id="29447-117">In order to use Azure Active Directory’s Cloud App discovery feature to get insights into the applications used by employees in your organization, you need to first deploy the Azure AD Cloud App Discovery endpoint agent to machines in your organization.</span></span>

<span data-ttu-id="29447-118">Администраторы клиента Azure Active Directory (или их делегаты) могут загрузить пакет установки агентов с портала Azure.</span><span class="sxs-lookup"><span data-stu-id="29447-118">Administrators of the Azure Active Directory tenant (or their delegate) can download the agent installation package from the Azure portal.</span></span> <span data-ttu-id="29447-119">Агент можно установить вручную на каждый компьютер отдельно либо на несколько компьютеров в организации с помощью SCCM или групповой политики.</span><span class="sxs-lookup"><span data-stu-id="29447-119">The agent can either be manually installed or installed across multiple machines in the organization using SCCM or Group Policy.</span></span>

<span data-ttu-id="29447-120">Дополнительные сведения о параметрах развертывания см. в статье [Руководство по развертыванию групповой политики Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30965.cloud-app-discovery-group-policy-deployment-guide.aspx).</span><span class="sxs-lookup"><span data-stu-id="29447-120">For further instructions on deployment options, see [Cloud App Discovery Group Policy Deployment Guide](http://social.technet.microsoft.com/wiki/contents/articles/30965.cloud-app-discovery-group-policy-deployment-guide.aspx).</span></span>


### <a name="data-collected-by-the-agent"></a><span data-ttu-id="29447-121">Данные, собираемые агентом</span><span class="sxs-lookup"><span data-stu-id="29447-121">Data collected by the agent</span></span>
<span data-ttu-id="29447-122">После подключения к веб-приложению агент собирает данные, приведенные в списке ниже.</span><span class="sxs-lookup"><span data-stu-id="29447-122">The information outlined in the list below is collected by the agent when a connection is made to a Web application.</span></span> <span data-ttu-id="29447-123">Собираются только данные тех приложений, обнаружение которых настроено администратором.</span><span class="sxs-lookup"><span data-stu-id="29447-123">The information is only collected for those applications that the administrator has configured for discovery.</span></span>  
<span data-ttu-id="29447-124">Можно изменить список облачных приложений, которые агент отслеживает. Для этого на [портале Azure](https://portal.azure.com/) в колонке "Cloud App Discovery" перейдите к разделу **Параметры**->**Сбор данных**->**Список коллекции приложений**.</span><span class="sxs-lookup"><span data-stu-id="29447-124">You can edit the list of cloud apps that the agent monitors through the Cloud App Discovery blade in the Microsoft [Azure portal](https://portal.azure.com/), under **Settings**->**Data Collection**->**App Collection list**.</span></span> <span data-ttu-id="29447-125">Дополнительные сведения см. в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).</span><span class="sxs-lookup"><span data-stu-id="29447-125">For more details, see [Getting Started With Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx)</span></span>


<span data-ttu-id="29447-126">**Категория данных**: данные о пользователе.</span><span class="sxs-lookup"><span data-stu-id="29447-126">**Information Category**: User information</span></span>  
<span data-ttu-id="29447-127">**Описание**</span><span class="sxs-lookup"><span data-stu-id="29447-127">**Description**:</span></span>  
<span data-ttu-id="29447-128">имя пользователя Windows для процесса, который отправил запрос конечному веб-приложению (например, ДОМЕН\имя пользователя), и идентификатор безопасности Windows (SID) пользователя.</span><span class="sxs-lookup"><span data-stu-id="29447-128">The Windows user name of the process that made a request to the target Web application (e.g.: DOMAIN\username) as well as the Windows Security Identifier (SID) of the user.</span></span>

<span data-ttu-id="29447-129">**Категория данных**: обработка информации</span><span class="sxs-lookup"><span data-stu-id="29447-129">**Information Category**: Process information</span></span>  
<span data-ttu-id="29447-130">**Описание**</span><span class="sxs-lookup"><span data-stu-id="29447-130">**Description**:</span></span>  
<span data-ttu-id="29447-131">имя процесса, который отправил запрос конечному веб-приложению (например, iexplore.exe)</span><span class="sxs-lookup"><span data-stu-id="29447-131">The name of the process that made the request to the target Web application (e.g.: “iexplore.exe”)</span></span>

<span data-ttu-id="29447-132">**Категория данных**: сведения о компьютере</span><span class="sxs-lookup"><span data-stu-id="29447-132">**Information Category**: Machine information</span></span>  
<span data-ttu-id="29447-133">**Описание**</span><span class="sxs-lookup"><span data-stu-id="29447-133">**Description**:</span></span>  
<span data-ttu-id="29447-134">NetBIOS-имя компьютера, на котором установлен агент.</span><span class="sxs-lookup"><span data-stu-id="29447-134">The machine NetBIOS name on which the agent is installed.</span></span>

<span data-ttu-id="29447-135">**Категория данных**: сведения о трафике приложения</span><span class="sxs-lookup"><span data-stu-id="29447-135">**Information Category**: App traffic information</span></span>  
<span data-ttu-id="29447-136">**Описание**</span><span class="sxs-lookup"><span data-stu-id="29447-136">**Description**:</span></span> 

<span data-ttu-id="29447-137">Следующие сведения о подключении:</span><span class="sxs-lookup"><span data-stu-id="29447-137">The following connection information:</span></span>

* <span data-ttu-id="29447-138">исходный (локальный компьютер) и конечные IP-адреса и номера портов;</span><span class="sxs-lookup"><span data-stu-id="29447-138">The source (local computer) and destination IP addresses and port numbers</span></span>
* <span data-ttu-id="29447-139">общедоступный IP-адрес организации, с которого отправляется запрос;</span><span class="sxs-lookup"><span data-stu-id="29447-139">The public IP address of the organization through which the request goes out.</span></span>
* <span data-ttu-id="29447-140">время запроса;</span><span class="sxs-lookup"><span data-stu-id="29447-140">The time of the request</span></span>
* <span data-ttu-id="29447-141">объем отправленного и полученного трафика;</span><span class="sxs-lookup"><span data-stu-id="29447-141">The volume of traffic sent and received</span></span>
* <span data-ttu-id="29447-142">версия IP (4 или 6);</span><span class="sxs-lookup"><span data-stu-id="29447-142">The IP version (4 or 6)</span></span>
* <span data-ttu-id="29447-143">только для TLS-подключений: имя конечного узла из расширения указания имени сервера или сертификата сервера.</span><span class="sxs-lookup"><span data-stu-id="29447-143">For TLS connections only: The target host name from either the Server Name Indication extension or the server certificate.</span></span>

<span data-ttu-id="29447-144">Следующие данные HTTP:</span><span class="sxs-lookup"><span data-stu-id="29447-144">The following HTTP information:</span></span>

* <span data-ttu-id="29447-145">метод (GET, POST и т. п.);</span><span class="sxs-lookup"><span data-stu-id="29447-145">Method (GET, POST, etc.)</span></span>
* <span data-ttu-id="29447-146">протокол (HTTP/1.1 и т. п.);</span><span class="sxs-lookup"><span data-stu-id="29447-146">Protocol (HTTP/1.1, etc.)</span></span>
* <span data-ttu-id="29447-147">строка агента пользователя;</span><span class="sxs-lookup"><span data-stu-id="29447-147">User agent string</span></span>
* <span data-ttu-id="29447-148">имя узла;</span><span class="sxs-lookup"><span data-stu-id="29447-148">Hostname</span></span>
* <span data-ttu-id="29447-149">конечный URI (за исключением строки запроса);</span><span class="sxs-lookup"><span data-stu-id="29447-149">Target URI (excluding query string)</span></span>
* <span data-ttu-id="29447-150">данные о типе содержимого;</span><span class="sxs-lookup"><span data-stu-id="29447-150">Content type information</span></span>
* <span data-ttu-id="29447-151">URL-адрес источника ссылки (за исключением строки запроса).</span><span class="sxs-lookup"><span data-stu-id="29447-151">Referrer URL information (excluding query string)</span></span>

> [!NOTE]
> <span data-ttu-id="29447-152">Указанные выше данные HTTP собираются для всех незашифрованных подключений.</span><span class="sxs-lookup"><span data-stu-id="29447-152">The HTTP information above is collected for all non-encrypted connections.</span></span>
> <span data-ttu-id="29447-153">Для TLS-подключений эти данные собираются только при включении параметра «Внимательное отслеживание» на портале.</span><span class="sxs-lookup"><span data-stu-id="29447-153">For TLS connections, this information is only captured when the ‘Deep Inspection’ setting is turned on in the portal.</span></span> <span data-ttu-id="29447-154">По умолчанию этот параметр включен.</span><span class="sxs-lookup"><span data-stu-id="29447-154">The setting is ‘ON’ by default.</span></span>
> <span data-ttu-id="29447-155">Дополнительные сведения см. ниже и в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).</span><span class="sxs-lookup"><span data-stu-id="29447-155">For more details, see below, and [Getting Started With Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx)</span></span>
> 
> 

<span data-ttu-id="29447-156">Помимо данных, которые агент собирает о действиях в сети, он также собирает анонимные сведения о конфигурации программ и оборудования, отчеты об ошибках и сведения об использовании агента.</span><span class="sxs-lookup"><span data-stu-id="29447-156">In addition to the data that the agent collects about the network activity, it also collects anonymous information about the software and hardware configuration, error reports, and information about how the agent is being used.</span></span>


### <a name="how-the-agent-works"></a><span data-ttu-id="29447-157">Как работает агент</span><span class="sxs-lookup"><span data-stu-id="29447-157">How the agent works</span></span>
<span data-ttu-id="29447-158">Установка агента состоит из двух компонентов:</span><span class="sxs-lookup"><span data-stu-id="29447-158">The agent installation includes two components:</span></span>

* <span data-ttu-id="29447-159">компонент пользовательского режима;</span><span class="sxs-lookup"><span data-stu-id="29447-159">A user-mode component</span></span>
* <span data-ttu-id="29447-160">компонент драйвера режима ядра (драйвер платформы фильтрации Windows).</span><span class="sxs-lookup"><span data-stu-id="29447-160">A kernel-mode driver component (Windows Filtering Platform driver)</span></span>

<span data-ttu-id="29447-161">При первой установке на компьютер агент сохраняет его доверенный сертификат, который затем используется для безопасного подключения к службе Cloud App Discovery.</span><span class="sxs-lookup"><span data-stu-id="29447-161">When the agent is first installed it stores a machine-specific trusted certificate on the machine which it then uses to establish a secure connection with the Cloud App Discovery service.</span></span>  
<span data-ttu-id="29447-162">Через это безопасное подключение агент периодически получает конфигурацию политики из службы Cloud App Discovery.</span><span class="sxs-lookup"><span data-stu-id="29447-162">The agent periodically retrieves policy configuration from the Cloud App Discovery service over this secure connection.</span></span>  
<span data-ttu-id="29447-163">Эта политика содержит сведения об облачных приложениях, которые требуется отслеживать, а также указывает, помимо прочего, должно ли быть включено автоматическое обновление.</span><span class="sxs-lookup"><span data-stu-id="29447-163">The policy includes information about which cloud applications to monitor and whether auto-updating should be enabled, among other things.</span></span>

<span data-ttu-id="29447-164">По мере отправки и получения веб-трафика из браузера Chrome или Internet Explorer на компьютере агент Cloud App Discovery анализирует трафик и извлекает соответствующие метаданные (см. приведенный выше раздел **Данные, собираемые агентом**).</span><span class="sxs-lookup"><span data-stu-id="29447-164">As Web traffic is sent and received on the machine from Internet Explorer and Chrome, the Cloud App Discovery agent analyzes the traffic and extracts the relevant metadata (see the **Data collected by the agent** section above).</span></span>  
<span data-ttu-id="29447-165">Каждую минуту агент отправляет собранные метаданные в службу Cloud App Discovery по зашифрованному каналу.</span><span class="sxs-lookup"><span data-stu-id="29447-165">Every minute, the agent uploads the collected metadata to the Cloud App Discovery service over an encrypted channel.</span></span>

<span data-ttu-id="29447-166">Компонент драйвера перехватывает зашифрованный трафик и вставляется в зашифрованный поток.</span><span class="sxs-lookup"><span data-stu-id="29447-166">The driver component intercepts the encrypted traffic and inserts itself into the encrypted stream.</span></span> <span data-ttu-id="29447-167">Дополнительные сведения см. в приведенном ниже разделе **Перехват данных из зашифрованного подключения (внимательное отслеживание)**.</span><span class="sxs-lookup"><span data-stu-id="29447-167">More details in the **Intercepting data from encrypted connections (Deep inspection)** section below.</span></span>

### <a name="respecting-user-privacy"></a><span data-ttu-id="29447-168">Соблюдение конфиденциальности пользователей</span><span class="sxs-lookup"><span data-stu-id="29447-168">Respecting user privacy</span></span>
<span data-ttu-id="29447-169">Наша цель — предоставить администраторам средства, которые помогут установить баланс между подробным рассмотрением использования приложений и конфиденциальностью пользователей на уровне, требуемом для их организации.</span><span class="sxs-lookup"><span data-stu-id="29447-169">Our goal is to provide administrators the tools to set the balance between detailed optics into application usage and user privacy as appropriate for their organization.</span></span> <span data-ttu-id="29447-170">Для этого на странице параметров портала имеются следующие средства:</span><span class="sxs-lookup"><span data-stu-id="29447-170">To that end, we provide the following knobs in the settings page in the Portal:</span></span>

* <span data-ttu-id="29447-171">**Сбор данных**. Администраторы могут указывать приложения или категории приложений, для которых требуется обнаружение данных.</span><span class="sxs-lookup"><span data-stu-id="29447-171">**Data Collection**: Administrators can choose to specify which applications or application categories they want to get discovery data on.</span></span>
* <span data-ttu-id="29447-172">**Внимательное отслеживание**. Администраторы могут указывать, следует ли агенту собирать HTTP-трафик для SSL- или TLS-подключений (**"внимательное отслеживание"**).</span><span class="sxs-lookup"><span data-stu-id="29447-172">**Deep Inspection**: Administrators can chose to specify if the agent collects HTTP traffic for SSL/TLS connections (aka **'Deep Inspection'**).</span></span> <span data-ttu-id="29447-173">Дополнительные сведения об этом см. в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="29447-173">More on this in the next section.</span></span>
* <span data-ttu-id="29447-174">**Параметры согласия**. С помощью портала Cloud App Discovery администраторы могут указать, следует ли уведомлять пользователей о сборе данных агентом, а также следует ли получать от пользователя разрешение перед тем, как агент приступит к сбору пользовательских данных.</span><span class="sxs-lookup"><span data-stu-id="29447-174">**Consent Options**: Administrators can use the Cloud App Discovery portal to choose whether to notify users of the data collection by the agent, and whether to require user consent before the agent starts collecting user data.</span></span>

<span data-ttu-id="29447-175">Cloud App Discovery Endpoint Agent собирает только сведения, описанные в таблице выше в разделе **Данные, собираемые агентом** .</span><span class="sxs-lookup"><span data-stu-id="29447-175">The Cloud App Discovery endpoint agent only collects the information described in the **Data collected by the agent** section above.</span></span>

### <a name="intercepting-data-from-encrypted-connections-deep-inspection"></a><span data-ttu-id="29447-176">Перехват данных из зашифрованного подключения (внимательное отслеживание)</span><span class="sxs-lookup"><span data-stu-id="29447-176">Intercepting data from encrypted connections (Deep inspection)</span></span>
<span data-ttu-id="29447-177">Как упоминалось ранее, администраторы могут настроить агент для отслеживания данных из зашифрованного соединения ("внимательное отслеживание").</span><span class="sxs-lookup"><span data-stu-id="29447-177">As we mentioned earlier, administrators can configure the agent to monitor data from encrypted connections ('deep inspection').</span></span> <span data-ttu-id="29447-178">В настоящее время TLS ([Transport Layer Security](https://msdn.microsoft.com/library/windows/desktop/aa380516%28v=vs.85%29.aspx)) является одним из наиболее распространенных протоколов в Интернете.</span><span class="sxs-lookup"><span data-stu-id="29447-178">TLS ([Transport Layer Security](https://msdn.microsoft.com/library/windows/desktop/aa380516%28v=vs.85%29.aspx)) is one of the most common protocols in use on the Internet today.</span></span> <span data-ttu-id="29447-179">Благодаря шифрованию обмена данными с помощью TLS клиент может создать защищенный канал конфиденциальной связи с веб-сервером, а протокол TLS позволяет обеспечить необходимую защиту для передачи учетных данных для проверки подлинности и предотвратить раскрытие конфиденциальной информации.</span><span class="sxs-lookup"><span data-stu-id="29447-179">By encrypting communication with TLS, a client can establish a secure and private communication channel with a web server; TLS provides essential protection for passing authentication credentials and prevent the disclosure of sensitive information.</span></span>

<span data-ttu-id="29447-180">Поскольку с помощью TLS можно организовать полностью защищенный и зашифрованный канал, обеспечивающий безопасность и конфиденциальность передаваемых данных, этот протокол зачастую используют во вредоносных или злонамеренных целях.</span><span class="sxs-lookup"><span data-stu-id="29447-180">While the end-to-end secure encrypted channel provided by TLS enables important security and privacy protection, the protocol is often abused for malicious or nefarious purposes.</span></span> <span data-ttu-id="29447-181">По этой причине протокол TSL нередко называют «универсальным протоколом для обхода брандмауэра».</span><span class="sxs-lookup"><span data-stu-id="29447-181">So much so, in fact, that TLS is often referred to as the “universal firewall-bypass protocol”.</span></span> <span data-ttu-id="29447-182">Корнем проблемы является то, что большинство брандмауэров не способны проверять подключения TLS, так как на уровне приложений данные шифруются с помощью протокола SSL.</span><span class="sxs-lookup"><span data-stu-id="29447-182">The root of the problem is that most firewalls are unable to inspect TLS communication because the application-layer data is encrypted with SSL.</span></span> <span data-ttu-id="29447-183">Зная это, злоумышленники часто используют TLS для доставки пользователю вредоносных данных, будучи уверенными, что даже самые интеллектуальные брандмауэры на уровне приложений полностью слепо доверяют TLS и их задача сводится к простой ретрансляции подключения TLS между узлами.</span><span class="sxs-lookup"><span data-stu-id="29447-183">Knowing this, attackers frequently leverage TLS to deliver malicious payloads to a user confident that even the most intelligent application-layer firewalls are completely blind to TLS and must simply relay TLS communication between hosts.</span></span> <span data-ttu-id="29447-184">Часто конечные пользователи используют TLS для обхода элементов управления, применяемые корпоративными брандмауэрами и прокси-серверами, используя этот протокол для подключения к общедоступным прокси-серверам и для туннелирования протоколов, отличных от TLS, через брандмауэр, которые могут быть заблокированы политикой.</span><span class="sxs-lookup"><span data-stu-id="29447-184">End users frequently leverage TLS to bypass access controls enforced by their corporate firewalls and proxy servers, using it to connect to public proxies and for tunneling non-TLS protocols through the firewall that might otherwise be blocked by policy.</span></span>

<span data-ttu-id="29447-185">Внимательное отслеживание позволяет агенту Cloud App Discovery выступать в качестве доверенного посредника.</span><span class="sxs-lookup"><span data-stu-id="29447-185">Deep inspection allows the Cloud App Discovery agent to act as a trusted man-in-the-middle.</span></span> <span data-ttu-id="29447-186">Получив клиентский запрос на доступ к защищенному ресурсу HTTPS, драйвер Endpoint Agent прерывает подключение, устанавливает новое подключение к серверу назначения и получает его SSL-сертификат от имени клиента.</span><span class="sxs-lookup"><span data-stu-id="29447-186">When a client request is made to access an HTTPS protected resource, the Endpoint Agent driver intercepts the connection and establishes a new connection to the destination server to retrieves its SSL certificate on behalf of the client.</span></span> <span data-ttu-id="29447-187">Затем агент проверяет надежность сертификата (узнает, не отзывался ли этот сертификат, и выполняет другие процедуры) и, если проверка пройдена, копирует данные из сертификата сервера, создает на их основе свой собственный (так называемый перехваченный) сертификат и предоставляет его клиенту.</span><span class="sxs-lookup"><span data-stu-id="29447-187">The agent then verifies that the certificate can be trusted (by checking that it was not revoked, and performing other certificate checks), and if these pass, the Endpoint Agent then copies the information from the server certificate and creates its own server certificate -- known as an interception certificate -- using that information.</span></span> <span data-ttu-id="29447-188">Endpoint Agent на лету подписывает перехваченный сертификат, используя для этого корневой сертификат, установленный в хранилище доверенных сертификатов Windows.</span><span class="sxs-lookup"><span data-stu-id="29447-188">The interception certificate is signed on-the-fly by the endpoint agent with a root certificate, which is installed in the Windows trusted certificate store.</span></span> <span data-ttu-id="29447-189">Самозаверяющий корневой сертификат помечается как неэкспортируемый, и его списком ACL управляют администраторы.</span><span class="sxs-lookup"><span data-stu-id="29447-189">This self-signed root certificate is marked non-exportable and is ACL’d to administrators.</span></span> <span data-ttu-id="29447-190">Он никогда не покидает компьютер, на котором был создан.</span><span class="sxs-lookup"><span data-stu-id="29447-190">It is intended to never leave the machine on which it was created.</span></span> <span data-ttu-id="29447-191">Получив перехваченный сертификат, клиентское приложение конечного пользователя принимает его как надежный, поскольку может отследить всю цепочку сертификатов вплоть до корневого сертификата.</span><span class="sxs-lookup"><span data-stu-id="29447-191">When the end-user’s client application receives the interception certificate, it will trust it because it can successfully validate the certificate chain all the way to the root certificate.</span></span> <span data-ttu-id="29447-192">Для конечного пользователя этот процесс в основном прозрачен за исключением нескольких описанных ниже моментов.</span><span class="sxs-lookup"><span data-stu-id="29447-192">This process is mostly transparent from an end-user’s point of view with a few caveats as described below.</span></span>

<span data-ttu-id="29447-193">Благодаря внимательному отслеживанию, Cloud App Discovery Endpoint Agent может расшифровывать и проверять зашифрованные соединения TLS, упрощая тем самым работу для службы и обеспечивая предоставление подробных сведений об использовании зашифрованных облачных приложений.</span><span class="sxs-lookup"><span data-stu-id="29447-193">By enabling deep inspection, the Cloud App Discovery Endpoint Agent can decrypt and inspect TLS encrypted communications, allowing the service to reduce noise and provide insights about the usage of the encrypted cloud apps.</span></span>

#### <a name="a-word-of-caution"></a><span data-ttu-id="29447-194">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="29447-194">A word of caution</span></span>
<span data-ttu-id="29447-195">Прежде чем включить внимательное отслеживание, настоятельно рекомендуется согласовать свои намерения с юридическим отделом и отделом кадров и получить от них соответствующие разрешения.</span><span class="sxs-lookup"><span data-stu-id="29447-195">Before turning on deep inspection, it is strongly suggested that you communicate your intentions to your legal and HR departments and obtain their consent.</span></span> <span data-ttu-id="29447-196">Проверка закрытого зашифрованного соединения пользователя по объективным причинам может требовать конфиденциальности.</span><span class="sxs-lookup"><span data-stu-id="29447-196">Inspecting end user’s private encrypted communications can be a sensitive subject, for obvious reasons.</span></span> <span data-ttu-id="29447-197">Перед проведением внимательного отслеживания убедитесь в том, что ваши корпоративные политики обеспечения безопасности и допустимого использования обновлены с учетом сведений о том, что зашифрованные соединения подлежат проверке.</span><span class="sxs-lookup"><span data-stu-id="29447-197">Before a production roll-out of deep inspection, make certain that your corporate security and acceptable use policies have been updated to indicate that encrypted communication will be inspected.</span></span> <span data-ttu-id="29447-198">При настройке Cloud App Discovery для отслеживания сайтов, которые считаются конфиденциальными (таких как банковские и медицинские сайты), может также потребоваться организовать соответствующее уведомление пользователей и исключить такие сайты из проверок.</span><span class="sxs-lookup"><span data-stu-id="29447-198">User notification and exemption of sites deemed sensitive (e.g. banking and medical sites) may also be necessary if you configure Cloud App Discovery to monitor them.</span></span> <span data-ttu-id="29447-199">Как уже говорилось, с помощью портала Cloud App Discovery администраторы могут указать, следует ли уведомлять пользователей о сборе данных агентом, а также следует ли получать от пользователя разрешение перед тем, как агент приступит к сбору пользовательских данных.</span><span class="sxs-lookup"><span data-stu-id="29447-199">As mentioned above, administrators can use the Cloud App Discovery portal to choose whether to notify users of the data collection by the agent, and whether to require user consent before the agent starts collecting user data.</span></span>

### <a name="known-issues-and-drawbacks"></a><span data-ttu-id="29447-200">Известные проблемы и недостатки</span><span class="sxs-lookup"><span data-stu-id="29447-200">Known issues and drawbacks</span></span>
<span data-ttu-id="29447-201">Существует несколько ситуаций, когда перехват TLS может повлиять на взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="29447-201">There are a few cases where TLS interception may impact the end user experience:</span></span>

* <span data-ttu-id="29447-202">Сертификаты высокой надежности (EV) окрашивают адресную строку веб-браузера в зеленый цвет, что служит визуальным подтверждения того, что посещаемый веб-сайт является надежным.</span><span class="sxs-lookup"><span data-stu-id="29447-202">Extended Validation (EV) certificates render the address bar of the web browser green to act as a visual clue that you are visiting a trusted web site.</span></span> <span data-ttu-id="29447-203">При отслеживании TLS невозможно создать копию EV в сертификате, выдаваемом клиенту, поэтому веб-сайты, которые используют сертификаты высокой надежности, будут нормально работать, однако адресная строка не будет окрашена в зеленый цвет.</span><span class="sxs-lookup"><span data-stu-id="29447-203">TLS inspection cannot duplicate EV in the certificate it issues to the client, so web sites that use EV certificates will work normally but the address bar will not display green.</span></span>  
* <span data-ttu-id="29447-204">Привязка открытого ключа (привязка сертификата) предназначена для защиты пользователей от атак «злоумышленник в середине» и незаконных центров сертификации.</span><span class="sxs-lookup"><span data-stu-id="29447-204">Public key pinning (also known as certificate pinning) are designed to help protect users from man-in-the-middle attacks and rogue certificate authorities.</span></span> <span data-ttu-id="29447-205">Если корневой сертификат для привязанного веб-сайта не соответствует ни одному из сертификатов из хорошо известных ЦС, браузер отклоняет подключение и выдает сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="29447-205">When the root certificate for a pinned site does not match one of the known good CA's, the browser rejects the connection with an error.</span></span> <span data-ttu-id="29447-206">Поскольку перехват TLS, фактически, является атакой "злоумышленник в середине", установить такие соединения не удастся.</span><span class="sxs-lookup"><span data-stu-id="29447-206">Since TLS interception is, in fact, a man-in-the-middle, these connections will fail.</span></span>
* <span data-ttu-id="29447-207">Если пользователь щелкнет значок блокировки в адресной строке браузера, чтобы проверить данные о веб-сайте, он увидит цепочку сертификатов, которая заканчивается не центром сертификации, подписавшим сертификат веб-сайта, а хранилищем доверенных сертификатов Windows.</span><span class="sxs-lookup"><span data-stu-id="29447-207">If users click the lock icon in the browser address bar browser to inspect the site information, they will not see a chain ending in the certificate authority used to sign the website certificate, but instead a certificate chain ending with the Windows trusted certificate store.</span></span>

<span data-ttu-id="29447-208">Чтобы уменьшить риск возникновения таких проблем, мы отслеживаем облачные службы и клиентские приложения, о которых известно, что в них используется расширенная проверка или привязка открытого ключа, и предотвращения перехвата соответствующих подключений.</span><span class="sxs-lookup"><span data-stu-id="29447-208">To reduce the occurrences of these issues, we keep track of cloud services and client applications known to use extended validation or public key pinning and instruct the Endpoint Agent to avoid intercepting impacted connections.</span></span> <span data-ttu-id="29447-209">Но даже в этих случаях вы будете получать отчеты об использовании этих облачных приложений и объеме передаваемых данных, однако, поскольку внимательное отслеживание не проводится, дополнительные сведения об использовании таких приложений предоставляться не будут.</span><span class="sxs-lookup"><span data-stu-id="29447-209">Even in these cases, however, you will still receive reports of the use of these cloud apps and the volume of data being transferred, but since they are not deep inspected, no details about how the apps were used will be available.</span></span>

## <a name="sending-data-to-cloud-app-discovery"></a><span data-ttu-id="29447-210">Отправка данных в службу Cloud App Discovery</span><span class="sxs-lookup"><span data-stu-id="29447-210">Sending data to Cloud App Discovery</span></span>
<span data-ttu-id="29447-211">Собранные агентом метаданные кэшируются на компьютере в течение одной минуты или пока размер кэшированных данных не достигнет 5 МБ.</span><span class="sxs-lookup"><span data-stu-id="29447-211">Once metadata has been collected by the agent, it is cached on the machine for up to one minute or until the cached data reaches a size of 5MB.</span></span> <span data-ttu-id="29447-212">Затем они сжимаются и отправляются через безопасное подключение в службу Cloud App Discovery.</span><span class="sxs-lookup"><span data-stu-id="29447-212">It is then compressed and sent over a secure connection to the Cloud App Discovery service.</span></span>

<span data-ttu-id="29447-213">Если по какой-либо причине агенту не удается связаться со службой Cloud App Discovery, собранные метаданные хранятся в локальном кэше файлов, доступ к которому имеют только привилегированные пользователи компьютера (например, группа «Администраторы»).</span><span class="sxs-lookup"><span data-stu-id="29447-213">If the agent is unable to communicate with the Cloud App Discovery service for any reason, the collected metadata is stored in a local file cache that can only be accessed by privileged users on the machine (such as the Administrators group).</span></span>  
<span data-ttu-id="29447-214">Агент автоматически повторяет попытки отправить кэшированные метаданные, пока они не будут успешно получены службой Cloud App Discovery.</span><span class="sxs-lookup"><span data-stu-id="29447-214">The agent automatically attempts to resend the cached metadata until it has successfully been received by the Cloud App Discovery service.</span></span>

## <a name="receiving-the-data-at-the-service-end"></a><span data-ttu-id="29447-215">Получение данных на стороне службы</span><span class="sxs-lookup"><span data-stu-id="29447-215">Receiving the data at the service end</span></span>
<span data-ttu-id="29447-216">Агенты проходят проверку подлинности в службе Cloud App Discovery с помощью клиентского сертификата проверки подлинности для определенного компьютера, который упоминался выше, и отправляют данные по зашифрованному каналу.</span><span class="sxs-lookup"><span data-stu-id="29447-216">The agents authenticate to the Cloud App Discovery service using the machine specific client authentication certificate referenced above and forwards data over an encrypted channel.</span></span>  
<span data-ttu-id="29447-217">Конвейер аналитики службы Cloud App Discovery обрабатывает метаданные для каждого клиента отдельно, логически разделяя их на всех этапах конвейера аналитики.</span><span class="sxs-lookup"><span data-stu-id="29447-217">The Cloud App Discovery service’s analytics pipeline processes metadata for each customer separately by logically partitioning it through all stages of the analytics pipeline.</span></span>
<span data-ttu-id="29447-218">Проанализированные метаданные используются для создания различных отчетов на портале.</span><span class="sxs-lookup"><span data-stu-id="29447-218">The analyzed metadata drives the various reports in the portal.</span></span>

<span data-ttu-id="29447-219">Как необработанные, так и проанализированные метаданные хранятся в течение 180 дней.</span><span class="sxs-lookup"><span data-stu-id="29447-219">The unprocessed metadata and the analyzed metadata are stored for up to 180 days.</span></span> <span data-ttu-id="29447-220">Кроме того, клиенты могут перенаправлять проанализированные метаданные в учетную запись хранилища BLOB-объектов Azure по своему выбору.</span><span class="sxs-lookup"><span data-stu-id="29447-220">In addition, customers can choose to capture the analyzed metadata in an Azure blob storage account of their choosing.</span></span>
<span data-ttu-id="29447-221">Это полезно для последующего автономного анализа метаданных, а также для более длительного хранения данных.</span><span class="sxs-lookup"><span data-stu-id="29447-221">This is useful for offline analysis of metadata as well as longer retention of the data.</span></span>

## <a name="accessing-the-data-using-the-azure-portal"></a><span data-ttu-id="29447-222">Доступ к данным через портал Azure</span><span class="sxs-lookup"><span data-stu-id="29447-222">Accessing the data using the Azure portal</span></span>
<span data-ttu-id="29447-223">Для безопасности собранных данных только глобальные администраторы клиента имеют по умолчанию доступ к компоненту Cloud App Discovery на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="29447-223">In an effort to keep the metadata collected secure, by default only global administrators of the tenant have access to the Cloud App Discovery feature in the Azure portal.</span></span>  
<span data-ttu-id="29447-224">Тем не менее администраторы могут делегировать доступ другим пользователям или группам.</span><span class="sxs-lookup"><span data-stu-id="29447-224">However, administrators can choose to delegate this access to other users or groups.</span></span>

> [!NOTE]
> <span data-ttu-id="29447-225">Дополнительные сведения см. в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).</span><span class="sxs-lookup"><span data-stu-id="29447-225">For more details, see [Getting Started With Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx)</span></span>
> 
> 


<span data-ttu-id="29447-226">Для доступа к данным на портале пользователи должны иметь лицензию Azure AD Premium.</span><span class="sxs-lookup"><span data-stu-id="29447-226">Any user accessing the data in the portal, must be licensed with an Azure AD Premium license.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="29447-227">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="29447-227">Additional Resources</span></span>
* [<span data-ttu-id="29447-228">Как обнаруживать несанкционированные облачные приложения, которые используются в моей организации</span><span class="sxs-lookup"><span data-stu-id="29447-228">How can I discover unsanctioned cloud apps that are used within my organization</span></span>](active-directory-cloudappdiscovery-whatis.md)
* [<span data-ttu-id="29447-229">Указатель статьей по управлению приложениями в Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="29447-229">Article Index for Application Management in Azure Active Directory</span></span>](active-directory-apps-index.md)

