---
title: "Пользователи для приложения в коллекции Azure AD не подготавливаются | Документы Майкрософт"
description: "В этой статье описаны способы решения распространенных проблем, при которых пользователи, для которых была настроена подготовка в Azure AD, не появляются в приложении в коллекции Azure AD."
services: active-directory
documentationcenter: 
author: ajamess
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/04/2017
ms.author: asteen
ms.openlocfilehash: 30db71c0706de1dcc0d48fb72fa5d62475a14ba7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="no-users-are-being-provisioned-to-an-azure-ad-gallery-application"></a><span data-ttu-id="b7b2f-103">Пользователи для приложения в коллекции Azure AD не подготавливаются</span><span class="sxs-lookup"><span data-stu-id="b7b2f-103">No users are being provisioned to an Azure AD Gallery application</span></span>

<span data-ttu-id="b7b2f-104">Настройте автоматическую подготовку для приложения (проверив действительность учетных данных, с помощью которых Azure AD подключается к приложению).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-104">Once automatic provisioning has been configured for an application (including verifying that the app credentials provided to Azure AD to connect to the app are valid).</span></span> <span data-ttu-id="b7b2f-105">Пользователи и (или) группы, которые подготавливаются для приложения, определяются следующими критериями.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-105">Then users and/or groups are provisioned to the app and is determined by the following things:</span></span>

-   <span data-ttu-id="b7b2f-106">Какие пользователи и группы были **назначены** приложению.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-106">Which users and groups have been **assigned** to the application.</span></span> <span data-ttu-id="b7b2f-107">Дополнительные сведения о назначении см. в разделе [Назначение пользователя или группы корпоративному приложению в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-107">For more information on assignment, see [Assign a user or group to an enterprise app in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal).</span></span>

-   <span data-ttu-id="b7b2f-108">Было ли **сопоставление атрибутов** включено и настроено для синхронизации допустимых атрибутов из Azure AD в приложение.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-108">Whether or not **attribute mappings** are enabled, and configured to sync valid attributes from Azure AD to the app.</span></span> <span data-ttu-id="b7b2f-109">Дополнительные сведения о сопоставлении атрибутов см. в разделе [Настройка сопоставления атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-109">For more information on attribute mappings, see [Customizing User Provisioning Attribute Mappings for SaaS Applications in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings).</span></span>

-   <span data-ttu-id="b7b2f-110">Используется ли **фильтр области**, который фильтрует пользователей на основе значений указанных атрибутов.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-110">Whether or not there is a **scoping filter** present that is filtering users based on specific attribute values.</span></span> <span data-ttu-id="b7b2f-111">Дополнительные сведения о фильтрах области см. в статье [Подготовка приложений на основе атрибутов с использованием фильтров области](https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-111">For more information on scoping filters, see [Attribute-based application provisioning with scoping filters](https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters).</span></span>

<span data-ttu-id="b7b2f-112">Обнаружив, что пользователи не подготавливаются, обратитесь к журналам аудита в Azure AD и попробуйте найти записи журнала для указанного пользователя.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-112">When observing that users are not being provisioned, consult the Audit logs in Azure AD and search for log entries for a specific user.</span></span>

<span data-ttu-id="b7b2f-113">Журналы аудита для подготовки можно открыть на портале Azure на вкладке **Azure Active Directory &gt; Корпоративные приложения &gt; \[Имя приложения\] &gt; Журналы аудита**.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-113">The provisioning audit logs can be accessed in the Azure portal, in the **Azure Active Directory &gt; Enterprise Apps &gt; \[Application Name\] &gt; Audit Logs** tab.</span></span> <span data-ttu-id="b7b2f-114">Чтобы просмотреть события подготовки только для этого приложения, отфильтруйте журналы по категории **Учетная запись подготовки**.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-114">Filter the logs on the **Account Provisioning** category to only see the provisioning events for that app.</span></span> <span data-ttu-id="b7b2f-115">Найти пользователей можно по "идентификатору сопоставления", который был назначен для этих пользователей в сопоставлениях атрибутов.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-115">You can search for users based on the “matching ID” that was configured for them in the attribute mappings.</span></span> <span data-ttu-id="b7b2f-116">Предположим, что в качестве атрибута сопоставления для пользователя, для которого не выполняется подготовка, в Azure AD выбран атрибут "имя участника-пользователя" или "адрес электронной почты", и этот атрибут имеет значение "audrey@contoso.com".</span><span class="sxs-lookup"><span data-stu-id="b7b2f-116">For example, if you configured the “user principal name” or “email address” as the matching attribute on the Azure AD side, and the user not being provisioning has a value of “audrey@contoso.com”.</span></span> <span data-ttu-id="b7b2f-117">В этом случае попробуйте найти "audrey@contoso.com" в журналах аудита и просмотрите результаты поиска.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-117">Then search the audit logs for “audrey@contoso.com” and review then entries returned.</span></span>

<span data-ttu-id="b7b2f-118">В журналах аудита подготовки хранятся записи обо всех операциях, выполняемых службой подготовки, включая запросы Azure AD для назначенных пользователей, которые находятся в области для подготовки, запросы целевого приложения на наличие этих пользователей и сравнение объектов пользователя в разных системах.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-118">The provisioning audit logs record all the operations performed by the provisioning service, including querying Azure AD for assigned users that are in scope for provisioning, querying the target app for the existence of those users, comparing the user objects between the system.</span></span> <span data-ttu-id="b7b2f-119">Затем добавьте, измените или отключите учетную запись пользователя в целевой системе на основе сравнения.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-119">Then add, update, or disable the user account in the target system based on the comparison.</span></span>

## <a name="general-problem-areas-with-provisioning-to-consider"></a><span data-ttu-id="b7b2f-120">Общие проблемные области при подготовке, которые необходимо учитывать</span><span class="sxs-lookup"><span data-stu-id="b7b2f-120">General Problem Areas with Provisioning to consider</span></span>

<span data-ttu-id="b7b2f-121">Ниже приведен список общих проблемных областей, в которые можно углубиться, если у вас есть какие-то идеи.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-121">Below is a list of the general problem areas that you can drill into if you have an idea of where to start.</span></span>

* [<span data-ttu-id="b7b2f-122">Служба подготовки не запускается</span><span class="sxs-lookup"><span data-stu-id="b7b2f-122">Provisioning service does not appear to start</span></span>](#provisioning-service-does-not-appear-to-start)
* [<span data-ttu-id="b7b2f-123">Судя по журналам аудита, пользователи не подготовлены, несмотря на то, что они назначены</span><span class="sxs-lookup"><span data-stu-id="b7b2f-123">Audit logs say users are skipped and not provisioned, even though they are assigned</span></span>](#audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned)

## <a name="provisioning-service-does-not-appear-to-start"></a><span data-ttu-id="b7b2f-124">Служба подготовки не запускается</span><span class="sxs-lookup"><span data-stu-id="b7b2f-124">Provisioning service does not appear to start</span></span>

<span data-ttu-id="b7b2f-125">Предположим, что вы установили параметр **Состояние подготовки** в значение **Вкл** в разделе **Azure Active Directory &gt; Корпоративные приложения &gt; \[Имя приложения\] &gt;Подготовка** портала Azure.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-125">If you set the **Provisioning Status** to be **On** in the **Azure Active Directory &gt; Enterprise Apps &gt; \[Application Name\] &gt;Provisioning** section of the Azure portal.</span></span> <span data-ttu-id="b7b2f-126">Однако при последующей перезагрузке никакие другие сведения о состоянии на этой странице не отображаются. Вероятно, что служба запущена, но первоначальная синхронизация еще не завершена.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-126">However no other status details are shown on that page after subsequent reloads, it is likely that the service is running but has not completed an initial synchronization yet.</span></span> <span data-ttu-id="b7b2f-127">Проверьте **журналы аудита**, как описано выше, чтобы определить, какие операции выполняет служба и не возникают ли ошибки.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-127">Check the **Audit logs** described above to determine what operations the service is performing, and if there are any errors.</span></span>

>[!NOTE]
><span data-ttu-id="b7b2f-128">Первоначальная синхронизация может занять от 20 минут до нескольких часов, в зависимости от размера каталога Azure AD и количества пользователей в области подготовки.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-128">An initial sync can take anywhere from 20 minutes to several hours, depending on the size of the Azure AD directory and the number of users in scope for provisioning.</span></span> <span data-ttu-id="b7b2f-129">Последующие операции синхронизации занимают меньше времени, так как служба подготовки сохраняет "водяные знаки", которые представляют состояние обеих систем после начальной синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-129">Subsequent syncs after the initial sync are faster, as the provisioning service stores watermarks that represent the state of both systems after the initial sync.</span></span> <span data-ttu-id="b7b2f-130">Это позволяет повысить скорость последующих операций синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-130">This improves performance of subsequent syncs.</span></span>
>
>

## <a name="audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned"></a><span data-ttu-id="b7b2f-131">Судя по журналам аудита, пользователи не подготовлены, несмотря на то, что они назначены</span><span class="sxs-lookup"><span data-stu-id="b7b2f-131">Audit logs say users are skipped and not provisioned even though they are assigned</span></span>

<span data-ttu-id="b7b2f-132">Если пользователь отображается в журналах аудита как "пропущенный", очень важно ознакомиться с подробными сведениями об ошибке, чтобы определить причину.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-132">When a user shows up as “skipped” in the audit logs, it is very important to read the extended details in the log message to determine the reason.</span></span> <span data-ttu-id="b7b2f-133">Ниже приведены распространенные причины и способы устранения ошибок:</span><span class="sxs-lookup"><span data-stu-id="b7b2f-133">Below are common reasons and resolutions:</span></span>

-   <span data-ttu-id="b7b2f-134">**Настроен фильтр области** **, который фильтрует пользователей на основе значения атрибута**.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-134">**A scoping filter has been configured** **that is filtering the user out based on an attribute value**.</span></span> <span data-ttu-id="b7b2f-135">Дополнительные сведения о фильтрах области см. в разделе <https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters>.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-135">For more information on scoping filters, see <https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters>.</span></span>

-   <span data-ttu-id="b7b2f-136">**Пользователь "не имеет фактических прав".**</span><span class="sxs-lookup"><span data-stu-id="b7b2f-136">**The user is “not effectively entitled”.**</span></span> <span data-ttu-id="b7b2f-137">Если вы видите это сообщение об ошибке, это свидетельствует о наличии проблемы с записью назначения пользователя, которая хранится в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-137">If you see this specific error message, it is because there is a problem with the user assignment record stored in Azure AD.</span></span> <span data-ttu-id="b7b2f-138">Для устранения этой проблемы отмените назначение пользователя (или группы) для приложения и повторно назначьте пользователя (или группу).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-138">To fix this issue, un-assign the user (or group) from the app, and re-assign it again.</span></span> <span data-ttu-id="b7b2f-139">Дополнительные сведения о назначении см. в разделе <https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal>.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-139">For more information on assignment, see  <https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal>.</span></span>

-   <span data-ttu-id="b7b2f-140">**Обязательный атрибут для пользователя отсутствует или его значение не указано.**</span><span class="sxs-lookup"><span data-stu-id="b7b2f-140">**A required attribute is missing or not populated for a user.**</span></span> <span data-ttu-id="b7b2f-141">При настройке подготовки важно просмотреть и настроить сопоставления атрибутов и рабочие процессы, которые определяют, какие свойства пользователя (или группы) передаются из Azure AD в приложение.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-141">An important thing to consider when setting up provisioning be to review and configure the attribute mappings and workflows that define which user (or group) properties flow from Azure AD to the application.</span></span> <span data-ttu-id="b7b2f-142">К ним относится "свойство сопоставления", используемое для уникальной идентификации и сопоставления пользователей или групп между двумя системами.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-142">This includes setting the “matching property” that be used to uniquely identify and match users/groups between the two systems.</span></span> <span data-ttu-id="b7b2f-143">Дополнительные сведения об этом важном процессе см. в разделе [Настройка сопоставления атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-143">For more information on this important process, see [Customizing User Provisioning Attribute Mappings for SaaS Applications in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings).</span></span>

  * <span data-ttu-id="b7b2f-144">**Сопоставление атрибутов для групп:** подготовка имени группы и сведений о группе наряду с ее участниками (если поддерживается для некоторых приложений).</span><span class="sxs-lookup"><span data-stu-id="b7b2f-144">**Attribute mappings for groups:** Provisioning of the group name and group details, in addition to the members, if supported for some applications.</span></span> <span data-ttu-id="b7b2f-145">Вы можете включить или отключить эту функцию, включив или отключив **сопоставление** для объектов группы, отображаемых на вкладке **Подготовка**.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-145">You can enable or disable this functionality by enabling or disabling the **Mapping** for group objects shown in the **Provisioning** tab.</span></span> <span data-ttu-id="b7b2f-146">Если подготовка групп включена, обязательно ознакомьтесь с атрибутами сопоставления, чтобы убедиться, что в качестве соответствующего идентификатора используется подходящее поле.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-146">If provisioning groups is enabled, be sure to review the attribute mappings to ensure an appropriate field is being used for the “matching ID”.</span></span> <span data-ttu-id="b7b2f-147">В качестве этого поля может использоваться отображаемое имя или псевдоним электронной почты. Если соответствующее свойство для группы в Azure AD не указано или не заполнено, группа и ее участники не будут подготовлены.</span><span class="sxs-lookup"><span data-stu-id="b7b2f-147">This can be the display name or email alias), as the group and its members not be provisioned if the matching property is empty or not populated for a group in Azure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b7b2f-148">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b7b2f-148">Next steps</span></span>
[<span data-ttu-id="b7b2f-149">Служба синхронизации Azure AD Connect: общие сведения о декларативной подготовке</span><span class="sxs-lookup"><span data-stu-id="b7b2f-149">Azure AD Connect sync: Understanding Declarative Provisioning</span></span>](active-directory-aadconnectsync-understanding-declarative-provisioning.md)

