---
title: "Azure AD SSPR с компонентом обратной записи паролей | Документация Майкрософт"
description: "С помощью Azure AD и Azure AD Connect toowriteback пароли tooon локальный каталог"
services: active-directory
keywords: "Управление паролями Active Directory, управление паролями, самостоятельный сброс пароля Azure AD"
documentationcenter: 
author: MicrosoftGuyJFlo
manager: femila
ms.reviewer: gahug
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: joflore
ms.custom: it-pro
ms.openlocfilehash: 6a1dd964a51b4f3b5b0be303b722ab6deb4a6110
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="password-writeback-overview"></a>Обзор обратной записи паролей

Обратная запись паролей позволяет вам tooconfigure Azure AD пароли toowrite обратно tooyou локальной Active Directory. Она удаляет tooset hello необходимость копирования и управление паролем самообслуживания сброса сложного локального решения, и предоставляет удобный способ облачного для вашего tooreset пользователей пароли локальных независимо от их. Компонент обратной записи паролей  — это компонент [Azure Active Directory Connect](./connect/active-directory-aadconnect.md), который могут включить и использовать текущие подписчики [Azure Active Directory](active-directory-editions.md) Premium.

Обратная запись паролей предоставляет следующие функции hello

* **Обратная связь с нулевой задержкой.** Обратная запись паролей выполняется в синхронном режиме. Пользователи получают уведомления немедленно, если пароль не соответствовал политики, а также был toobe не удается сбросить или изменении по любой причине.
* **Поддерживается сброс паролей для пользователей с помощью AD FS и другими технологиями федерации** -с обратной записи паролей, при условии, что hello федеративные учетные записи пользователей синхронизируются с клиентом Azure AD, они являются может toomanage их локальной AD пароли из облака hello.
* **Поддерживается сброс паролей для пользователей с помощью [синхронизация хэшей паролей](./connect/active-directory-aadconnectsync-implement-password-synchronization.md) ** — когда служба сброса паролей hello обнаруживает, что для синхронизированной учетной включена синхронизация хэшей паролей, возвращаются оба этой учетной записи локальные и облачные пароль одновременно.
* **Поддерживается сброс паролей с hello доступ к панели и Office 365** — когда федеративные или синхронизированными паролями пользователей сопряжен toochange свои пароли с истекшим сроком действия или не истек срок действия, мы пишем среды задней tooyour локальной AD эти пароли.
* **Обратная запись паролей при их сбросе администратором поддерживает hello портал Azure** — всякий раз, когда администратор сбрасывает пароль пользователя в hello [портал Azure](https://portal.azure.com), если федеративного пользователя или пароль синхронизирован, мы настроим hello пароль Здравствуйте, администратор выбирает в локальном каталоге AD, а также. В настоящее время не поддерживается в hello портал администрирования Office.
* **Обеспечивает выполнение в локальной политики паролей AD** — когда пользователь сбрасывает свой пароль, мы убедитесь в том, что оно соответствует вашей локальной политике AD перед его применением toothat каталога. Это включает журнал, сложность, срок пользования, фильтры паролей и любые другие ограничения паролей, заданные в локальной службе AD.
* **Не требует все правила брандмауэра для входящих подключений** -обратной записи паролей ретрансляция шины обслуживания Azure используется как базовый канал связи, это означает, что у вас tooopen входящие порты в брандмауэре toowork этот компонент.
* **Отсутствие поддержки для учетных записей пользователей, существующих в защищенных группах в локальной службе Active Directory.** Дополнительные сведения о защищенных группах см. в статье [Приложение c. защищенных учетных записей и групп в Active Directory](https://technet.microsoft.com/library/dn535499.aspx).

## <a name="how-password-writeback-works"></a>Как работает обратная запись паролей

При синхронизации хэш федеративной или пароль пользователя поставляется tooreset или изменить свой пароль в облаке hello, происходит следующее hello:

1. Мы проверяем toosee тип пользователя пароль hello.
    * Если мы видим hello пароля осуществляется локально
        * Мы проверяем, если hello служба обратная запись включена и запущена, если это так, мы рекомендуем позволить пользователю hello продолжить
        * Если служба обратной записи hello не работает, мы сообщаем hello пользователя, пароль не может быть изменена теперь
2. Затем пользователь hello передает hello соответствующие вентили аутентификации и достигает hello экран сброса пароля.
3. Hello пользователь выбирает новый пароль и подтверждает его.
4. После нажатия на кнопку submit, мы зашифровать пароль открытым текстом hello с помощью симметричного ключа, который был создан во время процесса установки hello обратной записи.
5. После шифрования пароля hello, мы добавляем его в полезные данные, отправляемые через HTTPS канала tooyour конкретного клиента ретрансляции шины обслуживания (который мы также предварительно настроенный во время процесса установки обратной записи hello). Этот ретранслятор защищается случайно генерируемым паролем, который известен только локальной установленной системе.
6. По достижении служебной шины приветственное сообщение hello конечная точка сброса паролей автоматически активируется и видит, что ожидающий запрос на сброс.
7. Hello служба выполняет поиск пользователя hello рассматриваемой с помощью атрибута облачной привязки hello. Для этого toosucceed уточняющего запроса:

    * объект пользователя Hello должен существовать в пространство соединителя AD hello
    * Hello объекта-пользователя должно быть соответствующим объектом MV связанного toohello
    * объект пользователя Hello должен иметь связанный toohello соответствующим объектом соединителя AAD.
    * Hello ссылка из tooMV объектом соединителя AD должен иметь правило синхронизации hello `Microsoft.InfromADUserAccountEnabled.xxx` ссылку hello. <br> <br>
    При поступлении вызова hello из облака hello hello синхронизации подсистемой hello toolook атрибут cloudAnchor копирование объект пространства соединителя AAD hello после объекта MV toohello обратной связи hello и затем следующий hello ссылку задней toohello AD объектом. Так как может существовать несколько объектов AD (несколько лесов) для одного пользователя, модуль синхронизации hello зависит от hello hello `Microsoft.InfromADUserAccountEnabled.xxx` hello toopick ссылку исправьте значение одного их.

    > [!Note]
    > В результате этой логики Azure AD Connect должен быть доступ toocommunicate с hello эмулятор основного контроллера домена для toowork обратной записи паролей. Если вам требуется tooenable вручную, могут подключаться Azure AD Connect toohello эмулятор основного контроллера домена, щелкнув hello **свойства** соединителя синхронизации Active Directory hello, выбрав **настройки разделы каталога**. После этого найдите hello **параметры подключения для контроллера домена** статьи и установите флажок "под названием" hello **использовать только контроллеры домена предпочтительный**. Даже если hello основной контроллер домена не является эмулятор основного контроллера домена, Azure AD Connect попытается toohello tooconnect основного контроллера домена для обратной записи паролей.

8. После обнаружения учетной записи пользователя hello мы будем стараться tooreset hello пароль непосредственно в соответствующем лесу AD hello.
9. При успешном выполнении операции задания пароля hello мы сообщаем hello пользователя, что пароль был изменен.
    > [!NOTE]
    > В случае hello, если hello пароль — синхронизированные tooAzure AD с помощью синхронизации паролей, есть вероятность, политики паролей в локальной среде hello слабее политики паролей hello облака. В этом случае мы по-прежнему накладывает любые hello Локальная политика и хэш toosynchronize синхронизации hello хэш пароля, вместо этого позволяет пароль. Это обеспечить в локальной политике соблюдение в облаке hello независимо от при использовании пароля синхронизации или федерации tooprovide единого входа.

10. Если происходит сбой операции набора hello пароль, мы возвращают hello ошибка toohello пользователя и позволяем повторить попытку.
    * Hello операция может завершиться ошибкой из-за следующих hello
        * Hello служба была недоступна.
        * пароль Hello, они выбраны не соответствовал политикам организации
        * Не удалось найти пользователя hello в локальный AD hello

    У нас есть определенный сообщений для многих из этих случаев и уведомить пользователя hello, что можно делать tooresolve hello проблему.

## <a name="configuring-password-writeback"></a>Настройка компонента обратной записи паролей

Рекомендуется использовать функцию автоматического обновления hello объекта [Azure AD Connect](./connect/active-directory-aadconnect-get-started-express.md) Если toouse обратной записи паролей.

DirSync и Azure AD Sync больше не поддерживаемое средство включения статьи hello обратной записи пароля [обновление от DirSync и Azure AD Sync](connect/active-directory-aadconnect-dirsync-deprecated.md) содержит дополнительные сведения о toohelp с при переходе.

Hello ниже предполагается, что вы уже настроили Azure AD Connect в вашей среде, с помощью hello [Express](./connect/active-directory-aadconnect-get-started-express.md) или [настраиваемый](./connect/active-directory-aadconnect-get-started-custom.md) параметры.

1. tooconfigure и включить обратную запись паролей, войдите в tooyour Azure AD Connect-server и запустите hello **Azure AD Connect** мастер настройки.
2. На экране приветствия hello щелкните **Настройка**.
3. На hello дополнительные задачи экране щелкните **настроить параметры синхронизации** и выберите **Далее**.
4. На экране tooAzure AD Connect hello введите учетные данные глобального администратора и выберите **Далее**.
5. На hello подключения каталогов и домена и Подразделения, фильтрация экранов можно выбрать **Далее**.
6. На экране дополнительных функций hello флажок hello рядом слишком**обратной записи паролей** и нажмите кнопку **Далее**.
   ![Включение обратной записи паролей в Azure AD Connect][Writeback]
7. На экране приветствия готов tooconfigure щелкните **Настройка** и подождите, пока процесс toocomplete hello.
8. При появлении экрана "Конфигурация завершена" можно нажать кнопку **Выйти**.

## <a name="licensing-requirements-for-password-writeback"></a>Требования к лицензированию для обратной записи паролей

Сведения о лицензировании, см. раздел hello [лицензий, необходимых для обратной записи паролей](active-directory-passwords-licensing.md#licenses-required-for-password-writeback) или hello следующий сайтов

* [Сайт с ценами на Azure Active Directory](https://azure.microsoft.com/pricing/details/active-directory/).
* [Enterprise Mobility + Security](https://www.microsoft.com/cloud-platform/enterprise-mobility-security).
* [Secure Productive Enterprise](https://www.microsoft.com/secure-productive-enterprise/default.aspx).

### <a name="on-premises-authentication-modes-supported-for-password-writeback"></a>Локальные режимы проверки подлинности, поддерживаемые компонентом обратной записи паролей

Обратная запись работает для hello следующие типы пароль пользователя:

* **Пользователи облака.** В этом случае обратная запись паролей не применяется, так как локальный пароль отсутствует.
* **Пользователи с синхронизацией паролей.** Компонент обратной записи паролей поддерживается.
* **Федеративные пользователи.** Компонент обратной записи паролей поддерживается.
* **Пользователи со сквозной проверкой подлинности.** Компонент обратной записи паролей поддерживается.

### <a name="user-and-admin-operations-supported-for-password-writeback"></a>Операции администрирования и операции пользователя, поддерживаемые компонентом обратной записи паролей

Пароли записываются обратно в все hello в следующих ситуациях:

* **Поддерживаемые операции конечных пользователей:**
  * все самостоятельные добровольные операции изменения пароля конечного пользователя;
  * все самостоятельные принудительные операции изменения пароля конечного пользователя (например, из-за окончания срока действия пароля);
  * Любой конечным пользователем самостоятельный сброс пароля инициированный hello [портала сброса паролей](https://passwordreset.microsoftonline.com)
* **Поддерживаемые операции администрирования:**
  * все самостоятельные добровольные операции изменения пароля администратора;
  * все самостоятельные принудительные операции изменения пароля администратора (например, из-за окончания срока действия пароля);
  * Любой администратор самостоятельный сброс пароля инициированный hello [портала сброса паролей](https://passwordreset.microsoftonline.com)
  * Любой администратором для конечных пользователей смену пароля у hello [классический портал Azure](https://manage.windowsazure.com)
  * Любой администратором для конечных пользователей смену пароля у hello [портал Azure](https://portal.azure.com)

### <a name="user-and-admin-operations-not-supported-for-password-writeback"></a>Операции администрирования и операции пользователя, не поддерживаемые компонентом обратной записи паролей

Пароли являются **не** написаны обратно в любой из следующих ситуаций hello:

* **Неподдерживаемые операции конечных пользователей:**
  * Любой пользователь, сброс пароля с помощью PowerShell v1, v2 или hello API Azure AD Graph
* **Неподдерживаемые операции администрирования:**
  * Любой администратором для конечных пользователей смену пароля у hello [портал управления Office](https://portal.office.com)
  * Любой администратором для конечных пользователей смену пароля у PowerShell v1, v2 или hello API Azure AD Graph

Хотя мы работаем tooremove эти ограничения, определенные временной шкалы, можно поделиться еще нет.

## <a name="password-writeback-security-model"></a>Модель безопасности обратной записи паролей

Обратная запись паролей — это служба с высоким уровнем безопасности.  tooensure защиты информации, мы включим 4-уровневую модель безопасности, как описано ниже.

* **Ретранслятор служебной шины для определенного клиента**
  * При настройке службы hello мы настраиваем защищен случайный надежный пароль, который у корпорации Майкрософт нет доступа к ретрансляции шины конкретного клиента службы.
* **Заблокированный криптографически надежный ключ шифрования пароля**
  * После создания ретрансляции шины обслуживания hello создадим сильного симметричного ключа, мы используем tooencrypt hello пароля, получаемого по сети hello. Этот ключ существует только в секретное хранилище вашей компании в облаке hello, который сильно блокировки и аудиту, как и любой пароль в каталоге hello.
* **TLS отраслевого стандарта**
  1. Когда пароль сбросить или сменить операция выполняется в облаке hello, мы требуют пароль открытым текстом hello и его шифрование с помощью открытого ключа.
  2. Мы поместите, в сообщение HTTPS, который передается по зашифрованному каналу с помощью ретрансляции шины обслуживания tooyour сертификаты SSL корпорации Майкрософт.
  3. После приветственное сообщение поступает в Service Bus, ваш локальный агент пробуждается вверх и выполняет проверку подлинности с помощью шины tooService hello надежный пароль, который был создан ранее.
  4. Локальный агент выбирает зашифрованное сообщение hello, расшифровывает его с помощью hello закрытый ключ, который мы создали.
  5. Локальный агент предпринимает tooset hello пароля с помощью AD DS SetPassword API hello.
     * Этот шаг является то, что позволяет нам tooenforce Рекламы в локальной политике паролей (сложность, возраст, журнал, фильтры, т. д.) в облаке hello.
* **Политики срока действия сообщений** 
  * Если приветственное сообщение останется в Service Bus, так как в локальной службы не работает, он имеет время ожидания и удалена после нескольких минут tooincrease безопасности.

### <a name="password-writeback-encryption-details"></a>Сведения о шифровании компонента обратной записи паролей

Ниже описаны шаги шифрования Hello проходит запросить сброс пароля, после отправки ее, прежде чем их поступления в локальной среде, tooensure максимальное службы надежности и безопасности.

* **Шаг 1 — шифрование пароля ключом RSA 2048-разрядный** — когда пользователь отправляет toobe пароль, записаны tooon организациями, во-первых, hello отправленной собственно пароля шифруется 2048-битным ключом RSA.
* **Шаг 2 - шифрование на уровне пакета с помощью AES-GCM** - то hello весь пакет (пароль + необходимые метаданные) шифруется с помощью AES-GCM. Это предотвращает все, кто имеет прямой доступ toohello базового канала служебной шины просмотра или подделки hello содержимое.
* **Шаг 3 - весь обмен данными происходит через TLS / SSL** -происходит вся hello связь со служебной шины в канала SSL/TLS. Это защищает содержимое hello несанкционированного сторонних производителей.
* **Автоматическую смену ключей каждые шесть месяцев** — автоматически каждые 6 месяцев, или каждый раз при обратной записи паролей отключена или снова включить в Azure AD Connect, мы продолжения эти ключи tooensure максимальное службы безопасности и безопасности.

### <a name="password-writeback-bandwidth-usage"></a>Использование пропускной способности компонента обратной записи паролей

Обратная запись паролей — это служба низкой пропускной способностью, которая отправляет запросы обратно toohello локального агента только при следующих обстоятельствах hello:

1. Два сообщения, отправленные при включении или отключении компонента hello через Azure AD Connect.
2. Одно сообщение отправляется каждые пять минут как пульс для службы, при условии, что запущена служба hello.
3. Два сообщения отправляются при каждой отправке нового пароля.
    * Первое сообщение, как операция запроса tooperform hello
    * Второе сообщение, которое содержит hello результат операции hello и отправляются в hello при следующих обстоятельствах:
        * Во время каждой отправки нового пароля при самостоятельном сбросе пароля пользователем.
        * Во время каждой отправки нового пароля в ходе операции по смене пароля пользователя.
        * Каждый раз, новый пароль отправляется во время инициировал сброс пароля (от проводить hello Azure admin порталы только).

#### <a name="message-size-and-bandwidth-considerations"></a>Рекомендации по размеру сообщений и пропускной способности

размер каждого из описанных выше приветственное сообщение Hello обычно менее 1 КБ, даже при чрезвычайных нагрузках, служба обратной записи паролей hello сам занимает несколько килобит в секунду, пропускной способности. Поскольку каждое сообщение отправляется в реальном времени, только когда требуется с помощью операции обновления пароля, так как размер сообщения hello слишком мало, поэтому, использование пропускной способности hello возможности обратной записи hello эффективно слишком мало toohave любой real заметного влияния.

## <a name="next-steps"></a>Дальнейшие действия

Привет, следующие ссылки предоставляют дополнительную информацию об пароль с помощью Azure AD

* [**Быстрое начало работы с самостоятельным сбросом пароля в Azure AD**](active-directory-passwords-getting-started.md). Запуск и выполнение службы самостоятельного управления паролями Azure AD. 
* [**Licensing requirements for Azure AD self-service password reset**](active-directory-passwords-licensing.md) (Требования к лицензированию самостоятельного сброса пароля в Azure AD). Сведения о настройке лицензирования Azure AD.
* [**Данные** ](active-directory-passwords-data.md) — понять hello данные, которые не требуется и как она используется для управления паролями
* [**Развертывание** ](active-directory-passwords-best-practices.md) -планирование и развертывание SSPR tooyour пользователей с помощью hello рекомендации по следующему адресу
* [**Настройка** ](active-directory-passwords-customize.md) -настроить hello внешний вид и поведение hello SSPR взаимодействие с вашей компании.
* [**Политики и ограничения для паролей в Azure Active Directory**](active-directory-passwords-policy.md). Общие сведения и информация об установке политик паролей Azure AD.
* [**Reporting options for Azure AD password management**](active-directory-passwords-reporting.md) (Параметры отчетов для управления паролями Azure AD). Определяйте, кто и когда использовал функцию SSPR.
* [**Технические глубокое погружение** ](active-directory-passwords-how-it-works.md) -перейдите за занавесом toounderstand hello принцип работы
* [**Вопросы и ответы об управлении паролями**](active-directory-passwords-faq.md). Как? Почему? Что? Где? Кто? Когда? -Ответы tooquestions требуется, чтобы tooask
* [**Устранение неполадок** ](active-directory-passwords-troubleshoot.md) -Узнайте, как tooresolve распространенные проблемы, мы увидим с SSPR

[Writeback]: ./media/active-directory-passwords-writeback/enablepasswordwriteback.png "Включение обратной записи паролей в Azure AD Connect"
