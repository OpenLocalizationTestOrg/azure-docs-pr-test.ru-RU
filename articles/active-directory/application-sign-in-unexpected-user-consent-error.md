---
title: "Непредвиденная ошибка при предоставлении согласия для приложения | Документы Майкрософт"
description: "Здесь описаны ошибки, возникающие при предоставлении согласия для приложения, и способы их устранения."
services: active-directory
documentationcenter: 
author: ajamess
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: asteen
ms.openlocfilehash: fd500fdd4c8642bad96dcf71eebcf1fad461a35f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="unexpected-error-when-performing-consent-to-an-application"></a><span data-ttu-id="47d45-103">Непредвиденная ошибка при предоставлении согласия для приложения</span><span class="sxs-lookup"><span data-stu-id="47d45-103">Unexpected error when performing consent to an application</span></span>

<span data-ttu-id="47d45-104">В этой статье описаны ошибки, возникающие при предоставлении согласия для приложения.</span><span class="sxs-lookup"><span data-stu-id="47d45-104">This article discusses errors that can occur during the process of consenting to an application.</span></span> <span data-ttu-id="47d45-105">Если вы получаете непредвиденные запросы согласия, не содержащие сообщения об ошибках, см. статью [Сценарии аутентификации в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-scenarios).</span><span class="sxs-lookup"><span data-stu-id="47d45-105">If you are Troubleshoot unexpected consent prompts that do not contain any error messages, see [Authentication Scenarios for Azure AD](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-scenarios).</span></span>

<span data-ttu-id="47d45-106">Для правильной работы многим приложениям, интегрирующимся с Azure Active Directory, нужны разрешения на доступ к другим ресурсам.</span><span class="sxs-lookup"><span data-stu-id="47d45-106">Many applications that integrate with Azure Active Directory require permissions to access other resources in order to function.</span></span> <span data-ttu-id="47d45-107">Если эти ресурсы также интегрированы с Azure Active Directory, доступ к ним часто запрашивается с помощью общей инфраструктуры согласия.</span><span class="sxs-lookup"><span data-stu-id="47d45-107">When these resources are also integrated with Azure Active Directory, permissions to access them is often requested using the common consent framework.</span></span> 

<span data-ttu-id="47d45-108">Это приводит к выводу запроса согласия, что обычно происходит при первом использовании приложения, но может встречаться и при дальнейшем использовании.</span><span class="sxs-lookup"><span data-stu-id="47d45-108">This results in a consent prompt being displayed, which generally occurs the first time an application is used but can also occur on a subsequent use of the application.</span></span>

<span data-ttu-id="47d45-109">Чтобы пользователь дал согласие на необходимые приложению разрешения, должны выполняться определенные условия.</span><span class="sxs-lookup"><span data-stu-id="47d45-109">Certain conditions must be true for a user to consent to the permissions an application requires.</span></span> <span data-ttu-id="47d45-110">В противном случае могут возникать различные ошибки.</span><span class="sxs-lookup"><span data-stu-id="47d45-110">If these conditions are not met, various errors can occur.</span></span> <span data-ttu-id="47d45-111">В частности, описаны такие возможности:</span><span class="sxs-lookup"><span data-stu-id="47d45-111">These include:</span></span>

## <a name="requesting-not-authorized-permissions-error"></a><span data-ttu-id="47d45-112">Ошибка при запросе неавторизованных разрешений</span><span class="sxs-lookup"><span data-stu-id="47d45-112">Requesting not authorized permissions error</span></span>
* <span data-ttu-id="47d45-113">**AADSTS90093:** &lt;clientAppDisplayName&gt; is requesting one or more permissions that you are not authorized to grant.</span><span class="sxs-lookup"><span data-stu-id="47d45-113">**AADSTS90093:** &lt;clientAppDisplayName&gt; is requesting one or more permissions that you are not authorized to grant.</span></span> <span data-ttu-id="47d45-114">Contact an administrator, who can consent to this application on your behalf. ("clientAppDisplayName" запрашивает одно или несколько разрешений, которые вы не имеете права предоставлять. Обратитесь к администратору, который может дать согласие для этого приложения от вашего имени.)</span><span class="sxs-lookup"><span data-stu-id="47d45-114">Contact an administrator, who can consent to this application on your behalf.</span></span>

<span data-ttu-id="47d45-115">Эта ошибка возникает, когда пользователь, не являющийся администратором организации, пытается использовать приложение, которому нужны разрешения, предоставляемые лишь администратором.</span><span class="sxs-lookup"><span data-stu-id="47d45-115">This error occurs when a user who is not a company administrator attempts to use an application that is requesting permissions that only an administrator can grant.</span></span> <span data-ttu-id="47d45-116">Администратор может устранить эту ошибку, предоставив доступ к приложению от имени своей организации.</span><span class="sxs-lookup"><span data-stu-id="47d45-116">This error can be resolved by an administrator granting access to the application on behalf of their organization.</span></span>

## <a name="policy-prevents-granting-permissions-error"></a><span data-ttu-id="47d45-117">Ошибка при блокировке назначения разрешений политикой</span><span class="sxs-lookup"><span data-stu-id="47d45-117">Policy prevents granting permissions error</span></span>
* <span data-ttu-id="47d45-118">**AADSTS90093:** An administrator of &lt;tenantDisplayName&gt; has set a policy that prevents you from granting &lt;name of app&gt; the permissions it is requesting.</span><span class="sxs-lookup"><span data-stu-id="47d45-118">**AADSTS90093:** An administrator of &lt;tenantDisplayName&gt; has set a policy that prevents you from granting &lt;name of app&gt; the permissions it is requesting.</span></span> <span data-ttu-id="47d45-119">Contact an administrator of &lt;tenantDisplayName&gt;, who can grant permissions to this app on your behalf. (Администратор "tenantDisplayName" задал политику, которая запрещает предоставление разрешений, запрошенных "имя приложения". Обратитесь к администратору "tenantDisplayName", который может предоставить разрешения для этого приложения от вашего имени.)</span><span class="sxs-lookup"><span data-stu-id="47d45-119">Contact an administrator of &lt;tenantDisplayName&gt;, who can grant permissions to this app on your behalf.</span></span>

<span data-ttu-id="47d45-120">Эта ошибка возникает, когда администратор организации отключает пользователям возможность давать согласие для приложений, после чего пользователь без прав администратора пытается использовать приложение, требующее согласие.</span><span class="sxs-lookup"><span data-stu-id="47d45-120">This error occurs when a company administrator turns off the ability for users to consent to applications, then a non-administrator user attempts to use an application that requires consent.</span></span> <span data-ttu-id="47d45-121">Администратор может устранить эту ошибку, предоставив доступ к приложению от имени своей организации.</span><span class="sxs-lookup"><span data-stu-id="47d45-121">This error can be resolved by an administrator granting access to the application on behalf of their organization.</span></span>

## <a name="intermittent-problem-error"></a><span data-ttu-id="47d45-122">Ошибка, связанная с периодически возникающей проблемой</span><span class="sxs-lookup"><span data-stu-id="47d45-122">Intermittent problem error</span></span>
* <span data-ttu-id="47d45-123">**AADSTS90090:** It looks like we encountered an intermittent problem recording the permissions you attempted to grant to &lt;clientAppDisplayName&gt;.</span><span class="sxs-lookup"><span data-stu-id="47d45-123">**AADSTS90090:** It looks like we encountered an intermittent problem recording the permissions you attempted to grant to &lt;clientAppDisplayName&gt;.</span></span> <span data-ttu-id="47d45-124">Try again later. (Похоже, мы столкнулись с периодически возникающей проблемой при записи разрешений, которые вы пытались предоставить "clientAppDisplayName". Повторите попытку позже.)</span><span class="sxs-lookup"><span data-stu-id="47d45-124">try again later.</span></span>

<span data-ttu-id="47d45-125">Эта ошибка указывает на наличие периодически возникающей проблемы на стороне службы.</span><span class="sxs-lookup"><span data-stu-id="47d45-125">This error indicates that an intermittent service side issue has occurred.</span></span> <span data-ttu-id="47d45-126">Для ее решения можно еще раз попытаться предоставить согласие для приложения.</span><span class="sxs-lookup"><span data-stu-id="47d45-126">It can be resolved by attempting to consent to the application again.</span></span>

## <a name="resource-not-available-error"></a><span data-ttu-id="47d45-127">Ошибка при недоступном ресурсе</span><span class="sxs-lookup"><span data-stu-id="47d45-127">Resource not available error</span></span>
* <span data-ttu-id="47d45-128">**AADSTS65005:** The app &lt;clientAppDisplayName&gt; requested permissions to access a resource &lt;resourceAppDisplayName&gt; that is not available. (Приложение "clientAppDisplayName" запросило разрешения для обращения к недоступному ресурсу "resourceAppDisplayName".)</span><span class="sxs-lookup"><span data-stu-id="47d45-128">**AADSTS65005:** The app &lt;clientAppDisplayName&gt; requested permissions to access a resource &lt;resourceAppDisplayName&gt; that is not available.</span></span> 

<span data-ttu-id="47d45-129">Свяжитесь с разработчиком приложения.</span><span class="sxs-lookup"><span data-stu-id="47d45-129">Contact the application developer.</span></span>

##  <a name="resource-not-available-in-tenant-error"></a><span data-ttu-id="47d45-130">Ошибка при недоступном ресурсе в клиенте</span><span class="sxs-lookup"><span data-stu-id="47d45-130">Resource not available in tenant error</span></span>
* <span data-ttu-id="47d45-131">**AADSTS65005:** &lt;clientAppDisplayName&gt; is requesting access to a resource &lt;resourceAppDisplayName&gt; that is not available in your organization &lt;tenantDisplayName&gt;. ("clientAppDisplayName" запрашивает доступ к ресурсу "resourceAppDisplayName", который недоступен в вашей организации "tenantDisplayName".)</span><span class="sxs-lookup"><span data-stu-id="47d45-131">**AADSTS65005:** &lt;clientAppDisplayName&gt; is requesting access to a resource &lt;resourceAppDisplayName&gt; that is not available in your organization &lt;tenantDisplayName&gt;.</span></span> 

<span data-ttu-id="47d45-132">Убедитесь, что этот ресурс доступен, или обратитесь к администратору &lt;tenantDisplayName&gt;.</span><span class="sxs-lookup"><span data-stu-id="47d45-132">Ensure that this resource is available or contact an administrator of &lt;tenantDisplayName&gt;.</span></span>

## <a name="permissions-mismatch-error"></a><span data-ttu-id="47d45-133">Ошибка при несовпадении разрешений</span><span class="sxs-lookup"><span data-stu-id="47d45-133">Permissions mismatch error</span></span>
* <span data-ttu-id="47d45-134">**AADSTS65005:** The app requested consent to access resource &lt;resourceAppDisplayName&gt;.</span><span class="sxs-lookup"><span data-stu-id="47d45-134">**AADSTS65005:** The app requested consent to access resource &lt;resourceAppDisplayName&gt;.</span></span> <span data-ttu-id="47d45-135">This request failed because it does not match how the app was pre-configured during app registration.</span><span class="sxs-lookup"><span data-stu-id="47d45-135">This request failed because it does not match how the app was pre-configured during app registration.</span></span> <span data-ttu-id="47d45-136">Contact the app vendor.** (Приложение запросило согласие на обращение к ресурсу "resourceAppDisplayName". Выполнить этот запрос не удалось, так как он не соответствует предварительной настройке приложения, заданной при регистрации. Обратитесь к поставщику.)</span><span class="sxs-lookup"><span data-stu-id="47d45-136">Contact the app vendor.**</span></span>

<span data-ttu-id="47d45-137">Эти ошибки всегда возникают, когда приложение, для которого пользователь пытается предоставить согласие, запрашивает разрешения на доступ к приложению-ресурсу, отсутствующее в каталоге организации (клиенте).</span><span class="sxs-lookup"><span data-stu-id="47d45-137">These errors all occur when the application a user is trying to consent to is requesting permissions to access a resource application that cannot be found in the organization’s directory (tenant).</span></span> <span data-ttu-id="47d45-138">Это может произойти по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="47d45-138">This can occur for several reasons:</span></span>

-   <span data-ttu-id="47d45-139">Разработчик клиентского приложения неправильно настроил его, в результате чего оно запрашивает доступ к недопустимому ресурсу.</span><span class="sxs-lookup"><span data-stu-id="47d45-139">The client application developer has configured their application incorrectly, causing it to request access to an invalid resource.</span></span> <span data-ttu-id="47d45-140">В этом случае разработчику нужно обновить конфигурации клиентского приложения для устранения этой проблемы.</span><span class="sxs-lookup"><span data-stu-id="47d45-140">In this case, the application developer must update the configuration of the client application to resolve this issue.</span></span>

-   <span data-ttu-id="47d45-141">Субъект-служба, представляющий целевое приложение-ресурс, которое отсутствует в организации либо было удалено.</span><span class="sxs-lookup"><span data-stu-id="47d45-141">A Service Principal representing the target resource application does not exist in the organization, or existed in the past but has been removed.</span></span> <span data-ttu-id="47d45-142">Чтобы устранить эту проблему, в организации нужно подготовить субъект-службу для приложения-ресурса, после чего клиентское приложение сможет запросить для него права.</span><span class="sxs-lookup"><span data-stu-id="47d45-142">To resolve this issue, a Service Principal for the resource application must be provisioned in the organization so the client application can request permissions to it.</span></span> <span data-ttu-id="47d45-143">В зависимости от типа приложения это можно осуществить несколькими способами, в том числе:</span><span class="sxs-lookup"><span data-stu-id="47d45-143">This can happen in an number of ways, depending on the type of application, including:</span></span>

    -   <span data-ttu-id="47d45-144">Приобретение подписки для приложения-ресурса (приложения, опубликованные корпорацией Майкрософт)</span><span class="sxs-lookup"><span data-stu-id="47d45-144">Acquiring a subscription for the resource application (Microsoft published applications)</span></span>

    -   <span data-ttu-id="47d45-145">Предоставление согласия для приложения-ресурса</span><span class="sxs-lookup"><span data-stu-id="47d45-145">Consenting to the resource application</span></span>

    -   <span data-ttu-id="47d45-146">Предоставление разрешений для приложения с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="47d45-146">Granting the application permissions via the Azure Portal</span></span>

    -   <span data-ttu-id="47d45-147">Добавление приложения из коллекции приложений Azure AD</span><span class="sxs-lookup"><span data-stu-id="47d45-147">Adding the application from the Azure AD Application Gallery</span></span>

## <a name="next-steps"></a><span data-ttu-id="47d45-148">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="47d45-148">Next steps</span></span> 

[<span data-ttu-id="47d45-149">Приложения, разрешения и согласие в Azure Active Directory (конечная точка версии 1)</span><span class="sxs-lookup"><span data-stu-id="47d45-149">Apps, permissions, and consent in Azure Active Directory (v1 endpoint)</span></span>](https://docs.microsoft.com/azure/active-directory/active-directory-apps-permissions-consent)<br>

[<span data-ttu-id="47d45-150">Области, разрешения и согласие в Azure Active Directory (конечная точка версии 2.0)</span><span class="sxs-lookup"><span data-stu-id="47d45-150">Scopes, permissions, and consent in the Azure Active Directory (v2.0 endpoint)</span></span>](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-scopes)


