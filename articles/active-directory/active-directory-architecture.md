---
title: "Общие сведения об архитектуре Azure Active Directory | Документация Майкрософт"
description: "В этом разделе объясняется, что такое клиент Azure AD и как управлять Azure с помощью Azure Active Directory."
services: active-directory
documentationcenter: 
author: MarkusVi
writer: v-lorisc
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 08/02/2017
ms.author: markvi
ms.openlocfilehash: 50dad848cfbdab7f5b1fff0fcec3b5f754e6ae74
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="understand-azure-active-directory-architecture"></a>Общие сведения об архитектуре Azure Active Directory
Azure Active Directory (Azure AD) позволяет безопасно управлять доступом к службам и ресурсам Azure пользователей, а также содержит полный набор возможностей управления удостоверениями. Дополнительные сведения о возможностях Azure AD см. в статье [Что такое Microsoft Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/active-directory-whatis).

Благодаря Azure AD вы можете создавать пользователей и группы и управлять ими, разрешая и запрещая доступ к корпоративным ресурсам на основе разрешений. Дополнительные сведения об управлении удостоверениями см. в [этой статье](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals-identity).

## <a name="azure-ad-architecture"></a>Архитектура Azure AD
Географически распределенная архитектура Azure AD сочетает в себе расширенные возможности мониторинга, автоматического перенаправления, отработки отказа и восстановления, благодаря которым мы можем предоставлять клиентам доступность и производительность корпоративного класса.

В этой статье рассматриваются следующие элементы архитектуры:
 *  схема архитектуры службы;
 *  Масштабируемость 
 *  постоянная доступность;
 *  центры обработки данных.

### <a name="service-architecture-design"></a>Схема архитектуры службы
Наиболее распространенный способ создания масштабируемой системы с большим количеством данных и высоким уровнем доступности заключается в использовании независимых стандартных блоков или единиц масштабирования на уровне данных Azure AD. Эти единицы масштабирования называются *разделами*. 

На уровне данных содержится несколько интерфейсных служб, обеспечивающих возможность чтения и записи. На схеме ниже показано, как компоненты раздела каталога распределяются по географически распределенным центрам обработки данных. 

  ![Разделы каталога](./media/active-directory-architecture/active-directory-architecture.png)

К компонентам архитектуры Azure AD относятся первичная реплика и вторичные реплики.

**Первичная реплика**

*Первичная реплика* принимает все операции *записи* раздела, к которому она относится. Перед возвращением успешного ответа вызывающей стороне все операции записи сразу же реплицируются на вторичную реплику в другом центре обработки данных, что обеспечивает геоизбыточную устойчивость этих операций.

**Вторичные реплики**

Все операции *чтения* в каталоге обрабатываются на *вторичных репликах*, расположенных в центрах обработки данных в разных географических регионах. Данные реплицируются асинхронно, поэтому вы можете иметь большое количество вторичных реплик. Операции чтения в каталоге, такие как запросы на проверку подлинности, обрабатываются в центрах обработки данных, расположенных в непосредственной близости к клиентам. Вторичные реплики отвечают за масштабируемость операций чтения.

### <a name="scalability"></a>Масштабируемость

Масштабируемость — это возможность расширения службы в соответствии с растущими требованиями к производительности. Изменение количества операций записи обеспечивается за счет секционирования, а операций чтения — за счет репликации данных из одного раздела на несколько вторичных реплик, распределенных по всему миру.

Обычно запросы от приложений каталога направляются в ближайший центр обработки данных. Операции записи явным образом перенаправляются на первичную реплику, что позволяет обеспечить согласованность операций чтения и записи. Вторичные реплики значительно расширяют масштаб разделов, так как большую часть времени каталоги обрабатывают операции чтения.

Приложения каталога подключаются к ближайшим центрам обработки данных. Это повышает производительность и, следовательно, предоставляет возможности масштабирования. Так как разделы каталога могут иметь большое количество вторичных реплик, эти реплики можно размещать ближе к клиентам каталога. Только внутренние компоненты службы каталогов с большим количеством операций записи непосредственно используют активную первичную реплику.

### <a name="continuous-availability"></a>Постоянная доступность

Доступность (или время непрерывной работы) определяет возможность системы работать без перебоя. Высокий уровень доступности Azure AD обеспечивается благодаря возможности наших служб быстро распределять трафик между несколькими географически распределенными центрами обработки данных. Каждый центр обработки данных является независимым, благодаря чему режимы сбоя не коррелируют.

Архитектура разделов Azure AD не такая сложная по сравнению с архитектурой AD предприятия, которая важна для масштабирования системы. Мы внедрили архитектуру с одной первичной репликой, которая включает тщательно организованный и детерминированный процесс отработки отказа первичной реплики.

**Отказоустойчивость**

Чтобы обеспечить более высокую доступность системы, необходимо реализовать ее устойчивость к сбоям оборудования, сети и программного обеспечения. Для каждого раздела в каталоге назначена основная реплика с высоким уровнем доступности — первичная реплика. Эта реплика обрабатывает только операции записи на определенный раздел. Она постоянно находится под тщательным контролем, а в случае обнаружения сбоя операции записи немедленно перенаправляются на другую реплику (которая становится новой первичной репликой). Во время отработки отказа доступность для записи может быть потеряна на 1–2 минуты. Эта операция не влияет на доступность для чтения.

Операции чтения (которые численно превышают количество операций записи) направляются только на вторичные реплики. Так как вторичные реплики идемпотентные, потеря одной из них в определенном разделе легко возмещается за счет перенаправления операций чтения на другую реплику, расположенную обычно в том же центре обработки данных.

**Устойчивость данных**

Перед подтверждением операция записи надежно фиксируется по крайней мере в двух центрах обработки данных. Сначала эта операция фиксируется на первичной реплике, а затем немедленно реплицируется хотя бы в один дополнительный центр обработки данных. Это гарантирует, что в случае необратимого сбоя в работе центра обработки данных, в котором расположена первичная реплика, данные не будут потеряны.

Azure AD поддерживает нулевое значение [целевого времени восстановления (RTO)](https://en.wikipedia.org/wiki/Recovery_time_objective) для выдачи токенов и операций чтения в каталоге и примерно 5-минутное значение RTO для операций записи в каталог. Мы также поддерживаем нулевое значение [RPO](https://en.wikipedia.org/wiki/Recovery_point_objective), что позволяет обеспечить сохранность данных во время отработок отказа.

### <a name="data-centers"></a>Центры обработки данных

Реплики Azure AD хранятся в центрах обработки данных, расположенных по всему миру. Дополнительные сведения см. в статье [Центры обработки данных Azure](https://azure.microsoft.com/en-us/overview/datacenters).

Azure AD работает в центрах обработки данных со следующими характеристиками:

 * Службы проверки подлинности, Graph и другие службы AD находятся за службой шлюза. Шлюз управляет балансировкой нагрузки этих служб. При обнаружении неработоспособных серверов с использованием транзакционных проб работоспособности он автоматически выполняет отработку отказа. В зависимости от этих проб шлюз динамически направляет трафик в работоспособные центры обработки данных.
 * Для *операций чтения* каталог имеет вторичные реплики и соответствующие интерфейсные службы с конфигурацией "активный — активный", работающие в нескольких центрах обработки данных. В случае сбоя всего центра обработки данных трафик автоматически направляется в другой центр обработки данных.
 *  Для операций *записи* каталог будет выполнять отработку отказа первичной (основной) реплики между несколькими центрами обработки данных в рамках планового (новая первичная реплика синхронизируется со старой) или экстренного процесса отработки отказа. Устойчивость данных достигается за счет репликации всех фиксаций по крайней мере в два центра обработки данных.

**Согласованность данных**

Модель каталога обеспечивает окончательную согласованность данных. Типичная проблема, связанная с распределенными асинхронно реплицированными системами, заключается в том, что данные, возвращенные из определенной реплики, могут не всегда отражать последние изменения. 

Azure AD обеспечивает согласованность операций чтения и записи для приложений, использующих вторичную реплику, направляя их операции записи на первичную реплику и синхронно возвращая эти операции на вторичную реплику.

Операции записи приложения, выполняемые с помощью API Graph службы Azure AD, абстрагируются от сохранения сходства с репликой каталога для согласованности операций чтения и записи. Служба Azure AD Graph поддерживает логический сеанс, который имеет сходство с вторичной репликой, используемой для операций чтения. Сходство сохраняется в токене реплики, кэшируемом службой Graph с использованием распределенного кэша. Затем этот токен используется в последующих операциях в том же логическом сеансе. 

 >[!NOTE]
 >Операции записи немедленно реплицируются на вторичную реплику, для которой были выданы операции чтения логического сеанса.
 >

**Резервное копирование**

Чтобы упростить процесс восстановления случайно удаленных пользователей и клиентов, в каталоге используется обратимое удаление вместо необратимого. Если администратор клиента случайно удалил пользователей, он может легко отменить удаление и восстановить их. 

Azure AD выполняет ежедневное резервное копирование всех данных и поэтому может принудительно восстановить данные в случае их логического удаления или повреждения. На нашем уровне данных применяются коды исправления ошибок. Это позволяет проверять наличие ошибок и автоматически исправлять определенные типы ошибок диска.

**Метрики и мониторы**

Для выполнения службы с высоким уровнем доступности требуются метрики и возможности мониторинга мирового уровня. Azure AD постоянно анализирует метрики работоспособности основных служб и предоставляет сведения о них, а также о критериях успешной работы каждой из этих служб. Мы постоянно разрабатываем и настраиваем метрики, возможности мониторинга и создания оповещений для каждого сценария в каждой службе Azure AD и во всех остальных службах.

Если какая-либо служба Azure AD не работает должным образом, мы немедленно предпринимаем действие по восстановлению ее работоспособности. Самая важная метрика, отслеживаемая Azure AD, — это скорость обнаружения и устранение проблемы в системе клиента или на рабочем сайте. Мы вложили много ресурсов в возможности мониторинга и создания оповещений, чтобы минимизировать время на обнаружение (менее 5 минут) и устранение (менее 30 минут) проблемы.

**Защита операций**

Мы используем операционные элементы управления, такие как Многофакторная идентификация (MFA), для всех операций, а также ведем аудит всех операций. Кроме того, мы используем JIT-систему повышения прав, чтобы предоставлять необходимый временный доступ к любой рабочей задаче по запросу на постоянной основе. Дополнительные сведения см. на странице [Надежное облако](https://azure.microsoft.com/en-us/support/trust-center).

## <a name="next-steps"></a>Дальнейшие действия
[Руководство разработчика по Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-developers-guide)

