---
title: "Синхронизация Azure AD Connect: изменение конфигурации | Документация Майкрософт"
description: "Описывается способ toomake toohello изменений конфигурации в Azure AD Connect синхронизации."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 7b9df836-e8a5-4228-97da-2faec9238b31
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 78e96d9166831a668439c2b8aa6a0022bc472da4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-sync-how-toomake-a-change-toohello-default-configuration"></a>Синхронизация Azure AD Connect: как конфигурация по умолчанию toomake toohello изменений
Hello в этом разделе предназначена toowalk рассматривается как toomake изменяет конфигурацию по умолчанию toohello в Azure AD Connect sync. Здесь также описываются действия для некоторых стандартных сценариев. Обладая такими сведениями можно будет toomake некоторые простые изменения tooyour владельцем конфигурации зависит от бизнес-правила.

## <a name="synchronization-rules-editor"></a>Редактор правил синхронизации
Редактор правил синхронизации Hello — используется toosee и изменение конфигурации hello по умолчанию. Его можно найти в hello меню "Пуск" в группе hello **Azure AD Connect** группы.  
![Редактор правил синхронизации в меню "Пуск"](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)

При его открытии, отобразятся правила out-of-box по умолчанию hello.

![Редактор правил синхронизации](./media/active-directory-aadconnectsync-change-the-configuration/sre2.png)

### <a name="navigating-in-hello-editor"></a>Перемещение в редакторе hello
раскрывающийся список Hello hello верхней части редактора hello разрешить tooquickly найти конкретное правило. Например правила toosee hello, где будет включен атрибут proxyAddresses hello следует нужно изменить hello раскрывающихся списков toohello следующее:  
![Фильтрация в редакторе правил синхронизации](./media/active-directory-aadconnectsync-change-the-configuration/filtering.png)  
Фильтрация tooreset и загрузка новой конфигурации, нажмите клавишу **F5** на клавиатуре hello.

toohello правой верхней части окна есть кнопка **добавить новое правило**. Эта кнопка будет использоваться toocreate пользовательское правило.

Внизу hello у вас есть кнопки для действующего синхронизации для выбранного правила. Кнопки **Изменить** и **Удалить** используются для удаления и изменения правил. **Экспорт** создает сценарий PowerShell для повторного создания правила синхронизации hello. Эта процедура позволяет toomove правила синхронизации из одного сервера tooanother.

## <a name="create-your-first-custom-rule"></a>Создание настраиваемого правила
самое частое изменение Hello — потоки атрибутов toohello изменения. данные Hello в исходном каталоге не могут быть как в Azure AD. В примере hello в этом разделе, требуется toomake убедиться, что hello заданное имя пользователя всегда открывается в **исправленная версия**.

### <a name="disable-hello-scheduler"></a>Отключить hello планировщика
Hello [планировщика](active-directory-aadconnectsync-feature-scheduler.md) по умолчанию запускается каждые 30 минут. Вы хотите toomake том, что она не запущена во время изменения вносятся и устранение неполадок новых правил. tootemporarily отключить hello планировщика, запустите PowerShell и выполните`Set-ADSyncScheduler -SyncCycleEnabled $false`

![Отключить hello планировщика](./media/active-directory-aadconnectsync-change-the-configuration/schedulerdisable.png)  

### <a name="create-hello-rule"></a>Создание правила hello
1. Щелкните **Добавить новое правило**.
2. На hello **описание** страницы введите hello ниже:  
   ![Фильтрация входящего правила синхронизации](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)  
   * Имя: Задайте правило hello подходящее имя.
   * Описание: Рассчитан некоторые уточнить, кто-то другой было понятно, какие правила hello.
   * Подключение системы: hello объекта hello системы можно найти в. В этом случае выберите hello Соединитель Active Directory.
   * Connected System Type (Тип подключенной системы) и Metaverse Object Type (Тип объекта метавселенной). Выберите **Пользователь** и **Человек** соответственно.
   * Тип ссылки: Измените это значение слишком**соединения**.
   * Приоритет: Укажите значение, которое является уникальным в системе hello. Более низкие значения имеют более высокий приоритет.
   * "Тег". Оставьте это поле пустым. Его нужно заполнять только при использовании стандартных правил Майкрософт.
3. На hello **фильтр области** введите **givenName ISNOTNULL**.  
   ![Фильтр области входящего правила](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)  
   Этот раздел представляет используется toodefine должно применяться правило hello какие объекты. Если оставить пустым, hello правило будет применяться tooall пользовательские объекты. в том числе к конференц-залам, учетным записям службы и другим неодушевленным объектам.
4. На hello **правила присоединения**, оставьте поле пустым.
5. На hello **преобразования** измените hello FlowType слишком**выражение**. Выберите hello целевого атрибута **givenName**и введите в исходном `PCase([givenName])`.
   ![Преобразования входящего правила](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)  
   Модуль синхронизации Hello учитывается регистр, как имя функции hello и с именем hello атрибута hello. При вводе проблема появляется при добавлении правила hello. Редактор Hello дает toosave и продолжить работу, поэтому tooreopen hello и правильный hello правила.
6. Нажмите кнопку **добавить** toosave hello правило.

Новые правила должны быть видимыми с другими hello синхронизации правил в системе hello.

### <a name="verify-hello-change"></a>Проверьте изменения hello
После этого новые изменения требуется toomake, что он работает надлежащим образом и не создает ошибок. В зависимости от числа объектов, которые у вас есть hello существует два способа toodo этот шаг.

1. Выполнить полную синхронизацию всех объектов.
2. Выполнить предварительный просмотр и полную синхронизацию одного объекта.

Запуск **служба синхронизации** из меню "Пуск" hello. Hello шаги в этом разделе находятся в это средство.

1. **Полная синхронизация всех объектов**  
   Выберите **соединители** вверху hello. Идентифицировать hello соединителя внесенные изменения tooin hello предыдущего раздела, в этом случае hello доменных служб Active Directory и выберите его. Выберите **Запустить** в колонке "Действия". После этого выберите **Полная синхронизация** и нажмите кнопку **ОК**.
   ![Полная синхронизация](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)  
   Теперь Hello объекты обновляются в метавселенной hello. Требуется toolook hello объекта в метавселенной hello.
2. **Предварительный просмотр и полная синхронизация одного объекта**  
   Выберите **соединители** вверху hello. Идентифицировать hello соединителя внесенные изменения tooin hello предыдущего раздела, в этом случае hello доменных служб Active Directory и выберите его. Выберите **Search Connector Space**(Поиск пространства соединителя). Используйте область toofind объект, который вы хотите изменить hello tootest toouse. Выберите объект hello и нажмите **предварительной версии**. В новый экран приветствия, выберите **зафиксировать Preview**.  
   ![Просмотр перед фиксацией](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)  
   Изменение Hello больше не зафиксирована toohello метавселенной.

**Рассмотрим hello объекта в метавселенной hello**  
Теперь требуется toopick, несколько образец объектов toomake убедиться, что hello ожидается значение и применения правила hello. Выберите **поиска метавселенной** сверху hello. Добавьте любые фильтры, необходимо toofind hello соответствующих объектов. Результат поиска hello откройте объект. Убедиться в hello и просмотрите значения атрибутов hello **правила синхронизации** столбец, который hello правило применяется должным образом.  
![Поиск в метавселенной](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)  

### <a name="enable-hello-scheduler"></a>Включите планировщик hello
Если все должным образом, можно включить снова hello планировщика. В PowerShell выполните команду `Set-ADSyncScheduler -SyncCycleEnabled $true`.

## <a name="other-common-attribute-flow-changes"></a>Другие основные изменения потоков атрибутов
Hello предыдущем разделе описано, как toomake изменяется tooan поток атрибутов. В этом разделе приведены дополнительные примеры. этапы Hello как сокращается правило синхронизации toocreate hello, но можно найти hello все действия, необходимые в предыдущем разделе hello.

### <a name="use-another-attribute-than-hello-default"></a>Использовать другой атрибут, чем по умолчанию hello
В компании Fabrikam отсутствует в лесу, где используются локальные алфавита hello для указанного имени, фамилии и отображаемое имя. Hello представление содержит символы латинского алфавита эти атрибуты можно найти в атрибуты расширения hello. При построении hello глобального списка адресов в Azure AD и Office 365 hello организация хочет toobe эти атрибуты, вместо этого использовать.

С конфигурацией по умолчанию объект из локального леса hello выглядит следующим образом:  
![Поток атрибутов 1](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp1.png)

правило с других потоков атрибутов toocreate hello следующие:

* Запуск **редактор правил синхронизации** из меню "Пуск" hello.
* С **Входящие** toohello по-прежнему выбранного слева, нажмите кнопку "hello" **добавить новое правило**.
* Присвойте hello правило, имя и описание. Выберите hello в локальной среде Active Directory и hello соответствующие типы объектов. В поле **Тип связи** выберите **Join** (Присоединение). Для задания приоритета выберите число, которое не используется другим правилом. out-of-box правила Hello запускается со 100, поэтому hello значение 50, может использоваться в этом примере.
  ![Поток атрибутов 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)
* Оставьте пустую область (то есть применимы tooall пользовательские объекты в лесу hello).
* Оставьте правила присоединения пустой (, позволяющие hello дескриптор правило out-of-box любых соединений).
* В преобразованиях создайте следующие потоки hello:  
  ![Поток атрибутов 3](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp3.png)
* Нажмите кнопку **добавить** toosave hello правило.
* Go слишком**диспетчер службы синхронизации**. На **соединители**, выберите hello соединителя, где мы добавили hello правило. Выберите **Запустить**, а затем — **Полная синхронизация**. Полная синхронизация повторно вычисляет все объекты с помощью hello текущие правила.

Это результат hello для hello один объектов с помощью этого правила:  
![Поток атрибутов 4](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp4.png)

### <a name="length-of-attributes"></a>Длина атрибутов
По индексированию toobe набор по умолчанию являются атрибутами строк и hello Максимальная длина — 448 символов. При работе с атрибутами, которые может содержать более внесите следующие hello tooinclude убедиться, что в поток атрибутов hello:  
`attributeName` <- `Left([attributeName],448)`

### <a name="changing-hello-userprincipalsuffix"></a>Изменение hello userPrincipalSuffix
атрибут userPrincipalName Hello в Active Directory не всегда известен пользователям hello и могут не подходить как hello идентификатор входа. Hello Azure AD Connect, мастер установки sync позволяет выбирать другой атрибут, например почты. Однако в некоторых случаях hello атрибут должен вычисляться. Например hello компания Contoso имеет два каталога Azure AD, один для рабочей среды и один для тестирования. Они хотите hello пользователей в их тестового клиента toouse другой суффикс в идентификаторе hello вход.  
`userPrincipalName` <- `Word([userPrincipalName],1,"@") & "@contosotest.com"`

В этом выражении взять все данные сначала слева от hello @-sign (Word) и сцепить с фиксированной строкой.

### <a name="convert-a-multi-value-tooa-single-value"></a>Преобразовать однозначный tooa несколькими значениями
Некоторые атрибуты в Active Directory имеют несколько значений в схеме hello, несмотря на то, что они выглядят один табличные значения в Active Directory — пользователи и компьютеры. Например, атрибут описания hello.  
`description` <- `IIF(IsNullOrEmpty([description]),NULL,Left(Trim(Item([description],1)),448))`

В этом выражение, на случай hello атрибут имеет значение, принимают hello первый элемент (Item) в атрибуте hello, удалите начальные и конечные пробелы (Trim) и затем сохранить hello первые 448 символов (слева) в строке приветствия.

### <a name="do-not-flow-an-attribute"></a>Отключение потока для атрибута
Основные сведения о сценарии hello для этого раздела см. в разделе [управления процессом потока атрибута hello](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process).

Атрибут потока toonot двумя способами. Hello сначала доступна в мастере установки hello и позволяет слишком[удалить выбранные атрибуты](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering). Этот параметр работает, если вы никогда не синхронизировался hello атрибута перед. Однако если вы запустили toosynchronize этот атрибут и более поздней версии, удалите его с помощью этой функции, модуль синхронизации hello прекращает управление атрибут hello и оставить существующие значения hello в Azure AD.

Значение атрибута tooremove hello и убедитесь, что оно не переходит в будущем hello, должны вместо этого создать настраиваемое правило.

В компании Fabrikam мы поняли, некоторые атрибуты мы синхронизации toohello облако приветствия не должен быть существует. Мы хотим убедиться, что эти атрибуты не будут удалены из Azure AD toomake.  
![Неправильные атрибуты расширения](./media/active-directory-aadconnectsync-change-the-configuration/badextensionattribute.png)

* Создать новое правило синхронизации входящих и заполнить описание hello ![описания](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)
* Создайте потоки атрибут типа **выражение** и с источником hello **AuthoritativeNull**. литерал Hello **AuthoritativeNull** указывает, что значение hello должно быть пустым в hello MV, даже если значение hello toopopulate пытается ниже приоритет правила синхронизации.
  ![Преобразование атрибутов расширения](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)
* Сохраните hello правило синхронизации. Запуск **служба синхронизации**, найти hello соединитель, выберите **запуска**, и **полная синхронизация**. Это приведет к пересчету всех потоков атрибутов.
* Убедитесь, что этот hello предназначен изменения происходят об экспорте путем поиска пространства соединителя hello toobe.
  ![Промежуточное удаление](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)

## <a name="create-rules-with-powershell"></a>Создание правил с помощью PowerShell
С помощью редактора правил синхронизации hello работает при наличии нескольких toomake изменения. Если требуется внести много изменений toomake PowerShell может быть лучшим вариантом. Некоторые дополнительные функции доступны только в PowerShell.

### <a name="get-hello-powershell-script-for-an-out-of-box-rule"></a>Получение скрипта PowerShell hello для правила out-of-box
hello toosee сценарий PowerShell, создать правило out-of-box, но выберите hello правило синхронизации hello правил редактор и нажмите кнопку **Экспорт**. Это действие дает hello PowerShell сценария этого правила созданный hello.

### <a name="advanced-precedence"></a>Расширенный приоритет
правила синхронизации out-of-box Hello начать со значением приоритета, равный 100. Если у вас есть несколько лесов и необходимо, чтобы toomake многие пользовательские изменения, а затем правила 99 синхронизации может оказаться недостаточно.

Можно настроить hello модуль синхронизации, необходимо вставить перед правилами out-of-box hello Дополнительные правила. tooget такое поведение, выполните следующие действия:

1. Первое правило синхронизации out-of-box пометить hello (это правило — hello **в из AD-User Join**) в редактор правил синхронизации hello и выберите **экспорта**. Скопируйте значение идентификатора SR hello.  
![PowerShell до изменения](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)  
2. Создайте новое правило синхронизации hello. Можно использовать toocreate редактор правил синхронизации hello его. Экспортируйте сценарий PowerShell tooa правило hello.
3. В свойстве hello **PrecedenceBefore**, вставить значение идентификатора hello hello out-of-box правила. Набор hello **приоритет** слишком**0**. Убедитесь, что атрибут hello идентификатор является уникальным и не используется повторно GUID из другого правила. Также убедитесь в том, что hello **ImmutableTag** свойство не задано, это свойство должно быть установлено только для правил out-of-box. Сохраните сценарий PowerShell hello и запустите его. Hello получается, что пользовательское правило назначается приоритет hello значение 100, и все прочие правила out-of-box увеличиваются.  
![PowerShell после изменения](./media/active-directory-aadconnectsync-change-the-configuration/powershell2.png)  

У вас есть много пользовательские правила синхронизации с помощью hello же **PrecedenceBefore** значение, если это требуется.


## <a name="enable-synchronization-of-preferreddatalocation"></a>Включение синхронизации PreferredDataLocation
Azure AD Connect поддерживает синхронизацию hello **PreferredDataLocation** для атрибута **пользователя** объектов в версии 1.1.524.0 и после. В частности, были введены следующие изменения.

* Hello схемы типа hello объекта **пользователя** в hello соединителя Azure AD распространяется tooinclude PreferredDataLocation атрибута, который имеет строковый тип и одно значение.

* Hello схемы типа hello объекта **лицо** в hello метавселенной распространяется tooinclude PreferredDataLocation атрибута, который имеет строковый тип и одно значение.

По умолчанию hello PreferredDataLocation атрибут не включен для синхронизации, так как отсутствует соответствующий атрибут PreferredDataLocation в локальной Active Directory. Необходимо вручную включить синхронизацию.

> [!IMPORTANT]
> В настоящее время Azure AD позволяет атрибута PreferredDataLocation hello синхронизированные объекты пользователя и облака toobe объекты пользователя напрямую настроить с помощью Azure AD PowerShell. После включения синхронизации атрибута PreferredDataLocation hello, необходимо остановить с помощью атрибута hello Azure AD PowerShell tooconfigure **синхронизировать объекты пользователя** как Azure AD Connect будет переопределить их на основе значения атрибутов источника Hello в локальной Active Directory.

> [!IMPORTANT]
> На 1 сентября 2017 года, Azure AD больше не сможет атрибут PreferredDataLocation hello на **синхронизировать объекты пользователя** toobe непосредственно настроить с помощью Azure AD PowerShell. атрибут PreferredLocation tooconfigure синхронизировать объекты пользователя, необходимо использовать только Azure AD Connect.

Перед включением синхронизации атрибута PreferredDataLocation hello, необходимо выполнить следующее:

 * Сначала определите, какой атрибут toobe локальной Active Directory, используется как атрибут источника hello. Он должно иметь тип **string** и быть **однозначным**.

 * Если были настроены ранее атрибут PreferredDataLocation hello на существующие синхронизированы объекты пользователя в Azure AD с помощью Azure AD PowerShell, необходимо **backport** toohello соответствующими пользовательскими объектами значений атрибутов hello в локальной Active Directory.
 
    > [!IMPORTANT]
    > В противном случае не backport hello атрибут значения toohello соответствующими пользовательскими объектами в локальной Active Directory Azure AD Connect удалит существующие значения атрибута hello в Azure AD при синхронизации для атрибута PreferredDataLocation hello включена.

 * Рекомендуется настраивать hello исходный атрибут на по крайней мере двух локальных пользователя AD объектов, который может использоваться для проверки более поздней версии.
 
Синхронизация tooenable Hello действия атрибута PreferredDataLocation hello можно вкратце описать следующим образом:

1. Отключите планировщик синхронизации и убедитесь, что синхронизация не выполняется

2. Добавьте атрибут toohello hello источника локального соединителя AD схемы

3. Добавьте схему соединителя Azure AD toohello PreferredDataLocation

4. Создать значения атрибута hello tooflow правило синхронизации входящих подключений из локальной Active Directory

5. Создание исходящей синхронизации правило tooflow hello атрибута значение tooAzure AD

6. Запустите полный цикл синхронизации.

7. Включите планировщик синхронизации.

> [!NOTE]
> Hello оставшейся части этого раздела описываются эти шаги подробно. Они описаны в контексте hello развертывания с одним лесом топологии и без пользовательские правила синхронизации Azure AD. При наличии топологии с несколькими лесами пользовательские правила синхронизации задана или промежуточный сервер, необходимо tooadjust hello действия соответствующим образом.

### <a name="step-1-disable-sync-scheduler-and-verify-there-is-no-synchronization-in-progress"></a>Шаг 1. Отключение планировщика синхронизации и остановка синхронизации
Убедитесь, синхронизация не выполняется, пока вы находитесь в середине hello обновлении синхронизации правила tooavoid непреднамеренного изменения срока экспортировать tooAzure AD. Планировщик синхронизации встроенных hello toodisable:

 1. Запустите сеанс PowerShell на сервере hello Azure AD Connect.

 2. Отключите плановую синхронизацию, выполнив командлет: `Set-ADSyncScheduler -SyncCycleEnabled $false`
 
 3. Запуск hello **диспетчер службы синхронизации** с переходом → tooSTART службы синхронизации.
 
 4. Go toohello **операции** вкладку и подтвердите нет операции с состоянием *в состоянии «выполняется».*

![Synchronization Service Manager: проверка наличия выполняющихся операций](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step1.png)

### <a name="step-2-add-hello-source-attribute-toohello-on-premises-ad-connector-schema"></a>Шаг 2: Добавление hello исходного атрибута toohello локального соединителя AD схемы
Не все атрибуты AD, импортируются в hello в локальной среде AD пространством соединителя. tooadd hello источника toohello список атрибутов hello импортированы атрибуты:

 1. Go toohello **соединители** hello Synchronization Service Manager на вкладке.
 
 2. Щелкните правой кнопкой мыши на hello **локального соединителя AD** и выберите **свойства**.
 
 3. В всплывающем диалоговом окне приветствия перейдите toohello **Выбор атрибутов** вкладки.
 
 4. Убедитесь, что установлен флажок hello исходный атрибут в списке атрибутов hello.
 
 5. Нажмите кнопку **ОК** toosave.

![Добавьте исходный атрибут tooon в локальной схеме соединителя AD](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step2.png)

### <a name="step-3-add-preferreddatalocation-toohello-azure-ad-connector-schema"></a>Шаг 3: Добавление схем соединителя Azure AD toohello PreferredDataLocation
По умолчанию атрибут PreferredDataLocation hello не импортируется в Azure AD Connect пространства hello. tooadd hello PreferredDataLocation атрибута toohello список импортированных атрибутов:

 1. Go toohello **соединители** hello Synchronization Service Manager на вкладке.

 2. Щелкните правой кнопкой мыши на hello **соединителя Azure AD** и выберите **свойства**.

 3. В всплывающем диалоговом окне приветствия перейдите toohello **Выбор атрибутов** вкладки.

 4. Убедитесь, что в списке атрибутов hello установлен атрибут PreferredDataLocation hello.

 5. Нажмите кнопку **ОК** toosave.

![Добавьте атрибут источника tooAzure схемы соединителя AD](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step3.png)

### <a name="step-4-create-an-inbound-synchronization-rule-tooflow-hello-attribute-value-from-on-premises-active-directory"></a>Шаг 4: Создание значения атрибута hello tooflow правило синхронизации входящих подключений из локальной службы Active Directory
правило синхронизации входящих подключений Hello разрешает tooflow значение атрибута hello из исходного атрибута hello из локальной Active Directory toohello метавселенной:

1. Запуск hello **редактор правил синхронизации** с переходом → tooSTART синхронизации правила редактора.

2. Фильтр поиска hello набора **направление** toobe **Входящие**.

3. Нажмите кнопку **добавить новое правило** toocreate кнопку новое правило входящего трафика.

4. В разделе hello **описание** укажите hello следующая конфигурация:
 
    | Атрибут | Значение | Сведения |
    | --- | --- | --- |
    | Имя | *Укажите имя* | Например, *In from AD – User PreferredDataLocation*. |
    | Описание | *Укажите описание* |  |
    | Подключенная система | *Выбрать hello локального соединителя AD* |  |
    | Тип объекта подключенной системы | **User** |  |
    | Тип объекта метавселенной | **Person** |  |
    | Тип связи | **Join** |  |
    | Приоритет | *Выберите число от 1 до 99*. | Значения 1–99 зарезервированы для настраиваемых правил синхронизации. Не выбирайте значение, которое используется в другом правиле синхронизации. |

5. Go toohello **фильтр области** вкладка и добавить **одной области группы фильтров с hello, следующие предложения**:
 
    | Атрибут | Оператор | Значение |
    | --- | --- | --- |
    | adminDescription | NOTSTARTWITH | Пользователь\_ | 
 
    Фильтр области определяет локальные объекты AD, к которым применяется данное правило входящей синхронизации. В этом примере мы используем hello же фильтр области используется как *» в from AD – общий пользователя «* OOB синхронизации правило, которое запрещает правило синхронизации hello применения tooUser объекты, созданные с помощью обратной записи пользователей Azure AD функция. Может потребоваться фильтр области hello tootweak в соответствии с tooyour развертывания Azure AD Connect.

6. Go toohello **вкладка преобразование** и реализовать hello следующие правила преобразования:
 
    | Тип потока | Целевой атрибут | Источник | Применить однократно | "Merge Type" (Тип объединения) |
    | --- | --- | --- | --- | --- |
    | Напрямую | PreferredDataLocation | Выберите исходный атрибут hello | Флажок снят. | Блокировка изменений |

7. Нажмите кнопку **добавить** toocreate hello входящее правило.

![Создание правила входящей синхронизации](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step4.png)

### <a name="step-5-create-an-outbound-synchronization-rule-tooflow-hello-attribute-value-tooazure-ad"></a>Шаг 5: Создание синхронизации исходящих подключений правило tooflow hello атрибута значение tooAzure AD
правило синхронизации исходящих подключений Hello допускает tooflow значение атрибута hello из атрибута PreferredDataLocation toohello метавселенной hello в Azure AD:

1. Go toohello **правила синхронизации** редактора.

2. Фильтр поиска hello набора **направление** toobe **исходящие**.

3. Нажмите кнопку **Добавить правило**.

4. В разделе hello **описание** укажите hello следующая конфигурация:

    | Атрибут | Значение | Сведения |
    | --- | --- | --- |
    | Имя | *Укажите имя* | Например «Out tooAAD — PreferredDataLocation пользователя» |
    | Описание | *Укажите описание* |
    | Подключенная система | *Выберите соединитель AAD hello* |
    | Тип объекта подключенной системы | Пользователь ||
    | Тип объекта метавселенной | **Person** ||
    | Тип связи | **Join** ||
    | Приоритет | *Выберите число от 1 до 99*. | Значения 1–99 зарезервированы для настраиваемых правил синхронизации. Не выбирайте значение, которое используется в другом правиле синхронизации. |

5. Go toohello **фильтр области** вкладка и добавить **одной области группы фильтров с двумя предложениями**:
 
    | Атрибут | Оператор | Значение |
    | --- | --- | --- |
    | sourceObjectType | EQUAL | Пользователь |
    | cloudMastered | NOTEQUAL | Да |

    Фильтр области определяет объекты Azure AD, к которым применяется данное правило исходящей синхронизации. В этом примере мы используем hello же фильтр области из «Out tooAD — удостоверение пользователя» OOB правила синхронизации. Он предотвращает правило синхронизации hello примененных tooUser объекты, которые не синхронизированы из локальной службы Active Directory. Может потребоваться фильтр области hello tootweak в соответствии с tooyour развертывания Azure AD Connect.
    
6. Go toohello **преобразования** вкладку и реализовать hello следующие правила преобразования:

    | Тип потока | Целевой атрибут | Источник | Применить однократно | "Merge Type" (Тип объединения) |
    | --- | --- | --- | --- | --- |
    | Напрямую | PreferredDataLocation | PreferredDataLocation | Флажок снят. | Блокировка изменений |

7. Закрыть **добавить** toocreate hello исходящее правило.

![Создание правила исходящей синхронизации](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step5.png)

### <a name="step-6-run-full-synchronization-cycle"></a>Шаг 6. Запуск полного цикла синхронизации
Как правило полная синхронизация цикла является обязательным, поскольку мы добавили новые атрибуты tooboth hello AD и схемы соединителя Azure AD, а также появился пользовательские правила синхронизации. Рекомендуется проверить hello изменения, прежде чем экспортировать их tooAzure AD. Можно использовать hello после изменения hello tooverify действия во время запуска действия hello, составляющих цикла полной синхронизации вручную. 

1. Запустите **полный импорт** шаг на hello **локального соединителя AD**:

   1. Go toohello **операции** hello Synchronization Service Manager на вкладке.

   2. Щелкните правой кнопкой мыши на hello **локального соединителя AD** и выберите **запуска...**

   3. В всплывающем диалоговом окне приветствия выберите **полный импорт** и нажмите кнопку **ОК**.
    
   4. Дождитесь toocomplete операции.

    > [!NOTE]
    > Полный импорт можно пропустить на hello локального соединителя AD Если hello исходный атрибут уже включен в список импортированных атрибутов hello. Другими словами, не было toomake любые изменения во время [шаг 2: добавить атрибут toohello hello источника локального соединителя AD схемы](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema).

2. Запустите **полный импорт** шаг на hello **соединителя Azure AD**:

   1. Щелкните правой кнопкой мыши на hello **соединителя Azure AD** и выберите **запуска...**

   2. В всплывающем диалоговом окне приветствия выберите **полный импорт** и нажмите кнопку **ОК**.
   
   3. Дождитесь toocomplete операции.

3. Проверьте изменения правила синхронизации hello на существующий пользовательский объект.

Исходный атрибут Hello из локальной Active Directory и PreferredDataLocation из Azure AD были импортированы в hello соответствующие пространства соединитель. Перед выполнением шага полную синхронизацию, рекомендуется выполнить **предварительного просмотра** существующего пользователя объекта в hello на локальной пространство соединителя AD. Hello объекта, что вы выбрали должно быть hello исходный атрибут заполнен. Успешное выполнение **предварительного просмотра** с hello в метавселенной hello заполняются PreferredDataLocation является хорошим показателем правильно настроить правила синхронизации hello. Сведения о том, как toodo **предварительного просмотра**, см. toosection [Проверьте изменения hello](#verify-the-change).

4. Запустите **полная синхронизация** шаг на hello **локального соединителя AD**:

   1. Щелкните правой кнопкой мыши на hello **локального соединителя AD** и выберите **запуска...**
  
   2. В всплывающем диалоговом окне приветствия выберите **полная синхронизация** и нажмите кнопку **ОК**.
   
   3. Дождитесь toocomplete операции.

5. Проверьте **ожидающие операции экспорта** tooAzure AD:

   1. Щелкните правой кнопкой мыши на hello **соединителя Azure AD** и выберите **поиска пространства соединителя**.

   2. В hello поиска пространства соединителя всплывающем диалоговом окне:

      1. Задать **область** слишком**ожидающие экспорта**.
      
      2. Установите все 3 флажка: **"Добавить", "Изменить" и "Удалить"**.
      
      3. Нажмите кнопку hello **поиска** кнопку tooget hello список объектов с toobe изменения экспортированы. изменения hello tooexamine для заданного объекта, дважды щелкните hello объекта.
      
      4. Убедитесь, что ожидаются изменения hello.

6. Запустите **Экспорт** шаг на hello **соединителя Azure AD**
      
   1. Щелкните правой кнопкой мыши hello **соединителя Azure AD** и выберите **запуска...**
   
   2. В hello запуска соединителя всплывающем диалоговом окне, выберите **Экспорт** и нажмите кнопку **ОК**.
   
   3. Дождитесь toocomplete tooAzure AD экспорта.

> [!NOTE]
> Вы можете заметить, что hello шаги не включают действия полная синхронизация hello и экспорта на hello соединителя Azure AD. Поскольку значения атрибутов hello потоков от локальной tooAzure Active Directory AD только Hello действия не требуются.

### <a name="step-7-re-enable-sync-scheduler"></a>Шаг 7. Повторное включение планировщика синхронизации
Повторно включите планировщик hello встроенных синхронизации:

1. Запустите сеанс PowerShell.

2. Повторно включите плановую синхронизацию, выполнив командлет: `Set-ADSyncScheduler -SyncCycleEnabled $true`



## <a name="next-steps"></a>Дальнейшие действия
* Дополнительные сведения о модели конфигурации hello в [декларативной подготовки основные сведения о](active-directory-aadconnectsync-understanding-declarative-provisioning.md).
* Дополнительные сведения о языке выражений hello в [выражения декларативной подготовки основные сведения о](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md).

**Обзорные статьи**

* [Службы синхронизации Azure AD Connect: общие сведений о синхронизации и ее настройка](active-directory-aadconnectsync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md)
