---
title: "Соединитель SQL aaaGeneric | Документы Microsoft"
description: "В этой статье описывается как универсальный соединитель SQL tooconfigure Microsoft."
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: fd8ccef3-6605-47ba-9219-e0c74ffc0ec9
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 2eab8f0894e83ab4738b9f2deb05b03cdc9a9d43
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="generic-sql-connector-technical-reference"></a>Технический справочник по универсальному соединителю SQL
В этой статье описывается hello универсальный соединитель SQL. статья Hello относится toohello следующие продукты:

* Microsoft Identity Manager 2016 (MIM2016);
* Forefront Identity Manager 2010 R2 (FIM2010R2).
  * Необходимо установить исправление 4.1.3671.0 или более позднюю версию ( [KB3092178](https://support.microsoft.com/kb/3092178)).

Для MIM2016 и FIM2010R2, hello соединителя доступен для загрузки из hello [центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkId=717495).

toosee этот соединитель в действии, см. hello [универсальный соединитель SQL пошаговые](active-directory-aadconnectsync-connector-genericsql-step-by-step.md) статьи.

## <a name="overview-of-hello-generic-sql-connector"></a>Общие сведения о hello универсальный соединитель SQL
Hello универсальный соединитель SQL позволяет, служба синхронизации hello toointegrate с системой базы данных, которая предлагает возможности подключения ODBC.  

С точки зрения высокого уровня hello текущий выпуск соединителя hello поддерживаются hello следующие атрибуты:

| Функция | Поддержка |
| --- | --- |
| Подключенный источник данных |Все 64-разрядные драйверы ODBC поддерживает Hello соединителя. Он протестирован hello следующее: <li>Microsoft SQL Server и SQL Azure</li><li>IBM DB2 10.x</li><li>IBM DB2 9.x</li><li>Oracle 10 и 11g</li><li>MySQL 5.x</li> |
| Сценарии |<li>Управление жизненным циклом объекта</li><li>Управление паролями</li> |
| Операции |<li>Полный импорт и импорт изменений, экспорт</li><li>Для экспорта: добавление, удаление, обновление и замена</li><li>Установка пароля, изменение пароля</li> |
| Схема |<li>Динамическое обнаружение объектов и атрибутов</li> |

### <a name="prerequisites"></a>Предварительные требования
Прежде чем использовать hello соединитель, убедитесь, что у вас есть следующие hello hello синхронизации сервера:

* Microsoft .NET Framework, начиная с версии 4.5.2.
* 64-разрядные клиентские драйверы ODBC.

### <a name="permissions-in-connected-data-source"></a>Разрешения в подключенном источнике данных
toocreate или выполнения задач hello поддерживается в SQL универсальный соединитель, необходимо иметь:

* db_datareader;
* db_datawriter.

### <a name="ports-and-protocols"></a>Порты и протоколы
Hello порты, необходимые для toowork драйвера ODBC hello hello базы данных поставщика документации.

## <a name="create-a-new-connector"></a>Создание нового соединителя
tooCreate соединителя универсального SQL в **служба синхронизации** выберите **агент управления** и **создать**. Выберите hello **универсального SQL (Майкрософт)** соединителя.

![Создание соединителя](./media/active-directory-aadconnectsync-connector-genericsql/createconnector.png)

### <a name="connectivity"></a>Соединение
Hello соединителя использует файл источника данных ODBC для подключения. Создание hello файлового DSN с помощью **источники данных ODBC** в меню "Пуск" hello в **Администрирование**. В средстве администрирования hello, создайте **файловый DSN** , может быть предоставлен toohello соединителя.

![Создание соединителя](./media/active-directory-aadconnectsync-connector-genericsql/connectivity.png)

экран приветствия подключения при hello сначала создается новый универсальный соединитель SQL. Необходимо сначала hello tooprovide следующую информацию:

* Путь к DSN-файлу
* Аутентификация
  * Имя пользователя
  * Пароль

Hello базы данных должен поддерживать один из следующих методов проверки подлинности:

* **Проверка подлинности Windows**: hello, проверка подлинности базы данных использует пользователь hello tooverify учетные данные Windows hello. Hello имя пользователя и пароль указан — используется tooauthenticate с базой данных hello. Эта учетная запись должна базы данных toohello разрешения.
* **Проверка подлинности SQL**: hello, проверка подлинности базы данных использует hello имя пользователя и пароль определен одной hello подключения экрана tooconnect toohello базы данных. Если имя пользователя hello и пароль хранятся в файле DSN hello, учетные данные hello на экране приветствия подключения имеют более высокий приоритет.
* **Проверки подлинности базы данных SQL Azure**: Дополнительные сведения см. в разделе [tooSQL базы данных с использованием Azure Active Directory проверки подлинности подключения](../../sql-database/sql-database-aad-authentication.md).

**Различающееся имя является привязка**: Если этот параметр выбран, hello различающееся имя также используется в качестве hello привязки атрибута. Он может использоваться для простой реализации, но также имеет следующие ограничения hello:

* Соединитель поддерживает только один тип объекта. Поэтому любой ссылки, которую может ссылаться только атрибуты hello объект такого же типа.

**Тип экспорта: Объект замены**: во время экспорта, когда только некоторые атрибуты были изменены, экспортируется весь объект hello со всеми атрибутами и заменяет hello существующего объекта.

### <a name="schema-1-detect-object-types"></a>Схема 1 (определение типов объектов)
На этой странице будет tooconfigure как hello соединитель является постоянной toofind hello различных типов объектов в базе данных hello.

Каждый тип объектов представляется в виде раздела и может быть настроен впоследствии на странице **Configure Partitions and Hierarchies**(Настройка разделов и иерархий).

![schema1a](./media/active-directory-aadconnectsync-connector-genericsql/schema1a.png)

**Метод обнаружения типа объекта**: hello соединитель поддерживает эти средства определения типа объекта.

* **Фиксированное значение**: укажите hello список типов объектов с разделителями-запятыми. Например, `User,Group,Department`.  
  ![schema1b](./media/active-directory-aadconnectsync-connector-genericsql/schema1b.png)
* **Таблица, представление или хранимая процедура**: укажите имя hello hello таблицы и хранимые процедуры, а затем имя столбца hello, предоставляющий hello список типов объектов. Если хранимая процедура затем также предоставляют параметры для него в формате hello **[имя]: [направление]: [значение]**. Укажите каждый параметр в отдельной строке (используйте сочетание клавиш Ctrl + Ввод tooget новой строки).  
  ![schema1c](./media/active-directory-aadconnectsync-connector-genericsql/schema1c.png)
* **SQL-запрос**: этот параметр позволяет tooprovide SQL-запроса, возвращающее один столбец с типом объекта, например `SELECT [Column Name] FROM TABLENAME`. столбец должен иметь тип string (varchar) вернул Hello.

### <a name="schema-2-detect-attribute-types"></a>Схема 2 (определение типов атрибутов)
На этой странице вы собираетесь tooconfigure hello как имена атрибутов и типы будут обнаружены toobe. для каждого типа объекта, на предыдущую страницу приветствия обнаружена перечислены параметры конфигурации Hello.

![schema2a](./media/active-directory-aadconnectsync-connector-genericsql/schema2a.png)

**Атрибут типа метода обнаружения**: hello соединитель поддерживает эти средства определения типа атрибута с каждым типом объектов, обнаруженных в схеме 1 экрана.

* **Таблица, представление или хранимая процедура**: укажите имя hello hello таблицы и хранимые процедуры, которые должны быть имена атрибутов используется toofind hello. Если хранимая процедура затем также предоставляют параметры для него в формате hello **[имя]: [направление]: [значение]**. Укажите каждый параметр в отдельной строке (используйте сочетание клавиш Ctrl + Ввод tooget новой строки). имена атрибутов toodetect hello в многозначном атрибуте, укажите список разделенных запятыми таблиц или представлений. Многозначные атрибуты не поддерживаются, если имена столбцов в родительской и дочерней таблицах совпадают.
* **SQL-запрос**: этот параметр позволяет tooprovide SQL-запроса, возвращающее один столбец с имена атрибутов, например `SELECT [Column Name] FROM TABLENAME`. столбец должен иметь тип string (varchar) вернул Hello.

### <a name="schema-3-define-anchor-and-dn"></a>Схема 3 (определение привязки и различаемого имени)
Эта страница позволяет tooconfigure привязки и атрибутов различающееся имя для каждого типа обнаруженных объектов. Можно выбрать несколько атрибутов toomake hello привязки уникальным.

![schema3a](./media/active-directory-aadconnectsync-connector-genericsql/schema3a.png)

* Многозначные и логические атрибуты в список не включаются.
* Один атрибут нельзя использовать для DN и привязка, если **DN является привязка** выбран на странице подключения hello.
* Если **DN является привязка** выбран на странице приветствия подключения к этой страницы требуется только hello различающееся имя атрибута. Этот атрибут будет также использоваться как атрибут привязки hello.

  ![schema3b](./media/active-directory-aadconnectsync-connector-genericsql/schema3b.png)

### <a name="schema-4-define-attribute-type-reference-and-direction"></a>Схема 4 (определение типа атрибута, ссылки и направления)
Эта страница позволяет tooconfigure hello атрибут типа, например целое число со знаком, двоичные данные, или логические и направление для каждого атрибута. Здесь приводятся все атрибуты со страницы **Схема 2** , включая многозначные атрибуты.

![schema4a](./media/active-directory-aadconnectsync-connector-genericsql/schema4a.png)

* **Тип данных**: использовать toomap hello атрибут типа toothose типов обработчиком синхронизации hello. по умолчанию Hello hello toouse того же типа, обнаруженного в схеме SQL hello, но DateTime и ссылки, невозможно легко выявить. Для них, потребуется toospecify **DateTime** или **ссылка**.
* **Направление**: можно задать направление tooImport hello атрибута, экспорт и ImportExport. Значением по умолчанию является ImportExport.

![schema4b](./media/active-directory-aadconnectsync-connector-genericsql/schema4b.png)

Примечания:

* Если тип атрибута не удается обнаружить по hello соединитель, он использует hello строкового типа данных.
* **Вложенные таблицы** можно считать таблицами с одним столбцом. Oracle хранит hello строки вложенной таблицы в произвольном порядке. Тем не менее при извлечении hello вложенной таблицы в переменную PL/SQL, hello строкам присваивается последовательных индексы, начиная с 1. Который предоставляет доступ через массив tooindividual строк.
* **VARRYS** не поддерживаются в соединителе hello.

### <a name="schema-5-define-partition-for-reference-attributes"></a>Схема 5 (определение разделов для ссылочных атрибутов)
На этой странице для всех ссылочных атрибутов указываются разделы (типы объектов), на которые ссылается атрибут.

![schema5](./media/active-directory-aadconnectsync-connector-genericsql/schema5.png)

Если вы используете **DN является привязка**, необходимо использовать один тип объектов, сколько hello один при ссылке из hello. Ссылаться на объект другого типа нельзя.

>[!NOTE]
Начиная с обновления hello марта 2017 г., теперь есть возможность «*» Если этот параметр не выбран, а затем все типы членов, возможно, будут импортированы.

![globalparameters3](./media/active-directory-aadconnectsync-connector-genericsql/any-option.png)

>[!IMPORTANT]
 По состоянию на май 2017 г Здравствуйте, «*» aka **любой параметр** был изменен toosupport импорта и экспорта потока. Если вы хотите toouse этот параметр Многозначный таблиц и представлений должны быть атрибут, содержащий тип hello объекта.

![](./media/active-directory-aadconnectsync-connector-genericsql/any-02.png)

 </br> Если «*» выбран, то также необходимо указать имя hello hello столбца с типом hello объекта.</br> ![](./media/active-directory-aadconnectsync-connector-genericsql/any-03.png)

После импорта вы увидите, что-нибудь подобное toohello рисунке ниже:

  ![globalparameters3](./media/active-directory-aadconnectsync-connector-genericsql/after-import.png)



### <a name="global-parameters"></a>Глобальные параметры
Hello глобальные параметры страницы — используется tooconfigure разностный Импорт формат даты и времени и метод пароля.

![globalparameters1](./media/active-directory-aadconnectsync-connector-genericsql/globalparameters1.png)



Hello универсальный соединитель SQL поддерживает следующие методы для разностный Импорт hello:

* **Триггер**. См. статью [Generating Delta Views Using Triggers](https://technet.microsoft.com/library/cc708665.aspx) (Создание представлений изменений с помощью триггеров).
* **Водяной знак**. Это общий подход, который может использоваться с любой базой данных. запрос Hello водяного знака предварительно заполняется в зависимости от поставщика базы данных hello. В каждой используемой таблице или представлении должен присутствовать столбец для водяного знака. Этот столбец должен отслеживать операции вставки и обновления таблицы toohello как и зависимых (допускающее или дочерних) таблиц. часы Hello между службой синхронизации и hello сервера базы данных должны быть синхронизированы. В противном случае некоторые записи в hello разностный Импорт могут быть опущены.  
  Ограничение:
  * Функция водяных знаков не поддерживает удаленные объекты.
* **Моментальный снимок** (работает только с Microsoft SQL Server). См. статью о [создании представлений изменений с использованием моментальных снимков](https://technet.microsoft.com/library/cc720640.aspx).
* **Отслеживание изменений** (работает только с Microsoft SQL Server). См. статью [Об отслеживании изменений (SQL Server)](https://msdn.microsoft.com/library/bb933875.aspx).  
  Ограничения:
  * Привязать & DN атрибут должен быть частью первичного ключа для выбранного объекта hello в таблице hello.
  * Во время импорта и экспорта данных с использованием функции отслеживания изменений SQL-запросы не поддерживаются.

**Дополнительные параметры**: укажите hello часовым поясом сервера базы данных, позволяющее определить, где размещен сервер базы данных. Это значение используется toosupport hello различные форматы даты и времени атрибуты.

Hello соединитель всегда хранится Дата и Дата и время в формате UTC. может toocorrectly toobe преобразовать hello даты и времени, должен быть указан часовой пояс hello hello сервера базы данных и формат hello. Hello формат должен быть выражен в формате .net.

Во время экспорта каждый атрибут даты времени должен быть предоставлен toohello соединителя в формате времени UTC.

![globalparameters2](./media/active-directory-aadconnectsync-connector-genericsql/globalparameters2.png)

**Конфигурация паролей**: hello соединителя предоставляет возможности синхронизации паролей и поддерживает задание и изменение пароля.

Hello соединителя предоставляет два метода синхронизации паролей toosupport:

* **Хранимая процедура**: этот метод требует двух хранимых процедур toosupport набор & Сменить пароль. Введите все параметры для добавления и изменения паролей hello в **задать пароль SP** и **изменить пароль SP** параметры соответственно как в примере ниже.
  ![globalparameters3](./media/active-directory-aadconnectsync-connector-genericsql/globalparameters3.png)
* **Расширение пароль**: этот метод требует DLL расширения пароль (требуется hello tooprovide имя библиотеки DLL расширения, реализуемых hello [IMAExtensible2Password](https://msdn.microsoft.com/library/microsoft.metadirectoryservices.imaextensible2password.aspx) интерфейс). Сборка модуля пароль следует разместить в папки расширения, чтобы соединитель hello могли загружать hello DLL во время выполнения.
  ![globalparameters4](./media/active-directory-aadconnectsync-connector-genericsql/globalparameters4.png)

Также имеется hello tooenable управление паролями на hello **настроить расширение** страницы.
![globalparameters5](./media/active-directory-aadconnectsync-connector-genericsql/globalparameters5.png)

### <a name="configure-partitions-and-hierarchies"></a>Настройка разделов и иерархий
На странице приветствия разделов и иерархий выберите все типы объектов. Каждый тип помещается в отдельный раздел.

![partitions1](./media/active-directory-aadconnectsync-connector-genericsql/partitions1.png)

Можно также переопределить hello значений, определенных на hello **подключения** или **глобальных параметров** страницы.

![partitions2](./media/active-directory-aadconnectsync-connector-genericsql/partitions2.png)

### <a name="configure-anchors"></a>Настройка привязок
Эта страница доступна только для чтения, так как уже было определено hello привязки. Hello выбранные привязки атрибута всегда добавляются с tooensure типа hello объекта остается уникальный различных типов объектов.

![Привязки](./media/active-directory-aadconnectsync-connector-genericsql/anchors.png)

## <a name="configure-run-step-parameter"></a>Настройка параметров шагов выполнения
Эти действия можно настроить на hello профилей выполнения для соединителя hello. Эти конфигурации hello фактические трудозатраты импорта и экспорта данных.

### <a name="full-and-delta-import"></a>Полный импорт и импорт изменений
Универсальный соединитель SQL поддерживает следующие методы полного импорта и импорта изменений.

* Таблица
* Просмотр
* Хранимая процедура
* Запросы SQL

![runstep1](./media/active-directory-aadconnectsync-connector-genericsql/runstep1.png)

**Таблица или представление**  
tooimport многозначных атрибутов для объекта, имя таблицы или представления, разделенных запятыми hello tooprovide имеется в **имя многозначных таблицы и представления** и условия соответствующих соединения в hello **условиеобъединения**с hello родительской таблицы.

Пример: Вы хотите tooimport hello сотрудника объект и все его многозначных атрибутов. Существует две таблицы: Employee (главная таблица) и Department (многозначная таблица).
Здравствуйте, следующие:

* В поле **Таблица/представление/хранимая процедура** введите **Employee**.
* В поле **Имена многозначных таблиц или представлений**введите Department.
* Введите условие соединения hello между Employee & в отделе **условие соединения**, например `Employee.DEPTID=Department.DepartmentID`.
  ![runstep2](./media/active-directory-aadconnectsync-connector-genericsql/runstep2.png)

**Хранимые процедуры**  
![runstep3](./media/active-directory-aadconnectsync-connector-genericsql/runstep3.png)

* При наличии большого объема данных, рекомендуется tooimplement разбиение на страницы с помощью хранимых процедур.
* Для вашего хранимой процедуры toosupport разбиения на страницы необходимо tooprovide начального индекса и конечного индекса. См. статью [Efficiently Paging Through Large Amounts of Data](https://msdn.microsoft.com/library/bb445504.aspx) (Эффективное разбиение больших объемов данных).
* @StartIndex и @EndIndex во время выполнения заменяются соответствующими значениями размера страницы, которые настраиваются на странице **Configure Step** (Настройка шага). Например, если соединитель hello извлекает первой страницы и размера страницы приветствия имеет значение 500, в такой ситуации @StartIndex будет равно 1 и @EndIndex 500. Эти значения увеличить время, когда соединитель получает последующих страницах и изменить hello @StartIndex & @EndIndex значение.
* tooexecute параметризованные хранимые процедуры, укажите параметры hello в `[Name]:[Direction]:[Value]` формате. Введите каждый параметр в отдельной строке (используйте сочетание клавиш Ctrl + Ввод tooget новой строки).
* Универсальный соединитель SQL также поддерживает операции импорта из связанных серверов на сервере Microsoft SQL Server. Если сведения должны быть получены из таблицы в связанный сервер, таблицы должны предоставляться в формате hello:`[ServerName].[Database].[Schema].[TableName]`
* Универсальный соединитель SQL поддерживает только те объекты, структура (имя псевдонима и тип данных) которых в шагах выполнения и в схеме совпадает. Если выбран hello отличается объект из схемы и предоставленной информации на этапе выполнения, то соединитель SQL невозможно toosupport таких сценариев.

**Запросы SQL**  
![runstep4](./media/active-directory-aadconnectsync-connector-genericsql/runstep4.png)

![runstep5](./media/active-directory-aadconnectsync-connector-genericsql/runstep5.png)

* Запросы с несколькими результирующими наборами не поддерживаются.
* SQL-запроса поддерживает hello разбиение на страницы и позволяют и конечный индексы в виде переменной toosupport разбиения на страницы.

### <a name="delta-import"></a>импорт изменений;
![runstep6](./media/active-directory-aadconnectsync-connector-genericsql/runstep6.png)

Для конфигурации импорта изменений требуются некоторые дополнительные настройки по сравнению с полным импортом.

* Если выбран hello триггера или моментального снимка подход tootrack незначительные изменения, укажите таблицу журнала или моментального снимка базы данных в **имя таблицы журнала или моментального снимка базы данных** поле.
* Необходимо также tooprovide условия соединения между таблицей журнала и родительской таблицы, например`Employee.ID=History.EmployeeID`
* транзакция hello tootrack hello родительской таблицы из таблицы журнала hello, необходимо указать имя hello столбца, содержащего сведения об операциях hello (Добавление, обновление и удаление).
* При выборе tootrack водяного знака изменений, затем укажите hello имя столбца, который содержит операцию hello в **имя столбца метки вода**.
* Hello **изменить атрибут типа** необходим столбец типа hello изменений. Этот столбец сопоставлен изменением, которое произошло в таблице первичного hello или нескольких значений в таблице tooa измените тип в hello дельта-представления. Этот столбец может содержать тип изменения Modify_Attribute hello для изменений на уровне атрибута или добавления, изменения или удаления измените тип для типа изменений на уровне объектов. Если он имеет отличное от значения по умолчанию hello добавить, изменить или Delete, то можно определить эти значения с помощью этого параметра.

### <a name="export"></a>экспорт.
![runstep7](./media/active-directory-aadconnectsync-connector-genericsql/runstep7.png)

Универсальный соединитель SQL поддерживает четыре метода экспорта.

* Таблица
* Просмотр
* Хранимая процедура
* Запросы SQL

**Таблица или представление**  
При выборе hello параметр таблицы или представления, соединитель hello создает hello соответствующие запросы toodo hello экспорта.

**Хранимые процедуры**  
![runstep8](./media/active-directory-aadconnectsync-connector-genericsql/runstep8.png)

При выборе параметра хранимой процедуры hello экспорта требуется три различных хранимой процедуры tooperform вставки/обновления/удаления операций.

* **Добавьте имя SP**: этот пакет выполняется, если любой объект поступает tooconnector вставки в соответствующей таблице hello.
* **Обновите имя SP**: этот пакет выполняется, если любой объект поступает tooconnector для обновления в соответствующей таблице hello.
* **Удалите имя SP**: этот пакет выполняется, если любой объект поступает tooconnector для удаления в соответствующей таблице hello.
* Атрибут, выбранный из схемы hello, используется в качестве параметра значение toohello хранимой процедуры. Например `EmployeeName: INPUT: @EmployeeName` (EmployeeName выбран в схеме соединителя hello и соединитель hello заменяет hello соответствующее значение во время выполнения экспорта)
* toorun параметризованные хранимые процедуры, укажите параметры в `[Name]:[Direction]:[Value]` формате. Введите каждый параметр в отдельной строке (используйте сочетание клавиш Ctrl + Ввод tooget новой строки).

**SQL query**  
![runstep9](./media/active-directory-aadconnectsync-connector-genericsql/runstep9.png)

При выборе параметра запроса SQL hello экспорта требуется три разных запросов операций Insert/Update/Delete tooperform.

* **Вставить запрос**: этот запрос выполняется, если любой объект переходит в tooconnector вставки в соответствующей таблице hello.
* **Запрос на обновление**: этот запрос выполняется, если любой объект переходит в tooconnector для обновления в соответствующей таблице hello.
* **Запрос на удаление**: этот запрос выполняется, если любой объект переходит в tooconnector для удаления в соответствующей таблице hello.
* Атрибут, выбранный из схемы hello, используемый как запрос toohello значение параметра, например`Insert into Employee (ID, Name) Values (@ID, @EmployeeName)`

## <a name="troubleshooting"></a>Устранение неполадок
* Сведения о как ведение журнала tooenable tootroubleshoot hello соединителя разделе hello [как трассировка ETW для соединителей tooEnable](http://go.microsoft.com/fwlink/?LinkId=335731).
