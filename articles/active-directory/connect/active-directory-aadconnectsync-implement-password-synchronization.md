---
title: "Синхронизация паролей aaaImplement с Azure AD Connect sync | Документы Microsoft"
description: "Предоставляет сведения о, как работает синхронизация паролей и как tooset вверх."
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
editor: 
ms.assetid: 05f16c3e-9d23-45dc-afca-3d0fa9dbf501
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: a0401640f2a4d914419ee4446f923bb3a972389d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="implement-password-synchronization-with-azure-ad-connect-sync"></a><span data-ttu-id="163bc-103">Реализация синхронизации паролей с помощью Azure AD Connect Sync</span><span class="sxs-lookup"><span data-stu-id="163bc-103">Implement password synchronization with Azure AD Connect sync</span></span>
<span data-ttu-id="163bc-104">Эта статья содержит сведения, необходимые toosynchronize пароли пользователей из локальной Active Directory экземпляр tooa облачного Azure Active Directory (Azure AD) экземпляра.</span><span class="sxs-lookup"><span data-stu-id="163bc-104">This article provides information that you need toosynchronize your user passwords from an on-premises Active Directory instance tooa cloud-based Azure Active Directory (Azure AD) instance.</span></span>

## <a name="what-is-password-synchronization"></a><span data-ttu-id="163bc-105">Что такое синхронизация паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-105">What is password synchronization</span></span>
<span data-ttu-id="163bc-106">Hello вероятности, которые вы запретить выполнение задач из-за tooa забыт пароль связан номер toohello разные пароли должны tooremember.</span><span class="sxs-lookup"><span data-stu-id="163bc-106">hello probability that you're blocked from getting your work done due tooa forgotten password is related toohello number of different passwords you need tooremember.</span></span> <span data-ttu-id="163bc-107">Здравствуйте, пароли должны tooremember hello выше hello вероятности tooforget один.</span><span class="sxs-lookup"><span data-stu-id="163bc-107">hello more passwords you need tooremember, hello higher hello probability tooforget one.</span></span> <span data-ttu-id="163bc-108">Вопросы и вызовы о сбросах паролей и других проблем, связанных с паролем запросу hello больше всего ресурсов службы технической поддержки.</span><span class="sxs-lookup"><span data-stu-id="163bc-108">Questions and calls about password resets and other password-related issues demand hello most helpdesk resources.</span></span>

<span data-ttu-id="163bc-109">Синхронизация паролей — это функция используемых toosynchronize пароли пользователей из экземпляра локального экземпляра Active Directory tooa облачного Azure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-109">Password synchronization is a feature used toosynchronize user passwords from an on-premises Active Directory instance tooa cloud-based Azure AD instance.</span></span>
<span data-ttu-id="163bc-110">Используйте этот компонент toosign в tooAzure AD служб, таких как Office 365, Microsoft Intune, CRM Online и доменных служб Azure Active Directory (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="163bc-110">Use this feature toosign in tooAzure AD services like Office 365, Microsoft Intune, CRM Online, and Azure Active Directory Domain Services (Azure AD DS).</span></span> <span data-ttu-id="163bc-111">Войти в службе toohello с помощью hello использовать toosign в tooyour пароль локального экземпляра Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-111">You sign in toohello service by using hello same password you use toosign in tooyour on-premises Active Directory instance.</span></span>

![Что такое Azure AD Connect?](./media/active-directory-aadconnectsync-implement-password-synchronization/arch1.png)

<span data-ttu-id="163bc-113">Благодаря уменьшению числа hello пароли, вашим пользователям требуется toojust toomaintain один.</span><span class="sxs-lookup"><span data-stu-id="163bc-113">By reducing hello number of passwords, your users need toomaintain toojust one.</span></span> <span data-ttu-id="163bc-114">Синхронизация паролей дает следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="163bc-114">Password synchronization helps you to:</span></span>

* <span data-ttu-id="163bc-115">Повысить производительность hello пользователей.</span><span class="sxs-lookup"><span data-stu-id="163bc-115">Improve hello productivity of your users.</span></span>
* <span data-ttu-id="163bc-116">Снижение затрат на техническую поддержку.</span><span class="sxs-lookup"><span data-stu-id="163bc-116">Reduce your helpdesk costs.</span></span>  

<span data-ttu-id="163bc-117">Кроме того Если вы решите toouse [федерации со службами федерации Active Directory (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), то при необходимости можно настроить синхронизацию паролей в резервную копию в случае сбоя инфраструктуры AD FS.</span><span class="sxs-lookup"><span data-stu-id="163bc-117">Also, if you decide toouse [Federation with Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), you can optionally set up password synchronization as a backup in case your AD FS infrastructure fails.</span></span>

<span data-ttu-id="163bc-118">Синхронизация паролей — функции синхронизации каталогов toohello расширения, реализуемых синхронизации Azure AD Connect. Синхронизация паролей toouse в вашей среде, необходимо:</span><span class="sxs-lookup"><span data-stu-id="163bc-118">Password synchronization is an extension toohello directory synchronization feature implemented by Azure AD Connect sync. toouse password synchronization in your environment, you need to:</span></span>

* <span data-ttu-id="163bc-119">Установите Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="163bc-119">Install Azure AD Connect.</span></span>  
* <span data-ttu-id="163bc-120">Настройте синхронизацию каталогов между локальным экземпляром службы Active Directory и облачным экземпляром Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-120">Configure directory synchronization between your on-premises Active Directory instance and your Azure Active Directory instance.</span></span>
* <span data-ttu-id="163bc-121">Включите синхронизацию паролей.</span><span class="sxs-lookup"><span data-stu-id="163bc-121">Enable password synchronization.</span></span>

<span data-ttu-id="163bc-122">Дополнительные сведения см. в статье [Интеграция локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="163bc-122">For more details, see [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>

> [!NOTE]
> <span data-ttu-id="163bc-123">Дополнительную информацию о настройке доменных служб Azure Active Directory для использования FIPS и синхронизации паролей, см. в разделе "Синхронизация паролей и FIPS" дальше в этой статье.</span><span class="sxs-lookup"><span data-stu-id="163bc-123">For more details about Azure Active Directory Domain Services configured for FIPS and password synchronization, see "Password synchronization and FIPS" later in this article.</span></span>
>
>

## <a name="how-password-synchronization-works"></a><span data-ttu-id="163bc-124">Как работает синхронизация паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-124">How password synchronization works</span></span>
<span data-ttu-id="163bc-125">Hello доменные службы Active Directory сохраняет пароли в виде hello представления значение хэша hello фактические пароли пользователей.</span><span class="sxs-lookup"><span data-stu-id="163bc-125">hello Active Directory domain service stores passwords in hello form of a hash value representation of hello actual user password.</span></span> <span data-ttu-id="163bc-126">Хэш-значение является результатом необратимой математической функции (hello *хэш-алгоритм*).</span><span class="sxs-lookup"><span data-stu-id="163bc-126">A hash value is a result of a one-way mathematical function (hello *hashing algorithm*).</span></span> <span data-ttu-id="163bc-127">Отсутствует результирующий hello метод toorevert версии односторонняя функция toohello обычный текст пароля.</span><span class="sxs-lookup"><span data-stu-id="163bc-127">There is no method toorevert hello result of a one-way function toohello plain text version of a password.</span></span> <span data-ttu-id="163bc-128">Нельзя использовать toosign хэш пароля в tooyour локальной сети.</span><span class="sxs-lookup"><span data-stu-id="163bc-128">You cannot use a password hash toosign in tooyour on-premises network.</span></span>

<span data-ttu-id="163bc-129">toosynchronize, пароль, Azure AD Connect sync Извлекает хэш пароля в из hello локальным экземпляром Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-129">toosynchronize your password, Azure AD Connect sync extracts your password hash from hello on-premises Active Directory instance.</span></span> <span data-ttu-id="163bc-130">Обработка дополнительной безопасности применяется toohello хэш пароля, прежде чем он будет синхронизирован toohello службы проверки подлинности Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-130">Extra security processing is applied toohello password hash before it is synchronized toohello Azure Active Directory authentication service.</span></span> <span data-ttu-id="163bc-131">Пароли синхронизируются для каждого пользователя отдельно и в хронологическом порядке.</span><span class="sxs-lookup"><span data-stu-id="163bc-131">Passwords are synchronized on a per-user basis and in chronological order.</span></span>

<span data-ttu-id="163bc-132">Hello реальный поток данных процесса синхронизации пароля hello — примерно toohello синхронизации данных пользователя, таких как DisplayName или адреса электронной почты.</span><span class="sxs-lookup"><span data-stu-id="163bc-132">hello actual data flow of hello password synchronization process is similar toohello synchronization of user data such as DisplayName or Email Addresses.</span></span> <span data-ttu-id="163bc-133">Однако пароли синхронизируются чаще, чем окно синхронизации hello стандартного каталога для других атрибутов.</span><span class="sxs-lookup"><span data-stu-id="163bc-133">However, passwords are synchronized more frequently than hello standard directory synchronization window for other attributes.</span></span> <span data-ttu-id="163bc-134">процесс синхронизации паролей Hello выполняется каждые 2 минуты.</span><span class="sxs-lookup"><span data-stu-id="163bc-134">hello password synchronization process runs every 2 minutes.</span></span> <span data-ttu-id="163bc-135">Невозможно изменить частоту hello этого процесса.</span><span class="sxs-lookup"><span data-stu-id="163bc-135">You cannot modify hello frequency of this process.</span></span> <span data-ttu-id="163bc-136">При синхронизации пароля, он переопределяет hello существующий пароль для облака.</span><span class="sxs-lookup"><span data-stu-id="163bc-136">When you synchronize a password, it overwrites hello existing cloud password.</span></span>

<span data-ttu-id="163bc-137">Hello впервые включена функция синхронизации паролей hello, он выполняет начальную синхронизацию hello паролей всех пользователей в области видимости.</span><span class="sxs-lookup"><span data-stu-id="163bc-137">hello first time you enable hello password synchronization feature, it performs an initial synchronization of hello passwords of all in-scope users.</span></span> <span data-ttu-id="163bc-138">Нельзя явно определять подмножество пароли пользователей, которые должны toosynchronize.</span><span class="sxs-lookup"><span data-stu-id="163bc-138">You cannot explicitly define a subset of user passwords that you want toosynchronize.</span></span>

<span data-ttu-id="163bc-139">При изменении пароля с локальными hello обновить пароль будет синхронизирован, наиболее часто в течение нескольких минут.</span><span class="sxs-lookup"><span data-stu-id="163bc-139">When you change an on-premises password, hello updated password is synchronized, most often in a matter of minutes.</span></span>
<span data-ttu-id="163bc-140">Hello функция синхронизации паролей автоматически повторяет попытку синхронизации.</span><span class="sxs-lookup"><span data-stu-id="163bc-140">hello password synchronization feature automatically retries failed synchronization attempts.</span></span> <span data-ttu-id="163bc-141">При возникновении ошибки во время попытки toosynchronize пароль, ошибка записывается в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="163bc-141">If an error occurs during an attempt toosynchronize a password, an error is logged in your event viewer.</span></span>

<span data-ttu-id="163bc-142">Синхронизация пароля Hello не оказывает влияния на пользователя hello, который подключен к сети.</span><span class="sxs-lookup"><span data-stu-id="163bc-142">hello synchronization of a password has no impact on hello user  who is currently signed in.</span></span>
<span data-ttu-id="163bc-143">Текущий сеанс облачной службы является изменение не затрагивает немедленно синхронизированным паролем при входе в облачной службе tooa.</span><span class="sxs-lookup"><span data-stu-id="163bc-143">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you are signed in tooa cloud service.</span></span> <span data-ttu-id="163bc-144">Тем не менее когда hello облачная служба требует tooauthenticate снова, вам нужно tooprovide новый пароль.</span><span class="sxs-lookup"><span data-stu-id="163bc-144">However, when hello cloud service requires you tooauthenticate again, you need tooprovide your new password.</span></span>

<span data-ttu-id="163bc-145">Пользователь должен ввести свои корпоративные учетные данные второй раз tooauthenticate tooAzure AD, независимо от того, вошли ли они в tootheir корпоративной сети.</span><span class="sxs-lookup"><span data-stu-id="163bc-145">A user must enter their corporate credentials a second time tooauthenticate tooAzure AD, regardless of whether they're signed in tootheir corporate network.</span></span> <span data-ttu-id="163bc-146">Эти шаблон можно свести к минимуму, тем не менее, если hello пользователь выбирает hello оставаться системе флажок (KMSI) при входе.</span><span class="sxs-lookup"><span data-stu-id="163bc-146">These pattern can be minimized, however, if hello user selects hello Keep me signed in (KMSI) check box at sign in.</span></span> <span data-ttu-id="163bc-147">Это действие создает для сеанса файл cookie, который на некоторое время позволяет обходить аутентификацию.</span><span class="sxs-lookup"><span data-stu-id="163bc-147">This selection sets a session cookie that bypasses authentication for a short period.</span></span> <span data-ttu-id="163bc-148">KMSI поведения можно включить или отключить Здравствуйте, администратор Azure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-148">KMSI behavior can be enabled or disabled by hello Azure AD administrator.</span></span>

> [!NOTE]
> <span data-ttu-id="163bc-149">Синхронизация паролей поддерживается только для hello объекта типа пользователя в Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-149">Password sync is only supported for hello object type user in Active Directory.</span></span> <span data-ttu-id="163bc-150">Не поддерживается для типа объекта iNetOrgPerson hello.</span><span class="sxs-lookup"><span data-stu-id="163bc-150">It is not supported for hello iNetOrgPerson object type.</span></span>

### <a name="detailed-description-of-how-password-synchronization-works"></a><span data-ttu-id="163bc-151">Подробное описание принципа действия синхронизации паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-151">Detailed description of how password synchronization works</span></span>
<span data-ttu-id="163bc-152">Hello ниже приводится подробное описание и как работает синхронизация паролей между Active Directory и Azure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-152">hello following describes in-depth how password synchronization works between Active Directory and Azure AD.</span></span>

![Подробная схема использования паролей](./media/active-directory-aadconnectsync-implement-password-synchronization/arch3.png)


1. <span data-ttu-id="163bc-154">Каждые две минуты hello агент синхронизации паролей на сервере подключение hello AD запрашивает хэши сохраненный пароль (hello атрибута unicodePwd) из контроллера домена через стандартные hello [MS DRSR](https://msdn.microsoft.com/library/cc228086.aspx) toosynchronize данных использовать протокол репликации между контроллерами доменов.</span><span class="sxs-lookup"><span data-stu-id="163bc-154">Every two minutes, hello password synchronization agent on hello AD Connect server requests stored password hashes (hello unicodePwd attribute) from a DC via hello standard [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) replication protocol used toosynchronize data between DCs.</span></span> <span data-ttu-id="163bc-155">Учетная запись службы Hello должен иметь репликация изменений каталога и репликацию каталогов все изменения AD хэши паролей hello tooobtain разрешения (по умолчанию при установке).</span><span class="sxs-lookup"><span data-stu-id="163bc-155">hello service account must have Replicate Directory Changes and Replicate Directory Changes All AD permissions (granted by default on installation) tooobtain hello password hashes.</span></span>
2. <span data-ttu-id="163bc-156">Перед отправкой, hello DC шифрует hello MD4 хэш пароля с помощью ключа, который является [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) хэш ключа сеанса RPC hello и соль.</span><span class="sxs-lookup"><span data-stu-id="163bc-156">Before sending, hello DC encrypts hello MD4 password hash by using a key that is a [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash of hello RPC session key and a salt.</span></span> <span data-ttu-id="163bc-157">Агент синхронизации паролей toohello результат hello отправляется через RPC.</span><span class="sxs-lookup"><span data-stu-id="163bc-157">It then sends hello result toohello password synchronization agent over RPC.</span></span> <span data-ttu-id="163bc-158">Hello контроллера домена также передает агент синхронизации hello соли toohello по протоколу hello контроллера домена репликации, таким образом, агент hello может toodecrypt hello конверта.</span><span class="sxs-lookup"><span data-stu-id="163bc-158">hello DC also passes hello salt toohello synchronization agent by using hello DC replication protocol, so hello agent will be able toodecrypt hello envelope.</span></span>
3.  <span data-ttu-id="163bc-159">Получив зашифрованную оболочку hello, агент синхронизации паролей hello использует [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) и hello toogenerate соли ключа toodecrypt hello полученных задней tooits исходного MD4 формат данных.</span><span class="sxs-lookup"><span data-stu-id="163bc-159">After hello password synchronization agent has hello encrypted envelope, it uses [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) and hello salt toogenerate a key toodecrypt hello received data back tooits original MD4 format.</span></span> <span data-ttu-id="163bc-160">Ни на одном этапе агент синхронизации паролей hello имеет доступ toohello открытый пароль.</span><span class="sxs-lookup"><span data-stu-id="163bc-160">At no point does hello password synchronization agent have access toohello clear text password.</span></span> <span data-ttu-id="163bc-161">Hello агент синхронизации паролей MD5 используется исключительно для совместимости протокола репликации с hello контроллера домена и он используется только на локальном компьютере между hello контроллера домена и агент синхронизации паролей hello.</span><span class="sxs-lookup"><span data-stu-id="163bc-161">hello password synchronization agent’s use of MD5 is strictly for replication protocol compatibility with hello DC, and it is only used on premises between hello DC and hello password synchronization agent.</span></span>
4.  <span data-ttu-id="163bc-162">агент синхронизации паролей Hello расширяет байты too64 хэша пароля двоичные 16-байтовый hello, первый преобразование hello хэш tooa 32-разрядного шестнадцатеричную строку, а затем преобразование этой строки обратно в двоичный файл с кодировкой UTF-16.</span><span class="sxs-lookup"><span data-stu-id="163bc-162">hello password synchronization agent expands hello 16-byte binary password hash too64 bytes by first converting hello hash tooa 32-byte hexadecimal string, then converting this string back into binary with UTF-16 encoding.</span></span>
5.  <span data-ttu-id="163bc-163">агент синхронизации паролей Hello добавляет соли, состоящий из 10 байт рассеивание, toohello 64-байтовое двоичное toofurther защиты hello оригинальный хэш-коды.</span><span class="sxs-lookup"><span data-stu-id="163bc-163">hello password synchronization agent adds a salt, consisting of a 10-byte length salt, toohello 64-byte binary toofurther protect hello original hash.</span></span>
6.  <span data-ttu-id="163bc-164">агент синхронизации паролей Hello на основе хэша hello MD4 плюс соли и он получает на входе в hello [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) функции.</span><span class="sxs-lookup"><span data-stu-id="163bc-164">hello password synchronization agent then combines hello MD4 hash plus salt, and inputs it into hello [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) function.</span></span> <span data-ttu-id="163bc-165">1000 итераций hello [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) используется хэш-алгоритма с ключом.</span><span class="sxs-lookup"><span data-stu-id="163bc-165">1000 iterations of hello [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) keyed hashing algorithm is used.</span></span> 
7.  <span data-ttu-id="163bc-166">агент синхронизации паролей Hello принимает hello результирующий хэш 32 байтам, объединяет оба соли hello и hello число tooit итераций SHA256 (для использования Azure AD), а затем передает строку hello из Azure AD Connect tooAzure AD по протоколу SSL.</span><span class="sxs-lookup"><span data-stu-id="163bc-166">hello password synchronization agent takes hello resulting 32-byte hash, concatenates both hello salt and hello number of SHA256 iterations tooit (for use by Azure AD), then transmits hello string from Azure AD Connect tooAzure AD over SSL.</span></span></br> 
8.  <span data-ttu-id="163bc-167">Когда пользователь пытается toosign в tooAzure AD и вводит свои пароль, пароль hello запуска с помощью hello же MD4 + соли + PBKDF2 + HMAC-SHA256 процесса.</span><span class="sxs-lookup"><span data-stu-id="163bc-167">When a user attempts toosign in tooAzure AD and enters their password, hello password is run through hello same MD4+salt+PBKDF2+HMAC-SHA256 process.</span></span> <span data-ttu-id="163bc-168">Если результирующий хэш hello соответствует хэш hello, сохраненные в Azure AD, hello пользователь ввел правильный пароль hello и проходит проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="163bc-168">If hello resulting hash matches hello hash stored in Azure AD, hello user has entered hello correct password and is authenticated.</span></span> 

>[!Note] 
><span data-ttu-id="163bc-169">Hello исходного MD4-хэширования не передано tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-169">hello original MD4 hash is not transmitted tooAzure AD.</span></span> <span data-ttu-id="163bc-170">Вместо этого передается hello хэш SHA256 hello исходного MD4-хэширования.</span><span class="sxs-lookup"><span data-stu-id="163bc-170">Instead, hello SHA256 hash of hello original MD4 hash is transmitted.</span></span> <span data-ttu-id="163bc-171">В результате Если получить хэш hello, сохраненные в Azure AD, он не может использоваться в локальные атаки pass--hash.</span><span class="sxs-lookup"><span data-stu-id="163bc-171">As a result, if hello hash stored in Azure AD is obtained, it cannot be used in an on-premises pass-the-hash attack.</span></span>

### <a name="how-password-synchronization-works-with-azure-active-directory-domain-services"></a><span data-ttu-id="163bc-172">Как работает синхронизация паролей с доменными службами Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="163bc-172">How password synchronization works with Azure Active Directory Domain Services</span></span>
<span data-ttu-id="163bc-173">Можно также использовать toosynchronize функция синхронизации паролей hello пароли локальных слишком[доменных служб Active Directory Azure](../../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="163bc-173">You can also use hello password synchronization feature toosynchronize your on-premises passwords too[Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span></span> <span data-ttu-id="163bc-174">В этом случае экземпляр hello доменных служб Active Directory Azure использует для проверки подлинности пользователей в облаке hello всех hello методов, доступных в вашем экземпляре в локальной среде Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-174">In this scenario, hello Azure Active Directory Domain Services instance authenticates your users in hello cloud with all hello methods available in your on-premises Active Directory instance.</span></span> <span data-ttu-id="163bc-175">взаимодействие Hello этого сценария — аналогично hello toousing средства миграции Active Directory (ADMT) в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="163bc-175">hello experience of this scenario is similar toousing hello Active Directory Migration Tool (ADMT) in an on-premises environment.</span></span>

### <a name="security-considerations"></a><span data-ttu-id="163bc-176">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="163bc-176">Security considerations</span></span>
<span data-ttu-id="163bc-177">При синхронизации паролей hello текстового версия ваш пароль не предоставляется toohello функция синхронизации паролей, tooAzure AD или любых связанных hello служб.</span><span class="sxs-lookup"><span data-stu-id="163bc-177">When synchronizing passwords, hello plain-text version of your password is not exposed toohello password synchronization feature, tooAzure AD, or any of hello associated services.</span></span>

<span data-ttu-id="163bc-178">Проверка подлинности пользователя выполняется в Azure AD, а не с экземпляром службы каталогов Active Directory организации hello.</span><span class="sxs-lookup"><span data-stu-id="163bc-178">User authentication takes place against Azure AD rather than against hello organization's own Active Directory instance.</span></span> <span data-ttu-id="163bc-179">Если у организации есть предложения по поводу пароль данных в формах, оставляя hello локальный, рассмотрите возможность hello фактов, hello SHA256 пароля данные, хранящиеся в Azure AD — хэш hello исходного MD4-хэширования--значительно более безопасную, чем того, что хранится в Active Directory.</span><span class="sxs-lookup"><span data-stu-id="163bc-179">If your organization has concerns about password data in any form leaving hello premises, consider hello fact that hello SHA256 password data stored in Azure AD--a hash of hello original MD4 hash--is significantly more secure than what is stored in Active Directory.</span></span> <span data-ttu-id="163bc-180">Кроме того так как не удается расшифровать этот хэш SHA256, не удается возвращены toohello корпоративную среду Active Directory и представлен в виде допустимого пользователя пароль во время атаки pass--hash.</span><span class="sxs-lookup"><span data-stu-id="163bc-180">Further, because this SHA256 hash cannot be decrypted, it cannot be brought back toohello organization's Active Directory environment and presented as a valid user password in a pass-the-hash attack.</span></span>





### <a name="password-policy-considerations"></a><span data-ttu-id="163bc-181">Рекомендации по политикам паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-181">Password policy considerations</span></span>
<span data-ttu-id="163bc-182">Есть два типа политик паролей, которые затрагивает синхронизация паролей:</span><span class="sxs-lookup"><span data-stu-id="163bc-182">There are two types of password policies that are affected by enabling password synchronization:</span></span>

* <span data-ttu-id="163bc-183">политика сложности паролей;</span><span class="sxs-lookup"><span data-stu-id="163bc-183">Password complexity policy</span></span>
* <span data-ttu-id="163bc-184">политика срока действия паролей.</span><span class="sxs-lookup"><span data-stu-id="163bc-184">Password expiration policy</span></span>

#### <a name="password-complexity-policy"></a><span data-ttu-id="163bc-185">Политика сложности паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-185">Password complexity policy</span></span>  
<span data-ttu-id="163bc-186">При включении синхронизации паролей hello политика сложности паролей в локальный экземпляр Active Directory переопределения политики сложности в облаке hello для синхронизированных пользователей.</span><span class="sxs-lookup"><span data-stu-id="163bc-186">When password synchronization is enabled, hello password complexity policies in your on-premises Active Directory instance override complexity policies in hello cloud for synchronized users.</span></span> <span data-ttu-id="163bc-187">Можно использовать все пароли допустимым hello из вашей локальной Active Directory экземпляр tooaccess служб Azure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-187">You can use all of hello valid passwords from your on-premises Active Directory instance tooaccess Azure AD services.</span></span>

> [!NOTE]
> <span data-ttu-id="163bc-188">Пароли пользователей, созданные непосредственно в облаке hello по-прежнему являются политики toopassword субъекта, как определено в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="163bc-188">Passwords for users that are created directly in hello cloud are still subject toopassword policies as defined in hello cloud.</span></span>

#### <a name="password-expiration-policy"></a><span data-ttu-id="163bc-189">политика срока действия паролей.</span><span class="sxs-lookup"><span data-stu-id="163bc-189">Password expiration policy</span></span>  
<span data-ttu-id="163bc-190">Если пользователь входит в область hello синхронизации паролей, пароль учетной записи облачной hello устанавливается слишком*никогда не истекает*.</span><span class="sxs-lookup"><span data-stu-id="163bc-190">If a user is in hello scope of password synchronization, hello cloud account password is set too*Never Expire*.</span></span>

<span data-ttu-id="163bc-191">Вы можете продолжить toosign tooyour облачные службы с помощью синхронизированного пароля с истекшим сроком в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="163bc-191">You can continue toosign in tooyour cloud services by using a synchronized password that is expired in your on-premises environment.</span></span> <span data-ttu-id="163bc-192">Обновить пароль облака hello в следующий раз при смене пароля hello в локальной среде hello.</span><span class="sxs-lookup"><span data-stu-id="163bc-192">Your cloud password is updated hello next time you change hello password in hello on-premises environment.</span></span>

#### <a name="account-expiration"></a><span data-ttu-id="163bc-193">Срок действия учетной записи</span><span class="sxs-lookup"><span data-stu-id="163bc-193">Account expiration</span></span>
<span data-ttu-id="163bc-194">Если ваша организация использует атрибут accountExpires hello как часть управление учетными записями пользователей, имейте в виду, что этот атрибут не синхронизированные tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-194">If your organization uses hello accountExpires attribute as part of user account management, be aware that this attribute is not synchronized tooAzure AD.</span></span> <span data-ttu-id="163bc-195">В результате учетная запись Active Directory будет всегда активной в Azure AD, даже если срок ее действия истек в той среде, где настроена синхронизация паролей.</span><span class="sxs-lookup"><span data-stu-id="163bc-195">As a result, an expired Active Directory account in an environment configured for password synchronization will still be active in Azure AD.</span></span> <span data-ttu-id="163bc-196">Рекомендуется, если истек срок действия учетной записи hello действия рабочего процесса должны запускать сценарий PowerShell, отключение учетной записи пользователя hello Azure AD.</span><span class="sxs-lookup"><span data-stu-id="163bc-196">We recommend that if hello account is expired, a workflow action should trigger a PowerShell script that disables hello user's Azure AD account.</span></span> <span data-ttu-id="163bc-197">И наоборот при включении учетной записи hello hello экземпляра Azure AD должна быть включена.</span><span class="sxs-lookup"><span data-stu-id="163bc-197">Conversely, when hello account is turned on, hello Azure AD instance should be turned on.</span></span>

### <a name="overwrite-synchronized-passwords"></a><span data-ttu-id="163bc-198">Перезапись синхронизированных паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-198">Overwrite synchronized passwords</span></span>
<span data-ttu-id="163bc-199">Администратор может вручную сбросить пароль с помощью Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="163bc-199">An administrator can manually reset your password by using Windows PowerShell.</span></span>

<span data-ttu-id="163bc-200">В этом случае новый пароль hello переопределяет синхронизированный пароль, и все политики паролей, определенные в облаке hello, примененные toohello новый пароль.</span><span class="sxs-lookup"><span data-stu-id="163bc-200">In this case, hello new password overrides your synchronized password, and all password policies defined in hello cloud are applied toohello new password.</span></span>

<span data-ttu-id="163bc-201">Если снова изменить пароль локального hello новый пароль будет синхронизирован toohello облака и переопределяет hello вручную обновить пароль.</span><span class="sxs-lookup"><span data-stu-id="163bc-201">If you change your on-premises password again, hello new password is synchronized toohello cloud, and it overrides hello manually updated password.</span></span>

<span data-ttu-id="163bc-202">Синхронизация пароля Hello не оказывает влияния на hello Azure пользователю, вошедшему в систему.</span><span class="sxs-lookup"><span data-stu-id="163bc-202">hello synchronization of a password has no impact on hello Azure user who is signed in.</span></span> <span data-ttu-id="163bc-203">Текущий сеанс облачной службы является изменение не затрагивает немедленно синхронизированным паролем, имеет место, когда вы вошли в облачной службе tooa.</span><span class="sxs-lookup"><span data-stu-id="163bc-203">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you're signed in tooa cloud service.</span></span> <span data-ttu-id="163bc-204">KMSI расширяет hello длительность этого факта.</span><span class="sxs-lookup"><span data-stu-id="163bc-204">KMSI extends hello duration of this difference.</span></span> <span data-ttu-id="163bc-205">Когда hello облачная служба требует tooauthenticate снова, вам нужно tooprovide новый пароль.</span><span class="sxs-lookup"><span data-stu-id="163bc-205">When hello cloud service requires you tooauthenticate again, you need tooprovide your new password.</span></span>

### <a name="additional-advantages"></a><span data-ttu-id="163bc-206">Дополнительные преимущества</span><span class="sxs-lookup"><span data-stu-id="163bc-206">Additional advantages</span></span>

- <span data-ttu-id="163bc-207">Как правило синхронизация паролей — tooimplement проще, чем служба федерации.</span><span class="sxs-lookup"><span data-stu-id="163bc-207">Generally, password synchronization is simpler tooimplement than a federation service.</span></span> <span data-ttu-id="163bc-208">Он не требует дополнительные серверы и устраняет зависимость от пользователей tooauthenticate службы федерации высокой доступности.</span><span class="sxs-lookup"><span data-stu-id="163bc-208">It doesn't require any additional servers, and eliminates dependence on a highly available federation service tooauthenticate users.</span></span> 
- <span data-ttu-id="163bc-209">Также можно включить синхронизацию паролей в toofederation сложения.</span><span class="sxs-lookup"><span data-stu-id="163bc-209">Password synchronization can also be enabled in addition toofederation.</span></span> <span data-ttu-id="163bc-210">Это будет хорошим резервным механизмом на случай сбоя службы федерации.</span><span class="sxs-lookup"><span data-stu-id="163bc-210">It may be used as a fallback if your federation service experiences an outage.</span></span>












## <a name="enable-password-synchronization"></a><span data-ttu-id="163bc-211">Включение синхронизации паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-211">Enable password synchronization</span></span>
<span data-ttu-id="163bc-212">При установке Azure AD Connect с помощью hello **параметров Express** параметр, синхронизация паролей включается автоматически.</span><span class="sxs-lookup"><span data-stu-id="163bc-212">When you install Azure AD Connect by using hello **Express Settings** option, password synchronization is automatically enabled.</span></span> <span data-ttu-id="163bc-213">Дополнительные сведения см. в статье [Приступая к работе с Azure AD Connect с использованием стандартных параметров](active-directory-aadconnect-get-started-express.md).</span><span class="sxs-lookup"><span data-stu-id="163bc-213">For more details, see [Getting started with Azure AD Connect using express settings](active-directory-aadconnect-get-started-express.md).</span></span>

<span data-ttu-id="163bc-214">Если вы используете пользовательские параметры при установке Azure AD Connect, синхронизация паролей — доступны на странице входа в систему пользователя hello.</span><span class="sxs-lookup"><span data-stu-id="163bc-214">If you use custom settings when you install Azure AD Connect, password synchronization is available on hello user sign-in page.</span></span> <span data-ttu-id="163bc-215">Дополнительные сведения см. в статье [Выборочная установка Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="163bc-215">For more details, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span></span>

![Включение синхронизации паролей](./media/active-directory-aadconnectsync-implement-password-synchronization/usersignin.png)

### <a name="password-synchronization-and-fips"></a><span data-ttu-id="163bc-217">Синхронизация паролей и FIPS</span><span class="sxs-lookup"><span data-stu-id="163bc-217">Password synchronization and FIPS</span></span>
<span data-ttu-id="163bc-218">Если сервер заблокирован в соответствии с tooFederal обработки информации Standard (FIPS), MD5 отключена.</span><span class="sxs-lookup"><span data-stu-id="163bc-218">If your server has been locked down according tooFederal Information Processing Standard (FIPS), then MD5 is disabled.</span></span>

<span data-ttu-id="163bc-219">**tooenable MD5 для синхронизации паролей, выполните следующие шаги hello.**</span><span class="sxs-lookup"><span data-stu-id="163bc-219">**tooenable MD5 for password synchronization, perform hello following steps:**</span></span>

1. <span data-ttu-id="163bc-220">Go too%programfiles%\Azure AD sync\bin..</span><span class="sxs-lookup"><span data-stu-id="163bc-220">Go too%programfiles%\Azure AD Sync\Bin.</span></span>
2. <span data-ttu-id="163bc-221">Откройте файл miiserver.exe.config.</span><span class="sxs-lookup"><span data-stu-id="163bc-221">Open miiserver.exe.config.</span></span>
3. <span data-ttu-id="163bc-222">Перейдите узел конфигурации или выполнения toohello конце hello hello файла.</span><span class="sxs-lookup"><span data-stu-id="163bc-222">Go toohello configuration/runtime node at hello end of hello file.</span></span>
4. <span data-ttu-id="163bc-223">Добавьте следующий узлом hello:`<enforceFIPSPolicy enabled="false"/>`</span><span class="sxs-lookup"><span data-stu-id="163bc-223">Add hello following node: `<enforceFIPSPolicy enabled="false"/>`</span></span>
5. <span data-ttu-id="163bc-224">Сохраните изменения.</span><span class="sxs-lookup"><span data-stu-id="163bc-224">Save your changes.</span></span>

<span data-ttu-id="163bc-225">Этот фрагмент должен выглядеть примерно так:</span><span class="sxs-lookup"><span data-stu-id="163bc-225">For reference, this snippet is what it should look like:</span></span>

```
    <configuration>
        <runtime>
            <enforceFIPSPolicy enabled="false"/>
        </runtime>
    </configuration>
```

<span data-ttu-id="163bc-226">Дополнительные сведения о безопасности и FIPS см. в записи блога [AAD Password Sync, Encryption and FIPS compliance](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/) (Синхронизация паролей, шифрование и соответствие FIPS в AAD).</span><span class="sxs-lookup"><span data-stu-id="163bc-226">For information about security and FIPS, see [AAD Password Sync, encryption and FIPS compliance](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span></span>

## <a name="troubleshoot-password-synchronization"></a><span data-ttu-id="163bc-227">Устранение неполадок с синхронизацией паролей</span><span class="sxs-lookup"><span data-stu-id="163bc-227">Troubleshoot password synchronization</span></span>
<span data-ttu-id="163bc-228">При возникновении проблем с синхронизацией паролей см. рекомендации в статье [Устранение неполадок синхронизации паролей с помощью службы синхронизации Azure AD Connect](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="163bc-228">If you have problems with password synchronization, see [Troubleshoot password synchronization](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="163bc-229">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="163bc-229">Next steps</span></span>
* [<span data-ttu-id="163bc-230">Службы синхронизации Azure AD Connect: общие сведений о синхронизации и ее настройка</span><span class="sxs-lookup"><span data-stu-id="163bc-230">Azure AD Connect sync: Customizing synchronization options</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="163bc-231">Интеграция локальных удостоверений с Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="163bc-231">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
