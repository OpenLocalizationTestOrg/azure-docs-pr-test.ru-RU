---
title: "Синхронизация Azure AD Connect: общие сведения о пользователях и контактах | Документация Майкрософт"
description: "Описание пользователей и контактов в службе синхронизации Azure AD Connect."
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
ms.assetid: 8d204647-213a-4519-bd62-49563c421602
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: markvi;andkjell
ms.openlocfilehash: 495e926a1975128707212ba571d47cfc7c9507b3
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-sync-understanding-users-and-contacts"></a>Синхронизация Azure AD Connect: общее представление о пользователях и контактах
Существует несколько разных причин, по которым нужно иметь несколько лесов Active Directory. Кроме того, существует несколько разных топологий развертывания. Распространенные модели включают развертывание ресурсов учетной записи и лесов с синхронизированным глобальным списком адресов после слияния и поглощения. Но даже при наличии чистых моделей гибридные модели не менее часто используются. Конфигурация по умолчанию в службе синхронизации Azure AD Connect не предполагает какой-то конкретной модели. Тем не менее, в зависимости от выбора сопоставления пользователей в руководстве по установке, можно наблюдать разное поведение.

В этом разделе будет рассмотрено поведение конфигурации по умолчанию в определенных топологиях. Мы изучим конфигурацию с помощью редактора правил синхронизации.

Конфигурация предполагает наличие нескольких общих правил.

* Конечный результат всегда должен быть одинаковым, независимо от используемого порядка импорта исходных каталогов Active Directory.
* Активная учетная запись всегда будет передавать данные для входа, включая атрибуты **userPrincipalName** и **sourceAnchor**.
* Если активная учетная запись не найдена, будут использованы атрибуты userPrincipalName и sourceAnchor из отключенной учетной записи, если только это не связанный почтовый ящик.
* Учетная запись со связанным почтовым ящиком никогда не будет использоваться для передачи атрибутов userPrincipalName и sourceAnchor. Предполагается, что активная учетная запись будет найдена позже.
* Контактный объект может быть подготовлен в Azure AD как контакт или пользователь. Фактически, это остается неизвестным до тех пор, пока не будут обработаны все исходные леса Active Directory.

## <a name="contacts"></a>Контакты
Наличие контактов, представляющих пользователя в разных лесах, — распространенное явление. Это происходит после слияния и поглощения, когда решение GALSync связывает два и более леса Exchange. Контактный объект всегда присоединяется из пространства соединителя к метавселенной с помощью атрибута mail. Если контактный объект или объект-пользователь с тем же адресом электронной почты уже существует, такие объекты объединяются. Это настраивается в правиле **In from AD — Contact Join**. Также существует правило с именем **In from AD — Contact Common** с потоком атрибутов в атрибут метавселенной **sourceObjectType** с константой **Contact**. Это правило имеет очень низкий приоритет. Поэтому, если любой объект пользователя присоединен к тому же объекту метавселенной, то правило **In from AD — User Common** передаст значение User этому атрибуту. Благодаря этому правилу атрибут получит значение Contact, если пользователь не был присоединен, а также значение User, если был найден хотя бы один пользователь.

Для подготовки объекта в Azure AD исходящее правило **Out to AAD — Contact Join** создаст объект-контакт, если атрибут метавселенной **sourceObjectType** имеет значение **Contact**. Если этот атрибут имеет значение **User**, тогда правило **Out to AAD — User Join** создаст объект-пользователя.
Повышение значения Contact до User возможно, если большее количество дополнительных исходных каталогов Active Directory будет импортировано и синхронизировано.

Например, в топологии GALSync мы найдем контактные объекты для всех во втором лесу при импорте первого леса. Это позволит разместить новые контактные объекты в соединителе AAD. При последующем импорте и синхронизации второго леса мы найдем реальных пользователей, которые будут присоединены к существующим объектам метавселенной. Затем мы удалим контактный объект в AAD и создадим вместо него новый объект-пользователь.

Если у вас есть топология, в которой пользователи представлены как контакты, убедитесь, что вы выбрали в руководстве по установке сопоставление пользователей по атрибуту почты (mail). Если выбран другой вариант, вы получите конфигурацию, зависящую от порядка. Контактные объекты всегда присоединяются по атрибуту mail. При этом объекты-пользователи будут присоединяться по атрибуту mail только в том случае, если этот вариант выбран в руководстве по установке. Если контактный объект импортирован до объекта-пользователя, вы можете получить два разных объекта в метавселенной с одинаковым атрибутом mail. Во время экспорта в Azure AD возникнет ошибка. Такое поведение является запланированным. Оно указывает на наличие неправильных данных или на неправильное определение топологии во время установки.

## <a name="disabled-accounts"></a>Отключенные учетные записи
Отключенные учетные записи также синхронизируются в Azure AD. Обычно отключенные учетные записи представляют ресурсы в Exchange, включая переговорные. Исключением являются пользователи со связанным почтовым ящиком. Как упоминалось выше, для них никогда не выполняется подготовка учетной записи в Azure AD.

Предполагается, что при обнаружении отключенной учетной записи пользователя другая активная учетная запись впоследствии найдена не будет. Поэтому объект будет подготовлен в Azure AD с найденными атрибутами userPrincipalName и sourceAnchor. Если присоединить другую активную учетную запись к этому же объекту метавселенной, будут использоваться его атрибуты userPrincipalName и sourceAnchor.

## <a name="changing-sourceanchor"></a>Изменение атрибута sourceAnchor
После экспорта объекта в Azure AD изменить атрибут sourceAnchor невозможно. При экспорте объекта атрибуту метавселенной **cloudSourceAnchor** присваивается значение **sourceAnchor**, принятое Azure AD. Если атрибут **sourceAnchor** изменен и не соответствует **cloudSourceAnchor**, то правило **Out to AAD — User Join** породит ошибку **sourceAnchor attribute has changed** (атрибут sourceAnchor изменен). В таком случае необходимо исправить конфигурацию или данные, чтобы в метавселенной снова был представлен прежний атрибут sourceAnchor, прежде чем объект снова можно будет синхронизировать.

## <a name="additional-resources"></a>Дополнительные ресурсы
* [Azure AD Connect Sync: настройка параметров синхронизации](active-directory-aadconnectsync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md)

