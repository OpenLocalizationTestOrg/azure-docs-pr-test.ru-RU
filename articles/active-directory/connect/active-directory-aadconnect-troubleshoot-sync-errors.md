---
title: "Azure AD Connect: устранение ошибок синхронизации | Документация Майкрософт"
description: "В этой статье объясняется, как устранить ошибки, возникшие во время синхронизации с Azure AD Connect."
services: active-directory
documentationcenter: 
author: karavar
manager: samueld
editor: curtand
ms.assetid: 2209d5ce-0a64-447b-be3a-6f06d47995f8
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: 5a319de69c4e142414ab8f2be980a6576acbf8bb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="troubleshooting-errors-during-synchronization"></a><span data-ttu-id="2a7e5-103">Устранение ошибок синхронизации</span><span class="sxs-lookup"><span data-stu-id="2a7e5-103">Troubleshooting Errors during synchronization</span></span>
<span data-ttu-id="2a7e5-104">При синхронизации данных удостоверений Windows Server Active Directory (AD DS) с Azure Active Directory (Azure AD) могут возникать ошибки.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-104">Errors could occur when identity data is synchronized from Windows Server Active Directory (AD DS) to Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="2a7e5-105">В этой статье предоставляются общие сведения о различных типах ошибок синхронизации, некоторые возможные сценарии возникновения этих ошибок, а также возможные способы их устранения.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-105">This article provides an overview of different types of sync errors, some of the possible scenarios that cause those errors and potential ways to fix the errors.</span></span> <span data-ttu-id="2a7e5-106">Здесь содержатся сведения о распространенных типах ошибок, возможно, рассматриваются не все возможные ошибки.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-106">This article includes the common error types and may not cover all the possible errors.</span></span>

 <span data-ttu-id="2a7e5-107">В этой статье предполагается, что читатель знаком с базовыми [принципами архитектуры Azure AD и Azure AD Connect](active-directory-aadconnect-design-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2a7e5-107">This article assumes the reader is familiar with the underlying [design concepts of Azure AD and Azure AD Connect](active-directory-aadconnect-design-concepts.md).</span></span>

<span data-ttu-id="2a7e5-108">В последней версии Azure AD Connect \(от августа 2016 г. и более новых версиях\) добавлена возможность просмотра отчета об ошибках синхронизации на [портале Azure](https://aka.ms/aadconnecthealth) в качестве части отчета Azure AD Connect Health для синхронизации.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-108">With the latest version of Azure AD Connect \(August 2016 or higher\), a report of Synchronization Errors is available in the [Azure Portal](https://aka.ms/aadconnecthealth) as part of Azure AD Connect Health for sync.</span></span>

<span data-ttu-id="2a7e5-109">С 1 сентября 2016 года функция [устойчивости повторяющихся атрибутов Azure AD](active-directory-aadconnectsyncservice-duplicate-attribute-resiliency.md) будет включена по умолчанию для всех *новых* клиентов Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-109">Starting September 1, 2016 [Azure Active Directory Duplicate Attribute Resiliency](active-directory-aadconnectsyncservice-duplicate-attribute-resiliency.md) feature will be enabled by default for all the *new* Azure Active Directory Tenants.</span></span> <span data-ttu-id="2a7e5-110">В ближайшие месяцы эта функция будет автоматически включена для имеющихся клиентов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-110">This feature will be automatically enabled for existing tenants in the upcoming months.</span></span>

<span data-ttu-id="2a7e5-111">Во время синхронизации Azure AD Connect выполняет в каталогах 3 типа операций: импорт, синхронизацию и экспорт.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-111">Azure AD Connect performs 3 types of operations from the directories it keeps in sync: Import, Synchronization and Export.</span></span> <span data-ttu-id="2a7e5-112">В ходе всех операций могут возникать ошибки.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-112">Errors can take place in all the operations.</span></span> <span data-ttu-id="2a7e5-113">Эта статья главным образом посвящена ошибкам во время экспорта данных в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-113">This article mainly focuses on errors during Export to Azure AD.</span></span>

## <a name="errors-during-export-to-azure-ad"></a><span data-ttu-id="2a7e5-114">Ошибки во время экспорта данных в Azure AD</span><span class="sxs-lookup"><span data-stu-id="2a7e5-114">Errors during Export to Azure AD</span></span>
<span data-ttu-id="2a7e5-115">В следующем разделе описываются разные типы ошибок синхронизации, которые могут возникнуть при экспорте данных в Azure AD с помощью соединителя Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-115">Following section describes different types of synchronization errors that can occur during the export operation to Azure AD using the Azure AD connector.</span></span> <span data-ttu-id="2a7e5-116">Этот соединитель можно определить по формату имени, например contoso.*onmicrosoft.com*.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-116">This connector can be identified by the name format being "contoso.*onmicrosoft.com*".</span></span>
<span data-ttu-id="2a7e5-117">Ошибки во время экспорта данных в Azure AD указывают, что при попытке \(модуля синхронизации\) Azure AD Connect выполнить \(добавление, удаление, обновление и т. п.\) в Azure Active Directory произошел сбой.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-117">Errors during Export to Azure AD indicate that the operation \(add, update, delete etc.\) attempted by Azure AD Connect \(Sync Engine\) on Azure Active Directory failed.</span></span>

![Обзор ошибок экспорта](./media/active-directory-aadconnect-troubleshoot-sync-errors/Export_Errors_Overview_01.png)

## <a name="data-mismatch-errors"></a><span data-ttu-id="2a7e5-119">Ошибки несовпадения данных</span><span class="sxs-lookup"><span data-stu-id="2a7e5-119">Data Mismatch Errors</span></span>
### <a name="invalidsoftmatch"></a><span data-ttu-id="2a7e5-120">InvalidSoftMatch</span><span class="sxs-lookup"><span data-stu-id="2a7e5-120">InvalidSoftMatch</span></span>
#### <a name="description"></a><span data-ttu-id="2a7e5-121">Description (Описание)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-121">Description</span></span>
* <span data-ttu-id="2a7e5-122">Когда \(модуль синхронизации\) Azure AD Connect указывает Azure AD добавить или обновить объекты, Azure AD сопоставляет входящий объект, используя атрибут **sourceAnchor**, с атрибутом **immutableId** объектов в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-122">When Azure AD Connect \(sync engine\) instructs Azure Active Directory to add or update objects, Azure AD matches the incoming object using the **sourceAnchor** attribute to the **immutableId** attribute of objects in Azure AD.</span></span> <span data-ttu-id="2a7e5-123">Это сопоставление называется **жестким**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-123">This match is called a **Hard Match**.</span></span>
* <span data-ttu-id="2a7e5-124">Если перед подготовкой нового объекта **не удалось найти** объект, соответствующий атрибуту **immutableId** и атрибуту **sourceAnchor** входящего объекта, для поиска соответствия Azure AD использует атрибуты proxyAddresses и userPrincipalName.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-124">When Azure AD **does not find** any object that matches the **immutableId** attribute with the **sourceAnchor** attribute of the incoming object, before provisioning a new object, it falls back to use the ProxyAddresses and UserPrincipalName attributes to find a match.</span></span> <span data-ttu-id="2a7e5-125">Такое сопоставление называется **мягким**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-125">This match is called a **Soft Match**.</span></span> <span data-ttu-id="2a7e5-126">Мягкое сопоставление предназначено для имеющихся в Azure AD объектов (происходящих их Azure AD) с новыми объектами, добавленными или обновленными при синхронизации, которые представляют ту же сущность (пользователей, группы) в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-126">The Soft Match is designed to match objects already present in Azure AD (that are sourced in Azure AD) with the new objects being added/updated during synchronization that represent the same entity (users, groups) on premises.</span></span>
* <span data-ttu-id="2a7e5-127">Ошибка **InvalidSoftMatch** возникает, если при жестком сопоставлении не удалось найти соответствующий объект, **А** при мягком сопоставлении он найден, но при этом значение *immutableId* этого объекта и *sourceAnchor* входящего объекта отличаются, предполагая что совпадающий объект синхронизирован с другим объектом из локального каталога AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-127">**InvalidSoftMatch** error occurs when the hard match does not find any matching object **AND** soft match finds a matching object but that object has a different value of *immutableId* than the incoming object's *SourceAnchor*, suggesting that the matching object was synchronized with another object from on premises Active Directory.</span></span>

<span data-ttu-id="2a7e5-128">Другими словами, чтобы выполнить мягкое сопоставление, для атрибута *immutableId* объекта, с которым выполняется сопоставление, не должно быть указано значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-128">In other words, in order for the soft match to work, the object to be soft-matched with should not have any value for the *immutableId*.</span></span> <span data-ttu-id="2a7e5-129">Если для объекта с атрибутом *immutableId* задать значение, которое не соответствует условиям жесткого сопоставления, но соответствует условиям мягкого, при синхронизации возникнет ошибка InvalidSoftMatch.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-129">If any object with *immutableId* set with a value is failing the hard-match but satisfying the soft-match criteria, the operation would result in an InvalidSoftMatch synchronization error.</span></span>

<span data-ttu-id="2a7e5-130">В схеме Azure Active Directory запрещено использовать для нескольких объектов одинаковые значения следующих атрибутов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-130">Azure Active Directory schema does not allow two or more objects to have the same value of the following attributes.</span></span> <span data-ttu-id="2a7e5-131">\(Это неполный список.\)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-131">\(This is not an exhaustive list.\)</span></span>

* <span data-ttu-id="2a7e5-132">ProxyAddresses</span><span class="sxs-lookup"><span data-stu-id="2a7e5-132">ProxyAddresses</span></span>
* <span data-ttu-id="2a7e5-133">UserPrincipalName</span><span class="sxs-lookup"><span data-stu-id="2a7e5-133">UserPrincipalName</span></span>
* <span data-ttu-id="2a7e5-134">onPremisesSecurityIdentifier;</span><span class="sxs-lookup"><span data-stu-id="2a7e5-134">onPremisesSecurityIdentifier</span></span>
* <span data-ttu-id="2a7e5-135">ObjectId</span><span class="sxs-lookup"><span data-stu-id="2a7e5-135">ObjectId</span></span>

> [!NOTE]
> <span data-ttu-id="2a7e5-136">Функция [устойчивости повторяющихся атрибутов](active-directory-aadconnectsyncservice-duplicate-attribute-resiliency.md) также внедряется в Azure Active Directory в рамках поведения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-136">[Azure AD Attribute Duplicate Attribute Resiliency](active-directory-aadconnectsyncservice-duplicate-attribute-resiliency.md) feature is also being rolled out as the default behavior of Azure Active Directory.</span></span>  <span data-ttu-id="2a7e5-137">Это позволит снизить количество ошибок синхронизации Azure AD Connect (и других клиентов синхронизации), за счет чего обработка повторяющихся в локальных средах Azure AD атрибутов proxyAddresses и userPrincipalName станет более устойчивой.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-137">This will reduce the number of synchronization errors seen by Azure AD Connect (as well as other sync clients) by making Azure AD more resilient in the way it handles duplicated ProxyAddresses and UserPrincipalName attributes present in on premises AD environments.</span></span> <span data-ttu-id="2a7e5-138">Эта функция не исправляет ошибки дублирования,</span><span class="sxs-lookup"><span data-stu-id="2a7e5-138">This feature does not fix the duplication errors.</span></span> <span data-ttu-id="2a7e5-139">поэтому данные все равно необходимо исправлять.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-139">So the data still needs to be fixed.</span></span> <span data-ttu-id="2a7e5-140">Но используя эту функцию, можно подготавливать новые объекты, подготовка которых запрещена из-за повторяющихся значений в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-140">But it allows provisioning of new objects which are otherwise blocked from being provisioned due to duplicated values in Azure AD.</span></span> <span data-ttu-id="2a7e5-141">Это также позволит снизить количество ошибок синхронизации, возвращаемых клиенту синхронизации.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-141">This will also reduce the number of synchronization errors returned to the synchronization client.</span></span>
> <span data-ttu-id="2a7e5-142">После включения в клиенте функции устойчивости повторяющихся атрибутов при подготовке новых объектов не будет отображаться ошибка синхронизации InvalidSoftMatch.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-142">If this feature is enabled for your Tenant, you will not see the InvalidSoftMatch synchronization errors seen during provisioning of new objects.</span></span>
>
>

#### <a name="example-scenarios-for-invalidsoftmatch"></a><span data-ttu-id="2a7e5-143">Примеры сценариев для InvalidSoftMatch</span><span class="sxs-lookup"><span data-stu-id="2a7e5-143">Example Scenarios for InvalidSoftMatch</span></span>
1. <span data-ttu-id="2a7e5-144">В локальном каталоге AD есть несколько объектов с одинаковым значением атрибута proxyAddresses.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-144">Two or more objects with the same value of ProxyAddresses attribute exists in on premises Active Directory.</span></span> <span data-ttu-id="2a7e5-145">Azure AD подготовит только один объект.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-145">Only one is getting provisioned in Azure AD.</span></span>
2. <span data-ttu-id="2a7e5-146">В локальном каталоге AD есть несколько объектов с одинаковым значением атрибута userPrincipalName.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-146">Two or more objects with the same value of userPrincipalName exists in on premises Active Directory.</span></span> <span data-ttu-id="2a7e5-147">Azure AD подготовит только один объект.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-147">Only one is getting provisioned in Azure AD.</span></span>
3. <span data-ttu-id="2a7e5-148">В локальный каталог AD добавлен объект с таким же значением атрибута proxyAddresses, что и у имеющегося объекта в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-148">An object was added in the on premises Active Directory with the same value of ProxyAddresses attribute as that of an existing object in Azure Active Directory.</span></span> <span data-ttu-id="2a7e5-149">Объект, добавленный в локальный каталог, не будет подготовлен в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-149">The object added on premises is not getting provisioned in Azure Active Directory.</span></span>
4. <span data-ttu-id="2a7e5-150">В локальный каталог AD добавлен объект с таким же значением атрибута userPrincipalName, что и у учетной записи в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-150">An object was added in on premises Active Directory with the same value of userPrincipalName attribute as that of an account in Azure Active Directory.</span></span> <span data-ttu-id="2a7e5-151">Объект не будет подготовлен в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-151">The object is not getting provisioned in Azure Active Directory.</span></span>
5. <span data-ttu-id="2a7e5-152">Синхронизированная учетная запись перемещена из леса А в лес Б. Azure AD Connect (модуль синхронизации) использовал атрибут ObjectGUID для вычисления sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-152">A synced account was moved from Forest A to Forest B. Azure AD Connect (sync engine) was using ObjectGUID attribute to compute the SourceAnchor.</span></span> <span data-ttu-id="2a7e5-153">После перемещения леса значение sourceAnchor изменилось.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-153">After the forest move, the value of the SourceAnchor is different.</span></span> <span data-ttu-id="2a7e5-154">Новый объект (из леса Б) не удалось синхронизировать с имеющимся объектом в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-154">The new object (from Forest B) is failing to sync with the existing object in Azure AD.</span></span>
6. <span data-ttu-id="2a7e5-155">Синхронизированный объект случайно удален из локального каталога AD. В AD для той же сущности (такой как пользователь) создан новый объект. При этом учетная запись в Azure AD не удалена.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-155">A synced object got accidentally deleted from on premises Active Directory and a new object was created in Active Directory for the same entity (such as user) without deleting the account in Azure Active Directory.</span></span> <span data-ttu-id="2a7e5-156">При синхронизации новой учетной записи с имеющимся объектом Azure AD произойдет сбой.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-156">The new account fails to sync with the existing Azure AD object.</span></span>
7. <span data-ttu-id="2a7e5-157">Azure AD Connect удалили и переустановили.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-157">Azure AD Connect was uninstalled and re-installed.</span></span> <span data-ttu-id="2a7e5-158">При повторной установке вместо атрибута sourceAnchor выбран другой атрибут.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-158">During the re-installation, a different attribute was chosen as the SourceAnchor.</span></span> <span data-ttu-id="2a7e5-159">Синхронизация всех синхронизированных ранее объектов будет остановлена. Отобразится ошибка InvalidSoftMatch.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-159">All the objects that had previously synced stopped syncing with InvalidSoftMatch error.</span></span>

#### <a name="example-case"></a><span data-ttu-id="2a7e5-160">Пример:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-160">Example case:</span></span>
1. <span data-ttu-id="2a7e5-161">Пользователь **Григорий Авдеев** синхронизирован в Azure AD из локального каталога AD в домене *contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-161">**Bob Smith** is a synced user in Azure Active Directory from on premises Active Directory of *contoso.com*</span></span>
2. <span data-ttu-id="2a7e5-162">Для атрибута **userPrincipalName** Григория задано значение **bobs@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-162">Bob Smith's **UserPrincipalName** is set as **bobs@contoso.com**.</span></span>
3. <span data-ttu-id="2a7e5-163">**abcdefghijklmnopqrstuv==** — это атрибут **sourceAnchor**, вычисленный Azure AD Connect на основе атрибута **objectGUID** из локального каталога Active Directory, который является атрибутом **immutableId** Григория в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-163">**"abcdefghijklmnopqrstuv=="** is the **SourceAnchor** calculated by Azure AD Connect using Bob Smith's **objectGUID** from on premises Active Directory, which is the **immutableId** for Bob Smith in Azure Active Directory.</span></span>
4. <span data-ttu-id="2a7e5-164">Для атрибута **proxyAddresses** Григория используются следующие значения.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-164">Bob also has following values for the **proxyAddresses** attribute:</span></span>
   * smtp:bobs@contoso.com
   * smtp:bob.smith@contoso.com
   * **smtp:bob@contoso.com**
5. <span data-ttu-id="2a7e5-165">В локальный каталог AD добавлен новый пользователь **Артем Кузнецов**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-165">A new user, **Bob Taylor**, is added to the on premises Active Directory.</span></span>
6. <span data-ttu-id="2a7e5-166">Для атрибута **userPrincipalName** Артема задано значение **bobt@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-166">Bob Taylor's **UserPrincipalName** is set as **bobt@contoso.com**.</span></span>
7. <span data-ttu-id="2a7e5-167">**abcdefghijkl0123456789==** — это атрибут **sourceAnchor**, вычисленный Azure AD Connect с использованием атрибута **objectGUID** Артема из локального каталога AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-167">**"abcdefghijkl0123456789==""** is the **sourceAnchor** calculated by Azure AD Connect using Bob Taylor's **objectGUID** from on premises Active Directory.</span></span> <span data-ttu-id="2a7e5-168">Объект Артема Кузнецова пока не синхронизирован с Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-168">Bob Taylor's object has NOT synced to Azure Active Directory yet.</span></span>
8. <span data-ttu-id="2a7e5-169">Для атрибута proxyAddresses Артема используются следующие значения:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-169">Bob Taylor has the following values for the proxyAddresses attribute</span></span>
   * smtp:bobt@contoso.com
   * smtp:bob.taylor@contoso.com
   * **smtp:bob@contoso.com**
9. <span data-ttu-id="2a7e5-170">Во время синхронизации Azure AD Connect определит добавление Артема Кузнецова в локальный каталог AD и отправит запрос на изменение аналогичных настроек в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-170">During sync, Azure AD Connect will recognize the addition of Bob Taylor in on premises Active Directory and ask Azure AD to make the same change.</span></span>
10. <span data-ttu-id="2a7e5-171">Сначала Azure AD выполнит жесткое сопоставление.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-171">Azure AD will first perform hard match.</span></span> <span data-ttu-id="2a7e5-172">Другими словами, выполнит поиск объектов, у которых для атрибута immutableId задано значение abcdefghijkl0123456789==.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-172">That is, it will search if there is any object with the immutableId equal to "abcdefghijkl0123456789==".</span></span> <span data-ttu-id="2a7e5-173">Так как в Azure AD отсутствуют объекты с таким атрибутом immutableId, жесткое сопоставление завершится ошибкой.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-173">Hard Match will fail as no other object in Azure AD will have that immutableId.</span></span>
11. <span data-ttu-id="2a7e5-174">Затем Azure AD выполнит мягкое сопоставление объекта Артема Кузнецова.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-174">Azure AD will then attempt to soft-match Bob Taylor.</span></span> <span data-ttu-id="2a7e5-175">То есть Azure AD выполнит поиск объектов, у которых для атрибута proxyAddresses задано три значения, в том числе smtp:bob@contoso.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-175">That is, it will search if there is any object with proxyAddresses equal to the three values, including smtp:bob@contoso.com</span></span>
12. <span data-ttu-id="2a7e5-176">Azure AD найдет объект Григория Авдеева, который соответствует условиям поиска.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-176">Azure AD will find Bob Smith's object to match the soft-match criteria.</span></span> <span data-ttu-id="2a7e5-177">Но для атрибута immutableId этого объекта задано значение abcdefghijklmnopqrstuv==.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-177">But this object has the value of immutableId = "abcdefghijklmnopqrstuv==".</span></span> <span data-ttu-id="2a7e5-178">Это значит, что этот объект синхронизирован из другого объекта локального каталога AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-178">which indicates this object was synced from another object from on premises Active Directory.</span></span> <span data-ttu-id="2a7e5-179">Поэтому Azure AD не может выполнить нестрогое сопоставление, что приведет к ошибке синхронизации **InvalidSoftMatch**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-179">Thus, Azure AD cannot soft-match these objects and results in an **InvalidSoftMatch** sync error.</span></span>

#### <a name="how-to-fix-invalidsoftmatch-error"></a><span data-ttu-id="2a7e5-180">Как устранить ошибку InvalidSoftMatch</span><span class="sxs-lookup"><span data-stu-id="2a7e5-180">How to fix InvalidSoftMatch error</span></span>
<span data-ttu-id="2a7e5-181">Чаще всего причина ошибки InvalidSoftMatch — наличие двух объектов с разными атрибутами sourceAnchor \(immutableId\), но одинаковым значением атрибутов proxyAddresses и/или userPrincipalName, которые используются при мягком сопоставлении в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-181">The most common reason for the InvalidSoftMatch error is two objects with different SourceAnchor \(immutableId\) have the same value for the ProxyAddresses and/or UserPrincipalName attributes, which are used during the soft-match process on Azure AD.</span></span> <span data-ttu-id="2a7e5-182">Чтобы устранить ошибку InvalidSoftMatch, выполните следующее:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-182">In order to fix the Invalid Soft Match</span></span>

1. <span data-ttu-id="2a7e5-183">Определите повторяющееся значение атрибута proxyAddresses, userPrincipalName или другого атрибута, вызвавшее ошибку.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-183">Identify the duplicated proxyAddresses, userPrincipalName or other attribute value that's causing the error.</span></span> <span data-ttu-id="2a7e5-184">Кроме того, определите два \(или несколько\) объектов, участвующих в конфликте.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-184">Also identify which two \(or more\) objects are involved in the conflict.</span></span> <span data-ttu-id="2a7e5-185">Эти объекты можно определить с помощью отчета, созданного [Azure AD Connect Health для синхронизации](https://aka.ms/aadchsyncerrors).</span><span class="sxs-lookup"><span data-stu-id="2a7e5-185">The report generated by [Azure AD Connect Health for sync](https://aka.ms/aadchsyncerrors) can help you identify the two objects.</span></span>
2. <span data-ttu-id="2a7e5-186">Определите объекты, для которых требуется повторяющееся значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-186">Identify which object should continue to have the duplicated value and which object should not.</span></span>
3. <span data-ttu-id="2a7e5-187">Удалите из объекта ненужное повторяющееся значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-187">Remove the duplicated value from the object that should NOT have that value.</span></span> <span data-ttu-id="2a7e5-188">Обратите внимание, что эти изменения необходимо вносить в каталоге, из которого происходит объект.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-188">Note that you should make the change in the directory where the object is sourced from.</span></span> <span data-ttu-id="2a7e5-189">В некоторых случаях может потребоваться удалить один из объектов, участвующих в конфликте.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-189">In some cases, you may need to delete one of the objects in conflict.</span></span>
4. <span data-ttu-id="2a7e5-190">Если изменения внесены в локальном каталоге AD, выполните синхронизацию этих изменений с Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-190">If you made the change in the on premises AD, let Azure AD Connect sync the change.</span></span>

<span data-ttu-id="2a7e5-191">Обратите внимание, что отчет об ошибках Azure AD Connect Health для синхронизации обновляется каждые 30 минут. В нем отображаются ошибки, возникшие при последних попытках синхронизации.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-191">Note that Sync error report within Azure AD Connect Health for sync is updated every 30 minutes and includes the errors from the latest synchronization attempt.</span></span>

> [!NOTE]
> <span data-ttu-id="2a7e5-192">По сути атрибут immutableId не должен изменяться в течение времени существования объекта.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-192">ImmutableId, by definition, should not change in the lifetime of the object.</span></span> <span data-ttu-id="2a7e5-193">Если при настройке Azure AD Connect не учтены некоторые из сценариев выше, может возникнуть ситуация, когда Azure AD Connect вычисляет разное значение атрибута sourceAnchor, представляющего ту же сущность (пользователя, группу, контакт и т. п.), что и в имеющемся объекте Azure AD, который необходимо продолжать использовать.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-193">If Azure AD Connect was not configured with some of the scenarios in mind from the above list, you could end up in a situation where Azure AD Connect calculates a different value of the SourceAnchor for the AD object that represents the same entity (same user/group/contact etc) that has an existing Azure AD Object that you wish to continue using.</span></span>
>
>

#### <a name="related-articles"></a><span data-ttu-id="2a7e5-194">Связанные статьи</span><span class="sxs-lookup"><span data-stu-id="2a7e5-194">Related Articles</span></span>
* <span data-ttu-id="2a7e5-195">[Duplicate or invalid attributes prevent directory synchronization in Office 365](https://support.microsoft.com/en-us/kb/2647098) (Запрет синхронизации службы каталогов в Office 365 из-за повторяющихся или недопустимых атрибутов)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-195">[Duplicate or invalid attributes prevent directory synchronization in Office 365](https://support.microsoft.com/en-us/kb/2647098)</span></span>

### <a name="objecttypemismatch"></a><span data-ttu-id="2a7e5-196">ObjectTypeMismatch</span><span class="sxs-lookup"><span data-stu-id="2a7e5-196">ObjectTypeMismatch</span></span>
#### <a name="description"></a><span data-ttu-id="2a7e5-197">Description (Описание)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-197">Description</span></span>
<span data-ttu-id="2a7e5-198">При попытке Azure AD мягко сопоставить два объекта может возникнуть ситуация, когда у двух объектов разных типов (пользователя, группы, контакта и т. п.) одинаковые значения атрибутов, используемых в этом процессе.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-198">When Azure AD attempts to soft match two objects, it is possible that two objects of different "object type" (such as User, Group, Contact etc.) have the same values for the attributes used to perform the soft match.</span></span> <span data-ttu-id="2a7e5-199">Так как повторение этих атрибутов не допускается в Azure AD, операция может завершиться ошибкой синхронизации ObjectTypeMismatch.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-199">As duplication of these attributes is not permitted in Azure AD, the operation can result in "ObjectTypeMismatch" synchronization error.</span></span>

#### <a name="example-scenarios-for-objecttypemismatch-error"></a><span data-ttu-id="2a7e5-200">Примеры сценариев ошибки ObjectTypeMismatch</span><span class="sxs-lookup"><span data-stu-id="2a7e5-200">Example Scenarios for ObjectTypeMismatch error</span></span>
* <span data-ttu-id="2a7e5-201">Администратор создал в Office 365 группу безопасности, поддерживающую почту.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-201">A mail enabled security group is created in Office 365.</span></span> <span data-ttu-id="2a7e5-202">Он добавил в локальный каталог AD (пока не синхронизированный с Azure AD) нового пользователя или контакт с тем же значением атрибута proxyAddresses, что и у группы Office 365.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-202">Admin adds a new user or contact in on premises AD (that's not synchronized to Azure AD yet) with the same value for the ProxyAddresses attribute as that of the Office 365 group.</span></span>

#### <a name="example-case"></a><span data-ttu-id="2a7e5-203">Примеры</span><span class="sxs-lookup"><span data-stu-id="2a7e5-203">Example case</span></span>
1. <span data-ttu-id="2a7e5-204">Администратор создал для налогового департамента в Office 365 группу безопасности, поддерживающую почту, а в качестве адреса электронной почты указал tax@contoso.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-204">Admin creates a new mail enabled security group in Office 365 for the Tax department and provides an email address as tax@contoso.com.</span></span> <span data-ttu-id="2a7e5-205">Таким образом он назначил этой группе атрибут ProxyAddresses со значением **smtp:tax@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-205">This assigns the ProxyAddresses attribute for this group with the value of **smtp:tax@contoso.com**</span></span>
2. <span data-ttu-id="2a7e5-206">К домену contoso.com присоединился новый пользователь, для которого в локальном каталоге создана учетная запись с атрибутом proxyAddress. Значение этого атрибута — **smtp:tax@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-206">A new user joins Contoso.com and an account is created for the user on premises with the proxyAddress as **smtp:tax@contoso.com**</span></span>
3. <span data-ttu-id="2a7e5-207">Когда Azure AD Connect синхронизирует новую учетную запись пользователя, произойдет ошибка ObjectTypeMismatch.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-207">When Azure AD Connect will sync the new user account, it will get the "ObjectTypeMismatch" error.</span></span>

#### <a name="how-to-fix-objecttypemismatch-error"></a><span data-ttu-id="2a7e5-208">Как устранить ошибку ObjectTypeMismatch</span><span class="sxs-lookup"><span data-stu-id="2a7e5-208">How to fix ObjectTypeMismatch error</span></span>
<span data-ttu-id="2a7e5-209">Чаще всего причина ошибки ObjectTypeMismatch заключается в наличии двух объектов разных типов (пользователь, группа, контакт и т. д.), у которых одинаковое значение атрибута proxyAddresses.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-209">The most common reason for the ObjectTypeMismatch error is two objects of different type (User, Group, Contact etc.) have the same value for the ProxyAddresses attribute.</span></span> <span data-ttu-id="2a7e5-210">Чтобы устранить ошибку ObjectTypeMismatch, выполните следующее:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-210">In order to fix the ObjectTypeMismatch:</span></span>

1. <span data-ttu-id="2a7e5-211">Определите повторяющееся значение атрибута proxyAddresses (или другого атрибута), вызвавшее ошибку.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-211">Identify the duplicated proxyAddresses (or other attribute) value that's causing the error.</span></span> <span data-ttu-id="2a7e5-212">Кроме того, определите два \(или несколько\) объектов, участвующих в конфликте.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-212">Also identify which two \(or more\) objects are involved in the conflict.</span></span> <span data-ttu-id="2a7e5-213">Эти объекты можно определить с помощью отчета, созданного [Azure AD Connect Health для синхронизации](https://aka.ms/aadchsyncerrors).</span><span class="sxs-lookup"><span data-stu-id="2a7e5-213">The report generated by [Azure AD Connect Health for sync](https://aka.ms/aadchsyncerrors) can help you identify the two objects.</span></span>
2. <span data-ttu-id="2a7e5-214">Определите объекты, для которых требуется повторяющееся значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-214">Identify which object should continue to have the duplicated value and which object should not.</span></span>
3. <span data-ttu-id="2a7e5-215">Удалите из объекта ненужное повторяющееся значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-215">Remove the duplicated value from the object that should NOT have that value.</span></span> <span data-ttu-id="2a7e5-216">Обратите внимание, что эти изменения необходимо вносить в каталоге, из которого происходит объект.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-216">Note that you should make the change in the directory where the object is sourced from.</span></span> <span data-ttu-id="2a7e5-217">В некоторых случаях может потребоваться удалить один из объектов, участвующих в конфликте.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-217">In some cases, you may need to delete one of the objects in conflict.</span></span>
4. <span data-ttu-id="2a7e5-218">Если изменения внесены в локальном каталоге AD, выполните синхронизацию этих изменений с Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-218">If you made the change in the on premises AD, let Azure AD Connect sync the change.</span></span> <span data-ttu-id="2a7e5-219">Отчет об ошибках Azure AD Connect Health для синхронизации обновляется каждые 30 минут. В нем отображаются ошибки, возникшие при последних попытках синхронизации.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-219">Sync error report within Azure AD Connect Health for sync gets updated every 30 minutes and includes the errors from the latest synchronization attempt.</span></span>

## <a name="duplicate-attributes"></a><span data-ttu-id="2a7e5-220">Повторяющиеся атрибуты</span><span class="sxs-lookup"><span data-stu-id="2a7e5-220">Duplicate Attributes</span></span>
### <a name="attributevaluemustbeunique"></a><span data-ttu-id="2a7e5-221">AttributeValueMustBeUnique</span><span class="sxs-lookup"><span data-stu-id="2a7e5-221">AttributeValueMustBeUnique</span></span>
#### <a name="description"></a><span data-ttu-id="2a7e5-222">Description (Описание)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-222">Description</span></span>
<span data-ttu-id="2a7e5-223">В схеме Azure Active Directory запрещено использовать для нескольких объектов одинаковые значения следующих атрибутов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-223">Azure Active Directory schema does not allow two or more objects to have the same value of the following attributes.</span></span> <span data-ttu-id="2a7e5-224">Это значит, что у каждого объекта в Azure AD должно быть уникальное значение для этих атрибутов в заданном экземпляре.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-224">That is each object in Azure AD is forced to have a unique value of these attributes at a given instance.</span></span>

* <span data-ttu-id="2a7e5-225">ProxyAddresses</span><span class="sxs-lookup"><span data-stu-id="2a7e5-225">ProxyAddresses</span></span>
* <span data-ttu-id="2a7e5-226">UserPrincipalName</span><span class="sxs-lookup"><span data-stu-id="2a7e5-226">UserPrincipalName</span></span>

<span data-ttu-id="2a7e5-227">Если Azure AD Connect пытается добавить новый объект или обновить указанные выше атрибуты имеющегося объекта, добавив для них значения, назначенные другому объекту в Azure Active Directory, то операция завершится ошибкой синхронизации AttributeValueMustBeUnique.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-227">If Azure AD Connect attempts to add a new object or update an existing object with a value for the above attributes that is already assigned to another object in Azure Active Directory, the operation results in the "AttributeValueMustBeUnique" sync error.</span></span>

#### <a name="possible-scenarios"></a><span data-ttu-id="2a7e5-228">Возможные сценарии</span><span class="sxs-lookup"><span data-stu-id="2a7e5-228">Possible Scenarios:</span></span>
1. <span data-ttu-id="2a7e5-229">Повторяющееся значение назначено синхронизированному объекту, конфликтующему с другим синхронизированным объектом.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-229">Duplicate value is assigned to an already synced object, which conflicts with another synced object.</span></span>

#### <a name="example-case"></a><span data-ttu-id="2a7e5-230">Пример</span><span class="sxs-lookup"><span data-stu-id="2a7e5-230">Example case:</span></span>
1. <span data-ttu-id="2a7e5-231">Пользователь **Григорий Авдеев** синхронизирован в Azure AD из локального каталога AD в домене contoso.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-231">**Bob Smith** is a synced user in Azure Active Directory from on premises Active Directory of contoso.com</span></span>
2. <span data-ttu-id="2a7e5-232">Для атрибута **userPrincipalName** Григория в локальном каталоге задано значение **bobs@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-232">Bob Smith's **UserPrincipalName** on premises is set as **bobs@contoso.com**.</span></span>
3. <span data-ttu-id="2a7e5-233">Для атрибута **proxyAddresses** Григория используются следующие значения.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-233">Bob also has following values for the **proxyAddresses** attribute:</span></span>
   * smtp:bobs@contoso.com
   * smtp:bob.smith@contoso.com
   * **smtp:bob@contoso.com**
4. <span data-ttu-id="2a7e5-234">В локальный каталог AD добавлен новый пользователь **Артем Кузнецов**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-234">A new user, **Bob Taylor**, is added to the on premises Active Directory.</span></span>
5. <span data-ttu-id="2a7e5-235">Для атрибута **userPrincipalName** Артема задано значение **bobt@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-235">Bob Taylor's **UserPrincipalName** is set as **bobt@contoso.com**.</span></span>
6. <span data-ttu-id="2a7e5-236">Для атрибута **proxyAddresses** **Артема Кузнецова** используются следующие значения:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-236">**Bob Taylor** has the following values for the **ProxyAddresses** attribute i.</span></span> <span data-ttu-id="2a7e5-237">smtp:bobt@contoso.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-237">smtp:bobt@contoso.com ii.</span></span> <span data-ttu-id="2a7e5-238">smtp:bob.taylor@contoso.com</span><span class="sxs-lookup"><span data-stu-id="2a7e5-238">smtp:bob.taylor@contoso.com</span></span>
7. <span data-ttu-id="2a7e5-239">Синхронизация объекта Артема Кузнецова выполнена успешно.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-239">Bob Taylor's object is synchronized with Azure AD successfully.</span></span>
8. <span data-ttu-id="2a7e5-240">Администратор решил заменить значение атрибута **proxyAddresses** Артема на следующее:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-240">Admin decided to update Bob Taylor's **ProxyAddresses** attribute with the following value: i.</span></span> **smtp:bob@contoso.com**
9. <span data-ttu-id="2a7e5-241">Azure AD выполнит попытку обновить объект Артема в Azure AD, добавив в него значение выше, но эта операция завершится ошибкой, потому что такое значение уже назначено Григорию Авдееву. В результате отобразится ошибка AttributeValueMustBeUnique.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-241">Azure AD will attempt to update Bob Taylor's object in Azure AD with the above value, but that operation will fail as that ProxyAddresses value is already assigned to Bob Smith, resulting in "AttributeValueMustBeUnique" error.</span></span>

#### <a name="how-to-fix-attributevaluemustbeunique-error"></a><span data-ttu-id="2a7e5-242">Как устранить ошибку AttributeValueMustBeUnique</span><span class="sxs-lookup"><span data-stu-id="2a7e5-242">How to fix AttributeValueMustBeUnique error</span></span>
<span data-ttu-id="2a7e5-243">Чаще всего причина ошибки AttributeValueMustBeUnique заключается в наличии двух объектов с разными атрибутами sourceAnchor \(immutableId\), но одинаковым значением атрибутов proxyAddresses и/или userPrincipalName.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-243">The most common reason for the AttributeValueMustBeUnique error is two objects with different SourceAnchor \(immutableId\) have the same value for the ProxyAddresses and/or UserPrincipalName attributes.</span></span> <span data-ttu-id="2a7e5-244">Чтобы устранить ошибку AttributeValueMustBeUnique, выполните следующее:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-244">In order to fix AttributeValueMustBeUnique error</span></span>

1. <span data-ttu-id="2a7e5-245">Определите повторяющееся значение атрибута proxyAddresses, userPrincipalName или другого атрибута, вызвавшее ошибку.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-245">Identify the duplicated proxyAddresses, userPrincipalName or other attribute value that's causing the error.</span></span> <span data-ttu-id="2a7e5-246">Кроме того, определите два \(или несколько\) объектов, участвующих в конфликте.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-246">Also identify which two \(or more\) objects are involved in the conflict.</span></span> <span data-ttu-id="2a7e5-247">Эти объекты можно определить с помощью отчета, созданного [Azure AD Connect Health для синхронизации](https://aka.ms/aadchsyncerrors).</span><span class="sxs-lookup"><span data-stu-id="2a7e5-247">The report generated by [Azure AD Connect Health for sync](https://aka.ms/aadchsyncerrors) can help you identify the two objects.</span></span>
2. <span data-ttu-id="2a7e5-248">Определите объекты, для которых требуется повторяющееся значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-248">Identify which object should continue to have the duplicated value and which object should not.</span></span>
3. <span data-ttu-id="2a7e5-249">Удалите из объекта ненужное повторяющееся значение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-249">Remove the duplicated value from the object that should NOT have that value.</span></span> <span data-ttu-id="2a7e5-250">Обратите внимание, что эти изменения необходимо вносить в каталоге, из которого происходит объект.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-250">Note that you should make the change in the directory where the object is sourced from.</span></span> <span data-ttu-id="2a7e5-251">В некоторых случаях может потребоваться удалить один из объектов, участвующих в конфликте.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-251">In some cases, you may need to delete one of the objects in conflict.</span></span>
4. <span data-ttu-id="2a7e5-252">Если изменения внесены в локальном каталоге AD, выполните их синхронизацию c Azure AD Connect. Это позволит устранить ошибку.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-252">If you made the change in the on premises AD, let Azure AD Connect sync the change for the error to get fixed.</span></span>

#### <a name="related-articles"></a><span data-ttu-id="2a7e5-253">Связанные статьи</span><span class="sxs-lookup"><span data-stu-id="2a7e5-253">Related Articles</span></span>
<span data-ttu-id="2a7e5-254">-[Duplicate or invalid attributes prevent directory synchronization in Office 365](https://support.microsoft.com/en-us/kb/2647098) (Запрет синхронизации службы каталогов в Office 365 из-за повторяющихся или недопустимых атрибутов)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-254">-[Duplicate or invalid attributes prevent directory synchronization in Office 365](https://support.microsoft.com/en-us/kb/2647098)</span></span>

## <a name="data-validation-failures"></a><span data-ttu-id="2a7e5-255">Сбой проверки данных</span><span class="sxs-lookup"><span data-stu-id="2a7e5-255">Data Validation Failures</span></span>
### <a name="identitydatavalidationfailed"></a><span data-ttu-id="2a7e5-256">IdentityDataValidationFailed</span><span class="sxs-lookup"><span data-stu-id="2a7e5-256">IdentityDataValidationFailed</span></span>
#### <a name="description"></a><span data-ttu-id="2a7e5-257">Description (Описание)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-257">Description</span></span>
<span data-ttu-id="2a7e5-258">Перед записью данных в каталог Azure AD применяет к ним разные ограничения.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-258">Azure Active Directory enforces various restrictions on the data itself before allowing that data to be written into the directory.</span></span> <span data-ttu-id="2a7e5-259">Это улучшает работу пользователей с приложениями, которые зависят от этих данных.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-259">This is to ensure that end users get the best possible experiences while using the applications that depend on this data.</span></span>

#### <a name="scenarios"></a><span data-ttu-id="2a7e5-260">Сценарии</span><span class="sxs-lookup"><span data-stu-id="2a7e5-260">Scenarios</span></span>
<span data-ttu-id="2a7e5-261">а.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-261">a.</span></span> <span data-ttu-id="2a7e5-262">Значение атрибута userPrincipalName содержит недопустимые или неподдерживаемые символы.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-262">The UserPrincipalName attribute value has invalid/unsupported characters.</span></span>
<span data-ttu-id="2a7e5-263">b.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-263">b.</span></span> <span data-ttu-id="2a7e5-264">Атрибут userPrincipalName не соответствует требуемому формату.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-264">The UserPrincipalName attribute does not follow the required format.</span></span>

#### <a name="how-to-fix-identitydatavalidationfailed-error"></a><span data-ttu-id="2a7e5-265">Как устранить ошибку IdentityDataValidationFailed</span><span class="sxs-lookup"><span data-stu-id="2a7e5-265">How to fix IdentityDataValidationFailed error</span></span>
<span data-ttu-id="2a7e5-266">а.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-266">a.</span></span> <span data-ttu-id="2a7e5-267">Убедитесь, что для значения атрибута userPrincipalName указаны поддерживаемые символы и значение соответствует требуемому формату.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-267">Ensure that the userPrincipalName attribute has supported characters and required format.</span></span>

#### <a name="related-articles"></a><span data-ttu-id="2a7e5-268">Связанные статьи</span><span class="sxs-lookup"><span data-stu-id="2a7e5-268">Related Articles</span></span>
* [<span data-ttu-id="2a7e5-269">Подготовка пользователей к работе путем синхронизации каталогов с Office 365</span><span class="sxs-lookup"><span data-stu-id="2a7e5-269">Prepare to provision users through directory synchronization to Office 365</span></span>](https://support.office.com/en-us/article/Prepare-to-provision-users-through-directory-synchronization-to-Office-365-01920974-9e6f-4331-a370-13aea4e82b3e)

### <a name="federateddomainchangeerror"></a><span data-ttu-id="2a7e5-270">Ошибка FederatedDomainChangeError</span><span class="sxs-lookup"><span data-stu-id="2a7e5-270">FederatedDomainChangeError</span></span>
#### <a name="description"></a><span data-ttu-id="2a7e5-271">Описание</span><span class="sxs-lookup"><span data-stu-id="2a7e5-271">Description</span></span>
<span data-ttu-id="2a7e5-272">Ошибка синхронизации **FederatedDomainChangeError** возникает в конкретном случае, когда суффикс атрибута userPrincipalName пользователя изменяется при переходе из одного федеративного домена в другой.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-272">This is a specific case that results in a **"FederatedDomainChangeError"** sync error when the suffix of a user's UserPrincipalName is changed from one federated domain to another federated domain.</span></span>

#### <a name="scenarios"></a><span data-ttu-id="2a7e5-273">Сценарии</span><span class="sxs-lookup"><span data-stu-id="2a7e5-273">Scenarios</span></span>
<span data-ttu-id="2a7e5-274">Суффикс атрибута userPrincipalName синхронизированного пользователя изменился при переходе из одного федеративного домена в другой локальный федеративный домен.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-274">For a synchronized user, the UserPrincipalName suffix was changed from one federated domain to another federated domain on premises.</span></span> <span data-ttu-id="2a7e5-275">Например, *userPrincipalName = bob@contoso.com* изменился на *userPrincipalName = bob@fabrikam.com*.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-275">For example, *UserPrincipalName = bob@contoso.com* was changed to *UserPrincipalName = bob@fabrikam.com*.</span></span>

#### <a name="example"></a><span data-ttu-id="2a7e5-276">Пример</span><span class="sxs-lookup"><span data-stu-id="2a7e5-276">Example</span></span>
1. <span data-ttu-id="2a7e5-277">Григорий Авдеев (учетная запись для contoso.com) добавлен в AD как новый пользователь. Для атрибута userPrincipalName учетной записи задано значение bob@contoso.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-277">Bob Smith, an account for Contoso.com, gets added as a new user in Active Directory with the UserPrincipalName bob@contoso.com</span></span>
2. <span data-ttu-id="2a7e5-278">Григорий перешел в другой домен contoso.com, fabrikam.com. Значение атрибута userPrincipalName изменилось на bob@fabrikam.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-278">Bob moves to a different division of Contoso.com called Fabrikam.com and his UserPrincipalName is changed to bob@fabrikam.com</span></span>
3. <span data-ttu-id="2a7e5-279">Домены contoso.com и fabrikam.com — это федеративные домены Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-279">Both contoso.com and fabrikam.com domains are federated domains with Azure Active Directory.</span></span>
4. <span data-ttu-id="2a7e5-280">Атрибут userPrincipalName Григория не обновляется, поэтому возникла ошибка синхронизации FederatedDomainChangeError.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-280">Bob's userPrincipalName does not get updated and results in a "FederatedDomainChangeError" sync error.</span></span>

#### <a name="how-to-fix"></a><span data-ttu-id="2a7e5-281">Как устранить</span><span class="sxs-lookup"><span data-stu-id="2a7e5-281">How to fix</span></span>
<span data-ttu-id="2a7e5-282">Если при переходе из домена bob@**contoso.com** в домен bob@**fabrikam.com** (домены **contoso.com** и **fabrikam.com** **федеративные**) суффикс атрибута userPrincipalName изменился, выполните приведенные ниже шаги, чтобы устранить ошибку синхронизации.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-282">If a user's UserPrincipalName suffix was updated from bob@**contoso.com** to bob@**fabrikam.com**, where both **contoso.com** and **fabrikam.com** are **federated domains**, then follow these steps to fix the sync error</span></span>

1. <span data-ttu-id="2a7e5-283">Измените UserPrincipalName пользователя в Azure AD с bob@contoso.com на bob@contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-283">Update the user's UserPrincipalName in Azure AD from bob@contoso.com to bob@contoso.onmicrosoft.com.</span></span> <span data-ttu-id="2a7e5-284">Вы можете использовать следующую команду PowerShell в модуле Azure AD PowerShell: `Set-MsolUserPrincipalName -UserPrincipalName bob@contoso.com -NewUserPrincipalName bob@contoso.onmicrosoft.com`</span><span class="sxs-lookup"><span data-stu-id="2a7e5-284">You can use the following PowerShell command with the Azure AD PowerShell Module: `Set-MsolUserPrincipalName -UserPrincipalName bob@contoso.com -NewUserPrincipalName bob@contoso.onmicrosoft.com`</span></span>
2. <span data-ttu-id="2a7e5-285">Разрешите выполнить следующий цикл синхронизации.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-285">Allow the next sync cycle to attempt synchronization.</span></span> <span data-ttu-id="2a7e5-286">В этот раз синхронизация пройдет успешно, а для атрибута userPrincipalName Григория будет задано значение bob@fabrikam.com (как и ожидалось).</span><span class="sxs-lookup"><span data-stu-id="2a7e5-286">This time synchronization will be successful and it will update the UserPrincipalName of Bob to bob@fabrikam.com as expected.</span></span>

#### <a name="related-articles"></a><span data-ttu-id="2a7e5-287">Связанные статьи</span><span class="sxs-lookup"><span data-stu-id="2a7e5-287">Related Articles</span></span>
* [<span data-ttu-id="2a7e5-288">Изменения не синхронизируются с помощью инструмента синхронизации Azure Active Directory после изменения имени участника-пользователя или учетной записи пользователя для использования другого федеративного домена</span><span class="sxs-lookup"><span data-stu-id="2a7e5-288">Changes aren't synced by the Azure Active Directory Sync tool after you change the UPN of a user account to use a different federated domain</span></span>](https://support.microsoft.com/en-us/help/2669550/changes-aren-t-synced-by-the-azure-active-directory-sync-tool-after-you-change-the-upn-of-a-user-account-to-use-a-different-federated-domain)

## <a name="largeobject"></a><span data-ttu-id="2a7e5-289">LargeObject</span><span class="sxs-lookup"><span data-stu-id="2a7e5-289">LargeObject</span></span>
### <a name="description"></a><span data-ttu-id="2a7e5-290">Описание</span><span class="sxs-lookup"><span data-stu-id="2a7e5-290">Description</span></span>
<span data-ttu-id="2a7e5-291">Если атрибут превышает установленное в схеме Azure AD значение размера, длины и количества, то во время синхронизации возникнет ошибка **LargeObject** или **ExceededAllowedLength**.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-291">When an attribute exceeds the allowed size limit, length limit or count limit set by Azure Active Directory schema, the synchronization operation results in the **LargeObject** or **ExceededAllowedLength** sync error.</span></span> <span data-ttu-id="2a7e5-292">Как правило, эта ошибка возникает для следующих атрибутов:</span><span class="sxs-lookup"><span data-stu-id="2a7e5-292">Typically this error occurs for the following attributes</span></span>

* <span data-ttu-id="2a7e5-293">userCertificate</span><span class="sxs-lookup"><span data-stu-id="2a7e5-293">userCertificate</span></span>
* <span data-ttu-id="2a7e5-294">userSMIMECertificate</span><span class="sxs-lookup"><span data-stu-id="2a7e5-294">userSMIMECertificate</span></span>
* <span data-ttu-id="2a7e5-295">thumbnailPhoto;</span><span class="sxs-lookup"><span data-stu-id="2a7e5-295">thumbnailPhoto</span></span>
* <span data-ttu-id="2a7e5-296">proxyAddresses</span><span class="sxs-lookup"><span data-stu-id="2a7e5-296">proxyAddresses</span></span>

### <a name="possible-scenarios"></a><span data-ttu-id="2a7e5-297">Возможные сценарии</span><span class="sxs-lookup"><span data-stu-id="2a7e5-297">Possible Scenarios</span></span>
1. <span data-ttu-id="2a7e5-298">Атрибут userCertificate хранит большое количество назначенных Григорию сертификатов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-298">Bob's userCertificate attribute is storing too many certificates assigned to Bob.</span></span> <span data-ttu-id="2a7e5-299">К ним также относятся недействительные и старые сертификаты.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-299">These may include older, expired certificates.</span></span> <span data-ttu-id="2a7e5-300">Жесткий предел — 15 сертификатов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-300">The hard limit is 15 certificates.</span></span> <span data-ttu-id="2a7e5-301">Дополнительные сведения о том, как обрабатывать ошибки LargeObject с атрибутом userCertificate, см. в статье, посвященной [обработке ошибок LargeObject, вызванных атрибутом userCertificate](active-directory-aadconnectsync-largeobjecterror-usercertificate.md).</span><span class="sxs-lookup"><span data-stu-id="2a7e5-301">For more information on how to handle LargeObject errors with userCertificate attribute, please refer to article [Handling LargeObject errors caused by userCertificate attribute](active-directory-aadconnectsync-largeobjecterror-usercertificate.md).</span></span>
2. <span data-ttu-id="2a7e5-302">Атрибут userSMIMECertificat хранит большое количество назначенных Григорию сертификатов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-302">Bob's userSMIMECertificate attribute is storing too many certificates assigned to Bob.</span></span> <span data-ttu-id="2a7e5-303">К ним также относятся недействительные и старые сертификаты.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-303">These may include older, expired certificates.</span></span> <span data-ttu-id="2a7e5-304">Жесткий предел — 15 сертификатов.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-304">The hard limit is 15 certificates.</span></span>
3. <span data-ttu-id="2a7e5-305">Атрибут thmubnailPhoto, заданный в Active Directory, слишком большой для синхронизации в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-305">Bob's thumbnailPhoto set in Active Directory is too large to be synced in Azure AD.</span></span>
4. <span data-ttu-id="2a7e5-306">При автоматическом заполнении в Active Directory объекту назначено слишком много атрибутов ProxyAddresses.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-306">During automatic population of the ProxyAddresses attribute in Active Directory, an object has too many ProxyAddresses assigned.</span></span>

### <a name="how-to-fix"></a><span data-ttu-id="2a7e5-307">Как устранить</span><span class="sxs-lookup"><span data-stu-id="2a7e5-307">How to fix</span></span>
1. <span data-ttu-id="2a7e5-308">Убедитесь, что атрибут, повлекший ошибку, не превысил установленное ограничение.</span><span class="sxs-lookup"><span data-stu-id="2a7e5-308">Ensure that the attribute causing the error is within the allowed limitation.</span></span>

## <a name="related-links"></a><span data-ttu-id="2a7e5-309">Связанные ссылки</span><span class="sxs-lookup"><span data-stu-id="2a7e5-309">Related links</span></span>
* <span data-ttu-id="2a7e5-310">[Locate Active Directory Objects in Active Directory Administrative Center](https://technet.microsoft.com/library/dd560661.aspx) (Поиск объектов Active Directory в центре администрирования Active Directory)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-310">[Locate Active Directory Objects in Active Directory Administrative Center](https://technet.microsoft.com/library/dd560661.aspx)</span></span>
* <span data-ttu-id="2a7e5-311">[How to query Azure Active Directory for an object using Azure Active Directory PowerShell](https://msdn.microsoft.com/library/azure/jj151815.aspx) (Как запросить объект с помощью модуля Azure Active Directory для PowerShell)</span><span class="sxs-lookup"><span data-stu-id="2a7e5-311">[How to query Azure Active Directory for an object using Azure Active Directory PowerShell](https://msdn.microsoft.com/library/azure/jj151815.aspx)</span></span>
