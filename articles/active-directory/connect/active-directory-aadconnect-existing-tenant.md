---
title: "Использование Azure AD Connect при наличии существующего клиента Azure AD | Документация Майкрософт"
description: "В этом разделе описывается, как toouse подключаться, если у вас есть существующий клиент Azure AD."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: f7b166e9e85c1f03330e8e0074d4afa4036738c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-when-you-have-an-existent-tenant"></a><span data-ttu-id="b9541-103">Azure AD Connect: если имеется существующий клиент</span><span class="sxs-lookup"><span data-stu-id="b9541-103">Azure AD Connect: When you have an existent tenant</span></span>
<span data-ttu-id="b9541-104">Большинство разделов hello по как предполагает toouse Azure AD Connect, можно начать с нового Azure клиента AD, и что пользователи не и другие объекты в ней.</span><span class="sxs-lookup"><span data-stu-id="b9541-104">Most of hello topics for how toouse Azure AD Connect assumes you start with a new Azure AD tenant and that there are no users or other objects there.</span></span> <span data-ttu-id="b9541-105">Но если вы начали с клиента Azure AD, заполненный пользователей и других объектов, а теперь хотите toouse Connect, а затем этот раздел предназначен для вас.</span><span class="sxs-lookup"><span data-stu-id="b9541-105">But if you have started with an Azure AD tenant, populated it with users and other objects, and now want toouse Connect, then this topic is for you.</span></span>

## <a name="hello-basics"></a><span data-ttu-id="b9541-106">Основы Hello</span><span class="sxs-lookup"><span data-stu-id="b9541-106">hello basics</span></span>
<span data-ttu-id="b9541-107">Объект в Azure AD либо управляется в облаке hello (Azure AD) или в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="b9541-107">An object in Azure AD is either mastered in hello cloud (Azure AD) or on-premises.</span></span> <span data-ttu-id="b9541-108">Невозможно управлять одними атрибутами отдельного объекта в локальной среде, а другими — в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-108">For one single object, you cannot manage some attributes on-premises and some other attributes in Azure AD.</span></span> <span data-ttu-id="b9541-109">Каждый объект имеет флаг, указывающий, где осуществляется hello объекта.</span><span class="sxs-lookup"><span data-stu-id="b9541-109">Each object has a flag indicating where hello object is managed.</span></span>

<span data-ttu-id="b9541-110">Некоторые пользователи локальных и других можно управлять в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="b9541-110">You can manage some users on-premises and other in hello cloud.</span></span> <span data-ttu-id="b9541-111">Распространенный сценарий для этой конфигурации — организация, состоящая из сотрудников отдела бухгалтерии и отдела продаж.</span><span class="sxs-lookup"><span data-stu-id="b9541-111">A common scenario for this configuration is an organization with a mix of accounting workers and sales workers.</span></span> <span data-ttu-id="b9541-112">Hello учета сотрудники имеют локальной учетной записи AD, но работников продаж hello этого не сделать, они имеют учетную запись в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-112">hello accounting workers have an on-premises AD account, but hello sales workers do not, they have an account in Azure AD.</span></span> <span data-ttu-id="b9541-113">Будет удобно управлять одними пользователями в локальной среде, а другими — в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-113">You would manage some users on-premises and some in Azure AD.</span></span>

<span data-ttu-id="b9541-114">Если вы начали toomanage пользователей в Azure AD, которые также располагаются в локальной AD и позже будут toouse Connect, то существуют некоторые дополнительные проблемы, необходимые tooconsider.</span><span class="sxs-lookup"><span data-stu-id="b9541-114">If you started toomanage users in Azure AD that are also in on-premises AD and later want toouse Connect, then there are some additional concerns you need tooconsider.</span></span>

## <a name="sync-with-existing-users-in-azure-ad"></a><span data-ttu-id="b9541-115">Синхронизация с существующими пользователями в Azure AD</span><span class="sxs-lookup"><span data-stu-id="b9541-115">Sync with existing users in Azure AD</span></span>
<span data-ttu-id="b9541-116">При установке Azure AD Connect и начать синхронизацию, hello службы синхронизации Azure AD (в Azure AD) выполняет проверку на каждый новый объект и повторите toofind существующие toomatch объекта.</span><span class="sxs-lookup"><span data-stu-id="b9541-116">When you install Azure AD Connect and you start synchronizing, hello Azure AD sync service (in Azure AD) does a check on every new object and try toofind an existing object toomatch.</span></span> <span data-ttu-id="b9541-117">Для этого используются три атрибута: **userPrincipalName**, **proxyAddresses** и **sourceAnchor**/**immutableID**.</span><span class="sxs-lookup"><span data-stu-id="b9541-117">There are three attributes used for this process: **userPrincipalName**, **proxyAddresses**, and **sourceAnchor**/**immutableID**.</span></span> <span data-ttu-id="b9541-118">Сопоставление по **userPrincipalName** и **proxyAddresses** называется **нестрогим сопоставлением**.</span><span class="sxs-lookup"><span data-stu-id="b9541-118">A match on **userPrincipalName** and **proxyAddresses** is known as a **soft match**.</span></span> <span data-ttu-id="b9541-119">Сопоставление по**sourceAnchor** называется **строгим сопоставлением**.</span><span class="sxs-lookup"><span data-stu-id="b9541-119">A match on **sourceAnchor** is known as **hard match**.</span></span> <span data-ttu-id="b9541-120">Для hello **proxyAddresses** только hello значения с помощью атрибута **SMTP:**, является hello основной адрес электронной почты, используемый для вычисления hello.</span><span class="sxs-lookup"><span data-stu-id="b9541-120">For hello **proxyAddresses** attribute only hello value with **SMTP:**, that is hello primary email address, is used for hello evaluation.</span></span>

<span data-ttu-id="b9541-121">соответствие Hello вычисляется только для новых объектов, поступающих от Connect.</span><span class="sxs-lookup"><span data-stu-id="b9541-121">hello match is only evaluated for new objects coming from Connect.</span></span> <span data-ttu-id="b9541-122">Если изменить существующий объект, чтобы он соответствовал какому-либо из этих атрибутов, то появится сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="b9541-122">If you change an exiting object so it is matching any of these attributes, then you see an error instead.</span></span>

<span data-ttu-id="b9541-123">Обнаружив Azure AD, где значения атрибута hello, hello объекта то же самое, объектом, находящимся из Connect и что она уже присутствует в Azure AD, то hello объекта в Azure AD, берется по строке подключения.</span><span class="sxs-lookup"><span data-stu-id="b9541-123">If Azure AD finds an object where hello attribute values are hello same for an object coming from Connect and that it is already present in Azure AD, then hello object in Azure AD is taken over by Connect.</span></span> <span data-ttu-id="b9541-124">Hello ранее управляемыми из облака объект помечен как управляемые локальные.</span><span class="sxs-lookup"><span data-stu-id="b9541-124">hello previously cloud-managed object is flagged as on-premises managed.</span></span> <span data-ttu-id="b9541-125">Все атрибуты в Azure AD со значением в локальном AD заменяются значение hello в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="b9541-125">All attributes in Azure AD with a value in on-premises AD are overwritten with hello on-premises value.</span></span> <span data-ttu-id="b9541-126">Hello исключение — когда атрибут имеет **NULL** значение в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="b9541-126">hello exception is when an attribute has a **NULL** value on-premises.</span></span> <span data-ttu-id="b9541-127">В этом случае значение hello в Azure AD остается, но может по-прежнему его изменить, только локально toosomething else.</span><span class="sxs-lookup"><span data-stu-id="b9541-127">In this case, hello value in Azure AD remains, but you can still only change it on-premises toosomething else.</span></span>

> [!WARNING]
> <span data-ttu-id="b9541-128">Поскольку все атрибуты в Azure AD будет toobe перезаписать значение в локальной среде hello, убедитесь, что у вас есть хорошие данные локально.</span><span class="sxs-lookup"><span data-stu-id="b9541-128">Since all attributes in Azure AD are going toobe overwritten by hello on-premises value, make sure you have good data on-premises.</span></span> <span data-ttu-id="b9541-129">Например, если вы только использовали управляемый электронный адрес в Office 365 и не обновляли его в локальной среде AD DS, то будут потеряны все значения в Azure AD и Office 365, которые отсутствуют в AD DS.</span><span class="sxs-lookup"><span data-stu-id="b9541-129">For example, if you only have managed email address in Office 365 and not kept it updated in on-premises AD DS, then you lose any values in Azure AD/Office 365 not present in AD DS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b9541-130">Если использовать синхронизацию паролей, которая всегда используется стандартные параметры, то пароль hello в Azure AD перезаписывается hello пароль в локальном AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-130">If you use password sync, which is always used by express settings, then hello password in Azure AD is overwritten with hello password in on-premises AD.</span></span> <span data-ttu-id="b9541-131">Если пользователи являются используется toomanage разные пароли, то вы должны tooinform их, должны использовать hello локальный пароль, при установке подключения.</span><span class="sxs-lookup"><span data-stu-id="b9541-131">If your users are used toomanage different passwords, then you need tooinform them that they should use hello on-premises password when you have installed Connect.</span></span>

<span data-ttu-id="b9541-132">предыдущий раздел Hello и предупреждение необходимо учитывать при планировании.</span><span class="sxs-lookup"><span data-stu-id="b9541-132">hello previous section and warning must be considered in your planning.</span></span> <span data-ttu-id="b9541-133">Если внести много изменений были внесены в Azure AD, не отражаются в локальной службы AD DS, потребуется tooplan для toopopulate AD DS с hello обновление значения перед синхронизацией объектами с помощью Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="b9541-133">If you have made many changes in Azure AD not reflected in on-premises AD DS, then you need tooplan for how toopopulate AD DS with hello updated values before you sync your objects with Azure AD Connect.</span></span>

<span data-ttu-id="b9541-134">Затем hello расстановке объектами с помощью программной match **sourceAnchor** добавляется toohello объекта в Azure AD, чтобы жесткий соответствия можно использовать позже.</span><span class="sxs-lookup"><span data-stu-id="b9541-134">If you matched your objects with a soft-match, then hello **sourceAnchor** is added toohello object in Azure AD so a hard match can be used later.</span></span>

### <a name="hard-match-vs-soft-match"></a><span data-ttu-id="b9541-135">Строгое и нестрогое сопоставление</span><span class="sxs-lookup"><span data-stu-id="b9541-135">Hard-match vs Soft-match</span></span>
<span data-ttu-id="b9541-136">Для нового установленного экземпляра Connect нет практической разницы между строгим и нестрогим сопоставлением.</span><span class="sxs-lookup"><span data-stu-id="b9541-136">For a new installation of Connect, there is no practical difference between a soft- and a hard-match.</span></span> <span data-ttu-id="b9541-137">Hello разница заключается в аварийном восстановлении.</span><span class="sxs-lookup"><span data-stu-id="b9541-137">hello difference is in a disaster recovery situation.</span></span> <span data-ttu-id="b9541-138">В случае потери сервера с Azure AD Connect можно повторно установить новый экземпляр без потери данных.</span><span class="sxs-lookup"><span data-stu-id="b9541-138">If you have lost your server with Azure AD Connect, you can reinstall a new instance without losing any data.</span></span> <span data-ttu-id="b9541-139">Объект с sourceAnchor отправляется tooConnect во время первоначальной установки.</span><span class="sxs-lookup"><span data-stu-id="b9541-139">An object with a sourceAnchor is sent tooConnect during initial install.</span></span> <span data-ttu-id="b9541-140">Hello совпадения можно затем оценить клиентом hello (Azure AD Connect), который выполняется гораздо быстрее, чем это же hello в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-140">hello match can then be evaluated by hello client (Azure AD Connect), which is a lot faster than doing hello same in Azure AD.</span></span> <span data-ttu-id="b9541-141">Строгое сопоставление оценивается Connect и Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-141">A hard match is evaluated both by Connect and by Azure AD.</span></span> <span data-ttu-id="b9541-142">Нестрогое сопоставление оценивается только Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-142">A soft match is only evaluated by Azure AD.</span></span>

### <a name="other-objects-than-users"></a><span data-ttu-id="b9541-143">Объекты, отличные от пользователей</span><span class="sxs-lookup"><span data-stu-id="b9541-143">Other objects than users</span></span>
<span data-ttu-id="b9541-144">Пользователи обычно имеют userPrincipalName и proxyAddresses, упрощение hello совпадения.</span><span class="sxs-lookup"><span data-stu-id="b9541-144">Users usually have both userPrincipalName and proxyAddresses, making hello match easy.</span></span> <span data-ttu-id="b9541-145">Но у других объектов, таких как группы безопасности, их нет.</span><span class="sxs-lookup"><span data-stu-id="b9541-145">But other objects, such as security groups, do not have those.</span></span> <span data-ttu-id="b9541-146">В этом случае вы может соответствовать только на жестких сопоставление с использованием hello sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="b9541-146">In this case, you can only match on a hard match using hello sourceAnchor.</span></span> <span data-ttu-id="b9541-147">Hello sourceAnchor всегда является hello преобразовать Base64 **objectGUID** в локальной среде, необходимо обновить значение hello в Azure AD, при необходимости toomatch двух объектов.</span><span class="sxs-lookup"><span data-stu-id="b9541-147">hello sourceAnchor is always hello Base64 converted **objectGUID** on-premises, so you must update hello value in Azure AD when you need two objects toomatch.</span></span> <span data-ttu-id="b9541-148">Hello sourceAnchor/immutableID могут обновляться только с помощью PowerShell, а не через порталы hello.</span><span class="sxs-lookup"><span data-stu-id="b9541-148">hello sourceAnchor/immutableID can only be updated with PowerShell and not through hello portals.</span></span>

## <a name="create-a-new-on-premises-active-directory-from-data-in-azure-ad"></a><span data-ttu-id="b9541-149">Создание локальной службы Active Directory на основе данных в Azure AD</span><span class="sxs-lookup"><span data-stu-id="b9541-149">Create a new on-premises Active Directory from data in Azure AD</span></span>
<span data-ttu-id="b9541-150">Некоторые клиенты начинают с облачного решения на основе Azure AD и не используют локальную среду AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-150">Some customers start with a cloud-only solution with Azure AD and they do not have an on-premises AD.</span></span> <span data-ttu-id="b9541-151">Позже tooconsume локальных ресурсов и их требуется toobuild локальной AD на основании данных Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-151">Later they want tooconsume on-premises resources and want toobuild an on-premises AD based on Azure AD data.</span></span> <span data-ttu-id="b9541-152">В этом случае Azure AD Connect ничем не поможет.</span><span class="sxs-lookup"><span data-stu-id="b9541-152">Azure AD Connect cannot help you for this scenario.</span></span> <span data-ttu-id="b9541-153">Не создает пользователей в локальной среде и не включает все возможности tooset hello пароль локального toohello отличается от используемого в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b9541-153">It does not create users on-premises and it does not have any ability tooset hello password on-premises toohello same as in Azure AD.</span></span>

<span data-ttu-id="b9541-154">Если hello единственной причиной, почему планирование tooadd локальной AD — toosupport больших объектов (бизнес-приложения), то может быть целесообразно toouse [доменные службы Azure AD](../../active-directory-domain-services/index.md) вместо него.</span><span class="sxs-lookup"><span data-stu-id="b9541-154">If hello only reason why you plan tooadd on-premises AD is toosupport LOBs (Line-of-Business apps), then maybe you should consider toouse [Azure AD domain services](../../active-directory-domain-services/index.md) instead.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b9541-155">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b9541-155">Next steps</span></span>
<span data-ttu-id="b9541-156">Узнайте больше об [интеграции локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="b9541-156">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
