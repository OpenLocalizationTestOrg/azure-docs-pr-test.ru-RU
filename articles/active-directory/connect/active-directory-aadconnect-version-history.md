---
title: "Azure AD Connect. История выпусков версий | Документация Майкрософт"
description: "В этой статье перечислены все выпуски Azure AD Connect и Azure AD Sync"
services: active-directory
documentationcenter: 
author: billmath
manager: mtillman
editor: 
ms.assetid: ef2797d7-d440-4a9a-a648-db32ad137494
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 12/14/2017
ms.author: billmath
ms.openlocfilehash: ff43edc9799670fd90beaef1dbe4db48b2e762e5
ms.sourcegitcommit: 3f33787645e890ff3b73c4b3a28d90d5f814e46c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/03/2018
---
# <a name="azure-ad-connect-version-release-history"></a>Azure AD Connect. История выпусков версий
Команда Azure Active Directory (Azure AD) регулярно обновляет службу Azure AD Connect, добавляя новые функции и возможности. Не все эти дополнения применимы для всех пользователей.
"Эта статья предназначена для отслеживания версий, которые были выпущены и для понимания того, требуется ли обновление до последней версии или не.

Ниже приведен список связанных статей.



Раздел |  Сведения
--------- | --------- |
Действия по переходу с Azure AD Connect | Различные методы [обновления предыдущей версии до последней версии](active-directory-aadconnect-upgrade-previous-version.md) Azure AD Connect.
Необходимые разрешения | Разрешения, необходимые для установки обновления, см. в [этом](./active-directory-aadconnect-accounts-permissions.md#upgrade) разделе.

Загрузите | [Загрузить Azure AD Connect](http://go.microsoft.com/fwlink/?LinkId=615771).

## <a name="116540"></a>1.1.654.0
Состояние: 12-го декабря 2017 г.

>[!NOTE]
>Это является безопасности, связанные с помощью установки Azure AD Connect

### <a name="azure-ad-connect"></a>Azure AD Connect
Улучшение будет добавлен в Azure AD Connect версии 1.1.654.0 (и после) убедитесь, что Рекомендуемое разрешение изменяется описано в разделе [блокировка доступа к учетной записи службы AD DS](#lock) автоматически применяются при Azure AD Подключение создает учетную запись службы AD DS. 

- При настройке Azure AD Connect, установка администратора можно указать существующую учетную запись службы AD DS или позволяет автоматически создать учетную запись Azure AD Connect. Разрешение изменения автоматически применяются к учетной записи службы AD DS, созданный во время установки Azure AD Connect. Они не применяются к существующей учетной записи службы AD DS, предоставленный администратором установки.
- Для клиентов, которые выполнили обновление с более старой версии Azure AD Connect 1.1.654.0 (или после), разрешение изменения не применяются задним числом для существующих учетных записей AD DS, созданные до обновления. Они будут применяться только для новых учетных записей AD DS, созданные после обновления. Это происходит при добавлении нового леса AD быть синхронизированы с Azure AD.

>[!NOTE]
>Этот выпуск только устраняет уязвимость для новых установок Azure AD Connect, где создается учетная запись службы в процессе установки. Для существующих установок или в случаях, где предоставить учетную запись самостоятельно следует убедиться, что эта уязвимость не существует.

#### <a name="lock"></a>Блокировка доступа к учетной записи службы AD DS
Блокировка доступа учетной записи службы AD DS путем реализации следующие изменения разрешений в локальной AD:  

*   Отключение наследования для указанного объекта
*   Удалите все элементы управления доступом на конкретном объекте, за исключением элементов управления доступом, определенных на себя. Нам нужно сохранять разрешения по умолчанию без изменений, когда дело доходит до самого себя.
*   Назначьте эти разрешения:

type     | ИМЯ                          | Access               | Применяется к
---------|-------------------------------|----------------------|--------------|
РАЗРЕШИТЬ    | SYSTEM                        | Полный доступ         | Этот объект  |
РАЗРЕШИТЬ    | Администраторы предприятия             | Полный доступ         | Этот объект  |
РАЗРЕШИТЬ    | Администраторы домена                 | Полный доступ         | Этот объект  |
РАЗРЕШИТЬ    | Администраторы                | Полный доступ         | Этот объект  |
РАЗРЕШИТЬ    | Контроллеры домена предприятия | Просмотр содержимого        | Этот объект  |
РАЗРЕШИТЬ    | Контроллеры домена предприятия | Чтение всех свойств  | Этот объект  |
РАЗРЕШИТЬ    | Контроллеры домена предприятия | Разрешения на чтение     | Этот объект  |
РАЗРЕШИТЬ    | Прошедшие проверку           | Просмотр содержимого        | Этот объект  |
РАЗРЕШИТЬ    | Прошедшие проверку           | Чтение всех свойств  | Этот объект  |
РАЗРЕШИТЬ    | Прошедшие проверку           | Разрешения на чтение     | Этот объект  |

Чтобы усилить параметры для учетной записи службы AD DS, то можно запустить [этот сценарий PowerShell](https://gallery.technet.microsoft.com/Prepare-Active-Directory-ef20d978). Сценарий PowerShell будет назначать разрешения, упомянутых выше для учетной записи службы AD DS.

#### <a name="powershell-script-to-tighten-a-pre-existing-service-account"></a>Сценарий PowerShell, чтобы усилить существующей учетной записи службы

Использовать сценарий PowerShell, чтобы применить эти параметры к существующей учетной записи AD DS (Гистограмма, предоставляемая вашей организации или созданные предыдущей установки Azure AD Connect, загрузите скрипт с предоставленную ссылку выше.

##### <a name="usage"></a>Использование:

```powershell
Set-ADSyncRestrictedPermissions -ObjectDN <$ObjectDN> -Credential <$Credential>
```

Where 

**$ObjectDN** = учетная запись Active Directory, разрешения которого должны быть усилена.

**$Credential** учетные данные администратора, которая обладает необходимыми правами доступа, чтобы ограничить разрешения для учетной записи $ObjectDN =. Обычно это администратор предприятия или домена. Используйте полное доменное имя учетной записи администратора, чтобы избежать сбоев поиска учетной записи. Пример: contoso.com\admin.

>[!NOTE] 
>$credential. Имя пользователя должно быть в формате FQDN\username. Пример: contoso.com\admin 

##### <a name="example"></a>Пример:

```powershell
Set-ADSyncRestrictedPermissions -ObjectDN "CN=TestAccount1,CN=Users,DC=bvtadwbackdc,DC=com" -Credential $credential 
```
### <a name="was-this-vulnerability-used-to-gain-unauthorized-access"></a>Эта уязвимость использовался для получения несанкционированного доступа?

Для просмотра, использовался ли эта уязвимость для атак в Azure AD Connect конфигурации следует проверить последний пароль переустановить срока действия учетной записи службы.  Если отметка времени в Непредвиденная, дальнейшего изучения через журнал событий должны выполняться для сброса пароля, событие.

Дополнительные сведения см. в разделе [4056318 советы по безопасности Майкрософт](https://technet.microsoft.com/library/security/4056318)

## <a name="116490"></a>1.1.649.0
Состояние: 27 октября 2017 г.

>[!NOTE]
>Эта сборка недоступна для клиентов, использующих функцию автоматического обновления Azure AD Connect.

### <a name="azure-ad-connect"></a>Azure AD Connect
#### <a name="fixed-issue"></a>Исправленные проблемы
* Устранена проблема совместимости между Azure AD Connect и агентом Azure AD Connect Health (для синхронизации). Эта проблема затрагивает клиентов, выполняющих обновление на месте Azure AD Connect до версии 1.1.647.0, но в настоящее время использующих агент Azure AD Connect Health версии 3.0.127.0. После обновления агент Azure AD Connect Health больше не может отправлять данные о службе синхронизации Azure AD Connect в службу Azure AD Health. Благодаря этому исправлению агент Azure AD Connect Health версии 3.0.129.0 устанавливается во время обновления на месте Azure AD Connect. В Azure AD Connect Health версии 3.0.129.0 нет проблемы совместимости с Azure AD Connect версии 1.1.649.0.


## <a name="116470"></a>1.1.647.0
Состояние: 19 октября 2017 г.

> [!IMPORTANT]
> Существует проблема совместимости между Azure AD Connect версии 1.1.647.0 и агентом Azure AD Connect Health (для синхронизации) версии 3.0.127.0. Эта проблема не позволяет агенту работоспособности отправлять данные о работоспособности службы синхронизации Azure AD Connect (включая ошибки синхронизации объектов и данные журнала выполнения) в службу Azure AD Health. Прежде чем вручную обновить развертывание Azure AD Connect до версии 1.1.647.0, проверьте текущую версию агента Azure AD Connect Health, установленную на сервере Azure AD Connect. Чтобы сделать это, выберите пункты *Панель управления → Установка и удаление программ* и найдите приложение *агента Azure AD Connect Health для синхронизации*. Если его версия 3.0.127.0, рекомендуется дождаться выхода следующей версии обновления Azure AD Connect. Если версия агента работоспособности отличается от 3.0.127.0, можно вручную выполнить обновление "на месте". Обратите внимание, что эта проблема не влияет на обновление со сменой или новую установку Azure AD Connect.
>
>

### <a name="azure-ad-connect"></a>Azure AD Connect
#### <a name="fixed-issues"></a>Исправленные проблемы
* Устранена проблема с задачей *изменения параметров входа пользователя* в мастере Azure AD Connect:

  * Эта проблема возникает при наличии существующего развертывания Azure AD Connect с **включенной** синхронизацией паролей, когда вы пытаетесь установить метод *сквозной проверки подлинности* для входа. Перед применением изменений в мастере неправильно отображался запрос *Отключение синхронизации паролей*. Однако синхронизация паролей оставалась включенной после применения изменений. После этого исправления в мастере больше не отображается этот запрос.

  * По умолчанию мастер не отключает синхронизацию паролей при обновлении метода входа пользователя с помощью задачи *изменения параметров входа пользователя*. Это нужно, чтобы избежать сбоев для клиентов, которые хотят сохранить синхронизацию паролей, даже несмотря на то, что они включают сквозную аутентификацию или федерацию в качестве основного метода входа пользователя.
  
  * Если вы хотите отключить синхронизацию паролей после обновления метода входа пользователя, необходимо выполнить задачу *настройки конфигурации синхронизации* в мастере. Перейдя на страницу *Дополнительные возможности*, снимите флажок *Синхронизация паролей*.
  
  * Обратите внимание, что такая же проблема возникает при включении или отключении простого единого входа. Так происходит, если у вас есть развертывание Azure AD Connect с включенной синхронизацией паролей и для входа пользователей уже установлен метод *сквозной проверки подлинности*. С помощью задачи *изменения параметров входа пользователя* вы устанавливаете или снимаете флажок *Включить простой единый вход*, в то время как методом входа в систему остается сквозная проверка подлинности. Перед применением изменений в мастере неправильно отображался запрос *Отключение синхронизации паролей*. Однако синхронизация паролей оставалась включенной после применения изменений. После этого исправления в мастере больше не отображается этот запрос.

* Устранена проблема с задачей *изменения параметров входа пользователя* в мастере Azure AD Connect:

   * Эта проблема возникает при наличии существующего развертывания Azure AD Connect с **отключенной** синхронизацией паролей, когда вы пытаетесь установить метод *сквозной проверки подлинности* для входа. При применении изменений мастер включает и сквозную аутентификацию, и синхронизацию паролей. Благодаря этому исправлению мастер больше не включает синхронизацию паролей.

  * Ранее синхронизация паролей была обязательной для включения сквозной проверки подлинности. Если вы устанавливаете *сквозную проверку подлинности* в качестве метода входа пользователя, мастер включит и сквозную аутентификацию, и синхронизацию паролей. Недавно синхронизация паролей была исключена из предварительных требований. В Azure AD Connect версии 1.1.557.0 внесено изменение для отключения синхронизации паролей, если в качестве метода входа пользователя установлена *сквозная проверка подлинности*. Однако это изменение применено только к установке Azure AD Connect. Благодаря этому исправлению такие же изменения применяются к задаче *изменения параметров входа пользователя*.
  
  * Обратите внимание, что такая же проблема возникает при включении или отключении простого единого входа. Эта проблема возникает при наличии существующего развертывания Azure AD Connect с отключенной синхронизацией паролей, когда уже установлен метод *сквозной проверки подлинности* для входа. С помощью задачи *изменения параметров входа пользователя* вы устанавливаете или снимаете флажок *Включить простой единый вход*, в то время как методом входа в систему остается сквозная проверка подлинности. При применении изменений мастер включает синхронизацию паролей. Благодаря этому исправлению мастер больше не включает синхронизацию паролей. 

* Исправлена ​​проблема, из-за которой обновление Azure AD Connect завершалось ошибкой *Unable to upgrade the Synchronization Service* (Не удалось обновить службу синхронизации). Кроме того, служба синхронизации не может запуститься с ошибкой *The service was unable to start because the version of the database is newer than the version of the binaries installed* (Не удалось запустить службу, так как версия базы данных новее, чем версия установленных двоичных файлов). Эта проблема возникает, когда администратор, выполняющий обновление, не имеет прав доступа системного администратора (sysadmin) к серверу SQL Server, который используется Azure AD Connect. Благодаря этому исправлению Azure AD Connect требует, чтобы администратор имел права доступа владельца базы данных (db_owner) к базе данных ADSync во время обновления.

* Устранена проблема с обновлением Azure AD Connect, которая затрагивала клиентов, у которых включен [простой единый вход](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-sso). После обновления Azure AD Connect функция простого единого входа отображалась как отключенная в мастере Azure AD Connect, хотя она оставалась включенной и полностью работоспособной. Теперь благодаря этому исправлению эта функция отображается в мастере как включенная.

* Исправлена ​​ошибка, из-за которой мастер Azure AD Connect всегда отображал запрос *Настройка привязки к источнику* на странице *Готово к настройке*, даже если никаких изменений, связанных с привязкой к источнику, не было сделано.

* При выполнении обновления Azure AD Connect "на месте" вручную пользователь должен предоставить учетные данные глобального администратора соответствующего клиента Azure AD. Раньше обновление могло продолжаться, даже если предоставленные учетные данные глобального администратора относились к другому клиенту Azure AD. Хотя обновление завершалось успешно, некоторые конфигурации не сохранялись должным образом. После этого исправления мастер не позволит выполнить обновление, если предоставленные учетные данные не совпадают с клиентом Azure AD.

* Удалена избыточная логика, которая без необходимости перезапускала службу Azure AD Connect Health в начале обновления вручную.


#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* Добавлена ​​логика для упрощения этапов, необходимых для настройки Azure AD Connect с облаком Майкрософт для Германии. Раньше вам необходимо было обновить определенные разделы реестра на сервере Azure AD Connect, чтобы он корректно работал с облаком Майкрософт для Германии, как описано в этой статье. Теперь Azure AD Connect может автоматически определить, находится ли ваш клиент в облаке Майкрософт для Германии на основе учетных данных глобального администратора, предоставленных во время установки.

### <a name="azure-ad-connect-sync"></a>Синхронизация Azure AD Connect
>[!NOTE]
> Примечание. Служба синхронизации имеет интерфейс WMI, который позволяет разрабатывать собственный пользовательский планировщик. Этот интерфейс больше не рекомендуется использовать. Он будет удален из будущих версий Azure AD Connect, которые будут выпущены после 30 июня 2018 г. Клиенты, которые хотят настроить расписание синхронизации, должны использовать [встроенный планировщик (https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnectsync-feature-scheduler).

#### <a name="fixed-issues"></a>Исправленные проблемы
* Когда мастер Azure AD Connect создает учетную запись соединителя AD, необходимую для синхронизации изменений локальной службы Active Directory, он неправильно присваивает учетной записи разрешение, требуемое для чтения объектов PublicFolder. Эта проблема затрагивает как экспресс-установку, так и выборочную установку. Это исправление устраняет эту проблему.

* Исправлена ​​ошибка, из-за которой страница со сведениями об устранении неполадок мастера Azure AD Connect отображалась неправильно для администраторов, работающих с Windows Server 2016.

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* При устранении неполадок с синхронизацией паролей с помощью соответствующей страницы мастера Azure AD Connect на странице теперь содержится состояние домена.

* Ранее при попытке включить синхронизацию хэша паролей Azure AD Connect не проверял, имеет ли учетная запись соединителя AD разрешения для синхронизации хэша паролей из локальной службы AD. Теперь мастер Azure AD Connect проверяет и предупреждает, если учетная запись соединителя AD не имеет достаточно прав.

### <a name="ad-fs-management"></a>Управление AD FS
#### <a name="fixed-issue"></a>Исправленные проблемы
* Исправлена ​​проблема, связанная с использованием [msDS-ConsistencyGuid в качестве привязки к источнику](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-design-concepts#using-msds-consistencyguid-as-sourceanchor). Эта проблема затрагивает клиентов, настроивших *федерацию с AD FS* в качестве метода входа пользователя. Когда вы выполняете задачу *Настройка привязки к источнику* в мастере, Azure AD Connect переключается на использование *ms-DS-ConsistencyGuid в качестве исходного атрибута для immutableId. В рамках этого изменения Azure AD Connect пытается обновить правила утверждения для атрибута immutableId в AD FS. Однако этот шаг завершался сбоем, так как Azure AD Connect не имел учетных данных администратора, необходимых для настройки AD FS. Благодаря этому исправлению теперь при выполнении задачи *Настройка привязки к источнику* Azure AD Connect запрашивает учетные данные администратора AD FS.



## <a name="116140"></a>1.1.614.0
Состояние: 5 сентября 2017 года

### <a name="azure-ad-connect"></a>Azure AD Connect

#### <a name="known-issues"></a>Известные проблемы
* Существует известная проблема, которая приводит к сбою обновления Azure AD Connect с ошибкой *Unable to upgrade the Synchronization Service* (Не удалось обновить службу синхронизации). Кроме того, служба синхронизации не может запуститься с ошибкой *The service was unable to start because the version of the database is newer than the version of the binaries installed* (Не удалось запустить службу, так как версия базы данных новее, чем версия установленных двоичных файлов). Эта проблема возникает, когда администратор, выполняющий обновление, не имеет прав доступа системного администратора (sysadmin) к серверу SQL Server, который используется Azure AD Connect. Разрешений владельца базы данных недостаточно.

* Есть известная проблема с обновлением Azure AD Connect, которая затрагивает клиентов, у которых включен [простой единый вход](active-directory-aadconnect-sso.md). После обновления Azure AD Connect компонент отображается как отключенный в мастере, несмотря на то что он остается включенным. Эта проблема будет решена в следующем выпуске. Клиенты, которые обеспокоены этой проблемой отображения, могут вручную исправить ее, включив простой единый вход в мастере.

#### <a name="fixed-issues"></a>Исправленные проблемы
* Устранена проблема, не позволявшая Azure AD Connect обновить правила утверждений в локальных службах AD FS при включении функции [msDS-ConsistencyGuid как привязка к источнику](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-design-concepts#using-msds-consistencyguid-as-sourceanchor). Эта проблема возникала при попытке включить эту функцию для существующего развертывания Azure AD Connect, для которого настроен вход с помощью AD FS. Эта проблема возникала потому, что мастер не запрашивал учетные данные AD FS перед попыткой обновить правила утверждений в AD FS.
* Исправлена проблема, из-за которой установка в Azure AD Connect завершалась сбоем, если в локальном лесу AD отключен NTLM. Проблема заключалась в том, что мастер Azure AD Connect не предоставлял полные учетные данные при создании контекста безопасности, необходимого для проверки подлинности Kerberos. Это вызывало сбой проверки подлинности Kerberos, и мастер Azure AD Connect возвращался к использованию NTLM.

### <a name="azure-ad-connect-sync"></a>Синхронизация Azure AD Connect
#### <a name="fixed-issues"></a>Исправленные проблемы
* Исправлена проблема, при которой не удавалось создать правило синхронизации, если атрибут тега не заполнен.
* Исправлена проблема, которая вызывала подключение Azure AD Connect к локальной службе AD для синхронизации паролей с помощью NTLM, несмотря на то что Kerberos был доступен. Эта проблема возникала, если в топологии локальной службы AD был один или несколько контроллеров домена, восстановленных из резервной копии.
* Исправлена проблема, которая вызывала появление ненужных действий полной синхронизации после обновления. Как правило, эти действия должны выполняться, только если вносились изменения в стандартные правила синхронизации. Проблема возникала из-за ошибки в логике обнаружения изменений, которая неправильно обнаруживала изменения, когда натыкалась на выражение правила синхронизации с символами новой строки. Символы новой строки вставляются в выражение правила синхронизации для повышения удобства чтения.
* Исправлена проблема, которая вызывала неправильную работу сервера Azure AD Connect после автоматического обновления. Эта проблема затрагивает серверы Azure AD Connect версии 1.1.443.0 (или более ранних версий). Дополнительные сведения об этой проблеме см. в статье [Azure AD Connect is not working correctly after an automatic upgrade](https://support.microsoft.com/help/4038479/azure-ad-connect-is-not-working-correctly-after-an-automatic-upgrade) (Azure AD Connect работает неправильно после автоматического обновления).
* Исправлена проблема, которая может вызывать повторные попытки автоматического обновления каждые 5 минут в случае возникновения ошибок. Теперь автоматическое обновление повторно выполняется с экспоненциальной задержкой при возникновении ошибок.
* Исправлена проблема, при которой событие синхронизации паролей 611 некорректно отображалось в журналах событий приложения Windows с состоянием **информация**, а не **ошибка**. Событие 611 создается каждый раз, когда при синхронизации паролей возникает ошибка. 
* Исправлена ​​проблема в мастере Azure AD Connect, которая позволяла включить функцию обратной записи групп без выбора подразделения.

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* В мастер Azure AD Connect в разделе "Дополнительные задачи" добавлена задача устранения неполадок. Клиенты могут использовать эту задачу, чтобы исправить проблему, связанную с синхронизацией паролей, и собрать общие диагностические данные. В будущем задача устранения неполадок будет распространяться и на другие проблемы синхронизации каталога.
* Azure AD Connect теперь поддерживает новый режим установки под названием **Использовать существующую базу данных**. Режим установки позволяет пользователям устанавливать Azure AD Connect, который указывает имеющуюся базу данных ADSync. Дополнительные сведения об этой возможности см. в статье [Install Azure AD Connect using an existing ADSync database](active-directory-aadconnect-existing-database.md) (Установка Azure AD Connect с помощью имеющейся базы данных ADSync).
* В целях повышения безопасности Azure AD Connect теперь по умолчанию использует протокол TLS 1.2 при подключении к Azure AD для синхронизации каталогов. Ранее по умолчанию использовался протокол TLS 1.0.
* При запуске агент синхронизации паролей Azure AD Connect пытается подключиться к хорошо известной конечной точке Azure AD для синхронизации паролей. После успешного подключения он перенаправляется к конечной точке конкретного региона. Ранее агент синхронизации паролей кэшировал конечную точку конкретного региона до его перезапуска. Теперь агент очищает кэш и повторяет попытку с помощью известной конечной точки при обнаружении проблемы с подключением к конечной точке конкретного региона. Таким образом при синхронизации паролей может быть выполнена отработка отказа в другую конечную точку конкретного региона, если кэшированная конечная точка конкретного региона больше недоступна.
* Для синхронизации изменений из локального леса AD необходима учетная запись AD DS. Можно создать учетную запись AD DS самостоятельно и предоставить ее учетные данные для Azure AD Connect либо предоставить учетные данные администратора предприятия и позволить Azure AD Connect создать учетную запись AD DS за вас. Ранее по умолчанию в мастере Azure AD Connect использовался первый вариант. Теперь используется второй вариант.

### <a name="azure-ad-connect-health"></a>Azure AD Connect Health,

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* Добавлена поддержка облака Microsoft Azure для государственных организаций и Microsoft Cloud для Германии.

### <a name="ad-fs-management"></a>Управление AD FS
#### <a name="fixed-issues"></a>Исправленные проблемы
* Командлет Initialize-ADSyncNGCKeysWriteBack в модуле PowerShell для подготовки AD неправильно использовал список управления доступом для контейнера регистрации устройств и таким образом наследовал только имеющиеся разрешения.  Это было обновлено, чтобы учетная запись службы синхронизации имела правильные разрешения.

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* Задача проверки входа ADFS в AAD Connect была обновлена, чтобы проверять входы в Microsoft Online, а не только извлечение маркеров из ADFS.
* При настройке новой фермы ADFS с помощью AAD Connect страница запроса учетных данных ADFS была перемещена. Теперь она возникает перед тем, как пользователя попросят указать серверы ADFS и WAP.  Это позволяет AAD Connect проверить, имеет ли указанная учетная запись правильные разрешения.
* При обновлении AAD Connect больше не происходит сбой, если не удается обновить доверие ADFS AAD.  В этом случае пользователь увидит соответствующее предупреждающее сообщение, и он должен будет продолжить сброс доверия через дополнительную задачу AAD Connect.

### <a name="seamless-single-sign-on"></a>Простой единый вход
#### <a name="fixed-issues"></a>Исправленные проблемы
* Исправлена проблема, из-за которой мастер Azure AD Connect возвращал ошибку при попытке включить [простой единый вход](active-directory-aadconnect-sso.md). Сообщение об ошибке: *Configuration of Microsoft Azure AD Connect Authentication Agent failed.* (Не удалось выполнить настройку агента проверки подлинности Microsoft Azure AD Connect). Эта проблема касается уже существующих клиентов, которые вручную обновили предварительные версии агентов проверки подлинности для [сквозной проверки подлинности](active-directory-aadconnect-sso.md), используя действия, описанные в этой [статье](active-directory-aadconnect-pass-through-authentication-upgrade-preview-authentication-agents.md).


## <a name="115610"></a>1.1.561.0
Состояние: 23 июля 2017 г.

### <a name="azure-ad-connect"></a>Azure AD Connect

#### <a name="fixed-issue"></a>Исправленные проблемы

* Устранена проблема, вызывающая удаление стандартного правила синхронизации Out to AD - User ImmutableId:

  * Эта проблема возникает при обновлении Azure AD Connect или если для обновления конфигурации синхронизации Azure AD Connect в мастере Azure AD Connect используется параметр задачи *Update Synchronization Configuration* (Обновить конфигурацию синхронизации).
  
  * Это правило синхронизации применяется к клиентам, которые включили [msDS-ConsistencyGuid в качестве функции привязки к источнику](active-directory-aadconnect-design-concepts.md#using-msds-consistencyguid-as-sourceanchor). Эта функция доступна начиная с версии 1.1.524.0. При удалении правила синхронизации Azure AD Connect больше не сможет заполнить атрибут локальной среды AD DS-ms-ConsistencyGuid значением атрибута ObjectGuid. Он не предотвращает подготовку новых пользователей в Azure AD.
  
  * Исправление гарантирует, что правила синхронизации больше не будут удаляться во время обновления или во время изменения конфигурации при условии, что эта функция включена. Для существующих клиентов, которых затронула эта проблема, исправление также гарантирует, что правило синхронизации будет добавлено обратно после обновления до этой версии Azure AD Connect.

* Исправлена проблема, из за которой стандартное правило синхронизации имело значение приоритета меньше 100:

  * Как правило, более высокие значения приоритета (от 0 до 99) зарезервированы для пользовательских правил синхронизации. Во время обновления значения приоритета для стандартного правила синхронизации обновляются в соответствии с изменениями правила синхронизации. Из-за этой проблемы стандартному правилу синхронизации может быть назначено значение приоритета меньше 100.
  
  * Исправление предотвращает возникновение этой проблемы во время обновления. Однако оно не восстанавливает значения приоритета для существующих клиентов, которые столкнулись с этой проблемой. Для восстановления в будущем будет предоставлено отдельное исправление.

* Устранена проблема, при которой в [окне фильтрации домена и подразделения](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering) мастера Azure AD Connect параметр *Синхронизировать все домены и подразделения* отображается как выбранный, хотя включена фильтрация на основе подразделения.

*   Устранена проблема, из-за которой [окно настройки разделов каталога](active-directory-aadconnectsync-configure-filtering.md#organizational-unitbased-filtering) в Synchronization Service Manager возвращает ошибку при нажатии кнопки *Обновить*. Появляется сообщение об ошибке *Произошла ошибка при обновлении доменов: не удалось привести объект типа System.Collections.ArrayList к типу Microsoft.DirectoryServices.MetadirectoryServices.UI.PropertySheetBase.MaPropertyPages.PartitionObject.* Эта ошибка возникает, если вы добавили новый домен AD в существующий лес AD и пытаетесь обновить Azure AD Connect с помощью кнопки "Обновить".

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения

* [Функция автоматического обновления](active-directory-aadconnect-feature-automatic-upgrade.md) расширена для поддержки клиентов, которые используют следующие конфигурации:
  * Включена функция обратной записи устройства.
  * Включена функция обратной записи групп.
  * Установка не является экспресс-установкой параметров или обновлением DirSync.
  * В метавселенной больше 100 000 объектов.
  * Выполняется подключение к нескольким лесам. Экспресс-установка подключается только к одному лесу.
  * Учетная запись соединителя AD больше не является учетной записью MSOL_ по умолчанию.
  * Сервер настроен для работы в промежуточном режиме.
  * Включена функция обратной записи пользователей.
  
  >[!NOTE]
  >Расширение области функции автоматического обновления затрагивает клиентов сборки Azure AD Connect версии 1.1.105.0 и более поздних версий. Если автоматическое обновление сервера Azure AD Connect не требуется, необходимо выполнить следующий командлет на сервере Azure AD Connect: `Set-ADSyncAutoUpgrade -AutoUpgradeState disabled`. Сведения об автоматическом обновлении см. в статье [Azure AD Connect: автоматическое обновление](active-directory-aadconnect-feature-automatic-upgrade.md).

## <a name="115580"></a>1.1.558.0
Состояние: не будет выпущено. Изменения в этой сборке добавлены в версию 1.1.561.0.

### <a name="azure-ad-connect"></a>Azure AD Connect

#### <a name="fixed-issue"></a>Исправленные проблемы

* Устранена проблема, вызывающая удаление стандартного правила синхронизации Out to AD - User ImmutableId при обновлении конфигурации фильтрации по подразделениям. Это правило синхронизации необходимо для [msDS-ConsistencyGuid в качестве функции привязки к источнику](active-directory-aadconnect-design-concepts.md#using-msds-consistencyguid-as-sourceanchor).

* Устранена проблема, при которой в [окне фильтрации домена и подразделения](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering) мастера Azure AD Connect параметр *Синхронизировать все домены и подразделения* отображается как выбранный, хотя включена фильтрация на основе подразделения.

*   Устранена проблема, из-за которой [окно настройки разделов каталога](active-directory-aadconnectsync-configure-filtering.md#organizational-unitbased-filtering) в Synchronization Service Manager возвращает ошибку при нажатии кнопки *Обновить*. Появляется сообщение об ошибке *Произошла ошибка при обновлении доменов: не удалось привести объект типа System.Collections.ArrayList к типу Microsoft.DirectoryServices.MetadirectoryServices.UI.PropertySheetBase.MaPropertyPages.PartitionObject.* Эта ошибка возникает, если вы добавили новый домен AD в существующий лес AD и пытаетесь обновить Azure AD Connect с помощью кнопки "Обновить".

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения

* [Функция автоматического обновления](active-directory-aadconnect-feature-automatic-upgrade.md) расширена для поддержки клиентов, которые используют следующие конфигурации:
  * Включена функция обратной записи устройства.
  * Включена функция обратной записи групп.
  * Установка не является экспресс-установкой параметров или обновлением DirSync.
  * В метавселенной больше 100 000 объектов.
  * Выполняется подключение к нескольким лесам. Экспресс-установка подключается только к одному лесу.
  * Учетная запись соединителя AD больше не является учетной записью MSOL_ по умолчанию.
  * Сервер настроен для работы в промежуточном режиме.
  * Включена функция обратной записи пользователей.
  
  >[!NOTE]
  >Расширение области функции автоматического обновления затрагивает клиентов сборки Azure AD Connect версии 1.1.105.0 и более поздних версий. Если автоматическое обновление сервера Azure AD Connect не требуется, необходимо выполнить следующий командлет на сервере Azure AD Connect: `Set-ADSyncAutoUpgrade -AutoUpgradeState disabled`. Сведения об автоматическом обновлении см. в статье [Azure AD Connect: автоматическое обновление](active-directory-aadconnect-feature-automatic-upgrade.md).

## <a name="115570"></a>1.1.557.0
Состояние: июль 2017 г.

>[!NOTE]
>Эта сборка недоступна для клиентов, использующих функцию автоматического обновления Azure AD Connect.

### <a name="azure-ad-connect"></a>Azure AD Connect

#### <a name="fixed-issue"></a>Исправленные проблемы
* Устранена проблема с командлетом Initialize-ADSyncDomainJoinedComputerSync, которая вызывала изменение проверенного домена, настроенного для существующего объекта точки подключения службы, даже если он является допустимым. Эта проблема возникает, когда в клиенте Azure AD имеется несколько проверенных доменов, которые могут использоваться для настройки точки подключения службы.

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* Обратная запись паролей доступна в виде предварительной версии в облаке Microsoft Azure для государственных организаций и Microsoft Cloud для Германии. Дополнительные сведения о поддержке в Azure AD Connect различных экземпляров службы см. в статье [Azure AD Connect: специальные рекомендации для экземпляров](active-directory-aadconnect-instances.md).

* Командлет Initialize-ADSyncDomainJoinedComputerSync теперь имеет новый дополнительный параметр с именем AzureADDomain. Этот параметр позволяет указать, какой проверенный домен следует использовать для настройки точки подключения службы.

### <a name="pass-through-authentication"></a>Сквозная проверка подлинности

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* Имя агента, необходимого для сквозной проверки подлинности, было изменено с *Соединитель прокси приложения Microsoft Azure AD* на *Агент проверки подлинности Microsoft Azure AD Connect*.

* Включение сквозной проверки подлинности больше не включает синхронизацию хэша паролей по умолчанию.


## <a name="115530"></a>1.1.553.0
Состояние: июнь 2017 г.

> [!IMPORTANT]
> В этой сборке представлены изменения схем и правил синхронизации. После обновления служба синхронизации Azure AD Connect синхронизации запустит действия полного импорта и полной синхронизации. Подробнее эти изменения описываются ниже. Чтобы временно отложить полный импорт и полную синхронизацию после обновления, перейдите к разделу [Как отложить полную синхронизацию после обновления](active-directory-aadconnect-upgrade-previous-version.md#how-to-defer-full-synchronization-after-upgrade).
>
>

### <a name="azure-ad-connect-sync"></a>Синхронизация Azure AD Connect

#### <a name="known-issue"></a>Известная проблема
* Существует проблема, которая затрагивает клиентов, использующих [фильтрацию по подразделениям](active-directory-aadconnectsync-configure-filtering.md#organizational-unitbased-filtering) при синхронизации Azure AD Connect. При переходе на страницу [Фильтрация доменов и подразделений](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering) в мастере Azure AD Connect ожидается следующее поведение:
  * Если включена фильтрация по подразделениям, используется параметр **Синхронизировать выбранные домены и подразделения**.
  * В противном случае будет выбран параметр **Синхронизировать все домены и подразделения**.

Проблема в том, что параметр **Синхронизировать все домены и подразделения** всегда выбран при запуске мастера.  Это происходит, даже если уже настроена фильтрация по подразделениям. Прежде чем сохранять изменения конфигурации AAD Connect, убедитесь, что выбран параметр **Синхронизировать выбранные домены и подразделения**, и подтвердите повторное включение всех подразделений, которые нужно синхронизировать. В противном случае фильтрация по подразделениям будет отключена.

#### <a name="fixed-issues"></a>Исправленные проблемы

* Устранена проблема с обратной записью паролей, которая позволяет администраторам Azure AD сбрасывать пароль локальной учетной записи привилегированного пользователя AD. Эта проблема возникает, когда Azure AD Connect предоставлено разрешение на сброс паролей привилегированных учетных записей. Чтобы устранить эту проблему, в этой версии Azure AD Connect можно не давать администраторам Azure AD разрешение сбрасывать пароли произвольных локальных учетных записей AD привилегированных пользователей, если администраторы не являются владельцами этих учетных записей. Дополнительные сведения см. в статье [Советы по безопасности 4033453](https://technet.microsoft.com/library/security/4033453).

* Исправлена проблема, связанная с [msDS-ConsistencyGuid в качестве функции привязки к источнику](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-design-concepts#using-msds-consistencyguid-as-sourceanchor), когда Azure AD Connect не осуществляет обратную запись в локальный атрибут AD msDS-ConsistencyGuid. Эта проблема возникает, когда в Azure AD Connect добавлены несколько локальных лесов AD и выбран параметр *Удостоверения пользователя существуют в нескольких каталогах*. При использовании такой конфигурации итоговые правила синхронизации не заполняют атрибут sourceAnchorBinary в метавселенной. Атрибут sourceAnchorBinary используется как исходный атрибут для атрибута msDS-ConsistencyGuid. В результате обратная запись в атрибут ms-DSConsistencyGuid не происходит. Чтобы устранить проблему, для постоянного заполнения атрибута sourceAnchorBinary в метавселенной обновлены следующие правила синхронизации:
  * In from AD - InetOrgPerson AccountEnabled.xml;
  * In from AD - InetOrgPerson Common.xml;
  * In from AD - User AccountEnabled.xml;
  * In from AD - User Common.xml;
  * In from AD - User Join SOAInAAD.xml.

* Ранее даже если функция [msDS-ConsistencyGuid в качестве функции привязки к источнику](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-design-concepts#using-msds-consistencyguid-as-sourceanchor) не была включена, правило синхронизации Out to AD - User ImmutableId все равно добавлялось в Azure AD Connect. Этот эффект носит безвредный характер и не приводит к возникновению обратной записи атрибута msDS-ConsistencyGuid. Чтобы избежать путаницы и гарантировать, что правило синхронизации добавляется только, если включена функция, была добавлена логика.

* Устранена проблема, которая приводила к сбою синхронизации хэша паролей с событием ошибки 611. Эта проблема возникает после удаления одного или нескольких контроллеров домена из локальной службы AD. В конце каждого цикла синхронизации паролей файл cookie синхронизации, выданный локальной службой AD, содержит идентификаторы вызова удаленных контроллеров домена со значением USN (номер последовательного обновления) равным 0. Диспетчер синхронизации паролей не может сохранить файл cookie синхронизации, который содержит значение USN равное 0, и завершается сбоем с событием ошибки 611. Во время следующего цикла синхронизации диспетчер синхронизации паролей будет повторно использовать последний сохраненный файл cookie синхронизации, который не содержит значение USN равное 0. В результате для изменения одного пароля потребуется повторная синхронизация. Благодаря этому исправлению диспетчер синхронизации паролей сохраняет файл cookie синхронизации правильно.

* Ранее даже если автоматическое обновление было отключено с помощью командлета Set-ADSyncAutoUpgrade, процесс автоматического обновления сервера по-прежнему периодически проверял наличие обновлений, а скачанный установщик учитывал конфигурацию автоматического обновления. Благодаря этому исправлению процесс автоматического обновления больше не выполняет периодическую проверку на наличие обновлений. Исправление применяется автоматически, если установщик обновления для этой версии Azure AD Connect выполняется один раз.

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения

* Ранее функция [msDS-ConsistencyGuid в качестве функции привязки к источнику](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-design-concepts#using-msds-consistencyguid-as-sourceanchor) была доступна только для новых развертываний. Теперь она доступна для существующих развертываний. В частности:
  * Чтобы получить доступ к функции, запустите мастер Azure AD Connect и выберите параметр *Update Source Anchor* (Обновить привязку к источнику).
  * Этот параметр доступен только для существующих развертываний, использующих objectGuid в качестве атрибута sourceAnchor.
  * При настройке параметра мастер проверяет состояние атрибута msDS-ConsistencyGuid в локальном каталоге Active Directory. Если для какого-то объекта-пользователя в каталоге атрибут не настроен, то мастер использует msDS-ConsistencyGuid в качестве атрибута sourceAnchor. Если атрибут настроен в одном или нескольких объектах-пользователях в каталоге, то мастер делает вывод, что он используется другими приложениями и не подходит в качестве атрибута sourceAnchor и не позволяет изменить привязку к источнику. Если вы уверены, что атрибут не используется существующими приложениями, то необходимо обратиться в службу поддержки для получения сведений об устранении этой ошибки.

* На основе атрибута **userCertificate** объектов-устройств Azure AD Connect теперь ищет значения сертификатов, необходимых для [подключения присоединенных к домену устройств к Azure AD для работы в Windows 10](https://docs.microsoft.com/azure/active-directory/active-directory-azureadjoin-devices-group-policy) и отфильтровывает остальные перед синхронизацией с Azure AD. Чтобы включить это поведение, стандартное правило синхронизации Out to AAD - Device Join SOAInAD было обновлено.

* Теперь Azure AD Connect поддерживает обратную запись атрибута Exchange Online **cloudPublicDelegates** в локальный атрибут AD **publicDelegates**. Это позволяет в почтовом ящике Exchange Online предоставлять права SendOnBehalfTo пользователям с локальными почтовыми ящиками Exchange. Для поддержки этой возможности добавлено новое стандартное правило синхронизации Out to AD – User Exchange Hybrid PublicDelegates writeback. Это правило синхронизации добавляется в Azure AD Connect, только если включена функция гибридного развертывания Exchange.

*   Azure AD Connect теперь поддерживает синхронизацию атрибута **altRecipient** из Azure AD. Для поддержки этого изменения были обновлены следующие стандартные правила синхронизации, чтобы включить необходимый поток атрибутов:
  * Поступление из AD — пользователь Exchange
  * Out to AAD – User ExchangeOnline
  
* Атрибут **CloudSOAExchMailbox** в метавселенной указывает, имеет ли заданный пользователь почтовый ящик Exchange Online. Теперь определение включает дополнительные типы Exchange Online RecipientDisplayTypes, такие как почтовые ящики оборудования и конференц-зала. Чтобы включить это изменение, следующие элементы определения атрибута cloudSOAExchMailbox, который находится в стандартном правиле синхронизации In from AAD – User Exchange Hybrid, заменены:

```
CBool(IIF(IsNullOrEmpty([cloudMSExchRecipientDisplayType]),NULL,BitAnd([cloudMSExchRecipientDisplayType],&amp;HFF) = 0))
```

... на следующие:

```
CBool(
  IIF(IsPresent([cloudMSExchRecipientDisplayType]),(
    IIF([cloudMSExchRecipientDisplayType]=0,True,(
      IIF([cloudMSExchRecipientDisplayType]=2,True,(
        IIF([cloudMSExchRecipientDisplayType]=7,True,(
          IIF([cloudMSExchRecipientDisplayType]=8,True,(
            IIF([cloudMSExchRecipientDisplayType]=10,True,(
              IIF([cloudMSExchRecipientDisplayType]=16,True,(
                IIF([cloudMSExchRecipientDisplayType]=17,True,(
                  IIF([cloudMSExchRecipientDisplayType]=18,True,(
                    IIF([cloudMSExchRecipientDisplayType]=1073741824,True,(
                       IF([cloudMSExchRecipientDisplayType]=1073741840,True,False)))))))))))))))))))),False))

```

* Добавлен следующий набор функций, совместимых с сертификатом X509Certificate2, чтобы создать выражения правила синхронизации для обработки значений сертификата в атрибуте userCertificate:

    ||||
    | --- | --- | --- |
    |CertSubject|CertIssuer|CertKeyAlgorithm|
    |CertSubjectNameDN|CertIssuerOid|CertNameInfo|
    |CertSubjectNameOid|CertIssuerDN|IsCert|
    |CertFriendlyName|CertThumbprint|CertExtensionOids|
    |CertFormat|CertNotAfter|CertPublicKeyOid|
    |CertSerialNumber|CertNotBefore|CertPublicKeyParametersOid|
    |CertVersion|CertSignatureAlgorithmOid|Выберите пункт|
    |CertKeyAlgorithmParams|CertHashString|Where|
    |||With|

* Чтобы разрешить пользователям создавать пользовательские правила синхронизации для потока sAMAccountName, domainNetBios и domainFQDN для объектов-групп, а также distinguishedName для объектов-пользователей, были введены следующие изменения схемы:

  * В схему MV были добавлены следующие атрибуты:
    * Группа: AccountName.
    * Группа: domainNetBios.
    * Группа: domainFQDN.
    * Пользователь: distinguishedName.

  * В схему соединителя Azure AD были добавлены следующие атрибуты:
    * Группа: OnPremisesSamAccountName.
    * Группа: NetBiosName.
    * Группа: DnsDomainName.
    * Пользователь: OnPremisesDistinguishedName.

* Скрипт командлета ADSyncDomainJoinedComputerSync теперь имеет новый дополнительный параметр с именем AzureEnvironment. Параметр используется для указания региона, в котором размещается соответствующий клиент Azure Active Directory. Допустимые значения:
  * AzureCloud (по умолчанию).
  * AzureChinaCloud;
  * AzureGermanyCloud.
  * USGovernment.
 
* Обновлен редактор правил синхронизации для использования предложения Join (вместо Provision) в качестве значения типа ссылки по умолчанию при создании правила синхронизации.

### <a name="ad-fs-management"></a>Управление AD FS

#### <a name="issues-fixed"></a>Исправленные проблемы

* Чтобы повысить устойчивость к сбоям проверки подлинности, в Azure AD представлены следующие URL-адреса в качестве новых конечных точек WS-Federation, которые будут добавлены в локальную конфигурацию AD FS для отношения доверия с проверяющей стороной:
  * https://ests.login.microsoftonline.com/login.srf
  * https://stamp2.login.microsoftonline.com/login.srf
  * https://ccs.login.microsoftonline.com/login.srf
  * https://ccs-sdf.login.microsoftonline.com/login.srf
  
* Исправлена проблема, в результате которой AD FS создавал неправильное значение утверждения для IssuerID. Эта проблема возникает, если в клиенте Azure AD существуют несколько проверенных доменов, а суффикс домена в атрибуте userPrincipalName, используемый для создания утверждений IssuerID, имеет не менее 3 уровней (например, johndoe@us.contoso.com). Для устранения проблемы нужно обновить регулярное выражение, которое используется правилами утверждений.

#### <a name="new-features-and-improvements"></a>Новые функции и внесенные улучшения
* Ранее функцию управления сертификатами служб федерации Active Directory в Azure AD Connect можно было использовать только с фермами служб федерации Active Directory, управляемыми с помощью Azure AD Connect. Теперь эту функцию можно использовать с фермами служб федерации Active Directory, которые не управляются с помощью Azure AD Connect.

## <a name="115240"></a>1.1.524.0
Дата выпуска: май 2017 г.

> [!IMPORTANT]
> В этой сборке представлены изменения схем и правил синхронизации. После обновления служба синхронизации Azure AD Connect синхронизации запустит действия полного импорта и полной синхронизации. Подробнее эти изменения описываются ниже.
>
>

**Исправленные проблемы:**

Службы синхронизации Azure AD Connect

* Устранена проблема, которая вызывала автоматическое обновление на сервере Azure AD Connect, даже если клиент отключал эту функцию с помощью командлета Set-ADSyncAutoUpgrade. Благодаря этому исправлению процесс автоматического обновления сервера по-прежнему периодически проверяет наличие обновлений, но скачанный установщик учитывает конфигурацию автоматического обновления.
* При выполнении обновления "на месте" службы DirSync Azure AD Connect создает учетную запись службы Azure AD, которая будет использоваться соединителем Azure AD для синхронизации с Azure AD. После создания учетной записи Azure AD Connect выполняет аутентификацию в Azure AD с помощью учетной записи Azure AD. Иногда из-за временных проблем происходит сбой аутентификации, который, в свою очередь, вызывает сбой обновления "на месте" службы DirSync с ошибкой *"An error has occurred executing Configure AAD Sync task: AADSTS50034: To sign into this application, the account must be added to the xxx.onmicrosoft.com directory".* (При выполнении задачи настройки службы синхронизации AAD произошла ошибка: AADSTS50034. Для входа в это приложение необходимо добавить учетную запись в каталог xxx.onmicrosoft.com). Чтобы повысить устойчивость обновления DirSync, Azure AD Connect теперь повторяет шаг аутентификации.
* В сборке 443 возникала проблема, из-за которой обновление "на месте" DirSync выполнялось, но профили выполнения, необходимые для синхронизации каталогов, не создавались. В эту сборку Azure AD Connect включена логика восстановления. Когда клиент обновляется до этой сборки, Azure AD Connect выявляет недостающие профили выполнения и создает их.
* Устранена проблема, из-за которой процесс синхронизации паролей не мог запуститься, отображая идентификатор события 6900 и ошибку *"Уже добавлен элемент с таким ключом"*. Эта проблема возникает при обновлении настройки фильтрации подразделений для включения раздела конфигурации AD. Для устранения этой проблемы процесс синхронизации паролей теперь синхронизирует изменения паролей только из разделов домена AD. Разделы, не относящиеся к домену (такие как раздел конфигурации), пропускаются.
* Во время экспресс-установки Azure AD Connect создает локальную учетную запись AD DS, которая используется соединителем AD для взаимодействия с локальной службой AD. Раньше учетная запись создавалась с помощью установки флага PASSWD_NOTREQD для атрибута user-Account-Control и случайного выбора пароля для учетной записи. Теперь Azure AD Connect явно удаляет флаг PASSWD_NOTREQD после того, как пароль установлен в учетной записи.
* Устранена проблема, из-за которой обновление DirSync завершалось ошибкой *"a deadlock occurred in sql server which trying to acquire an application lock"* (В SQL Server произошла взаимоблокировка при попытке заблокировать приложение), когда в локальной схеме AD находился атрибут mailNickname, но он не был связан с классом объекта User в AD.
* Устранена проблема, из-за которой функция обратной записи устройств автоматически отключалась, когда администратор обновлял настройки синхронизации Azure AD Connect с помощью мастера Azure AD Connect. Причиной этого является то, что мастер выполняет проверку предварительных требований для существующей конфигурации обратной записи устройств в локальной службе AD и эта проверка завершается ошибкой. Цель исправления — пропустить проверку, если обратная запись устройств уже была включена.
* Чтобы настроить фильтрацию подразделений, можно использовать мастер Azure AD Connect или Synchronization Service Manager. Раньше, если фильтрация подразделений настраивалась с помощью мастера Azure AD Connect, то созданные затем подразделения включались в синхронизацию каталогов. Чтобы новые подразделения не включались в этот процесс, фильтрацию подразделений необходимо было настраивать с помощью Synchronization Service Manager. Теперь для получения того же результата можно использовать мастер Azure AD Connect.
* Устранена проблема, из-за которой хранимые процедуры, необходимые для Azure AD Connect, создавались по схеме устанавливающего администратора, а не по схеме dbo.
* Устранена проблема, из-за которой в журналах событий сервера AAD Connect опускался атрибут TrackingId, возвращаемый Azure AD. Эта проблема возникала, когда служба Azure AD Connect получала перенаправленное сообщение от Azure AD и Azure AD Connect не удавалось подключиться к указанной конечной точке. TrackingId используется специалистами службы поддержки для сопоставления с журналами службы при устранении неполадок.
* Когда Azure AD Connect получает ошибку LargeObject от Azure AD, служба Azure AD Connect создает событие с идентификатором EventID 6941 и сообщением *"Подготовленный объект слишком велик. Уменьшите число значений атрибутов объекта".* В то же время Azure AD Connect также создает вводящее в заблуждение событие с идентификатором EventID 6900 и сообщением *"Microsoft.Online.Coexistence.ProvisionRetryException: Не удается установить связь со службой Windows Azure Active Directory".* Во избежание путаницы Azure AD Connect больше не создает такое событие при возникновении ошибки LargeObject.
* Устранена проблема, из-за которой Synchronization Service Manager переставал отвечать на запросы при попытке обновить конфигурацию универсального соединителя LDAP.

**Новые функции и улучшения:**

Службы синхронизации Azure AD Connect
* Изменения правил синхронизации. Реализованы следующие изменения правил синхронизации:
  * Набор правил синхронизации по умолчанию обновлен. Теперь атрибуты **userCertificate** и **userSMIMECertificate** не экспортируются, если атрибуты имеют более 15 значений.
  * Атрибуты AD **employeeID** и **msExchBypassModerationLink** теперь включены в набор правил синхронизации по умолчанию.
  * Атрибут AD **photo** удален из набора правил синхронизации по умолчанию.
  * Атрибут **preferredDataLocation** добавлен в схему метавселенной и схему соединителя AAD. Клиенты, которым требуется обновить какие-либо атрибуты в Azure AD, могут использовать для этого настраиваемые правила синхронизации. Дополнительные сведения об атрибуте см. в [разделе "Включение синхронизации PreferredDataLocation" статьи "Службы синхронизации Azure AD Connect: изменение конфигурации по умолчанию"](active-directory-aadconnectsync-change-the-configuration.md#enable-synchronization-of-preferreddatalocation).
  * Атрибут **userType** добавлен в схему метавселенной и схему соединителя AAD. Клиенты, которым требуется обновить какие-либо атрибуты в Azure AD, могут использовать для этого настраиваемые правила синхронизации.

* Azure AD Connect теперь автоматически обеспечивает использование атрибута ConsistencyGuid в качестве атрибута привязки к источнику для локальных объектов AD. Более того, Azure AD Connect заполняет атрибут ConsistencyGuid значением атрибута objectGuid, если оно пустое. Эта функция применима только к новому развертыванию. Дополнительные сведения об этой функции см. в [разделе "Использование msDS-ConsistencyGuid в качестве sourceAnchor" статьи "Azure AD Connect: принципы проектирования"](active-directory-aadconnect-design-concepts.md#using-msds-consistencyguid-as-sourceanchor).
* Добавлен новый командлет для устранения неполадок Invoke-ADSyncDiagnostics, который помогает диагностировать проблемы, связанные с синхронизацией хэша паролей. Сведения об использовании командлета см.в статье [Устранение неполадок синхронизации паролей с помощью службы синхронизации Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnectsync-troubleshoot-password-synchronization).
* Теперь Azure AD Connect поддерживает синхронизацию объектов общедоступной папки с поддержкой электронной почты из локальной службы AD в Azure AD. Эту функцию можно включить с помощью мастера Azure AD Connect в разделе "Дополнительные возможности". Сведения об этой функции см. в записи блога [Office 365 Directory Based Edge Blocking support for on-premises Mail Enabled Public Folders](https://blogs.technet.microsoft.com/exchange/2017/05/19/office-365-directory-based-edge-blocking-support-for-on-premises-mail-enabled-public-folders) (Пограничная блокировка на основе каталогов Office 365 для локальных общедоступных папок с поддержкой почты).
* Для синхронизации из локального каталога AD службе Azure AD Connect требуются учетные записи AD DS. Раньше при экспресс-установке Azure AD Connect можно было предоставить учетные данные учетной записи администратора предприятия, а Azure AD Connect создавал необходимую учетную запись службы AD DS. Но при выборочной установке и при добавлении лесов в существующее развертывание необходимо предоставить учетную запись AD DS. Теперь у вас есть возможность предоставить учетные данные учетной записи администратора предприятия при выборочной установке, а также разрешить Azure AD Connect создать необходимую учетную запись AD DS.
* Azure AD Connect теперь поддерживает функцию SQL AOA. Перед установкой Azure AD Connect включите функцию SQL AOA. При установке Azure AD Connect определяет, включена ли в указанном экземпляре SQL функция SQL AOA. Если функция SQL AOA включена, то Azure AD Connect определяет, какая в SQL AOA настроена репликация (синхронная или асинхронная). При настройке прослушивателя группы доступности рекомендуется задать свойству RegisterAllProvidersIP значение 0. Это требуется то той причине, что для подключения к SQL служба Azure AD Connect сейчас использует SQL Native Client, а SQL Native Client не поддерживает свойство MultiSubNetFailover.
* Если при использовании LocalDB как базы данных для сервера Azure AD Connect достигнуто ограничение размера в 10 ГБ, то служба синхронизации больше не сможет запускаться. Раньше в LocalDB требовалось выполнить операцию ShrinkDatabase, чтобы освободить достаточно места в базе данных для запуска службы синхронизации. После этого можно было воспользоваться Synchronization Service Manager для удаления журнала выполнения, чтобы освободить еще больше места в базе данных. Теперь с помощью командлета Start-ADSyncPurgeRunHistory можно очистить данные журнала выполнения из LocalDB и тем самым освободить место в базе данных. Кроме того, этот командлет поддерживает автономный режим (если указать параметр -offline), который можно использовать, когда служба синхронизации не запущена. Примечание. Автономный режим можно использовать только в том случае, если служба синхронизации не запущена и используется база данных LocalDB.
* Чтобы сократить объем требуемого хранилища, Azure AD Connect теперь сжимает сведения об ошибках синхронизации, прежде чем сохранить их в базах данных LocalDB или SQL. При обновлении более ранней версии Azure AD Connect до этой версии, Azure AD Connect выполняет однократное сжатие существующих сведений об ошибках синхронизации.
* Раньше после обновления настройки фильтрации подразделений необходимо было вручную выполнять полный импорт, чтобы существующие объекты должным образом включались в синхронизацию каталогов или исключались из нее. Теперь Azure AD Connect автоматически запускает полный импорт при выполнении очередного цикла синхронизации. Кроме того, полный импорт выполняется только в отношении соединителей AD, затронутых обновлением. Примечание. Это улучшение относится только к обновлениям фильтрации подразделений, выполненным с помощью мастера Azure AD Connect. Оно не касается обновлений фильтрации подразделений, выполненных с помощью Synchronization Service Manager.
* Раньше при фильтрации на основе группы поддерживались только объекты User, Group и Contact. Теперь фильтрация на основе группы также поддерживает объекты-компьютеры.
* Раньше данные из пространства соединителя можно было удалить без отключения планировщика синхронизации Azure AD Connect. Теперь Synchronization Service Manager блокирует удаление данных из пространства соединителя, если обнаруживает, что планировщик включен. Затем возвращается предупреждение, которое информирует клиентов о потенциальной потере данных в случае удаления данных из пространства соединителя.
* Раньше требовалось отключить транскрипцию PowerShell, чтобы мастер Azure AD Connect работал правильно. Эта проблема частично решена. Вы можете включить транскрипцию PowerShell, если используете мастер Azure AD Connect для управления конфигурацией синхронизации. Транскрипцию PowerShell необходимо отключить, если мастер Azure AD Connect используется для управления конфигурацией ADFS.



## <a name="114860"></a>1.1.486.0
Дата выпуска: апрель 2017 г.

**Исправленные проблемы:**
* Исправлена проблема сбоя установки Azure AD Connect в локализованной версии Windows Server.

## <a name="114840"></a>1.1.484.0
Дата выпуска: апрель 2017 г.

**Известные проблемы:**

* Сбой установки этой версии Azure AD Connect может случиться в следующих случаях.
   1. При выполнении обновления "на месте" службы DirSync или новой установки Azure AD Connect.
   2. При использовании локализованной версии Windows Server, в которой имя встроенной группы администраторов на сервере — не "Администраторы".
   3. При использовании выпуска SQL Server 2012 Express LocalDB по умолчанию, установленного с помощью Azure AD Connect, вместо полной версии SQL Server.

**Исправленные проблемы:**

Службы синхронизации Azure AD Connect
* Исправлена проблема, когда планировщик синхронизации пропускает этап синхронизации, если отсутствует один или несколько соединителей и профиль выполнения для этого этапа. Например, если вы вручную добавили соединитель с помощью Synchronization Service Manager, но при этом не создали профиль выполнения для импорта изменений. Теперь планировщик синхронизации продолжит выполнение импорта изменений для других соединителей.
* Исправлена проблема, когда служба синхронизации мгновенно останавливает обработку профиля выполнения при возникновении ошибки на одном из этапов выполнения. Теперь служба синхронизации пропускает этот этап выполнения и продолжает последующую обработку. Например, у вас есть профиль выполнения импорта изменений для соединителя AD с несколькими этапами выполнения (по одному этапу на каждый локальный домен AD). Служба синхронизации будет выполнять импорт изменений с другими доменами AD даже при наличии проблем с сетевым подключением.
* Исправлена проблема, при которой не выполняется обновление соединителя Azure AD во время автоматического обновления.
* Исправлена проблема, при которой соединитель Azure AD во время настройки не может определить, является ли сервер контроллером домена, что, в свою очередь, вызывает сбой обновления DirSync.
* Исправлена проблема, когда обновление "на месте" DirSync не может создать любой профиль выполнения для соединителя Azure AD.
* Исправлена проблема, когда пользовательский интерфейс Synchronization Service Manager при настройке универсального соединителя LDAP не отвечает.

Управление AD FS
* Исправлена проблема сбоя мастера Azure AD Connect при перемещении первичного узла AD FS на другой сервер.

Desktop SSO
* Исправлена проблема для мастера Azure AD Connect, когда экран входа не позволяет включить функцию Desktop SSO, если в качестве режима входа во время установки выбрана синхронизация паролей.

**Новые функции и улучшения:**

Службы синхронизации Azure AD Connect
* Теперь синхронизация Azure AD Connect поддерживает использование учетной записи виртуальной службы, управляемую учетную запись службы и групповую управляемую учетную запись службы как свои учетные записи службы. Это применимо только к новой установке Azure AD Connect. При установке Azure AD Connect происходит следующее:
    * По умолчанию мастер Azure AD Connect создаст учетную запись виртуальной службы и будет использовать ее в качестве учетной записи службы.
    * Если установка выполняется на контроллере домена, Azure AD Connect вернется к предыдущему режиму, создаст учетную запись пользователя домена и будет использовать ее как учетную запись службы.
    * Вы можете переопределить режим по умолчанию, указав следующее:
      * групповую управляемую учетную запись службы;
      * управляемую учетную запись службы;
      * учетную запись пользователя домена;
      * локальную учетную запись пользователя.
* Если ранее вы обновили Azure AD Connect и соединители обновились или изменились правила синхронизации, Azure AD Connect запустит цикл полной синхронизации. Теперь Azure AD Connect выборочно запустит этап полного импорта только для соединителей с обновлениями и этап полной синхронизации только для соединителей с измененными правилами синхронизации.
* Ранее пороговое значение удаления экспорта можно было применить только к операциям экспорта, запускаемым с помощью планировщика синхронизации. Теперь эта функция расширена и включает операции экспорта, которые клиент может запустить вручную с помощью Synchronization Service Manager.
* В вашем клиенте Azure AD есть конфигурация службы, которая указывает, включена ли для этого клиента функция синхронизации паролей. Ранее существовал большой риск неправильной настройки конфигурации службы с помощью Azure AD Connect при наличии активного или промежуточного сервера. Сейчас Azure AD Connect позволяет согласовывать конфигурацию службы только со своим активным сервером.
* Теперь мастер Azure AD Connect обнаруживает и возвращает предупреждение, если в локальном AD не включена корзина AD.
* Ранее операции экспорта в Azure AD завершались сбоем, если общий размер объектов в пакетной службе превышал определенное пороговое значение. Сейчас при возникновении такой проблемы служба синхронизации будет повторно отправлять объекты по отдельности в пакетах меньшего размера.
* Приложение управления ключами службы синхронизации было удалено из меню "Пуск" Windows. Управление ключами шифрования будет поддерживаться и дальше через интерфейс командной строки с помощью miiskmu.exe. Дополнительные сведения об управлении ключами шифрования см. в разделе [Сброс ключа шифрования в службе синхронизации Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnectsync-change-serviceacct-pass#abandoning-the-azure-ad-connect-sync-encryption-key).
* Ранее, если вы изменили пароль учетной записи службы синхронизации Azure AD Connect, служба синхронизации не могла правильно запуститься, пока вы не сбросите ключ шифрования и не выполните повторную инициализацию пароля учетной записи этой службы. Теперь эти действия не требуются.

Desktop SSO

* Мастеру Azure AD Connect больше не нужен открытый в сети порт 9090 при настройке сквозной проверки подлинности и Desktop SSO. Требуется только порт 443. 

## <a name="114430"></a>1.1.443.0
Дата выпуска: март 2017 г.

**Исправленные проблемы:**

Службы синхронизации Azure AD Connect
* Исправлена ошибка, из-за которой работа мастера Azure AD Connect завершалась ошибкой, если в отображаемом имени соединителя Azure AD не содержался исходный домен onmicrosoft.com, назначенный клиенту Azure AD.
* Исправлена ошибка, из-за которой работа мастера Azure AD Connect завершалась ошибкой при подключении к базе данных SQL, если пароль учетной записи службы синхронизации содержал специальные знаки, такие как апостроф, двоеточие или пробел.
* Устранена проблема, из-за которой на сервере Azure AD Connect в промежуточном режиме возникала ошибка "The image has an anchor that is different than the image" (Образ имеет привязку, которая отличается от образа). Это происходило после временного исключения из синхронизации локального объекта AD, а затем его включения в процесс синхронизации.
* Устранена проблема, из-за которой на сервере Azure AD Connect в промежуточном режиме возникала ошибка "The object located by DN is a phantom" (Объект, найденный по различающемуся имени, является фантомным). Это происходило после временного исключения из синхронизации локального объекта AD, а затем его включения в процесс синхронизации.

Управление AD FS
* Исправлена ошибка, из-за которой мастер Azure AD Connect не обновлял конфигурацию AD FS и не устанавливал правильные утверждения для отношения доверия с проверяющей стороной после настройки альтернативного имени пользователя.
* Исправлена ошибка, из-за которой мастер Azure AD Connect не мог правильно обрабатывать серверы AD FS, на которых учетные записи служб были настроены в формате userPrincipalName, а не sAMAccountName.

Сквозная проверка подлинности
* Исправлена ошибка, из-за которой работа мастера Azure AD Connect завершалась ошибкой, если выбиралась сквозная аутентификация, но при регистрации соединителя происходил сбой.
* Исправлена ошибка, из-за которой мастер Azure AD Connect обходил проверки при выборе метода входа, если была включена функция Desktop SSO (Единый вход с рабочего стола).

Сброс паролей
* Исправлена проблема, которая могла помешать серверу Azure AAD Connect повторить попытку подключения, если подключение было завершено брандмауэром или прокси-сервером.

**Новые функции и улучшения:**

Службы синхронизации Azure AD Connect
* Теперь командлет Get-ADSyncScheduler возвращает новое логическое свойство SyncCycleInProgress. Если возвращаемое значение — true, то это означает, что выполняется запланированный цикл синхронизации.
* Расположение целевой папки, в которой хранятся журналы установки и настройки Azure AD Connect, перенесено из %localappdata%\AADConnect в %programdata%\AADConnect, чтобы улучшить доступ к файлам журналов.

Управление AD FS
* Добавлена поддержка обновления SSL-сертификата фермы AD FS.
* Добавлена поддержка управления AD FS 2016.
* Теперь во время установки AD FS можно указать существующую групповую управляемую учетную запись службы (GMSA).
* Теперь в качестве хэш-алгоритма подписи для отношения доверия с проверяющей стороной Azure AD можно настроить SHA-256.

Сброс паролей
* Добавлены усовершенствования, позволяющие продукту работать в средах с более строгими правилами брандмауэра.
* Повышена надежность подключений к служебной шине Azure.

## <a name="113800"></a>1.1.380.0
Дата выпуска: декабрь 2016 г.

**Исправлена проблема:**

* Исправлена проблема отсутствия в этой сборке правила для утверждений issuerid для служб федерации Active Directory (AD FS) ADFS.

>[!NOTE]
>Эта сборка недоступна для клиентов, использующих функцию автоматического обновления Azure AD Connect.

## <a name="113710"></a>1.1.371.0
Дата выпуска: декабрь 2016 г.

**Известная проблема:**

* Правило для утверждений issuerid для AD FS отсутствует в этой сборке. Правило для утверждений issuerid является обязательным, если включена федерация нескольких доменов с Azure Active Directory (Azure AD). Если вы используете Azure AD Connect для управления локальным развертыванием служб AD FS, обновление этой сборки приведет к удалению существующего правила для утверждений issuerid из конфигурации AD FS. Эту проблему можно решить, добавив правило для утверждений issuerid после установки или обновления. Дополнительные сведения о добавлении правила для утверждений issuerid см. в статье [Поддержка нескольких доменов для федерации с Azure AD](active-directory-aadconnect-multiple-domains.md).

**Исправлена проблема:**

* Сбой установки или обновления Azure AD Connect, если порт 9090 не открыт для исходящего трафика.

>[!NOTE]
>Эта сборка недоступна для клиентов, использующих функцию автоматического обновления Azure AD Connect.

## <a name="113700"></a>1.1.370.0
Дата выпуска: декабрь 2016 г.

**Известные проблемы:**

* Правило для утверждений issuerid для AD FS отсутствует в этой сборке. Правило для утверждений issuerid является обязательным, если включена федерация нескольких доменов с Azure AD. Если вы используете Azure AD Connect для управления локальным развертыванием служб AD FS, обновление этой сборки приведет к удалению существующего правила для утверждений issuerid из конфигурации AD FS. Эту проблему можно решить, добавив правило для утверждений issuerid после установки или обновления. Дополнительные сведения о добавлении правила для утверждений issuerid см. в статье [Поддержка нескольких доменов для федерации с Azure AD](active-directory-aadconnect-multiple-domains.md).
* Для завершения установки необходимо открыть порт 9090 для исходящего трафика.

**Новые функции:**

* Сквозная проверка подлинности (предварительная версия).

>[!NOTE]
>Эта сборка недоступна для клиентов, использующих функцию автоматического обновления Azure AD Connect.

## <a name="113430"></a>1.1.343.0
Дата выпуска: ноябрь 2016 г.

**Известная проблема:**

* Правило для утверждений issuerid для AD FS отсутствует в этой сборке. Правило для утверждений issuerid является обязательным, если включена федерация нескольких доменов с Azure AD. Если вы используете Azure AD Connect для управления локальным развертыванием служб AD FS, обновление этой сборки приведет к удалению существующего правила для утверждений issuerid из конфигурации AD FS. Эту проблему можно решить, добавив правило для утверждений issuerid после установки или обновления. Дополнительные сведения о добавлении правила для утверждений issuerid см. в статье [Поддержка нескольких доменов для федерации с Azure AD](active-directory-aadconnect-multiple-domains.md).

**Исправленные проблемы:**

* В некоторых случаях установка Azure AD Connect завершается сбоем, так как не удалось создать локальную учетную запись службы, пароль которой соответствует уровню сложности, заданному политикой паролей организации.
* Исправлена проблема, при которой правила объединения не вычисляются повторно, если объект в пространстве соединителя одновременно находится за пределами области для одного правила объединения и в рамках области — для другого правила объединения. Это может произойти при наличии нескольких правил объединения, условия которых являются взаимоисключающими.
* Исправлена проблема, при которой входящие правила синхронизации (из Azure AD), не содержащие правил объединения, не обрабатываются при более низких значениях приоритета, в отличие от правил, содержащих правила объединения.

**Улучшения:**

* Добавлена поддержка установки Azure AD Connect на Windows Server 2016 Standard или более поздней версии.
* Добавлена поддержка использования SQL Server 2016 в качестве удаленной базы данных для Azure AD Connect.

## <a name="112810"></a>1.1.281.0
Дата выпуска: август 2016 г.

**Исправленные проблемы:**

* Изменения в интервал синхронизации вносятся, только когда завершается следующий цикл синхронизации.
* Мастер Azure AD Connect не принимает учетную запись Azure AD, если ее имя пользователя начинается с подчеркивания (\_).
* Если пароль учетной записи Azure AD Connect содержит слишком много специальных символов, мастер Azure AD не сможет выполнить ее аутентификацию. Возвращается сообщение об ошибке "Не удалось проверить учетные данные. Произошла непредвиденная ошибка". .
* Удаление промежуточного сервера отключает синхронизацию паролей в клиенте Azure AD и приводит к сбою синхронизации паролей на активном сервере.
* Пароли не удается синхронизировать в редких случаях, когда хэш пароля не хранится на клиентском устройстве.
* Если на сервере Azure AD Connect разрешен промежуточный режим, компонент обратной записи паролей временно не отключается.
* Когда сервер находится в промежуточном режиме, мастер Azure AD Connect не отображает фактические настройки синхронизации паролей и настройки компонента обратной записи паролей. Он всегда отображает их как отключенные.
* Когда на сервере включен промежуточный режим, мастер Azure AD Connect не сохраняет изменения, внесенные в настройки синхронизации паролей и настройки компонента обратной записи паролей.

**Улучшения:**

* Обновлен командлет Start-ADSyncSyncCycle. Теперь он указывает на возможность начать новый цикл синхронизации.
* Добавлен командлет Stop-ADSyncSyncCycle, который завершает выполняющиеся цикл синхронизации и операцию.
* Обновлен командлет Stop-ADSyncScheduler, который завершает выполняющиеся цикл синхронизации и операцию.
* Когда вы настраиваете [расширения каталога](active-directory-aadconnectsync-feature-directory-extensions.md) в мастере Azure AD Connect, вы можете выбрать атрибут Azure AD, относящийся к типу "строка Teletex".

## <a name="111890"></a>1.1.189.0
Дата выпуска: июнь 2016 г.

**Исправленные проблемы и внесенные улучшения:**

* Службу Azure AD Connect теперь можно устанавливать на FIPS-совместимом сервере.
  * Дополнительные сведения о синхронизации паролей см. в разделе [Синхронизация паролей и FIPS](active-directory-aadconnectsync-implement-password-synchronization.md#password-synchronization-and-fips).
* Исправлена проблема, при которой NetBIOS-имя не удавалось разрешить в полное доменное имя в соединителе Active Directory.

## <a name="111800"></a>1.1.180.0
Дата выпуска: май 2016 г.

**Новые функции:**

* Предупреждает и помогает выполнить проверку доменов, если это не сделано перед запуском Azure AD Connect.
* Добавлена поддержка облака [Microsoft Cloud Germany](active-directory-aadconnect-instances.md#microsoft-cloud-germany).
* Добавлена поддержка последней инфраструктуры для [облака Microsoft Azure для государственных организаций](active-directory-aadconnect-instances.md#microsoft-azure-government-cloud) с новым перечнем URL-адресов.

**Исправленные проблемы и внесенные улучшения:**

* В редактор правил синхронизации добавлена фильтрация, чтобы упростить поиск правил синхронизации.
* Повышена производительность при удалении пространства соединителя.
* Исправлена проблема, когда один и тот же объект удалялся и добавлялся в ходе одного запуска (delete/add).
* Отключенное правило синхронизации больше не будет повторно включать включенные объекты и атрибуты при обновлении версии или схемы.

## <a name="111300"></a>1.1.130.0
Дата выпуска: апрель 2016 г.

**Новые функции:**

* Добавлена поддержка многозначных атрибутов для [расширений каталогов](active-directory-aadconnectsync-feature-directory-extensions.md).
* Добавлена поддержка большего числа вариантов конфигурации для соответствия условиям [автоматического обновления](active-directory-aadconnect-feature-automatic-upgrade.md).
* Добавлены некоторые командлеты для [настраиваемого планировщика](active-directory-aadconnectsync-feature-scheduler.md#custom-scheduler).

## <a name="111190"></a>1.1.119.0
Дата выпуска: март 2016 г.

**Исправленные проблемы:**

* Отключена возможность быстрой установки в Windows Server 2008 (до выпуска R2), так как в этой операционной системе не поддерживается синхронизация паролей.
* Обновление из DirSync с конфигурацией пользовательского фильтра не работало как ожидалось.
* При обновлении до новой версии без изменений в конфигурации не следовало планировать полный импорт или синхронизацию.

## <a name="111100"></a>1.1.110.0
Дата выпуска: февраль 2016 г.

**Исправленные проблемы:**

* Обновление предыдущих версий не работает, если установка выполнена не в папку по умолчанию C:\Program Files.
* Если во время установки (перед завершением работы мастера установки) вы сняли флажок **Запустить синхронизацию...**, при повторном запуске мастера установки планировщик не будет включен.
* Планировщик не будет работать правильно на серверах, формат даты и времени на которых отличается от принятого в США. Это также не позволит `Get-ADSyncScheduler` возвращать правильное время.
* Если вы установили более ранний выпуск Azure AD Connect с AD FS в качестве механизма входа и устанавливаете новую версию, запускать мастер установки повторно нельзя.

## <a name="111050"></a>1.1.105.0
Дата выпуска: февраль 2016 г.

**Новые функции:**

* [Automatic upgrade](active-directory-aadconnect-feature-automatic-upgrade.md) для тех, кто использует стандартные параметры.
* Поддержка глобального администратора с помощью Многофакторной идентификации (Azure MFA) и управления привилегированными пользователями в мастере установки.
  * Также необходимо, чтобы при использовании Многофакторной идентификации Azure прокси-сервер пропускал трафик по адресу https://secure.aadcdn.microsoftonline-p.com.
  * Чтобы обеспечить нормальную работу Многофакторной идентификации Azure, следует добавить адрес https://secure.aadcdn.microsoftonline-p.com в список надежных сайтов.
* Разрешите изменять способ входа пользователя после первоначальной установки.
* Разрешите [фильтрацию доменов и подразделений](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering) в мастере установки. Это также позволяет подключиться к лесам, в которых доступны не все домены.
* [Планировщик](active-directory-aadconnectsync-feature-scheduler.md) встроен в модуль синхронизации.

**Функции, повышенные с предварительной версии до общедоступной версии:**

* [Обратная запись устройства](active-directory-aadconnect-feature-device-writeback.md).
* [Расширения каталога](active-directory-aadconnectsync-feature-directory-extensions.md).

**Новые функции предварительной версии:**

* По умолчанию интервал синхронизации цикла составляет 30 минут. Для всех более ранних версий он составлял 3 часа. Добавлена поддержка изменения поведения [планировщика](active-directory-aadconnectsync-feature-scheduler.md).

**Исправленные проблемы:**

* На странице проверки доменов DNS домены не всегда распознаются.
* Запрос на ввод учетных данных администратора домена при настройке служб AD FS.
* Локальные учетные записи AD не распознаются с помощью мастера установки, если они расположены в домене с другим деревом DNS по сравнению с корневым доменом.

## <a name="1091310"></a>1.0.9131.0
Дата выпуска: декабрь 2015 г.

**Исправленные проблемы:**

* Синхронизация паролей при их изменении в Active Directory Domain Services (AD DS) может не работать, но работает при установке паролей.
* При наличии прокси-сервера проверка подлинности в Azure AD может завершаться ошибкой во время установки или при отмене обновления на странице конфигурации.
* Обновление предыдущего выпуска Azure AD Connect с полной версией сервера SQL Server завершается ошибкой при отсутствии прав системного администратора (SA) в среде SQL.
* При обновлении предыдущего выпуска Azure AD Connect с удаленной версией сервера SQL Server появляется сообщение об ошибке, связанной с отсутствием доступа к базе данных SQL ADSync.

## <a name="1091250"></a>1.0.9125.0
Дата выпуска: ноябрь 2015 г.

**Новые функции:**

* Перенастройка AD FS для создания отношения доверия Azure AD.
* Обновление схемы Active Directory и повторное создание правил синхронизации.
* Отключение правила синхронизации.
* Определение AuthoritativeNull как нового литерала в правиле синхронизации.

**Новые функции предварительной версии:**

* [Azure AD Connect Health для синхронизации](../connect-health/active-directory-aadconnect-health-sync.md).
* Поддержка синхронизации паролей [доменных служб Azure AD](../active-directory-passwords-update-your-own-password.md).

**Новый поддерживаемый сценарий:**

* Поддерживает несколько локальных организаций Exchange. Дополнительные сведения см. в статье [Гибридные развертывания в нескольких лесах Active Directory](https://technet.microsoft.com/library/jj873754.aspx).

**Исправленные проблемы:**

* Проблемы синхронизации паролей
  * Пароль объекта, перемещенного из внешней области во внутреннюю, не будет синхронизирован. Это относится к фильтрации как подразделений, так и атрибутов.
  * При выборе нового подразделения для включения в синхронизацию не требуется полная синхронизация паролей.
  * При включении отключенного пользователя синхронизация паролей не выполняется.
  * Очередь повторного ввода пароля является бесконечной. Предыдущее ограничение в 5 000 объектов было снято.
* Невозможно подключиться к Active Directory с Windows Server 2016 в режиме работы леса.
* Невозможно изменить группу, которая используется для фильтрации групп, после первоначальной установки.
* Больше нельзя создать новый профиль пользователя на сервере Azure AD Connect для каждого пользователя, выполняющего изменение пароля с включенной функцией обратной записи паролей.
* Невозможно использовать длинные целые числа в областях правил синхронизации.
* Параметр "Обратная запись устройств" останется отключенным, если контроллеры домена недоступны.

## <a name="1086670"></a>1.0.8667.0
Дата выпуска: август 2015 г.

**Новые функции:**

* Мастер установки Azure AD Connect теперь локализован на все языки Windows Server.
* При использовании управления паролями Azure AD добавлена поддержка разблокирования учетной записи.

**Исправленные проблемы:**

* Мастер установки Azure AD Connect дает сбой, если установку продолжает другой пользователь, а не тот, который начал установку.
* Если при предыдущем удалении Azure AD Connect не удалось полностью удалить службу Azure AD Sync, переустановка будет невозможной.
* Установить Azure AD Connect в режиме экспресс-установки невозможно, если пользователь не находится в корневом домене леса или используется локализованная версия службы каталогов Active Directory.
* Если не удается разрешить полное доменное имя учетной записи пользователя Active Directory, отображается вводящее в заблуждение сообщение об ошибке «Не удалось зафиксировать схему».
* Если учетная запись, используемая для соединителя Active Directory, будет изменена за пределами мастера, при последующих запусках мастер будет давать сбой.
* Иногда Azure AD Connect не удается установить на контроллере домена.
* Невозможно включить и отключить промежуточный режим, если были добавлены атрибуты расширения.
* Компонент обратной записи паролей дает сбой в некоторых конфигурациях из-за недопустимого пароля в соединителе Active Directory.
* DirSync невозможно обновить, если при фильтрации атрибутов используется различающееся имя (DN).
* Чрезмерное использование ресурсов ЦП при использовании сброса пароля.

**Удаленные функции предварительной версии:**

* Функция [обратной записи пользователя](active-directory-aadconnect-feature-preview.md#user-writeback) предварительной версии была временно удалена на основе отзывов клиентов этой версии. Она будет повторно добавлена позже, когда мы изучим полученные отзывы.

## <a name="1086410"></a>1.0.8641.0
Дата выпуска: июнь 2015 г.

**Первоначальный выпуск Azure AD Connect.**

Имя изменено с Azure AD Sync на Azure AD Connect.

**Новые функции:**

* установка [со стандартными параметрами](active-directory-aadconnect-get-started-express.md);
* возможность [настройки AD FS](active-directory-aadconnect-get-started-custom.md#configuring-federation-with-ad-fs);
* возможность [обновления из DirSync](active-directory-aadconnect-dirsync-upgrade-get-started.md);
* [Предотвращение случайного удаления](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)
* Добавлен [промежуточный режим](active-directory-aadconnectsync-operations.md#staging-mode)

**Новые функции предварительной версии:**

* [Обратная запись пользователей](active-directory-aadconnect-feature-preview.md#user-writeback)
* [Обратная запись групп](active-directory-aadconnect-feature-preview.md#group-writeback)
* [Обратная запись устройств](active-directory-aadconnect-feature-device-writeback.md)
* [Расширения каталогов](active-directory-aadconnect-feature-preview.md)

## <a name="104940501"></a>1.0.494.0501
Дата выпуска: май 2015 г.

**Новое требование:**

* Теперь для работы службы Azure AD Sync требуется установка платформы .NET Framework версии 4.5.1.

**Исправленные проблемы:**

* Компонент обратной записи паролей из Azure AD завершается ошибкой подключения к служебной шине.

## <a name="104910413"></a>1.0.491.0413
Дата выпуска: апрель 2015 г.

**Исправленные проблемы и внесенные улучшения:**

* Соединитель Active Directory не обрабатывает удаления правильно, если включена корзина и лес содержит несколько доменов.
* Повышена производительность операций импорта для соединителя Azure Active Directory.
* Если в группе превышался лимит количества участников (по умолчанию он равен 50 000 объектов), эта группа удалялась из Azure Active Directory. Благодаря реализации нового поведения теперь группа не удаляется, а возникает ошибка и новые изменения членства не экспортируются.
* Новый объект не удается подготовить, если в пространстве соединителя уже существует промежуточное удаление с таким же DN.
* Некоторые объекты отмечаются для синхронизации при синхронизации изменений, хотя для объекта нет промежуточных изменений.
* При принудительной синхронизации паролей также удаляется список предпочтительных контроллеров доменов.
* В CSExportAnalyzer возникают проблемы с некоторыми состояниями объектов.

**Новые функции:**

* Соединение теперь может подключаться к любому (ANY) типу объекта в MV.

## <a name="104850222"></a>1.0.485.0222
Дата выпуска: февраль 2015 г.

**Улучшения:**

* Улучшена производительность импорта.

**Исправленные проблемы:**

* При синхронизации паролей учитывается атрибут cloudFiltered, который используется при фильтрации атрибутов. Отфильтрованные объекты больше не будут находиться в области видимости для синхронизации паролей.
* В редких случаях, когда топология содержит очень много контроллеров доменов, синхронизация паролей не работает.
* «Остановленный сервер» при импорте из соединителя Azure AD после активации управления устройствами в Azure AD или Intune.
* Присоединение внешних участников безопасности из нескольких доменов в одном и том же лесу приводит к ошибке неоднозначного соединения.

## <a name="104751202"></a>1.0.475.1202
Дата выпуска: декабрь 2014 г.

**Новые функции:**

* Теперь поддерживается синхронизация паролей с фильтрацией на основе атрибутов. Дополнительные сведения см. в статье [Службы синхронизации Azure AD Connect: настройка фильтрации](active-directory-aadconnectsync-configure-filtering.md).
* Атрибут msDS-ExternalDirectoryObjectID записывается обратно в Active Directory. Эта функция добавляет поддержку приложений Office 365. Она использует OAuth2 для доступа к сетевым и локальным почтовым ящикам в гибридном развертывании Exchange.

**Исправленные проблемы обновления:**

* На сервере доступна более новая версия помощника по входу.
* Для установки Azure AD Sync использовался пользовательский путь.
* Недопустимый критерий пользовательского соединения блокирует обновление.

**Другие исправления:**

* Исправлены шаблоны для Office Pro Plus.
* Исправлены проблемы с установкой, связанные с именами пользователей, которые начинаются с дефиса.
* Исправлена потеря параметра sourceAnchor при втором запуске мастера установки.
* Исправлена трассировка ETW для синхронизации паролей.

## <a name="104701023"></a>1.0.470.1023
Дата выпуска: октябрь 2014 г.

**Новые функции:**

* Синхронизация паролей из нескольких локальных каталогов Active Directory в Azure AD.
* Локализованный пользовательский интерфейс установки для всех языков Windows Server.

**Обновление с версии AADSync 1.0 GA**

Если у вас уже установлена служба Azure AD Sync и вы изменили какое-либо из стандартных правил синхронизации, необходимо выполнить еще один дополнительный шаг. После обновления до выпуска 1.0.470.1023 измененные вами правила синхронизации дублируются. Для каждого измененного правила синхронизации сделайте следующее.

1.  Найдите измененное правило синхронизации и запишите изменения.
* Удалите правило синхронизации.
* Найдите новое правило синхронизации, созданное службой Azure AD Sync, и повторно внесите изменения.

**Разрешения для учетной записи Active Directory**

Учетной записи Active Directory необходимо предоставить дополнительные разрешения, чтобы она могла считывать хэши паролей из среды Active Directory. Предоставляемые разрешения называются "Репликация изменений каталога" и "Репликация всех изменений каталога". Для чтения хэшей паролей требуются оба разрешения.

## <a name="104190911"></a>1.0.419.0911
Дата выпуска: сентябрь 2014 г.

**Первоначальный выпуск Azure AD Sync.**

## <a name="next-steps"></a>Дальнейшие действия
Узнайте больше об [интеграции локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md).
