---
title: "Соединитель PowerShell | Документация Майкрософт"
description: "В этой статье описана настройка соединителя Windows PowerShell корпорации Майкрософт."
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 6dba8e34-a874-4ff0-90bc-bd2b0a4199b5
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 0e5ccf5a38072e31d85bbc63eb0c608b0c34cfc2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="windows-powershell-connector-technical-reference"></a><span data-ttu-id="1450d-103">Технический справочник по соединителю Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1450d-103">Windows PowerShell Connector technical reference</span></span>
<span data-ttu-id="1450d-104">В этой статье описан соединитель Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-104">This article describes the Windows PowerShell Connector.</span></span> <span data-ttu-id="1450d-105">Статья относится к следующим продуктам:</span><span class="sxs-lookup"><span data-stu-id="1450d-105">The article applies to the following products:</span></span>

* <span data-ttu-id="1450d-106">Microsoft Identity Manager 2016 (MIM2016);</span><span class="sxs-lookup"><span data-stu-id="1450d-106">Microsoft Identity Manager 2016 (MIM2016)</span></span>
* <span data-ttu-id="1450d-107">Forefront Identity Manager 2010 R2 (FIM2010R2).</span><span class="sxs-lookup"><span data-stu-id="1450d-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span></span>
  * <span data-ttu-id="1450d-108">Необходимо установить исправление 4.1.3671.0 или более позднюю версию ( [KB3092178](https://support.microsoft.com/kb/3092178)).</span><span class="sxs-lookup"><span data-stu-id="1450d-108">Must use hotfix 4.1.3671.0 or later [KB3092178](https://support.microsoft.com/kb/3092178).</span></span>

<span data-ttu-id="1450d-109">Для MIM2016 и FIM2010R2 соединитель можно скачать из [Центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkId=717495).</span><span class="sxs-lookup"><span data-stu-id="1450d-109">For MIM2016 and FIM2010R2, the Connector is available as a download from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=717495).</span></span>

## <a name="overview-of-the-powershell-connector"></a><span data-ttu-id="1450d-110">Общие сведения о соединителе PowerShell</span><span class="sxs-lookup"><span data-stu-id="1450d-110">Overview of the PowerShell Connector</span></span>
<span data-ttu-id="1450d-111">Соединитель PowerShell позволяет интегрировать службу синхронизации с внешними системами, которые предоставляют API-интерфейсы на основе Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-111">The PowerShell Connector enables you to integrate the synchronization service with external systems that offer Windows PowerShell based APIs.</span></span> <span data-ttu-id="1450d-112">Соединитель обеспечивает связь между возможностями платформы расширяемого агента управления подключением 2 (ECMA2) на основе вызова и Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-112">The connector provides a bridge between the capabilities of the call-based extensible connectivity management agent 2 (ECMA2) framework and Windows PowerShell.</span></span> <span data-ttu-id="1450d-113">Дополнительные сведения о платформе ECMA см. в разделе [Справочник по расширяемому агенту управления подключением 2.2](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span><span class="sxs-lookup"><span data-stu-id="1450d-113">For more information about the ECMA framework, see the [Extensible Connectivity 2.2 Management Agent Reference](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="1450d-114">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="1450d-114">Prerequisites</span></span>
<span data-ttu-id="1450d-115">Прежде чем использовать соединитель, установите на сервере синхронизации такие компоненты:</span><span class="sxs-lookup"><span data-stu-id="1450d-115">Before you use the Connector, make sure you have the following on the synchronization server:</span></span>

* <span data-ttu-id="1450d-116">Microsoft .NET Framework, начиная с версии 4.5.2.</span><span class="sxs-lookup"><span data-stu-id="1450d-116">Microsoft .NET 4.5.2 Framework or later</span></span>
* <span data-ttu-id="1450d-117">Windows PowerShell 2.0, 3.0 или 4.0.</span><span class="sxs-lookup"><span data-stu-id="1450d-117">Windows PowerShell 2.0, 3.0, or 4.0</span></span>

<span data-ttu-id="1450d-118">Политику выполнения на сервере службы синхронизации необходимо настроить для выполнения сценариев Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-118">The execution policy on the Synchronization Service server must be configured to allow the connector to run Windows PowerShell scripts.</span></span> <span data-ttu-id="1450d-119">Если скрипты, выполняющиеся соединителем, не снабжены цифровой подписью, настройте политику выполнения с помощью следующей команды: </span><span class="sxs-lookup"><span data-stu-id="1450d-119">Unless the scripts the connector runs are digitally signed, configure the execution policy by running this command:</span></span>  
`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned`

## <a name="create-a-new-connector"></a><span data-ttu-id="1450d-120">Создание нового соединителя</span><span class="sxs-lookup"><span data-stu-id="1450d-120">Create a new Connector</span></span>
<span data-ttu-id="1450d-121">Чтобы создать в службе синхронизации соединитель Windows PowerShell, необходимо задать ряд сценариев Windows PowerShell, выполняющих шаги по запросу службы синхронизации.</span><span class="sxs-lookup"><span data-stu-id="1450d-121">To create a Windows PowerShell connector in the synchronization service, you must provide a series of Windows PowerShell scripts that execute the steps requested by the synchronization service.</span></span> <span data-ttu-id="1450d-122">Выбор скриптов для реализации зависит от источника данных, к которому будет подключаться система, и требуемых функций.</span><span class="sxs-lookup"><span data-stu-id="1450d-122">Depending on the data source you connect to and the functionality you require, the scripts you must implement varies.</span></span> <span data-ttu-id="1450d-123">В этом разделе описаны все скрипты, которые могут быть реализованы по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="1450d-123">This section outlines each of the scripts that can be implemented and when they are required.</span></span>

<span data-ttu-id="1450d-124">Соединитель Windows PowerShell предназначен для хранения всех скриптов в базе данных службы синхронизации.</span><span class="sxs-lookup"><span data-stu-id="1450d-124">The Windows PowerShell connector is designed to store each of the scripts inside the Synchronization Service database.</span></span> <span data-ttu-id="1450d-125">Хотя можно выполнять скрипты, которые хранятся в файловой системе, гораздо проще вставить текст каждого скрипта непосредственно в конфигурацию соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-125">While it is possible to run scripts that are stored on the file system, it is easier to insert the body of each script directly in to the connector’s configuration.</span></span>

<span data-ttu-id="1450d-126">Чтобы создать соединитель PowerShell, в **Synchronization Service** (Служба синхронизации) последовательно выберите элементы **Management Agent** (Агент управления)и **Create** (Создать).</span><span class="sxs-lookup"><span data-stu-id="1450d-126">To Create a PowerShell connector, in **Synchronization Service** select **Management Agent** and **Create**.</span></span> <span data-ttu-id="1450d-127">Выберите соединитель **PowerShell (Microsoft)** .</span><span class="sxs-lookup"><span data-stu-id="1450d-127">Select the **PowerShell (Microsoft)** Connector.</span></span>

![Создание соединителя](./media/active-directory-aadconnectsync-connector-powershell/createconnector.png)

### <a name="connectivity"></a><span data-ttu-id="1450d-129">Соединение</span><span class="sxs-lookup"><span data-stu-id="1450d-129">Connectivity</span></span>
<span data-ttu-id="1450d-130">Задайте параметры конфигурации для подключения к удаленной системе.</span><span class="sxs-lookup"><span data-stu-id="1450d-130">Supply configuration parameters for connecting to a remote system.</span></span> <span data-ttu-id="1450d-131">Эти значения будут безопасно храниться в службе синхронизации и станут доступны для скриптов Windows PowerShell при запуске соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-131">These values are securely stored by the Synchronization Service and made available to your Windows PowerShell scripts when the connector is run.</span></span>

![Соединение](./media/active-directory-aadconnectsync-connector-powershell/connectivity.png)

<span data-ttu-id="1450d-133">Можно настроить указанные ниже параметры подключения.</span><span class="sxs-lookup"><span data-stu-id="1450d-133">You can configure the following Connectivity parameters:</span></span>

<span data-ttu-id="1450d-134">**Соединение**</span><span class="sxs-lookup"><span data-stu-id="1450d-134">**Connectivity**</span></span>

| <span data-ttu-id="1450d-135">Параметр</span><span class="sxs-lookup"><span data-stu-id="1450d-135">Parameter</span></span> | <span data-ttu-id="1450d-136">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="1450d-136">Default Value</span></span> | <span data-ttu-id="1450d-137">Назначение</span><span class="sxs-lookup"><span data-stu-id="1450d-137">Purpose</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-138">сервер;</span><span class="sxs-lookup"><span data-stu-id="1450d-138">Server</span></span> |<Blank> |<span data-ttu-id="1450d-139">Имя сервера, к которому будет подключен соединитель.</span><span class="sxs-lookup"><span data-stu-id="1450d-139">Server name that the connector should connect to.</span></span> |
| <span data-ttu-id="1450d-140">Домен</span><span class="sxs-lookup"><span data-stu-id="1450d-140">Domain</span></span> |<Blank> |<span data-ttu-id="1450d-141">Домен учетных данных, который будет сохранен для использования при запуске соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-141">Domain of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="1450d-142">Пользователь</span><span class="sxs-lookup"><span data-stu-id="1450d-142">User</span></span> |<Blank> |<span data-ttu-id="1450d-143">Имя пользователя учетных данных, которое будет сохранено для использования при запуске соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-143">Username of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="1450d-144">Пароль</span><span class="sxs-lookup"><span data-stu-id="1450d-144">Password</span></span> |<Blank> |<span data-ttu-id="1450d-145">Пароль учетных данных, который будет сохранен для использования при запуске соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-145">Password of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="1450d-146">Выполнять олицетворение учетной записи соединителя</span><span class="sxs-lookup"><span data-stu-id="1450d-146">Impersonate Connector Account</span></span> |<span data-ttu-id="1450d-147">Ложь</span><span class="sxs-lookup"><span data-stu-id="1450d-147">False</span></span> |<span data-ttu-id="1450d-148">Если задано значение true, служба синхронизации выполняет скрипты Windows PowerShell в контексте указанных учетных данных.</span><span class="sxs-lookup"><span data-stu-id="1450d-148">When true, the synchronization service runs the Windows PowerShell scripts in the context of the credentials supplied.</span></span> <span data-ttu-id="1450d-149">По возможности вместо олицетворения рекомендуется использовать параметр **$Credentials**, передаваемый в каждый сценарий.</span><span class="sxs-lookup"><span data-stu-id="1450d-149">When possible, it is recommended that the **$Credentials** parameter is passed to each script is used instead of impersonation.</span></span> <span data-ttu-id="1450d-150">Подробные сведения о дополнительных разрешениях для использования этого параметра см. в разделе [Дополнительные настройки для олицетворения](#additional-configuration-for-impersonation).</span><span class="sxs-lookup"><span data-stu-id="1450d-150">For more information on additional permissions that are required to use this option, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="1450d-151">Загрузить профиль пользователя при олицетворении</span><span class="sxs-lookup"><span data-stu-id="1450d-151">Load User Profile When Impersonating</span></span> |<span data-ttu-id="1450d-152">Ложь</span><span class="sxs-lookup"><span data-stu-id="1450d-152">False</span></span> |<span data-ttu-id="1450d-153">Указывает Windows загрузить профиль пользователя учетных данных для соединителя при олицетворении пользователя.</span><span class="sxs-lookup"><span data-stu-id="1450d-153">Instructs Windows to load the user profile of the connector’s credentials during impersonation.</span></span> <span data-ttu-id="1450d-154">Если олицетворяемый пользователь использует перемещаемый профиль, соединитель не загрузит этот профиль.</span><span class="sxs-lookup"><span data-stu-id="1450d-154">If the impersonated user has a roaming profile, the connector does not load the roaming profile.</span></span> <span data-ttu-id="1450d-155">Подробные сведения о дополнительных разрешениях для использования этого параметра см. в разделе [Дополнительные настройки для олицетворения](#additional-configuration-for-impersonation).</span><span class="sxs-lookup"><span data-stu-id="1450d-155">For more information on additional permissions that are required to use this parameter, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="1450d-156">Тип входа при олицетворении</span><span class="sxs-lookup"><span data-stu-id="1450d-156">Logon Type When Impersonating</span></span> |<span data-ttu-id="1450d-157">None</span><span class="sxs-lookup"><span data-stu-id="1450d-157">None</span></span> |<span data-ttu-id="1450d-158">Тип входа при олицетворении.</span><span class="sxs-lookup"><span data-stu-id="1450d-158">Logon type during impersonation.</span></span> <span data-ttu-id="1450d-159">Дополнительные сведения см. в документации по [dwLogonType][dw].</span><span class="sxs-lookup"><span data-stu-id="1450d-159">For more information, see the [dwLogonType][dw] documentation.</span></span> |
| <span data-ttu-id="1450d-160">Только для подписанных сценариев</span><span class="sxs-lookup"><span data-stu-id="1450d-160">Signed Scripts Only</span></span> |<span data-ttu-id="1450d-161">Ложь</span><span class="sxs-lookup"><span data-stu-id="1450d-161">False</span></span> |<span data-ttu-id="1450d-162">Если установлено значение «истина», соединитель Windows PowerShell проверяет, содержит ли каждый сценарий действительную цифровую подпись.</span><span class="sxs-lookup"><span data-stu-id="1450d-162">If true, the Windows PowerShell connector validates that each script has a valid digital signature.</span></span> <span data-ttu-id="1450d-163">Если установлено значение «ложь», убедитесь, что для политики выполнения Windows PowerShell на сервере службы синхронизации установлено значение RemoteSigned или Unrestricted.</span><span class="sxs-lookup"><span data-stu-id="1450d-163">If false, ensure that the Synchronization Service server’s Windows PowerShell execution policy is RemoteSigned or Unrestricted.</span></span> |

<span data-ttu-id="1450d-164">**Общий модуль**</span><span class="sxs-lookup"><span data-stu-id="1450d-164">**Common Module**</span></span>  
<span data-ttu-id="1450d-165">Соединитель позволяет хранить в конфигурации общий модуль Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-165">The connector allows you to store a shared Windows PowerShell module in the configuration.</span></span> <span data-ttu-id="1450d-166">При выполнении соединителем скрипта модуль Windows PowerShell извлекается в файловую систему, чтобы он мог импортироваться каждым скриптом.</span><span class="sxs-lookup"><span data-stu-id="1450d-166">When the connector runs a script, the Windows PowerShell module is extracted to the file system so that it can be imported by each script.</span></span>

<span data-ttu-id="1450d-167">Для сценариев импорта, экспорта и синхронизации паролей общий модуль извлекается в папку соединителя MAData.</span><span class="sxs-lookup"><span data-stu-id="1450d-167">For Import, Export, and Password Synchronization scripts, the common module is extracted to the connector’s MAData folder.</span></span> <span data-ttu-id="1450d-168">Для сценариев обнаружения схемы, проверки, иерархии и секций общий модуль извлекается в папку %TEMP%.</span><span class="sxs-lookup"><span data-stu-id="1450d-168">For Schema, Validation, Hierarchy, and Partition discovery scripts, the common module is extracted to the %TEMP% folder.</span></span> <span data-ttu-id="1450d-169">В обоих случаях извлеченный сценарий общего модуля именуется в соответствии с настройкой имени общего модуля сценария.</span><span class="sxs-lookup"><span data-stu-id="1450d-169">In both cases, the extracted Common Module script is named according to the Common Module Script Name setting.</span></span>

<span data-ttu-id="1450d-170">Чтобы загрузить модуль с именем FIMPowerShellConnectorModule.psm1 из папки MAData, воспользуйтесь следующим оператором: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="1450d-170">To load a module called FIMPowerShellConnectorModule.psm1 from the MAData folder, use the following statement: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="1450d-171">Чтобы загрузить модуль с именем FIMPowerShellConnectorModule.psm1 из папки %TEMP%, воспользуйтесь следующим оператором: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="1450d-171">To load a module called FIMPowerShellConnectorModule.psm1 from the %TEMP% folder, use the following statement: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="1450d-172">**Проверка параметров**</span><span class="sxs-lookup"><span data-stu-id="1450d-172">**Parameter Validation**</span></span>  
<span data-ttu-id="1450d-173">Сценарий проверки является необязательным сценарием Windows PowerShell, который может использоваться для проверки допустимости параметров конфигурации соединителя, установленных администратором.</span><span class="sxs-lookup"><span data-stu-id="1450d-173">The Validation Script is an optional Windows PowerShell script that can be used to ensure that connector configuration parameters supplied by the administrator are valid.</span></span> <span data-ttu-id="1450d-174">Как правило, этот скрипт используется для проверки сервера и учетных данных, а также параметров подключения.</span><span class="sxs-lookup"><span data-stu-id="1450d-174">Validating server, connection credentials, and connectivity parameters are common usages of the validation script.</span></span> <span data-ttu-id="1450d-175">Сценарий проверки вызывается после изменения указанных ниже вкладок и диалоговых окон.</span><span class="sxs-lookup"><span data-stu-id="1450d-175">The validation script is called after the following tabs and dialogs are modified:</span></span>

* <span data-ttu-id="1450d-176">Соединение</span><span class="sxs-lookup"><span data-stu-id="1450d-176">Connectivity</span></span>
* <span data-ttu-id="1450d-177">Глобальные параметры</span><span class="sxs-lookup"><span data-stu-id="1450d-177">Global Parameters</span></span>
* <span data-ttu-id="1450d-178">Конфигурация секции</span><span class="sxs-lookup"><span data-stu-id="1450d-178">Partition Configuration</span></span>

<span data-ttu-id="1450d-179">Сценарий проверки принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-179">The validation script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-180">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-180">Name</span></span> | <span data-ttu-id="1450d-181">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-181">Data Type</span></span> | <span data-ttu-id="1450d-182">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-182">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-183">ConfigParameterPage</span><span class="sxs-lookup"><span data-stu-id="1450d-183">ConfigParameterPage</span></span> |<span data-ttu-id="1450d-184">[ConfigParameterPage][cpp]</span><span class="sxs-lookup"><span data-stu-id="1450d-184">[ConfigParameterPage][cpp]</span></span> |<span data-ttu-id="1450d-185">Вкладка или диалоговое окно «Конфигурация», где был активирован запрос на проверку.</span><span class="sxs-lookup"><span data-stu-id="1450d-185">The configuration tab or dialog that triggered the validation request.</span></span> |
| <span data-ttu-id="1450d-186">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-186">ConfigParameters</span></span> |<span data-ttu-id="1450d-187">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-188">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-188">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-189">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-189">Credential</span></span> |<span data-ttu-id="1450d-190">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-190">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-191">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-191">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="1450d-192">Сценарий проверки должен вернуть в конвейер один объект ParameterValidationResult.</span><span class="sxs-lookup"><span data-stu-id="1450d-192">The validation script should return a single ParameterValidationResult object to the pipeline.</span></span>

<span data-ttu-id="1450d-193">**Обнаружение схемы**</span><span class="sxs-lookup"><span data-stu-id="1450d-193">**Schema Discovery**</span></span>  
<span data-ttu-id="1450d-194">Сценарий обнаружения схемы является обязательным для использования.</span><span class="sxs-lookup"><span data-stu-id="1450d-194">The Schema Discovery script is mandatory.</span></span> <span data-ttu-id="1450d-195">Этот скрипт возвращает типы и атрибуты объектов, а также ограничения атрибутов, которые служба синхронизации использует при настройке правил потока атрибутов.</span><span class="sxs-lookup"><span data-stu-id="1450d-195">This script returns the object types, attributes, and attribute constraints that the Synchronization Service uses when configuring attribute flow rules.</span></span> <span data-ttu-id="1450d-196">Скрипт обнаружения схемы выполняется во время создания соединителя и заполняет схему соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-196">The Schema Discovery script is run during connector creation and populates the connector’s schema.</span></span> <span data-ttu-id="1450d-197">Он также используется действием "Обновление схемы" в Synchronization Service Manager.</span><span class="sxs-lookup"><span data-stu-id="1450d-197">It is also used by the Refresh Schema action in the Synchronization Service Manager.</span></span>

<span data-ttu-id="1450d-198">Сценарий обнаружения схемы принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-198">The schema discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-199">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-199">Name</span></span> | <span data-ttu-id="1450d-200">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-200">Data Type</span></span> | <span data-ttu-id="1450d-201">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-201">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-202">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-202">ConfigParameters</span></span> |<span data-ttu-id="1450d-203">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-204">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-204">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-205">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-205">Credential</span></span> |<span data-ttu-id="1450d-206">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-206">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-207">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-207">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="1450d-208">Сценарий должен возвращать в конвейер один объект [Schema][schema].</span><span class="sxs-lookup"><span data-stu-id="1450d-208">The script must return a single [Schema][schema] object to the pipeline.</span></span> <span data-ttu-id="1450d-209">Объект Schema состоит из объектов [SchemaType][schemaT], представляющих типы объектов (например, пользователи и группы).</span><span class="sxs-lookup"><span data-stu-id="1450d-209">The Schema object is composed of [SchemaType][schemaT] objects that represent object types (for example: users and groups).</span></span> <span data-ttu-id="1450d-210">Объект SchemaType содержит коллекцию объектов [SchemaAttribute][schemaA], представляющих атрибуты типа (например, имя, фамилия и почтовый адрес).</span><span class="sxs-lookup"><span data-stu-id="1450d-210">The SchemaType object holds a collection of [SchemaAttribute][schemaA] objects that represent the attributes (for example: given name, surname, and postal address) of the type.</span></span>

<span data-ttu-id="1450d-211">**Дополнительные параметры**</span><span class="sxs-lookup"><span data-stu-id="1450d-211">**Additional Parameters**</span></span>  
<span data-ttu-id="1450d-212">Помимо стандартных настроек конфигурации, можно определить дополнительные настраиваемые параметры конфигурации, относящиеся к конкретному экземпляру соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-212">In addition to the standard configuration settings, you can define additional custom configuration settings that are specific to the instance of the Connector.</span></span> <span data-ttu-id="1450d-213">Эти параметры могут быть заданы на уровнях соединителя, секции или этапа выполнения. Доступ к ним можно получить из соответствующего сценария Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-213">These parameters can be specified at the connector, partition, or run step levels and accessed from the relevant Windows PowerShell script.</span></span> <span data-ttu-id="1450d-214">Настраиваемые параметры конфигурации могут храниться в базе данных службы синхронизации в формате обычного текста или в зашифрованном виде.</span><span class="sxs-lookup"><span data-stu-id="1450d-214">Custom configuration settings can be stored in the Synchronization Service database in plain text format or they may be encrypted.</span></span> <span data-ttu-id="1450d-215">Служба синхронизации при необходимости автоматически шифрует и расшифровывает защищенные параметры конфигурации.</span><span class="sxs-lookup"><span data-stu-id="1450d-215">The Synchronization Service automatically encrypts and decrypts secure configuration settings when required.</span></span>

<span data-ttu-id="1450d-216">При установке настраиваемых параметров конфигурации их имена разделяются запятыми (,).</span><span class="sxs-lookup"><span data-stu-id="1450d-216">To specify custom configuration settings, separate the name of each parameter with a comma ( , ).</span></span>

<span data-ttu-id="1450d-217">Чтобы получить доступ к настраиваемым параметрам конфигурации из сценария, необходимо добавить к имени суффикс, содержащий символ подчеркивания (\_) и область параметра (Global, Partition или RunStep).</span><span class="sxs-lookup"><span data-stu-id="1450d-217">To access custom configuration settings from a script, you must suffix the name with an underscore ( \_ ) and the scope of the parameter (Global, Partition, or RunStep).</span></span> <span data-ttu-id="1450d-218">Например, чтобы получить доступ к параметру Global FileName, используйте следующий фрагмент кода: `$ConfigurationParameters["FileName_Global"].Value`</span><span class="sxs-lookup"><span data-stu-id="1450d-218">For example, to access the Global FileName parameter, use this code snippet: `$ConfigurationParameters["FileName_Global"].Value`</span></span>

### <a name="capabilities"></a><span data-ttu-id="1450d-219">Возможности</span><span class="sxs-lookup"><span data-stu-id="1450d-219">Capabilities</span></span>
<span data-ttu-id="1450d-220">На вкладке возможностей конструктора агента управления определяются поведение и функции соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-220">The capabilities tab of the Management Agent Designer defines the behavior and functionality of the connector.</span></span> <span data-ttu-id="1450d-221">Выбранные на этой вкладке параметры после создания соединителя изменить нельзя.</span><span class="sxs-lookup"><span data-stu-id="1450d-221">The selections made on this tab cannot be modified when the connector has been created.</span></span> <span data-ttu-id="1450d-222">В таблице ниже перечислены параметры функций.</span><span class="sxs-lookup"><span data-stu-id="1450d-222">This table lists the capability settings.</span></span>

![Возможности](./media/active-directory-aadconnectsync-connector-powershell/capabilities.png)

| <span data-ttu-id="1450d-224">Функция</span><span class="sxs-lookup"><span data-stu-id="1450d-224">Capability</span></span> | <span data-ttu-id="1450d-225">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-225">Description</span></span> |
| --- | --- |
| <span data-ttu-id="1450d-226">[Стиль различающегося имени][dnstyle]</span><span class="sxs-lookup"><span data-stu-id="1450d-226">[Distinguished Name Style][dnstyle]</span></span> |<span data-ttu-id="1450d-227">Указывает, поддерживает ли соединитель различающиеся имена, и, если это так, определяет их стили.</span><span class="sxs-lookup"><span data-stu-id="1450d-227">Indicates if the connector supports distinguished names and if so, what style.</span></span> |
| <span data-ttu-id="1450d-228">[Тип экспорта][exportT]</span><span class="sxs-lookup"><span data-stu-id="1450d-228">[Export Type][exportT]</span></span> |<span data-ttu-id="1450d-229">Определяет тип объектов, которые представлены в сценарии экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-229">Determines the type of objects that are presented to the Export script.</span></span> <li><span data-ttu-id="1450d-230">AttributeReplace — включает полный набор значений для многозначного атрибута при его изменении.</span><span class="sxs-lookup"><span data-stu-id="1450d-230">AttributeReplace – includes the full set of values for a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="1450d-231">AttributeUpdate — включает только изменения атрибута с несколькими значениями при его изменении.</span><span class="sxs-lookup"><span data-stu-id="1450d-231">AttributeUpdate – includes only the deltas to a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="1450d-232">MultivaluedReferenceAttributeUpdate — включает полный набор значений для не являющихся ссылками многозначных атрибутов и только изменения для многозначных ссылочных атрибутов.</span><span class="sxs-lookup"><span data-stu-id="1450d-232">MultivaluedReferenceAttributeUpdate - includes a full set of values for non-reference multi-valued attributes and only deltas for multi-valued reference attributes.</span></span></li><li><span data-ttu-id="1450d-233">ObjectReplace — включает все атрибуты объекта при изменении любого атрибута.</span><span class="sxs-lookup"><span data-stu-id="1450d-233">ObjectReplace – includes all attributes for an object when any attribute changes</span></span></li> |
| <span data-ttu-id="1450d-234">[Нормализация данных][DataNorm]</span><span class="sxs-lookup"><span data-stu-id="1450d-234">[Data Normalization][DataNorm]</span></span> |<span data-ttu-id="1450d-235">Указывает службе синхронизации нормализовать привязки атрибутов, перед тем как они будут заданы в сценариях.</span><span class="sxs-lookup"><span data-stu-id="1450d-235">Instructs the Synchronization Service to normalize anchor attributes before they are provided to scripts.</span></span> |
| <span data-ttu-id="1450d-236">[Подтверждение объекта][oconf]</span><span class="sxs-lookup"><span data-stu-id="1450d-236">[Object Confirmation][oconf]</span></span> |<span data-ttu-id="1450d-237">Настраивает поведение при ожидании импорта в службу синхронизации.</span><span class="sxs-lookup"><span data-stu-id="1450d-237">Configures the pending import behavior in the Synchronization Service.</span></span> <li><span data-ttu-id="1450d-238">Normal — поведение по умолчанию, при котором предполагается, что все экспортированные изменения должны быть подтверждены посредством импорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-238">Normal – default behavior that expects all exported changes to be confirmed via import</span></span></li><li><span data-ttu-id="1450d-239">NoDeleteConfirmation — при удалении объекта ожидание импорта отсутствует.</span><span class="sxs-lookup"><span data-stu-id="1450d-239">NoDeleteConfirmation – when an object is deleted, there is no pending import generated.</span></span></li><li><span data-ttu-id="1450d-240">NoAddAndDeleteConfirmation — при создании или удалении объекта ожидание импорта отсутствует.</span><span class="sxs-lookup"><span data-stu-id="1450d-240">NoAddAndDeleteConfirmation – when an object is created or deleted, there is no pending import generated.</span></span></li> |
| <span data-ttu-id="1450d-241">Использование DN как привязки</span><span class="sxs-lookup"><span data-stu-id="1450d-241">Use DN as Anchor</span></span> |<span data-ttu-id="1450d-242">Если для стиля различающегося имени установлено значение LDAP, атрибут привязки для пространства соединителя также является различающимся именем.</span><span class="sxs-lookup"><span data-stu-id="1450d-242">If the Distinguished Name Style is set to LDAP, the anchor attribute for the connector space is also the distinguished name.</span></span> |
| <span data-ttu-id="1450d-243">Параллельная работа нескольких соединителей</span><span class="sxs-lookup"><span data-stu-id="1450d-243">Concurrent Operations of Several Connectors</span></span> |<span data-ttu-id="1450d-244">Если этот флажок установлен, можно одновременно запустить несколько соединителей Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-244">When checked, multiple Windows PowerShell connectors can run simultaneously.</span></span> |
| <span data-ttu-id="1450d-245">Разделы</span><span class="sxs-lookup"><span data-stu-id="1450d-245">Partitions</span></span> |<span data-ttu-id="1450d-246">Если этот флажок установлен, соединитель будет поддерживать несколько секций и функцию их обнаружения.</span><span class="sxs-lookup"><span data-stu-id="1450d-246">When checked, the connector supports multiple partitions and partition discovery.</span></span> |
| <span data-ttu-id="1450d-247">Иерархия</span><span class="sxs-lookup"><span data-stu-id="1450d-247">Hierarchy</span></span> |<span data-ttu-id="1450d-248">Если этот флажок установлен, соединитель будет поддерживать иерархическую структуру стиля LDAP.</span><span class="sxs-lookup"><span data-stu-id="1450d-248">When checked, the connector supports an LDAP style hierarchical structure.</span></span> |
| <span data-ttu-id="1450d-249">Включить импорт</span><span class="sxs-lookup"><span data-stu-id="1450d-249">Enable Import</span></span> |<span data-ttu-id="1450d-250">Если этот флажок установлен, соединитель импортирует данные с помощью скриптов импорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-250">When checked, the connector imports data via import scripts.</span></span> |
| <span data-ttu-id="1450d-251">Включить импорт изменений</span><span class="sxs-lookup"><span data-stu-id="1450d-251">Enable Delta Import</span></span> |<span data-ttu-id="1450d-252">Если этот флажок установлен, соединитель может подавать в сценарии импорта запросы на изменения.</span><span class="sxs-lookup"><span data-stu-id="1450d-252">When checked, the connector can request deltas from the import scripts.</span></span> |
| <span data-ttu-id="1450d-253">Включить экспорт</span><span class="sxs-lookup"><span data-stu-id="1450d-253">Enable Export</span></span> |<span data-ttu-id="1450d-254">Если этот флажок установлен, соединитель экспортирует данные с помощью скриптов экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-254">When checked, the connector exports data via export scripts.</span></span> |
| <span data-ttu-id="1450d-255">Включить полный экспорт</span><span class="sxs-lookup"><span data-stu-id="1450d-255">Enable Full Export</span></span> |<span data-ttu-id="1450d-256">Если этот флажок установлен, сценарии экспорта будут поддерживать экспорт всего пространства соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-256">When checked, the export scripts support exporting the entire connector space.</span></span> <span data-ttu-id="1450d-257">Для использования этого параметра должен быть установлен флажок «Включить экспорт».</span><span class="sxs-lookup"><span data-stu-id="1450d-257">To use this option, Enable Export must also be checked.</span></span> |
| <span data-ttu-id="1450d-258">Без ссылочных значений на первом этапе экспорта</span><span class="sxs-lookup"><span data-stu-id="1450d-258">No Reference Values In First Export Pass</span></span> |<span data-ttu-id="1450d-259">Если этот флажок установлен, ссылочные атрибуты экспортируются на втором этапе экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-259">When checked, reference attributes are exported in a second export pass.</span></span> |
| <span data-ttu-id="1450d-260">Включить переименование объекта</span><span class="sxs-lookup"><span data-stu-id="1450d-260">Enable Object Rename</span></span> |<span data-ttu-id="1450d-261">Если этот флажок установлен, различающиеся имена можно изменить.</span><span class="sxs-lookup"><span data-stu-id="1450d-261">When checked, distinguished names can be modified.</span></span> |
| <span data-ttu-id="1450d-262">Удаление и добавление как замена</span><span class="sxs-lookup"><span data-stu-id="1450d-262">Delete-Add As Replace</span></span> |<span data-ttu-id="1450d-263">Если этот флажок установлен, операции удаления и добавления экспортируются как одна операция замены.</span><span class="sxs-lookup"><span data-stu-id="1450d-263">When checked, delete-add operations are exported as a single replacement.</span></span> |
| <span data-ttu-id="1450d-264">Включить операции паролей</span><span class="sxs-lookup"><span data-stu-id="1450d-264">Enable Password Operations</span></span> |<span data-ttu-id="1450d-265">Если этот флажок установлен, поддерживаются сценарии синхронизации паролей.</span><span class="sxs-lookup"><span data-stu-id="1450d-265">When checked, password synchronization scripts are supported.</span></span> |
| <span data-ttu-id="1450d-266">Включить пароль для экспорта на первом этапе</span><span class="sxs-lookup"><span data-stu-id="1450d-266">Enable Export Password in First Pass</span></span> |<span data-ttu-id="1450d-267">Если этот флажок установлен, пароли, заданные во время подготовки, экспортируются при создании объекта.</span><span class="sxs-lookup"><span data-stu-id="1450d-267">When checked, passwords set during provisioning are exported when the object is created.</span></span> |

### <a name="global-parameters"></a><span data-ttu-id="1450d-268">Глобальные параметры</span><span class="sxs-lookup"><span data-stu-id="1450d-268">Global Parameters</span></span>
<span data-ttu-id="1450d-269">Скрипты Windows PowerShell, которые запускаются с помощью соединителя, можно настроить на вкладке "Глобальные параметры" в конструкторе агента управления.</span><span class="sxs-lookup"><span data-stu-id="1450d-269">The Global Parameters tab in the Management Agent Designer enables you to configure the Windows PowerShell scripts that are run by the connector.</span></span> <span data-ttu-id="1450d-270">Можно также настроить глобальные значения настраиваемых параметров конфигурации на вкладке "Подключение".</span><span class="sxs-lookup"><span data-stu-id="1450d-270">You can also configure global values for custom configuration settings defined on the Connectivity tab.</span></span>

<span data-ttu-id="1450d-271">**Обнаружение секции**</span><span class="sxs-lookup"><span data-stu-id="1450d-271">**Partition Discovery**</span></span>  
<span data-ttu-id="1450d-272">Секция — отдельное пространство имен в пределах одной общей схемы.</span><span class="sxs-lookup"><span data-stu-id="1450d-272">A partition is a separate namespace within one shared schema.</span></span> <span data-ttu-id="1450d-273">Например, в Active Directory каждый домен представляет собой секцию в пределах одного леса.</span><span class="sxs-lookup"><span data-stu-id="1450d-273">For example, in Active Directory every domain is a partition within one forest.</span></span> <span data-ttu-id="1450d-274">Секция является логической группой для операций импорта и экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-274">A partition is the logical grouping for import and export operations.</span></span> <span data-ttu-id="1450d-275">Импорт и экспорт разбиваются на секции по контексту, и все операции выполняются в этом контексте.</span><span class="sxs-lookup"><span data-stu-id="1450d-275">Import and Export have partition as a context and all operations happens in this context.</span></span> <span data-ttu-id="1450d-276">Секции должны представлять иерархию в LDAP.</span><span class="sxs-lookup"><span data-stu-id="1450d-276">Partitions are supposed to represent a hierarchy in LDAP.</span></span> <span data-ttu-id="1450d-277">Различающееся имя секции используется при импорте. Оно позволяет проверить, находятся ли все возвращаемые объекты в пределах секции.</span><span class="sxs-lookup"><span data-stu-id="1450d-277">The distinguished name of a partition is used in import to verify that all returned objects are within the scope of a partition.</span></span> <span data-ttu-id="1450d-278">Различающееся имя секции также используется при подготовке передачи из метавселенной в пространство соединителя, чтобы определить, с какой секцией должен быть связан объект во время экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-278">The partition distinguished name is also used during provisioning from the metaverse to the connector space to determine the partition an object should be associated with during export.</span></span>

<span data-ttu-id="1450d-279">Сценарий обнаружения секции принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-279">The partition discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-280">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-280">Name</span></span> | <span data-ttu-id="1450d-281">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-281">Data Type</span></span> | <span data-ttu-id="1450d-282">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-282">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-283">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-283">ConfigParameters</span></span> |<span data-ttu-id="1450d-284">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-285">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-285">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-286">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-286">Credential</span></span> |<span data-ttu-id="1450d-287">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-287">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-288">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-288">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="1450d-289">Сценарий должен возвращать в конвейер отдельный объект [Partition][part] или объект List[T] с объектами Partition.</span><span class="sxs-lookup"><span data-stu-id="1450d-289">The script must return a either a single [Partition][part] object or a List[T] of Partition objects to the pipeline.</span></span>

<span data-ttu-id="1450d-290">**Обнаружение иерархии**</span><span class="sxs-lookup"><span data-stu-id="1450d-290">**Hierarchy Discovery**</span></span>  
<span data-ttu-id="1450d-291">Сценарий обнаружения иерархии используется только в том случае, когда различающееся имя стиля возможностей является LDAP.</span><span class="sxs-lookup"><span data-stu-id="1450d-291">The hierarchy discovery script is only used when the Distinguished Name Style capability is LDAP.</span></span> <span data-ttu-id="1450d-292">Скрипт позволяет просматривать и выбирать контейнеры, которые будут учитываться в области операций импорта и экспорта или вне ее.</span><span class="sxs-lookup"><span data-stu-id="1450d-292">The script is used to allow you to browse and select a set of containers that is considered in or out of scope for import and export operations.</span></span> <span data-ttu-id="1450d-293">Сценарий должен указывать только список узлов, которые являются непосредственными дочерними элементами корневого узла, заданного для сценария.</span><span class="sxs-lookup"><span data-stu-id="1450d-293">The script should only provide a list of nodes that are direct children of the root node supplied to the script.</span></span>

<span data-ttu-id="1450d-294">Сценарий обнаружения иерархии принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-294">The hierarchy discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-295">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-295">Name</span></span> | <span data-ttu-id="1450d-296">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-296">Data Type</span></span> | <span data-ttu-id="1450d-297">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-297">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-298">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-298">ConfigParameters</span></span> |<span data-ttu-id="1450d-299">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-300">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-300">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-301">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-301">Credential</span></span> |<span data-ttu-id="1450d-302">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-302">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-303">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-303">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-304">ParentNode</span><span class="sxs-lookup"><span data-stu-id="1450d-304">ParentNode</span></span> |<span data-ttu-id="1450d-305">[HierarchyNode][hn]</span><span class="sxs-lookup"><span data-stu-id="1450d-305">[HierarchyNode][hn]</span></span> |<span data-ttu-id="1450d-306">Корневой узел иерархии, в которой сценарий должен возвращать непосредственные дочерние элементы.</span><span class="sxs-lookup"><span data-stu-id="1450d-306">The root node of the hierarchy under which the script should return direct children.</span></span> |

<span data-ttu-id="1450d-307">Сценарий должен возвращать в конвейер один дочерний объект HierarchyNode или список дочерних объектов HierarchyNode.</span><span class="sxs-lookup"><span data-stu-id="1450d-307">The script must return a either a single child HierarchyNode object or a List[T] of child HierarchyNode objects to the pipeline.</span></span>

#### <a name="import"></a><span data-ttu-id="1450d-308">Импорт</span><span class="sxs-lookup"><span data-stu-id="1450d-308">Import</span></span>
<span data-ttu-id="1450d-309">Соединители, которые поддерживают операции импорта, должны реализовать три сценария.</span><span class="sxs-lookup"><span data-stu-id="1450d-309">Connectors that support import operations must implement three scripts.</span></span>

<span data-ttu-id="1450d-310">**Начало импорта**</span><span class="sxs-lookup"><span data-stu-id="1450d-310">**Begin Import**</span></span>  
<span data-ttu-id="1450d-311">Сценарий начала импорта реализуется в начале этапа выполнения импорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-311">The begin import script is run at the beginning of an import run step.</span></span> <span data-ttu-id="1450d-312">На этом этапе можно установить подключение к исходной системе и выполнить все необходимые подготовительные действия перед импортом данных из подключенной системы.</span><span class="sxs-lookup"><span data-stu-id="1450d-312">During this step, you can establish a connection to the source system and do preparatory steps before importing data from the connected system.</span></span>

<span data-ttu-id="1450d-313">Сценарий начала импорта принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-313">The begin import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-314">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-314">Name</span></span> | <span data-ttu-id="1450d-315">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-315">Data Type</span></span> | <span data-ttu-id="1450d-316">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-316">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-317">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-317">ConfigParameters</span></span> |<span data-ttu-id="1450d-318">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-319">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-319">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-320">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-320">Credential</span></span> |<span data-ttu-id="1450d-321">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-321">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-322">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-322">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-323">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-323">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="1450d-324">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-324">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="1450d-325">Информирует сценарий о типе запуска импорта (измененный или полный), секции, иерархии, водяном знаке и ожидаемом размере страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-325">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="1450d-326">Типы</span><span class="sxs-lookup"><span data-stu-id="1450d-326">Types</span></span> |<span data-ttu-id="1450d-327">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="1450d-327">[Schema][schema]</span></span> |<span data-ttu-id="1450d-328">Схема для импортируемого пространства соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-328">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="1450d-329">Сценарий должен возвращать в конвейер один объект [OpenImportConnectionResults][oicres], например: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`.</span><span class="sxs-lookup"><span data-stu-id="1450d-329">The script must return a single [OpenImportConnectionResults][oicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span></span>

<span data-ttu-id="1450d-330">**Импорт данных**</span><span class="sxs-lookup"><span data-stu-id="1450d-330">**Import Data**</span></span>  
<span data-ttu-id="1450d-331">Соединитель вызывает сценарий импорта данных, пока сценарий не укажет, что данных для импорта больше нет.</span><span class="sxs-lookup"><span data-stu-id="1450d-331">The import data script is called by the connector until the script indicates that there is no more data to import.</span></span> <span data-ttu-id="1450d-332">Размер страницы соединителя Windows PowerShell составляет 9999 объектов.</span><span class="sxs-lookup"><span data-stu-id="1450d-332">The Windows PowerShell connector has a page size of 9,999 objects.</span></span> <span data-ttu-id="1450d-333">Если скрипт возвращает более 9999 объектов для импорта, должна поддерживаться разбивка на страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-333">If your script returns more than 9,999 objects for import, you must support paging.</span></span> <span data-ttu-id="1450d-334">Соединитель представляет свойство настраиваемых данных, которое можно использовать для хранения водяного знака, чтобы при каждом вызове сценарий импорта данных возобновлял импорт объектов с того момента, на котором он был остановлен.</span><span class="sxs-lookup"><span data-stu-id="1450d-334">The connector exposes a custom data property that you can use to a store a watermark so that each time the import data script is called, your script resumes importing objects where it left off.</span></span>

<span data-ttu-id="1450d-335">Сценарий импорта данных принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-335">The import data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-336">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-336">Name</span></span> | <span data-ttu-id="1450d-337">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-337">Data Type</span></span> | <span data-ttu-id="1450d-338">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-338">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-339">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-339">ConfigParameters</span></span> |<span data-ttu-id="1450d-340">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-341">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-341">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-342">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-342">Credential</span></span> |<span data-ttu-id="1450d-343">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-343">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-344">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-344">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-345">GetImportEntriesRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-345">GetImportEntriesRunStep</span></span> |<span data-ttu-id="1450d-346">[ImportRunStep][irs]</span><span class="sxs-lookup"><span data-stu-id="1450d-346">[ImportRunStep][irs]</span></span> |<span data-ttu-id="1450d-347">Содержит водяной знак (CustomData), который можно использовать во время постраничного импорта и импорта изменений.</span><span class="sxs-lookup"><span data-stu-id="1450d-347">Holds the watermark (CustomData) that can be used during paged imports and delta imports.</span></span> |
| <span data-ttu-id="1450d-348">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-348">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="1450d-349">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-349">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="1450d-350">Информирует сценарий о типе запуска импорта (измененный или полный), секции, иерархии, водяном знаке и ожидаемом размере страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-350">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="1450d-351">Типы</span><span class="sxs-lookup"><span data-stu-id="1450d-351">Types</span></span> |<span data-ttu-id="1450d-352">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="1450d-352">[Schema][schema]</span></span> |<span data-ttu-id="1450d-353">Схема для импортируемого пространства соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-353">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="1450d-354">Сценарий импорта данных должен записать в конвейер объект List[[CSEntryChange][csec]].</span><span class="sxs-lookup"><span data-stu-id="1450d-354">The import data script must write a List[[CSEntryChange][csec]] object to the pipeline.</span></span> <span data-ttu-id="1450d-355">Эта коллекция состоит из атрибутов CSEntryChange, представляющих каждый импортируемый объект.</span><span class="sxs-lookup"><span data-stu-id="1450d-355">This collection is composed of CSEntryChange attributes that represent each object being imported.</span></span> <span data-ttu-id="1450d-356">При выполнении полного импорта эта коллекция должна содержать полный набор объектов CSEntryChange со всеми атрибутами для каждого объекта.</span><span class="sxs-lookup"><span data-stu-id="1450d-356">During a Full Import run, this collection should have a full set of CSEntryChange objects that have all attributes for every object.</span></span> <span data-ttu-id="1450d-357">При импорте изменений объект CSEntryChange должен содержать изменения уровня атрибутов для каждого импортируемого объекта или полное представление измененных объектов (режим замены).</span><span class="sxs-lookup"><span data-stu-id="1450d-357">During a Delta Import, the CSEntryChange object should either contain the attribute level deltas for each object to import, or a complete representation of the objects that have changed (Replace mode).</span></span>

<span data-ttu-id="1450d-358">**Окончание импорта**</span><span class="sxs-lookup"><span data-stu-id="1450d-358">**End Import**</span></span>  
<span data-ttu-id="1450d-359">По завершении импорта выполняется сценарий окончания импорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-359">At the conclusion of the import run, the End Import script is run.</span></span> <span data-ttu-id="1450d-360">Этот скрипт должен выполнять все необходимые задачи очистки (например, закрытие подключений к системам и реагирование на сбои).</span><span class="sxs-lookup"><span data-stu-id="1450d-360">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="1450d-361">Сценарий окончания импорта принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-361">The end import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-362">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-362">Name</span></span> | <span data-ttu-id="1450d-363">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-363">Data Type</span></span> | <span data-ttu-id="1450d-364">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-364">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-365">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-365">ConfigParameters</span></span> |<span data-ttu-id="1450d-366">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-367">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-367">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-368">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-368">Credential</span></span> |<span data-ttu-id="1450d-369">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-369">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-370">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-370">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-371">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-371">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="1450d-372">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-372">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="1450d-373">Информирует сценарий о типе запуска импорта (измененный или полный), секции, иерархии, водяном знаке и ожидаемом размере страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-373">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="1450d-374">CloseImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-374">CloseImportConnectionRunStep</span></span> |<span data-ttu-id="1450d-375">[CloseImportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-375">[CloseImportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="1450d-376">Информирует сценарий о причине завершения импорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-376">Informs the script about the reason the import was ended.</span></span> |

<span data-ttu-id="1450d-377">Сценарий должен возвращать в конвейер отдельный объект [CloseImportConnectionResults][cicres], например: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`.</span><span class="sxs-lookup"><span data-stu-id="1450d-377">The script must return a single [CloseImportConnectionResults][cicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span></span>

#### <a name="export"></a><span data-ttu-id="1450d-378">экспорт.</span><span class="sxs-lookup"><span data-stu-id="1450d-378">Export</span></span>
<span data-ttu-id="1450d-379">Идентичен архитектуре импорта соединителя. Соединители, поддерживающие экспорт, должны реализовать три сценария.</span><span class="sxs-lookup"><span data-stu-id="1450d-379">Identical to the import architecture of the connector, connectors that support Export must implement three scripts.</span></span>

<span data-ttu-id="1450d-380">**Начало экспорта**</span><span class="sxs-lookup"><span data-stu-id="1450d-380">**Begin Export**</span></span>  
<span data-ttu-id="1450d-381">Сценарий «Начало экспорта» реализуется в начале этапа выполнения экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-381">The begin export script is run at the beginning of an export run step.</span></span> <span data-ttu-id="1450d-382">На этом этапе можно установить подключение к исходной системе и выполнить все необходимые подготовительные действия перед экспортом данных в подключенную систему.</span><span class="sxs-lookup"><span data-stu-id="1450d-382">During this step, you can establish a connection to the source system and conduct any preparatory steps before exporting data to the connected system.</span></span>

<span data-ttu-id="1450d-383">Сценарий начала экспорта принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-383">The begin export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-384">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-384">Name</span></span> | <span data-ttu-id="1450d-385">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-385">Data Type</span></span> | <span data-ttu-id="1450d-386">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-386">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-387">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-387">ConfigParameters</span></span> |<span data-ttu-id="1450d-388">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-389">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-389">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-390">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-390">Credential</span></span> |<span data-ttu-id="1450d-391">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-391">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-392">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-392">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-393">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-393">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="1450d-394">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-394">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="1450d-395">Информирует сценарий о типе запуска экспорта (измененный или полный), секции, иерархии и ожидаемом размере страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-395">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="1450d-396">Типы</span><span class="sxs-lookup"><span data-stu-id="1450d-396">Types</span></span> |<span data-ttu-id="1450d-397">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="1450d-397">[Schema][schema]</span></span> |<span data-ttu-id="1450d-398">Схема для экспортируемого пространства соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-398">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="1450d-399">Сценарий не должен возвращать выходные данные в конвейер.</span><span class="sxs-lookup"><span data-stu-id="1450d-399">The script should not return any output to the pipeline.</span></span>

<span data-ttu-id="1450d-400">**Экспорт данных**</span><span class="sxs-lookup"><span data-stu-id="1450d-400">**Export Data**</span></span>  
<span data-ttu-id="1450d-401">Служба синхронизации вызывает сценарий экспорта данных столько раз, сколько это необходимо для обработки всех операций экспорта в ожидании.</span><span class="sxs-lookup"><span data-stu-id="1450d-401">The Synchronization Service calls the Export Data script as many times as is necessary to process all pending exports.</span></span> <span data-ttu-id="1450d-402">Если количество операций экспорта в ожидании превышает размер страницы соединителя, скрипт экспорта данных может вызываться несколько раз (возможно, несколько раз для одного и того же объекта).</span><span class="sxs-lookup"><span data-stu-id="1450d-402">If the connector space has more pending exports than the connector’s page size, the export data script may be called multiple times and possibly multiple times for the same object.</span></span>

<span data-ttu-id="1450d-403">Сценарий экспорта данных принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-403">The export data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-404">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-404">Name</span></span> | <span data-ttu-id="1450d-405">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-405">Data Type</span></span> | <span data-ttu-id="1450d-406">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-406">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-407">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-407">ConfigParameters</span></span> |<span data-ttu-id="1450d-408">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-409">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-409">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-410">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-410">Credential</span></span> |<span data-ttu-id="1450d-411">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-411">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-412">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-412">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-413">CSEntries</span><span class="sxs-lookup"><span data-stu-id="1450d-413">CSEntries</span></span> |<span data-ttu-id="1450d-414">IList[CSEntryChange][csec]</span><span class="sxs-lookup"><span data-stu-id="1450d-414">IList[CSEntryChange][csec]</span></span> |<span data-ttu-id="1450d-415">Список всех объектов пространства соединителя с операциями экспорта в ожидании для обработки на этом этапе.</span><span class="sxs-lookup"><span data-stu-id="1450d-415">List of all the connector space objects with pending exports to be processed during this pass.</span></span> |
| <span data-ttu-id="1450d-416">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-416">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="1450d-417">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-417">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="1450d-418">Информирует сценарий о типе запуска экспорта (измененный или полный), секции, иерархии и ожидаемом размере страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-418">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="1450d-419">Типы</span><span class="sxs-lookup"><span data-stu-id="1450d-419">Types</span></span> |<span data-ttu-id="1450d-420">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="1450d-420">[Schema][schema]</span></span> |<span data-ttu-id="1450d-421">Схема для экспортируемого пространства соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-421">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="1450d-422">Сценарий экспорта данных должен возвращать в конвейер объект [PutExportEntriesResults][peeres].</span><span class="sxs-lookup"><span data-stu-id="1450d-422">The export data script must return a [PutExportEntriesResults][peeres] object to the pipeline.</span></span> <span data-ttu-id="1450d-423">Этот объект не должен включать данные результатов для каждого экспортируемого соединителя, если не произойдет ошибка или изменение атрибута привязки.</span><span class="sxs-lookup"><span data-stu-id="1450d-423">This object does not need to include result information for each exported connector unless an error or a change to the anchor attribute occurs.</span></span> <span data-ttu-id="1450d-424">Например, чтобы вернуть в конвейер объект PutExportEntriesResults: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span><span class="sxs-lookup"><span data-stu-id="1450d-424">For example, to return a PutExportEntriesResults object to the pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span></span>

<span data-ttu-id="1450d-425">**Окончание экспорта**</span><span class="sxs-lookup"><span data-stu-id="1450d-425">**End Export**</span></span>  
<span data-ttu-id="1450d-426">По завершении экспорта выполняется сценарий окончания экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-426">At the conclusion of the export run, the End Export script to run.</span></span> <span data-ttu-id="1450d-427">Этот скрипт должен выполнять все необходимые задачи очистки (например, закрытие подключений к системам и реагирование на сбои).</span><span class="sxs-lookup"><span data-stu-id="1450d-427">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="1450d-428">Сценарий окончания экспорта принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-428">The end export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-429">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-429">Name</span></span> | <span data-ttu-id="1450d-430">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-430">Data Type</span></span> | <span data-ttu-id="1450d-431">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-431">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-432">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-432">ConfigParameters</span></span> |<span data-ttu-id="1450d-433">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-434">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-434">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-435">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-435">Credential</span></span> |<span data-ttu-id="1450d-436">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-436">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-437">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-437">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-438">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-438">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="1450d-439">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-439">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="1450d-440">Информирует сценарий о типе запуска экспорта (измененный или полный), секции, иерархии и ожидаемом размере страницы.</span><span class="sxs-lookup"><span data-stu-id="1450d-440">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="1450d-441">CloseExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="1450d-441">CloseExportConnectionRunStep</span></span> |<span data-ttu-id="1450d-442">[CloseExportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="1450d-442">[CloseExportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="1450d-443">Информирует сценарий о причине завершения экспорта.</span><span class="sxs-lookup"><span data-stu-id="1450d-443">Informs the script about the reason the export was ended.</span></span> |

<span data-ttu-id="1450d-444">Сценарий не должен возвращать выходные данные в конвейер.</span><span class="sxs-lookup"><span data-stu-id="1450d-444">The script should not return any output to the pipeline.</span></span>

#### <a name="password-synchronization"></a><span data-ttu-id="1450d-445">Синхронизация паролей</span><span class="sxs-lookup"><span data-stu-id="1450d-445">Password Synchronization</span></span>
<span data-ttu-id="1450d-446">Соединители Windows PowerShell могут использоваться в качестве целевого объекта для изменения или сброса пароля.</span><span class="sxs-lookup"><span data-stu-id="1450d-446">Windows PowerShell connectors can be used as a target for password changes/resets.</span></span>

<span data-ttu-id="1450d-447">Сценарий пароля принимает от соединителя указанные ниже параметры.</span><span class="sxs-lookup"><span data-stu-id="1450d-447">The password script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="1450d-448">Имя</span><span class="sxs-lookup"><span data-stu-id="1450d-448">Name</span></span> | <span data-ttu-id="1450d-449">Тип данных</span><span class="sxs-lookup"><span data-stu-id="1450d-449">Data Type</span></span> | <span data-ttu-id="1450d-450">Описание</span><span class="sxs-lookup"><span data-stu-id="1450d-450">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1450d-451">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="1450d-451">ConfigParameters</span></span> |<span data-ttu-id="1450d-452">[KeyedCollection][keyk] [строка, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="1450d-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="1450d-453">Таблица параметров конфигурации для соединителя.</span><span class="sxs-lookup"><span data-stu-id="1450d-453">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="1450d-454">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="1450d-454">Credential</span></span> |<span data-ttu-id="1450d-455">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="1450d-455">[PSCredential][pscred]</span></span> |<span data-ttu-id="1450d-456">Содержит все учетные данные, введенные администратором на вкладке «Подключение».</span><span class="sxs-lookup"><span data-stu-id="1450d-456">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="1450d-457">Секция</span><span class="sxs-lookup"><span data-stu-id="1450d-457">Partition</span></span> |<span data-ttu-id="1450d-458">[Секция][part]</span><span class="sxs-lookup"><span data-stu-id="1450d-458">[Partition][part]</span></span> |<span data-ttu-id="1450d-459">Секция каталога, содержащая CSEntry.</span><span class="sxs-lookup"><span data-stu-id="1450d-459">Directory partition that the CSEntry is in.</span></span> |
| <span data-ttu-id="1450d-460">CSEntry</span><span class="sxs-lookup"><span data-stu-id="1450d-460">CSEntry</span></span> |<span data-ttu-id="1450d-461">[CSEntry][cse]</span><span class="sxs-lookup"><span data-stu-id="1450d-461">[CSEntry][cse]</span></span> |<span data-ttu-id="1450d-462">Запись пространства соединителя для объекта, который получил данные о смене или сбросе пароля.</span><span class="sxs-lookup"><span data-stu-id="1450d-462">Connector space entry for the object that is received a password change or reset.</span></span> |
| <span data-ttu-id="1450d-463">OperationType</span><span class="sxs-lookup"><span data-stu-id="1450d-463">OperationType</span></span> |<span data-ttu-id="1450d-464">Строка</span><span class="sxs-lookup"><span data-stu-id="1450d-464">String</span></span> |<span data-ttu-id="1450d-465">Указывает тип операции: сброс (**SetPassword**) или изменение (**ChangePassword**).</span><span class="sxs-lookup"><span data-stu-id="1450d-465">Indicates if the operation is a reset (**SetPassword**) or a change (**ChangePassword**).</span></span> |
| <span data-ttu-id="1450d-466">PasswordOptions</span><span class="sxs-lookup"><span data-stu-id="1450d-466">PasswordOptions</span></span> |<span data-ttu-id="1450d-467">[PasswordOptions][pwdopt]</span><span class="sxs-lookup"><span data-stu-id="1450d-467">[PasswordOptions][pwdopt]</span></span> |<span data-ttu-id="1450d-468">Флаги, определяющие предполагаемое поведение при сбросе пароля.</span><span class="sxs-lookup"><span data-stu-id="1450d-468">Flags that specify the intended password reset behavior.</span></span> <span data-ttu-id="1450d-469">Этот параметр доступен, только если для OperationType установлено значение **SetPassword**.</span><span class="sxs-lookup"><span data-stu-id="1450d-469">This parameter is only available if OperationType is **SetPassword**.</span></span> |
| <span data-ttu-id="1450d-470">OldPassword</span><span class="sxs-lookup"><span data-stu-id="1450d-470">OldPassword</span></span> |<span data-ttu-id="1450d-471">Строка</span><span class="sxs-lookup"><span data-stu-id="1450d-471">String</span></span> |<span data-ttu-id="1450d-472">Содержит старый пароль объекта, необходимый для изменения пароля.</span><span class="sxs-lookup"><span data-stu-id="1450d-472">Populated with the object’s old password for password changes.</span></span> <span data-ttu-id="1450d-473">Этот параметр доступен, только если для OperationType установлено значение **ChangePassword**.</span><span class="sxs-lookup"><span data-stu-id="1450d-473">This parameter is only available if OperationType is **ChangePassword**.</span></span> |
| <span data-ttu-id="1450d-474">NewPassword</span><span class="sxs-lookup"><span data-stu-id="1450d-474">NewPassword</span></span> |<span data-ttu-id="1450d-475">Строка</span><span class="sxs-lookup"><span data-stu-id="1450d-475">String</span></span> |<span data-ttu-id="1450d-476">Содержит новый пароль, который должен быть установлен сценарием.</span><span class="sxs-lookup"><span data-stu-id="1450d-476">Populated with the object’s new password that the script should set.</span></span> |

<span data-ttu-id="1450d-477">Сценарий пароля не должен возвращать результаты в конвейер Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-477">The password script is not expected to return any results to the Windows PowerShell pipeline.</span></span> <span data-ttu-id="1450d-478">В случае ошибки в сценарии пароля сценарий должен вызывать одно из указанных ниже исключений, чтобы отправить сведения о проблеме в службу синхронизации.</span><span class="sxs-lookup"><span data-stu-id="1450d-478">If an error occurs in the password script, the script should throw one of the following exceptions to inform the Synchronization Service about the problem:</span></span>

* <span data-ttu-id="1450d-479">[PasswordPolicyViolationException][pwdex1] порождается, если пароль не соответствует политике паролей в подключенной системе.</span><span class="sxs-lookup"><span data-stu-id="1450d-479">[PasswordPolicyViolationException][pwdex1] – Thrown if the password does not meet the password policy in the connected system.</span></span>
* <span data-ttu-id="1450d-480">[PasswordIllFormedException][pwdex2] порождается, если пароль неприемлем для подключенной системы.</span><span class="sxs-lookup"><span data-stu-id="1450d-480">[PasswordIllFormedException][pwdex2] – Thrown if the password is not acceptable for the connected system.</span></span>
* <span data-ttu-id="1450d-481">[PasswordExtension][pwdex3] порождается при возникновении любых других ошибок в сценарии пароля.</span><span class="sxs-lookup"><span data-stu-id="1450d-481">[PasswordExtension][pwdex3] – Thrown for all other errors in the password script.</span></span>

## <a name="sample-connectors"></a><span data-ttu-id="1450d-482">Образцы соединителей</span><span class="sxs-lookup"><span data-stu-id="1450d-482">Sample Connectors</span></span>
<span data-ttu-id="1450d-483">Полный обзор доступных примеров соединителей представлен в статье [Windows PowerShell Connector for FIM 2010 R2 Sample Connector Collection][samp] (Коллекция примеров соединителей Windows PowerShell для FIM 2010 R2).</span><span class="sxs-lookup"><span data-stu-id="1450d-483">For a complete overview of the available sample connectors, see [Windows PowerShell Connector Sample Connector Collection][samp].</span></span>

## <a name="other-notes"></a><span data-ttu-id="1450d-484">Другие примечания</span><span class="sxs-lookup"><span data-stu-id="1450d-484">Other notes</span></span>
### <a name="additional-configuration-for-impersonation"></a><span data-ttu-id="1450d-485">Дополнительные настройки для олицетворения</span><span class="sxs-lookup"><span data-stu-id="1450d-485">Additional Configuration for Impersonation</span></span>
<span data-ttu-id="1450d-486">Предоставляются олицетворяемому пользователю с указанными ниже разрешениями на сервере службы синхронизации.</span><span class="sxs-lookup"><span data-stu-id="1450d-486">Grant the user that is impersonated the following permissions on the Synchronization Service server:</span></span>

<span data-ttu-id="1450d-487">Доступ для чтения к следующим разделам реестра:</span><span class="sxs-lookup"><span data-stu-id="1450d-487">Read access to the following registry keys:</span></span>

* <span data-ttu-id="1450d-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span><span class="sxs-lookup"><span data-stu-id="1450d-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span></span>
* <span data-ttu-id="1450d-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span><span class="sxs-lookup"><span data-stu-id="1450d-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span></span>

<span data-ttu-id="1450d-490">Чтобы определить идентификатор безопасности (SID) учетной записи службы синхронизации, необходимо выполнить указанные ниже команды PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1450d-490">To determine the Security Identifier (SID) of the Synchronization Service service account, run the following PowerShell commands:</span></span>

```
$account = New-Object System.Security.Principal.NTAccount "<domain>\<username>"
$account.Translate([System.Security.Principal.SecurityIdentifier]).Value
```

<span data-ttu-id="1450d-491">Доступ для чтения к следующим папкам файловой системы:</span><span class="sxs-lookup"><span data-stu-id="1450d-491">Read access to the following file system folders:</span></span>

* <span data-ttu-id="1450d-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions;</span><span class="sxs-lookup"><span data-stu-id="1450d-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span></span>
* <span data-ttu-id="1450d-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache;</span><span class="sxs-lookup"><span data-stu-id="1450d-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span></span>
* <span data-ttu-id="1450d-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span><span class="sxs-lookup"><span data-stu-id="1450d-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span></span>

<span data-ttu-id="1450d-495">Подставьте имя соединителя Windows PowerShell вместо заполнителя {ConnectorName}.</span><span class="sxs-lookup"><span data-stu-id="1450d-495">Substitute the name of the Windows PowerShell connector for the {ConnectorName} placeholder.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="1450d-496">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="1450d-496">Troubleshooting</span></span>
* <span data-ttu-id="1450d-497">Сведения о том, как включить ведение журнала для устранения неполадок соединителя, см. в статье [How to Enable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731) (Включение трассировки событий Windows для соединителей).</span><span class="sxs-lookup"><span data-stu-id="1450d-497">For information on how to enable logging to troubleshoot the connector, see the [How to Enable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731).</span></span>

<!--Reference style links - using these makes the source content way more readable than using inline links-->
[cpp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameterpage.aspx
[keyk]: https://msdn.microsoft.com/library/ms132438.aspx
[cp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameter.aspx
[pscred]: https://msdn.microsoft.com/library/system.management.automation.pscredential.aspx
[schema]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schema.aspx
[schemaT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schematype.aspx
[schemaA]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schemaattribute.aspx
[dnstyle]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.madistinguishednamestyle.aspx
[exportT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maexporttype.aspx
[DataNorm]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.manormalizations.aspx
[oconf]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maobjectconfirmation.aspx
[dw]: https://msdn.microsoft.com/library/windows/desktop/aa378184.aspx
[part]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.partition.aspx
[hn]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.hierarchynode.aspx
[oicrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionrunstep.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[oicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionresults.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[cicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeimportconnectionresults.aspx
[oecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openexportconnectionrunstep.aspx
[irs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.importrunstep.aspx
[cse]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentry.aspx
[csec]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentrychange.aspx
[peeres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.putexportentriesresults.aspx
[pwdopt]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordoptions.aspx
[pwdex1]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordpolicyviolationexception.aspx
[pwdex2]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordillformedexception.aspx
[pwdex3]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordextensionexception.aspx
[samp]: http://go.microsoft.com/fwlink/?LinkId=394291
