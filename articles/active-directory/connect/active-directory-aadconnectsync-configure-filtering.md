---
title: "Синхронизация Azure AD Connect: настройка фильтрации | Документация Майкрософт"
description: "Объясняет, как tooconfigure фильтрации в Azure AD Connect sync."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 880facf6-1192-40e9-8181-544c0759d506
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 97979b508c560a6de6cb091b1b621bc1d51b25c4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-sync-configure-filtering"></a><span data-ttu-id="b1711-103">Синхронизация Azure AD Connect: настройка фильтрации</span><span class="sxs-lookup"><span data-stu-id="b1711-103">Azure AD Connect sync: Configure filtering</span></span>
<span data-ttu-id="b1711-104">Возможность фильтрации позволяет управлять тем, какие объекты локального каталога будут синхронизированы с Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="b1711-104">By using filtering, you can control which objects appear in Azure Active Directory (Azure AD) from your on-premises directory.</span></span> <span data-ttu-id="b1711-105">Конфигурация по умолчанию Hello принимает все объекты во всех доменах леса настроены hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-105">hello default configuration takes all objects in all domains in hello configured forests.</span></span> <span data-ttu-id="b1711-106">Как правило это Рекомендуемая конфигурация hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-106">In general, this is hello recommended configuration.</span></span> <span data-ttu-id="b1711-107">Пользователи системы Office 365, будь-то Exchange Online или Skype для бизнеса, могут использовать глобальный список адресов для отправки сообщений электронной почты и осуществления звонков по всем адресам.</span><span class="sxs-lookup"><span data-stu-id="b1711-107">Users using Office 365 workloads, such as Exchange Online and Skype for Business, benefit from a complete Global Address List so they can send email and call everyone.</span></span> <span data-ttu-id="b1711-108">С конфигурацией по умолчанию hello они бы приветствия одинаковую функциональность, что они бы с реализацией в локальной среде Exchange и Lync.</span><span class="sxs-lookup"><span data-stu-id="b1711-108">With hello default configuration, they would have hello same experience that they would have with an on-premises implementation of Exchange or Lync.</span></span>

<span data-ttu-id="b1711-109">В некоторых случаях тем не менее, вам требуется внести некоторые изменения toohello по умолчанию конфигурации.</span><span class="sxs-lookup"><span data-stu-id="b1711-109">In some cases however, you're required make some changes toohello default configuration.</span></span> <span data-ttu-id="b1711-110">Ниже приведены некоторые примеры:</span><span class="sxs-lookup"><span data-stu-id="b1711-110">Here are some examples:</span></span>

* <span data-ttu-id="b1711-111">Планирование toouse hello [несколькими Azure AD directory топологии](active-directory-aadconnect-topologies.md#each-object-only-once-in-an-azure-ad-tenant).</span><span class="sxs-lookup"><span data-stu-id="b1711-111">You plan toouse hello [multi-Azure AD directory topology](active-directory-aadconnect-topologies.md#each-object-only-once-in-an-azure-ad-tenant).</span></span> <span data-ttu-id="b1711-112">Затем необходимо tooapply toocontrol фильтра, какие объекты представляют собой каталогов синхронизированные tooa определенного Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-112">Then you need tooapply a filter toocontrol which objects are synchronized tooa particular Azure AD directory.</span></span>
* <span data-ttu-id="b1711-113">Используется пилотная программа Azure или Office 365, и нужно синхронизировать с Azure AD только определенных пользователей.</span><span class="sxs-lookup"><span data-stu-id="b1711-113">You run a pilot for Azure or Office 365 and you only want a subset of users in Azure AD.</span></span> <span data-ttu-id="b1711-114">В небольших пилотных hello не важно toohave полные функции hello toodemonstrate глобального списка адресов.</span><span class="sxs-lookup"><span data-stu-id="b1711-114">In hello small pilot, it's not important toohave a complete Global Address List toodemonstrate hello functionality.</span></span>
* <span data-ttu-id="b1711-115">Если не нужно синхронизировать с Azure AD много учетных записей служб и других рабочих учетных записей.</span><span class="sxs-lookup"><span data-stu-id="b1711-115">You have many service accounts and other nonpersonal accounts that you don't want in Azure AD.</span></span>
* <span data-ttu-id="b1711-116">В целях обеспечения соответствия нельзя локально удалять учетные записи пользователей,</span><span class="sxs-lookup"><span data-stu-id="b1711-116">For compliance reasons, you don't delete any user accounts on-premises.</span></span> <span data-ttu-id="b1711-117">но можно их отключить.</span><span class="sxs-lookup"><span data-stu-id="b1711-117">You only disable them.</span></span> <span data-ttu-id="b1711-118">Однако в Azure AD требуется только учетные записи active toobe присутствует.</span><span class="sxs-lookup"><span data-stu-id="b1711-118">But in Azure AD, you only want active accounts toobe present.</span></span>

<span data-ttu-id="b1711-119">В этой статье рассказывается, как tooconfigure hello различные методы фильтрации.</span><span class="sxs-lookup"><span data-stu-id="b1711-119">This article covers how tooconfigure hello different filtering methods.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b1711-120">Корпорация Майкрософт не поддерживает изменение, а также ОС Azure AD Connect sync за пределами действия hello, формально задокументированных.</span><span class="sxs-lookup"><span data-stu-id="b1711-120">Microsoft doesn't support modifying or operating Azure AD Connect sync outside of hello actions that are formally documented.</span></span> <span data-ttu-id="b1711-121">Любые иные действия могут привести к несогласованному или неподдерживаемому состоянию служб синхронизации Azure AD Connect. Для таких развертываний Майкрософт не предоставляет техническую поддержку.</span><span class="sxs-lookup"><span data-stu-id="b1711-121">Any of these actions might result in an inconsistent or unsupported state of Azure AD Connect sync. As a result, Microsoft can't provide technical support for such deployments.</span></span>

## <a name="basics-and-important-notes"></a><span data-ttu-id="b1711-122">Основные сведения и важные примечания</span><span class="sxs-lookup"><span data-stu-id="b1711-122">Basics and important notes</span></span>
<span data-ttu-id="b1711-123">В службах синхронизации Azure AD Connect фильтрацию можно включить в любое время.</span><span class="sxs-lookup"><span data-stu-id="b1711-123">In Azure AD Connect sync, you can enable filtering at any time.</span></span> <span data-ttu-id="b1711-124">Если начать с синхронизации службы каталогов конфигурации по умолчанию и затем настроить фильтрацию, hello объекты, которые фильтруются, не синхронизированные tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-124">If you start with a default configuration of directory synchronization and then configure filtering, hello objects that are filtered out are no longer synchronized tooAzure AD.</span></span> <span data-ttu-id="b1711-125">В результате этого изменения все объекты в Azure AD, которые ранее были синхронизированы, а затем отфильтрованы, будут удалены из Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-125">Because of this change, any objects in Azure AD that were previously synchronized but were then filtered are deleted in Azure AD.</span></span>

<span data-ttu-id="b1711-126">Прежде чем начать, делая toofiltering изменения, убедитесь, что вы [отключить запланированная задача hello](#disable-scheduled-task) так изменений, еще не проверен toobe правильный случайно не экспортировать.</span><span class="sxs-lookup"><span data-stu-id="b1711-126">Before you start making changes toofiltering, make sure that you [disable hello scheduled task](#disable-scheduled-task) so you don't accidentally export changes that you haven't yet verified toobe correct.</span></span>

<span data-ttu-id="b1711-127">Поскольку фильтрации можно удалить многие объекты hello одновременную, требуется toomake правильность новые фильтры перед началом экспорта любые изменения tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-127">Because filtering can remove many objects at hello same time, you want toomake sure that your new filters are correct before you start exporting any changes tooAzure AD.</span></span> <span data-ttu-id="b1711-128">После завершения действия по настройке hello, настоятельно рекомендуется следовать hello [шаги проверки](#apply-and-verify-changes) прежде чем экспортировать и внести изменения tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-128">After you've completed hello configuration steps, we strongly recommend that you follow hello [verification steps](#apply-and-verify-changes) before you export and make changes tooAzure AD.</span></span>

<span data-ttu-id="b1711-129">функция tooprotect удалять многие объекты случайно, hello»[избежать случайного удаления](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)» по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b1711-129">tooprotect you from deleting many objects by accident, hello feature "[prevent accidental deletes](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)" is on by default.</span></span> <span data-ttu-id="b1711-130">При удалении нескольких объектов из-за toofiltering (500 по умолчанию), необходимо toofollow hello шаги в этой статье tooallow hello удаляет toogo через tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-130">If you delete many objects due toofiltering (500 by default), you need toofollow hello steps in this article tooallow hello deletes toogo through tooAzure AD.</span></span>

<span data-ttu-id="b1711-131">При использовании сборки до ноября 2015 г. ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)), внесено изменение конфигурации фильтра tooa и использования синхронизации паролей после завершения настройки hello, потребуется tootrigger полную синхронизацию всех паролей.</span><span class="sxs-lookup"><span data-stu-id="b1711-131">If you use a build before November 2015 ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)), make a change tooa filter configuration, and use password synchronization, then you need tootrigger a full sync of all passwords after you've completed hello configuration.</span></span> <span data-ttu-id="b1711-132">Инструкции по как tootrigger пароль полная синхронизация. в разделе [запуска полной синхронизации всех паролей](active-directory-aadconnectsync-troubleshoot-password-synchronization.md#trigger-a-full-sync-of-all-passwords).</span><span class="sxs-lookup"><span data-stu-id="b1711-132">For steps on how tootrigger a password full sync, see [Trigger a full sync of all passwords](active-directory-aadconnectsync-troubleshoot-password-synchronization.md#trigger-a-full-sync-of-all-passwords).</span></span> <span data-ttu-id="b1711-133">Если вы будете в построении 1.0.9125 или более поздней версии, затем hello regular **полная синхронизация** действие также вычисляет настроить синхронизацию паролей, и если этот дополнительный шаг больше не требуется.</span><span class="sxs-lookup"><span data-stu-id="b1711-133">If you're on build 1.0.9125 or later, then hello regular **full synchronization** action also calculates whether passwords should be synchronized and if this extra step is no longer required.</span></span>

<span data-ttu-id="b1711-134">Если **пользователя** в Azure AD случайном удалении объектов из-за ошибки фильтрации, можно повторно создать hello пользовательские объекты в Azure AD, удалив настройки фильтрации.</span><span class="sxs-lookup"><span data-stu-id="b1711-134">If **user** objects were inadvertently deleted in Azure AD because of a filtering error, you can recreate hello user objects in Azure AD by removing your filtering configurations.</span></span> <span data-ttu-id="b1711-135">Затем можно снова синхронизировать каталоги.</span><span class="sxs-lookup"><span data-stu-id="b1711-135">Then you can synchronize your directories again.</span></span> <span data-ttu-id="b1711-136">Это действие восстанавливает hello пользователей из корзины hello в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-136">This action restores hello users from hello recycle bin in Azure AD.</span></span> <span data-ttu-id="b1711-137">Однако удаление объектов других типов отменить нельзя.</span><span class="sxs-lookup"><span data-stu-id="b1711-137">However, you can't undelete other object types.</span></span> <span data-ttu-id="b1711-138">Например если используется tooACL ресурса было случайно удалить группу безопасности, нельзя восстановить hello группы и ее списки управления доступом.</span><span class="sxs-lookup"><span data-stu-id="b1711-138">For example, if you accidentally delete a security group and it was used tooACL a resource, hello group and its ACLs can't be recovered.</span></span>

<span data-ttu-id="b1711-139">Azure AD Connect удаляет только объекты, что он один раз считается toobe в области видимости.</span><span class="sxs-lookup"><span data-stu-id="b1711-139">Azure AD Connect only deletes objects that it has once considered toobe in scope.</span></span> <span data-ttu-id="b1711-140">Объекты Azure AD, созданные в результате работы другого модуля синхронизации и не соответствующие фильтру, удалены не будут.</span><span class="sxs-lookup"><span data-stu-id="b1711-140">If there are objects in Azure AD that were created by another sync engine and these objects aren't in scope, adding filtering doesn't remove them.</span></span> <span data-ttu-id="b1711-141">Например если начать с сервером DirSync, созданные полную копию всего каталога в Azure AD, и установить новый сервер синхронизации Azure AD Connect параллельно с включенной с начала hello фильтрацией, Azure AD Connect не удаляет лишние hello объекты, созданные с DirSync.</span><span class="sxs-lookup"><span data-stu-id="b1711-141">For example, if you start with a DirSync server that created a complete copy of your entire directory in Azure AD, and you install a new Azure AD Connect sync server in parallel with filtering enabled from hello beginning, Azure AD Connect doesn't remove hello extra objects that are created by DirSync.</span></span>

<span data-ttu-id="b1711-142">При установке или обновлении tooa более новой версии Azure AD Connect сохраняется Hello конфигурацией фильтрации.</span><span class="sxs-lookup"><span data-stu-id="b1711-142">hello filtering configuration is retained when you install or upgrade tooa newer version of Azure AD Connect.</span></span> <span data-ttu-id="b1711-143">Это всегда всего наиболее tooverify рекомендаций, который hello конфигурации не был случайно изменена после обновления tooa новой версии перед выполнением первого цикла синхронизации hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-143">It's always a best practice tooverify that hello configuration wasn't inadvertently changed after an upgrade tooa newer version before running hello first synchronization cycle.</span></span>

<span data-ttu-id="b1711-144">Если у вас есть более чем одном лесе, то необходимо применить фильтрацию настройки, описанные в данном разделе tooevery лесу hello (при условии, что требуется hello же конфигурации для всех из них).</span><span class="sxs-lookup"><span data-stu-id="b1711-144">If you have more than one forest, then you must apply hello filtering configurations that are described in this topic tooevery forest (assuming that you want hello same configuration for all of them).</span></span>

### <a name="disable-hello-scheduled-task"></a><span data-ttu-id="b1711-145">Отключить задание hello</span><span class="sxs-lookup"><span data-stu-id="b1711-145">Disable hello scheduled task</span></span>
<span data-ttu-id="b1711-146">toodisable hello планировщик, инициирует цикл синхронизации каждые 30 минут, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b1711-146">toodisable hello built-in scheduler that triggers a synchronization cycle every 30 minutes, follow these steps:</span></span>

1. <span data-ttu-id="b1711-147">Откройте командную строку PowerShell tooa.</span><span class="sxs-lookup"><span data-stu-id="b1711-147">Go tooa PowerShell prompt.</span></span>
2. <span data-ttu-id="b1711-148">Запустите `Set-ADSyncScheduler -SyncCycleEnabled $False` toodisable hello планировщика.</span><span class="sxs-lookup"><span data-stu-id="b1711-148">Run `Set-ADSyncScheduler -SyncCycleEnabled $False` toodisable hello scheduler.</span></span>
3. <span data-ttu-id="b1711-149">Сделать hello изменения, описанные в этой статье.</span><span class="sxs-lookup"><span data-stu-id="b1711-149">Make hello changes that are documented in this article.</span></span>
4. <span data-ttu-id="b1711-150">Запустите `Set-ADSyncScheduler -SyncCycleEnabled $True` планировщика hello tooenable еще раз.</span><span class="sxs-lookup"><span data-stu-id="b1711-150">Run `Set-ADSyncScheduler -SyncCycleEnabled $True` tooenable hello scheduler again.</span></span>

<span data-ttu-id="b1711-151">**При использовании сборки Azure AD Connect до версии 1.1.105.0**</span><span class="sxs-lookup"><span data-stu-id="b1711-151">**If you use an Azure AD Connect build before 1.1.105.0**</span></span>  
<span data-ttu-id="b1711-152">Запланированная задача hello toodisable, которое запускает цикл синхронизации каждые три часа, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b1711-152">toodisable hello scheduled task that triggers a synchronization cycle every three hours, follow these steps:</span></span>

1. <span data-ttu-id="b1711-153">Запуск **планировщик** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-153">Start **Task Scheduler** from hello **Start** menu.</span></span>
2. <span data-ttu-id="b1711-154">Непосредственно под **Библиотека планировщика заданий**, задачу hello поиска с именем **Azure AD Sync Scheduler**, щелкните правой кнопкой мыши и выберите **отключить**.</span><span class="sxs-lookup"><span data-stu-id="b1711-154">Directly under **Task Scheduler Library**, find hello task named **Azure AD Sync Scheduler**, right-click, and select **Disable**.</span></span>  
   <span data-ttu-id="b1711-155">![планировщик задач](./media/active-directory-aadconnectsync-configure-filtering/taskscheduler.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-155">![Task Scheduler](./media/active-directory-aadconnectsync-configure-filtering/taskscheduler.png)</span></span>  
3. <span data-ttu-id="b1711-156">Теперь можно внести изменения в конфигурацию и запустите модуль синхронизации hello вручную из hello **диспетчер службы синхронизации** консоли.</span><span class="sxs-lookup"><span data-stu-id="b1711-156">You can now make configuration changes and run hello sync engine manually from hello **Synchronization Service Manager** console.</span></span>

<span data-ttu-id="b1711-157">После завершения всех изменений фильтрации, не забывайте toocome назад и **включить** задачу hello еще раз.</span><span class="sxs-lookup"><span data-stu-id="b1711-157">After you've completed all your filtering changes, don't forget toocome back and **Enable** hello task again.</span></span>

## <a name="filtering-options"></a><span data-ttu-id="b1711-158">Параметры фильтрации</span><span class="sxs-lookup"><span data-stu-id="b1711-158">Filtering options</span></span>
<span data-ttu-id="b1711-159">Можно применить после фильтрации настройки средства синхронизации каталогов типы toohello hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-159">You can apply hello following filtering configuration types toohello directory synchronization tool:</span></span>

* <span data-ttu-id="b1711-160">[**Групповые**](#group-based-filtering): фильтрации, основанной на одну группу можно задавать только при первоначальной установке с помощью мастера установки hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-160">[**Group-based**](#group-based-filtering): Filtering based on a single group can only be configured on initial installation by using hello installation wizard.</span></span>
* <span data-ttu-id="b1711-161">[**На основе домена**](#domain-based-filtering): С помощью этого параметра, можно выбрать, какие домены синхронизации tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-161">[**Domain-based**](#domain-based-filtering): By using this option, you can select which domains synchronize tooAzure AD.</span></span> <span data-ttu-id="b1711-162">Можно также добавлять и удалять домены из конфигурации подсистемы синхронизации hello при внесении изменений tooyour локальной инфраструктуры после установки синхронизации Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="b1711-162">You can also add and remove domains from hello sync engine configuration when you make changes tooyour on-premises infrastructure after you install Azure AD Connect sync.</span></span>
* <span data-ttu-id="b1711-163">[**Организационное подразделение (OU) — на основе**](#organizational-unitbased-filtering): С помощью этого параметра, можно выбрать OU синхронизации tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-163">[**Organizational unit (OU)–based**](#organizational-unitbased-filtering): By using this option, you can select which OUs synchronize tooAzure AD.</span></span> <span data-ttu-id="b1711-164">Действие этого параметра распространяется на все типы объектов в выбранных подразделениях.</span><span class="sxs-lookup"><span data-stu-id="b1711-164">This option is for all object types in selected OUs.</span></span>
* <span data-ttu-id="b1711-165">[**Основанное на атрибутах**](#attribute-based-filtering): С помощью этого параметра, можно фильтровать объекты по значениям атрибутов объектов hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-165">[**Attribute-based**](#attribute-based-filtering): By using this option, you can filter objects based on attribute values on hello objects.</span></span> <span data-ttu-id="b1711-166">Кроме того, для объектов различных типов можно использовать разные фильтры.</span><span class="sxs-lookup"><span data-stu-id="b1711-166">You can also have different filters for different object types.</span></span>

<span data-ttu-id="b1711-167">Можно использовать несколько параметров фильтрации на hello то же время.</span><span class="sxs-lookup"><span data-stu-id="b1711-167">You can use multiple filtering options at hello same time.</span></span> <span data-ttu-id="b1711-168">Например, можно использовать фильтрацию на основе Подразделения tooonly включать объекты в одно Подразделение.</span><span class="sxs-lookup"><span data-stu-id="b1711-168">For example, you can use OU-based filtering tooonly include objects in one OU.</span></span> <span data-ttu-id="b1711-169">AT hello же time и дальнейшего использования на основе атрибутов объектов hello toofilter фильтрации.</span><span class="sxs-lookup"><span data-stu-id="b1711-169">At hello same time, you can use attribute-based filtering toofilter hello objects further.</span></span> <span data-ttu-id="b1711-170">При использовании нескольких методов фильтрации, фильтры hello используйте операцию логического «и» между hello фильтры.</span><span class="sxs-lookup"><span data-stu-id="b1711-170">When you use multiple filtering methods, hello filters use a logical "AND" between hello filters.</span></span>

## <a name="domain-based-filtering"></a><span data-ttu-id="b1711-171">Фильтрация по доменам</span><span class="sxs-lookup"><span data-stu-id="b1711-171">Domain-based filtering</span></span>
<span data-ttu-id="b1711-172">В этом разделе приводятся шаги tooconfigure hello фильтр домена.</span><span class="sxs-lookup"><span data-stu-id="b1711-172">This section provides you with hello steps tooconfigure your domain filter.</span></span> <span data-ttu-id="b1711-173">При их добавлении и удалении доменов в лесу, после установки Azure AD Connect, необходимо также tooupdate hello конфигурацией фильтрации.</span><span class="sxs-lookup"><span data-stu-id="b1711-173">If you added or removed domains in your forest after you installed Azure AD Connect, you also have tooupdate hello filtering configuration.</span></span>

<span data-ttu-id="b1711-174">Hello предпочтительный способ фильтрации toochange на основе домена, запустив мастер установки hello и изменив [домен и Подразделение фильтрации](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span><span class="sxs-lookup"><span data-stu-id="b1711-174">hello preferred way toochange domain-based filtering is by running hello installation wizard and changing [domain and OU filtering](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span></span> <span data-ttu-id="b1711-175">Мастер установки Hello автоматизирует все hello задачи, описанные в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="b1711-175">hello installation wizard automates all hello tasks that are documented in this topic.</span></span>

<span data-ttu-id="b1711-176">Только, если по некоторым причинам вы мастер установки не удается toorun hello, должны выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b1711-176">You should only follow these steps if you're unable toorun hello installation wizard for some reason.</span></span>

<span data-ttu-id="b1711-177">Настройка фильтрации по доменам предусматривает следующие шаги:</span><span class="sxs-lookup"><span data-stu-id="b1711-177">Domain-based filtering configuration consists of these steps:</span></span>

1. <span data-ttu-id="b1711-178">[Выберите домены hello](#select-domains-to-be-synchronized) , которые должны tooinclude в hello синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-178">[Select hello domains](#select-domains-to-be-synchronized) that you want tooinclude in hello synchronization.</span></span>
2. <span data-ttu-id="b1711-179">Для каждого добавления и удаления домена, настроить hello [профили запуска](#update-run-profiles).</span><span class="sxs-lookup"><span data-stu-id="b1711-179">For each added and removed domain, adjust hello [run profiles](#update-run-profiles).</span></span>
3. <span data-ttu-id="b1711-180">[Примените и проверьте изменения](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="b1711-180">[Apply and verify changes](#apply-and-verify-changes).</span></span>

### <a name="select-hello-domains-toobe-synchronized"></a><span data-ttu-id="b1711-181">Синхронизация toobe доменов выберите hello</span><span class="sxs-lookup"><span data-stu-id="b1711-181">Select hello domains toobe synchronized</span></span>
<span data-ttu-id="b1711-182">домен hello tooset фильтрации, hello следующие действия:</span><span class="sxs-lookup"><span data-stu-id="b1711-182">tooset hello domain filter, do hello following steps:</span></span>

1. <span data-ttu-id="b1711-183">Войдите в toohello сервера, на котором выполняется синхронизация Azure AD Connect, используя учетную запись, которая является членом hello **ADSyncAdmins** группы безопасности.</span><span class="sxs-lookup"><span data-stu-id="b1711-183">Sign in toohello server that is running Azure AD Connect sync by using an account that is a member of hello **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="b1711-184">Запуск **служба синхронизации** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-184">Start **Synchronization Service** from hello **Start** menu.</span></span>
3. <span data-ttu-id="b1711-185">Выберите **соединители**и в hello **соединители** выберите hello соединитель с типом hello **доменных служб Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="b1711-185">Select **Connectors**, and in hello **Connectors** list, select hello Connector with hello type **Active Directory Domain Services**.</span></span> <span data-ttu-id="b1711-186">В разделе **Действия** выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="b1711-186">In **Actions**, select **Properties**.</span></span>  
   <span data-ttu-id="b1711-187">![Свойства соединителя](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-187">![Connector properties](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span></span>  
4. <span data-ttu-id="b1711-188">Щелкните **Настроить разделы каталога**.</span><span class="sxs-lookup"><span data-stu-id="b1711-188">Click **Configure Directory Partitions**.</span></span>
5. <span data-ttu-id="b1711-189">В hello **выберите разделы каталога** выберите и отмените выделение доменов, при необходимости.</span><span class="sxs-lookup"><span data-stu-id="b1711-189">In hello **Select directory partitions** list, select and unselect domains as needed.</span></span> <span data-ttu-id="b1711-190">Убедитесь, что выбраны только hello секций, что требуется toosynchronize.</span><span class="sxs-lookup"><span data-stu-id="b1711-190">Verify that only hello partitions that you want toosynchronize are selected.</span></span>  
   <span data-ttu-id="b1711-191">![Разделы](./media/active-directory-aadconnectsync-configure-filtering/connectorpartitions.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-191">![Partitions](./media/active-directory-aadconnectsync-configure-filtering/connectorpartitions.png)</span></span>  
   <span data-ttu-id="b1711-192">Если был изменен инфраструктуру Active Directory в локальной и добавлен или удален доменов из леса hello, нажмите кнопку hello **обновление** tooget кнопку обновленный список.</span><span class="sxs-lookup"><span data-stu-id="b1711-192">If you've changed your on-premises Active Directory infrastructure and added or removed domains from hello forest, then click hello **Refresh** button tooget an updated list.</span></span> <span data-ttu-id="b1711-193">Во время обновления будет предложено ввести учетные данные.</span><span class="sxs-lookup"><span data-stu-id="b1711-193">When you refresh, you're asked for credentials.</span></span> <span data-ttu-id="b1711-194">Любые учетные данные с tooWindows доступ на чтение Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b1711-194">Provide any credentials with read access tooWindows Server Active Directory.</span></span> <span data-ttu-id="b1711-195">Это не обязательно toobe hello пользователя, который подставлена в диалоговое окно «hello».</span><span class="sxs-lookup"><span data-stu-id="b1711-195">It doesn't have toobe hello user that is prepopulated in hello dialog box.</span></span>  
   <span data-ttu-id="b1711-196">![Требуется обновление](./media/active-directory-aadconnectsync-configure-filtering/refreshneeded.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-196">![Refresh needed](./media/active-directory-aadconnectsync-configure-filtering/refreshneeded.png)</span></span>  
6. <span data-ttu-id="b1711-197">После завершения закройте hello **свойства** диалоговое окно, нажав кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="b1711-197">When you're done, close hello **Properties** dialog by clicking **OK**.</span></span> <span data-ttu-id="b1711-198">При удалении доменов в лесу hello всплывающего сообщения говорит, что домен был удален, и этой конфигурации будут очищены.</span><span class="sxs-lookup"><span data-stu-id="b1711-198">If you removed domains from hello forest, a message pop-up says that a domain was removed and that configuration will be cleaned up.</span></span>
7. <span data-ttu-id="b1711-199">Продолжить tooadjust hello [профили запуска](#update-run-profiles).</span><span class="sxs-lookup"><span data-stu-id="b1711-199">Continue tooadjust hello [run profiles](#update-run-profiles).</span></span>

### <a name="update-hello-run-profiles"></a><span data-ttu-id="b1711-200">Обновить профили запуска hello</span><span class="sxs-lookup"><span data-stu-id="b1711-200">Update hello run profiles</span></span>
<span data-ttu-id="b1711-201">Если вы обновили фильтр домена, необходимо также tooupdate профили запуска hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-201">If you've updated your domain filter, you also need tooupdate hello run profiles.</span></span>

1. <span data-ttu-id="b1711-202">В hello **соединители** убедитесь, что hello выбран соединитель, измененной в предыдущем шаге hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-202">In hello **Connectors** list, make sure that hello Connector that you changed in hello previous step is selected.</span></span> <span data-ttu-id="b1711-203">В разделе **Действия** выберите **Configure Run Profiles** (Настроить профили выполнения).</span><span class="sxs-lookup"><span data-stu-id="b1711-203">In **Actions**, select **Configure Run Profiles**.</span></span>  
   <span data-ttu-id="b1711-204">![Профили выполнения соединителя 1](./media/active-directory-aadconnectsync-configure-filtering/connectorrunprofiles1.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-204">![Connector run profiles 1](./media/active-directory-aadconnectsync-configure-filtering/connectorrunprofiles1.png)</span></span>  
2. <span data-ttu-id="b1711-205">Найдите и определите следующие профили hello:</span><span class="sxs-lookup"><span data-stu-id="b1711-205">Find and identify hello following profiles:</span></span>
    * <span data-ttu-id="b1711-206">полный импорт;</span><span class="sxs-lookup"><span data-stu-id="b1711-206">Full Import</span></span>
    * <span data-ttu-id="b1711-207">полная синхронизация;</span><span class="sxs-lookup"><span data-stu-id="b1711-207">Full Synchronization</span></span>
    * <span data-ttu-id="b1711-208">импорт изменений;</span><span class="sxs-lookup"><span data-stu-id="b1711-208">Delta Import</span></span>
    * <span data-ttu-id="b1711-209">синхронизация изменений;</span><span class="sxs-lookup"><span data-stu-id="b1711-209">Delta Synchronization</span></span>
    * <span data-ttu-id="b1711-210">экспорт.</span><span class="sxs-lookup"><span data-stu-id="b1711-210">Export</span></span>
3. <span data-ttu-id="b1711-211">Для каждого профиля настроить hello **добавлены** и **удалены** доменов.</span><span class="sxs-lookup"><span data-stu-id="b1711-211">For each profile, adjust hello **added** and **removed** domains.</span></span>
    1. <span data-ttu-id="b1711-212">Для каждого из профилей пяти hello, hello следующие действия для каждого **добавлены** домена:</span><span class="sxs-lookup"><span data-stu-id="b1711-212">For each of hello five profiles, do hello following steps for each **added** domain:</span></span>
        1. <span data-ttu-id="b1711-213">Выберите профиль выполнения hello и щелкните **новый шаг**.</span><span class="sxs-lookup"><span data-stu-id="b1711-213">Select hello run profile and click **New Step**.</span></span>
        2. <span data-ttu-id="b1711-214">На hello **шаг настройки** страницы в hello **тип** раскрывающееся меню hello выберите тип шага с hello точно такое же имя, как hello профиля, который настраивается.</span><span class="sxs-lookup"><span data-stu-id="b1711-214">On hello **Configure Step** page, in hello **Type** drop-down menu, select hello step type with hello same name as hello profile that you're configuring.</span></span> <span data-ttu-id="b1711-215">Нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-215">Then click **Next**.</span></span>  
        <span data-ttu-id="b1711-216">![Профили выполнения соединителя 2](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep1.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-216">![Connector run profiles 2](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep1.png)</span></span>  
        3. <span data-ttu-id="b1711-217">На hello **конфигурацию соединителя** страницы в hello **секции** раскрывающееся меню, выберите hello имя домена hello, что вы добавили tooyour фильтр домена.</span><span class="sxs-lookup"><span data-stu-id="b1711-217">On hello **Connector Configuration** page, in hello **Partition** drop-down menu, select hello name of hello domain that you've added tooyour domain filter.</span></span>  
        <span data-ttu-id="b1711-218">![Профили выполнения соединителя 3](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep2.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-218">![Connector run profiles 3](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep2.png)</span></span>  
        4. <span data-ttu-id="b1711-219">tooclose hello **настройки профилей выполнения** диалоговое окно, нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="b1711-219">tooclose hello **Configure Run Profile** dialog, click **Finish**.</span></span>
    2. <span data-ttu-id="b1711-220">Для каждого из профилей пяти hello, hello следующие действия для каждого **удалены** домена:</span><span class="sxs-lookup"><span data-stu-id="b1711-220">For each of hello five profiles, do hello following steps for each **removed** domain:</span></span>
        1. <span data-ttu-id="b1711-221">Выберите профиль выполнения hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-221">Select hello run profile.</span></span>
        2. <span data-ttu-id="b1711-222">Если hello **значение** из hello **секции** атрибута представляет собой идентификатор GUID, выберите hello выполнить шаг и щелкните **удалить шаг**.</span><span class="sxs-lookup"><span data-stu-id="b1711-222">If hello **Value** of hello **Partition** attribute is a GUID, select hello run step and click **Delete Step**.</span></span>  
        <span data-ttu-id="b1711-223">![Профили выполнения соединителя 4](./media/active-directory-aadconnectsync-configure-filtering/runprofilesdeletestep.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-223">![Connector run profiles 4](./media/active-directory-aadconnectsync-configure-filtering/runprofilesdeletestep.png)</span></span>  
    3. <span data-ttu-id="b1711-224">Проверьте внесенные изменения.</span><span class="sxs-lookup"><span data-stu-id="b1711-224">Verify your change.</span></span> <span data-ttu-id="b1711-225">Каждый домен, следует toosynchronize должно быть указано в ходе каждого профиля выполнения.</span><span class="sxs-lookup"><span data-stu-id="b1711-225">Each domain that you want toosynchronize should be listed as a step in each run profile.</span></span>
4. <span data-ttu-id="b1711-226">tooclose hello **Настройка профилей выполнения** диалоговое окно, нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="b1711-226">tooclose hello **Configure Run Profiles** dialog, click **OK**.</span></span>
5.  <span data-ttu-id="b1711-227">toocomplete hello конфигурации, необходимые toorun **полный импорт** и **разностной синхронизации**. Продолжить чтение раздела hello [применить и проверка изменений](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="b1711-227">toocomplete hello configuration, you need toorun a **Full import** and a **Delta sync**. Continue reading hello section [Apply and verify changes](#apply-and-verify-changes).</span></span>

## <a name="organizational-unitbased-filtering"></a><span data-ttu-id="b1711-228">Фильтрация по подразделениям</span><span class="sxs-lookup"><span data-stu-id="b1711-228">Organizational unit–based filtering</span></span>
<span data-ttu-id="b1711-229">Hello предпочтительный способ фильтрации toochange на основе Подразделения, запустив мастер установки hello и изменив [домен и Подразделение фильтрации](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span><span class="sxs-lookup"><span data-stu-id="b1711-229">hello preferred way toochange OU-based filtering is by running hello installation wizard and changing [domain and OU filtering](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span></span> <span data-ttu-id="b1711-230">Мастер установки Hello автоматизирует все hello задачи, описанные в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="b1711-230">hello installation wizard automates all hello tasks that are documented in this topic.</span></span>

<span data-ttu-id="b1711-231">Только, если по некоторым причинам вы мастер установки не удается toorun hello, должны выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b1711-231">You should only follow these steps if you're unable toorun hello installation wizard for some reason.</span></span>

<span data-ttu-id="b1711-232">tooconfigure организационную единицу фильтрации на основе, hello следующие действия:</span><span class="sxs-lookup"><span data-stu-id="b1711-232">tooconfigure organizational unit–based filtering, do hello following steps:</span></span>

1. <span data-ttu-id="b1711-233">Войдите в toohello сервера, на котором выполняется синхронизация Azure AD Connect, используя учетную запись, которая является членом hello **ADSyncAdmins** группы безопасности.</span><span class="sxs-lookup"><span data-stu-id="b1711-233">Sign in toohello server that is running Azure AD Connect sync by using an account that is a member of hello **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="b1711-234">Запуск **служба синхронизации** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-234">Start **Synchronization Service** from hello **Start** menu.</span></span>
3. <span data-ttu-id="b1711-235">Выберите **соединители**и в hello **соединители** выберите hello соединитель с типом hello **доменных служб Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="b1711-235">Select **Connectors**, and in hello **Connectors** list, select hello Connector with hello type **Active Directory Domain Services**.</span></span> <span data-ttu-id="b1711-236">В разделе **Действия** выберите **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="b1711-236">In **Actions**, select **Properties**.</span></span>  
   <span data-ttu-id="b1711-237">![Свойства соединителя](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-237">![Connector properties](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span></span>  
4. <span data-ttu-id="b1711-238">Нажмите кнопку **Настройка разделов каталога**выберите hello домена требуется tooconfigure и нажмите кнопку **контейнеры**.</span><span class="sxs-lookup"><span data-stu-id="b1711-238">Click **Configure Directory Partitions**, select hello domain that you want tooconfigure, and then click **Containers**.</span></span>
5. <span data-ttu-id="b1711-239">Когда появится запрос, предоставьте доступ на чтение tooyour локальной Active Directory любые учетные данные.</span><span class="sxs-lookup"><span data-stu-id="b1711-239">When you're prompted, provide any credentials with read access tooyour on-premises Active Directory.</span></span> <span data-ttu-id="b1711-240">Это не обязательно toobe hello пользователя, который подставлена в диалоговое окно «hello».</span><span class="sxs-lookup"><span data-stu-id="b1711-240">It doesn't have toobe hello user that is prepopulated in hello dialog box.</span></span>
6. <span data-ttu-id="b1711-241">В hello **выбора контейнеров** диалоговом очистить hello подразделений, не требуется toosynchronize с облачным каталогом hello, а затем выберите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="b1711-241">In hello **Select Containers** dialog box, clear hello OUs that you don’t want toosynchronize with hello cloud directory, and then click **OK**.</span></span>  
   <span data-ttu-id="b1711-242">![Подразделений в диалоговое окно выбора контейнеров hello](./media/active-directory-aadconnectsync-configure-filtering/ou.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-242">![OUs in hello Select Containers dialog box](./media/active-directory-aadconnectsync-configure-filtering/ou.png)</span></span>  
   * <span data-ttu-id="b1711-243">Hello **компьютеров** контейнер должен быть выбран для вашей toobe компьютеров Windows 10 успешно синхронизирован tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-243">hello **Computers** container should be selected for your Windows 10 computers toobe successfully synchronized tooAzure AD.</span></span> <span data-ttu-id="b1711-244">Если компьютеры, присоединенные к домену, находятся в других подразделениях, выберите соответствующие подразделения.</span><span class="sxs-lookup"><span data-stu-id="b1711-244">If your domain-joined computers are located in other OUs, make sure those are selected.</span></span>
   * <span data-ttu-id="b1711-245">Hello **ForeignSecurityPrincipals** контейнер должен быть выбран при наличии нескольких лесов с отношениями доверия.</span><span class="sxs-lookup"><span data-stu-id="b1711-245">hello **ForeignSecurityPrincipals** container should be selected if you have multiple forests with trusts.</span></span> <span data-ttu-id="b1711-246">Этот контейнер позволяет безопасности между лесами группы членства toobe разрешен.</span><span class="sxs-lookup"><span data-stu-id="b1711-246">This container allows cross-forest security group membership toobe resolved.</span></span>
   * <span data-ttu-id="b1711-247">Hello **RegisteredDevices** Подразделения следует выбирать, если включена функция обратной записи устройства hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-247">hello **RegisteredDevices** OU should be selected if you enabled hello device writeback feature.</span></span> <span data-ttu-id="b1711-248">Если используется другая функция обратной записи, такая как обратная запись группы, выберите соответствующие расположения.</span><span class="sxs-lookup"><span data-stu-id="b1711-248">If you use another writeback feature, such as group writeback, make sure these locations are selected.</span></span>
   * <span data-ttu-id="b1711-249">Выберите все подразделения, к которым принадлежат объекты контейнеров «Пользователи», iNetOrgPersons, «Группы», «Контакты» и «Компьютеры».</span><span class="sxs-lookup"><span data-stu-id="b1711-249">Select any other OU where Users, iNetOrgPersons, Groups, Contacts, and Computers are located.</span></span> <span data-ttu-id="b1711-250">На рисунке hello всех подразделений расположены в hello ManagedObjects Подразделения.</span><span class="sxs-lookup"><span data-stu-id="b1711-250">In hello picture, all these OUs are located in hello ManagedObjects OU.</span></span>
   * <span data-ttu-id="b1711-251">При использовании фильтрации на основе группы hello Подразделение, где расположена группа hello должен быть включен.</span><span class="sxs-lookup"><span data-stu-id="b1711-251">If you use group-based filtering, then hello OU where hello group is located must be included.</span></span>
   * <span data-ttu-id="b1711-252">Обратите внимание, что можно определить, нужно ли новых подразделениях, которые будут добавлены после завершения hello конфигурацией фильтрации синхронизированы или не синхронизированы.</span><span class="sxs-lookup"><span data-stu-id="b1711-252">Note that you can configure whether new OUs that are added after hello filtering configuration finishes are synchronized or not synchronized.</span></span> <span data-ttu-id="b1711-253">См. в следующем разделе hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-253">See hello next section for details.</span></span>
7. <span data-ttu-id="b1711-254">После завершения закройте hello **свойства** диалоговое окно, нажав кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="b1711-254">When you're done, close hello **Properties** dialog by clicking **OK**.</span></span>
8. <span data-ttu-id="b1711-255">toocomplete hello конфигурации, необходимые toorun **полный импорт** и **разностной синхронизации**. Продолжить чтение раздела hello [применить и проверка изменений](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="b1711-255">toocomplete hello configuration, you need toorun a **Full import** and a **Delta sync**. Continue reading hello section [Apply and verify changes](#apply-and-verify-changes).</span></span>

### <a name="synchronize-new-ous"></a><span data-ttu-id="b1711-256">Синхронизация новых подразделений</span><span class="sxs-lookup"><span data-stu-id="b1711-256">Synchronize new OUs</span></span>
<span data-ttu-id="b1711-257">Новые подразделения, созданные после настройки фильтрации, синхронизируются по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b1711-257">New OUs that are created after filtering has been configured are synchronized by default.</span></span> <span data-ttu-id="b1711-258">Это состояние обозначается установленным флажком.</span><span class="sxs-lookup"><span data-stu-id="b1711-258">This state is indicated by a selected check box.</span></span> <span data-ttu-id="b1711-259">С некоторых подразделений можно снять флажки.</span><span class="sxs-lookup"><span data-stu-id="b1711-259">You can also unselect some sub-OUs.</span></span> <span data-ttu-id="b1711-260">tooget такое поведение, щелкните поле, hello, пока она не станет белый синяя галочка (состояние по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="b1711-260">tooget this behavior, click hello box until it becomes white with a blue check mark (its default state).</span></span> <span data-ttu-id="b1711-261">Затем снимите флажки для любой отделов, вы не хотите toosynchronize.</span><span class="sxs-lookup"><span data-stu-id="b1711-261">Then unselect any sub-OUs that you don't want toosynchronize.</span></span>

<span data-ttu-id="b1711-262">При синхронизации всех отделов hello поле имеет белый синяя галочка.</span><span class="sxs-lookup"><span data-stu-id="b1711-262">If all sub-OUs are synchronized, then hello box is white with a blue check mark.</span></span>  
![Подразделение со всеми установленными флажками](./media/active-directory-aadconnectsync-configure-filtering/ousyncnewall.png)

<span data-ttu-id="b1711-264">Если некоторые отделов был отменен, поле hello — серый с белой галочкой.</span><span class="sxs-lookup"><span data-stu-id="b1711-264">If some sub-OUs have been unselected, then hello box is gray with a white check mark.</span></span>  
![Подразделение, где не выбраны некоторые отделы](./media/active-directory-aadconnectsync-configure-filtering/ousyncnew.png)

<span data-ttu-id="b1711-266">С этой конфигурацией новое подразделение, созданное в ManagedObjects, синхронизируется.</span><span class="sxs-lookup"><span data-stu-id="b1711-266">With this configuration, a new OU that was created under ManagedObjects is synchronized.</span></span>

<span data-ttu-id="b1711-267">Мастер установки Hello Azure AD Connect всегда создает эту конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="b1711-267">hello Azure AD Connect installation wizard always creates this configuration.</span></span>

### <a name="dont-synchronize-new-ous"></a><span data-ttu-id="b1711-268">Как не синхронизировать новые подразделения</span><span class="sxs-lookup"><span data-stu-id="b1711-268">Don't synchronize new OUs</span></span>
<span data-ttu-id="b1711-269">Можно настроить синхронизацию hello toonot механизм синхронизации новых подразделениях после завершения hello конфигурацией фильтрации.</span><span class="sxs-lookup"><span data-stu-id="b1711-269">You can configure hello sync engine toonot synchronize new OUs after hello filtering configuration has finished.</span></span> <span data-ttu-id="b1711-270">Это состояние указывается в hello пользовательского интерфейса с hello поле отображаются сплошной серый без флажка.</span><span class="sxs-lookup"><span data-stu-id="b1711-270">This state is indicated in hello UI by hello box appearing solid gray with no check mark.</span></span> <span data-ttu-id="b1711-271">tooget такое поведение, щелкните поле, hello, пока она не станет белый без флажка.</span><span class="sxs-lookup"><span data-stu-id="b1711-271">tooget this behavior, click hello box until it becomes white with no check mark.</span></span> <span data-ttu-id="b1711-272">Затем выберите hello отделов, которые должны toosynchronize.</span><span class="sxs-lookup"><span data-stu-id="b1711-272">Then select hello sub-OUs that you want toosynchronize.</span></span>

![Подразделение с корнем hello не выбрано](./media/active-directory-aadconnectsync-configure-filtering/oudonotsyncnew.png)

<span data-ttu-id="b1711-274">С этой конфигурацией синхронизируется новое подразделение, созданное в ManagedObjects.</span><span class="sxs-lookup"><span data-stu-id="b1711-274">With this configuration, a new OU that was created under ManagedObjects isn't synchronized.</span></span>

## <a name="attribute-based-filtering"></a><span data-ttu-id="b1711-275">Фильтрация по атрибутам</span><span class="sxs-lookup"><span data-stu-id="b1711-275">Attribute-based filtering</span></span>
<span data-ttu-id="b1711-276">Убедитесь, что вы используете hello ноября 2015 г. ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)) или более поздней версии сборки, эти шаги toowork.</span><span class="sxs-lookup"><span data-stu-id="b1711-276">Make sure that you're using hello November 2015 ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)) or later build for these steps toowork.</span></span>

<span data-ttu-id="b1711-277">Фильтрация на основе атрибута — это hello самый гибкий способ toofilter объектов.</span><span class="sxs-lookup"><span data-stu-id="b1711-277">Attribute-based filtering is hello most flexible way toofilter objects.</span></span> <span data-ttu-id="b1711-278">Можно использовать возможности hello [декларативной подготовки](active-directory-aadconnectsync-understanding-declarative-provisioning.md) toocontrol практически все аспекты перевода объекта синхронизации tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-278">You can use hello power of [declarative provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md) toocontrol almost every aspect of when an object is synchronized tooAzure AD.</span></span>

<span data-ttu-id="b1711-279">Можно применить [входящий](#inbound-filtering) фильтрации из метавселенной toohello Active Directory, и [исходящих](#outbound-filtering) фильтрации из tooAzure метавселенной hello AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-279">You can apply [inbound](#inbound-filtering) filtering from Active Directory toohello metaverse, and [outbound](#outbound-filtering) filtering from hello metaverse tooAzure AD.</span></span> <span data-ttu-id="b1711-280">Рекомендуется применять фильтрация входящих сообщений, так как это самый простой toomaintain hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-280">We recommend that you apply inbound filtering because that is hello easiest toomaintain.</span></span> <span data-ttu-id="b1711-281">Фильтрация исходящего трафика, если он должен toojoin объекты из более чем одном лесе перед hello можно вычислить следует использовать только.</span><span class="sxs-lookup"><span data-stu-id="b1711-281">You should only use outbound filtering if it's required toojoin objects from more than one forest before hello evaluation can take place.</span></span>

### <a name="inbound-filtering"></a><span data-ttu-id="b1711-282">Фильтрация входящих объектов</span><span class="sxs-lookup"><span data-stu-id="b1711-282">Inbound filtering</span></span>
<span data-ttu-id="b1711-283">Фильтрация входящих сообщений использует конфигурацию по умолчанию hello, где объекты будут tooAzure AD, должны иметь hello метавселенной атрибут cloudFiltered не синхронизированы toobe значение tooa.</span><span class="sxs-lookup"><span data-stu-id="b1711-283">Inbound filtering uses hello default configuration, where objects going tooAzure AD must have hello metaverse attribute cloudFiltered not set tooa value toobe synchronized.</span></span> <span data-ttu-id="b1711-284">Если этот атрибут имеет значение слишком**True**, а затем hello объекта не синхронизировано.</span><span class="sxs-lookup"><span data-stu-id="b1711-284">If this attribute's value is set too**True**, then hello object isn't synchronized.</span></span> <span data-ttu-id="b1711-285">Его не следует задавать слишком**False**, намеренно.</span><span class="sxs-lookup"><span data-stu-id="b1711-285">It shouldn't be set too**False**, by design.</span></span> <span data-ttu-id="b1711-286">toomake убедиться, что другие правила имеют возможность toocontribute hello значение, этот атрибут только должен значения hello toohave **True** или **NULL** (absent).</span><span class="sxs-lookup"><span data-stu-id="b1711-286">toomake sure other rules have hello ability toocontribute a value, this attribute is only supposed toohave hello values **True** or **NULL** (absent).</span></span>

<span data-ttu-id="b1711-287">Фильтрация входящих сообщений используется в степень hello **область** toodetermine toosynchronize объектов или не синхронизируются.</span><span class="sxs-lookup"><span data-stu-id="b1711-287">In inbound filtering, you use hello power of **scope** toodetermine which objects toosynchronize or not synchronize.</span></span> <span data-ttu-id="b1711-288">Это на них можно вносить корректировки toofit требования вашей организации.</span><span class="sxs-lookup"><span data-stu-id="b1711-288">This is where you make adjustments toofit your own organization's requirements.</span></span> <span data-ttu-id="b1711-289">модуль Hello области имеет **группы** и **предложение** toodetermine, если в области правила синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-289">hello scope module has a **group** and a **clause** toodetermine when a sync rule is in scope.</span></span> <span data-ttu-id="b1711-290">В группе может содержаться одно или несколько предложений.</span><span class="sxs-lookup"><span data-stu-id="b1711-290">A group contains one or many clauses.</span></span> <span data-ttu-id="b1711-291">Если предложений несколько, в качестве их разделителя используется логический оператор AND, а при наличии нескольких групп — оператор OR.</span><span class="sxs-lookup"><span data-stu-id="b1711-291">There is a logical "AND" between multiple clauses, and a logical "OR" between multiple groups.</span></span>

<span data-ttu-id="b1711-292">Вот пример.</span><span class="sxs-lookup"><span data-stu-id="b1711-292">Let us look at an example:</span></span>  
<span data-ttu-id="b1711-293">![Область](./media/active-directory-aadconnectsync-configure-filtering/scope.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-293">![Scope](./media/active-directory-aadconnectsync-configure-filtering/scope.png)</span></span>  
<span data-ttu-id="b1711-294">Его следует рассматривать так: **(department = IT) OR (department = Sales AND c = US)**.</span><span class="sxs-lookup"><span data-stu-id="b1711-294">This should be read as **(department = IT) OR (department = Sales AND c = US)**.</span></span>

<span data-ttu-id="b1711-295">В hello следующие образцы и пошаговые инструкции, hello объекта-пользователя используется в качестве примера, но его можно использовать для всех типов объектов.</span><span class="sxs-lookup"><span data-stu-id="b1711-295">In hello following samples and steps, you use hello user object as an example, but you can use this for all object types.</span></span>

<span data-ttu-id="b1711-296">В следующих образцов hello значение приоритета hello начинается с 50.</span><span class="sxs-lookup"><span data-stu-id="b1711-296">In hello following samples, hello precedence value starts with 50.</span></span> <span data-ttu-id="b1711-297">Это может быть любое число меньше 100, которое еще не используется.</span><span class="sxs-lookup"><span data-stu-id="b1711-297">This can be any number not used, but should be lower than 100.</span></span>

#### <a name="negative-filtering-do-not-sync-these"></a><span data-ttu-id="b1711-298">Отрицательная фильтрация (выбор объектов, которые не следует синхронизировать)</span><span class="sxs-lookup"><span data-stu-id="b1711-298">Negative filtering: "do not sync these"</span></span>
<span data-ttu-id="b1711-299">В следующем примере hello, можно фильтровать (не синхронизировать) всех пользователей где **extensionAttribute15** имеет значение hello **NoSync**.</span><span class="sxs-lookup"><span data-stu-id="b1711-299">In hello following example, you filter out (not synchronize) all users where **extensionAttribute15** has hello value **NoSync**.</span></span>

1. <span data-ttu-id="b1711-300">Войдите в toohello сервера, на котором выполняется синхронизация Azure AD Connect, используя учетную запись, которая является членом hello **ADSyncAdmins** группы безопасности.</span><span class="sxs-lookup"><span data-stu-id="b1711-300">Sign in toohello server that is running Azure AD Connect sync by using an account that is a member of hello **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="b1711-301">Запуск **редактор правил синхронизации** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-301">Start **Synchronization Rules Editor** from hello **Start** menu.</span></span>
3. <span data-ttu-id="b1711-302">Выберите параметр **Входящие** и щелкните **Add New Rule** (Добавить новое правило).</span><span class="sxs-lookup"><span data-stu-id="b1711-302">Make sure **Inbound** is selected, and click **Add New Rule**.</span></span>
4. <span data-ttu-id="b1711-303">Присвойте правило hello описательное имя, такое как «*в from AD – User DoNotSyncFilter*».</span><span class="sxs-lookup"><span data-stu-id="b1711-303">Give hello rule a descriptive name, such as "*In from AD – User DoNotSyncFilter*".</span></span> <span data-ttu-id="b1711-304">Hello выберите правильный лес, выберите **пользователя** как hello **типа объекта CS**и выберите **лицо** как hello **типа объекта MV**.</span><span class="sxs-lookup"><span data-stu-id="b1711-304">Select hello correct forest, select **User** as hello **CS object type**, and select **Person** as hello **MV object type**.</span></span> <span data-ttu-id="b1711-305">В поле **Тип связи** выберите **Join** (Присоединение).</span><span class="sxs-lookup"><span data-stu-id="b1711-305">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="b1711-306">В поле **Приоритет** введите значение, которое не используется в другом правиле синхронизации (например, 50), и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-306">In **Precedence**, type a value that isn't currently used by another synchronization rule (for example 50), and then click **Next**.</span></span>  
   <span data-ttu-id="b1711-307">![Описание входящего объекта 1](./media/active-directory-aadconnectsync-configure-filtering/inbound1.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-307">![Inbound 1 description](./media/active-directory-aadconnectsync-configure-filtering/inbound1.png)</span></span>  
5. <span data-ttu-id="b1711-308">В поле **Scoping filter** (Фильтр области действия) выберите **Добавить группу** и щелкните **Добавить предложение**.</span><span class="sxs-lookup"><span data-stu-id="b1711-308">In **Scoping filter**, click **Add Group**, and click **Add Clause**.</span></span> <span data-ttu-id="b1711-309">В поле **Атрибут** выберите **ExtensionAttribute15**.</span><span class="sxs-lookup"><span data-stu-id="b1711-309">In **Attribute**, select **ExtensionAttribute15**.</span></span> <span data-ttu-id="b1711-310">Убедитесь, что **оператор** задано слишком**равно**и введите значение hello **NoSync** в hello **значение** поле.</span><span class="sxs-lookup"><span data-stu-id="b1711-310">Make sure that **Operator** is set too**EQUAL**, and type hello value **NoSync** in hello **Value** box.</span></span> <span data-ttu-id="b1711-311">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-311">Click **Next**.</span></span>  
   <span data-ttu-id="b1711-312">![Область входящего объекта 2](./media/active-directory-aadconnectsync-configure-filtering/inbound2.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-312">![Inbound 2 scope](./media/active-directory-aadconnectsync-configure-filtering/inbound2.png)</span></span>  
6. <span data-ttu-id="b1711-313">Оставьте hello **Join** правила пустым и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-313">Leave hello **Join** rules empty, and then click **Next**.</span></span>
7. <span data-ttu-id="b1711-314">Нажмите кнопку **добавить преобразование**выберите hello **FlowType** как **константой**и выберите **cloudFiltered** как hello  **Целевой атрибут**.</span><span class="sxs-lookup"><span data-stu-id="b1711-314">Click **Add Transformation**, select hello **FlowType** as **Constant**, and select **cloudFiltered** as hello **Target Attribute**.</span></span> <span data-ttu-id="b1711-315">В hello **источника** введите **True**.</span><span class="sxs-lookup"><span data-stu-id="b1711-315">In hello **Source** text box, type **True**.</span></span> <span data-ttu-id="b1711-316">Нажмите кнопку **добавить** toosave hello правило.</span><span class="sxs-lookup"><span data-stu-id="b1711-316">Click **Add** toosave hello rule.</span></span>  
   <span data-ttu-id="b1711-317">![Преобразование входящего объекта 3](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-317">![Inbound 3 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span></span>
8. <span data-ttu-id="b1711-318">toocomplete hello конфигурации, необходимые toorun **полная синхронизация**. Продолжить чтение раздела hello [применить и проверка изменений](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="b1711-318">toocomplete hello configuration, you need toorun a **Full sync**. Continue reading hello section [Apply and verify changes](#apply-and-verify-changes).</span></span>

#### <a name="positive-filtering-only-sync-these"></a><span data-ttu-id="b1711-319">Положительная фильтрация (выбор объектов, которые нужно синхронизировать)</span><span class="sxs-lookup"><span data-stu-id="b1711-319">Positive filtering: "only sync these"</span></span>
<span data-ttu-id="b1711-320">Выражения положительное Фильтрация может быть более сложной задачей, так как имеется tooconsider объекты, которые не являются очевидным toobe синхронизированы, таких как конференц-зале.</span><span class="sxs-lookup"><span data-stu-id="b1711-320">Expressing positive filtering can be more challenging because you also have tooconsider objects that aren't obvious toobe synchronized, such as conference rooms.</span></span> <span data-ttu-id="b1711-321">Вы также имеются фильтр по умолчанию hello toooverride переход в правило out-of-box hello **в из AD — User Join**.</span><span class="sxs-lookup"><span data-stu-id="b1711-321">You are also going toooverride hello default filter in hello out-of-box rule **In from AD - User Join**.</span></span> <span data-ttu-id="b1711-322">При создании пользовательского фильтра, убедитесь, что toonot включают критические системные объекты, объекты конфликтов репликации, специальные почтовые ящики и hello учетных записей служб для Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="b1711-322">When you create your custom filter, make sure toonot include critical system objects, replication conflict objects, special mailboxes, and hello service accounts for Azure AD Connect.</span></span>

<span data-ttu-id="b1711-323">параметр фильтрации положительное Hello требуется два правила синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-323">hello positive filtering option requires two sync rules.</span></span> <span data-ttu-id="b1711-324">Вам потребуется одно правило (или несколько) с областью правильный hello toosynchronize объектов.</span><span class="sxs-lookup"><span data-stu-id="b1711-324">You need one rule (or several) with hello correct scope of objects toosynchronize.</span></span> <span data-ttu-id="b1711-325">а другое правило должно быть универсальным, чтобы отсеять все объекты, не соответствующие объектам, подлежащим синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-325">You also need a second catch-all sync rule that filters out all objects that haven't yet been identified as an object that should be synchronized.</span></span>

<span data-ttu-id="b1711-326">В следующем примере hello, можно синхронизировать только пользовательские объекты, где hello отдел атрибут имеет значение hello **Sales**.</span><span class="sxs-lookup"><span data-stu-id="b1711-326">In hello following example, you only synchronize user objects where hello department attribute has hello value **Sales**.</span></span>

1. <span data-ttu-id="b1711-327">Войдите в toohello сервера, на котором выполняется синхронизация Azure AD Connect, используя учетную запись, которая является членом hello **ADSyncAdmins** группы безопасности.</span><span class="sxs-lookup"><span data-stu-id="b1711-327">Sign in toohello server that is running Azure AD Connect sync by using an account that is a member of hello **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="b1711-328">Запуск **редактор правил синхронизации** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-328">Start **Synchronization Rules Editor** from hello **Start** menu.</span></span>
3. <span data-ttu-id="b1711-329">Выберите параметр **Входящие** и щелкните **Add New Rule** (Добавить новое правило).</span><span class="sxs-lookup"><span data-stu-id="b1711-329">Make sure **Inbound** is selected, and click **Add New Rule**.</span></span>
4. <span data-ttu-id="b1711-330">Присвойте правило hello описательное имя, такое как «*из AD — пользователь продаж синхронизированы*».</span><span class="sxs-lookup"><span data-stu-id="b1711-330">Give hello rule a descriptive name, such as "*In from AD – User Sales sync*".</span></span> <span data-ttu-id="b1711-331">Hello выберите правильный лес, выберите **пользователя** как hello **типа объекта CS**и выберите **лицо** как hello **типа объекта MV**.</span><span class="sxs-lookup"><span data-stu-id="b1711-331">Select hello correct forest, select **User** as hello **CS object type**, and select **Person** as hello **MV object type**.</span></span> <span data-ttu-id="b1711-332">В поле **Тип связи** выберите **Join** (Присоединение).</span><span class="sxs-lookup"><span data-stu-id="b1711-332">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="b1711-333">В поле **Приоритет** введите значение, которое не используется в другом правиле синхронизации (например, 51), и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-333">In **Precedence**, type a value that isn't currently used by another synchronization rule (for example 51), and then click **Next**.</span></span>  
   <span data-ttu-id="b1711-334">![Описание входящего объекта 4](./media/active-directory-aadconnectsync-configure-filtering/inbound4.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-334">![Inbound 4 description](./media/active-directory-aadconnectsync-configure-filtering/inbound4.png)</span></span>  
5. <span data-ttu-id="b1711-335">В поле **Scoping filter** (Фильтр области действия) выберите **Добавить группу** и щелкните **Добавить предложение**.</span><span class="sxs-lookup"><span data-stu-id="b1711-335">In **Scoping filter**, click **Add Group**, and click **Add Clause**.</span></span> <span data-ttu-id="b1711-336">В разделе **Атрибут** выберите **department**.</span><span class="sxs-lookup"><span data-stu-id="b1711-336">In **Attribute**, select **department**.</span></span> <span data-ttu-id="b1711-337">Убедитесь, что оператор задано слишком**равно**и введите значение hello **продажи** в hello **значение** поле.</span><span class="sxs-lookup"><span data-stu-id="b1711-337">Make sure that Operator is set too**EQUAL**, and type hello value **Sales** in hello **Value** box.</span></span> <span data-ttu-id="b1711-338">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-338">Click **Next**.</span></span>  
   <span data-ttu-id="b1711-339">![Область входящего объекта 5](./media/active-directory-aadconnectsync-configure-filtering/inbound5.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-339">![Inbound 5 scope](./media/active-directory-aadconnectsync-configure-filtering/inbound5.png)</span></span>  
6. <span data-ttu-id="b1711-340">Оставьте hello **Join** правила пустым и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-340">Leave hello **Join** rules empty, and then click **Next**.</span></span>
7. <span data-ttu-id="b1711-341">Нажмите кнопку **добавить преобразование**выберите **константой** как hello **FlowType**и выберите hello **cloudFiltered** как hello  **Целевой атрибут**.</span><span class="sxs-lookup"><span data-stu-id="b1711-341">Click **Add Transformation**, select **Constant** as hello **FlowType**, and select hello **cloudFiltered** as hello **Target Attribute**.</span></span> <span data-ttu-id="b1711-342">В hello **источника** введите **False**.</span><span class="sxs-lookup"><span data-stu-id="b1711-342">In hello **Source** box, type **False**.</span></span> <span data-ttu-id="b1711-343">Нажмите кнопку **добавить** toosave hello правило.</span><span class="sxs-lookup"><span data-stu-id="b1711-343">Click **Add** toosave hello rule.</span></span>  
   <span data-ttu-id="b1711-344">![Преобразование входящего объекта 6](./media/active-directory-aadconnectsync-configure-filtering/inbound6.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-344">![Inbound 6 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound6.png)</span></span>  
   <span data-ttu-id="b1711-345">Это особый случай, где вы явным образом задать cloudFiltered слишком**False**.</span><span class="sxs-lookup"><span data-stu-id="b1711-345">This is a special case where you explicitly set cloudFiltered too**False**.</span></span>
8. <span data-ttu-id="b1711-346">Теперь у нас есть правило синхронизации универсальным toocreate hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-346">We now have toocreate hello catch-all sync rule.</span></span> <span data-ttu-id="b1711-347">Присвойте правило hello описательное имя, такое как «*в from AD – пользователь универсальным фильтра*».</span><span class="sxs-lookup"><span data-stu-id="b1711-347">Give hello rule a descriptive name, such as "*In from AD – User Catch-all filter*".</span></span> <span data-ttu-id="b1711-348">Hello выберите правильный лес, выберите **пользователя** как hello **типа объекта CS**и выберите **лицо** как hello **типа объекта MV**.</span><span class="sxs-lookup"><span data-stu-id="b1711-348">Select hello correct forest, select **User** as hello **CS object type**, and select **Person** as hello **MV object type**.</span></span> <span data-ttu-id="b1711-349">В поле **Тип связи** выберите **Join** (Присоединение).</span><span class="sxs-lookup"><span data-stu-id="b1711-349">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="b1711-350">В поле **Приоритет** введите значение, которое не используется в другом правиле синхронизации (например, 99).</span><span class="sxs-lookup"><span data-stu-id="b1711-350">In **Precedence**, type a value that isn't currently used by another Synchronization Rule (for example 99).</span></span> <span data-ttu-id="b1711-351">Вы выбрали значение приоритета, имеет приоритет выше, (нижнем) чем hello предыдущего правила синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-351">You've selected a precedence value that is higher (lower precedence) than hello previous sync rule.</span></span> <span data-ttu-id="b1711-352">Но вы также оставили дополнительное пространство, можно добавить несколько правил синхронизации позже при необходимости toostart Синхронизация дополнительных отделов.</span><span class="sxs-lookup"><span data-stu-id="b1711-352">But you've also left some room so that you can add more filtering sync rules later when you want toostart synchronizing additional departments.</span></span> <span data-ttu-id="b1711-353">Щелкните **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-353">Click **Next**.</span></span>  
   <span data-ttu-id="b1711-354">![Описание входящего объекта 7](./media/active-directory-aadconnectsync-configure-filtering/inbound7.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-354">![Inbound 7 description](./media/active-directory-aadconnectsync-configure-filtering/inbound7.png)</span></span>  
9. <span data-ttu-id="b1711-355">Оставьте поле **Scoping filter** (Фильтр области) пустым и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-355">Leave **Scoping filter** empty, and click **Next**.</span></span> <span data-ttu-id="b1711-356">Пустой фильтр указывает hello правила применения toobe tooall объектов.</span><span class="sxs-lookup"><span data-stu-id="b1711-356">An empty filter indicates that hello rule is toobe applied tooall objects.</span></span>
10. <span data-ttu-id="b1711-357">Оставьте hello **Join** правила пустым и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="b1711-357">Leave hello **Join** rules empty, and then click **Next**.</span></span>
11. <span data-ttu-id="b1711-358">Нажмите кнопку **добавить преобразование**выберите **константой** как hello **FlowType**и выберите **cloudFiltered** как hello  **Целевой атрибут**.</span><span class="sxs-lookup"><span data-stu-id="b1711-358">Click **Add Transformation**, select **Constant** as hello **FlowType**, and select **cloudFiltered** as hello **Target Attribute**.</span></span> <span data-ttu-id="b1711-359">В hello **источника** введите **True**.</span><span class="sxs-lookup"><span data-stu-id="b1711-359">In hello **Source** box, type **True**.</span></span> <span data-ttu-id="b1711-360">Нажмите кнопку **добавить** toosave hello правило.</span><span class="sxs-lookup"><span data-stu-id="b1711-360">Click **Add** toosave hello rule.</span></span>  
    <span data-ttu-id="b1711-361">![Преобразование входящего объекта 3](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-361">![Inbound 3 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span></span>  
12. <span data-ttu-id="b1711-362">toocomplete hello конфигурации, необходимые toorun **полная синхронизация**. Продолжить чтение раздела hello [применить и проверка изменений](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="b1711-362">toocomplete hello configuration, you need toorun a **Full sync**. Continue reading hello section [Apply and verify changes](#apply-and-verify-changes).</span></span>

<span data-ttu-id="b1711-363">Если необходимо, можно создать дополнительные правила hello первого типа, где содержат несколько объектов в hello синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-363">If you need to, you can create more rules of hello first type where you include more objects in hello synchronization.</span></span>

### <a name="outbound-filtering"></a><span data-ttu-id="b1711-364">Фильтрация исходящих объектов</span><span class="sxs-lookup"><span data-stu-id="b1711-364">Outbound filtering</span></span>
<span data-ttu-id="b1711-365">В некоторых случаях это hello необходимые toodo фильтрацию только после присоединения hello объектов в метавселенной hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-365">In some cases, it's necessary toodo hello filtering only after hello objects have joined in hello metaverse.</span></span> <span data-ttu-id="b1711-366">Например бывает необходимо toolook hello атрибут mail из леса ресурсов hello и hello атрибут userPrincipalName из леса учетных записей hello, toodetermine, если объект, должны быть синхронизированы.</span><span class="sxs-lookup"><span data-stu-id="b1711-366">For example, it might be necessary toolook at hello mail attribute from hello resource forest, and hello userPrincipalName attribute from hello account forest, toodetermine if an object should be synchronized.</span></span> <span data-ttu-id="b1711-367">В таких случаях создание hello, фильтрация по hello правило исходящего трафика.</span><span class="sxs-lookup"><span data-stu-id="b1711-367">In these cases, you create hello filtering on hello outbound rule.</span></span>

<span data-ttu-id="b1711-368">В этом примере Изменение hello фильтрации, чтобы имеют только пользователи, как почта, так и userPrincipalName, заканчивающиеся на @contoso.com синхронизации:</span><span class="sxs-lookup"><span data-stu-id="b1711-368">In this example, you change hello filtering so that only users that have both their mail and userPrincipalName ending in @contoso.com are synchronized:</span></span>

1. <span data-ttu-id="b1711-369">Войдите в toohello сервера, на котором выполняется синхронизация Azure AD Connect, используя учетную запись, которая является членом hello **ADSyncAdmins** группы безопасности.</span><span class="sxs-lookup"><span data-stu-id="b1711-369">Sign in toohello server that is running Azure AD Connect sync by using an account that is a member of hello **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="b1711-370">Запуск **редактор правил синхронизации** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-370">Start **Synchronization Rules Editor** from hello **Start** menu.</span></span>
3. <span data-ttu-id="b1711-371">В разделе **Rules Type** (Тип правил) выберите **Outbound** (Исходящие).</span><span class="sxs-lookup"><span data-stu-id="b1711-371">Under **Rules Type**, click **Outbound**.</span></span>
4. <span data-ttu-id="b1711-372">Правило hello поиска с именем **Out tooAAD – User Join**и нажмите кнопку **изменить**.</span><span class="sxs-lookup"><span data-stu-id="b1711-372">Find hello rule named **Out tooAAD – User Join**, and click **Edit**.</span></span>
5. <span data-ttu-id="b1711-373">Во всплывающем hello ответить **Да** toocreate копию hello правило.</span><span class="sxs-lookup"><span data-stu-id="b1711-373">In hello pop-up, answer **Yes** toocreate a copy of hello rule.</span></span>
6. <span data-ttu-id="b1711-374">На hello **описание** измените **приоритет** tooan неиспользуемые значения, например 50.</span><span class="sxs-lookup"><span data-stu-id="b1711-374">On hello **Description** page, change **Precedence** tooan unused value, such as 50.</span></span>
7. <span data-ttu-id="b1711-375">Нажмите кнопку **фильтр области** на hello навигации слева, затем щелкните **добавить предложение**.</span><span class="sxs-lookup"><span data-stu-id="b1711-375">Click **Scoping filter** on hello left-hand navigation, and then click **Add clause**.</span></span> <span data-ttu-id="b1711-376">В разделе **Атрибут** выберите **mail**.</span><span class="sxs-lookup"><span data-stu-id="b1711-376">In **Attribute**, select **mail**.</span></span> <span data-ttu-id="b1711-377">В разделе **Оператор** выберите **ENDSWITH**.</span><span class="sxs-lookup"><span data-stu-id="b1711-377">In **Operator**, select **ENDSWITH**.</span></span> <span data-ttu-id="b1711-378">В разделе **Значение** введите **@contoso.com**, а затем щелкните **Добавить предложение**.</span><span class="sxs-lookup"><span data-stu-id="b1711-378">In **Value**, type **@contoso.com**, and then click **Add clause**.</span></span> <span data-ttu-id="b1711-379">В разделе **Атрибут** выберите **userPrincipalName**.</span><span class="sxs-lookup"><span data-stu-id="b1711-379">In **Attribute**, select **userPrincipalName**.</span></span> <span data-ttu-id="b1711-380">В разделе **Оператор** выберите **ENDSWITH**.</span><span class="sxs-lookup"><span data-stu-id="b1711-380">In **Operator**, select **ENDSWITH**.</span></span> <span data-ttu-id="b1711-381">В разделе **Значение** введите **@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="b1711-381">In **Value**, type **@contoso.com**.</span></span>
8. <span data-ttu-id="b1711-382">Щелкните **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="b1711-382">Click **Save**.</span></span>
9. <span data-ttu-id="b1711-383">toocomplete hello конфигурации, необходимые toorun **полная синхронизация**. Продолжить чтение раздела hello [применить и проверка изменений](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="b1711-383">toocomplete hello configuration, you need toorun a **Full sync**. Continue reading hello section [Apply and verify changes](#apply-and-verify-changes).</span></span>

## <a name="apply-and-verify-changes"></a><span data-ttu-id="b1711-384">Примените и проверьте изменения</span><span class="sxs-lookup"><span data-stu-id="b1711-384">Apply and verify changes</span></span>
<span data-ttu-id="b1711-385">После внесения изменения конфигурации, необходимо применить их toohello объекты, которые уже присутствуют в системе hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-385">After you've made your configuration changes, you must apply them toohello objects that are already present in hello system.</span></span> <span data-ttu-id="b1711-386">Он также может быть обработки hello объекты, которые в настоящее время отсутствуют в модуль синхронизации hello (и подсистема синхронизации hello должен tooread hello исходной системы снова tooverify его содержимое).</span><span class="sxs-lookup"><span data-stu-id="b1711-386">It might also be that hello objects that aren't currently in hello sync engine should be processed (and hello sync engine needs tooread hello source system again tooverify its content).</span></span>

<span data-ttu-id="b1711-387">Если вы изменили hello конфигурацию с помощью **домена** или **подразделения** фильтрации, то вы должны toodo **полный импорт**, за которым следует **дельта Синхронизация**.</span><span class="sxs-lookup"><span data-stu-id="b1711-387">If you changed hello configuration by using **domain** or **organizational-unit** filtering, then you need toodo a **Full import**, followed by **Delta synchronization**.</span></span>

<span data-ttu-id="b1711-388">Если вы изменили hello конфигурацию с помощью **атрибута** фильтрации, то вы должны toodo **полная синхронизация**.</span><span class="sxs-lookup"><span data-stu-id="b1711-388">If you changed hello configuration by using **attribute** filtering, then you need toodo a **Full synchronization**.</span></span>

<span data-ttu-id="b1711-389">Здравствуйте, следующие действия:</span><span class="sxs-lookup"><span data-stu-id="b1711-389">Do hello following steps:</span></span>

1. <span data-ttu-id="b1711-390">Запуск **служба синхронизации** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-390">Start **Synchronization Service** from hello **Start** menu.</span></span>
2. <span data-ttu-id="b1711-391">Выберите **Соединители**.</span><span class="sxs-lookup"><span data-stu-id="b1711-391">Select **Connectors**.</span></span> <span data-ttu-id="b1711-392">В hello **соединители** выберите hello соединителя, где был сделан ранее изменение конфигурации.</span><span class="sxs-lookup"><span data-stu-id="b1711-392">In hello **Connectors** list, select hello Connector where you made a configuration change earlier.</span></span> <span data-ttu-id="b1711-393">В разделе **Действия** выберите **Запуск**.</span><span class="sxs-lookup"><span data-stu-id="b1711-393">In **Actions**, select **Run**.</span></span>  
   <span data-ttu-id="b1711-394">![Выполнение соединителя](./media/active-directory-aadconnectsync-configure-filtering/connectorrun.png)</span><span class="sxs-lookup"><span data-stu-id="b1711-394">![Connector run](./media/active-directory-aadconnectsync-configure-filtering/connectorrun.png)</span></span>  
3. <span data-ttu-id="b1711-395">В **профили запуска**, выберите операцию hello, описанный в предыдущем разделе hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-395">In **Run profiles**, select hello operation that was mentioned in hello previous section.</span></span> <span data-ttu-id="b1711-396">Если требуется два действия toorun выполнения hello, во-вторых, после hello первый завершено.</span><span class="sxs-lookup"><span data-stu-id="b1711-396">If you need toorun two actions, run hello second after hello first one has finished.</span></span> <span data-ttu-id="b1711-397">(hello **состояние** столбец **Idle** для соединителя выбран hello.)</span><span class="sxs-lookup"><span data-stu-id="b1711-397">(hello **State** column is **Idle** for hello selected connector.)</span></span>

<span data-ttu-id="b1711-398">После синхронизации hello все изменения будут промежуточных toobe экспортированы.</span><span class="sxs-lookup"><span data-stu-id="b1711-398">After hello synchronization, all changes are staged toobe exported.</span></span> <span data-ttu-id="b1711-399">Перед внесением изменений hello фактически в Azure AD требуется tooverify правильность этих изменений.</span><span class="sxs-lookup"><span data-stu-id="b1711-399">Before you actually make hello changes in Azure AD, you want tooverify that all these changes are correct.</span></span>

1. <span data-ttu-id="b1711-400">Откройте командную строку и перейдите слишком`%Program Files%\Microsoft Azure AD Sync\bin`.</span><span class="sxs-lookup"><span data-stu-id="b1711-400">Start a command prompt, and go too`%Program Files%\Microsoft Azure AD Sync\bin`.</span></span>
2. <span data-ttu-id="b1711-401">Запустите `csexport "Name of Connector" %temp%\export.xml /f:x`.</span><span class="sxs-lookup"><span data-stu-id="b1711-401">Run `csexport "Name of Connector" %temp%\export.xml /f:x`.</span></span>  
   <span data-ttu-id="b1711-402">Имя Hello hello соединителя — в службе синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-402">hello name of hello Connector is in Synchronization Service.</span></span> <span data-ttu-id="b1711-403">Она имеет аналогичные too"contoso.com имя — AAD» для Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-403">It has a name similar too"contoso.com – AAD" for Azure AD.</span></span>
3. <span data-ttu-id="b1711-404">Запустите `CSExportAnalyzer %temp%\export.xml > %temp%\export.csv`.</span><span class="sxs-lookup"><span data-stu-id="b1711-404">Run `CSExportAnalyzer %temp%\export.xml > %temp%\export.csv`.</span></span>
4. <span data-ttu-id="b1711-405">Теперь у вас в папке %temp% есть файл export.csv, который можно просмотреть в Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="b1711-405">You now have a file in %temp% named export.csv that can be examined in Microsoft Excel.</span></span> <span data-ttu-id="b1711-406">Этот файл содержит все изменения hello, высока вероятность toobe экспортированы.</span><span class="sxs-lookup"><span data-stu-id="b1711-406">This file contains all hello changes that are about toobe exported.</span></span>
5. <span data-ttu-id="b1711-407">Внесите необходимые изменения hello toohello данных или конфигурации и выполните эти шаги еще раз (импорта, синхронизации и проверьте) до hello изменения, которые будут экспортированы toobe, как ожидалось.</span><span class="sxs-lookup"><span data-stu-id="b1711-407">Make hello necessary changes toohello data or configuration, and run these steps again (Import, Synchronize, and Verify) until hello changes that are about toobe exported are what you expect.</span></span>

<span data-ttu-id="b1711-408">Если вы удовлетворены, экспорта tooAzure изменения hello AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-408">When you're satisfied, export hello changes tooAzure AD.</span></span>

1. <span data-ttu-id="b1711-409">Выберите **Соединители**.</span><span class="sxs-lookup"><span data-stu-id="b1711-409">Select **Connectors**.</span></span> <span data-ttu-id="b1711-410">В hello **соединители** выберите hello соединителя Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-410">In hello **Connectors** list, select hello Azure AD Connector.</span></span> <span data-ttu-id="b1711-411">В разделе **Действия** выберите **Запуск**.</span><span class="sxs-lookup"><span data-stu-id="b1711-411">In **Actions**, select **Run**.</span></span>
2. <span data-ttu-id="b1711-412">В разделе **Run profiles** (Профили выполнения) выберите **Экспорт**.</span><span class="sxs-lookup"><span data-stu-id="b1711-412">In **Run profiles**, select **Export**.</span></span>
3. <span data-ttu-id="b1711-413">Если изменения конфигурации удаляют множество объектов, появится сообщение об ошибке в файле экспорта hello, когда номер hello больше, чем пороговое значение hello настроен (по умолчанию 500).</span><span class="sxs-lookup"><span data-stu-id="b1711-413">If your configuration changes delete many objects, then you see an error in hello export when hello number is more than hello configured threshold (by default 500).</span></span> <span data-ttu-id="b1711-414">Если данная ошибка возникает, то вы должны отключить hello tootemporarily "[избежать случайного удаления](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)» компонента.</span><span class="sxs-lookup"><span data-stu-id="b1711-414">If you see this error, then you need tootemporarily disable hello "[prevent accidental deletes](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)" feature.</span></span>

<span data-ttu-id="b1711-415">Теперь настало время tooenable hello планировщика еще раз.</span><span class="sxs-lookup"><span data-stu-id="b1711-415">Now it's time tooenable hello scheduler again.</span></span>

1. <span data-ttu-id="b1711-416">Запуск **планировщик** из hello **запустить** меню.</span><span class="sxs-lookup"><span data-stu-id="b1711-416">Start **Task Scheduler** from hello **Start** menu.</span></span>
2. <span data-ttu-id="b1711-417">Непосредственно под **Библиотека планировщика заданий**, задачу hello поиска с именем **Azure AD Sync Scheduler**, щелкните правой кнопкой мыши и выберите **включить**.</span><span class="sxs-lookup"><span data-stu-id="b1711-417">Directly under **Task Scheduler Library**, find hello task named **Azure AD Sync Scheduler**, right-click, and select **Enable**.</span></span>

## <a name="group-based-filtering"></a><span data-ttu-id="b1711-418">Фильтрация на основе группы</span><span class="sxs-lookup"><span data-stu-id="b1711-418">Group-based filtering</span></span>
<span data-ttu-id="b1711-419">Можно настроить на основе групповой фильтрации hello первый раз установить Azure AD Connect с помощью [выборочной установки](active-directory-aadconnect-get-started-custom.md#sync-filtering-based-on-groups).</span><span class="sxs-lookup"><span data-stu-id="b1711-419">You can configure group-based filtering hello first time that you install Azure AD Connect by using [custom installation](active-directory-aadconnect-get-started-custom.md#sync-filtering-based-on-groups).</span></span> <span data-ttu-id="b1711-420">Он предназначен для того, Пилотное развертывание место только небольшому числу toobe объектов синхронизации.</span><span class="sxs-lookup"><span data-stu-id="b1711-420">It's intended for a pilot deployment where you want only a small set of objects toobe synchronized.</span></span> <span data-ttu-id="b1711-421">После отключения фильтрацию на основе группы невозможно будет включить заново.</span><span class="sxs-lookup"><span data-stu-id="b1711-421">When you disable group-based filtering, it can't be enabled again.</span></span> <span data-ttu-id="b1711-422">Он имеет *не поддерживается* toouse фильтрации в пользовательской конфигурации на основе групп.</span><span class="sxs-lookup"><span data-stu-id="b1711-422">It's *not supported* toouse group-based filtering in a custom configuration.</span></span> <span data-ttu-id="b1711-423">Он поддерживается только tooconfigure этой функции с помощью мастера установки hello.</span><span class="sxs-lookup"><span data-stu-id="b1711-423">It's only supported tooconfigure this feature by using hello installation wizard.</span></span> <span data-ttu-id="b1711-424">После завершения вашего пилотного развертывания, выполните одно из hello другие параметры фильтрации в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="b1711-424">When you've completed your pilot, then use one of hello other filtering options in this topic.</span></span> <span data-ttu-id="b1711-425">При использовании Подразделение фильтрации на основе вместе с фильтрации на основе группы, должен быть включен hello OU(s), где находятся группы hello и его членах.</span><span class="sxs-lookup"><span data-stu-id="b1711-425">When using OU-based filtering in conjunction with group-based filtering, hello OU(s) where hello group and its members are located must be included.</span></span>

<span data-ttu-id="b1711-426">При синхронизации нескольких лесов AD можно настроить фильтрацию по группам, указав отдельные группы для каждого соединителя AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-426">When synchronizing multiple AD forests, you can configure group-based filtering by specifying a different group for each AD connector.</span></span> <span data-ttu-id="b1711-427">Если нужно toosynchronize пользователя в одном лесу AD и hello же пользователь имеет один или более соответствующих FSP (внешней безопасности) объектов в других лесах AD необходимо убедиться, hello объекта пользователя и его соответствующим FSP объекты находятся в групповые Фильтрация области.</span><span class="sxs-lookup"><span data-stu-id="b1711-427">If you wish toosynchronize a user in one AD forest and hello same user has one or more corresponding FSP (Foreign Security Principal) objects in other AD forests, you must ensure that hello user object and all its corresponding FSP objects are within group-based filtering scope.</span></span> <span data-ttu-id="b1711-428">Если один или несколько объектов FSP hello исключаются фильтром на основе групп, hello объекта-пользователя не будет синхронизированные tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="b1711-428">If one or more of hello FSP objects are excluded by group-based filtering, hello user object will not be synchronized tooAzure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b1711-429">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b1711-429">Next steps</span></span>
- <span data-ttu-id="b1711-430">Сведения о настройке службы синхронизации Azure AD Connect см. в [этой статье](active-directory-aadconnectsync-whatis.md).</span><span class="sxs-lookup"><span data-stu-id="b1711-430">Learn more about [Azure AD Connect sync](active-directory-aadconnectsync-whatis.md) configuration.</span></span>
- <span data-ttu-id="b1711-431">Сведения об интеграции локальных удостоверений с Azure Active Directory см. в [этой статье](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="b1711-431">Learn more about [integrating your on-premises identities with Azure AD](active-directory-aadconnect.md).</span></span>
