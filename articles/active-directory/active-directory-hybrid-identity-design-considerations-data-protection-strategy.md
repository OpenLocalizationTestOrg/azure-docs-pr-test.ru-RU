---
title: "Рекомендации по разработке архитектуры гибридной идентификации в Azure Active Directory ― определение стратегии защиты данных | Документация Майкрософт"
description: "С помощью этой статьи вы сможете определить стратегии защиты данных для гибридных решений идентификации, соответствующие определенным вами бизнес-критериям."
documentationcenter: 
services: active-directory
author: billmath
manager: femila
editor: 
ms.assetid: e76fd1f4-340a-492a-84d9-e05f3b7cc396
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 07/18/2017
ms.author: billmath
ms.openlocfilehash: 6c9b7423fa56886104bc6060d25904277b75f30c
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="define-data-protection-strategy-for-your-hybrid-identity-solution"></a>Определение стратегии защиты данных для гибридного решения идентификации
В этой статье вы определите стратегию защиты данных для гибридных решений идентификации, которая соответствует требованиям, выработанным с помощью таких статей:

* [Определение требований к защите данных](active-directory-hybrid-identity-design-considerations-dataprotection-requirements.md)
* [Определение требований к управлению содержимым](active-directory-hybrid-identity-design-considerations-contentmgt-requirements.md)
* [Определение требований к контролю доступа](active-directory-hybrid-identity-design-considerations-accesscontrol-requirements.md)
* [Определение требований по реагированию на инциденты](active-directory-hybrid-identity-design-considerations-incident-response-requirements.md)

## <a name="define-data-protection-options"></a>Определение вариантов защиты данных
Как было описано в статье [Определение требований к синхронизации каталогов](active-directory-hybrid-identity-design-considerations-directory-sync-requirements.md), Microsoft Azure AD может синхронизироваться с вашими локальными доменными службами Active Directory. Такая интеграция позволяет использовать Azure AD для проверки учетных данных пользователей, которые пытаются получить доступ к корпоративным ресурсам. Это возможно для обоих сценариев: при хранении неактивных данных локально или в облаке.  Доступ к данным в Azure AD требует проверки подлинности пользователя через службу маркеров безопасности.

После проверки подлинности служба получает имя участника-пользователя из токена проверки подлинности и определяет реплицированный раздел и контейнер, соответствующие домену пользователя. Система авторизации определяет, имеет ли этот пользователь в этом сеансе право на доступ требуемого типа к целевому клиенту. Решение принимается на основе информации о существовании, состоянии активности и роли пользователя. Для некоторых действий (в частности, для создания пользователя и сброса пароля) создается журнал аудита, который администратор клиента может использовать для проверки попыток соответствия требованиям и для расследования нарушений.

Перенос данных из локального центра обработки данных в службу хранилища Azure через интернет-соединение может быть невозможен из-за большого объема данных, низкой пропускной способности канала или по другим причинам. [Служба импорта и экспорта хранилища Azure](../storage/common/storage-import-export-service.md) позволяет использовать аппаратное решение для размещения или извлечения больших объемов данных в хранилище больших двоичных объектов. Она позволяет отправить жесткие диски, [зашифрованные BitLocker](https://technet.microsoft.com/library/dn306081#BKMK_BL2012R2) , напрямую в центр данных Azure, где операторы облака смогут передавать данные в вашу учетную запись хранения или загружать данные из Azure на ваши диски. Для этого годятся только зашифрованные диски (при этом используется ключ BitLocker, создаваемый службой во время установки). Этот ключ BitLocker предоставляется в Azure отдельно, и это делает возможным внеполосный совместный доступ к ключам.

Передача данных может выполняться в различных сценариях, и здесь важно помнить, что Microsoft Azure использует для изолирования трафика клиентов друг от друга [виртуальные сети](https://azure.microsoft.com/documentation/services/virtual-network/). Служба применяет такие меры, как брандмауэры на уровне узла или посетителя, фильтрацию IP-пакетов, блокировку портов и поддержку HTTPS на конечных точках. Впрочем, шифруется и значительная часть внутренних коммуникаций Azure, в том числе передача данных между инфраструктурами и от инфраструктуры к клиенту (к локальному расположению). Еще один важный сценарий — передача данных внутри центров обработки данных Azure. Сети корпорации Майкрософт организованы так, что ни одна виртуальная машина не может олицетворять или подслушивать чужой IP-адрес. При доступе к службе хранилища Azure или к базам данных SQL, а также при подключении к облачным службам используется протокол TLS/SSL. В этом случае администратор клиента обязан получить сертификат TLS/SSL и развернуть его в клиентской инфраструктуре. Перемещение данных через виртуальную сеть Microsoft Azure между виртуальными машинами в одном развертывании или между клиентами в одном развертывании можно защитить протоколом шифрования соединений, например HTTPS, SSL/TLS или любым другим.

Теперь на основании ваших ответов на вопросы раздела [Определения требований к защите данных](active-directory-hybrid-identity-design-considerations-dataprotection-requirements.md)вы можете выбрать подходящий способ защиты данных и определить возможность использования в этих целях гибридного решения. В таблице показаны варианты, которые поддерживает Azure для каждого сценария защиты данных.

| Варианты защиты данных | При хранении в облаке | При локальном хранении | В пути |
| --- | --- | --- | --- |
| Шифрование диска BitLocker |X |X | |
| Шифрование баз данных на сервере SQL Server |X |X | |
| Шифрование трафика между виртуальными машинами | | |X |
| Протокол SSL/TLS | | |X |
| Виртуальная частная сеть | | |X |

> [!NOTE]
> Ознакомьтесь со статьей [Соответствие продуктов требованиям](https://azure.microsoft.com/support/trust-center/services/) в [центре управления безопасностью Microsoft Azure](https://azure.microsoft.com/support/trust-center/), которая расскажет о том, каким сертификатам соответствует каждая служба Azure.
> Указанные варианты защиты данных подразумевают многоуровневый подход, поэтому их сравнение в рамках этой статьи невозможно. Постарайтесь использовать все возможные варианты для каждого состояния, в котором будут находиться ваши данные.
>
>

## <a name="define-content-management-options"></a>Определение параметров управления содержимым
Использование Azure AD для управления гибридной инфраструктурой идентификации имеет важное преимущество: полностью прозрачный для конечного пользователя процесс. Пользователь обращается к общему ресурсу, ресурс запрашивает проверку подлинности, пользователь отправляет в Azure AD запрос проверки подлинности и получает маркер, дающий доступ к ресурсу. Весь процесс происходит в фоновом режиме, без прямого участия пользователя. Кроме того, есть возможность предоставить разрешение [группе](active-directory-manage-groups.md#getting-started-with-access-management) пользователей на выполнение стандартных действий.

Организации, которые уделяют внимание конфиденциальности данных, обычно выбирают решения, которые позволяют классифицировать данные. Если в локальной инфраструктуре уже используется классификация данных, можно разместить в Azure AD основной репозиторий учетных данных пользователей. Для классификации данных в локальных службах широко используется [набор средств классификации данных](https://msdn.microsoft.com/library/Hh204743.aspx) , который входит в состав Windows Server 2012 R2. Этот набор помогает идентифицировать, классифицировать и защищать данные на файловых серверах частного облака. Кроме того, для этих целей можно использовать [автоматическую классификацию файлов](https://technet.microsoft.com/library/hh831672.aspx) в Windows Server 2012.

Если в вашей организации не используется классификация данных, но есть необходимость защищать конфиденциальные файлы, не добавляя новые локальные серверы, то можно использовать [службу Microsoft Azure Rights Management](https://technet.microsoft.com/library/JJ585026.aspx).  Эта служба использует для защиты файлов и электронной почты шифрование, удостоверения и политики авторизации. Она может работать на различных устройствах — телефонах, планшетных и настольных компьютерах. Служба управления правами Azure является облачной службой, поэтому для использования защищенных данных совместно с другими организациями не нужно отдельно настраивать отношения доверия. Если у ваших партнеров уже есть Office 365 или каталог Azure AD, совместная работа между организациями будет автоматически возможна. Вы также можете синхронизировать только атрибуты каталога, которые Azure RMS использует для поддержки общих удостоверений локальных учетных записей Active Directory. В этом вам помогут службы синхронизации Active Directory для Azure (AAD Sync) и Azure AD Connect.

Для управления содержимым важно хорошо понимать, кто обращается к каким ресурсам, поэтому в хорошем решении по управлению идентификацией следует создать широкие возможности для ведения журналов. Azure AD поддерживает журналы за 30 дней, в которых сохраняются:

* изменения членства в ролях (например, добавление пользователя в роль глобального администратора);
* изменение учетных данных (например, изменение пароля);
* управление доменами (например, проверка пользовательского домена или удаление домена);
* добавление и удаление приложений;
* управление пользователями (например, добавление, удаление или обновление пользователя);
* добавление и удаление лицензий.

> [!NOTE]
> Дополнительные сведения о возможности ведения журналов в Azure вы найдете в документе [Управление журналами безопасности и аудита Microsoft Azure](http://download.microsoft.com/download/B/6/C/B6C0A98B-D34A-417C-826E-3EA28CDFC9DD/AzureSecurityandAuditLogManagement_11132014.pdf) .
> Теперь на основании ваших ответов на вопросы раздела [Определения требований к управлению содержимым](active-directory-hybrid-identity-design-considerations-contentmgt-requirements.md)вы можете выбрать подходящий способ управления содержимым в гибридном решении идентификации. Azure AD может интегрироваться с любым вариантом, который представлен в таблице 6, но вам важно выбрать наиболее подходящий для целей вашего бизнеса.
>
>

| Варианты управления содержимым | Преимущества | Недостатки |
| --- | --- | --- |
| Централизованное локальное управление (сервер управления правами Active Directory) |Полный контроль над серверной инфраструктурой, отвечающей за классификацию данных. <br> Встроенная возможность в Windows Server, не требующая дополнительных лицензий или подписок. <br> Возможность интеграции с Azure AD в гибридном сценарии. <br> Поддерживает управление правами на доступ к данным (IRM) в службах Microsoft Online Services, например Exchange Online и SharePoint Online, а также в Office 365. <br> Поддерживает локальные серверные продукты корпорации Майкрософт, например Exchange Server, SharePoint Server и файловые серверы под управлением Windows Server с инфраструктурой классификации файлов (FCI). |Высокие требования к обслуживанию (отслеживание обновлений, конфигураций и потенциальных обновлений), так как сервером управляет ИТ-служба. <br> Требует локальной серверной инфраструктуры.<br> Не имеет встроенной поддержки возможностей Azure. |
| Централизованное управление в облаке (Azure RMS) |Упрощенное управление по сравнению с локальным решением. <br> Возможность интеграции с AD DS в гибридном сценарии. <br>  Полная интеграция с Azure AD. <br> Не требует локальной серверной инфраструктуры для развертывания службы. <br> Поддерживает локальные серверные продукты корпорации Майкрософт, например Exchange Server, SharePoint Server и файловые серверы под управлением Windows Server с инфраструктурой классификации файлов (FCI). <br> ИТ-служба имеет полный контроль над клиентскими ключами в сценарии BYOK. |У организации должна быть облачная подписка с поддержкой RMS. <br> У организации должен быть каталог Azure AD, чтобы организовать аутентификацию пользователя для RMS. |
| Гибридное управление (служба Azure RMS, интегрированная с локальным сервером управления правами Active Directory) |Этот сценарий объединяет преимущества обоих предыдущих: централизованное локальное управление и централизованное управление в облаке. |У организации должна быть облачная подписка с поддержкой RMS. <br> У организации должен быть каталог Azure AD, чтобы организовать аутентификацию пользователя для RMS. <br> Требует наличия связи между облачной службой Azure и локальной инфраструктурой. |

## <a name="define-access-control-options"></a>Определение параметров управления доступом
Возможности проверки подлинности, авторизации и управления доступом, которые доступны в Azure AD, позволят вашей организации использовать центральный репозиторий идентификации, при этом предоставляя единый вход для пользователей и партнеров, как показано на рисунке ниже.

![](./media/hybrid-id-design-considerations/centralized-management.png)

Централизованное управление и полная интеграция с другими каталогами

Azure Active Directory предоставляет единый вход для тысяч приложений SaaS и локальных веб-приложений. Ознакомьтесь со статьей [Список совместимости федерации Azure Active Directory: использование сторонних поставщиков удостоверений для реализации единого входа](https://msdn.microsoft.com/library/azure/jj679342.aspx) , чтобы получить информацию о том, для каких сторонних приложений корпорация Майкрософт проверила возможность единого входа. Эта возможность позволяет организации реализовать различные сценарии «бизнес-бизнес», сохраняя контроль над управлением идентификацией и доступом. При разработке решения «бизнес-бизнес» важно хорошо понимать, какой метод аутентификации будет использовать ваш партнер, и проверить поддержку этого метода службой Azure. В настоящее время Azure AD поддерживает такие методы:

* Security Assertion Markup Language (SAML)
* OAuth
* Kerberos
* Маркеры
* Сертификаты

> [!NOTE]
> Каждый их этих протоколов и возможности их применения в Azure описаны в статье [Протоколы аутентификации Azure Active Directory](https://msdn.microsoft.com/library/azure/dn151124.aspx) .
>
>

При поддержке Azure AD мобильные бизнес-приложения могут предоставлять такие же простые возможности аутентификации мобильных служб. Это позволяет сотрудникам входить в мобильные приложения, используя корпоративные учетные данные Active Directory. Эта функция позволяет зарегистрировать Azure AD в качестве поставщика удостоверений в мобильных службах наряду с другими поставщиками удостоверений, которые в них поддерживаются (в том числе учетные записи Майкрософт и идентификаторы пользователей Facebook, Google и Twitter). Если локальное приложение использует учетные данные пользователей, размещенные в корпоративной доменной службе Active Directory, доступ для партнеров и облачных пользователей должен быть прозрачным. Вы можете управлять условным доступом к веб-приложениям (в том числе облачным), веб-API, облачным службам Майкрософт, сторонним приложениям SaaS и собственным (мобильным) клиентским приложениям. Все функции защиты, аудита и отчетности будут сконцентрированы в одном месте. Однако хотим напомнить, что такие решения желательно сначала проверять в тестовой среде или с ограниченным количеством пользователей.

> [!TIP]
> Важно отметить, что Azure AD, в отличие от AD DS, не поддерживает групповые политики. Для применения политики к устройствам требуется отдельное решение для управления мобильными устройствами, например [Microsoft Intune](https://technet.microsoft.com/library/jj676587.aspx).
>
>

После аутентификации пользователя в Azure AD нужно оценить уровень доступа, который он будет иметь. Пользователь может получать различные уровни доступа к определенному ресурсу. При этом служба Azure AD может добавить дополнительный уровень защиты, контролируя доступ к некоторым ресурсам. Имейте также в виду, что сам ресурс может иметь свой собственный список управления доступом, например список контроля доступа к файлам, расположенным на файловом сервере. На рисунке ниже представлены уровни управления доступом, которые можно использовать в гибридном сценарии.

![](./media/hybrid-id-design-considerations/accesscontrol.png)

Каждое взаимодействие, отображенное в схеме на рисунке X, представляет собой один сценарий контроля доступом, который может выполнять служба Azure AD. Ниже мы приводим описание каждого сценария:

1. Условный доступ к приложениям, размещенным локально. Для зарегистрированных устройств можно применять политики доступа к приложениям, настройки которых позволяют использовать службы федерации Active Directory в Windows Server 2012 R2. Узнать больше о настройке условного доступа для локальной среды можно в разделе [Настройка локального условного доступа с помощью регистрации устройств в Azure Active Directory](active-directory-conditional-access.md).

2. Управление доступом к порталу Azure. Azure также позволяет контролировать доступ к порталу с помощью управления доступом на основе ролей (RBAC). Организация может использовать этот метод, чтобы ограничить количество операций, которые пользователь может выполнить на портале Azure. Используя RBAC для управления доступом к порталу, ИТ-администраторы могут применить такие методы управления доступом:

* Назначение ролей на основе групп: доступ можно предоставлять группам Azure AD, которые синхронизируются с локальной службой Active Directory. Это позволит с пользой применить средства и процессы, которые уже созданы в организации для управления группами. Можно также использовать функцию делегирования управления группой, которая есть в Azure AD Premium.
* Использование встроенных ролей Azure: есть три готовые роли (владельца, участника и читателя), которых достаточно для предоставления пользователям и группам прав на выполнение строго тех задач, которые им необходимы для работы.
* Детальный доступ к ресурсам. Можно назначить роли пользователям и группам для конкретной подписки, группы ресурсов или отдельного ресурса Azure, например веб-сайта или базы данных. Это позволит гарантировать, что пользователи имеют доступ ко всем нужным ресурсам и не имеют доступа к тем ресурсам, которыми не должны управлять.

> [!NOTE]
> Разработчики, которые создают приложения и желают настроить для них управление доступом, могут использовать роли приложений Azure AD для авторизации. Изучите этот [пример WebApp-RoleClaims-DotNet](https://github.com/AzureADSamples/WebApp-RoleClaims-DotNet) , который демонстрирует, как создать приложение с такой функцией.
>
>

3. Условный доступ к приложениям Office 365 с использованием Microsoft Intune. ИТ-администраторы могут подготавливать политики условного доступа устройств для защиты корпоративных ресурсов, при этом разрешая информационным работникам обращаться к службам на совместимых устройствах. Дополнительные сведения см. в разделе [Политики условного доступа к службам Office 365 с устройств](active-directory-conditional-access-device-policies.md).

4. Условный доступ для приложений SaaS. [Эта функция](http://blogs.technet.com/b/ad/archive/2015/06/25/azure-ad-conditional-access-preview-update-more-apps-and-blocking-access-for-users-not-at-work.aspx) позволяет настроить правила доступа с многофакторной аутентификацией каждого приложения и блокировать доступ пользователей из сетей, не входящих в список доверенных. Правила многофакторной проверки подлинности могут применяться для всех пользователей, назначенных приложению, или только для пользователей в указанных группах безопасности. Пользователи могут быть исключены из требования многофакторной проверки подлинности, если они получают доступ к приложению с IP-адреса в сети организации.

Указанные варианты контроля доступа подразумевают многоуровневый подход, поэтому их сравнение в рамках этой статьи невозможно. Постарайтесь использовать все возможные варианты для каждого сценария, в котором требуется контроль доступа к ресурсам.

## <a name="define-incident-response-options"></a>Определение вариантов реагирования на инциденты
Azure AD может помочь ИТ-специалистам идентифицировать потенциальные риски безопасности в ИТ-среде, наблюдая за действиями пользователя. ИТ-специалисты могут использовать отчеты Azure AD о доступе и использовании, чтобы получить информацию о целостности и безопасности каталога вашей организации. C помощью этой информации ИТ-администратор может более точно определить источники рисков безопасности и принять соответствующие меры для их смягчения.  [Подписка Azure AD Premium](active-directory-get-started-premium.md) включает несколько отчетов о безопасности, которые позволят получить такие сведения. [Отчеты Azure AD](active-directory-view-access-usage-reports.md) делятся на следующие категории:

* **Отчеты об аномалиях**содержат информацию об аномальных событиях входа. Наша цель — уведомлять вас о таких событиях, чтобы вы могли самостоятельно определять, является ли то или иное событие подозрительным.
* **Отчеты о встроенных приложениях**предоставляют информацию о том, как ваша организация использует облачные приложения. Azure Active Directory обеспечивает интеграцию с множеством облачных приложений.
* **Отчеты об ошибках**демонстрируют ошибки, которые возникают при подготовке учетных записей для внешних приложений.
* **Пользовательские отчеты**— это отчеты, которые предоставляют данные об использование устройства или случаях входа для конкретного пользователя.
* **Журналы действий**содержат записи обо всех событиях аудита за последние 24 часа, 7 дней или 30 дней, а также записи об изменениях в составе групп, событиях сброса пароля и регистрации.

> [!TIP]
> Еще один отчет может помочь в расследовании инцидентов. Это отчет о [пользователях с утечкой учетных данных](http://blogs.technet.com/b/ad/archive/2015/06/15/azure-active-directory-premium-reporting-now-detects-leaked-credentials.aspx).  Этот отчет выявит любые совпадения между списком пользователей с утечкой учетных данных и вашими клиентами.
>
>

При расследовании инцидентов можно использовать еще несколько важных отчетов, встроенных в Azure AD:

* Отчет **Действия по сбросу пароля** дает администратору информацию о том, как используется в организации функция сброса паролей.
* Отчет **Действия по регистрации методов сброса пароля** предоставляет информацию о том, какие пользователи указали методы сброса пароля и какие именно методы они выбрали.
* Отчет **Действия с группами** содержит журнал изменений в составе групп (например, добавление или удаление пользователей), выполненных через панель доступа.

Помимо базовых возможностей создания отчетов, которые есть в Azure AD Premium, ИТ-специалисты могут использовать при расследовании инцидентов отчет об аудите, чтобы получить такие сведения:

* изменения членства в ролях (например, добавление пользователя в роль глобального администратора);
* изменение учетных данных (например, изменение пароля);
* управление доменами (например, проверка пользовательского домена или удаление домена);
* добавление и удаление приложений;
* управление пользователями (например, добавление, удаление или обновление пользователя);
* добавление и удаление лицензий.

Указанные варианты реагирования на инциденты подразумевают многоуровневый подход, поэтому их сравнение в рамках этой статьи невозможно. Постарайтесь использовать все возможные варианты для каждого сценария, в котором корпоративная политика реагирования на инциденты требует использовать возможности Azure AD по созданию отчетов.

## <a name="next-steps"></a>Дальнейшие действия
[Определение задач управления гибридной идентификацией](active-directory-hybrid-identity-design-considerations-hybrid-id-management-tasks.md)

## <a name="see-also"></a>См. также
[Обзор рекомендаций по проектированию](active-directory-hybrid-identity-design-considerations-overview.md)
