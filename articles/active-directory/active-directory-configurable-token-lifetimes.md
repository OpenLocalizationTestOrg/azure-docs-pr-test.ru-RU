---
title: "aaaConfigurable времени жизни токенов в Azure Active Directory | Документы Microsoft"
description: "Узнайте, как время жизни tooset для маркеров, выданного Azure AD."
services: active-directory
documentationcenter: 
author: billmath
manager: femila
editor: 
ms.assetid: 06f5b317-053e-44c3-aaaa-cf07d8692735
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/20/2017
ms.author: billmath
ms.custom: aaddev
ms.reviewer: anchitn
ms.openlocfilehash: 0d4c8545981c5463cc7c95f669167bbc38230123
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="configurable-token-lifetimes-in-azure-active-directory-public-preview"></a>Настройка времени жизни маркеров в Azure Active Directory (общедоступная предварительная версия)
Можно указать время существования hello маркер, выданный службой Azure Active Directory (Azure AD). Время жизни маркеров можно настроить для всех приложений в организации, для многопользовательского приложения (приложения для нескольких организаций) или для определенного субъекта-службы в организации.

> [!NOTE]
> Эта функция сейчас предоставляется в режиме общедоступной предварительной версии. Подготовить toorevert или отмените все изменения. функция Hello доступна в подписках Azure Active Directory предварительной версии. Однако при hello функция станет общедоступной, некоторые аспекты hello компонентов может потребоваться [Azure Active Directory Premium](active-directory-get-started-premium.md) подписки.
>
>

В Azure AD объект политики представлен набором правил, которые применяются к отдельным приложениям или ко всем приложениям в организации. Каждый тип политики имеет структуру уникальный набор свойств, которые будут применяться tooobjects toowhich, они назначаются.

Политики можно назначить в качестве политики по умолчанию hello для вашей организации. политика Hello — примененных tooany приложений в организации hello, до тех пор, пока оно не переопределено политики с более высоким приоритетом. Можно также назначить toospecific политики приложений. порядок приоритетов Hello зависит от типа политики.


## <a name="token-types"></a>Типы маркеров

Политики времени жизни маркера можно настроить для маркеров обновления, маркеров доступа, маркеров сеансов и маркеров идентификации.

### <a name="access-tokens"></a>Маркеры доступа
Доступ клиентов используйте маркеры tooaccess защищенному ресурсу. Маркер доступа можно использовать только для конкретного сочетания пользователя, клиентского приложения и ресурса. Маркеры доступа не могут быть отозваны. Они действуют до истечения срока своего действия. Вредоносный субъект, получивший маркер доступа, сможет использовать его на протяжении всего времени жизни. Корректировка времени существования hello доступа токен компромисс между повышения производительности системы и увеличение hello количество времени, hello клиент сохраняет доступ после отключения учетной записи пользователя hello. Улучшенной производительностью достигается за счет уменьшения hello количество раз, клиент должен tooacquire маркер доступа новую.

### <a name="refresh-tokens"></a>Маркеры обновления
Когда клиент получает маркер tooaccess доступа к защищенному ресурсу, hello клиент получает токен обновления и маркер доступа. токен обновления Hello — новые пары токенов используется tooobtain доступа или обновления, после истечения срока действия текущего маркера доступа hello. Токен обновления — сочетание связанных tooa пользователя и клиента. Токен обновления могут быть отменены и допустимость hello маркер проверяется каждый раз используется токен hello.

Это важные toomake различие между конфиденциальных клиентов и открытый. Дополнительные сведения о различных типах клиентов см. в разделе [RFC 6749](https://tools.ietf.org/html/rfc6749#section-2.1).

#### <a name="token-lifetimes-with-confidential-client-refresh-tokens"></a>Время жизни маркера для маркеров обновления конфиденциального клиента
Конфиденциальные клиенты — это такие клиентские приложения, которые могут безопасно хранить клиентский пароль (секрет), Они гарантируют, что запросы исходят от клиентского приложения hello, а не из вредоносных субъекта. Например веб-приложения является конфиденциального клиента, так как он позволяет хранить секрет клиента на веб-сервере hello. и потому он остается невидимым. По умолчанию время жизни маркеров обновления, выданный toothese потоки — Здравствуйте, так как эти потоки являются более безопасными, `until-revoked`, не может быть изменен с помощью политики и не будут отозваны сброс пароля добровольное.

#### <a name="token-lifetimes-with-public-client-refresh-tokens"></a>Время жизни маркеров для маркеров обновления общедоступного клиента

Общедоступные клиенты не могут обеспечить безопасное хранение клиентского пароля (секрета). Например приложение iOS и Android нельзя замаскировать секрет от владельца ресурса hello, чтобы считать открытого клиента. Можно определить политику ресурсов tooprevent токенов обновления из общих клиенты старше указанного периода, получить новую пару токена доступа или обновления. (toodo hello, используйте свойство обновления токена максимальное время простоя.) Также можно использовать политики tooset период за какой hello токенов обновления больше не принимаются. (toodo hello, используйте свойство обновления токена максимального срока хранения.) Вы можете настроить время жизни токена toocontrol обновления, когда и как часто hello пользователь является tooreenter необходимые учетные данные, вместо автоматической повторной проверки подлинности, при использовании открытого клиентское приложение hello.

### <a name="id-tokens"></a>Маркеры идентификации
Маркеров безопасности, передаются toowebsites и собственных клиентов. Они содержат сведения о профиле пользователя. Маркер идентификатора — привязанного tooa конкретную комбинацию пользователя и клиента. Маркеры идентификации считаются действительными до истечения срока действия. Как правило, веб-приложение соответствует пользователю время жизни сеанса за время существования toohello приложения hello hello идентификатор маркера, выданного для пользователя hello. Вы можете настроить время существования идентификатора токена toocontrol частоту веб-приложение hello истечения срока действия сеанса приложения hello и как часто требуется повторная проверка подлинности с помощью Azure AD (без вмешательства пользователя или интерактивно) toobe пользователя hello hello.

### <a name="single-sign-on-session-tokens"></a>Маркеры сеанса единого входа
Когда пользователь выполняет проверку подлинности с помощью Azure AD и выбирает hello **оставаться в системе** флажок, установлен один сеанс входа (SSO) с браузером пользователя hello и Azure AD. маркер единого входа Hello, в форме куки-файла, hello представляет этого сеанса. Обратите внимание, что этот токен сеанса единого входа hello не привязанной tooa определенного ресурса и клиентского приложения. Маркеры сеанса единого входа могут быть отозваны, а при каждом использовании проверяется их действительность.

В Azure AD используется два вида маркеров сеанса единого входа: постоянные и временные. Токены постоянного сеанса хранятся в виде постоянных файлов cookie браузером hello. а временные — хранятся в виде файлов cookie сеанса. (Файлов cookie сеанса, удаляются при закрытии hello.)

Срок действия временных маркеров сеанса составляет 24 часа, а постоянных маркеров — 180 дней. Каждый раз, когда токен сеанса единого входа используется в пределах срока его действия, срок действия hello расширяется другой 24 часа или 180 дней, в зависимости от типа маркера hello. Если маркер сеанса единого входа не используется в течение срока его действия, он считается истекшим и не будет приниматься.

Можно использовать политики раз hello tooset после первого токена сеанса hello был выдан за пределами какие hello токена сеанса больше не принимаются. (toodo hello этого, используйте свойство максимального срока хранения токена сеанса.) Вы можете настроить время существования маркера toocontrol сеанса, когда и как часто пользователь является tooreenter необходимые учетные данные, вместо автоматической проверки подлинности, при использовании веб-приложения hello.

### <a name="token-lifetime-policy-properties"></a>Свойства политики времени жизни маркера
Политика времени жизни маркера — это объект политики, который содержит правила времени жизни маркера. Используйте свойства hello toocontrol политики hello указано время жизни токена. Если политика не задано, система hello обеспечивает значение времени жизни по умолчанию hello.

### <a name="configurable-token-lifetime-properties"></a>Свойства для настройки времени жизни маркера
| Свойство | Строка свойства политики | Область применения | значение по умолчанию | Минимальная | Максимальная |
| --- | --- | --- | --- | --- | --- |
| Время жизни маркера доступа |AccessTokenLifetime |Маркеры доступа, маркеры безопасности, маркеры SAML2 |1 час |10 минут |1 день |
| Максимальное время неактивности для маркеров обновления |MaxInactiveTime |Маркеры обновления |14 дней |10 минут |90 дней |
| Максимальный возраст однофакторного маркера обновления |MaxAgeSingleFactor |Маркеры обновления (для всех пользователей) |Пока не будет отозван |10 минут |Пока не будет отозван<sup>1</sup> |
| Максимальный возраст многофакторного маркера обновления |MaxAgeMultiFactor |Маркеры обновления (для всех пользователей) |Пока не будет отозван |10 минут |Пока не будет отозван<sup>1</sup> |
| Максимальный возраст однофакторного маркера сеанса |MaxAgeSessionSingleFactor<sup>2</sup> |Маркеры сеанса (постоянные и временные) |Пока не будет отозван |10 минут |Пока не будет отозван<sup>1</sup> |
| Максимальный возраст многофакторного маркера сеанса |MaxAgeSessionMultiFactor<sup>3</sup> |Маркеры сеанса (постоянные и временные) |Пока не будет отозван |10 минут |Пока не будет отозван<sup>1</sup> |

* <sup>1</sup>hello явную длину, можно задать для этих атрибутов — 365 дней.
* <sup>2</sup>Если **MaxAgeSessionSingleFactor** не задано, это значение принимает hello **MaxAgeSingleFactor** значение. Если ни один из параметров имеет значение, hello свойство принимает значение по умолчанию hello (до отозванные).
* <sup>3</sup>Если **MaxAgeSessionMultiFactor** не задано, это значение принимает hello **MaxAgeMultiFactor** значение. Если ни один из параметров имеет значение, hello свойство принимает значение по умолчанию hello (до отозванные).

### <a name="exceptions"></a>Исключения
| Свойство | Область применения | значение по умолчанию |
| --- | --- | --- |
| Обновление максимального возраста маркеров (выданные для федеративных пользователей с недостаточной информацией об отзыве <sup>1</sup>) |Маркеры обновления (выданные для федеративных пользователей с недостаточной информацией об отзыве <sup>1</sup>) |12 часов |
| Максимальное время неактивности для маркера обновления (выданного для конфиденциальных клиентов) |Маркеры обновления (выданные для конфиденциальных клиентов) |90 дней |
| Максимальный возраст маркеров обновления (выданных для конфиденциальных клиентов) |Маркеры обновления (выданные для конфиденциальных клиентов) |Пока не будет отозван |

* <sup>1</sup>федеративные пользователи, имеющие входить все пользователи, не имеющие сведений недостаточно отзыва hello синхронизированных атрибут «LastPasswordChangeTimestamp». Эти пользователи получают этот короткий максимального срока хранения, так как AAD не удается tooverify при toorevoke маркеры, которые привязаны tooan старой учетных данных (например, пароль, который был изменен) и необходимо вернуть обратно чаще tooensure этого пользователя hello и связанные маркеры будут по-прежнему репутацию. tooimprove эти возможности клиента, которые администраторы необходимо убедиться, что они синхронизации hello атрибут «LastPasswordChangeTimestamp» (это можно задать на hello объекта пользователя, с помощью Powershell или с помощью AADSync).

### <a name="policy-evaluation-and-prioritization"></a>Оценка политики и ее приоритеты
Можно создать и затем назначить время существования маркера политики tooa определенного приложения, tooyour организации и tooservice участниками. Несколько политик могут применяться tooa конкретного приложения. политика времени существования маркера Hello, вступает в силу следует таким правилам:

* Если политика назначена явно toohello участника-службы, он применяется.
* Если политика не присвоено явным образом toohello участника-службы, явно назначено toohello головной организации hello субъекта-службы включена политика.
* Если политика не назначается явно toohello участника-службы или toohello организации, применяется политика hello, назначенное toohello приложение.
* Если политика не была назначена toohello службы участника, hello организации или объекта приложения hello, hello значения по умолчанию применяется. (См. таблицу hello в [свойства можно настроить время существования маркера](#configurable-token-lifetime-properties).)

Дополнительные сведения об отношениях hello service principal-объекты и объекты приложений см. в разделе [приложений и объектов участника службы в Azure Active Directory](active-directory-application-objects.md).

Во время hello используется токен hello оценивает допустимость маркера. политика Hello с высоким приоритетом hello приложения hello, к которому имеет доступ вступает в силу.

> [!NOTE]
> Ниже приведен пример сценария.
>
> Пользователь хочет tooaccess двух веб-приложений: веб-приложение A и B. приложения Web
> 
> Факторы:
> * Оба веб-приложения, в hello же родительских организации.
> * Токен 1 время существования политики с возрастом Max маркера сеанса восемь часов имеет значение по умолчанию hello родительской организации.
> * Веб-приложение A является использование обычных веб-приложением, не связанный tooany политики.
> * Веб-приложение Б используется для процессов с высоким уровнем конфиденциальности, Его участник службы имеет связанный tooToken 2 политики времени жизни, имеет сеанса токена максимального срока хранения в 30 минут.
>
> В 12:00 hello пользователь начинает новый сеанс браузера и пытается tooaccess A. приложения Web hello пользователя является перенаправленный tooAzure AD и запрашивается toosign в. Это создает файл cookie, который содержит маркер сеанса в браузере hello. пользователь Hello является перенаправленный задней tooWeb приложение A с маркер идентификатора и позволяющая tooaccess hello пользователя приложения hello.
>
> В 12:15 PM hello пользователь пытается tooaccess B. приложения Web hello браузер перенаправляет tooAzure AD, который определяет файл cookie сеанса hello. Субъекта приложения В веб-службы — связанного tooToken 2 время существования политики, но он также является частью родительской организации hello токен 1 время существования политики по умолчанию. Так как субъекты связанного tooservice политики имеют более высокий приоритет, чем политикам организации по умолчанию токена 2 время существования политики вступает в силу. маркер сеанса Hello первоначального выпуска внутри hello последних 30 минут, поэтому считается допустимым. пользователь Hello является перенаправленный задней tooWeb приложение B с маркер идентификатора, который предоставит им доступ.
>
> В 13:00 hello пользователь пытается tooaccess Web приложение A. hello пользователь — перенаправленный tooAzure AD. Веб-сайта A приложения не является связанной tooany политики, но так как он находится в организации с токен 1 время существования политики по умолчанию, эта политика вступает в силу. обнаружен файл cookie сеанса Hello, изначально выдан внутри hello последние восемь часов. пользователь Hello — автоматически перенаправленный задней tooWeb объект приложения с маркером новый идентификатор. пользователь Hello не является обязательным tooauthenticate.
>
> Сразу же после этого пользователь hello пытается tooaccess B. приложения Web hello пользователь является перенаправленный tooAzure AD. Как и прошлый раз, применяется политика времени жизни маркеров 2. Так как более 30 минут выдачи токена hello, пользователь hello является запросом tooreenter своих учетных данных для входа. чтобы получить новые маркер сеанса и маркер идентификатора. Hello пользователь может получить доступ к Web приложение B.
>
>

## <a name="configurable-policy-property-details"></a>Подробные сведения о настройке свойств политики
### <a name="access-token-lifetime"></a>Время жизни маркера доступа
**Строка:** AccessTokenLifetime

**Область применения:** маркеры доступа, маркеры безопасности

**Описание:** эта политика определяет, как долго продолжают действовать маркеры доступа и маркеры идентификации для определенного ресурса. Уменьшение hello время жизни токена доступа свойства снижает риск hello маркера доступа или маркер идентификатора, используемого вредоносных субъекта для длительного времени. (Эти токены не могут быть отозваны.) компромисс Hello связано с, производительность значительно снижена, токены hello toobe заменен более часто.

### <a name="refresh-token-max-inactive-time"></a>Максимальное время неактивности для маркеров обновления
**Строка:** MaxInactiveTime

**Область применения:** маркеры обновления

**Сводка:** эта политика определяет, насколько стара токен обновления может быть до клиента больше не использования tooretrieve новую пару токена доступа или обновления при попытке tooaccess этого ресурса. Так как новый маркер обновления обычно возвращается при использовании токена обновления эта политика предотвращает доступ, если hello клиент пытается использовать tooaccess любой ресурс с помощью hello текущий маркер обновления во время hello указанного периода времени.

Эта политика принудительно пользователей, которые не были активными в их tooretrieve tooreauthenticate клиента новый токен обновления.

необходимо задать Hello свойство обновления токена максимальное время простоя, меньше значения tooa hello проверкой маркера максимального срока хранения и свойства многофакторной обновления токена максимального срока хранения hello.

### <a name="single-factor-refresh-token-max-age"></a>Максимальный возраст однофакторного маркера обновления
**Строка:** MaxAgeSingleFactor

**Область применения:** маркеры обновления

**Сводка:** этот параметр определяет как долго пользователя можно использовать обновления токена tooget новый доступа или обновления пары токенов после их последнего подлинность проверена успешно с помощью только одного фактора. После пользователь проходит проверку подлинности и получает новый маркер обновления, hello пользователь может использовать поток маркеров обновления hello для hello указанного периода времени. (Это значение равно true, пока текущий маркер обновления hello не отозван, и не остается неиспользуемые дольше, чем время простоя hello). В этот момент пользователь hello является принудительное tooreauthenticate tooreceive новый токен обновления.

Уменьшение максимального возраста hello принудительно tooauthenticate пользователи чаще. Поскольку однофакторной проверки подлинности является менее безопасен, чем многофакторной проверки подлинности, рекомендуется установить значение этого свойства tooa, равно tooor меньше hello свойство многофакторной обновления токена максимального срока хранения.

### <a name="multi-factor-refresh-token-max-age"></a>Максимальный возраст многофакторного маркера обновления
**Строка:** MaxAgeMultiFactor

**Область применения:** маркеры обновления

**Сводка:** этот параметр определяет как долго пользователя можно использовать обновления токена tooget новый доступа или обновления пары токенов после их последнего подлинность проверена успешно с использованием нескольких факторов. После пользователь проходит проверку подлинности и получает новый маркер обновления, hello пользователь может использовать поток маркеров обновления hello для hello указанного периода времени. (Это значение равно true, пока текущий маркер обновления hello не отозван, и не неиспользуемые дольше, чем время простоя hello). На этом этапе принудительным tooreauthenticate tooreceive новый токен обновления.

Уменьшение максимального возраста hello принудительно tooauthenticate пользователи чаще. Поскольку однофакторной проверки подлинности является менее безопасен, чем многофакторной проверки подлинности, рекомендуется установить это значение свойства tooa, равно tooor, превышающее значение hello проверкой обновления токена максимального срока хранения.

### <a name="single-factor-session-token-max-age"></a>Максимальный возраст однофакторного маркера сеанса
**Строка:** MaxAgeSessionSingleFactor

**Область применения:** маркеры сеанса (постоянные и временные)

**Сводка:** этот параметр определяет продолжительность пользователь может использовать токен tooget сеанса, новый идентификатор и сеанса токен после их последнего подлинность проверена успешно с помощью только одного фактора. После пользователь проходит проверку подлинности и получает маркер новый сеанс, hello пользователь может использовать поток маркеров hello сеанса для hello указанного периода времени. (Это значение true, при условии, что hello токена текущего сеанса не отозван и не истек). После hello указанный период времени, пользователь hello является принудительное tooreauthenticate tooreceive новый маркер.

Уменьшение максимального возраста hello принудительно tooauthenticate пользователи чаще. Поскольку однофакторной проверки подлинности является менее безопасен, чем многофакторной проверки подлинности, рекомендуется установить это значение свойства tooa, равно tooor меньше hello многофакторной сеанса токена максимального срока хранения в свойство.

### <a name="multi-factor-session-token-max-age"></a>Максимальный возраст многофакторного маркера сеанса
**Строка:** MaxAgeSessionMultiFactor

**Область применения:** маркеры сеанса (постоянные и временные)

**Сводка:** Здравствуйте, этот параметр определяет продолжительность пользователь может использовать токен tooget сеанса, новый идентификатор и сеанса токен после последнего времени они выполнена проверка подлинности успешно с использованием нескольких факторов. После пользователь проходит проверку подлинности и получает маркер новый сеанс, hello пользователь может использовать поток маркеров hello сеанса для hello указанного периода времени. (Это значение true, при условии, что hello токена текущего сеанса не отозван и не истек). После hello указанный период времени, пользователь hello является принудительное tooreauthenticate tooreceive новый маркер.

Уменьшение максимального возраста hello принудительно tooauthenticate пользователи чаще. Поскольку однофакторной проверки подлинности является менее безопасен, чем многофакторной проверки подлинности, рекомендуется установить это значение свойства tooa, равно tooor, превышающее значение hello маркера максимального срока хранения проверкой сеанса.

## <a name="example-token-lifetime-policies"></a>Пример использования политик срока действия маркеров
Указывая и изменяя время жизни маркеров для приложений, субъектов-служб и организации в целом, вы сможете реализовать в Azure AD много новых сценариев. В этом разделе мы рассмотрим несколько распространенных вариантов использования политик, которые помогут вам правильно применять новые правила для следующих параметров:

* Token Lifetime
* максимальное время неактивности для маркеров;
* Максимальный возраст маркеров

В примерах hello, можно узнать, как:

* как управлять политикой организации по умолчанию;
* как создать политику для входа в веб-службы;
* как создать политику для собственного приложения, которое вызывает веб-API;
* как управлять расширенной политикой.

### <a name="prerequisites"></a>Предварительные требования
В следующих примерах hello создание, обновление, связать и удаление политики для вашей организации, приложений и субъектов-служб. Если новый tooAzure AD, рекомендуется изучить [как tooget в Azure AD для клиента](active-directory-howto-tenant.md) перед выполнением этих примеров.  

запущена, tooget hello следующие шаги:

1. Загрузить последний hello [Azure AD PowerShell модуль выпуска общедоступной предварительной версии](https://www.powershellgallery.com/packages/AzureADPreview).
2. Запустите hello `Connect` toosign команды в tooyour учетная запись администратора Azure AD. Эту команду следует выполнять при каждом запуске сеанса.

    ```PowerShell
    Connect-AzureAD -Confirm
    ```

3. toosee все политики, которые были созданы в вашей организации, выполнения hello следующие команды. Выполните эту команду после большинства операций в hello следующие сценарии. Выполнение команды hello также позволяет воспользоваться hello ** ** политик.

    ```PowerShell
    Get-AzureADPolicy
    ```

### <a name="example-manage-an-organizations-default-policy"></a>Пример управления политикой организации по умолчанию
В этом примере мы создадим для всей организации политику, которая позволяет пользователям реже вводить учетные данные. toodo это, создайте политику времени существования маркера для проверкой токенов обновления, которая используется в вашей организации. политика Hello — примененных tooevery приложения в вашей организации и tooeach участника-службы, задать политики еще нет.

1. Создайте политику времени жизни маркеров.

    1.  Набор hello проверкой токен обновления слишком» до отозванные.» токен Hello не истекает, пока отмене доступа. Создайте следующие определения политики hello:

        ```PowerShell
        @('{
            "TokenLifetimePolicy":
            {
                "Version":1,
                "MaxAgeSingleFactor":"until-revoked"
            }
        }')
        ```

    2.  политика hello toocreate с запуска hello следующую команду:

        ```PowerShell
        New-AzureADPolicy -Definition @('{"TokenLifetimePolicy":{"Version":1, "MaxAgeSingleFactor":"until-revoked"}}') -DisplayName "OrganizationDefaultPolicyScenario" -IsOrganizationDefault $true -Type "TokenLifetimePolicy"
        ```

    3.  toosee новую политику, а также политики hello tooget **ObjectId**, запустите hello следующую команду:

        ```PowerShell
        Get-AzureADPolicy
        ```

2. Обновление политики hello.

    Можно решить, заданные в этом примере первая политика hello не строгие службе требуется. Запустите ваш токен обновления проверкой tooexpire в течение двух дней tooset hello следующую команду:

    ```PowerShell
    Set-AzureADPolicy -Id <ObjectId FROM GET COMMAND> -DisplayName "OrganizationDefaultPolicyUpdatedScenario" -Definition @('{"TokenLifetimePolicy":{"Version":1,"MaxAgeSingleFactor":"2.00:00:00"}}')
    ```

### <a name="example-create-a-policy-for-web-sign-in"></a>Пример создания политики для входа в веб-службы

В этом примере создается политика, которая требует tooauthenticate пользователи чаще, в веб-приложения. Эта политика задает время существования маркеров доступа или идентификатор hello hello и максимальный возраст hello субъекта-службы маркеров toohello многофакторной сеанса веб-приложения.

1. Создайте политику времени жизни маркеров.

    Эта политика для web входа в систему, задает время существования маркера доступа или идентификатор hello и hello max проверкой маркера возраст tootwo часы сеансов.

    1.  toocreate политика hello, выполните следующую команду:

        ```PowerShell
        New-AzureADPolicy -Definition @('{"TokenLifetimePolicy":{"Version":1,"AccessTokenLifetime":"02:00:00","MaxAgeSessionSingleFactor":"02:00:00"}}') -DisplayName "WebPolicyScenario" -IsOrganizationDefault $false -Type "TokenLifetimePolicy"
        ```

    2.  toosee новую политику, а также политики hello tooget **ObjectId**, запустите hello следующую команду:

        ```PowerShell
        Get-AzureADPolicy
        ```

2.  Назначьте участника-службы tooyour политики hello. Необходимо также tooget hello **ObjectId** субъекта-службы. 

    1.  toosee субъектов-служб вашей организации, вы можете запросить [Microsoft Graph](https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity). Либо в [Azure AD Graph Explorer](https://graphexplorer.cloudapp.net/), войдите в tooyour учетной записи Azure AD.

    2.  При наличии hello **ObjectId** субъекта-службы запуска hello следующую команду:

        ```PowerShell
        Add-AzureADServicePrincipalPolicy -Id <ObjectId of hello ServicePrincipal> -RefObjectId <ObjectId of hello Policy>
        ```


### <a name="example-create-a-policy-for-a-native-app-that-calls-a-web-api"></a>Пример создания политики для собственного приложения, вызывающего веб-API
В этом примере создается политика, часто требуется меньше пользователей tooauthenticate. Hello политики также увеличивающими hello количество времени, пользователь может оставаться неактивным, перед hello пользователь должен принудительную проверку подлинности. политика Hello — примененных toohello веб-API. Когда собственное приложение hello запрашивает hello веб-API в качестве ресурса, применяется эта политика.

1. Создайте политику времени жизни маркеров.

    1.  toocreate strict политику для веб-API, запустите hello следующую команду:

        ```PowerShell
        New-AzureADPolicy -Definition @('{"TokenLifetimePolicy":{"Version":1,"MaxInactiveTime":"30.00:00:00","MaxAgeMultiFactor":"until-revoked","MaxAgeSingleFactor":"180.00:00:00"}}') -DisplayName "WebApiDefaultPolicyScenario" -IsOrganizationDefault $false -Type "TokenLifetimePolicy"
        ```

    2.  toosee новую политику, а также политики hello tooget **ObjectId**, запустите hello следующую команду:

        ```PowerShell
        Get-AzureADPolicy
        ```

2. Назначьте hello политики tooyour веб-API. Необходимо также tooget hello **ObjectId** приложения. Здравствуйте, лучшим способом toofind приложения **ObjectId** — toouse hello [портал Azure](https://portal.azure.com/).

   При наличии hello **ObjectId** приложения, запустите hello следующую команду:

        ```PowerShell
        Add-AzureADApplicationPolicy -Id <ObjectId of hello Application> -RefObjectId <ObjectId of hello Policy>
        ```


### <a name="example-manage-an-advanced-policy"></a>Пример управления расширенной политикой
В этом примере можно создать несколько политик, как работает система приоритетов hello toolearn. Вы также узнаете как toomanage несколько политик, которые являются объектами примененных tooseveral.

1. Создайте политику времени жизни маркеров.

    1.  toocreate политику по умолчанию организации, которая задает дни hello токен обновления проверкой too30 время существования, запустите следующую команду hello:

        ```PowerShell
        New-AzureADPolicy -Definition @('{"TokenLifetimePolicy":{"Version":1,"MaxAgeSingleFactor":"30.00:00:00"}}') -DisplayName "ComplexPolicyScenario" -IsOrganizationDefault $true -Type "TokenLifetimePolicy"
        ```

    2.  toosee новую политику, а также политики hello tooget **ObjectId**, запустите hello следующую команду:

        ```PowerShell
        Get-AzureADPolicy
        ```

2. Назначьте участника-службы tooa политики hello.

    Вы получили политику, применяемую toohello всей организации. Может потребоваться toopreserve эта политика 30-дневной для участника службы, но также изменить hello организации по умолчанию политика toohello верхний предел «до отозванные.»

    1.  toosee субъектов-служб вашей организации, вы можете запросить [Microsoft Graph](https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity). или открыть [проводник Azure AD Graph](https://graphexplorer.cloudapp.net/) и войти в учетную запись Azure AD.

    2.  При наличии hello **ObjectId** субъекта-службы запуска hello следующую команду:

            ```PowerShell
            Add-AzureADServicePrincipalPolicy -Id <ObjectId of hello ServicePrincipal> -RefObjectId <ObjectId of hello Policy>
            ```
        
3. Набор hello `IsOrganizationDefault` флаг toofalse:

    ```PowerShell
    Set-AzureADPolicy -Id <ObjectId of Policy> -DisplayName "ComplexPolicyScenario" -IsOrganizationDefault $false
    ```

4. Создайте новую политику организации по умолчанию:

    ```PowerShell
    New-AzureADPolicy -Definition @('{"TokenLifetimePolicy":{"Version":1,"MaxAgeSingleFactor":"until-revoked"}}') -DisplayName "ComplexPolicyScenarioTwo" -IsOrganizationDefault $true -Type "TokenLifetimePolicy"
    ```

    Теперь у вас есть исходного участника-службы политик связанного tooyour hello и новая политика hello задано как политика по умолчанию вашей организации. Это важные tooremember, что участники tooservice применяются политики имеют приоритет над организации политик по умолчанию.

## <a name="cmdlet-reference"></a>Справочник по командлетам

### <a name="manage-policies"></a>Управление политиками

Можно использовать следующие командлеты toomanage политики hello.

#### <a name="new-azureadpolicy"></a>New-AzureADPolicy

Создает новую политику.

```PowerShell
New-AzureADPolicy -Definition <Array of Rules> -DisplayName <Name of Policy> -IsOrganizationDefault <boolean> -Type <Policy Type>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Definition</code> |Массив stringified JSON, содержащий все политики hello правила. | `-Definition @('{"TokenLifetimePolicy":{"Version":1,"MaxInactiveTime":"20:00:00"}}')` |
| <code>&#8209;DisplayName</code> |Строка hello имя политики. |`-DisplayName "MyTokenPolicy"` |
| <code>&#8209;IsOrganizationDefault</code> |Если значение равно true, задает политику hello как политика по умолчанию hello организации. Если присвоено значение false — параметр игнорируется. |`-IsOrganizationDefault $true` |
| <code>&#8209;Type</code> |Тип политики. Для политик времени жизни маркеров всегда используйте значение TokenLifetimePolicy. | `-Type "TokenLifetimePolicy"` |
| <code>&#8209;AlternativeIdentifier</code> (необязательный параметр) |Задает альтернативным Идентификатором для политики hello. |`-AlternativeIdentifier "myAltId"` |

</br></br>

#### <a name="get-azureadpolicy"></a>Get-AzureADPolicy
Возвращает полный список политик Azure AD или одну указанную политику.

```PowerShell
Get-AzureADPolicy
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> (необязательный параметр) |**ObjectId (Id)** hello политики требуется. |`-Id <ObjectId of Policy>` |

</br></br>

#### <a name="get-azureadpolicyappliedobject"></a>Get-AzureADPolicyAppliedObject
Возвращает все приложения и участников службы, которые являются связанные tooa политики.

```PowerShell
Get-AzureADPolicyAppliedObject -Id <ObjectId of Policy>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** hello политики требуется. |`-Id <ObjectId of Policy>` |

</br></br>

#### <a name="set-azureadpolicy"></a>Set-AzureADPolicy
Обновляет существующую политику.

```PowerShell
Set-AzureADPolicy -Id <ObjectId of Policy> -DisplayName <string>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** hello политики требуется. |`-Id <ObjectId of Policy>` |
| <code>&#8209;DisplayName</code> |Строка hello имя политики. |`-DisplayName "MyTokenPolicy"` |
| <code>&#8209;Definition</code> (необязательный параметр) |Массив stringified JSON, содержащий все политики hello правила. |`-Definition @('{"TokenLifetimePolicy":{"Version":1,"MaxInactiveTime":"20:00:00"}}')` |
| <code>&#8209;IsOrganizationDefault</code> (необязательный параметр) |Если значение равно true, задает политику hello как политика по умолчанию hello организации. Если присвоено значение false — параметр игнорируется. |`-IsOrganizationDefault $true` |
| <code>&#8209;Type</code> (необязательный параметр) |Тип политики. Для политик времени жизни маркеров всегда используйте значение TokenLifetimePolicy. |`-Type "TokenLifetimePolicy"` |
| <code>&#8209;AlternativeIdentifier</code> (необязательный параметр) |Задает альтернативным Идентификатором для политики hello. |`-AlternativeIdentifier "myAltId"` |

</br></br>

#### <a name="remove-azureadpolicy"></a>Remove-AzureADPolicy
Удаляет hello указан политики.

```PowerShell
 Remove-AzureADPolicy -Id <ObjectId of Policy>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** hello политики требуется. | `-Id <ObjectId of Policy>` |

</br></br>

### <a name="application-policies"></a>Политики приложений
Можно использовать следующие командлеты для политик приложения hello.</br></br>

#### <a name="add-azureadapplicationpolicy"></a>Add-AzureADApplicationPolicy
Hello ссылки указано tooan применения политики.

```PowerShell
Add-AzureADApplicationPolicy -Id <ObjectId of Application> -RefObjectId <ObjectId of Policy>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** приложения hello. | `-Id <ObjectId of Application>` |
| <code>&#8209;RefObjectId</code> |**ObjectId** hello политики. | `-RefObjectId <ObjectId of Policy>` |

</br></br>

#### <a name="get-azureadapplicationpolicy"></a>Get-AzureADApplicationPolicy
Получает политику Здравствуй, назначаемый tooan приложения.

```PowerShell
Get-AzureADApplicationPolicy -Id <ObjectId of Application>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** приложения hello. | `-Id <ObjectId of Application>` |

</br></br>

#### <a name="remove-azureadapplicationpolicy"></a>Remove-AzureADApplicationPolicy
Удаляет политику из приложения.

```PowerShell
Remove-AzureADApplicationPolicy -Id <ObjectId of Application> -PolicyId <ObjectId of Policy>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** приложения hello. | `-Id <ObjectId of Application>` |
| <code>&#8209;PolicyId</code> |**ObjectId** hello политики. | `-PolicyId <ObjectId of Policy>` |

</br></br>

### <a name="service-principal-policies"></a>Политики субъекта-службы
Можно использовать следующие командлеты для политики основной службы hello.

#### <a name="add-azureadserviceprincipalpolicy"></a>Add-AzureADServicePrincipalPolicy
Ссылки hello участника-службы tooa указанной политики.

```PowerShell
Add-AzureADServicePrincipalPolicy -Id <ObjectId of ServicePrincipal> -RefObjectId <ObjectId of Policy>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** приложения hello. | `-Id <ObjectId of Application>` |
| <code>&#8209;RefObjectId</code> |**ObjectId** hello политики. | `-RefObjectId <ObjectId of Policy>` |

</br></br>

#### <a name="get-azureadserviceprincipalpolicy"></a>Get-AzureADServicePrincipalPolicy
Возвращает все политики связанного toohello указанного субъекта-службы.

```PowerShell
Get-AzureADServicePrincipalPolicy -Id <ObjectId of ServicePrincipal>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** приложения hello. | `-Id <ObjectId of Application>` |

</br></br>

#### <a name="remove-azureadserviceprincipalpolicy"></a>Remove-AzureADServicePrincipalPolicy
Удаляет политику hello из hello указанного субъекта-службы.

```PowerShell
Remove-AzureADServicePrincipalPolicy -Id <ObjectId of ServicePrincipal>  -PolicyId <ObjectId of Policy>
```

| Параметры | Описание | Пример |
| --- | --- | --- |
| <code>&#8209;Id</code> |**ObjectId (Id)** приложения hello. | `-Id <ObjectId of Application>` |
| <code>&#8209;PolicyId</code> |**ObjectId** hello политики. | `-PolicyId <ObjectId of Policy>` |
