---
title: "aaaDebugging Azure облачной службы или виртуальной машины в Visual Studio | Документы Microsoft"
description: "Отладка облачной службы или виртуальной машины в Visual Studio"
services: visual-studio-online
documentationcenter: na
author: kraigb
manager: ghogen
editor: 
ms.assetid: 945e06e0-2100-41af-b218-72347367ddab
ms.service: visual-studio-online
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: multiple
ms.workload: na
ms.date: 11/11/2016
ms.author: kraigb
ms.openlocfilehash: 32a326430021ba2ea9317a6a71fa005d4b87c273
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="debugging-an-azure-cloud-service-or-virtual-machine-in-visual-studio"></a>Отладка облачной службы или виртуальной машины Azure в Visual Studio
Visual Studio предоставляет разнообразные варианты отладки облачных служб и виртуальных машин Azure.

## <a name="debug-your-cloud-service-on-your-local-computer"></a>Отладка облачной службы на локальном компьютере
Можно сохранить время и деньги с помощью toodebug эмулятор вычислений Azure hello облачной службы на локальном компьютере. Посредством локальной отладки службы перед ее развертыванием можно повысить надежность и производительность службы, не платя за время использования вычислительных ресурсов. Однако некоторые ошибки могут возникнуть только при запуске облачной службы непосредственно в среде Azure. Эти ошибки можно устранить, если включить удаленную отладку при публикации службы, а затем подключите экземпляр роли tooa hello отладчика.

Hello эмулятор имитирует службу вычислений Azure hello и выполняется в локальной среде, можно протестировать и отладка облачной службы перед ее развертыванием. дескрипторы эмулятор Hello hello жизненный цикл экземпляров ролей и предоставляет доступ toosimulated ресурсы, такие как локальное хранилище. При отладке или запуске службы из Visual Studio, он автоматически запускает эмулятор hello в качестве фонового приложения и развертывает симулятора toohello службы. Можно использовать эмулятор tooview hello службы при запуске в локальной среде hello. Можно запустить полную версию hello или hello экспресс-версию эмулятора hello. (Начиная с Azure 2.3 hello экспресс-версию эмулятора hello — по умолчанию hello) В разделе [tooRun использование Emulator Express и отладка облачной службы локально](https://msdn.microsoft.com/library/dn339018.aspx).

### <a name="toodebug-your-cloud-service-on-your-local-computer"></a>toodebug вашей облачной службы на локальном компьютере
1. В строке меню hello, выберите **отладки**, **начать отладку** toorun проекта Azure облачной службы. Также можно просто нажать клавишу F5. Вы увидите, что начинается сообщение, которое hello в эмуляторе вычислений. При запуске эмулятора hello hello иконку подтверждает это.

    ![Эмулятор Azure в системной панели задач hello](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC783828.png)
2. Отображать hello пользовательский интерфейс эмулятора вычислений hello, открыв контекстное меню значка Azure hello hello в области уведомлений hello, а затем выберите **Показать пользовательский Интерфейс эмулятора вычислений**.

    Левая панель Hello hello пользовательский Интерфейс отображает hello служб, которые в данный момент развертывания toohello вычислительного эмулятора и hello экземпляров ролей, которые каждая служба запущена. Вы можете hello службу или роль toodisplay жизненного цикла, ведение журнала и диагностической информации в правой области hello. Если поместить фокус hello в верхнее поле hello вложенного окна, он расширяет toofill hello правой панели.
3. Шаг через приложение hello с помощью команд на hello **отладки** меню и задание точек останова в коде. При пошаговом выполнении приложения hello в отладчике hello hello состояние приложения hello в обновляются hello области. При остановке отладки развертывание приложения hello удаляется. Если приложение включает веб-роли и установили hello запуска действия свойство toostart hello веб-браузера, Visual Studio запускает веб-приложения в браузере hello. При изменении hello число экземпляров роли в конфигурации службы hello, необходимо остановить облачную службу и затем перезапустить отладку, чтобы можно было отлаживать эти новые экземпляры роли hello.

    **Примечание:** при остановить выполнение или отладку службы, hello локальный эмулятор вычислений и эмулятор хранилища не останавливаются. Необходимо остановить их явно из области уведомлений hello.

## <a name="debug-a-cloud-service-in-azure"></a>Отладка облачной службы в Azure
toodebug облачной службы с удаленного компьютера, необходимо включить эти функциональные возможности явным образом при развертывании облачной службы, чтобы необходимые службы (например, msvsmon.exe), установленные на hello виртуальных машин, работающих экземпляров ролей. Если вы не включили удаленную отладку при публикации службы hello, у вас toorepublish hello службу с включенной удаленной отладкой.

Если вы включили удаленную отладку для облачной службы, это не приводит к снижению производительности и не требует дополнительных затрат. Не следует использовать удаленную отладку для рабочей службы, так как клиенты, использующие hello службы может быть нарушена.

> [!NOTE]
> При публикации облачной службы из Visual Studio, можно включить **IntelliTrace** для любой роли в том, что служба hello, целевой платформы .NET Framework 4 или hello .NET Framework 4.5. С помощью **IntelliTrace**, можно изучить события, возникшие в экземпляре роли в прошлом hello и воспроизвести контекст hello, начиная с этого момента. Ознакомьтесь со статьями [Отладка опубликованной облачной службы с помощью IntelliTrace и Visual Studio](http://go.microsoft.com/fwlink/?LinkID=623016) и [Использование IntelliTrace](https://msdn.microsoft.com/library/dd264915.aspx).
>
>

### <a name="tooenable-remote-debugging-for-a-cloud-service"></a>tooenable удаленной отладки для облачной службы
1. Откройте контекстное меню проекта Azure hello hello, а затем выберите **публикации**.
2. Выберите hello **промежуточной** среды и hello **отладки** конфигурации.

    Это всего лишь рекомендация. Вы можете toorun сред тестирования в рабочей среде. Тем не менее это может оказать на пользователей, если необходимо включить удаленную отладку в производственной среде hello. Можно выбрать конфигурацию выпуска hello, но hello конфигурация отладки облегчает процесс отладки.

    ![Выберите конфигурацию отладки hello](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746717.gif)
3. Выполните обычные действия hello, но выберите hello **включить удаленный отладчик для всех ролей** флажок на hello **Дополнительные параметры** вкладки.

    ![Конфигурация отладки](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746718.gif)

### <a name="tooattach-hello-debugger-tooa-cloud-service-in-azure"></a>tooattach hello отладчик tooa облачной службы в Azure
1. В обозревателе серверов разверните узел hello для облачной службы.
2. Привет открыть контекстное меню для роли hello или toowhich экземпляр роли будет tooattach, а затем выберите **подключить отладчик**.

    При отладке роли отладчик Visual Studio hello присоединяет tooeach экземпляра этой роли. Hello отладчика произойдет останов на точку останова для экземпляра роли первого hello, который запускает эту строку кода и выполняет условия точки останова. Если вы производите отладку экземпляра, hello отладчик подключается tooonly hello, экземпляру и останавливает работу в точках останова только в том случае, если этот конкретный экземпляр запускает эту строку кода и выполняет условия точки останова.

    ![Присоединить отладчик](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746719.gif)
3. После hello отладчик подключается tooan экземпляра, отладку обычным образом. Hello отладчик автоматически выполняет присоединение toohello соответствующему хост-процессу для вашей роли. В зависимости от того, какие hello — роли, toow3wp.exe Присоединяет отладчик hello, WaWorkerHost.exe или WaIISHost.exe. tooverify hello процесса toowhich hello отладчик присоединен, разверните узел экземпляра hello в обозревателе серверов. Дополнительные сведения о процессах Azure см. в статье [Архитектура ролей Azure](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx).

    ![Диалоговое окно "Выбор типа кода"](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718346.png)
4. процессы hello tooidentify toowhich hello отладчик подключен, открытия hello процессы диалогового, на hello меню отладки, Windows, процессы. (Клавиатура: Ctrl + Alt + Z) toodetach конкретного процесса, откройте ее контекстное меню и выберите **отсоединить процесс**. Или, найдите узел экземпляра hello в обозревателе серверов, найдите процесс hello, откройте ее контекстное меню и выберите **отсоединить процесс**.

    ![Отладить процессы](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC690787.gif)

> [!WARNING]
> Во время удаленной отладки избегайте длинных остановок на точках останова. Azure обрабатывает процесс, который остановленным дольше нескольких минут, как отвечать на запросы и перестает отправлять трафик toothat экземпляра. Если вы остановите слишком долго, msvsmon.exe отсоединяется от процесса hello.
>
>

отладчик hello toodetach от всех процессов в вашем экземпляра или роли, Привет открыть контекстное меню для роли hello или экземпляр, отладки, а затем выберите **отсоединить отладчик**.

## <a name="limitations-of-remote-debugging-in-azure"></a>Ограничения удаленной отладки в Azure
Из пакета Azure SDK 2.3 удаленная отладка обладает hello следующие ограничения.

* При включенной удаленной отладке нельзя опубликовать облачную службу, в которой любая роль содержит более 25 экземпляров.
* Hello отладчик использует порты 30400 too30424, 31400 too31424 и 32400 too32424. При попытке toouse любой из этих портов, не будет возможности toopublish отображения службы и из hello следующие сообщения об ошибках в журнал действий hello для Azure:

  * Ошибка при проверке файла cscfg hello по файл csdef hello.
    Hello диапазон портов «диапазон» зарезервировано для конечной точки Microsoft.WindowsAzure.Plugins.RemoteDebugger.Connector роли «роль» накладывается на уже заданный порт или диапазон.
  * Ошибка выделения. Повторите попытку позже, попробуйте уменьшить размер виртуальной Машины hello или число экземпляров роли или попробуйте выполнить развертывание tooa другой регион.

## <a name="debugging-azure-virtual-machines"></a>Отладка виртуальных машин Azure
Вы можете выполнять отладку программ, выполняемых на виртуальных машинах Azure, с помощью обозревателя серверов в Visual Studio. Если включить удаленную отладку на виртуальной машине Azure, Azure устанавливает hello расширение удаленной отладки на виртуальной машине hello. Затем можно присоединить tooprocesses на виртуальной машине hello и отладку обычным образом.

> [!NOTE]
> Виртуальные машины, созданные через стек диспетчера ресурсов Azure hello можно удаленно отлаживать с помощью Cloud Explorer в Visual Studio 2015. Дополнительные сведения см. в статье [Управление ресурсами Azure с помощью Cloud Explorer](http://go.microsoft.com/fwlink/?LinkId=623031).
>
>

### <a name="toodebug-an-azure-virtual-machine"></a>toodebug виртуальной машине Azure
1. В обозревателе серверов разверните узел виртуальных машин hello и выберите hello узел hello виртуальной машины, которые должны toodebug.
2. Откройте контекстное меню hello и выберите **включить отладку**. При появлении запроса, если вы уверены в том случае, если требуется отладка tooenable hello виртуальной машине, выберите **Да**.

    Azure устанавливает hello расширение удаленной отладки на отладку tooenable hello виртуальной машины.

    ![Команда включения отладки в виртуальной машине](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746720.png)

    ![Журнал действий Azure](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746721.png)
3. По окончании установки hello расширение удаленной отладки, откройте контекстное меню hello виртуальной машины и выберите **подключить отладчик...**

    Возвращает список процессов hello на виртуальной машине hello Azure и отображает их в диалоговое окно tooProcess присоединение hello.

    ![Команда подключения отладчика](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746722.png)
4. В hello **присоединения tooProcess** выберите **выберите** toolimit hello в результаты включаются только типы hello tooshow кода требуется toodebug. Вы можете осуществлять отладку 32- или 64-разрядного управляемого и/или машинного кода.

    ![Диалоговое окно "Выбор типа кода"](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718346.png)
5. Выберите процессы hello toodebug на виртуальной машине hello и затем выберите **присоединение**. Например можно выбрать процесс w3wp.exe hello, если требуется, чтобы toodebug веб-приложения на виртуальной машине hello. Дополнительные сведения см. в статьях [Отладка одного или нескольких процессов в Visual Studio](https://msdn.microsoft.com/library/jj919165.aspx) и [Архитектура ролей Azure](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx).

## <a name="create-a-web-project-and-a-virtual-machine-for-debugging"></a>Создание веб-проекта и виртуальной машины для отладки
Перед публикацией проекта Azure, может оказаться полезным tootest его в автономной среде, который поддерживает сценарии отладки и тестирования и где можно установить для тестирования и мониторинга программы. Это один из способов toodo tooremotely отладки приложения на виртуальной машине.

Проекты Visual Studio ASP.NET предоставляют параметр toocreate удобную виртуальную машину, можно использовать для тестирования приложения. Hello виртуальная машина содержит нужные обычно конечные точки, такие как PowerShell, удаленный рабочий стол и WebDeploy.

### <a name="toocreate-a-web-project-and-a-virtual-machine-for-debugging"></a>toocreate веб-проекта и виртуальной машины для отладки
1. Создайте в Visual Studio новое веб-приложение ASP.NET.
2. В диалоговом окне Новый проект ASP.NET hello в hello Azure раздела выберите **виртуальной машины** в hello раскрывающегося списка. Оставьте hello **создать удаленные ресурсы** флажком. Выберите **ОК** tooproceed.

    Hello **создать виртуальную машину в Azure** откроется диалоговое окно.

    ![Диалоговое окно "Создать веб-проект ASP.NET"](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746723.png)

    **Примечание:** будут запрошены toosign в tooyour учетная запись Azure, если вы еще не вошли.

1. Выберите различные параметры для виртуальной машины hello hello, а затем выберите **ОК**. Дополнительные сведения см. в статье [Виртуальные машины](http://go.microsoft.com/fwlink/?LinkId=623033).

    Привет, указываемые для DNS-имени будет называться hello имя hello виртуальной машины.

    ![Диалоговое окно "Создать виртуальную машину"](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746724.png)

    Azure создает hello виртуальной машины, а также подготавливает и настраивает конечные точки hello, такие как удаленный рабочий стол и веб-развертывания
2. После полной настройки hello виртуальной машины, выберите узел hello виртуальной машины в обозревателе серверов.
3. Откройте контекстное меню hello и выберите **включить отладку**. При появлении запроса, если вы уверены в том случае, если требуется отладка tooenable hello виртуальной машине, выберите **Да**.

    Azure устанавливает hello удаленной отладки расширения toohello виртуальной машины tooenable отладки.

    ![Команда включения отладки в виртуальной машине](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746720.png)

    ![Журнал действий Azure](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746721.png)
4. Опубликуйте проект в соответствии с инструкциями из статьи [Развертывание веб-проекта с помощью публикации одним щелчком в Visual Studio](https://msdn.microsoft.com/library/dd465337.aspx). Так как вы хотите toodebug для hello виртуальной машины на hello **параметры** страница hello **веб-публикация** мастера выберите **отладки** как конфигурация hello. Это позволяет просматривать символы кода во время отладки.

    ![Параметры публикации](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718349.png)
5. В hello **параметры публикации файлов**выберите **удалить дополнительные файлы в месте назначения** Если hello проект уже был развернут ранее.
6. После публикует hello проекта, в контекстном меню виртуальной машины hello в обозревателе серверов, выберите **подключить отладчик...**

    Возвращает список процессов hello на виртуальной машине hello Azure и отображает их в диалоговое окно tooProcess присоединение hello.

    ![Команда подключения отладчика](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC746722.png)
7. В hello **присоединения tooProcess** выберите **выберите** toolimit hello в результаты включаются только типы hello tooshow кода требуется toodebug. Вы можете осуществлять отладку 32- или 64-разрядного управляемого и/или машинного кода.

    ![Диалоговое окно "Выбор типа кода"](./media/vs-azure-tools-debug-cloud-services-virtual-machines/IC718346.png)
8. Выберите процессы hello toodebug на виртуальной машине hello и затем выберите **присоединение**. Например можно выбрать процесс w3wp.exe hello, если требуется, чтобы toodebug веб-приложения на виртуальной машине hello. Дополнительные сведения см. в статье [Отладка одного или нескольких процессов в Visual Studio](https://msdn.microsoft.com/library/jj919165.aspx).

## <a name="next-steps"></a>Дальнейшие действия
* Используйте **Intellitrace** toocollect журнала вызовов и событий с сервера выпуска. Ознакомьтесь со статьей [Отладка опубликованной облачной службы с помощью IntelliTrace и Visual Studio](http://go.microsoft.com/fwlink/?LinkID=623016).
* Используйте **диагностики Azure** toolog подробные сведения из кода, выполняемых внутри ролей, ли hello ролей, выполняются в среде разработки hello, или в Azure. Ознакомьтесь со статьей [Включение системы диагностики Azure в облачных службах Azure](http://go.microsoft.com/fwlink/p/?LinkId=400450).
