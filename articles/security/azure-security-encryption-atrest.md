---
title: "Шифрование неактивных данных в Microsoft Azure | Документация Майкрософт"
description: "В этой статье описывается шифрование неактивных данных в Microsoft Azure, общие возможности и рекомендации."
services: security
documentationcenter: na
author: YuriDio
manager: mbaldwin
editor: TomSh
ms.assetid: 9dcb190e-e534-4787-bf82-8ce73bf47dba
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/21/2017
ms.author: yurid
ms.openlocfilehash: b02afa77ce99f576fed76b398642ba3f3ce2ba98
ms.sourcegitcommit: 62eaa376437687de4ef2e325ac3d7e195d158f9f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2017
---
# <a name="azure-data-encryption-at-rest"></a>Шифрование неактивных данных в Azure
В Microsoft Azure существует несколько средств для защиты данных в соответствии с требованиями безопасности и соблюдения стандартов в организации. В этой статье основное внимание уделяется следующим вопросам:
- защита неактивных данных в Microsoft Azure;
- описание различных компонентов, обеспечивающих защиту данных;
- анализ преимуществ и недостатков основных подходов к защите управления. 

Шифрование неактивных данных — общее требование безопасности. Преимущество Microsoft Azure заключается в том, что организации могут использовать шифрование неактивных данных без расходов на реализацию и управление, а также без риска, связанного с настраиваемым решением управления ключами. Организации могут предоставить Azure полный контроль над шифрованием неактивных данных. Кроме того, им доступны различные параметры точного управления шифрованием или ключами шифрования.

## <a name="what-is-encryption-at-rest"></a>Что такое шифрование неактивных данных?
Шифрование неактивных данных — это криптографическое кодирование (шифрование) данных при хранении. Схемы шифрования неактивных данных в Azure используют симметричное шифрование для быстрого шифрования и расшифровки больших объемов данных на основе простой концептуальной модели:

- Симметричный ключ шифрования используется для шифрования данных при хранении. 
- Этот же ключ используется для расшифровки данных при подготовке к использованию в памяти.
- Данные могут быть секционированы, а для каждой секции могут использоваться разные ключи.
- Ключи должны храниться в безопасном месте с политиками управления доступом, ограничивающими доступ для определенных удостоверений и регистрирующими сведения об использовании ключей. Ключи шифрования данных часто шифруются с помощью асимметричного шифрования для дальнейшего ограничения доступа (это подробно описано в разделе *иерархии ключей* ниже).

Выше описаны общие основные элементы шифрования неактивных данных. На практике основные сценарии управления и регулирования, а также гарантии масштабирования и доступности требуют дополнительных конструкций. Ниже приведены основные понятия и компоненты шифрования неактивных данных в Microsoft Azure.

## <a name="the-purpose-of-encryption-at-rest"></a>Цель шифрования неактивных данных
Шифрование неактивных данных выполняется для защиты неактивных данных (как описано выше). Атаки, направленные на такие данные, включают попытки получить физический доступ к оборудованию, на котором хранятся данные, с последующей компрометацией этих данных. При такой атаке во время обслуживания может наблюдаться неправильное управление жестким диском сервера, что дает возможность злоумышленнику его извлечь. Позже злоумышленник может поместить жесткий диск в компьютер, находящийся под его контролем, чтобы попытаться получить доступ к данным. 

Шифрование неактивных данных предназначено для предотвращения доступа злоумышленника к незашифрованным данным за счет шифрования данных на диске. Если злоумышленник получит жесткий диск с зашифрованными данными без доступа к ключам шифрования, вероятность компрометации данных очень небольшая. В этом случае атаки злоумышленника будут направлены на зашифрованные данные. Совершение этих атак требует гораздо больше усилий и потребления ресурсов, чем сам доступ к незашифрованным данным на жестком диске. По этой причине мы настоятельно рекомендуем использовать шифрование неактивных данных, которое имеет приоритетное значение для многих организаций. 

В некоторых случаях такое шифрование также требуется в связи с необходимостью управления данными и обеспечения соответствия. В отраслевых и государственных нормативах, например HIPAA, PCI и FedRAMP, описываются меры по обеспечению безопасности на основе требований к шифрованию и защите данных. Для многих из этих нормативов такое шифрование является обязательной мерой, необходимой для соответствующего управления данными и их защиты. 

Кроме нормативных требований и требований соответствия, шифрование неактивных данных необходимо рассматривать как возможность расширенной защиты для платформы. Хотя Майкрософт предоставляет соответствующую стандартам платформу для служб, приложений и данных, комплексные возможности, физическую безопасность, управление доступом к данным и аудит, важно обеспечить дополнительные "перекрывающие" меры безопасности в случае сбоя основных. Шифрование неактивных данных предоставляет такой дополнительный механизм защиты.

Майкрософт стремится обеспечить возможности шифрования неактивных данных в облачных службах, а также предоставить пользователям подходящий способ управления ключами шифрования и доступ к журналам, из которых можно получить сведения об использовании этих ключей. Кроме того, Майкрософт активно работает над тем, чтобы для всех данных пользователя можно было применять такое шифрование по умолчанию.

## <a name="azure-encryption-at-rest-components"></a>Компоненты шифрования неактивных данных в Azure

Как было описано выше, цель шифрования неактивных данных — выполнить шифрование данных, хранящихся на диске, с помощью секретного ключа шифрования. Для достижения этой цели необходимы безопасное создание ключей, хранилище, управление доступом и ключами шифрования. Хотя некоторые моменты могут отличаться, реализацию шифрования неактивных данных можно описать с помощью приведенных ниже понятий, которые также наглядно иллюстрируются с помощью соответствующей схемы.

![Компоненты](./media/azure-security-encryption-atrest/azure-security-encryption-atrest-fig1.png)

### <a name="azure-key-vault"></a>Хранилище ключей Azure

Место хранения ключей шифрования и управление доступом к этим ключам имеет принципиально важное значение в отношении модели шифрования неактивных данных. Ключи должны быть надежно защищены. При этом определенные службы должны иметь к ним доступны, и они должны быть доступны для управления определенными пользователями. Для служб Azure рекомендуемым решением хранилища ключей является хранилище Azure Key Vault, предоставляющее общие возможности управления в службах. Для хранения ключей и управления ими используются хранилища ключей, доступ к которым можно предоставить пользователям или службам. Azure Key Vault поддерживает создание пользователем ключей или импорт пользовательских ключей для использования в сценариях ключей шифрования, управляемых пользователем.

### <a name="azure-active-directory"></a>Azure Active Directory

Учетным записям Azure Active Directory можно предоставить разрешения на использование ключей, хранящихся в Azure Key Vault, управление ими или доступ к ним в целях шифрования неактивных данных и расшифровки. 

### <a name="key-hierarchy"></a>Иерархия ключей

При реализации шифрования неактивных данных используется несколько ключей шифрования. Асимметричное шифрование можно использовать для обеспечения доверия и аутентификации, необходимых для управления ключами и доступа к ним. Симметричное шифрование более эффективно для массового шифрования и расшифровки, что гарантирует более надежное шифрование и лучшую производительность. Кроме того, ограничение использования ключа шифрования снижает риск его компрометации, а также затраты на повторное шифрование при необходимости замены ключа. Чтобы реализовать преимущества асимметричного и симметричного шифрования, а также ограничить использование ключа и доступ к нему, в модели шифрования неактивных данных в Azure используется иерархия ключей, которая состоит их следующих типов ключей:

- **Ключ шифрования данных (DEK)** — симметричный ключ AES256 для шифрования раздела или блока данных.  Один ресурс может включать много секций и много ключей шифрования данных. Шифрование каждого блока данных другим ключом создает дополнительные сложности для выполнения атак в отношении зашифрованных данных. Доступ к DEK требуется поставщику ресурсов или экземпляру приложения, выполняющему шифрование или расшифровку определенного блока. Когда DEK заменяется новым ключом, повторного шифрования этим ключом требуют только данные в его связанном блоке.
- **Ключ шифрования ключей (KEK)** — асимметричный ключ шифрования, используемый для шифрования ключей шифрования данных. Использование ключа шифрования ключей позволяет зашифровать непосредственно ключи шифрования данных, а также управлять ими. Сущность, у которой есть доступ к KEK, может быть отличной от сущности, требующей DEK. Это позволяет сущности выступать к качестве брокера при доступе к DEK, чтобы ограничить доступ каждого DEK для определенной секции. Так как KEK требуется для расшифровки ключей DEK, его можно фактически рассматривать как единую точку, с помощью которой можно удалить ключи DEK (непосредственно удалив KEK).

Ключи шифрования данных, зашифрованные с помощью ключей шифрования ключей, хранятся отдельно, и только сущность, у которой есть доступ к ключам шифрования ключей, может получить любой ключ шифрования данных, зашифрованный таким ключом KEK. Поддерживаются различные модели хранилища ключей. Мы рассмотрим каждую модель более подробно в разделе ниже.

## <a name="data-encryption-models"></a>Модели шифрования данных

Знакомство с различными моделями шифрования, их преимуществами и недостатками необходимо для понимания реализации шифрования неактивных данных в Azure различными поставщиками ресурсов. Эти определения являются общими для всех поставщиков ресурсов в Azure для обеспечения общей среды и таксономии. 

Существует три сценария для шифрования на стороне сервера:

- Шифрование на стороне сервера с помощью управляемых службой ключей:
    - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
    - ключами управляет Майкрософт;
    - все возможности облака.

- Шифрование на стороне сервера с помощью управляемых пользователем ключей в Azure Key Vault:
    - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
    - пользователь управляет ключами через Azure Key Vault;
    - все возможности облака.

- Шифрование на стороне сервера с использованием администрируемых пользователем ключей на управляемом пользователем оборудовании:
    - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
    - пользователь администрирует ключи на управляемом оборудовании;
    - все возможности облака.

Для шифрования на стороне клиента учтите следующее:

- расшифрованные данные недоступны службам Azure;
- управление ключами и их хранение доступно в локальной среде или других безопасных хранилищах. Ключи недоступны для служб Azure
- возможности облака ограничены.

В Azure поддерживаемые модели шифрования делятся на две группы. Как уже было сказано ранее, это шифрование на стороне клиента и шифрование на стороне сервера. Обратите внимание, что независимо от используемой модели шифрования неактивных данных службы Azure всегда рекомендуют использовать безопасный канал транспорта, например TLS или HTTPS. Таким образом, шифрование на транспортном уровне должно определяться транспортным протоколом и не должно быть основным фактором при определении используемой модели шифрования неактивных данных.

### <a name="client-encryption-model"></a>Модель шифрования клиентом

Модель шифрования клиентом — это шифрование, выполняемое службой или вызывающим приложением за пределами поставщика ресурсов или Azure. Это шифрование можно выполнить с помощью приложения службы в Azure или приложения, работающего в центре обработки данных пользователя. В любом случае при использовании этой модели шифрования поставщик ресурсов Azure принимает зашифрованный большой двоичный объект данных без возможности расшифровки этих данных каким-либо образом, а также без доступа к ключам шифрования. В этой модели ключами управляют вызывающие приложение или служба. Этот процесс является непрозрачным для службы Azure.

![Клиент](./media/azure-security-encryption-atrest/azure-security-encryption-atrest-fig2.png)

### <a name="server-side-encryption-model"></a>Модель шифрования на стороне сервера

Модели шифрования на стороне сервера относятся к шифрованию, выполняемому службой Azure. В этой модели поставщик ресурсов выполняет операции шифрования и расшифровки. Например, служба хранилища Azure может получать данные посредством простых текстовых операций, а затем выполнять внутренние шифрование и расшифровку. Поставщик ресурсов может использовать ключи шифрования, управляемые Майкрософт или пользователем, в зависимости от конфигурации. 

![сервер;](./media/azure-security-encryption-atrest/azure-security-encryption-atrest-fig3.png)

### <a name="server-side-encryption-key-management-models"></a>Модели управления ключами шифрования на стороне сервера

Каждая из моделей шифрования неактивных данных на стороне сервера подразумевает отличные характеристики управления ключами, в частности то, где и как создаются и хранятся ключи шифрования, а также модели доступа и процедуры смены ключей. 

#### <a name="server-side-encryption-using-service-managed-keys"></a>Шифрование на стороне сервера с помощью управляемых службой ключей

Для многих пользователей существенным требованием является гарантия шифрования неактивных данных. Шифрование на стороне сервера с помощью управляемых службой ключей позволяет реализовать эту модель, давая пользователям возможность помечать конкретный ресурс (учетную запись хранения, базу данных SQL Server и т. д.) для шифрования и передает все аспекты управления ключами, например выдачу, смену и резервное копирование ключей, корпорации Майкрософт. Большинство служб Azure, которые обычно поддерживают шифрование неактивных данных, поддерживают эту модель передачи задач управления ключами шифрования в Azure. Поставщик ресурсов Azure создает ключи и помещает их в надежное хранилище, извлекая их при необходимости. Это означает, что служба имеет полный доступ к ключам и полностью контролирует жизненный цикл учетных данных.

![Управляемые](./media/azure-security-encryption-atrest/azure-security-encryption-atrest-fig4.png)

Таким образом, шифрование на стороне сервера с помощью управляемых службой ключей быстро выполняет шифрование неактивных данных с низкими издержками для пользователя. На портале Azure откройте целевую подписку и поставщик ресурсов и установите флажок, указывающий, что данные требуется зашифровать. В некоторых диспетчерах ресурсов шифрование на стороне сервера с помощью управляемых службой ключей включено по умолчанию. 

Шифрование на стороне сервера с помощью ключей, управляемых Майкрософт, подразумевает, что служба имеет полный доступ к хранению ключей и управлению ими. Хотя некоторые пользователи хотят управлять ключами, так как они считают, что они могут обеспечить большую безопасность, при оценке такой модели следует учитывать затраты и риски, связанные с использованием пользовательского хранилища ключей. Во многих случаях организация может решить, что нехватка ресурсов или риски, связанные с локальным решением, превышают риски облачного управления ключами шифрования неактивных данных.  Однако эта модель может не подойти для организаций, которые имеют требования к управлению созданием и жизненным циклом ключей шифрования или имеют отдельную службу управления ключами шифрования (т. е. отдельное управление ключами от общей модели управления для службы).

##### <a name="key-access"></a>Доступ к ключам

При использовании шифрования на стороне сервера с ключами, управляемыми службой, создание и хранение ключа, а также доступ к ним службами управляются службой. Как правило, основные поставщики ресурсов Azure хранят ключи шифрования данных в хранилище рядом с данными для быстрого доступа, в то время как ключи шифрования ключей хранятся в защищенном внутреннем хранилище.

**Преимущества**

- Простая настройка.
- Корпорация Майкрософт управляет сменой, резервным копированием и избыточностью ключей.
- Пользователь не несет затраты, связанные с реализацией, и для него нет риска использования пользовательской схемы управления ключами.

**Недостатки**

- Пользователь не управляет ключами шифрования (спецификацией, жизненным циклом, отзывом ключей и т. д.).
- Отсутствует возможность отделить управление ключами от общей модели управления для службы.

#### <a name="server-side-encryption-using-customer-managed-keys-in-azure-key-vault"></a>Шифрование на стороне сервера с помощью управляемых пользователем ключей в Azure Key Vault 

Для сценариев, в которых требуется шифровать неактивные данные и управлять ключами шифрования, можно использовать шифрование на стороне сервера с помощью управляемых пользователем ключей в хранилище ключей. Некоторые службы могут хранить корневой ключ шифрования ключей в Azure Key Vault и хранить зашифрованный ключ шифрования данных во внутреннем расположении рядом с данными. В таком сценарии пользователи могут переносить свои собственные ключи (BYOK) в хранилище ключей или создать ключи и использовать их для шифрования нужных ресурсов. Поставщик ресурсов выполняет операции шифрования и расшифровки, используя настроенный ключ в качестве корневого ключа для всех операций шифрования. 

##### <a name="key-access"></a>Доступ к ключам

В модели шифрования на стороне сервера с помощью ключей, управляемых пользователем, в Azure Key Vault служба при необходимости получает доступ к ключам для шифрования и расшифровки. Ключи для шифрования неактивных данных становятся доступными для службы благодаря политике управления доступом. Эта политика предоставляет службе доступ на основе удостоверения для получения ключа. Службу Azure, запущенную от имени связанной подписки, можно настроить с помощью удостоверения в рамках этой подписки. Служба может выполнять проверку подлинности Azure Active Directory и получать токен проверки подлинности, идентифицируя себя как службу, которая действует от имени подписки. Затем этот токен может быть предоставлен хранилищу ключей для получения ключа, доступ к которому был получен.

Для операций с использованием ключей шифрования удостоверению службы можно предоставить доступ к любой из следующих операций: расшифровка, шифрование, упаковка, распаковка, проверка, подписывание, получение, перечисление, обновление, создание, импорт, удаление, резервное копирование и восстановление.

Чтобы получить ключ для шифрования или расшифровки неактивных данных, удостоверение службы, запущенное экземпляром службы диспетчера ресурсов, должно иметь ключ распаковки (чтобы получить ключ для расшифровки) и ключ упаковки (чтобы вставить ключ в хранилище ключей при создании нового ключа).


>[!NOTE] 
>Дополнительные сведения об авторизации в хранилище ключей см. в статье [Защита хранилища ключей](https://docs.microsoft.com/azure/key-vault/key-vault-secure-your-key-vault). 

**Преимущества**

- Полный контроль над ключами. Управление ключами шифрования выполняется в хранилище ключей пользователя под его контролем.
- Возможность шифрования нескольких служб с помощью главного ключа.
- Возможность отделить управление ключами от общей модели управления для службы.
- Возможность определить службу и расположение ключа в нескольких регионах.

**Недостатки**

- Пользователь полностью отвечает за управление доступом к ключам.
- Пользователь полностью отвечает за управление жизненным циклом ключей.
- Дополнительные издержки в процессе установки и конфигурации.

#### <a name="server-side-encryption-using-service-managed-keys-in-customer-controlled-hardware"></a>Шифрование на стороне сервера с помощью управляемых службой ключей на оборудовании под контролем пользователя

Для сценариев, в которых требуется шифровать неактивные данные и управлять ключами в собственном репозитории вне контроля Майкрософт, некоторые службы Azure допускают использование модели управления с размещением собственного ключа (HYOK). В этой модели службе необходимо получить ключ из внешнего сайта, что в результате оказывает влияние на производительность и гарантии доступности, а конфигурация усложняется. Кроме того, так как служба имеет доступ к ключу шифрования данных во время операции шифрования и дешифрирования, общие гарантии безопасности этой модели аналогичны модели, в которой ключами управляют пользователи в Azure Key Vault.  В результате эта модель не подходит для большинства организаций, если они не имеют конкретных требований к управлению ключами. Из-за этих ограничений большинство служб Azure не поддерживают шифрование на стороне сервера с помощью управляемых сервером ключей на оборудовании под контролем пользователя.

##### <a name="key-access"></a>Доступ к ключам

При использовании шифрования на стороне сервера с помощью управляемых службой ключей в оборудовании под контролем пользователя ключи хранятся в системе, настроенной пользователем. Службы Azure, которые поддерживают эту модель, предоставляют средства для создания безопасного подключения к хранилищу ключей, предоставленному пользователем.

**Преимущества**

- Полный контроль над корневым ключом. Ключи шифрования управляются в хранилище пользователя.
- Возможность шифрования нескольких служб с помощью главного ключа.
- Возможность отделить управление ключами от общей модели управления для службы.
- Возможность определить службу и расположение ключа в нескольких регионах.

**Недостатки**

- Полная ответственность за хранение ключей, безопасность, производительность и доступность.
- Полная ответственность за управление доступом к ключам.
- Полная ответственность за управление жизненным циклом ключей.
- Значительные расходы на установку, настройку и текущее обслуживание.
- Повышенная зависимость от доступности сети между центрами обработки данных Azure и центром обработки данных пользователя.

## <a name="encryption-at-rest-in-microsoft-cloud-services"></a>Шифрование неактивных данных в облачных службах Майкрософт

Облачные службы Майкрософт используются во всех трех облачных моделях: IaaS, PaaS, SaaS. Ниже приведены примеры их размещения в каждой модели.

- Программные службы ("программное обеспечение как сервер" (SaaS)) имеют приложение, предоставляемое облачной службой, например Office 365.
- Службы платформы, через которые пользователи используют облако в своих приложениях, используя облако для доступа к функциям служебной шины, хранения и аналитики.
- Службы инфраструктуры (инфраструктура как услуга (IaaS)), в которых пользователь развертывает операционные системы и приложения, размещенные в облаке, и в которых может использовать другие облачные службы.

### <a name="encryption-at-rest-for-saas-customers"></a>Шифрование неактивных данных пользователей SaaS

Для пользователей программного обеспечения как услуги (SaaS) шифрование неактивных данных обычно включено или доступно в каждой службе. В Office 365 реализовано несколько механизмов проверки выполнения или включения шифрования неактивных данных. Чтобы получить сведения о службах Office 365, ознакомьтесь с технологиями шифрования данных в Office 365.

### <a name="encryption-at-rest-for-paas-customers"></a>Шифрование неактивных данных пользователей PaaS

Данные пользователей платформы как услуги (PaaS) обычно располагаются в среде выполнения приложения, а для хранения данных пользователя используются все поставщики ресурсов Azure. Чтобы просмотреть доступные варианты шифрования неактивных данных, просмотрите сведения в таблице ниже для используемых хранилищ и платформ приложений. Если шифрование поддерживается, в таблице указана ссылка на инструкции по включению шифрования неактивных данных для каждого поставщика ресурсов. 

### <a name="encryption-at-rest-for-iaas-customers"></a>Шифрование неактивных данных пользователей IaaS

Пользователи, использующие инфраструктуру как услугу (IaaS), могут использовать ряд служб и приложений. Службы IaaS могут включить шифрование неактивных данных на своих размещенных в Azure виртуальных машинах и виртуальных жестких дисках с помощью шифрования дисков Azure. 

#### <a name="encrypted-storage"></a>Зашифрованное хранилище

Аналогично решениям PaaS, решения IaaS могут использовать другие службы Azure, которые хранят данные в зашифрованном виде. В таких случаях можно включить поддержку шифрования неактивных данных для каждой используемой службы Azure. В таблице ниже перечислены основные хранилища, службы и платформы приложений, а также поддерживаемые модели шифрования неактивных данных. Если шифрование поддерживается, для них указана ссылка на инструкции по включению шифрования неактивных данных. 

#### <a name="encrypted-compute"></a>Зашифрованные вычисления

Полное решение для шифрования неактивных данных предполагает, что данные никогда не сохраняются в незашифрованном виде. Во время использования, когда сервер загружает данные в память, данные могут быть сохранены локально различными способами, включая файл подкачки Windows, аварийный дамп и ведение журнала, которое может выполнять приложение. Чтобы убедиться, что эти данные шифруются при хранении, приложения IaaS могут использовать шифрование дисков Azure на виртуальной машине Azure IaaS (Windows или Linux) и виртуальном диске. 

#### <a name="custom-encryption-at-rest"></a>Пользовательское шифрование неактивных данных

Рекомендуется, чтобы приложения IaaS использовали шифрование дисков Azure и параметры шифрования неактивных данных, предоставляемые любой используемой службой Azure. В некоторых случаях, например при нестандартных требованиях к шифрованию или при использовании хранилища, отличного от Azure, разработчику приложения IaaS может потребоваться реализовать шифрование неактивных данных самостоятельно. Разработчики решений IaaS могут обеспечивать лучшую интеграцию с управлением Azure и удовлетворять ожидания пользователей за счет использования определенных компонентов Azure. В частности разработчикам следует использовать службу Azure Key Vault, чтобы обеспечить безопасное хранение ключей, а также предоставить своим пользователям согласованные параметры управления ключами большинства служб платформы Azure. Кроме того, пользовательские решения должны использовать удостоверения управляемых служб Azure, чтобы предоставить учетным записям служб доступ к ключам шифрования. Сведения для разработчиков об Azure Key Vault и удостоверениях управляемых служб см. в соответствующих пакетах SDK.

## <a name="azure-resource-providers-encryption-model-support"></a>Поддержка модели шифрования поставщиками ресурсов Azure

Каждая служба Microsoft Azure поддерживает одну или несколько моделей шифрования неактивных данных. Тем не менее для некоторых служб одна или несколько моделей шифрования могут быть неприменимы. Кроме того, службы могут выпускать поддержку этих сценариев в разное время. В этом разделе описывается поддержка шифрования неактивных данных на момент написания этой статьи для основных служб хранения данных Azure.

### <a name="azure-disk-encryption"></a>Шифрование дисков Azure

Любой пользователь, который использует функции инфраструктуры как услуги (IaaS) Azure, может включить шифрование неактивных данных на виртуальных машинах IaaS и дисках с помощью шифрования дисков Azure. Дополнительные сведения о шифровании дисков Azure см. в статье [Дисковое шифрование Azure для виртуальных машин IaaS под управлением Windows и Linux](https://docs.microsoft.com/azure/security/azure-security-disk-encryption).

#### <a name="azure-storage"></a>Хранилище Azure

Большой двоичный объект и файл Azure поддерживают шифрование неактивных данных в сценариях шифрования на стороне сервера, а также шифрования на стороне клиента.

- Шифрование на стороне сервера. Пользователи, использующие хранилище BLOB-объектов Azure, могут включить шифрование неактивных данных для каждой учетной записи ресурса хранилища Azure. После активации шифрование на стороне сервера выполняется прозрачно для приложения. Дополнительные сведения см. в статье [Шифрование службы хранилища Azure для неактивных данных (предварительная версия)](https://docs.microsoft.com/azure/storage/storage-service-encryption).
- Шифрование на стороне клиента. Поддерживается шифрование больших двоичных объектов Azure на стороне клиента. При использовании шифрования на стороне клиента данные шифруются и отправляются в виде зашифрованного большого двоичного объекта. Управление ключами осуществляется пользователем. Дополнительные сведения см. в статье [Шифрование на стороне клиента для службы хранилища Microsoft Azure](https://docs.microsoft.com/azure/storage/storage-client-side-encryption).


#### <a name="sql-azure"></a>SQL Azure

SQL Azure в настоящее время поддерживает шифрование неактивных данных в сценариях шифрования на стороне клиента и на стороне управляемых служб Майкрософт.

Поддержка шифрования на стороне сервера в настоящее время предоставляется с помощью функции SQL, которая называется прозрачным шифрованием данных. Как только пользователь SQL Azure активирует прозрачное шифрование данных, эта функция будет автоматически создавать ключи и управлять ими. Шифрование неактивных данных можно включить на уровне базы данных и на уровне сервера. Начиная с июня 2017 г. [прозрачное шифрование данных (TDE)](https://msdn.microsoft.com/library/bb934049.aspx) будет включено по умолчанию для всех новых баз данных.

Шифрование на стороне клиента данных SQL Azure поддерживается с помощью функции [Always Encrypted](https://msdn.microsoft.com/library/mt163865.aspx). Always Encrypted использует ключ, который создается и хранится клиентом. пользователь может хранить главный ключ в хранилище сертификатов Windows, Azure Key Vault или аппаратном модуле безопасности (HSM), размещенном локально. В SQL Server Management Studio пользователи SQL выбирают, какие ключи они хотели бы использовать для шифрования отдельных столбцов.

|                                  |                |                     | **Модель шифрования**             |                              |        |
|----------------------------------|----------------|---------------------|------------------------------|------------------------------|--------|
|                                  |                |                     |                              |                              | **Клиент** |
|                                  | **Управление ключами** | **Ключами управляет служба** | **Ключами управляет пользователь в хранилище ключей** | **Ключами управляет пользователь в локальной среде** |        |
| **Хранилище и базы данных**            |                |                     |                              |                              |        |
| Диск (IaaS)                      |                | -                   | Да                          | Да*                         | -      |
| SQL Server (IaaS)                |                | Да                 | Да                          | Да                          | Да    |
| SQL Azure (PaaS)                 |                | Да                 | Предварительный просмотр                      | -                            | Да    |
| Хранилище Azure (блочные и страничные BLOB-объекты) |                | Да                 | Предварительный просмотр                      | -                            | Да    |
| Хранилище Azure (файлы)            |                | Да                 | -                            | -                            | -      |
| Хранилище Azure (таблицы, очереди)   |                | -                   | -                            | -                            | Да    |
| Cosmos DB (Document DB)          |                | Да                 | -                            | -                            | -      |
| StorSimple                       |                | Да                 | -                            | -                            | Да    |
| Архивация                           |                | -                   | -                            | -                            | Да    |
| **Службы аналитики**       |                |                     |                              |                              |        |
| Фабрика данных Azure               |                | Да                 | -                            | -                            | -      |
| Машинное обучение Azure           |                | -                   | Предварительный просмотр                      | -                            | -      |
| Azure Stream Analytics           |                | Да                 | -                            | -                            | -      |
| HDInsights (хранилище BLOB-объектов Azure)  |                | Да                 | -                            | -                            | -      |
| HDInsights (Data Lake Storage)   |                | Да                 | -                            | -                            | -      |
| Хранилище озера данных Azure            |                | Да                 | Да                          | -                            | -      |
| Каталог данных Azure               |                | Да                 | -                            | -                            | -      |
| Power BI                         |                | Да                 | -                            | -                            | -      |
| **Службы Интернета вещей**                     |                |                     |                              |                              |        |
| Центр Интернета вещей                          |                | -                   | -                            | -                            | Да    |
| Служебная шина                      |                | Да (уровень "Премиум")              | -                            | -                            | Да    |
| Концентраторы событий                       |                | Да             | -                            | -                            | -      |


## <a name="conclusion"></a>Заключение

Защита данных пользователя, хранимых в службах Azure, представляет особую важность для Майкрософт. Все службы, размещенные в Azure, обязуются предоставлять параметры шифрования неактивных данных. Базовые службы, такие как хранилище Azure, SQL Azure и ключевые службы аналитики, уже предоставляют параметры шифрования неактивных данных. Некоторые из этих служб поддерживают ключи, управляемые пользователем, и шифрование на стороне клиента, а также ключи, управляемые службой, и шифрование. Службы Microsoft Azure постоянно совершенствуют доступность шифрования неактивных данных, а новые параметры появятся в предварительной и общедоступной версиях в ближайшее время.

