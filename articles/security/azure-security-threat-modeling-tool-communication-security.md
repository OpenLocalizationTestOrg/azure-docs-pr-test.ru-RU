---
title: "aaaCommunication безопасности - Microsoft средства моделирования угроз - Azure | Документы Microsoft"
description: "защиту от угроз, которые представлены в hello средства моделирования угроз"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: 667829c75123f4dbe0b383fdaf8cd899802f9b16
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="security-frame-communication-security--mitigations"></a>Механизм безопасности. Безопасность обмена данными | Устранение угроз 
| Продукт или служба | Статья |
| --------------- | ------- |
| **Концентратор событий Azure** | <ul><li>[TooEvent безопасного обмена данными с помощью SSL/TLS концентратора](#comm-ssltls)</li></ul> |
| **Dynamics CRM** | <ul><li>[Проверьте, что права доступа и убедитесь, что hello пользовательских служб или страниц ASP.NET учитывают CRM безопасности учетной записи службы](#priv-aspnet)</li></ul> |
| **Фабрика данных Azure** | <ul><li>[Использовать шлюз управления данными при подключении на локальном SQL Server tooAzure фабрики данных](#sqlserver-factory)</li></ul> |
| **Сервер удостоверений** | <ul><li>[Убедитесь, что все tooIdentity трафик сервера через соединение по протоколу HTTPS](#identity-https)</li></ul> |
| **Веб-приложение** | <ul><li>[Проверка соединения SSL, TLS и DTLS tooauthenticate используются сертификаты X.509](#x509-ssltls)</li><li>[Настройте сертификат SSL для личного домена в службе приложений Azure](#ssl-appservice)</li><li>[Принудительно все tooAzure трафика службы приложений через соединение по протоколу HTTPS](#appservice-https)</li><li>[Включите строгий режим безопасности транспорта HTTP (HSTS)](#http-hsts)</li></ul> |
| **База данных** | <ul><li>[Включите шифрование подключения и проверку сертификатов SQL Server](#sqlserver-validation)</li><li>[Принудительное шифрование связи tooSQL сервера](#encrypted-sqlserver)</li></ul> |
| **Хранилище Azure** | <ul><li>[Убедитесь, что tooAzure связи хранилища — по протоколу HTTPS](#comm-storage)</li><li>[Проверяйте MD5-хэш после скачивания большого двоичного объекта по протоколу HTTP](#md5-https)</li><li>[Tooensure совместимый клиент SMB 3.0 для использования в пути tooAzure шифрования данных общих папок](#smb-shares)</li></ul> |
| **Мобильный клиент** | <ul><li>[Реализуйте привязку сертификата](#cert-pinning)</li></ul> |
| **WCF** | <ul><li>[Включите безопасный канал транспорта HTTPS](#https-transport)</li><li>[WCF: TooEncryptAndSign уровня защиты безопасности набор сообщения](#message-protection)</li><li>[WCF: Используйте toorun минимальными правами доступа учетной записи службы WCF](#least-account-wcf)</li></ul> |
| **Веб-интерфейс API** | <ul><li>[Принудительно все tooWeb трафика API-интерфейсы через соединение по протоколу HTTPS](#webapi-https)</li></ul> |
| **кэш Azure Redis** | <ul><li>[Убедитесь, что tooAzure связи — кэш Redis по протоколу SSL](#redis-ssl)</li></ul> |
| **Полевой шлюз Интернета вещей** | <ul><li>[Безопасные подключения шлюза tooField устройства](#device-field)</li></ul> |
| **Облачный шлюз Интернета вещей** | <ul><li>[Защита tooCloud устройства шлюза связи, используя протокол SSL/TLS](#device-cloud)</li></ul> |

## <a id="comm-ssltls"></a>TooEvent безопасного обмена данными с помощью SSL/TLS концентратора

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | концентратору событий Azure | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Обзор проверки подлинности концентраторов событий и модели безопасности](https://azure.microsoft.com/documentation/articles/event-hubs-authentication-and-security-model-overview/) |
| **Действия** | Безопасный AMQP или HTTP-соединений tooEvent концентратора с помощью SSL/TLS |

## <a id="priv-aspnet"></a>Проверьте, что права доступа и убедитесь, что hello пользовательских служб или страниц ASP.NET учитывают CRM безопасности учетной записи службы

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Dynamics CRM | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Проверьте, что права доступа и убедитесь, что hello пользовательских служб или страниц ASP.NET учитывают CRM безопасности учетной записи службы |

## <a id="sqlserver-factory"></a>Использовать шлюз управления данными при подключении на локальном SQL Server tooAzure фабрики данных

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Фабрика данных Azure | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Типы связанных служб: Azure и локальные |
| **Справочные материалы**              |[Перемещение данных между локальными источниками и облаком с помощью шлюза управления данными](https://azure.microsoft.com/documentation/articles/data-factory-move-data-between-onprem-and-cloud/#create-gateway), [Шлюз управления данными](https://azure.microsoft.com/documentation/articles/data-factory-data-management-gateway/) |
| **Действия** | <p>Средство Hello шлюза управления данными (DMG) является обязательным tooconnect toodata источников, которые защищены после корпоративной сети или брандмауэра.</p><ol><li>Блокировка компьютера hello изолирует средство DMG hello и предотвращает неисправность программ из повреждения или прослушиванием на компьютер источника данных hello. (В частности, необходимо установить последние обновления, выполнять управляемую подготовку учетных записей, а также включить минимальное требуемое количество портов, аудит, шифрование дисков и т. д.)</li><li>Ключ шлюза данных должны быть повернуты более короткие интервалы, или каждый раз, когда обновляет пароль учетной записи службы DMG hello</li><li>Транзиты данных через связанную службу должны быть зашифрованы.</li></ol> |

## <a id="identity-https"></a>Убедитесь, что все tooIdentity трафик сервера через соединение по протоколу HTTPS

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Сервер удостоверений | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Сведения о ключах, подписях и шифровании на платформе IdentityServer3](https://identityserver.github.io/Documentation/docsv2/configuration/crypto.html), [информация о развертывании платформы IdentityServer3](https://identityserver.github.io/Documentation/docsv2/advanced/deployment.html) |
| **Действия** | По умолчанию IdentityServer требует всех toocome входящих подключений по протоколу HTTPS. Взаимодействие с IdentityServer должно выполняться только через защищенные транспортные протоколы. Но в некоторых сценариях развертывания, например при настройке разгрузки SSL, это требование можно опустить. Посетите страницу развертывания сервер удостоверений hello в hello ссылки на дополнительные сведения. |

## <a id="x509-ssltls"></a>Проверка соединения SSL, TLS и DTLS tooauthenticate используются сертификаты X.509

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | <p>Приложения, использующие протокол SSL, TLS и DTLS полностью необходимо проверить сертификаты X.509 hello hello сущностей, которому они подключены. Сюда входит проверка сертификатов hello для:</p><ul><li>Доменное имя</li><li>Даты действия (даты начала и окончания срока действия).</li><li>Состояние отзыва.</li><li>Использование (например, проверка подлинности сервера для серверов, проверка подлинности клиента для клиентов).</li><li>Цепь доверия. Сертификаты должен связываться по цепочке tooa корневой центр сертификации (ЦС), является доверенным для платформы hello или явным образом настроен администратором hello</li><li>Длина открытого ключа сертификата должна быть больше 2048 бит.</li><li>Должен использоваться алгоритм хэширования версии SHA256 или более поздней. |

## <a id="ssl-appservice"></a>Настройте сертификат SSL для личного домена в службе приложений Azure

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | EnvironmentType: Azure |
| **Справочные материалы**              | [Включение протокола HTTPS для приложения в службе приложений Azure](https://azure.microsoft.com/documentation/articles/web-sites-configure-ssl-certificate/) |
| **Действия** | По умолчанию Azure уже обеспечивает HTTPS для каждого приложения с сертификатом с подстановочными символами для hello *. azurewebsites.net домена. Однако, как и все домены с подстановочными знаками, он не так безопасен, как личный домен с собственным сертификатом. Дополнительные сведения см. в [этой статье](https://casecurity.org/2014/02/26/pros-and-cons-of-single-domain-multi-domain-and-wildcard-certificates/). Рекомендуется tooenable SSL для пользовательского домена hello, какое приложение hello развертывания будет осуществляться через|

## <a id="appservice-https"></a>Принудительно все tooAzure трафика службы приложений через соединение по протоколу HTTPS

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | EnvironmentType: Azure |
| **Справочные материалы**              | [Защита личного домена приложения с помощью протокола HTTPS]https://azure.microsoft.com/documentation/articles/web-sites-configure-ssl-certificate/#4-enforce-https-on-your-app) |
| **Действия** | <p>Хотя Azure уже обеспечивает HTTPS для службы приложений Azure с сертификатом с подстановочными символами для домена hello *. azurewebsites.net, не выполняют HTTPS. Посетители по-прежнему может получать доступ к протоколу HTTP, который может нарушить безопасность приложение hello приложение hello и поэтому HTTPS имеет toobe принудительно явным образом. ASP.NET MVC-приложений следует использовать hello [RequireHttps фильтра](http://msdn.microsoft.com/library/system.web.mvc.requirehttpsattribute.aspx) , требующий небезопасную toobe запроса HTTP, повторно отправленных по протоколу HTTPS.</p><p>Кроме того hello переопределения URL-адресов модуль, который входит в состав службы приложений Azure может быть tooenforce используется HTTPS. Модуль переопределения URL-адресов позволяет разработчикам toodefine правила, примененные tooincoming запросов перед hello запросы передаются tooyour приложения. В файле web.config, хранимых в корневом hello приложения hello определенных правил переопределения URL-адресов</p>|

### <a name="example"></a>Пример
Hello следующий пример содержит основные правила переопределения URL-адресов, которое заставляет все входящие toouse трафик HTTPS
```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <rule name="Force HTTPS" enabled="true">
          <match url="(.*)" ignoreCase="false" />
          <conditions>
            <add input="{HTTPS}" pattern="off" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" appendQueryString="true" redirectType="Permanent" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
</configuration>
```
Это правило может действовать, возвращая код состояния HTTP 301 (постоянное перенаправление) при hello пользователь запрашивает страницу с помощью протокола HTTP. Hello 301 перенаправления hello запроса toohello же URL-адрес как посетитель hello запрошено, но заменяет hello HTTP часть hello запроса с помощью протокола HTTPS. Например HTTP://contoso.com бы перенаправленный tooHTTPS://contoso.com. 

## <a id="http-hsts"></a>Включите строгий режим безопасности транспорта HTTP (HSTS)

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Памятка OWASP по HSTS](https://www.owasp.org/index.php/HTTP_Strict_Transport_Security_Cheat_Sheet) |
| **Действия** | <p>HTTP строгой безопасности транспорта (HSTS) — расширение согласиться на использование безопасности, определяемый веб-приложения с использованием hello заголовок специальные ответа. Когда поддерживаемого браузера получает этот заголовок браузера позволит обмен данными из посылаются через HTTP toohello указанного домена и вместо этого будет отправлять все связи по протоколу HTTPS. HSTS также предотвращает переходы на вредоносные страницы по протоколу HTTPS в браузерах.</p><p>tooimplement HSTS hello после заголовка ответа имеет toobe глобально, настроенных для веб-сайта в коде или в файле конфигурации. Strict--безопасности транспорта: max-age = 300; includeSubDomains HSTS рассматриваются следующие угрозы hello:</p><ul><li>Пользователь создает закладки или вручную вводит http://example.com и является злоумышленник в середине tooa субъекта: HSTS автоматически перенаправляет tooHTTPS запросы HTTP для целевого домена hello</li><li>Веб-приложение, которое является предполагаемым toobe исключительно HTTPS случайно ссылки HTTP или служит содержимого по протоколу HTTP: HSTS автоматически перенаправляет tooHTTPS запросы HTTP для целевого домена hello</li><li>Злоумышленник в середине пытается toointercept трафик от пользователей жертвы использует недопустимый сертификат и рассчитывает hello пользователя будет принимать неверный сертификат hello: HSTS не допускает сообщение hello недопустимый сертификат пользователя toooverride</li></ul>|

## <a id="sqlserver-validation"></a>Включите шифрование подключения и проверку сертификатов SQL Server

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | SQL Azure  |
| **Атрибуты**              | Версия SQL: 12 |
| **Справочные материалы**              | [Рекомендации по написанию безопасных строк подключения для базы данных SQL](http://social.technet.microsoft.com/wiki/contents/articles/2951.windows-azure-sql-database-connection-security.aspx#best) |
| **Действия** | <p>Все подключения между базой данных SQL и клиентским приложением шифруются с помощью протокола SSL. База данных SQL не поддерживает незашифрованные подключения. сертификаты toovalidate с кодом приложения или средства, явно запроса зашифрованного соединения и без доверия сертификатов сервера hello. Если код приложения или инструменты не запрашивают зашифрованное подключение, они все равно его получат.</p><p>Тем не менее, они могут не проверять сертификаты сервера hello и поэтому становятся восприимчивыми слишком атак «злоумышленник в середине hello». toovalidate сертификатов с помощью прикладного кода ADO.NET задайте `Encrypt=True` и `TrustServerCertificate=False` в строку подключения базы данных hello. toovalidate сертификаты с помощью SQL Server Management Studio откройте диалоговое окно tooServer подключение hello. Щелкните шифровать соединение на вкладке Свойства соединения hello</p>|

## <a id="encrypted-sqlserver"></a>Принудительное шифрование связи tooSQL сервера

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Локальные |
| **Атрибуты**              | Версия SQL: MsSQL2016, MsSQL2012, MsSQL2014 |
| **Справочные материалы**              | [Включение шифрования соединений toohello компонент Database Engine](https://msdn.microsoft.com/library/ms191192)  |
| **Действия** | Шифрование SSL повышает безопасность передачи данных по сетям между экземплярами SQL Server и приложения hello. |

## <a id="comm-storage"></a>Убедитесь, что tooAzure связи хранилища — по протоколу HTTPS

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Хранилище Azure | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Руководство по безопасности службы хранилища Azure. Шифрование на уровне транспорта с помощью протокола HTTPS](https://azure.microsoft.com/documentation/articles/storage-security-guide/#_encryption-in-transit) |
| **Действия** | безопасность hello tooensure хранилища Azure данных во время передачи, всегда использовать протокол HTTPS hello, при вызове hello API-интерфейс REST или обращении к объектов в хранилище. Кроме того подписанные URL-адреса, которые могут быть используется toodelegate доступ к объектам хранилища tooAzure, включите параметр toospecify только приветствия, можно использовать протокол HTTPS, при использовании подписей общего доступа, обеспечивая любой пользователь отправкой статьях с токенами SAS будет Используйте правильную протокола hello.|

## <a id="md5-https"></a>Проверяйте MD5-хэш после скачивания большого двоичного объекта по протоколу HTTP

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Хранилище Azure | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Тип хранилища: большой двоичный объект |
| **Справочные материалы**              | [Общие сведения о проверке MD5 в службе BLOB-объектов Microsoft Azure](https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/) |
| **Действия** | <p>Служба больших двоичных объектов Windows Azure обеспечивает целостность данных механизмов tooensure как на приложения hello и транспортного уровня. Если для какой-либо причине требуется toouse HTTP вместо HTTPS и вы работаете с блочных больших двоичных объектов может использовать проверка MD5 toohelp проверки целостности hello hello BLOB-объектов, передаваемых</p><p>Это поможет защититься от ошибок транспортного и сетевого уровня, но не обязательно предотвратит атаки промежуточного уровня. Если можно использовать протокол HTTPS, который обеспечивает безопасность на транспортном уровне, то применение проверки MD5 является избыточным и ненужным.</p>|

## <a id="smb-shares"></a>Использовать SMB 3.0 совместимые клиентские tooensure во время передачи данных шифрования tooAzure, файловыми ресурсами общего доступа

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Мобильный клиент | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Тип хранилища: файлы |
| **Справочные материалы**              | [Сведения о хранилище файлов Azure](https://azure.microsoft.com/blog/azure-file-storage-now-generally-available/#comment-2529238931), [Приступая к работе с хранилищем файлов Azure в Windows](https://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-files/#_mount-the-file-share) |
| **Действия** | Хранилище файлов Azure поддерживает протокол HTTPS при использовании REST API hello, но наиболее часто используемых как файловый ресурс SMB подключенные tooa виртуальной Машины. SMB 2.1 не поддерживает шифрование, поэтому соединения разрешены только в пределах hello же область в Azure. Тем не менее SMB 3.0 поддерживает шифрование, можно использовать с Windows Server 2012 R2, Windows 8, Windows 8.1 и Windows 10, позволяя различных регионах доступ и даже доступа на рабочем столе hello. |

## <a id="cert-pinning"></a>Реализуйте привязку сертификата

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Хранилище Azure | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальное, Windows Phone |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Привязка сертификата и открытого ключа](https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#.Net) |
| **Действия** | <p>Привязка сертификата защищает от атак "злоумышленник в середине". Закрепление — процесс hello связывание узла с их X509 Ожидаемый сертификат и открытый ключ. Сертификат или открытый ключ известен или для узла, сертификат hello или открытый ключ после узла toohello связанные или «закрепленные». </p><p>Таким образом когда злоумышленник пытается toodo, атак SSL MITM, во время ключу hello подтверждения SSL с сервера злоумышленника будут отличаться от hello закрепленные ключа сертификата и hello запроса не сохранятся, предотвращения MITM сертификат закрепление может осуществляться через Реализация элемента ServicePointManager `ServerCertificateValidationCallback` делегата.</p>|

### <a name="example"></a>Пример
```C#
using System;
using System.Net;
using System.Net.Security;
using System.Security.Cryptography;

namespace CertificatePinningExample
{
    class CertificatePinningExample
    {
        /* Note: In this example, we're hardcoding a hello certificate's public key and algorithm for 
           demonstration purposes. In a real-world application, this should be stored in a secure
           configuration area that can be updated as needed. */

        private static readonly string PINNED_ALGORITHM = "RSA";

        private static readonly string PINNED_PUBLIC_KEY = "3082010A0282010100B0E75B7CBE56D31658EF79B3A1" +
            "294D506A88DFCDD603F6EF15E7F5BCBDF32291EC50B2B82BA158E905FE6A83EE044A48258B07FAC3D6356AF09B2" +
            "3EDAB15D00507B70DB08DB9A20C7D1201417B3071A346D663A241061C151B6EC5B5B4ECCCDCDBEA24F051962809" +
            "FEC499BF2D093C06E3BDA7D0BB83CDC1C2C6660B8ECB2EA30A685ADE2DC83C88314010FFC7F4F0F895EDDBE5C02" +
            "ABF78E50B708E0A0EB984A9AA536BCE61A0C31DB95425C6FEE5A564B158EE7C4F0693C439AE010EF83CA8155750" +
            "09B17537C29F86071E5DD8CA50EBD8A409494F479B07574D83EDCE6F68A8F7D40447471D05BC3F5EAD7862FA748" +
            "EA3C92A60A128344B1CEF7A0B0D94E50203010001";


        public static void Main(string[] args)
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://azure.microsoft.com");
            request.ServerCertificateValidationCallback = (sender, certificate, chain, sslPolicyErrors) =>
            {
                if (certificate == null || sslPolicyErrors != SslPolicyErrors.None)
                {
                    // Error getting certificate or hello certificate failed basic validation
                    return false;
                }

                var targetKeyAlgorithm = new Oid(certificate.GetKeyAlgorithm()).FriendlyName;
                var targetPublicKey = certificate.GetPublicKeyString();
                
                if (targetKeyAlgorithm == PINNED_ALGORITHM &&
                    targetPublicKey == PINNED_PUBLIC_KEY)
                {
                    // Success, hello certificate matches hello pinned value.
                    return true;
                }
                // Reject, either hello key or hello algorithm does not match hello expected value.
                return false;
            };

            try
            {
                var response = (HttpWebResponse)request.GetResponse();
                Console.WriteLine($"Success, HTTP status code: {response.StatusCode}");
            }
            catch(Exception ex)
            {
                Console.WriteLine($"Failure, {ex.Message}");
            }
            Console.WriteLine("Press any key tooend.");
            Console.ReadKey();
        }
    }
}
```

## <a id="https-transport"></a>Включите безопасный канал транспорта HTTPS

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | .NET Framework 3 |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify Kingdom](https://vulncat.fortify.com/en/vulncat/index.html) |
| **Действия** | Конфигурация приложения Hello следует убедиться, что HTTPS используется для всех сведений о toosensitive доступа.<ul><li>**Описание:** Если приложение обрабатывает конфиденциальной информации и не использует шифрование на уровне сообщений, то он может только toocommunicate по каналу зашифрованные транспорта.</li><li>**Рекомендации.** Отключите транспортный протокол HTTP и включите HTTPS. Например, замените hello `<httpTransport/>` с `<httpsTransport/>` тег. Не следует полагаться на tooguarantee сетевой конфигурации (брандмауэром), что приложение hello может осуществляться только через защищенный канал. С философским точки зрения приложения hello не должны зависеть от сети hello в плане безопасности.</li></ul><p>С практической точки зрения hello людей, ответственная за безопасность сети hello не всегда отслеживать hello требования безопасности приложения hello развития.</p>|

## <a id="message-protection"></a>WCF: TooEncryptAndSign уровня защиты безопасности набор сообщения

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | .NET Framework 3 |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [MSDN](https://msdn.microsoft.com/library/ff650862.aspx) |
| **Действия** | <ul><li>**Описание:** когда установлен уровень защиты слишком «нет» оно приведет к отключению защиты сообщений. Конфиденциальность и целостность достигается при использовании соответствующего уровня настройки.</li><li>**Рекомендации.**<ul><li>Задайте значение `Mode=None`, чтобы отключить защиту сообщений.</li><li>Когда `Mode=Sign` -знаки, но не зашифровать сообщение hello; следует использовать, если важна целостность данных</li><li>Когда `Mode=EncryptAndSign` -знаки и шифрует сообщение hello</li></ul></li></ul><p>Рассмотрите возможность отключения шифрования и только подписи сообщения, если необходимо просто toovalidate hello целостность hello без обеспечения конфиденциальности. Это может быть полезно для операций или контракты служб, в котором нужно отправитель hello toovalidate. Однако конфиденциальные данные не передаются. При сокращении размера hello уровень защиты, будьте внимательны, приветственное сообщение не содержит персональные данные (PII).</p>|

### <a name="example"></a>Пример
Настройка службы hello и сообщение hello операции tooonly входа hello отображается в следующих примерах hello. Пример контракта службы `ProtectionLevel.Sign`: hello ниже приведен пример использования ProtectionLevel.Sign на уровне контракта службы hello: 
```
[ServiceContract(Protection Level=ProtectionLevel.Sign] 
public interface IService 
  { 
  string GetData(int value); 
  } 
```

### <a name="example"></a>Пример
Пример контракта операции `ProtectionLevel.Sign` (для детализированного управления): hello ниже приведен пример использования `ProtectionLevel.Sign` на hello OperationContract уровень:

```
[OperationContract(ProtectionLevel=ProtectionLevel.Sign] 
string GetData(int value);
``` 

## <a id="least-account-wcf"></a>WCF: Используйте toorun минимальными правами доступа учетной записи службы WCF

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | .NET Framework 3 |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [MSDN](https://msdn.microsoft.com/library/ff648826.aspx ) |
| **Действия** | <ul><li>**Пояснение.** Не запускайте службы WCF, используя учетную запись с высоким уровнем привилегий или учетную запись администратора. В случае компрометации служб это может иметь значительные последствия.</li><li>**РЕКОМЕНДАЦИИ:** использовать toohost записи с минимальными правами, службы WCF, так как он будет уменьшить уязвимость приложения и снизить потенциальный ущерб hello, если атаки. Если учетная запись службы hello требует дополнительных прав на ресурсы инфраструктуры, такие как MSMQ, hello журнала событий, счетчики производительности и hello файловой системы, соответствующие разрешения должны предоставляться toothese ресурсы для запуска службы WCF hello успешно.</li></ul><p>Если службе нужна tooaccess определенным ресурсам от имени первоначального участника hello, используйте олицетворение и делегирование tooflow hello удостоверение для проверки авторизации подчиненных. В сценарии разработки используете hello локального учетная запись сетевой службы, которая — специальная встроенная учетная запись с ограниченными правами. В рабочем сценарии создайте пользовательскую учетную запись службы домена с минимальными привилегиями</p>|

## <a id="webapi-https"></a>Принудительно все tooWeb трафика API-интерфейсы через соединение по протоколу HTTPS

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-интерфейс API | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | MVC 5, MVC 6 |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Информация о работе с SSL в веб-интерфейсе API](http://www.asp.net/web-api/overview/security/working-with-ssl-in-web-api) |
| **Действия** | Если приложение имеет привязку HTTP и HTTPS, клиенты могут использовать HTTP tooaccess hello сайта. tooprevent, воспользуйтесь всегда являются tooensure фильтра действий, запрашивающий tooprotected API-интерфейсы по протоколу HTTPS.|

### <a name="example"></a>Пример 
Hello ниже код демонстрирует фильтр проверки подлинности веб-API, который проверяет наличие SSL. 
```C#
public class RequireHttpsAttribute : AuthorizationFilterAttribute
{
    public override void OnAuthorization(HttpActionContext actionContext)
    {
        if (actionContext.Request.RequestUri.Scheme != Uri.UriSchemeHttps)
        {
            actionContext.Response = new HttpResponseMessage(System.Net.HttpStatusCode.Forbidden)
            {
                ReasonPhrase = "HTTPS Required"
            };
        }
        else
        {
            base.OnAuthorization(actionContext);
        }
    }
}
```
Добавьте этот веб-API действий фильтра tooany, которых требуется SSL. 
```C#
public class ValuesController : ApiController
{
    [RequireHttps]
    public HttpResponseMessage Get() { ... }
}
```
 
## <a id="redis-ssl"></a>Убедитесь, что tooAzure связи — кэш Redis по протоколу SSL

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | кэш Azure Redis | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Кэш Redis для Azure. Вопросы и ответы](https://azure.microsoft.com/documentation/articles/cache-faq/#when-should-i-enable-the-non-ssl-port-for-connecting-to-redis) |
| **Действия** | Redis сервер не поддерживает SSL стандартной hello, но не в кэше Redis для Azure. Если вы подключаетесь tooAzure кэша Redis и клиент поддерживает SSL, например StackExchange.Redis, следует использовать SSL. По умолчанию порт без SSL отключен для новых экземпляров кэша Redis для Azure. Убедитесь, что защищенные параметры по умолчанию hello не изменяется, если имеется зависимость для клиентов redis поддержку SSL. |

Пожалуйста Обратите внимание, что Redis спроектированный toobe обращаются доверенных клиентов в доверенных средах. Это означает, что обычно не хорошее tooexpose hello Redis непосредственно экземпляра toohello идея Интернет или в общем случае tooan среде, где можно получить доступ клиенты без доверия hello Redis TCP-порт или UNIX сокета. 

## <a id="device-field"></a>Безопасные подключения шлюза tooField устройства

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Полевой шлюз Интернета вещей | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Для устройств на основе IP протокол связи hello удалось обычно содержатся в во время передачи данных tooprotect канала SSL/TLS. Для других протоколов, которые не поддерживают SSL/TLS проверьте, существует безопасные версии протокола hello обеспечения безопасности на уровне транспорта или сообщений. |

## <a id="device-cloud"></a>Защита tooCloud устройства шлюза связи, используя протокол SSL/TLS

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Облачный шлюз Интернета вещей | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Руководство разработчика по центру Azure IoT (IoT — Интернет вещей)](https://azure.microsoft.com/documentation/articles/iot-hub-devguide/#messaging) |
| **Действия** | Защитите протоколы HTTP/AMQP или MQTT с помощью SSL/TLS. |
