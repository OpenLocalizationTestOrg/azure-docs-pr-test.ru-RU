---
title: "aaaInput проверки - Microsoft средства моделирования угроз - Azure | Документы Microsoft"
description: "защиту от угроз, которые представлены в hello средства моделирования угроз"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: 823503881f4bae292ef021834d5e64acf2a0f54a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="security-frame-input-validation--mitigations"></a><span data-ttu-id="14a62-103">Механизм безопасности: проверки входных данных | Снижение риска</span><span class="sxs-lookup"><span data-stu-id="14a62-103">Security Frame: Input Validation | Mitigations</span></span> 
| <span data-ttu-id="14a62-104">Продукт или служба</span><span class="sxs-lookup"><span data-stu-id="14a62-104">Product/Service</span></span> | <span data-ttu-id="14a62-105">Статья</span><span class="sxs-lookup"><span data-stu-id="14a62-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="14a62-106">**Веб-приложение**</span><span class="sxs-lookup"><span data-stu-id="14a62-106">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="14a62-107">Отключайте скрипты XSLT для всех операций преобразования, использующих ненадежные таблицы стилей</span><span class="sxs-lookup"><span data-stu-id="14a62-107">Disable XSLT scripting for all transforms using untrusted style sheets</span></span>](#disable-xslt)</li><li>[<span data-ttu-id="14a62-108">Убедитесь, что каждая страница, на которой может быть содержимое, управляемое пользователем, не использует автоматическое обнаружение типов MIME</span><span class="sxs-lookup"><span data-stu-id="14a62-108">Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>](#out-sniffing)</li><li>[<span data-ttu-id="14a62-109">Усильте защиту для разрешения сущностей XML или отключите его</span><span class="sxs-lookup"><span data-stu-id="14a62-109">Harden or Disable XML Entity Resolution</span></span>](#xml-resolution)</li><li>[<span data-ttu-id="14a62-110">Приложения, использующие драйвер http.sys, выполняют проверку нормализации URL-адресов</span><span class="sxs-lookup"><span data-stu-id="14a62-110">Applications utilizing http.sys perform URL canonicalization verification</span></span>](#app-verification)</li><li>[<span data-ttu-id="14a62-111">Убедитесь, что при приеме файлов от пользователей обеспечиваются соответствующие меры безопасности</span><span class="sxs-lookup"><span data-stu-id="14a62-111">Ensure appropriate controls are in place when accepting files from users</span></span>](#controls-users)</li><li>[<span data-ttu-id="14a62-112">Убедитесь, что в веб-приложении для доступа к данным используются параметры типобезопасности</span><span class="sxs-lookup"><span data-stu-id="14a62-112">Ensure that type-safe parameters are used in Web Application for data access</span></span>](#typesafe)</li><li>[<span data-ttu-id="14a62-113">Используйте классы привязки отдельной модели или привязки списков уязвимость массового присваивания tooprevent MVC</span><span class="sxs-lookup"><span data-stu-id="14a62-113">Use separate model binding classes or binding filter lists tooprevent MVC mass assignment vulnerability</span></span>](#binding-mvc)</li><li>[<span data-ttu-id="14a62-114">Кодирование предыдущих toorendering вывода ненадежных веб</span><span class="sxs-lookup"><span data-stu-id="14a62-114">Encode untrusted web output prior toorendering</span></span>](#rendering)</li><li>[<span data-ttu-id="14a62-115">Проверяйте и фильтруйте входные данные по всем свойствам модели строкового типа</span><span class="sxs-lookup"><span data-stu-id="14a62-115">Perform input validation and filtering on all string type Model properties</span></span>](#typemodel)</li><li>[<span data-ttu-id="14a62-116">Очищайте поля форм, принимающие все знаки, например редактор форматированного текста</span><span class="sxs-lookup"><span data-stu-id="14a62-116">Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>](#richtext)</li><li>[<span data-ttu-id="14a62-117">Не назначайте toosinks элементы DOM, не имеет встроенных кодировки</span><span class="sxs-lookup"><span data-stu-id="14a62-117">Do not assign DOM elements toosinks that do not have inbuilt encoding</span></span>](#inbuilt-encode)</li><li>[<span data-ttu-id="14a62-118">Проверить все закрытые или делать безопасно перенаправления приложения hello</span><span class="sxs-lookup"><span data-stu-id="14a62-118">Validate all redirects within hello application are closed or done safely</span></span>](#redirect-safe)</li><li>[<span data-ttu-id="14a62-119">Внедрите проверку входных данных для всех параметров строкового типа, принимаемых методами контроллера</span><span class="sxs-lookup"><span data-stu-id="14a62-119">Implement input validation on all string type parameters accepted by Controller methods</span></span>](#string-method)</li><li>[<span data-ttu-id="14a62-120">Задать время ожидания верхний предел для регулярного выражения, обработка DoS tooprevent из-за toobad регулярные выражения</span><span class="sxs-lookup"><span data-stu-id="14a62-120">Set upper limit timeout for regular expression processing tooprevent DoS due toobad regular expressions</span></span>](#dos-expression)</li><li>[<span data-ttu-id="14a62-121">Не используйте метод Html.Raw в представлениях Razor</span><span class="sxs-lookup"><span data-stu-id="14a62-121">Avoid using Html.Raw in Razor views</span></span>](#html-razor)</li></ul> | 
| <span data-ttu-id="14a62-122">**База данных**</span><span class="sxs-lookup"><span data-stu-id="14a62-122">**Database**</span></span> | <ul><li>[<span data-ttu-id="14a62-123">Не используйте динамические запросы в хранимых процедурах</span><span class="sxs-lookup"><span data-stu-id="14a62-123">Do not use dynamic queries in stored procedures</span></span>](#stored-proc)</li></ul> |
| <span data-ttu-id="14a62-124">**Веб-интерфейс API**</span><span class="sxs-lookup"><span data-stu-id="14a62-124">**Web API**</span></span> | <ul><li>[<span data-ttu-id="14a62-125">Убедитесь, что в методах веб-API выполнена проверка моделей</span><span class="sxs-lookup"><span data-stu-id="14a62-125">Ensure that model validation is done on Web API methods</span></span>](#validation-api)</li><li>[<span data-ttu-id="14a62-126">Внедрите проверку входных данных для всех параметров строкового типа, принимаемых методами веб-API</span><span class="sxs-lookup"><span data-stu-id="14a62-126">Implement input validation on all string type parameters accepted by Web API methods</span></span>](#string-api)</li><li>[<span data-ttu-id="14a62-127">Убедитесь, что в веб-API для доступа к данным используются параметры типобезопасности</span><span class="sxs-lookup"><span data-stu-id="14a62-127">Ensure that type-safe parameters are used in Web API for data access</span></span>](#typesafe-api)</li></ul> | 
| <span data-ttu-id="14a62-128">**Azure DocumentDB**</span><span class="sxs-lookup"><span data-stu-id="14a62-128">**Azure Document DB**</span></span> | <ul><li>[<span data-ttu-id="14a62-129">Используйте параметризованные SQL-запросы для DocumentDB</span><span class="sxs-lookup"><span data-stu-id="14a62-129">Use parametrized SQL queries for DocumentDB</span></span>](#sql-docdb)</li></ul> | 
| <span data-ttu-id="14a62-130">**WCF**</span><span class="sxs-lookup"><span data-stu-id="14a62-130">**WCF**</span></span> | <ul><li>[<span data-ttu-id="14a62-131">Проверка входных данных WCF путем привязки к схеме</span><span class="sxs-lookup"><span data-stu-id="14a62-131">WCF Input validation through Schema binding</span></span>](#schema-binding)</li><li>[<span data-ttu-id="14a62-132">Проверка входных данных WCF с помощью инспекторов параметров</span><span class="sxs-lookup"><span data-stu-id="14a62-132">WCF- Input validation through Parameter Inspectors</span></span>](#parameters)</li></ul> |

## <span data-ttu-id="14a62-133"><a id="disable-xslt"></a>Отключайте скрипты XSLT для всех операций преобразования, использующих ненадежные таблицы стилей</span><span class="sxs-lookup"><span data-stu-id="14a62-133"><a id="disable-xslt"></a>Disable XSLT scripting for all transforms using untrusted style sheets</span></span>

| <span data-ttu-id="14a62-134">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-134">Title</span></span>                   | <span data-ttu-id="14a62-135">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-135">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-136">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-136">**Component**</span></span>               | <span data-ttu-id="14a62-137">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-137">Web Application</span></span> | 
| <span data-ttu-id="14a62-138">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-138">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-139">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-139">Build</span></span> |  
| <span data-ttu-id="14a62-140">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-140">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-141">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-141">Generic</span></span> |
| <span data-ttu-id="14a62-142">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-142">**Attributes**</span></span>              | <span data-ttu-id="14a62-143">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-143">N/A</span></span>  |
| <span data-ttu-id="14a62-144">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-144">**References**</span></span>              | <span data-ttu-id="14a62-145">[Безопасность XSLT](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx) (Свойство XsltSettings.EnableScript)</span><span class="sxs-lookup"><span data-stu-id="14a62-145">[XSLT Security](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span></span> |
| <span data-ttu-id="14a62-146">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-146">**Steps**</span></span> | <span data-ttu-id="14a62-147">XSLT поддерживает сценарии внутри таблицы стилей с помощью hello `<msxml:script>` элемента.</span><span class="sxs-lookup"><span data-stu-id="14a62-147">XSLT supports scripting inside style sheets using hello `<msxml:script>` element.</span></span> <span data-ttu-id="14a62-148">Это позволяет toobe пользовательских функций, используемых в XSLT-преобразования.</span><span class="sxs-lookup"><span data-stu-id="14a62-148">This allows custom functions toobe used in an XSLT transformation.</span></span> <span data-ttu-id="14a62-149">Hello сценарий выполняется в контексте hello hello процесса выполнения преобразования hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-149">hello script is executed under hello context of hello process performing hello transform.</span></span> <span data-ttu-id="14a62-150">Скрипт XSLT, необходимо отключить в ненадежной среде выполнения tooprevent ненадежный код.</span><span class="sxs-lookup"><span data-stu-id="14a62-150">XSLT script must be disabled when in an untrusted environment tooprevent execution of untrusted code.</span></span> <span data-ttu-id="14a62-151">*Если с помощью .NET:* скрипты XSLT отключены по умолчанию; однако необходимо убедиться, что он не включен явно через hello `XsltSettings.EnableScript` свойство.</span><span class="sxs-lookup"><span data-stu-id="14a62-151">*If using .NET:* XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through hello `XsltSettings.EnableScript` property.</span></span>|

### <a name="example"></a><span data-ttu-id="14a62-152">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-152">Example</span></span> 

```C#
XsltSettings settings = new XsltSettings();
settings.EnableScript = true; // WRONG: THIS SHOULD BE SET toofalse
```

### <a name="example"></a><span data-ttu-id="14a62-153">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-153">Example</span></span>
<span data-ttu-id="14a62-154">При использовании с помощью MSXML 6.0, скрипты XSLT отключены по умолчанию. Тем не менее необходимо убедиться, что он не включен явно через свойство объекта XML DOM hello AllowXsltScript.</span><span class="sxs-lookup"><span data-stu-id="14a62-154">If you are using using MSXML 6.0, XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through hello XML DOM object property AllowXsltScript.</span></span> 

```C#
doc.setProperty("AllowXsltScript", true); // WRONG: THIS SHOULD BE SET toofalse
```

### <a name="example"></a><span data-ttu-id="14a62-155">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-155">Example</span></span>
<span data-ttu-id="14a62-156">Если вы используете MSXML версии 5 или более ранней, скрипты XSLT включены по умолчанию. Их необходимо явно отключать.</span><span class="sxs-lookup"><span data-stu-id="14a62-156">If you are using MSXML 5 or below, XSLT scripting is enabled by default and you must explicitly disable it.</span></span> <span data-ttu-id="14a62-157">Задайте hello XML DOM объекта свойство AllowXsltScript toofalse.</span><span class="sxs-lookup"><span data-stu-id="14a62-157">Set hello XML DOM object property AllowXsltScript toofalse.</span></span> 

```C#
doc.setProperty("AllowXsltScript", false); // CORRECT. Setting toofalse disables XSLT scripting.
```

## <span data-ttu-id="14a62-158"><a id="out-sniffing"></a>Убедитесь, что каждая страница, на которой может быть содержимое, управляемое пользователем, не использует автоматическое обнаружение типов MIME</span><span class="sxs-lookup"><span data-stu-id="14a62-158"><a id="out-sniffing"></a>Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>

| <span data-ttu-id="14a62-159">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-159">Title</span></span>                   | <span data-ttu-id="14a62-160">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-160">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-161">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-161">**Component**</span></span>               | <span data-ttu-id="14a62-162">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-162">Web Application</span></span> | 
| <span data-ttu-id="14a62-163">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-163">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-164">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-164">Build</span></span> |  
| <span data-ttu-id="14a62-165">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-165">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-166">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-166">Generic</span></span> |
| <span data-ttu-id="14a62-167">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-167">**Attributes**</span></span>              | <span data-ttu-id="14a62-168">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-168">N/A</span></span>  |
| <span data-ttu-id="14a62-169">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-169">**References**</span></span>              | <span data-ttu-id="14a62-170">[IE8 Security Part V — Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx) (Безопасность IE8, часть 5: комплексная защита)</span><span class="sxs-lookup"><span data-stu-id="14a62-170">[IE8 Security Part V - Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)</span></span>  |
| <span data-ttu-id="14a62-171">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-171">**Steps**</span></span> | <p><span data-ttu-id="14a62-172">Для каждой страницы, который может содержать управляемое содержимое пользователя, необходимо использовать hello заголовок HTTP `X-Content-Type-Options:nosniff`.</span><span class="sxs-lookup"><span data-stu-id="14a62-172">For each page that could contain user controllable content, you must use hello HTTP Header `X-Content-Type-Options:nosniff`.</span></span> <span data-ttu-id="14a62-173">toocomply с этим требованием, вы можете либо набор hello необходимые верхний колонтитул страницы для лишь те страницы, которые могут содержать настраиваемым пользователем содержимое, или может быть задана глобально для всех страниц приложения hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-173">toocomply with this requirement, you can either set hello required header page by page for only those pages that might contain user-controllable content, or you can set it globally for all pages in hello application.</span></span></p><p><span data-ttu-id="14a62-174">Каждый тип файлов, доставленных на веб-сервере имеет связанный [тип MIME](http://en.wikipedia.org/wiki/Mime_type) (также называется *content-type*), описывающий hello характер содержимого hello (то есть изображение, текст, приложения, и т. д.)</span><span class="sxs-lookup"><span data-stu-id="14a62-174">Each type of file delivered from a web server has an associated [MIME type](http://en.wikipedia.org/wiki/Mime_type) (also called a *content-type*) that describes hello nature of hello content (that is, image, text, application, etc.)</span></span></p><p><span data-ttu-id="14a62-175">Заголовок X-содержимое-тип Options Hello является заголовком HTTP, которая позволяет разработчикам toospecify, что их содержимое не будут вносятся MIME.</span><span class="sxs-lookup"><span data-stu-id="14a62-175">hello X-Content-Type-Options header is an HTTP header that allows developers toospecify that their content should not be MIME-sniffed.</span></span> <span data-ttu-id="14a62-176">Этот заголовок является спроектированный toomitigate сканирование MIME атак.</span><span class="sxs-lookup"><span data-stu-id="14a62-176">This header is designed toomitigate MIME-Sniffing attacks.</span></span> <span data-ttu-id="14a62-177">В Internet Explorer 8 (IE8) добавлена поддержка этого заголовка.</span><span class="sxs-lookup"><span data-stu-id="14a62-177">Support for this header was added in Internet Explorer 8 (IE8)</span></span></p><p><span data-ttu-id="14a62-178">Заголовком X-Content-Type-Options смогут воспользоваться только пользователи Internet Explorer 8 (IE8).</span><span class="sxs-lookup"><span data-stu-id="14a62-178">Only users of Internet Explorer 8 (IE8) will benefit from X-Content-Type-Options.</span></span> <span data-ttu-id="14a62-179">Предыдущие версии Internet Explorer не влияют на момент заголовок X-содержимое-тип Options hello</span><span class="sxs-lookup"><span data-stu-id="14a62-179">Previous versions of Internet Explorer do not currently respect hello X-Content-Type-Options header</span></span></p><p><span data-ttu-id="14a62-180">Internet Explorer 8 (и более поздние версии) hello только основные обозреватели возможность отказаться tooimplement сканирование MIME.</span><span class="sxs-lookup"><span data-stu-id="14a62-180">Internet Explorer 8 (and later) are hello only major browsers tooimplement a MIME-sniffing opt-out feature.</span></span> <span data-ttu-id="14a62-181">При других основных браузеров (Firefox и Safari, Chrome) реализовать аналогичные функции, эта рекомендация будет tooinclude обновленный синтаксис для этих обозревателей также</span><span class="sxs-lookup"><span data-stu-id="14a62-181">If and when other major browsers (Firefox, Safari, Chrome) implement similar features, this recommendation will be updated tooinclude syntax for those browsers as well</span></span></p>|

### <a name="example"></a><span data-ttu-id="14a62-182">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-182">Example</span></span>
<span data-ttu-id="14a62-183">обязательный заголовок tooenable hello глобально для всех страниц приложения hello, необходимо выполнить одно из следующих hello:</span><span class="sxs-lookup"><span data-stu-id="14a62-183">tooenable hello required header globally for all pages in hello application, you can do one of hello following:</span></span> 

* <span data-ttu-id="14a62-184">Добавить заголовок hello в файле web.config hello, если приложение hello размещается в Internet Information Services (IIS) 7</span><span class="sxs-lookup"><span data-stu-id="14a62-184">Add hello header in hello web.config file if hello application is hosted by Internet Information Services (IIS) 7</span></span> 

```
<system.webServer> 
  <httpProtocol> 
    <customHeaders> 
      <add name=""X-Content-Type-Options"" value=""nosniff""/>
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

* <span data-ttu-id="14a62-185">Добавить заголовок hello через hello глобальные приложения\_BeginRequest</span><span class="sxs-lookup"><span data-stu-id="14a62-185">Add hello header through hello global Application\_BeginRequest</span></span> 

``` 
void Application_BeginRequest(object sender, EventArgs e)
{
  this.Response.Headers[""X-Content-Type-Options""] = ""nosniff"";
} 
```

* <span data-ttu-id="14a62-186">Внедрите пользовательский HTTP-модуль.</span><span class="sxs-lookup"><span data-stu-id="14a62-186">Implement custom HTTP module</span></span> 

``` 
public class XContentTypeOptionsModule : IHttpModule 
  {
    #region IHttpModule Members 
    public void Dispose() 
    { 

    } 
    public void Init(HttpApplication context)
    { 
      context.PreSendRequestHeaders += newEventHandler(context_PreSendRequestHeaders); 
    } 
    #endregion 
    void context_PreSendRequestHeaders(object sender, EventArgs e) 
      { 
        HttpApplication application = sender as HttpApplication; 
        if (application == null) 
          return; 
        if (application.Response.Headers[""X-Content-Type-Options ""] != null) 
          return; 
        application.Response.Headers.Add(""X-Content-Type-Options "", ""nosniff""); 
      } 
  } 

``` 

* <span data-ttu-id="14a62-187">Обязательный заголовок hello только для отдельных страниц можно включить, добавив его tooindividual ответов:</span><span class="sxs-lookup"><span data-stu-id="14a62-187">You can enable hello required header only for specific pages by adding it tooindividual responses:</span></span> 

```
this.Response.Headers[""X-Content-Type-Options""] = ""nosniff""; 
``` 

## <span data-ttu-id="14a62-188"><a id="xml-resolution"></a>Усильте защиту для разрешения сущностей XML или отключите его</span><span class="sxs-lookup"><span data-stu-id="14a62-188"><a id="xml-resolution"></a>Harden or Disable XML Entity Resolution</span></span>

| <span data-ttu-id="14a62-189">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-189">Title</span></span>                   | <span data-ttu-id="14a62-190">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-190">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-191">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-191">**Component**</span></span>               | <span data-ttu-id="14a62-192">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-192">Web Application</span></span> | 
| <span data-ttu-id="14a62-193">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-193">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-194">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-194">Build</span></span> |  
| <span data-ttu-id="14a62-195">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-195">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-196">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-196">Generic</span></span> |
| <span data-ttu-id="14a62-197">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-197">**Attributes**</span></span>              | <span data-ttu-id="14a62-198">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-198">N/A</span></span>  |
| <span data-ttu-id="14a62-199">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-199">**References**</span></span>              | <span data-ttu-id="14a62-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html) (Расширения сущностей XML), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx) (XML: атаки типа "отказ в обслуживании" и способы защиты от них), [Общие сведения о безопасности MSXML](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Рекомендации по обеспечению безопасности кода MSXML](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html) (Справочник по протоколу NSXMLParserDelegate), [Разрешение внешних ресурсов](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span><span class="sxs-lookup"><span data-stu-id="14a62-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx), [MSXML Security Overview](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Best Practices for Securing MSXML Code](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolving External References](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span></span> |
| <span data-ttu-id="14a62-201">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-201">**Steps**</span></span>| <p><span data-ttu-id="14a62-202">Несмотря на то, что он широко не применяется, имеется функция XML, который позволяет tooexpand средство синтаксического анализа XML hello макрос сущностей с помощью значений, определенных в сам документ hello или из внешних источников.</span><span class="sxs-lookup"><span data-stu-id="14a62-202">Although it is not widely used, there is a feature of XML that allows hello XML parser tooexpand macro entities with values defined either within hello document itself or from external sources.</span></span> <span data-ttu-id="14a62-203">Например, документ hello определить сущность «companyname» со значением hello «Microsoft», чтобы каждый раз hello текст «&companyname;» отображается в документе hello, он автоматически заменяется текстом hello корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="14a62-203">For example, hello document might define an entity "companyname" with hello value "Microsoft," so that every time hello text "&companyname;" appears in hello document, it is automatically replaced with hello text Microsoft.</span></span> <span data-ttu-id="14a62-204">Или hello документ может иметь собственное определение сущности «MSFTStock», который ссылается на внешний веб службы toofetch hello текущее значение Microsoft stock.</span><span class="sxs-lookup"><span data-stu-id="14a62-204">Or, hello document might define an entity "MSFTStock" that references an external web service toofetch hello current value of Microsoft stock.</span></span></p><p><span data-ttu-id="14a62-205">Затем в любое время «&MSFTStock;» отображается в документе hello автоматически заменяется hello текущего акций.</span><span class="sxs-lookup"><span data-stu-id="14a62-205">Then any time "&MSFTStock;" appears in hello document, it is automatically replaced with hello current stock price.</span></span> <span data-ttu-id="14a62-206">Тем не менее эта функция может быть неправильно toocreate отказ в обслуживании (DoS).</span><span class="sxs-lookup"><span data-stu-id="14a62-206">However, this functionality can be abused toocreate denial of service (DoS) conditions.</span></span> <span data-ttu-id="14a62-207">Злоумышленники могут быть вложены несколько сущностей toocreate механизм XML экспоненциального расширения, который использует всю доступную память в системе hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-207">An attacker can nest multiple entities toocreate an exponential expansion XML bomb that consumes all available memory on hello system.</span></span> </p><p><span data-ttu-id="14a62-208">Кроме того он может создать внешних ссылок, который обрабатывает назад неограниченного количества данных или, просто зависает hello потока.</span><span class="sxs-lookup"><span data-stu-id="14a62-208">Alternatively, he can create an external reference that streams back an infinite amount of data or that simply hangs hello thread.</span></span> <span data-ttu-id="14a62-209">В результате все команды необходимо отключить внутренним и внешним разрешение сущностей XML полностью в том случае, если приложение не использует его или вручную ограничить объем памяти и времени, приложение hello, может использовать для разрешения сущностей, если эта функциональность hello Это действительно необходимо.</span><span class="sxs-lookup"><span data-stu-id="14a62-209">As a result, all teams must disable internal and/or external XML entity resolution entirely if their application does not use it, or manually limit hello amount of memory and time that hello application can consume for entity resolution if this functionality is absolutely necessary.</span></span> <span data-ttu-id="14a62-210">Если приложению не требуется разрешение сущностей, отключите его.</span><span class="sxs-lookup"><span data-stu-id="14a62-210">If entity resolution is not required by your application, then disable it.</span></span> </p>|

### <a name="example"></a><span data-ttu-id="14a62-211">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-211">Example</span></span>
<span data-ttu-id="14a62-212">Для кода .NET Framework можно использовать hello следующие подходы:</span><span class="sxs-lookup"><span data-stu-id="14a62-212">For .NET Framework code, you can use hello following approaches:</span></span>

```C#
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true;

XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);

// for .NET 4
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="14a62-213">Обратите внимание, это значение по умолчанию hello объекта `ProhibitDtd` в `XmlReaderSettings` имеет значение true, однако в `XmlTextReader` — false.</span><span class="sxs-lookup"><span data-stu-id="14a62-213">Note that hello default value of `ProhibitDtd` in `XmlReaderSettings` is true, but in `XmlTextReader` it is false.</span></span> <span data-ttu-id="14a62-214">При использовании XmlReaderSettings tooset ProhibitDtd tootrue не требуется явно, но рекомендуется ради безопасности это сделать.</span><span class="sxs-lookup"><span data-stu-id="14a62-214">If you are using XmlReaderSettings, you do not need tooset ProhibitDtd tootrue explicitly, but it is recommended for safety sake that you do.</span></span> <span data-ttu-id="14a62-215">Также Обратите внимание, что класс XmlDocument hello позволяет разрешение сущностей по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-215">Also note that hello XmlDocument class allows entity resolution by default.</span></span> 

### <a name="example"></a><span data-ttu-id="14a62-216">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-216">Example</span></span>
<span data-ttu-id="14a62-217">разрешение toodisable сущностей для объектов XmlDocument, используйте hello `XmlDocument.Load(XmlReader)` перегрузка hello загрузить метод и задать hello соответствующие свойства в разрешении toodisable аргумент XmlReader hello, как показано в следующим hello:</span><span class="sxs-lookup"><span data-stu-id="14a62-217">toodisable entity resolution for XmlDocuments, use hello `XmlDocument.Load(XmlReader)` overload of hello Load method and set hello appropriate properties in hello XmlReader argument toodisable resolution, as illustrated in hello following code:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);
XmlDocument doc = new XmlDocument();
doc.Load(reader);
```

### <a name="example"></a><span data-ttu-id="14a62-218">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-218">Example</span></span>
<span data-ttu-id="14a62-219">Если отключение разрешения сущностей не поддерживается для приложения, задайте hello XmlReaderSettings.MaxCharactersFromEntities tooa разумное значение свойства в соответствии с потребностями приложения tooyour.</span><span class="sxs-lookup"><span data-stu-id="14a62-219">If disabling entity resolution is not possible for your application, set hello XmlReaderSettings.MaxCharactersFromEntities property tooa reasonable value according tooyour application's needs.</span></span> <span data-ttu-id="14a62-220">Это ограничивает влияние hello потенциальных экспоненциального расширения DoS-атак.</span><span class="sxs-lookup"><span data-stu-id="14a62-220">This will limit hello impact of potential exponential expansion DoS attacks.</span></span> <span data-ttu-id="14a62-221">Hello после кода приведен пример такого подхода.</span><span class="sxs-lookup"><span data-stu-id="14a62-221">hello following code provides an example of this approach:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
XmlReader reader = XmlReader.Create(stream, settings);
```

### <a name="example"></a><span data-ttu-id="14a62-222">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-222">Example</span></span>
<span data-ttu-id="14a62-223">Если вам требуется tooresolve Встроенные сущности, но не обязательно tooresolve внешние сущности, задайте свойство toonull hello XmlReaderSettings.XmlResolver.</span><span class="sxs-lookup"><span data-stu-id="14a62-223">If you need tooresolve inline entities but do not need tooresolve external entities, set hello XmlReaderSettings.XmlResolver property toonull.</span></span> <span data-ttu-id="14a62-224">Например:</span><span class="sxs-lookup"><span data-stu-id="14a62-224">For example:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
settings.XmlResolver = null;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="14a62-225">Обратите внимание, что в MSXML6, ProhibitDTD tootrue (отключение обработки DTD) по умолчанию имеет значение.</span><span class="sxs-lookup"><span data-stu-id="14a62-225">Note that in MSXML6, ProhibitDTD is set tootrue (disabling DTD processing) by default.</span></span> <span data-ttu-id="14a62-226">Для кода Apple OSX или iOS можно использовать два средства синтаксического анализа XML: NSXMLParser и libXML2.</span><span class="sxs-lookup"><span data-stu-id="14a62-226">For Apple OSX/iOS code, there are two XML parsers you can use: NSXMLParser and libXML2.</span></span> 

## <span data-ttu-id="14a62-227"><a id="app-verification"></a>Приложения, использующие драйвер http.sys, выполняют проверку нормализации URL-адресов</span><span class="sxs-lookup"><span data-stu-id="14a62-227"><a id="app-verification"></a>Applications utilizing http.sys perform URL canonicalization verification</span></span>

| <span data-ttu-id="14a62-228">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-228">Title</span></span>                   | <span data-ttu-id="14a62-229">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-229">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-230">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-230">**Component**</span></span>               | <span data-ttu-id="14a62-231">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-231">Web Application</span></span> | 
| <span data-ttu-id="14a62-232">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-232">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-233">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-233">Build</span></span> |  
| <span data-ttu-id="14a62-234">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-234">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-235">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-235">Generic</span></span> |
| <span data-ttu-id="14a62-236">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-236">**Attributes**</span></span>              | <span data-ttu-id="14a62-237">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-237">N/A</span></span>  |
| <span data-ttu-id="14a62-238">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-238">**References**</span></span>              | <span data-ttu-id="14a62-239">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-239">N/A</span></span>  |
| <span data-ttu-id="14a62-240">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-240">**Steps**</span></span> | <p><span data-ttu-id="14a62-241">При работе с любым приложением, использующим драйвер http.sys, следует придерживаться следующих правил:</span><span class="sxs-lookup"><span data-stu-id="14a62-241">Any application that uses http.sys should follow these guidelines:</span></span></p><ul><li><span data-ttu-id="14a62-242">Ограничьте длину toono hello URL-адрес больше 16 384 символов (ASCII или Юникод).</span><span class="sxs-lookup"><span data-stu-id="14a62-242">Limit hello URL length toono more than 16,384 characters (ASCII or Unicode).</span></span> <span data-ttu-id="14a62-243">Это hello абсолютный Максимальная длина URL-адреса на основе параметра Internet Information Services (IIS) 6 по умолчанию hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-243">This is hello absolute maximum URL length based on hello default Internet Information Services (IIS) 6 setting.</span></span> <span data-ttu-id="14a62-244">По возможности для веб-сайтов следует создавать более короткие URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="14a62-244">Websites should strive for a length shorter than this if possible</span></span></li><li><span data-ttu-id="14a62-245">Использование стандартных классов файлового ввода-вывода .NET Framework hello (такой как FileStream), как они будут использовать преимущества hello правилам стандартизации в hello .NET FX</span><span class="sxs-lookup"><span data-stu-id="14a62-245">Use hello standard .NET Framework file I/O classes (such as FileStream) as these will take advantage of hello canonicalization rules in hello .NET FX</span></span></li><li><span data-ttu-id="14a62-246">Создайте список разрешенных известных имен файлов явным образом.</span><span class="sxs-lookup"><span data-stu-id="14a62-246">Explicitly build an allow-list of known filenames</span></span></li><li><span data-ttu-id="14a62-247">Явно отклоните известные типы файлов, для которых не будет выдаваться отклонение UrlScan: EXE, BAT, CMD, COM, HTW, IDA, IDQ, HTR, IDC, SHTM[L], STM, PRINTER, INI, POL, DAT.</span><span class="sxs-lookup"><span data-stu-id="14a62-247">Explicitly reject known filetypes you will not serve UrlScan rejects: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat files</span></span></li><li><span data-ttu-id="14a62-248">CATCH hello следующие исключения:</span><span class="sxs-lookup"><span data-stu-id="14a62-248">Catch hello following exceptions:</span></span><ul><li><span data-ttu-id="14a62-249">System.ArgumentException (для имен устройств);</span><span class="sxs-lookup"><span data-stu-id="14a62-249">System.ArgumentException (for device names)</span></span></li><li><span data-ttu-id="14a62-250">System.NotSupportedException (для потоков данных);</span><span class="sxs-lookup"><span data-stu-id="14a62-250">System.NotSupportedException (for data streams)</span></span></li><li><span data-ttu-id="14a62-251">System.IO.FileNotFoundException (для недопустимых экранированных имен файлов);</span><span class="sxs-lookup"><span data-stu-id="14a62-251">System.IO.FileNotFoundException (for invalid escaped filenames)</span></span></li><li><span data-ttu-id="14a62-252">System.IO.DirectoryNotFoundException (для недопустимых экранированных каталогов).</span><span class="sxs-lookup"><span data-stu-id="14a62-252">System.IO.DirectoryNotFoundException (for invalid escaped dirs)</span></span></li></ul></li><li><span data-ttu-id="14a62-253">*Не* вызов файла tooWin32 API-интерфейсов ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="14a62-253">*Do not* call out tooWin32 file I/O APIs.</span></span> <span data-ttu-id="14a62-254">На недопустимый URL-адрес верного возврата пользователя toohello ошибке 400 и журналов действительно ошибка hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-254">On an invalid URL gracefully return a 400 error toohello user, and log hello real error.</span></span></li></ul>|

## <span data-ttu-id="14a62-255"><a id="controls-users"></a>Убедитесь, что при приеме файлов от пользователей обеспечиваются соответствующие меры безопасности</span><span class="sxs-lookup"><span data-stu-id="14a62-255"><a id="controls-users"></a>Ensure appropriate controls are in place when accepting files from users</span></span>

| <span data-ttu-id="14a62-256">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-256">Title</span></span>                   | <span data-ttu-id="14a62-257">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-257">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-258">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-258">**Component**</span></span>               | <span data-ttu-id="14a62-259">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-259">Web Application</span></span> | 
| <span data-ttu-id="14a62-260">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-260">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-261">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-261">Build</span></span> |  
| <span data-ttu-id="14a62-262">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-262">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-263">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-263">Generic</span></span> |
| <span data-ttu-id="14a62-264">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-264">**Attributes**</span></span>              | <span data-ttu-id="14a62-265">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-265">N/A</span></span>  |
| <span data-ttu-id="14a62-266">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-266">**References**</span></span>              | <span data-ttu-id="14a62-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload) (Неограниченная передача файлов), [File Signature Table](http://www.garykessler.net/library/file_sigs.html) (Таблица подписей файлов)</span><span class="sxs-lookup"><span data-stu-id="14a62-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table](http://www.garykessler.net/library/file_sigs.html)</span></span> |
| <span data-ttu-id="14a62-268">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-268">**Steps**</span></span> | <p><span data-ttu-id="14a62-269">Переданные файлы представляют tooapplications серьезную угрозу.</span><span class="sxs-lookup"><span data-stu-id="14a62-269">Uploaded files represent a significant risk tooapplications.</span></span></p><p><span data-ttu-id="14a62-270">Первым шагом Hello в многие атаки является tooget атаке некоторые toobe системы toohello кода.</span><span class="sxs-lookup"><span data-stu-id="14a62-270">hello first step in many attacks is tooget some code toohello system toobe attacked.</span></span> <span data-ttu-id="14a62-271">Затем атаки hello достаточно toofind выполнения кода hello tooget способом.</span><span class="sxs-lookup"><span data-stu-id="14a62-271">Then hello attack only needs toofind a way tooget hello code executed.</span></span> <span data-ttu-id="14a62-272">Использование передачу файла позволяет злоумышленнику hello выполнения первого шага hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-272">Using a file upload helps hello attacker accomplish hello first step.</span></span> <span data-ttu-id="14a62-273">последствия Hello передачу неограниченный файла может быть различной, включая перехват всей системы, перегруженные файловой системы или базы данных, пересылка системы tooback атак, а также простой вандализм.</span><span class="sxs-lookup"><span data-stu-id="14a62-273">hello consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks tooback-end systems, and simple defacement.</span></span></p><p><span data-ttu-id="14a62-274">Это зависит от какое приложение hello делает hello загружен файлом и особенно хранятся там.</span><span class="sxs-lookup"><span data-stu-id="14a62-274">It depends on what hello application does with hello uploaded file and especially where it is stored.</span></span> <span data-ttu-id="14a62-275">На стороне сервера не предусмотрена проверка передаваемых файлов.</span><span class="sxs-lookup"><span data-stu-id="14a62-275">Server side validation of file uploads is missing.</span></span> <span data-ttu-id="14a62-276">Для отправки файлов нужно внедрять следующие меры безопасности:</span><span class="sxs-lookup"><span data-stu-id="14a62-276">Following security controls should be implemented for File Upload functionality:</span></span></p><ul><li><span data-ttu-id="14a62-277">Проверка расширений файлов (должны приниматься только определенные допустимые типы файлов).</span><span class="sxs-lookup"><span data-stu-id="14a62-277">File Extension check (only a valid set of allowed file type should be accepted)</span></span></li><li><span data-ttu-id="14a62-278">Ограничение максимального размера файлов.</span><span class="sxs-lookup"><span data-stu-id="14a62-278">Maximum file size limit</span></span></li><li><span data-ttu-id="14a62-279">Файл не должен быть загруженного toowebroot; Hello расположение должно представлять каталог на несистемном диске</span><span class="sxs-lookup"><span data-stu-id="14a62-279">File should not be uploaded toowebroot; hello location should be a directory on non-system drive</span></span></li><li><span data-ttu-id="14a62-280">Соглашение об именовании следует выполнить, так, что hello имя отправленного файла некоторые случайности, так как tooprevent перезаписывает файл</span><span class="sxs-lookup"><span data-stu-id="14a62-280">Naming convention should be followed, such that hello uploaded file name have some randomness, so as tooprevent file overwrites</span></span></li><li><span data-ttu-id="14a62-281">Файлы должны сканироваться для защиты от вирусов перед записью toohello диска</span><span class="sxs-lookup"><span data-stu-id="14a62-281">Files should be scanned for anti-virus before writing toohello disk</span></span></li><li><span data-ttu-id="14a62-282">Обеспечить проверку hello имя файла и любые другие метаданные (например, путь к файлу) для вредоносные символы</span><span class="sxs-lookup"><span data-stu-id="14a62-282">Ensure that hello file name and any other metadata (e.g., file path) are validated for malicious characters</span></span></li><li><span data-ttu-id="14a62-283">Формат подписи файла должны быть проверены, tooprevent пользователь загрузить файл masqueraded (например, передача exe-файла, изменив расширение tootxt)</span><span class="sxs-lookup"><span data-stu-id="14a62-283">File format signature should be checked, tooprevent a user from uploading a masqueraded file (e.g., uploading an exe file by changing extension tootxt)</span></span></li></ul>| 

### <a name="example"></a><span data-ttu-id="14a62-284">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-284">Example</span></span>
<span data-ttu-id="14a62-285">Hello последней точки относительно проверку подписи файлов формата см. класс toohello ниже дополнительные сведения:</span><span class="sxs-lookup"><span data-stu-id="14a62-285">For hello last point regarding file format signature validation, refer toohello class below for details:</span></span> 

```C#
        private static Dictionary<string, List<byte[]>> fileSignature = new Dictionary<string, List<byte[]>>
                    {
                    { ".DOC", new List<byte[]> { new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 } } },
                    { ".DOCX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".PDF", new List<byte[]> { new byte[] { 0x25, 0x50, 0x44, 0x46 } } },
                    { ".ZIP", new List<byte[]> 
                                            {
                                              new byte[] { 0x50, 0x4B, 0x03, 0x04 },
                                              new byte[] { 0x50, 0x4B, 0x4C, 0x49, 0x54, 0x55 },
                                              new byte[] { 0x50, 0x4B, 0x53, 0x70, 0x58 },
                                              new byte[] { 0x50, 0x4B, 0x05, 0x06 },
                                              new byte[] { 0x50, 0x4B, 0x07, 0x08 },
                                              new byte[] { 0x57, 0x69, 0x6E, 0x5A, 0x69, 0x70 }
                                                }
                                            },
                    { ".PNG", new List<byte[]> { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A } } },
                    { ".JPG", new List<byte[]>
                                    {
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE1 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE8 }
                                    }
                                    },
                    { ".JPEG", new List<byte[]>
                                        { 
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE2 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE3 }
                                        }
                                        },
                    { ".XLS", new List<byte[]>
                                            {
                                              new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 },
                                              new byte[] { 0x09, 0x08, 0x10, 0x00, 0x00, 0x06, 0x05, 0x00 },
                                              new byte[] { 0xFD, 0xFF, 0xFF, 0xFF }
                                            }
                                            },
                    { ".XLSX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".GIF", new List<byte[]> { new byte[] { 0x47, 0x49, 0x46, 0x38 } } }
                };

        public static bool IsValidFileExtension(string fileName, byte[] fileData, byte[] allowedChars)
        {
            if (string.IsNullOrEmpty(fileName) || fileData == null || fileData.Length == 0)
            {
                return false;
            }

            bool flag = false;
            string ext = Path.GetExtension(fileName);
            if (string.IsNullOrEmpty(ext))
            {
                return false;
            }

            ext = ext.ToUpperInvariant();

            if (ext.Equals(".TXT") || ext.Equals(".CSV") || ext.Equals(".PRN"))
            {
                foreach (byte b in fileData)
                {
                    if (b > 0x7F)
                    {
                        if (allowedChars != null)
                        {
                            if (!allowedChars.Contains(b))
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }

                return true;
            }

            if (!fileSignature.ContainsKey(ext))
            {
                return true;
            }

            List<byte[]> sig = fileSignature[ext];
            foreach (byte[] b in sig)
            {
                var curFileSig = new byte[b.Length];
                Array.Copy(fileData, curFileSig, b.Length);
                if (curFileSig.SequenceEqual(b))
                {
                    flag = true;
                    break;
                }
            }

            return flag;
        }
```

## <span data-ttu-id="14a62-286"><a id="typesafe"></a>Убедитесь, что в веб-приложении для доступа к данным используются параметры типобезопасности</span><span class="sxs-lookup"><span data-stu-id="14a62-286"><a id="typesafe"></a>Ensure that type-safe parameters are used in Web Application for data access</span></span>

| <span data-ttu-id="14a62-287">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-287">Title</span></span>                   | <span data-ttu-id="14a62-288">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-288">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-289">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-289">**Component**</span></span>               | <span data-ttu-id="14a62-290">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-290">Web Application</span></span> | 
| <span data-ttu-id="14a62-291">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-291">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-292">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-292">Build</span></span> |  
| <span data-ttu-id="14a62-293">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-293">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-294">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-294">Generic</span></span> |
| <span data-ttu-id="14a62-295">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-295">**Attributes**</span></span>              | <span data-ttu-id="14a62-296">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-296">N/A</span></span>  |
| <span data-ttu-id="14a62-297">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-297">**References**</span></span>              | <span data-ttu-id="14a62-298">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-298">N/A</span></span>  |
| <span data-ttu-id="14a62-299">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-299">**Steps**</span></span> | <p><span data-ttu-id="14a62-300">При использовании коллекции Parameters hello SQL будет обрабатываться hello ввода — как буквенное значение, а не как исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="14a62-300">If you use hello Parameters collection, SQL treats hello input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="14a62-301">Hello коллекцию Parameters можно tooenforce используется тип и длина ограничения для входных данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-301">hello Parameters collection can be used tooenforce type and length constraints on input data.</span></span> <span data-ttu-id="14a62-302">Значение за пределами диапазона hello вызвано исключение.</span><span class="sxs-lookup"><span data-stu-id="14a62-302">Values outside of hello range trigger an exception.</span></span> <span data-ttu-id="14a62-303">Если строго типизированным SQL параметры не используются, злоумышленники могут быть атак путем внедрения кода может tooexecute, внедренных в hello нефильтрованные входные данные.</span><span class="sxs-lookup"><span data-stu-id="14a62-303">If type-safe SQL parameters are not used, attackers might be able tooexecute injection attacks that are embedded in hello unfiltered input.</span></span></p><p><span data-ttu-id="14a62-304">Используйте безопасные параметры типа, при построении SQL запросов tooavoid возможности атаки SQL injection, связанных с нефильтрованные входные данные.</span><span class="sxs-lookup"><span data-stu-id="14a62-304">Use type safe parameters when constructing SQL queries tooavoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="14a62-305">Эти параметры можно использовать с хранимыми процедурами и динамическими инструкциями SQL.</span><span class="sxs-lookup"><span data-stu-id="14a62-305">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="14a62-306">Параметры обрабатываются как литеральные значения, hello базы данных, а не исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="14a62-306">Parameters are treated as literal values by hello database and not as executable code.</span></span> <span data-ttu-id="14a62-307">Кроме того, проверяется тип и длина параметров.</span><span class="sxs-lookup"><span data-stu-id="14a62-307">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="14a62-308">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-308">Example</span></span> 
<span data-ttu-id="14a62-309">Hello следующий код показывает, как toouse безопасные параметры типа с hello SqlParameterCollection при вызове хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="14a62-309">hello following code shows how toouse type safe parameters with hello SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="14a62-310">Входное значение hello hello предшествующий пример кода, не может быть длиннее 11 символов.</span><span class="sxs-lookup"><span data-stu-id="14a62-310">In hello preceding code example, hello input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="14a62-311">Если тип toohello или длина, определенная параметром hello hello данные не соответствуют, hello SqlParameter класс вызывает исключение.</span><span class="sxs-lookup"><span data-stu-id="14a62-311">If hello data does not conform toohello type or length defined by hello parameter, hello SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="14a62-312"><a id="binding-mvc"></a>Используйте классы привязки отдельной модели или привязки списков уязвимость массового присваивания tooprevent MVC</span><span class="sxs-lookup"><span data-stu-id="14a62-312"><a id="binding-mvc"></a>Use separate model binding classes or binding filter lists tooprevent MVC mass assignment vulnerability</span></span>

| <span data-ttu-id="14a62-313">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-313">Title</span></span>                   | <span data-ttu-id="14a62-314">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-314">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-315">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-315">**Component**</span></span>               | <span data-ttu-id="14a62-316">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-316">Web Application</span></span> | 
| <span data-ttu-id="14a62-317">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-317">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-318">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-318">Build</span></span> |  
| <span data-ttu-id="14a62-319">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-319">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-320">MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-320">MVC5, MVC6</span></span> |
| <span data-ttu-id="14a62-321">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-321">**Attributes**</span></span>              | <span data-ttu-id="14a62-322">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-322">N/A</span></span>  |
| <span data-ttu-id="14a62-323">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-323">**References**</span></span>              | <span data-ttu-id="14a62-324">[Атрибуты метаданных](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [открытый ключ безопасности и уязвимостей](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [tooMass полное руководство по присваивания в ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Приступая к работе с EF в MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span><span class="sxs-lookup"><span data-stu-id="14a62-324">[Metadata Attributes](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide tooMass Assignment in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span></span> |
| <span data-ttu-id="14a62-325">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-325">**Steps**</span></span> | <ul><li><span data-ttu-id="14a62-326">**Когда следует искать уязвимости типа overposting?** Уязвимости типа overposting могут появляться на любом этапе привязки классов модели из входных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="14a62-326">**When should I look for over-posting vulnerabilities? -** Over-posting vulnerabilities can occur any place you bind model classes from user input.</span></span> <span data-ttu-id="14a62-327">Платформы, такие как MVC, могут представлять данные пользователя в пользовательских классах .NET, включая Plain Old CLR Object (POCO).</span><span class="sxs-lookup"><span data-stu-id="14a62-327">Frameworks like MVC can represent user data in custom .NET classes, including Plain Old CLR Objects (POCOs).</span></span> <span data-ttu-id="14a62-328">MVC автоматически заполняет эти классы модели с данными из запроса hello, предоставляя удобный способ представления для работы с вводимыми пользователем данными.</span><span class="sxs-lookup"><span data-stu-id="14a62-328">MVC automatically populates these model classes with data from hello request, providing a convenient representation for dealing with user input.</span></span> <span data-ttu-id="14a62-329">Если эти классы содержат свойства, которые не следует задавать пользователем hello, hello приложение может быть уязвимым учета tooover атаки, в том разрешить пользовательский элемент управления данных, приложение hello никогда не предназначен.</span><span class="sxs-lookup"><span data-stu-id="14a62-329">When these classes include properties that should not be set by hello user, hello application can be vulnerable tooover-posting attacks, which allow user control of data that hello application never intended.</span></span> <span data-ttu-id="14a62-330">Как и привязка модели MVC, технологий доступа базы данных, таких как модули объектно реляционного сопоставления, такие как Entity Framework часто также поддерживают POCO объекты toorepresent базы данных с помощью.</span><span class="sxs-lookup"><span data-stu-id="14a62-330">Like MVC model binding, database access technologies such as object/relational mappers like Entity Framework often also support using POCO objects toorepresent database data.</span></span> <span data-ttu-id="14a62-331">Эти классы модели данных обеспечивают hello же удобных в работе с данными базы данных, как и в MVC в работе с вводимыми пользователем данными.</span><span class="sxs-lookup"><span data-stu-id="14a62-331">These data model classes provide hello same convenience in dealing with database data as MVC does in dealing with user input.</span></span> <span data-ttu-id="14a62-332">Поскольку база данных MVC и hello поддерживает аналогичные модели, как объекты POCO кажется hello легко tooreuse же классы для обоих назначений.</span><span class="sxs-lookup"><span data-stu-id="14a62-332">Because both MVC and hello database support similar models, like POCO objects, it seems easy tooreuse hello same classes for both purposes.</span></span> <span data-ttu-id="14a62-333">Этот подход сбое разделение toopreserve проблемы и его общие сферами, где непредвиденные свойства предоставляются toomodel привязки, включение чрезмерное учета атак.</span><span class="sxs-lookup"><span data-stu-id="14a62-333">This practice fails toopreserve separation of concerns, and it is one common area where unintended properties are exposed toomodel binding, enabling over-posting attacks.</span></span></li><li><span data-ttu-id="14a62-334">**Почему не следует использовать мой нефильтрованные классы базы данных модели как действия MVC toomy параметров -** Привязка модели MVC, так как привязки ничего в этом классе.</span><span class="sxs-lookup"><span data-stu-id="14a62-334">**Why shouldn't I use my unfiltered database model classes as parameters toomy MVC actions? -** Because MVC model binding will bind anything in that class.</span></span> <span data-ttu-id="14a62-335">Даже если Здравствуйте, данные не отображаются в представлении, пользователь-злоумышленник может отправлять HTTP-запроса с данными включены и MVC с удовольствием привязывается его так, как действие говорит, что класс базы данных является hello формы данных, он должен принять для ввода данных пользователем.</span><span class="sxs-lookup"><span data-stu-id="14a62-335">Even if hello data does not appear in your view, a malicious user can send an HTTP request with this data included, and MVC will gladly bind it because your action says that database class is hello shape of data it should accept for user input.</span></span></li><li><span data-ttu-id="14a62-336">**Почему следует обратить внимание hello фигура, используемая для привязки модели? -** Привязка модели с помощью ASP.NET MVC с моделями слишком широкие предоставляет атак учета tooover приложения.</span><span class="sxs-lookup"><span data-stu-id="14a62-336">**Why should I care about hello shape used for model binding? -** Using ASP.NET MVC model binding with overly broad models exposes an application tooover-posting attacks.</span></span> <span data-ttu-id="14a62-337">Чрезмерное учета может позволить злоумышленникам данные приложения toochange за пределы какие hello разработчик, например переопределение hello цену для элемента или hello привилегии безопасности для учетной записи.</span><span class="sxs-lookup"><span data-stu-id="14a62-337">Over-posting could enable attackers toochange application data beyond what hello developer intended, such as overriding hello price for an item or hello security privileges for an account.</span></span> <span data-ttu-id="14a62-338">Приложения должны использовать tooprovide привязки модели (или определенное свойство разрешенные списки фильтров) каждого действия прямого контракта для какой ненадежных входных tooallow посредством привязки модели.</span><span class="sxs-lookup"><span data-stu-id="14a62-338">Applications should use action-specific binding models (or specific allowed property filter lists) tooprovide an explicit contract for what untrusted input tooallow via model binding.</span></span></li><li><span data-ttu-id="14a62-339">**Дублируется ли код при наличии отдельных моделей привязки?** Нет. Дело касается разделения областей ответственности.</span><span class="sxs-lookup"><span data-stu-id="14a62-339">**Is having separate binding models just duplicating code? -** No, it is a matter of separation of concerns.</span></span> <span data-ttu-id="14a62-340">При повторном модели базы данных в методах действий вы говорите любое свойство (или подсвойств) в том, что класс может задавать пользователем hello в HTTP-запроса.</span><span class="sxs-lookup"><span data-stu-id="14a62-340">If you reuse database models in action methods, you are saying any property (or sub-property) in that class can be set by hello user in an HTTP request.</span></span> <span data-ttu-id="14a62-341">Если это не самое интересное MVC toodo, требуется список фильтров или отдельный класс фигуры tooshow MVC, какие данные могут поступать из вместо вводимых пользователем данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-341">If that is not what you want MVC toodo, you need a filter list or a separate class shape tooshow MVC what data can come from user input instead.</span></span></li><li><span data-ttu-id="14a62-342">**Имея моделей отдельные привязки для ввода данных пользователем, нужно ли tooduplicate все атрибуты заметок Мои данные? -** Не обязательно.</span><span class="sxs-lookup"><span data-stu-id="14a62-342">**If I have separate binding models for user input, do I have tooduplicate all my data annotation attributes? -** Not necessarily.</span></span> <span data-ttu-id="14a62-343">Можно использовать MetadataTypeAttribute на hello базы данных модели toolink toohello метаданные класса для класса привязки модели.</span><span class="sxs-lookup"><span data-stu-id="14a62-343">You can use MetadataTypeAttribute on hello database model class toolink toohello metadata on a model binding class.</span></span> <span data-ttu-id="14a62-344">Точно так же, обратите внимание, что тип ссылается hello MetadataTypeAttribute hello должен представлять собой подмножество hello, ссылающимся на тип (он может иметь меньше свойств, но не более).</span><span class="sxs-lookup"><span data-stu-id="14a62-344">Just note that hello type referenced by hello MetadataTypeAttribute must be a subset of hello referencing type (it can have fewer properties, but not more).</span></span></li><li><span data-ttu-id="14a62-345">**Перемещать данные между моделями входных данных пользователя и моделями базы данных утомительно. Можно ли просто скопировать все свойства с использованием отражения?** Да.</span><span class="sxs-lookup"><span data-stu-id="14a62-345">**Moving data back and forth between user input models and database models is tedious. Can I just copy over all properties using reflection? -** Yes.</span></span> <span data-ttu-id="14a62-346">Hello только свойства, отображаемые в моделях привязки hello: hello тех, которые вы определили toobe безопасным для ввода данных пользователем</span><span class="sxs-lookup"><span data-stu-id="14a62-346">hello only properties that appear in hello binding models are hello ones you have determined toobe safe for user input.</span></span> <span data-ttu-id="14a62-347">Нет причин безопасности, не позволяющая с помощью отражения toocopy через все свойства, которые хранятся в общем, между этими двумя моделями.</span><span class="sxs-lookup"><span data-stu-id="14a62-347">There is no security reason that prevents using reflection toocopy over all properties that exist in common between these two models.</span></span></li><li><span data-ttu-id="14a62-348">**Можно ли использовать свойство [Bind(Exclude ="â€¦")] вместо того, чтобы создавать отдельные модели привязки?** Мы не рекомендуем использовать такой подход.</span><span class="sxs-lookup"><span data-stu-id="14a62-348">**What about [Bind(Exclude ="â€¦")]. Can I use that instead of having separate binding models? -** This approach is not recommended.</span></span> <span data-ttu-id="14a62-349">Если использовать свойство [Bind(Exclude ="â€¦")], любое новое свойство можно будет привязать по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-349">Using [Bind(Exclude ="â€¦")] means that any new property is bindable by default.</span></span> <span data-ttu-id="14a62-350">Когда добавляется новое свойство, защищено дополнительный шаг tooremember tookeep вещей, а не наличие hello конструктора быть безопасность по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-350">When a new property is added, there is an extra step tooremember tookeep things secure, rather than having hello design be secure by default.</span></span> <span data-ttu-id="14a62-351">В зависимости от hello developer проверки этот список, каждый раз при добавлении свойства является опасной.</span><span class="sxs-lookup"><span data-stu-id="14a62-351">Depending on hello developer checking this list every time a property is added is risky.</span></span></li><li><span data-ttu-id="14a62-352">**Можно ли использовать атрибут [Bind(Include ="â€¦")] в операциях изменения?** Нет.</span><span class="sxs-lookup"><span data-stu-id="14a62-352">**Is [Bind(Include ="â€¦")] useful for Edit operations? -** No.</span></span> <span data-ttu-id="14a62-353">Атрибут [Bind(Include ="â€¦")] поддерживает только операции вставки (добавление новых данных).</span><span class="sxs-lookup"><span data-stu-id="14a62-353">[Bind(Include ="â€¦")] is only suitable for INSERT-style operations (adding new data).</span></span> <span data-ttu-id="14a62-354">Для операций обновления стиля (пересмотра существующих данных) использовать другой подход, такие как наличие отдельные привязки модели или передача явный список допустимых свойств tooUpdateModel или TryUpdateModel.</span><span class="sxs-lookup"><span data-stu-id="14a62-354">For UPDATE-style operations (revising existing data), use another approach, like having separate binding models or passing an explicit list of allowed properties tooUpdateModel or TryUpdateModel.</span></span> <span data-ttu-id="14a62-355">Добавление [привязки (Include = "... в")] атрибута на операцию редактирования означает, что MVC будет создать экземпляр объекта и только hello в списке свойств, оставив все остальные значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-355">Adding a [Bind(Include ="â€¦")] attribute on an Edit operation means that MVC will create an object instance and set only hello listed properties, leaving all others at their default values.</span></span> <span data-ttu-id="14a62-356">При сохранении данных hello, она полностью заменить существующую сущность hello, сброс значений hello для любого значения по умолчанию свойства, опущенные tootheir.</span><span class="sxs-lookup"><span data-stu-id="14a62-356">When hello data is persisted, it will entirely replace hello existing entity, resetting hello values for any omitted properties tootheir defaults.</span></span> <span data-ttu-id="14a62-357">Например, если было IsAdmin [привязки (Include = "... в")] атрибут операции изменения, любой пользователь, имя которого был изменен с помощью этого действия может быть tooIsAdmin сброса = false (любой пользователь, измененного теряли статусом администратора).</span><span class="sxs-lookup"><span data-stu-id="14a62-357">For example, if IsAdmin was omitted from a [Bind(Include ="â€¦")] attribute on an Edit operation, any user whose name was edited via this action would be reset tooIsAdmin = false (any edited user would lose administrator status).</span></span> <span data-ttu-id="14a62-358">Если вы хотите tooprevent обновляет свойства toocertain, воспользуйтесь одним из hello других подходов выше.</span><span class="sxs-lookup"><span data-stu-id="14a62-358">If you want tooprevent updates toocertain properties, use one of hello other approaches above.</span></span> <span data-ttu-id="14a62-359">Обратите внимание, что некоторые версии средств MVC создают классы контроллера с атрибутом [Bind(Include ="â€¦")] в действиях изменения. При этом подразумевается, что удалив свойство из этого списка, вы сократите риск атак типа overposting.</span><span class="sxs-lookup"><span data-stu-id="14a62-359">Note that some versions of MVC tooling generate controller classes with [Bind(Include ="â€¦")] on Edit actions and imply that removing a property from that list will prevent over-posting attacks.</span></span> <span data-ttu-id="14a62-360">Тем не менее как описано выше, этот подход не работает должным образом и вместо сбрасывает все данные в значения по умолчанию hello опущен свойства tootheir.</span><span class="sxs-lookup"><span data-stu-id="14a62-360">However, as described above, that approach does not work as intended and instead will reset any data in hello omitted properties tootheir default values.</span></span></li><li><span data-ttu-id="14a62-361">**Есть ли какие-либо особенности при использовании атрибута [Bind(Include ="â€¦")] вместо отдельных моделей привязки в операциях создания?** Да.</span><span class="sxs-lookup"><span data-stu-id="14a62-361">**For Create operations, are there any caveats using [Bind(Include ="â€¦")] rather than separate binding models? -** Yes.</span></span> <span data-ttu-id="14a62-362">Во-первых, этот подход не действует в операциях изменения. Чтобы устранить все уязвимости типа overposting, следует применять два отдельных подхода.</span><span class="sxs-lookup"><span data-stu-id="14a62-362">First this approach does not work for Edit scenarios, requiring maintaining two separate approaches for mitigating all over-posting vulnerabilities.</span></span> <span data-ttu-id="14a62-363">Вторую, отдельную привязки моделей применить разделение между hello фигуру, используемую для пользователя вход и hello фигуру, используемую для сохранения состояния, что-нибудь [привязки (Include = "â...")] не имеет.</span><span class="sxs-lookup"><span data-stu-id="14a62-363">Second, separate binding models enforce separation of concerns between hello shape used for user input and hello shape used for persistence, something [Bind(Include ="â€¦")] does not do.</span></span> <span data-ttu-id="14a62-364">В-третьих, обратите внимание, что [привязки (Include = "â...")] может обрабатывать только свойства верхнего уровня; в атрибуте hello не может разрешить только части вложенных свойств (например, «Details.Name»).</span><span class="sxs-lookup"><span data-stu-id="14a62-364">Third, note that [Bind(Include ="â€¦")] can only handle top-level properties; you cannot allow only portions of sub-properties (such as "Details.Name") in hello attribute.</span></span> <span data-ttu-id="14a62-365">Наконец и, возможно, что самое главное, с помощью [привязки (Include = "â...")] добавляет дополнительный этап, должны будут запомнены любой класс hello времени используется для привязки модели.</span><span class="sxs-lookup"><span data-stu-id="14a62-365">Finally, and perhaps most importantly, using [Bind(Include ="â€¦")] adds an extra step that must be remembered any time hello class is used for model binding.</span></span> <span data-ttu-id="14a62-366">Если новый метод действия привязывается toohello класс данных напрямую и забыл tooinclude [привязки (Include = "... в")] атрибут, он может быть уязвим учета tooover атак, поэтому hello [привязки (Include = "... в")] подход немного менее безопасен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-366">If a new action method binds toohello data class directly and forgets tooinclude a [Bind(Include ="â€¦")] attribute, it can be vulnerable tooover-posting attacks, so hello [Bind(Include ="â€¦")] approach is somewhat less secure by default.</span></span> <span data-ttu-id="14a62-367">При использовании [привязки (Include = "â...")], будьте внимательны всегда tooremember toospecify его каждый раз данных классов отображаются как параметры метода действия.</span><span class="sxs-lookup"><span data-stu-id="14a62-367">If you use [Bind(Include ="â€¦")], take care always tooremember toospecify it every time your data classes appear as action method parameters.</span></span></li><li><span data-ttu-id="14a62-368">**Для операций Create, что размещение hello [привязки (Include = "â...")] атрибута самого класса hello модели? Не такой подход не hello необходимость tooremember размещение hello атрибут для каждого метода действия? -** Такой подход работает в некоторых случаях.</span><span class="sxs-lookup"><span data-stu-id="14a62-368">**For Create operations, what about putting hello [Bind(Include ="â€¦")] attribute on hello model class itself? Does not this approach avoid hello need tooremember putting hello attribute on every action method? -** This approach works in some cases.</span></span> <span data-ttu-id="14a62-369">С помощью [привязки (Include = "â...")] в самом типе модели hello (а не на параметров действий с помощью этого класса), избежать hello необходимость tooremember tooinclude hello [привязки (Include = "â...")] атрибута для каждого метода действия.</span><span class="sxs-lookup"><span data-stu-id="14a62-369">Using [Bind(Include ="â€¦")] on hello model type itself (rather than on action parameters using this class), does avoid hello need tooremember tooinclude hello [Bind(Include ="â€¦")] attribute on every action method.</span></span> <span data-ttu-id="14a62-370">Эффективное использование атрибута hello непосредственно для класса hello создает отдельный контактной зоны этого класса в целях привязки модели.</span><span class="sxs-lookup"><span data-stu-id="14a62-370">Using hello attribute directly on hello class effectively creates a separate surface area of this class for model binding purposes.</span></span> <span data-ttu-id="14a62-371">Однако такой подход позволяет использовать привязку модели одного типа на класс модели.</span><span class="sxs-lookup"><span data-stu-id="14a62-371">However, this approach only allows for one model binding shape per model class.</span></span> <span data-ttu-id="14a62-372">Если один метод действия должен привязки модели tooallow поля (например, только администратору действие, обновляющее ролей пользователей) и другие действия необходима привязка модели tooprevent этого поля, такой подход не будет работать.</span><span class="sxs-lookup"><span data-stu-id="14a62-372">If one action method needs tooallow model binding of a field (for example, an administrator-only action that updates user roles) and other actions need tooprevent model binding of this field, this approach will not work.</span></span> <span data-ttu-id="14a62-373">Каждый класс может иметь только одну фигуру привязки модели; Если разные действия требуется другую модель привязки фигур, они должны toorepresent эти отдельные фигур с помощью классов привязки либо отдельную модель или разделения [привязки (Include = "â...")] атрибутов в методы действий hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-373">Each class can only have one model binding shape; if different actions need different model binding shapes, they need toorepresent these separate shapes using either separate model binding classes or separate [Bind(Include ="â€¦")] attributes on hello action methods.</span></span></li><li><span data-ttu-id="14a62-374">**Что такое модели привязки? Что они hello же, что и Просмотр моделей? -** Это две связанные понятия.</span><span class="sxs-lookup"><span data-stu-id="14a62-374">**What are binding models? Are they hello same thing as view models? -** These are two related concepts.</span></span> <span data-ttu-id="14a62-375">модель привязки ссылается класс модели tooa, используемый в действии термин Hello — список параметров (hello форму, переданных из метода действия toohello привязка модели MVC).</span><span class="sxs-lookup"><span data-stu-id="14a62-375">hello term binding model refers tooa model class used in an action is parameter list (hello shape passed from MVC model binding toohello action method).</span></span> <span data-ttu-id="14a62-376">модель представления термин Hello ссылается класс модели tooa, передаваемый из tooa представления метод действия.</span><span class="sxs-lookup"><span data-stu-id="14a62-376">hello term view model refers tooa model class passed from an action method tooa view.</span></span> <span data-ttu-id="14a62-377">С помощью модели представления — это распространенный способ передачи данных из представления tooa метода действия.</span><span class="sxs-lookup"><span data-stu-id="14a62-377">Using a view-specific model is a common approach for passing data from an action method tooa view.</span></span> <span data-ttu-id="14a62-378">Часто эта фигура также подходит для привязки модели, модель представления hello термин может быть hello используется toorefer же модель используется в обоих местах.</span><span class="sxs-lookup"><span data-stu-id="14a62-378">Often, this shape is also suitable for model binding, and hello term view model can be used toorefer hello same model used in both places.</span></span> <span data-ttu-id="14a62-379">toobe точным, эта процедура рассмотрен в частности привязки модели, сосредоточившись на фигуре hello, переданный toohello действие, которое является то, что важно для целей массового присваивания.</span><span class="sxs-lookup"><span data-stu-id="14a62-379">toobe precise, this procedure talks specifically about binding models, focusing on hello shape passed toohello action, which is what matters for mass assignment purposes.</span></span></li></ul>| 

## <span data-ttu-id="14a62-380"><a id="rendering"></a>Кодирование предыдущих toorendering вывода ненадежных веб</span><span class="sxs-lookup"><span data-stu-id="14a62-380"><a id="rendering"></a>Encode untrusted web output prior toorendering</span></span>

| <span data-ttu-id="14a62-381">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-381">Title</span></span>                   | <span data-ttu-id="14a62-382">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-382">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-383">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-383">**Component**</span></span>               | <span data-ttu-id="14a62-384">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-384">Web Application</span></span> | 
| <span data-ttu-id="14a62-385">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-385">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-386">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-386">Build</span></span> |  
| <span data-ttu-id="14a62-387">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-387">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-388">Универсальные, веб-формы, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-388">Generic, Web Forms, MVC5, MVC6</span></span> |
| <span data-ttu-id="14a62-389">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-389">**Attributes**</span></span>              | <span data-ttu-id="14a62-390">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-390">N/A</span></span>  |
| <span data-ttu-id="14a62-391">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-391">**References**</span></span>              | <span data-ttu-id="14a62-392">[Как tooprevent межсайтовых сценариев в ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [скриптов](http://cwe.mitre.org/data/definitions/79.html), [Памятка Предотвращение XSS (межсайтовых сценариев)](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span><span class="sxs-lookup"><span data-stu-id="14a62-392">[How tooprevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span></span> |
| <span data-ttu-id="14a62-393">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-393">**Steps**</span></span> | <span data-ttu-id="14a62-394">Межсайтовых сценариев (обычно называемого XSS) является атаки для Интернет-служб или приложение или компонент, который принимает входные данные из веб-hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-394">Cross-site scripting (commonly abbreviated as XSS) is an attack vector for online services or any application/component that consumes input from hello web.</span></span> <span data-ttu-id="14a62-395">XSS может уязвимости злоумышленник tooexecute сценария на компьютере другого пользователя через уязвимым веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="14a62-395">XSS vulnerabilities may allow an attacker tooexecute script on another user's machine through a vulnerable web application.</span></span> <span data-ttu-id="14a62-396">Вредоносных скриптов можно использовать toosteal файлы cookie и в противном случае незаконно жертвы машины с помощью JavaScript.</span><span class="sxs-lookup"><span data-stu-id="14a62-396">Malicious scripts can be used toosteal cookies and otherwise tamper with a victim's machine through JavaScript.</span></span> <span data-ttu-id="14a62-397">Чтобы обеспечить защиту от использования межсайтовых сценариев, следует проверять входные данные пользователя, их формат, а также кодировать их перед обработкой на веб-странице.</span><span class="sxs-lookup"><span data-stu-id="14a62-397">XSS is prevented by validating user input, ensuring it is well formed and encoding before it is rendered in a web page.</span></span> <span data-ttu-id="14a62-398">Для проверки входных данных и кодирования выходных данных можно использовать библиотеку веб-защиты.</span><span class="sxs-lookup"><span data-stu-id="14a62-398">Input validation and output encoding can be done by using Web Protection Library.</span></span> <span data-ttu-id="14a62-399">Для управляемого кода (C\#, VB.net, т. д.), используйте один или несколько соответствующих методов кодирования из библиотеки Web защиты (Anti-XSS), в зависимости от контекста hello, где возвращает объявленное ввод данных пользователем hello hello:</span><span class="sxs-lookup"><span data-stu-id="14a62-399">For Managed code (C\#, VB.net, etc.), use one or more appropriate encoding methods from hello Web Protection (Anti-XSS) Library, depending on hello context where hello user input gets manifested:</span></span>| 

### <a name="example"></a><span data-ttu-id="14a62-400">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-400">Example</span></span>

```C#
* Encoder.HtmlEncode 
* Encoder.HtmlAttributeEncode 
* Encoder.JavaScriptEncode 
* Encoder.UrlEncode
* Encoder.VisualBasicScriptEncode 
* Encoder.XmlEncode 
* Encoder.XmlAttributeEncode 
* Encoder.CssEncode 
* Encoder.LdapEncode 
```

## <span data-ttu-id="14a62-401"><a id="typemodel"></a>Проверяйте и фильтруйте входные данные по всем свойствам модели строкового типа</span><span class="sxs-lookup"><span data-stu-id="14a62-401"><a id="typemodel"></a>Perform input validation and filtering on all string type Model properties</span></span>

| <span data-ttu-id="14a62-402">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-402">Title</span></span>                   | <span data-ttu-id="14a62-403">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-403">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-404">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-404">**Component**</span></span>               | <span data-ttu-id="14a62-405">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-405">Web Application</span></span> | 
| <span data-ttu-id="14a62-406">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-406">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-407">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-407">Build</span></span> |  
| <span data-ttu-id="14a62-408">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-408">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-409">Универсальные, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-409">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="14a62-410">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-410">**Attributes**</span></span>              | <span data-ttu-id="14a62-411">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-411">N/A</span></span>  |
| <span data-ttu-id="14a62-412">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-412">**References**</span></span>              | <span data-ttu-id="14a62-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation) (Добавление проверки), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Проверка данных модели в приложении MVC), [Основные принципы ваших приложений ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="14a62-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="14a62-414">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-414">**Steps**</span></span> | <p><span data-ttu-id="14a62-415">Все входные параметры hello необходимо проверить перед их использованием в tooensure приложения hello, приложение hello защищен от входных данных пользователь-злоумышленник.</span><span class="sxs-lookup"><span data-stu-id="14a62-415">All hello input parameters must be validated before they are used in hello application tooensure that hello application is safeguarded against malicious user inputs.</span></span> <span data-ttu-id="14a62-416">Проверка входных значений hello, используя регулярное выражение проверки на стороне сервера с стратегии проверки белого списка.</span><span class="sxs-lookup"><span data-stu-id="14a62-416">Validate hello input values using regular expression validations on server side with a whitelist validation strategy.</span></span> <span data-ttu-id="14a62-417">Unsanitized данные, вводимые пользователем параметров, передаваемых методам toohello может привести к кода атак путем внедрения кода.</span><span class="sxs-lookup"><span data-stu-id="14a62-417">Unsanitized user inputs / parameters passed toohello methods can cause code injection vulnerabilities.</span></span></p><p><span data-ttu-id="14a62-418">Точки входа для веб-приложений также включают поля форм, строки запросов, файлы cookie, заголовки HTTP и параметры веб-службы.</span><span class="sxs-lookup"><span data-stu-id="14a62-418">For web applications, entry points can also include form fields, QueryStrings, cookies, HTTP headers, and web service parameters.</span></span></p><p><span data-ttu-id="14a62-419">Hello следующие входные проверки необходимо выполнить после привязки модели:</span><span class="sxs-lookup"><span data-stu-id="14a62-419">hello following input validation checks must be performed upon model binding:</span></span></p><ul><li><span data-ttu-id="14a62-420">Свойства модели Hello должен сопровождаться атрибутом заметки регулярное выражение для приема допустимые символы и максимально допустимую длину</span><span class="sxs-lookup"><span data-stu-id="14a62-420">hello model properties should be annotated with RegularExpression annotation, for accepting allowed characters and maximum permissible length</span></span></li><li><span data-ttu-id="14a62-421">методы контроллера Hello должен выполнить действия ModelState</span><span class="sxs-lookup"><span data-stu-id="14a62-421">hello controller methods should perform ModelState validity</span></span></li></ul>|

## <span data-ttu-id="14a62-422"><a id="richtext"></a>Очищайте поля форм, принимающие все знаки, например редактор форматированного текста</span><span class="sxs-lookup"><span data-stu-id="14a62-422"><a id="richtext"></a>Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>

| <span data-ttu-id="14a62-423">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-423">Title</span></span>                   | <span data-ttu-id="14a62-424">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-424">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-425">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-425">**Component**</span></span>               | <span data-ttu-id="14a62-426">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-426">Web Application</span></span> | 
| <span data-ttu-id="14a62-427">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-427">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-428">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-428">Build</span></span> |  
| <span data-ttu-id="14a62-429">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-429">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-430">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-430">Generic</span></span> |
| <span data-ttu-id="14a62-431">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-431">**Attributes**</span></span>              | <span data-ttu-id="14a62-432">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-432">N/A</span></span>  |
| <span data-ttu-id="14a62-433">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-433">**References**</span></span>              | <span data-ttu-id="14a62-434">[Кодирование небезопасных входных данных](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer) (Библиотека HtmlSanitizer)</span><span class="sxs-lookup"><span data-stu-id="14a62-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span></span> |
| <span data-ttu-id="14a62-435">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-435">**Steps**</span></span> | <p><span data-ttu-id="14a62-436">Определите все теги разметки static, что требуется toouse.</span><span class="sxs-lookup"><span data-stu-id="14a62-436">Identify all static markup tags that you want toouse.</span></span> <span data-ttu-id="14a62-437">Распространенной практикой является форматирование элементов toosafe HTML, такие как toorestrict `<b>` (полужирный) и `<i>` (курсивом).</span><span class="sxs-lookup"><span data-stu-id="14a62-437">A common practice is toorestrict formatting toosafe HTML elements, such as `<b>` (bold) and `<i>` (italic).</span></span></p><p><span data-ttu-id="14a62-438">Перед записью данных hello, HTML-кодирование его.</span><span class="sxs-lookup"><span data-stu-id="14a62-438">Before writing hello data, HTML-encode it.</span></span> <span data-ttu-id="14a62-439">Это делает любой вредоносный скрипт, безопасном инициируя toobe обрабатывать как текст, не как исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="14a62-439">This makes any malicious script safe by causing it toobe handled as text, not as executable code.</span></span></p><ol><li><span data-ttu-id="14a62-440">Отключить запроса ASP.NET, проверки, добавив hello hello ValidateRequest = «false» атрибута toohello @ директивы страницы</span><span class="sxs-lookup"><span data-stu-id="14a62-440">Disable ASP.NET request validation by hello adding hello ValidateRequest="false" attribute toohello @ Page directive</span></span></li><li><span data-ttu-id="14a62-441">Кодирование входная строка hello с помощью метода HtmlEncode hello</span><span class="sxs-lookup"><span data-stu-id="14a62-441">Encode hello string input with hello HtmlEncode method</span></span></li><li><span data-ttu-id="14a62-442">Используйте StringBuilder и вызов его замены метод tooselectively удалить кодировку для hello HTML-элементов, которые должны toopermit hello</span><span class="sxs-lookup"><span data-stu-id="14a62-442">Use a StringBuilder and call its Replace method tooselectively remove hello encoding on hello HTML elements that you want toopermit</span></span></li></ol><p><span data-ttu-id="14a62-443">Hello ссылки на страницы в hello отключает проверки запроса ASP.NET, задав `ValidateRequest="false"`.</span><span class="sxs-lookup"><span data-stu-id="14a62-443">hello page-in hello references disables ASP.NET request validation by setting `ValidateRequest="false"`.</span></span> <span data-ttu-id="14a62-444">Он кодирует в формате HTML hello ввода и выборочно позволяет hello `<b>` и `<i>` в качестве альтернативы библиотеки .NET для очистки HTML можно также использовать.</span><span class="sxs-lookup"><span data-stu-id="14a62-444">It HTML-encodes hello input and selectively allows hello `<b>` and `<i>` Alternatively, a .NET library for HTML sanitization may also be used.</span></span></p><p><span data-ttu-id="14a62-445">HtmlSanitizer — это библиотека .NET для очистки фрагменты HTML и документов из конструкций, которые могут привести к атакам tooXSS.</span><span class="sxs-lookup"><span data-stu-id="14a62-445">HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead tooXSS attacks.</span></span> <span data-ttu-id="14a62-446">Она использует AngleSharp tooparse, управления и визуализации HTML и CSS.</span><span class="sxs-lookup"><span data-stu-id="14a62-446">It uses AngleSharp tooparse, manipulate, and render HTML and CSS.</span></span> <span data-ttu-id="14a62-447">HtmlSanitizer можно установить в виде пакета NuGet и ввод данных пользователем hello могут передаваться через соответствующие HTML и CSS очистки методы, где это применимо, на стороне сервера hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-447">HtmlSanitizer can be installed as a NuGet package, and hello user input can be passed through relevant HTML or CSS sanitization methods, as applicable, on hello server side.</span></span> <span data-ttu-id="14a62-448">Обратите внимание, что очистка — это крайняя мера безопасности.</span><span class="sxs-lookup"><span data-stu-id="14a62-448">Please note that Sanitization as a security control should be considered only as a last option.</span></span></p><p><span data-ttu-id="14a62-449">Самые эффективные меры безопасности — это проверка входных данных и кодирование выходных данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-449">Input validation and Output Encoding are considered better security controls.</span></span></p> |

## <span data-ttu-id="14a62-450"><a id="inbuilt-encode"></a>Не назначайте toosinks элементы DOM, не имеет встроенных кодировки</span><span class="sxs-lookup"><span data-stu-id="14a62-450"><a id="inbuilt-encode"></a>Do not assign DOM elements toosinks that do not have inbuilt encoding</span></span>

| <span data-ttu-id="14a62-451">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-451">Title</span></span>                   | <span data-ttu-id="14a62-452">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-452">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-453">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-453">**Component**</span></span>               | <span data-ttu-id="14a62-454">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-454">Web Application</span></span> | 
| <span data-ttu-id="14a62-455">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-455">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-456">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-456">Build</span></span> |  
| <span data-ttu-id="14a62-457">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-457">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-458">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-458">Generic</span></span> |
| <span data-ttu-id="14a62-459">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-459">**Attributes**</span></span>              | <span data-ttu-id="14a62-460">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-460">N/A</span></span>  |
| <span data-ttu-id="14a62-461">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-461">**References**</span></span>              | <span data-ttu-id="14a62-462">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-462">N/A</span></span>  |
| <span data-ttu-id="14a62-463">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-463">**Steps**</span></span> | <span data-ttu-id="14a62-464">Многие функции JavaScript не выполняют кодирование по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-464">Many javascript functions don't do encoding by default.</span></span> <span data-ttu-id="14a62-465">При назначении элементы ненадежных входных tooDOM через такие функции, может привести к между выполнениями скрипта (XSS) сайта.</span><span class="sxs-lookup"><span data-stu-id="14a62-465">When assigning untrusted input tooDOM elements via such functions, may result in cross site script (XSS) executions.</span></span>| 

### <a name="example"></a><span data-ttu-id="14a62-466">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-466">Example</span></span>
<span data-ttu-id="14a62-467">Ниже приведены примеры ненадежных входных данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-467">Following are insecure examples:</span></span> 

```
document.getElementByID("div1").innerHtml = value;
$("#userName").html(res.Name);
return $('<div/>').html(value)
$('body').append(resHTML);   
```
<span data-ttu-id="14a62-468">Не используйте элемент `innerHtml`. Вместо него используйте `innerText`.</span><span class="sxs-lookup"><span data-stu-id="14a62-468">Don't use `innerHtml`; instead use `innerText`.</span></span> <span data-ttu-id="14a62-469">Аналогичным образом вместо `$("#elm").html()` используйте `$("#elm").text()`.</span><span class="sxs-lookup"><span data-stu-id="14a62-469">Similarly, instead of `$("#elm").html()`, use `$("#elm").text()`</span></span> 

## <span data-ttu-id="14a62-470"><a id="redirect-safe"></a>Проверить все закрытые или делать безопасно перенаправления приложения hello</span><span class="sxs-lookup"><span data-stu-id="14a62-470"><a id="redirect-safe"></a>Validate all redirects within hello application are closed or done safely</span></span>

| <span data-ttu-id="14a62-471">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-471">Title</span></span>                   | <span data-ttu-id="14a62-472">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-472">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-473">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-473">**Component**</span></span>               | <span data-ttu-id="14a62-474">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-474">Web Application</span></span> | 
| <span data-ttu-id="14a62-475">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-475">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-476">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-476">Build</span></span> |  
| <span data-ttu-id="14a62-477">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-477">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-478">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-478">Generic</span></span> |
| <span data-ttu-id="14a62-479">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-479">**Attributes**</span></span>              | <span data-ttu-id="14a62-480">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-480">N/A</span></span>  |
| <span data-ttu-id="14a62-481">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-481">**References**</span></span>              | [<span data-ttu-id="14a62-482">Hello OAuth 2.0 Authorization Framework - откройте перенаправителями</span><span class="sxs-lookup"><span data-stu-id="14a62-482">hello OAuth 2.0 Authorization Framework - Open Redirectors</span></span>](http://tools.ietf.org/html/rfc6749#section-10.15) |
| <span data-ttu-id="14a62-483">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-483">**Steps**</span></span> | <p><span data-ttu-id="14a62-484">Разработка приложений, требующие перенаправления tooa пользовательское расположение необходимо ограничить hello перенаправления возможных целевых объектов tooa встроенный «безопасной» список сайты или домены.</span><span class="sxs-lookup"><span data-stu-id="14a62-484">Application design requiring redirection tooa user-supplied location must constrain hello possible redirection targets tooa predefined "safe" list of sites or domains.</span></span> <span data-ttu-id="14a62-485">Все переадресации в приложение hello должен быть закрыт или безопасным.</span><span class="sxs-lookup"><span data-stu-id="14a62-485">All redirects in hello application must be closed/safe.</span></span></p><p><span data-ttu-id="14a62-486">toodo это:</span><span class="sxs-lookup"><span data-stu-id="14a62-486">toodo this:</span></span></p><ul><li><span data-ttu-id="14a62-487">Определяйте все операции перенаправления.</span><span class="sxs-lookup"><span data-stu-id="14a62-487">Identify all redirects</span></span></li><li><span data-ttu-id="14a62-488">Реализуйте подходящий метод защиты для каждого перенаправления.</span><span class="sxs-lookup"><span data-stu-id="14a62-488">Implement an appropriate mitigation for each redirect.</span></span> <span data-ttu-id="14a62-489">Сюда входит список разрешений для перенаправления или подтверждение пользователя.</span><span class="sxs-lookup"><span data-stu-id="14a62-489">Appropriate mitigations include redirect whitelist or user confirmation.</span></span> <span data-ttu-id="14a62-490">Если веб-узел или служба с уязвимостью в виде открытого перенаправления использует поставщиков удостоверений Facebook, OAuth или OpenID, злоумышленник может похитить маркер входа пользователя и выполнять действия от его имени.</span><span class="sxs-lookup"><span data-stu-id="14a62-490">If a web site or service with an open redirect vulnerability uses Facebook/OAuth/OpenID identity providers, an attacker can steal a user's logon token and impersonate that user.</span></span> <span data-ttu-id="14a62-491">Это специфические риск при использовании OAuth, который описан в RFC 6749 «hello OAuth 2.0 Authorization Framework», аналогично статьи 10.15» откройте перенаправляет», учетные данные пользователей могут быть скомпрометированы, направленных фишинг-атаках с использованием открытых перенаправления</span><span class="sxs-lookup"><span data-stu-id="14a62-491">This is an inherent risk when using OAuth, which is documented in RFC 6749 "hello OAuth 2.0 Authorization Framework", Section 10.15 "Open Redirects" Similarly, users' credentials can be compromised by spear phishing attacks using open redirects</span></span></li></ul>|

## <span data-ttu-id="14a62-492"><a id="string-method"></a>Внедрите проверку входных данных для всех параметров строкового типа, принимаемых методами контроллера</span><span class="sxs-lookup"><span data-stu-id="14a62-492"><a id="string-method"></a>Implement input validation on all string type parameters accepted by Controller methods</span></span>

| <span data-ttu-id="14a62-493">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-493">Title</span></span>                   | <span data-ttu-id="14a62-494">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-494">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-495">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-495">**Component**</span></span>               | <span data-ttu-id="14a62-496">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-496">Web Application</span></span> | 
| <span data-ttu-id="14a62-497">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-497">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-498">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-498">Build</span></span> |  
| <span data-ttu-id="14a62-499">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-499">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-500">Универсальные, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-500">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="14a62-501">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-501">**Attributes**</span></span>              | <span data-ttu-id="14a62-502">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-502">N/A</span></span>  |
| <span data-ttu-id="14a62-503">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-503">**References**</span></span>              | <span data-ttu-id="14a62-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Проверка данных модели в приложении MVC), [Основные принципы ваших приложений ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="14a62-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="14a62-505">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-505">**Steps**</span></span> | <span data-ttu-id="14a62-506">Для методов, принимающих примитивные типы данных, а не модели в качестве аргументов, следует выполнять проверки входных данных с использованием регулярных выражений.</span><span class="sxs-lookup"><span data-stu-id="14a62-506">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="14a62-507">Здесь следует использовать Regex.IsMatch с шаблоном допустимого регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="14a62-507">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="14a62-508">Hello входные данные соответствуют hello указанному регулярному выражению, элемент управления не следует продолжить и отображать достаточно предупреждение об ошибке проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="14a62-508">If hello input doesn't match hello specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>| 

## <span data-ttu-id="14a62-509"><a id="dos-expression"></a>Задать время ожидания верхний предел для регулярного выражения, обработка DoS tooprevent из-за toobad регулярные выражения</span><span class="sxs-lookup"><span data-stu-id="14a62-509"><a id="dos-expression"></a>Set upper limit timeout for regular expression processing tooprevent DoS due toobad regular expressions</span></span>

| <span data-ttu-id="14a62-510">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-510">Title</span></span>                   | <span data-ttu-id="14a62-511">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-511">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-512">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-512">**Component**</span></span>               | <span data-ttu-id="14a62-513">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-513">Web Application</span></span> | 
| <span data-ttu-id="14a62-514">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-514">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-515">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-515">Build</span></span> |  
| <span data-ttu-id="14a62-516">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-516">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-517">Универсальные, веб-формы, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-517">Generic, Web Forms, MVC5, MVC6</span></span>  |
| <span data-ttu-id="14a62-518">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-518">**Attributes**</span></span>              | <span data-ttu-id="14a62-519">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-519">N/A</span></span>  |
| <span data-ttu-id="14a62-520">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-520">**References**</span></span>              | [<span data-ttu-id="14a62-521">Свойство DefaultRegexMatchTimeout</span><span class="sxs-lookup"><span data-stu-id="14a62-521">DefaultRegexMatchTimeout Property </span></span>](https://msdn.microsoft.com/library/system.web.configuration.httpruntimesection.defaultregexmatchtimeout.aspx) |
| <span data-ttu-id="14a62-522">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-522">**Steps**</span></span> | <span data-ttu-id="14a62-523">отказ в обслуживании законных пользователей tooensure неправильно создана регулярных выражений, которые связано со значительным поиск с возвратом, задать время ожидания hello глобальное значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="14a62-523">tooensure denial of service attacks against badly created regular expressions, that cause a lot of backtracking, set hello global default timeout.</span></span> <span data-ttu-id="14a62-524">Если время обработки hello занимает больше времени, чем hello определенные верхний предел, он будет вызывать исключение времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="14a62-524">If hello processing time takes longer than hello defined upper limit, it would throw a Timeout exception.</span></span> <span data-ttu-id="14a62-525">Если ничего не настроен, время ожидания hello будет бесконечным.</span><span class="sxs-lookup"><span data-stu-id="14a62-525">If nothing is configured, hello timeout would be infinite.</span></span>| 

### <a name="example"></a><span data-ttu-id="14a62-526">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-526">Example</span></span>
<span data-ttu-id="14a62-527">Например hello следующая конфигурация создаст исключение RegexMatchTimeoutException, если hello обработки занимает более 5 секунд:</span><span class="sxs-lookup"><span data-stu-id="14a62-527">For example, hello following configuration will throw a RegexMatchTimeoutException, if hello processing takes more than 5 seconds:</span></span> 

```C#
<httpRuntime targetFramework="4.5" defaultRegexMatchTimeout="00:00:05" />
```

## <span data-ttu-id="14a62-528"><a id="html-razor"></a>Не используйте метод Html.Raw в представлениях Razor</span><span class="sxs-lookup"><span data-stu-id="14a62-528"><a id="html-razor"></a>Avoid using Html.Raw in Razor views</span></span>

| <span data-ttu-id="14a62-529">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-529">Title</span></span>                   | <span data-ttu-id="14a62-530">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-530">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-531">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-531">**Component**</span></span>               | <span data-ttu-id="14a62-532">Веб-приложение</span><span class="sxs-lookup"><span data-stu-id="14a62-532">Web Application</span></span> | 
| <span data-ttu-id="14a62-533">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-533">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-534">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-534">Build</span></span> |  
| <span data-ttu-id="14a62-535">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-535">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-536">MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-536">MVC5, MVC6</span></span> |
| <span data-ttu-id="14a62-537">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-537">**Attributes**</span></span>              | <span data-ttu-id="14a62-538">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-538">N/A</span></span>  |
| <span data-ttu-id="14a62-539">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-539">**References**</span></span>              | <span data-ttu-id="14a62-540">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-540">N/A</span></span>  |
| <span data-ttu-id="14a62-541">Шаг</span><span class="sxs-lookup"><span data-stu-id="14a62-541">Step</span></span> | <span data-ttu-id="14a62-542">Веб-страницы ASP.NET (Razor) выполняют автоматическое кодирование HTML.</span><span class="sxs-lookup"><span data-stu-id="14a62-542">ASP.Net WebPages (Razor) perform automatic HTML encoding.</span></span> <span data-ttu-id="14a62-543">Все строки, которые выводятся внедренными ограничителями кода (блоки @), автоматически преобразовываются в формат HTML.</span><span class="sxs-lookup"><span data-stu-id="14a62-543">All strings printed by embedded code nuggets (@ blocks) are automatically HTML-encoded.</span></span> <span data-ttu-id="14a62-544">Однако при вызове метод `HtmlHelper.Raw` возвращает разметку без кодировки HTML.</span><span class="sxs-lookup"><span data-stu-id="14a62-544">However, when `HtmlHelper.Raw` Method is invoked, it returns markup that is not HTML encoded.</span></span> <span data-ttu-id="14a62-545">Если `Html.Raw()` вспомогательный метод используется, он пропускает hello автоматического кодирования защиты, который предоставляет Razor.</span><span class="sxs-lookup"><span data-stu-id="14a62-545">If `Html.Raw()` helper method is used, it bypasses hello automatic encoding protection that Razor provides.</span></span>|

### <a name="example"></a><span data-ttu-id="14a62-546">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-546">Example</span></span>
<span data-ttu-id="14a62-547">Ниже приведены примеры ненадежных входных данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-547">Following is an insecure example:</span></span> 

```C#
<div class="form-group">
            @Html.Raw(Model.AccountConfirmText)
        </div>
        <div class="form-group">
            @Html.Raw(Model.PaymentConfirmText)
        </div>
</div>
```
<span data-ttu-id="14a62-548">Не используйте `Html.Raw()` при отсутствии необходимости toodisplay разметки.</span><span class="sxs-lookup"><span data-stu-id="14a62-548">Do not use `Html.Raw()` unless you need toodisplay markup.</span></span> <span data-ttu-id="14a62-549">Этот метод помогает избежать неявного кодирования выходных данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-549">This method does not perform output encoding implicitly.</span></span> <span data-ttu-id="14a62-550">Используйте другие вспомогательные методы ASP.NET, например `@Html.DisplayFor()`.</span><span class="sxs-lookup"><span data-stu-id="14a62-550">Use other ASP.NET helpers e.g., `@Html.DisplayFor()`</span></span> 

## <span data-ttu-id="14a62-551"><a id="stored-proc"></a>Не используйте динамические запросы в хранимых процедурах</span><span class="sxs-lookup"><span data-stu-id="14a62-551"><a id="stored-proc"></a>Do not use dynamic queries in stored procedures</span></span>

| <span data-ttu-id="14a62-552">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-552">Title</span></span>                   | <span data-ttu-id="14a62-553">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-553">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-554">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-554">**Component**</span></span>               | <span data-ttu-id="14a62-555">База данных</span><span class="sxs-lookup"><span data-stu-id="14a62-555">Database</span></span> | 
| <span data-ttu-id="14a62-556">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-556">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-557">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-557">Build</span></span> |  
| <span data-ttu-id="14a62-558">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-558">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-559">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-559">Generic</span></span> |
| <span data-ttu-id="14a62-560">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-560">**Attributes**</span></span>              | <span data-ttu-id="14a62-561">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-561">N/A</span></span>  |
| <span data-ttu-id="14a62-562">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-562">**References**</span></span>              | <span data-ttu-id="14a62-563">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-563">N/A</span></span>  |
| <span data-ttu-id="14a62-564">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-564">**Steps**</span></span> | <p><span data-ttu-id="14a62-565">Атаки SQL injection может использовать уязвимости в произвольные команды toorun проверки входных данных в базе данных hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-565">A SQL injection attack exploits vulnerabilities in input validation toorun arbitrary commands in hello database.</span></span> <span data-ttu-id="14a62-566">Она возможна, когда приложение использует входной tooconstruct динамического tooaccess инструкций SQL hello базы данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-566">It can occur when your application uses input tooconstruct dynamic SQL statements tooaccess hello database.</span></span> <span data-ttu-id="14a62-567">Кроме того, такая атака может выполняться, если код использует хранимые процедуры, передающие строки с необработанными входными данными пользователя.</span><span class="sxs-lookup"><span data-stu-id="14a62-567">It can also occur if your code uses stored procedures that are passed strings that contain raw user input.</span></span> <span data-ttu-id="14a62-568">С помощью hello атак путем внедрения кода SQL, злоумышленник hello можно выполнять произвольные команды в базе данных hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-568">Using hello SQL injection attack, hello attacker can execute arbitrary commands in hello database.</span></span> <span data-ttu-id="14a62-569">Все инструкции SQL (включая hello инструкций SQL в хранимых процедурах) должны быть параметризованы.</span><span class="sxs-lookup"><span data-stu-id="14a62-569">All SQL statements (including hello SQL statements in stored procedures) must be parameterized.</span></span> <span data-ttu-id="14a62-570">Параметризованные инструкции SQL будет принимать символы, которые имеют специальное значение tooSQL (например, одинарная кавычка) без проблем, так как они являются строго типизированными.</span><span class="sxs-lookup"><span data-stu-id="14a62-570">Parameterized SQL statements will accept characters that have special meaning tooSQL (like single quote) without problems because they are strongly typed.</span></span> |

### <a name="example"></a><span data-ttu-id="14a62-571">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-571">Example</span></span>
<span data-ttu-id="14a62-572">Ниже приведен пример небезопасной динамической хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="14a62-572">Following is an example of insecure dynamic Stored Procedure:</span></span> 

```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteria]
(
  @productName nvarchar(200) = NULL,
  @startPrice float = NULL,
  @endPrice float = NULL
)
AS
 BEGIN
  DECLARE @sql nvarchar(max)
  SELECT @sql = ' SELECT ProductID, ProductName, Description, UnitPrice, ImagePath' +
       ' FROM dbo.Products WHERE 1 = 1 '
       PRINT @sql
  IF @productName IS NOT NULL
     SELECT @sql = @sql + ' AND ProductName LIKE ''%' + @productName + '%'''
  IF @startPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice > ''' + CONVERT(VARCHAR(10),@startPrice) + ''''
  IF @endPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice < ''' + CONVERT(VARCHAR(10),@endPrice) + ''''

  PRINT @sql
  EXEC(@sql)
 END
```

### <a name="example"></a><span data-ttu-id="14a62-573">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-573">Example</span></span>
<span data-ttu-id="14a62-574">Ниже приведен hello безопасно реализации одной хранимой процедуре.</span><span class="sxs-lookup"><span data-stu-id="14a62-574">Following is hello same stored procedure implemented securely:</span></span> 
```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteriaSecure]
(
             @productName nvarchar(200) = NULL,
             @startPrice float = NULL,
             @endPrice float = NULL
)
AS
       BEGIN
             SELECT ProductID, ProductName, Description, UnitPrice, ImagePath
             FROM dbo.Products where
             (@productName IS NULL or ProductName like '%'+ @productName +'%')
             AND
             (@startPrice IS NULL or UnitPrice > @startPrice)
             AND
             (@endPrice IS NULL or UnitPrice < @endPrice)         
       END
```

## <span data-ttu-id="14a62-575"><a id="validation-api"></a>Убедитесь, что в методах веб-API выполнена проверка моделей</span><span class="sxs-lookup"><span data-stu-id="14a62-575"><a id="validation-api"></a>Ensure that model validation is done on Web API methods</span></span>

| <span data-ttu-id="14a62-576">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-576">Title</span></span>                   | <span data-ttu-id="14a62-577">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-577">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-578">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-578">**Component**</span></span>               | <span data-ttu-id="14a62-579">Веб-интерфейс API</span><span class="sxs-lookup"><span data-stu-id="14a62-579">Web API</span></span> | 
| <span data-ttu-id="14a62-580">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-580">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-581">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-581">Build</span></span> |  
| <span data-ttu-id="14a62-582">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-582">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-583">MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-583">MVC5, MVC6</span></span> |
| <span data-ttu-id="14a62-584">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-584">**Attributes**</span></span>              | <span data-ttu-id="14a62-585">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-585">N/A</span></span>  |
| <span data-ttu-id="14a62-586">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-586">**References**</span></span>              | <span data-ttu-id="14a62-587">[Model Validation in ASP.NET Web API ](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api) (Проверка модели в веб-API ASP.NET)</span><span class="sxs-lookup"><span data-stu-id="14a62-587">[Model Validation in ASP.NET Web API ](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api)</span></span> |
| <span data-ttu-id="14a62-588">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-588">**Steps**</span></span> | <span data-ttu-id="14a62-589">Когда клиент отправляет данные tooa в веб-API, это обязательные toovalidate hello данных перед выполнением какой-либо обработки.</span><span class="sxs-lookup"><span data-stu-id="14a62-589">When a client sends data tooa web API, it is mandatory toovalidate hello data before doing any processing.</span></span> <span data-ttu-id="14a62-590">Для ASP.NET веб-API, который принимает в качестве входных данных модели используйте заметок к данным на правила проверки модели tooset hello свойств модели hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-590">For ASP.NET Web APIs which accept models as input, use data annotations on models tooset validation rules on hello properties of hello model.</span></span>|

### <a name="example"></a><span data-ttu-id="14a62-591">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-591">Example</span></span>
<span data-ttu-id="14a62-592">Привет, следующий код демонстрирует hello же:</span><span class="sxs-lookup"><span data-stu-id="14a62-592">hello following code demonstrates hello same:</span></span> 

```C#
using System.ComponentModel.DataAnnotations;

namespace MyApi.Models
{
    public class Product
    {
        public int Id { get; set; }
        [Required]
        [RegularExpression(@"^[a-zA-Z0-9]*$", ErrorMessage="Only alphanumeric characters are allowed.")]
        public string Name { get; set; }
        public decimal Price { get; set; }
        [Range(0, 999)]
        public double Weight { get; set; }
    }
}
```

### <a name="example"></a><span data-ttu-id="14a62-593">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-593">Example</span></span>
<span data-ttu-id="14a62-594">В метод действия hello hello API контроллеров допустимость модели hello имеет toobe проверены явно, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="14a62-594">In hello action method of hello API controllers, validity of hello model has toobe explicitly checked as shown below:</span></span> 

```C#
namespace MyApi.Controllers
{
    public class ProductsController : ApiController
    {
        public HttpResponseMessage Post(Product product)
        {
            if (ModelState.IsValid)
            {
                // Do something with hello product (not shown).

                return new HttpResponseMessage(HttpStatusCode.OK);
            }
            else
            {
                return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState);
            }
        }
    }
}
```

## <span data-ttu-id="14a62-595"><a id="string-api"></a>Внедрите проверку входных данных для всех параметров строкового типа, принимаемых методами веб-API</span><span class="sxs-lookup"><span data-stu-id="14a62-595"><a id="string-api"></a>Implement input validation on all string type parameters accepted by Web API methods</span></span>

| <span data-ttu-id="14a62-596">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-596">Title</span></span>                   | <span data-ttu-id="14a62-597">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-597">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-598">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-598">**Component**</span></span>               | <span data-ttu-id="14a62-599">Веб-интерфейс API</span><span class="sxs-lookup"><span data-stu-id="14a62-599">Web API</span></span> | 
| <span data-ttu-id="14a62-600">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-600">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-601">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-601">Build</span></span> |  
| <span data-ttu-id="14a62-602">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-602">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-603">Универсальные, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="14a62-603">Generic, MVC 5, MVC 6</span></span> |
| <span data-ttu-id="14a62-604">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-604">**Attributes**</span></span>              | <span data-ttu-id="14a62-605">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-605">N/A</span></span>  |
| <span data-ttu-id="14a62-606">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-606">**References**</span></span>              | <span data-ttu-id="14a62-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Проверка данных модели в приложении MVC), [Основные принципы ваших приложений ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="14a62-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="14a62-608">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-608">**Steps**</span></span> | <span data-ttu-id="14a62-609">Для методов, принимающих примитивные типы данных, а не модели в качестве аргументов, следует выполнять проверки входных данных с использованием регулярных выражений.</span><span class="sxs-lookup"><span data-stu-id="14a62-609">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="14a62-610">Здесь следует использовать Regex.IsMatch с шаблоном допустимого регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="14a62-610">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="14a62-611">Hello входные данные соответствуют hello указанному регулярному выражению, элемент управления не следует продолжить и отображать достаточно предупреждение об ошибке проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="14a62-611">If hello input doesn't match hello specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>|

## <span data-ttu-id="14a62-612"><a id="typesafe-api"></a>Убедитесь, что в веб-API для доступа к данным используются параметры типобезопасности</span><span class="sxs-lookup"><span data-stu-id="14a62-612"><a id="typesafe-api"></a>Ensure that type-safe parameters are used in Web API for data access</span></span>

| <span data-ttu-id="14a62-613">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-613">Title</span></span>                   | <span data-ttu-id="14a62-614">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-614">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-615">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-615">**Component**</span></span>               | <span data-ttu-id="14a62-616">Веб-интерфейс API</span><span class="sxs-lookup"><span data-stu-id="14a62-616">Web API</span></span> | 
| <span data-ttu-id="14a62-617">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-617">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-618">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-618">Build</span></span> |  
| <span data-ttu-id="14a62-619">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-619">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-620">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-620">Generic</span></span> |
| <span data-ttu-id="14a62-621">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-621">**Attributes**</span></span>              | <span data-ttu-id="14a62-622">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-622">N/A</span></span>  |
| <span data-ttu-id="14a62-623">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-623">**References**</span></span>              | <span data-ttu-id="14a62-624">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-624">N/A</span></span>  |
| <span data-ttu-id="14a62-625">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-625">**Steps**</span></span> | <p><span data-ttu-id="14a62-626">При использовании коллекции Parameters hello SQL будет обрабатываться hello ввода — как буквенное значение, а не как исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="14a62-626">If you use hello Parameters collection, SQL treats hello input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="14a62-627">Hello коллекцию Parameters можно tooenforce используется тип и длина ограничения для входных данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-627">hello Parameters collection can be used tooenforce type and length constraints on input data.</span></span> <span data-ttu-id="14a62-628">Значение за пределами диапазона hello вызвано исключение.</span><span class="sxs-lookup"><span data-stu-id="14a62-628">Values outside of hello range trigger an exception.</span></span> <span data-ttu-id="14a62-629">Если строго типизированным SQL параметры не используются, злоумышленники могут быть атак путем внедрения кода может tooexecute, внедренных в hello нефильтрованные входные данные.</span><span class="sxs-lookup"><span data-stu-id="14a62-629">If type-safe SQL parameters are not used, attackers might be able tooexecute injection attacks that are embedded in hello unfiltered input.</span></span></p><p><span data-ttu-id="14a62-630">Используйте безопасные параметры типа, при построении SQL запросов tooavoid возможности атаки SQL injection, связанных с нефильтрованные входные данные.</span><span class="sxs-lookup"><span data-stu-id="14a62-630">Use type safe parameters when constructing SQL queries tooavoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="14a62-631">Эти параметры можно использовать с хранимыми процедурами и динамическими инструкциями SQL.</span><span class="sxs-lookup"><span data-stu-id="14a62-631">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="14a62-632">Параметры обрабатываются как литеральные значения, hello базы данных, а не исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="14a62-632">Parameters are treated as literal values by hello database and not as executable code.</span></span> <span data-ttu-id="14a62-633">Кроме того, проверяется тип и длина параметров.</span><span class="sxs-lookup"><span data-stu-id="14a62-633">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="14a62-634">Пример</span><span class="sxs-lookup"><span data-stu-id="14a62-634">Example</span></span>
<span data-ttu-id="14a62-635">Hello следующий код показывает, как toouse безопасные параметры типа с hello SqlParameterCollection при вызове хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="14a62-635">hello following code shows how toouse type safe parameters with hello SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="14a62-636">Входное значение hello hello предшествующий пример кода, не может быть длиннее 11 символов.</span><span class="sxs-lookup"><span data-stu-id="14a62-636">In hello preceding code example, hello input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="14a62-637">Если тип toohello или длина, определенная параметром hello hello данные не соответствуют, hello SqlParameter класс вызывает исключение.</span><span class="sxs-lookup"><span data-stu-id="14a62-637">If hello data does not conform toohello type or length defined by hello parameter, hello SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="14a62-638"><a id="sql-docdb"></a>Использование параметризованных SQL-запросов для Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="14a62-638"><a id="sql-docdb"></a>Use parametrized SQL queries for Cosmos DB</span></span>

| <span data-ttu-id="14a62-639">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-639">Title</span></span>                   | <span data-ttu-id="14a62-640">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-640">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-641">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-641">**Component**</span></span>               | <span data-ttu-id="14a62-642">Azure DocumentDB</span><span class="sxs-lookup"><span data-stu-id="14a62-642">Azure Document DB</span></span> | 
| <span data-ttu-id="14a62-643">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-643">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-644">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-644">Build</span></span> |  
| <span data-ttu-id="14a62-645">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-645">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-646">Универсальный</span><span class="sxs-lookup"><span data-stu-id="14a62-646">Generic</span></span> |
| <span data-ttu-id="14a62-647">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-647">**Attributes**</span></span>              | <span data-ttu-id="14a62-648">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-648">N/A</span></span>  |
| <span data-ttu-id="14a62-649">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-649">**References**</span></span>              | <span data-ttu-id="14a62-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/) (Объявление о параметризации SQL в DocumentDB)</span><span class="sxs-lookup"><span data-stu-id="14a62-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/)</span></span> |
| <span data-ttu-id="14a62-651">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-651">**Steps**</span></span> | <span data-ttu-id="14a62-652">Несмотря на то что DocumentDB поддерживает исключительно запросы только для чтения, атака путем внедрения кода SQL по-прежнему возможна, если создавать запросы, объединяя их с входными данными пользователя.</span><span class="sxs-lookup"><span data-stu-id="14a62-652">Although DocumentDB only supports read-only queries, SQL injection is still possible if queries are constructed by concatenating with user input.</span></span> <span data-ttu-id="14a62-653">Могут быть доступны для toodata доступа toogain пользователя, не следует обращаться в hello одной коллекции разработать вредоносные запросы SQL.</span><span class="sxs-lookup"><span data-stu-id="14a62-653">It might be possible for a user toogain access toodata they shouldn’t be accessing within hello same collection by crafting malicious SQL queries.</span></span> <span data-ttu-id="14a62-654">Используйте параметризованные SQL-запросы, если запросы создаются на основе входных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="14a62-654">Use parameterized SQL queries if queries are constructed based on user input.</span></span> |

## <span data-ttu-id="14a62-655"><a id="schema-binding"></a>Проверка входных данных WCF путем привязки к схеме</span><span class="sxs-lookup"><span data-stu-id="14a62-655"><a id="schema-binding"></a>WCF Input validation through Schema binding</span></span>

| <span data-ttu-id="14a62-656">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-656">Title</span></span>                   | <span data-ttu-id="14a62-657">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-657">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-658">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-658">**Component**</span></span>               | <span data-ttu-id="14a62-659">WCF</span><span class="sxs-lookup"><span data-stu-id="14a62-659">WCF</span></span> | 
| <span data-ttu-id="14a62-660">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-660">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-661">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-661">Build</span></span> |  
| <span data-ttu-id="14a62-662">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-662">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-663">Универсальные, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="14a62-663">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="14a62-664">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-664">**Attributes**</span></span>              | <span data-ttu-id="14a62-665">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-665">N/A</span></span>  |
| <span data-ttu-id="14a62-666">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-666">**References**</span></span>              | [<span data-ttu-id="14a62-667">MSDN</span><span class="sxs-lookup"><span data-stu-id="14a62-667">MSDN</span></span>](https://msdn.microsoft.com/library/ff647820.aspx) |
| <span data-ttu-id="14a62-668">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-668">**Steps**</span></span> | <p><span data-ttu-id="14a62-669">Отсутствие проверки приводит toodifferent атак путем внедрения кода типа.</span><span class="sxs-lookup"><span data-stu-id="14a62-669">Lack of validation leads toodifferent type injection attacks.</span></span></p><p><span data-ttu-id="14a62-670">Проверка сообщений представляет одну линию обороны в защите hello приложения WCF.</span><span class="sxs-lookup"><span data-stu-id="14a62-670">Message validation represents one line of defense in hello protection of your WCF application.</span></span> <span data-ttu-id="14a62-671">В этом случае проверка сообщений с помощью операций службы WCF tooprotect схемы от атак со стороны вредоносного клиента.</span><span class="sxs-lookup"><span data-stu-id="14a62-671">With this approach, you validate messages using schemas tooprotect WCF service operations from attack by a malicious client.</span></span> <span data-ttu-id="14a62-672">Проверьте все сообщения, полученные клиентом hello клиента tooprotect hello от атак на вредоносной службе.</span><span class="sxs-lookup"><span data-stu-id="14a62-672">Validate all messages received by hello client tooprotect hello client from attack by a malicious service.</span></span> <span data-ttu-id="14a62-673">Проверка сообщений упрощает возможных toovalidate сообщений при операции потреблять контрактов сообщений или контрактов данных, которые невозможно выполнить с помощью проверки параметров.</span><span class="sxs-lookup"><span data-stu-id="14a62-673">Message validation makes it possible toovalidate messages when operations consume message contracts or data contracts, which cannot be done using parameter validation.</span></span> <span data-ttu-id="14a62-674">Проверка сообщений позволяет toocreate логику проверки в схемах, тем самым обеспечивая большую гибкость и сократить время разработки.</span><span class="sxs-lookup"><span data-stu-id="14a62-674">Message validation allows you toocreate validation logic inside schemas, thereby providing more flexibility and reducing development time.</span></span> <span data-ttu-id="14a62-675">Схемы можно использовать в различных приложениях внутри организации hello, создание стандарты для представления данных.</span><span class="sxs-lookup"><span data-stu-id="14a62-675">Schemas can be reused across different applications inside hello organization, creating standards for data representation.</span></span> <span data-ttu-id="14a62-676">Кроме того Проверка сообщений позволяет tooprotect операции когда они используют более сложных типов данных, связанных с контрактами, представляющий бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="14a62-676">Additionally, message validation allows you tooprotect operations when they consume more complex data types involving contracts representing business logic.</span></span></p><p><span data-ttu-id="14a62-677">проверки сообщений tooperform вначале построить схему, которая представляет hello операции службы и hello типов данных потребляет выполнения этих операций.</span><span class="sxs-lookup"><span data-stu-id="14a62-677">tooperform message validation, you first build a schema that represents hello operations of your service and hello data types consumed by those operations.</span></span> <span data-ttu-id="14a62-678">Создайте класс .NET, который реализует пользовательского клиентского инспектора сообщений и пользовательский диспетчер message inspector toovalidate hello сообщений отправленных и полученных от службы hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-678">You then create a .NET class that implements a custom client message inspector and custom dispatcher message inspector toovalidate hello messages sent/received to/from hello service.</span></span> <span data-ttu-id="14a62-679">Далее необходимо реализовать проверку сообщения tooenable поведение пользовательской конечной точки на приветствия клиента и службы hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-679">Next, you implement a custom endpoint behavior tooenable message validation on both hello client and hello service.</span></span> <span data-ttu-id="14a62-680">Наконец необходимо реализовать пользовательский элемент конфигурации на hello класс, который позволяет tooexpose hello расширенной настраиваемые поведения конечной точки в файле конфигурации hello hello службы или клиента hello»</span><span class="sxs-lookup"><span data-stu-id="14a62-680">Finally, you implement a custom configuration element on hello class that allows you tooexpose hello extended custom endpoint behavior in hello configuration file of hello service or hello client"</span></span></p>|

## <span data-ttu-id="14a62-681"><a id="parameters"></a>Проверка входных данных WCF с помощью инспекторов параметров</span><span class="sxs-lookup"><span data-stu-id="14a62-681"><a id="parameters"></a>WCF- Input validation through Parameter Inspectors</span></span>

| <span data-ttu-id="14a62-682">Название</span><span class="sxs-lookup"><span data-stu-id="14a62-682">Title</span></span>                   | <span data-ttu-id="14a62-683">Сведения</span><span class="sxs-lookup"><span data-stu-id="14a62-683">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="14a62-684">**Компонент**</span><span class="sxs-lookup"><span data-stu-id="14a62-684">**Component**</span></span>               | <span data-ttu-id="14a62-685">WCF</span><span class="sxs-lookup"><span data-stu-id="14a62-685">WCF</span></span> | 
| <span data-ttu-id="14a62-686">**Этап SDL**</span><span class="sxs-lookup"><span data-stu-id="14a62-686">**SDL Phase**</span></span>               | <span data-ttu-id="14a62-687">Создание</span><span class="sxs-lookup"><span data-stu-id="14a62-687">Build</span></span> |  
| <span data-ttu-id="14a62-688">**Применимые технологии**</span><span class="sxs-lookup"><span data-stu-id="14a62-688">**Applicable Technologies**</span></span> | <span data-ttu-id="14a62-689">Универсальные, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="14a62-689">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="14a62-690">**Атрибуты**</span><span class="sxs-lookup"><span data-stu-id="14a62-690">**Attributes**</span></span>              | <span data-ttu-id="14a62-691">Недоступно</span><span class="sxs-lookup"><span data-stu-id="14a62-691">N/A</span></span>  |
| <span data-ttu-id="14a62-692">**Справочные материалы**</span><span class="sxs-lookup"><span data-stu-id="14a62-692">**References**</span></span>              | [<span data-ttu-id="14a62-693">MSDN</span><span class="sxs-lookup"><span data-stu-id="14a62-693">MSDN</span></span>](https://msdn.microsoft.com/library/ff647875.aspx) |
| <span data-ttu-id="14a62-694">**Действия**</span><span class="sxs-lookup"><span data-stu-id="14a62-694">**Steps**</span></span> | <p><span data-ttu-id="14a62-695">Ввод и проверка данных представляет один важные линией обороны в защите hello приложения WCF.</span><span class="sxs-lookup"><span data-stu-id="14a62-695">Input and data validation represents one important line of defense in hello protection of your WCF application.</span></span> <span data-ttu-id="14a62-696">Следует проверить все параметры, предоставленные служба WCF службы операций tooprotect hello от атак со стороны вредоносного клиента.</span><span class="sxs-lookup"><span data-stu-id="14a62-696">You should validate all parameters exposed in WCF service operations tooprotect hello service from attack by a malicious client.</span></span> <span data-ttu-id="14a62-697">И наоборот следует проверить все возвращаемые значения, полученных hello клиент tooprotect hello клиент от атак вредоносного службой</span><span class="sxs-lookup"><span data-stu-id="14a62-697">Conversely, you should also validate all return values received by hello client tooprotect hello client from attack by a malicious service</span></span></p><p><span data-ttu-id="14a62-698">WCF предоставляет точки различные расширения, обеспечивающие поведение среды выполнения WCF hello toocustomize путем создания пользовательских расширений.</span><span class="sxs-lookup"><span data-stu-id="14a62-698">WCF provides different extensibility points that allow you toocustomize hello WCF runtime behavior by creating custom extensions.</span></span> <span data-ttu-id="14a62-699">Сообщение, инспекторы и Инспекторы параметров являются двумя механизмами расширяемости использовать toogain больший контроль над hello данных, передаваемых между клиентом и службой.</span><span class="sxs-lookup"><span data-stu-id="14a62-699">Message Inspectors and Parameter Inspectors are two extensibility mechanisms used toogain greater control over hello data passing between a client and a service.</span></span> <span data-ttu-id="14a62-700">Следует использовать инспекторов параметров для проверки входных данных и используйте инспекторы сообщений только в том случае, если требуются все сообщение hello tooinspect проходящие через службу.</span><span class="sxs-lookup"><span data-stu-id="14a62-700">You should use parameter inspectors for input validation and use message inspectors only when you need tooinspect hello entire message flowing in and out of a service.</span></span></p><p><span data-ttu-id="14a62-701">tooperform проверку входных данных, будут построены класс .NET и реализовать пользовательский инспектор параметров в параметры toovalidate заказа на операции в службе.</span><span class="sxs-lookup"><span data-stu-id="14a62-701">tooperform input validation, you will build a .NET class and implement a custom parameter inspector in order toovalidate parameters on operations in your service.</span></span> <span data-ttu-id="14a62-702">Затем будет реализовывать tooenable проверки поведения пользовательской конечной точки на приветствия клиента и службы hello.</span><span class="sxs-lookup"><span data-stu-id="14a62-702">You will then implement a custom endpoint behavior tooenable validation on both hello client and hello service.</span></span> <span data-ttu-id="14a62-703">Наконец будет реализовать пользовательский элемент конфигурации на hello класс, который позволяет tooexpose hello расширенной настраиваемые поведения конечной точки в файле конфигурации hello hello службы или клиента hello</span><span class="sxs-lookup"><span data-stu-id="14a62-703">Finally, you will implement a custom configuration element on hello class that allows you tooexpose hello extended custom endpoint behavior in hello configuration file of hello service or hello client</span></span></p>|
