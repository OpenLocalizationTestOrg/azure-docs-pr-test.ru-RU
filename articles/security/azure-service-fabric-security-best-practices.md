---
title: "Рекомендации по безопасности Azure Service Fabric | Документация Майкрософт"
description: "В этой статье представлены рекомендации по безопасности Azure Service Fabric."
services: security
documentationcenter: na
author: unifycloud
manager: swadhwa
editor: tomsh
ms.assetid: 
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/04/2017
ms.author: tomsh
ms.openlocfilehash: 3132e42aac72c0132c7526ac56d80bc5eec269e7
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="azure-service-fabric-security-best-practices"></a><span data-ttu-id="bd80c-103">Рекомендации по безопасности Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="bd80c-103">Azure Service Fabric security best practices</span></span>
<span data-ttu-id="bd80c-104">Развертывание приложения в Azure — быстрое, удобное и экономичное.</span><span class="sxs-lookup"><span data-stu-id="bd80c-104">Deploying an application on Azure is fast, easy, and cost-effective.</span></span> <span data-ttu-id="bd80c-105">Перед развертыванием облачного приложения в рабочей среде удобно иметь под рукой рекомендации, содержащие важные и лучшие методики, которые помогают оценить приложение.</span><span class="sxs-lookup"><span data-stu-id="bd80c-105">Before deploying cloud application in production useful to have a best practice to assist in evaluating your application against a list of essential and recommended best practices.</span></span>

<span data-ttu-id="bd80c-106">Azure Service Fabric — это платформа распределенных систем, которая дает возможность не только легко упаковывать и развертывать масштабируемые и надежные микрослужбы, но и управлять ими.</span><span class="sxs-lookup"><span data-stu-id="bd80c-106">Azure Service Fabric is a distributed systems platform that makes it easy to package, deploy, and manage scalable and reliable microservices.</span></span> <span data-ttu-id="bd80c-107">Service Fabric также позволяет разрешить значительные трудности, возникающие при разработке облачных приложений и управлении ими.</span><span class="sxs-lookup"><span data-stu-id="bd80c-107">Service Fabric also addresses the significant challenges in developing and managing cloud applications.</span></span> <span data-ttu-id="bd80c-108">Получая гарантированную масштабируемость, надежность и управляемость, разработчики и администраторы могут сосредоточиться на реализации критически важных и ресурсоемких рабочих нагрузок вместо того, чтобы тратить силы на решение сложных проблем с инфраструктурой.</span><span class="sxs-lookup"><span data-stu-id="bd80c-108">Developers and administrators can avoid complex infrastructure problems and focus on implementing mission-critical, demanding workloads that are scalable, reliable, and manageable.</span></span> 

<span data-ttu-id="bd80c-109">Для каждой рекомендации будет предоставлено объяснение следующих аспектов:</span><span class="sxs-lookup"><span data-stu-id="bd80c-109">For each best practice, we explain:</span></span>

-   <span data-ttu-id="bd80c-110">суть рекомендации;</span><span class="sxs-lookup"><span data-stu-id="bd80c-110">What the best practice is</span></span>
-   <span data-ttu-id="bd80c-111">почему необходимо применять эту рекомендацию;</span><span class="sxs-lookup"><span data-stu-id="bd80c-111">Why you want to enable that best practice</span></span>
-   <span data-ttu-id="bd80c-112">что может случиться, если не применить эту рекомендацию;</span><span class="sxs-lookup"><span data-stu-id="bd80c-112">What might be the result if you fail to enable the best practice</span></span>
-   <span data-ttu-id="bd80c-113">как научиться применять эту рекомендацию.</span><span class="sxs-lookup"><span data-stu-id="bd80c-113">How you can learn to enable the best practice</span></span>

<span data-ttu-id="bd80c-114">Сейчас доступны следующие рекомендации по обеспечению безопасности в Azure Service Fabric:</span><span class="sxs-lookup"><span data-stu-id="bd80c-114">We currently have the following Azure Service Fabric security best practices:</span></span>

-   <span data-ttu-id="bd80c-115">Создание безопасного кластера с помощью шаблона Azure Resource Manager (ARM) и модуля PowerShell Azure для Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="bd80c-115">Use Azure Resource Manager(ARM) template and Service Fabric Azure PowerShell Module to create secure cluster</span></span>
-   <span data-ttu-id="bd80c-116">Использование сертификата X.509.</span><span class="sxs-lookup"><span data-stu-id="bd80c-116">Use X.509 certificates</span></span>
-   <span data-ttu-id="bd80c-117">Настройка политик безопасности.</span><span class="sxs-lookup"><span data-stu-id="bd80c-117">Configure security policies</span></span>
-   <span data-ttu-id="bd80c-118">Настройка безопасности с помощью Reliable Actors.</span><span class="sxs-lookup"><span data-stu-id="bd80c-118">Reliable Actors security configuration</span></span>
-   <span data-ttu-id="bd80c-119">Настройка SSL для Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="bd80c-119">Configure SSL for Azure Service Fabric</span></span>
-   <span data-ttu-id="bd80c-120">Обеспечение сетевой изоляции и безопасности с помощью Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="bd80c-120">Network Isolation/Security with Azure Service Fabric</span></span>
-   <span data-ttu-id="bd80c-121">Настройка хранилища ключей для обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="bd80c-121">Set up a key vault for security</span></span>
-   <span data-ttu-id="bd80c-122">Назначение пользователей ролям</span><span class="sxs-lookup"><span data-stu-id="bd80c-122">Assign users to roles</span></span>


## <a name="best-practices-for-securing-your-cluster"></a><span data-ttu-id="bd80c-123">Рекомендации по обеспечению безопасности кластера</span><span class="sxs-lookup"><span data-stu-id="bd80c-123">Best practices for securing your cluster</span></span>

<span data-ttu-id="bd80c-124">**Общая картина**</span><span class="sxs-lookup"><span data-stu-id="bd80c-124">**Big Picture**</span></span>

<span data-ttu-id="bd80c-125">Всегда используйте безопасный кластер.</span><span class="sxs-lookup"><span data-stu-id="bd80c-125">Always use a secure cluster</span></span>
-   <span data-ttu-id="bd80c-126">Безопасность кластера. Используйте сертификаты.</span><span class="sxs-lookup"><span data-stu-id="bd80c-126">Cluster security – use Certificates</span></span>
-   <span data-ttu-id="bd80c-127">Клиентский доступ (для администраторов и только для чтения). Используйте AAD.</span><span class="sxs-lookup"><span data-stu-id="bd80c-127">Client access (Admin and Read only) – use AAD</span></span>

<span data-ttu-id="bd80c-128">Используйте автоматическое развертывание.</span><span class="sxs-lookup"><span data-stu-id="bd80c-128">Use automated deployments</span></span>
-   <span data-ttu-id="bd80c-129">Используйте сценарии для создания, развертывания и смены секретов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-129">Use scripts to generate, deploy and, roll over secrets</span></span>
-   <span data-ttu-id="bd80c-130">Храните секреты в хранилище ключей. Используйте AD для других видов клиентского доступа.</span><span class="sxs-lookup"><span data-stu-id="bd80c-130">Keep the secrets in KV, use AD for all other client access</span></span>
-   <span data-ttu-id="bd80c-131">Никто не должен иметь к ним доступ без аутентификации.</span><span class="sxs-lookup"><span data-stu-id="bd80c-131">No human should have access to them without authentication.</span></span>

<span data-ttu-id="bd80c-132">Кроме того, учтите следующее:</span><span class="sxs-lookup"><span data-stu-id="bd80c-132">Additionally, consider the following:</span></span>
-   <span data-ttu-id="bd80c-133">Создавайте сети периметра с помощью групп безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="bd80c-133">Create DMZs using Network Security Groups (NSGs)</span></span>
-   <span data-ttu-id="bd80c-134">Используйте серверы перехода для подключения к виртуальным машинам кластера по протоколу удаленного рабочего стола или для управления кластером.</span><span class="sxs-lookup"><span data-stu-id="bd80c-134">Use Jump servers to RDP into cluster VMs or to manage your cluster</span></span>

<span data-ttu-id="bd80c-135">Кластеры должны быть защищены для предотвращения подключения к ним неавторизованных пользователей, особенно в тех случаях, когда на кластере выполняются рабочие нагрузки в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="bd80c-135">Clusters must be secured to prevent unauthorized users from connecting to your cluster, especially when it has production workloads running on it.</span></span> <span data-ttu-id="bd80c-136">Существует возможность создания незащищенного кластера, однако стоит учитывать, что это позволит анонимным пользователям подключаться к нему, если конечные точки управления кластером общедоступны через Интернет.</span><span class="sxs-lookup"><span data-stu-id="bd80c-136">Although it is possible to create an unsecured cluster, doing so allows anonymous users to connect to it, if it exposes management endpoints to the public Internet.</span></span>

<span data-ttu-id="bd80c-137">Технологии, используемые для реализации этих сценариев.</span><span class="sxs-lookup"><span data-stu-id="bd80c-137">Technologies used to implement those scenarios.</span></span> <span data-ttu-id="bd80c-138">[Сценарии обеспечения безопасности кластера](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security):</span><span class="sxs-lookup"><span data-stu-id="bd80c-138">The [cluster security scenarios](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security) are:</span></span>

-   <span data-ttu-id="bd80c-139">Безопасность обмена данными между узлами. Обеспечивается защита взаимодействия виртуальных машин и компьютеров в кластере.</span><span class="sxs-lookup"><span data-stu-id="bd80c-139">Node-to-node security- This secures communication between the VMs and computers in the cluster.</span></span> <span data-ttu-id="bd80c-140">Такая защита гарантирует, что размещать приложения и службы в кластере смогут владельцы только тех компьютеров, которые прошли авторизацию для подключения к кластеру.</span><span class="sxs-lookup"><span data-stu-id="bd80c-140">This ensures that only computers that are authorized to join the cluster can participate in hosting applications and services in the cluster.</span></span>
<span data-ttu-id="bd80c-141">Кластеры, работающие в Azure, или автономные кластеры, работающие под управлением Windows, могут использовать [безопасность на основе сертификатов](https://docs.microsoft.com/azure/service-fabric/service-fabric-windows-cluster-x509-security) или [безопасность Windows](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-windows-cluster-windows-security) для компьютеров Windows Server.</span><span class="sxs-lookup"><span data-stu-id="bd80c-141">Clusters running on Azure or standalone clusters running on Windows can use either [Certificate Security](https://docs.microsoft.com/azure/service-fabric/service-fabric-windows-cluster-x509-security) or [Windows Security](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-windows-cluster-windows-security) for Windows Server machines.</span></span>
-   <span data-ttu-id="bd80c-142">Безопасность обмена данными между клиентами и узлами. Обеспечивается защита взаимодействия клиента Service Fabric и отдельных узлов в кластере.</span><span class="sxs-lookup"><span data-stu-id="bd80c-142">Client-to-node security- This secures communication between a Service Fabric client and individual nodes in the cluster.</span></span>
-   <span data-ttu-id="bd80c-143">Управление доступом на основе ролей. Клиентские роли (администратора или клиента) задаются во время создания кластера путем предоставления отдельных удостоверений (сертификатов, AAD и т. д.) для каждой из них.</span><span class="sxs-lookup"><span data-stu-id="bd80c-143">Role-based access control (RBAC) - You specify the administrator and user client roles at the time of cluster creation by providing separate identities (certificates, AAD etc.) for each.</span></span>
-   <span data-ttu-id="bd80c-144">Рекомендации по безопасности. Чтобы обеспечить безопасность обмена данными между узлами в кластерах Azure, рекомендуется использовать безопасность AAD для аутентификации клиентов и сертификатов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-144">Security Recommendations-For Azure clusters, it is recommended that you use AAD security to authenticate clients and certificates for node-to-node security.</span></span>

<span data-ttu-id="bd80c-145">Для настройки автономного кластера Windows см. статью [Параметры конфигурации для автономного кластера Windows](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-manifest).</span><span class="sxs-lookup"><span data-stu-id="bd80c-145">To configure the standalone Windows cluster, see [configure settings for standalone windows cluster](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-manifest).</span></span>

<span data-ttu-id="bd80c-146">Используйте шаблон Azure Resource Manager (ARM) и модуль PowerShell Azure для Service Fabric для создания безопасного кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-146">Use Azure Resource Manager templates and Service Fabric Azure PowerShell Module to create secure cluster.</span></span>
<span data-ttu-id="bd80c-147">Пошаговое руководство, которое поможет выполнить настройку защищенного кластера Azure Service Fabric в Azure с помощью Azure Resource Manager, доступно [здесь](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-via-arm).</span><span class="sxs-lookup"><span data-stu-id="bd80c-147">A step-by-step guide walks you through setting up a secure Azure Service Fabric cluster in Azure by using Azure Resource Manager is available [here](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-via-arm).</span></span>

<span data-ttu-id="bd80c-148">Используйте шаблон Azure Resource Manager для настройки кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-148">Use the Azure Resource Manager template to customize your cluster</span></span>
-   <span data-ttu-id="bd80c-149">Настройте управляемое хранилище для виртуальных жестких дисков виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="bd80c-149">Setup-managed storage for VM VHDs</span></span>

<span data-ttu-id="bd80c-150">Используйте шаблон Azure Resource Manager для изменения группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-150">Use the Azure Resource Manager template to drive changes to your Resource Group</span></span>
-   <span data-ttu-id="bd80c-151">Простое управление конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="bd80c-151">Easy configuration management</span></span>
-   <span data-ttu-id="bd80c-152">Аудит</span><span class="sxs-lookup"><span data-stu-id="bd80c-152">Auditing</span></span>

<span data-ttu-id="bd80c-153">Считайте конфигурацию кластера кодом.</span><span class="sxs-lookup"><span data-stu-id="bd80c-153">Treat your cluster configuration as Code</span></span>
-   <span data-ttu-id="bd80c-154">Тщательно проверяйте конфигурации, которые требуется развернуть.</span><span class="sxs-lookup"><span data-stu-id="bd80c-154">Be thorough in checking the configurations you choose to deploy</span></span>
-   <span data-ttu-id="bd80c-155">Не используйте неявные команды для настройки ресурсов напрямую.</span><span class="sxs-lookup"><span data-stu-id="bd80c-155">Avoid using implicit commands to tweak your resources directly</span></span>

<span data-ttu-id="bd80c-156">Многие аспекты [жизненного цикла приложения Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-lifecycle) можно автоматизировать.</span><span class="sxs-lookup"><span data-stu-id="bd80c-156">Many aspects of the [Service Fabric application lifecycle](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-lifecycle) can be automated.</span></span> <span data-ttu-id="bd80c-157">[Модуль PowerShell Azure для Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-remove-applications#upload-the-application-package) автоматизирует типовые задачи по развертыванию, обновлению, удалению и тестированию приложений Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="bd80c-157">[Service Fabric Azure PowerShell Module](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-remove-applications#upload-the-application-package) automates common tasks for deploying, upgrading, removing, and testing Azure Service Fabric applications.</span></span> <span data-ttu-id="bd80c-158">Также доступны управляемые API и API HTTP для управления приложениями.</span><span class="sxs-lookup"><span data-stu-id="bd80c-158">Managed and HTTP APIs for app management are also available.</span></span>

## <a name="use-x509-certificates"></a><span data-ttu-id="bd80c-159">Использование сертификата X.509.</span><span class="sxs-lookup"><span data-stu-id="bd80c-159">Use X.509 certificates</span></span>
<span data-ttu-id="bd80c-160">Кластеры всегда должны быть защищены с помощью сертификатов X.509 или службы безопасности Windows.</span><span class="sxs-lookup"><span data-stu-id="bd80c-160">Clusters should always be secured using X.509 certificates or Windows security.</span></span> <span data-ttu-id="bd80c-161">Безопасность настраивается только во время создания кластера. После этого ее невозможно включить.</span><span class="sxs-lookup"><span data-stu-id="bd80c-161">Security is only configured at cluster creation time and it is not possible to enable security after the cluster is created.</span></span>

<span data-ttu-id="bd80c-162">При указании [сертификата кластера](https://docs.microsoft.com/azure/service-fabric/service-fabric-windows-cluster-x509-security) задайте для параметра ClusterCredentialType значение X509.</span><span class="sxs-lookup"><span data-stu-id="bd80c-162">If you are specifying a [cluster certificate](https://docs.microsoft.com/azure/service-fabric/service-fabric-windows-cluster-x509-security), set the value of ClusterCredentialType to X509.</span></span> <span data-ttu-id="bd80c-163">При указании сертификата сервера для внешних соединений задайте для параметра ServerCredentialType значение X509.</span><span class="sxs-lookup"><span data-stu-id="bd80c-163">If you are specifying server certificate for outside connections, set the ServerCredentialType to X509.</span></span>

-   <span data-ttu-id="bd80c-164">Сертификаты, которые используются в кластерах, выполняющих рабочие нагрузки в рабочей среде, следует создать с помощью правильно настроенной службы сертификации Windows Server или получить из утвержденного центра сертификации.</span><span class="sxs-lookup"><span data-stu-id="bd80c-164">Certificates used in clusters running production workloads should be created by using a correctly configured Windows Server certificate service or obtained from an approved Certificate Authority (CA).</span></span>
-   <span data-ttu-id="bd80c-165">Никогда не используйте в рабочей среде какие-либо временные или тестовые сертификаты, созданные с помощью таких инструментов, как MakeCert.exe.</span><span class="sxs-lookup"><span data-stu-id="bd80c-165">Never use any temporary or test certificates in production that are created with tools such as MakeCert.exe.</span></span>
-   <span data-ttu-id="bd80c-166">Можно использовать самозаверяющий сертификат, но это следует делать только для тестовых кластеров, а не в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="bd80c-166">You can use a self-signed certificate, but should only do so for test clusters and not in production.</span></span>

<span data-ttu-id="bd80c-167">Этот кластер не защищен.</span><span class="sxs-lookup"><span data-stu-id="bd80c-167">If the cluster is unsecure.</span></span> <span data-ttu-id="bd80c-168">Любой пользователь может анонимно подключиться и выполнять операции управления, поэтому рабочие кластеры нужно обязательно защищать с помощью сертификатов X.509 или средств обеспечения безопасности Windows.</span><span class="sxs-lookup"><span data-stu-id="bd80c-168">Anyone can connect anonymously and perform management operations, so production clusters should always be secured using X.509 certificates or Windows security.</span></span>

<span data-ttu-id="bd80c-169">Дополнительные сведения о включении сертификатов в кластере Service Fabric см. в статье [Добавление и удаление сертификатов для кластера Service Fabric в Azure](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security-update-certs-azure).</span><span class="sxs-lookup"><span data-stu-id="bd80c-169">To learn more how to enable certificates in service fabric cluster see, [add or remove certificates for a service fabric cluster](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security-update-certs-azure).</span></span>

## <a name="configure-security-policies"></a><span data-ttu-id="bd80c-170">Настройка политик безопасности.</span><span class="sxs-lookup"><span data-stu-id="bd80c-170">Configure security policies</span></span>
<span data-ttu-id="bd80c-171">Кроме того, платформа помогает защищать ресурсы, используемые приложениями при развертывании с помощью учетных записей, например файлы, каталоги и сертификаты.</span><span class="sxs-lookup"><span data-stu-id="bd80c-171">Service Fabric also helps secure the resources that are used by applications at the time of deployment under the user accounts--for example, files, directories, and certificates.</span></span> <span data-ttu-id="bd80c-172">Это позволяет изолировать друг от друга выполняемые приложения, даже если они запущены в общей среде.</span><span class="sxs-lookup"><span data-stu-id="bd80c-172">This makes running applications, even in a shared hosted environment, more secure from one another.</span></span>

-   <span data-ttu-id="bd80c-173">Используйте группу доменов или пользователя Active Directory. Службу можно запустить с использованием учетных данных для учетной записи пользователя или группы Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bd80c-173">Use an Active Directory domain group or user: You can run the service under the credentials for an Active Directory user or group account.</span></span> <span data-ttu-id="bd80c-174">Речь идет о локальной службе Active Directory в домене, а не Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="bd80c-174">This is Active Directory on-premises within your domain and is not with Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="bd80c-175">С помощью пользователей или групп домена вы можете обращаться к другим ресурсам в домене (например, к общим файловым ресурсам), для которых предоставлены разрешения на доступ.</span><span class="sxs-lookup"><span data-stu-id="bd80c-175">By using a domain user or group, you can then access other resources in the domain (for example, file shares) that have been granted permissions.</span></span>

-   <span data-ttu-id="bd80c-176">Назначьте политику безопасности доступа для конечных точек HTTP и HTTPS. Если к службе применяется политика запуска от имени, а манифест службы объявляет в качестве ресурсов конечные точки, использующие протокол HTTP, вам нужно указать SecurityAccessPolicy. Это гарантирует, что к выделенным для этих конечных точек портам будут правильно применены списки управления доступом для той учетной записи, от имени которой выполняется служба.</span><span class="sxs-lookup"><span data-stu-id="bd80c-176">Assign a security access policy for HTTP and HTTPS endpoints: If you apply a RunAs policy to a service and the service manifest declares endpoint resources with the HTTP protocol, you must specify a SecurityAccessPolicy to ensure that ports allocated to these endpoints are correctly access-controlled listed for the RunAs user account that the service runs under.</span></span> <span data-ttu-id="bd80c-177">В противном случае файл http.sys не получит доступа к службе, а вызовы от клиента будут завершаться ошибками.</span><span class="sxs-lookup"><span data-stu-id="bd80c-177">Otherwise, http.sys does not have access to the service, and you get failures with calls from the client.</span></span>
<span data-ttu-id="bd80c-178">Дополнительные сведения о включении политики безопасности в Service Fabric см. в статье [Настройка политик безопасности для приложения](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-runas-security).</span><span class="sxs-lookup"><span data-stu-id="bd80c-178">To learn more enable security policies in service fabric see, [configure security policies for your application](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-runas-security).</span></span>

## <a name="reliable-actors-security-configuration"></a><span data-ttu-id="bd80c-179">Настройка безопасности с помощью Reliable Actors.</span><span class="sxs-lookup"><span data-stu-id="bd80c-179">Reliable Actors security configuration</span></span>
<span data-ttu-id="bd80c-180">Субъекты Reliable Actors Service Fabric — это реализация шаблона проектирования субъектов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-180">Service Fabric Reliable Actors is an implementation of the actor design pattern.</span></span> <span data-ttu-id="bd80c-181">Как и в случае с любым другим шаблоном проектирования программного обеспечения, решение о выборе того или иного шаблона зависит от того, соответствует ли он проблеме проектирования программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="bd80c-181">As with any software design pattern, the decision whether to use a specific pattern is made based on whether or not a software design problem fits the pattern.</span></span>

<span data-ttu-id="bd80c-182">В частности следует учесть, подойдет ли шаблон субъекта для моделирования проблемы или сценария, если:</span><span class="sxs-lookup"><span data-stu-id="bd80c-182">As general guidance, consider the actor pattern to model your problem or scenario if:</span></span>
-   <span data-ttu-id="bd80c-183">Проблемное пространство включает множество (тысячи и больше) небольших независимых и изолированных единиц состояния и логики.</span><span class="sxs-lookup"><span data-stu-id="bd80c-183">Your problem space involves a large number (thousands or more) of small, independent, and isolated units of state and logic.</span></span>
-   <span data-ttu-id="bd80c-184">Вы собираетесь работать с однопоточными объектами, которые не требуют значительного взаимодействия с внешними компонентами, включая запросы состояния в пределах определенного набора субъектов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-184">You want to work with single-threaded objects that do not require significant interaction from external components, including querying state across a set of actors.</span></span>
-   <span data-ttu-id="bd80c-185">Экземпляры субъекта не должны блокировать вызывающие объекты с непредсказуемыми задержками, выполняя операции ввода-вывода.</span><span class="sxs-lookup"><span data-stu-id="bd80c-185">Your actor instances won't block callers with unpredictable delays by issuing I/O operations.</span></span>

<span data-ttu-id="bd80c-186">В Service Fabric субъекты реализуются на платформе субъектов Reliable Actors: платформа приложений на основе шаблона субъекта опирается на [службы Reliable Services Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction).</span><span class="sxs-lookup"><span data-stu-id="bd80c-186">In Service Fabric, actors are implemented in the Reliable Actors framework: An actor-pattern-based application framework built on top of [Service Fabric Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction).</span></span> <span data-ttu-id="bd80c-187">Каждая написанный вами субъект Reliable Actor фактически представляет собой секционированную надежную службу Reliable Service с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="bd80c-187">Each Reliable Actor service you write is actually a partitioned, stateful Reliable Service.</span></span>
<span data-ttu-id="bd80c-188">Аналогично объектам .NET, которые являются экземплярами типа .NET, каждый субъект определяется как экземпляр типа субъекта.</span><span class="sxs-lookup"><span data-stu-id="bd80c-188">Every actor is defined as an instance of an actor type, identical to the way a .NET object is an instance of a .NET type.</span></span> <span data-ttu-id="bd80c-189">Предположим, есть тип субъекта, который реализует функции калькулятора, и есть много субъектов этого типа, распределенных по разным узлам кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-189">For example, there may be an actor type that implements the functionality of a calculator and there could be many actors of that type that are distributed on various nodes across a cluster.</span></span> <span data-ttu-id="bd80c-190">У каждого такого субъекта есть уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="bd80c-190">Each such actor is uniquely identified by an actor ID.</span></span>

<span data-ttu-id="bd80c-191">[Конфигурации безопасности репликаторов](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-kvsactorstateprovider-configuration) используются для защиты канала связи, который используется во время репликации.</span><span class="sxs-lookup"><span data-stu-id="bd80c-191">[Replicator security configurations](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-kvsactorstateprovider-configuration) are used to secure the communication channel that is used during replication.</span></span> <span data-ttu-id="bd80c-192">Это означает, что службы не будут "видеть" реплицируемый трафик друг друга, что позволит обеспечить высокую доступность и высокий уровень защиты.</span><span class="sxs-lookup"><span data-stu-id="bd80c-192">This means that services cannot see each other's replication traffic, ensuring that the data that is made highly available is also secure.</span></span> <span data-ttu-id="bd80c-193">По умолчанию пустой раздел конфигурации безопасности означает, что канал репликации не защищен.</span><span class="sxs-lookup"><span data-stu-id="bd80c-193">By default, an empty security configuration section prevents replication security.</span></span>
<span data-ttu-id="bd80c-194">Конфигурации репликатора используются для настройки репликатора, отвечающего за надежность состояний поставщика состояний субъекта.</span><span class="sxs-lookup"><span data-stu-id="bd80c-194">Replicator configurations configure the replicator that is responsible for making the Actor State Provider state highly reliable.</span></span>

## <a name="configure-ssl-for-azure-service-fabric"></a><span data-ttu-id="bd80c-195">Настройка SSL для Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="bd80c-195">Configure SSL for Azure Service Fabric</span></span>

<span data-ttu-id="bd80c-196">[Аутентификация сервера](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-via-arm) позволяет аутентифицировать конечные точки управления кластера в клиенте управления, чтобы он "знал", что обращается к настоящему кластеру.</span><span class="sxs-lookup"><span data-stu-id="bd80c-196">Server authentication: [Authenticates](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-via-arm) the cluster management endpoints to a management client, so that the management client knows it is talking to the real cluster.</span></span> <span data-ttu-id="bd80c-197">Этот сертификат также предоставляет [SSL](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-cluster-creation-via-arm) для API управления HTTPS и Service Fabric Explorer по протоколу HTTPS.</span><span class="sxs-lookup"><span data-stu-id="bd80c-197">This certificate also provides an [SSL](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-cluster-creation-via-arm) for the HTTPS management API and for Service Fabric Explorer over HTTPS.</span></span>
<span data-ttu-id="bd80c-198">Необходимо получить имя личного домена для кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-198">You must obtain a custom domain name for your cluster.</span></span> <span data-ttu-id="bd80c-199">При запросе сертификата из ЦС имя субъекта сертификата должно совпадать с именем личного домена, используемого для кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-199">When you request a certificate from a CA, the certificate's subject name must match the custom domain name that you use for your cluster.</span></span>

<span data-ttu-id="bd80c-200">Чтобы настроить протокол SSL для приложения, сначала необходимо получить SSL-сертификат, подписанный центром сертификации, то есть доверенным сторонним поставщиком, который выдает сертификаты для этой цели.</span><span class="sxs-lookup"><span data-stu-id="bd80c-200">To configure SSL for an application, you first need to get an SSL certificate that has been signed by a Certificate Authority (CA), a trusted third party who issues certificates for this purpose.</span></span> <span data-ttu-id="bd80c-201">Если у вас еще нет сертификата, нужно получить его в компании, продающей SSL-сертификаты.</span><span class="sxs-lookup"><span data-stu-id="bd80c-201">If you do not already have one, you need to obtain one from a company that sells SSL certificates.</span></span>

<span data-ttu-id="bd80c-202">Сертификат должен отвечать следующим требованиям для SSL-сертификатов в Azure:</span><span class="sxs-lookup"><span data-stu-id="bd80c-202">The certificate must meet the following requirements for SSL certificates in Azure:</span></span>
-   <span data-ttu-id="bd80c-203">Сертификат должен содержать закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="bd80c-203">The certificate must contain a private key.</span></span>
-   <span data-ttu-id="bd80c-204">Сертификат должен быть создан для обмена ключами, которые можно экспортировать в файл обмена личной информацией (PFX-файл).</span><span class="sxs-lookup"><span data-stu-id="bd80c-204">The certificate must be created for key exchange, exportable to a Personal Information Exchange (.pfx) file.</span></span>
-   <span data-ttu-id="bd80c-205">Имя субъекта сертификата должно совпадать с именем домена, которое используется для обращения к облачной службе.</span><span class="sxs-lookup"><span data-stu-id="bd80c-205">The certificate's subject name must match the domain used to access the cloud service.</span></span> <span data-ttu-id="bd80c-206">Не удается получить SSL-сертификат от центра сертификации (ЦС) в домене cloudapp.net.</span><span class="sxs-lookup"><span data-stu-id="bd80c-206">You cannot obtain an SSL certificate from a certificate authority (CA) for the cloudapp.net domain.</span></span> <span data-ttu-id="bd80c-207">Необходимо получить имя пользовательского домена для использования при получении доступа к службе.</span><span class="sxs-lookup"><span data-stu-id="bd80c-207">You must acquire a custom domain name to use when access your service.</span></span> <span data-ttu-id="bd80c-208">При запросе сертификата из ЦС имя субъекта сертификата должно соответствовать имени личного домена, который используется для доступа к вашему приложению.</span><span class="sxs-lookup"><span data-stu-id="bd80c-208">When you request a certificate from a CA, the certificate's subject name must match the custom domain name used to access your application.</span></span> <span data-ttu-id="bd80c-209">Например, если вы используете домен contoso.com, необходимо запросить сертификат из центра сертификации для **.contoso.com** или **www.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="bd80c-209">For example, if your custom domain name is contoso.com you would request a certificate from your CA for **.contoso.com** or **www.contoso.com.**</span></span>
-   <span data-ttu-id="bd80c-210">Сертификат должен использовать как минимум 2048-разрядное шифрование.</span><span class="sxs-lookup"><span data-stu-id="bd80c-210">The certificate must use a minimum of 2048-bit encryption.</span></span>

<span data-ttu-id="bd80c-211">Протокол HTTP — небезопасный и подвержен атакам с перехватом, так как данные передаются с веб-браузера на веб-сервер или между другими конечными точками в виде обычного текста.</span><span class="sxs-lookup"><span data-stu-id="bd80c-211">HTTP is insecure and is subject to eavesdropping attacks because the data being transferred from the web browser to the web server or between other endpoints, is transmitted in plaintext.</span></span> <span data-ttu-id="bd80c-212">Это означает, что злоумышленники могут перехватывать и просматривать конфиденциальные данные, такие как сведения о кредитной карте и учетных данных.</span><span class="sxs-lookup"><span data-stu-id="bd80c-212">This means attackers can intercept and view sensitive data, such as credit card details and account logins.</span></span> <span data-ttu-id="bd80c-213">При отправке или публикации данных с помощью браузера по протоколу HTTPS SSL обеспечивает шифрование таких сведений и их защиту от перехвата.</span><span class="sxs-lookup"><span data-stu-id="bd80c-213">When data is sent or posted through a browser using HTTPS, SSL ensures that such information is encrypted and secure from interception.</span></span>

<span data-ttu-id="bd80c-214">Дополнительные сведения см. в статье [Настройка SSL для приложения в Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-configure-ssl-certificate).</span><span class="sxs-lookup"><span data-stu-id="bd80c-214">To learn more, see, [Configure SSL for azure application](https://docs.microsoft.com/azure/cloud-services/cloud-services-configure-ssl-certificate).</span></span>

## <a name="network-isolationsecurity-with-azure-service-fabric"></a><span data-ttu-id="bd80c-215">Обеспечение сетевой изоляции и безопасности с помощью Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="bd80c-215">Network Isolation/Security with Azure Service Fabric</span></span>
<span data-ttu-id="bd80c-216">Используйте [шаблон Azure Resource Manager (ARM)](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-authoring-templates) как пример для настройки трех безопасных кластеров типа узла и управления входящим и исходящим сетевым трафиком с помощью групп безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="bd80c-216">Use [Azure Resource Manager (ARM) template](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-authoring-templates) as a sample for setting up a three nodetype secure cluster and to control the inbound and outbound network traffic using Network Security Groups.</span></span>

<span data-ttu-id="bd80c-217">Шаблон содержит по одной группе безопасности сети для каждого масштабируемого набора виртуальных машин для управления входящим и исходящим трафиком масштабируемого набора виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="bd80c-217">The template has a Network Security Group for each of the virtual machine scale set(VMSS) to control the traffic in and out of the VMSS.</span></span> <span data-ttu-id="bd80c-218">По умолчанию правила настраиваются на разрешение всего трафика, необходимого системным службам и приложениям портов, указанным в шаблоне.</span><span class="sxs-lookup"><span data-stu-id="bd80c-218">As a default, the rules are set up to allow all the traffic needed by the system services and the application ports specified in the template.</span></span> <span data-ttu-id="bd80c-219">Просмотрите эти правила и измените их в соответствии со своими потребностями, включая добавление новых правил для приложений.</span><span class="sxs-lookup"><span data-stu-id="bd80c-219">Review those rules and make changes to fit your needs, including add any new ones for your applications.</span></span>

<span data-ttu-id="bd80c-220">Дополнительные сведения см. в статье [Схемы сетевых подключений Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-patterns-networking).</span><span class="sxs-lookup"><span data-stu-id="bd80c-220">For more information, see [Azure Service Fabric – Common Networking Scenarios](https://docs.microsoft.com/azure/service-fabric/service-fabric-patterns-networking).</span></span>

## <a name="set-up-a-key-vault-for-security"></a><span data-ttu-id="bd80c-221">Настройка хранилища ключей для обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="bd80c-221">Set up a key vault for security</span></span>
<span data-ttu-id="bd80c-222">Сертификаты используются в Service Fabric, чтобы обеспечить функции аутентификации и шифрования для защиты различных аспектов кластера и его приложений.</span><span class="sxs-lookup"><span data-stu-id="bd80c-222">Certificates are used in Service Fabric to provide authentication and encryption to secure various aspects of a cluster and its applications.</span></span>

<span data-ttu-id="bd80c-223">Service Fabric использует сертификаты X.509 для защиты кластера и обеспечения функций безопасности приложений.</span><span class="sxs-lookup"><span data-stu-id="bd80c-223">Service Fabric uses X.509 certificates to secure a cluster and provide application security features.</span></span> <span data-ttu-id="bd80c-224">Key Vault используется для [управления сертификатами](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security-update-certs-azure) кластеров Service Fabric в Azure.</span><span class="sxs-lookup"><span data-stu-id="bd80c-224">You use Key Vault to [manage certificates](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security-update-certs-azure) for Service Fabric clusters in Azure.</span></span> <span data-ttu-id="bd80c-225">При развертывании кластера в Azure поставщик ресурсов Azure, ответственный за создание кластеров Service Fabric, извлекает сертификаты из Key Vault и устанавливает их на виртуальные машины кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-225">When a cluster is deployed in Azure, the Azure resource provider that's responsible for creating Service Fabric clusters pulls certificates from Key Vault and installs them on the cluster VMs.</span></span>

<span data-ttu-id="bd80c-226">Между [Azure Key Vault](https://docs.microsoft.com/azure/key-vault/key-vault-secure-your-key-vault), кластером Service Fabric и поставщиком ресурсов Azure, который использует сертификаты из Key Vault при создании кластера, устанавливается связь.</span><span class="sxs-lookup"><span data-stu-id="bd80c-226">The relationship between [Azure Key Vault](https://docs.microsoft.com/azure/key-vault/key-vault-secure-your-key-vault), a service fabric cluster, and the Azure resource provider that uses certificates stored in a key vault when it creates a cluster.</span></span>

<span data-ttu-id="bd80c-227">**Создание группы ресурсов.** Первый шаг — создание группы ресурсов специально для хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="bd80c-227">**Create a resource group** The first step is to create a resource group specifically for your key vault.</span></span> <span data-ttu-id="bd80c-228">Рекомендуется поместить хранилище ключей в собственной группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-228">We recommend that you put the key vault into its own resource group.</span></span> <span data-ttu-id="bd80c-229">Так вы сможете удалять группы ресурсов для вычислений и хранения, включая группу ресурсов, в которой размещен кластер Service Fabric, без потери ключей и секретов.</span><span class="sxs-lookup"><span data-stu-id="bd80c-229">This action lets you remove the compute and storage resource groups, including the resource group that contains your Service Fabric cluster, without losing your keys and secrets.</span></span> <span data-ttu-id="bd80c-230">Группа ресурсов с хранилищем ключей должна находиться в том же регионе, что и кластер, который ее использует.</span><span class="sxs-lookup"><span data-stu-id="bd80c-230">The resource group that contains your key vault must be in the same region as the cluster that is using it.</span></span>

<span data-ttu-id="bd80c-231">**Создание хранилища ключей в новой группе ресурсов.** Хранилище ключей должно быть доступно для развернутой службы. Это позволит поставщику вычислительных ресурсов получить из него сертификаты и установить их на экземплярах виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="bd80c-231">**Create a key vault in the new resource group** The key vault must be enabled for deployment to allow the compute resource provider to get certificates from it and install it on virtual machine instances.</span></span>
<span data-ttu-id="bd80c-232">Дополнительные сведения о настройке Azure Key Vault см. в статье [Приступая к работе с хранилищем ключей Azure](https://docs.microsoft.com/azure/key-vault/key-vault-get-started).</span><span class="sxs-lookup"><span data-stu-id="bd80c-232">To learn more how to set up Azure key vault see, [Get started with Azure Key Vault](https://docs.microsoft.com/azure/key-vault/key-vault-get-started).</span></span>

## <a name="assign-users-roles"></a><span data-ttu-id="bd80c-233">Назначение ролей пользователей</span><span class="sxs-lookup"><span data-stu-id="bd80c-233">Assign users roles</span></span>
<span data-ttu-id="bd80c-234">Создав приложения, представляющие кластер, сопоставьте пользователей с ролями, поддерживаемыми Service Fabric и разрешающими доступ на чтение и администрирование. Роли можно назначить с помощью классического портала Azure.</span><span class="sxs-lookup"><span data-stu-id="bd80c-234">After you have created the applications to represent your cluster, assign your users to the roles supported by Service Fabric: read-only and admin. You can assign the roles by using the Azure classic portal.</span></span>

>[!Note]
> <span data-ttu-id="bd80c-235">Дополнительные сведения о ролях в Service Fabric см. в статье [Контроль доступа на основе ролей для клиентов Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security-roles).</span><span class="sxs-lookup"><span data-stu-id="bd80c-235">For more information about roles in Service Fabric, see [Role-based access control for Service Fabric clients](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-security-roles).</span></span>

<span data-ttu-id="bd80c-236">Платформа Azure Service Fabric поддерживает два разных типа контроля доступа для клиентов, подключенных к [кластеру Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-via-arm): администраторский и пользовательский.</span><span class="sxs-lookup"><span data-stu-id="bd80c-236">Azure Service Fabric supports two different access control types for clients that are connected to a [Service Fabric cluster](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-via-arm): administrator and user.</span></span> <span data-ttu-id="bd80c-237">Благодаря контролю доступа администратор кластера может ограничить доступ разных групп пользователей на выполнение определенных операций в кластере, повысив тем самым уровень безопасности кластера.</span><span class="sxs-lookup"><span data-stu-id="bd80c-237">Access control allows the cluster administrator to limit access to certain cluster operations for different groups of users, making the cluster more secure.</span></span>

## <a name="next-steps"></a><span data-ttu-id="bd80c-238">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="bd80c-238">Next steps</span></span>
- <span data-ttu-id="bd80c-239">Настройка [среды разработки](https://docs.microsoft.com/azure/service-fabric/service-fabric-get-started).</span><span class="sxs-lookup"><span data-stu-id="bd80c-239">Setting up your Service Fabric [development environment](https://docs.microsoft.com/azure/service-fabric/service-fabric-get-started).</span></span>
- <span data-ttu-id="bd80c-240">Узнайте о [вариантах поддержки Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-support).</span><span class="sxs-lookup"><span data-stu-id="bd80c-240">Learn about [Service Fabric support options](https://docs.microsoft.com/azure/service-fabric/service-fabric-support).</span></span>

