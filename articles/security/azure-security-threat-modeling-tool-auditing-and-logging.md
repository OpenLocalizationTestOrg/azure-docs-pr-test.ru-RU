---
title: "aaaAuditing и ведения журнала — Microsoft средства моделирования угроз - Azure | Документы Microsoft"
description: "защиту от угроз, которые представлены в hello средства моделирования угроз"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: f28988833eba251b6ceb8bbd47cde37e871af609
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="security-frame-auditing-and-logging--mitigations"></a>Механизм безопасности. Аудит и ведение журналов | Устранение проблем 
| Продукт или служба | Статья |
| --------------- | ------- |
| **Dynamics CRM**    | <ul><li>[Определение конфиденциальных сущностей в решении и реализация аудита изменений](#sensitive-entities)</li></ul> |
| **Веб-приложение** | <ul><li>[Убедитесь, что аудит и ведение журнала будет применена на приложения hello](#auditing)</li><li>[Проверка разделения и чередования журналов](#log-rotation)</li><li>[Убедитесь, что приложение hello не записывает в журнал конфиденциальные пользовательские данные](#log-sensitive-data)</li><li>[Проверка ограниченного доступа к функциям аудита и ведения журнала](#log-restricted-access)</li><li>[Проверка записи в журнал событий управления пользователями](#user-management)</li><li>[Убедитесь, что система hello имеет встроенных защиту от несанкционированного использования](#inbuilt-defenses)</li><li>[Включение ведения журнала диагностики для веб-приложений в службе приложений Azure](#diagnostics-logging)</li></ul> |
| **База данных** | <ul><li>[Проверка включения на сервере SQL Server аудита входа в систему](#identify-sensitive-entities)</li><li>[Включение обнаружения угроз в Azure SQL](#threat-detection)</li></ul> |
| **Хранилище Azure** | <ul><li>[Используйте доступ tooaudit аналитики хранилища Azure хранилища Azure](#analytics)</li></ul> |
| **WCF** | <ul><li>[Реализация надлежащего ведения журнала](#sufficient-logging)</li><li>[Реализация надлежащей обработки сбоя аудита](#audit-failure-handling)</li></ul> |
| **Веб-интерфейс API** | <ul><li>[Проверка принудительного применения аудита и ведения журнала в веб-API](#logging-web-api)</li></ul> |
| **Полевой шлюз Интернета вещей** | <ul><li>[Проверка включения надлежащих аудита и ведения журнала в полевом шлюзе](#logging-field-gateway)</li></ul> |
| **Облачный шлюз Интернета вещей** | <ul><li>[Проверка включения надлежащих аудита и ведения журнала в облачном шлюзе](#logging-cloud-gateway)</li></ul> |

## <a id="sensitive-entities"></a>Определение конфиденциальных сущностей в решении и реализация аудита изменений

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Dynamics CRM | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | Определите в решении сущности с конфиденциальными данными и реализуйте аудит изменений в этих сущностях и полях. |

## <a id="auditing"></a>Убедитесь, что аудит и ведение журнала будет применена на приложения hello

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | Включите аудит и ведение журнала во всех компонентах. Журналы аудита должны записывать контекст пользователя. Определите все важные события для их регистрации в журнале. Реализуйте централизованное ведение журнала. |

## <a id="log-rotation"></a>Проверка разделения и чередования журналов

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | <p>Чередование журналов — автоматизированный процесс, используемый в системном администрировании при архивации устаревших файлов журналов. Серверы, которые часто выполняются большие приложения регистрировать каждый запрос: шрифтом hello объемный журналов Смена журнала — hello toolimit как общий размер журналов hello, но позволяет анализ последние события. </p><p>Разделение журнала по существу означает, что toostore файлы журнала в раздел, отличный от ОС и приложения запущенным в порядке tooavert отказ в обслуживании атак или hello понижения версии приложения его производительность</p>|

## <a id="log-sensitive-data"></a>Убедитесь, что приложение hello не записывает в журнал конфиденциальные пользовательские данные

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | <p>Проверьте, не регистрировать все конфиденциальные данные, что пользователь отправляет tooyour сайта. Проверьте, не настроено ли ведение журнала, а также нет ли каких-либо побочных эффектов, вызванных недостатками разработки. К конфиденциальным данным относятся:</p><ul><li>учетные данные пользователя;</li><li>номер социального страхования и другие идентификационные сведения;</li><li>номера кредитных карт и другие финансовые сведения;</li><li>сведения о работоспособности;</li><li>Закрытые ключи или других данных, которую можно использовать toodecrypt зашифрованных данных</li><li>Сведения системы или приложения, который может использоваться toomore эффективно атак приложения hello</li></ul>|

## <a id="log-restricted-access"></a>Проверка ограниченного доступа к функциям аудита и ведения журнала

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | <p>Проверьте, что соответствующим образом настроены права toolog tooensure доступа к файлам. Учетным записям приложения следует назначить доступ только для записи, а доступ только для чтения должен быть назначен (при необходимости) операторам и сотрудникам службы поддержки.</p><p>Учетные записи администраторов являются hello только учетные записи, которые должна иметь полный доступ. Убедитесь, что правильно ограничен tooensure файлы Windows ACL для журнала:</p><ul><li>Учетные записи приложений должны иметь доступ только для записи.</li><li>Операторам и сотрудникам службы поддержки при необходимости должен быть предоставлен доступ только для чтения.</li><li>Администраторы — hello только учетные записи, которые должны иметь полный доступ</li></ul>|

## <a id="user-management"></a>Проверка записи в журнал событий управления пользователями

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | <p>Убедитесь, что приложения hello наблюдает за событиями управления пользователя, такие как успешные и неудачные имена входа, сброс паролей, изменения пароля, блокировка учетной записи, регистрации пользователей. Это помогает toodetect и реагировать toopotentially подозрительное поведение. Она также позволяет toogather рабочие данные; Например tootrack, который загружает приложения hello</p>|

## <a id="inbuilt-defenses"></a>Убедитесь, что система hello имеет встроенных защиту от несанкционированного использования

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия**                   | <p>Должны присутствовать элементы управления, которые выдают исключения системы безопасности в случае несанкционированного использования приложения. Например если выполняется проверка ввода и злоумышленник пытается tooinject вредоносный код, который не соответствует hello regex, может быть исключение безопасности может принимать это указывает на неправильное использование системы</p><p>Например рекомендуется toohave безопасности исключения в журнал и действия, выполняемые для hello следующих ситуаций:</p><ul><li>проверок входных данных;</li><li>нарушений CSRF;</li><li>атак методом подбора (верхний лимит для числа запросов на пользователя на ресурс);</li><li>нарушений отправки файлов.</li><ul>|

## <a id="diagnostics-logging"></a>Включение ведения журнала диагностики для веб-приложений в службе приложений Azure

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | EnvironmentType: Azure |
| **Справочные материалы**              | Недоступно  |
| **Действия** | <p>Azure предоставляет tooassist встроенных средств диагностики в процессе отладки службы приложения веб-приложения. Это также относится tooAPI приложений и мобильных приложений. Веб-приложения служб приложений предоставляют диагностических функций для записи в журнал из hello веб-сервер и веб-приложения hello.</p><p>Используется следующее логическое разделение: диагностика веб-сервера и диагностика приложений.</p>|

## <a id="identify-sensitive-entities"></a>Проверка включения на сервере SQL Server аудита входа в систему

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Настройка аудита входа в систему](https://msdn.microsoft.com/library/ms175850.aspx) |
| **Действия** | <p>Аудит входа в систему сервера базы данных должен быть включен toodetect/подтверждение пароля атак. Очень важно toocapture неудавшихся попыток. Запись успешных и неудачных попыток входа предоставляет дополнительные преимущества во время судебного разбирательства.</p>|

## <a id="threat-detection"></a>Включение обнаружения угроз в Azure SQL

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | SQL Azure |
| **Атрибуты**              | Версия SQL: 12 |
| **Справочные материалы**              | [Get Started with SQL Database Threat Detection](https://azure.microsoft.com/documentation/articles/sql-database-threat-detection-get-started/) (Приступая к работе с системой обнаружения угроз базы данных SQL)|
| **Действия** |<p>Обнаружение угроз обнаруживает аномальные действия базы данных, указывающее базу данных toohello потенциальные угрозы безопасности. Он обеспечивает новый уровень безопасности, которая позволяет клиентам toodetect и отвечать toopotential угроз, как только они происходят, предоставляя предупреждения системы безопасности о подозрительной активности.</p><p>Пользователи могут исследовать hello подозрительных событий с помощью Azure аудита базы данных SQL toodetermine, если они являются результатом tooaccess попытки нарушения или воспользоваться hello базы данных.</p><p>Обнаружение угроз база данных он простой tooaddress потенциальных угроз toohello без необходимости hello toobe специалист по безопасности или управлять повышенной безопасности, контроль различных систем</p>|

## <a id="analytics"></a>Используйте доступ tooaudit аналитики хранилища Azure хранилища Azure

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Хранилище Azure | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно |
| **Справочные материалы**              | [С помощью типа авторизации toomonitor аналитики хранилища](https://azure.microsoft.com/documentation/articles/storage-security-guide/#storage-analytics) |
| **Действия** | <p>Для каждой учетной записи хранения одно tooperform ведение журнала службы аналитики хранилища Azure и хранения данных метрик. Hello журналы аналитики хранилища содержатся важные сведения, такие как метод проверки подлинности, используемый другим при доступе к хранилища.</p><p>Это может быть весьма полезно в том случае, если тесно защищая toostorage доступа. Например в хранилище больших двоичных объектов можно задать все контейнеры tooprivate hello и реализован hello используйте службы SAS в приложениях. Затем можно проверить журналы hello регулярно toosee Если BLOB-объектов осуществляется с помощью hello ключи учетной записи хранения, которые могут указывать на нарушение безопасности, или если hello большие двоичные объекты являются открытыми, но они не должны быть.</p>|

## <a id="sufficient-logging"></a>Реализация надлежащего ведения журнала

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | .NET Framework |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify Kingdom](https://vulncat.fortify.com/en/vulncat/index.html) |
| **Действия** | <p>отсутствие Hello правильную аудита после угрозы безопасности может помешать судебных усилий. Windows Communication Foundation (WCF) предлагает hello возможность toolog успешных и неудачных попыток пройти проверку подлинности.</p><p>Использование журнала неудачных попыток аутентификации поможет администраторам узнать о потенциальных атаках методом подбора. Аналогично, ведение журнала событий успешной аутентификации позволяет получить полезные данные аудита при компрометации подлинной учетной записи. Включите функцию аудита безопасности WCF. |

### <a name="example"></a>Пример
Hello ниже приведен пример конфигурации при включении аудита
```
<system.serviceModel>
    <behaviors>
        <serviceBehaviors>
            <behavior name=""NewBehavior"">
                <serviceSecurityAudit auditLogLocation=""Default""
                suppressAuditFailure=""false"" 
                serviceAuthorizationAuditLevel=""SuccessAndFailure""
                messageAuthenticationAuditLevel=""SuccessAndFailure"" />
                ...
            </behavior>
        </servicebehaviors>
    </behaviors>
</system.serviceModel>
```

## <a id="audit-failure-handling"></a>Реализация надлежащей обработки сбоя аудита

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | .NET Framework |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify Kingdom](https://vulncat.fortify.com/en/vulncat/index.html) |
| **Действия** | <p>Настроить разработанного решения toogenerate исключение при сбое журнала аудита tooan toowrite. Если настроен WCF toothrow исключение после журнала аудита tooan toowrite невозможно, программа hello не будет уведомлен сбоя hello и аудит событий безопасности не будет выполняться.</p>|

### <a name="example"></a>Пример
Hello `<behavior/>` ниже файла конфигурации WCF hello указывает WCF toonot уведомления приложения hello, сбое журнала аудита tooan toowrite WCF.
````
<behaviors>
    <serviceBehaviors>
        <behavior name="NewBehavior">
            <serviceSecurityAudit auditLogLocation="Application"
            suppressAuditFailure="true"
            serviceAuthorizationAuditLevel="Success"
            messageAuthenticationAuditLevel="Success" />
        </behavior>
    </serviceBehaviors>
</behaviors>
````
Настройте программу hello toonotify WCF, каждый раз, когда используется журнал аудита tooan toowrite невозможно. Программа Hello должен иметь схему альтернативных уведомления в месте tooalert hello организации, что журналы аудита не поддерживается. 

## <a id="logging-web-api"></a>Проверка принудительного применения аудита и ведения журнала в веб-API

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-интерфейс API | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Включите аудит и ведение журнала в веб-API. Журналы аудита должны записывать контекст пользователя. Определите все важные события для их регистрации в журнале. Реализуйте централизованное ведение журнала. |

## <a id="logging-field-gateway"></a>Проверка включения надлежащих аудита и ведения журнала в полевом шлюзе

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Полевой шлюз Интернета вещей | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | <p>При подключении нескольких устройства tooa шлюз поля, убедитесь, что попытки подключения и состояния проверки подлинности (успех или сбой) для отдельных устройств в журнал и сохраняется на hello шлюз поля.</p><p>Кроме того, в случаях, когда шлюз поля входит поддержка hello центра IoT учетные данные для отдельных устройств, убедитесь, что аудит выполняется, когда эти учетные данные будут получены. Разработка процесса tooperiodically передачи hello журналы tooAzure центр IoT и хранилища для долговременного хранения.</p> |

## <a id="logging-cloud-gateway"></a>Проверка включения надлежащих аудита и ведения журнала в облачном шлюзе

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Облачный шлюз Интернета вещей | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Наблюдение за операции концентратора tooIoT введение](https://azure.microsoft.com/documentation/articles/iot-hub-operations-monitoring/) |
| **Действия** | <p>Разработайте процесс сбора и хранения данных аудита, собранных в ходе мониторинга операций Центра Интернета вещей. Включите следующие категории мониторинга hello:</p><ul><li>Операции с удостоверениями устройства</li><li>обмен данными между устройством и облаком;</li><li>обмен данными между облаком и устройством;</li><li>Подключения</li><li>Передача файлов</li></ul>|
