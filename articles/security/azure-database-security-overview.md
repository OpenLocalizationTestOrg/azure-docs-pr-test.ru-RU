---
title: "Общие сведения о защите базы данных Azure | Документы Майкрософт"
description: "В этой статье приведено краткое описание основных функций безопасности базы данных Azure."
services: security
documentationcenter: na
author: UnifyCloud
manager: swadhwa
editor: TomSh
ms.assetid: 
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/01/2017
ms.author: TomSh
ms.openlocfilehash: 3c83645f61cd42c8c2b46f787c9e7531726d3fbb
ms.sourcegitcommit: d41d9049625a7c9fc186ef721b8df4feeb28215f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2017
---
# <a name="azure-database-security-overview"></a>Общие сведения о защите базы данных Azure

При управлении базами данных безопасность имеет первостепенное значение и всегда была приоритетной задачей для базы данных SQL Azure. База данных SQL Azure поддерживает безопасность подключения с помощью шифрования соединения и правил брандмауэра. Она поддерживает проверку подлинности с именем пользователя и паролем, а также проверку подлинности Azure Active Directory, в которой используются удостоверения, контролируемые Azure Active Directory. Проверка подлинности использует управление доступом на основе ролей.

База данных SQL Azure выполняет шифрование и дешифровку базы данных, связанных резервных копий и неактивных файлов журналов транзакций в реальном времени без необходимости изменения приложения.

Корпорация Майкрософт предоставляет дополнительные возможности для шифрования корпоративных данных:

-   Шифрование на уровне ячейки для шифрования определенных столбцов или даже ячеек данных с использованием разных ключей шифрования.
-   Если требуется аппаратный модуль безопасности или централизованное управление иерархией ключей шифрования, используйте Azure Key Vault с сервером SQL Server на виртуальной машине Azure.
-   Always Encrypted (сейчас в предварительной версии) делает шифрование прозрачным для приложений и позволяет клиентам шифровать конфиденциальные данные внутри клиентских приложений без совместного использования ключей шифрования с базой данных SQL.

Аудит базы данных SQL Azure позволяет организациям записывать события аудита для отслеживания событий входа службы хранилища Azure. Кроме того, благодаря интеграции аудита Базы данных SQL с Microsoft Power BI обеспечиваются упрощенное создание подробных отчетов и проведение детализированного анализа.

 Вы можете обеспечить надежную защиту баз данных SQL Azure, чтобы удовлетворить большинству нормативных требований и требований безопасности, включая, помимо прочих, стандарты HIPAA, ISO 27001/27002 и PCI DSS (уровень 1). Текущий список сертификатов соответствия требованиям безопасности доступен на [сайте Центра управления безопасностью Microsoft Azure](http://azure.microsoft.com/support/trust-center/services/).

В этой статье рассматриваются основные принципы защиты баз данных SQL Microsoft Azure для структурированных, табличных и реляционных данных. В частности, эта статья содержит инструкции по началу работы с ресурсами для защиты данных, контроля доступа и упреждающего мониторинга.

В этой статье с обзором безопасности баз данных Azure рассматриваются следующие вопросы:

-   Защита данных
-   управление доступом;
-   Упреждающий мониторинг
-   Централизованное управление защитой
-   Azure Marketplace

## <a name="protect-data"></a>Защита данных

База данных SQL обеспечивает защиту данных, шифруя передаваемые данные с использованием протокола [TLS](https://support.microsoft.com/kb/3135244), неактивные данные с использованием [прозрачного шифрования данных](http://go.microsoft.com/fwlink/?LinkId=526242) и используемые данные с помощью функции [Always Encrypted](https://msdn.microsoft.com/library/mt163865.aspx).

В этом разделе будут освещены следующие вопросы:

-   Шифрование при передаче
-   Шифрование при хранении
-   Шифрование при использовании (клиент)

Другие способы шифрования данных включают следующее:

-   [Шифрование на уровне ячейки](https://msdn.microsoft.com/library/ms179331.aspx) для шифрования определенных столбцов или даже ячеек данных с использованием разных ключей шифрования.
-   Если требуется аппаратный модуль безопасности или централизованное управление иерархии ключей шифрования, рассмотрите возможность использования [хранилища ключей Azure с сервером SQL Server на виртуальной машине Azure](http://blogs.technet.com/b/kv/archive/2015/01/12/using-the-key-vault-for-sql-server-encryption.aspx).

### <a name="encryption-in-motion"></a>Шифрование при передаче

Распространенной проблемой для всех клиентских и серверных приложений является необходимость конфиденциальности при передаче данных в общедоступных и частных сетях. Если данные, передаваемые по сети, не зашифрованы, эти данные могут быть перехвачены и украдены посторонними лицами. При работе со службами базы данных необходимо убедиться, что данные между сервером и клиентом базы данных, а также данные между серверами баз данных, которые взаимодействуют друг с другом и с приложениями среднего уровня, шифруются.

Одна из проблем при администрировании сети заключается в обеспечении безопасности данных, которые передаются между приложениями по ненадежной сети. Для проверки подлинности серверов и клиентов и шифрования сообщений между клиентом и сервером, прошедшими проверку подлинности, можно использовать протокол [TLS/SSL](https://docs.microsoft.com/windows-server/security/tls/transport-layer-security-protocol).

При проверке подлинности клиент TLS/SSL отправляет сообщение серверу TLS/SSL, и сервер в ответ отправляет сообщение о том, что сервер должен пройти проверку подлинности. Клиент и сервер выполняют дополнительный обмен сеансовыми ключами, и диалог проверки подлинности завершается. После завершения проверки подлинности между клиентом и сервером можно установить обмен данными по защищенному протоколу SSL с использованием симметричных ключей шифрования, которые формируются во время проверки подлинности.

Во время каждого сеанса передачи данных в Базу данных SQL Azure и из нее все подключения к базе должны быть зашифрованы (SSL/TLS). SQL Azure использует протокол TLS/SSL для проверки подлинности серверов и клиентов, а затем использует его для шифрования сообщений между сторонами, прошедшими проверку подлинности. В строке подключения приложения необходимо настроить параметры шифрования подключения, а также указать отсутствие доверия для сертификата сервера (это происходит автоматически при копировании строки подключения с портала Azure), в противном случае подключение не будет проверять подлинность сервера и будет уязвимо для атак "злоумышленник в середине". Например, для драйвера ADO.NET это параметры строки подключения Encrypt=True и TrustServerCertificate=False.

### <a name="encryption-at-rest"></a>Шифрование при хранении
Можно принять ряд мер предосторожности для защиты базы данных, таких как проектирование безопасной системы, шифрование конфиденциальных ресурсов и создание брандмауэра на серверах базы данных. Однако в случае похищения физического носителя (например, дисков или лент с резервными копиями) злоумышленник может просто восстановить или подключить базу данных и просмотреть данные.

Одним из решений этой проблемы является шифрование конфиденциальных данных в базе данных и защита ключей, которые используются для шифрования, с помощью сертификата. Это не позволит никому использовать данные без ключей, но такой тип защиты следует планировать заранее.

Для решения этой проблемы SQL Server и база данных SQL Azure поддерживают [прозрачное шифрование данных (TDE)](https://docs.microsoft.com/sql/relational-databases/securityrecryption/transparent-data-encryption-tde). При прозрачном шифровании данных шифруются файлы данных SQL Server и базы данных SQL Azure. Это так называемое шифрование неактивных данных.

Прозрачное шифрование данных в базе данных SQL Azure помогает защитить базу данных от доступа злоумышленников. Для этого в реальном времени выполняется шифрование и расшифровка баз данных, связанных резервных копий и неактивных файлов журналов транзакций без необходимости изменения приложения.  

При использовании TDE хранилище всей базы данных шифруется с помощью симметричного ключа, который называется ключом шифрования базы данных. В базе данных SQL ключ шифрования базы данных защищается встроенным сертификатом сервера. Каждый сервер Базы данных SQL обладает уникальным встроенным сертификатом.

Если база данных находится в отношении GeoDR, она защищается различными ключами на разных серверах. Если две базы данных подключены к одному и тому же серверу, то они совместно используют один встроенный сертификат. Корпорация Майкрософт автоматически изменяет эти сертификаты не реже, чем раз в 90 дней. Общие сведения о прозрачном шифровании данных см. в [этой статье](https://docs.microsoft.com/sql/relational-databases/security/encryption/transparent-data-encryption-tde).

### <a name="encryption-in-use-client"></a>Шифрование при использовании (клиент)

Большинство утечек данных происходят из-за кражи критически важных данных, таких как номера кредитных карт или персональные данные. Базы данных могут содержать ценные конфиденциальные данные. Они могут содержать персональные данные заказчиков, конфиденциальную информацию о конкурентах и сведения, представляющие интеллектуальную собственность. Потеря или кража данных, особенно данных клиентов, могут привести к ущербу для бренда, утрате преимущества перед конкурентами, серьезным штрафам и даже судебным искам.

![Постоянное шифрование](./media/azure-databse-security-overview/azure-database-fig1.png)

Функция [Always Encrypted](https://msdn.microsoft.com/library/mt163865.aspx) предназначена для защиты конфиденциальных данных, таких как номера кредитных карт и номеров национальной идентификации (например, номера социального страхования США), которые хранятся в базах данных SQL Server и базах данных SQL Azure. Always Encrypted позволяет клиентам шифровать конфиденциальные данные в приложениях, не раскрывая ключи шифрования в ядре СУБД (база данных SQL или SQL Server).

Always Encrypted разделяет пользователей на владельцев данных (которые могут просматривать данные) и управляющих данными (у которых не должно быть доступа к данным). Администраторы локальных баз данных, операторы облачных баз данных и другие пользователи с высоким уровнем привилегий, не прошедшие проверку подлинности, не имеют доступа к зашифрованным данным.

Кроме того, функция Always Encrypted делает шифрование прозрачным для приложений. На клиентском компьютере установлен драйвер с поддержкой Always Encrypted. Это позволяет приложению автоматически шифровать и дешифровать конфиденциальные данные в клиентском приложении. Драйвер шифрует данные из конфиденциальных столбцов перед их передачей в ядро СУБД и автоматически переписывает запросы, чтобы сохранить семантику приложения. Аналогичным образом драйвер прозрачно расшифровывает данные, которые хранятся в зашифрованных столбцах базы данных в результатах запроса.

## <a name="access-control"></a>управление доступом;
Чтобы обеспечить безопасность, база данных SQL управляет доступом с помощью правил брандмауэра, ограничивающих подключение по IP-адресу, механизмов проверки подлинности, требующих удостоверений пользователей, и методов авторизации, ограничивающих действия и данные для пользователей.

### <a name="database-access"></a>Доступ к базе данных

Защита данных начинается с контроля доступа к данным. Центр обработки данных, в котором размещены ваши данные, управляет физическим доступом к данным. Вы можете настроить брандмауэр для управления безопасностью на уровне сети. Вы также можете управлять доступом, настроив имена входа для проверки подлинности и задав разрешения для ролей сервера и базы данных.

В этом разделе будут освещены следующие вопросы:

-   Брандмауэр и правила брандмауэра
-   Аутентификация
-   Авторизация

#### <a name="firewall-and-firewall-rules"></a>Брандмауэр и правила брандмауэра

База данных SQL Microsoft Azure предоставляет службу реляционных баз данных для Azure и других интернет-приложений. Чтобы защитить ваши данные, брандмауэр запрещает любой доступ к серверу базы данных, пока вы не укажете компьютеры, у которых есть разрешение на доступ. Брандмауэр предоставляет доступ к базам данным на основе исходного IP-адреса каждого запроса. Дополнительные сведения см. в статье [Обзор правил брандмауэра базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure).

Служба [базы данных SQL Azure](https://azure.microsoft.com/services/sql-database/) доступна только на TCP-порте 1433. Для получения доступа к базе данных Azure со своего компьютера убедитесь, что брандмауэр клиентского компьютера пропускает исходящие подключения по протоколу TCP через порт 1433. Заблокируйте входящие подключения по протоколу TCP через порт 1433, если они не требуются для других приложений.

#### <a name="authentication"></a>Аутентификация

В процессе проверки подлинности базы данных SQL предлагается подтвердить личность пользователя при подключении к базе данных. База данных SQL поддерживает два типа аутентификации:

-   **Проверка подлинности SQL:** при создании логического экземпляра SQL создается единая учетная запись, которая называется учетной записью подписчика базы данных SQL. Эта учетная запись используется для подключения [с использованием проверки подлинности SQL Server](https://docs.microsoft.com/azure/sql-database/sql-database-security-overview) (с помощью имени пользователя и пароля). Эта учетная запись является администратором для экземпляра логического сервера, а также для всех пользовательских баз данных, присоединенных к этому экземпляру. Разрешения учетной записи подписчика нельзя ограничить. Может существовать только одна такая учетная запись.
-   **Проверка подлинности Azure Active Directory** ([проверка подлинности Azure Active Directory](https://docs.microsoft.com/azure/sql-database/sql-database-aad-authentication)) — это механизм подключения к базе данных Microsoft Azure SQL и хранилищу данных SQL с помощью удостоверений в Azure Active Directory (Azure AD). Этот механизм позволяет централизованно управлять удостоверениями пользователей базы данных.

![Аутентификация](./media/azure-databse-security-overview/azure-database-fig2.png)

 К преимуществам проверки подлинности Azure Active Directory относятся:
  - наличие альтернативного варианта проверки подлинности SQL Server;
  - предотвращение распространения удостоверений пользователей на серверах базы данных и возможность смены паролей в одном месте;
  - возможность управления разрешениями базы данных с помощью внешних групп (Azure Active Directory);
  - возможность исключить хранение паролей с помощью встроенной проверки подлинности Windows и других видов проверки подлинности, поддерживаемых Azure Active Directory;

#### <a name="authorization"></a>Авторизация
[Проверка подлинности](https://docs.microsoft.com/azure/sql-database/sql-database-manage-logins) включает набор действий, которые пользователь может выполнять в базе данных SQL Azure. Этот набор действий определяется [принадлежностью учетной записи пользователя к ролям базы данных](https://msdn.microsoft.com/library/ms189121) и [разрешениями на уровне объектов](https://msdn.microsoft.com/library/ms191291.aspx). Проверка подлинности — это процесс определения того, к каким защищаемым ресурсам участник может получить доступ и какие операции допускаются для этих ресурсов.

### <a name="application-access"></a>Доступ к приложениям

В этом разделе будут освещены следующие вопросы:

-   Динамическое маскирование данных
-   Безопасность на уровне строк

#### <a name="dynamic-data-masking"></a>Динамическое маскирование данных
Представитель отдела обслуживания клиентов в центре обработки вызовов может идентифицировать абонентов по нескольким цифрам номера социального страхования или номера кредитной карты, но эти элементы данных не должны предоставляться ему полностью.

Правило маскирования может быть задано таким образом, чтобы в результатах выполнения запросов маскировалось все, кроме последних четырех цифр номера социального страхования или кредитной карты.

![Динамическое маскирование данных](./media/azure-databse-security-overview/azure-database-fig3.png)

Еще один пример — защита персональных данных с помощью соответствующей маски. Разработчик может отправлять запросы в рабочие среды для устранения неполадок, не нарушая при этом нормативные правила.

[Динамическое маскирование данных базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-dynamic-data-masking-get-started) ограничивает возможность раскрытия конфиденциальных данных, маскируя их для обычных пользователей. Динамическое маскирование данных поддерживается в версии 12 Базы данных SQL Azure.

[Динамическое маскирование данных](https://docs.microsoft.com/sql/relational-databases/security/dynamic-data-masking) помогает предотвратить несанкционированный доступ к конфиденциальным данным, позволяя вам самостоятельно определить, какой объем конфиденциальных данных следует раскрывать с минимальным влиянием на уровне приложения. Эта функция работает на основе политики безопасности, скрывая конфиденциальные данные в результирующем наборе запроса по заданным полям базы данных, не меняя сами данные в базе данных.


> [!Note]
> Динамическую маскировку данных может настраивать администратор базы данных Azure, администратор сервера или сотрудник службы безопасности.

#### <a name="row-level-security"></a>Безопасность на уровне строк
Другим распространенным требованием безопасности для многопользовательских баз данных является [безопасность на уровне строк](https://msdn.microsoft.com/library/dn765131.aspx). Эта функция позволяет пользователям управлять доступом к строкам в таблице базы данных в зависимости от характеристик пользователя, выполняющего запрос (например, членство в группе или контекст выполнения).

![Безопасность на уровне строк](./media/azure-databse-security-overview/azure-database-fig4.png)

Логика ограничения доступа находится на уровне базы данных, а не на другом уровне приложения отдельно от данных. Система базы данных применяет ограничения доступа при каждой попытке получения доступа к данным независимо от уровня. Это делает систему безопасности более надежной и устойчивой за счет уменьшения ее контактной зоны.

Безопасность на уровне строк включает управление доступом на основе предикатов. Она поддерживает гибкую централизованную оценку на основе предикатов, которая может учитывать метаданные или другие критерии, определяемые администратором по необходимости. Предикат используется как критерий для определения того, имеет ли пользователь соответствующий доступ к данным на основе атрибутов пользователя. Управление доступом на основе меток можно реализовать с помощью управления доступом на основе предикатов.

## <a name="proactive-monitoring"></a>Упреждающий мониторинг
База данных SQL обеспечивает защиту данных, предоставляя возможности **аудита** и **обнаружения угроз**.

### <a name="auditing"></a>Аудит
Аудит базы данных SQL повышает возможность получения сведений о событиях и изменениях, которые произошли в базе данных, включая обновления и запросы к данным.

[Аудит базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-auditing-get-started) позволяет отслеживать события базы данных и записывать их в журнал аудита в учетной записи хранения Azure. Аудит может помочь вам соблюсти требования нормативов, проанализировать работу с базой данных и получить представление о расхождениях и аномалиях, которые могут указывать на бизнес-проблемы или предполагаемые нарушения безопасности. Средства аудита способствуют соблюдению стандартов соответствия, но не гарантируют их выполнение.

Аудит базы данных SQL позволяет:

-   **Сохранить** журнал аудита выбранных событий. Вы можете указать, какие категории действий базы данных должны проходить аудит.
-   **Создавать отчеты** по действиям, производимым с базой данных. Вы можете использовать предварительно настроенные отчеты и панель мониторинга для быстрого начала работы с отчетностью по действиям и событиям.
-   **Анализировать** отчеты. Вы можете искать подозрительные события, необычную деятельность и тенденции.

Существует два метода аудита:

-   **Аудит BLOB-объектов**: журналы записываются в хранилище BLOB-объектов Azure. Это сравнительно новый метод аудита, который обеспечивает более высокую производительность, поддерживает более высокую детализацию аудита на уровне объекта и является более экономически эффективным.
-   **Аудит таблиц**: журналы записываются в хранилище таблиц Azure.

### <a name="threat-detection"></a>Обнаружение угроз
[Обнаружение угроз базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection) выявляет подозрительные действия, которые указывают на потенциальные угрозы безопасности. Обнаружение угроз позволяет реагировать на подозрительные события в базе данных, например атаки путем внедрения кода SQL, при их возникновении. Оно предоставляет оповещения и позволяет использовать аудит базы данных SQL Azure для изучения подозрительных событий.

![Обнаружение угроз](./media/azure-databse-security-overview/azure-database-fig5.jpg)

Например, внедрение кода SQL — один из распространенных видов угроз безопасности веб-приложений в Интернете, используемый для получения несанкционированного доступа к приложениям, управляемым данными. Хакеры используют уязвимости приложения, чтобы ввести вредоносные инструкции SQL в поля ввода приложения, чтобы испортить или изменить данные в базе данных.

Сотрудники службы безопасности или другие назначенные администраторы могут получить немедленное уведомление о подозрительных действиях с базой данных. Каждое уведомление содержит сведения о подозрительном действии и рекомендации по дальнейшему исследованию и снижению угрозы.        

## <a name="centralized-security-management"></a>Централизованное управление защитой

[Центр безопасности Azure](https://azure.microsoft.com/documentation/services/security-center/) позволяет предотвращать, обнаруживать угрозы и реагировать на них. Она включает встроенные функции мониторинга безопасности и управления политиками для подписок Azure, помогает выявлять угрозы, которые в противном случае могли бы оказаться незамеченными, и взаимодействует с широким комплексом решений по обеспечению безопасности.

[Центр безопасности](https://docs.microsoft.com/azure/security-center/security-center-sql-database) помогает защитить данные в базе данных SQL, обеспечивая представление безопасности всех серверов и баз данных. Ниже перечислены возможности центра безопасности:

-   определение политик для шифрования и аудита базы данных SQL;
-   мониторинг безопасности ресурсов базы данных SQL во всех ваших подписках;
-   быстрое выявление и устранение проблем безопасности;
-   интеграция оповещений об [обнаружении угроз для базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection).
-   Центр безопасности поддерживает доступ на основе ролей.

## <a name="azure-marketplace"></a>Azure Marketplace

Azure Marketplace — это интернет-магазин приложений и служб, который позволяет независимым поставщикам программного обеспечения (ISV) и разработчикам, чьи проекты находятся на начальном этапе развития, предлагать свои решения клиентам Azure по всему миру.
Azure Marketplace объединяет экосистемы партнеров Microsoft Azure в единообразную платформу для повышения качества обслуживания клиентов и партнеров. Щелкните [здесь](https://azuremarketplace.microsoft.com/marketplace/apps?search=Database%20Security&page=1), чтобы получить сведения о продуктах Azure Marketplace, связанных с безопасностью баз данных.

## <a name="next-steps"></a>Дальнейшие действия

- Ознакомьтесь с дополнительными сведениями о [защите базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-security-tutorial).
- Ознакомьтесь с дополнительными сведениями о [центре безопасности Azure и службе базы данных SQL Azure](https://docs.microsoft.com/azure/security-center/security-center-sql-database).
- Дополнительные сведения об обнаружении угроз см. в разделе [Обнаружение угроз для базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection).
- Ознакомьтесь с дополнительными сведениями в разделе [Улучшение производительности базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-performance-tutorial). 
