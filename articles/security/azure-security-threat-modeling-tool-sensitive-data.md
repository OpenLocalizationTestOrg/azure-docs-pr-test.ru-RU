---
title: "Конфиденциальные данные. Средство моделирования угроз Microsoft Azure | Документация Майкрософт"
description: "Устранение угроз, обнаруженных с помощью средства моделирования угроз"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: 21d1ba02052862e16ef27ec313d53cd0bffcc21a
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-sensitive-data--mitigations"></a>Механизм безопасности. Конфиденциальные данные | Устранение угроз 
| Продукт или служба | Статья |
| --------------- | ------- |
| **Граница доверия между компьютерами** | <ul><li>[Двоичные файлы, содержащие конфиденциальные данные, должны быть замаскированы](#binaries-info)</li><li>[Используйте шифрование на уровне файловой системы (EFS) для защиты конфиденциальных данных пользователя](#efs-user)</li><li>[Настройте шифрование конфиденциальных данных, сохраняемых приложением в файловой системе](#filesystem)</li></ul> | 
| **Веб-приложение** | <ul><li>[Конфиденциальное содержимое не должно кэшироваться в браузере](#cache-browser)</li><li>[Зашифруйте разделы файлов конфигурации веб-приложения, содержащие конфиденциальные данные](#encrypt-data)</li><li>[Явным образом отключите автозаполнение атрибута HTML в конфиденциальных формах и входных данных](#autocomplete-input)</li><li>[Замаскируйте конфиденциальные данные, отображаемые на экране пользователя](#data-mask)</li></ul> | 
| **База данных** | <ul><li>[Реализуйте динамическую маскировку данных, чтобы уменьшить шансы раскрытия конфиденциальных данных для непривилегированных пользователей](#dynamic-users)</li><li>[Обеспечьте хранение паролей в формате хэша с использованием случайной строки данных](#salted-hash)</li><li>[Шифруйте конфиденциальные данные в столбцах базы данных](#db-encrypted)</li><li>[Включите шифрование уровня базы данных (TDE)](#tde-enabled)</li><li>[Зашифруйте резервные копии базы данных](#backup)</li></ul> | 
| **Веб-интерфейс API** | <ul><li>[В хранилище браузера не должны храниться конфиденциальные данные, относящиеся к веб-API](#api-browser)</li></ul> | 
| Azure DocumentDB | <ul><li>[Шифруйте конфиденциальные данные, хранящиеся в DocumentDB](#encrypt-docdb)</li></ul> | 
| **Граница доверия виртуальной машины IaaS Azure** | <ul><li>[Шифруйте диски, используемые виртуальными машинами, с помощью шифрования дисков Azure](#disk-vm)</li></ul> | 
| **Граница доверия Service Fabric** | <ul><li>[Шифруйте секреты в приложениях Service Fabric](#fabric-apps)</li></ul> | 
| **Dynamics CRM** | <ul><li>[Выполняйте моделирование безопасности, при необходимости привлекая рабочие подразделения и группы](#modeling-teams)</li><li>[Ограничьте доступ к общим функциям критически важных сущностей](#entities)</li><li>[Информируйте пользователей о рисках, связанных с использованием функции "Поделиться" Dynamics CRM, и предоставьте им рекомендации безопасности](#good-practices)</li><li>[Включите стандартные правила разработки, запрещающие показ данных о конфигурации в управлении исключениями](#exception-mgmt)</li></ul> | 
| **Хранилище Azure** | <ul><li>[Используйте шифрование службы хранилища Azure (SSE) для неактивных данных (предварительная версия)](#sse-preview)</li><li>[Используйте шифрование на стороне клиента для хранения конфиденциальных данных в службе хранилища Azure](#client-storage)</li></ul> | 
| **Мобильный клиент** | <ul><li>[Шифруйте конфиденциальные данные или личные данные, записываемые в локальное хранилище телефонов](#pii-phones)</li><li>[Маскируйте созданные двоичные файлы перед их распространением конечным пользователям](#binaries-end)</li></ul> | 
| **WCF** | <ul><li>[Установите для параметра clientCredentialType значение Certificate или Windows](#cert)</li><li>[Не включен режим безопасности WCF](#security)</li></ul> | 

## <a id="binaries-info"></a>Двоичные файлы, содержащие конфиденциальные данные, должны быть замаскированы

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Отношения доверия между компьютерами | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Двоичные файлы, содержащие конфиденциальные данные, например коммерческие тайны или конфиденциальную бизнес-логику, которую нельзя отменить, следует маскировать. Это позволит остановить проведение инженерного анализа сборок. Для этой цели можно использовать такой инструмент, как `CryptoObfuscator`. |

## <a id="efs-user"></a>Используйте шифрование на уровне файловой системы (EFS) для защиты конфиденциальных данных пользователя

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Отношения доверия между компьютерами | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Рассмотрите возможность использования шифрования на уровне файловой системы для защиты конфиденциальных данных пользователя от злоумышленников, использующих физический доступ к компьютеру. |

## <a id="filesystem"></a>Настройте шифрование конфиденциальных данных, сохраняемых приложением в файловой системе

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Отношения доверия между компьютерами | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Шифруйте конфиденциальные данные, сохраняемые приложением в файловой системе (например, с помощью DPAPI), если невозможно применить шифрование на уровне файловой системы. |

## <a id="cache-browser"></a>Конфиденциальное содержимое не должно кэшироваться в браузере

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальные, веб-формы, MVC 5, MVC 6 |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Браузеры могут сохранять информацию для кэширования и ведения истории. Эти кэшированные файлы хранятся в папке, подобной папке временных файлов Интернета в Internet Explorer. При повторном обращении к страницам браузер отображает их из кэша. Если конфиденциальные сведения отображаются пользователю (например, адреса, данные кредитной карты, номер социального страхования или имя пользователя), эта информация может быть сохранена в кэше браузера, а значит ее можно получить путем проверки кэша браузера или просто нажатием кнопки "Назад" в браузере. Задайте для заголовка ответа Cache-Control значение no-store ("не сохранять") для всех страниц. |

### <a name="example"></a>Пример
```XML
<configuration>
  <system.webServer>
   <httpProtocol>
    <customHeaders>
        <add name="Cache-Control" value="no-cache" />
        <add name="Pragma" value="no-cache" />
        <add name="Expires" value="-1" />
    </customHeaders>
  </httpProtocol>
 </system.webServer>
</configuration>
```

### <a name="example"></a>Пример
Вы можете сделать это, используя фильтр. Воспользуйтесь следующим примером. 
```C#
public override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            if (filterContext == null || (filterContext.HttpContext != null && filterContext.HttpContext.Response != null && filterContext.HttpContext.Response.IsRequestBeingRedirected))
            {
                //// Since this is MVC pipeline, this should never be null.
                return;
            }

            var attributes = filterContext.ActionDescriptor.GetCustomAttributes(typeof(System.Web.Mvc.OutputCacheAttribute), false);
            if (attributes == null || **Attributes**.Count() == 0)
            {
                filterContext.HttpContext.Response.Cache.SetNoStore();
                filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);
                filterContext.HttpContext.Response.Cache.SetExpires(DateTime.UtcNow.AddHours(-1));
                if (!filterContext.IsChildAction)
                {
                    filterContext.HttpContext.Response.AppendHeader("Pragma", "no-cache");
                }
            }

            base.OnActionExecuting(filterContext);
        }
``` 

## <a id="encrypt-data"></a>Зашифруйте разделы файлов конфигурации веб-приложения, содержащие конфиденциальные данные

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Руководство по шифрованию разделов конфигурации в ASP.NET 2.0 с помощью DPAPI](https://msdn.microsoft.com/library/ff647398.aspx), [сведения об указании поставщика защищенной конфигурации](https://msdn.microsoft.com/library/68ze1hb2.aspx), [использование Azure Key Vault для защиты секретов приложения](https://azure.microsoft.com/documentation/articles/guidance-multitenant-identity-keyvault/) |
| **Действия** | Такие файлы конфигурации, как web.config и appsettings.json, часто используются для хранения конфиденциальной информации, включая имена пользователей, пароли, строки подключения к базам данных и ключи шифрования. Если эти данные не защищены, приложение становится уязвимым для злоумышленников, которые таким образом могут получить различные конфиденциальные сведения, например имена учетных записей пользователей, пароли, имена баз данных и имена серверов. На основе типа развертывания (Azure или локального) зашифруйте конфиденциальные разделы файлов конфигурации с помощью DPAPI или таких служб, как Azure Key Vault. |

## <a id="autocomplete-input"></a>Явным образом отключите автозаполнение атрибута HTML в конфиденциальных формах и входных данных

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Сведения об атрибуте autocomplete на сайте MSDN](http://msdn.microsoft.com/library/ms533486(VS.85).aspx), [использование функции автозаполнение в формах HTML](http://msdn.microsoft.com/library/ms533032.aspx), [Бюллетень по безопасности (Майкрософт) MS10-071 — критическое](http://technet.microsoft.com/security/bulletin/MS10-071), [запись блога о функции автозаполнения](http://blog.mindedsecurity.com/2011/10/autocompleteagain.html) |
| **Действия** | Атрибут autocompletee указывает, включено ли автозаполнение формы. Если автозаполнение включено, браузер автоматически использует значения, введенные пользователем. Например, если форма, в которую вы ввели новое имя и пароль, успешно отправлена, браузер спрашивает, нужно ли сохранить пароль. В дальнейшем при отображении формы имя и пароль заполняются автоматически или непосредственно во время введения имени. Злоумышленник, у которого есть локальный доступ, может получить открытый пароль из кэша браузера. По умолчанию автозаполнение включено, поэтому его явным образом следует отключить. |

### <a name="example"></a>Пример
```C#
<form action="Login.aspx" method="post " autocomplete="off" >
      Social Security Number: <input type="text" name="ssn" />
      <input type="submit" value="Submit" />    
</form>
```

## <a id="data-mask"></a>Замаскируйте конфиденциальные данные, отображаемые на экране пользователя

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-приложение | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Конфиденциальные данные, такие как пароли, номера кредитных карт, номера социального страхования и т. д., при отображении на экране должны быть скрыты. Это необходимо для предотвращения несанкционированного доступа к данным (например, сотрудники могут просмотреть пароль при его вводе другим сотрудником, персонал группы поддержки может просмотреть номера социального страхования пользователей). Убедитесь, что эти данные не отображаются в обычном тексте и что они скрыты должным образом. Вам необходимо позаботиться об этом как на этапе принятия их в качестве входных данных (например, input type="password"), так и при отображении на экране (например, отображать только последние 4 цифры номера кредитной карты). |

## <a id="dynamic-users"></a>Реализуйте динамическую маскировку данных, чтобы уменьшить шансы раскрытия конфиденциальных данных для непривилегированных пользователей

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | SQL Azure, локальные |
| **Атрибуты**              | Версия SQL: 12, MsSQL2016 |
| **Справочные материалы**              | [динамическое маскирование данных;](https://msdn.microsoft.com/library/mt130841) |
| **Действия** | Цель динамической маскировки данных — уменьшить шансы раскрытия конфиденциальных данных пользователями, у которых нет разрешения на их просмотр. Динамическая маскировка данных не предотвращает подключение пользователей базы данных непосредственно к базе данных и выполнение тщательных запросов, способных выявить фрагменты конфиденциальных данных. Динамическая маскировка данных дополняет другие функции безопасности SQL Server (аудит, шифрование, защита на уровне строк и т. д.). Мы рекомендуем использовать эту функцию в сочетании с другими для обеспечения лучшей защиты конфиденциальных сведений базы данных. Обратите внимание, что эта функция поддерживается только в SQL Server (начиная с версии 2016) и базе данных SQL Azure. |

## <a id="salted-hash"></a>Обеспечьте хранение паролей в формате хэша с использованием случайной строки данных

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Хеширование паролей с использованием API .NET для шифрования](http://docs.asp.net/en/latest/security/data-protection/consumer-apis/password-hashing.html) |
| **Действия** | Пароли не должны храниться в пользовательских базах данных хранилища. Вместо этого хэши паролей должны храниться со случайными данными. Эти данные должны быть уникальными для каждого пользователя. Кроме того, перед сохранением пароля необходимо применить bcrypt, scrypt или PBKDF2 с минимальным числом итераций рабочего фактора в 150 000 циклов, чтобы предотвратить возможность атак методом подбора.| 

## <a id="db-encrypted"></a>Шифруйте конфиденциальные данные в столбцах базы данных

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Версия SQL: все |
| **Справочные материалы**              | [Контрольный список. Шифрование конфиденциальных данных](https://technet.microsoft.com/library/ff848751(v=sql.105).aspx), [Шифрование столбца данных](https://msdn.microsoft.com/library/ms179331), [ENCRYPTBYCERT (Transact-SQL)](https://msdn.microsoft.com/library/ms188061) |
| **Действия** | В базе данных должны быть зашифрованы такие конфиденциальные данные, как номера кредитных карт. К данным можно применять шифрование на уровне столбцов или функции шифрования с помощью функции-приложения. |

## <a id="tde-enabled"></a>Включите шифрование уровня базы данных (TDE)

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Основные сведения о прозрачном шифровании данных (TDE)](https://technet.microsoft.com/library/bb934049(v=sql.105).aspx) |
| **Действия** | Функция прозрачного шифрования данных (TDE) в SQL Server помогает шифровать конфиденциальные данные в базе данных и защищать ключи, используемые для шифрования данных с помощью сертификата. Таким образом, пользователи без ключей не смогут использовать эти данные. Функция TDE защищает неактивные данные, то есть файлы данных и файлы журналов. Это дает возможность соблюдать требования многих законов, норм и рекомендаций, установленных в различных отраслях. |

## <a id="backup"></a>Зашифруйте резервные копии базы данных

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | База данных | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | SQL Azure, локальные |
| **Атрибуты**              | Версия SQL: 12, MsSQL2014 |
| **Справочные материалы**              | [Шифрование резервной копии](https://msdn.microsoft.com/library/dn449489) |
| **Действия** | SQL Server может шифровать данные при создании резервной копии. Для создания зашифрованных файлов резервной копии достаточно указать алгоритм шифрования и шифратор (сертификат или асимметричный ключ) при создании резервной копии. |

## <a id="api-browser"></a>В хранилище браузера не должны храниться конфиденциальные данные, относящиеся к веб-API

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Веб-интерфейс API | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | MVC 5, MVC 6 |
| **Атрибуты**              | Поставщик удостоверений — ADFS или Azure AD |
| **Справочные материалы**              | Недоступно  |
| **Действия** | <p>В некоторых реализациях конфиденциальные артефакты, связанные с проверкой подлинности веб-API, хранятся в локальном хранилище браузера. Например, такие артефакты проверки подлинности Azure AD, как adal.idtoken, adal.nonce.idtoken, adal.access.token.key, adal.token.keys, adal.state.login, adal.session.state, adal.expiration.key и другие.</p><p>Эти артефакты доступны даже после выхода или закрытия браузера. Если злоумышленник получит доступ к этим артефактам, он может повторно использовать их для доступа к защищенным ресурсам (API). Убедитесь, что все конфиденциальные артефакты, относящиеся к веб-API, не хранятся в хранилище браузера. Когда доступ к клиентскому хранилищу (например, одностраничные приложения, которые используют неявные потоки OpenIdConnect или OAuth, хранят маркеры доступа локально) неизбежен, используйте временные хранилища. Например, вместо локального хранилища используйте хранилище для сеанса.</p>| 

### <a name="example"></a>Пример
Приведенный ниже фрагмент кода JavaScript взят из пользовательской библиотеки проверки подлинности, хранящей артефакты проверки подлинности в локальном хранилище. Необходимо избегать таких реализаций. 
```javascript
ns.AuthHelper.Authenticate = function () {
window.config = {
instance: 'https://login.microsoftonline.com/',
tenant: ns.Configurations.Tenant,
clientId: ns.Configurations.AADApplicationClientID,
postLogoutRedirectUri: window.location.origin,
cacheLocation: 'localStorage', // enable this for IE, as sessionStorage does not work for localhost.
};
```

## <a id="encrypt-docdb"></a>Шифрование конфиденциальных данных, хранящихся в Cosmos DB

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Azure DocumentDB | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Зашифруйте конфиденциальные данные на уровне приложения, прежде чем сохранить их в DocumentDB, или сохраните все конфиденциальные данные в других решениях хранения, например в службе хранилища Azure или Azure SQL.| 

## <a id="disk-vm"></a>Шифруйте диски, используемые виртуальными машинами, с помощью шифрования дисков Azure

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Границы доверия виртуальной машины IaaS Azure | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Руководство по безопасности службы хранилища Azure. Применение шифрования дисков Azure для шифрования дисков, используемых виртуальными машинами](https://azure.microsoft.com/documentation/articles/storage-security-guide/#_using-azure-disk-encryption-to-encrypt-disks-used-by-your-virtual-machines) |
| **Действия** | <p>Шифрование дисков Azure — это новая функция, которая в настоящее время находится на этапе предварительной версии. Она позволяет шифровать диски ОС и данных, используемые виртуальными машинами IaaS. Для Windows диски шифруются с помощью стандартной отраслевой технологии шифрования BitLocker. Для Linux диски шифруются с помощью технологии DM-Crypt. Функция интегрируется с хранилищем ключей Azure, что позволяет управлять ключами шифрования дисков. Решение для шифрования дисков Azure поддерживает следующие три сценария шифрования данных клиента:</p><ul><li>включение шифрования в новых виртуальных машинах IaaS, созданных на основе шифруемых клиентом файлов VHD и предоставленных клиентом ключей шифрования, которые хранятся в хранилище ключей Azure;</li><li>включение шифрования в новых виртуальных машинах IaaS, созданных с помощью Azure Marketplace;</li><li>включение шифрования в существующих виртуальных машинах IaaS, которые уже работают в Azure.</li></ul>| 

## <a id="fabric-apps"></a>Шифруйте секреты в приложениях Service Fabric

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Граница доверия Service Fabric | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Среда: Azure |
| **Справочные материалы**              | [Управление секретами в приложениях Service Fabric](https://azure.microsoft.com/documentation/articles/service-fabric-application-secret-management/) |
| **Действия** | Секретом может считаться любая конфиденциальная информации, например строка подключения к хранилищу, пароль или другое значение, которое не должно обрабатываться в виде обычного текста. Используйте Azure Key Vault для управления ключами и секретами в приложениях Service Fabric. |

## <a id="modeling-teams"></a>Выполняйте моделирование безопасности, при необходимости привлекая рабочие подразделения и группы

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Dynamics CRM | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Выполняйте моделирование безопасности, при необходимости привлекая рабочие подразделения и группы |

## <a id="entities"></a>Ограничьте доступ к общим функциям критически важных сущностей

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Dynamics CRM | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Ограничьте доступ к общим функциям критически важных сущностей |

## <a id="good-practices"></a>Информируйте пользователей о рисках, связанных с использованием функции "Поделиться" Dynamics CRM, и предоставьте им рекомендации безопасности

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Dynamics CRM | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Информируйте пользователей о рисках, связанных с использованием функции "Поделиться" Dynamics CRM, и предоставьте им рекомендации безопасности |

## <a id="exception-mgmt"></a>Включите стандартные правила разработки, запрещающие показ данных о конфигурации в управлении исключениями

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Dynamics CRM | 
| **Этап SDL**               | Развертывание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | Недоступно  |
| **Действия** | Включите стандартные правила разработки, запрещающие показ данных о конфигурации в управлении исключениями за пределами среды разработки. Протестируйте эту возможность как часть проверки кода или во время периодических проверок.|

## <a id="sse-preview"></a>Используйте шифрование службы хранилища Azure (SSE) для неактивных данных (предварительная версия)

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Хранилище Azure | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Тип хранилища: большой двоичный объект |
| **Справочные материалы**              | [Шифрование службы хранилища Azure для неактивных данных (предварительная версия)](https://azure.microsoft.com/documentation/articles/storage-service-encryption/) |
| **Действия** | <p>Шифрование службы хранилища Azure (SSE) для неактивных данных помогает защитить данные в соответствии с предложениями по безопасности и соответствию вашей организации. С помощью этой функции служба хранилища Azure автоматически шифрует данные перед сохранением в хранилище и расшифровывает их перед извлечением. Шифрование, расшифровка и управление ключами полностью прозрачны для пользователей. Шифрование службы хранилища применяется только к блочным, страничным и добавочным BLOB-объектам. Другие типы данных, включая таблицы, очереди и файлы, не шифруются.</p><p>Ниже описан рабочий процесс шифрования и расшифровки.</p><ul><li>Клиент включает шифрование в учетной записи хранения.</li><li>Когда клиент записывает новые данные (выполняя операции PUT Blob, PUT Block, PUT Page и другие) в хранилище BLOB-объектов, к каждой операции записи применяется 256-разрядное шифрование AES, являющееся самой надежной технологией блочного шифрования на сегодняшний день.</li><li>Когда клиенту требуется получить доступ к данным (например, GET Blob и т. д.), они автоматически расшифровываются перед возвратом пользователю.</li><li>Если шифрование отключено, новые операции записи не шифруются, а уже зашифрованные данные остаются в таком состоянии, пока не будут перезаписаны пользователем. Когда шифрование включено, операции записи в хранилище BLOB-объектов шифруются. Состояние данных не изменяется, когда пользователь переключается между включенным и отключенным шифрованием для учетной записи хранения.</li><li>Все ключи шифрования хранятся в зашифрованном виде и управляются корпорацией Майкрософт.</li></ul><p>Обратите внимание, что в настоящее время ключами, используемыми для шифрования, управляет корпорация Майкрософт. Майкрософт создает исходные ключи и управляет их безопасным хранением, а также регулярной заменой в соответствии с внутренней политикой Майкрософт. В будущем клиенты получат возможность управлять своими ключами шифрования самостоятельно и им будет предоставлен план перехода с ключей, управляемых корпорацией Майкрософт, на ключи, управляемые клиентом.</p>| 

## <a id="client-storage"></a>Используйте шифрование на стороне клиента для хранения конфиденциальных данных в службе хранилища Azure

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Хранилище Azure | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Шифрование на стороне клиента для службы хранилища Microsoft Azure](https://azure.microsoft.com/documentation/articles/storage-client-side-encryption/), [Шифрование и расшифровка BLOB-объектов в хранилище Microsoft Azure с помощью хранилища ключей Azure](https://azure.microsoft.com/documentation/articles/storage-encrypt-decrypt-blobs-key-vault/), [запись блога о безопасном хранении данных в хранилище BLOB-объектов Azure с расширениями шифрования Azure](https://blogs.msdn.microsoft.com/partnercatalystteam/2015/06/17/storing-data-securely-in-azure-blob-storage-with-azure-encryption-extensions/) |
| **Действия** | <p>Клиентская библиотека службы хранилища Azure для пакета Nuget для .NET поддерживает шифрование данных в клиентских приложениях перед их отправкой в службу хранилища Azure и их расшифровку во время скачивания клиентом. Библиотека также поддерживает интеграцию с хранилищем ключей Azure для управления ключами учетной записи хранения. Вот краткое описание того, как работает шифрование на стороне клиента.</p><ul><li>Пакет SDK клиента хранилища Azure создает ключ шифрования содержимого (CEK), который является одноразовым симметричным ключом.</li><li>Данные пользователей шифруются с помощью этого ключа CEK.</li><li>Ключ CEK, в свою очередь, шифруется с помощью ключа шифрования ключа KEK. Ключ KEK определяется идентификатором ключа и может быть парой асимметричных ключей или симметричным ключом. Вы можете управлять им локально или хранить его в хранилище ключей Azure. У самого клиента хранилища нет доступа к KEK. Он просто вызывает алгоритм шифрования ключа, предоставляемый хранилищем ключей. Пользователи могут при необходимости использовать настраиваемые поставщики для шифрования и расшифровки ключа.</li><li>Зашифрованные данные затем передаются в службу хранилища Azure. Просмотрите ссылки в разделе справочных сведений, чтобы получить низкоуровневые сведения о реализации.</li></ul>|

## <a id="pii-phones"></a>Шифруйте конфиденциальные данные или личные данные, записываемые в локальное хранилище телефонов

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Мобильный клиент | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальные, Xamarin  |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Создание политики конфигурации](https://docs.microsoft.com/intune/deploy-use/manage-settings-and-features-on-your-devices-with-microsoft-intune-policies#create-a-configuration-policy), [сведения об обслуживании цепочки ключей](https://components.xamarin.com/view/square.valet) |
| **Действия** | <p>Перед записью в локальную файловую систему персональные данные пользователя (электронная почта, номер телефона, имя, фамилия, параметры и т. д.), которые приложение записывает в файловую систему мобильного устройства, должны быть зашифрованы. Если приложение является корпоративным, рассмотрите возможности публикации приложения с помощью Windows Intune.</p>|

### <a name="example"></a>Пример
Вы можете настроить Intune со следующими политиками безопасности для защиты конфиденциальных данных: 
```C#
Require encryption on mobile device    
Require encryption on storage cards
Allow screen capture
```

### <a name="example"></a>Пример
Если приложение не является корпоративным, используйте предоставленное платформой хранилище ключей и цепочки ключей для хранения ключей шифрования и выполняйте тип операции шифрования, допустимый в файловой системе. Фрагмент кода ниже отображает получение ключа из цепочки ключей с помощью Xamarin. 
```C#
        protected static string EncryptionKey
        {
            get
            {
                if (String.IsNullOrEmpty(_Key))
                {
                    var query = new SecRecord(SecKind.GenericPassword);
                    query.Service = NSBundle.MainBundle.BundleIdentifier;
                    query.Account = "UniqueID";

                    NSData uniqueId = SecKeyChain.QueryAsData(query);
                    if (uniqueId == null)
                    {
                        query.ValueData = NSData.FromString(System.Guid.NewGuid().ToString());
                        var err = SecKeyChain.Add(query);
                        _Key = query.ValueData.ToString();
                    }
                    else
                    {
                        _Key = uniqueId.ToString();
                    }
                }

                return _Key;
            }
        }
```

## <a id="binaries-end"></a>Маскируйте созданные двоичные файлы перед их распространением конечным пользователям

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | Мобильный клиент | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальный |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Crypto Obfuscator для .NET](http://www.ssware.com/cryptoobfuscator/obfuscator-net.htm) |
| **Действия** | Созданные двоичные файлы (сборки в APK) должны быть замаскированы, чтобы остановить проведение инженерного анализа сборок. Для этой цели могут использоваться такие инструменты, как `CryptoObfuscator`. |

## <a id="cert"></a>Установите для параметра clientCredentialType значение Certificate или Windows

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | .NET Framework 3 |
| **Атрибуты**              | Недоступно  |
| **Справочные материалы**              | [Fortify](https://vulncat.fortify.com/en/vulncat/index.html) |
| **Действия** | Использование маркера имени пользователя с открытым паролем в незащищенном канале делает пароль уязвимым к атакам злоумышленников, которые могут получить доступ к сообщениям, передаваемым по протоколу SOAP. Поставщики служб, которые используют маркер имени пользователя, могут принять пароли, отправленные обычным текстом. В случае отправки открытых паролей через незащищенный канал учетные данные становятся уязвимыми к атакам злоумышленников, которые могут получить доступ к сообщениям, передаваемым по протоколу SOAP. | 

### <a name="example"></a>Пример
Ниже представлена конфигурация поставщика службы WCF, в которой используется маркер имени пользователя. 
```
<security mode="Message"> 
<message clientCredentialType="UserName" />
``` 
Установите для параметра clientCredentialType значение Certificate или Windows. 

## <a id="security"></a>Не включен режим безопасности WCF

| Название                   | Сведения      |
| ----------------------- | ------------ |
| **Компонент**               | WCF | 
| **Этап SDL**               | Создание |  
| **Применимые технологии** | Универсальные, .NET Framework 3 |
| **Атрибуты**              | Режим безопасности — транспорт или сообщение |
| **Справочные материалы**              | [MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify Kingdom](https://vulncat.fortify.com/en/vulncat/index.html), [основы безопасности WCF](http://www.codemag.com/article/0611051) |
| **Действия** | Безопасность доставки и сообщений не определена. Приложения, передающие сообщения без защиты доставки или сообщений, не могут гарантировать их целостность и конфиденциальность. Если для привязки безопасности WCF задано значение None, безопасность доставки и сообщений отключена. |

### <a name="example"></a>Пример
В конфигурации ниже для режима безопасности задано значение None. 
```
<system.serviceModel> 
  <bindings> 
    <wsHttpBinding> 
      <binding name=""MyBinding""> 
        <security mode=""None""/> 
      </binding> 
  </bindings> 
</system.serviceModel> 
```

### <a name="example"></a>Пример
Ниже приведены пять режимов безопасности, доступных для всех привязок служб. 
* Отсутствует. Отключает безопасность. 
* Transport. Применяет безопасность доставки для взаимной проверки подлинности и защиты сообщений. 
* Message. Применяет безопасность сообщений для взаимной проверки подлинности и защиты сообщений. 
* Both. Позволяет задать параметры безопасности доставки и сообщений (только для MSMQ). 
* TransportWithMessageCredential. Учетные данные передаются с сообщением, а безопасность сообщений и проверка подлинности сервера обеспечиваются на уровне доставки. 
* TransportCredentialOnly. Учетные данные клиента передаются на уровне доставки, безопасность сообщений не применяется. Применяйте безопасность доставки и сообщений для защиты целостности и конфиденциальности сообщений. Ниже представлен пример конфигурации, в соответствии с которым служба будет применять защиту доставки с использованием учетных данных сообщения.
```
<system.serviceModel>
  <bindings>
    <wsHttpBinding>
    <binding name=""MyBinding""> 
    <security mode=""TransportWithMessageCredential""/> 
    <message clientCredentialType=""Windows""/> 
    </binding> 
  </bindings> 
</system.serviceModel> 
```
