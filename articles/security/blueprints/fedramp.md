---
title: "Служба автоматизации Azure Blueprint — веб-приложения для FedRAMP"
description: "Служба автоматизации Azure Blueprint — веб-приложения для FedRAMP"
services: security
documentationcenter: na
author: jomolesk
manager: mbaldwin
editor: tomsh
ms.assetid: 8fe47cff-9c24-49e0-aa11-06ff9892a468
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/15/2017
ms.author: jomolesk
ms.openlocfilehash: d0521d68bab8bd0b7db53a512da6d37033abd85e
ms.sourcegitcommit: 7d107bb9768b7f32ec5d93ae6ede40899cbaa894
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2017
---
# <a name="azure-blueprint-automation---web-applications-for-fedramp"></a>Служба автоматизации Azure Blueprint — веб-приложения для FedRAMP

## <a name="overview"></a>Обзор

[Федеральная программа аккредитации облачных служб (FedRAMP)](https://www.fedramp.gov) — государственная программа США, которая определяет стандартизированный подход к оценке безопасности, сертификации и постоянному мониторингу облачных продуктов и услуг. В этой статье предоставлено руководство по развертыванию совместимой с FedRAMP среды IaaS, подходящей для создания простого интернет-приложения. Это решение автоматизирует развертывание и конфигурацию ресурсов Azure для общей эталонной архитектуры, демонстрируя, как клиенты могут обеспечить соответствие требованиям к безопасности и соответствию. Оно также служит основой для создания и настройки решений в Azure. В решении реализовано несколько директив из базовых требований FedRAMP уровня High на основе стандартов NIST SP 800-53. Дополнительные сведения о требованиях FedRAMP уровня High и этом решении см. в статье [FedRAMP overview](fedramp-controls-overview.md) (Общие сведения о FedRAMP). ***Примечание. Это решение развертывается в Azure для государственных организаций.***

Эта архитектура призвана служить основой, которую клиенты должны адаптировать для конкретных требований, и не должна использоваться "как есть" в рабочей среде. Развертывания приложения в этой среде без изменений недостаточно для полного соответствия базовым требованиям FedRAMP уровня High. Обратите внимание на следующее:
- Эта архитектура является своего рода эталоном, который помогает клиентам использовать Azure в соответствии с требованиями FedRAMP.
- Клиенты несут ответственность за проведение соответствующих проверок безопасности и соответствия внутренней оценки решения, созданного с использованием этой архитектуры, поскольку требования могут варьироваться в зависимости от специфики реализации каждого клиента. 

Краткий обзор того, как работает это решение, содержится в этом [видео](https://aka.ms/fedrampblueprintvideo). В нем объясняется и демонстрируется развертывание решения.

Инструкции по развертыванию см. [здесь](https://aka.ms/fedrampblueprintrepo).

## <a name="solution-components"></a>Компоненты решения

Служба автоматизации Azure Blueprint автоматически развертывает эталонную архитектуру веб-приложения IaaS с предварительно настроенными элементами управления безопасностью, чтобы помочь клиентам обеспечить соответствие требованиям FedRAMP. Решение состоит из шаблонов Azure Resource Manager и сценариев PowerShell, позволяющих развернуть и настроить ресурсы. Доступна сопутствующая [документация по соответствию](#compliance-documentation) Azure Blueprint. В ней описано наследование контроля безопасности от Azure, а также развернутые ресурсы и конфигурации, которые согласовываются с директивами безопасности NIST SP 800-53, тем самым позволяя организациям ускорить выполнение обязательств по соответствию.

## <a name="architecture-diagram"></a>Схема архитектуры

Это решение развертывает эталонную архитектуру для веб-приложения IaaS с внутренним сервером базы данных. Архитектура включает веб-уровень, уровень данных, инфраструктуру Active Directory, шлюз приложения и подсистему балансировки нагрузки. Виртуальные машины развернуты в сети, уровни данных настроены в группе доступности, а экземпляры SQL Server настроены в группе доступности AlwaysOn для обеспечения высокой доступности. Виртуальные машины присоединены к доменам, а с помощью политик группы Active Directory обеспечивается безопасность и соответствие конфигурациям на уровне операционной системы. Управляющий jumpbox (узел-бастион) предоставляет безопасное соединение для администраторов, позволяющее получить доступ к развернутым ресурсам.

![замещающий текст](images/fedramp-architectural-diagram.png?raw=true "Служба автоматизации для веб-приложения IaaS для сред, соответствующих требованиям FedRAMP")

Это решение использует следующие службы Azure. Подробные сведения об архитектуре развертывания см. в [этом разделе](#deployment-architecture).

* **Виртуальные машины Azure**
    - (1) Управление и бастион (Windows Server 2016 Datacenter).
    - (2) Контроллер домена Active Directory (Windows Server 2016 Datacenter).
    - (2) Узел кластера SQL Server (SQL Server 2016 в Windows Server 2012 R2).
    - (1) Следящий сервер SQL Server (Windows Server 2016 Datacenter).
    - (2) Веб-службы и службы IIS (Windows Server 2016 Datacenter).
* **Группы доступности**
    - (1) Контроллеры домена Active Directory.
    - (1) Узлы и следящий сервер кластера SQL.
    - (1) Веб-службы и службы IIS.
* **Виртуальная сеть Azure**
    - (1) Виртуальные сети размером в /16.
    - (5) Подсети размером в /24.
    - Параметры DNS настроены на двух контроллерах доменов.
* **Подсистема балансировщика нагрузки Azure**
    - (1) Подсистема балансировки нагрузки SQL.
* **Шлюз приложений Azure**
    - (1) Включенный шлюз приложений с брандмауэром веб-приложения:
      - режим брандмауэра — предотвращение;
      - набор правил — OWASP 3.0;
      - прослушиватель — порт 443.
* **Хранилище Azure**
    - (7) Учетная запись хранения для геоизбыточного хранилища.
* **Служба архивации Azure**
    - (1) Хранилище служб восстановления.
* **Хранилище ключей Azure**
    - (1) Хранилище ключей.
* **Azure Active Directory**
* **Диспетчер ресурсов Azure**
* **Мониторинг базы данных SQL Azure с помощью служб анализа SQL Azure (предварительная версия) в Log Analytics**.
* **Служба автоматизации Azure**
    - (1) Учетная запись службы автоматизации.
* **Operations Management Suite**
    - (1) Рабочая область OMS.

## <a name="deployment-architecture"></a>Архитектура развертывания

В следующем разделе подробно описываются компоненты разработки и реализации.

### <a name="network-segmentation-and-security"></a>Сегментация сети и безопасность

#### <a name="application-gateway"></a>Шлюз приложений

Архитектура снижает риск уязвимостей безопасности с помощью шлюза приложений с брандмауэром веб-приложения (WAF) и включенным набором правил OWASP. Доступны следующие дополнительные возможности:

- [сквозное SSL-подключение](https://docs.microsoft.com/azure/application-gateway/application-gateway-end-to-end-ssl-powershell);
- включение [разгрузки SSL](https://docs.microsoft.com/azure/application-gateway/application-gateway-ssl-portal);
- отключение [TLS версий 1.0 и 1.1](https://docs.microsoft.com/azure/application-gateway/application-gateway-end-to-end-ssl-powershell);
- [брандмауэр веб-приложения](https://docs.microsoft.com/azure/application-gateway/application-gateway-web-application-firewall-overview) (режим WAF);
- [режим предотвращения](https://docs.microsoft.com/azure/application-gateway/application-gateway-web-application-firewall-portal) с набором правил OWASP 3.0.

#### <a name="virtual-network"></a>Виртуальная сеть

Архитектура определяет частную виртуальную сеть с пространством адресов 10.200.0.0/16.

#### <a name="network-security-groups"></a>Группы безопасности сети

Решение развертывает ресурсы в архитектуре с отдельной веб-подсетью, подсетью базы данных, подсетью Active Directory и подсетью управления внутри виртуальной сети. Подсети логически разделены правилами групп безопасности сети, применяемыми к отдельным подсетям, которые настроены таким образом, чтобы между подсетями проходил только трафик, который необходим для работы функций системы и управления.

Конфигурацию групп безопасности сети для развертывания с помощью этого решения см. на сайте [GitHub](https://github.com/Azure/fedramp-iaas-webapp/blob/master/nestedtemplates/virtualNetworkNSG.json). Организации могут настроить группы безопасности сети, изменив файл, приведенный выше, с использованием [этой документации](https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg) в качестве руководства.

Каждая из подсетей имеет выделенную группу безопасности сети (NSG):
- 1 NSG для шлюза приложений (LBNSG);
- 1 NSG для Jumpbox (MGTNSG);
- 1 NSG для основного и резервного контроллера домена (ADNSG);
- 1 NSG для серверов SQL и файлового ресурса-свидетеля (SQLNSG);
- 1 NSG для веб-уровня (WEBNSG).

#### <a name="subnets"></a>Подсети

Каждая подсеть связана с соответствующей NSG.

### <a name="data-at-rest"></a>Неактивные данные

Архитектура защищает неактивные данные с помощью нескольких мер шифрования.

#### <a name="azure-storage"></a>Хранилище Azure

Для удовлетворения требований к шифрованию неактивных данных все учетные записи хранения используют [шифрование службы хранения](https://docs.microsoft.com/azure/storage/common/storage-service-encryption).

#### <a name="sql-database"></a>База данных SQL

База данных SQL настроена для использования [прозрачного шифрования данных (TDE)](https://docs.microsoft.com/sql/relational-databases/security/encryption/transparent-data-encryption), которое обеспечивает шифрование и расшифровку файлов данных и журналов в реальном времени для защиты неактивных данных. TDE позволяет защитить сохраненные данные от несанкционированного доступа. 

#### <a name="azure-disk-encryption"></a>Дисковое шифрование Azure

Шифрование дисков Azure применяется для шифрования дисков Windows в виртуальных машинах IaaS. [Шифрование дисков Azure](https://docs.microsoft.com/azure/security/azure-security-disk-encryption) использует возможность BitLocker Windows, чтобы обеспечить шифрование тома для ОС и дисков данных. Решение интегрируется с хранилищем ключей Azure, помогая управлять ключами шифрования дисков.

### <a name="logging-and-auditing"></a>Ведение журналов и аудит

[Operations Management Suite (OMS)](https://docs.microsoft.com/azure/security/azure-security-disk-encryption) обеспечивает детальную запись системных и пользовательских действий, а также системной работоспособности. 

- **Журналы действий.** [Журналы действий](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-activity-logs) содержат информацию об операциях, которые выполнялись с ресурсами в подписке.
- **Журналы диагностики.** [Журналы диагностики](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs) — это все журналы, создаваемые ресурсом. К этим журналам относятся системные журналы событий Windows, журналы службы хранилища Azure, журналы аудита Key Vault, а также журналы брандмауэра и доступа шлюза приложений.
- **Архивация журнала.** Журналы диагностики и журналы действий Azure можно подключить к Azure Log Analytics для обработки, хранения и отображения данных на панелях мониторинга. В соответствии с требованиями конкретной организации пользователь может настроить срок до 730 дней.

### <a name="secrets-management"></a>Управление секретами

Решение управляет ключами и секретами с помощью хранилища ключей Azure

- [Хранилище ключей Azure](https://azure.microsoft.com/services/key-vault/) помогает защитить криптографические ключи и секреты, используемые облачными приложениями и службами. 
- Решение интегрируется с Azure Key Vault, чтобы обеспечить управление секретами и ключами шифрования диска виртуальной машины IaaS.

### <a name="identity-management"></a>Управление удостоверениями

Следующие технологии обеспечивают возможности управления удостоверениями в среде Azure.
- [Azure Active Directory (Azure AD)](https://azure.microsoft.com/services/active-directory/) — это мультитенантный облачный каталог и служба управления удостоверениями корпорации Майкрософт.
- Аутентификация развернутого пользователем веб-приложения может выполняться с помощью Azure Active Directory. Дополнительные сведения см. в статье [Интеграция приложений с Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications).  
- [Контроль доступа на основе ролей (RBAC) Azure](https://docs.microsoft.com/azure/active-directory/role-based-access-control-configure) обеспечивает точное управление доступом для Azure. Доступ к подписке ограничен администратором подписки, а доступ к ресурсам можно ограничить с учетом роли пользователя.
- Развернутый экземпляр IaaS Active Directory обеспечивает управление удостоверениями на уровне операционной системы для развернутых виртуальных машин IaaS.
   
### <a name="compute-resources"></a>Вычислительные ресурсы

#### <a name="web-tier"></a>Веб-уровень

Решение развертывает виртуальные машины веб-уровня в [группе доступности](https://docs.microsoft.com/azure/virtual-machines/windows/tutorial-availability-sets). Группа доступности распределяет виртуальные машины между несколькими изолированными аппаратными кластерами, чтобы повысить уровень доступности.

#### <a name="database-tier"></a>Уровень базы данных

Решение развертывает виртуальные машины уровня базы данных в группе доступности в качестве [группы доступности AlwaysOn](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-availability-group-overview). Группа доступности Always On предоставляет возможности, обеспечивающие высокий уровень доступности, и возможности аварийного восстановления. 

#### <a name="active-directory"></a>Active Directory

Все виртуальные машины, развернутые решением, присоединены к доменам, а с помощью политик группы Active Directory реализуются конфигурации безопасности и соответствия на уровне операционной системы. Виртуальные машины Active Directory развернуты в группе доступности.


#### <a name="jumpbox-bastion-host"></a>Jumpbox (узел-бастион)

Управляющий jumpbox (узел-бастион) предоставляет безопасное соединение для администраторов, позволяющее получить доступ к развернутым ресурсам. NSG, связанная с подсетью управления, в которой находится виртуальная машина jumpbox, допускает подключения только через TCP-порт 3389 для протокола удаленного рабочего стола. 

### <a name="malware-protection"></a>Защита от вредоносных программ

[Microsoft Antimalware](https://docs.microsoft.com/azure/security/azure-security-antimalware) для виртуальных машин Azure предоставляет возможности защиты в реальном времени для обнаружения и удаления вирусов, шпионских и других вредоносных программ. Вы можете настроить оповещения о попытках установки или выполнения вредоносных или нежелательных программ на защищенных виртуальных машинах.

### <a name="patch-management"></a>Управление исправлениями

Виртуальные машины Windows, развернутые этой службой автоматизации Blueprint, по умолчанию настроены для получения автоматических обновлений из службы Центра обновления Windows. Это решение также развертывает решение службы автоматизации Azure OMS, с помощью которого можно создать обновления развертываний для развертывания исправлений на серверах Windows, когда это требуется.

### <a name="operations-management"></a>Operations Management

#### <a name="log-analytics"></a>Служба Log Analytics

Log Analytics — это служба в [Operations Management Suite (OMS)](https://azure.microsoft.com/services/log-analytics/), которая собирает и анализирует данные, создаваемые ресурсами в локальных средах Azure.

#### <a name="oms-solutions"></a>Решения OMS

Следующие решения OMS предварительно установлены как часть этого решения:
- [Оценка AD](https://docs.microsoft.com/azure/log-analytics/log-analytics-ad-assessment)
- [Оценка защиты от вредоносных программ](https://docs.microsoft.com/azure/log-analytics/log-analytics-malware)
- [Служба автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-hybrid-runbook-worker)
- [Безопасность и аудит](https://docs.microsoft.com/azure/operations-management-suite/oms-security-getting-started)
- [Оценка SQL](https://docs.microsoft.com/azure/log-analytics/log-analytics-sql-assessment)
- [Управление обновлениями](https://docs.microsoft.com/azure/operations-management-suite/oms-solution-update-management)
- [Работоспособность агентов](https://docs.microsoft.com/azure/operations-management-suite/oms-solution-agenthealth)
- [журналы действий Azure](https://docs.microsoft.com/azure/log-analytics/log-analytics-activity);
- [Отслеживание изменений](https://docs.microsoft.com/azure/log-analytics/log-analytics-activity)

## <a name="compliance-documentation"></a>Документация по соответствию

### <a name="customer-responsibility-matrix"></a>Таблица обязанностей клиента

В [таблице обязанностей клиента](https://aka.ms/blueprinthighcrm) (книга Excel) перечислены все директивы безопасности, требуемые в соответствии с базовыми требованиями FedRAMP уровня High. Для каждой директивы (или ее подраздела) в таблице указано, кто отвечает за ее реализацию: корпорация Майкрософт, клиент либо же они вместе. 

### <a name="control-implementation-matrix"></a>Таблица реализации директивы

В [таблице реализации директивы](https://aka.ms/blueprintwacim) (книга Excel) перечислены все директивы безопасности, требуемые в соответствии с базовыми требованиями FedRAMP уровня High. Для каждой директивы (или ее подраздела), за реализацию которой отвечает клиент (в соответствии с таблицей обязанностей клиента), в таблице указано, 1) реализована ли директива в службе автоматизации Blueprint, и 2) соответствие способа реализации требованиям директивы. Содержимое также можно получить [здесь](fedramp-controls-overview.md).

## <a name="deploy-the-solution"></a>Развертывание решения

Это решение Azure Blueprint состоит из файлов конфигурации JSON и сценариев PowerShell, которые обрабатываются службой API Azure Resource Manager для развертывания ресурсов в Azure. Подробные инструкции по развертыванию см. в [этой статье](https://aka.ms/fedrampblueprintrepo). ***Примечание. Это решение развертывается в Azure для государственных организаций.***

#### <a name="quickstart"></a>Быстрый запуск
1. Клонируйте или скачайте [этот](https://aka.ms/fedrampblueprintrepo) репозиторий GitHub на локальную рабочую станцию.

2. Запустите сценарий PowerShell для предварительного развертывания: azure-blueprint/predeploy/Orchestration_InitialSetup.ps1.

3. Нажмите кнопку ниже, войдите на портал Azure, введите необходимые параметры шаблона ARM и нажмите кнопку **Приобрести**.

    [![Развертывание в Azure](http://azuredeploy.net/AzureGov.png)](https://portal.azure.us/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Ffedramp-iaas-webapp%2Fmaster%2Fazuredeploy.json)

## <a name="disclaimer"></a>Отказ от ответственности

- Этот документ является исключительно информационным. МАЙКРОСОФТ НЕ ПРЕДОСТАВЛЯЕТ НИКАКИХ ГАРАНТИЙ, ЯВНЫХ, КОСВЕННЫХ ИЛИ ПРЕДУСМОТРЕННЫХ ЗАКОНОМ, В ОТНОШЕНИИ ИНФОРМАЦИИ В ЭТОМ ДОКУМЕНТЕ. Данный документ предоставляется "как есть". Сведения и мнения, представленные в данном документе, включая URL-адреса и ссылки на другие веб-сайты, могут быть изменены без предварительного уведомления. Клиенты, читающие этот документ, берут ответственность за его использование на себя.  
- Настоящий документ не предоставляет клиентам юридических прав на интеллектуальную собственность в отношении продуктов или решений корпорации Майкрософт.  
- Клиенты могут скопировать и использовать данный документ для внутренних справочных целей.  
- Выполнение некоторых рекомендаций в этом документе может привести к более интенсивному использованию данных, а также сетевых и вычислительных ресурсов в Azure, а значит и к дополнительным затратам на лицензии или подписки Azure.  
- Эта архитектура призвана служить основой, которую клиенты должны адаптировать для конкретных требований, и не должна использоваться "как есть" в рабочей среде.
- Этот документ разработан в качестве справочного материала и не определяет все способы, с помощью которых клиент может отвечать нормам и стандартам соответствия. Клиентам следует обратиться к юридическому отделу своей организации, чтобы получить утвержденные варианты пользовательских реализаций.
