---
title: "aaaEncrypt виртуальной машине Azure | Документы Microsoft"
description: "Этот документ поможет вам tooencrypt виртуальной машине Azure после получения оповещения центра обеспечения безопасности Azure."
services: security, security-center
documentationcenter: na
author: TomShinder
manager: swadhwa
editor: 
ms.assetid: f6c28bc4-1f79-4352-89d0-03659b2fa2f5
ms.service: security
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/15/2017
ms.author: tomsh
ms.openlocfilehash: 7c7c6eed39d16bde8a0dfaffe3a3331c58101634
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="encrypt-an-azure-virtual-machine"></a><span data-ttu-id="906e5-103">Шифрование виртуальной машины Azure</span><span class="sxs-lookup"><span data-stu-id="906e5-103">Encrypt an Azure Virtual Machine</span></span>
<span data-ttu-id="906e5-104">Если у вас есть незашифрованные виртуальные машины, центр безопасности Azure оповестит вас.</span><span class="sxs-lookup"><span data-stu-id="906e5-104">Azure Security Center will alert you if you have virtual machines that are not encrypted.</span></span> <span data-ttu-id="906e5-105">Эти предупреждения будут показаны как высокого уровня серьезности и hello рекомендация является tooencrypt эти виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="906e5-105">These alerts will show as High Severity and hello recommendation is tooencrypt these virtual machines.</span></span>

![Рекомендации по шифрованию дисков](./media/security-center-disk-encryption/security-center-disk-encryption-fig1.png)

> [!NOTE]
> <span data-ttu-id="906e5-107">Hello сведения в этом документе относятся tooencrypting виртуальных машин без использования шифрования ключа (который обязателен для резервного копирования виртуальных машин с помощью резервного копирования Azure).</span><span class="sxs-lookup"><span data-stu-id="906e5-107">hello information in this document applies tooencrypting virtual machines without using a Key Encryption Key (which is required for backing up virtual machines using Azure Backup).</span></span> <span data-ttu-id="906e5-108">См. в разделе статьи hello [Azure диск шифрования для Windows и виртуальных машин Linux Azure](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) сведения о том, как toouse toosupport ключа шифрования для зашифрованного виртуальных машин Azure служба архивации Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-108">Please see hello article [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) for information on how toouse a Key Encryption Key toosupport Azure Backup for encrypted Azure Virtual Machines.</span></span>
>
>

<span data-ttu-id="906e5-109">tooencrypt виртуальных машинах Azure, которые идентифицируются центра безопасности Azure, указывающая шифрования, мы рекомендуем hello следующие шаги:</span><span class="sxs-lookup"><span data-stu-id="906e5-109">tooencrypt Azure Virtual Machines that have been identified by Azure Security Center as needing encryption, we recommend hello following steps:</span></span>

* <span data-ttu-id="906e5-110">Установите и настройте Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="906e5-110">Install and configure Azure PowerShell.</span></span> <span data-ttu-id="906e5-111">Это позволит toorun hello PowerShell команды требуется tooset копирование tooencrypt необходимые предварительные требования hello виртуальных машинах Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-111">This will enable you toorun hello PowerShell commands required tooset up hello prerequisites required tooencrypt Azure Virtual Machines.</span></span>
* <span data-ttu-id="906e5-112">Получение и запустите сценарий hello предварительные требования шифрования диска Azure, Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="906e5-112">Obtain and run hello Azure Disk Encryption Prerequisites Azure PowerShell script</span></span>
* <span data-ttu-id="906e5-113">Зашифруйте свои виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="906e5-113">Encrypt your virtual machines</span></span>

<span data-ttu-id="906e5-114">Hello цель данного документа — tooenable вы tooencrypt виртуальные машины, даже при наличии очень низкая или отсутствует в Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="906e5-114">hello goal of this document is tooenable you tooencrypt your virtual machines, even if you have little or no background in Azure PowerShell.</span></span>
<span data-ttu-id="906e5-115">В этом документе предполагается, что вы используете Windows 10 как hello клиентского компьютера, с которого вы настроите шифрование диска Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-115">This document assumes you are using Windows 10 as hello client machine from which you will configure Azure Disk Encryption.</span></span>

<span data-ttu-id="906e5-116">Существует множество подходов, которые могут быть предварительные условия используется toosetup hello и tooconfigure шифрования для виртуальных машин Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-116">There are many approaches that can be used toosetup hello prerequisites and tooconfigure encryption for Azure Virtual Machines.</span></span> <span data-ttu-id="906e5-117">Если вы уже хорошо versed в Azure PowerShell или Azure CLI, то лучше toouse альтернативные подходы.</span><span class="sxs-lookup"><span data-stu-id="906e5-117">If you are already well-versed in Azure PowerShell or Azure CLI, then you may prefer toouse alternate approaches.</span></span>

> [!NOTE]
> <span data-ttu-id="906e5-118">toolearn Дополнительные сведения о шифрования tooconfiguring альтернативные подходы для виртуальных машин Azure, см. в разделе [Azure диск шифрования для Windows и виртуальных машин Linux Azure](https://gallery.technet.microsoft.com/Azure-Disk-Encryption-for-a0018eb0).</span><span class="sxs-lookup"><span data-stu-id="906e5-118">toolearn more about alternate approaches tooconfiguring encryption for Azure virtual machines, please see [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://gallery.technet.microsoft.com/Azure-Disk-Encryption-for-a0018eb0).</span></span>
>
>

## <a name="install-and-configure-azure-powershell"></a><span data-ttu-id="906e5-119">Установка и настройка Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="906e5-119">Install and configure Azure PowerShell</span></span>
<span data-ttu-id="906e5-120">На компьютере необходимо установить Azure PowerShell 1.2.1 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="906e5-120">You need Azure PowerShell version 1.2.1 or above installed on your computer.</span></span> <span data-ttu-id="906e5-121">статья Hello [как tooinstall и настройка Azure PowerShell](/powershell/azure/overview) содержит все hello шаги, которые tooprovision toowork ваш компьютер с помощью Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="906e5-121">hello article [How tooinstall and configure Azure PowerShell](/powershell/azure/overview) contains all hello steps you need tooprovision your computer toowork with Azure PowerShell.</span></span> <span data-ttu-id="906e5-122">наиболее простой подход Hello подход toouse hello Web PI установки упоминаемые в этой статье.</span><span class="sxs-lookup"><span data-stu-id="906e5-122">hello most straightforward approach is toouse hello Web PI installation approach mentioned in that article.</span></span> <span data-ttu-id="906e5-123">Даже если у вас уже есть Azure PowerShell установлен, установить повторно с использованием подхода hello Web PI, чтобы получить последнюю версию Azure PowerShell hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-123">Even if you already have Azure PowerShell installed, install again using hello Web PI approach so that you have hello latest version of Azure PowerShell.</span></span>

## <a name="obtain-and-run-hello-azure-disk-encryption-prerequisites-configuration-script"></a><span data-ttu-id="906e5-124">Получение и выполните необходимые условия для шифрования диска Azure hello скрипт конфигурации</span><span class="sxs-lookup"><span data-stu-id="906e5-124">Obtain and run hello Azure disk encryption prerequisites configuration script</span></span>
<span data-ttu-id="906e5-125">Hello сценарий настройки необходимых компонентов шифрования диска Azure устанавливаются все hello, необходимых для шифрования виртуальные машины Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-125">hello Azure Disk Encryption Prerequisites Configuration Script will set up all hello prerequisites required for encrypting your Azure Virtual Machines.</span></span>

1. <span data-ttu-id="906e5-126">Страница GitHub перейдите toohello hello [Azure диск шифрования необходимых компонентов установки скрипт](https://github.com/Azure/azure-powershell/blob/master/src/ResourceManager/Compute/Commands.Compute/Extension/AzureDiskEncryption/Scripts/AzureDiskEncryptionPreRequisiteSetup.ps1).</span><span class="sxs-lookup"><span data-stu-id="906e5-126">Go toohello GitHub page that has hello [Azure Disk Encryption Prerequisite Setup Script](https://github.com/Azure/azure-powershell/blob/master/src/ResourceManager/Compute/Commands.Compute/Extension/AzureDiskEncryption/Scripts/AzureDiskEncryptionPreRequisiteSetup.ps1).</span></span>
2. <span data-ttu-id="906e5-127">На странице приветствия GibHub щелкните hello **Raw** кнопки.</span><span class="sxs-lookup"><span data-stu-id="906e5-127">On hello GibHub page, click hello **Raw** button.</span></span>
3. <span data-ttu-id="906e5-128">Используйте **CTRL + A** tooselect все hello текста на странице приветствия, а затем используйте **CTRL-C** toocopy все hello текст в буфере обмена toohello страницы приветствия.</span><span class="sxs-lookup"><span data-stu-id="906e5-128">Use **CTRL-A** tooselect all hello text on hello page and then use **CTRL-C** toocopy all hello text on hello page toohello clipboard.</span></span>
4. <span data-ttu-id="906e5-129">Откройте **Блокнот** и вставьте текст hello копируются в Блокнот.</span><span class="sxs-lookup"><span data-stu-id="906e5-129">Open **Notepad** and paste hello copied text into Notepad.</span></span>
5. <span data-ttu-id="906e5-130">Создайте на диске C: новую папку с именем **AzureADEScript**.</span><span class="sxs-lookup"><span data-stu-id="906e5-130">Create a new folder on your C: drive named **AzureADEScript**.</span></span>
6. <span data-ttu-id="906e5-131">Сохраните файл в блокноте hello, нажав **файл**, нажмите кнопку **Сохранить как**.</span><span class="sxs-lookup"><span data-stu-id="906e5-131">Save hello Notepad file – click **File**, then click **Save As**.</span></span> <span data-ttu-id="906e5-132">Введите в текстовое поле имя файла hello **«ADEPrereqScript.ps1»** и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="906e5-132">In hello File name textbox, enter **“ADEPrereqScript.ps1”** and click **Save**.</span></span> <span data-ttu-id="906e5-133">(Убедитесь, что кавычки hello hello имя, в противном случае он hello-файл будет сохранен с расширением .txt).</span><span class="sxs-lookup"><span data-stu-id="906e5-133">(make sure you put hello quotation marks around hello name, otherwise it will save hello file with a .txt file extension).</span></span>

<span data-ttu-id="906e5-134">Теперь, когда содержимое сценария hello сохраняется, откройте скрипт hello hello интегрированной среды Сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="906e5-134">Now that hello script content is saved, open hello script in hello PowerShell ISE:</span></span>

1. <span data-ttu-id="906e5-135">В hello меню "Пуск", щелкните **Cortana**.</span><span class="sxs-lookup"><span data-stu-id="906e5-135">In hello Start Menu, click **Cortana**.</span></span> <span data-ttu-id="906e5-136">Попросите **Cortana** «PowerShell», введя **PowerShell** в Cortana hello поиска.</span><span class="sxs-lookup"><span data-stu-id="906e5-136">Ask **Cortana** “PowerShell” by typing **PowerShell** in hello Cortana search text box.</span></span>
2. <span data-ttu-id="906e5-137">Щелкните правой кнопкой мыши **Интегрированная среда сценариев Windows PowerShell** и выберите пункт **Запуск от имени администратора**.</span><span class="sxs-lookup"><span data-stu-id="906e5-137">Right click **Windows PowerShell ISE** and click **Run as administrator**.</span></span>
3. <span data-ttu-id="906e5-138">В hello **администратор: Windows PowerShell ISE** окно, нажмите кнопку **представление** и нажмите кнопку **Показать область сценариев**.</span><span class="sxs-lookup"><span data-stu-id="906e5-138">In hello **Administrator: Windows PowerShell ISE** window, click **View** and then click **Show Script Pane**.</span></span>
4. <span data-ttu-id="906e5-139">Если вы видите hello **команды** панели hello правой части окна приветствия щелкните hello **«x»** в hello правом верхнем углу панели tooclose hello его.</span><span class="sxs-lookup"><span data-stu-id="906e5-139">If you see hello **Commands** pane on hello right side of hello window, click hello **“x”** in hello top right corner of hello pane tooclose it.</span></span> <span data-ttu-id="906e5-140">Если текст hello слишком мал для вас toosee, используйте **CTRL + добавить** («Добавить» — hello «знак "+"»).</span><span class="sxs-lookup"><span data-stu-id="906e5-140">If hello text is too small for you toosee, use **CTRL+Add** (“Add” is hello “+” sign).</span></span> <span data-ttu-id="906e5-141">Если текст hello слишком велико, используйте **CTRL + Subtract** (Subtract — hello»-«входа).</span><span class="sxs-lookup"><span data-stu-id="906e5-141">If hello text is too large, use **CTRL+Subtract** (Subtract is hello “-“ sign).</span></span>
5. <span data-ttu-id="906e5-142">Щелкните **Файл** и выберите пункт **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="906e5-142">Click **File** and then click **Open**.</span></span> <span data-ttu-id="906e5-143">Перейдите toohello **C:\AzureADEScript** папки и hello дважды щелкнуть hello **ADEPrereqScript**.</span><span class="sxs-lookup"><span data-stu-id="906e5-143">Navigate toohello **C:\AzureADEScript** folder and hello double-click on hello **ADEPrereqScript**.</span></span>
6. <span data-ttu-id="906e5-144">Hello **ADEPrereqScript** содержимое должен появиться в интегрированной среде Сценариев PowerShell hello и имеет цветовую маркировку toohelp более легко получить различные компоненты, такие как команды, параметры и переменные.</span><span class="sxs-lookup"><span data-stu-id="906e5-144">hello **ADEPrereqScript** contents should now appear in hello PowerShell ISE and is color-coded toohelp you see various components, such as commands, parameters and variables more easily.</span></span>

<span data-ttu-id="906e5-145">Вы увидите нечто похожее на следующем рисунке hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-145">You should now see something like hello figure below.</span></span>

![Окно PowerShell ISE](./media/security-center-disk-encryption/security-center-disk-encryption-fig2.png)

<span data-ttu-id="906e5-147">hello нижней области — ссылка tooas hello «консоли» Hello верхней панели — hello tooas ссылка «"панель сценарий»</span><span class="sxs-lookup"><span data-stu-id="906e5-147">hello top pane is referred tooas hello “script pane” and hello bottom pane is referred tooas hello “console”.</span></span> <span data-ttu-id="906e5-148">Мы будем использовать эти термины далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="906e5-148">We will use these terms later in this article.</span></span>

## <a name="run-hello-azure-disk-encryption-prerequisites-powershell-command"></a><span data-ttu-id="906e5-149">Выполните команду PowerShell предварительные требования шифрования диска Azure hello</span><span class="sxs-lookup"><span data-stu-id="906e5-149">Run hello Azure disk encryption prerequisites PowerShell command</span></span>
<span data-ttu-id="906e5-150">Предварительные требования для шифрования диска Azure скрипт Hello запросит следующую информацию, после запуска сценария hello hello:</span><span class="sxs-lookup"><span data-stu-id="906e5-150">hello Azure Disk Encryption Prerequisites script will ask you for hello following information after you start hello script:</span></span>

* <span data-ttu-id="906e5-151">**Имя группы ресурсов** — имя для группы ресурсов, которые должны tooput hello hello хранилище ключей в.</span><span class="sxs-lookup"><span data-stu-id="906e5-151">**Resource Group Name** - Name of hello Resource Group that you want tooput hello Key Vault into.</span></span>  <span data-ttu-id="906e5-152">Если его не существует уже с таким именем создан создается новую группу ресурсов с именем Привет вводимых вами.</span><span class="sxs-lookup"><span data-stu-id="906e5-152">A new Resource Group with hello name you enter will be created if there isn’t already one with that name created.</span></span> <span data-ttu-id="906e5-153">При наличии группы ресурсов, которые должны toouse в эту подписку, затем введите имя hello данной группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="906e5-153">If you already have a Resource Group that you want toouse in this subscription, then enter hello name of that Resource Group.</span></span>
* <span data-ttu-id="906e5-154">**Имя хранилища ключей** -имя хранилища ключей hello, в какие шифрования, ключи toobe разместить.</span><span class="sxs-lookup"><span data-stu-id="906e5-154">**Key Vault Name** - Name of hello Key Vault in which encryption keys are toobe placed.</span></span> <span data-ttu-id="906e5-155">Будет создано хранилище ключей с таким именем (если оно еще не создано).</span><span class="sxs-lookup"><span data-stu-id="906e5-155">A new Key Vault with this name will be created if you don’t already have a Key Vault with this name.</span></span> <span data-ttu-id="906e5-156">Если уже имеется хранилище ключей, которые должны toouse, введите имя hello hello существующие хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="906e5-156">If you already have a Key Vault that you want toouse, enter hello name of hello existing Key Vault.</span></span>
* <span data-ttu-id="906e5-157">**Расположение** -расположение hello хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="906e5-157">**Location** - Location of hello Key Vault.</span></span> <span data-ttu-id="906e5-158">Убедитесь, что hello хранилище ключей и виртуальные машины toobe зашифрованы в hello местоположения.</span><span class="sxs-lookup"><span data-stu-id="906e5-158">Make sure hello Key Vault and VMs toobe encrypted are in hello same location.</span></span> <span data-ttu-id="906e5-159">Если вам не известно расположение hello, далее в этой статье, будет показано, как будут действия toofind out.</span><span class="sxs-lookup"><span data-stu-id="906e5-159">If you don’t know hello location, there are steps later in this article that will show you how toofind out.</span></span>
* <span data-ttu-id="906e5-160">**Имя приложения с Azure Active Directory** -имя hello приложений Azure Active Directory, используемые toowrite секреты toohello хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="906e5-160">**Azure Active Directory Application Name** - Name of hello Azure Active Directory application that will be used toowrite secrets toohello Key Vault.</span></span> <span data-ttu-id="906e5-161">Будет создано приложение с таким именем (если оно еще не создано).</span><span class="sxs-lookup"><span data-stu-id="906e5-161">A new application with this name will be created if one doesn't exist.</span></span> <span data-ttu-id="906e5-162">Если уже имеется приложение Azure Active Directory, что требуется toouse, введите имя hello этого приложения Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="906e5-162">If you already have an Azure Active Directory application that you want toouse, enter hello name of that Azure Active Directory application.</span></span>

> [!NOTE]
> <span data-ttu-id="906e5-163">Если интересно как toowhy необходимо toocreate приложения Azure Active Directory, см. в разделе *зарегистрировать приложение в Azure Active Directory* hello статьи [Приступая к работе с хранилищем ключей Azure](../key-vault/key-vault-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="906e5-163">If you’re curious as toowhy you need toocreate an Azure Active Directory application, please see *Register an application with Azure Active Directory* section in hello article [Getting Started with Azure Key Vault](../key-vault/key-vault-get-started.md).</span></span>
>
>

<span data-ttu-id="906e5-164">Выполните следующие шаги tooencrypt виртуальной машине Azure hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-164">Perform hello following steps tooencrypt an Azure Virtual Machine:</span></span>

1. <span data-ttu-id="906e5-165">Если закрыто hello интегрированной среды Сценариев PowerShell, откройте экземпляр hello интегрированной среды Сценариев PowerShell с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="906e5-165">If you closed hello PowerShell ISE, open an elevated instance of hello PowerShell ISE.</span></span> <span data-ttu-id="906e5-166">Следуйте инструкциям hello ранее в этой статье, если открыть интегрированной среды Сценариев PowerShell еще не приветствия.</span><span class="sxs-lookup"><span data-stu-id="906e5-166">Follow hello instructions earlier in this article if hello PowerShell ISE is not already open.</span></span> <span data-ttu-id="906e5-167">При закрытии скрипт hello откройте hello **ADEPrereqScript.ps1** щелкнув **файл**, затем **откройте** и выбрав команду сценария hello hello **c:\ AzureADEScript** папки.</span><span class="sxs-lookup"><span data-stu-id="906e5-167">If you closed hello script, then open hello **ADEPrereqScript.ps1** clicking **File**, then **Open** and selecting hello script from hello **c:\AzureADEScript** folder.</span></span> <span data-ttu-id="906e5-168">Если в этой статье были выполнены с начала hello, просто переместите на следующем шаге toohello.</span><span class="sxs-lookup"><span data-stu-id="906e5-168">If you have followed this article from hello start, then just move on toohello next step.</span></span>
2. <span data-ttu-id="906e5-169">В консоли hello hello интегрированной среды Сценариев PowerShell (hello нижней части интегрированной среды Сценариев PowerShell hello), изменить локальной toohello фокус hello hello сценария, введя **cd c:\AzureADEScript** и нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-169">In hello console of hello PowerShell ISE (hello bottom pane of hello PowerShell ISE), change hello focus toohello local of hello script by typing **cd c:\AzureADEScript** and press **ENTER**.</span></span>
3. <span data-ttu-id="906e5-170">Задайте политику выполнения hello на компьютере, чтобы обеспечить возможность выполнения скрипта hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-170">Set hello execution policy on your machine so that you can run hello script.</span></span> <span data-ttu-id="906e5-171">Тип **Set-ExecutionPolicy Unrestricted** в hello консоли и нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="906e5-171">Type **Set-ExecutionPolicy Unrestricted** in hello console and then press ENTER.</span></span> <span data-ttu-id="906e5-172">Если отображается диалоговое окно, сообщение о эффекты hello hello изменение tooexecution политики, щелкните **Да tooall** или **Да** (Если вы видите **Да tooall**, выберите соответствующий параметр – если Вы не видите **Да tooall**, нажмите кнопку **Да**).</span><span class="sxs-lookup"><span data-stu-id="906e5-172">If you see a dialog box telling about hello effects of hello change tooexecution policy, click either **Yes tooall** or **Yes** (if you see **Yes tooall**, select that option – if you do not see **Yes tooall**, then click **Yes**).</span></span>
4. <span data-ttu-id="906e5-173">Войдите в свою учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-173">Log into your Azure account.</span></span> <span data-ttu-id="906e5-174">Можно ввести в консоли hello **входа AzureRmAccount** и нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-174">In hello console, type **Login-AzureRmAccount** and press **ENTER**.</span></span> <span data-ttu-id="906e5-175">Диалоговое окно будет отображаться, в котором можно ввести учетные данные (Убедитесь, что у вас есть права toochange hello виртуальных машин — Если нет прав, не будет возможности tooencrypt их.</span><span class="sxs-lookup"><span data-stu-id="906e5-175">A dialog box will appear in which you enter your credentials (make sure you have rights toochange hello virtual machines – if you do not have rights, you will not be able tooencrypt them.</span></span> <span data-ttu-id="906e5-176">(Убедитесь, что у вас есть права на изменение виртуальных машин, иначе вы не сможете зашифровать виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="906e5-176">If you are not sure, ask your subscription owner or administrator).</span></span> <span data-ttu-id="906e5-177">Вы должны увидеть сведения о **среде**, **учетной записи**, а также **TenantId**, **SubscriptionId** и **CurrentStorageAccount**.</span><span class="sxs-lookup"><span data-stu-id="906e5-177">You should see information about your **Environment**, **Account**, **TenantId**, **SubscriptionId** and **CurrentStorageAccount**.</span></span> <span data-ttu-id="906e5-178">Копировать hello **SubscriptionId** tooNotepad.</span><span class="sxs-lookup"><span data-stu-id="906e5-178">Copy hello **SubscriptionId** tooNotepad.</span></span> <span data-ttu-id="906e5-179">Он потребуется toouse на шаге #6.</span><span class="sxs-lookup"><span data-stu-id="906e5-179">You will need toouse this in step #6.</span></span>
5. <span data-ttu-id="906e5-180">Найти какие подписки виртуальный компьютер принадлежит tooand его расположение.</span><span class="sxs-lookup"><span data-stu-id="906e5-180">Find what subscription your virtual machine belongs tooand its location.</span></span> <span data-ttu-id="906e5-181">Go слишком[https://portal.azure.com](ttps://portal.azure.com) и войдите в систему.</span><span class="sxs-lookup"><span data-stu-id="906e5-181">Go too[https://portal.azure.com](ttps://portal.azure.com) and log in.</span></span>  <span data-ttu-id="906e5-182">Щелкните hello левая сторона страницы приветствия, **виртуальные машины**.</span><span class="sxs-lookup"><span data-stu-id="906e5-182">On hello left side of hello page, click **Virtual Machines**.</span></span> <span data-ttu-id="906e5-183">Вы увидите список виртуальных машин и hello подписки, которым они принадлежат.</span><span class="sxs-lookup"><span data-stu-id="906e5-183">You will see a list of your virtual machines and hello subscriptions they belong to.</span></span>

   ![Виртуальные машины](./media/security-center-disk-encryption/security-center-disk-encryption-fig3.png)
6. <span data-ttu-id="906e5-185">Возвращает toohello интегрированной среды Сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="906e5-185">Return toohello PowerShell ISE.</span></span> <span data-ttu-id="906e5-186">Задать контекст hello подписки, в которой будет выполняться скрипт hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-186">Set hello subscription context in which hello script will be run.</span></span> <span data-ttu-id="906e5-187">Можно ввести в консоли hello **Select AzureRmSubscription — SubscriptionId < your_subscription_Id >** (Замените **< your_subscription_Id >** своим Идентификатором подписки фактическое) и нажмите клавишу  **Введите**.</span><span class="sxs-lookup"><span data-stu-id="906e5-187">In hello console, type **Select-AzureRmSubscription –SubscriptionId <your_subscription_Id>** (replace **< your_subscription_Id >** with your actual Subscription ID) and press **ENTER**.</span></span> <span data-ttu-id="906e5-188">Вы увидите сведения о среде, hello **учетной записи**, **TenantId**, **SubscriptionId** и **CurrentStorageAccount**.</span><span class="sxs-lookup"><span data-stu-id="906e5-188">You will see information about hello Environment, **Account**, **TenantId**, **SubscriptionId** and **CurrentStorageAccount**.</span></span>
7. <span data-ttu-id="906e5-189">Теперь вы находитесь готов toorun hello скрипта.</span><span class="sxs-lookup"><span data-stu-id="906e5-189">You are now ready toorun hello script.</span></span> <span data-ttu-id="906e5-190">Нажмите кнопку hello **выполнить сценарий** или клавишу **F5** на клавиатуре hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-190">Click hello **Run Script** button or press **F5** on hello keyboard.</span></span>

   ![Выполнение скрипта PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig4.png)
8. <span data-ttu-id="906e5-192">запрашивает Hello сценарий **resourceGroupName:** -введите имя hello *группы ресурсов* требуется toouse, нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-192">hello script asks for **resourceGroupName:** - enter hello name of *Resource Group* you want toouse, then press **ENTER**.</span></span> <span data-ttu-id="906e5-193">Если у вас его нет, введите имя для нового требуется toouse.</span><span class="sxs-lookup"><span data-stu-id="906e5-193">If you don’t have one, enter a name you want toouse for a new one.</span></span> <span data-ttu-id="906e5-194">Если у вас уже есть *группы ресурсов* требуется toouse (например, «hello один виртуальный компьютер, находящийся в), введите имя hello hello существующие группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="906e5-194">If you already have a *Resource Group* that you want toouse (such as hello one that your virtual machine is in), enter hello name of hello existing Resource Group.</span></span>
9. <span data-ttu-id="906e5-195">запрашивает Hello сценарий **keyVaultName:** -введите имя hello hello *хранилище ключей* toouse и нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="906e5-195">hello script asks for **keyVaultName:** - enter hello name of hello *Key Vault* you want toouse, then press ENTER.</span></span> <span data-ttu-id="906e5-196">Если у вас его нет, введите имя для нового требуется toouse.</span><span class="sxs-lookup"><span data-stu-id="906e5-196">If you don’t have one, enter a name you want toouse for a new one.</span></span> <span data-ttu-id="906e5-197">При наличии нужных toouse хранилище ключей, введите имя hello hello существующих *хранилище ключей*.</span><span class="sxs-lookup"><span data-stu-id="906e5-197">If you already have a Key Vault that you want toouse, enter hello name of hello existing *Key Vault*.</span></span>
10. <span data-ttu-id="906e5-198">запрашивает Hello сценарий **расположение:** — введите имя hello hello расположения, в какие hello находится требуется tooencrypt виртуальной Машины, а затем нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-198">hello script asks for **location:** - enter hello name of hello location in which hello VM you want tooencrypt is located, then press **ENTER**.</span></span> <span data-ttu-id="906e5-199">Если вы не помните hello расположение, вы можете вернуться toostep #5.</span><span class="sxs-lookup"><span data-stu-id="906e5-199">If you don’t remember hello location, go back toostep #5.</span></span>
11. <span data-ttu-id="906e5-200">запрашивает Hello сценарий **aadAppName:** -введите имя hello hello *Azure Active Directory* приложение, требуется toouse, затем нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-200">hello script asks for **aadAppName:** - enter hello name of hello *Azure Active Directory* application you want toouse, then press **ENTER**.</span></span> <span data-ttu-id="906e5-201">Если у вас его нет, введите имя для нового требуется toouse.</span><span class="sxs-lookup"><span data-stu-id="906e5-201">If you don’t have one, enter a name you want toouse for a new one.</span></span> <span data-ttu-id="906e5-202">Если у вас уже есть *приложения Azure Active Directory* требуется toouse, введите имя hello hello существующих *приложения Azure Active Directory*.</span><span class="sxs-lookup"><span data-stu-id="906e5-202">If you already have an *Azure Active Directory application* that you want toouse, enter hello name of hello existing *Azure Active Directory application*.</span></span>
12. <span data-ttu-id="906e5-203">Появится диалоговое окно входа.</span><span class="sxs-lookup"><span data-stu-id="906e5-203">A log in dialog box will appear.</span></span> <span data-ttu-id="906e5-204">Укажите свои учетные данные (Да, необходимо войти в один раз, но теперь требуется toodo его еще раз).</span><span class="sxs-lookup"><span data-stu-id="906e5-204">Provide your credentials (yes, you have logged in once, but now you need toodo it again).</span></span>
13. <span data-ttu-id="906e5-205">сценарий Hello выполняется, а по завершении он запросит значения hello toocopy hello **aadClientID**, **aadClientSecret**, **diskEncryptionKeyVaultUrl**и **keyVaultResourceId**.</span><span class="sxs-lookup"><span data-stu-id="906e5-205">hello script runs and when complete it will ask you toocopy hello values of hello **aadClientID**, **aadClientSecret**, **diskEncryptionKeyVaultUrl**, and **keyVaultResourceId**.</span></span> <span data-ttu-id="906e5-206">Каждый из этих значений toohello буфера копирования и вставьте их в Блокнот.</span><span class="sxs-lookup"><span data-stu-id="906e5-206">Copy each of these values toohello clipboard and paste them into Notepad.</span></span>
14. <span data-ttu-id="906e5-207">Вернуть toohello интегрированной среды Сценариев PowerShell и поместите курсор hello в конце hello последнюю строку hello и нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-207">Return toohello PowerShell ISE and place hello cursor at hello end of hello last line, and press **ENTER**.</span></span>

<span data-ttu-id="906e5-208">Вывод Hello hello скрипта должен выглядеть примерно экран приветствия, показанный ниже:</span><span class="sxs-lookup"><span data-stu-id="906e5-208">hello output of hello script should look something like hello screen below:</span></span>

![Вывод PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig5.png)

## <a name="encrypt-hello-azure-virtual-machine"></a><span data-ttu-id="906e5-210">Шифрование hello виртуальной машины Azure</span><span class="sxs-lookup"><span data-stu-id="906e5-210">Encrypt hello Azure virtual machine</span></span>
<span data-ttu-id="906e5-211">Вы являются tooencrypt теперь готовы к виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="906e5-211">You are now ready tooencrypt your virtual machine.</span></span> <span data-ttu-id="906e5-212">Если виртуальная машина находится в hello же группе ресурсов вашего хранилища ключей, можно переместить на разделе действий toohello шифрования.</span><span class="sxs-lookup"><span data-stu-id="906e5-212">If your virtual machine is located in hello same Resource Group as your Key Vault, you can move on toohello encryption steps section.</span></span> <span data-ttu-id="906e5-213">Тем не менее если виртуальная машина не находится в hello же группа ресурсов как вашего хранилища ключей, вы должны будете tooenter следующие hello в hello консоли в интегрированной среде Сценариев PowerShell hello:</span><span class="sxs-lookup"><span data-stu-id="906e5-213">However, if your virtual machine is not in hello same Resource Group as your Key Vault, you will need tooenter hello following in hello console in hello PowerShell ISE:</span></span>

<span data-ttu-id="906e5-214">**$resourceGroupName = <’Virtual_Machine_RG’>**</span><span class="sxs-lookup"><span data-stu-id="906e5-214">**$resourceGroupName = <’Virtual_Machine_RG’>**</span></span>

<span data-ttu-id="906e5-215">Замените **< Virtual_Machine_RG >** с именем hello hello группы ресурсов, в котором содержатся виртуальные машины, заключенных в одинарные кавычки.</span><span class="sxs-lookup"><span data-stu-id="906e5-215">Replace **< Virtual_Machine_RG >** with hello name of hello Resource Group in which your virtual machines are contained, surrounded by a single quote.</span></span> <span data-ttu-id="906e5-216">Нажмите клавишу **ВВОД**.</span><span class="sxs-lookup"><span data-stu-id="906e5-216">Then press **ENTER**.</span></span>
<span data-ttu-id="906e5-217">tooconfirm, Здравствуйте правильных введено имя группы ресурсов, введите ниже hello в hello консоли интегрированной среды Сценариев PowerShell:</span><span class="sxs-lookup"><span data-stu-id="906e5-217">tooconfirm that hello correct Resource Group name was entered, type hello following in hello PowerShell ISE console:</span></span>

<span data-ttu-id="906e5-218">**$resourceGroupName**</span><span class="sxs-lookup"><span data-stu-id="906e5-218">**$resourceGroupName**</span></span>

<span data-ttu-id="906e5-219">Нажмите клавишу **ВВОД**.</span><span class="sxs-lookup"><span data-stu-id="906e5-219">Press **ENTER**.</span></span> <span data-ttu-id="906e5-220">Вы увидите hello имя группы ресурсов, виртуальные машины находятся в.</span><span class="sxs-lookup"><span data-stu-id="906e5-220">You should see hello name of Resource Group that your virtual machines are located in.</span></span> <span data-ttu-id="906e5-221">Например:</span><span class="sxs-lookup"><span data-stu-id="906e5-221">For example:</span></span>

![Вывод PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig6.png)

### <a name="encryption-steps"></a><span data-ttu-id="906e5-223">Шаги шифрования</span><span class="sxs-lookup"><span data-stu-id="906e5-223">Encryption steps</span></span>
<span data-ttu-id="906e5-224">Во-первых, необходимо имя hello PowerShell tootell hello виртуальной машины требуется tooencrypt.</span><span class="sxs-lookup"><span data-stu-id="906e5-224">First, you need tootell PowerShell hello name of hello virtual machine you want tooencrypt.</span></span> <span data-ttu-id="906e5-225">В консоли hello введите:</span><span class="sxs-lookup"><span data-stu-id="906e5-225">In hello console, type:</span></span>

<span data-ttu-id="906e5-226">**$vmName = <’your_vm_name’>**</span><span class="sxs-lookup"><span data-stu-id="906e5-226">**$vmName = <’your_vm_name’>**</span></span>

<span data-ttu-id="906e5-227">Замените **< your_vm_name >** с именем hello вашей виртуальной машины (Убедитесь, что имя hello, заключенных в одинарные кавычки) и нажмите клавишу **ввод**.</span><span class="sxs-lookup"><span data-stu-id="906e5-227">Replace **<’your_vm_name’>** with hello name of your VM (make sure hello name is surrounded by a single quote) and then press **ENTER**.</span></span>

<span data-ttu-id="906e5-228">tooconfirm, Здравствуйте правильных введено имя виртуальной Машины, введите:</span><span class="sxs-lookup"><span data-stu-id="906e5-228">tooconfirm that hello correct VM name was entered, type:</span></span>

<span data-ttu-id="906e5-229">**$vmName**</span><span class="sxs-lookup"><span data-stu-id="906e5-229">**$vmName**</span></span>

<span data-ttu-id="906e5-230">Нажмите клавишу **ВВОД**.</span><span class="sxs-lookup"><span data-stu-id="906e5-230">Press **ENTER**.</span></span> <span data-ttu-id="906e5-231">Вы увидите имя hello hello виртуальной машины требуется tooencrypt.</span><span class="sxs-lookup"><span data-stu-id="906e5-231">You should see hello name of hello virtual machine you want tooencrypt.</span></span> <span data-ttu-id="906e5-232">Например:</span><span class="sxs-lookup"><span data-stu-id="906e5-232">For example:</span></span>

![Вывод PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig7.png)

<span data-ttu-id="906e5-234">Существует два методы toorun hello шифрования команда tooencrypt все диски на виртуальной машине hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-234">There are two methods toorun hello encryption command tooencrypt all drives on hello virtual machine.</span></span> <span data-ttu-id="906e5-235">Первый метод Hello является hello tootype следующую команду в консоли PowerShell ISE hello:</span><span class="sxs-lookup"><span data-stu-id="906e5-235">hello first method is tootype hello following command in hello PowerShell ISE console:</span></span>

~~~
Set-AzureRmVMDiskEncryptionExtension -ResourceGroupName $resourceGroupName -VMName $vmName -AadClientID $aadClientID -AadClientSecret $aadClientSecret -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $keyVaultResourceId -VolumeType All
~~~

<span data-ttu-id="906e5-236">Введя эту команду, нажмите клавишу **ВВОД**.</span><span class="sxs-lookup"><span data-stu-id="906e5-236">After typing this command press **ENTER**.</span></span>

<span data-ttu-id="906e5-237">Второй метод Hello — tooclick в области сценариев hello (hello верхней панели hello интегрированной среды Сценариев PowerShell) и прокрутите вниз toohello конец скрипта hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-237">hello second method is tooclick in hello script pane (hello top pane of hello PowerShell ISE) and scroll down toohello bottom of hello script.</span></span> <span data-ttu-id="906e5-238">Выделите команду hello, перечисленных выше и затем щелкните правой кнопкой мыши его и нажмите кнопку **выполнить выделенный фрагмент** или нажмите клавишу **F8** на клавиатуре hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-238">Highlight hello command listed above, and then right click it and then click **Run Selection** or press **F8** on hello keyboard.</span></span>

![Интегрированная среда сценариев PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig8.png)

<span data-ttu-id="906e5-240">Независимо от метода hello используется, диалоговое окно будет отображаться информирующее 10 – 15 минут для операции toocomplete hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-240">Regardless of hello method you use, a dialog box will appear informing you that it will take 10-15 minutes for hello operation toocomplete.</span></span> <span data-ttu-id="906e5-241">Щелкните **Да**.</span><span class="sxs-lookup"><span data-stu-id="906e5-241">Click **Yes**.</span></span>

<span data-ttu-id="906e5-242">Во время процесса шифрования hello, можно возвращать toohello портала Azure и просмотреть состояние hello hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="906e5-242">While hello encryption process is taking place, you can return toohello Azure Portal and see hello status of hello virtual machine.</span></span> <span data-ttu-id="906e5-243">На hello левая сторона страницы приветствия, нажмите кнопку **виртуальные машины**, затем в hello **виртуальные машины** колонка, щелкните имя виртуальной машины hello, шифрование hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-243">On hello left side of hello page, click **Virtual Machines**, then in hello **Virtual Machines** blade, click hello name of hello virtual machine you’re encrypting.</span></span> <span data-ttu-id="906e5-244">В колонке hello, которое отображается, вы заметите, что hello **состояние** говорит, что это **обновление**.</span><span class="sxs-lookup"><span data-stu-id="906e5-244">In hello blade that appears, you’ll notice that hello **Status** says that it’s **Updating**.</span></span> <span data-ttu-id="906e5-245">которое свидетельствует о выполнении шифрования.</span><span class="sxs-lookup"><span data-stu-id="906e5-245">This demonstrates that encryption is in process.</span></span>

![Дополнительные сведения о hello виртуальной Машины](./media/security-center-disk-encryption/security-center-disk-encryption-fig9.png)

<span data-ttu-id="906e5-247">Возвращает toohello интегрированной среды Сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="906e5-247">Return toohello PowerShell ISE.</span></span> <span data-ttu-id="906e5-248">После завершения скрипта hello, вы увидите, что будет отображаться в приведенном ниже рисунке hello.</span><span class="sxs-lookup"><span data-stu-id="906e5-248">When hello script completes, you’ll see what appears in hello figure below.</span></span>

![Вывод PowerShell](./media/security-center-disk-encryption/security-center-disk-encryption-fig10.png)

<span data-ttu-id="906e5-250">Теперь шифруется toodemonstrate, hello виртуальной машины, возвращают toohello портала Azure и нажмите кнопку **виртуальные машины** на hello левая сторона страницы приветствия.</span><span class="sxs-lookup"><span data-stu-id="906e5-250">toodemonstrate that hello virtual machine is now encrypted, return toohello Azure Portal and click **Virtual Machines** on hello left side of hello page.</span></span> <span data-ttu-id="906e5-251">Щелкните имя hello hello виртуальной машины, которые были зашифрованы.</span><span class="sxs-lookup"><span data-stu-id="906e5-251">Click hello name of hello virtual machine you encrypted.</span></span> <span data-ttu-id="906e5-252">В hello **параметры** колонка, щелкните **дисков**.</span><span class="sxs-lookup"><span data-stu-id="906e5-252">In hello **Settings** blade, click **Disks**.</span></span>

![Параметры](./media/security-center-disk-encryption/security-center-disk-encryption-fig11.png)

<span data-ttu-id="906e5-254">На hello **дисков** колонку, вы увидите, что **шифрования** — **включено**.</span><span class="sxs-lookup"><span data-stu-id="906e5-254">On hello **Disks** blade, you will see that **Encryption** is **Enabled**.</span></span>

![Свойства дисков](./media/security-center-disk-encryption/security-center-disk-encryption-fig12.png)

## <a name="next-steps"></a><span data-ttu-id="906e5-256">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="906e5-256">Next steps</span></span>
<span data-ttu-id="906e5-257">В этом документе вы узнали, каким образом tooencrypt виртуальной машине Azure.</span><span class="sxs-lookup"><span data-stu-id="906e5-257">In this document, you learned how tooencrypt an Azure Virtual Machine.</span></span> <span data-ttu-id="906e5-258">toolearn Дополнительные сведения о центра безопасности Azure, см. ниже hello:</span><span class="sxs-lookup"><span data-stu-id="906e5-258">toolearn more about Azure Security Center, see hello following:</span></span>

* <span data-ttu-id="906e5-259">[Наблюдение за работоспособностью системы безопасности в центр безопасности Azure](security-center-monitoring.md) — Узнайте, как toomonitor hello работоспособности ресурсов Azure</span><span class="sxs-lookup"><span data-stu-id="906e5-259">[Security health monitoring in Azure Security Center](security-center-monitoring.md) – Learn how toomonitor hello health of your Azure resources</span></span>
* <span data-ttu-id="906e5-260">[Управление и отвечает на запросы toosecurity предупреждения в центр безопасности Azure](security-center-managing-and-responding-alerts.md) -Узнайте, как предупреждения toosecurity toomanage и ответ</span><span class="sxs-lookup"><span data-stu-id="906e5-260">[Managing and responding toosecurity alerts in Azure Security Center](security-center-managing-and-responding-alerts.md) - Learn how toomanage and respond toosecurity alerts</span></span>
* <span data-ttu-id="906e5-261">[Центр безопасности Azure часто задаваемые вопросы о](security-center-faq.md) — часто задаваемые вопросы об использовании hello службы поиска</span><span class="sxs-lookup"><span data-stu-id="906e5-261">[Azure Security Center FAQ](security-center-faq.md) – Find frequently asked questions about using hello service</span></span>
* <span data-ttu-id="906e5-262">[Блог по безопасности Azure](http://blogs.msdn.com/b/azuresecurity/) — публикации блога, посвященные безопасности Azure и соответствию требованиям.</span><span class="sxs-lookup"><span data-stu-id="906e5-262">[Azure Security Blog](http://blogs.msdn.com/b/azuresecurity/) – Find blog posts about Azure security and compliance</span></span>
