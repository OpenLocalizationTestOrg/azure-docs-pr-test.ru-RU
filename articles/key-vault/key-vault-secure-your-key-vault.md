---
title: "хранилище ключа aaaSecure | Документы Microsoft"
description: "Управление правами доступа к хранилищу ключей для управления хранилищами, ключами и секретами. Модели проверки подлинности и авторизации для хранилища ключей и как toosecure ключа в хранилище"
services: key-vault
documentationcenter: 
author: amitbapat
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: e5b4e083-4a39-4410-8e3a-2832ad6db405
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 01/07/2017
ms.author: ambapat
ms.openlocfilehash: 84f5fc18142a1ad89babbd11f4f65eca105afc32
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="secure-your-key-vault"></a><span data-ttu-id="e192a-104">Защита хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-104">Secure your key vault</span></span>
<span data-ttu-id="e192a-105">Хранилище ключей Azure — это облачная служба, которая обеспечивает защиту ключей шифрования и секретов (например, сертификатов, строк подключения и паролей) для облачных приложений.</span><span class="sxs-lookup"><span data-stu-id="e192a-105">Azure Key Vault is a cloud service that safeguards encryption keys and secrets (such as certificates, connection strings, passwords) for your cloud applications.</span></span> <span data-ttu-id="e192a-106">Поскольку эти данные с учетом и важных для бизнеса, требуется toosecure доступ tooyour ключа хранилища, чтобы только авторизованные приложения и пользователи могут обращаться к хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-106">Since this data is sensitive and business critical, you want toosecure access tooyour key vaults so that only authorized applications and users can access key vault.</span></span> <span data-ttu-id="e192a-107">В этой статье Общие сведения о хранилище ключей доступа к модели, объясняет проверки подлинности и авторизации и описывает, как tookey toosecure доступа в хранилище для облачных приложений, с примерами.</span><span class="sxs-lookup"><span data-stu-id="e192a-107">This article provides an overview of key vault access model, explains authentication and authorization, and describes how toosecure access tookey vault for your cloud applications with an example.</span></span>

## <a name="overview"></a><span data-ttu-id="e192a-108">Обзор</span><span class="sxs-lookup"><span data-stu-id="e192a-108">Overview</span></span>
<span data-ttu-id="e192a-109">Хранилище ключей tooa доступ осуществляется с помощью двух отдельных интерфейсов: плоскости управления и информационной панели.</span><span class="sxs-lookup"><span data-stu-id="e192a-109">Access tooa key vault is controlled through two separate interfaces: management plane and data plane.</span></span> <span data-ttu-id="e192a-110">Для обоих плоскости надлежащую проверку подлинности и авторизации требуется вызывающего объекта (пользователя или приложения) можно получить доступ tookey хранилища.</span><span class="sxs-lookup"><span data-stu-id="e192a-110">For both planes proper authentication and authorization is required before a caller (a user or an application) can get access tookey vault.</span></span> <span data-ttu-id="e192a-111">Проверка подлинности устанавливает идентификацию hello вызывающему Привет, во время авторизации определяет, какие операции hello вызывающий разрешен tooperform.</span><span class="sxs-lookup"><span data-stu-id="e192a-111">Authentication establishes hello identity of hello caller, while authorization determines what operations hello caller is allowed tooperform.</span></span>

<span data-ttu-id="e192a-112">Для проверки подлинности в плоскости управления и плоскости данных используется Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-112">For authentication both management plane and data plane use Azure Active Directory.</span></span> <span data-ttu-id="e192a-113">Для авторизации в плоскости управления используется управление доступом на основе ролей (RBAC), а в плоскости данных — политика доступа к хранилищу ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-113">For authorization, management plane uses role-based access control (RBAC) while data plane uses key vault access policy.</span></span>

<span data-ttu-id="e192a-114">Ниже приведен краткий обзор hello подразделов:</span><span class="sxs-lookup"><span data-stu-id="e192a-114">Here is a brief overview of hello topics covered:</span></span>

<span data-ttu-id="e192a-115">[Проверка подлинности с использованием Azure Active Directory](#authentication-using-azure-active-directory) -в этом разделе описывается, как вызывающий объект использует для проверки подлинности Azure Active Directory tooaccess ключа хранилища через панель управления и информационной панели.</span><span class="sxs-lookup"><span data-stu-id="e192a-115">[Authentication using Azure Active Directory](#authentication-using-azure-active-directory) - This section explains how a caller authenticates with Azure Active Directory tooaccess a key vault via management plane and data plane.</span></span> 

<span data-ttu-id="e192a-116">[Плоскость управления и плоскость данных.](#management-plane-and-data-plane) Плоскость управления и плоскость данных — это две плоскости доступа к хранилищу ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-116">[Management plane and data plane](#management-plane-and-data-plane) - Management plane and data plane are two access planes used for accessing your key vault.</span></span> <span data-ttu-id="e192a-117">В каждой плоскости доступа поддерживаются определенные операции.</span><span class="sxs-lookup"><span data-stu-id="e192a-117">Each access plane supports specific operations.</span></span> <span data-ttu-id="e192a-118">В этом разделе описываются hello конечные точки доступа, операции поддерживаются и доступ к методу элемента управления, используемые каждой плоскости.</span><span class="sxs-lookup"><span data-stu-id="e192a-118">This section describes hello access endpoints, operations supported, and access control method used by each plane.</span></span> 

<span data-ttu-id="e192a-119">[Управление доступом плоскости управления](#management-plane-access-control) — в этом разделе мы рассмотрим доступ toomanagement плоскость операций с помощью управления доступом на основе ролей.</span><span class="sxs-lookup"><span data-stu-id="e192a-119">[Management plane access control](#management-plane-access-control) - In this section we'll look at allowing access toomanagement plane operations using role-based access control.</span></span>

<span data-ttu-id="e192a-120">[Управление доступом плоскости данных](#data-plane-access-control) -в этом разделе описываются, как данные toocontrol политики доступа хранилища ключей toouse плоскости доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-120">[Data plane access control](#data-plane-access-control) - This section describes how toouse key vault access policy toocontrol data plane access.</span></span>

<span data-ttu-id="e192a-121">[Пример](#example) -в этом примере описывается, как элемент управления для вашего хранилища ключей tooallow тремя различными группами (группа безопасности, разработчики и операторы и аудиторы) доступ к toosetup toodevelop tooperform конкретные задачи, управление и наблюдение за приложениями в Azure .</span><span class="sxs-lookup"><span data-stu-id="e192a-121">[Example](#example) - This example describes how toosetup access control for your key vault tooallow three different teams (security team, developers/operators, and auditors) tooperform specific tasks toodevelop, manage and monitor an application in Azure.</span></span>

## <a name="authentication-using-azure-active-directory"></a><span data-ttu-id="e192a-122">Проверка подлинности с помощью Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="e192a-122">Authentication using Azure Active Directory</span></span>
<span data-ttu-id="e192a-123">При создании хранилища ключей в подписку Azure, автоматически связывается с клиентом Azure Active Directory hello подписки.</span><span class="sxs-lookup"><span data-stu-id="e192a-123">When you create a key vault in an Azure subscription, it is automatically associated with hello subscription's Azure Active Directory tenant.</span></span> <span data-ttu-id="e192a-124">Все вызывающие объекты (пользователи и приложения) должны быть зарегистрированы в этом tooaccess клиента этому хранилищу ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-124">All callers (users and applications) must be registered in this tenant tooaccess this key vault.</span></span> <span data-ttu-id="e192a-125">Приложение или пользователь должен пройти проверку подлинности с помощью хранилища ключей tooaccess Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-125">An application or a user must authenticate with Azure Active Directory tooaccess key vault.</span></span> <span data-ttu-id="e192a-126">Это относится плоскости управления tooboth и информационной панели доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-126">This applies tooboth management plane and data plane access.</span></span> <span data-ttu-id="e192a-127">В обоих случаях приложение может получить доступ к хранилищу ключей двумя способами.</span><span class="sxs-lookup"><span data-stu-id="e192a-127">In both cases, an application can access key vault in two ways:</span></span>

* <span data-ttu-id="e192a-128">**Доступ с помощью пользователя и приложения.** Обычно этот способ используется для приложений, которые получают доступ к хранилищу ключей от имени выполнившего вход пользователя.</span><span class="sxs-lookup"><span data-stu-id="e192a-128">**user+app access** - usually this is for applications that access key vault on behalf of a signed-in user.</span></span> <span data-ttu-id="e192a-129">Такой доступ осуществляется через Azure PowerShell и портал Azure.</span><span class="sxs-lookup"><span data-stu-id="e192a-129">Azure PowerShell, Azure Portal are examples of this type of access.</span></span> <span data-ttu-id="e192a-130">Существует два способа доступа toousers toogrant: один из способов — toousers toogrant доступа хранилища ключей для доступа к из любого приложения, hello другим способом toogrant хранилище tookey доступ пользователя только в том случае, если они используют конкретного приложения (который ссылается tooas составным удостоверением).</span><span class="sxs-lookup"><span data-stu-id="e192a-130">There are two ways toogrant access toousers: one way is toogrant access toousers so they can access key vault from any application and hello other way is toogrant a user access tookey vault only when they use a specific application (referred tooas compound identity).</span></span> 
* <span data-ttu-id="e192a-131">**доступ только для приложений** — для приложений, запуска управляющей программы служб, фоновых заданий удостоверения приложения hello, т. д., предоставляется доступ к toohello ключа хранилища.</span><span class="sxs-lookup"><span data-stu-id="e192a-131">**app-only access** - for applications that run daemon services, background jobs etc. hello application's identity is granted access toohello key vault.</span></span>

<span data-ttu-id="e192a-132">В обоих типов приложений приложения hello проходит аутентификацию в Azure Active Directory с помощью любого hello [поддерживаемые методы проверки подлинности](../active-directory/active-directory-authentication-scenarios.md) и получает маркер.</span><span class="sxs-lookup"><span data-stu-id="e192a-132">In both types of applications, hello application authenticates with Azure Active Directory using any of hello [supported authentication methods](../active-directory/active-directory-authentication-scenarios.md) and acquires a token.</span></span> <span data-ttu-id="e192a-133">Используемый метод проверки подлинности зависит от типа приложения hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-133">Authentication method used depends on hello application type.</span></span> <span data-ttu-id="e192a-134">Затем приложение hello использует этот маркер и отправляет хранилище tookey запроса API-интерфейса REST.</span><span class="sxs-lookup"><span data-stu-id="e192a-134">Then hello application uses this token and sends REST API request tookey vault.</span></span> <span data-ttu-id="e192a-135">В случае hello доступа плоскости управления запросы направляются через конечную точку диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="e192a-135">In case of management plane access hello requests are routed through Azure Resource Manager endpoint.</span></span> <span data-ttu-id="e192a-136">При доступе к информационной панели, приложения hello напрямую обращается конечной точки tooa хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-136">When accessing data plane, hello applications talks directly tooa key vault endpoint.</span></span> <span data-ttu-id="e192a-137">Дополнительные сведения см. в разделе на hello [потока проверки подлинности](../active-directory/active-directory-protocols-oauth-code.md).</span><span class="sxs-lookup"><span data-stu-id="e192a-137">See more details on hello [whole authentication flow](../active-directory/active-directory-protocols-oauth-code.md).</span></span> 

<span data-ttu-id="e192a-138">Имя ресурса Hello, для которой приложение hello запрашивает маркер отличается в зависимости от того, является ли доступ к приложения hello плоскости управления или информационной панели.</span><span class="sxs-lookup"><span data-stu-id="e192a-138">hello resource name for which hello application requests a token is different depending on whether hello application is accessing management plane or data plane.</span></span> <span data-ttu-id="e192a-139">Таким образом hello имя ресурса является либо плоскости или данных плоскости конечная точка управления описанные в таблице hello в одном из следующих разделов, в зависимости от hello среды Azure.</span><span class="sxs-lookup"><span data-stu-id="e192a-139">Hence hello resource name is either management plane or data plane endpoint described in hello table in a later section, depending on hello Azure environment.</span></span>

<span data-ttu-id="e192a-140">Наличие одного единый механизм для проверки подлинности tooboth плоскости управления и данных имеет собственные преимущества.</span><span class="sxs-lookup"><span data-stu-id="e192a-140">Having one single mechanism for authentication tooboth management and data plane has its own benefits:</span></span>

* <span data-ttu-id="e192a-141">Организации могут централизованного контроля доступа tooall ключа хранилища в своей организации</span><span class="sxs-lookup"><span data-stu-id="e192a-141">Organizations can centrally control access tooall key vaults in their organization</span></span>
* <span data-ttu-id="e192a-142">После ухода пользователя, немедленно потеряют доступ tooall ключа хранилища в организации hello</span><span class="sxs-lookup"><span data-stu-id="e192a-142">If a user leaves, they instantly lose access tooall key vaults in hello organization</span></span>
* <span data-ttu-id="e192a-143">Организации могут настроить проверку подлинности через параметры hello в Azure Active Directory (например, включение многофакторной проверки подлинности для повышения безопасности)</span><span class="sxs-lookup"><span data-stu-id="e192a-143">Organizations can customize authentication via hello options in Azure Active Directory (for example, enabling multi-factor authentication for added security)</span></span>

## <a name="management-plane-and-data-plane"></a><span data-ttu-id="e192a-144">Плоскость управления и плоскость данных</span><span class="sxs-lookup"><span data-stu-id="e192a-144">Management plane and data plane</span></span>
<span data-ttu-id="e192a-145">Хранилище ключей Azure — это служба Azure, доступная через модель развертывания с помощью Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="e192a-145">Azure Key Vault is an Azure service available via Azure Resource Manager deployment model.</span></span> <span data-ttu-id="e192a-146">При создании хранилища ключей вы получаете виртуальный контейнер, в котором можно создавать другие объекты, например ключи, секреты и сертификаты.</span><span class="sxs-lookup"><span data-stu-id="e192a-146">When you create a key vault, you get a virtual container inside which you can create other objects like keys, secrets, and certificates.</span></span> <span data-ttu-id="e192a-147">Получить доступ к хранилищу ключей с помощью управления плоскости и данные плоскости tooperform конкретных операций.</span><span class="sxs-lookup"><span data-stu-id="e192a-147">Then you access your key vault using management plane and data plane tooperform specific operations.</span></span> <span data-ttu-id="e192a-148">Интерфейс управления плоскость — используется toomanage ключа в хранилище себя, таких как создание, удаление, обновление атрибутов ключа хранилища и настройка политики доступа к информационной панели.</span><span class="sxs-lookup"><span data-stu-id="e192a-148">Management plane interface is used toomanage your key vault itself, such as creating, deleting, updating key vault attributes and setting access policies for data plane.</span></span> <span data-ttu-id="e192a-149">Интерфейс плоскости данных является используется tooadd, удалить, изменить и использовать ключи hello, секреты и сертификаты, находящиеся в хранилище ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-149">Data plane interface is used tooadd, delete, modify, and use hello keys, secrets, and certificates stored in your key vault.</span></span>

<span data-ttu-id="e192a-150">Hello плоскости и данные плоскости интерфейсы управления осуществляется с помощью разных конечных точек (см. таблицу).</span><span class="sxs-lookup"><span data-stu-id="e192a-150">hello management plane and data plane interfaces are accessed through different endpoints (see table).</span></span> <span data-ttu-id="e192a-151">Hello второго столбца в таблице hello описывает hello DNS-имена для этих конечных точек в различных средах Azure.</span><span class="sxs-lookup"><span data-stu-id="e192a-151">hello second column in hello table describes hello DNS names for these endpoints in different Azure environments.</span></span> <span data-ttu-id="e192a-152">Третий столбец Hello описывает hello операции, которые можно выполнять из каждой плоскости доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-152">hello third column describes hello operations you can perform from each access plane.</span></span> <span data-ttu-id="e192a-153">В каждой плоскости доступа также есть свой собственный механизм контроля доступа: в плоскости управления контроль доступа настраивается с помощью RBAC Azure Resource Manager, а в плоскости данных — с помощью политики доступа к хранилищу ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-153">Each access plane also has its own access control mechanism: for management plane access control is set using Azure Resource Manager Role-Based Access Control (RBAC), while for data plane access control is set using key vault access policy.</span></span>

| <span data-ttu-id="e192a-154">Плоскость доступа</span><span class="sxs-lookup"><span data-stu-id="e192a-154">Access plane</span></span> | <span data-ttu-id="e192a-155">Конечные точки доступа</span><span class="sxs-lookup"><span data-stu-id="e192a-155">Access endpoints</span></span> | <span data-ttu-id="e192a-156">Операции</span><span class="sxs-lookup"><span data-stu-id="e192a-156">Operations</span></span> | <span data-ttu-id="e192a-157">Механизм контроля доступа</span><span class="sxs-lookup"><span data-stu-id="e192a-157">Access control mechanism</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e192a-158">Плоскость управления</span><span class="sxs-lookup"><span data-stu-id="e192a-158">Management plane</span></span> |<span data-ttu-id="e192a-159">**Глобально:**</span><span class="sxs-lookup"><span data-stu-id="e192a-159">**Global:**</span></span><br> <span data-ttu-id="e192a-160">management.azure.com:443</span><span class="sxs-lookup"><span data-stu-id="e192a-160">management.azure.com:443</span></span><br><br> <span data-ttu-id="e192a-161">**Azure для Китая:**</span><span class="sxs-lookup"><span data-stu-id="e192a-161">**Azure China:**</span></span><br> <span data-ttu-id="e192a-162">management.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="e192a-162">management.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="e192a-163">**Azure для правительства США:**</span><span class="sxs-lookup"><span data-stu-id="e192a-163">**Azure US Government:**</span></span><br> <span data-ttu-id="e192a-164">management.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="e192a-164">management.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="e192a-165">**Azure для Германии:**</span><span class="sxs-lookup"><span data-stu-id="e192a-165">**Azure Germany:**</span></span><br> <span data-ttu-id="e192a-166">management.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="e192a-166">management.microsoftazure.de:443</span></span> |<span data-ttu-id="e192a-167">Создание, чтение, обновление и удаление хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-167">Create/Read/Update/Delete key vault</span></span> <br> <span data-ttu-id="e192a-168">Задание политик доступа к хранилищу ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-168">Set access policies for key vault</span></span><br><span data-ttu-id="e192a-169">Задание тегов для хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-169">Set tags for key vault</span></span> |<span data-ttu-id="e192a-170">Управление доступом на основе ролей Azure Active Directory (RBAC)</span><span class="sxs-lookup"><span data-stu-id="e192a-170">Azure Resource Manager Role-Based Access Control (RBAC)</span></span> |
| <span data-ttu-id="e192a-171">Плоскость данных</span><span class="sxs-lookup"><span data-stu-id="e192a-171">Data plane</span></span> |<span data-ttu-id="e192a-172">**Глобально:**</span><span class="sxs-lookup"><span data-stu-id="e192a-172">**Global:**</span></span><br> <span data-ttu-id="e192a-173">&lt;vault-name&gt;.vault.azure.net:443</span><span class="sxs-lookup"><span data-stu-id="e192a-173">&lt;vault-name&gt;.vault.azure.net:443</span></span><br><br> <span data-ttu-id="e192a-174">**Azure для Китая:**</span><span class="sxs-lookup"><span data-stu-id="e192a-174">**Azure China:**</span></span><br> <span data-ttu-id="e192a-175">&lt;vault-name&gt;.vault.azure.cn:443</span><span class="sxs-lookup"><span data-stu-id="e192a-175">&lt;vault-name&gt;.vault.azure.cn:443</span></span><br><br> <span data-ttu-id="e192a-176">**Azure для правительства США:**</span><span class="sxs-lookup"><span data-stu-id="e192a-176">**Azure US Government:**</span></span><br> <span data-ttu-id="e192a-177">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="e192a-177">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="e192a-178">**Azure для Германии:**</span><span class="sxs-lookup"><span data-stu-id="e192a-178">**Azure Germany:**</span></span><br> <span data-ttu-id="e192a-179">&lt;vault-name&gt;.vault.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="e192a-179">&lt;vault-name&gt;.vault.microsoftazure.de:443</span></span> |<span data-ttu-id="e192a-180">Для ключей: расшифровка, шифрование, оборачивание, разворачивание, проверка, подписывание, получение, перечисление, обновление, создание, импорт, удаление, резервное копирование, восстановление</span><span class="sxs-lookup"><span data-stu-id="e192a-180">For Keys: Decrypt, Encrypt, UnwrapKey, WrapKey, Verify, Sign, Get, List, Update, Create, Import, Delete, Backup, Restore</span></span><br><br> <span data-ttu-id="e192a-181">Для секретов: получение, перечисление, настройка, удаление</span><span class="sxs-lookup"><span data-stu-id="e192a-181">For secrets: Get, List, Set, Delete</span></span> |<span data-ttu-id="e192a-182">Политика доступа к хранилищу ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-182">Key vault access policy</span></span> |

<span data-ttu-id="e192a-183">Hello управления плоскости и данные плоскости управления доступом работать независимо.</span><span class="sxs-lookup"><span data-stu-id="e192a-183">hello management plane and data plane access controls work independently.</span></span> <span data-ttu-id="e192a-184">Например следует toogrant toouse ключа доступа приложения в хранилище ключей достаточно toogrant разрешения на доступа к данным плоскости с помощью ключа хранилища политик доступа и нет доступа плоскости управления необходим для этого приложения.</span><span class="sxs-lookup"><span data-stu-id="e192a-184">For example, if you want toogrant an application access toouse keys in a key vault, you only need toogrant data plane access permissions using key vault access policies and no management plane access is needed for this application.</span></span> <span data-ttu-id="e192a-185">И и наоборот, если требуется toobe пользователь может tooread хранилище свойств и теги, но не имеют доступа tookeys, секреты или сертификаты, можно предоставить этому пользователю, необходим доступ «чтение», используя RBAC и плоскости toodata нет доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-185">And conversely, if you want a user toobe able tooread vault properties and tags, but not have any access tookeys, secrets, or certificates, you can grant this user, 'read' access using RBAC and no access toodata plane is required.</span></span>

## <a name="management-plane-access-control"></a><span data-ttu-id="e192a-186">Контроль доступа к плоскости управления</span><span class="sxs-lookup"><span data-stu-id="e192a-186">Management plane access control</span></span>
<span data-ttu-id="e192a-187">Hello плоскости управления состоит из операций, которые влияют на хранилище ключей hello сам.</span><span class="sxs-lookup"><span data-stu-id="e192a-187">hello management plane consists of operations that affect hello key vault itself.</span></span> <span data-ttu-id="e192a-188">Например, вы можете создать или удалить хранилище ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-188">For example, you can create or delete a key vault.</span></span> <span data-ttu-id="e192a-189">Можно также получить список хранилищ в подписке.</span><span class="sxs-lookup"><span data-stu-id="e192a-189">You can get a list of vaults in a subscription.</span></span> <span data-ttu-id="e192a-190">Можно извлекать свойства хранилища ключей (например, Конфигурация тегов) и задать политики доступа, которые управляют hello пользователей и приложений, которые могут обращаться к ключи и секретные данные в хранилище ключей hello хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-190">You can retrieve key vault properties (such as SKU, tags) and set key vault access policies that control hello users and applications that can access keys and secrets in hello key vault.</span></span> <span data-ttu-id="e192a-191">Контроль доступа к плоскости управления использует RBAC.</span><span class="sxs-lookup"><span data-stu-id="e192a-191">Management plane access control uses RBAC.</span></span> <span data-ttu-id="e192a-192">См. Полный список операций хранилища ключей, выполняемые с помощью плоскости управления в таблице hello выше разделе hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-192">See hello complete list of key vault operations that can be performed via management plane in hello table in preceding section.</span></span> 

### <a name="role-based-access-control-rbac"></a><span data-ttu-id="e192a-193">Управление доступом на основе ролей (RBAC)</span><span class="sxs-lookup"><span data-stu-id="e192a-193">Role-based Access Control (RBAC)</span></span>
<span data-ttu-id="e192a-194">Каждая подписка Azure имеет каталог Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-194">Each Azure subscription has an Azure Active Directory.</span></span> <span data-ttu-id="e192a-195">Пользователи, группы и приложения из этого каталога можно предоставить доступ toomanage ресурсы hello подписки Azure, использующие модель развертывания диспетчера ресурсов Azure hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-195">Users, groups, and applications from this directory can be granted access toomanage resources in hello Azure subscription that use hello Azure Resource Manager deployment model.</span></span> <span data-ttu-id="e192a-196">Этот тип управления доступом является ссылка tooas управление доступом на основе ролей (RBAC).</span><span class="sxs-lookup"><span data-stu-id="e192a-196">This type of access control is referred tooas Role-Based Access Control (RBAC).</span></span> <span data-ttu-id="e192a-197">toomanage этот доступ, можно использовать hello [портал Azure](https://portal.azure.com/), hello [средства Azure CLI](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), или hello [интерфейсы API REST диспетчера ресурсов Azure](https://msdn.microsoft.com/library/azure/dn906885.aspx).</span><span class="sxs-lookup"><span data-stu-id="e192a-197">toomanage this access, you can use hello [Azure portal](https://portal.azure.com/), hello [Azure CLI tools](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), or hello [Azure Resource Manager REST APIs](https://msdn.microsoft.com/library/azure/dn906885.aspx).</span></span>

<span data-ttu-id="e192a-198">С моделью hello диспетчера ресурсов Azure для создания хранилища ключей ресурсов группы и контроль доступа toohello управления плоскости из этого хранилища ключей с помощью Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-198">With hello Azure Resource Manager model, you create your key vault in a resource group and control access toohello management plane of this key vault by using Azure Active Directory.</span></span> <span data-ttu-id="e192a-199">Например можно предоставить пользователей или группы возможность toomanage ключа хранилища в определенной группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e192a-199">For example, you can grant users or a group ability toomanage key vaults in a specific resource group.</span></span>

<span data-ttu-id="e192a-200">Вы можете предоставить доступ toousers, групп и приложений в конкретной области, назначив соответствующие роли RBAC.</span><span class="sxs-lookup"><span data-stu-id="e192a-200">You can grant access toousers, groups and applications at a specific scope by assigning appropriate RBAC roles.</span></span> <span data-ttu-id="e192a-201">Например toogrant доступ к tooa пользователя toomanage ключа хранилища можно назначить предопределенную роль «хранилища ключей участника» toothis пользователя в определенной области.</span><span class="sxs-lookup"><span data-stu-id="e192a-201">For example, toogrant access tooa user toomanage key vaults you would assign a predefined role 'key vault Contributor' toothis user at a specific scope.</span></span> <span data-ttu-id="e192a-202">область Hello в этом случае будет подписки, группы ресурсов или только определенных хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-202">hello scope in this case would be either a subscription, a resource group, or just a specific key vault.</span></span> <span data-ttu-id="e192a-203">Роль, назначенная на уровне подписки применяется tooall групп ресурсов и ресурсов в этой подписке.</span><span class="sxs-lookup"><span data-stu-id="e192a-203">A role assigned at subscription level applies tooall resource groups and resources within that subscription.</span></span> <span data-ttu-id="e192a-204">Роль, назначенная на уровне группы ресурсов применяется tooall ресурсов в этой группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e192a-204">A role assigned at resource group level applies tooall resources in that resource group.</span></span> <span data-ttu-id="e192a-205">Роль, назначенная для определенного ресурса применяется только toothat ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e192a-205">A role assigned for a specific resource only applies toothat resource.</span></span> <span data-ttu-id="e192a-206">Существует несколько предопределенных ролей (в разделе [RBAC: встроенные роли](../active-directory/role-based-access-built-in-roles.md)), и если hello стандартные роли не соответствовать потребностям, можно также определить собственные роли.</span><span class="sxs-lookup"><span data-stu-id="e192a-206">There are several predefined roles (see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md)), and if hello predefined roles do not fit your needs you can also define your own roles.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e192a-207">Обратите внимание, если у пользователя есть плоскости tooa хранилища ключей управления для участника разрешения (RBAC), она можно предоставить себе доступ toodata плоскость, задав политики доступа хранилища ключей, управляющий плоскости toodata доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-207">Note that if a user has Contributor permissions (RBAC) tooa key vault management plane, she can grant herself access toodata plane, by setting key vault access policy, which controls access toodata plane.</span></span> <span data-ttu-id="e192a-208">Таким образом рекомендуется tootightly управления, который имеет «Участник» доступа tooyour хранилищ ключей tooensure только авторизованными лицами можно доступа и управления хранилищами ключей, ключей, секреты и сертификаты.</span><span class="sxs-lookup"><span data-stu-id="e192a-208">Therefore, it is recommended tootightly control who has 'Contributor' access tooyour key vaults tooensure only authorized persons can access and manage your key vaults, keys, secrets, and certificates.</span></span>
> 
> 

## <a name="data-plane-access-control"></a><span data-ttu-id="e192a-209">Контроль доступа к плоскости данных</span><span class="sxs-lookup"><span data-stu-id="e192a-209">Data plane access control</span></span>
<span data-ttu-id="e192a-210">Hello хранилища ключей информационной панели состоит из операций, которые влияют на объекты hello в хранилище ключей, таких как ключи, секреты и сертификаты.</span><span class="sxs-lookup"><span data-stu-id="e192a-210">hello key vault data plane consists of operations that affect hello objects in a key vault, such as keys, secrets, and certificates.</span></span>  <span data-ttu-id="e192a-211">Сюда относятся операции с ключами, такие как создание, импорт, обновление, перечисление, резервное копирование и восстановление ключей, криптографические операции, такие как подписывание, проверка, шифрование, расшифровка, оборачивание, разворачивание, задание тегов и других атрибутов для ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-211">This includes key operations such as create, import, update, list, backup, and restore keys, cryptographic operations such as sign, verify, encrypt, decrypt, wrap, and unwrap, and set tags and other attributes for keys.</span></span> <span data-ttu-id="e192a-212">Аналогичным образом к операциям с секретами относятся получение, задание, перечисление и удаление.</span><span class="sxs-lookup"><span data-stu-id="e192a-212">Similarly, for secrets it includes, get, set, list, delete.</span></span>

<span data-ttu-id="e192a-213">Доступ к плоскости данных предоставляется путем настройки политик доступа для хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-213">Data plane access is granted by setting access policies for a key vault.</span></span> <span data-ttu-id="e192a-214">Пользователь, группа или приложения требуются разрешения участника (RBAC) для управления плоскости для политики хранилища ключей toobe tooset возможности доступа для этого хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-214">A user, group, or an application must have Contributor permissions (RBAC) for management plane for a key vault toobe able tooset access policies for that key vault.</span></span> <span data-ttu-id="e192a-215">Пользователь, группа или приложения могут быть предоставлены определенные операции доступа к tooperform ключи и секретные данные в хранилище ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-215">A user, group, or application can be granted access tooperform specific operations for keys or secrets in a key vault.</span></span> <span data-ttu-id="e192a-216">Поддержка хранилища ключей too16 записи политики доступа для хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-216">Key vault support up too16 access policy entries for a key vault.</span></span> <span data-ttu-id="e192a-217">Создание группы безопасности Azure Active Directory и добавление пользователей toothat группы toogrant данных плоскости доступа tooseveral пользователей tooa хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-217">Create an Azure Active Directory security group and add users toothat group toogrant data plane access tooseveral users tooa key vault.</span></span>

### <a name="key-vault-access-policies"></a><span data-ttu-id="e192a-218">Политики доступа Key Vault</span><span class="sxs-lookup"><span data-stu-id="e192a-218">Key vault Access Policies</span></span>
<span data-ttu-id="e192a-219">Политики доступа в хранилище ключей отдельно предоставить разрешения tookeys, секреты и сертификаты.</span><span class="sxs-lookup"><span data-stu-id="e192a-219">Key vault access policies grant permissions tookeys, secrets and certificates separately.</span></span> <span data-ttu-id="e192a-220">Например можно предоставить tooonly ключей доступа пользователя, но нет разрешения для секретов.</span><span class="sxs-lookup"><span data-stu-id="e192a-220">For example, you can give a user access tooonly keys, but no permissions for secrets.</span></span> <span data-ttu-id="e192a-221">Однако разрешений tooaccess ключи или секреты или сертификаты, на уровне хранилища hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-221">However, permissions tooaccess keys or secrets or certificates are at hello vault level.</span></span> <span data-ttu-id="e192a-222">Другими словами, политика доступа к хранилищу ключей не поддерживает разрешения на уровне объектов.</span><span class="sxs-lookup"><span data-stu-id="e192a-222">In other words, key vault access policy does not support object level permissions.</span></span> <span data-ttu-id="e192a-223">Можно использовать [портал Azure](https://portal.azure.com/), hello [средства Azure CLI](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), или hello [управления API REST хранилища ключей](https://msdn.microsoft.com/library/azure/mt620024.aspx) tooset политики доступа для хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-223">You can use [Azure portal](https://portal.azure.com/), hello [Azure CLI tools](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), or hello [key vault Management REST APIs](https://msdn.microsoft.com/library/azure/mt620024.aspx) tooset access policies for a key vault.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e192a-224">Обратите внимание, что хранилище ключей политики доступа применяются на уровне хранилища hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-224">Note that key vault access policies apply at hello vault level.</span></span> <span data-ttu-id="e192a-225">Например при предоставлении разрешений toocreate и удалить ключи она выполнения этих операций на все ключи в этом хранилище ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-225">For example, when a user is granted permission toocreate and delete keys, she can perform those operations on all keys in that key vault.</span></span>
> 
> 

## <a name="example"></a><span data-ttu-id="e192a-226">Пример</span><span class="sxs-lookup"><span data-stu-id="e192a-226">Example</span></span>
<span data-ttu-id="e192a-227">Предположим, что разрабатывается приложение, в котором используется сертификат для SSL, служба хранилища Azure для хранения данных и 2048-разрядный ключ RSA для операций подписывания.</span><span class="sxs-lookup"><span data-stu-id="e192a-227">Let's say you are developing an application that uses a certificate for SSL, Azure storage for storing data, and uses an RSA 2048-bit key for sign operations.</span></span> <span data-ttu-id="e192a-228">Допустим, что это приложение выполняется в виртуальной машине (или масштабируемом наборе виртуальных машин).</span><span class="sxs-lookup"><span data-stu-id="e192a-228">Let's say this application is running in a VM (or a VM Scale Set).</span></span> <span data-ttu-id="e192a-229">Можно использовать хранилище ключей toostore, все hello секретные данные приложения и использовать хранилище ключей toostore hello начальной загрузки сертификат, используемый tooauthenticate приложения hello в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-229">You can use a key vault toostore all hello application secrets, and use key vault toostore hello bootstrap certificate that is used by hello application tooauthenticate with Azure Active Directory.</span></span>

<span data-ttu-id="e192a-230">Итак здесь — это совокупность всех toobe ключи и секретные коды hello, хранящихся в хранилище ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-230">So, here's a summary of all hello keys and secrets toobe stored in a key vault.</span></span>

* <span data-ttu-id="e192a-231">**SSL-сертификат** — используется для SSL;</span><span class="sxs-lookup"><span data-stu-id="e192a-231">**SSL Cert** - used for SSL</span></span>
* <span data-ttu-id="e192a-232">**Ключ хранилища** -используется учетная запись tooStorage tooget доступа</span><span class="sxs-lookup"><span data-stu-id="e192a-232">**Storage Key** - used tooget access tooStorage account</span></span>
* <span data-ttu-id="e192a-233">**2048-разрядный ключ RSA** — используется для операций подписывания;</span><span class="sxs-lookup"><span data-stu-id="e192a-233">**RSA 2048-bit key** - used for sign operations</span></span>
* <span data-ttu-id="e192a-234">**Начальной загрузки сертификата** -используется для подписи tooauthenticate tooAzure Active Directory, доступ tooget tookey toofetch хранилище hello ключ хранилища и использовать ключ RSA hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-234">**Bootstrap certificate** - used tooauthenticate tooAzure Active Directory, tooget access tookey vault toofetch hello storage key and use hello RSA key for signing.</span></span>

<span data-ttu-id="e192a-235">Теперь давайте соответствуют hello специалистами управление, развертывание и аудит этого приложения.</span><span class="sxs-lookup"><span data-stu-id="e192a-235">Now let's meet hello people who are managing, deploying and auditing this application.</span></span> <span data-ttu-id="e192a-236">В этом примере используются три роли.</span><span class="sxs-lookup"><span data-stu-id="e192a-236">We'll use three roles in this example.</span></span>

* <span data-ttu-id="e192a-237">**Группа безопасности** — это обычно ИТ-специалисты hello «office hello CSO (Руководитель отдела безопасности)» или эквивалентные, ответственный за hello правильного хранения секретов такие как SSL-сертификаты, ключи RSA для подписывания, строки подключения для базы данных, ключи учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="e192a-237">**Security team** - These are typically IT staff from hello 'office of hello CSO (Chief Security Officer)' or equivalent, responsible for hello proper safekeeping of secrets such as SSL certificates, RSA keys used for signing, connection strings for databases, storage account keys.</span></span>
* <span data-ttu-id="e192a-238">**Разработчики и операторы** -это hello специалистов, разрабатывающих этого приложения и затем развернуть его в Azure.</span><span class="sxs-lookup"><span data-stu-id="e192a-238">**Developers/operators** - These are hello folks who develop this application and then deploy it in Azure.</span></span> <span data-ttu-id="e192a-239">Как правило они не являются частью группы безопасности hello и поэтому они не должны иметь доступа tooany конфиденциальные данные, такие как SSL-сертификаты, ключи RSA, но они развернуть приложение hello должна быть toothose доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-239">Typically, they are not part of hello security team, and hence they should not have access tooany sensitive data, such as SSL certificates, RSA keys, but hello application they deploy should have access toothose.</span></span>
* <span data-ttu-id="e192a-240">**Аудиторы** -это обычно набор людей, изолированные от разработчиков hello и общие ИТ-специалистов.</span><span class="sxs-lookup"><span data-stu-id="e192a-240">**Auditors** - This is usually a different set of people, isolated from hello developers and general IT staff.</span></span> <span data-ttu-id="e192a-241">Обязанностью является tooreview правильное использование и обслуживание сертификаты, ключи, т. д. и обеспечения соответствия стандартам безопасности данных.</span><span class="sxs-lookup"><span data-stu-id="e192a-241">Their responsibility is tooreview proper use and maintenance of certificates, keys, etc. and ensure compliance with data security standards.</span></span> 

<span data-ttu-id="e192a-242">Одну роль это hello вне области приложения, но соответствующие здесь toobe упоминалось, и это было бы подписки hello (или группа ресурсов) администратора.</span><span class="sxs-lookup"><span data-stu-id="e192a-242">There is one more role that is outside hello scope of this application, but relevant here toobe mentioned, and that would be hello subscription (or resource group) administrator.</span></span> <span data-ttu-id="e192a-243">Подписки администратор устанавливает начальные права доступа для группы безопасности hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-243">Subscription administrator sets up initial access permissions for hello security team.</span></span> <span data-ttu-id="e192a-244">Здесь предполагается, что подписки, hello администратор предоставил доступ toohello команды tooa ресурсов группы безопасности в котором все hello ресурсы, необходимые для этого приложения расположенные.</span><span class="sxs-lookup"><span data-stu-id="e192a-244">Here we assume that hello subscription administrator has granted access toohello security team tooa resource group in which all hello resources needed for this application reside.</span></span>

<span data-ttu-id="e192a-245">Теперь давайте посмотрим, какие действия выполняет каждой роли в контексте этого приложения hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-245">Now let's see what actions each role performs in hello context of this application.</span></span>

* <span data-ttu-id="e192a-246">**Группа безопасности:**</span><span class="sxs-lookup"><span data-stu-id="e192a-246">**Security team**</span></span>
  * <span data-ttu-id="e192a-247">создание хранилищ ключей;</span><span class="sxs-lookup"><span data-stu-id="e192a-247">Create key vaults</span></span>
  * <span data-ttu-id="e192a-248">включение ведения журнала хранилища ключей;</span><span class="sxs-lookup"><span data-stu-id="e192a-248">Turns on key vault logging</span></span>
  * <span data-ttu-id="e192a-249">добавление ключей и секретов;</span><span class="sxs-lookup"><span data-stu-id="e192a-249">Add keys/secrets</span></span>
  * <span data-ttu-id="e192a-250">создание резервной копии ключей для аварийного восстановления;</span><span class="sxs-lookup"><span data-stu-id="e192a-250">Create backup of keys for disaster recovery</span></span>
  * <span data-ttu-id="e192a-251">Хранилище ключей доступа политики toogrant разрешений toousers и приложения tooperform определенные операции над множествами</span><span class="sxs-lookup"><span data-stu-id="e192a-251">Set key vault access policy toogrant permissions toousers and applications tooperform specific operations</span></span>
  * <span data-ttu-id="e192a-252">периодическое развертывание ключей и секретов.</span><span class="sxs-lookup"><span data-stu-id="e192a-252">Periodically roll keys/secrets</span></span>
* <span data-ttu-id="e192a-253">**Разработчики и операторы:**</span><span class="sxs-lookup"><span data-stu-id="e192a-253">**Developers/operators**</span></span>
  * <span data-ttu-id="e192a-254">Получение ссылки на toobootstrap и SSL-сертификатами (отпечатки), ключа хранилища (секрет URI) и подписывания ключа (ключ URI) из группы безопасности</span><span class="sxs-lookup"><span data-stu-id="e192a-254">Get references toobootstrap and SSL certs (thumbprints), storage key (secret URI) and signing key (Key URI) from security team</span></span>
  * <span data-ttu-id="e192a-255">разработка и развертывание приложения, которое получает доступ к ключам и секретам программным способом.</span><span class="sxs-lookup"><span data-stu-id="e192a-255">Develop and deploy application that accesses keys and secrets programmatically</span></span>
* <span data-ttu-id="e192a-256">**Аудиторы:**</span><span class="sxs-lookup"><span data-stu-id="e192a-256">**Auditors**</span></span>
  * <span data-ttu-id="e192a-257">Просмотр использования журналы tooconfirm правильное использование ключа/секрета и соответствие стандартам безопасности данных</span><span class="sxs-lookup"><span data-stu-id="e192a-257">Review usage logs tooconfirm proper key/secret use and compliance with data security standards</span></span>

<span data-ttu-id="e192a-258">Теперь давайте посмотрим, какое хранилище tookey разрешения доступа требуются каждой роли (и приложения hello) tooperform назначенных им задач.</span><span class="sxs-lookup"><span data-stu-id="e192a-258">Now let's see what access permissions tookey vault are needed by each role (and hello application) tooperform their assigned tasks.</span></span> 

| <span data-ttu-id="e192a-259">Роль пользователя</span><span class="sxs-lookup"><span data-stu-id="e192a-259">User Role</span></span> | <span data-ttu-id="e192a-260">Разрешения плоскости управления</span><span class="sxs-lookup"><span data-stu-id="e192a-260">Management plane permissions</span></span> | <span data-ttu-id="e192a-261">Разрешения плоскости данных</span><span class="sxs-lookup"><span data-stu-id="e192a-261">Data plane permissions</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e192a-262">Группа безопасности</span><span class="sxs-lookup"><span data-stu-id="e192a-262">Security Team</span></span> |<span data-ttu-id="e192a-263">Участник хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-263">key vault Contributor</span></span> |<span data-ttu-id="e192a-264">Ключи: резервное копирование, создание, удаление, получение, импорт, перечисление, восстановление</span><span class="sxs-lookup"><span data-stu-id="e192a-264">Keys: backup, create, delete, get, import, list, restore</span></span> <br> <span data-ttu-id="e192a-265">Секреты: все</span><span class="sxs-lookup"><span data-stu-id="e192a-265">Secrets: all</span></span> |
| <span data-ttu-id="e192a-266">Разработчики и операторы</span><span class="sxs-lookup"><span data-stu-id="e192a-266">Developers/Operator</span></span> |<span data-ttu-id="e192a-267">хранилище ключей развернуть разрешение так, чтобы они развернуть виртуальные машины hello можно извлекать секретов из хранилища ключей hello</span><span class="sxs-lookup"><span data-stu-id="e192a-267">key vault deploy permission so that hello VMs they deploy can fetch secrets from hello key vault</span></span> |<span data-ttu-id="e192a-268">None</span><span class="sxs-lookup"><span data-stu-id="e192a-268">None</span></span> |
| <span data-ttu-id="e192a-269">Аудиторы</span><span class="sxs-lookup"><span data-stu-id="e192a-269">Auditors</span></span> |<span data-ttu-id="e192a-270">None</span><span class="sxs-lookup"><span data-stu-id="e192a-270">None</span></span> |<span data-ttu-id="e192a-271">Ключи: перечисление</span><span class="sxs-lookup"><span data-stu-id="e192a-271">Keys: list</span></span><br><span data-ttu-id="e192a-272">Секреты: перечисление</span><span class="sxs-lookup"><span data-stu-id="e192a-272">Secrets: list</span></span> |
| <span data-ttu-id="e192a-273">Приложение</span><span class="sxs-lookup"><span data-stu-id="e192a-273">Application</span></span> |<span data-ttu-id="e192a-274">None</span><span class="sxs-lookup"><span data-stu-id="e192a-274">None</span></span> |<span data-ttu-id="e192a-275">Ключи: подписывание</span><span class="sxs-lookup"><span data-stu-id="e192a-275">Keys: sign</span></span><br><span data-ttu-id="e192a-276">Секреты: получение</span><span class="sxs-lookup"><span data-stu-id="e192a-276">Secrets: get</span></span> |

> [!NOTE]
> <span data-ttu-id="e192a-277">Аудиторы требуются разрешения списка для ключи и секретные коды чтобы они смогли проверить атрибуты ключи и секретные данные, которые не преобразуются в журналах hello, такие как теги, даты окончания срока действия активации.</span><span class="sxs-lookup"><span data-stu-id="e192a-277">Auditors need list permission for keys and secrets so they can inspect attributes for keys and secrets that are not emitted in hello logs, such as tags, activation and expiration dates.</span></span>
> 
> 

<span data-ttu-id="e192a-278">Помимо разрешений хранилища tookey все три роли также требуется доступ к tooother ресурсам.</span><span class="sxs-lookup"><span data-stu-id="e192a-278">Besides permission tookey vault, all three roles also need access tooother resources.</span></span> <span data-ttu-id="e192a-279">Например toobe может toodeploy виртуальных машин (или Web Apps и т. д.) Разработчики и операторы также должны типов ресурсов toothose доступа «Участник».</span><span class="sxs-lookup"><span data-stu-id="e192a-279">For example, toobe able toodeploy VMs (or Web Apps etc.) Developers/Operators also need 'Contributor' access toothose resource types.</span></span> <span data-ttu-id="e192a-280">Аудиторы требуется доступ на чтение учетной записи хранилища toohello где хранятся журналы hello хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-280">Auditors need read access toohello storage account where hello key vault logs are stored.</span></span>

<span data-ttu-id="e192a-281">Поскольку hello темой этой статьи заключается в обеспечении безопасности хранилища ключей доступа tooyour, мы только показаны соответствующие части hello относится раздел toothis и пропустить сведения о развертывании сертификатов, доступ к ключи и секретные коды программными средствами и т. д. Эти сведения уже описаны в другой статье.</span><span class="sxs-lookup"><span data-stu-id="e192a-281">Since hello focus of this article is securing access tooyour key vault, we only illustrate hello relevant portions pertaining toothis topic and skip details regarding deploying certificates, accessing keys and secrets programmatically etc. Those details are already covered elsewhere.</span></span> <span data-ttu-id="e192a-282">Развертывание сертификатов, хранящихся в хранилище ключей tooVMs рассматривается в [блога](https://blogs.technet.microsoft.com/kv/2016/09/14/updated-deploy-certificates-to-vms-from-customer-managed-key-vault/)и [пример кода](https://www.microsoft.com/download/details.aspx?id=45343) доступны, показано, как toouse начальной загрузки сертификат tooget tooauthenticate tooAzure AD хранилище tookey доступа.</span><span class="sxs-lookup"><span data-stu-id="e192a-282">Deploying certificates stored in key vault tooVMs is covered in a [blog post](https://blogs.technet.microsoft.com/kv/2016/09/14/updated-deploy-certificates-to-vms-from-customer-managed-key-vault/), and there is [sample code](https://www.microsoft.com/download/details.aspx?id=45343) available that illustrates how toouse bootstrap certificate tooauthenticate tooAzure AD tooget access tookey vault.</span></span>

<span data-ttu-id="e192a-283">Большая часть hello разрешения на доступ можно предоставить с помощью портала Azure, но детальные разрешения toogrant hello tooachieve toouse Azure PowerShell (или Azure CLI) может потребоваться требуемого результата.</span><span class="sxs-lookup"><span data-stu-id="e192a-283">Most of hello access permissions can be granted using Azure portal, but toogrant granular permissions you may need toouse Azure PowerShell (or Azure CLI) tooachieve hello desired result.</span></span> 

<span data-ttu-id="e192a-284">Предположим, Hello следующие фрагменты кода PowerShell:</span><span class="sxs-lookup"><span data-stu-id="e192a-284">hello following PowerShell snippets assume:</span></span>

* <span data-ttu-id="e192a-285">Здравствуйте, администратор Azure Active Directory создала группы безопасности, представляющие hello три роли, а именно группой обеспечения безопасности компании Contoso, Devops приложение Contoso, аудиторы приложение Contoso.</span><span class="sxs-lookup"><span data-stu-id="e192a-285">hello Azure Active Directory administrator has created security groups that represent hello three roles, namely Contoso Security Team, Contoso App Devops, Contoso App Auditors.</span></span> <span data-ttu-id="e192a-286">Здравствуйте, администратор добавил toohello групп пользователей, которые они входят.</span><span class="sxs-lookup"><span data-stu-id="e192a-286">hello administrator has also added users toohello groups they belong.</span></span>
* <span data-ttu-id="e192a-287">**ContosoAppRG** является группой ресурсов hello, где находятся все ресурсы hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-287">**ContosoAppRG** is hello resource group where all hello resources reside.</span></span> <span data-ttu-id="e192a-288">**contosologstorage** — где хранятся журналы hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-288">**contosologstorage** is where hello logs are stored.</span></span> 
* <span data-ttu-id="e192a-289">Хранилище ключей **ContosoKeyVault** и учетной записи хранилища, используемый для хранилища ключей журналов **contosologstorage** должен находиться в hello местоположения Azure</span><span class="sxs-lookup"><span data-stu-id="e192a-289">Key vault **ContosoKeyVault** and storage account used for key vault logs **contosologstorage** must be in hello same Azure location</span></span>

<span data-ttu-id="e192a-290">Первый hello подписки администратор назначает «ключа хранилища участника» и группой обеспечения безопасности toohello роли "Администратор доступа пользователя".</span><span class="sxs-lookup"><span data-stu-id="e192a-290">First hello subscription administrator assigns 'key vault Contributor' and 'User Access Administrator' roles toohello security team.</span></span> <span data-ttu-id="e192a-291">Это позволяет tooother hello безопасности team toomanage доступ к ресурсам и управление хранилищами ключей в группе ресурсов hello ContosoAppRG.</span><span class="sxs-lookup"><span data-stu-id="e192a-291">This allows hello security team toomanage access tooother resources and manage key vaults in hello resource group ContosoAppRG.</span></span>

```
New-AzureRmRoleAssignment -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso Security Team')[0].Id -RoleDefinitionName "key vault Contributor" -ResourceGroupName ContosoAppRG
New-AzureRmRoleAssignment -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso Security Team')[0].Id -RoleDefinitionName "User Access Administrator" -ResourceGroupName ContosoAppRG
```

<span data-ttu-id="e192a-292">Hello следующий сценарий иллюстрирует как hello группы безопасности можно создать хранилище ключей, Настройка ведения журнала и установить разрешения на доступ для других ролей и приложения hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-292">hello following script illustrates how hello security team can create a key vault, setup logging, and set access permissions for other roles and hello application.</span></span> 

```
# Create key vault and enable logging
$sa = Get-AzureRmStorageAccount -ResourceGroup ContosoAppRG -Name contosologstorage
$kv = New-AzureRmKeyVault -VaultName ContosoKeyVault -ResourceGroup ContosoAppRG -SKU premium -Location 'westus' -EnabledForDeployment
Set-AzureRmDiagnosticSetting -ResourceId $kv.ResourceId -StorageAccountId $sa.Id -Enabled $true -Categories AuditEvent

# Data plane permissions for Security team
Set-AzureRmKeyVaultAccessPolicy -VaultName ContosoKeyVault -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso Security Team')[0].Id -PermissionsToKeys backup,create,delete,get,import,list,restore -PermissionsToSecrets all

# Management plane permissions for Dev/ops
# Create a new role from an existing role
$devopsrole = Get-AzureRmRoleDefinition -Name "Virtual Machine Contributor"
$devopsrole.Id = $null
$devopsrole.Name = "Contoso App Devops"
$devopsrole.Description = "Can deploy VMs that need secrets from key vault"
$devopsrole.AssignableScopes = @("/subscriptions/<SUBSCRIPTION-GUID>")

# Add permission for dev/ops so they can deploy VMs that have secrets deployed from key vaults
$devopsrole.Actions.Add("Microsoft.KeyVault/vaults/deploy/action")
New-AzureRmRoleDefinition -Role $devopsrole

# Assign this newly defined role tooDev ops security group
New-AzureRmRoleAssignment -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso App Devops')[0].Id -RoleDefinitionName "Contoso App Devops" -ResourceGroupName ContosoAppRG

# Data plane permissions for Auditors
Set-AzureRmKeyVaultAccessPolicy -VaultName ContosoKeyVault -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso App Auditors')[0].Id -PermissionsToKeys list -PermissionsToSecrets list
```

<span data-ttu-id="e192a-293">пользовательской роли Hello определения, является только подписки может быть назначен toohello, где создается группа ресурсов ContosoAppRG hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-293">hello custom role defined, is only assignable toohello subscription where hello ContosoAppRG resource group is created.</span></span> <span data-ttu-id="e192a-294">Если hello же пользовательские роли будет использоваться для других проектов в других подписок, ее область может быть добавлено несколько подписок.</span><span class="sxs-lookup"><span data-stu-id="e192a-294">If hello same custom roles will be used for other projects in other subscriptions, it's scope could have more subscriptions added.</span></span>

<span data-ttu-id="e192a-295">Hello пользовательской роли для разработчиков hello/операторов разрешение «развертывания и действие» hello назначен области toohello группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e192a-295">hello custom role assignment for hello developers/operators for hello "deploy/action" permission is scoped toohello resource group.</span></span> <span data-ttu-id="e192a-296">Таким образом, созданные только виртуальные машины hello в группе ресурсов hello, «ContosoAppRG» получит hello секретные данные (SSL-сертификат и сертификат начальной загрузки).</span><span class="sxs-lookup"><span data-stu-id="e192a-296">This way only hello VMs created in hello resource group 'ContosoAppRG' will get hello secrets (SSL cert and bootstrap cert).</span></span> <span data-ttu-id="e192a-297">Все виртуальные машины, является членом группы разработки и эксплуатации создает в другой группе ресурсов не будет возможности tooget эти секреты даже если они знали, что hello секрет идентификаторы URI.</span><span class="sxs-lookup"><span data-stu-id="e192a-297">Any VMs that a member of dev/ops team creates in other resource group will not be able tooget these secrets even if they knew hello secret URIs.</span></span>

<span data-ttu-id="e192a-298">В этом примере показан простой сценарий.</span><span class="sxs-lookup"><span data-stu-id="e192a-298">This example depicts a simple scenario.</span></span> <span data-ttu-id="e192a-299">Реальных сценариев может быть более сложной и может потребоваться tooadjust разрешения tooyour хранилища ключей зависимости от потребностей.</span><span class="sxs-lookup"><span data-stu-id="e192a-299">Real life scenarios may be more complex and you may need tooadjust permissions tooyour key vault based on your needs.</span></span> <span data-ttu-id="e192a-300">Например в данном примере предполагается, что этой группы безопасности будет предоставлять ключ hello и секретный ссылки (URI и отпечатки) tooreference необходимость команды, разработчики и операторы, в своих приложениях.</span><span class="sxs-lookup"><span data-stu-id="e192a-300">For example, in our example, we assume that security team will provide hello key and secret references (URIs and thumbprints) that developers/operators team need tooreference in their applications.</span></span> <span data-ttu-id="e192a-301">Таким образом они не должны toogrant разработчики и операторы доступа к данным плоскости.</span><span class="sxs-lookup"><span data-stu-id="e192a-301">Hence, they don't need toogrant developers/operators any data plane access.</span></span> <span data-ttu-id="e192a-302">Кроме того, обратите внимание, что в этом примере уделяется внимание обеспечению защиты хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="e192a-302">Also, note that this example focuses on securing your key vault.</span></span> <span data-ttu-id="e192a-303">Аналогично следует учитывать toosecure [виртуальные машины](https://azure.microsoft.com/services/virtual-machines/security/), [учетные записи хранения](../storage/common/storage-security-guide.md) и другим ресурсам Azure слишком.</span><span class="sxs-lookup"><span data-stu-id="e192a-303">Similar consideration should be given toosecure [your VMs](https://azure.microsoft.com/services/virtual-machines/security/), [storage accounts](../storage/common/storage-security-guide.md) and other Azure resources too.</span></span>

> [!NOTE]
> <span data-ttu-id="e192a-304">Примечание. В этом примере показано как доступ к хранилищу ключей будет заблокирован в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="e192a-304">Note: This example shows how key vault access will be locked down in production.</span></span> <span data-ttu-id="e192a-305">Hello разработчики должны иметь свои собственные подписки или группа ресурсов которого они имеют полные права доступа toomanage их хранилищ, виртуальные машины и учетной записи хранилища где они разрабатывают приложения hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-305">hello developers should have their own subscription or resourcegroup where they have full permissions toomanage their vaults, VMs and storage account where they develop hello application.</span></span>
> 
> 

## <a name="resources"></a><span data-ttu-id="e192a-306">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="e192a-306">Resources</span></span>
* [<span data-ttu-id="e192a-307">Контроль доступа на основе ролей Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="e192a-307">Azure Active Directory Role-based Access Control</span></span>](../active-directory/role-based-access-control-configure.md)
  
  <span data-ttu-id="e192a-308">В этой статье описываются hello управления доступом на основе роли Azure Active Directory и как он работает.</span><span class="sxs-lookup"><span data-stu-id="e192a-308">This article explains hello Azure Active Directory Role-based Access Control and how it works.</span></span>
* [<span data-ttu-id="e192a-309">RBAC: встроенные роли</span><span class="sxs-lookup"><span data-stu-id="e192a-309">RBAC: Built in Roles</span></span>](../active-directory/role-based-access-built-in-roles.md)
  
  <span data-ttu-id="e192a-310">Этой статьи описаны все hello встроенные роли, имеющиеся в RBAC.</span><span class="sxs-lookup"><span data-stu-id="e192a-310">This article details all hello built-in roles available in RBAC.</span></span>
* [<span data-ttu-id="e192a-311">Общие сведения о развертывании диспетчера ресурсов и классическом развертывании</span><span class="sxs-lookup"><span data-stu-id="e192a-311">Understanding Resource Manager deployment and classic deployment</span></span>](../azure-resource-manager/resource-manager-deployment-model.md)
  
  <span data-ttu-id="e192a-312">В этой статье рассказывается, развертывания диспетчера ресурсов hello и классическое развертывание модели и преимущества использования диспетчера ресурсов и ресурсов группы hello hello</span><span class="sxs-lookup"><span data-stu-id="e192a-312">This article explains hello Resource Manager deployment and classic deployment models, and explains hello benefits of using hello Resource Manager and resource groups</span></span>
* [<span data-ttu-id="e192a-313">Управление доступом на основе ролей с помощью Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="e192a-313">Manage Role-Based Access Control with Azure PowerShell</span></span>](../active-directory/role-based-access-control-manage-access-powershell.md)
  
  <span data-ttu-id="e192a-314">В этой статье объясняется, как элемент управления с помощью Azure PowerShell доступ к toomanage на основе ролей</span><span class="sxs-lookup"><span data-stu-id="e192a-314">This article explains how toomanage role-based access control with Azure PowerShell</span></span>
* [<span data-ttu-id="e192a-315">Управление на основе ролей управления доступом с помощью API-интерфейса REST hello</span><span class="sxs-lookup"><span data-stu-id="e192a-315">Managing Role-Based Access Control with hello REST API</span></span>](../active-directory/role-based-access-control-manage-access-rest.md)
  
  <span data-ttu-id="e192a-316">В этой статье показано, как toouse hello toomanage API-интерфейса REST RBAC.</span><span class="sxs-lookup"><span data-stu-id="e192a-316">This article shows how toouse hello REST API toomanage RBAC.</span></span>
* [<span data-ttu-id="e192a-317">Конференция Ignite: управление доступом на основе ролей в Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="e192a-317">Role-Based Access Control for Microsoft Azure from Ignite</span></span>](https://channel9.msdn.com/events/Ignite/2015/BRK2707)
  
  <span data-ttu-id="e192a-318">Это tooa ссылку, с конференции Ignite 2015 MS hello видео на канале 9.</span><span class="sxs-lookup"><span data-stu-id="e192a-318">This is a link tooa video on Channel 9 from hello 2015 MS Ignite conference.</span></span> <span data-ttu-id="e192a-319">В этом сеансе говорить о доступа, управления и работы с отчетами Azure и рекомендации по защите доступа tooAzure подписки с помощью Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-319">In this session, they talk about access management and reporting capabilities in Azure, and explore best practices around securing access tooAzure subscriptions using Azure Active Directory.</span></span>
* [<span data-ttu-id="e192a-320">Авторизация доступа tooweb приложений с помощью OAuth 2.0 и Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="e192a-320">Authorize access tooweb applications using OAuth 2.0 and Azure Active Directory</span></span>](../active-directory/active-directory-protocols-oauth-code.md)
  
  <span data-ttu-id="e192a-321">В этой статье описывается полный поток OAuth 2.0 для проверки подлинности с помощью Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e192a-321">This article describes complete OAuth 2.0 flow for authenticating with Azure Active Directory.</span></span>
* <span data-ttu-id="e192a-322">[Key vault Management REST APIs](https://msdn.microsoft.com/library/azure/mt620024.aspx) (REST API для управления хранилищем ключей)</span><span class="sxs-lookup"><span data-stu-id="e192a-322">[key vault Management REST APIs](https://msdn.microsoft.com/library/azure/mt620024.aspx)</span></span>
  
  <span data-ttu-id="e192a-323">Данный документ является hello справочник для ключа в хранилище службы программными средствами, включая настройку политики доступа в хранилище ключей toomanage API-интерфейс REST hello.</span><span class="sxs-lookup"><span data-stu-id="e192a-323">This document is hello reference for hello REST APIs toomanage your key vault programmatically, including setting key vault access policy.</span></span>
* [<span data-ttu-id="e192a-324">REST API хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="e192a-324">key vault REST APIs</span></span>](https://msdn.microsoft.com/library/azure/dn903609.aspx)
  
  <span data-ttu-id="e192a-325">Хранилище tookey ссылку справочной документации REST API.</span><span class="sxs-lookup"><span data-stu-id="e192a-325">Link tookey vault REST API reference documentation.</span></span>
* [<span data-ttu-id="e192a-326">Контроль доступа к ключам</span><span class="sxs-lookup"><span data-stu-id="e192a-326">Key access control</span></span>](https://msdn.microsoft.com/library/azure/dn903623.aspx#BKMK_KeyAccessControl)
  
  <span data-ttu-id="e192a-327">Свяжите tooSecret доступ управления справочной документации.</span><span class="sxs-lookup"><span data-stu-id="e192a-327">Link tooSecret access control reference documentation.</span></span>
* [<span data-ttu-id="e192a-328">Контроль доступа к секретам</span><span class="sxs-lookup"><span data-stu-id="e192a-328">Secret access control</span></span>](https://msdn.microsoft.com/library/azure/dn903623.aspx#BKMK_SecretAccessControl)
  
  <span data-ttu-id="e192a-329">Свяжите tooKey доступ управления справочной документации.</span><span class="sxs-lookup"><span data-stu-id="e192a-329">Link tooKey access control reference documentation.</span></span>
* <span data-ttu-id="e192a-330">[Настройка](https://msdn.microsoft.com/library/mt603625.aspx) и [удаление](https://msdn.microsoft.com/library/mt619427.aspx) политики доступа к хранилищу ключей с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="e192a-330">[Set](https://msdn.microsoft.com/library/mt603625.aspx) and [Remove](https://msdn.microsoft.com/library/mt619427.aspx) key vault access policy using PowerShell</span></span>
  
  <span data-ttu-id="e192a-331">Документация tooreference ссылки для политики доступа хранилища ключей toomanage командлеты PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e192a-331">Links tooreference documentation for PowerShell cmdlets toomanage key vault access policy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e192a-332">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="e192a-332">Next Steps</span></span>
<span data-ttu-id="e192a-333">Руководство по началу работы для администраторов см. в статье [Приступая к работе с хранилищем ключей Azure](key-vault-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="e192a-333">For a getting started tutorial for an administrator, see [Get Started with Azure key vault](key-vault-get-started.md).</span></span>

<span data-ttu-id="e192a-334">Дополнительные сведения о ведении журнала использования для хранилища ключей см. в статье [Ведение журнала хранилища ключей Azure](key-vault-logging.md).</span><span class="sxs-lookup"><span data-stu-id="e192a-334">For more information about usage logging for key vault, see [Azure key vault Logging](key-vault-logging.md).</span></span>

<span data-ttu-id="e192a-335">Дополнительные сведения об использовании ключей и секретов с помощью хранилища ключей Azure см. в статье [About keys, secrets, and certificates](https://msdn.microsoft.com/library/azure/dn903623.aspx) (О ключах, секретах и сертификатах).</span><span class="sxs-lookup"><span data-stu-id="e192a-335">For more information about using keys and secrets with Azure key vault, see [About Keys and Secrets](https://msdn.microsoft.com/library/azure/dn903623.aspx).</span></span>

<span data-ttu-id="e192a-336">Если у вас есть вопросы о хранилище ключей, посетите hello [хранилища ключей Azure форумы](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault)</span><span class="sxs-lookup"><span data-stu-id="e192a-336">If you have questions about key vault, visit hello [Azure key vault Forums](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault)</span></span>

