---
ms.assetid: 
title: "Удаление с возможностью восстановления хранилище ключей aaaAzure | Документы Microsoft"
ms.service: key-vault
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.date: 07/10/2017
ms.openlocfilehash: 1b402c58db6f25ae4ae5e2720786fa81eb0e839a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="72c71-102">Общие сведения об обратимом удалении в Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="72c71-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="72c71-103">Функция обратимого удаления хранилища ключей позволяет восстановить хранилищ hello удалены и объекты, хранилище, называемые программной delete.</span><span class="sxs-lookup"><span data-stu-id="72c71-103">Key Vault's soft delete feature allows recovery of hello deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="72c71-104">В частности мы адресов hello следующие сценарии:</span><span class="sxs-lookup"><span data-stu-id="72c71-104">Specifically, we address hello following scenarios:</span></span>

- <span data-ttu-id="72c71-105">Поддержка восстанавливаемого удаления хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="72c71-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="72c71-106">Поддержка восстанавливаемого удаления объектов Key Vault (например,</span><span class="sxs-lookup"><span data-stu-id="72c71-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="72c71-107">ключей, секретов, сертификатов).</span><span class="sxs-lookup"><span data-stu-id="72c71-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="72c71-108">Поддержка интерфейсов</span><span class="sxs-lookup"><span data-stu-id="72c71-108">Supporting interfaces</span></span>

<span data-ttu-id="72c71-109">Hello функция удаления программной изначально доступна через hello REST, .NET или C# и PowerShell интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="72c71-109">hello soft-delete feature is initially available through hello REST, .NET/C# and PowerShell interfaces.</span></span> <span data-ttu-id="72c71-110">См. Эти сведения, ссылки на toohello [хранилище справочника по ключам](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="72c71-110">Refer toohello references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="72c71-111">Сценарии</span><span class="sxs-lookup"><span data-stu-id="72c71-111">Scenarios</span></span>

<span data-ttu-id="72c71-112">Azure Key Vault — это отслеживаемые ресурсы, управляемые Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="72c71-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="72c71-113">Azure Resource Manager также задает четко определенное поведение для удаления, которое требует, чтобы после успешной операции удаления этот ресурс больше не был доступен.</span><span class="sxs-lookup"><span data-stu-id="72c71-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="72c71-114">функция удаления программной адреса Hello hello восстановления объекта hello удалены ли удаление hello было случайное или намеренное.</span><span class="sxs-lookup"><span data-stu-id="72c71-114">hello soft-delete feature addresses hello recovery of hello deleted object, whether hello deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="72c71-115">В типичном сценарии hello пользователь может случайно удаленных хранилища ключей и объектом хранилища ключей. Если этого хранилища ключей или ключа хранилища объекта были toobe восстановимых заранее определенное, hello пользователь может отменить удаление hello и восстанавливать свои данные.</span><span class="sxs-lookup"><span data-stu-id="72c71-115">In hello typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were toobe recoverable for a predetermined period, hello user may undo hello deletion and recover their data.</span></span>

2. <span data-ttu-id="72c71-116">В другом сценарии пользователь-мошенник может предпринимать toodelete хранилища ключей или объект хранилища ключей, например ключ в хранилище, toocause к прерыванию бизнеса.</span><span class="sxs-lookup"><span data-stu-id="72c71-116">In a different scenario, a rogue user may attempt toodelete a key vault or a key vault object, such as a key inside a vault, toocause a business disruption.</span></span> <span data-ttu-id="72c71-117">Отделение от hello фактическое удаление hello базовым данным hello удаление хранилища ключей hello объекта хранилища ключей можно использовать как меры предосторожности, ограничив разрешения для разных, tooa удаления данных для экземпляра надежные роли.</span><span class="sxs-lookup"><span data-stu-id="72c71-117">Separating hello deletion of hello key vault or key vault object from hello actual deletion of hello underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion tooa different, trusted role.</span></span> <span data-ttu-id="72c71-118">По существу, при таком подходе требуется кворум для операции, так как в противном случае может произойти немедленная потеря данных.</span><span class="sxs-lookup"><span data-stu-id="72c71-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="72c71-119">Поведение обратимого удаления</span><span class="sxs-lookup"><span data-stu-id="72c71-119">Soft-delete behavior</span></span>

<span data-ttu-id="72c71-120">С помощью этой функции hello операции удаления в хранилище ключей или объект хранилища ключей является фактически удерживая hello ресурсов для заданного срока, придавая вид hello объекта hello удаляется обратимо delete.</span><span class="sxs-lookup"><span data-stu-id="72c71-120">With this feature, hello DELETE operation on a key vault or key vault object is a soft-delete, effectively holding hello resources for a given retention period, while giving hello appearance that hello object is deleted.</span></span> <span data-ttu-id="72c71-121">Дополнительные службы Hello предоставляет механизм для восстановления удалена hello объекта, по существу, Отмена удаления hello.</span><span class="sxs-lookup"><span data-stu-id="72c71-121">hello service further provides a mechanism for recovering hello deleted object, essentially undoing hello deletion.</span></span> 

<span data-ttu-id="72c71-122">Обратимое удаление — это дополнительная функция Key Vault, которая **не включена по умолчанию** в этом выпуске.</span><span class="sxs-lookup"><span data-stu-id="72c71-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> <span data-ttu-id="72c71-123">Подробные сведения о включении soft-delete для хранилища ключей, см. руководство hello в ссылке hello для интерфейса hello по своему усмотрению, [хранилище справочника по ключам](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="72c71-123">For details on enabling soft-delete for your key vault, see hello specific guidance in hello reference for hello interface of your choice, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

### <a name="key-vault-recovery"></a><span data-ttu-id="72c71-124">Восстановление Key Vault</span><span class="sxs-lookup"><span data-stu-id="72c71-124">Key vault recovery</span></span>

<span data-ttu-id="72c71-125">После удаления хранилища ключей, hello службы создает ресурс прокси-сервера в рамках подписки hello, добавление метаданных, необходимых для восстановления.</span><span class="sxs-lookup"><span data-stu-id="72c71-125">Upon deleting a key vault, hello service creates a proxy resource under hello subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="72c71-126">Hello прокси-сервера ресурса — это хранимый объект, доступных в hello местоположения хранилища ключей hello удален.</span><span class="sxs-lookup"><span data-stu-id="72c71-126">hello proxy resource is a stored object, available in hello same location as hello deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="72c71-127">Восстановление объектов Key Vault</span><span class="sxs-lookup"><span data-stu-id="72c71-127">Key vault object recovery</span></span>

<span data-ttu-id="72c71-128">После удаления объекта хранилища ключей, например ключ, hello служба будет помещать hello объекта в удаленном состоянии, делая его недоступным tooany операций получения.</span><span class="sxs-lookup"><span data-stu-id="72c71-128">Upon deleting a key vault object, such as a key, hello service will place hello object in a deleted state, thus making it inaccessible tooany retrieval operations.</span></span> <span data-ttu-id="72c71-129">В этом состоянии hello объекта хранилища ключей можно только указать, восстановленные или принудительно или будут удалены.</span><span class="sxs-lookup"><span data-stu-id="72c71-129">While in this state, hello key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="72c71-130">В hello же времени, ключа хранилища будет запланировано удаление hello hello базовые данные соответствующего toohello удалены хранилища ключей или объект хранилища ключей для выполнения после интервал предопределенном хранения.</span><span class="sxs-lookup"><span data-stu-id="72c71-130">At hello same time, Key Vault will schedule hello deletion of hello underlying data corresponding toohello deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="72c71-131">Hello DNS записей соответствующее toohello хранилище также можно сохранить для hello длительность интервала хранения hello.</span><span class="sxs-lookup"><span data-stu-id="72c71-131">hello DNS record corresponding toohello vault is also retained for hello duration of hello retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="72c71-132">Период хранения при обратимом удалении</span><span class="sxs-lookup"><span data-stu-id="72c71-132">Soft-delete retention period</span></span>

<span data-ttu-id="72c71-133">Ресурсы обратимого удаления сохраняются в течение заданного периода времени — 90 дней.</span><span class="sxs-lookup"><span data-stu-id="72c71-133">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="72c71-134">Период хранения soft-delete hello применяются следующие hello.</span><span class="sxs-lookup"><span data-stu-id="72c71-134">During hello soft-delete retention interval, hello following apply:</span></span>

- <span data-ttu-id="72c71-135">Вы может список всех хранилищ ключей hello и хранилища ключей объектов в состоянии удаления программной hello для подписки, а также удаления и восстановления доступа о них.</span><span class="sxs-lookup"><span data-stu-id="72c71-135">You may list all of hello key vaults and key vault objects in hello soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="72c71-136">Только пользователи со специальными разрешениями могут вести список удаленных хранилищ.</span><span class="sxs-lookup"><span data-stu-id="72c71-136">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="72c71-137">Мы советуем нашим пользователям создать настраиваемую роль с этими разрешениями для управления удаленными хранилищами.</span><span class="sxs-lookup"><span data-stu-id="72c71-137">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="72c71-138">Хранилище ключей с таким же именем нельзя создать в hello hello местоположения; соответственно, хранилище ключей не удается создать объект в данном хранилище, если этого хранилища ключей содержит объект с hello таким же именем и который находится в удаленном состоянии</span><span class="sxs-lookup"><span data-stu-id="72c71-138">A key vault with hello same name cannot be created in hello same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with hello same name and which is in a deleted state</span></span> 
- <span data-ttu-id="72c71-139">Только специально привилегированный пользователь может восстановить хранилища ключей или объект хранилища ключей с помощью команды восстановить на hello соответствующий ресурс прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="72c71-139">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on hello corresponding proxy resource.</span></span>
    - <span data-ttu-id="72c71-140">пользователь Hello членом пользовательской роли hello, обладающего toocreate hello привилегий хранилища ключей в группе ресурсов hello можно восстановить хранилище hello.</span><span class="sxs-lookup"><span data-stu-id="72c71-140">hello user, member of hello custom role, who has hello privilege toocreate a key vault under hello resource group can restore hello vault.</span></span>
- <span data-ttu-id="72c71-141">Принудительно только специально привилегированный пользователь может удалять хранилища ключей или объект хранилища ключей с помощью команды delete на hello соответствующий ресурс прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="72c71-141">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on hello corresponding proxy resource.</span></span>

<span data-ttu-id="72c71-142">Если восстанавливается хранилища ключей или объект хранилища ключей, конец интервала hello hello хранения службы с hello выполняет очистку объекта hello обратимо удаленные хранилища ключей или ключа хранилища и его содержимое.</span><span class="sxs-lookup"><span data-stu-id="72c71-142">Unless a key vault or key vault object is recovered, at hello end of hello retention interval hello service performs a purge of hello soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="72c71-143">Удаление ресурса нельзя запланировать повторно.</span><span class="sxs-lookup"><span data-stu-id="72c71-143">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="72c71-144">Разрешенная очистка</span><span class="sxs-lookup"><span data-stu-id="72c71-144">Permitted purge</span></span>

<span data-ttu-id="72c71-145">Окончательно удалить, очистка, хранилища ключей можно сделать через операцию POST для ресурсов hello прокси-сервера и требует специальные права доступа.</span><span class="sxs-lookup"><span data-stu-id="72c71-145">Permanently deleting, purging, a key vault is possible via a POST operation on hello proxy resource and requires special privileges.</span></span> <span data-ttu-id="72c71-146">Как правило только владелец подписки hello будет может toopurge хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="72c71-146">Generally, only hello subscription owner will be able toopurge a key vault.</span></span> <span data-ttu-id="72c71-147">триггеры операции POST Hello hello немедленно и неустранимых удаления этого хранилища.</span><span class="sxs-lookup"><span data-stu-id="72c71-147">hello POST operation triggers hello immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="72c71-148">Исключение toothis случается hello когда hello подписки Azure был помечен как *неудаляемый*.</span><span class="sxs-lookup"><span data-stu-id="72c71-148">An exception toothis is hello case when hello Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="72c71-149">В этом случае только hello службы выполните фактическое удаление hello и выполняет как запланированные процесс.</span><span class="sxs-lookup"><span data-stu-id="72c71-149">In this case, only hello service may then perform hello actual deletion, and does so as a scheduled process.</span></span> 



