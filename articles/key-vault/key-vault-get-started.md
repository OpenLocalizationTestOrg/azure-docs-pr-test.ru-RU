---
title: "aaaGet к работе с хранилищем ключей Azure | Документы Microsoft"
description: "Использовать этот учебник toohelp, вы получаете работы с хранилищем ключей Azure toocreate жесткой контейнера в Azure, toostore и управлять ими, криптографические ключи и секретные данные в Azure."
services: key-vault
documentationcenter: 
author: cabailey
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: 36721e1d-38b8-4a15-ba6f-14ed5be4de79
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 07/19/2017
ms.author: cabailey
ms.openlocfilehash: 865853b778dec5fca5c7db0d060627554c0a9cb3
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="get-started-with-azure-key-vault"></a><span data-ttu-id="6115b-103">Приступая к работе с хранилищем ключей Azure</span><span class="sxs-lookup"><span data-stu-id="6115b-103">Get started with Azure Key Vault</span></span>
<span data-ttu-id="6115b-104">Хранилище ключей Azure доступно в большинстве регионов.</span><span class="sxs-lookup"><span data-stu-id="6115b-104">Azure Key Vault is available in most regions.</span></span> <span data-ttu-id="6115b-105">Дополнительные сведения см. в разделе hello [страница цен в хранилище ключей](https://azure.microsoft.com/pricing/details/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="6115b-105">For more information, see hello [Key Vault pricing page](https://azure.microsoft.com/pricing/details/key-vault/).</span></span>

## <a name="introduction"></a><span data-ttu-id="6115b-106">Введение</span><span class="sxs-lookup"><span data-stu-id="6115b-106">Introduction</span></span>
<span data-ttu-id="6115b-107">Использовать этот учебник toohelp, вы получаете работы с хранилищем ключей Azure toocreate жесткой контейнера (хранилище) в Azure, toostore и управлять ими, криптографические ключи и секретные данные в Azure.</span><span class="sxs-lookup"><span data-stu-id="6115b-107">Use this tutorial toohelp you get started with Azure Key Vault toocreate a hardened container (a vault) in Azure, toostore and manage cryptographic keys and secrets in Azure.</span></span> <span data-ttu-id="6115b-108">Помогает выполнить процесс с помощью Azure PowerShell toocreate hello хранилище, в котором содержится ключ или пароль, который затем можно использовать вместе с приложением Azure.</span><span class="sxs-lookup"><span data-stu-id="6115b-108">It walks you through hello process of using Azure PowerShell toocreate a vault that contains a key or password that you can then use with an Azure application.</span></span> <span data-ttu-id="6115b-109">В нем также показано, как приложение может использовать этот ключ или пароль.</span><span class="sxs-lookup"><span data-stu-id="6115b-109">It then shows you how an application can use that key or password.</span></span>

<span data-ttu-id="6115b-110">**Предполагаемое время toocomplete:** 20 минут</span><span class="sxs-lookup"><span data-stu-id="6115b-110">**Estimated time toocomplete:** 20 minutes</span></span>

> [!NOTE]
> <span data-ttu-id="6115b-111">Этот учебник не содержит инструкций для как toowrite hello Azure приложения, которое содержит один из шагов hello, а именно как tooauthorize приложения toouse ключа или секрета в ключе hello хранилище.</span><span class="sxs-lookup"><span data-stu-id="6115b-111">This tutorial does not include instructions for how toowrite hello Azure application that one of hello steps includes, namely how tooauthorize an application toouse a key or secret in hello key vault.</span></span>
>
> <span data-ttu-id="6115b-112">В этом руководстве используется Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6115b-112">This tutorial uses Azure PowerShell.</span></span> <span data-ttu-id="6115b-113">Инструкции по кроссплатформенному интерфейсу командной строки см. в [этом руководстве](key-vault-manage-with-cli2.md).</span><span class="sxs-lookup"><span data-stu-id="6115b-113">For Cross-Platform Command-Line Interface instructions, see [this equivalent tutorial](key-vault-manage-with-cli2.md).</span></span>
>
>

<span data-ttu-id="6115b-114">Общие сведения о хранилище ключей Azure см. в статье [Что такое хранилище ключей Azure?](key-vault-whatis.md)</span><span class="sxs-lookup"><span data-stu-id="6115b-114">For overview information about Azure Key Vault, see [What is Azure Key Vault?](key-vault-whatis.md)</span></span>

## <a name="prerequisites"></a><span data-ttu-id="6115b-115">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="6115b-115">Prerequisites</span></span>
<span data-ttu-id="6115b-116">toocomplete этого учебника необходимо иметь следующие hello:</span><span class="sxs-lookup"><span data-stu-id="6115b-116">toocomplete this tutorial, you must have hello following:</span></span>

* <span data-ttu-id="6115b-117">TooMicrosoft подписки Azure.</span><span class="sxs-lookup"><span data-stu-id="6115b-117">A subscription tooMicrosoft Azure.</span></span> <span data-ttu-id="6115b-118">Если у вас нет подписки, вы можете зарегистрироваться для использования [бесплатной учетной записи](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="6115b-118">If you do not have one, you can sign up for a [free account](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="6115b-119">Azure PowerShell, **начиная с версии 1.1.0**.</span><span class="sxs-lookup"><span data-stu-id="6115b-119">Azure PowerShell, **minimum version of 1.1.0**.</span></span> <span data-ttu-id="6115b-120">tooinstall Azure PowerShell и связать ее с подпиской Azure см. в разделе [как tooinstall и настройка Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="6115b-120">tooinstall Azure PowerShell and associate it with your Azure subscription, see [How tooinstall and configure Azure PowerShell](/powershell/azure/overview).</span></span> <span data-ttu-id="6115b-121">Если вы уже установили Azure PowerShell и вы не знаете версии hello из консоли Azure PowerShell hello, введите `(Get-Module azure -ListAvailable).Version`.</span><span class="sxs-lookup"><span data-stu-id="6115b-121">If you have already installed Azure PowerShell and do not know hello version, from hello Azure PowerShell console, type `(Get-Module azure -ListAvailable).Version`.</span></span> <span data-ttu-id="6115b-122">Если у вас установлено средство Azure PowerShell версий 0.9.1–0.9.8, вы можете использовать это руководство с некоторыми незначительными поправками.</span><span class="sxs-lookup"><span data-stu-id="6115b-122">When you have Azure PowerShell version 0.9.1 through 0.9.8 installed, you can still use this tutorial with some minor changes.</span></span> <span data-ttu-id="6115b-123">Например, необходимо использовать hello `Switch-AzureMode AzureResourceManager` команды и команд hello хранилище ключей Azure были изменены.</span><span class="sxs-lookup"><span data-stu-id="6115b-123">For example, you must use hello `Switch-AzureMode AzureResourceManager` command and some of hello Azure Key Vault commands have changed.</span></span> <span data-ttu-id="6115b-124">Список hello командлетам хранилища ключей для версий 0.9.1 через 0.9.8, в разделе [командлетам](/powershell/module/azurerm.keyvault/#key_vault).</span><span class="sxs-lookup"><span data-stu-id="6115b-124">For a list of hello Key Vault cmdlets for versions 0.9.1 through 0.9.8, see [Azure Key Vault Cmdlets](/powershell/module/azurerm.keyvault/#key_vault).</span></span>
* <span data-ttu-id="6115b-125">Приложение, настроенное toouse hello ключ или пароль, который создан в этом учебнике.</span><span class="sxs-lookup"><span data-stu-id="6115b-125">An application that will be configured toouse hello key or password that you create in this tutorial.</span></span> <span data-ttu-id="6115b-126">Образец приложения доступно из hello [центра загрузки Майкрософт](http://www.microsoft.com/en-us/download/details.aspx?id=45343).</span><span class="sxs-lookup"><span data-stu-id="6115b-126">A sample application is available from hello [Microsoft Download Center](http://www.microsoft.com/en-us/download/details.aspx?id=45343).</span></span> <span data-ttu-id="6115b-127">Инструкции см. в файле Readme, сопровождающие hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-127">For instructions, see hello accompanying Readme file.</span></span>

<span data-ttu-id="6115b-128">Этот учебник предназначен для начинающих Azure PowerShell, но предполагается, что вы понимаете базовые понятия hello, например модули, командлеты и сеансов.</span><span class="sxs-lookup"><span data-stu-id="6115b-128">This tutorial is designed for Azure PowerShell beginners, but it assumes that you understand hello basic concepts, such as modules, cmdlets, and sessions.</span></span> <span data-ttu-id="6115b-129">Дополнительные сведения см. в статье [Начало работы с Windows PowerShell](https://technet.microsoft.com/library/hh857337.aspx).</span><span class="sxs-lookup"><span data-stu-id="6115b-129">For more information, see [Getting started with Windows PowerShell](https://technet.microsoft.com/library/hh857337.aspx).</span></span>

<span data-ttu-id="6115b-130">tooget подробную справку для любого командлета, которое будет отображаться в этом учебнике используйте hello **Get-Help** командлета.</span><span class="sxs-lookup"><span data-stu-id="6115b-130">tooget detailed help for any cmdlet that you see in this tutorial, use hello **Get-Help** cmdlet.</span></span>

    Get-Help <cmdlet-name> -Detailed

<span data-ttu-id="6115b-131">Например, tooget справку для hello **AzureRmAccount входа** командлета введите:</span><span class="sxs-lookup"><span data-stu-id="6115b-131">For example, tooget help for hello **Login-AzureRmAccount** cmdlet, type:</span></span>

    Get-Help Login-AzureRmAccount -Detailed

<span data-ttu-id="6115b-132">Можно также прочитать hello следующие учебники tooget знакомы с диспетчером ресурсов Azure в Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6115b-132">You can also read hello following tutorials tooget familiar with Azure Resource Manager in Azure PowerShell:</span></span>

* [<span data-ttu-id="6115b-133">Как tooinstall и настройка Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="6115b-133">How tooinstall and configure Azure PowerShell</span></span>](/powershell/azure/overview)
* [<span data-ttu-id="6115b-134">Использование Azure PowerShell с диспетчером ресурсов</span><span class="sxs-lookup"><span data-stu-id="6115b-134">Using Azure PowerShell with Resource Manager</span></span>](../powershell-azure-resource-manager.md)

## <span data-ttu-id="6115b-135"><a id="connect"></a>Подключение tooyour подписки</span><span class="sxs-lookup"><span data-stu-id="6115b-135"><a id="connect"></a>Connect tooyour subscriptions</span></span>
<span data-ttu-id="6115b-136">Запустите сеанс Azure PowerShell и войдите в tooyour учетная запись Azure с hello следующую команду:</span><span class="sxs-lookup"><span data-stu-id="6115b-136">Start an Azure PowerShell session and sign in tooyour Azure account with hello following command:</span></span>  

    Login-AzureRmAccount

<span data-ttu-id="6115b-137">Обратите внимание, что при использовании определенного экземпляра Azure, например, Azure для государственных, используйте hello - параметр среды с помощью этой команды.</span><span class="sxs-lookup"><span data-stu-id="6115b-137">Note that if you are using a specific instance of Azure, for example, Azure Government, use hello -Environment parameter with this command.</span></span> <span data-ttu-id="6115b-138">Например: `Login-AzureRmAccount –Environment (Get-AzureRmEnvironment –Name AzureUSGovernment)`</span><span class="sxs-lookup"><span data-stu-id="6115b-138">For example: `Login-AzureRmAccount –Environment (Get-AzureRmEnvironment –Name AzureUSGovernment)`</span></span>

<span data-ttu-id="6115b-139">В hello всплывающем окне браузера введите имя пользователя учетной записи Azure и пароль.</span><span class="sxs-lookup"><span data-stu-id="6115b-139">In hello pop-up browser window, enter your Azure account user name and password.</span></span> <span data-ttu-id="6115b-140">Azure PowerShell возвращает все подписки hello, которые связаны с этой учетной записью, а также по умолчанию, использует hello первое.</span><span class="sxs-lookup"><span data-stu-id="6115b-140">Azure PowerShell gets all hello subscriptions that are associated with this account and by default, uses hello first one.</span></span>

<span data-ttu-id="6115b-141">Если есть несколько подписок и требуется toospecify конкретных один toouse для хранилища ключей Azure, введите hello, следуя toosee hello подписки для учетной записи:</span><span class="sxs-lookup"><span data-stu-id="6115b-141">If you have multiple subscriptions and want toospecify a specific one toouse for Azure Key Vault, type hello following toosee hello subscriptions for your account:</span></span>

    Get-AzureRmSubscription

<span data-ttu-id="6115b-142">Затем toospecify hello подписки toouse, тип:</span><span class="sxs-lookup"><span data-stu-id="6115b-142">Then, toospecify hello subscription toouse, type:</span></span>

    Set-AzureRmContext -SubscriptionId <subscription ID>

<span data-ttu-id="6115b-143">Дополнительные сведения о настройке Azure PowerShell см. в разделе [как tooinstall и настройка Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="6115b-143">For more information about configuring Azure PowerShell, see [How tooinstall and configure Azure PowerShell](/powershell/azure/overview).</span></span>

## <span data-ttu-id="6115b-144"><a id="resource"></a>Создание новой группы ресурсов</span><span class="sxs-lookup"><span data-stu-id="6115b-144"><a id="resource"></a>Create a new resource group</span></span>
<span data-ttu-id="6115b-145">При использовании диспетчера ресурсов Azure все связанные ресурсы создаются внутри группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="6115b-145">When you use Azure Resource Manager, all related resources are created inside a resource group.</span></span> <span data-ttu-id="6115b-146">Для примера мы создадим новую группу ресурсов с именем **ContosoResourceGroup** :</span><span class="sxs-lookup"><span data-stu-id="6115b-146">We will create a new resource group named **ContosoResourceGroup** for this tutorial:</span></span>

    New-AzureRmResourceGroup –Name 'ContosoResourceGroup' –Location 'East Asia'


## <span data-ttu-id="6115b-147"><a id="vault"></a>Создание хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="6115b-147"><a id="vault"></a>Create a key vault</span></span>
<span data-ttu-id="6115b-148">Используйте hello [New AzureRmKeyVault](/powershell/module/azurerm.keyvault/new-azurermkeyvault) toocreate командлет хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="6115b-148">Use hello [New-AzureRmKeyVault](/powershell/module/azurerm.keyvault/new-azurermkeyvault) cmdlet toocreate a key vault.</span></span> <span data-ttu-id="6115b-149">Этот командлет имеет три обязательных параметра: **имя группы ресурсов**, **имя хранилища ключей**и hello **географическое расположение**.</span><span class="sxs-lookup"><span data-stu-id="6115b-149">This cmdlet has three mandatory parameters: a **resource group name**, a **key vault name**, and hello **geographic location**.</span></span>

<span data-ttu-id="6115b-150">Например, если вы используете хранилище hello с именем **ContosoKeyVault**, hello группу ресурсов с именем **ContosoResourceGroup**и расположение hello **Восточная Азия**, тип:</span><span class="sxs-lookup"><span data-stu-id="6115b-150">For example, if you use hello vault name of **ContosoKeyVault**, hello resource group name of **ContosoResourceGroup**, and hello location of **East Asia**, type:</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="6115b-151">выходные данные командлета Hello приведены свойства ключа хранилища hello, которое вы только что создали.</span><span class="sxs-lookup"><span data-stu-id="6115b-151">hello output of this cmdlet shows properties of hello key vault that you’ve just created.</span></span> <span data-ttu-id="6115b-152">Hello двух наиболее важных свойств:</span><span class="sxs-lookup"><span data-stu-id="6115b-152">hello two most important properties are:</span></span>

* <span data-ttu-id="6115b-153">**Имя хранилища**: В примере hello это **ContosoKeyVault**.</span><span class="sxs-lookup"><span data-stu-id="6115b-153">**Vault Name**: In hello example, this is **ContosoKeyVault**.</span></span> <span data-ttu-id="6115b-154">Вы будете использовать это имя для выполнения других командлетов хранилища ключей;</span><span class="sxs-lookup"><span data-stu-id="6115b-154">You will use this name for other Key Vault cmdlets.</span></span>
* <span data-ttu-id="6115b-155">**Код URI хранилища**: пример hello это https://contosokeyvault.vault.azure.net/.</span><span class="sxs-lookup"><span data-stu-id="6115b-155">**Vault URI**: In hello example, this is https://contosokeyvault.vault.azure.net/.</span></span> <span data-ttu-id="6115b-156">Необходимо, чтобы приложения, использующие ваше хранилище через REST API, использовали этот URI.</span><span class="sxs-lookup"><span data-stu-id="6115b-156">Applications that use your vault through its REST API must use this URI.</span></span>

<span data-ttu-id="6115b-157">Учетная запись Azure — теперь авторизованным tooperform все операции в этот ключ в хранилище.</span><span class="sxs-lookup"><span data-stu-id="6115b-157">Your Azure account is now authorized tooperform any operations on this key vault.</span></span> <span data-ttu-id="6115b-158">Пока что это недоступно для других учетных записей.</span><span class="sxs-lookup"><span data-stu-id="6115b-158">As yet, nobody else is.</span></span>

> [!NOTE]
> <span data-ttu-id="6115b-159">При возникновении ошибки hello **hello подписки не зарегистрированного toouse пространством имен «Microsoft.KeyVault»** при обращении toocreate новое хранилище ключей, выполните `Register-AzureRmResourceProvider -ProviderNamespace "Microsoft.KeyVault"` и затем снова запустите команду New-AzureRmKeyVault.</span><span class="sxs-lookup"><span data-stu-id="6115b-159">If you see hello error **hello subscription is not registered toouse namespace 'Microsoft.KeyVault'** when you try toocreate your new key vault, run `Register-AzureRmResourceProvider -ProviderNamespace "Microsoft.KeyVault"` and then rerun your New-AzureRmKeyVault command.</span></span> <span data-ttu-id="6115b-160">Дополнительные сведения см. в статье [Register-AzureRmResourceProvider](/powershell/module/azurerm.resources/register-azurermresourceprovider).</span><span class="sxs-lookup"><span data-stu-id="6115b-160">For more information, see [Register-AzureRmResourceProvider](/powershell/module/azurerm.resources/register-azurermresourceprovider).</span></span>
>
>

## <span data-ttu-id="6115b-161"><a id="add"></a>Добавление ключа или секрета toohello хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="6115b-161"><a id="add"></a>Add a key or secret toohello key vault</span></span>
<span data-ttu-id="6115b-162">Хранилище ключей Azure toocreate программно защищенного ключа для вас, используйте hello [Add-AzureKeyVaultKey](/powershell/module/azurerm.keyvault/add-azurekeyvaultkey) командлет и введите hello ниже:</span><span class="sxs-lookup"><span data-stu-id="6115b-162">If you want Azure Key Vault toocreate a software-protected key for you, use hello [Add-AzureKeyVaultKey](/powershell/module/azurerm.keyvault/add-azurekeyvaultkey) cmdlet, and type hello following:</span></span>

    $key = Add-AzureKeyVaultKey -VaultName 'ContosoKeyVault' -Name 'ContosoFirstKey' -Destination 'Software'

<span data-ttu-id="6115b-163">Тем не менее если имеется существующий программно защищенного ключа. Файл сохранен PFX tooyour C:\ диск в файл с именем, которые должны tooupload tooAzure хранилище ключей, тип hello следующая переменная hello tooset softkey.pfx **securepfxpwd** пароль **123** для hello. PFX-файла:</span><span class="sxs-lookup"><span data-stu-id="6115b-163">However, if you have an existing software-protected key in a .PFX file saved tooyour C:\ drive in a file named softkey.pfx that you want tooupload tooAzure Key Vault, type hello following tooset hello variable **securepfxpwd** for a password of **123** for hello .PFX file:</span></span>

    $securepfxpwd = ConvertTo-SecureString –String '123' –AsPlainText –Force

<span data-ttu-id="6115b-164">Затем введите следующую tooimport hello ключ из hello hello. PFX-файл, который защищает hello с помощью программного обеспечения в hello службы хранилища ключей:</span><span class="sxs-lookup"><span data-stu-id="6115b-164">Then type hello following tooimport hello key from hello .PFX file, which protects hello key by software in hello Key Vault service:</span></span>

    $key = Add-AzureKeyVaultKey -VaultName 'ContosoKeyVault' -Name 'ContosoFirstKey' -KeyFilePath 'c:\softkey.pfx' -KeyFilePassword $securepfxpwd


<span data-ttu-id="6115b-165">Теперь можно ссылаться на этот ключ, созданные или переданные tooAzure хранилище ключей с помощью URI-адрес.</span><span class="sxs-lookup"><span data-stu-id="6115b-165">You can now reference this key that you created or uploaded tooAzure Key Vault, by using its URI.</span></span> <span data-ttu-id="6115b-166">Используйте **https://ContosoKeyVault.vault.azure.net/keys/ContosoFirstKey** tooalways получения текущей версии hello и **https://ContosoKeyVault.vault.azure.net/keys/ContosoFirstKey/ cgacf4f763ar42ffb0a1gca546aygd87** tooget этой конкретной версии.</span><span class="sxs-lookup"><span data-stu-id="6115b-166">Use **https://ContosoKeyVault.vault.azure.net/keys/ContosoFirstKey** tooalways get hello current version, and use **https://ContosoKeyVault.vault.azure.net/keys/ContosoFirstKey/cgacf4f763ar42ffb0a1gca546aygd87** tooget this specific version.</span></span>  

<span data-ttu-id="6115b-167">hello toodisplay URI для этого ключа типа:</span><span class="sxs-lookup"><span data-stu-id="6115b-167">toodisplay hello URI for this key, type:</span></span>

    $Key.key.kid

<span data-ttu-id="6115b-168">tooadd хранилище toohello секретный пароль, с именем SQLPassword и имеют значение hello Pa$ $w0rd tooAzure хранилище ключей, сначала преобразуйте значение hello Pa$ $w0rd tooa защищенной строки, введя следующее hello:</span><span class="sxs-lookup"><span data-stu-id="6115b-168">tooadd a secret toohello vault, which is a password named SQLPassword and has hello value of Pa$$w0rd tooAzure Key Vault, first convert hello value of Pa$$w0rd tooa secure string by typing hello following:</span></span>

    $secretvalue = ConvertTo-SecureString 'Pa$$w0rd' -AsPlainText -Force

<span data-ttu-id="6115b-169">Затем введите hello следующее:</span><span class="sxs-lookup"><span data-stu-id="6115b-169">Then, type hello following:</span></span>

    $secret = Set-AzureKeyVaultSecret -VaultName 'ContosoKeyVault' -Name 'SQLPassword' -SecretValue $secretvalue

<span data-ttu-id="6115b-170">Теперь можно ссылаться на этот пароль добавили tooAzure хранилище ключей с помощью URI-адрес.</span><span class="sxs-lookup"><span data-stu-id="6115b-170">You can now reference this password that you added tooAzure Key Vault, by using its URI.</span></span> <span data-ttu-id="6115b-171">Используйте **https://ContosoVault.vault.azure.net/secrets/SQLPassword** tooalways получения текущей версии hello и **https://ContosoVault.vault.azure.net/secrets/SQLPassword/ 90018dbb96a84117a0d2847ef8e7189d** tooget этой конкретной версии.</span><span class="sxs-lookup"><span data-stu-id="6115b-171">Use **https://ContosoVault.vault.azure.net/secrets/SQLPassword** tooalways get hello current version, and use **https://ContosoVault.vault.azure.net/secrets/SQLPassword/90018dbb96a84117a0d2847ef8e7189d** tooget this specific version.</span></span>

<span data-ttu-id="6115b-172">hello toodisplay URI для этот секрет типа:</span><span class="sxs-lookup"><span data-stu-id="6115b-172">toodisplay hello URI for this secret, type:</span></span>

    $secret.Id

<span data-ttu-id="6115b-173">Позволяет просмотреть hello ключа или секрета, который вы только что создали:</span><span class="sxs-lookup"><span data-stu-id="6115b-173">Let’s view hello key or secret that you just created:</span></span>

* <span data-ttu-id="6115b-174">tooview вашей, введите:`Get-AzureKeyVaultKey –VaultName 'ContosoKeyVault'`</span><span class="sxs-lookup"><span data-stu-id="6115b-174">tooview your key, type: `Get-AzureKeyVaultKey –VaultName 'ContosoKeyVault'`</span></span>
* <span data-ttu-id="6115b-175">tooview в тайне, тип:`Get-AzureKeyVaultSecret –VaultName 'ContosoKeyVault'`</span><span class="sxs-lookup"><span data-stu-id="6115b-175">tooview your secret, type: `Get-AzureKeyVaultSecret –VaultName 'ContosoKeyVault'`</span></span>

<span data-ttu-id="6115b-176">Теперь хранилища ключей и ключа или секрета готова для toouse приложений.</span><span class="sxs-lookup"><span data-stu-id="6115b-176">Now, your key vault and key or secret is ready for applications toouse.</span></span> <span data-ttu-id="6115b-177">Toouse приложений необходимо авторизовать их.</span><span class="sxs-lookup"><span data-stu-id="6115b-177">You must authorize applications toouse them.</span></span>  

## <span data-ttu-id="6115b-178"><a id="register"></a>Регистрация приложения в Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="6115b-178"><a id="register"></a>Register an application with Azure Active Directory</span></span>
<span data-ttu-id="6115b-179">Обычно этот шаг выполняет разработчик на отдельном компьютере.</span><span class="sxs-lookup"><span data-stu-id="6115b-179">This step would usually be done by a developer, on a separate computer.</span></span> <span data-ttu-id="6115b-180">Он не tooAzure конкретного хранилища ключей, но указан для полноты.</span><span class="sxs-lookup"><span data-stu-id="6115b-180">It is not specific tooAzure Key Vault, but is included here for completeness.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6115b-181">Учебник toocomplete hello, учетная запись, хранилище hello и приложения hello, которое будет зарегистрирован на этом шаге необходимо в hello один каталог Azure.</span><span class="sxs-lookup"><span data-stu-id="6115b-181">toocomplete hello tutorial, your account, hello vault, and hello application that you will register in this step must all be in hello same Azure directory.</span></span>
>
>

<span data-ttu-id="6115b-182">Приложения, которые используют хранилища ключей, должны пройти аутентификацию с использованием токена Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6115b-182">Applications that use a key vault must authenticate by using a token from Azure Active Directory.</span></span> <span data-ttu-id="6115b-183">toodo, hello владелец приложения hello сначала необходимо зарегистрировать приложение hello в своем Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6115b-183">toodo this, hello owner of hello application must first register hello application in their Azure Active Directory.</span></span> <span data-ttu-id="6115b-184">В конце hello регистрации владелец приложения hello возвращает hello следующие значения:</span><span class="sxs-lookup"><span data-stu-id="6115b-184">At hello end of registration, hello application owner gets hello following values:</span></span>

* <span data-ttu-id="6115b-185">**Идентификатор приложения** (также известный как идентификатор клиента) и **ключ проверки подлинности** (также известный как общий секрет hello).</span><span class="sxs-lookup"><span data-stu-id="6115b-185">An **Application ID** (also known as a Client ID) and **authentication key** (also known as hello shared secret).</span></span> <span data-ttu-id="6115b-186">приложение Hello необходимо представить оба этих значения tooAzure Active Directory, tooget маркер.</span><span class="sxs-lookup"><span data-stu-id="6115b-186">hello application must present both these values tooAzure Active Directory, tooget a token.</span></span> <span data-ttu-id="6115b-187">Как приложение hello настраивается toodo это зависит от приложения hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-187">How hello application is configured toodo this depends on hello application.</span></span> <span data-ttu-id="6115b-188">Для hello образец приложения хранилища ключей владелец приложения hello устанавливает эти значения в файле app.config hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-188">For hello Key Vault sample application, hello application owner sets these values in hello app.config file.</span></span>

<span data-ttu-id="6115b-189">приложение hello tooregister в Azure Active Directory:</span><span class="sxs-lookup"><span data-stu-id="6115b-189">tooregister hello application in Azure Active Directory:</span></span>

1. <span data-ttu-id="6115b-190">Войдите в систему toohello классический портал Azure.</span><span class="sxs-lookup"><span data-stu-id="6115b-190">Sign in toohello Azure classic portal.</span></span>
2. <span data-ttu-id="6115b-191">В левой части экрана приветствия щелкните **Active Directory**и выберите каталог hello, в котором будет зарегистрировать приложение.</span><span class="sxs-lookup"><span data-stu-id="6115b-191">On hello left, click **Active Directory**, and then select hello directory in which you will register your application.</span></span> <br> <br> <span data-ttu-id="6115b-192">**Примечание:** hello необходимо выбрать каталог, содержащий hello подписки Azure, в которой для создания хранилища ключей.</span><span class="sxs-lookup"><span data-stu-id="6115b-192">**Note:** You must select hello same directory that contains hello Azure subscription with which you created your key vault.</span></span> <span data-ttu-id="6115b-193">Если вы не знаете, какой каталог это, нажмите кнопку **параметры**идентификации hello подписки, в которой для создания хранилища ключей и Примечание hello hello directory название hello последнего столбца.</span><span class="sxs-lookup"><span data-stu-id="6115b-193">If you do not know which directory this is, click **Settings**, identify hello subscription with which you created your key vault, and note hello name of hello directory displayed in hello last column.</span></span>
3. <span data-ttu-id="6115b-194">Щелкните **ПРИЛОЖЕНИЯ**.</span><span class="sxs-lookup"><span data-stu-id="6115b-194">Click **APPLICATIONS**.</span></span> <span data-ttu-id="6115b-195">Если приложения не были добавлены tooyour каталог, на этой странице отображаются только hello **добавить приложение** ссылку.</span><span class="sxs-lookup"><span data-stu-id="6115b-195">If no apps have been added tooyour directory, this page shows only hello **Add an App** link.</span></span> <span data-ttu-id="6115b-196">Щелкните ссылку hello, или в качестве альтернативы можно щелкнуть **добавить** на панели команд hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-196">Click hello link, or alternatively, you can click **ADD** on hello command bar.</span></span>
4. <span data-ttu-id="6115b-197">В hello **добавить приложение** мастера hello **что вам требуется toodo?** щелкните **добавить приложение, разрабатываемое моей организацией**.</span><span class="sxs-lookup"><span data-stu-id="6115b-197">In hello **ADD APPLICATION** wizard, on hello **What do you want toodo?** page, click **Add an application my organization is developing**.</span></span>
5. <span data-ttu-id="6115b-198">На hello **Расскажите о своем приложении** страницы, укажите имя для приложения и выберите **веб-приложение и/или WEB API** (по умолчанию hello).</span><span class="sxs-lookup"><span data-stu-id="6115b-198">On hello **Tell us about your application** page, specify a name for your application, and then select **WEB APPLICATION AND/OR WEB API** (hello default).</span></span> <span data-ttu-id="6115b-199">Нажмите кнопку hello **Далее** значок.</span><span class="sxs-lookup"><span data-stu-id="6115b-199">Click hello **Next** icon.</span></span>
6. <span data-ttu-id="6115b-200">На hello **свойства приложения** укажите hello **URL-адрес входа** и **URI идентификатора приложения** для веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="6115b-200">On hello **App properties** page, specify hello **SIGN-ON URL** and **APP ID URI** for your web application.</span></span> <span data-ttu-id="6115b-201">Если в вашем приложении нет этих значений, можно придумать их для этого шага (например, можно указать http://test1.contoso.com в обоих полях).</span><span class="sxs-lookup"><span data-stu-id="6115b-201">If your application does not have these values, you can make them up for this step (for example, you could specify http://test1.contoso.com for both boxes).</span></span> <span data-ttu-id="6115b-202">Неважно, существуют ли эти сайты.</span><span class="sxs-lookup"><span data-stu-id="6115b-202">It does not matter if these sites exist.</span></span> <span data-ttu-id="6115b-203">Важно то, что URI идентификатора приложения hello для каждого приложения отличается для каждого приложения в каталоге.</span><span class="sxs-lookup"><span data-stu-id="6115b-203">What is important is that hello app ID URI for each application is different for every application in your directory.</span></span> <span data-ttu-id="6115b-204">каталог Hello используется этой строки tooidentify приложений.</span><span class="sxs-lookup"><span data-stu-id="6115b-204">hello directory uses this string tooidentify your app.</span></span>
7. <span data-ttu-id="6115b-205">Нажмите кнопку hello **завершить** toosave значок изменения в мастере hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-205">Click hello **Complete** icon toosave your changes in hello wizard.</span></span>
8. <span data-ttu-id="6115b-206">На hello **быстрый запуск** щелкните **Настройка**.</span><span class="sxs-lookup"><span data-stu-id="6115b-206">On hello **Quick Start** page, click **CONFIGURE**.</span></span>
9. <span data-ttu-id="6115b-207">Прокрутите toohello **ключей** выберите длительность hello и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="6115b-207">Scroll toohello **keys** section, select hello duration, and then click **SAVE**.</span></span> <span data-ttu-id="6115b-208">Страница приветствия обновляется и теперь отображается значение ключа.</span><span class="sxs-lookup"><span data-stu-id="6115b-208">hello page refreshes and now shows a key value.</span></span> <span data-ttu-id="6115b-209">Необходимо настроить приложение с таким значением ключа и hello **идентификатор КЛИЕНТА** значение.</span><span class="sxs-lookup"><span data-stu-id="6115b-209">You must configure your application with this key value and hello **CLIENT ID** value.</span></span> <span data-ttu-id="6115b-210">(указания по этой конфигурации зависят от конкретного приложения).</span><span class="sxs-lookup"><span data-stu-id="6115b-210">(Instructions for this configuration are application-specific.)</span></span>
10. <span data-ttu-id="6115b-211">На этой странице, который будет использоваться в hello следующий шаг tooset разрешения на ваше хранилище, скопируйте значение идентификатора клиента hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-211">Copy hello client ID value from this page, which you will use in hello next step tooset permissions on your vault.</span></span>

## <span data-ttu-id="6115b-212"><a id="authorize"></a>Авторизовать hello приложения toouse hello ключа или секрета</span><span class="sxs-lookup"><span data-stu-id="6115b-212"><a id="authorize"></a>Authorize hello application toouse hello key or secret</span></span>
<span data-ttu-id="6115b-213">tooaccess приложения hello tooauthorize hello ключа или секрета в хранилище hello, используйте [Set-AzureRmKeyVaultAccessPolicy](/powershell/module/azurerm.keyvault/set-azurermkeyvaultaccesspolicy) командлета.</span><span class="sxs-lookup"><span data-stu-id="6115b-213">tooauthorize hello application tooaccess hello key or secret in hello vault, use the [Set-AzureRmKeyVaultAccessPolicy](/powershell/module/azurerm.keyvault/set-azurermkeyvaultaccesspolicy) cmdlet.</span></span>

<span data-ttu-id="6115b-214">Например, если имя хранилища — **ContosoKeyVault** и tooauthorize имеет идентификатор клиента 8f8c4bbd-485b-45fd-98f7-ec6300b7b4ed, и вы хотите toodecrypt приложения hello tooauthorize входа с ключами в приложение hello хранилище, выполните следующие hello:</span><span class="sxs-lookup"><span data-stu-id="6115b-214">For example, if your vault name is **ContosoKeyVault** and hello application you want tooauthorize has a client ID of 8f8c4bbd-485b-45fd-98f7-ec6300b7b4ed, and you want tooauthorize hello application toodecrypt and sign with keys in your vault, run hello following:</span></span>

    Set-AzureRmKeyVaultAccessPolicy -VaultName 'ContosoKeyVault' -ServicePrincipalName 8f8c4bbd-485b-45fd-98f7-ec6300b7b4ed -PermissionsToKeys decrypt,sign

<span data-ttu-id="6115b-215">Tooauthorize этой же tooread секреты приложения в хранилище, выполните следующие hello:</span><span class="sxs-lookup"><span data-stu-id="6115b-215">If you want tooauthorize that same application tooread secrets in your vault, run hello following:</span></span>

    Set-AzureRmKeyVaultAccessPolicy -VaultName 'ContosoKeyVault' -ServicePrincipalName 8f8c4bbd-485b-45fd-98f7-ec6300b7b4ed -PermissionsToSecrets Get

## <span data-ttu-id="6115b-216"><a id="HSM"></a>Если требуется, чтобы toouse аппаратный модуль безопасности (HSM)</span><span class="sxs-lookup"><span data-stu-id="6115b-216"><a id="HSM"></a>If you want toouse a hardware security module (HSM)</span></span>
<span data-ttu-id="6115b-217">Для повышения надежности можно импортировать или создавать ключи в аппаратных модулях безопасности (HSM), никогда не покидают границ HSM hello.</span><span class="sxs-lookup"><span data-stu-id="6115b-217">For added assurance, you can import or generate keys in hardware security modules (HSMs) that never leave hello HSM boundary.</span></span> <span data-ttu-id="6115b-218">Hello аппаратные модули безопасности являются FIPS 140-2 уровня 2 проверки.</span><span class="sxs-lookup"><span data-stu-id="6115b-218">hello HSMs are FIPS 140-2 Level 2 validated.</span></span> <span data-ttu-id="6115b-219">Если это требование не распространяется tooyou, пропустите этот раздел и перейдите слишком[удалить hello хранилища ключей и связанные ключи и секретные данные](#delete).</span><span class="sxs-lookup"><span data-stu-id="6115b-219">If this requirement doesn't apply tooyou, skip this section and go too[Delete hello key vault and associated keys and secrets](#delete).</span></span>

<span data-ttu-id="6115b-220">toocreate этих ключей, защищенных HSM, необходимо использовать hello [хранилище ключей Azure Premium службы ключей, защищенных HSM toosupport уровня](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="6115b-220">toocreate these HSM-protected keys, you must use hello [Azure Key Vault Premium service tier toosupport HSM-protected keys](https://azure.microsoft.com/pricing/free-trial/).</span></span> <span data-ttu-id="6115b-221">Обратите внимание, эта функция недоступна для Китая.</span><span class="sxs-lookup"><span data-stu-id="6115b-221">In addition, note that this functionality is not available for Azure China.</span></span>

<span data-ttu-id="6115b-222">При создании хранилища ключей hello добавить hello **- SKU** параметр:</span><span class="sxs-lookup"><span data-stu-id="6115b-222">When you create hello key vault, add hello **-SKU** parameter:</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVaultHSM' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia' -SKU 'Premium'



<span data-ttu-id="6115b-223">Можно добавить программно защищенных ключей (как показано выше) и хранилища ключей toothis ключей, защищенных HSM.</span><span class="sxs-lookup"><span data-stu-id="6115b-223">You can add software-protected keys (as shown earlier) and HSM-protected keys toothis key vault.</span></span> <span data-ttu-id="6115b-224">toocreate Перенос аппаратно защищенного ключа набора hello **-назначения** too'HSM параметр ":</span><span class="sxs-lookup"><span data-stu-id="6115b-224">toocreate an HSM-protected key, set hello **-Destination** parameter too'HSM':</span></span>

    $key = Add-AzureKeyVaultKey -VaultName 'ContosoKeyVaultHSM' -Name 'ContosoFirstHSMKey' -Destination 'HSM'

<span data-ttu-id="6115b-225">Можно использовать следующие команды tooimport hello ключа из. PFX-файл на компьютере.</span><span class="sxs-lookup"><span data-stu-id="6115b-225">You can use hello following command tooimport a key from a .PFX file on your computer.</span></span> <span data-ttu-id="6115b-226">Эта команда импортирует ключ hello в аппаратные модули безопасности в hello службы хранилища ключей:</span><span class="sxs-lookup"><span data-stu-id="6115b-226">This command imports hello key into HSMs in hello Key Vault service:</span></span>

    $key = Add-AzureKeyVaultKey -VaultName 'ContosoKeyVaultHSM' -Name 'ContosoFirstHSMKey' -KeyFilePath 'c:\softkey.pfx' -KeyFilePassword $securepfxpwd -Destination 'HSM'


<span data-ttu-id="6115b-227">Hello следующая команда импортирует «принеси свой собственный ключ» (BYOK) пакета.</span><span class="sxs-lookup"><span data-stu-id="6115b-227">hello next command imports a “bring your own key" (BYOK) package.</span></span> <span data-ttu-id="6115b-228">Этот сценарий позволяет создание ключа в ваш локальный HSM и передачи tooHSMs в hello службы хранилища ключей без ключа hello, оставляя границ HSM hello:</span><span class="sxs-lookup"><span data-stu-id="6115b-228">This scenario lets you generate your key in your local HSM, and transfer it tooHSMs in hello Key Vault service, without hello key leaving hello HSM boundary:</span></span>

    $key = Add-AzureKeyVaultKey -VaultName 'ContosoKeyVaultHSM' -Name 'ContosoFirstHSMKey' -KeyFilePath 'c:\ITByok.byok' -Destination 'HSM'

<span data-ttu-id="6115b-229">Более подробные инструкции о том, как toogenerate этот пакет BYOK разделе [как toogenerate и передача ключей, защищенных HSM для хранилища ключей Azure](key-vault-hsm-protected-keys.md).</span><span class="sxs-lookup"><span data-stu-id="6115b-229">For more detailed instructions about how toogenerate this BYOK package, see [How toogenerate and transfer HSM-protected keys for Azure Key Vault](key-vault-hsm-protected-keys.md).</span></span>

## <span data-ttu-id="6115b-230"><a id="delete"></a>Удаление хранилища ключей hello и связанные ключи и секретные данные</span><span class="sxs-lookup"><span data-stu-id="6115b-230"><a id="delete"></a>Delete hello key vault and associated keys and secrets</span></span>
<span data-ttu-id="6115b-231">Если вы больше не нужна hello хранилища ключей и hello ключа или секрета, который его содержит, можно удалить hello хранилища ключей с помощью hello [AzureRmKeyVault удаление](/powershell/module/azurerm.keyvault/remove-azurermkeyvault) командлета:</span><span class="sxs-lookup"><span data-stu-id="6115b-231">If you no longer need hello key vault and hello key or secret that it contains, you can delete hello key vault by using hello [Remove-AzureRmKeyVault](/powershell/module/azurerm.keyvault/remove-azurermkeyvault) cmdlet:</span></span>

    Remove-AzureRmKeyVault -VaultName 'ContosoKeyVault'

<span data-ttu-id="6115b-232">Или можно удалить группы весь ресурс Azure, которая включает в себя хранилище ключей hello и другие ресурсы, которые включены в эту группу:</span><span class="sxs-lookup"><span data-stu-id="6115b-232">Or, you can delete an entire Azure resource group, which includes hello key vault and any other resources that you included in that group:</span></span>

    Remove-AzureRmResourceGroup -ResourceGroupName 'ContosoResourceGroup'


## <span data-ttu-id="6115b-233"><a id="other"></a>Другие командлеты Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="6115b-233"><a id="other"></a>Other Azure PowerShell Cmdlets</span></span>
<span data-ttu-id="6115b-234">Другие команды, которые могут быть полезны при управлении хранилищем ключей Azure.</span><span class="sxs-lookup"><span data-stu-id="6115b-234">Other commands that you might find useful for managing Azure Key Vault:</span></span>

* <span data-ttu-id="6115b-235">`$Keys = Get-AzureKeyVaultKey -VaultName 'ContosoKeyVault'` — эта команда отображает все ключи и выбранные свойства в виде таблицы;</span><span class="sxs-lookup"><span data-stu-id="6115b-235">`$Keys = Get-AzureKeyVaultKey -VaultName 'ContosoKeyVault'`: This command gets a tabular display of all keys and selected properties.</span></span>
* <span data-ttu-id="6115b-236">`$Keys[0]`: Эта команда отображает полный список свойств для указанного ключа hello</span><span class="sxs-lookup"><span data-stu-id="6115b-236">`$Keys[0]`: This command displays a full list of properties for hello specified key</span></span>
* <span data-ttu-id="6115b-237">`Get-AzureKeyVaultSecret` — эта команда перечисляет все имена секретов и выбранные свойства в виде таблицы;</span><span class="sxs-lookup"><span data-stu-id="6115b-237">`Get-AzureKeyVaultSecret`: This command lists a tabular display of all secret names and selected properties.</span></span>
* <span data-ttu-id="6115b-238">`Remove-AzureKeyVaultKey -VaultName 'ContosoKeyVault' -Name 'ContosoFirstKey'`: Пример как tooremove определенного ключа.</span><span class="sxs-lookup"><span data-stu-id="6115b-238">`Remove-AzureKeyVaultKey -VaultName 'ContosoKeyVault' -Name 'ContosoFirstKey'`: Example how tooremove a specific key.</span></span>
* <span data-ttu-id="6115b-239">`Remove-AzureKeyVaultSecret -VaultName 'ContosoKeyVault' -Name 'SQLPassword'`: Пример как tooremove конкретных секрета.</span><span class="sxs-lookup"><span data-stu-id="6115b-239">`Remove-AzureKeyVaultSecret -VaultName 'ContosoKeyVault' -Name 'SQLPassword'`: Example how tooremove a specific secret.</span></span>

## <span data-ttu-id="6115b-240"><a id="next"></a>Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="6115b-240"><a id="next"></a>Next steps</span></span>
<span data-ttu-id="6115b-241">Подробное руководство по использованию хранилища ключей Azure в веб-приложении см. в [этой статье](key-vault-use-from-web-application.md).</span><span class="sxs-lookup"><span data-stu-id="6115b-241">For a follow-up tutorial that uses Azure Key Vault in a web application, see [Use Azure Key Vault from a Web Application](key-vault-use-from-web-application.md).</span></span>

<span data-ttu-id="6115b-242">toosee используется хранилище ключей в статье [ведение журнала хранилища ключей Azure](key-vault-logging.md).</span><span class="sxs-lookup"><span data-stu-id="6115b-242">toosee how your key vault is being used, see [Azure Key Vault Logging](key-vault-logging.md).</span></span>

<span data-ttu-id="6115b-243">Список hello новые командлеты Azure PowerShell для хранилища ключей Azure см. в разделе [командлетам](/powershell/module/azurerm.keyvault/#key_vault).</span><span class="sxs-lookup"><span data-stu-id="6115b-243">For a list of hello latest Azure PowerShell cmdlets for Azure Key Vault, see [Azure Key Vault Cmdlets](/powershell/module/azurerm.keyvault/#key_vault).</span></span>

<span data-ttu-id="6115b-244">Программирование ссылки, в разделе [hello хранилище ключей Azure в руководстве разработчика](key-vault-developers-guide.md).</span><span class="sxs-lookup"><span data-stu-id="6115b-244">For programming references, see [hello Azure Key Vault developer's guide](key-vault-developers-guide.md).</span></span>
