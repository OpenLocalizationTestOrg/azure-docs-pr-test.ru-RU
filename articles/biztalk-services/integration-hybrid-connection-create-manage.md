---
title: "Создание гибридных подключений и управление ими | Документация Майкрософт"
description: "Узнайте, как создать гибридное подключение, управлять подключением и установить диспетчер гибридных подключений. MABS, WABS"
services: biztalk-services
documentationcenter: 
author: MandiOhlinger
manager: erikre
editor: 
ms.assetid: aac0546b-3bae-41e0-b874-583491a395ea
ms.service: biztalk-services
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/18/2016
ms.author: ccompy
ms.openlocfilehash: fceb6b0671e0f77c1f8f92bbb49c986fda3660ea
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="create-and-manage-hybrid-connections"></a>Создание гибридных подключений и управление ими

> [!IMPORTANT]
> Гибридные подключения BizTalk больше не используются. Они заменены гибридными подключениями службы приложений. Дополнительную информацию, включая сведения об управлении существующими гибридными подключениями BizTalk, см. в статье [Гибридные подключения к службе приложений Azure](../app-service/app-service-hybrid-connections.md).


## <a name="overview-of-the-steps"></a>Описание действий
1. Создание гибридного подключения путем ввода **host name** или **FQDN** of the on-premises resource in your private netwилиk.
2. Связывание веб-приложений Azure или мобильных приложений Azure с гибридным подключением.
3. Установка диспетчера гибридных подключений на локальном ресурсе и соединение с конкретным гибридным подключением. Портал Azure предлагает простой интерфейс для установки и подключения.
4. Управление гибридными подключениями и их ключами.

В этом разделе перечислены эти действия. 

> [!IMPORTANT]
> IP-адресу можно задать конечную точку гибридного подключения. Если вы используете IP-адрес, вы можете получить или не получить доступ к локальному ресурсу. Это зависит от вашего клиента. Гибридное подключение зависит от клиента, который выполняет поиск DNS. В большинстве случаев **клиент** — это код вашего приложения. Если клиент не выполняет поиск DNS (не пытается разрешить IP-адрес как имя домена (x.x.x.x)), трафик не отправляется через гибридное подключение.
> 
> Например, вы задали **10.4.5.6** в качестве локального хоста (это псевдокод):
> 
> **Следующий сценарий будет работать:**  
> `Application code -> GetHostByName("10.4.5.6") -> Resolves to 127.0.0.3 -> Connect("127.0.0.3") -> Hybrid Connection -> on-prem host`
> 
> **Следующий сценарий не будет работать:**  
> `Application code -> Connect("10.4.5.6") -> ?? -> No route to host`
> 
> 

## <a name="CreateHybridConnection"></a>Создание гибридного подключения
Гибридное подключение можно создать на портале Azure с помощью веб-приложений **или** служб BizTalk. 

**Сведения о создании гибридных подключений с помощью веб-приложений** см. в статье [Доступ к локальным ресурсам с помощью гибридных подключений в службе приложений Azure](../app-service-web/web-sites-hybrid-connection-get-started.md). Кроме того, диспетчер гибридных подключений можно установить из веб-приложения. Этот метод является предпочтительным. 

**Создание гибридных подключений в службах BizTalk**

1. Перейдите на [классический портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=213885).
2. В левой панели навигации щелкните **Службы BizTalk** , а затем выберите нужную службу BizTalk. 
   
    Если служба BizTalk отсутствует, можно создать ее с помощью команды [Создать службу BizTalk](biztalk-provision-services.md).
3. Откройте вкладку **Гибридные подключения**:  
   ![вкладка "Гибридные подключения"][HybridConnectionTab]
4. Щелкните **Создать гибридное подключение** или нажмите кнопку **ДОБАВИТЬ** в области задач. Заполните следующие поля:
   
   | Свойство | Описание |
   | --- | --- |
   | Имя |Имя гибридного подключения должно быть уникальным и не должно совпадать с именем службы BizTalk. Можно ввести любое имя, но рекомендуется использовать специальные имена, соответствующие назначению подключения. Примеры таких ошибок: <br/><br/>Payroll*SQLServer*<br/>SupplyList*SharepointServer*<br/>Customers*OracleServer* |
   | Имя компьютера |Введите полное имя компьютера, только имя компьютера или IPv4-адрес локального ресурса. Примеры:<br/><br/>mySQLServer<br/>*mySQLServer*.*Domain*.corp.*yourCompany*.com<br/>*myHTTPSharePointServer*<br/>*myHTTPSharePointServer*.*yourCompany*.com<br/>10.100.10.10<br/><br/>Если вы используете адрес IPv4, обратите внимание, что код клиента или приложения могут не разрешить IP-адрес. См. важное примечание в верхней части этого раздела. |
   | Порт |Укажите номер порта локального ресурса. Например если вы используете веб-приложения, введите порт 80 или 443. Если вы используете SQL Server, введите порт 1433. |
5. Установите флажок для завершения настройки. 

#### <a name="additional"></a>Дополнительно
* Можно создать несколько гибридных подключений. См. число разрешенных подключений в статье [Службы BizTalk: диаграмма выпусков](biztalk-editions-feature-chart.md). 
* Каждое гибридное подключение создается с помощью пары строк подключения: ключи приложений, которые ОТПРАВЛЯЮТ и локальные ключи, которые ПРОСЛУШИВАЮТ. В каждой паре есть первичный и вторичный ключи. 

## <a name="LinkWebSite"></a>Связывание веб-приложения службы приложений Azure или мобильного приложения
Чтобы связать веб-приложение или мобильное приложение с существующим гибридным подключением, в колонке "Гибридные подключения" выберите элемент **Использовать существующее гибридное подключение**. См. статью [Доступ к локальным ресурсам с помощью гибридных подключений в службе приложений Azure](../app-service-web/web-sites-hybrid-connection-get-started.md).

## <a name="InstallHCM"></a>Локальная установка диспетчера гибридных подключений
После создания гибридного подключения необходимо установить диспетчер гибридных подключений на локальном ресурсе. Его можно скачать из веб-приложения Azure или из службы BizTalk. Действия, выполняемые в службе BizTalk: 

1. Перейдите на [классический портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=213885).
2. В левой панели навигации щелкните **Службы BizTalk** , а затем выберите нужную службу BizTalk. 
3. Откройте вкладку **Гибридные подключения**:  
   ![вкладка "Гибридные подключения"][HybridConnectionTab]
4. На панели задач нажмите кнопку **программу локальной установки**  
   ![программу локальной установки][HCOnPremSetup]
5. Щелкните **Установить и настроить** , чтобы запустить или загрузить диспетчер гибридных подключений в локальной системе. 
6. Установите флажок для запуска процесса установки. 

<!--
You can also download the Hybrid Connection Manager MSI file and copy the file to your on-premises resource. Specific steps:

1. Copy the on-premises primary Connection String. See [Manage Hybrid Connections](#ManageHybridConnection) in this topic for the specific steps.
2. Download the Hybrid Connection Manager MSI file. 
3. On the on-premises resource, install the Hybrid Connection Manager from the MSI file. 
4. Using Windows PowerShell, type: 
> Add-HybridConnection -ConnectionString “*Your On-Premises Connection String that you copied*” 
--> 

#### <a name="additional"></a>Дополнительно
* Диспетчер гибридных подключений можно установить в следующих операционных системах:
  
  * Windows Server 2008 R2 (требуются .NET Framework 4.5 или более поздней версии и Windows Management Framework 4.0 или более поздней версии);
  * Windows Server 2012 (требуется Windows Management Framework 4.0 или более поздней версии).
  * Windows Server 2012 R2
* После установки диспетчера гибридных подключений произойдут следующие события: 
  
  * Автоматическая настройка гибридного подключения на платформе Azure для использования основной строки подключения к приложению. 
  * Автоматическая настройка локального ресурса для использования основной локальной строки подключения.
* Для прохождения авторизации диспетчер гибридных подключений должен использовать допустимую локальную строку подключения. Для прохождения авторизации веб-приложение или мобильное приложение Azure должны использовать допустимую строку подключения к приложению.
* Гибридные подключения можно масштабировать путем установки другого экземпляра диспетчера гибридных подключений на другом сервере. Настройте локальный прослушиватель для использования того же адреса в качестве первого локального прослушивателя. В этом случае трафик распределяется случайно (путем циклического перебора) между активными локальными прослушивателями. 

## <a name="ManageHybridConnection"></a>Управление гибридными подключениями
Для управления гибридными подключениями можно выбрать следующие варианты:

* Использование страницы службы BizTalk на портале Azure. 
* Использование интерфейсов [REST API](http://msdn.microsoft.com/library/azure/dn232347.aspx).

#### <a name="copyregenerate-the-hybrid-connection-strings"></a>Копирование или повторное создание строк гибридных подключений
1. Перейдите на [классический портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=213885).
2. В левой панели навигации щелкните **Службы BizTalk** , а затем выберите нужную службу BizTalk. 
3. Откройте вкладку **Гибридные подключения**:  
   ![вкладка "Гибридные подключения"][HybridConnectionTab]
4. Выберите гибридное подключение. На панели задач нажмите кнопку **Управление подключением**  
   ![Управление параметрами][HCManageConnection]
   
    **Управление подключением** содержится перечень строк подключения к приложению и локальных строк подключения. Вы можете скопировать сроки подключений или повторно создать ключ доступа, используемый в строке подключения. 
   
    **При повторном создании**общий ключ доступа, используемый в строке подключения, будет изменен. Выполните следующее:
   
   * На классическом портале Azure в приложении Azure щелкните **Синхронизировать ключи** .
   * Повторно запустите **программу локальной установки**. Локальный ресурс автоматически настроится для использования обновленной основной строки подключения.

#### <a name="use-group-policy-to-control-the-on-premises-resources-used-by-a-hybrid-connection"></a>Применение групповой политики для контроля локальных ресурсов, используемых гибридным подключением
1. Скачайте [административные шаблоны диспетчера гибридных подключений](http://www.microsoft.com/download/details.aspx?id=42963).
2. Извлеките файлы.
3. На компьютере, где осуществляется изменение групповой политики, выполните следующие действия.  
   
   * Скопируйте файлы ADMX в папку *%WINROOT%\PolicyDefinitions*.
   * Скопируйте файлы ADMX в папку *%WINROOT%\PolicyDefinitions\en-us*.

После копирования файлов можно изменить политику с помощью редактора групповой политики.

## <a name="next"></a>Далее
[Доступ к локальным ресурсам с помощью гибридных подключений в службе приложений Azure](../app-service-web/web-sites-hybrid-connection-get-started.md)  
[Подключение к локальному SQL Server из веб-приложения, размещенного в службе приложений Azure с помощью гибридных подключений](../app-service-web/web-sites-hybrid-connection-connect-on-premises-sql-server.md)   
[Обзор гибридных подключений](integration-hybrid-connection-overview.md)

## <a name="see-also"></a>См. также
[REST API для управления службами BizTalk в Microsoft Azure](http://msdn.microsoft.com/library/azure/dn232347.aspx)  
[Службы BizTalk: диаграмма выпусков](biztalk-editions-feature-chart.md)  
[Создание службы BizTalk с помощью классического портала Azure](biztalk-provision-services.md)  
[Службы BizTalk: вкладки «Панель мониторинга», «Монитор» и «Масштаб»](biztalk-dashboard-monitor-scale-tabs.md)

[HybridConnectionTab]: ./media/integration-hybrid-connection-create-manage/WABS_HybridConnectionTab.png
[HCOnPremSetup]: ./media/integration-hybrid-connection-create-manage/WABS_HybridConnectionOnPremSetup.png
[HCManageConnection]: ./media/integration-hybrid-connection-create-manage/WABS_HybridConnectionManageConn.png 
