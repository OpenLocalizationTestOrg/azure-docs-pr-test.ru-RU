---
title: "Создание доступной в Интернете внутренней подсистемы балансировки нагрузки с помощью портала Azure | Документация Майкрософт"
description: "Узнайте, как создать балансировщик нагрузки для Интернета в Resource Manager с помощью портала Azure."
services: load-balancer
documentationcenter: na
author: anavinahar
manager: narayan
editor: 
tags: azure-resource-manager
ms.assetid: aa9d26ca-3d8a-4a99-83b7-c410dd20b9d0
ms.service: load-balancer
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/25/2017
ms.author: annahar
ms.openlocfilehash: 922c33f712e160835256ad9ad040e523dfbf76db
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="creating-an-internet-facing-load-balancer-using-the-azure-portal"></a>Создание балансировщика нагрузки для Интернета на портале Azure

> [!div class="op_single_selector"]
> * [Портал](../load-balancer/load-balancer-get-started-internet-portal.md)
> * [PowerShell](../load-balancer/load-balancer-get-started-internet-arm-ps.md)
> * [Интерфейс командной строки Azure](../load-balancer/load-balancer-get-started-internet-arm-cli.md)
> * [Шаблон](../load-balancer/load-balancer-get-started-internet-arm-template.md)

[!INCLUDE [load-balancer-basic-sku-include.md](../../includes/load-balancer-basic-sku-include.md)]

[!INCLUDE [load-balancer-get-started-internet-intro-include.md](../../includes/load-balancer-get-started-internet-intro-include.md)]

[!INCLUDE [azure-arm-classic-important-include](../../includes/azure-arm-classic-important-include.md)]

В этой статье описывается модель развертывания с использованием менеджера ресурсов.

[!INCLUDE [load-balancer-get-started-internet-scenario-include.md](../../includes/load-balancer-get-started-internet-scenario-include.md)]

В этой статье приводится порядок выполнения отдельных операций, которые требуется выполнить для создания балансировщика нагрузки, а также подробно объясняется, что необходимо сделать для решения этой задачи.

## <a name="what-is-required-to-create-an-internet-facing-load-balancer"></a>Что необходимо для создания балансировщика нагрузки для Интернета?

Чтобы развернуть балансировщик нагрузки, необходимо создать и настроить следующие объекты.

* Конфигурация интерфейсных IP-адресов. Содержит общедоступные IP-адреса для входящего сетевого трафика.
* Пул внутренних адресов. Содержит сетевые интерфейсы (сетевые карты) для получения виртуальными машинами трафика от балансировщика нагрузки.
* Правила балансировки нагрузки. Содержат правила сопоставления общего порта в балансировщике нагрузки с портом в пуле внутренних адресов.
* Правила NAT для входящего трафика. Содержат правила сопоставления общего порта в балансировщике нагрузки с портом на конкретной виртуальной машине в пуле внутренних адресов.
* Пробы. Содержат пробы работоспособности, с помощью которых можно проверить доступность экземпляров виртуальных машин в пуле внутренних адресов.

Дополнительные сведения о настройке компонентов балансировщика нагрузки с помощью Azure Resource Manager см. в статье [Поддержка диспетчера ресурсов Azure для подсистемы балансировки нагрузки](load-balancer-arm.md).

## <a name="set-up-a-load-balancer-in-azure-portal"></a>Настройка балансировщика нагрузки на портале Azure

> [!IMPORTANT]
> В этом примере предполагается, что у вас уже есть виртуальная сеть с именем **myVNet**. Если нет, то см. статью о [создании виртуальной сети](../virtual-network/virtual-networks-create-vnet-arm-pportal.md). Также предполагается, что в сети **myVNet** есть подсеть с именем **LB-Subnet-BE**, а также есть две виртуальные машины **web1** и **web2**, которые входят в одну группу доступности **myAvailSet** в сети **myVNet**. Чтобы создать виртуальные машины, перейдите по [этой ссылке](../virtual-machines/virtual-machines-windows-hero-tutorial.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

1. В браузере откройте портал Azure ( [http://portal.azure.com](http://portal.azure.com) ) и войдите, используя учетную запись Azure.
2. В верхней левой части экрана щелкните **Создать** > **Сети** > **Балансировщик нагрузки**.
3. В колонке **Создание подсистемы балансировки нагрузки** введите имя для балансировщика нагрузки. Здесь он назван **myLoadBalancer**.
4. В разделе **Тип** выберите **Общедоступный**.
5. В разделе **Общедоступный IP-адрес** создайте общедоступный IP-адрес с именем **myPublicIP**.
6. В разделе "Группа ресурсов" выберите **myRG**. Затем укажите соответствующее **Расположение** и нажмите кнопку **ОК**. После этого подсистема балансировки нагрузки начнет развертывание. Этот процесс может занять несколько минут.

    ![Обновление группы ресурсов балансировщика нагрузки](./media/load-balancer-get-started-internet-portal/1-load-balancer.png)

## <a name="create-a-back-end-address-pool"></a>Создание серверного пула адресов

1. После успешного развертывания балансировщика нагрузки выберите его в списке ресурсов. В разделе "Параметры" выберите "Серверные пулы". Введите имя для серверного пула. Затем в верхней части появившейся колонки нажмите кнопку **Добавить** .
2. В колонке **Добавление серверного пула** щелкните **Добавить виртуальную машину**.  В разделе **Группа доступности** щелкните **Выберите группу доступности**, а затем выберите **myAvailSet**. После этого в разделе "Виртуальные машины" колонки щелкните **Выберите виртуальные машины** и выберите **web1** и **web2** — две виртуальные машины, созданные для балансировки нагрузки. Убедитесь, что слева от каждой из них установлен синий флажок, как показано на рисунке ниже. В этой колонке щелкните **Выбрать**, затем нажмите кнопку "ОК" в колонке **Выбор виртуальных машин**, а затем — кнопку **ОК** в колонке **Добавление серверного пула**.

    ![Добавление в серверный пул адресов ](./media/load-balancer-get-started-internet-portal/3-load-balancer-backend-02.png)

3. Убедитесь, что в раскрывающемся списке уведомлений есть сообщение о сохранении серверного пула балансировщика нагрузки, а также об обновлении сетевого интерфейса для виртуальных машин **web1** и **web2**.

## <a name="create-a-probe-lb-rule-and-nat-rules"></a>Создание пробы, правила балансировщика нагрузки и правил NAT

1. Создайте пробу работоспособности.

    В параметрах балансировщика нагрузки выберите "Пробы". В верхней части колонки щелкните **Добавить** .

    Существует два способа настройки пробы: HTTP и TCP. В этот примере показан способ HTTP, но и через TCP настройка выполняется подобным образом.
    Обновите необходимые сведения. Как уже упоминалось, **myLoadBalancer** будет выполнять балансировку трафика, проходящего через порт 80. Выбранный путь — HealthProbe.aspx, интервал — 15 секунд, а порог состояния неработоспособности — 2. По завершении нажмите кнопку **ОК** , чтобы создать пробу.

    Наведите указатель мыши на значок "i", чтобы узнать больше об индивидуальных настройках и о том, как их изменить для соответствия своим требованиям.

    ![Добавление пробы](./media/load-balancer-get-started-internet-portal/4-load-balancer-probes.png)

2. Создайте правило балансировщика нагрузки.

    В разделе "Параметры" балансировщика нагрузки щелкните "Правила балансировки нагрузки". В новой колонке нажмите кнопку **Добавить**. Введите имя для правила. В этом примере используется имя HTTP. Выберите интерфейсный и внутренний порты. В этом примере для обоих портов выбрано значение 80. В качестве серверного пула укажите **LB-backend**, а в качестве пробы — ранее созданную пробу **HealthProbe**. Остальные параметры задайте на свое усмотрение. Нажмите кнопку "ОК", чтобы сохранить правило балансировки нагрузки.

    ![Добавление правила балансировки нагрузки](./media/load-balancer-get-started-internet-portal/5-load-balancing-rules.png)

3. Создание правила NAT для входящего трафика

    В разделе "Параметры" балансировщика нагрузки щелкните "Правила NAT для входящего трафика". В появившейся новой колонке щелкните **Добавить**. Введите имя для своего правила NAT для входящего трафика. В этом примере правило названо **inboundNATrule1**. В качестве расположения необходимо указать созданный ранее общедоступный IP-адрес. В разделе "Служба" выберите "Настраиваемая", а затем укажите протокол, который хотите использовать. В этом примере выбран TCP. Введите порт (3441), а также целевой порт (в данном случае — 3389). Затем нажмите кнопку "ОК", чтобы сохранить это правило.

    После создания первого правила повторите этот шаг для второго правила NAT для входящего трафика с именем inboundNATrule2: из порта 3442 в целевой порт 3389.

    ![Добавление правила NAT для входящего трафика](./media/load-balancer-get-started-internet-portal/6-load-balancer-inbound-nat-rules.png)

## <a name="remove-a-load-balancer"></a>Удаление балансировщика нагрузки

Чтобы удалить балансировщик нагрузки, выберите балансировщик, который требуется удалить. Вверху колонки *Балансировщик нагрузки* щелкните **Удалить**. При появлении запроса выберите **Да** .

## <a name="next-steps"></a>Дальнейшие действия

[Приступая к настройке внутренней подсистемы балансировки нагрузки](load-balancer-get-started-ilb-arm-cli.md)

[Настройка режима распределения подсистемы балансировки нагрузки](load-balancer-distribution-mode.md)

[Настройка параметров времени ожидания простоя TCP для подсистемы балансировки нагрузки](load-balancer-tcp-idle-timeout.md)
