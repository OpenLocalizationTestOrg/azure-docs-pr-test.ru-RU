---
title: "Обзор балансировки нагрузки aaaAzure | Документы Microsoft"
description: "Обзор функций балансировщика нагрузки Azure, его архитектуры и реализации. Узнайте, как работает hello балансировки нагрузки и использовать его в облаке hello."
services: load-balancer
documentationcenter: na
author: kumudd
manager: timlt
editor: 
ms.assetid: 0f313dc0-f007-4cee-b2b9-f542357925a3
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/24/2016
ms.author: kumud
ms.openlocfilehash: 2376a02f7cbbbed6a90f216419c0c3d30f594272
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-load-balancer-overview"></a><span data-ttu-id="6961a-104">Обзор балансировщика нагрузки Azure</span><span class="sxs-lookup"><span data-stu-id="6961a-104">Azure Load Balancer overview</span></span>

<span data-ttu-id="6961a-105">Подсистема балансировки нагрузки Azure обеспечивает высокий уровень доступности и сетевой производительности tooyour приложений.</span><span class="sxs-lookup"><span data-stu-id="6961a-105">Azure Load Balancer delivers high availability and network performance tooyour applications.</span></span> <span data-ttu-id="6961a-106">Это балансировщик нагрузки уровня 4 (TCP, UDP), распределяющий входящий трафик между работоспособными экземплярами служб, определенных в наборе балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="6961a-106">It is a Layer 4 (TCP, UDP) load balancer that distributes incoming traffic among healthy instances of services defined in a load-balanced set.</span></span>

<span data-ttu-id="6961a-107">Вот какие функции можно настроить в службе Azure Load Balancer:</span><span class="sxs-lookup"><span data-stu-id="6961a-107">Azure Load Balancer can be configured to:</span></span>

* <span data-ttu-id="6961a-108">Балансировку нагрузки входящего Интернет трафика toovirtual машин.</span><span class="sxs-lookup"><span data-stu-id="6961a-108">Load balance incoming Internet traffic toovirtual machines.</span></span> <span data-ttu-id="6961a-109">Такая конфигурация называется [балансировкой нагрузки для Интернета](load-balancer-internet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-109">This configuration is known as [Internet-facing load balancing](load-balancer-internet-overview.md).</span></span>
* <span data-ttu-id="6961a-110">Балансировка нагрузки трафика между виртуальными машинами в виртуальной сети, между виртуальными машинами в облачных службах или между локальными компьютерами и виртуальными машинами в распределенной виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="6961a-110">Load balance traffic between virtual machines in a virtual network, between virtual machines in cloud services, or between on-premises computers and virtual machines in a cross-premises virtual network.</span></span> <span data-ttu-id="6961a-111">Такая конфигурация называется [внутренней балансировкой нагрузки](load-balancer-internal-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-111">This configuration is known as [internal load balancing](load-balancer-internal-overview.md).</span></span>
* <span data-ttu-id="6961a-112">Пересылка внешнего трафика tooa отдельную виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="6961a-112">Forward external traffic tooa specific virtual machine.</span></span>

<span data-ttu-id="6961a-113">Все ресурсы в облаке hello должны открытый toobe адрес IP, доступная через Интернет hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-113">All resources in hello cloud need a public IP address toobe reachable from hello Internet.</span></span> <span data-ttu-id="6961a-114">Hello облачной инфраструктуры в Azure использует немаршрутизируемый IP-адреса для его ресурсов.</span><span class="sxs-lookup"><span data-stu-id="6961a-114">hello cloud infrastructure in Azure uses non-routable IP addresses for its resources.</span></span> <span data-ttu-id="6961a-115">Azure использует преобразование сетевых адресов (NAT) с помощью открытого IP адресов toocommunicate toohello Интернета.</span><span class="sxs-lookup"><span data-stu-id="6961a-115">Azure uses network address translation (NAT) with public IP addresses toocommunicate toohello Internet.</span></span>

## <a name="azure-deployment-models"></a><span data-ttu-id="6961a-116">Модели развертывания Azure</span><span class="sxs-lookup"><span data-stu-id="6961a-116">Azure deployment models</span></span>

<span data-ttu-id="6961a-117">Это важные toounderstand hello различия между hello Azure классические и диспетчер ресурсов [модели развертывания](../azure-resource-manager/resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-117">It's important toounderstand hello differences between hello Azure classic and Resource Manager [deployment models](../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="6961a-118">В каждой модели Azure Load Balancer настраивается по-разному.</span><span class="sxs-lookup"><span data-stu-id="6961a-118">Azure Load Balancer is configured differently in each model.</span></span>

### <a name="azure-classic-deployment-model"></a><span data-ttu-id="6961a-119">классическая модель развертывания Azure</span><span class="sxs-lookup"><span data-stu-id="6961a-119">Azure classic deployment model</span></span>

<span data-ttu-id="6961a-120">Виртуальные машины, развернутые в пределах границ облачной службы может быть сгруппированных toouse подсистемы балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="6961a-120">Virtual machines deployed within a cloud service boundary can be grouped toouse a load balancer.</span></span> <span data-ttu-id="6961a-121">В этой модели общедоступный IP-адрес и полное доменное имя, (FQDN) назначаются tooa облачной службы.</span><span class="sxs-lookup"><span data-stu-id="6961a-121">In this model a public IP address and a Fully Qualified Domain Name, (FQDN) are assigned tooa cloud service.</span></span> <span data-ttu-id="6961a-122">Подсистема балансировки нагрузки Hello порт перевода и распределяет hello сетевого трафика с помощью hello общедоступный IP-адрес для hello облачной службы.</span><span class="sxs-lookup"><span data-stu-id="6961a-122">hello load balancer does port translation and load balances hello network traffic by using hello public IP address for hello cloud service.</span></span>

<span data-ttu-id="6961a-123">Трафик с балансировкой нагрузки определяется конечными точками.</span><span class="sxs-lookup"><span data-stu-id="6961a-123">Load-balanced traffic is defined by endpoints.</span></span> <span data-ttu-id="6961a-124">Конечные точки порта преобразования имеют однозначное соответствие между hello назначенный public hello общедоступного IP-адреса и hello локальный порт назначенный toohello службы на конкретной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="6961a-124">Port translation endpoints have a one-to-one relationship between hello public-assigned port of hello public IP address and hello local port assigned toohello service on a specific virtual machine.</span></span> <span data-ttu-id="6961a-125">Конечные точки балансировки нагрузки содержат один ко многим связь между hello общедоступный IP-адрес и hello локальные порты, назначенные toohello служб на виртуальных машинах hello в облачной службе hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-125">Load balancing endpoints have a one-to-many relationship between hello public IP address and hello local ports assigned toohello services on hello virtual machines in hello cloud service.</span></span>

![Подсистема балансировки нагрузки Azure в hello классической модели развертывания](./media/load-balancer-overview/asm-lb.png)

<span data-ttu-id="6961a-127">Рис. 1. Подсистема балансировки нагрузки Azure в hello классической модели развертывания</span><span class="sxs-lookup"><span data-stu-id="6961a-127">Figure 1 - Azure Load Balancer in hello classic deployment model</span></span>

<span data-ttu-id="6961a-128">метки домена Hello hello общедоступный IP-адрес, который hello использует подсистемы балансировки нагрузки для данной модели развертывания \<имя облачной службы\>. cloudapp.net.</span><span class="sxs-lookup"><span data-stu-id="6961a-128">hello domain label for hello public IP address that hello load balancer uses for this deployment model is \<cloud service name\>.cloudapp.net.</span></span> <span data-ttu-id="6961a-129">Hello следующей схеме показаны hello подсистемы балансировки нагрузки Azure в этой модели.</span><span class="sxs-lookup"><span data-stu-id="6961a-129">hello following graphic shows hello Azure Load Balancer in this model.</span></span>

### <a name="azure-resource-manager-deployment-model"></a><span data-ttu-id="6961a-130">Модель развертывания диспетчера ресурсов Azure</span><span class="sxs-lookup"><span data-stu-id="6961a-130">Azure Resource Manager deployment model</span></span>

<span data-ttu-id="6961a-131">В модели развертывания диспетчера ресурсов hello нет toocreate нет необходимости в облачной службе.</span><span class="sxs-lookup"><span data-stu-id="6961a-131">In hello Resource Manager deployment model there is no need toocreate a Cloud service.</span></span> <span data-ttu-id="6961a-132">Подсистема балансировки нагрузки Hello создается tooexplicitly маршрутизацию трафика между несколькими виртуальными машинами.</span><span class="sxs-lookup"><span data-stu-id="6961a-132">hello load balancer is created tooexplicitly route traffic among multiple virtual machines.</span></span>

<span data-ttu-id="6961a-133">Общедоступный IP-адрес является отдельным ресурсом с меткой домена (DNS-именем).</span><span class="sxs-lookup"><span data-stu-id="6961a-133">A public IP address is an individual resource that has a domain label (DNS name).</span></span> <span data-ttu-id="6961a-134">Hello общедоступный IP-адрес связан с ресурсом подсистемы балансировки нагрузки hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-134">hello public IP address is associated with hello load balancer resource.</span></span> <span data-ttu-id="6961a-135">Правила подсистемы балансировки нагрузки и правила для входящих подключений NAT служит hello общедоступный IP-адрес hello Интернет конечной точки для ресурсов hello, получающие балансировки нагрузки сетевого трафика.</span><span class="sxs-lookup"><span data-stu-id="6961a-135">Load balancer rules and inbound NAT rules use hello public IP address as hello Internet endpoint for hello resources that are receiving load-balanced network traffic.</span></span>

<span data-ttu-id="6961a-136">Частный или общедоступный IP-адрес назначается toohello сетевой интерфейс ресурсов присоединенного tooa виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="6961a-136">A private or public IP address is assigned toohello network interface resource attached tooa virtual machine.</span></span> <span data-ttu-id="6961a-137">После добавления пула IP-адресов подсистемы балансировки нагрузки tooa внутренней сетевой интерфейс hello балансировки нагрузки — может toosend балансировки нагрузки сетевого трафика на основе правил, балансировки нагрузки hello, создаются.</span><span class="sxs-lookup"><span data-stu-id="6961a-137">Once a network interface is added tooa load balancer's back-end IP address pool, hello load balancer is able toosend load-balanced network traffic based on hello load-balanced rules that are created.</span></span>

<span data-ttu-id="6961a-138">Hello рисунке ниже показано hello подсистемы балансировки нагрузки Azure в этой модели.</span><span class="sxs-lookup"><span data-stu-id="6961a-138">hello following graphic shows hello Azure Load Balancer in this model:</span></span>

![Балансировщик нагрузки Azure в диспетчере ресурсов](./media/load-balancer-overview/arm-lb.png)

<span data-ttu-id="6961a-140">Рис. 2. Azure Load Balancer в диспетчере Resource Manager</span><span class="sxs-lookup"><span data-stu-id="6961a-140">Figure 2 - Azure Load Balancer in Resource Manager</span></span>

<span data-ttu-id="6961a-141">Hello балансировки нагрузки можно управлять через диспетчер ресурсов на основе шаблонов, API-интерфейсы и средства.</span><span class="sxs-lookup"><span data-stu-id="6961a-141">hello load balancer can be managed through Resource Manager-based templates, APIs, and tools.</span></span> <span data-ttu-id="6961a-142">toolearn более о диспетчере ресурсов, в разделе hello [Обзор диспетчера ресурсов](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-142">toolearn more about Resource Manager, see hello [Resource Manager overview](../azure-resource-manager/resource-group-overview.md).</span></span>

## <a name="load-balancer-features"></a><span data-ttu-id="6961a-143">Функции подсистемы балансировки нагрузки</span><span class="sxs-lookup"><span data-stu-id="6961a-143">Load Balancer features</span></span>

* <span data-ttu-id="6961a-144">Распространение на основе хэша</span><span class="sxs-lookup"><span data-stu-id="6961a-144">Hash-based distribution</span></span>

    <span data-ttu-id="6961a-145">Балансировщик нагрузки Azure использует алгоритм распределения на основе хэша.</span><span class="sxs-lookup"><span data-stu-id="6961a-145">Azure Load Balancer uses a hash-based distribution algorithm.</span></span> <span data-ttu-id="6961a-146">По умолчанию использует хэш 5-фрагментному, состоящие из исходный IP-адрес, порт источника, конечный IP-адрес, конечный порт и протокол тип toomap трафика tooavailable серверов.</span><span class="sxs-lookup"><span data-stu-id="6961a-146">By default, it uses a 5-tuple hash composed of source IP, source port, destination IP, destination port, and protocol type toomap traffic tooavailable servers.</span></span> <span data-ttu-id="6961a-147">Он позволяет закреплять IP-адреса только *в рамках* сеанса транспорта.</span><span class="sxs-lookup"><span data-stu-id="6961a-147">It provides stickiness only *within* a transport session.</span></span> <span data-ttu-id="6961a-148">Пакетов в hello сеанс TCP или UDP будут направляться toohello же экземпляра за конечной точкой с балансировкой нагрузки hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-148">Packets in hello same TCP or UDP session will be directed toohello same instance behind hello load-balanced endpoint.</span></span> <span data-ttu-id="6961a-149">Когда hello клиента закрытия и открытия соединения hello или начинает новый сеанс из hello же исходный IP-адрес, hello изменений исходного порта.</span><span class="sxs-lookup"><span data-stu-id="6961a-149">When hello client closes and reopens hello connection or starts a new session from hello same source IP, hello source port changes.</span></span> <span data-ttu-id="6961a-150">Это может привести к hello трафика toogo tooa другой конечной точке в другом центре обработки данных.</span><span class="sxs-lookup"><span data-stu-id="6961a-150">This may cause hello traffic toogo tooa different endpoint in a different datacenter.</span></span>

    <span data-ttu-id="6961a-151">Дополнительные сведения см. в статье [Режим распределения для балансировщика нагрузки (сходство исходного IP-адреса)](load-balancer-distribution-mode.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-151">For more details, see [Load balancer distribution mode](load-balancer-distribution-mode.md).</span></span> <span data-ttu-id="6961a-152">Hello следующий рисунок показывает hello хэша распространения:</span><span class="sxs-lookup"><span data-stu-id="6961a-152">hello following graphic shows hello hash-based distribution:</span></span>

    ![Распространение на основе хэша](./media/load-balancer-overview/load-balancer-distribution.png)

    <span data-ttu-id="6961a-154">Рис. 3. Распределение на основе хэша</span><span class="sxs-lookup"><span data-stu-id="6961a-154">Figure 3 - Hash based distribution</span></span>

* <span data-ttu-id="6961a-155">Перенаправление портов</span><span class="sxs-lookup"><span data-stu-id="6961a-155">Port forwarding</span></span>

    <span data-ttu-id="6961a-156">Балансировщик нагрузки Azure позволяет контролировать процесс управления входящей связью.</span><span class="sxs-lookup"><span data-stu-id="6961a-156">Azure Load Balancer gives you control over how inbound communication is managed.</span></span> <span data-ttu-id="6961a-157">Это взаимодействие включает в себя трафик с узлов Интернета, виртуальных машин в других облачных службах или из виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="6961a-157">This communication includes traffic initiated from Internet hosts, virtual machines in other cloud services, or virtual networks.</span></span> <span data-ttu-id="6961a-158">Этот контроль представлен конечной точкой (также известной как входная конечная точка).</span><span class="sxs-lookup"><span data-stu-id="6961a-158">This control is represented by an endpoint (also called an input endpoint).</span></span>

    <span data-ttu-id="6961a-159">Конечная точка ввода прослушивает открытый порт и перенаправляет трафик tooan внутренний порт.</span><span class="sxs-lookup"><span data-stu-id="6961a-159">An input endpoint listens on a public port and forwards traffic tooan internal port.</span></span> <span data-ttu-id="6961a-160">Можно сопоставить hello же порты для внутренней или внешней конечной точки или использовать другой порт для них.</span><span class="sxs-lookup"><span data-stu-id="6961a-160">You can map hello same ports for an internal or external endpoint or use a different port for them.</span></span> <span data-ttu-id="6961a-161">Например может быть tooport toolisten сервер, настроенный web 81, а сопоставление hello общедоступная конечная точка является порт 80.</span><span class="sxs-lookup"><span data-stu-id="6961a-161">For example, you can have a web server configured toolisten tooport 81 while hello public endpoint mapping is port 80.</span></span> <span data-ttu-id="6961a-162">Создание общедоступной конечной точки Hello триггеры hello создание экземпляра подсистемы балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="6961a-162">hello creation of a public endpoint triggers hello creation of a load balancer instance.</span></span>

    <span data-ttu-id="6961a-163">Если создана с помощью hello портал Azure, hello портал автоматически создает конечные точки toohello виртуальную машину для hello удаленного рабочего стола (RDP) и трафика удаленного сеанса Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6961a-163">When created using hello Azure portal, hello portal automatically creates endpoints toohello virtual machine for hello Remote Desktop Protocol (RDP) and remote Windows PowerShell session traffic.</span></span> <span data-ttu-id="6961a-164">Можно использовать эти конечные точки tooremotely администрирования hello виртуальной машины через Интернет hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-164">You can use these endpoints tooremotely administer hello virtual machine over hello Internet.</span></span>

* <span data-ttu-id="6961a-165">Автоматическая перенастройка</span><span class="sxs-lookup"><span data-stu-id="6961a-165">Automatic reconfiguration</span></span>

    <span data-ttu-id="6961a-166">Балансировщик нагрузки Azure мгновенно перенастраивает сам себя при горизонтальном и вертикальном масштабировании экземпляров.</span><span class="sxs-lookup"><span data-stu-id="6961a-166">Azure Load Balancer instantly reconfigures itself when you scale instances up or down.</span></span> <span data-ttu-id="6961a-167">Например перенастройки происходит при увеличении hello число экземпляров для рабочих и веб-ролей в облачной службе или при добавлении дополнительных виртуальных машин в hello же балансировкой нагрузки задать.</span><span class="sxs-lookup"><span data-stu-id="6961a-167">For example, this reconfiguration happens when you increase hello instance count for web/worker roles in a cloud service or when you add additional virtual machines into hello same load-balanced set.</span></span>

* <span data-ttu-id="6961a-168">Мониторинг службы</span><span class="sxs-lookup"><span data-stu-id="6961a-168">Service monitoring</span></span>

    <span data-ttu-id="6961a-169">Подсистема балансировки нагрузки Azure могли проверять работоспособность hello hello различных экземпляров сервера.</span><span class="sxs-lookup"><span data-stu-id="6961a-169">Azure Load Balancer can probe hello health of hello various server instances.</span></span> <span data-ttu-id="6961a-170">При toorespond происходит сбой проверки, hello балансировки нагрузки останавливает отправку новых подключений toohello неисправных экземпляров.</span><span class="sxs-lookup"><span data-stu-id="6961a-170">When a probe fails toorespond, hello load balancer stops sending new connections toohello unhealthy instances.</span></span> <span data-ttu-id="6961a-171">Существующие подключения не затрагиваются.</span><span class="sxs-lookup"><span data-stu-id="6961a-171">Existing connections are not impacted.</span></span>

    <span data-ttu-id="6961a-172">Существует три типа проверки:</span><span class="sxs-lookup"><span data-stu-id="6961a-172">Three types of probes are supported:</span></span>

    + <span data-ttu-id="6961a-173">**Зонд гостевого агента (для платформы как службы виртуальные машины только):** hello балансировки нагрузки использует hello агент гостевой виртуальной машине hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-173">**Guest agent probe (on Platform as a Service Virtual Machines only):** hello load balancer utilizes hello guest agent inside hello virtual machine.</span></span> <span data-ttu-id="6961a-174">Hello гостевой агент прослушивает и отвечает только тогда, когда hello ответ HTTP 200 OK экземпляр находится в состоянии готовности hello (т. е. hello экземпляр не находится в состоянии, как заняты, повторный запуск или остановка).</span><span class="sxs-lookup"><span data-stu-id="6961a-174">hello guest agent listens and responds with an HTTP 200 OK response only when hello instance is in hello ready state (i.e. hello instance is not in a state like busy, recycling, or stopping).</span></span> <span data-ttu-id="6961a-175">При сбое агента hello toorespond с HTTP 200 OK метки подсистемы балансировки нагрузки hello hello экземпляра не отвечает и отправке трафика toothat экземпляр останавливается.</span><span class="sxs-lookup"><span data-stu-id="6961a-175">If hello agent fails toorespond with an HTTP 200 OK, hello load balancer marks hello instance as unresponsive and stops sending traffic toothat instance.</span></span> <span data-ttu-id="6961a-176">Подсистема балансировки нагрузки Hello продолжается tooping hello экземпляра.</span><span class="sxs-lookup"><span data-stu-id="6961a-176">hello load balancer continues tooping hello instance.</span></span> <span data-ttu-id="6961a-177">Если hello агент даст ответ HTTP 200, hello балансировки нагрузки будет отправлять трафик toothat экземпляра еще раз.</span><span class="sxs-lookup"><span data-stu-id="6961a-177">If hello guest agent responds with an HTTP 200, hello load balancer will send traffic toothat instance again.</span></span> <span data-ttu-id="6961a-178">При использовании веб-роли код веб-сайта обычно выполняется в w3wp.exe, который не отслеживается hello фабрики Azure или гостевого агента.</span><span class="sxs-lookup"><span data-stu-id="6961a-178">When you're using a web role, your website code typically runs in w3wp.exe, which is not monitored by hello Azure fabric or guest agent.</span></span> <span data-ttu-id="6961a-179">Это означает, что ошибки в w3wp.exe (например, ответы HTTP 500) не будет обнаруженную toohello гостевого агента, а hello балансировки нагрузки не будет tootake этот экземпляр из ротации.</span><span class="sxs-lookup"><span data-stu-id="6961a-179">This means that failures in w3wp.exe (e.g. HTTP 500 responses) will not be reported toohello guest agent, and hello load balancer will not know tootake that instance out of rotation.</span></span>
    + <span data-ttu-id="6961a-180">**Пользовательский зонд HTTP:** зондирования переопределяет пробы (гостевого агента) по умолчанию hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-180">**HTTP custom probe:** This probe overrides hello default (guest agent) probe.</span></span> <span data-ttu-id="6961a-181">Его можно использовать toocreate собственную пользовательскую логику toodetermine hello работоспособности экземпляра роли hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-181">You can use it toocreate your own custom logic toodetermine hello health of hello role instance.</span></span> <span data-ttu-id="6961a-182">Hello балансировки нагрузки будет регулярно выполнять тестирование конечной точки (каждые 15 секунд, по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="6961a-182">hello load balancer will regularly probe your endpoint (every 15 seconds, by default).</span></span> <span data-ttu-id="6961a-183">экземпляр Hello считается toobe в поворота, если он отвечает TCP ACK или HTTP 200 в течение периода ожидания hello (31 секунды по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="6961a-183">hello instance is considered toobe in rotation if it responds with a TCP ACK or HTTP 200 within hello timeout period (default of 31 seconds).</span></span> <span data-ttu-id="6961a-184">Это полезно для реализации собственных экземпляров tooremove логики из ротации подсистемы балансировки нагрузки hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-184">This is useful for implementing your own logic tooremove instances from hello load balancer's rotation.</span></span> <span data-ttu-id="6961a-185">Например можно настроить экземпляр hello tooreturn состояние отличный от 200, если экземпляр hello превышает 90% загрузки ЦП.</span><span class="sxs-lookup"><span data-stu-id="6961a-185">For example, you can configure hello instance tooreturn a non-200 status if hello instance is above 90% CPU.</span></span> <span data-ttu-id="6961a-186">Для веб-ролей, использующих w3wp.exe, можно также получить автоматический мониторинг веб-сайта, так как ошибки в коде веб-сайт возвращать зонда toohello состояние отличный от 200.</span><span class="sxs-lookup"><span data-stu-id="6961a-186">For web roles that use w3wp.exe, you also get automatic monitoring of your website, since failures in your website code return a non-200 status toohello probe.</span></span>
    + <span data-ttu-id="6961a-187">**Пользовательский зонд TCP:** эта проверка зависит от успешного TCP-порт пробы tooa определенные сеанса установление.</span><span class="sxs-lookup"><span data-stu-id="6961a-187">**TCP custom probe:** This probe relies on successful TCP session establishment tooa defined probe port.</span></span>

    <span data-ttu-id="6961a-188">Дополнительные сведения см. в разделе hello [схема LoadBalancerProbe](https://msdn.microsoft.com/library/azure/jj151530.aspx).</span><span class="sxs-lookup"><span data-stu-id="6961a-188">For more information, see hello [LoadBalancerProbe schema](https://msdn.microsoft.com/library/azure/jj151530.aspx).</span></span>

* <span data-ttu-id="6961a-189">Исходящее преобразование сетевых адресов (SNAT)</span><span class="sxs-lookup"><span data-stu-id="6961a-189">Source NAT</span></span>

    <span data-ttu-id="6961a-190">Все toohello исходящий трафик, проходит Интернет, полученному от вашей службы источника NAT (SNAT) с помощью hello же виртуальный IP-адрес как hello входящего трафика.</span><span class="sxs-lookup"><span data-stu-id="6961a-190">All outbound traffic toohello Internet that originates from your service undergoes source NAT (SNAT) by using hello same VIP address as hello incoming traffic.</span></span> <span data-ttu-id="6961a-191">SNAT предоставляет такие важные преимущества:</span><span class="sxs-lookup"><span data-stu-id="6961a-191">SNAT provides important benefits:</span></span>

    + <span data-ttu-id="6961a-192">Он позволяет легко обновления и восстановления после сбоев служб, так как hello виртуального IP-адреса могут быть динамически сопоставлены tooanother экземпляр службы hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-192">It enables easy upgrade and disaster recovery of services, since hello VIP can be dynamically mapped tooanother instance of hello service.</span></span>
    + <span data-ttu-id="6961a-193">Это упрощает управление списком управления доступом (ACL).</span><span class="sxs-lookup"><span data-stu-id="6961a-193">It makes access control list (ACL) management easier.</span></span> <span data-ttu-id="6961a-194">С точки зрения виртуальных IP-адресов списки управления доступом не меняются при масштабировании или повторном развертывании служб.</span><span class="sxs-lookup"><span data-stu-id="6961a-194">ACLs expressed in terms of VIPs do not change as services scale up, down, or get redeployed.</span></span>

    <span data-ttu-id="6961a-195">конфигурация подсистемы балансировки нагрузки Hello поддерживает полный цилиндр NAT для протокола UDP.</span><span class="sxs-lookup"><span data-stu-id="6961a-195">hello load balancer configuration supports full cone NAT for UDP.</span></span> <span data-ttu-id="6961a-196">Полный цилиндр NAT — это тип NAT, где порт hello позволяет входящих подключений от любого внешнего узла (в ответ tooan исходящего запроса).</span><span class="sxs-lookup"><span data-stu-id="6961a-196">Full cone NAT is a type of NAT where hello port allows inbound connections from any external host (in response tooan outbound request).</span></span>

    <span data-ttu-id="6961a-197">Для каждого нового исходящего подключения инициирующего виртуальной машины исходящий порт также выделяется подсистемой балансировки нагрузки hello.</span><span class="sxs-lookup"><span data-stu-id="6961a-197">For each new outbound connection that a virtual machine initiates, an outbound port is also allocated by hello load balancer.</span></span> <span data-ttu-id="6961a-198">внешний узел Hello видит трафика с помощью виртуального порта на выделенный IP-адресов VIP.</span><span class="sxs-lookup"><span data-stu-id="6961a-198">hello external host sees traffic with a virtual IP (VIP)-allocated port.</span></span> <span data-ttu-id="6961a-199">Для сценариев, требующих большое число исходящих подключений, рекомендуется toouse [общедоступный IP-адрес на уровне экземпляра](../virtual-network/virtual-networks-instance-level-public-ip.md) адресов таким образом, что виртуальные машины hello выделенный исходящий IP-адрес для SNAT.</span><span class="sxs-lookup"><span data-stu-id="6961a-199">For scenarios that require a large number of outbound connections, it is recommended toouse [instance-level public IP](../virtual-network/virtual-networks-instance-level-public-ip.md) addresses so that hello VMs have a dedicated outbound IP address for SNAT.</span></span> <span data-ttu-id="6961a-200">Это снижает риск hello нехватку портов.</span><span class="sxs-lookup"><span data-stu-id="6961a-200">This reduces hello risk of port exhaustion.</span></span>

    <span data-ttu-id="6961a-201">Дополнительные сведения по этой теме см. в разделе [Общие сведения об исходящих подключениях в Azure](load-balancer-outbound-connections.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-201">Please see [outbound connections](load-balancer-outbound-connections.md) article for more details on this topic.</span></span>

### <a name="support-for-multiple-load-balanced-ip-addresses-for-virtual-machines"></a><span data-ttu-id="6961a-202">Поддержка нескольких IP-адресов с балансировкой нагрузки для виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="6961a-202">Support for multiple load-balanced IP addresses for virtual machines</span></span>
<span data-ttu-id="6961a-203">Можно назначить несколько балансировкой нагрузки открытый набор IP-адресов tooa виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="6961a-203">You can assign more than one load-balanced public IP address tooa set of virtual machines.</span></span> <span data-ttu-id="6961a-204">Эта возможность позволяет размещать несколько веб-сайтов SSL и/или несколько прослушивателей группы доступности AlwaysOn SQL Server на hello же набор виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="6961a-204">With this ability, you can host multiple SSL websites and/or multiple SQL Server AlwaysOn Availability Group listeners on hello same set of virtual machines.</span></span> <span data-ttu-id="6961a-205">Дополнительные сведения см. в статье [Несколько виртуальных IP-адресов для облачной службы](load-balancer-multivip.md).</span><span class="sxs-lookup"><span data-stu-id="6961a-205">For more information, see [Multiple VIPs per cloud service](load-balancer-multivip.md).</span></span>

[!INCLUDE [load-balancer-compare-tm-ag-lb-include.md](../../includes/load-balancer-compare-tm-ag-lb-include.md)]

## <a name="limitations"></a><span data-ttu-id="6961a-206">Ограничения</span><span class="sxs-lookup"><span data-stu-id="6961a-206">Limitations</span></span>

<span data-ttu-id="6961a-207">Внутренние пулы Load Balancer могут содержать виртуальные машины с любым номером SKU, за исключением уровня "Базовый".</span><span class="sxs-lookup"><span data-stu-id="6961a-207">Load Balancer backend pools can contain any VM SKU except Basic tier.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6961a-208">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="6961a-208">Next steps</span></span>

- <span data-ttu-id="6961a-209">Дополнительные сведения о [подсистеме балансировки нагрузки, подключенной к Интернету](load-balancer-internet-overview.md)</span><span class="sxs-lookup"><span data-stu-id="6961a-209">Learn more about [Internet-facing load balancer](load-balancer-internet-overview.md)</span></span>

- <span data-ttu-id="6961a-210">Дополнительные сведения о [внутренней подсистеме балансировки нагрузки](load-balancer-internal-overview.md)</span><span class="sxs-lookup"><span data-stu-id="6961a-210">Learn more about [Internal load balancer overview](load-balancer-internal-overview.md)</span></span>

- <span data-ttu-id="6961a-211">Создание [подсистемы балансировки нагрузки, подключенной к Интернету](load-balancer-get-started-internet-portal.md)</span><span class="sxs-lookup"><span data-stu-id="6961a-211">Create an [Internet-facing load balancer](load-balancer-get-started-internet-portal.md)</span></span>

- <span data-ttu-id="6961a-212">Дополнительные сведения о некоторых hello другой ключ [сетевые возможности](../networking/networking-overview.md) из Azure</span><span class="sxs-lookup"><span data-stu-id="6961a-212">Learn about some of hello other key [networking capabilities](../networking/networking-overview.md) of Azure</span></span>

