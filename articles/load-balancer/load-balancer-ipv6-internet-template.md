---
title: "aaaDeploy Интернет-подсистемы балансировки нагрузки с IPv6 - шаблон Azure | Документы Microsoft"
description: "Как toodeploy IPv6 поддержка балансировки нагрузки Azure и виртуальные машины с балансировкой нагрузки."
services: load-balancer
documentationcenter: na
author: kumudd
manager: timlt
editor: 
tags: azure-resource-manager
keywords: "IPv6, Azure Load Balancer, двойной стек, общедоступный IP-адрес, встроенная поддержка Ipv6, мобильное устройство, Интернет вещей"
ms.assetid: 2998e943-13fc-4ea9-a68c-875e53a08db3
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/23/2016
ms.author: kumud
ms.openlocfilehash: 68b9ba874a50161243577b64c4a6d9c76b39156c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="deploy-an-internet-facing-load-balancer-solution-with-ipv6-using-a-template"></a>Развертывание решения балансировки нагрузки для Интернета с поддержкой IPv6 с помощью шаблона

> [!div class="op_single_selector"]
> * [PowerShell](load-balancer-ipv6-internet-ps.md)
> * [Интерфейс командной строки Azure](load-balancer-ipv6-internet-cli.md)
> * [Шаблон](load-balancer-ipv6-internet-template.md)

Azure Load Balancer является балансировщиком нагрузки 4-го уровня (TCP, UDP). Подсистема балансировки нагрузки Hello обеспечивает высокую доступность путем распределения входящего трафика между экземплярами службы работоспособности в облачных службах или виртуальных машин в набор балансировки нагрузки. Azure Load Balancer может также представить данные службы на нескольких портах, нескольких IP-адресах или обоими этими способами.

## <a name="example-deployment-scenario"></a>Пример сценария развертывания

Hello следующей схеме показано решение по балансировке нагрузки hello развертываемого с помощью шаблона пример hello, описанных в этой статье.

![Сценарий использования балансировщика нагрузки](./media/load-balancer-ipv6-internet-template/lb-ipv6-scenario.png)

В этом случае будут созданы следующие ресурсы Azure hello:

* виртуальный сетевой интерфейс для каждой виртуальной машины с назначенными IPv4 и IPv6-адресами;
* балансировщик нагрузки для Интернета с общедоступными IPv4- и IPv6-адресами;
* два загрузить балансировки правила toomap hello открытые виртуальные IP-адреса toohello закрытый конечные точки
* Группы доступности, содержащий hello две виртуальные машины
* две виртуальные машины;

## <a name="deploying-hello-template-using-hello-azure-portal"></a>Развертывание шаблона hello, с помощью портала Azure hello

Эта статья содержит ссылки на шаблон, который публикуется в hello [шаблоны быстрый запуск Azure](https://azure.microsoft.com/documentation/templates/201-load-balancer-ipv6-create/) коллекции. Можно загрузить шаблон hello из галереи hello, или запустите hello развертывания в Azure непосредственно из галереи hello. В этой статье предполагается, что вы скачали hello шаблона tooyour локального компьютера.

1. Откройте портал Azure hello и выполните вход с помощью учетной записи с разрешениями toocreate виртуальные машины и сетевых ресурсов в пределах подписки Azure. Кроме того для работы с существующими ресурсами, hello учетной записи должен toocreate разрешений группы ресурсов и учетной записи хранилища.
2. Нажмите кнопку «+ Создать» из меню hello, а затем тип «шаблон» в поле поиска hello. Выберите «Шаблон развертывания» из результатов поиска hello.

    ![lb-ipv6-portal-step2](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step2.png)

3. Здравствуйте, все, что в колонке нажмите кнопку «Развертывание шаблона».

    ![lb-ipv6-portal-step3](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step3.png)

4. Нажмите кнопку "Создать".

    ![lb-ipv6-portal-step4](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step4.png)

5. Щелкните "Изменить шаблон". Удалите существующее содержимое hello и копирования и вставки в hello все содержимое файла шаблона hello (tooinclude hello начала и окончания {}), затем нажмите кнопку «Сохранить».

    > [!NOTE]
    > Если вы используете Microsoft Internet Explorer, при вставке вы отображается диалоговое окно с приглашением tooallow toohello доступа Windows, буфер обмена. Нажмите кнопку "Разрешить доступ".

    ![lb-ipv6-portal-step5](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step5.png)

6. Щелкните "Изменить параметры". В колонке параметров hello укажите значения hello согласно рекомендациям hello в hello раздела параметров шаблона, а затем нажмите кнопку «Сохранить» колонку параметров tooclose hello. В колонке развертывания пользовательского hello выберите подписки, в существующую группу ресурсов или создайте новый. При создании группы ресурсов, затем выберите местоположение для группы ресурсов hello. Далее щелкните **условия**, нажмите кнопку **покупки** для hello условия. Azure начинается развертывание ресурсов hello. Занимает несколько минут toodeploy все ресурсы hello.

    ![lb-ipv6-portal-step6](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step6.png)

    Дополнительные сведения об этих параметрах см. в разделе hello [параметры шаблона и переменные](#template-parameters-and-variables) далее в этой статье.

7. toosee hello ресурсов, созданных с использованием шаблона hello, нажмите кнопку Обзор и найдите список hello. в разделе «Группы ресурсов», затем щелкните его.

    ![lb-ipv6-portal-step7](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step7.png)

8. В колонке групп ресурсов hello щелкните имя hello hello группы ресурсов, указанных в шаге 6. Можно просмотреть список всех ресурсов hello, которые были развернуты. Если все прошло успешно, то в разделе "Последнее развертывание" должно отобразиться "Выполнено". Если нет, убедитесь в наличии разрешений toocreate hello необходимые ресурсы hello учетной записи, которую вы используете.

    ![lb-ipv6-portal-step8](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step8.png)

    > [!NOTE]
    > При просмотре групп ресурсов сразу после выполнения шага 6 «Последнего развертывания» будет отображать состояние hello «Развертывание» во время развертывания ресурсов hello.

9. Нажмите кнопку «myIPv6PublicIP», в список ресурсов hello. Вы увидите наличие IPv6-адрес в списке IP-адрес и что его имя DNS является значением hello, указанное для параметра dnsNameforIPv6LbIP hello в шаге 6. Этот ресурс находится hello открытый IPv6 адреса и имени узла, доступного tooInternet клиентов.

    ![lb-ipv6-portal-step9](./media/load-balancer-ipv6-internet-template/lb-ipv6-portal-step9.png)

## <a name="validate-connectivity"></a>Проверка подключения

После успешного развертывания шаблон hello можно проверить возможность подключения, выполнив следующие задачи hello:

1. Вход toohello портал Azure и подключиться tooeach из hello виртуальные машины, созданные при развертывании шаблона hello. Если была развернута виртуальная машина Windows Server, то в командной строке введите ipconfig / all. Вы видите, что hello виртуальные машины имеют адреса IPv4 и IPv6. При развертывании виртуальных машин Linux необходимо tooconfigure hello ОС Linux tooreceive динамического IPv6-адреса с помощью hello инструкциям для своего дистрибутива Linux.
2. Из клиента, подключенного к Интернету IPv6 Инициируйте подключение toohello общедоступный IPv6-адрес подсистемы балансировки нагрузки hello. балансировки tooconfirm, hello балансировки нагрузки между виртуальными машинами hello двух, удалось установить веб-сервер как Microsoft Internet Information Services (IIS) на каждой из виртуальных машин hello. Hello по умолчанию веб-страницы на каждом сервере может содержать текст hello «Server0» или «Server1» toouniquely идентифицировать его. Затем откройте веб-браузер на клиенте, подключенном к Интернету IPv6 и обзор toohello имя узла, указанное для параметра dnsNameforIPv6LbIP hello hello нагрузки балансировки tooconfirm конца в конец IPv6 tooeach подключение виртуальной Машины. Если вы видите только веб-страницы приветствия только одного сервера, может потребоваться tooclear кэше браузера. Откройте несколько сеансов в режиме закрытого просмотра. Вы должны получить ответ от каждого сервера.
3. Из клиента, подключенного к Интернету IPv4 Инициируйте подключение toohello публичный IPv4-адрес подсистемы балансировки нагрузки hello. tooconfirm, hello балансировки нагрузки — балансировки нагрузки Здравствуйте две виртуальные машины, можно проверить с помощью IIS, как описано в шаге 2.
4. Из каждой виртуальной Машины инициировать исходящее подключение tooan IPv6 или устройство Интернета подключен IPv4. В обоих случаях hello исходный IP-адрес, просмотрен hello целевое устройство является hello открытый адрес IPv4 или IPv6 hello подсистемы балансировки нагрузки.

> [!NOTE]
> ICMP для IPv4 и IPv6 в сети Azure hello блокируется. Поэтому при запуске инструментов ICMP, таких как проверка связи, всегда происходит сбой. подключения tootest использовать вариант TCP, например TCPing или командлет PowerShell теста-NetConnection hello. Обратите внимание, что IP-адреса hello иллюстрации hello примеры значений, которые могут отображаться. Поскольку динамически назначаются hello IPv6-адреса, адреса hello, получаемых будут отличаться и меняется в зависимости от региона. Кроме того используются для hello общедоступный IPv6-адрес на hello toostart подсистемы балансировки нагрузки с другой префикс, чем hello частных адресов IPv6 в пуле hello серверной части.

## <a name="template-parameters-and-variables"></a>Параметры и переменные шаблона

Шаблон диспетчера ресурсов Azure содержит несколько переменных и параметров, которые можно настраивать tooyour потребностей. Переменные используются для фиксированных значений, не следует toochange пользователя. Параметры используются для значений, должны tooprovide пользователя при развертывании шаблона hello. шаблон пример Hello настроен для hello сценарий, описанный в этой статье. Вы можете настроить этот tooneeds среды.

шаблон, используемый в этой статье включает следующие hello пример Hello переменные и параметры:

| Параметр / переменная | Примечания |
| --- | --- |
| adminUsername |Укажите hello имя учетной записи администратора hello, используемых в виртуальных машинах toohello с toosign. |
| adminPassword |Укажите hello пароль для учетной записи администратора hello использовать toosign в виртуальных машинах toohello с. |
| dnsNameforIPv4LbIP |Укажите имя узла DNS hello, должен быть tooassign hello общедоступное имя подсистемы балансировки нагрузки hello. Это имя разрешается балансировки нагрузки toohello общедоступный адрес IPv4. Hello имя должно быть в нижнем регистре и соответствует hello regex: ^ [a-z][a-z0-9-]{1,61}[a-z0-9]$. |
| dnsNameforIPv6LbIP |Укажите имя узла DNS hello, должен быть tooassign hello общедоступное имя подсистемы балансировки нагрузки hello. Это имя разрешается балансировки нагрузки toohello общедоступный IPv6-адрес. Hello имя должно быть в нижнем регистре и соответствует hello regex: ^ [a-z][a-z0-9-]{1,61}[a-z0-9]$. Это может быть hello точно такое же имя, как hello IPv4-адрес. Когда клиент отправляет запрос DNS для этого имени Azure вернет hello A и AAAA записей при используется общее имя hello. |
| vmNamePrefix |Укажите префикс имени виртуальной Машины hello. шаблон Hello добавляет номер (0, 1, т. д.) имя toohello при hello создаются виртуальные машины. |
| nicNamePrefix |Укажите префикс имени hello сетевого интерфейса. шаблон Hello добавляет номер (0, 1, т. д.) имя toohello при создании hello сетевых интерфейсов. |
| storageAccountName |Введите имя существующей учетной записи хранения hello, или укажите имя нового один toobe, созданных с использованием шаблона hello hello. |
| availabilitySetName |Введите имя hello доступности набора toobe с hello виртуальные машины |
| addressPrefix |префикс адреса Hello используется диапазон адресов hello toodefine hello виртуальной сети |
| subnetName |Имя подсети hello в Hello, созданного для hello виртуальной сети |
| subnetPrefix |префикс адреса Hello используется toodefine hello диапазон адресов подсети hello |
| vnetName |Укажите имя hello hello виртуальной сети, используемой hello виртуальных машин. |
| ipv4PrivateIPAddressType |метод распределения Hello используется для hello частного IP-адрес (статический или динамический) |
| ipv6PrivateIPAddressType |метод распределения Hello используется для hello частного IP-адрес (динамическая). Протокол IPv6 поддерживает только динамическое распределение. |
| numberOfInstances |число Hello нагрузки балансировки экземпляров развернутых шаблоном hello |
| ipv4PublicIPAddressName |Укажите имя DNS hello требуется toocommunicate toouse с hello общедоступный адрес IPv4 hello подсистемы балансировки нагрузки. |
| ipv4PublicIPAddressType |метод распределения Hello, используемый для hello общедоступный IP-адрес (статический или динамический) |
| Ipv6PublicIPAddressName |Укажите имя DNS hello требуется toocommunicate toouse с hello общедоступный IPv6-адрес подсистемы балансировки нагрузки hello. |
| ipv6PublicIPAddressType |метод распределения Hello для hello общедоступный IP-адрес (динамическая). Протокол IPv6 поддерживает только динамическое распределение. |
| lbName |Укажите имя hello hello подсистемы балансировки нагрузки. Это имя отображается на портале hello, или используется при ссылке tooit с помощью команды CLI или PowerShell. |

остальные переменные Hello в шаблоне hello содержать производные значения, которые назначаются при Azure создает ресурсы hello. Не изменяйте эти переменные.
