---
title: "Повышение производительности за счет сжатия файлов в Azure CDN | Документация Майкрософт"
description: "В этом разделе описано, как ускорить передачу файла и повысить производительности загрузки страниц с помощью сжатия файлов в CDN Azure."
services: cdn
documentationcenter: 
author: zhangmanling
manager: erikre
editor: 
ms.assetid: af1cddff-78d8-476b-a9d0-8c2164e4de5d
ms.service: cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/23/2017
ms.author: mazha
ms.openlocfilehash: b4e27ec57543daed35811fff347f457b0dd2cd5c
ms.sourcegitcommit: 62eaa376437687de4ef2e325ac3d7e195d158f9f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2017
---
# <a name="improve-performance-by-compressing-files-in-azure-cdn"></a>Повышение производительности за счет сжатия файлов в Azure CDN
Сжатие файлов — это простой и эффективный способ, который позволяет повысить скорость передачи файлов и увеличить производительность загрузки страницы за счет уменьшения размера файлов перед их отправкой с сервера. Этот позволяет снизить потребление пропускной способности и обеспечивает более высокую скорость работы для пользователей.

Сжатие файлов можно активировать двумя способами.

* Включить сжатие на сервере-источнике. В этом случае CDN проходит по сжатым файлам и доставляет их клиентам, которые запросили эти файлы.
* Включить сжатие непосредственно на пограничных серверах CDN. В таком случае CDN сжимает файлы и доставляет их пользователям, даже если эти файлы не были сжаты на сервере-источнике.

> [!IMPORTANT]
> Для применения изменений конфигурации CDN по сети может потребоваться некоторое время.  Для профилей <b>Azure CDN от Akamai</b> распространение обычно завершается в течение одной минуты.  Для профилей <b>Azure CDN от Verizon</b> изменения обычно вступают в силу в течение 90 минут.  Если сжатие для конечной точки CDN задается впервые, перед устранением неполадок следует подождать 1–2 часа, чтобы настройки сжатия гарантированно распространились на серверы POP.
> 
> 

## <a name="enabling-compression"></a>Включение сжатия
> [!NOTE]
> Уровни CDN «Стандартный» и «Премиум» предоставляют одинаковые возможности сжатия, но разные пользовательские интерфейсы.  Дополнительные сведения о различиях между уровнями CDN "Стандартный" и "Премиум" см. в разделе [Обзор Azure CDN](cdn-overview.md).
> 
> 

### <a name="standard-tier"></a>Уровень Standard
> [!NOTE]
> Сведения в этом разделе относятся к профилям **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Стандартный" от Akamai**.
> 
> 

1. На странице профиля CDN щелкните конечную точку CDN, которой хотите управлять.
   
    ![Конечные точки профиля CDN](./media/cdn-file-compression/cdn-endpoints.png)
   
    Откроется страница конечной точки CDN.
2. Нажмите кнопку **Настроить** .
   
    ![Кнопка управления для профиля CDN](./media/cdn-file-compression/cdn-config-btn.png)
   
    Откроется страница настройки CDN.
3. Включите параметр **Сжатие**.
   
    ![Параметры сжатия CDN](./media/cdn-file-compression/cdn-compress-standard.png)
4. Используйте типы по умолчанию либо измените список, удалив или добавив типы файлов.
   
   > [!TIP]
   > Хотя это и возможно, не рекомендуем применять сжатие для сжатых форматов. Например, ZIP, MP3, MP4 или JPG.
   > 
 
5. Внеся необходимые изменения, нажмите кнопку **Сохранить** .

### <a name="premium-tier"></a>Уровень Premium
> [!NOTE]
> Сведения в этом разделе относятся к профилям **Azure CDN уровня "Премиум" от Verizon** .
> 
> 

1. На странице профиля сети CDN нажмите кнопку **Управление**.
   
    ![Кнопка управления для профиля CDN](./media/cdn-file-compression/cdn-manage-btn.png)
   
    Откроется портал управления CDN.
2. Наведите указатель мыши на вкладку **HTTP Large** (Большая платформа HTTP), а затем наведите указатель мыши на всплывающий элемент **Параметры кэша**.  Щелкните **Сжатие**.

    ![Выбор сжатия файлов](./media/cdn-file-compression/cdn-compress-select.png)
   
    Отобразятся параметры сжатия.
   
    ![Параметры сжатия файла](./media/cdn-file-compression/cdn-compress-files.png)
3. Включите сжатие, установив переключатель **Использовать сжатие** .  Введите типы MIME для сжатия в виде списка с разделителями-запятыми (без пробелов) в текстовом поле **Типы файлов** .
   
   > [!TIP]
   > Хотя это и возможно, не рекомендуем применять сжатие для сжатых форматов. Например, ZIP, MP3, MP4 или JPG.
   > 
4. Внеся необходимые изменения, нажмите кнопку **Обновить** .

## <a name="compression-rules"></a>Правила сжатия
В приведенных ниже таблицах описан принцип работы сжатия CDN Azure для всех сценариев.

> [!IMPORTANT]
> Для профилей **Azure CDN от Verizon** (уровня "Стандартный" и "Премиум") будут сжаты только подходящие файлы.  Сжатие допускается для следующих файлов:
> 
> * более 128 байт;
> * менее 1 МБ;
> 
> Эти профили поддерживают кодирование **gzip** (GNU zip), **deflate**, **bzip2** и **br** (Brotli). Для кодирования Brotli сжатие должно выполняться в источнике. Клиент (или браузер) должен отправить запрос на кодирование Brotli, а сжатый ресурс необходимо сначала сжать на стороне источника. 

> [!IMPORTANT]
> Для профилей **Azure CDN от Akamai** сжатие допускается для всех файлов. Но должен использоваться файл типа MIME, для которого [в настройках разрешено сжатие](#enabling-compression).
> 
>Эти профили поддерживают только кодирование **gzip**. Когда конечная точка профиля запрашивает файлы в формате **gzip**, они всегда запрашиваются из сервера-источника независимо от запроса клиента. 

### <a name="compression-disabled-or-file-is-ineligible-for-compression"></a>Сжатие отключено или для файла сжатие недопустимо
| Запрошенный клиентом формат (через заголовок Accept-Encoding) | Кэшированный формат файла | Ответ CDN клиенту | Примечания |
| --- | --- | --- | --- |
| сжатые; |сжатые; |сжатые; | |
| сжатые; |Без сжатия |Без сжатия | |
| сжатые; |Не кэширован |Сжатый или несжатый |Зависит от ответа источника |
| Без сжатия |сжатые; |Без сжатия | |
| Без сжатия |Без сжатия |Без сжатия | |
| Без сжатия |Не кэширован |Без сжатия | |

### <a name="compression-enabled-and-file-is-eligible-for-compression"></a>Сжатие включено и для файла допускается сжатие
| Запрошенный клиентом формат (через заголовок Accept-Encoding) | Кэшированный формат файла | Ответ CDN клиенту | Примечания |
| --- | --- | --- | --- |
| сжатые; |сжатые; |сжатые; |CDN перекодирует из одного поддерживаемого формата в другой |
| сжатые; |Без сжатия |сжатые; |CDN выполняет сжатие |
| сжатые; |Не кэширован |сжатые; |CDN выполняет сжатие, если источник возвращает несжатый файл.  **Azure CDN от Verizon** передает несжатый файл при первом запросе, а затем сжимает файл и помещает его в кэш для последующих запросов.  Файлы с заголовком `Cache-Control: no-cache` никогда не сжимаются. |
| Без сжатия |сжатые; |Без сжатия |CDN проводит распаковку |
| Без сжатия |Без сжатия |Без сжатия | |
| Без сжатия |Не кэширован |Без сжатия | |

## <a name="media-services-cdn-compression"></a>Сжатие CDN для служб мультимедиа
Для конечных точек потоковой передачи CDN служб мультимедиа по умолчанию включено сжатие для следующих типов содержимого: 
- application/vnd.ms-sstr+xml; 
- application/dash+xml;
- application/vnd.apple.mpegurl;
- application/f4m+xml. 

Вы не может включить или отключить сжатие для упомянутых выше типов с помощью портала Azure.  

## <a name="see-also"></a>См. также
* [Устранение неполадок со сжатием файлов CDN](cdn-troubleshoot-compression.md)    

