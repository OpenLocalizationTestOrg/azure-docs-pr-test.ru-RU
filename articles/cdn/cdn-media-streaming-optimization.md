---
title: "aaaMedia оптимизации через сеть доставки содержимого Azure hello потоков"
description: "Оптимизация потоковой передачи файлов мультимедиа для непрерывной доставки"
services: cdn
documentationcenter: 
author: smcevoy
manager: erikre
editor: 
ms.assetid: 
ms.service: cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/16/2017
ms.author: v-semcev
ms.openlocfilehash: a05a86204708c7ea7ef1f9be04323cdda6a2d403
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="media-streaming-optimization-via-hello-azure-content-delivery-network"></a><span data-ttu-id="4c024-103">Оптимизация через сеть доставки содержимого Azure hello потоковой передачи мультимедиа</span><span class="sxs-lookup"><span data-stu-id="4c024-103">Media streaming optimization via hello Azure Content Delivery Network</span></span> 
 
<span data-ttu-id="4c024-104">Использование видео высокого увеличивается на hello Интернет, что создает трудности для эффективной доставке больших файлов.</span><span class="sxs-lookup"><span data-stu-id="4c024-104">Use of high-definition video is increasing on hello Internet, which creates difficulties for efficient delivery of large files.</span></span> <span data-ttu-id="4c024-105">Пользователи ожидают Плавное воспроизведение видео по запросу или live видео средств на разных сетей и клиентов по всему Здравствуй, мир!.</span><span class="sxs-lookup"><span data-stu-id="4c024-105">Customers expect smooth playback of video on demand or live video assets on a variety of networks and clients all over hello world.</span></span> <span data-ttu-id="4c024-106">Для потоковой передачи файлов быстрого и эффективного механизма — критический tooensure smooth и гибких пользователем.</span><span class="sxs-lookup"><span data-stu-id="4c024-106">A fast and efficient delivery mechanism for media streaming files is critical tooensure a smooth and enjoyable consumer experience.</span></span>  

<span data-ttu-id="4c024-107">Потоковой передачи мультимедиа — особенно трудно toodeliver из-за больших размеров hello и количество одновременных средства просмотра.</span><span class="sxs-lookup"><span data-stu-id="4c024-107">Live streaming media is especially difficult toodeliver because of hello large sizes and number of concurrent viewers.</span></span> <span data-ttu-id="4c024-108">Длительные задержки вызвать tooleave пользователей.</span><span class="sxs-lookup"><span data-stu-id="4c024-108">Long delays cause users tooleave.</span></span> <span data-ttu-id="4c024-109">Поскольку обновляющиеся потоки не может быть кэширован заранее и большие задержки не являются приемлемым tooviewers, фрагменты видео должно быть доставлено своевременно.</span><span class="sxs-lookup"><span data-stu-id="4c024-109">Because live streams can't be cached ahead of time and large latencies aren't acceptable tooviewers, video fragments must be delivered in a timely manner.</span></span> 

<span data-ttu-id="4c024-110">шаблоны запроса Hello потоковой передачи также предоставляют новые проблемы.</span><span class="sxs-lookup"><span data-stu-id="4c024-110">hello request patterns of streaming also provide some new challenges.</span></span> <span data-ttu-id="4c024-111">При отпускании популярных обновляющегося потока или новый ряд видео по запросу, тысяч toomillions средств просмотра может запросить поток hello в hello то же время.</span><span class="sxs-lookup"><span data-stu-id="4c024-111">When a popular live stream or a new series is released for video on demand, thousands toomillions of viewers might request hello stream at hello same time.</span></span> <span data-ttu-id="4c024-112">В этом случае смарт-запрос консолидации является жизненно важной toonot перегрузки hello исходные серверы при еще не кэшируются активы hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-112">In this case, smart request consolidation is vital toonot overwhelm hello origin servers when hello assets aren't cached yet.</span></span>
 
<span data-ttu-id="4c024-113">Hello сети доставки содержимого Azure из Akamai теперь предоставляет возможность, обеспечивающая потоковой передачи мультимедиа эффективно toousers всех земной шар hello в масштабе.</span><span class="sxs-lookup"><span data-stu-id="4c024-113">hello Azure Content Delivery Network from Akamai now offers a feature that delivers streaming media assets efficiently toousers across hello globe at scale.</span></span> <span data-ttu-id="4c024-114">функция Hello сокращает задержки, так как это снижает нагрузку hello на исходные серверы hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-114">hello feature reduces latencies because it reduces hello load on hello origin servers.</span></span> <span data-ttu-id="4c024-115">Этот компонент доступен в ценовой категории Standard Akamai hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-115">This feature is available with hello Standard Akamai pricing tier.</span></span> 

<span data-ttu-id="4c024-116">Hello сети доставки содержимого Azure из Verizon доставляет потокового мультимедиа непосредственно в тип оптимизации доставки общие web hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-116">hello Azure Content Delivery Network from Verizon delivers streaming media directly in hello general web delivery optimization type.</span></span>
 
## <a name="configure-an-endpoint-toooptimize-media-streaming-in-hello-azure-content-delivery-network-from-akamai"></a><span data-ttu-id="4c024-117">Настройка конечной точки toooptimize потоковой передачи мультимедиа в сети доставки содержимого Azure из Akamai hello</span><span class="sxs-lookup"><span data-stu-id="4c024-117">Configure an endpoint toooptimize media streaming in hello Azure Content Delivery Network from Akamai</span></span>
 
<span data-ttu-id="4c024-118">Можно настроить на доставку доставки содержимого сети (CDN) конечной точки toooptimize для больших файлов через портал Azure hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-118">You can configure your content delivery network (CDN) endpoint toooptimize delivery for large files via hello Azure portal.</span></span> <span data-ttu-id="4c024-119">Можно также использовать нашими API REST или любой из hello клиента SDK toodo это.</span><span class="sxs-lookup"><span data-stu-id="4c024-119">You can also use our REST APIs or any of hello client SDKs toodo this.</span></span> <span data-ttu-id="4c024-120">Hello следующие шаги показывают процесс hello через портал Azure hello:</span><span class="sxs-lookup"><span data-stu-id="4c024-120">hello following steps show hello process via hello Azure portal:</span></span>

1. <span data-ttu-id="4c024-121">tooadd новую конечную точку на hello **профиля CDN** выберите **конечная точка**.</span><span class="sxs-lookup"><span data-stu-id="4c024-121">tooadd a new endpoint, on hello **CDN profile** page, select **Endpoint**.</span></span>
  
    ![Новая конечная точка](./media/cdn-media-streaming-optimization/01_Adding.png)

2. <span data-ttu-id="4c024-123">В hello **оптимизирован для** раскрывающемся списке выберите **видео потоковой передачи мультимедиа по требованию** для средств видео по запросу.</span><span class="sxs-lookup"><span data-stu-id="4c024-123">In hello **Optimized for** drop-down list, select **Video on demand media streaming** for video-on-demand assets.</span></span> <span data-ttu-id="4c024-124">Если используется сочетание потоковой передачи видео в реальном времени и потоковой передачи видео по запросу, выберите **Общая потоковая передача мультимедиа**.</span><span class="sxs-lookup"><span data-stu-id="4c024-124">If you do a combination of live and video-on-demand streaming, select **General media streaming**.</span></span>

    ![Выбранная потоковая передача](./media/cdn-media-streaming-optimization/02_Creating.png) 
 
<span data-ttu-id="4c024-126">После создания конечной точки hello, оно применяется hello оптимизации для всех файлов, соответствующих определенным условиям.</span><span class="sxs-lookup"><span data-stu-id="4c024-126">After you create hello endpoint, it applies hello optimization for all files that match certain criteria.</span></span> <span data-ttu-id="4c024-127">Этот процесс описан в следующем разделе Hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-127">hello following section describes this process.</span></span> 
 
## <a name="media-streaming-optimizations-for-hello-azure-content-delivery-network-from-akamai"></a><span data-ttu-id="4c024-128">Оптимизация для hello сети доставки содержимого Azure из Akamai потоковой передачи мультимедиа</span><span class="sxs-lookup"><span data-stu-id="4c024-128">Media streaming optimizations for hello Azure Content Delivery Network from Akamai</span></span>
 
<span data-ttu-id="4c024-129">Оптимизация потоковой передачи из Akamai эффективна для потоковой передачи видео по запросу, при которой передаются отдельные фрагменты мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="4c024-129">Media streaming optimization from Akamai is effective for live or video-on-demand streaming media that uses individual media fragments for delivery.</span></span> <span data-ttu-id="4c024-130">Этот процесс отличается от передачи одного большого ресурса с помощью последовательной загрузки или с помощью запросов на диапазоны байт.</span><span class="sxs-lookup"><span data-stu-id="4c024-130">This process is different from a single large asset transferred via progressive download or by using byte-range requests.</span></span> <span data-ttu-id="4c024-131">Дополнительные сведения о таком типе доставки мультимедиа см. в статье [Оптимизация больших файлов](cdn-large-file-optimization.md).</span><span class="sxs-lookup"><span data-stu-id="4c024-131">For information on that style of media delivery, see [Large file optimization](cdn-large-file-optimization.md).</span></span>


<span data-ttu-id="4c024-132">Hello общие носителя доставки или видео по запросу мультимедиа доставки оптимизации типа используются CDN внутренней оптимизации toodeliver мультимедийные ресурсы быстрее.</span><span class="sxs-lookup"><span data-stu-id="4c024-132">hello general media delivery or video-on-demand media delivery optimization types use a CDN with back-end optimizations toodeliver media assets faster.</span></span> <span data-ttu-id="4c024-133">В них также используются конфигурации для ресурсов мультимедиа на основе общих рекомендаций, выработанных с течением времени.</span><span class="sxs-lookup"><span data-stu-id="4c024-133">They also use configurations for media assets based on best practices learned over time.</span></span>

### <a name="caching"></a><span data-ttu-id="4c024-134">Caching</span><span class="sxs-lookup"><span data-stu-id="4c024-134">Caching</span></span>

<span data-ttu-id="4c024-135">Если hello сети доставки содержимого Azure из Akamai обнаруживает, что этого hello ресурса манифеста потоковой передачи или фрагмент, в нем разное время истечения срока действия кэширования, доставка общие веб.</span><span class="sxs-lookup"><span data-stu-id="4c024-135">If hello Azure Content Delivery Network from Akamai detects that hello asset is a streaming manifest or fragment, it uses different caching expiration times from general web delivery.</span></span> <span data-ttu-id="4c024-136">(См. Полный список hello в следующей таблице hello). Как всегда соблюдаются cache-control и Expires заголовки, отправленные из исходной hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-136">(See hello full list in hello following table.) As always, cache-control or Expires headers sent from hello origin are honored.</span></span> <span data-ttu-id="4c024-137">Если активов hello не актив мультимедиа, он кэширует с помощью hello сроков для доставки в общие web.</span><span class="sxs-lookup"><span data-stu-id="4c024-137">If hello asset is not a media asset, it caches by using hello expiration times for general web delivery.</span></span>

<span data-ttu-id="4c024-138">Hello короткое время отрицательное кэширования полезен для разгрузки источника при запросе много фрагмент, который еще не существует.</span><span class="sxs-lookup"><span data-stu-id="4c024-138">hello short negative caching time is useful for origin offload when many users request a fragment that doesn’t exist yet.</span></span> <span data-ttu-id="4c024-139">Например, обновляющегося потока, где приветственных пакетов недоступны из исходной hello, в секунду.</span><span class="sxs-lookup"><span data-stu-id="4c024-139">An example is a live stream where hello packets aren't available from hello origin that second.</span></span> <span data-ttu-id="4c024-140">интервал больше кэширования приветствия также позволяет разгрузить запросы от начала координат hello, так как обычно не изменил содержимое видео.</span><span class="sxs-lookup"><span data-stu-id="4c024-140">hello longer caching interval also helps offload requests from hello origin because video content isn't typically modified.</span></span>
 

|    | <span data-ttu-id="4c024-141">Общие сведения</span><span class="sxs-lookup"><span data-stu-id="4c024-141">General</span></span><br> <span data-ttu-id="4c024-142">web</span><span class="sxs-lookup"><span data-stu-id="4c024-142">web</span></span><br><span data-ttu-id="4c024-143">доставки</span><span class="sxs-lookup"><span data-stu-id="4c024-143">delivery</span></span> | <span data-ttu-id="4c024-144">Общие сведения</span><span class="sxs-lookup"><span data-stu-id="4c024-144">General</span></span><br> <span data-ttu-id="4c024-145">Схема</span><span class="sxs-lookup"><span data-stu-id="4c024-145">media</span></span><br> <span data-ttu-id="4c024-146">Потоковая передача</span><span class="sxs-lookup"><span data-stu-id="4c024-146">streaming</span></span> | <span data-ttu-id="4c024-147">Видео по запросу</span><span class="sxs-lookup"><span data-stu-id="4c024-147">Video-on-demand</span></span> <br><span data-ttu-id="4c024-148">Схема</span><span class="sxs-lookup"><span data-stu-id="4c024-148">media</span></span><br> <span data-ttu-id="4c024-149">Потоковая передача</span><span class="sxs-lookup"><span data-stu-id="4c024-149">streaming</span></span>  
--- | --- | --- | ---
<span data-ttu-id="4c024-150">Кэширование: положительное</span><span class="sxs-lookup"><span data-stu-id="4c024-150">Caching: Positive</span></span> <br> <span data-ttu-id="4c024-151">HTTP 200, 203, 300,</span><span class="sxs-lookup"><span data-stu-id="4c024-151">HTTP 200, 203, 300,</span></span> <br> <span data-ttu-id="4c024-152">301, 302 и 410</span><span class="sxs-lookup"><span data-stu-id="4c024-152">301, 302, and 410</span></span> | <span data-ttu-id="4c024-153">7 дней</span><span class="sxs-lookup"><span data-stu-id="4c024-153">7 days</span></span> |<span data-ttu-id="4c024-154">365 дней</span><span class="sxs-lookup"><span data-stu-id="4c024-154">365 days</span></span> | <span data-ttu-id="4c024-155">365 дней</span><span class="sxs-lookup"><span data-stu-id="4c024-155">365 days</span></span>   
<span data-ttu-id="4c024-156">Кэширование: отрицательное</span><span class="sxs-lookup"><span data-stu-id="4c024-156">Caching: Negative</span></span> <br> <span data-ttu-id="4c024-157">HTTP 204, 305, 404</span><span class="sxs-lookup"><span data-stu-id="4c024-157">HTTP 204, 305, 404,</span></span> <br> <span data-ttu-id="4c024-158">и 405</span><span class="sxs-lookup"><span data-stu-id="4c024-158">and 405</span></span> | <span data-ttu-id="4c024-159">None</span><span class="sxs-lookup"><span data-stu-id="4c024-159">None</span></span> | <span data-ttu-id="4c024-160">1 с</span><span class="sxs-lookup"><span data-stu-id="4c024-160">1 second</span></span> | <span data-ttu-id="4c024-161">1 с</span><span class="sxs-lookup"><span data-stu-id="4c024-161">1 second</span></span>
 
### <a name="deal-with-origin-failure"></a><span data-ttu-id="4c024-162">Устранение сбоев источника</span><span class="sxs-lookup"><span data-stu-id="4c024-162">Deal with origin failure</span></span>  

<span data-ttu-id="4c024-163">При общей передаче мультимедиа и передаче видео по запросу также используются время ожидания источника и журнал повторных попыток в соответствии с рекомендациями для шаблонов типичных запросов.</span><span class="sxs-lookup"><span data-stu-id="4c024-163">General media delivery and video-on-demand media delivery also have origin time-out and a retry log based on best practices for typical request patterns.</span></span> <span data-ttu-id="4c024-164">Например поскольку доставки мультимедиа, общие для динамическую и доставки мультимедиа видео по запросу, он использует короткое время ожидания подключения из-за характера срочных toohello динамической потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="4c024-164">For example, because general media delivery is for live and video-on-demand media delivery, it uses a shorter connection time-out due toohello time-sensitive nature of live streaming.</span></span>

<span data-ttu-id="4c024-165">После истечения времени ожидания соединения hello CDN повторяет несколько раз перед отправкой «504 - истекло время ожидания шлюза» ошибка toohello клиента.</span><span class="sxs-lookup"><span data-stu-id="4c024-165">When a connection times out, hello CDN retries a number of times before it sends a "504 - Gateway Timeout" error toohello client.</span></span> 

<span data-ttu-id="4c024-166">Если файл соответствует hello тип и размер условия список файлов, hello CDN использует поведение hello для потоковой передачи мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="4c024-166">When a file matches hello file type and size conditions list, hello CDN uses hello behavior for media streaming.</span></span> <span data-ttu-id="4c024-167">В противном случае используется общая веб-доставка.</span><span class="sxs-lookup"><span data-stu-id="4c024-167">Otherwise, it uses general web delivery.</span></span>
   
### <a name="conditions-for-media-streaming-optimization"></a><span data-ttu-id="4c024-168">Условия для оптимизации потоковой передачи мультимедиа</span><span class="sxs-lookup"><span data-stu-id="4c024-168">Conditions for media streaming optimization</span></span> 

<span data-ttu-id="4c024-169">Привет, в следующей таблице перечислены hello toobe условия удовлетворены для оптимизации потоковой передачи мультимедиа:</span><span class="sxs-lookup"><span data-stu-id="4c024-169">hello following table lists hello set of criteria toobe satisfied for media streaming optimization:</span></span> 
 
<span data-ttu-id="4c024-170">Поддерживаемые типы потоковой передачи</span><span class="sxs-lookup"><span data-stu-id="4c024-170">Supported streaming types</span></span> | <span data-ttu-id="4c024-171">Расширения файлов</span><span class="sxs-lookup"><span data-stu-id="4c024-171">File extensions</span></span>  
--- | ---  
<span data-ttu-id="4c024-172">Apple HLS</span><span class="sxs-lookup"><span data-stu-id="4c024-172">Apple HLS</span></span> | <span data-ttu-id="4c024-173">m3u8, m3u, m3ub, key, ts, aac</span><span class="sxs-lookup"><span data-stu-id="4c024-173">m3u8, m3u, m3ub, key, ts, aac</span></span>
<span data-ttu-id="4c024-174">Adobe HDS</span><span class="sxs-lookup"><span data-stu-id="4c024-174">Adobe HDS</span></span> | <span data-ttu-id="4c024-175">f4m, f4x, drmmeta, bootstrap, f4f,</span><span class="sxs-lookup"><span data-stu-id="4c024-175">f4m, f4x, drmmeta, bootstrap, f4f,</span></span><br><span data-ttu-id="4c024-176">Структура URL Seg-Frag</span><span class="sxs-lookup"><span data-stu-id="4c024-176">Seg-Frag URL structure</span></span> <br> <span data-ttu-id="4c024-177">(сопоставления регулярного выражения: ^(/.*)Seq(\d+)-Frag(\d+)</span><span class="sxs-lookup"><span data-stu-id="4c024-177">(matching regex: ^(/.*)Seq(\d+)-Frag(\d+)</span></span>
<span data-ttu-id="4c024-178">DASH</span><span class="sxs-lookup"><span data-stu-id="4c024-178">DASH</span></span> | <span data-ttu-id="4c024-179">mpd, тире, divx, ismv, m4s, m4v, mp4, mp4v,</span><span class="sxs-lookup"><span data-stu-id="4c024-179">mpd, dash, divx, ismv, m4s, m4v, mp4, mp4v,</span></span> <br> <span data-ttu-id="4c024-180">sidx, webm, mp4a, m4a, isma</span><span class="sxs-lookup"><span data-stu-id="4c024-180">sidx, webm, mp4a, m4a, isma</span></span>
<span data-ttu-id="4c024-181">Потоковая передача Smooth Streaming</span><span class="sxs-lookup"><span data-stu-id="4c024-181">Smooth streaming</span></span> | <span data-ttu-id="4c024-182">/manifest/,/QualityLevels/Fragments/</span><span class="sxs-lookup"><span data-stu-id="4c024-182">/manifest/,/QualityLevels/Fragments/</span></span>
  

 
## <a name="media-streaming-optimizations-for-hello-azure-content-delivery-network-from-verizon"></a><span data-ttu-id="4c024-183">Оптимизация для hello сети доставки содержимого Azure из Verizon потоковой передачи мультимедиа</span><span class="sxs-lookup"><span data-stu-id="4c024-183">Media streaming optimizations for hello Azure Content Delivery Network from Verizon</span></span>

<span data-ttu-id="4c024-184">Hello сети доставки содержимого Azure из Verizon доставляет потоковой передачи мультимедиа напрямую с помощью тип оптимизации доставки общие web hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-184">hello Azure Content Delivery Network from Verizon delivers streaming media assets directly by using hello general web delivery optimization type.</span></span> <span data-ttu-id="4c024-185">Несколько функций на hello CDN непосредственно поможет доставки мультимедиа по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4c024-185">A few features on hello CDN directly assist in delivering media assets by default.</span></span>

### <a name="partial-cache-sharing"></a><span data-ttu-id="4c024-186">Совместное использование частичного кэширования</span><span class="sxs-lookup"><span data-stu-id="4c024-186">Partial cache sharing</span></span>

<span data-ttu-id="4c024-187">Совместное использование частичного кэширования позволяет запросы содержимого toonew tooserve частично в кэше CDN hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-187">Partial cache sharing allows hello CDN tooserve partially cached content toonew requests.</span></span> <span data-ttu-id="4c024-188">Например если toohello первый запрос hello CDN Промах кэша, hello запрос отправляется toohello источника.</span><span class="sxs-lookup"><span data-stu-id="4c024-188">For example, if hello first request toohello CDN results in a cache miss, hello request is sent toohello origin.</span></span> <span data-ttu-id="4c024-189">Несмотря на то, что это неполный содержимое загружается в hello кэша CDN, другие запросы toohello CDN можно начать получение этих данных.</span><span class="sxs-lookup"><span data-stu-id="4c024-189">Although this incomplete content is loaded into hello CDN cache, other requests toohello CDN can start getting this data.</span></span> 

### <a name="cache-fill-wait-time"></a><span data-ttu-id="4c024-190">Время ожидания заполнения кэша</span><span class="sxs-lookup"><span data-stu-id="4c024-190">Cache fill wait time</span></span>

 <span data-ttu-id="4c024-191">функция времени ожидания заполнения кэша Hello принудительно hello пограничного сервера toohold последующие запросы для того же ресурса hello до ответа HTTP, заголовки, поставляемых hello исходного сервера.</span><span class="sxs-lookup"><span data-stu-id="4c024-191">hello cache fill wait time feature forces hello edge server toohold any subsequent requests for hello same resource until HTTP response headers arrive from hello origin server.</span></span> <span data-ttu-id="4c024-192">Если заголовки HTTP-ответа от источника hello поступило до истечения времени ожидания hello, все запросы, которые были поставить на удержание обслуживается hello растет кэша.</span><span class="sxs-lookup"><span data-stu-id="4c024-192">If HTTP response headers from hello origin  arrive before hello timer expires, all requests that were put on hold are served out of hello growing cache.</span></span> <span data-ttu-id="4c024-193">В hello же время hello кэш заполняется данными из источника hello.</span><span class="sxs-lookup"><span data-stu-id="4c024-193">At hello same time, hello cache is filled by data from hello origin.</span></span> <span data-ttu-id="4c024-194">По умолчанию время ожидания для заполнения кэша hello установлено too3 000 миллисекунд.</span><span class="sxs-lookup"><span data-stu-id="4c024-194">By default, hello cache fill wait time is set too3,000 milliseconds.</span></span> 

