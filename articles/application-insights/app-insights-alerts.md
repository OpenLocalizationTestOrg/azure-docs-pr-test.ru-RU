---
title: "Задание оповещений в Azure Application Insights | Документация Майкрософт"
description: "Получайте уведомления о малом времени отклика, исключениях или других изменениях производительности или использования в веб-приложении."
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.assetid: f8ebde72-f819-4ba5-afa2-31dbd49509a5
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 03/14/2017
ms.author: bwren
ms.openlocfilehash: c8386ffc5d68260eeb75edf7efb77db1163dcef8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="set-alerts-in-application-insights"></a><span data-ttu-id="93ec3-103">Настройка оповещений в Application Insights</span><span class="sxs-lookup"><span data-stu-id="93ec3-103">Set Alerts in Application Insights</span></span>
<span data-ttu-id="93ec3-104">[Azure Application Insights][start] может предупреждать об изменениях в метриках производительности или использования в веб-приложении.</span><span class="sxs-lookup"><span data-stu-id="93ec3-104">[Azure Application Insights][start] can alert you to changes in performance or usage metrics in your web app.</span></span> 

<span data-ttu-id="93ec3-105">Application Insights выполняет мониторинг живого приложения на [разнообразных платформах][platforms], чтобы помочь вам диагностировать проблемы с производительностью и понять закономерности использования приложения.</span><span class="sxs-lookup"><span data-stu-id="93ec3-105">Application Insights monitors your live app on a [wide variety of platforms][platforms] to help you diagnose performance issues and understand usage patterns.</span></span>

<span data-ttu-id="93ec3-106">Оповещения бывают трех типов:</span><span class="sxs-lookup"><span data-stu-id="93ec3-106">There are three kinds of alerts:</span></span>

* <span data-ttu-id="93ec3-107">**оповещения о метриках**, сообщающие, что какая-либо метрика, например времени отклика, числа исключений, загрузки ЦП или количества просмотров страницы, достигла порогового значения за некоторый период времени;</span><span class="sxs-lookup"><span data-stu-id="93ec3-107">**Metric alerts** tell you when a metric crosses a threshold value for some period - such as response times, exception counts, CPU usage, or page views.</span></span> 
* <span data-ttu-id="93ec3-108">[**веб-тесты**][availability], сообщающие о том, что сайт недоступен в Интернете или медленно реагирует на запросы.</span><span class="sxs-lookup"><span data-stu-id="93ec3-108">[**Web tests**][availability] tell you when your site is unavailable on the internet, or responding slowly.</span></span> <span data-ttu-id="93ec3-109">[Подробнее][availability]</span><span class="sxs-lookup"><span data-stu-id="93ec3-109">[Learn more][availability].</span></span>
* <span data-ttu-id="93ec3-110">[**Упреждающая диагностика**](app-insights-proactive-diagnostics.md) автоматически настроена для отправки уведомлений о необычных показателях производительности.</span><span class="sxs-lookup"><span data-stu-id="93ec3-110">[**Proactive diagnostics**](app-insights-proactive-diagnostics.md) are configured automatically to notify you about unusual performance patterns.</span></span>

<span data-ttu-id="93ec3-111">В этой статье мы рассмотрим оповещения о метриках.</span><span class="sxs-lookup"><span data-stu-id="93ec3-111">We focus on metric alerts in this article.</span></span>

## <a name="set-a-metric-alert"></a><span data-ttu-id="93ec3-112">Задание оповещения о метриках</span><span class="sxs-lookup"><span data-stu-id="93ec3-112">Set a Metric alert</span></span>
<span data-ttu-id="93ec3-113">Откройте колонку "Правила оповещений", а затем нажмите кнопку "Добавить".</span><span class="sxs-lookup"><span data-stu-id="93ec3-113">Open the Alert rules blade, and then use the add button.</span></span> 

![В колонке правил оповещений нажмите кнопку «Добавить оповещение».](./media/app-insights-alerts/01-set-metric.png)

* <span data-ttu-id="93ec3-116">Выбирайте ресурс прежде других свойств.</span><span class="sxs-lookup"><span data-stu-id="93ec3-116">Set the resource before the other properties.</span></span> <span data-ttu-id="93ec3-117">**Выберите ресурс («компоненты»)** , если нужно задать предупреждения для метрик производительности или использования.</span><span class="sxs-lookup"><span data-stu-id="93ec3-117">**Choose the "(components)" resource** if you want to set alerts on performance or usage metrics.</span></span>
* <span data-ttu-id="93ec3-118">Имя, присваиваемое предупреждению, должно быть уникальным в пределах группы ресурсов (не только приложения).</span><span class="sxs-lookup"><span data-stu-id="93ec3-118">The name that you give to the alert must be unique within the resource group (not just your application).</span></span>
* <span data-ttu-id="93ec3-119">Аккуратно указывайте единицы измерения для пороговых значений.</span><span class="sxs-lookup"><span data-stu-id="93ec3-119">Be careful to note the units in which you're asked to enter the threshold value.</span></span>
* <span data-ttu-id="93ec3-120">Если установить флажок Email owners (Отправлять по электронной почте владельцам), оповещения будут отправляться по электронной почте всем, кто имеет доступ к этой группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="93ec3-120">If you check the box "Email owners...", alerts are sent by email to everyone who has access to this resource group.</span></span> <span data-ttu-id="93ec3-121">Чтобы предоставить такой доступ другим пользователям, добавьте их в [группу ресурсов или подписку](app-insights-resources-roles-access-control.md) (но не ресурс).</span><span class="sxs-lookup"><span data-stu-id="93ec3-121">To expand this set of people, add them to the [resource group or subscription](app-insights-resources-roles-access-control.md) (not the resource).</span></span>
* <span data-ttu-id="93ec3-122">Если в поле Additional emails (Дополнительные электронные адреса) указать электронные адреса, оповещения будут отправляться на эти адреса отдельных пользователей или групп (независимо от того, установлен ли флажок Email owners [Отправлять по электронной почте владельцам]).</span><span class="sxs-lookup"><span data-stu-id="93ec3-122">If you specify "Additional emails", alerts are sent to those individuals or groups (whether or not you checked the "email owners..." box).</span></span> 
* <span data-ttu-id="93ec3-123">Задайте [адрес объекта webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md), если вы настроили веб-приложение, которое будет реагировать на оповещения.</span><span class="sxs-lookup"><span data-stu-id="93ec3-123">Set a [webhook address](../monitoring-and-diagnostics/insights-webhooks-alerts.md) if you have set up a web app that responds to alerts.</span></span> <span data-ttu-id="93ec3-124">Оно будет вызываться, когда оповещение будет активировано и разрешено.</span><span class="sxs-lookup"><span data-stu-id="93ec3-124">It is called both when the alert is Activated and when it is Resolved.</span></span> <span data-ttu-id="93ec3-125">(Обратите внимание, что в настоящее время параметры запроса не передаются как свойства объекта webhook.)</span><span class="sxs-lookup"><span data-stu-id="93ec3-125">(But note that at present, query parameters are not passed through as webhook properties.)</span></span>
* <span data-ttu-id="93ec3-126">Оповещение можно отключить или включить: см. кнопки вверху колонки.</span><span class="sxs-lookup"><span data-stu-id="93ec3-126">You can Disable or Enable the alert: see the buttons at the top of the blade.</span></span>

<span data-ttu-id="93ec3-127">*Отсутствует кнопка «Добавить оповещение».*</span><span class="sxs-lookup"><span data-stu-id="93ec3-127">*I don't see the Add Alert button.*</span></span> 

* <span data-ttu-id="93ec3-128">Вы используете учетную запись организации?</span><span class="sxs-lookup"><span data-stu-id="93ec3-128">Are you using an organizational account?</span></span> <span data-ttu-id="93ec3-129">Вы можете настроить оповещения, если у вас есть доступ к этому ресурсу приложения на правах владельца или участника.</span><span class="sxs-lookup"><span data-stu-id="93ec3-129">You can set alerts if you have owner or contributor access to this application resource.</span></span> <span data-ttu-id="93ec3-130">Просмотрите колонку "Контроль доступа".</span><span class="sxs-lookup"><span data-stu-id="93ec3-130">Take a look at the Access Control blade.</span></span> <span data-ttu-id="93ec3-131">[Дополнительная информация о контроле доступа][roles].</span><span class="sxs-lookup"><span data-stu-id="93ec3-131">[Learn about access control][roles].</span></span>

> [!NOTE]
> <span data-ttu-id="93ec3-132">В колонке "Оповещения" вы увидите, что оповещение уже настроено: [Упреждающая диагностика](app-insights-proactive-failure-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="93ec3-132">In the alerts blade, you see that there's already an alert set up: [Proactive Diagnostics](app-insights-proactive-failure-diagnostics.md).</span></span> <span data-ttu-id="93ec3-133">Это автоматическое оповещение, которое отслеживает одну определенную метрику — процент сбоев запросов.</span><span class="sxs-lookup"><span data-stu-id="93ec3-133">The automatic alert monitors one particular metric, request failure rate.</span></span> <span data-ttu-id="93ec3-134">Если вы не хотите отключать упреждающее оповещение, не нужно задавать собственное оповещение о проценте сбоев запросов.</span><span class="sxs-lookup"><span data-stu-id="93ec3-134">Unless you decide to disable the proactive alert, you don't need to set your own alert on request failure rate.</span></span> 
> 
> 

## <a name="see-your-alerts"></a><span data-ttu-id="93ec3-135">Отображение оповещений</span><span class="sxs-lookup"><span data-stu-id="93ec3-135">See your alerts</span></span>
<span data-ttu-id="93ec3-136">Вы получите сообщение электронной почты при изменении состояния предупреждения с неактивного на активное.</span><span class="sxs-lookup"><span data-stu-id="93ec3-136">You get an email when an alert changes state between inactive and active.</span></span> 

<span data-ttu-id="93ec3-137">Текущее состояние каждого предупреждения в колонке правил оповещений.</span><span class="sxs-lookup"><span data-stu-id="93ec3-137">The current state of each alert is shown in the Alert rules blade.</span></span>

<span data-ttu-id="93ec3-138">Ниже показана сводка недавних действий в раскрывающемся списке оповещений.</span><span class="sxs-lookup"><span data-stu-id="93ec3-138">There's a summary of recent activity in the alerts drop-down:</span></span>

![Раскрывающийся список оповещений](./media/app-insights-alerts/010-alert-drop.png)

<span data-ttu-id="93ec3-140">Журнал изменений состояния находится в журнале действий.</span><span class="sxs-lookup"><span data-stu-id="93ec3-140">The history of state changes is in the Activity Log:</span></span>

![В колонке "Обзор" щелкните "Параметры" > "Журналы аудита".](./media/app-insights-alerts/09-alerts.png)

## <a name="how-alerts-work"></a><span data-ttu-id="93ec3-142">Принципы работы оповещений</span><span class="sxs-lookup"><span data-stu-id="93ec3-142">How alerts work</span></span>
* <span data-ttu-id="93ec3-143">У оповещения бывает три состояния: Never activated (Еще не активировалось), "Активировано" и "Разрешено".</span><span class="sxs-lookup"><span data-stu-id="93ec3-143">An alert has three states: "Never activated", "Activated", and "Resolved."</span></span> <span data-ttu-id="93ec3-144">Активация означает, что при последней оценке указанное условие имело значение true.</span><span class="sxs-lookup"><span data-stu-id="93ec3-144">Activated means the condition you specified was true, when it was last evaluated.</span></span>
* <span data-ttu-id="93ec3-145">Когда оповещение изменяет состояние, создается уведомление.</span><span class="sxs-lookup"><span data-stu-id="93ec3-145">A notification is generated when an alert changes state.</span></span> <span data-ttu-id="93ec3-146">(Если при создании оповещения его условие уже имело значение true, возможно, вы не получите уведомление, пока условие не примет значение false.)</span><span class="sxs-lookup"><span data-stu-id="93ec3-146">(If the alert condition was already true when you created the alert, you might not get a notification until the condition goes false.)</span></span>
* <span data-ttu-id="93ec3-147">Каждое уведомление создает электронное сообщение, если вы установили флажок отправки электронных сообщений или указали электронные адреса.</span><span class="sxs-lookup"><span data-stu-id="93ec3-147">Each notification generates an email if you checked the emails box, or provided email addresses.</span></span> <span data-ttu-id="93ec3-148">Можно также просмотреть раскрывающийся список уведомлений.</span><span class="sxs-lookup"><span data-stu-id="93ec3-148">You can also look at the Notifications drop-down list.</span></span>
* <span data-ttu-id="93ec3-149">Каждый раз при получении метрики выполняется оценка оповещения (но не в других случаях).</span><span class="sxs-lookup"><span data-stu-id="93ec3-149">An alert is evaluated each time a metric arrives, but not otherwise.</span></span>
* <span data-ttu-id="93ec3-150">При такой оценке выполняется вычисление метрики за предыдущий период и ее сравнение с пороговым значением для определения нового состояния оповещения.</span><span class="sxs-lookup"><span data-stu-id="93ec3-150">The evaluation aggregates the metric over the preceding period, and then compares it to the threshold to determine the new state.</span></span>
* <span data-ttu-id="93ec3-151">Выбранный вами период определяет интервал, для которого выполняется вычисление метрики.</span><span class="sxs-lookup"><span data-stu-id="93ec3-151">The period that you choose specifies the interval over which metrics are aggregated.</span></span> <span data-ttu-id="93ec3-152">Он не влияет на периодичность оценки оповещения. Она зависит от частоты получения метрик.</span><span class="sxs-lookup"><span data-stu-id="93ec3-152">It doesn't affect how often the alert is evaluated: that depends on the frequency of arrival of metrics.</span></span>
* <span data-ttu-id="93ec3-153">Если в течение некоторого времени для определенной метрики не поступает никаких данных, то такая ситуация оказывает различное влияние на оценку оповещения и на диаграммы в обозревателе метрик.</span><span class="sxs-lookup"><span data-stu-id="93ec3-153">If no data arrives for a particular metric for some time, the gap has different effects on alert evaluation and on the charts in metric explorer.</span></span> <span data-ttu-id="93ec3-154">Если данные не поступают в обозреватель метрик в течение периода, превышающего интервал выборки диаграммы, то на диаграмме будет отображено значение 0.</span><span class="sxs-lookup"><span data-stu-id="93ec3-154">In metric explorer, if no data is seen for longer than the chart's sampling interval, the chart shows a value of 0.</span></span> <span data-ttu-id="93ec3-155">При этом не будет выполняться повторная оценка оповещения, основанного на прежней метрике, и его состояние останется неизменным.</span><span class="sxs-lookup"><span data-stu-id="93ec3-155">But an alert based on the same metric is not be reevaluated, and the alert's state remains unchanged.</span></span> 
  
    <span data-ttu-id="93ec3-156">Когда, наконец, данные поступят, значение диаграммы снова станет ненулевым.</span><span class="sxs-lookup"><span data-stu-id="93ec3-156">When data eventually arrives, the chart jumps back to a non-zero value.</span></span> <span data-ttu-id="93ec3-157">Будет выполнена оценка оповещения на основе данных, доступных за указанный вами период.</span><span class="sxs-lookup"><span data-stu-id="93ec3-157">The alert evaluates based on the data available for the period you specified.</span></span> <span data-ttu-id="93ec3-158">Если новая точка данных — это единственная доступная в периоде, то для вычисления будет использована только она.</span><span class="sxs-lookup"><span data-stu-id="93ec3-158">If the new data point is the only one available in the period, the aggregate is based just on that data point.</span></span>
* <span data-ttu-id="93ec3-159">Даже если задать длительный период, оповещение может часто менять свое состояние с "предупреждение" на "работоспособен" и наоборот.</span><span class="sxs-lookup"><span data-stu-id="93ec3-159">An alert can flicker frequently between alert and healthy states, even if you set a long period.</span></span> <span data-ttu-id="93ec3-160">Это может происходить, если значение метрики находится вблизи порогового значения.</span><span class="sxs-lookup"><span data-stu-id="93ec3-160">This can happen if the metric value hovers around the threshold.</span></span> <span data-ttu-id="93ec3-161">Для порогового значения не предусмотрен гистерезис: переход из состояния "предупреждение" в состояние "работоспособен" и наоборот происходит при одном и том же значении.</span><span class="sxs-lookup"><span data-stu-id="93ec3-161">There is no hysteresis in the threshold: the transition to alert happens at the same value as the transition to healthy.</span></span>

## <a name="what-are-good-alerts-to-set"></a><span data-ttu-id="93ec3-162">Какие оповещения следует настраивать</span><span class="sxs-lookup"><span data-stu-id="93ec3-162">What are good alerts to set?</span></span>
<span data-ttu-id="93ec3-163">Это зависит от приложения.</span><span class="sxs-lookup"><span data-stu-id="93ec3-163">It depends on your application.</span></span> <span data-ttu-id="93ec3-164">Прежде всего, лучше не задавать слишком много метрик.</span><span class="sxs-lookup"><span data-stu-id="93ec3-164">To start with, it's best not to set too many metrics.</span></span> <span data-ttu-id="93ec3-165">Просмотрите диаграммы метрик во время выполнения приложения, чтобы понять, как работает приложение в нормальном режиме.</span><span class="sxs-lookup"><span data-stu-id="93ec3-165">Spend some time looking at your metric charts while your app is running, to get a feel for how it behaves normally.</span></span> <span data-ttu-id="93ec3-166">Это поможет найти способы повышения его производительности.</span><span class="sxs-lookup"><span data-stu-id="93ec3-166">This practice helps you find ways to improve its performance.</span></span> <span data-ttu-id="93ec3-167">Затем настройте оповещения, которые будут предупреждать вас, если метрики превысят пределы обычного режима работы.</span><span class="sxs-lookup"><span data-stu-id="93ec3-167">Then set up alerts to tell you when the metrics go outside the normal zone.</span></span> 

<span data-ttu-id="93ec3-168">Чаще всего используются следующие оповещения.</span><span class="sxs-lookup"><span data-stu-id="93ec3-168">Popular alerts include:</span></span>

* <span data-ttu-id="93ec3-169">[Метрики браузера][client] (особенно показатель **времени загрузки страницы** браузера) удобно использовать для веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="93ec3-169">[Browser metrics][client], especially Browser **page load times**, are good for web applications.</span></span> <span data-ttu-id="93ec3-170">Если на странице имеется много сценариев, следует искать **исключения браузера**.</span><span class="sxs-lookup"><span data-stu-id="93ec3-170">If your page has many scripts, you should look for **browser exceptions**.</span></span> <span data-ttu-id="93ec3-171">Чтобы получить эти метрики и оповещения, необходимо настроить [мониторинг веб-страниц][client].</span><span class="sxs-lookup"><span data-stu-id="93ec3-171">In order to get these metrics and alerts, you have to set up [web page monitoring][client].</span></span>
* <span data-ttu-id="93ec3-172">**Время ответа сервера** для серверной части веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="93ec3-172">**Server response time** for the server side of web applications.</span></span> <span data-ttu-id="93ec3-173">Кроме настройки оповещений следите за этой метрикой, чтобы определить, насколько пропорционально она меняется по мере увеличения частоты запросов, так как изменение может указывать на то, что в приложении заканчиваются ресурсы.</span><span class="sxs-lookup"><span data-stu-id="93ec3-173">As well as setting up alerts, keep an eye on this metric to see if it varies disproportionately with high request rates: variation might indicate that your app is running out of resources.</span></span> 
* <span data-ttu-id="93ec3-174">**Исключения сервера.** Чтобы отобразить их, необходимо выполнить [дополнительную настройку](app-insights-asp-net-exceptions.md).</span><span class="sxs-lookup"><span data-stu-id="93ec3-174">**Server exceptions** - to see them, you have to do some [additional setup](app-insights-asp-net-exceptions.md).</span></span>

<span data-ttu-id="93ec3-175">Не забывайте, что [упреждающая диагностика частоты сбоев](app-insights-proactive-failure-diagnostics.md) автоматически отслеживает скорость, с которой приложение отвечает на запросы с кодом ошибки.</span><span class="sxs-lookup"><span data-stu-id="93ec3-175">Don't forget that [proactive failure rate diagnostics](app-insights-proactive-failure-diagnostics.md) automatically monitor the rate at which your app responds to requests with failure codes.</span></span> 

## <a name="automation"></a><span data-ttu-id="93ec3-176">Автоматизация</span><span class="sxs-lookup"><span data-stu-id="93ec3-176">Automation</span></span>
* [<span data-ttu-id="93ec3-177">Использование PowerShell для автоматизации настройки оповещений</span><span class="sxs-lookup"><span data-stu-id="93ec3-177">Use PowerShell to automate setting up alerts</span></span>](app-insights-powershell-alerts.md)
* [<span data-ttu-id="93ec3-178">Использование объектов webhook для автоматизации реагирования на оповещения</span><span class="sxs-lookup"><span data-stu-id="93ec3-178">Use webhooks to automate responding to alerts</span></span>](../monitoring-and-diagnostics/insights-webhooks-alerts.md)

## <a name="video"></a><span data-ttu-id="93ec3-179">Видео</span><span class="sxs-lookup"><span data-stu-id="93ec3-179">Video</span></span>

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player]

## <a name="see-also"></a><span data-ttu-id="93ec3-180">См. также</span><span class="sxs-lookup"><span data-stu-id="93ec3-180">See also</span></span>
* [<span data-ttu-id="93ec3-181">Доступность веб-тестов</span><span class="sxs-lookup"><span data-stu-id="93ec3-181">Availability web tests</span></span>](app-insights-monitor-web-app-availability.md)
* [<span data-ttu-id="93ec3-182">Автоматическая настройка оповещений</span><span class="sxs-lookup"><span data-stu-id="93ec3-182">Automate setting up alerts</span></span>](app-insights-powershell-alerts.md)
* [<span data-ttu-id="93ec3-183">Упреждающая диагностика</span><span class="sxs-lookup"><span data-stu-id="93ec3-183">Proactive diagnostics</span></span>](app-insights-proactive-diagnostics.md) 

<!--Link references-->

[availability]: app-insights-monitor-web-app-availability.md
[client]: app-insights-javascript.md
[platforms]: app-insights-platforms.md
[roles]: app-insights-resources-roles-access-control.md
[start]: app-insights-overview.md

