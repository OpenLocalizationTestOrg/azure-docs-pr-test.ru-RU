---
title: "Задание оповещений в Azure Application Insights | Документация Майкрософт"
description: "Получайте уведомления о малом времени отклика, исключениях или других изменениях производительности или использования в веб-приложении."
services: application-insights
documentationcenter: 
author: mrbullwinkle
manager: carmonm
ms.assetid: f8ebde72-f819-4ba5-afa2-31dbd49509a5
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 03/14/2017
ms.author: mbullwin
ms.openlocfilehash: b0e4828b2cb6bbcb4329381e77db3b187d659706
ms.sourcegitcommit: e462e5cca2424ce36423f9eff3a0cf250ac146ad
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/01/2017
---
# <a name="set-alerts-in-application-insights"></a>Настройка оповещений в Application Insights
[Azure Application Insights][start] может предупреждать об изменениях в метриках производительности или использования в веб-приложении. 

Application Insights выполняет мониторинг живого приложения на [разнообразных платформах][platforms], чтобы помочь вам диагностировать проблемы с производительностью и понять закономерности использования приложения.

Оповещения бывают трех типов:

* **оповещения о метриках**, сообщающие, что какая-либо метрика, например времени отклика, числа исключений, загрузки ЦП или количества просмотров страницы, достигла порогового значения за некоторый период времени; 
* [**веб-тесты**][availability], сообщающие о том, что сайт недоступен в Интернете или медленно реагирует на запросы. [Подробнее][availability]
* [**Упреждающая диагностика**](app-insights-proactive-diagnostics.md) автоматически настроена для отправки уведомлений о необычных показателях производительности.

В этой статье мы рассмотрим оповещения о метриках.

## <a name="set-a-metric-alert"></a>Задание оповещения о метриках
Откройте колонку "Правила оповещений", а затем нажмите кнопку "Добавить". 

![В колонке правил оповещений нажмите кнопку «Добавить оповещение». Установите приложение в качестве ресурса для измерения, введите имя оповещения и выберите метрику.](./media/app-insights-alerts/01-set-metric.png)

* Выбирайте ресурс прежде других свойств. **Выберите ресурс («компоненты»)** , если нужно задать предупреждения для метрик производительности или использования.
* Имя, присваиваемое предупреждению, должно быть уникальным в пределах группы ресурсов (не только приложения).
* Аккуратно указывайте единицы измерения для пороговых значений.
* Если установить флажок Email owners (Отправлять по электронной почте владельцам), оповещения будут отправляться по электронной почте всем, кто имеет доступ к этой группе ресурсов. Чтобы предоставить такой доступ другим пользователям, добавьте их в [группу ресурсов или подписку](app-insights-resources-roles-access-control.md) (но не ресурс).
* Если в поле Additional emails (Дополнительные электронные адреса) указать электронные адреса, оповещения будут отправляться на эти адреса отдельных пользователей или групп (независимо от того, установлен ли флажок Email owners [Отправлять по электронной почте владельцам]). 
* Задайте [адрес объекта webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md), если вы настроили веб-приложение, которое будет реагировать на оповещения. Оно будет вызываться, когда оповещение будет активировано и разрешено. (Обратите внимание, что в настоящее время параметры запроса не передаются как свойства объекта webhook.)
* Оповещение можно отключить или включить: см. кнопки вверху колонки.

*Отсутствует кнопка «Добавить оповещение».* 

* Вы используете учетную запись организации? Вы можете настроить оповещения, если у вас есть доступ к этому ресурсу приложения на правах владельца или участника. Просмотрите колонку "Контроль доступа". [Дополнительная информация о контроле доступа][roles].

> [!NOTE]
> В колонке "Оповещения" вы увидите, что оповещение уже настроено: [Упреждающая диагностика](app-insights-proactive-failure-diagnostics.md). Это автоматическое оповещение, которое отслеживает одну определенную метрику — процент сбоев запросов. Если вы не хотите отключать упреждающее оповещение, не нужно задавать собственное оповещение о проценте сбоев запросов. 
> 
> 

## <a name="see-your-alerts"></a>Отображение оповещений
Вы получите сообщение электронной почты при изменении состояния предупреждения с неактивного на активное. 

Текущее состояние каждого предупреждения в колонке правил оповещений.

Ниже показана сводка недавних действий в раскрывающемся списке оповещений.

![Раскрывающийся список оповещений](./media/app-insights-alerts/010-alert-drop.png)

Журнал изменений состояния находится в журнале действий.

![В колонке "Обзор" щелкните "Параметры" > "Журналы аудита".](./media/app-insights-alerts/09-alerts.png)

## <a name="how-alerts-work"></a>Принципы работы оповещений
* У оповещения бывает три состояния: Never activated (Еще не активировалось), "Активировано" и "Разрешено". Активация означает, что при последней оценке указанное условие имело значение true.
* Когда оповещение изменяет состояние, создается уведомление. (Если при создании оповещения его условие уже имело значение true, возможно, вы не получите уведомление, пока условие не примет значение false.)
* Каждое уведомление создает электронное сообщение, если вы установили флажок отправки электронных сообщений или указали электронные адреса. Можно также просмотреть раскрывающийся список уведомлений.
* Каждый раз при получении метрики выполняется оценка оповещения (но не в других случаях).
* При такой оценке выполняется вычисление метрики за предыдущий период и ее сравнение с пороговым значением для определения нового состояния оповещения.
* Выбранный вами период определяет интервал, для которого выполняется вычисление метрики. Он не влияет на периодичность оценки оповещения. Она зависит от частоты получения метрик.
* Если в течение некоторого времени для определенной метрики не поступает никаких данных, то такая ситуация оказывает различное влияние на оценку оповещения и на диаграммы в обозревателе метрик. Если данные не поступают в обозреватель метрик в течение периода, превышающего интервал выборки диаграммы, то на диаграмме будет отображено значение 0. При этом не будет выполняться повторная оценка оповещения, основанного на прежней метрике, и его состояние останется неизменным. 
  
    Когда, наконец, данные поступят, значение диаграммы снова станет ненулевым. Будет выполнена оценка оповещения на основе данных, доступных за указанный вами период. Если новая точка данных — это единственная доступная в периоде, то для вычисления будет использована только она.
* Даже если задать длительный период, оповещение может часто менять свое состояние с "предупреждение" на "работоспособен" и наоборот. Это может происходить, если значение метрики находится вблизи порогового значения. Для порогового значения не предусмотрен гистерезис: переход из состояния "предупреждение" в состояние "работоспособен" и наоборот происходит при одном и том же значении.

## <a name="what-are-good-alerts-to-set"></a>Какие оповещения следует настраивать
Это зависит от приложения. Прежде всего, лучше не задавать слишком много метрик. Просмотрите диаграммы метрик во время выполнения приложения, чтобы понять, как работает приложение в нормальном режиме. Это поможет найти способы повышения его производительности. Затем настройте оповещения, которые будут предупреждать вас, если метрики превысят пределы обычного режима работы. 

Чаще всего используются следующие оповещения.

* [Метрики браузера][client] (особенно показатель **времени загрузки страницы** браузера) удобно использовать для веб-приложений. Если на странице имеется много сценариев, следует искать **исключения браузера**. Чтобы получить эти метрики и оповещения, необходимо настроить [мониторинг веб-страниц][client].
* **Время ответа сервера** для серверной части веб-приложений. Кроме настройки оповещений следите за этой метрикой, чтобы определить, насколько пропорционально она меняется по мере увеличения частоты запросов, так как изменение может указывать на то, что в приложении заканчиваются ресурсы. 
* **Исключения сервера.** Чтобы отобразить их, необходимо выполнить [дополнительную настройку](app-insights-asp-net-exceptions.md).

Не забывайте, что [упреждающая диагностика частоты сбоев](app-insights-proactive-failure-diagnostics.md) автоматически отслеживает скорость, с которой приложение отвечает на запросы с кодом ошибки. 

## <a name="automation"></a>Автоматизация
* [Использование PowerShell для автоматизации настройки оповещений](app-insights-powershell-alerts.md)
* [Использование объектов webhook для автоматизации реагирования на оповещения](../monitoring-and-diagnostics/insights-webhooks-alerts.md)

## <a name="video"></a>Видео

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player]

## <a name="see-also"></a>См. также
* [Доступность веб-тестов](app-insights-monitor-web-app-availability.md)
* [Автоматическая настройка оповещений](app-insights-powershell-alerts.md)
* [Упреждающая диагностика](app-insights-proactive-diagnostics.md) 

<!--Link references-->

[availability]: app-insights-monitor-web-app-availability.md
[client]: app-insights-javascript.md
[platforms]: app-insights-platforms.md
[roles]: app-insights-resources-roles-access-control.md
[start]: app-insights-overview.md

