---
title: "Мониторинг производительности веб-приложения в Azure Application Insights | Документация Майкрософт"
description: "Как Application Insights встраивается в цикл разработки и операций (DevOps)"
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.assetid: 479522a9-ff5c-471e-a405-b8fa221aedb3
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 03/14/2017
ms.author: bwren
ms.openlocfilehash: de94633cabaa7a1562a5a4839a8a8924da91a283
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="deep-diagnostics-for-web-apps-and-services-with-application-insights"></a><span data-ttu-id="63a38-103">Углубленная диагностика для веб-приложений и служб с помощью Application Insights</span><span class="sxs-lookup"><span data-stu-id="63a38-103">Deep diagnostics for web apps and services with Application Insights</span></span>
## <a name="why-do-i-need-application-insights"></a><span data-ttu-id="63a38-104">Зачем мне Application Insights?</span><span class="sxs-lookup"><span data-stu-id="63a38-104">Why do I need Application Insights?</span></span>
<span data-ttu-id="63a38-105">Служба Application Insights отслеживает работу веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="63a38-105">Application Insights monitors your running web app.</span></span> <span data-ttu-id="63a38-106">Она сообщает о сбоях и проблемах производительности, а также помогает анализировать использование приложения пользователями.</span><span class="sxs-lookup"><span data-stu-id="63a38-106">It tells you about failures and performance issues, and helps you analyze how customers use your app.</span></span> <span data-ttu-id="63a38-107">Она работает с приложениями, выполняемыми на различных платформах (ASP.NET, J2EE, Node.js и др.), и размещается в облаке или локально.</span><span class="sxs-lookup"><span data-stu-id="63a38-107">It works for apps running on many platforms (ASP.NET, J2EE, Node.js, ...) and is hosted either in the Cloud or on-premises.</span></span> 

![Аспекты сложности доставки веб-приложений](./media/app-insights-devops/010.png)

<span data-ttu-id="63a38-109">Очень важно отслеживать процесс выполнения современного приложения.</span><span class="sxs-lookup"><span data-stu-id="63a38-109">It's essential to monitor a modern application while it is running.</span></span> <span data-ttu-id="63a38-110">Самое главное, вам необходимо обнаружить сбои в его работе прежде, чем это сделает большинство ваших клиентов.</span><span class="sxs-lookup"><span data-stu-id="63a38-110">Most importantly, you want to detect failures before most of your customers do.</span></span> <span data-ttu-id="63a38-111">Кроме того, требуется обнаружить и устранить проблемы с производительностью, которые, даже если не являются масштабными, могут привести к замедлению работы или стать причиной неудобств для пользователей.</span><span class="sxs-lookup"><span data-stu-id="63a38-111">You also want to discover and fix performance issues that, while not catastrophic, perhaps slow things down or cause some inconvenience to your users.</span></span> <span data-ttu-id="63a38-112">А когда система работает надлежащим образом, полезно знать, что с ней делают пользователи, используют ли они новейшие функции и</span><span class="sxs-lookup"><span data-stu-id="63a38-112">And when the system is performing to your satisfaction, you want to know what the users are doing with it: Are they using the latest feature?</span></span> <span data-ttu-id="63a38-113">добиваются ли они успеха?</span><span class="sxs-lookup"><span data-stu-id="63a38-113">Are they succeeding with it?</span></span>

<span data-ttu-id="63a38-114">Современные веб-приложения разрабатываются с соблюдением цикла непрерывной поставки: выпуск новой функции или улучшения; наблюдение за тем, как с этим работают пользователи; планирование следующего шага разработки на основе полученных знаний.</span><span class="sxs-lookup"><span data-stu-id="63a38-114">Modern web applications are developed in a cycle of continuous delivery: release a new feature or improvement; observe how well it works for the users; plan the next increment of development based on that knowledge.</span></span> <span data-ttu-id="63a38-115">Ключевой частью этого цикла является этап наблюдения.</span><span class="sxs-lookup"><span data-stu-id="63a38-115">A key part of this cycle is the observation phase.</span></span> <span data-ttu-id="63a38-116">Application Insights предоставляет набор инструментов для отслеживания производительности и использования веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="63a38-116">Application Insights provides the tools to monitor a web application for performance and usage.</span></span>

<span data-ttu-id="63a38-117">В этом процессе наиболее важный аспект — проведение диагностики и постановка диагноза.</span><span class="sxs-lookup"><span data-stu-id="63a38-117">The most important aspect of this process is diagnostics and diagnosis.</span></span> <span data-ttu-id="63a38-118">Если приложение перестает работать, бизнес теряется.</span><span class="sxs-lookup"><span data-stu-id="63a38-118">If the application fails, then business is being lost.</span></span> <span data-ttu-id="63a38-119">Поэтому основная роль функций мониторинга — четко выявить проблему, немедленно сообщить об этом вам и представить всю необходимую информацию для диагностики проблемы.</span><span class="sxs-lookup"><span data-stu-id="63a38-119">The prime role of a monitoring framework is therefore to detect failures reliably, notify you immediately, and to present you with the information needed to diagnose the problem.</span></span> <span data-ttu-id="63a38-120">Именно это и делает Application Insights.</span><span class="sxs-lookup"><span data-stu-id="63a38-120">This is exactly what Application Insights does.</span></span>

### <a name="where-do-bugs-come-from"></a><span data-ttu-id="63a38-121">Откуда берутся ошибки?</span><span class="sxs-lookup"><span data-stu-id="63a38-121">Where do bugs come from?</span></span>
<span data-ttu-id="63a38-122">Ошибки в веб-системах обычно возникают из-за проблем с конфигурацией или из-за нечеткого взаимодействия между многочисленными компонентами.</span><span class="sxs-lookup"><span data-stu-id="63a38-122">Failures in web systems typically arise from configuration issues or bad interactions between their many components.</span></span> <span data-ttu-id="63a38-123">Поэтому первая задача при возникновении инцидента — определение источника (очага) проблемы: какой компонент или какая связь является причиной?</span><span class="sxs-lookup"><span data-stu-id="63a38-123">The first task when tackling a live site incident is therefore to identify the locus of the problem: which component or relationship is the cause?</span></span>

<span data-ttu-id="63a38-124">Некоторые из нас помнят то время, когда компьютерная программа выполнялась на одном компьютере.</span><span class="sxs-lookup"><span data-stu-id="63a38-124">Some of us, those with gray hair, can remember a simpler era in which a computer program ran in one computer.</span></span> <span data-ttu-id="63a38-125">Разработчики тщательно тестировали ее перед сдачей, а затем, после отправки заказчику, практически не вспоминали и не беспокоились о ней.</span><span class="sxs-lookup"><span data-stu-id="63a38-125">The developers would test it thoroughly before shipping it; and having shipped it, would rarely see or think about it again.</span></span> <span data-ttu-id="63a38-126">После этого пользователям приходилось мириться с остаточными ошибками в течение многих лет.</span><span class="sxs-lookup"><span data-stu-id="63a38-126">The users would have to put up with the residual bugs for many years.</span></span> 

<span data-ttu-id="63a38-127">В наши дни все по-другому.</span><span class="sxs-lookup"><span data-stu-id="63a38-127">Things are so very different now.</span></span> <span data-ttu-id="63a38-128">Теперь приложение должно работать с множеством различных устройств, и сложно гарантировать, что оно будет вести себя одинаково на каждом из них.</span><span class="sxs-lookup"><span data-stu-id="63a38-128">Your app has a plethora of different devices to run on, and it can be difficult to guarantee the exact same behavior on each one.</span></span> <span data-ttu-id="63a38-129">Размещение приложений в облаке позволяет быстро исправлять ошибки, но это также означает постоянную конкуренцию и ожидание новых функций, которые должны появляться через короткие промежутки времени.</span><span class="sxs-lookup"><span data-stu-id="63a38-129">Hosting apps in the cloud means bugs can be fixed fast, but it also means continuous competition and the expectation of new features at frequent intervals.</span></span> 

<span data-ttu-id="63a38-130">В этих условиях единственным способом четкого контроля над количеством ошибок является автоматизированное модульное тестирование.</span><span class="sxs-lookup"><span data-stu-id="63a38-130">In these conditions, the only way to keep a firm control on the bug count is automated unit testing.</span></span> <span data-ttu-id="63a38-131">Невозможно все перепроверить вручную при каждой поставке.</span><span class="sxs-lookup"><span data-stu-id="63a38-131">It would be impossible to manually re-test everything on every delivery.</span></span> <span data-ttu-id="63a38-132">Модульное тестирование теперь является обычной частью процесса сборки приложения.</span><span class="sxs-lookup"><span data-stu-id="63a38-132">Unit test is now a commonplace part of the build process.</span></span> <span data-ttu-id="63a38-133">Инструменты, такие как Xamarin Test Cloud, выполняют автоматизированное тестирование пользовательского интерфейса на нескольких версиях браузеров.</span><span class="sxs-lookup"><span data-stu-id="63a38-133">Tools such as the Xamarin Test Cloud help by providing automated UI testing on multiple browser versions.</span></span> <span data-ttu-id="63a38-134">Эти режимы тестирования позволяют надеяться, что число ошибок, обнаруженных в приложении, будет сведено к минимуму.</span><span class="sxs-lookup"><span data-stu-id="63a38-134">These testing regimes allow us to hope that the rate of bugs found inside an app can be kept to a minimum.</span></span>

<span data-ttu-id="63a38-135">Обычные веб-приложения содержат множество динамических компонентов.</span><span class="sxs-lookup"><span data-stu-id="63a38-135">Typical web applications have many live components.</span></span> <span data-ttu-id="63a38-136">Кроме клиента (в браузере или приложении для устройства) и веб-сервера, возможна также основательная обработка в серверной части.</span><span class="sxs-lookup"><span data-stu-id="63a38-136">In addition to the client (in a browser or device app) and the web server, there's likely to be substantial backend processing.</span></span> <span data-ttu-id="63a38-137">Вероятно, серверная часть является конвейером компонентов или коллекцией взаимодействующих элементов, связанных между собой в меньшей степени.</span><span class="sxs-lookup"><span data-stu-id="63a38-137">Perhaps the backend is a pipeline of components, or a looser collection of collaborating pieces.</span></span> <span data-ttu-id="63a38-138">И многие из них вы не сможете контролировать, так как это внешние службы, от которых вы зависите.</span><span class="sxs-lookup"><span data-stu-id="63a38-138">And many of them won't be in your control - they're external services on which you depend.</span></span>

<span data-ttu-id="63a38-139">В подобных конфигурациях может быть сложно и экономически невыгодно выполнять тестирование или прогнозировать все возможные режимы сбоя не в самой действующей системе.</span><span class="sxs-lookup"><span data-stu-id="63a38-139">In configurations like these, it can be difficult and uneconomical to test for, or foresee, every possible failure mode, other than in the live system itself.</span></span> 

### <a name="questions-"></a><span data-ttu-id="63a38-140">Вопросы...</span><span class="sxs-lookup"><span data-stu-id="63a38-140">Questions ...</span></span>
<span data-ttu-id="63a38-141">Некоторые вопросы возникают при разработке веб-системы.</span><span class="sxs-lookup"><span data-stu-id="63a38-141">Some questions we ask when we're developing a web system:</span></span>

* <span data-ttu-id="63a38-142">В моем приложении происходит аварийное завершение работы?</span><span class="sxs-lookup"><span data-stu-id="63a38-142">Is my app crashing?</span></span> 
* <span data-ttu-id="63a38-143">Что именно произошло?</span><span class="sxs-lookup"><span data-stu-id="63a38-143">What exactly happened?</span></span> <span data-ttu-id="63a38-144">— Если не удалось выполнить запрос, необходимо знать, как это случилось.</span><span class="sxs-lookup"><span data-stu-id="63a38-144">- If it failed a request, I want to know how it got there.</span></span> <span data-ttu-id="63a38-145">Нам нужно отследить последовательность событий...</span><span class="sxs-lookup"><span data-stu-id="63a38-145">We need a trace of events...</span></span>
* <span data-ttu-id="63a38-146">Мое приложение достаточно быстро работает?</span><span class="sxs-lookup"><span data-stu-id="63a38-146">Is my app fast enough?</span></span> <span data-ttu-id="63a38-147">Сколько времени требуется для ответа на стандартный запрос?</span><span class="sxs-lookup"><span data-stu-id="63a38-147">How long does it take to respond to typical requests?</span></span>
* <span data-ttu-id="63a38-148">Может ли сервер справиться с нагрузкой?</span><span class="sxs-lookup"><span data-stu-id="63a38-148">Can the server handle the load?</span></span> <span data-ttu-id="63a38-149">Когда частота запросов возрастет, будет ли время отклика стабильным?</span><span class="sxs-lookup"><span data-stu-id="63a38-149">When the rate of requests rises, does the response time hold steady?</span></span>
* <span data-ttu-id="63a38-150">Насколько быстро отвечают на запросы мои зависимости — интерфейсы REST API, базы данных и другие компоненты, вызываемые приложением?</span><span class="sxs-lookup"><span data-stu-id="63a38-150">How responsive are my dependencies - the REST APIs, databases and other components that my app calls.</span></span> <span data-ttu-id="63a38-151">В частности, если система работает медленно, это из-за моего компонента, или я получаю медленные ответы от кого-то другого?</span><span class="sxs-lookup"><span data-stu-id="63a38-151">In particular, if the system is slow, is it my component, or am I getting slow responses from someone else?</span></span>
* <span data-ttu-id="63a38-152">Работает мое приложение или нет?</span><span class="sxs-lookup"><span data-stu-id="63a38-152">Is my app Up or Down?</span></span> <span data-ttu-id="63a38-153">Его видно из других частей мира?</span><span class="sxs-lookup"><span data-stu-id="63a38-153">Can it be seen from around the world?</span></span> <span data-ttu-id="63a38-154">Сообщите мне, если оно остановится...</span><span class="sxs-lookup"><span data-stu-id="63a38-154">Let me know if it stops....</span></span>
* <span data-ttu-id="63a38-155">Что является основной причиной?</span><span class="sxs-lookup"><span data-stu-id="63a38-155">What is the root cause?</span></span> <span data-ttu-id="63a38-156">Сбой произошел в моем компоненте или в зависимости?</span><span class="sxs-lookup"><span data-stu-id="63a38-156">Was the failure in my component or a dependency?</span></span> <span data-ttu-id="63a38-157">Это проблема связи?</span><span class="sxs-lookup"><span data-stu-id="63a38-157">Is it a communication issue?</span></span>
* <span data-ttu-id="63a38-158">Сколько пользователей было затронуто?</span><span class="sxs-lookup"><span data-stu-id="63a38-158">How many users are impacted?</span></span> <span data-ttu-id="63a38-159">Если необходимо решить несколько проблем, какая из них наиболее критична?</span><span class="sxs-lookup"><span data-stu-id="63a38-159">If I have more than one issue to tackle, which is the most important?</span></span>

## <a name="what-is-application-insights"></a><span data-ttu-id="63a38-160">Что такое Azure Application Insights?</span><span class="sxs-lookup"><span data-stu-id="63a38-160">What is Application Insights?</span></span>
![Базовый рабочий процесс Application Insights](./media/app-insights-devops/020.png)

1. <span data-ttu-id="63a38-162">Application Insights снабжает ваше приложение инструментами и отправляет данные телеметрии во время выполнения приложения.</span><span class="sxs-lookup"><span data-stu-id="63a38-162">Application Insights instruments your app and sends telemetry about it while the app is running.</span></span> <span data-ttu-id="63a38-163">Либо встройте пакет SDK Application Insights в приложение, либо применяйте его инструменты во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="63a38-163">Either you can build the Application Insights SDK into the app, or you can apply instrumentation at runtime.</span></span> <span data-ttu-id="63a38-164">Первый метод является более гибким, так как вы можете добавлять собственную телеметрию в стандартные модули.</span><span class="sxs-lookup"><span data-stu-id="63a38-164">The former method is more flexible, as you can add your own telemetry to the regular modules.</span></span>
2. <span data-ttu-id="63a38-165">Данные телеметрии отправляются на портал Application Insights, где они сохраняются и обрабатываются.</span><span class="sxs-lookup"><span data-stu-id="63a38-165">The telemetry is sent to the Application Insights portal, where it is stored and processed.</span></span> <span data-ttu-id="63a38-166">(Несмотря на то, что служба Application Insights размещается в Microsoft Azure, она позволяет отслеживать любые веб-приложения, а не только приложения Azure.)</span><span class="sxs-lookup"><span data-stu-id="63a38-166">(Although Application Insights is hosted in Microsoft Azure, it can monitor any web apps - not just Azure apps.)</span></span>
3. <span data-ttu-id="63a38-167">Данные телеметрии представляются в виде диаграмм и таблиц событий.</span><span class="sxs-lookup"><span data-stu-id="63a38-167">The telemetry is presented to you in the form of charts and tables of events.</span></span>

<span data-ttu-id="63a38-168">Существует два основных типа телеметрии: статистически обработанные и необработанные экземпляры.</span><span class="sxs-lookup"><span data-stu-id="63a38-168">There are two main types of telemetry: aggregated and raw instances.</span></span> 

* <span data-ttu-id="63a38-169">Данные экземпляра включают в себя, например, отчет о запросе, который был получен веб-приложением.</span><span class="sxs-lookup"><span data-stu-id="63a38-169">Instance data includes, for example, a report of a request that has been received by your web app.</span></span> <span data-ttu-id="63a38-170">С помощью инструмента поиска на портале Application Insights можно найти и просмотреть сведения о запросе.</span><span class="sxs-lookup"><span data-stu-id="63a38-170">You can find for and inspect the details of a request using the Search tool in the Application Insights portal.</span></span> <span data-ttu-id="63a38-171">Экземпляр содержит следующие данные: сколько времени потребовалось приложению для ответа на запрос, запрашиваемый URL-адрес, приблизительное расположение клиента и другие.</span><span class="sxs-lookup"><span data-stu-id="63a38-171">The instance would include data such as how long your app took to respond to the request, as well as the requested URL, approximate location of the client, and other data.</span></span>
* <span data-ttu-id="63a38-172">Статистически обработанные данные включают в себя количество событий за единицу времени, что позволяет сравнить частоту запросов со временем откликов.</span><span class="sxs-lookup"><span data-stu-id="63a38-172">Aggregated data includes counts of events per unit time, so that you can compare the rate of requests with the response times.</span></span> <span data-ttu-id="63a38-173">Они также содержат средние значения метрик, таких как время отклика на запрос.</span><span class="sxs-lookup"><span data-stu-id="63a38-173">It also includes averages of metrics such as request response times.</span></span>

<span data-ttu-id="63a38-174">Вот основные категории данных.</span><span class="sxs-lookup"><span data-stu-id="63a38-174">The main categories of data are:</span></span>

* <span data-ttu-id="63a38-175">Запросы к приложению (обычно HTTP-запросы) с данными URL-адреса, временем отклика и результатом (успешный или неудачный).</span><span class="sxs-lookup"><span data-stu-id="63a38-175">Requests to your app (usually HTTP requests), with data on URL, response time, and success or failure.</span></span>
* <span data-ttu-id="63a38-176">Зависимости — вызовы REST и SQL, совершенные приложением, а также данные URI, время отклика и результат (успешный или неудачный).</span><span class="sxs-lookup"><span data-stu-id="63a38-176">Dependencies - REST and SQL calls made by your app, also with URI, response times and success</span></span>
* <span data-ttu-id="63a38-177">Исключения, включая трассировки стека.</span><span class="sxs-lookup"><span data-stu-id="63a38-177">Exceptions, including stack traces.</span></span>
* <span data-ttu-id="63a38-178">Данные о просмотре страниц, которые поступают из браузеров пользователей.</span><span class="sxs-lookup"><span data-stu-id="63a38-178">Page view data, which come from the users' browsers.</span></span>
* <span data-ttu-id="63a38-179">Метрики, такие как счетчики производительности, а также созданные вами метрики.</span><span class="sxs-lookup"><span data-stu-id="63a38-179">Metrics such as performance counters, as well as metrics you write yourself.</span></span> 
* <span data-ttu-id="63a38-180">Пользовательские события, которые можно использовать для отслеживания бизнес-событий.</span><span class="sxs-lookup"><span data-stu-id="63a38-180">Custom events that you can use to track business events</span></span>
* <span data-ttu-id="63a38-181">Трассировки журналов, используемые для отладки.</span><span class="sxs-lookup"><span data-stu-id="63a38-181">Log traces used for debugging.</span></span>

## <a name="case-study-real-madrid-fc"></a><span data-ttu-id="63a38-182">Пример использования: футбольный клуб "Реал" (Мадрид)</span><span class="sxs-lookup"><span data-stu-id="63a38-182">Case Study: Real Madrid F.C.</span></span>
<span data-ttu-id="63a38-183">Веб-служба [футбольного клуба "Реал" (Мадрид)](http://www.realmadrid.com/) обслуживает около 450 миллионов болельщиков по всему миру.</span><span class="sxs-lookup"><span data-stu-id="63a38-183">The web service of [Real Madrid Football Club](http://www.realmadrid.com/) serves about 450 million fans around the world.</span></span> <span data-ttu-id="63a38-184">Болельщики получают к нему доступ как через веб-браузеры, так и через мобильные приложения, предлагаемые клубом.</span><span class="sxs-lookup"><span data-stu-id="63a38-184">Fans access it both through web browsers and the Club's mobile apps.</span></span> <span data-ttu-id="63a38-185">Они могут не только бронировать билеты, но и имеют доступ к видеоматериалам, результатам игр, сведениям об игроках и следующих матчах.</span><span class="sxs-lookup"><span data-stu-id="63a38-185">Fans can not only book tickets, but also access information and video clips on results, players and upcoming games.</span></span> <span data-ttu-id="63a38-186">При поиске можно использовать фильтры, например по количеству забитых голов.</span><span class="sxs-lookup"><span data-stu-id="63a38-186">They can search with filters such as numbers of goals scored.</span></span> <span data-ttu-id="63a38-187">Также имеются ссылки на социальные сети.</span><span class="sxs-lookup"><span data-stu-id="63a38-187">There are also links to social media.</span></span> <span data-ttu-id="63a38-188">Взаимодействие с пользователем очень персонализировано и разработано как двусторонний обмен данными, что очень привлекает болельщиков.</span><span class="sxs-lookup"><span data-stu-id="63a38-188">The user experience is highly personalized, and is designed as a two-way communication to engage fans.</span></span>

<span data-ttu-id="63a38-189">Используемое решение — [это система служб и приложений на платформе Microsoft Azure](https://www.microsoft.com/en-us/enterprise/microsoftcloud/realmadrid.aspx).</span><span class="sxs-lookup"><span data-stu-id="63a38-189">The solution [is a system of services and applications on Microsoft Azure](https://www.microsoft.com/en-us/enterprise/microsoftcloud/realmadrid.aspx).</span></span> <span data-ttu-id="63a38-190">Масштабируемость является ключевым требованием: объем трафика переменчив и может особенно возрастать во время матчей, а также до и после матчей.</span><span class="sxs-lookup"><span data-stu-id="63a38-190">Scalability is a key requirement: traffic is variable and can reach very high volumes during and around matches.</span></span>

<span data-ttu-id="63a38-191">Для клуба "Реал" (Мадрид) крайне важно отслеживать производительность системы.</span><span class="sxs-lookup"><span data-stu-id="63a38-191">For Real Madrid, it's vital to monitor the system's performance.</span></span> <span data-ttu-id="63a38-192">Azure Application Insights предоставляет всесторонний обзор системы, обеспечивая надежную работу и высокий уровень обслуживания.</span><span class="sxs-lookup"><span data-stu-id="63a38-192">Azure Application Insights provides a comprehensive view across the system, ensuring a reliable and high level of service.</span></span> 

<span data-ttu-id="63a38-193">Клуб также получает полезные сведения о своих болельщиках, чтобы хорошо понимать их потребности: откуда они (всего 3 % болельщиков находится в Испании), что им интересно знать об игроках, исторические результаты и будущие матчи, а также их реакция на результаты завершившихся матчей.</span><span class="sxs-lookup"><span data-stu-id="63a38-193">The Club also gets in-depth understanding of its fans: where they are (only 3% are in Spain), what interest they have in players, historical results, and upcoming games, and how they respond to match outcomes.</span></span>

<span data-ttu-id="63a38-194">Большая часть этих данных телеметрии собирается автоматически и не требует добавления кода, что упрощает решение и оптимизирует его эксплуатацию.</span><span class="sxs-lookup"><span data-stu-id="63a38-194">Most of this telemetry data is automatically collected with no added code, which  simplified the solution and reduced operational complexity.</span></span>  <span data-ttu-id="63a38-195">Для клуба "Реал" (Мадрид) Application Insights ежемесячно обрабатывает 3,8 миллиарда точек телеметрических данных.</span><span class="sxs-lookup"><span data-stu-id="63a38-195">For Real Madrid, Application Insights deals with 3.8 billion telemetry points each month.</span></span>

<span data-ttu-id="63a38-196">Для просмотра своих данных телеметрии клуб использует модуль Power BI.</span><span class="sxs-lookup"><span data-stu-id="63a38-196">Real Madrid uses the Power BI module to view their telemetry.</span></span>

![Представление телеметрии Application Insights в Power BI](./media/app-insights-devops/080.png)

## <a name="smart-detection"></a><span data-ttu-id="63a38-198">Интеллектуальное обнаружение</span><span class="sxs-lookup"><span data-stu-id="63a38-198">Smart detection</span></span>
<span data-ttu-id="63a38-199">[Упреждающая диагностика](app-insights-proactive-diagnostics.md) — это одна из новых функций.</span><span class="sxs-lookup"><span data-stu-id="63a38-199">[Proactive diagnostics](app-insights-proactive-diagnostics.md) is a recent feature.</span></span> <span data-ttu-id="63a38-200">Без каких-либо специальных настроек Application Insights автоматически обнаруживает необычное возрастание числа сбоев в приложении и оповещает вас о нем.</span><span class="sxs-lookup"><span data-stu-id="63a38-200">Without any special configuration by you, Application Insights automatically detects and alerts you about unusual rises in failure rates in your app.</span></span> <span data-ttu-id="63a38-201">Она достаточно умна, чтобы пропускать фоновые случайные сбои, а также простое пропорциональное возрастание, вызванное ростом числа запросов.</span><span class="sxs-lookup"><span data-stu-id="63a38-201">It's smart enough to ignore a background of occasional failures, and also rises that are simply proportionate to a rise in requests.</span></span> <span data-ttu-id="63a38-202">Например, если в одной из служб, от которых зависит ваша работа, происходит сбой, или если только что развернутая новая сборка не работает надлежащим образом, вы узнаете об этом, как только проверите свою электронную почту.</span><span class="sxs-lookup"><span data-stu-id="63a38-202">So for example, if there's a failure in one of the services you depend on, or if the new build you just deployed isn't working so well, then you'll know about it as soon as you look at your email.</span></span> <span data-ttu-id="63a38-203">(Также есть веб-перехватчики, которые позволяют приводить в действие другие приложения.)</span><span class="sxs-lookup"><span data-stu-id="63a38-203">(And there are webhooks so that you can trigger other apps.)</span></span>

<span data-ttu-id="63a38-204">Другим аспектом этой функции является выполнение ежедневного глубокого анализа телеметрии и поиск необычных отклонений показателей производительности, которые трудно обнаружить.</span><span class="sxs-lookup"><span data-stu-id="63a38-204">Another aspect of this feature performs a daily in-depth analysis of your telemetry, looking for unusual patterns of performance that are hard to discover.</span></span> <span data-ttu-id="63a38-205">Например, она может выявить снижение производительности в определенном географическом регионе или в отдельной версии браузера.</span><span class="sxs-lookup"><span data-stu-id="63a38-205">For example, it can find slow performance associated with a particular geographical area, or with a particular browser version.</span></span>

<span data-ttu-id="63a38-206">В обоих случаях вы получите оповещение, в котором будут содержаться не только обнаруженные симптомы, но и данные, необходимые для диагностики проблемы, такие как соответствующие отчеты об исключениях.</span><span class="sxs-lookup"><span data-stu-id="63a38-206">In both cases, the alert not only tells you the symptoms it's discovered, but also gives you data you need to help diagnose the problem, such as relevant exception reports.</span></span>

![Сообщение электронной почты от компонента упреждающей диагностики](./media/app-insights-devops/030.png)

<span data-ttu-id="63a38-208">Пользователь Samtec сообщил следующее: "Во время последнего переключения функции мы выявили базу данных с некорректным масштабированием, в которой достигались ограничения ресурсов, вызывая превышение времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="63a38-208">Customer Samtec said: "During a recent feature cutover, we found an under-scaled database that was hitting its resource limits and causing timeouts.</span></span> <span data-ttu-id="63a38-209">Оповещение упреждающего обнаружения пришло буквально в тот момент, когда мы столкнулись с этой проблемой, очень близко к реальному времени, как и было заявлено.</span><span class="sxs-lookup"><span data-stu-id="63a38-209">Proactive detection alerts came through literally as we were triaging the issue, very near real time as advertised.</span></span> <span data-ttu-id="63a38-210">Это оповещение, которое сопровождалось оповещениями платформы Azure, помогло нам устранить проблему практически мгновенно.</span><span class="sxs-lookup"><span data-stu-id="63a38-210">This alert coupled with the Azure platform alerts helped us almost instantly fix the issue.</span></span> <span data-ttu-id="63a38-211">Общее время простоя — не более 10 минут".</span><span class="sxs-lookup"><span data-stu-id="63a38-211">Total downtime < 10 minutes."</span></span>

## <a name="live-metrics-stream"></a><span data-ttu-id="63a38-212">Динамический поток метрик</span><span class="sxs-lookup"><span data-stu-id="63a38-212">Live Metrics Stream</span></span>
<span data-ttu-id="63a38-213">Развертывание последней сборки может быть любопытным процессом.</span><span class="sxs-lookup"><span data-stu-id="63a38-213">Deploying the latest build can be an anxious experience.</span></span> <span data-ttu-id="63a38-214">Если возникнут проблемы, необходимо знать о них немедленно, чтобы была возможность при необходимости вернуться на шаг назад.</span><span class="sxs-lookup"><span data-stu-id="63a38-214">If there are any problems, you want to know about them right away, so that you can back out if necessary.</span></span> <span data-ttu-id="63a38-215">Динамический поток метрик предоставляет ключевые данные метрик с задержкой около одной секунды.</span><span class="sxs-lookup"><span data-stu-id="63a38-215">Live Metrics Stream gives you key metrics with a latency of about one second.</span></span>

![Динамические метрики](./media/app-insights-devops/040.png)

<span data-ttu-id="63a38-217">Кроме того, решение позволяет незамедлительно проверить образец любых ошибок или исключений.</span><span class="sxs-lookup"><span data-stu-id="63a38-217">And lets you immediately inspect a sample of any failures or exceptions.</span></span>

![Динамические события сбоев](./media/app-insights-devops/live-stream-failures.png)

## <a name="application-map"></a><span data-ttu-id="63a38-219">Схема сопоставления приложений</span><span class="sxs-lookup"><span data-stu-id="63a38-219">Application Map</span></span>
<span data-ttu-id="63a38-220">Схема сопоставления приложений автоматически определяет топологию приложения, размещая в верхней части сведения о производительности, чтобы было легче определить узкие места производительности и проблемные потоки в распределенной среде.</span><span class="sxs-lookup"><span data-stu-id="63a38-220">Application Map automatically discovers your application topology, laying the performance information on top of it, to let you easily identify performance bottlenecks and problematic flows across your distributed environment.</span></span> <span data-ttu-id="63a38-221">Она позволяет обнаружить зависимости приложений в службах Azure.</span><span class="sxs-lookup"><span data-stu-id="63a38-221">It allows you to discover application dependencies on Azure Services.</span></span> <span data-ttu-id="63a38-222">Можно рассмотреть проблему и понять, связана она с кодом или с зависимостями. Затем можно централизованно получить детальную информацию и соответствующие результаты диагностики.</span><span class="sxs-lookup"><span data-stu-id="63a38-222">You can triage the problem by understanding if it is code-related or dependency related and from a single place drill into related diagnostics experience.</span></span> <span data-ttu-id="63a38-223">Например, в приложения может происходить сбой из-за снижения производительности на уровне SQL.</span><span class="sxs-lookup"><span data-stu-id="63a38-223">For example, your application may be failing due to performance degradation in SQL tier.</span></span> <span data-ttu-id="63a38-224">С помощью схемы сопоставления приложений вы можете сразу это увидеть и перейти в помощник по построению индексов SQL или просмотреть подробные сведения о запросе.</span><span class="sxs-lookup"><span data-stu-id="63a38-224">With application map, you can see it immediately and drill into the SQL Index Advisor or Query Insights experience.</span></span>

![Схема сопоставления приложений](./media/app-insights-devops/050.png)

## <a name="application-insights-analytics"></a><span data-ttu-id="63a38-226">Аналитика Application Insights</span><span class="sxs-lookup"><span data-stu-id="63a38-226">Application Insights Analytics</span></span>
<span data-ttu-id="63a38-227">Используя [аналитику](app-insights-analytics.md), можно создавать произвольные запросы с помощью мощного языка, подобного SQL.</span><span class="sxs-lookup"><span data-stu-id="63a38-227">With [Analytics](app-insights-analytics.md), you can write arbitrary queries in a powerful SQL-like language.</span></span>  <span data-ttu-id="63a38-228">Выполнение диагностики по всему стеку приложений становится простым процессом, так как аналитика объединяет различные ракурсы и позволяет задавать правильные вопросы для сопоставления производительности служб с бизнес-метриками и качеством обслуживания.</span><span class="sxs-lookup"><span data-stu-id="63a38-228">Diagnosing across the entire app stack becomes easy as various perspectives get connected and you can ask the right questions to correlate Service Performance with Business Metrics and Customer Experience.</span></span> 

<span data-ttu-id="63a38-229">Можно запросить любые необработанные данные экземпляра телеметрии и метрик, хранящиеся на портале.</span><span class="sxs-lookup"><span data-stu-id="63a38-229">You can query all your telemetry instance and metric raw data stored in the portal.</span></span> <span data-ttu-id="63a38-230">Язык поддерживает фильтрацию, объединение, агрегирование и другие операции.</span><span class="sxs-lookup"><span data-stu-id="63a38-230">The language includes filter, join, aggregation, and other operations.</span></span> <span data-ttu-id="63a38-231">Можно выполнять вычисление полей и статистический анализ.</span><span class="sxs-lookup"><span data-stu-id="63a38-231">You can calculate fields and perform statistical analysis.</span></span> <span data-ttu-id="63a38-232">Имеются как табличные, так и графические визуализации.</span><span class="sxs-lookup"><span data-stu-id="63a38-232">There are both tabular and graphical visualizations.</span></span>

![Запрос аналитики и диаграмма результатов](./media/app-insights-devops/025.png)

<span data-ttu-id="63a38-234">Например, можно с легкостью выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="63a38-234">For example, it's easy to:</span></span>

* <span data-ttu-id="63a38-235">Разбить на сегменты данные о производительности запросов приложения по уровням пользователей для лучшего понимания процесса.</span><span class="sxs-lookup"><span data-stu-id="63a38-235">Segment your application’s request performance data by customer tiers to understand their experience.</span></span>
* <span data-ttu-id="63a38-236">Найти конкретные коды ошибок или имена пользовательских событий, исследуя рабочие сайты.</span><span class="sxs-lookup"><span data-stu-id="63a38-236">Search for specific error codes or custom event names during live site investigations.</span></span>
* <span data-ttu-id="63a38-237">Выполнить детализацию использования приложения конкретными пользователями, чтобы понять, как происходит получение и внедрение функций.</span><span class="sxs-lookup"><span data-stu-id="63a38-237">Drill down into the app usage of specific customers to understand how features are acquired and adopted.</span></span>
* <span data-ttu-id="63a38-238">Отследить длительность сеансов и время отклика для определенных пользователей, что позволяет службе поддержки и операционной группе оказывать немедленную помощь пользователям.</span><span class="sxs-lookup"><span data-stu-id="63a38-238">Track sessions and response times for specific users to enable support and operations teams to provide instant customer support.</span></span>
* <span data-ttu-id="63a38-239">Определить часто используемые функции приложения, чтобы правильно выполнить расстановку приоритетов для компонентов.</span><span class="sxs-lookup"><span data-stu-id="63a38-239">Determine frequently used app features to answer feature prioritization questions.</span></span>

<span data-ttu-id="63a38-240">Пользователь DNN сообщил следующее: "Благодаря Application Insights мы получили недостающую часть уравнения и теперь можем комбинировать, сортировать, запрашивать и фильтровать данные так, как нам требуется.</span><span class="sxs-lookup"><span data-stu-id="63a38-240">Customer DNN said: "Application Insights has provided us with the missing part of the equation for being able to combine, sort, query, and filter data as needed.</span></span> <span data-ttu-id="63a38-241">Это дает нашей команде возможность полагаться на собственную изобретательность и опыт при поиске данных. А мощный язык запросов позволяет нам получать подробные сведения и решать проблемы, о которых мы раньше даже не знали.</span><span class="sxs-lookup"><span data-stu-id="63a38-241">Allowing our team to use their own ingenuity and experience to find data with a powerful query language has allowed us to find insights and solve problems we didn't even know we had.</span></span> <span data-ttu-id="63a38-242">Много интересных решений появляются во время поиска ответов на вопросы, которые начинаются с *Интересно знать...*.</span><span class="sxs-lookup"><span data-stu-id="63a38-242">A lot of interesting answers come from the questions starting with *'I wonder if...'.*"</span></span>

## <a name="development-tools-integration"></a><span data-ttu-id="63a38-243">Интеграция средств разработки</span><span class="sxs-lookup"><span data-stu-id="63a38-243">Development tools integration</span></span>
### <a name="configuring-application-insights"></a><span data-ttu-id="63a38-244">Настройка Application Insights</span><span class="sxs-lookup"><span data-stu-id="63a38-244">Configuring Application Insights</span></span>
<span data-ttu-id="63a38-245">Visual Studio и Eclipse оснащены инструментами для настройки правильных пакетов SDK для разрабатываемого проекта.</span><span class="sxs-lookup"><span data-stu-id="63a38-245">Visual Studio and Eclipse have tools to configure the correct SDK packages for the project you are developing.</span></span> <span data-ttu-id="63a38-246">Есть и команда меню, которая позволяет добавить Application Insights.</span><span class="sxs-lookup"><span data-stu-id="63a38-246">There's a menu command to add Application Insights.</span></span>

<span data-ttu-id="63a38-247">Если используется платформа ведения журналов трассировки, например Log4N, NLog или System.Diagnostics.Trace, у вас будет возможность отправлять журналы в Application Insights вместе с другими данными телеметрии. Таким образом, вы сможете легко сопоставлять данные трассировки с запросами, вызовами зависимостей и исключениями.</span><span class="sxs-lookup"><span data-stu-id="63a38-247">If you happen to be using a trace logging framework such as Log4N, NLog, or System.Diagnostics.Trace, then you get the option to send the logs to Application Insights along with the other telemetry, so that you can easily correlate the traces with requests, dependency calls, and exceptions.</span></span>

### <a name="search-telemetry-in-visual-studio"></a><span data-ttu-id="63a38-248">Поиск данных телеметрии в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="63a38-248">Search telemetry in Visual Studio</span></span>
<span data-ttu-id="63a38-249">В процессе разработки и отладки функции можно просматривать и выполнять поиск данных телеметрии непосредственно в Visual Studio, используя те же средства поиска, что и веб-портал.</span><span class="sxs-lookup"><span data-stu-id="63a38-249">While developing and debugging a feature, you can view and search the telemetry directly in Visual Studio, using the same search facilities as in the web portal.</span></span>

<span data-ttu-id="63a38-250">И когда Application Insights регистрирует исключение, можно просмотреть точку данных в Visual Studio и сразу перейти к соответствующему коду.</span><span class="sxs-lookup"><span data-stu-id="63a38-250">And when Application Insights logs an exception, you can view the data point in Visual Studio and jump straight to the relevant code.</span></span>

![Поиск в Visual Studio](./media/app-insights-devops/060.png)

<span data-ttu-id="63a38-252">Во время отладки у вас есть возможность сохранять данные телеметрии на компьютере разработки, просматривая их в Visual Studio, но не отправляя на портал.</span><span class="sxs-lookup"><span data-stu-id="63a38-252">During debugging, you have the option to keep the telemetry in your development machine, viewing it in Visual Studio but without sending it to the portal.</span></span> <span data-ttu-id="63a38-253">Этот локальный параметр позволяет не смешивать отладку с рабочей телеметрией.</span><span class="sxs-lookup"><span data-stu-id="63a38-253">This local option avoids mixing debugging with production telemetry.</span></span>

### <a name="build-annotations"></a><span data-ttu-id="63a38-254">Аннотации к сборке</span><span class="sxs-lookup"><span data-stu-id="63a38-254">Build annotations</span></span>
<span data-ttu-id="63a38-255">При использовании Visual Studio Team Services для сборки и развертывания приложения на диаграммах, просматриваемых на портале, отображаются заметки к развертыванию.</span><span class="sxs-lookup"><span data-stu-id="63a38-255">If you use Visual Studio Team Services to build and deploy your app, deployment annotations show up on charts in the portal.</span></span> <span data-ttu-id="63a38-256">Если последний выпуск оказал какое-либо влияние на метрики, это будет заметно.</span><span class="sxs-lookup"><span data-stu-id="63a38-256">If your latest release had any effect on the metrics, it becomes obvious.</span></span>

![Аннотации к сборке](./media/app-insights-devops/070.png)

### <a name="work-items"></a><span data-ttu-id="63a38-258">Рабочие элементы</span><span class="sxs-lookup"><span data-stu-id="63a38-258">Work items</span></span>
<span data-ttu-id="63a38-259">При появлении оповещения Application Insights может автоматически создавать в системе отслеживания работы рабочий элемент.</span><span class="sxs-lookup"><span data-stu-id="63a38-259">When an alert is raised, Application Insights can automatically create a work item in your work tracking system.</span></span>

## <a name="but-what-about"></a><span data-ttu-id="63a38-260">А как насчет...?</span><span class="sxs-lookup"><span data-stu-id="63a38-260">But what about...?</span></span>
* <span data-ttu-id="63a38-261">[Конфиденциальность и хранение](app-insights-data-retention-privacy.md) — данные телеметрии хранятся на защищенных серверах Azure.</span><span class="sxs-lookup"><span data-stu-id="63a38-261">[Privacy and storage](app-insights-data-retention-privacy.md) - Your telemetry is kept on Azure secure servers.</span></span>
* <span data-ttu-id="63a38-262">Производительность — влияние очень незначительно.</span><span class="sxs-lookup"><span data-stu-id="63a38-262">Performance - the impact is very low.</span></span> <span data-ttu-id="63a38-263">Данные телеметрии передаются в пакетном режиме.</span><span class="sxs-lookup"><span data-stu-id="63a38-263">Telemetry is batched.</span></span>
* <span data-ttu-id="63a38-264">[Цены](app-insights-pricing.md) — начать работу можно бесплатно, и при небольших объемах такой режим сохраняется.</span><span class="sxs-lookup"><span data-stu-id="63a38-264">[Pricing](app-insights-pricing.md) - You can get started for free, and that continues while you're in low volume.</span></span>


## <a name="video"></a><span data-ttu-id="63a38-265">Видео</span><span class="sxs-lookup"><span data-stu-id="63a38-265">Video</span></span>

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player]

## <a name="next-steps"></a><span data-ttu-id="63a38-266">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="63a38-266">Next steps</span></span>
<span data-ttu-id="63a38-267">Начать работу с Application Insights легко.</span><span class="sxs-lookup"><span data-stu-id="63a38-267">Getting started with Application Insights is easy.</span></span> <span data-ttu-id="63a38-268">Ниже перечислены основные возможности.</span><span class="sxs-lookup"><span data-stu-id="63a38-268">The main options are:</span></span>

* <span data-ttu-id="63a38-269">Инструментирование уже работающего веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="63a38-269">Instrument an already-running web app.</span></span> <span data-ttu-id="63a38-270">При этом вы получаете всю встроенную телеметрию производительности.</span><span class="sxs-lookup"><span data-stu-id="63a38-270">This gives you all the built-in performance telemetry.</span></span> <span data-ttu-id="63a38-271">Эта функция доступна для [Java](app-insights-java-live.md) и [серверов IIS](app-insights-monitor-performance-live-website-now.md), а также для [веб-приложений Azure](app-insights-azure.md).</span><span class="sxs-lookup"><span data-stu-id="63a38-271">It's available for [Java](app-insights-java-live.md) and [IIS servers](app-insights-monitor-performance-live-website-now.md), and also for [Azure web apps](app-insights-azure.md).</span></span>
* <span data-ttu-id="63a38-272">Инструментирование проекта во время разработки.</span><span class="sxs-lookup"><span data-stu-id="63a38-272">Instrument your project during development.</span></span> <span data-ttu-id="63a38-273">Это можно сделать для приложений [ASP.NET](app-insights-asp-net.md) или [Java](app-insights-java-get-started.md), а также для [Node.js](app-insights-nodejs.md) и узлов [других типов](app-insights-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="63a38-273">You can do this for [ASP.NET](app-insights-asp-net.md) or [Java](app-insights-java-get-started.md) apps, as well as [Node.js](app-insights-nodejs.md) and a host of [other types](app-insights-platforms.md).</span></span> 
* <span data-ttu-id="63a38-274">Инструментирование [любой веб-страницы](app-insights-javascript.md) с помощью добавления небольшого фрагмента кода.</span><span class="sxs-lookup"><span data-stu-id="63a38-274">Instrument [any web page](app-insights-javascript.md) by adding a short code snippet.</span></span>

