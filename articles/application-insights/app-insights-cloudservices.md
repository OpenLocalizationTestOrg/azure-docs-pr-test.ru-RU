---
title: "Application Insights для облачных служб Azure | Документация Майкрософт"
description: "Эффективное отслеживание веб-ролей и рабочих ролей с помощью Application Insights"
services: application-insights
documentationcenter: 
keywords: "WAD2AI, система диагностики Azure"
author: CFreemanwa
manager: carmonm
editor: alancameronwills
ms.assetid: 5c7a5b34-329e-42b7-9330-9dcbb9ff1f88
ms.service: application-insights
ms.devlang: na
ms.tgt_pltfrm: ibiza
ms.topic: get-started-article
ms.workload: tbd
ms.date: 05/05/2017
ms.author: bwren
ms.openlocfilehash: c12b225aa351d0c272243469550791a6840091e0
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="application-insights-for-azure-cloud-services"></a><span data-ttu-id="76a95-104">Application Insights для облачных служб Azure</span><span class="sxs-lookup"><span data-stu-id="76a95-104">Application Insights for Azure Cloud Services</span></span>
<span data-ttu-id="76a95-105">С помощью [Application Insights][start] можно отслеживать [приложения облачной службы Microsoft Azure](https://azure.microsoft.com/services/cloud-services/) на предмет доступности, производительности, сбоев и использования, объединяя данные из пакета SDK Application Insights с данными [диагностики Azure](https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics) из облачных служб.</span><span class="sxs-lookup"><span data-stu-id="76a95-105">[Microsoft Azure Cloud service apps](https://azure.microsoft.com/services/cloud-services/) can be monitored by [Application Insights][start] for availability, performance, failures, and usage by combining data from Application Insights' SDKs with [Azure Diagnotics](https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics) data from your Cloud Services.</span></span> <span data-ttu-id="76a95-106">Благодаря получаемым данным о производительности и эффективности работы приложения на практике вы можете принимать осознанные решения о направлении разработки в каждом жизненном цикле.</span><span class="sxs-lookup"><span data-stu-id="76a95-106">With the feedback you get about the performance and effectiveness of your app in the wild, you can make informed choices about the direction of the design in each development lifecycle.</span></span>

![Пример](./media/app-insights-cloudservices/sample.png)

## <a name="before-you-start"></a><span data-ttu-id="76a95-108">Перед началом работы</span><span class="sxs-lookup"><span data-stu-id="76a95-108">Before you start</span></span>
<span data-ttu-id="76a95-109">Что вам понадобится:</span><span class="sxs-lookup"><span data-stu-id="76a95-109">You'll need:</span></span>

* <span data-ttu-id="76a95-110">Потребуется подписка [Microsoft Azure](http://azure.com).</span><span class="sxs-lookup"><span data-stu-id="76a95-110">A subscription with [Microsoft Azure](http://azure.com).</span></span> <span data-ttu-id="76a95-111">Войдите, используя учетную запись Майкрософт, которая уже может быть у вас для Windows, XBox Live или других облачных служб Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="76a95-111">Sign in with a Microsoft account, which you might have for Windows, XBox Live, or other Microsoft cloud services.</span></span> 
* <span data-ttu-id="76a95-112">Инструменты Microsoft Azure 2.9 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="76a95-112">Microsoft Azure tools 2.9 or later</span></span>
* <span data-ttu-id="76a95-113">Developer Analytics Tools 7.10 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="76a95-113">Developer Analytics Tools 7.10 or later</span></span>

## <a name="quick-start"></a><span data-ttu-id="76a95-114">Быстрый запуск</span><span class="sxs-lookup"><span data-stu-id="76a95-114">Quick start</span></span>
<span data-ttu-id="76a95-115">Самый быстрый и простой способ настроить мониторинг облачной службы с помощью Application Insights — выбрать этот вариант при публикации своей службы в Azure.</span><span class="sxs-lookup"><span data-stu-id="76a95-115">The quickest and easiest way to monitor your cloud service with Application Insights is to choose that option when you publish your service to Azure.</span></span>

![Пример](./media/app-insights-cloudservices/azure-cloud-application-insights.png)

<span data-ttu-id="76a95-117">Этот вариант позволяет инструментировать приложение во время выполнения, что обеспечивает все данные телеметрии, необходимые для мониторинга запросов, исключений и зависимостей в веб-роли, а также счетчиков производительности рабочих ролей.</span><span class="sxs-lookup"><span data-stu-id="76a95-117">This option instruments your app at run time, giving you all the telemetry you need to monitor requests, exceptions, and dependencies in your web role, as well as performance counters from your worker roles.</span></span> <span data-ttu-id="76a95-118">Все диагностические трассировки, генерируемые вашим приложением, также отправляются в Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-118">Any diagnostic traces generated by your app are also sent to Application Insights.</span></span>

<span data-ttu-id="76a95-119">Если это все, что вам нужно, то все готово.</span><span class="sxs-lookup"><span data-stu-id="76a95-119">If that's all you need, you're done!</span></span> <span data-ttu-id="76a95-120">Следующие шаги — [просмотр метрик приложения](app-insights-metrics-explorer.md), [запрос данных с помощью Аналитики](app-insights-analytics.md), и, возможно, настройка [мониторинга](app-insights-dashboards.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-120">Next steps are [viewing metrics from your app](app-insights-metrics-explorer.md), [querying your data with Analytics](app-insights-analytics.md), and maybe setting up a [dashboard](app-insights-dashboards.md).</span></span> <span data-ttu-id="76a95-121">Вам может потребоваться настроить [тесты доступности](app-insights-monitor-web-app-availability.md) и [добавить в веб-страницы код ](app-insights-javascript.md) для мониторинга производительности в браузере.</span><span class="sxs-lookup"><span data-stu-id="76a95-121">You might want to set up [availability tests](app-insights-monitor-web-app-availability.md) and [add code to your web pages](app-insights-javascript.md) to monitor performance in the browser.</span></span>

<span data-ttu-id="76a95-122">Но можно также получить дополнительные возможности:</span><span class="sxs-lookup"><span data-stu-id="76a95-122">But you can also get more options:</span></span>

* <span data-ttu-id="76a95-123">отправлять данные для различных компонентов и конфигураций борки в отдельные ресурсы;</span><span class="sxs-lookup"><span data-stu-id="76a95-123">Send data from different components and build configurations to separate resources.</span></span>
* <span data-ttu-id="76a95-124">добавить пользовательские данные телеметрии из своего приложения.</span><span class="sxs-lookup"><span data-stu-id="76a95-124">Add custom telemetry from your app.</span></span>

<span data-ttu-id="76a95-125">Если эти возможности представляют для вас интерес, продолжайте чтение.</span><span class="sxs-lookup"><span data-stu-id="76a95-125">If those options are of interest to you, read on.</span></span>

## <a name="sample-application-instrumented-with-application-insights"></a><span data-ttu-id="76a95-126">Пример приложения, инструментированного с помощью Application Insights</span><span class="sxs-lookup"><span data-stu-id="76a95-126">Sample Application instrumented with Application Insights</span></span>
<span data-ttu-id="76a95-127">Взгляните на этот [пример приложения](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService) , в котором служба Application Insights добавлена в облачную службу с двумя рабочими ролями, размещенными в Azure.</span><span class="sxs-lookup"><span data-stu-id="76a95-127">Take a look at this [sample application](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService) in which Application Insights is added to a cloud service with two worker roles hosted in Azure.</span></span> 

<span data-ttu-id="76a95-128">Ниже описано, как адаптировать собственный проект облачной службы таким же образом.</span><span class="sxs-lookup"><span data-stu-id="76a95-128">What follows tells you how to adapt your own cloud service project in the same way.</span></span>

## <a name="plan-resources-and-resource-groups"></a><span data-ttu-id="76a95-129">Планирование ресурсов и групп ресурсов</span><span class="sxs-lookup"><span data-stu-id="76a95-129">Plan resources and resource groups</span></span>
<span data-ttu-id="76a95-130">Данные телеметрии из приложения сохраняются, анализируются и отображаются в ресурсе Azure типа Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-130">The telemetry from your app is stored, analyzed and displayed in an Azure resource of type Application Insights.</span></span> 

<span data-ttu-id="76a95-131">Каждый ресурс относится к группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="76a95-131">Each resource belongs to a resource group.</span></span> <span data-ttu-id="76a95-132">Группы ресурсов используются для управления затратами, предоставления доступа участникам команды и развертывания обновлений при помощи отдельной согласованной транзакции.</span><span class="sxs-lookup"><span data-stu-id="76a95-132">Resource groups are used for managing costs, for granting access to team members, and to deploy updates in a single coordinated transaction.</span></span> <span data-ttu-id="76a95-133">Например, вы можете [написать сценарий для развертывания](../azure-resource-manager/resource-group-template-deploy.md) облачной службы Azure и ее ресурсов мониторинга Application Insights одной операцией.</span><span class="sxs-lookup"><span data-stu-id="76a95-133">For example, you could [write a script to deploy](../azure-resource-manager/resource-group-template-deploy.md) an Azure Cloud Service and its Application Insights monitoring resources all in one operation.</span></span>

### <a name="resources-for-components"></a><span data-ttu-id="76a95-134">Ресурсы для компонентов</span><span class="sxs-lookup"><span data-stu-id="76a95-134">Resources for components</span></span>
<span data-ttu-id="76a95-135">Рекомендуемая схема — создавать отдельный ресурс для каждого компонента приложения, то есть каждой веб-роли и рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-135">The recommended scheme is to create a separate resource for each component of your application - that is, each web role and worker role.</span></span> <span data-ttu-id="76a95-136">Вы можете анализировать каждый компонент отдельно, но можно создать [панель мониторинга](app-insights-dashboards.md), содержащую ключевые диаграммы для всех компонентов. Это позволит сравнивать и отслеживать их вместе.</span><span class="sxs-lookup"><span data-stu-id="76a95-136">You can analyze each component separately, but can create a [dashboard](app-insights-dashboards.md) that brings together the key charts from all the components, so that you can compare and monitor them together.</span></span> 

<span data-ttu-id="76a95-137">Альтернативной схемой является отправка данных телеметрии из нескольких ролей в один ресурс, но с [добавлением свойства измерения в каждый элемент телеметрии](app-insights-api-filtering-sampling.md#add-properties-itelemetryinitializer), определяющего его исходную роль.</span><span class="sxs-lookup"><span data-stu-id="76a95-137">An alternative scheme is to send the telemetry from more than one role to the same resource, but [add a dimension property to each telemetry item](app-insights-api-filtering-sampling.md#add-properties-itelemetryinitializer) that identifies its source role.</span></span> <span data-ttu-id="76a95-138">В этой схеме диаграммы метрик (например, исключений) обычно отображаются вместе с показателями других ролей. Но при необходимости вы можете сегментировать диаграммы по идентификатору роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-138">In this scheme, metric charts such as exceptions normally show an aggregation of the counts from the different roles, but you can segment the chart by the role identifier when required.</span></span> <span data-ttu-id="76a95-139">Результаты поиска также можно фильтровать по одному измерению.</span><span class="sxs-lookup"><span data-stu-id="76a95-139">Searches can also be filtered by the same dimension.</span></span> <span data-ttu-id="76a95-140">Этот вариант делает более удобным одновременный просмотр информации, но может привести к некоторой путанице с ролями.</span><span class="sxs-lookup"><span data-stu-id="76a95-140">This alternative makes it a bit easier to view everything at the same time, but could also lead to some confusion between the roles.</span></span>

<span data-ttu-id="76a95-141">Данные телеметрии браузера обычно добавляются в тот же ресурс, что и данные соответствующей серверной веб-роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-141">Browser telemetry is usually included in the same resource as its server-side web role.</span></span>

<span data-ttu-id="76a95-142">Поместите ресурсы Application Insights для различных компонентов в одну группу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="76a95-142">Put the Application Insights resources for the different components in one resource group.</span></span> <span data-ttu-id="76a95-143">Это позволяет легко управлять ими одновременно.</span><span class="sxs-lookup"><span data-stu-id="76a95-143">This makes it easy to manage them together.</span></span> 

### <a name="separating-development-test-and-production"></a><span data-ttu-id="76a95-144">Разделение данных для разработки, тестирования и эксплуатации</span><span class="sxs-lookup"><span data-stu-id="76a95-144">Separating development, test, and production</span></span>
<span data-ttu-id="76a95-145">При разработке пользовательских событий для следующего компонента в то время, когда предыдущая версия еще активна, необходимо отправлять данные телеметрии для разработки в отдельный ресурс Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-145">If you are developing custom events for your next feature while the previous version is live, you want to send the development telemetry to a separate Application Insights resource.</span></span> <span data-ttu-id="76a95-146">В противном случае будет трудно найти данные телеметрии тестирования среди всего трафика, поступающего от активного сайта.</span><span class="sxs-lookup"><span data-stu-id="76a95-146">Otherwise it will be hard to find your test telemetry among all the traffic from the live site.</span></span>

<span data-ttu-id="76a95-147">Чтобы избежать такой ситуации, создайте отдельные ресурсы для каждой конфигурации сборки или "метки" (разработка, тестирование, эксплуатация и т. п.) своей системы.</span><span class="sxs-lookup"><span data-stu-id="76a95-147">To avoid this situation, create separate resources for each build configuration or 'stamp' (development, test, production, ...) of your system.</span></span> <span data-ttu-id="76a95-148">Поместите ресурсы для каждой конфигурации сборки в отдельную группу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="76a95-148">Put the resources for each build configuration in a separate resource group.</span></span> 

<span data-ttu-id="76a95-149">Чтобы отправлять данные телеметрии в соответствующие ресурсы, можно настроить пакет SDK для Application Insights, чтобы он собирал разные ключи инструментирования, в зависимости от конфигурации сборки.</span><span class="sxs-lookup"><span data-stu-id="76a95-149">To send the telemetry to the appropriate resources, you can set up the Application Insights SDK so that it picks up a different instrumentation key depending on the build configuration.</span></span> 

## <a name="create-an-application-insights-resource-for-each-role"></a><span data-ttu-id="76a95-150">Создание ресурса Application Insights для каждой роли</span><span class="sxs-lookup"><span data-stu-id="76a95-150">Create an Application Insights resource for each role</span></span>
<span data-ttu-id="76a95-151">Если вы решили создать отдельный ресурс для каждой роли и, возможно, отдельный набор для каждой конфигурации сборки, то создать их проще всего будет на портале Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-151">If you've decided to create a separate resource for each role - and perhaps a separate set for each build configuration - then it's easiest to create them all in the Application Insights portal.</span></span> <span data-ttu-id="76a95-152">Если создается много ресурсов, можно [автоматизировать этот процесс](app-insights-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-152">(If you create resources a lot, you can [automate the process](app-insights-powershell.md).</span></span>

1. <span data-ttu-id="76a95-153">На [портале Azure][portal] создайте ресурс Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-153">In the [Azure portal][portal], create a new Application Insights resource.</span></span> <span data-ttu-id="76a95-154">Для параметра типа приложения выберите приложение ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="76a95-154">For application type, choose ASP.NET app.</span></span> 

    ![Нажмите "Создать" и "Application Insights"](./media/app-insights-cloudservices/01-new.png)
2. <span data-ttu-id="76a95-156">Обратите внимание, что каждый ресурс идентифицируется с помощью ключа инструментирования.</span><span class="sxs-lookup"><span data-stu-id="76a95-156">Note that each resource is identified by an Instrumentation Key.</span></span> <span data-ttu-id="76a95-157">Это может понадобиться позже, если вы захотите вручную настроить или проверить конфигурацию пакета SDK.</span><span class="sxs-lookup"><span data-stu-id="76a95-157">You might need this later if you want to manually configure or verify the configuration of the SDK.</span></span>

    ![Нажмите "Свойства", выберите ключ и нажмите сочетание клавиш CTRL + C](./media/app-insights-cloudservices/02-props.png) 

## <a name="set-up-azure-diagnostics-for-each-role"></a><span data-ttu-id="76a95-159">Настройка системы диагностики Azure для каждой роли</span><span class="sxs-lookup"><span data-stu-id="76a95-159">Set up Azure Diagnostics for each role</span></span>
<span data-ttu-id="76a95-160">Настройте мониторинг приложения с помощью Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-160">Set this option to monitor your app with Application Insights.</span></span> <span data-ttu-id="76a95-161">Для веб-ролей это обеспечивает мониторинг производительности, создание оповещений и диагностику, а также анализ сведений об использовании.</span><span class="sxs-lookup"><span data-stu-id="76a95-161">For web roles, this provides performance monitoring, alerts, and diagnostics, as well as usage analysis.</span></span> <span data-ttu-id="76a95-162">Для других ролей можно искать и отслеживать диагностические данные Azure, например о событиях перезапуска, показаниях счетчиков производительности и вызовах System.Diagnostics.Trace.</span><span class="sxs-lookup"><span data-stu-id="76a95-162">For other roles, you can search and monitor Azure diagnostics such as restart, performance counters, and calls to System.Diagnostics.Trace.</span></span> 

1. <span data-ttu-id="76a95-163">В обозревателе решений Visual Studio в разделе &lt;Ваша_облачная_служба&gt; > "Роли" откройте свойства каждой роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-163">In Visual Studio Solution Explorer, under &lt;YourCloudService&gt;, Roles, open the properties of each role.</span></span>
2. <span data-ttu-id="76a95-164">В разделе **Конфигурация** выберите **Отправка диагностических данных в Application Insights** и выберите соответствующий ресурс Application Insights, созданный ранее.</span><span class="sxs-lookup"><span data-stu-id="76a95-164">In **Configuration**, set **Send diagnostics data to Application Insights** and select the appropriate Application Insights resource that you created earlier.</span></span>

<span data-ttu-id="76a95-165">Если вы решили использовать отдельный ресурс Application Insights для каждой конфигурации сборки, сначала выберите эту конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="76a95-165">If you have decided to use a separate Application Insights resource for each build configuration, select the configuration first.</span></span>

![В свойствах каждой роли Azure настройте Application Insights.](./media/app-insights-cloudservices/configure-azure-diagnostics.png)

<span data-ttu-id="76a95-167">Это приведет к добавлению ключей инструментирования Application Insights в файлы `ServiceConfiguration.*.cscfg`.</span><span class="sxs-lookup"><span data-stu-id="76a95-167">This has the effect of inserting your Application Insights instrumentation keys into the files named `ServiceConfiguration.*.cscfg`.</span></span> <span data-ttu-id="76a95-168">([Пример кода](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/AzureEmailService/ServiceConfiguration.Cloud.cscfg)).</span><span class="sxs-lookup"><span data-stu-id="76a95-168">([Sample code](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/AzureEmailService/ServiceConfiguration.Cloud.cscfg)).</span></span>

<span data-ttu-id="76a95-169">Если требуется изменить уровень диагностических сведений, отправляемых в Application Insights, это можно сделать, [напрямую изменив файлы с расширением `.cscfg`](app-insights-azure-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-169">If you want to vary the level of diagnostic information sent to Application Insights, you can do so [by editing the `.cscfg` files directly](app-insights-azure-diagnostics.md).</span></span>

## <span data-ttu-id="76a95-170"><a name="sdk"></a>Установка пакета SDK в каждый проект</span><span class="sxs-lookup"><span data-stu-id="76a95-170"><a name="sdk"></a>Install the SDK in each project</span></span>
<span data-ttu-id="76a95-171">Этот параметр позволяет добавить пользовательские данные бизнес-телеметрии в любую роль для более тщательного анализа того, как приложение используется и работает.</span><span class="sxs-lookup"><span data-stu-id="76a95-171">This option adds the ability to add custom business telemetry to any role, for a closer analysis of how your application is used and performs.</span></span>

<span data-ttu-id="76a95-172">В Visual Studio настройте пакет SDK для Application Insights для каждого проекта облачного приложения.</span><span class="sxs-lookup"><span data-stu-id="76a95-172">In Visual Studio, configure the Application Insights SDK for each cloud app project.</span></span>

1. <span data-ttu-id="76a95-173">**Веб-роли**: щелкните проект правой кнопкой мыши и выберите **Настроить Application Insights** или **Добавить > Телеметрия Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="76a95-173">**Web roles**: Right-click the project and choose **Configure Application Insights** or **Add > Application Insights telemetry**.</span></span>

2. <span data-ttu-id="76a95-174">**Рабочие роли**:</span><span class="sxs-lookup"><span data-stu-id="76a95-174">**Worker roles**:</span></span> 
 * <span data-ttu-id="76a95-175">щелкните проект правой кнопкой мыши и выберите **Управление пакетами Nuget**.</span><span class="sxs-lookup"><span data-stu-id="76a95-175">Right-click the project and select **Manage Nuget Packages**.</span></span>
 * <span data-ttu-id="76a95-176">Добавьте [Application Insights для Windows Servers](https://www.nuget.org/packages/Microsoft.ApplicationInsights.WindowsServer/).</span><span class="sxs-lookup"><span data-stu-id="76a95-176">Add [Application Insights for Windows Servers](https://www.nuget.org/packages/Microsoft.ApplicationInsights.WindowsServer/).</span></span>

    ![Поиск Application Insights](./media/app-insights-cloudservices/04-ai-nuget.png)

3. <span data-ttu-id="76a95-178">Настройте пакет SDK для отправки данных в ресурсы Application Insights.</span><span class="sxs-lookup"><span data-stu-id="76a95-178">Configure the SDK to send data to the Application Insights resource.</span></span>

    <span data-ttu-id="76a95-179">В соответствующей функции запуска задайте ключ инструментирования из параметра конфигурации, заданного в CSCFG-файле.</span><span class="sxs-lookup"><span data-stu-id="76a95-179">In a suitable startup function, set the instrumentation key from the configuration setting in the .cscfg file:</span></span>
 
    ```C#
   
     TelemetryConfiguration.Active.InstrumentationKey = RoleEnvironment.GetConfigurationSettingValue("APPINSIGHTS_INSTRUMENTATIONKEY");
    ```
   
    <span data-ttu-id="76a95-180">Сделайте это для каждой роли в вашем приложении.</span><span class="sxs-lookup"><span data-stu-id="76a95-180">Do this for each role in your application.</span></span> <span data-ttu-id="76a95-181">См. указанные ниже примеры.</span><span class="sxs-lookup"><span data-stu-id="76a95-181">See the examples:</span></span>
   
   * [<span data-ttu-id="76a95-182">Веб-роль</span><span class="sxs-lookup"><span data-stu-id="76a95-182">Web role</span></span>](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/Global.asax.cs#L27)
   * [<span data-ttu-id="76a95-183">Рабочая роль</span><span class="sxs-lookup"><span data-stu-id="76a95-183">Worker role</span></span>](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/WorkerRoleA.cs#L232)
   * [<span data-ttu-id="76a95-184">При работе с веб-страницами</span><span class="sxs-lookup"><span data-stu-id="76a95-184">For web pages</span></span>](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/Views/Shared/_Layout.cshtml#L13) 
4. <span data-ttu-id="76a95-185">Задайте для файла ApplicationInsights.config незамедлительное копирование в выходной каталог.</span><span class="sxs-lookup"><span data-stu-id="76a95-185">Set the ApplicationInsights.config file to be copied always to the output directory.</span></span> 
   
    <span data-ttu-id="76a95-186">(в CONFIG-файле имеются сообщения, указывающие, куда именно поместить ключ инструментирования.</span><span class="sxs-lookup"><span data-stu-id="76a95-186">(In the .config file, you'll see messages asking you to place the instrumentation key there.</span></span> <span data-ttu-id="76a95-187">Тем не менее для облачных приложений лучше задать его в CSCFG-файле.</span><span class="sxs-lookup"><span data-stu-id="76a95-187">However, for cloud applications it's better to set it from the .cscfg file.</span></span> <span data-ttu-id="76a95-188">Это обеспечит правильную идентификацию роли на портале.)</span><span class="sxs-lookup"><span data-stu-id="76a95-188">This ensures that the role is correctly identified in the portal.)</span></span>

#### <a name="run-and-publish-the-app"></a><span data-ttu-id="76a95-189">Запуск и публикация приложения</span><span class="sxs-lookup"><span data-stu-id="76a95-189">Run and publish the app</span></span>
<span data-ttu-id="76a95-190">Запустите приложение и войдите в Azure.</span><span class="sxs-lookup"><span data-stu-id="76a95-190">Run your app, and sign into Azure.</span></span> <span data-ttu-id="76a95-191">Откройте созданные ресурсы Application Insights, и вы увидите отдельные точки данных в области [Поиск](app-insights-diagnostic-search.md) и объединенные данные в [обозревателе метрик](app-insights-metrics-explorer.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-191">Open the Application Insights resources you created, and you'll see individual data points appearing in [Search](app-insights-diagnostic-search.md), and aggregated data in [Metric Explorer](app-insights-metrics-explorer.md).</span></span> 

<span data-ttu-id="76a95-192">Добавьте дополнительные данные телеметрии (см. разделы ниже), а затем опубликуйте приложение для оперативного получения отзывов о диагностике и использовании.</span><span class="sxs-lookup"><span data-stu-id="76a95-192">Add more telemetry - see the sections below - and then publish your app to get live diagnostic and usage feedback.</span></span> 

#### <a name="no-data"></a><span data-ttu-id="76a95-193">Данные отсутствуют?</span><span class="sxs-lookup"><span data-stu-id="76a95-193">No data?</span></span>
* <span data-ttu-id="76a95-194">Откройте плитку [Поиск][diagnostic], чтобы просмотреть отдельные события.</span><span class="sxs-lookup"><span data-stu-id="76a95-194">Open the [Search][diagnostic] tile, to see individual events.</span></span>
* <span data-ttu-id="76a95-195">Используйте приложение, открывая различные страницы, чтобы создать некоторый объем данных телеметрии.</span><span class="sxs-lookup"><span data-stu-id="76a95-195">Use the application, opening different pages so that it generates some telemetry.</span></span>
* <span data-ttu-id="76a95-196">Подождите несколько секунд и нажмите "Обновить".</span><span class="sxs-lookup"><span data-stu-id="76a95-196">Wait a few seconds and click Refresh.</span></span>
* <span data-ttu-id="76a95-197">Ознакомьтесь с разделом [Устранение неполадок][qna].</span><span class="sxs-lookup"><span data-stu-id="76a95-197">See [Troubleshooting][qna].</span></span>

## <a name="view-azure-diagnostic-events"></a><span data-ttu-id="76a95-198">Просмотр событий диагностики Azure</span><span class="sxs-lookup"><span data-stu-id="76a95-198">View Azure Diagnostic events</span></span>
<span data-ttu-id="76a95-199">Источники данных [диагностики Azure](https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics) в Application Insights:</span><span class="sxs-lookup"><span data-stu-id="76a95-199">Where to find the [Azure Diagnostics](https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics) information in Application Insights:</span></span>

* <span data-ttu-id="76a95-200">Счетчики производительности отображаются в виде настраиваемых метрик.</span><span class="sxs-lookup"><span data-stu-id="76a95-200">Performance counters are displayed as custom metrics.</span></span> 
* <span data-ttu-id="76a95-201">Журналы событий Windows отображаются в виде трассировок и настраиваемых событий.</span><span class="sxs-lookup"><span data-stu-id="76a95-201">Windows event logs are shown as traces and custom events.</span></span>
* <span data-ttu-id="76a95-202">Журналы приложений, журналы трассировки событий Windows и все журналы инфраструктуры диагностики отображаются в виде трассировок.</span><span class="sxs-lookup"><span data-stu-id="76a95-202">Application logs, ETW logs, and any diagnostics infrastructure logs appear as traces.</span></span>

<span data-ttu-id="76a95-203">Чтобы просмотреть счетчики производительности и счетчики событий, откройте [обозреватель метрик](app-insights-metrics-explorer.md) и добавьте новую диаграмму:</span><span class="sxs-lookup"><span data-stu-id="76a95-203">To see performance counters and counts of events, open [Metrics Explorer](app-insights-metrics-explorer.md) and add a new chart:</span></span>

![Диагностические данные Azure](./media/app-insights-cloudservices/23-wad.png)

<span data-ttu-id="76a95-205">Используйте [Поиск](app-insights-diagnostic-search.md) или [запрос аналитики](app-insights-analytics-tour.md) для поиска в различных журналах трассировки, отправляемых системой диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="76a95-205">Use [Search](app-insights-diagnostic-search.md) or an [Analytics query](app-insights-analytics-tour.md) to search across the various trace logs sent by Azure Diagnostics.</span></span> <span data-ttu-id="76a95-206">Например предположим, что возникло необработанное исключение, которое вызвало сбой и перезапуск роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-206">For example, suppose you have an unhandled exception which caused a Role to crash and recycle.</span></span> <span data-ttu-id="76a95-207">Эта информация будет отображена в канале приложения журнала событий Windows.</span><span class="sxs-lookup"><span data-stu-id="76a95-207">That information would show up in the Application channel of Windows Event Log.</span></span> <span data-ttu-id="76a95-208">Можно использовать Поиск, чтобы просмотреть ошибку в журнале событий Windows и получить полную трассировку стека для исключения.</span><span class="sxs-lookup"><span data-stu-id="76a95-208">You can use Search to look at the Windows Event Log error and get the full stack trace for the exception.</span></span> <span data-ttu-id="76a95-209">Это поможет вам найти первопричину проблемы.</span><span class="sxs-lookup"><span data-stu-id="76a95-209">That will help you find the root cause of the issue.</span></span>

![Поиск диагностических данных Azure](./media/app-insights-cloudservices/25-wad.png)

## <a name="more-telemetry"></a><span data-ttu-id="76a95-211">Дополнительные данные телеметрии</span><span class="sxs-lookup"><span data-stu-id="76a95-211">More telemetry</span></span>
<span data-ttu-id="76a95-212">В следующих подразделах показано, как получить дополнительные данные телеметрии из различных аспектов приложения.</span><span class="sxs-lookup"><span data-stu-id="76a95-212">The sections below show how to get additional telemetry from different aspects of your application.</span></span>

## <a name="track-requests-from-worker-roles"></a><span data-ttu-id="76a95-213">Отслеживание запросов из рабочих ролей</span><span class="sxs-lookup"><span data-stu-id="76a95-213">Track Requests from Worker roles</span></span>
<span data-ttu-id="76a95-214">В веб-ролях модуль запросов собирает данные об HTTP-запросах автоматически.</span><span class="sxs-lookup"><span data-stu-id="76a95-214">In web roles, the requests module automatically collects data about HTTP requests.</span></span> <span data-ttu-id="76a95-215">Примеры переопределения поведения коллекции по умолчанию см. на странице с [примером роли MVCWebRole](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService/MvcWebRole).</span><span class="sxs-lookup"><span data-stu-id="76a95-215">See the [sample MVCWebRole](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService/MvcWebRole) for examples of how you can override the default collection behavior.</span></span> 

<span data-ttu-id="76a95-216">Производительность вызовов для рабочих ролей можно регистрировать, отслеживая их таким же образом, как запросы HTTP.</span><span class="sxs-lookup"><span data-stu-id="76a95-216">You can capture the performance of calls to worker roles by tracking them in the same way as HTTP requests.</span></span> <span data-ttu-id="76a95-217">В Application Insights тип телеметрии запроса определяет единицу работы для указанного сервера, которую можно учесть и которая может быть независимо выполнена или не выполнена.</span><span class="sxs-lookup"><span data-stu-id="76a95-217">In Application Insights, the Request telemetry type measures a unit of named server-side work that can be timed and can independently succeed or fail.</span></span> <span data-ttu-id="76a95-218">Во время автоматической регистрации HTTP-запросов пакетом SDK можно добавить собственный код для отслеживания запросов к рабочим ролям.</span><span class="sxs-lookup"><span data-stu-id="76a95-218">While HTTP requests are captured automatically by the SDK, you can insert your own code to track requests to worker roles.</span></span>

<span data-ttu-id="76a95-219">Ознакомьтесь с двумя примерами рабочих ролей, которые инструментированы для отправки отчетов по запросам: [WorkerRoleA](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService/WorkerRoleA) и [WorkerRoleB](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService/WorkerRoleB).</span><span class="sxs-lookup"><span data-stu-id="76a95-219">See the two sample worker roles instrumented to report requests: [WorkerRoleA](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService/WorkerRoleA) and [WorkerRoleB](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService/WorkerRoleB)</span></span>

## <a name="exceptions"></a><span data-ttu-id="76a95-220">Исключения</span><span class="sxs-lookup"><span data-stu-id="76a95-220">Exceptions</span></span>
<span data-ttu-id="76a95-221">Способы сбора необработанных исключений, выдаваемых веб-приложениями разных типов, см. в статье [Настройка Application Insights: диагностика исключений](app-insights-asp-net-exceptions.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-221">See [Monitoring Exceptions in Application Insights](app-insights-asp-net-exceptions.md) for information on how you can collect unhandled exceptions from different web application types.</span></span>

<span data-ttu-id="76a95-222">Образец веб-роли имеет контроллеры MVC5 и веб-API 2.</span><span class="sxs-lookup"><span data-stu-id="76a95-222">The sample web role has MVC5 and Web API 2 controllers.</span></span> <span data-ttu-id="76a95-223">Необработанные исключения, поступающие из них, регистрируются следующими обработчиками:</span><span class="sxs-lookup"><span data-stu-id="76a95-223">The unhandled exceptions from the two are captured with the following handlers:</span></span>

* <span data-ttu-id="76a95-224">объектом [AiHandleErrorAttribute](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/Telemetry/AiHandleErrorAttribute.cs), заданным [здесь](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/App_Start/FilterConfig.cs#L12) для контроллеров MVC5;</span><span class="sxs-lookup"><span data-stu-id="76a95-224">[AiHandleErrorAttribute](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/Telemetry/AiHandleErrorAttribute.cs) set up [here](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/App_Start/FilterConfig.cs#L12) for MVC5 controllers</span></span>
* <span data-ttu-id="76a95-225">объектом [AiWebApiExceptionLogger](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/Telemetry/AiWebApiExceptionLogger.cs), заданным [здесь](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/App_Start/WebApiConfig.cs#L25) для контроллеров веб-API 2.</span><span class="sxs-lookup"><span data-stu-id="76a95-225">[AiWebApiExceptionLogger](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/Telemetry/AiWebApiExceptionLogger.cs) set up [here](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/MvcWebRole/App_Start/WebApiConfig.cs#L25) for Web API 2 controllers</span></span>

<span data-ttu-id="76a95-226">Для рабочих ролей есть два способа отслеживания исключений.</span><span class="sxs-lookup"><span data-stu-id="76a95-226">For worker roles, there are two ways to track exceptions:</span></span>

* <span data-ttu-id="76a95-227">TrackException(ex);</span><span class="sxs-lookup"><span data-stu-id="76a95-227">TrackException(ex)</span></span>
* <span data-ttu-id="76a95-228">Если вы добавили пакет NuGet прослушивателя трассировки Application Insights, то вы можете вносить исключения в журнал с помощью **System.Diagnostics.Trace**.</span><span class="sxs-lookup"><span data-stu-id="76a95-228">If you have added the Application Insights trace listener NuGet package, you can use **System.Diagnostics.Trace** to log exceptions.</span></span> [<span data-ttu-id="76a95-229">Пример кода</span><span class="sxs-lookup"><span data-stu-id="76a95-229">Code example.</span></span>](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/WorkerRoleA.cs#L107)

## <a name="performance-counters"></a><span data-ttu-id="76a95-230">Счетчики производительности</span><span class="sxs-lookup"><span data-stu-id="76a95-230">Performance Counters</span></span>
<span data-ttu-id="76a95-231">По умолчанию собираются приведенные ниже счетчики.</span><span class="sxs-lookup"><span data-stu-id="76a95-231">The following counters are collected by default:</span></span>

    * <span data-ttu-id="76a95-232">\Process(??APP_WIN32_PROC??)\% Загруженность процессора</span><span class="sxs-lookup"><span data-stu-id="76a95-232">\Process(??APP_WIN32_PROC??)\% Processor Time</span></span>
    * <span data-ttu-id="76a95-233">\Память\доступные байты</span><span class="sxs-lookup"><span data-stu-id="76a95-233">\Memory\Available Bytes</span></span>
    * <span data-ttu-id="76a95-234">\.NET CLR Exceptions(??APP_CLR_PROC??)\# Исключений в секунду</span><span class="sxs-lookup"><span data-stu-id="76a95-234">\.NET CLR Exceptions(??APP_CLR_PROC??)\# of Exceps Thrown / sec</span></span>
    * <span data-ttu-id="76a95-235">\Process(??APP_WIN32_PROC??)\Байт исключительного пользования</span><span class="sxs-lookup"><span data-stu-id="76a95-235">\Process(??APP_WIN32_PROC??)\Private Bytes</span></span>
    * <span data-ttu-id="76a95-236">\Process(??APP_WIN32_PROC??)\I/O — обмен данными, байт в секунду</span><span class="sxs-lookup"><span data-stu-id="76a95-236">\Process(??APP_WIN32_PROC??)\IO Data Bytes/sec</span></span>
    * <span data-ttu-id="76a95-237">\Processor(_Total)\% Загруженность процессора</span><span class="sxs-lookup"><span data-stu-id="76a95-237">\Processor(_Total)\% Processor Time</span></span>

<span data-ttu-id="76a95-238">Эти счетчики также собираются для веб-ролей.</span><span class="sxs-lookup"><span data-stu-id="76a95-238">For web roles, these counters are also collected:</span></span>

    * <span data-ttu-id="76a95-239">\ASP.NET Applications(??APP_W3SVC_PROC??)\Запросов в секунду</span><span class="sxs-lookup"><span data-stu-id="76a95-239">\ASP.NET Applications(??APP_W3SVC_PROC??)\Requests/Sec</span></span>
    * <span data-ttu-id="76a95-240">\ASP.NET Applications(??APP_W3SVC_PROC??)\Время выполнения запросов</span><span class="sxs-lookup"><span data-stu-id="76a95-240">\ASP.NET Applications(??APP_W3SVC_PROC??)\Request Execution Time</span></span>
    * <span data-ttu-id="76a95-241">\ASP.NET Applications(??APP_W3SVC_PROC??)\Запросы в очереди приложений</span><span class="sxs-lookup"><span data-stu-id="76a95-241">\ASP.NET Applications(??APP_W3SVC_PROC??)\Requests In Application Queue</span></span>

<span data-ttu-id="76a95-242">Можно указать дополнительные пользовательские или другие счетчики производительности Windows, изменив файл ApplicationInsights.config, [как показано в этом примере](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/ApplicationInsights.config#L14).</span><span class="sxs-lookup"><span data-stu-id="76a95-242">You can specify additional custom or other windows performance counters by editing ApplicationInsights.config [as in this example](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/ApplicationInsights.config#L14).</span></span>

  ![Счетчики производительности](./media/app-insights-cloudservices/OLfMo2f.png)

## <a name="correlated-telemetry-for-worker-roles"></a><span data-ttu-id="76a95-244">Коррелированная телеметрия для рабочих ролей</span><span class="sxs-lookup"><span data-stu-id="76a95-244">Correlated Telemetry for Worker Roles</span></span>
<span data-ttu-id="76a95-245">Если вы видите причины неудавшихся запросов или запросов с высокой задержкой, это значит, что вы обладаете широким спектром возможностей диагностики.</span><span class="sxs-lookup"><span data-stu-id="76a95-245">It is a rich diagnostic experience, when you can see what led to a failed or high latency request.</span></span> <span data-ttu-id="76a95-246">При работе с веб-ролями пакет SDK автоматически настраивает корреляцию между связанными данными телеметрии.</span><span class="sxs-lookup"><span data-stu-id="76a95-246">With web roles, the SDK automatically sets up correlation between related telemetry.</span></span> <span data-ttu-id="76a95-247">Для рабочих ролей вы можете использовать пользовательский инициализатор телеметрии, чтобы задать атрибут общего контекста Operation.Id, и тогда эта возможность будет доступна для всех сведений телеметрии.</span><span class="sxs-lookup"><span data-stu-id="76a95-247">For worker roles, you can use a custom telemetry initializer to set a common Operation.Id context attribute for all the telemetry to achieve this.</span></span> <span data-ttu-id="76a95-248">Вы сможете узнать причину сбоя или задержки — зависимость или ваш код — с первого взгляда.</span><span class="sxs-lookup"><span data-stu-id="76a95-248">This allows you to see whether the latency/failure issue was caused due to a dependency or your code, at a glance!</span></span> 

<span data-ttu-id="76a95-249">Этот процесс описывается далее.</span><span class="sxs-lookup"><span data-stu-id="76a95-249">Here's how:</span></span>

* <span data-ttu-id="76a95-250">Задайте идентификатор корреляции в объекте CallContext, как показано [здесь](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/WorkerRoleA.cs#L36).</span><span class="sxs-lookup"><span data-stu-id="76a95-250">Set the correlation Id into a CallContext as shown [here](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/WorkerRoleA.cs#L36).</span></span> <span data-ttu-id="76a95-251">В этом случае мы используем идентификатор запроса как идентификатор корреляции.</span><span class="sxs-lookup"><span data-stu-id="76a95-251">In this case, we are using the Request ID as the correlation id</span></span>
* <span data-ttu-id="76a95-252">Добавьте пользовательскую реализацию TelemetryInitializer, которая задает для Operation.Id значение correlationId, заданное ранее.</span><span class="sxs-lookup"><span data-stu-id="76a95-252">Add a custom TelemetryInitializer implementation, to set the Operation.Id to the correlationId set above.</span></span> <span data-ttu-id="76a95-253">Пример: [ItemCorrelationTelemetryInitializer](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/Telemetry/ItemCorrelationTelemetryInitializer.cs#L13).</span><span class="sxs-lookup"><span data-stu-id="76a95-253">There's an example here: [ItemCorrelationTelemetryInitializer](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/Telemetry/ItemCorrelationTelemetryInitializer.cs#L13)</span></span>
* <span data-ttu-id="76a95-254">Добавьте пользовательский инициализатор телеметрии.</span><span class="sxs-lookup"><span data-stu-id="76a95-254">Add the custom telemetry initializer.</span></span> <span data-ttu-id="76a95-255">Это можно сделать в файле ApplicationInsights.config или в коде, как показано [ниже](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/WorkerRoleA.cs#L233)</span><span class="sxs-lookup"><span data-stu-id="76a95-255">You could do that in the ApplicationInsights.config file, or in code as shown [here](https://github.com/Microsoft/ApplicationInsights-Home/blob/master/Samples/AzureEmailService/WorkerRoleA/WorkerRoleA.cs#L233)</span></span>

<span data-ttu-id="76a95-256">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="76a95-256">That's it!</span></span> <span data-ttu-id="76a95-257">Взаимодействие с порталом уже настроено, и вы можете просматривать все связанные сведения телеметрии одновременно.</span><span class="sxs-lookup"><span data-stu-id="76a95-257">The portal experience is already wired up to help you see all associated telemetry at a glance:</span></span>

![Коррелированные данные телеметрии](./media/app-insights-cloudservices/bHxuUhd.png)

## <a name="client-telemetry"></a><span data-ttu-id="76a95-259">Данные телеметрии клиента</span><span class="sxs-lookup"><span data-stu-id="76a95-259">Client telemetry</span></span>
<span data-ttu-id="76a95-260">[Добавьте пакет SDK JavaScript на веб-страницы][client], которые позволяют получать браузерные данные телеметрии, такие как число просмотров страниц, время загрузки страницы, исключения сценариев, и записывать настраиваемую телеметрию в сценарии страниц.</span><span class="sxs-lookup"><span data-stu-id="76a95-260">[Add the JavaScript SDK to your web pages][client] to get browser-based telemetry such as page view counts, page load times, script exceptions, and to let you write custom telemetry in your page scripts.</span></span>

## <a name="availability-tests"></a><span data-ttu-id="76a95-261">Тесты доступности</span><span class="sxs-lookup"><span data-stu-id="76a95-261">Availability tests</span></span>
<span data-ttu-id="76a95-262">[Настройте веб-тесты][availability], которые помогут быть уверенными в том, что приложение остается работоспособным и правильно отвечает на запросы.</span><span class="sxs-lookup"><span data-stu-id="76a95-262">[Set up web tests][availability] to make sure your application stays live and responsive.</span></span>

## <a name="display-everything-together"></a><span data-ttu-id="76a95-263">Отображение всей информации вместе</span><span class="sxs-lookup"><span data-stu-id="76a95-263">Display everything together</span></span>
<span data-ttu-id="76a95-264">Чтобы получить общее представление о системе, можно отобразить ключевые диаграммы мониторинга на одной [панели мониторинга](app-insights-dashboards.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-264">To get an overall picture of your system, you can bring the key monitoring charts together on one [dashboard](app-insights-dashboards.md).</span></span> <span data-ttu-id="76a95-265">Например, можно закрепить количество запросов и сбоев для каждой роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-265">For example, you could pin the request and failure counts of each role.</span></span> 

<span data-ttu-id="76a95-266">Если в системе используются другие службы Azure, такие как Stream Analytics, добавьте и их диаграммы мониторинга.</span><span class="sxs-lookup"><span data-stu-id="76a95-266">If your system uses other Azure services such as Stream Analytics, include their monitoring charts as well.</span></span> 

<span data-ttu-id="76a95-267">При наличии клиентского мобильного приложения добавьте код, отправляющий пользовательские события для ключевых операций пользователей, и создайте [мост HockeyApp](app-insights-hockeyapp-bridge-app.md).</span><span class="sxs-lookup"><span data-stu-id="76a95-267">If you have a client mobile app, insert some code to send custom events on key user operations, and create a [HockeyApp bridge](app-insights-hockeyapp-bridge-app.md).</span></span> <span data-ttu-id="76a95-268">Создайте запросы в [Аналитике](app-insights-analytics.md) для отображения числа событий и закрепите эти показатели на панели мониторинга.</span><span class="sxs-lookup"><span data-stu-id="76a95-268">Create queries in [Analytics](app-insights-analytics.md) to display the event counts, and pin them to the dashboard.</span></span>

## <a name="example"></a><span data-ttu-id="76a95-269">Пример</span><span class="sxs-lookup"><span data-stu-id="76a95-269">Example</span></span>
<span data-ttu-id="76a95-270">[примере](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService) отслеживается служба, которая имеет веб-роль и две рабочие роли.</span><span class="sxs-lookup"><span data-stu-id="76a95-270">[The example](https://github.com/Microsoft/ApplicationInsights-Home/tree/master/Samples/AzureEmailService) monitors a service that has a web role and two worker roles.</span></span>

## <a name="exception-method-not-found-on-running-in-azure-cloud-services"></a><span data-ttu-id="76a95-271">Исключение "метод не найден" при выполнении в облачных службах Azure</span><span class="sxs-lookup"><span data-stu-id="76a95-271">Exception "method not found" on running in Azure Cloud Services</span></span>
<span data-ttu-id="76a95-272">Выполняется сборка для .NET 4.6?</span><span class="sxs-lookup"><span data-stu-id="76a95-272">Did you build for .NET 4.6?</span></span> <span data-ttu-id="76a95-273">Версия 4.6 не поддерживается автоматически в ролях облачных служб Azure.</span><span class="sxs-lookup"><span data-stu-id="76a95-273">4.6 is not automatically supported in Azure Cloud Services roles.</span></span> <span data-ttu-id="76a95-274">[установите версию 4.6 в каждой роли](../cloud-services/cloud-services-dotnet-install-dotnet.md) .</span><span class="sxs-lookup"><span data-stu-id="76a95-274">[Install 4.6 on each role](../cloud-services/cloud-services-dotnet-install-dotnet.md) before running your app.</span></span>

## <a name="video"></a><span data-ttu-id="76a95-275">Видео</span><span class="sxs-lookup"><span data-stu-id="76a95-275">Video</span></span>

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/100/player]

## <a name="next-steps"></a><span data-ttu-id="76a95-276">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="76a95-276">Next steps</span></span>
* [<span data-ttu-id="76a95-277">Настройка системы диагностики Azure для отправки данных в Application Insights</span><span class="sxs-lookup"><span data-stu-id="76a95-277">Configure sending Azure Diagnostics to Application Insights</span></span>](app-insights-azure-diagnostics.md)
* [<span data-ttu-id="76a95-278">Автоматизация создания ресурсов Application Insights</span><span class="sxs-lookup"><span data-stu-id="76a95-278">Automate creation of Application Insights resources</span></span>](app-insights-powershell.md)
* [<span data-ttu-id="76a95-279">Автоматизация системы диагностики Azure</span><span class="sxs-lookup"><span data-stu-id="76a95-279">Automate Azure diagnostics</span></span>](app-insights-powershell-azure-diagnostics.md)
* [<span data-ttu-id="76a95-280">Функции Azure</span><span class="sxs-lookup"><span data-stu-id="76a95-280">Azure Functions</span></span>](https://github.com/christopheranderson/azure-functions-app-insights-sample)

[api]: app-insights-api-custom-events-metrics.md
[availability]: app-insights-monitor-web-app-availability.md
[azure]: app-insights-azure.md
[client]: app-insights-javascript.md
[diagnostic]: app-insights-diagnostic-search.md
[netlogs]: app-insights-asp-net-trace-logs.md
[portal]: http://portal.azure.com/
[qna]: app-insights-troubleshoot-faq.md
[redfield]: app-insights-monitor-performance-live-website-now.md
[start]: app-insights-overview.md 
