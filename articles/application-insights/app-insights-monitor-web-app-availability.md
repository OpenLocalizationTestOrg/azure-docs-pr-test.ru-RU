---
title: "aaaMonitor доступности и скорости реагирования любого веб-сайта | Документы Microsoft"
description: "Настройка веб-тестов в Application Insights. Получение оповещений, когда веб-сайт становится недоступным или медленно реагирует на запросы."
services: application-insights
documentationcenter: 
author: SoubhagyaDash
manager: carmonm
ms.assetid: 46dc13b4-eb2e-4142-a21c-94a156f760ee
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/25/2017
ms.author: bwren
ms.openlocfilehash: 4c5425c948770cc57a648ca50e217c75ac75fbd7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-availability-and-responsiveness-of-any-web-site"></a>Наблюдение за доступностью и скоростью реагирования веб-сайта
После развертывания веб-приложения или сервера tooany веб-сайтов, можно настроить toomonitor тесты его доступности и скорости реагирования. [Azure Application Insights](app-insights-overview.md) отправляет веб-запросы, приложение tooyour с регулярными интервалами из точек вокруг Здравствуй, мир!. Эта надстройка предупреждает вас, если приложение реагирует медленно или не реагирует вообще.

Доступность тестов можно настроить для любой HTTP или конечной точки HTTPS, доступном hello общедоступный Интернет. У вас нет tooadd всего toohello веб-сайта, которое вы тестируете. Он даже не toobe веб-узла: можно проверить REST API службы, от которого зависят.

Существует два вида тестов доступности:

* [URL-адрес проверки связи](#create): простой тест, созданный в hello портал Azure.
* [Многоэтапный веб-теста](#multi-step-web-tests): создаваемая в Visual Studio Enterprise и передачи toohello портала.

Можно создать копии too25 тестов доступности для каждого ресурса приложения.

## <a name="create"></a>1. Открытие ресурса для отчетов по тестам доступности

**Если вы уже настроили Application Insights** для веб-приложения откройте его ресурс Application Insights в hello [портал Azure](https://portal.azure.com).

**Или, если требуется toosee отчетов в новый ресурс,** зарегистрироваться слишком[Microsoft Azure](http://azure.com), go toohello [портал Azure](https://portal.azure.com)и создать ресурс Application Insights.

![Создать > Application Insights](./media/app-insights-monitor-web-app-availability/11-new-app.png)

Нажмите кнопку **все ресурсы** tooopen hello Обзор колонке hello новый ресурс.

## <a name="setup"></a>2. Создание теста проверки связи с URL-адресом
Откройте колонку доступности hello и добавить тест.

![Заливка по крайней мере hello URL-адрес веб-сайта](./media/app-insights-monitor-web-app-availability/13-availability.png)

* **URL-адрес Hello** может быть любой веб-страницы требуется tootest, но он должен быть виден из hello общедоступный Интернет. Hello URL-адрес может включать строку запроса. поэтому вы, например, сможете немного поупражняться в работе с базой данных. Если URL-адрес hello разрешается tooa перенаправления, мы дальнейшие too10 перенаправления.
* **Синтаксический анализ зависимые запросы**: Если этот флажок установлен, тест hello запрашивает образы, сценарии, файлы стилей и другие файлы, которые являются частью веб-страницу приветствия при тестировании. Hello время записи ответа включает tooget время, затраченное hello эти файлы. Hello тест завершается неудачей, если эти ресурсы не могут быть загружены успешно в течение периода ожидания hello для всего теста hello. 

    Если hello флажок не установлен, hello теста только запрашивает hello файл по URL-АДРЕСУ hello указанной.
* **Разрешить повторные попытки**: Если этот флажок установлен, при сбое теста hello, он будет предпринята повторная попытка через небольшой промежуток. Сообщение об ошибке отобразится только после трех неудачных попыток подряд. Затем последующие тесты выполняются с частотой hello обычного теста. Повторите попытку временно приостанавливается до достижения успеха Далее hello. Это правило действует в любом расположении тестирования. Этот вариант является рекомендуемым. В среднем около 80 % неудачных попыток решаются при повторной попытке.
* **Периодичность проверки**: задает, как часто hello тест из расположения каждого теста. При частоте пять минут и с пятью тестовыми расположениями ваш сайт будет проверяться в среднем каждую минуту.
* **Тестовых расположений** являются hello помещает где наши серверы отправляют запросы tooyour URL-адрес. Выберите несколько расположений, чтобы можно было различать проблемы веб-сайта и сетевые проблемы. Можно выбрать копирование too16 расположения.
* **Критерии успешного завершения**:

    **Время ожидания теста**: уменьшить это значение toobe, оповещения о замедление отклика. тест Hello подсчитывается как сбой, если в течение этого периода не были получены ответы hello с веб-узла. Если вы выбрали **проанализировать зависимые запросы**, затем все hello изображения, файлы стилей, сценарии и другие зависимые ресурсы необходимо получено в течение этого периода.

    **HTTP-ответа**: hello, вернул код состояния, который учитывается как успех. 200 — hello код, который указывает, возвращена обычной веб-страницы.

    **Совпадение содержимого**: строка, например «Добро пожаловать!». Проверим наличие точного совпадения (с учетом регистра) в каждом ответе. Это должна быть строка обычного текста без подстановочных знаков. Помните, что если изменения содержимого страницы может потребоваться tooupdate его.
* **Оповещения** по умолчанию отправляются tooyou в случае сбоев в трех местах более пяти минут. Сбой в одном месте — toobe скорее всего, проблема с сетью, а не на проблему с веб-узла. Но вы можете изменить дополнительные toobe пороговое значение hello или меньше символов и можно также изменений, hello сообщения электронной почты должны отправляться.

    Можно настроить вызов [webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md), активируемый оповещением. (Обратите внимание, что в настоящее время параметры запроса не передаются как свойства.)

### <a name="test-more-urls"></a>Тестирование дополнительных URL-адресов
Добавьте дополнительные тесты. Например в дополнение tootesting на домашней странице вы может убедитесь, что базы данных выполняется путем проверки hello URL-адрес для поиска.


## <a name="monitor"></a>3. Просмотр результатов теста доступности

Через несколько минут, нажмите кнопку **обновление** toosee результатов теста. 

![Сводки результатов в колонке домашней hello](./media/app-insights-monitor-web-app-availability/14-availSummary-3.png)

Hello scatterplot показаны примеры hello результатов теста, имеющих сведений диагностики шаг теста в них. Обработчик тестов Hello хранит диагностических сведений для тестов со сбоями. Сведения диагностики хранятся для успешные тесты для подмножества выполнений hello. Наведите курсор на любую hello точек зеленый или красный toosee hello теста timestamp, продолжительность теста, расположение и имя теста. Нажимайте кнопку до любой точки в сведения hello точечной диаграммы toosee hello hello результата теста.  

Выберите конкретный тест, расположение, или уменьшить время hello периода toosee Дополнительные результаты вокруг hello интересующий вас период времени. Используйте обозреватель поиска toosee результатов из всех выполнений, или аналитика запросы toorun пользовательские отчеты на основе этих данных.

В дополнение toohello необработанных результатов существует две метрики доступности в обозревателе метрик. 

1. Доступности: Процент hello тесты, которые были успешно, через все выполнения теста. 
2. Продолжительность теста. Средняя длительность всех тестов.

Можно применить фильтры на имя теста hello, тенденции tooanalyze расположение конкретного теста и/или расположение.

## <a name="edit"></a> Изменение и проверка тестов

На странице сводки hello выберите определенного теста. Здесь можно просмотреть определенные результаты, а также изменить или временно отключить тест.

![Изменение или отключение веб-теста](./media/app-insights-monitor-web-app-availability/19-availEdit-3.png)

Может потребоваться тестов доступности toodisable или hello оповещения, правила, связанные с ними при выполнении обслуживания для службы. 

## <a name="failures"></a>При возникновении сбоев
Щелкните красную точку.

![Щелкните красную точку.](./media/app-insights-monitor-web-app-availability/open-instance-3.png)


С помощью результатов тестов доступности можно сделать следующее:

* Проверьте hello ответ, полученный от сервера.
* Откройте hello телеметрии, отправленные сервером приложения во время обработки экземпляра hello невыполненных запросов.
* Войдите в проблему или рабочих элементов в Git или VSTS проблема tootrack hello. Hello ошибок будет содержать событие toothis связи.
* Привет открыть результат веб-теста в Visual Studio.


*Кажется, что все работает правильно, но выдается отчет об ошибке?* Проверьте все образы hello, сценарии, таблицы стилей и другие файлы, загруженные страницы приветствия. Если любой из них происходит сбой, hello теста учитывается как сбой, даже если ОК загрузке hello html для главной страницы.

*Связанные элементы отсутствуют?* Если служба Application Insights настроена для серверного приложения, возможно, это произошло из-за [выборки](app-insights-sampling.md) в операции. 

## <a name="multi-step-web-tests"></a>Многошаговые веб-тесты
Вы можете отслеживать сценарий, который содержит последовательность URL-адресов. Например при наблюдении за продажу веб-сайта, можно проверить, добавление элементов toohello корзину работает правильно.

> [!NOTE] 
> За многошаговые веб-тесты взимается плата. См. [таблицу расценок](http://azure.microsoft.com/pricing/details/application-insights/).
> 

toocreate нескольких шагов теста вы запись hello сценарий с помощью Visual Studio Enterprise, а затем отправьте hello записи tooApplication аналитики. Application Insights воспроизводит hello сценарий с интервалами и проверяет ответы hello.

> [!NOTE]
> В тестах нельзя использовать запрограммированные функции или циклы. Hello тестирования должна полностью содержаться в скрипте открытии hello. Однако вы можете использовать стандартные подключаемые модули.
>

#### <a name="1-record-a-scenario"></a>1. Запись сценария
Используйте Visual Studio Enterprise toorecord веб-сеанс.

1. Создайте проект веб-теста производительности.

    ![В Visual Studio Enterprise edition создайте проект на основе шаблона веб-тестов производительности и нагрузочных тестов hello.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-create.png)

 * *Нет hello веб-тестов производительности и нагрузочного теста шаблон?* Закройте Visual Studio Enterprise. Откройте **установщик Visual Studio** toomodify установку Visual Studio Enterprise. В разделе **Отдельные компоненты** выберите **Средства для тестирования производительности веб-сайтов и нагрузочного тестирования**.

2. Откройте файл webtest hello и начать запись.

    ![Откройте файл webtest hello и щелкните запись.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-start.png)
3. Здравствуйте, действия пользователя, должны toosimulate в тесте: Откройте веб-сайт, добавить в корзину toohello продукта и т. д. Затем остановите тест.

    ![Hello веб-теста выполняется запись в Internet Explorer.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-record.png)

    Не делайте слишком длинный сценарий. Ограничение — 100 шагов и 2 минуты.
4. Изменение hello тест:

   * Добавление проверки toocheck hello полученных текста и ответа кодов.
   * Удалить все лишние взаимодействия. Можно также удалить зависимые запросы для изображения или tooad или отслеживания сайтов.

     Помните, можно изменить только скрипт теста hello - не удается добавить пользовательский код или вызывать другие веб-тесты. Нельзя вставлять циклы в тесте hello. Вы можете использовать стандартные подключаемые модули для веб-тестов.
5. Запустите тест hello в Visual Studio toomake убедиться, что он работает.

    средства выполнения тестов web Hello открывает веб-браузер и повторяется hello действия, которые были записаны. Убедитесь, что тест работает правильно.

    ![В Visual Studio откройте файл webtest hello и нажмите кнопку выполнить.](./media/app-insights-monitor-web-app-availability/appinsights-71webtest-multi-vs-run.png)

#### <a name="2-upload-hello-web-test-tooapplication-insights"></a>2. Отправка hello web теста tooApplication аналитики
1. Создайте веб-теста на портале Application Insights hello.

    ![В колонке тестов web hello нажмите кнопку "Добавить".](./media/app-insights-monitor-web-app-availability/16-another-test.png)
2. Выберите тест, состоящий из нескольких шагов и отправить файл webtest hello.

    ![Выберите многошаговый веб-тест.](./media/app-insights-monitor-web-app-availability/appinsights-71webtestUpload.png)

    Таким же способом, как и для проверки связи проверяет набор hello замера, частоту и параметры оповещений в hello.

#### <a name="3-see-hello-results"></a>3. Просмотреть результаты hello

Просмотр теста результаты и сбоев hello и те же тесты, так как одному URL-адресу.

Кроме того, можно загрузить tooview результаты теста hello их в Visual Studio.

#### <a name="too-many-failures"></a>Слишком много ошибок?

* Обычно причиной сбоя является hello теста выполняется слишком долго. Тест должен выполняться не более двух минут.

* Не забывайте, что все ресурсы hello страницы необходимо правильно загрузить для тестирования toosucceed hello, включая сценарии, таблицы стилей, изображений и т. д.

* Hello веб-тест должен полностью содержаться в скрипте открытии hello: закодированные функции нельзя использовать в тесте hello.

### <a name="plugging-time-and-random-numbers-into-your-multi-step-test"></a>Вставка времени и случайных чисел в многошаговый тест
Предположим, что вы тестируете инструмент, который получает зависящие от времени данные (например, запасы) от внешнего источника. При записи веб-теста имеется toouse определенное время, но они настроены как тестовые параметры hello StartTime и EndTime.

![Веб-тест с параметрами.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-parameters.png)

При выполнении теста hello, хотелось бы присутствуют всегда toobe hello время EndTime и StartTime должно быть 15 минут назад.

Подключаемые модули веб-теста позволяют hello toodo параметризовать раз.

1. Добавьте подключаемые модули веб-теста для всех необходимых значений переменных параметров. В веб-тест hello инструментов, выберите **добавить подключаемый модуль теста Web**.

    ![Щелкните "Добавить подключаемый модуль веб-теста" и выберите тип.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-plugins.png)

    В этом примере мы используем два экземпляра hello подключаемый модуль время даты. Для первого экземпляра будет задано время за 15 минут до текущего, а для второго — текущее время.
2. Откройте свойства hello каждого подключаемого модуля. Присвойте ему имя и задать для него toouse hello текущее время. Для одного из экземпляров задайте для параметра "Добавление минут" значение "-15".

    ![Задайте имя, выберите "Использовать текущее время" и "Добавить минуты".](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-plugin-parameters.png)
3. В параметры веб-теста hello используйте {{имя подключаемого модуля}} tooreference имя подключаемого модуля.

    ![В параметрах тестирования hello используйте {{имя подключаемого модуля}}.](./media/app-insights-monitor-web-app-availability/appinsights-72webtest-plugin-name.png)

Теперь отправьте портал toohello теста. Он использует hello динамические значения для каждого запуска тестирования hello.

## <a name="dealing-with-sign-in"></a>Работа с входом
Если в приложении tooyour входа пользователей, имеются различные варианты для имитации вход, благодаря чему можно протестировать страницы входа в hello. Hello подход используется зависит от типа hello объекта безопасности, предоставляемый приложение hello.

Во всех случаях следует создать учетную запись только для цели hello тестирования приложения. Если это возможно ограничения hello разрешения этой учетной записи теста, таким образом, чтобы невозможны hello веб-тесты, влияющие на реальных пользователей.

### <a name="simple-username-and-password"></a>Простое имя пользователя и пароль
Запишите веб-теста в hello обычным способом. Сначала удалите файлы cookie.

### <a name="saml-authentication"></a>Проверка подлинности SAML
С помощью подключаемого модуля hello SAML, который доступен для веб-тестов.

### <a name="client-secret"></a>Секрет клиента
Если в приложении предусмотрен маршрут входа с использованием секрета клиента, используйте этот маршрут. Azure Active Directory (AAD) — это пример службы, в которой доступен вход в систему с использованием секрета клиента. В Azure Active Directory hello секрет клиента — hello ключ приложения.

Ниже приведен пример веб-теста веб-приложения Azure с использованием ключа приложения.

![Пример секрета клиента](./media/app-insights-monitor-web-app-availability/110.png)

1. Получите токен из Azure AD с помощью секрета клиента (AppKey).
2. Извлеките токен носителя из ответа.
3. Вызовите API с помощью токена носителя в заголовке авторизации hello.

Убедитесь, что веб-тест hello фактического клиентского - то есть имеет собственное приложение в Azure Active Directory - и используйте его clientId + appkey. Ваша служба тестируемого также имеет собственное приложение в Azure Active Directory: hello appID URI этого приложения будет отражено в веб-тест hello в поле «ресурс» hello.

### <a name="open-authentication"></a>Открытая проверка подлинности
Пример открытой проверки подлинности — это вход с помощью учетной записи Майкрософт или Google. Многие приложения, используйте предоставляют OAuth hello вместо секрета клиента, поэтому на первый прием должно быть tooinvestigate эту возможность.

Если тест необходимо выполнить вход с использованием OAuth, имеет общий подход hello:

* С помощью средства, например Fiddler tooexamine hello трафика между веб-браузере, сайт проверки подлинности hello и приложения.
* Выполнение двух или более входа в систему с использованием разных компьютерах или браузеры, либо в длинные интервалы времени (tooexpire tooallow токены).
* Сравнивая различных сеансах, определите hello токен передается обратно из hello проверки подлинности узла, который затем передается сервером приложения tooyour после входа в систему.
* Запишите веб-тест с помощью Visual Studio.
* Параметризовать hello токены, параметр hello при hello маркер возвращается из проверки подлинности hello и его использовании hello toohello запросы на сайт.
  (Visual Studio пытается tooparameterize hello теста, но не правильно параметризовать токены hello.)


## <a name="performance-tests"></a>Тесты производительности
Вы можете выполнить на своем веб-сайте нагрузочный тест. Тестирование доступности hello вы можете отправлять простые запросы или запросы многоступенчатый из наших точек вокруг Здравствуй, мир!. В отличие от теста доступности, отправляется много запросов, что имитирует несколько одновременно работающих пользователей.

В колонке Обзор hello, откройте **параметры**, **тесты производительности**. При создании теста вы приглашены tooconnect tooor создать учетную запись Visual Studio Team Services.

После завершения теста hello отображаются время отклика и показатели успеха.


![тест производительности;](./media/app-insights-monitor-web-app-availability/perf-test.png)

> [!TIP]
> эффекты hello tooobserve теста производительности, используйте [обновляющегося потока](app-insights-live-stream.md) и [профилировщика](app-insights-profiler.md).
>

## <a name="automation"></a>Служба автоматизации
* [Использовать tooset сценариев PowerShell копирование тест доступности](app-insights-powershell.md#add-an-availability-test) автоматически.
* Настройте вызов [webhook](../monitoring-and-diagnostics/insights-webhooks-alerts.md), активируемый оповещением.

## <a name="qna"></a>Вопросы? Проблемы?
* *Можно ли вызывать код из моего веб-теста?*

    Нет. Hello шаги теста hello должен находиться в файл webtest hello. Кроме того, нельзя вызывать другие веб-тесты и использовать циклы. Но есть несколько подключаемых модулей, которые могут оказаться полезными.
* *Поддерживается ли протокол HTTPS?*

    Мы поддерживаем TLS 1.1 и TLS 1.2.
* *Есть ли разница между понятиями «веб-тесты» и «тесты доступности»?*

    Hello двух слов может ссылаться на равных основаниях. Доступность проверяет, что более универсальный термин, который включает один URL-адрес ping hello Кроме проверяет toohello многоэтапной веб-тестов.
* *Я хочу тестов доступности toouse на нашем внутреннего сервера, работающей за брандмауэром.*

    Есть два возможных решения:
    
    * Настройка вашего брандмауэра toopermit входящие запросы от hello [IP-адресов нашими веб-агенты тестирования](app-insights-ip-addresses.md).
    * Написать собственный код tooperiodically тест внутреннего сервера. Выполнение кода hello в виде фонового процесса на тестовом сервере за брандмауэром. Процесс тестирования могут отправлять свои результаты tooApplication аналитики с помощью [TrackAvailability()](https://docs.microsoft.com/dotnet/api/microsoft.applicationinsights.telemetryclient.trackavailability) API в пакете SDK core hello. Для этого тестового сервера toohave исходящего доступа toohello Application Insights приема конечной точки, но это гораздо меньшего размера угрозу безопасности, чем hello возможность разрешить входящие запросы. Hello результаты не будут отображаться в колонках тестов web доступности hello, но отображается как результаты доступности аналитика, поиска и обозреватель метрики.
* *Сбой отправки многошагового веб-теста.*

    Максимальный размер — 300 000.

    Циклы не поддерживаются.

    Ссылки на tooother веб-тесты, не поддерживаются.

    Источники данных не поддерживаются.
* *Мой многошаговый тест не выполняется.*

    Максимальное количество запросов в тесте — 100.

    Hello теста останавливается, если он выполняется дольше, чем двух минут.
* *Как запустить тест с клиентскими сертификатами?*

    К сожалению, эта возможность не поддерживается.


## <a name="next"></a>Дальнейшие действия
[Поиск по журналу диагностики в Application Insights][diagnostic]

[Устранение неполадок][qna]

[IP-адреса веб-агентов тестирования](app-insights-ip-addresses.md)

<!--Link references-->

[azure-availability]: ../insights-create-web-tests.md
[diagnostic]: app-insights-diagnostic-search.md
[qna]: app-insights-troubleshoot-faq.md
[start]: app-insights-overview.md
