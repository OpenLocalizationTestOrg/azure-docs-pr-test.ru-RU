---
title: "Анализ использования веб-приложений с помощью Azure Application Insights | Документы Майкрософт"
description: "Изучение пользователей и их действий с веб-приложением."
services: application-insights
documentationcenter: 
author: botatoes
manager: carmonm
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 05/03/2017
ms.author: bwren
ms.openlocfilehash: 63b74399790b718e14a5b6e09bc009a336caf928
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="usage-analysis-for-web-applications-with-application-insights"></a>Анализ использования для веб-приложений с помощью Application Insights

Какие функции веб-приложения наиболее популярны? Достигают ли пользователи своих целей с помощью вашего приложения? Уходят ли они в определенные моменты и возвращаются ли после этого?  [Azure Application Insights](app-insights-overview.md) помогает получить важные сведения о том, как люди используют ваше веб-приложение. Каждый раз, обновив приложение, можно оценить, насколько хорошо оно подходит пользователям. Обладая такими сведениями, можно принять решения на основе данных по дальнейшим циклам разработки.

## <a name="send-telemetry-from-your-app"></a>Отправка телеметрии из приложения

Максимальное удобство работы достигается путем установки Application Insights как в серверном коде приложения, так и на веб-страницах. Клиентские и серверные компоненты приложения отправляют данные телеметрии на портал Azure для анализа.

1. **Серверный код:** установите соответствующий модуль для своего приложения [ASP.NET](app-insights-asp-net.md), [Azure](app-insights-azure.md), [Java](app-insights-java-get-started.md), [Node.js](app-insights-nodejs.md) или приложения [иного типа](app-insights-platforms.md).

    * *Не хотите устанавливать серверный код? Просто [создайте ресурс Azure Application Insights](app-insights-create-new-resource.md).*

2. **Код веб-страницы:** откройте [портал Azure](https://portal.azure.com), откройте ресурс Application Insights для приложения, а затем выберите **Начало работы > Мониторинг и диагностика приложения на стороне клиента**. 

    ![Скопируйте скрипт в заголовок главной веб-страницы.](./media/app-insights-usage-overview/02-monitor-web-page.png)


3. **Получение данных телеметрии:** запустите проект в режиме отладки на несколько минут, а затем просмотрите результаты в колонке "Обзор" в Application Insights.

    Опубликуйте ваше приложение для отслеживания его производительности и узнайте, что делают с ним пользователи.

## <a name="include-user-and-session-id-in-your-telemetry"></a>Добавление идентификатора пользователя и сеанса к телеметрии
Для долговременного отслеживания пользователей Application Insights требуется способ их идентификации. Инструмент "События" — это единственный инструмент использования, не требующий идентификатор пользователя или сеанса.

Приступите к отправке этих идентификаторов [сюда](https://docs.microsoft.com/azure/application-insights/app-insights-usage-send-user-context).

## <a name="explore-usage-demographics-and-statistics"></a>Изучение демографических данных об использовании и статистики
Узнайте, когда люди используют ваше приложение, какие страницы им наиболее интересны, где находятся ваши пользователи, какие браузеры и операционные системы они используют. 

Отчеты о пользователях и сеансах позволяют фильтровать данные по страницам или пользовательским событиям, а также разделять их по свойствам, таким как расположение, среда и страница. Можно также добавить собственные фильтры.

![Пользователи](./media/app-insights-usage-overview/users.png)  

Аналитические сведения справа позволяют выделять важные закономерности в наборе данных.  

* В отчете **Пользователи** подсчитывается количество уникальных пользователей, которые обращаются к страницам в выбранные периоды времени. (Пользователи подсчитываются с помощью файлов cookie. Если какой-либо пользователь обращается к вашему сайту, используя различные браузеры или клиентские компьютеры, или очищает файлы cookie, то он будет учтен более одного раза.)
* В отчете **Сеансы** подсчитывается количество пользовательских сеансов, обращающихся к узлу. Сеанс — это период действий пользователя, завершающийся периодом бездействия более получаса.

[Дополнительные сведения об инструментах "Пользователи", "Сеансы" и "События".](app-insights-usage-segmentation.md)  

## <a name="page-views"></a>Просмотры страниц

В колонке "Использование" щелкайте "Просмотры страницы", чтобы получить статистику по наиболее популярным страницам.

![В колонке обзора щелкните диаграмму "Просмотры страниц"](./media/app-insights-usage-overview/05-games.png)

Приведенный выше пример взят с игрового веб-сайта. На диаграммах можно сразу же увидеть следующее:

* Использование не увеличилось за прошлую неделю. Возможно, стоит задуматься о поисковой оптимизации?
* "Теннис" является наиболее популярной игрой. Этой странице следует отдать приоритет в улучшениях.
* В среднем пользователи посещают страницу "Теннис" примерно три раза в неделю. (Сеансов примерно в три раза больше, чем пользователей.)
* Большинство пользователей посещают сайт в рабочие дни и часы. Возможно, следует добавить на веб-страницу кнопку для быстрого ее скрытия.
* В [заметках](app-insights-annotations.md) на диаграмме указывается, когда были развернуты новые версии веб-сайта. Последние развернутые версии не оказали заметного влияния на использование.

Что делать, если вы хотите более подробно изучить трафик своего сайта, например, разделив его по пользовательскому свойству, которое сайт отправляет в данных телеметрии просмотра страниц?

1. Откройте инструмент **События** в меню ресурса Application Insights. Этот инструмент позволяет проанализировать, сколько просмотров страниц и пользовательских событий было отправлено из приложения, используя разнообразные параметры фильтров, когорт и сегментов.
2. Из раскрывающегося списка "Которые использовали" выберите "Any Page View" (Просмотр любой страницы).
3. Из раскрывающегося списка "Разделение по" выберите свойство, по которому нужно разделить данные телеметрии просмотра страниц.

## <a name="retention---how-many-users-come-back"></a>Период удержания — сколько пользователей вернулось?

Период удержания помогает понять, как часто пользователи возвращаются к использованию своего приложения. Для этого используются когорты пользователей, которые выполнили какое-либо коммерческое действие во время определенного горизонта планирования. 

- Поймите, какие именно функции заставляют пользователей возвращаться чаще, чем другие. 
- Сформируйте гипотезу на основе данных реальных пользователей. 
- Определите, является ли период удержания проблемой для вашего продукта. 

![Сохранение](./media/app-insights-usage-overview/retention.png) 

Помимо прочего, элементы управления периодом удержания позволяют определить конкретные события и диапазон времени для вычисления периода удержания. График в середине дает визуальное представление об общем проценте удержания за указанный диапазон времени. График внизу отображает период удержания отдельных пользователей за заданный период времени. Такой уровень детализации позволяет лучше понять, что ваши пользователи делают и что может повлиять на возвращение пользователей.  

[Дополнительные сведения об инструменте "Хранение"](app-insights-usage-retention.md).

## <a name="custom-business-events"></a>Пользовательские бизнес-события

Чтобы получить четкое представление о действиях пользователей с веб-приложением, полезно добавить строки кода для ведения журнала пользовательских событий. Эти события могут отслеживать что угодно, начиная с детализированных действий пользователя (например, нажатие определенных кнопок) и заканчивая более серьезными бизнес-событиями (например, совершение покупки или победа в игре). 

Хотя в некоторых случаях просмотры страниц могут представлять собой полезные события, но в целом это не так. Пользователь может открыть страницу продукта, не приобретая его. 

С помощью специальных бизнес-событий можно создать диаграмму перемещения пользователей по сайту. Можно узнать их предпочтения относительно различных параметров, а также определить, где они покидают сайт или испытывают сложности. Обладая такими сведениями, можно принимать обоснованные решения о приоритетах для невыполненной работы по разработке.

Журнал событий можно вести на веб-странице.

```JavaScript

    appInsights.trackEvent("ExpandDetailTab", {DetailTab: tabName});
```

Или на стороне сервера веб-приложения.

```C#
    var tc = new Microsoft.ApplicationInsights.TelemetryClient();
    tc.TrackEvent("CreatedAccount", new Dictionary<string,string> {"AccountType":account.Type}, null);
    ...
    tc.TrackEvent("AddedItemToCart", new Dictionary<string,string> {"Item":item.Name}, null);
    ...
    tc.TrackEvent("CompletedPurchase");
```

В эти события можно вложить значения свойств, чтобы события можно было фильтровать или разделять при изучении на портале. Кроме того, в каждое событие вкладывается стандартный набор свойств, например идентификатор анонимного пользователя, который позволяет выполнять трассировку последовательности действий отдельного пользователя.

Узнайте больше о [пользовательских событиях](app-insights-api-custom-events-metrics.md#trackevent) и [свойствах](app-insights-api-custom-events-metrics.md#properties).

### <a name="slice-and-dice-events"></a>Анализ событий

В инструментах "Пользователи", "Сеансы" и "События" можно анализировать пользовательские события по пользователю, имени события и свойствам.
![Пользователи](./media/app-insights-usage-overview/users.png)  
  
## <a name="design-the-telemetry-with-the-app"></a>Разработка телеметрии приложения

При разработке каждого компонента приложения обдумайте, как вы будете измерять его успех у пользователей. Решите, какие бизнес-события необходимо записывать, и с самого начала запрограммируйте вызовы отслеживания для этих событий в приложении.

## <a name="a--b-testing"></a>Тестирование A или B 
Если неизвестно, какой вариант функции будет более эффективен, выпустите их оба, чтобы каждый из них был доступен для разных пользователей. Измерьте успешность каждого варианта, а затем перейдите к единой версии.

В рамках этого способа необходимо вложить разные значения свойств во все данные телеметрии, отправляемые каждой версией приложения. Для этого нужно определить свойства в активном контексте телеметрии TelemetryContext. Эти свойства по умолчанию добавляются к каждому сообщению телеметрии, которое отправляет приложение, — не только к настраиваемым сообщениям, но также к стандартным данным телеметрии.

Чтобы сравнить различные версии, на портале Application Insights можно отфильтровать и разделить данные по значениям свойств.

Для этого следует [настроить инициализатор телеметрии](app-insights-api-filtering-sampling.md##add-properties-itelemetryinitializer).

```C#


    // Telemetry initializer class
    public class MyTelemetryInitializer : ITelemetryInitializer
    {
        public void Initialize (ITelemetry telemetry)
        {
            telemetry.Properties["AppVersion"] = "v2.1";
        }
    }
```

В инициализаторе веб-приложения, например Global.asax.cs, добавьте следующий код.

```C#

    protected void Application_Start()
    {
        // ...
        TelemetryConfiguration.Active.TelemetryInitializers
        .Add(new MyTelemetryInitializer());
    }
```

Все новые клиенты телеметрии автоматически добавляют указанное значение свойства. Отдельные события телеметрии могут переопределять значения по умолчанию.

## <a name="next-steps"></a>Дальнейшие действия
   - [Пользователи, сеансы, события](app-insights-usage-segmentation.md)
   - [Воронки](usage-funnels.md)
   - [Сохранение](app-insights-usage-retention.md)
   - [Средство "Маршруты пользователей"](app-insights-usage-flows.md)
   - [Книги](app-insights-usage-workbooks.md)
   - [Добавление контекста пользователей](app-insights-usage-send-user-context.md)
