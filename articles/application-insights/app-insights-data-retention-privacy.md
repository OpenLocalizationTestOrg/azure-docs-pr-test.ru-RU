---
title: "Хранилища и хранение данных в Azure Application Insights | Документация Майкрософт"
description: "Заявление о политике хранении и конфиденциальности"
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.assetid: a6268811-c8df-42b5-8b1b-1d5a7e94cbca
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 04/07/2017
ms.author: bwren
ms.openlocfilehash: ddb9fa516da66da0484619439848583a29e1f5c1
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="data-collection-retention-and-storage-in-application-insights"></a>Сбор и хранение данных в Application Insights


После установки в приложение пакет SDK для [Azure Application Insights][start] отправляет данные телеметрии приложения в облако. Естественно, ответственные разработчики хотят знать, какие именно данные отправляются, что с ними происходит и как ими управлять. В частности, возникают следующие вопросы: можно ли отправлять конфиденциальные данные, где они хранятся и насколько это безопасно? 

Ответ прост.

* Для отправки конфиденциальных данных в службу лучше не использовать телеметрические модули со стандартными настройками. Телеметрия включает метрики нагрузки, производительности и использования, отчеты об исключениях и другие диагностические данные. Основными пользовательскими данными, которые отображаются в диагностических отчетах, являются URL-адреса. Однако приложение в любом случае не должно помещать конфиденциальные данные в URL-адрес в виде обычного текста.
* Можно написать код, который будет отправлять дополнительные пользовательские телеметрические данные для диагностики и мониторинга (эта расширяемость — одна из полезных возможностей Application Insights). По ошибке код может включать в себя личные и другие конфиденциальные данные. Если приложение работает с такими данными, то следует тщательно проверять весь написанный код.
* При разработке и тестировании приложения можно легко проверить, какие именно данные отправляются с помощью пакета SDK. Данные отображаются в окнах вывода отладочных данных IDE и браузера. 
* Данные хранятся на серверах [Microsoft Azure](http://azure.com) в США или Европе. (При этом ваше приложение может выполняться где угодно.) Azure применяет [надежные процедуры обеспечения безопасности и соответствует целому ряду стандартов](https://azure.microsoft.com/support/trust-center/). Доступ к данным будет только у вас и вашей команды. Сотрудникам Майкрософт может предоставляться ограниченный доступ к данным только при определенных условиях и с вашего ведома. Данные шифруются при передаче, а не на серверах.

Далее в статье эта тема рассматривается более подробно. Эта статья содержит все необходимые сведения, поэтому вы можете показывать ее коллегам, которые не работают непосредственно с вами.

## <a name="what-is-application-insights"></a>Что такое Azure Application Insights?
[Azure Application Insights][start] — это служба Майкрософт, которая помогает повысить производительность и удобство использования активного приложения. Она отслеживает приложение на протяжении всего времени его работы: как на этапе тестирования, так и после публикации или развертывания. Application Insights создает диаграммы и таблицы, которые могут отображать различные данные: например, в какое время дня у вас наибольшее число пользователей, насколько быстро приложение отвечает на запросы и насколько хорошо оно обслуживается внешними службами, от которых зависит. В случае сбоев, ошибок или проблем с производительностью можно более детально просмотреть телеметрические данные, чтобы определить причину проблемы. Кроме этого, в случае каких-либо изменений в доступности и производительности приложения служба будет отправлять вам по электронной почте соответствующие уведомления.

Чтобы использовать эту возможность, установите в приложение пакет SDK Application Insights, который интегрируется с кодом приложения. Когда приложение запущено, пакет SDK отслеживает его работу и отправляет телеметрические данные в службу Application Insights. Это облачная служба, размещенная в [Microsoft Azure](http://azure.com). (Application Insights работает для любых приложений, а не только тех, которые размещены в Azure.)

![Пакет SDK в приложении отправляет телеметрические данные в службу Application Insights.](./media/app-insights-data-retention-privacy/01-scheme.png)

Служба Application Insights хранит и анализирует телеметрические данные. Для просмотра результатов анализа или поиска в сохраненных телеметрических данных войдите в учетную запись Azure и откройте в окне приложения ресурс Application Insights. Доступ к данным также можно предоставить другим участникам команды или определенным подписчикам Azure.

Данные можно экспортировать из службы Application Insights — к примеру, в базу данных или на внешние устройства. Каждому устройству можно назначить специальный ключ, предоставляемый службой. При необходимости ключ можно отменить. 

Пакеты SDK Application Insights доступны для разных типов приложений: веб-служб, размещенных на ваших собственных серверах J2EE или ASP.NET или в Azure, веб-клиентов (то есть кода, выполняемого на веб-странице), классических приложений и служб, а также приложений для устройств (например, Windows Phone, iOS и Android). Все они отправляют телеметрические данные в одну и ту же службу.

## <a name="what-data-does-it-collect"></a>Какие данные собираются?
### <a name="how-is-the-data-is-collected"></a>Как собираются данные?
Есть три источника данных:

* Пакет SDK, который вы интегрируете в свое приложение [во время разработки](app-insights-asp-net.md) или [в среде выполнения](app-insights-monitor-performance-live-website-now.md). Существуют разные пакеты SDK для различных типов приложений. Также есть [пакет SDK для веб-страниц](app-insights-javascript.md), который загружается в браузер конечного пользователя вместе со страницей.
  
  * В каждый пакет SDK входит ряд [модулей](app-insights-configuration-with-applicationinsights-config.md), которые используют различные методики для сбора разных типов телеметрических данных.
  * Если пакет SDK устанавливается на этапе разработки, для отправки собственных телеметрических данных, помимо стандартных модулей, можно использовать API. Такая пользовательские телеметрические данные могут включать все данные, которые требуется отправить.
* На некоторых веб-серверах также установлены агенты, которые работают вместе с приложениями и отправляют телеметрические данные о ЦП, памяти и загрузке сети. Например, такие агенты могут быть установлены на виртуальных машинах Azure, узлах Docker и [серверах J2EE](app-insights-java-agent.md) .
* [Тесты доступности](app-insights-monitor-web-app-availability.md) — это процессы, выполняемые компанией Майкрософт, которые отправляют запросы к веб-приложению через одинаковые интервалы. Результаты отправляются в службу Application Insights.

### <a name="what-kinds-of-data-are-collected"></a>Какие типы данных собираются?
Вот основные категории данных.

* [Телеметрия веб-сервера](app-insights-asp-net.md) : HTTP-запросы.  URI, время обработки запроса, код ответа, IP-адрес клиента. Идентификатор сеанса.
* [Веб-страницы](app-insights-javascript.md) : количество страниц, пользователей и сеансов. Время загрузки страницы. Исключения. Вызовы AJAX.
* Счетчики производительности: загрузка памяти, ЦП, сети, количество операций ввода-вывода.
* Контекст клиента и сервера: ОС, языковой стандарт, тип устройства, браузер и разрешение экрана.
* [Исключения](app-insights-asp-net-exceptions.md) и сбои: **дампы стека**, идентификатор сборки и тип процессора. 
* [Зависимости](app-insights-asp-net-dependencies.md) : вызовы внешних служб, например REST, SQL и AJAX. URI или строка подключения, длительность, успешное выполнение, команда.
* [Тесты доступности](app-insights-monitor-web-app-availability.md) : длительность теста и его шагов, ответы.
* [Журналы трассировки](app-insights-asp-net-trace-logs.md) и [пользовательские данные телеметрии](app-insights-api-custom-events-metrics.md):  - **все данные, которые программно добавляются в журналы или данные телеметрии**.

[Дополнительные сведения](#data-sent-by-application-insights).

## <a name="how-can-i-verify-whats-being-collected"></a>Как проверить, какие именно данные собираются?
Если приложение разрабатывается в Visual Studio, запустите приложение в режиме отладки (F5). Телеметрические данные появятся в окне вывода. Оттуда их можно скопировать, отформатировать как файл JSON и быстро проверить. 

![](./media/app-insights-data-retention-privacy/06-vs.png)

В окне диагностики также есть более удобное для чтения представление.

В случае с веб-страницами, откройте окно отладки в браузере.

![Нажмите клавишу F12 и откройте вкладку «Сеть».](./media/app-insights-data-retention-privacy/08-browser.png)

### <a name="can-i-write-code-to-filter-the-telemetry-before-it-is-sent"></a>Можно ли написать код, чтобы отфильтровать телеметрические данные перед отправкой?
Можно написать [подключаемый модуль обработчика телеметрических данных](app-insights-api-filtering-sampling.md).

## <a name="how-long-is-the-data-kept"></a>Как долго хранятся данные?
Необработанные точки данных (то есть элементы, которые можно запросить в Аналитике и проверить с помощью Поиска) хранятся в течение 90 дней. Если требуется хранить данные дольше, можно использовать [непрерывный экспорт](app-insights-export-telemetry.md) , чтобы копировать их в учетную запись хранения.

Статистические данные (то есть счетчики, средние значения и другие статистические данные, которые отображаются в обозревателе метрик) сохраняются со степенью детализации в 1 минуту в течение 90 дней.

## <a name="who-can-access-the-data"></a>Кто может получить доступ к данным?
Данные видны вам и, если у вас есть учетная запись организации, членам вашей группы. 

Вы и члены группы могут их экспортировать и скопировать в другое место, а также передать другим пользователям.

#### <a name="what-does-microsoft-do-with-the-information-my-app-sends-to-application-insights"></a>Что корпорация Майкрософт делает с данными, которые мое приложение отправляет службе Application Insights?
Корпорация Майкрософт использует данные только для предоставления вам возможностей службы.

## <a name="where-is-the-data-held"></a>Где хранятся данные?
* В США и Европе. Расположение можно выбрать при создании нового ресурса Application Insights. 


#### <a name="does-that-mean-my-app-has-to-be-hosted-in-the-usa-or-europe"></a>Значит ли это, что мое приложение должно размещаться в США или Европе?
* Нет. Ваше приложение может выполняться где угодно, будь то ваш собственный локальный узел или облако.

## <a name="how-secure-is-my-data"></a>Насколько защищены мои данные?
Application Insights — это служба Azure. Политики безопасности описаны в [техническом документе Azure о безопасности, конфиденциальности и соответствии требованиям](http://go.microsoft.com/fwlink/?linkid=392408).

Данные хранятся на серверах Microsoft Azure. Ограничения для учетных записей на портале Azure описаны в документе [Безопасность, конфиденциальность и соответствие нормативам Azure](http://go.microsoft.com/fwlink/?linkid=392408).

Доступ к данным сотрудников Майкрософт ограничен. Доступ производится только с вашего разрешения и в случае, если это необходимо для поддержки использования вами Application Insights. 

Совокупные данные от приложений всех наших клиентов (например, скорость передачи данных и средний размер трассировок) используются для улучшения Application Insights.

#### <a name="could-someone-elses-telemetry-interfere-with-my-application-insights-data"></a>Могут ли данные телеметрии другого пользователя повлиять на мои данные Application Insights?
Дополнительные данные телеметрии могут отправляться в вашу учетную запись с помощью ключа инструментирования, который можно найти в коде веб-страниц. При достаточном объеме дополнительных данных вашим метрики неправильно представляют производительность и использование приложения.

Если вы совместно используете код в других проектах, не забудьте удалить ключ инструментирования.

## <a name="is-the-data-encrypted"></a>Шифруются ли данные?
В настоящее время данные на серверах не шифруются.

Все данные шифруются при перемещении между центрами обработки данных.

#### <a name="is-the-data-encrypted-in-transit-from-my-application-to-application-insights-servers"></a>Данные шифруются при передаче из приложения на серверы Application Insights?
Да, мы используем HTTPS для отправки данных на портал практически из всех пакетов SDK, включая веб-серверы, устройства и веб-страницы HTTPS. Единственное исключение — данные, отправляемые с простых веб-страниц HTTP. 

## <a name="personally-identifiable-information"></a>Персональные данные
#### <a name="could-personally-identifiable-information-pii-be-sent-to-application-insights"></a>Будет ли персонально идентифицируемая информация отправляться в Application Insights?
Да, это возможно. 

Общее руководство:

* Большинство стандартных данных телеметрии (которые отправляются без написания кода) не содержит явных персональных данных. Однако возможна идентификация отдельных пользователей за счет применения коллекции событий.
* Исключения и сообщения трассировки могут содержать личные данные.
* Пользовательские данные телеметрии (вызовы, такие как TrackEvent, добавленные в код с помощью API-интерфейса, или трассировки журнала) могут содержать любые выбранные вами данные.

Таблица в конце этого документа содержит более подробное описание собираемых данных.

#### <a name="am-i-responsible-for-complying-with-laws-and-regulations-in-regard-to-pii"></a>Несу ли я ответственность за соблюдение законов и нормативов в отношении персональных данных?
Да. На вас лежит ответственность за то, чтобы убедиться, что сбор и использование данных соответствует законам и нормативам, а также требованиям использования Microsoft Online Services.

Вам следует соответствующим образом проинформировать клиентов о данных, которые ваше приложение собирает, и о том, как они используются.

#### <a name="can-my-users-turn-off-application-insights"></a>Могут ли мои пользователи отключить Application Insights?
Не напрямую. Мы не предоставляем параметр, с помощью которого пользователи могут отключить Application Insights.

Однако вы можете реализовать такую возможность в своем приложении. Все пакеты SDK содержат параметр API, который отключает сбор данных телеметрии. 

#### <a name="my-application-is-unintentionally-collecting-sensitive-information-can-application-insights-scrub-this-data-so-it-isnt-retained"></a>Мое приложение непреднамеренно собирает конфиденциальные сведения. Может ли Application Insights удалить их?
Application Insights не фильтрует и не удаляет данные. Вам следует правильно управлять данными и предотвращать отправку таких данных службе Application Insights.

## <a name="data-sent-by-application-insights"></a>Данные, передаваемые службой Application Insights
На разных платформах пакеты SDK различаются, при этом существует несколько компонентов, которые можно установить. (Ознакомьтесь с [обзором Application Insights][start].) Каждый компонент отправляет различные данные.

#### <a name="classes-of-data-sent-in-different-scenarios"></a>Классы данных, передаваемых в различных сценариях
| Ваше действие | Собираемые классы данных (см. следующую таблицу) |
| --- | --- |
| [Добавление пакета SDK для Application Insights в веб-проект .NET][greenbrown] |ServerContext<br/>Выводимые<br/>Счетчики производительности<br/>Запросы<br/>**Исключения**<br/>Сеанс<br/>users |
| [Установка монитора состояния на сервере IIS][redfield] |Зависимости<br/>ServerContext<br/>Выводимые<br/>Счетчики производительности |
| [Добавление пакета SDK для Application Insights в веб-приложение Java][java] |ServerContext<br/>Выводимые<br/>Запрос<br/>Сеанс<br/>users |
| [Добавление пакета SDK для JavaScript на веб-страницу][client] |ClientContext <br/>Выводимые<br/>Страница<br/>ClientPerf<br/>Ajax |
| [Определение свойств по умолчанию][apiproperties] |**Свойства** всех стандартных и настраиваемых событий |
| [Вызов TrackMetric][api] |Числовые значения<br/>**Свойства** |
| [Вызов Track*][api] |Имя события<br/>**Свойства** |
| [Вызов TrackException][api] |**Исключения**<br/>Дамп стека<br/>**Свойства** |
| Пакету SDK не может собрать данные. Например: <br/> не удается получить доступ к счетчикам производительности;<br/> порождается исключение в инициализаторе телеметрии. |Диагностика SDK |

Сведения о [пакетах SDK для других платформ][platforms] можно получить в соответствующей документации.

#### <a name="the-classes-of-collected-data"></a>Классы собираемых данных
| Собираемый класс данных | Включает (неисчерпывающий список) |
| --- | --- |
| **Свойства** |**Все данные — определяется кодом** |
| DeviceContext |Идентификатор, IP-адрес, языковой стандарт, модель устройства, сеть, тип сети, имя изготовителя оборудования, разрешение экрана, экземпляр роли, имя роли, тип устройства |
| ClientContext |ОС, языковой стандарт, язык, сеть, разрешение окна |
| Сеанс |идентификатор сеанса |
| ServerContext |Имя компьютера, языковой стандарт, ОС, устройство, сеанс пользователя, контекст пользователя, операция |
| Выводимые |географическое расположение на основе IP-адреса, отметка времени, ОС, браузер |
| Метрики |Имя и значение метрики |
| События |Имя и значение события |
| PageViews |URL-адрес и имя страницы или имя экрана |
| Производительность клиента |URL-адрес или имя страницы, время загрузки браузера |
| Ajax |Вызовы HTTP от веб-страницы на сервер |
| Запросы |URL-адрес, длительность, код ответа |
| Зависимости |Тип (SQL, HTTP,...), строка подключения или URI, синхронный или асинхронный, длительность, успех, инструкция SQL (с монитором состояния) |
| **Исключения** |Тип, **сообщения**, стеки вызовов, исходный файл и номер строки, идентификатор потока |
| Сбои |Код процесса, код родительского процесса, код потока сбоя, исправление приложения, идентификатор, сборка, тип исключения, адрес, причина, скрытые символы и регистры, начальный и конечный двоичный адрес, имя и путь двоичного файла, тип ЦП |
| Трассировка |**Сообщение** и уровень серьезности |
| Счетчики производительности |Время процессора, объем доступной памяти, частота запросов, скорость исключения, байтов исключительного пользования процесса, скорость ввода-вывода, длительность запроса, длина очереди запросов |
| Доступность |Код ответа веб-теста, длительность каждого шага теста, имя теста, метка времени, успешное завершение, время отклика, расположение теста. |
| Диагностика SDK |Сообщение трассировки или исключение |

Вы можете [отключить некоторые данные, изменив файл ApplicationInsights.config][config].

## <a name="credits"></a>Баллы
Этот продукт содержит данные GeoLite2, созданные MaxMind и доступные на веб-сайте [http://www.maxmind.com](http://www.maxmind.com).



<!--Link references-->

[api]: app-insights-api-custom-events-metrics.md
[apiproperties]: app-insights-api-custom-events-metrics.md#properties
[client]: app-insights-javascript.md
[config]: app-insights-configuration-with-applicationinsights-config.md
[greenbrown]: app-insights-asp-net.md
[java]: app-insights-java-get-started.md
[platforms]: app-insights-platforms.md
[pricing]: http://azure.microsoft.com/pricing/details/application-insights/
[redfield]: app-insights-monitor-performance-live-website-now.md
[start]: app-insights-overview.md

