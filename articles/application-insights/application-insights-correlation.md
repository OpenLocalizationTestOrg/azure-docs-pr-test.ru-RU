---
title: "aaaAzure корреляции телеметрии аналитики приложений | Документы Microsoft"
description: "Корреляция данных телеметрии Application Insights"
services: application-insights
documentationcenter: .net
author: SergeyKanzhelev
manager: carmonm
ms.service: application-insights
ms.workload: TBD
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 04/25/2017
ms.author: bwren
ms.openlocfilehash: 3ed8c589d237cac5daceac939ca893b7d81a2967
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="telemetry-correlation-in-application-insights"></a><span data-ttu-id="8f141-103">Корреляция данных телеметрии в Application Insights</span><span class="sxs-lookup"><span data-stu-id="8f141-103">Telemetry correlation in Application Insights</span></span>

<span data-ttu-id="8f141-104">В Здравствуй, мир micro службы каждой логической операции требует работу с разными компонентами службы hello.</span><span class="sxs-lookup"><span data-stu-id="8f141-104">In hello world of micro services, every logical operation requires work done in various components of hello service.</span></span> <span data-ttu-id="8f141-105">Служба [Application Insights](app-insights-overview.md) может отдельно отслеживать каждый из этих компонентов.</span><span class="sxs-lookup"><span data-stu-id="8f141-105">Each of these components can be separately monitored by [Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="8f141-106">Hello веб-приложения компонента взаимодействует с учетными данными пользователя toovalidate компонент поставщика проверки подлинности и с данными tooget hello API компонентов для визуализации.</span><span class="sxs-lookup"><span data-stu-id="8f141-106">hello web app component communicates with authentication provider component toovalidate user credentials, and with hello API component tooget data for visualization.</span></span> <span data-ttu-id="8f141-107">компонент API Hello в свою очередь можно запрашивать данные из других служб и использовать компоненты поставщика кэша и уведомить hello выставления счетов компонентом, об этом вызове.</span><span class="sxs-lookup"><span data-stu-id="8f141-107">hello API component in its turn can query data from other services and use cache-provider components and notify hello billing component about this call.</span></span> <span data-ttu-id="8f141-108">Application Insights поддерживает распределенную корреляцию данных телеметрии.</span><span class="sxs-lookup"><span data-stu-id="8f141-108">Application Insights supports distributed telemetry correlation.</span></span> <span data-ttu-id="8f141-109">Она позволяет toodetect, какой компонент отвечает за сбоями или снижения производительности.</span><span class="sxs-lookup"><span data-stu-id="8f141-109">It allows you toodetect which component is responsible for failures or performance degradation.</span></span>

<span data-ttu-id="8f141-110">В этой статье описываются hello использует модель, toocorrelate телеметрии Application Insights отправлены в нескольких компонентах.</span><span class="sxs-lookup"><span data-stu-id="8f141-110">This article explains hello data model used by Application Insights toocorrelate telemetry sent by multiple components.</span></span> <span data-ttu-id="8f141-111">Рассматриваются методы распространения контекста hello и протоколов.</span><span class="sxs-lookup"><span data-stu-id="8f141-111">It covers hello context propagation techniques and protocols.</span></span> <span data-ttu-id="8f141-112">Она также охватывает hello реализации концепций корреляции hello на разных языках и платформах.</span><span class="sxs-lookup"><span data-stu-id="8f141-112">It also covers hello implementation of hello correlation concepts on different languages and platforms.</span></span>

## <a name="telemetry-correlation-data-model"></a><span data-ttu-id="8f141-113">Модель корреляции данных телеметрии</span><span class="sxs-lookup"><span data-stu-id="8f141-113">Telemetry correlation data model</span></span>

<span data-ttu-id="8f141-114">Application Insights определяет [модель данных](application-insights-data-model.md) для распределенной корреляции данных телеметрии.</span><span class="sxs-lookup"><span data-stu-id="8f141-114">Application Insights defines a [data model](application-insights-data-model.md) for distributed telemetry correlation.</span></span> <span data-ttu-id="8f141-115">tooassociate телеметрии с логической операции hello, каждый элемент телеметрии имеет поле контекста с именем `operation_Id`.</span><span class="sxs-lookup"><span data-stu-id="8f141-115">tooassociate telemetry with hello logical operation, every telemetry item has a context field called `operation_Id`.</span></span> <span data-ttu-id="8f141-116">Этот идентификатор совместно используется каждый элемент данных телеметрии в трассировке распределенных hello.</span><span class="sxs-lookup"><span data-stu-id="8f141-116">This identifier is shared by every telemetry item in hello distributed trace.</span></span> <span data-ttu-id="8f141-117">Поэтому даже в случае потери телеметрии из одного уровня вы по-прежнему можете связывать данные телеметрии, сообщаемые другими компонентами.</span><span class="sxs-lookup"><span data-stu-id="8f141-117">So even with loss of telemetry from a single layer you still can associate telemetry reported by other components.</span></span>

<span data-ttu-id="8f141-118">Распределенные логической операции обычно состоит из набора операций меньше - запросов, обрабатываемых одним из компонентов hello.</span><span class="sxs-lookup"><span data-stu-id="8f141-118">Distributed logical operation typically consists of a set of smaller operations - requests processed by one of hello components.</span></span> <span data-ttu-id="8f141-119">Эти операции определяются [телеметрией запросов](application-insights-data-model-request-telemetry.md).</span><span class="sxs-lookup"><span data-stu-id="8f141-119">Those operations are defined by [request telemetry](application-insights-data-model-request-telemetry.md).</span></span> <span data-ttu-id="8f141-120">Каждый элемент телеметрии запросов имеет собственный уникальный `id`, который его глобально идентифицирует.</span><span class="sxs-lookup"><span data-stu-id="8f141-120">Every request telemetry has its own `id` that uniquely globally identifies it.</span></span> <span data-ttu-id="8f141-121">И все данные телеметрии - трассировок, исключения, связанного с этим запросом и т.д. необходимо задать hello `operation_parentId` toohello значение hello запроса `id`.</span><span class="sxs-lookup"><span data-stu-id="8f141-121">And all telemetry - traces, exceptions, etc. associated with this request should set hello `operation_parentId` toohello value of hello request `id`.</span></span>

<span data-ttu-id="8f141-122">Каждый исходящий операции, например, http вызов tooanother компонента, представленного объектом [телеметрии зависимости](application-insights-data-model-dependency-telemetry.md).</span><span class="sxs-lookup"><span data-stu-id="8f141-122">Every outgoing operation like http call tooanother component represented by [dependency telemetry](application-insights-data-model-dependency-telemetry.md).</span></span> <span data-ttu-id="8f141-123">Телеметрия зависимостей также определяет собственный `id`, который является глобально уникальным.</span><span class="sxs-lookup"><span data-stu-id="8f141-123">Dependency telemetry also defines its own `id` that is globally unique.</span></span> <span data-ttu-id="8f141-124">Телеметрия запросов, инициированная этим вызовом зависимостей, использует его в качестве `operation_parentId`.</span><span class="sxs-lookup"><span data-stu-id="8f141-124">Request telemetry, initiated by this dependency call, uses it as `operation_parentId`.</span></span>

<span data-ttu-id="8f141-125">Можно создать представление hello использования распределенной логической операции `operation_Id`, `operation_parentId`, и `request.id` с `dependency.id`.</span><span class="sxs-lookup"><span data-stu-id="8f141-125">You can build hello view of distributed logical operation using `operation_Id`, `operation_parentId`, and `request.id` with `dependency.id`.</span></span> <span data-ttu-id="8f141-126">Эти поля также определять порядок причинно-следственных связей hello вызовов телеметрии.</span><span class="sxs-lookup"><span data-stu-id="8f141-126">Those fields also define hello causality order of telemetry calls.</span></span>

<span data-ttu-id="8f141-127">В среде служб micro трассировки из компонентов может перейти в различных хранилищах toohello.</span><span class="sxs-lookup"><span data-stu-id="8f141-127">In micro services environment, traces from components may go toohello different storages.</span></span> <span data-ttu-id="8f141-128">Каждый компонент может иметь свой собственный ключ инструментирования в Application Insights.</span><span class="sxs-lookup"><span data-stu-id="8f141-128">Every component may have its own instrumentation key in Application Insights.</span></span> <span data-ttu-id="8f141-129">tooget данные телеметрии для логическую операцию hello, требуются tooquery данные из каждого хранилища.</span><span class="sxs-lookup"><span data-stu-id="8f141-129">tooget telemetry for hello logical operation, you need tooquery data from every storage.</span></span> <span data-ttu-id="8f141-130">При огромное число систем хранения данных необходимо toohave подсказку о том, где toolook Далее.</span><span class="sxs-lookup"><span data-stu-id="8f141-130">When number of storages is huge, you need toohave a hint on where toolook next.</span></span>

<span data-ttu-id="8f141-131">Application Insights, модели анализа данных определяет два поля toosolve этой проблемы: `request.source` и `dependency.target`.</span><span class="sxs-lookup"><span data-stu-id="8f141-131">Application Insights data model defines two fields toosolve this problem: `request.source` and `dependency.target`.</span></span> <span data-ttu-id="8f141-132">Первое поле Hello определяет hello компонент, который инициировал запрос hello зависимостей, а hello второй определяет какой компонент вернул ответ hello вызова зависимостей hello.</span><span class="sxs-lookup"><span data-stu-id="8f141-132">hello first field identifies hello component that initiated hello dependency request, and hello second identifies which component returned hello response of hello dependency call.</span></span>


## <a name="example"></a><span data-ttu-id="8f141-133">Пример</span><span class="sxs-lookup"><span data-stu-id="8f141-133">Example</span></span>

<span data-ttu-id="8f141-134">Рассмотрим пример приложения STOCK цен, показывающая hello текущего рыночной цены акций, с помощью внешнего API hello вызывается API биржевые СВОДКИ.</span><span class="sxs-lookup"><span data-stu-id="8f141-134">Let's take an example of an application STOCK PRICES showing hello current market price of a stock using hello external API called STOCKS API.</span></span> <span data-ttu-id="8f141-135">Hello ЦЕНЫ АКЦИЙ приложения имеет страницу `Stock page` открываемые hello клиента веб-браузера с помощью `GET /Home/Stock`.</span><span class="sxs-lookup"><span data-stu-id="8f141-135">hello STOCK PRICES application has a page `Stock page` opened by hello client web browser using `GET /Home/Stock`.</span></span> <span data-ttu-id="8f141-136">запросы приложения Hello hello STOCK API с помощью вызова HTTP `GET /api/stock/value`.</span><span class="sxs-lookup"><span data-stu-id="8f141-136">hello application queries hello STOCK API by using an HTTP call `GET /api/stock/value`.</span></span>

<span data-ttu-id="8f141-137">Вы можете проанализировать итоговые данные телеметрии, выполнив запрос:</span><span class="sxs-lookup"><span data-stu-id="8f141-137">You can analyze resulting telemetry running a query:</span></span>

```
(requests | union dependencies | union pageViews) 
| where operation_Id == "STYz"
| project timestamp, itemType, name, id, operation_ParentId, operation_Id
```

<span data-ttu-id="8f141-138">В примечании представление hello результат, что все данные телеметрии элементы обычно имеют корневой hello `operation_Id`.</span><span class="sxs-lookup"><span data-stu-id="8f141-138">In hello result view note that all telemetry items share hello root `operation_Id`.</span></span> <span data-ttu-id="8f141-139">При вызове метода ajax сделанных страница hello — новый уникальный идентификатор `qJSXU` телеметрия зависимостей назначенный toohello и идентификатор элемента pageView используется как `operation_ParentId`.</span><span class="sxs-lookup"><span data-stu-id="8f141-139">When ajax call made from hello page - new unique id `qJSXU` is assigned toohello dependency telemetry and pageView's id is used as `operation_ParentId`.</span></span> <span data-ttu-id="8f141-140">В свою очередь запрос сервера использует идентификатор AJAX в качестве `operation_ParentId`, и т. д.</span><span class="sxs-lookup"><span data-stu-id="8f141-140">In turn server request uses ajax's id as `operation_ParentId`, etc.</span></span>

| <span data-ttu-id="8f141-141">itemType</span><span class="sxs-lookup"><span data-stu-id="8f141-141">itemType</span></span>   | <span data-ttu-id="8f141-142">name</span><span class="sxs-lookup"><span data-stu-id="8f141-142">name</span></span>                      | <span data-ttu-id="8f141-143">id</span><span class="sxs-lookup"><span data-stu-id="8f141-143">id</span></span>           | <span data-ttu-id="8f141-144">operation_ParentId</span><span class="sxs-lookup"><span data-stu-id="8f141-144">operation_ParentId</span></span> | <span data-ttu-id="8f141-145">operation_Id</span><span class="sxs-lookup"><span data-stu-id="8f141-145">operation_Id</span></span> |
|------------|---------------------------|--------------|--------------------|--------------|
| <span data-ttu-id="8f141-146">pageView</span><span class="sxs-lookup"><span data-stu-id="8f141-146">pageView</span></span>   | <span data-ttu-id="8f141-147">Stock page</span><span class="sxs-lookup"><span data-stu-id="8f141-147">Stock page</span></span>                |              | <span data-ttu-id="8f141-148">STYz</span><span class="sxs-lookup"><span data-stu-id="8f141-148">STYz</span></span>               | <span data-ttu-id="8f141-149">STYz</span><span class="sxs-lookup"><span data-stu-id="8f141-149">STYz</span></span>         |
| <span data-ttu-id="8f141-150">dependency</span><span class="sxs-lookup"><span data-stu-id="8f141-150">dependency</span></span> | <span data-ttu-id="8f141-151">GET /Home/Stock</span><span class="sxs-lookup"><span data-stu-id="8f141-151">GET /Home/Stock</span></span>           | <span data-ttu-id="8f141-152">qJSXU</span><span class="sxs-lookup"><span data-stu-id="8f141-152">qJSXU</span></span>        | <span data-ttu-id="8f141-153">STYz</span><span class="sxs-lookup"><span data-stu-id="8f141-153">STYz</span></span>               | <span data-ttu-id="8f141-154">STYz</span><span class="sxs-lookup"><span data-stu-id="8f141-154">STYz</span></span>         |
| <span data-ttu-id="8f141-155">запрос</span><span class="sxs-lookup"><span data-stu-id="8f141-155">request</span></span>    | <span data-ttu-id="8f141-156">GET Home/Stock</span><span class="sxs-lookup"><span data-stu-id="8f141-156">GET Home/Stock</span></span>            | <span data-ttu-id="8f141-157">KqKwlrSt9PA=</span><span class="sxs-lookup"><span data-stu-id="8f141-157">KqKwlrSt9PA=</span></span> | <span data-ttu-id="8f141-158">qJSXU</span><span class="sxs-lookup"><span data-stu-id="8f141-158">qJSXU</span></span>              | <span data-ttu-id="8f141-159">STYz</span><span class="sxs-lookup"><span data-stu-id="8f141-159">STYz</span></span>         |
| <span data-ttu-id="8f141-160">dependency</span><span class="sxs-lookup"><span data-stu-id="8f141-160">dependency</span></span> | <span data-ttu-id="8f141-161">GET /api/stock/value</span><span class="sxs-lookup"><span data-stu-id="8f141-161">GET /api/stock/value</span></span>      | <span data-ttu-id="8f141-162">bBrf2L7mm2g=</span><span class="sxs-lookup"><span data-stu-id="8f141-162">bBrf2L7mm2g=</span></span> | <span data-ttu-id="8f141-163">KqKwlrSt9PA=</span><span class="sxs-lookup"><span data-stu-id="8f141-163">KqKwlrSt9PA=</span></span>       | <span data-ttu-id="8f141-164">STYz</span><span class="sxs-lookup"><span data-stu-id="8f141-164">STYz</span></span>         |

<span data-ttu-id="8f141-165">Теперь, когда hello вызовов `GET /api/stock/value` внесенные tooan внешней службы требуется удостоверение hello tooknow этого сервера.</span><span class="sxs-lookup"><span data-stu-id="8f141-165">Now when hello call `GET /api/stock/value` made tooan external service you want tooknow hello identity of that server.</span></span> <span data-ttu-id="8f141-166">Поэтому можно соответствующим образом задать поле `dependency.target`.</span><span class="sxs-lookup"><span data-stu-id="8f141-166">So you can set `dependency.target` field appropriately.</span></span> <span data-ttu-id="8f141-167">Если внешняя служба hello не поддерживает мониторинг - `target` задается имя узла toohello hello службы как `stock-prices-api.com`.</span><span class="sxs-lookup"><span data-stu-id="8f141-167">When hello external service does not support monitoring - `target` is set toohello host name of hello service like `stock-prices-api.com`.</span></span> <span data-ttu-id="8f141-168">Однако если этой службы определяет себя, возвращая предварительно определенный заголовок HTTP - `target` содержит удостоверение службы hello, позволяющий toobuild распределенных трассировки Application Insights, запрашивая данные телеметрии из этой службы.</span><span class="sxs-lookup"><span data-stu-id="8f141-168">However if that service identifies itself by returning a predefined HTTP header - `target` contains hello service identity that allows Application Insights toobuild distributed trace by querying telemetry from that service.</span></span> 

## <a name="correlation-headers"></a><span data-ttu-id="8f141-169">Заголовки корреляции</span><span class="sxs-lookup"><span data-stu-id="8f141-169">Correlation headers</span></span>

<span data-ttu-id="8f141-170">Мы работаем над предложение RFC для hello [корреляции протокол HTTP](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v1.md).</span><span class="sxs-lookup"><span data-stu-id="8f141-170">We are working on RFC proposal for hello [correlation HTTP protocol](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v1.md).</span></span> <span data-ttu-id="8f141-171">Это предложение определяет два заголовка:</span><span class="sxs-lookup"><span data-stu-id="8f141-171">This proposal defines two headers:</span></span>

- <span data-ttu-id="8f141-172">`Request-Id`выполнение hello глобально уникальный идентификатор вызова hello</span><span class="sxs-lookup"><span data-stu-id="8f141-172">`Request-Id` carry hello globally unique id of hello call</span></span>
- <span data-ttu-id="8f141-173">`Correlation-Context`-выполнение hello имя пары коллекции значение свойства трассировки распределенного hello</span><span class="sxs-lookup"><span data-stu-id="8f141-173">`Correlation-Context` - carry hello name value pairs collection of hello distributed trace properties</span></span>

<span data-ttu-id="8f141-174">Стандартная Hello также определяет две схемы из `Request-Id` поколения - плоской и иерархической.</span><span class="sxs-lookup"><span data-stu-id="8f141-174">hello standard also defines two schemas of `Request-Id` generation - flat and hierarchical.</span></span> <span data-ttu-id="8f141-175">Схема неструктурированного hello, производится с известным `Id` ключ, определенный для hello `Correlation-Context` коллекции.</span><span class="sxs-lookup"><span data-stu-id="8f141-175">With hello flat schema, there is a well-known `Id` key defined for hello `Correlation-Context` collection.</span></span>

<span data-ttu-id="8f141-176">Application Insights определяет hello [расширения](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v2.md) для корреляции hello протокол HTTP.</span><span class="sxs-lookup"><span data-stu-id="8f141-176">Application Insights defines hello [extension](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v2.md) for hello correlation HTTP protocol.</span></span> <span data-ttu-id="8f141-177">Она использует `Request-Context` имя пары "значение" hello toopropagate коллекцию свойств, используемых hello непосредственного вызывающего или вызываемого объекта.</span><span class="sxs-lookup"><span data-stu-id="8f141-177">It uses `Request-Context` name value pairs toopropagate hello collection of properties used by hello immediate caller or callee.</span></span> <span data-ttu-id="8f141-178">Пакет SDK для Application Insights использует этот заголовок tooset `dependency.target` и `request.source` поля.</span><span class="sxs-lookup"><span data-stu-id="8f141-178">Application Insights SDK uses this header tooset `dependency.target` and `request.source` fields.</span></span>

## <a name="open-tracing-and-application-insights"></a><span data-ttu-id="8f141-179">OpenTracing и Application Insights</span><span class="sxs-lookup"><span data-stu-id="8f141-179">Open tracing and Application Insights</span></span>

<span data-ttu-id="8f141-180">Модели данных [OpenTracing](http://opentracing.io/) и Application Insights выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8f141-180">[Open Tracing](http://opentracing.io/) and Application Insights data models looks</span></span> 

- <span data-ttu-id="8f141-181">`request`, `pageView` сопоставляет слишком**диапазон** с`span.kind = server`</span><span class="sxs-lookup"><span data-stu-id="8f141-181">`request`, `pageView` maps too**Span** with `span.kind = server`</span></span>
- <span data-ttu-id="8f141-182">`dependency`Сопоставляет слишком**диапазон** с`span.kind = client`</span><span class="sxs-lookup"><span data-stu-id="8f141-182">`dependency` maps too**Span** with `span.kind = client`</span></span>
- <span data-ttu-id="8f141-183">`id`из `request` и `dependency` сопоставляет слишком**Span.Id**</span><span class="sxs-lookup"><span data-stu-id="8f141-183">`id` of a `request` and `dependency` maps too**Span.Id**</span></span>
- <span data-ttu-id="8f141-184">`operation_Id`Сопоставляет слишком**числовое обозначение TraceId**</span><span class="sxs-lookup"><span data-stu-id="8f141-184">`operation_Id` maps too**TraceId**</span></span>
- <span data-ttu-id="8f141-185">`operation_ParentId`Сопоставляет слишком**ссылки** типа`ChileOf`</span><span class="sxs-lookup"><span data-stu-id="8f141-185">`operation_ParentId` maps too**Reference** of type `ChileOf`</span></span>

<span data-ttu-id="8f141-186">В [этой статье](application-insights-data-model.md) представлены типы данных и модель данных для Application Insights.</span><span class="sxs-lookup"><span data-stu-id="8f141-186">See [data model](application-insights-data-model.md) for Application Insights types and data model.</span></span>

<span data-ttu-id="8f141-187">Определения основных понятий OpenTracing см. в [спецификации](https://github.com/opentracing/specification/blob/master/specification.md) и [соглашениях о семантике](https://github.com/opentracing/specification/blob/master/semantic_conventions.md).</span><span class="sxs-lookup"><span data-stu-id="8f141-187">See [specification](https://github.com/opentracing/specification/blob/master/specification.md) and [semantic_conventions](https://github.com/opentracing/specification/blob/master/semantic_conventions.md) for definitions of Open Tracing concepts.</span></span>


## <a name="telemetry-correlation-in-net"></a><span data-ttu-id="8f141-188">Корреляция данных телеметрии в .NET</span><span class="sxs-lookup"><span data-stu-id="8f141-188">Telemetry correlation in .NET</span></span>

<span data-ttu-id="8f141-189">Со временем .NET определено несколько способов toocorrelate телеметрии и диагностики журналы.</span><span class="sxs-lookup"><span data-stu-id="8f141-189">Over time .NET defined number of ways toocorrelate telemetry and diagnostics logs.</span></span> <span data-ttu-id="8f141-190">Отсутствует `System.Diagnostics.CorrelationManager` разрешение tootrack [LogicalOperationStack и ActivityId](https://msdn.microsoft.com/library/system.diagnostics.correlationmanager.aspx).</span><span class="sxs-lookup"><span data-stu-id="8f141-190">There is `System.Diagnostics.CorrelationManager` allowing tootrack [LogicalOperationStack and ActivityId](https://msdn.microsoft.com/library/system.diagnostics.correlationmanager.aspx).</span></span> <span data-ttu-id="8f141-191">`System.Diagnostics.Tracing.EventSource`и Windows ETW определить метод hello [SetCurrentThreadActivityId](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.setcurrentthreadactivityid.aspx).</span><span class="sxs-lookup"><span data-stu-id="8f141-191">`System.Diagnostics.Tracing.EventSource` and Windows ETW define hello method [SetCurrentThreadActivityId](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.setcurrentthreadactivityid.aspx).</span></span> <span data-ttu-id="8f141-192">`ILogger` использует [области журналов](https://docs.microsoft.com/aspnet/core/fundamentals/logging#log-scopes).</span><span class="sxs-lookup"><span data-stu-id="8f141-192">`ILogger` uses [Log Scopes](https://docs.microsoft.com/aspnet/core/fundamentals/logging#log-scopes).</span></span> <span data-ttu-id="8f141-193">WCF и HTTP подключают распространение "текущего" контекста.</span><span class="sxs-lookup"><span data-stu-id="8f141-193">WCF and Http wire up "current" context propagation.</span></span>

<span data-ttu-id="8f141-194">Однако эти методы не обеспечивали поддержку автоматической распределенной трассировки.</span><span class="sxs-lookup"><span data-stu-id="8f141-194">However those methods didn't enable automatic distributed tracing support.</span></span> <span data-ttu-id="8f141-195">`DiagnosticsSource`выполняется toosupport способом автоматически кросс-машины корреляции.</span><span class="sxs-lookup"><span data-stu-id="8f141-195">`DiagnosticsSource` is a way toosupport automatic cross machine correlation.</span></span> <span data-ttu-id="8f141-196">Библиотеки .NET поддержки диагностики источников и разрешить автоматическое межкомпьютерные распространение hello корреляции контекста через hello транспортного протокола, например http.</span><span class="sxs-lookup"><span data-stu-id="8f141-196">.NET libraries support Diagnostics Source and allow automatic cross machine propagation of hello correlation context via hello transport like http.</span></span>

<span data-ttu-id="8f141-197">Hello [руководство tooActivities](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) в диагностике источника объясняет основы hello отслеживание действий.</span><span class="sxs-lookup"><span data-stu-id="8f141-197">hello [guide tooActivities](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) in Diagnostics Source explains hello basics of tracking Activities.</span></span> 

<span data-ttu-id="8f141-198">ASP.NET Core 2.0 поддерживает извлечение заголовков Http и запуск нового действия "hello".</span><span class="sxs-lookup"><span data-stu-id="8f141-198">ASP.NET Core 2.0 supports extraction of Http Headers and starting hello new Activity.</span></span> 

<span data-ttu-id="8f141-199">`System.Net.HttpClient`начальной версии `<fill in>` поддерживает автоматическое внедрение hello корреляции заголовки Http и отслеживания hello вызовов http как действие.</span><span class="sxs-lookup"><span data-stu-id="8f141-199">`System.Net.HttpClient` starting version `<fill in>` supports automatic injection of hello correlation Http Headers and tracking hello http call as an Activity.</span></span>

<span data-ttu-id="8f141-200">Новый модуль Http [Microsoft.AspNet.TelemetryCorrelation](https://www.nuget.org/packages/Microsoft.AspNet.TelemetryCorrelation/) для hello классический ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8f141-200">There is a new Http Module [Microsoft.AspNet.TelemetryCorrelation](https://www.nuget.org/packages/Microsoft.AspNet.TelemetryCorrelation/) for hello ASP.NET Classic.</span></span> <span data-ttu-id="8f141-201">Этот модуль реализует корреляцию данных телеметрии с помощью DiagnosticsSource.</span><span class="sxs-lookup"><span data-stu-id="8f141-201">This module implements telemetry correlation using DiagnosticsSource.</span></span> <span data-ttu-id="8f141-202">Он запускает действие, исходя их заголовков входящего запроса.</span><span class="sxs-lookup"><span data-stu-id="8f141-202">It starts activity based on incoming request headers.</span></span> <span data-ttu-id="8f141-203">Он также сопоставляет телеметрии из hello разные этапы обработки запроса.</span><span class="sxs-lookup"><span data-stu-id="8f141-203">It also correlates telemetry from hello different stages of request processing.</span></span> <span data-ttu-id="8f141-204">Даже в тех случаях, hello при запуске каждого из этапов обработки IIS в потоках различных управление.</span><span class="sxs-lookup"><span data-stu-id="8f141-204">Even for hello cases when every stage of IIS processing runs on a different manage threads.</span></span>

<span data-ttu-id="8f141-205">Начальной версии пакета SDK аналитики приложений `2.4.0-beta1` использует телеметрии toocollect DiagnosticsSource и активности и связать его с текущим действием hello.</span><span class="sxs-lookup"><span data-stu-id="8f141-205">Application Insights SDK starting version `2.4.0-beta1` uses DiagnosticsSource and Activity toocollect telemetry and associate it with hello current activity.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="8f141-206">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="8f141-206">Next steps</span></span>

- [<span data-ttu-id="8f141-207">API Application Insights для пользовательских событий и метрик</span><span class="sxs-lookup"><span data-stu-id="8f141-207">Write custom telemetry</span></span>](app-insights-api-custom-events-metrics.md)
- <span data-ttu-id="8f141-208">Подключите все компоненты своей микрослужбы с помощью Application Insights.</span><span class="sxs-lookup"><span data-stu-id="8f141-208">Onboard all components of your micro service on Application Insights.</span></span> <span data-ttu-id="8f141-209">Ознакомьтесь со сведениями о [поддерживаемых платформах](app-insights-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="8f141-209">Check out [supported platforms](app-insights-platforms.md).</span></span>
- <span data-ttu-id="8f141-210">В [этой статье](application-insights-data-model.md) представлены типы данных и модель данных для Application Insights.</span><span class="sxs-lookup"><span data-stu-id="8f141-210">See [data model](application-insights-data-model.md) for Application Insights types and data model.</span></span>
- <span data-ttu-id="8f141-211">Узнайте, каким образом слишком[расширения и фильтровать данные телеметрии](app-insights-api-filtering-sampling.md).</span><span class="sxs-lookup"><span data-stu-id="8f141-211">Learn how too[extend and filter telemetry](app-insights-api-filtering-sampling.md).</span></span>
