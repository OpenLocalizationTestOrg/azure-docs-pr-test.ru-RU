---
title: "Обнаружение и оценка локальных виртуальных машин VMware для миграции в Azure с помощью службы \"Миграция Azure\" | Документация Майкрософт"
description: "В этой статье описывается, как обнаруживать и оценивать локальные виртуальные машины VMware для миграции в Azure с помощью службы \"Миграция Azure\"."
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: tutorial
ms.date: 01/08/2018
ms.author: raynew
ms.openlocfilehash: a5019d3f729f2efbd01fca021b0089c7f99b0014
ms.sourcegitcommit: 9a8b9a24d67ba7b779fa34e67d7f2b45c941785e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2018
---
# <a name="discover-and-assess-on-premises-vmware-vms-for-migration-to-azure"></a>Обнаружение и оценка локальных виртуальных машин VMware для миграции в Azure

Службы [Миграция Azure](migrate-overview.md) выполняют оценку локальных рабочих нагрузок для миграции в Azure.

Из этого руководства вы узнаете, как выполнять такие задачи:

> [!div class="checklist"]
> * Создайте проект службы "Миграция Azure".
> * Настройте локальную виртуальную машину сборщика для обнаружения локальных виртуальных машин VMware для оценки.
> * Сгруппируйте виртуальные машины и создайте оценку.


Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.


## <a name="prerequisites"></a>Необходимые компоненты

- **VMware.** Управление виртуальными машинами, которые планируется перенести, должно осуществляться с помощью vCenter Server версии 5.5, 6.0 или 6.5. Кроме того, необходим один узел ESXi версии 5.0 или более поздней для развертывания виртуальной машины сборщика. 
 
> [!NOTE]
> Вскоре мы планируем реализовать поддержку Hyper-V. 

- **Учетная запись vCenter Server.** Для доступа к серверу vCenter Server требуется учетная запись, предназначенная только для чтения. Служба "Миграция Azure" использует эту учетную запись для обнаружения локальных виртуальных машин.
- **Разрешения.** На сервере vCenter Server вам потребуются разрешения для создания виртуальной машины путем импорта OVA-файла. 
- **Параметры статистики.** Перед началом развертывания для сервера vCenter Server нужно задать параметры статистики уровня 3. Если указать уровень ниже 3, оценка будет работать, но данные о производительности хранилища и сети собираться не будут. Рекомендации по размеру в этом случае будут основаны на данных производительности ЦП и памяти, а также на данных конфигурации диска и сетевых адаптеров. 

## <a name="log-in-to-the-azure-portal"></a>Войдите на портал Azure.
Войдите на [портал Azure](https://portal.azure.com).

## <a name="create-a-project"></a>Создание проекта

1. На портале Azure щелкните **Создать ресурс**.
2. Выполните поиск по фразе **Миграция Azure** и в результатах поиска выберите службу **Azure Migrate (preview)** (Миграция Azure (предварительная версия)). Затем щелкните **Создать**.
3. Укажите имя проекта и подписку Azure для него.
4. Создайте новую группу ресурсов.
5. Укажите расположение для создания проекта и нажмите кнопку **Создать**. Проект службы "Миграция Azure" для данной предварительной версии можно создать только в регионе "Центральная часть США". При этом по-прежнему можно планировать перенос в любое целевое расположение Azure. Метаданные, собранные с локальных виртуальных машин, хранятся только в расположении, которое задано для проекта. 

    ![Служба "Миграция Azure"](./media/tutorial-assessment-vmware/project-1.png)
    


## <a name="download-the-collector-appliance"></a>Скачивание модуля сборщика

Служба "Миграция Azure" создает локальную виртуальную машину, известную как модуль сборщика. Эта виртуальная машина обнаруживает локальные виртуальные машины VMware и отправляет метаданные о них в службу "Миграция Azure". Чтобы настроить модуль сборщика, скачайте OVA-файл и импортируйте его на локальный сервер vCenter Server для создания виртуальной машины.

1. В проекте службы "Миграция Azure" щелкните **Начало работы** > **Обнаружение и оценка** > **Обнаружение компьютеров**.
2. В окне **Обнаружение компьютеров** щелкните **Скачать**, чтоб скачать OVA-файл.
3. В окне **Копирование учетных данных проекта** скопируйте идентификатор и ключ проекта. Они потребуются при настройке сборщика.

    ![Скачивание OVA-файла](./media/tutorial-assessment-vmware/download-ova.png)

### <a name="verify-the-collector-appliance"></a>Проверка модуля сборщика

Прежде чем развертывать OVA-файл, убедитесь, что он не поврежден.

1. На компьютере, на который был скачан файл, откройте командное окно с правами администратора.
2. Выполните следующую команду, чтобы создать хэш OVA-файла.
    - ```C:\>CertUtil -HashFile <file_location> [Hashing Algorithm]```
    - Пример использования: ```C:\>CertUtil -HashFile C:\AzureMigrate\AzureMigrate.ova SHA256```
3. Созданный хэш должен соответствовать этим параметрам.
    
    Для OVA-файла версии 1.0.8.49:
    **Алгоритм** | **Значение хэша**
    --- | ---
    MD5 | 8779eea842a1ac465942295c988ac0c7 
    SHA1 | c136c52a0f785e1fd98865e16479dd103704887d
    SHA256 | 5143b1144836f01dd4eaf84ff94bc1d2c53f51ad04b1ca43ade0d14a527ac3f9

    Для OVA-файла версии 1.0.8.40:

    **Алгоритм** | **Значение хэша**
    --- | ---
    MD5 |afbae5a2e7142829659c21fd8a9def3f
    SHA1 | 1751849c1d709cdaef0b02a7350834a754b0e71d
    SHA256 | d093a940aebf6afdc6f616626049e97b1f9f70742a094511277c5f59eacc41ad

## <a name="create-the-collector-vm"></a>Создание виртуальной машины сборщика

Импортируйте скачанный файл на сервер vCenter Server.

1. В консоли клиента vSphere щелкните **File** (Файл)  >  **Deploy OVF Template** (Развернуть шаблон OVF).

    ![Развертывание шаблона OVF](./media/tutorial-assessment-vmware/vcenter-wizard.png)

2. В мастере развертывания шаблона OVF выберите **Source** (Источник) и укажите расположение OVA-файла.
3. В полях**Name** (Имя) и **Location** (Расположение) укажите понятное имя виртуальной машины сборщика и объект инвентаризации, в котором будет размещена эта виртуальная машина.
5. В поле **Host/Cluster** (Узел или кластер) укажите узел или кластер, в котором будет выполняться виртуальная машина сборщика.
7. В поле "Storage" (Хранилище) укажите место хранения данных виртуальной машины сборщика.
8. В поле **Disk Format** (Формат диска) укажите тип и размер диска.
9. В поле **Network Mapping** (Сетевое сопоставление) укажите сеть, к которой будет подключена виртуальная машина сборщика. Этой сети требуется подключение к Интернету для отправки метаданных в Azure. 
10. Просмотрите и подтвердите параметры, а затем нажмите кнопку **Finish** (Готово).

## <a name="run-the-collector-to-discover-vms"></a>Запуск сборщика для обнаружения виртуальных машин

1. В консоли клиента vSphere щелкните правой кнопкой мыши виртуальную машину и выберите **Open Console** (Открыть консоль).
2. Укажите язык, часовой пояс и параметры пароля для модуля.
3. На рабочем столе щелкните ярлык **Run collector** (Запустить сборщик).
4. В сборщике службы "Миграция Azure" откройте раздел **Set Up Prerequisites** (Настройка предварительных требований).
    - Примите условия лицензии и прочитайте информацию от сторонних производителей.
    - Сборщик проверит наличие доступа к Интернету у виртуальной машины.
    - Если виртуальная машина подключена к Интернету через прокси-сервер, щелкните **Proxy settings** (Параметры прокси-сервера) и укажите адрес и порт прослушивания прокси-сервера. Укажите учетные данные, если для прокси-сервера требуется аутентификация.

    > [!NOTE]
    > Адрес прокси-сервера вводится в следующем формате: http://ProxyIPAddress или http://ProxyFQDN. Поддерживается только прокси-сервер HTTP.

    - Сборщик проверит, запущена ли служба сборщика. Эта служба устанавливается по умолчанию на виртуальной машине сборщика.
    - Скачайте и установите VMware vSphere PowerCLI.

5. В разделе **Specify vCenter Server details** (Укажите сведения о vCenter Server) выполните следующие действия:
    - Укажите полное доменное имя или IP-адрес сервера vCenter Server.
    - В полях **Имя пользователя** и **Пароль** укажите данные учетной записи только для чтения, которую сборщик будет использовать для обнаружения виртуальных машин на сервере vCenter Server.
    - В поле **Область сбора данных** выберите область обнаружения виртуальных машин. Сборщик может обнаруживать только виртуальные машины в указанной области. Областью может быть определенная папка, центр обработки данных или кластер. Она не должна содержать более 1000 виртуальных машин. 

6. В разделе **Specify migration project** (Укажите проект миграции) укажите идентификатор и ключ проекта службы "Миграция Azure", скопированные на портале. Если вы не скопировали их, откройте портал Azure на виртуальной машине сборщика. На странице **Обзор** проекта щелкните **Обнаружение компьютеров** и скопируйте соответствующие значения.  
7. В окне **View collection progress** (Просмотр хода выполнения сборщика) наблюдайте за обнаружением и убедитесь, что в области обнаружения собираются метаданные с виртуальных машин. Сборщик предоставляет приблизительное время завершения обнаружения.

> [!NOTE]
> Сборщик поддерживает только "Английский (США)" в качестве языка операционной системы и языка интерфейса сборщика. Поддержка дополнительных языков будет реализована в ближайшее время.


### <a name="verify-vms-in-the-portal"></a>Проверка виртуальных машин на портале

Длительность обнаружения зависит от количества виртуальных машин, обнаружение которых выполняется. Обычно для 100 виртуальных машин после завершения работы сборщика обнаружение занимает примерно час. 

1. В проекте службы "Миграция Azure" щелкните **Управление** > **Компьютеры**.
2. Проверьте, появились ли на портале виртуальные машины, которые нужно было обнаружить.


## <a name="create-and-view-an-assessment"></a>Создание и просмотр оценки

После обнаружения виртуальных машин их можно сгруппировать и создать оценку. 

1. На странице **Обзор** проекта щелкните **+Создать оценку**.
2. Щелкните **Просмотреть все**, чтобы просмотреть свойства оценки.
3. Создайте группу и укажите ее имя.
4. Выберите компьютеры, которые необходимо добавить в группу.
5. Щелкните **Создать оценку**, чтобы создать группу и оценку.
6. После создания оценки просмотрите ее, выбрав **Обзор** > **Панель мониторинга**.
7. Щелкните **Экспорт оценки**, чтобы скачать оценку в виде файла Excel.

### <a name="sample-assessment"></a>Пример оценки

Ниже приведен пример отчета об оценке. Он содержит сведения о совместимости виртуальных машин с Azure и предполагаемых ежемесячных затратах. 

![Отчет об оценке](./media/tutorial-assessment-vmware/assessment-report.png)

#### <a name="azure-readiness"></a>Готовность к работе в Azure

Это представление отображает состояние готовности каждого компьютера.

- Для виртуальных машин, которые готовы к миграции, служба "Миграция Azure" рекомендует размер виртуальной машины в Azure.
- Для виртуальных машин, которые не готовы к миграции, служба "Миграция Azure" указывает причины и инструкции по их устранению.
- Служба "Миграция Azure" предлагает инструменты, которые можно использовать для миграции. Если компьютер подходит для миграции "lift-and-shift", рекомендуется использовать службу Azure Site Recovery. Если это компьютер базы данных, рекомендуется использовать Azure Database Migration Service.

  ![Оценка готовности](./media/tutorial-assessment-vmware/assessment-suitability.png)  

#### <a name="monthly-cost-estimate"></a>Примерная стоимость в месяц

В этом представлении отображается общая стоимость вычислений и хранения для запуска виртуальных машин в Azure, а также сведениями для каждой машины. Примерная стоимость вычисляются с помощью рекомендованного на основе производительности размера компьютера и ее дисков, а также свойств оценки. 

> [!NOTE]
> Оценка стоимости, предоставляемая службой "Миграция Azure", приводится для запуска локальных виртуальных машин как виртуальных машин Azure IaaS (инфраструктура как услуга). При использовании службы "Миграция Azure" не учитывается стоимость платформы как услуги (PaaS) или программного обеспечения как услуги (SaaS). 

Примерная ежемесячная стоимость вычислений и хранилища суммируется для всех виртуальных машин в группе. 

![Оценка стоимости виртуальной машины](./media/tutorial-assessment-vmware/assessment-vm-cost.png) 

Вы можете воспользоваться детализацией для просмотра сведений об определенном компьютере.

![Оценка стоимости виртуальной машины](./media/tutorial-assessment-vmware/assessment-vm-drill.png) 

## <a name="next-steps"></a>Дополнительная информация

- [Узнайте](how-to-scale-assessment.md), как выполнять обнаружение и оценку в большой среде VMware.
- Узнайте, как создать группы с высоким уровнем надежности, используя [сопоставление зависимостей компьютеров](how-to-create-group-machine-dependencies.md).
- [Узнайте больше](concepts-assessment-calculation.md) о вычислении оценок.
