---
title: "Устранение неполадок в службе \"Миграция Azure\" | Документация Майкрософт"
description: "Эта статья содержит обзор известных проблем в службе \"Миграция Azure\" и советы по устранению распространенных ошибок."
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: troubleshooting
ms.date: 12/12/2017
ms.author: raynew
ms.openlocfilehash: 1fcc9e12e63eda73d53ae2085bc2a64d31ea2067
ms.sourcegitcommit: aaba209b9cea87cb983e6f498e7a820616a77471
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="troubleshoot-azure-migrate"></a>Устранение неполадок в службе "Миграция Azure"

## <a name="troubleshoot-common-errors"></a>Устранение распространенных ошибок

Служба [Миграция Azure](migrate-overview.md) выполняет оценку локальных рабочих нагрузок для переноса в Azure. Используйте эту статью для устранения неполадок при развертывании и использовании службы "Миграция Azure".


**Сборщик не может подключиться к Интернету**

Это может произойти, если машина, которую вы используете находится за прокси-сервер. Убедитесь, что вы предоставляете учетные данные авторизации требуется прокси-сервер.
При использовании любого брандмауэр на основе URL-адрес прокси-сервера для управления исходящие подключения, убедитесь, что в список разрешений этих требуется URL-адреса:

**URL-адрес** | **Назначение**  
--- | ---
*. portal.azure.com | Требуется для проверки связи с помощью службы Azure и проверки во время синхронизации проблем.
*. oneget.org | Необходимо загрузить powershell на основе модуля PowerCLI vCenter.

**Сборщику не удается подключиться к проекту, используя идентификатор и ключ проекта, скопированные на портале.**

Убедитесь, что вы скопировали и вставили правильную информацию. Для устранения неполадок установите Microsoft Monitoring Agent (MMA) следующим образом.

1. Скачайте [MMA](https://go.microsoft.com/fwlink/?LinkId=828603) на виртуальную машину сборщика.
2. Чтобы начать установку, дважды щелкните скачанный файл.
3. В программе установки на странице **приветствия** нажмите кнопку **Далее**. На странице **Условия лицензии** нажмите кнопку **Принимаю**, чтобы принять условия лицензии.
4. В поле **Конечная папка** оставьте или измените папку установки по умолчанию. Нажмите кнопку **Далее**.
5. В разделе **Параметры установки агента** выберите **Azure Log Analytics (OMS)** > **Далее**.
6. Щелкните **Добавить**, чтобы добавить новую рабочую область Log Analytics. Вставьте скопированные идентификатор и ключ проекта. Нажмите кнопку **Далее**.
7. Убедитесь, что агент может подключиться к проекту. Если установить подключение не удается, проверьте параметры. Если агент может подключиться к проекту, но сборщик — нет, обратитесь в службу поддержки.


**Ошибка 802. Возникает ошибка синхронизации даты и времени.**

Часы сервера могут быть не синхронизированы с текущим временем более чем на пять минут. Измените время на виртуальной машине сборщика с соответствии с текущим временем, как показано ниже.

1. Откройте командную строку с правами администратора на этой виртуальной машине.
2. Чтобы проверить часовой пояс, выполните команду w32tm /tz.
3. Чтобы синхронизировать время, выполните команду w32tm /resync.

**Ключ проекта содержит символы "==" в конце. Они кодируются сборщиком в другие буквенно-цифровые знаки. Так и должно быть?**

Да, каждый ключ проекта заканчивается "==". Сборщик шифрует ключ проекта, прежде чем обрабатывать его.

**В данных о производительности дисков и сетевых адаптеров отображаются нули**

Это может произойти, если на сервере vCenter Server задан уровень статистики меньше 3. На уровне 3 или выше vCenter сохраняет журнал производительности виртуальной машины, записывая в него данные о вычислениях, хранилище и сети. Для уровня ниже 3 vCenter не сохраняет данные хранилища и сети, а сохраняет только данные ЦП и памяти. В этом сценарии данные производительности в службе "Миграция Azure" показывают ноль, и она предоставляет рекомендации по размеру дисков и сетей на основе метаданных, собранных из локальных компьютеров.

Чтобы включить сбор данных о производительности дисков и сети, измените параметр уровня статистики на 3. Затем подождите по крайней мере один день. Это требуется, чтобы обнаружить среду и оценить ее. 

**Мной были установлены агенты и созданы группы с помощью визуализации зависимостей. Теперь после отработки отказа на компьютере отображается действие "Установить агент" вместо "Просмотреть зависимости"**
* После плановой или внеплановой отработки отказа локальные компьютеры отключаются и запускаются эквивалентные компьютеры в Azure. Эти компьютеры получают другие MAC-адреса. Они могут получить другой IP-адрес, если пользователь не указал сохранение локального IP-адреса. Если MAC-адрес и IP-адрес отличаются, служба "Миграция Azure" не связывает локальные компьютеры с какими-либо данными зависимостей сопоставления служб и предлагает пользователю установить агенты вместо просмотра зависимостей.
* Поле тестовой отработки отказа локальные компьютеры остаются включенными, как ожидается. Каждый эквивалентный компьютер, запускаемый в Azure, получает другой MAC-адрес и может получить другой IP-адрес. Если только пользователь не блокирует исходящий трафик OMS с этих компьютеров, служба "Миграция Azure" не связывает локальные компьютеры с какими-либо данными зависимостей сопоставления служб и предлагает пользователю установить агенты вместо просмотра зависимостей.


## <a name="troubleshoot-readiness-issues"></a>Устранение проблемы готовности

**Проблема** | **Исправление**
--- | ---
Тип загрузки не поддерживается | Измените тип загрузки на BIOS, прежде чем выполнять миграцию.
Число дисков превышает ограничение | Удалите неиспользуемые диски с компьютера перед миграцией.
Размер диска превышает ограничение | Уменьшите диски до размера менее 4 ТБ перед выполнением миграции. 
Диск недоступен в указанном расположении | Убедитесь, что диск доступен в целевом расположении, прежде чем выполнять миграцию.
Недоступен диск для обеспечения указанной избыточности | Диск должен использовать тип избыточности хранилища, указанный в параметрах оценки (по умолчанию — LRS).
Не удалось определить пригодность диска из-за внутренней ошибки | Попробуйте создать новую оценку для группы. 
Виртуальная машина с требуемым числом ядер и объемом памяти не найдена | Службе Azure не удалось найти подходящий тип виртуальной машины. Уменьшите объем памяти и число ядер на локальном компьютере, прежде чем выполнять миграцию. 
Один или несколько неподходящих дисков. | Убедитесь, что размер локальных дисков не превышает 4 ТБ, прежде чем выполнять миграцию.
Один или несколько неподходящих сетевых адаптеров. | Удалите неиспользуемые сетевые адаптеры с компьютера перед миграцией.
Не удалось определить пригодность виртуальной машины из-за внутренней ошибки. | Попробуйте создать новую оценку для группы. 
Не удалось определить пригодность одного или нескольких дисков из-за внутренней ошибки. | Попробуйте создать новую оценку для группы.
Не удалось определить пригодность одного или нескольких сетевых адаптеров из-за внутренней ошибки. | Попробуйте создать новую оценку для группы.
Не удалось найти хранилище с требуемой производительностью. | Производительность хранилища (число операций ввода-вывода и пропускная способность), необходимая для компьютера, превышает возможности поддерживаемых виртуальных машин Azure. Снизьте требования к хранилищу для компьютера перед выполнением миграции.
Не удалось найти виртуальную машину с требуемой производительностью сети. | Производительность сети (скорость входящего и исходящего трафика), необходимая для компьютера, превышает возможности поддерживаемых виртуальных машин Azure. Уменьшите требования к сети для компьютера. 
Не удалось найти виртуальную машину для указанной ценовой категории. | Проверьте параметры ценовой категории. 
Не удалось найти виртуальную машину в указанном расположении. | Используйте другое целевое расположение, прежде чем выполнять миграцию.
Проблемы с поддержкой ОС Linux | Убедитесь, что используется 64-разрядная версия следующих поддерживаемых [операционных систем](../virtual-machines/linux/endorsed-distros.md).
Проблемы с поддержкой ОС Windows | Убедитесь, что используется поддерживаемая операционная система. [Подробнее](concepts-assessment-calculation.md#azure-suitability-analysis)
Неизвестная операционная система. | Проверьте правильность указания операционной системы в vCenter и повторите процесс обнаружения.
Требуется подписка Visual Studio. | Операционные системы Windows Client поддерживаются только для подписок Visual Studio (MSDN).


## <a name="collect-logs"></a>Сбор журналов

**Как собирать журналы на виртуальной машине сборщика?**

Ведение журнала включено по умолчанию. Журналы расположены в следующих папках:

- C:\Profiler\ProfilerEngineDB.sqlite
- C:\Profiler\Service.log
- C:\Profiler\WebApp.log

Чтобы собирать данные трассировки событий Windows, выполните следующее.

1. На виртуальной машине сборщика откройте командное окно PowerShell.
2. Выполните команду **Get-EventLog -LogName Application | export-csv eventlog.csv**.

**Как собирать журналы сетевого трафика на портале?**

1. Откройте браузер, перейдите [к порталу](https://portal.azure.com) и войдите в него.
2. Нажмите клавишу F12, чтобы открыть средства для разработчиков. При необходимости снимите флажок **Clear entries on navigation** (Очищать записи при переходе).
3. Щелкните вкладку **Network** (Сеть) и начните сбор журналов сетевого трафика.
 - В Chrome установите флажок **Preserve log** (Сохранить журнал). Запись должна начаться автоматически. Красный кружок указывает, что данные трафика записываются. Если он не отображается, щелкните черный кружок, чтобы начать запись.
 - В Edge или Internet Explorer запись должна начаться автоматически. Если это не так, нажмите зеленую кнопку воспроизведения.
4. Попробуйте воспроизвести ошибку.
5. Если при записи возникла ошибка, остановите запись и сохраните копию записанных действий.
 - В Chrome щелкните запись правой кнопкой мыши и выберите **Save as HAR with content** (Сохранить как HAR-файл с содержимым). Журналы будут заархивированы в формате ZIP и экспортированы в виде HAR-файла.
 - В Edge или Internet Explorer щелкните значок **Экспорт собранного трафика**. Журнал будет заархивирован в формате ZIP и экспортирован.
6. Перейдите на вкладку **Консоль**, чтобы проверить наличие предупреждений или ошибок. Чтобы сохранить журнал консоли, сделайте следующее.
 - В Chrome щелкните правой кнопкой мыши в любом месте в журнале консоли. Выберите **Save as** (Сохранить как), чтобы заархивировать журнал в формате ZIP и экспортировать его.
 - В Edge или Internet Explorer щелкните правой кнопкой мыши ошибки и выберите **Копировать все**. 
7. Закройте средства для разработчиков.
 



