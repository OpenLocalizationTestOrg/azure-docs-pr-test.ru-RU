---
title: "мониторинг конечной точки диспетчера трафика aaaAzure | Документы Microsoft"
description: "Эта статья поможет вам понять, как диспетчер трафика использует мониторинга конечных точек и конечной точки автоматического перехода на другой ресурс toohelp Azure клиентам развертывать приложения высокой доступности"
services: traffic-manager
documentationcenter: 
author: kumudd
manager: timlt
editor: 
ms.assetid: fff25ac3-d13a-4af9-8916-7c72e3d64bc7
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/22/2017
ms.author: kumud
ms.openlocfilehash: b4862499c88bdb1951833d06199b034a07ac7576
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="traffic-manager-endpoint-monitoring"></a><span data-ttu-id="dcad7-103">Мониторинг конечных точек в диспетчере трафика</span><span class="sxs-lookup"><span data-stu-id="dcad7-103">Traffic Manager endpoint monitoring</span></span>

<span data-ttu-id="dcad7-104">Диспетчер трафика Azure включает в себя встроенные возможности мониторинга и автоматическую отработку отказа конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span></span> <span data-ttu-id="dcad7-105">Эта функция позволяет вам предоставлять высокого уровня доступности приложения, которые являются устойчивыми tooendpoint сбоя, включая сбои регион Azure.</span><span class="sxs-lookup"><span data-stu-id="dcad7-105">This feature helps you deliver high-availability applications that are resilient tooendpoint failure, including Azure region failures.</span></span>

## <a name="configure-endpoint-monitoring"></a><span data-ttu-id="dcad7-106">Настройка мониторинга конечных точек</span><span class="sxs-lookup"><span data-stu-id="dcad7-106">Configure endpoint monitoring</span></span>

<span data-ttu-id="dcad7-107">tooconfigure мониторинга конечной точки, необходимо указать следующие параметры для профиля диспетчера трафика hello:</span><span class="sxs-lookup"><span data-stu-id="dcad7-107">tooconfigure endpoint monitoring, you must specify hello following settings on your Traffic Manager profile:</span></span>

* <span data-ttu-id="dcad7-108">**Протокол**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-108">**Protocol**.</span></span> <span data-ttu-id="dcad7-109">Выберите HTTP, HTTPS или TCP в качестве протокола hello, диспетчер трафика использует при поиске ваш конечная точка toocheck его работоспособности.</span><span class="sxs-lookup"><span data-stu-id="dcad7-109">Choose HTTP, HTTPS, or TCP as hello protocol that Traffic Manager uses when probing your endpoint toocheck its health.</span></span> <span data-ttu-id="dcad7-110">Мониторинг HTTPS не проверяет допустимость SSL-сертификат — он только проверяет, что hello отсутствует сертификат.</span><span class="sxs-lookup"><span data-stu-id="dcad7-110">HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that hello certificate is present.</span></span>
* <span data-ttu-id="dcad7-111">**Порт**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-111">**Port**.</span></span> <span data-ttu-id="dcad7-112">Выберите hello порт, используемый для запроса hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-112">Choose hello port used for hello request.</span></span>
* <span data-ttu-id="dcad7-113">**Путь**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-113">**Path**.</span></span> <span data-ttu-id="dcad7-114">Этот параметр конфигурации является допустимым только для hello протоколов HTTP и HTTPS, для которых требуется указание параметра пути hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-114">This configuration setting is valid only for hello HTTP and HTTPS protocols, for which specifying hello path setting is required.</span></span> <span data-ttu-id="dcad7-115">Предоставление этот параметр для hello TCP мониторинга протокола приведет к ошибке.</span><span class="sxs-lookup"><span data-stu-id="dcad7-115">Providing this setting for hello TCP monitoring protocol results in an error.</span></span> <span data-ttu-id="dcad7-116">Для протокола TCP предоставьте hello относительный путь и имя hello hello веб-страницу или файл hello, hello мониторинга обращается к.</span><span class="sxs-lookup"><span data-stu-id="dcad7-116">For TCP protocol, give hello relative path and hello name of hello webpage or hello file that hello monitoring accesses.</span></span> <span data-ttu-id="dcad7-117">Косую черту (/) является допустимой записью для относительного пути hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-117">A forward slash (/) is a valid entry for hello relative path.</span></span> <span data-ttu-id="dcad7-118">Это значение означает, что это файл hello в корневом каталоге hello (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="dcad7-118">This value implies that hello file is in hello root directory (default).</span></span>
* <span data-ttu-id="dcad7-119">**Интервал проверки**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-119">**Probing Interval**.</span></span> <span data-ttu-id="dcad7-120">Это значение указывает, как часто проверяется работоспособность конечной точки с помощью агента проверки диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-120">This value specifies how often an endpoint is checked for its health from a Traffic Manager probing agent.</span></span> <span data-ttu-id="dcad7-121">Вы можете указать здесь два значения: 30 секунд (обычная проверка) и 10 секунд (быстрая проверка).</span><span class="sxs-lookup"><span data-stu-id="dcad7-121">You can specify two values here: 30 seconds (normal probing) and 10 seconds (fast probing).</span></span> <span data-ttu-id="dcad7-122">Если значения не указаны, профиль hello задает значение по умолчанию tooa 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-122">If no values are provided, hello profile sets tooa default value of 30 seconds.</span></span> <span data-ttu-id="dcad7-123">Посетите hello [диспетчера трафика цены](https://azure.microsoft.com/pricing/details/traffic-manager) toolearn страницы, Дополнительные сведения о ценах быстрой проверки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-123">Visit hello [Traffic Manager Pricing](https://azure.microsoft.com/pricing/details/traffic-manager) page toolearn more about fast probing pricing.</span></span>
* <span data-ttu-id="dcad7-124">**Допустимое число сбоев**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-124">**Tolerated Number of Failures**.</span></span> <span data-ttu-id="dcad7-125">Это значение указывает количество сбоев, которое допускает агент проверки диспетчера трафика. По достижении этого количества конечная точка будет помечена как неработоспособная.</span><span class="sxs-lookup"><span data-stu-id="dcad7-125">This value specifies how many failures a Traffic Manager probing agent tolerates before marking that endpoint as unhealthy.</span></span> <span data-ttu-id="dcad7-126">Значение должно быть в диапазоне от 0 до 9.</span><span class="sxs-lookup"><span data-stu-id="dcad7-126">Its value can range between 0 and 9.</span></span> <span data-ttu-id="dcad7-127">Значение 0 означает сбой одного мониторинга может привести к этой конечной точке toobe, отмечен как неработоспособный.</span><span class="sxs-lookup"><span data-stu-id="dcad7-127">A value of 0 means a single monitoring failure can cause that endpoint toobe marked as unhealthy.</span></span> <span data-ttu-id="dcad7-128">Если значение не указано, то используется значение по умолчанию hello 3.</span><span class="sxs-lookup"><span data-stu-id="dcad7-128">If no value is specified, it uses hello default value of 3.</span></span>
* <span data-ttu-id="dcad7-129">**Время ожидания мониторинга**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-129">**Monitoring Timeout**.</span></span> <span data-ttu-id="dcad7-130">Это свойство указывает hello объем времени hello проверки агента будет ожидать перед тем, как диспетчер трафика, проверьте сбоя при отправке проверки зонда работоспособности toohello конечной точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-130">This property specifies hello amount of time hello Traffic Manager probing agent should wait before considering that check a failure when a health check probe is sent toohello endpoint.</span></span> <span data-ttu-id="dcad7-131">Если приветствия зондирования интервал too30 секунд, то можно задать значение времени ожидания hello между 5 и 10 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-131">If hello Probing Interval is set too30 seconds, then you can set hello Timeout value between 5 and 10 seconds.</span></span> <span data-ttu-id="dcad7-132">Если значение не задано, используется значение по умолчанию 10 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-132">If no value is specified, it uses a default value of 10 seconds.</span></span> <span data-ttu-id="dcad7-133">Если приветствия зондирования интервал too10 секунд, то можно задать значение времени ожидания hello от 5 до 9 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-133">If hello Probing Interval is set too10 seconds, then you can set hello Timeout value between 5 and 9 seconds.</span></span> <span data-ttu-id="dcad7-134">Если значение времени ожидания не задано, используется значение по умолчанию 9 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-134">If no Timeout value is specified, it uses a default value of 9 seconds.</span></span>

![Мониторинг конечных точек в диспетчере трафика](./media/traffic-manager-monitoring/endpoint-monitoring-settings.png)

<span data-ttu-id="dcad7-136">**Рис. 1. Мониторинг конечных точек в диспетчере трафика**</span><span class="sxs-lookup"><span data-stu-id="dcad7-136">**Figure 1:  Traffic Manager endpoint monitoring**</span></span>

## <a name="how-endpoint-monitoring-works"></a><span data-ttu-id="dcad7-137">Как выполняется мониторинг конечных точек</span><span class="sxs-lookup"><span data-stu-id="dcad7-137">How endpoint monitoring works</span></span>

<span data-ttu-id="dcad7-138">Если протокол мониторинга hello задано как HTTP или HTTPS, агент проверки диспетчера трафика hello создает конечную точку toohello запрос GET с помощью hello протокол, порт и относительный путь, указанный.</span><span class="sxs-lookup"><span data-stu-id="dcad7-138">If hello monitoring protocol is set as HTTP or HTTPS, hello Traffic Manager probing agent makes a GET request toohello endpoint using hello protocol, port, and relative path given.</span></span> <span data-ttu-id="dcad7-139">Если он возвращает ответ 200-OK, тогда эта конечная точка считается работоспособной.</span><span class="sxs-lookup"><span data-stu-id="dcad7-139">If it gets back a 200-OK response, then that endpoint is considered healthy.</span></span> <span data-ttu-id="dcad7-140">Если ответ hello другое значение или, если отклик не получен в течение указанного периода ожидания hello, hello зондирования агент диспетчера трафика повторно пытается параметр допустимое число сбоев toohello (повторно пытается выполняются, если этот параметр равен 0) в соответствии с .</span><span class="sxs-lookup"><span data-stu-id="dcad7-140">If hello response is a different value, or, if no response is received within hello timeout period specified, then hello Traffic Manager probing agent re-attempts according toohello Tolerated Number of Failures setting (no re-attempts are done if this setting is 0).</span></span> <span data-ttu-id="dcad7-141">Если hello число последовательных сбоев превышает допустимое количество сбоев приветствия, этой конечной точки будет отмечен как неработоспособный.</span><span class="sxs-lookup"><span data-stu-id="dcad7-141">If hello number of consecutive failures is higher than hello Tolerated Number of Failures setting, then that endpoint is marked as unhealthy.</span></span> 

<span data-ttu-id="dcad7-142">Если hello мониторинга протокола TCP, hello диспетчера трафика проверки агент инициирует запрос подключения TCP, через указанный порт hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-142">If hello monitoring protocol is TCP, hello Traffic Manager probing agent initiates a TCP connection request using hello port specified.</span></span> <span data-ttu-id="dcad7-143">Если конечная точка hello отвечает toohello запроса с соединением hello tooestablish ответа, что проверка работоспособности помечается как успешно завершенного и проверки агента диспетчера трафика hello сбрасывает hello TCP-соединение.</span><span class="sxs-lookup"><span data-stu-id="dcad7-143">If hello endpoint responds toohello request with a response tooestablish hello connection, that health check is marked as a success and hello Traffic Manager probing agent resets hello TCP connection.</span></span> <span data-ttu-id="dcad7-144">Если ответ hello другое значение или если отклик не получен в течение периода ожидания hello указана, hello зондирования агент диспетчера трафика повторно пытается параметр допустимое число сбоев toohello (повторно пытается производится, если этот параметр равен 0) в соответствии с.</span><span class="sxs-lookup"><span data-stu-id="dcad7-144">If hello response is a different value, or if no response is received within hello timeout period specified, hello Traffic Manager probing agent re-attempts according toohello Tolerated Number of Failures setting (no re-attempts are made if this setting is 0).</span></span> <span data-ttu-id="dcad7-145">Если hello число последовательных сбоев превышает допустимое количество сбоев приветствия, эту конечную точку помечается неработоспособен.</span><span class="sxs-lookup"><span data-stu-id="dcad7-145">If hello number of consecutive failures is higher than hello Tolerated Number of Failures setting, then that endpoint is marked unhealthy.</span></span>

<span data-ttu-id="dcad7-146">Во всех случаях диспетчер трафика проверяет из нескольких мест и определение hello последовательный сбой происходит в каждом регионе.</span><span class="sxs-lookup"><span data-stu-id="dcad7-146">In all cases, Traffic Manager probes from multiple locations and hello consecutive failure determination happens within each region.</span></span> <span data-ttu-id="dcad7-147">Это также означает, что конечные точки получают пробы работоспособности из диспетчера трафика с частотой выше, чем hello параметра, который используется для проверки интервала.</span><span class="sxs-lookup"><span data-stu-id="dcad7-147">This also means that endpoints are receiving health probes from Traffic Manager with a higher frequency than hello setting used for Probing Interval.</span></span>

>[!NOTE]
><span data-ttu-id="dcad7-148">Для протоколов HTTP и HTTPS, протокол мониторинга чаще всего выполняются на стороне конечной точки hello — tooimplement настраиваемой страницы в приложении - например, /health.aspx.</span><span class="sxs-lookup"><span data-stu-id="dcad7-148">For HTTP or HTTPS monitoring protocol, a common practice on hello endpoint side is tooimplement a custom page within your application - for example, /health.aspx.</span></span> <span data-ttu-id="dcad7-149">Используя этот путь для мониторинга, можно выполнить проверки для конкретного приложения, такие как проверка счетчиков производительности или проверка доступности базы данных.</span><span class="sxs-lookup"><span data-stu-id="dcad7-149">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span></span> <span data-ttu-id="dcad7-150">Страница приветствия на основании этих пользовательских проверок, и возвращает соответствующий код состояния HTTP.</span><span class="sxs-lookup"><span data-stu-id="dcad7-150">Based on these custom checks, hello page returns an appropriate HTTP status code.</span></span>

<span data-ttu-id="dcad7-151">Все конечные точки в профиле диспетчера трафика имеют общие параметры мониторинга.</span><span class="sxs-lookup"><span data-stu-id="dcad7-151">All endpoints in a Traffic Manager profile share monitoring settings.</span></span> <span data-ttu-id="dcad7-152">Если вам требуется toouse разные параметры мониторинга для различных конечных точках, можно создать [вложенных профилей диспетчера трафика](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span><span class="sxs-lookup"><span data-stu-id="dcad7-152">If you need toouse different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span></span>

## <a name="endpoint-and-profile-status"></a><span data-ttu-id="dcad7-153">Состояние конечной точки и профиля</span><span class="sxs-lookup"><span data-stu-id="dcad7-153">Endpoint and profile status</span></span>

<span data-ttu-id="dcad7-154">Можно включать и отключать профили и конечные точки диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-154">You can enable and disable Traffic Manager profiles and endpoints.</span></span> <span data-ttu-id="dcad7-155">Однако изменение состояния конечной точки также может произойти в результате автоматической настройки и процессов диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-155">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span></span>

### <a name="endpoint-status"></a><span data-ttu-id="dcad7-156">Состояние конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-156">Endpoint status</span></span>

<span data-ttu-id="dcad7-157">Можно включить или отключить определенную конечную точку.</span><span class="sxs-lookup"><span data-stu-id="dcad7-157">You can enable or disable a specific endpoint.</span></span> <span data-ttu-id="dcad7-158">Hello базовой службы, которая все еще может быть работоспособности, не влияет.</span><span class="sxs-lookup"><span data-stu-id="dcad7-158">hello underlying service, which might still be healthy, is unaffected.</span></span> <span data-ttu-id="dcad7-159">Изменение элементов управления состояние конечной точки hello hello доступности конечной точки hello в hello профиля диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-159">Changing hello endpoint status controls hello availability of hello endpoint in hello Traffic Manager profile.</span></span> <span data-ttu-id="dcad7-160">При отключении состояние конечной точки диспетчера трафика не проверяет его работоспособность и hello конечной точки не включается в ответ DNS.</span><span class="sxs-lookup"><span data-stu-id="dcad7-160">When an endpoint status is disabled, Traffic Manager does not check its health and hello endpoint is not included in a DNS response.</span></span>

### <a name="profile-status"></a><span data-ttu-id="dcad7-161">Состояние профиля</span><span class="sxs-lookup"><span data-stu-id="dcad7-161">Profile status</span></span>

<span data-ttu-id="dcad7-162">Состояние профиля приветствия можно включить или отключить конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="dcad7-162">Using hello profile status setting, you can enable or disable a specific profile.</span></span> <span data-ttu-id="dcad7-163">Пока состояние конечной точки может повлиять на одну конечную точку, состояние профиля влияет на весь профиль hello, включая все конечные точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-163">While endpoint status affects a single endpoint, profile status affects hello entire profile, including all endpoints.</span></span> <span data-ttu-id="dcad7-164">При отключении профиля hello конечные точки не проверяются на работоспособность и конечные точки не включены в ответ DNS.</span><span class="sxs-lookup"><span data-stu-id="dcad7-164">When you disable a profile, hello endpoints are not checked for health and no endpoints are included in a DNS response.</span></span> <span data-ttu-id="dcad7-165">[NXDOMAIN](https://tools.ietf.org/html/rfc2308) возвращается код ответа для запроса DNS hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-165">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for hello DNS query.</span></span>

### <a name="endpoint-monitor-status"></a><span data-ttu-id="dcad7-166">Отслеживаемое состояние конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-166">Endpoint monitor status</span></span>

<span data-ttu-id="dcad7-167">Наблюдаемое состояние конечной точки является значением созданный диспетчера трафика, которое показывает состояние hello hello конечной точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-167">Endpoint monitor status is a Traffic Manager-generated value that shows hello status of hello endpoint.</span></span> <span data-ttu-id="dcad7-168">Этот параметр нельзя изменить вручную.</span><span class="sxs-lookup"><span data-stu-id="dcad7-168">You cannot change this setting manually.</span></span> <span data-ttu-id="dcad7-169">наблюдаемое состояние конечной точки Hello представляет собой сочетание отслеживание конечных результатов hello и hello состояние конечной точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-169">hello endpoint monitor status is a combination of hello results of endpoint monitoring and hello configured endpoint status.</span></span> <span data-ttu-id="dcad7-170">Возможные значения Hello наблюдаемое состояние конечной точки показаны в следующей таблице hello:</span><span class="sxs-lookup"><span data-stu-id="dcad7-170">hello possible values of endpoint monitor status are shown in hello following table:</span></span>

| <span data-ttu-id="dcad7-171">Состояние профиля</span><span class="sxs-lookup"><span data-stu-id="dcad7-171">Profile status</span></span> | <span data-ttu-id="dcad7-172">Состояние конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-172">Endpoint status</span></span> | <span data-ttu-id="dcad7-173">Отслеживаемое состояние конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-173">Endpoint monitor status</span></span> | <span data-ttu-id="dcad7-174">Примечания</span><span class="sxs-lookup"><span data-stu-id="dcad7-174">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="dcad7-175">Отключено</span><span class="sxs-lookup"><span data-stu-id="dcad7-175">Disabled</span></span> |<span data-ttu-id="dcad7-176">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-176">Enabled</span></span> |<span data-ttu-id="dcad7-177">Неактивно</span><span class="sxs-lookup"><span data-stu-id="dcad7-177">Inactive</span></span> |<span data-ttu-id="dcad7-178">Hello профиль был отключен.</span><span class="sxs-lookup"><span data-stu-id="dcad7-178">hello profile has been disabled.</span></span> <span data-ttu-id="dcad7-179">Состояние конечной точки hello включен, но состояние профиля hello (выключена) имеет приоритет.</span><span class="sxs-lookup"><span data-stu-id="dcad7-179">Although hello endpoint status is Enabled, hello profile status (Disabled) takes precedence.</span></span> <span data-ttu-id="dcad7-180">Конечные точки в отключенных профилях не отслеживаются.</span><span class="sxs-lookup"><span data-stu-id="dcad7-180">Endpoints in disabled profiles are not monitored.</span></span> <span data-ttu-id="dcad7-181">Код ответа NXDOMAIN возвращается для hello DNS-запрос.</span><span class="sxs-lookup"><span data-stu-id="dcad7-181">An NXDOMAIN response code is returned for hello DNS query.</span></span> |
| <span data-ttu-id="dcad7-182">&lt;любой&gt;</span><span class="sxs-lookup"><span data-stu-id="dcad7-182">&lt;any&gt;</span></span> |<span data-ttu-id="dcad7-183">Отключено</span><span class="sxs-lookup"><span data-stu-id="dcad7-183">Disabled</span></span> |<span data-ttu-id="dcad7-184">Отключено</span><span class="sxs-lookup"><span data-stu-id="dcad7-184">Disabled</span></span> |<span data-ttu-id="dcad7-185">Hello конечная точка отключена.</span><span class="sxs-lookup"><span data-stu-id="dcad7-185">hello endpoint has been disabled.</span></span> <span data-ttu-id="dcad7-186">Отключенные конечные точки не отслеживаются.</span><span class="sxs-lookup"><span data-stu-id="dcad7-186">Disabled endpoints are not monitored.</span></span> <span data-ttu-id="dcad7-187">Конечная точка Hello не включается в ответы DNS, таким образом, он не принимает трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-187">hello endpoint is not included in DNS responses, therefore, it does not receive traffic.</span></span> |
| <span data-ttu-id="dcad7-188">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-188">Enabled</span></span> |<span data-ttu-id="dcad7-189">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-189">Enabled</span></span> |<span data-ttu-id="dcad7-190">В сети</span><span class="sxs-lookup"><span data-stu-id="dcad7-190">Online</span></span> |<span data-ttu-id="dcad7-191">Hello конечная точка отслеживается и находится в работоспособном состоянии.</span><span class="sxs-lookup"><span data-stu-id="dcad7-191">hello endpoint is monitored and is healthy.</span></span> <span data-ttu-id="dcad7-192">Она включается в ответы DNS и может получать трафик.</span><span class="sxs-lookup"><span data-stu-id="dcad7-192">It is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="dcad7-193">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-193">Enabled</span></span> |<span data-ttu-id="dcad7-194">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-194">Enabled</span></span> |<span data-ttu-id="dcad7-195">Деградация</span><span class="sxs-lookup"><span data-stu-id="dcad7-195">Degraded</span></span> |<span data-ttu-id="dcad7-196">Проверки работоспособности мониторинга конечной точки завершаются ошибкой.</span><span class="sxs-lookup"><span data-stu-id="dcad7-196">Endpoint monitoring health checks are failing.</span></span> <span data-ttu-id="dcad7-197">Конечная точка Hello не включается в ответы DNS и не принимает трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-197">hello endpoint is not included in DNS responses and does not receive traffic.</span></span> <br><span data-ttu-id="dcad7-198">Toothis исключение — Если снижение работоспособности всех конечных точек, в этом случае все они считаются toobe, возвращаемых в ответ на запрос hello).</span><span class="sxs-lookup"><span data-stu-id="dcad7-198">An exception toothis is if all endpoints are degraded, in which case all of them are considered toobe returned in hello query response).</span></span></br>|
| <span data-ttu-id="dcad7-199">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-199">Enabled</span></span> |<span data-ttu-id="dcad7-200">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-200">Enabled</span></span> |<span data-ttu-id="dcad7-201">Проверка конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-201">CheckingEndpoint</span></span> |<span data-ttu-id="dcad7-202">Hello конечная точка отслеживается, но еще не были получены результаты hello hello первой проверки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-202">hello endpoint is monitored, but hello results of hello first probe have not been received yet.</span></span> <span data-ttu-id="dcad7-203">«Checkingendpoint» — это временное состояние, которое обычно происходит сразу после добавления или включение конечной точки в профиле hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-203">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in hello profile.</span></span> <span data-ttu-id="dcad7-204">Конечная точка в таком состоянии включается в ответы DNS и может получать трафик.</span><span class="sxs-lookup"><span data-stu-id="dcad7-204">An endpoint in this state is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="dcad7-205">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-205">Enabled</span></span> |<span data-ttu-id="dcad7-206">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-206">Enabled</span></span> |<span data-ttu-id="dcad7-207">Остановлено</span><span class="sxs-lookup"><span data-stu-id="dcad7-207">Stopped</span></span> |<span data-ttu-id="dcad7-208">Облачные службы или веб-приложение Hello, hello конечной точки toois не запущена.</span><span class="sxs-lookup"><span data-stu-id="dcad7-208">hello cloud service or web app that hello endpoint points toois not running.</span></span> <span data-ttu-id="dcad7-209">Проверьте hello облачной службы или веб-приложения параметры.</span><span class="sxs-lookup"><span data-stu-id="dcad7-209">Check hello cloud service or web app settings.</span></span> <span data-ttu-id="dcad7-210">Это также может произойти, если конечная точка hello объекта введите вложенных конечной точки и hello дочернем профиле отключена или подписка неактивна.</span><span class="sxs-lookup"><span data-stu-id="dcad7-210">This can also happen if hello endpoint is of type nested endpoint and hello child profile is disabled or is inactive.</span></span> <br><span data-ttu-id="dcad7-211">Конечная точка в остановленном состоянии не отслеживается.</span><span class="sxs-lookup"><span data-stu-id="dcad7-211">An endpoint with a Stopped status is not monitored.</span></span> <span data-ttu-id="dcad7-212">Она не включается в ответы DNS и поэтому не получает трафик.</span><span class="sxs-lookup"><span data-stu-id="dcad7-212">It is not included in DNS responses and does not receive traffic.</span></span> <span data-ttu-id="dcad7-213">Toothis исключение — Если снижение работоспособности всех конечных точек, в этом случае все они будут считаться toobe, возвращаемых в ответ на запрос hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-213">An exception toothis is if all endpoints are degraded, in which case all of them will be considered toobe returned in hello query response.</span></span></br>|

<span data-ttu-id="dcad7-214">Дополнительные сведения о вычислении отслеживаемого состояния конечной точки для вложенных конечных точек см. в статье [Вложенные профили диспетчера трафика](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="dcad7-214">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

### <a name="profile-monitor-status"></a><span data-ttu-id="dcad7-215">Состояние монитора профиля</span><span class="sxs-lookup"><span data-stu-id="dcad7-215">Profile monitor status</span></span>

<span data-ttu-id="dcad7-216">состояние монитора Hello профиля представляет собой сочетание состояние профиля настроен hello и значения состояния монитора hello конечной точки для всех конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-216">hello profile monitor status is a combination of hello configured profile status and hello endpoint monitor status values for all endpoints.</span></span> <span data-ttu-id="dcad7-217">Hello возможные значения описаны в следующей таблице hello:</span><span class="sxs-lookup"><span data-stu-id="dcad7-217">hello possible values are described in hello following table:</span></span>

| <span data-ttu-id="dcad7-218">Состояние профиля (согласно настройкам)</span><span class="sxs-lookup"><span data-stu-id="dcad7-218">Profile status (as configured)</span></span> | <span data-ttu-id="dcad7-219">Отслеживаемое состояние конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-219">Endpoint monitor status</span></span> | <span data-ttu-id="dcad7-220">Состояние монитора профиля</span><span class="sxs-lookup"><span data-stu-id="dcad7-220">Profile monitor status</span></span> | <span data-ttu-id="dcad7-221">Примечания</span><span class="sxs-lookup"><span data-stu-id="dcad7-221">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="dcad7-222">Отключено</span><span class="sxs-lookup"><span data-stu-id="dcad7-222">Disabled</span></span> |<span data-ttu-id="dcad7-223">&lt;любой&gt; или профиль без определенных конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-223">&lt;any&gt; or a profile with no defined endpoints.</span></span> |<span data-ttu-id="dcad7-224">Отключено</span><span class="sxs-lookup"><span data-stu-id="dcad7-224">Disabled</span></span> |<span data-ttu-id="dcad7-225">Hello профиль был отключен.</span><span class="sxs-lookup"><span data-stu-id="dcad7-225">hello profile has been disabled.</span></span> |
| <span data-ttu-id="dcad7-226">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-226">Enabled</span></span> |<span data-ttu-id="dcad7-227">Снижается Hello состояние по крайней мере одной конечной точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-227">hello status of at least one endpoint is Degraded.</span></span> |<span data-ttu-id="dcad7-228">Деградация</span><span class="sxs-lookup"><span data-stu-id="dcad7-228">Degraded</span></span> |<span data-ttu-id="dcad7-229">Просмотрите hello отдельной конечной точки состояние значения toodetermine какие конечные точки требуют дополнительной настройки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-229">Review hello individual endpoint status values toodetermine which endpoints require further attention.</span></span> |
| <span data-ttu-id="dcad7-230">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-230">Enabled</span></span> |<span data-ttu-id="dcad7-231">состояние Hello по крайней мере одной конечной точки — Online.</span><span class="sxs-lookup"><span data-stu-id="dcad7-231">hello status of at least one endpoint is Online.</span></span> <span data-ttu-id="dcad7-232">Отсутствуют конечные точки в состоянии пониженной функциональности.</span><span class="sxs-lookup"><span data-stu-id="dcad7-232">No endpoints have a Degraded status.</span></span> |<span data-ttu-id="dcad7-233">В сети</span><span class="sxs-lookup"><span data-stu-id="dcad7-233">Online</span></span> |<span data-ttu-id="dcad7-234">Hello служба принимает трафик.</span><span class="sxs-lookup"><span data-stu-id="dcad7-234">hello service is accepting traffic.</span></span> <span data-ttu-id="dcad7-235">Никаких действий от пользователя не требуется.</span><span class="sxs-lookup"><span data-stu-id="dcad7-235">No further action is required.</span></span> |
| <span data-ttu-id="dcad7-236">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-236">Enabled</span></span> |<span data-ttu-id="dcad7-237">состояние Hello по крайней мере одной конечной точки — CheckingEndpoint.</span><span class="sxs-lookup"><span data-stu-id="dcad7-237">hello status of at least one endpoint is CheckingEndpoint.</span></span> <span data-ttu-id="dcad7-238">Нет конечных точек, находящихся в сети или в состоянии пониженной функциональности.</span><span class="sxs-lookup"><span data-stu-id="dcad7-238">No endpoints are in Online or Degraded status.</span></span> |<span data-ttu-id="dcad7-239">Проверка конечных точек</span><span class="sxs-lookup"><span data-stu-id="dcad7-239">CheckingEndpoints</span></span> |<span data-ttu-id="dcad7-240">Это переходное состояние возникает при создании или включении профиля.</span><span class="sxs-lookup"><span data-stu-id="dcad7-240">This transition state occurs when a profile if created or enabled.</span></span> <span data-ttu-id="dcad7-241">Hello исправности конечной точки проверяется hello первый раз.</span><span class="sxs-lookup"><span data-stu-id="dcad7-241">hello endpoint health is being checked for hello first time.</span></span> |
| <span data-ttu-id="dcad7-242">Включено</span><span class="sxs-lookup"><span data-stu-id="dcad7-242">Enabled</span></span> |<span data-ttu-id="dcad7-243">Hello состояния всех конечных точек в профиле hello остановлена или отключена, или hello профиль без определенных конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-243">hello statuses of all endpoints in hello profile are either Disabled or Stopped, or hello profile has no defined endpoints.</span></span> |<span data-ttu-id="dcad7-244">Неактивно</span><span class="sxs-lookup"><span data-stu-id="dcad7-244">Inactive</span></span> |<span data-ttu-id="dcad7-245">Нет конечных точек, активной, но по-прежнему включенный профиль hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-245">No endpoints are active, but hello profile is still Enabled.</span></span> |

## <a name="endpoint-failover-and-recovery"></a><span data-ttu-id="dcad7-246">Отработка отказа и восстановление конечной точки</span><span class="sxs-lookup"><span data-stu-id="dcad7-246">Endpoint failover and recovery</span></span>

<span data-ttu-id="dcad7-247">Диспетчер трафика периодически проверяет работоспособность всех конечных точках, включая конечные точки неработоспособности hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-247">Traffic Manager periodically checks hello health of every endpoint, including unhealthy endpoints.</span></span> <span data-ttu-id="dcad7-248">Он обнаруживает, когда конечная точка восстановила работоспособность, и возвращает ее в работу.</span><span class="sxs-lookup"><span data-stu-id="dcad7-248">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span></span>

<span data-ttu-id="dcad7-249">Конечная точка — неработоспособное при возникновении hello следующие события:</span><span class="sxs-lookup"><span data-stu-id="dcad7-249">An endpoint is unhealthy when any of hello following events occur:</span></span>
- <span data-ttu-id="dcad7-250">Если hello мониторинга протокол HTTP или HTTPS:</span><span class="sxs-lookup"><span data-stu-id="dcad7-250">If hello monitoring protocol is HTTP or HTTPS:</span></span>
    - <span data-ttu-id="dcad7-251">получен ответ, отличный от 200 (включая различные коды 2xx или перенаправление 301/302).</span><span class="sxs-lookup"><span data-stu-id="dcad7-251">A non-200 response is received (including a different 2xx code, or a 301/302 redirect).</span></span>
- <span data-ttu-id="dcad7-252">Если hello мониторинга протокола TCP:</span><span class="sxs-lookup"><span data-stu-id="dcad7-252">If hello monitoring protocol is TCP:</span></span> 
    - <span data-ttu-id="dcad7-253">Ответ отличного от ACK или SYN ACK получено в запросе SYNC toohello ответа, отправленные tooattempt диспетчера трафика установление соединения.</span><span class="sxs-lookup"><span data-stu-id="dcad7-253">A response other than ACK or SYN-ACK is received in response toohello SYNC request sent by Traffic Manager tooattempt a connection establishment.</span></span>
- <span data-ttu-id="dcad7-254">Превышено время ожидания.</span><span class="sxs-lookup"><span data-stu-id="dcad7-254">Timeout.</span></span> 
- <span data-ttu-id="dcad7-255">Любые другие соединения проблема, приведшая к hello конечная точка не доступен.</span><span class="sxs-lookup"><span data-stu-id="dcad7-255">Any other connection issue resulting in hello endpoint being not reachable.</span></span>

<span data-ttu-id="dcad7-256">Дополнительную информацию об устранении неполадок, вызвавших сбой при проверке, см. в разделе [Устранение неполадок с состоянием пониженной функциональности в диспетчере трафика Azure](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="dcad7-256">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span> 

<span data-ttu-id="dcad7-257">Hello следующую временную шкалу на рис. 2 является подробное описание hello, наблюдение за процессом конечной точки диспетчера трафика с hello следующие параметры: мониторинга протокола HTTP, интервал проверки составляет 30 секунд, количество сбоев отклонения равно 3, время ожидания равен 10 секундам и DNS TTL — 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-257">hello following timeline in Figure 2 is a detailed description of hello monitoring process of Traffic Manager endpoint that has hello following settings: monitoring protocol is HTTP, probing interval is 30 seconds, number of tolerated failures is 3, timeout value is 10 seconds, and DNS TTL is 30 seconds.</span></span>

![Последовательность действий при отработке отказа и восстановлении после сбоя конечной точки диспетчера трафика](./media/traffic-manager-monitoring/timeline.png)

<span data-ttu-id="dcad7-259">**Рис. 2. Последовательность восстановления и отработки отказа конечной точки диспетчера трафика**</span><span class="sxs-lookup"><span data-stu-id="dcad7-259">**Figure 2:  Traffic manager endpoint failover and recovery sequence**</span></span>

1. <span data-ttu-id="dcad7-260">**GET**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-260">**GET**.</span></span> <span data-ttu-id="dcad7-261">Для каждой конечной точки hello система мониторинга диспетчера трафика выполняет запрос GET hello пути, указанному в hello параметры мониторинга.</span><span class="sxs-lookup"><span data-stu-id="dcad7-261">For each endpoint, hello Traffic Manager monitoring system performs a GET request on hello path specified in hello monitoring settings.</span></span>
2. <span data-ttu-id="dcad7-262">**200 ОК**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-262">**200 OK**.</span></span> <span data-ttu-id="dcad7-263">Hello, система мониторинга ожидает сообщение HTTP 200 OK toobe, возвращаются в течение 10 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-263">hello monitoring system expects an HTTP 200 OK message toobe returned within 10 seconds.</span></span> <span data-ttu-id="dcad7-264">Получив этот ответ, он распознает, что hello служба доступна.</span><span class="sxs-lookup"><span data-stu-id="dcad7-264">When it receives this response, it recognizes that hello service is available.</span></span>
3. <span data-ttu-id="dcad7-265">**30 секунд между проверками**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-265">**30 seconds between checks**.</span></span> <span data-ttu-id="dcad7-266">Проверка работоспособности конечной точки Hello повторяется каждые 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-266">hello endpoint health check is repeated every 30 seconds.</span></span>
4. <span data-ttu-id="dcad7-267">**Служба недоступна**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-267">**Service unavailable**.</span></span> <span data-ttu-id="dcad7-268">Hello служба становится недоступной.</span><span class="sxs-lookup"><span data-stu-id="dcad7-268">hello service becomes unavailable.</span></span> <span data-ttu-id="dcad7-269">Диспетчер трафика это неизвестно до следующей проверки работоспособности hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-269">Traffic Manager will not know until hello next health check.</span></span>
5. <span data-ttu-id="dcad7-270">**Мониторинг путь hello tooaccess попыток**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-270">**Attempts tooaccess hello monitoring path**.</span></span> <span data-ttu-id="dcad7-271">Привет, система мониторинга выполняет запрос GET, но не получает ответ в течение периода ожидания hello 10 секунд (Кроме того, отличный от 200 может быть получен ответ).</span><span class="sxs-lookup"><span data-stu-id="dcad7-271">hello monitoring system performs a GET request, but does not receive a response within hello timeout period of 10 seconds (alternatively, a non-200 response may be received).</span></span> <span data-ttu-id="dcad7-272">Затем выполняется еще три попытки с интервалом в 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-272">It then tries three more times, at 30-second intervals.</span></span> <span data-ttu-id="dcad7-273">При успешном выполнении одного из попыток hello hello число попыток сбрасывается.</span><span class="sxs-lookup"><span data-stu-id="dcad7-273">If one of hello tries is successful, then hello number of tries is reset.</span></span>
6. <span data-ttu-id="dcad7-274">**Задать состояние tooDegraded**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-274">**Status set tooDegraded**.</span></span> <span data-ttu-id="dcad7-275">После четырех неудачных попыток подряд система мониторинга hello помечает состояние hello недоступен конечной точки как деградация.</span><span class="sxs-lookup"><span data-stu-id="dcad7-275">After a fourth consecutive failure, hello monitoring system marks hello unavailable endpoint status as Degraded.</span></span>
7. <span data-ttu-id="dcad7-276">**Трафик — конечные точки перенаправленных tooother**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-276">**Traffic is diverted tooother endpoints**.</span></span> <span data-ttu-id="dcad7-277">Hello диспетчера трафика DNS-серверами обновляются и диспетчера трафика больше не возвращает конечную точку hello в ответ tooDNS запросах.</span><span class="sxs-lookup"><span data-stu-id="dcad7-277">hello Traffic Manager DNS name servers are updated and Traffic Manager no longer returns hello endpoint in response tooDNS queries.</span></span> <span data-ttu-id="dcad7-278">Новые подключения, направленные tooother, доступных конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-278">New connections are directed tooother, available endpoints.</span></span> <span data-ttu-id="dcad7-279">Однако рекурсивные DNS-серверы и DNS-клиенты могут по-прежнему содержать в кэше предыдущие ответы DNS с этой конечной точкой.</span><span class="sxs-lookup"><span data-stu-id="dcad7-279">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span></span> <span data-ttu-id="dcad7-280">Клиенты будут конечной точки hello toouse до истечения срока действия кэша DNS hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-280">Clients continue toouse hello endpoint until hello DNS cache expires.</span></span> <span data-ttu-id="dcad7-281">Как истекает hello кэш DNS, клиенты создавать новые запросы DNS и расширенный toodifferent конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-281">As hello DNS cache expires, clients make new DNS queries and are directed toodifferent endpoints.</span></span> <span data-ttu-id="dcad7-282">длительность кэширования Hello контролируются параметром TTL hello в hello профиля диспетчера трафика, например, в течение 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="dcad7-282">hello cache duration is controlled by hello TTL setting in hello Traffic Manager profile, for example, 30 seconds.</span></span>
8. <span data-ttu-id="dcad7-283">**Проверки работоспособности продолжаются**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-283">**Health checks continue**.</span></span> <span data-ttu-id="dcad7-284">Диспетчер трафика продолжается работоспособности hello toocheck hello конечной точки, пока она находится в состоянии Деградация.</span><span class="sxs-lookup"><span data-stu-id="dcad7-284">Traffic Manager continues toocheck hello health of hello endpoint while it has a Degraded status.</span></span> <span data-ttu-id="dcad7-285">Диспетчер трафика определяет, когда конечная точка hello возвращает toohealth.</span><span class="sxs-lookup"><span data-stu-id="dcad7-285">Traffic Manager detects when hello endpoint returns toohealth.</span></span>
9. <span data-ttu-id="dcad7-286">**Служба возвращается в сеть**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-286">**Service comes back online**.</span></span> <span data-ttu-id="dcad7-287">Hello служба становится доступной.</span><span class="sxs-lookup"><span data-stu-id="dcad7-287">hello service becomes available.</span></span> <span data-ttu-id="dcad7-288">Конечная точка Hello сохраняет состояние Деградация в диспетчере трафика до hello, система мониторинга выполняет проверку работоспособности Далее.</span><span class="sxs-lookup"><span data-stu-id="dcad7-288">hello endpoint retains its Degraded status in Traffic Manager until hello monitoring system performs its next health check.</span></span>
10. <span data-ttu-id="dcad7-289">**Возобновляет трафика tooservice**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-289">**Traffic tooservice resumes**.</span></span> <span data-ttu-id="dcad7-290">Диспетчер трафика отправляет запрос GET и получает ответ о состоянии "200 OK".</span><span class="sxs-lookup"><span data-stu-id="dcad7-290">Traffic Manager sends a GET request and receives a 200 OK status response.</span></span> <span data-ttu-id="dcad7-291">Hello служба возвратила tooa работоспособное состояние.</span><span class="sxs-lookup"><span data-stu-id="dcad7-291">hello service has returned tooa healthy state.</span></span> <span data-ttu-id="dcad7-292">серверы имен диспетчера трафика Hello обновляются, и они начинают toohand out hello службы DNS-имени в ответов DNS.</span><span class="sxs-lookup"><span data-stu-id="dcad7-292">hello Traffic Manager name servers are updated, and they begin toohand out hello service's DNS name in DNS responses.</span></span> <span data-ttu-id="dcad7-293">Трафик возвращает toohello конечной точки, как срок действия кэшированных ответов DNS, которые возвращают другие конечные точки, и как существующие подключения прерываются tooother конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-293">Traffic returns toohello endpoint as cached DNS responses that return other endpoints expire, and as existing connections tooother endpoints are terminated.</span></span>

    > [!NOTE]
    > <span data-ttu-id="dcad7-294">Так как диспетчер трафика работает на уровне DNS hello, не может повлиять на существующую конечную точку соединения tooany.</span><span class="sxs-lookup"><span data-stu-id="dcad7-294">Because Traffic Manager works at hello DNS level, it cannot influence existing connections tooany endpoint.</span></span> <span data-ttu-id="dcad7-295">Если он направляет трафик между конечными точками (или путем настройки профиля измененные или во время отработки отказа или восстановления размещения), диспетчер трафика направляет новые конечные точки tooavailable подключений.</span><span class="sxs-lookup"><span data-stu-id="dcad7-295">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections tooavailable endpoints.</span></span> <span data-ttu-id="dcad7-296">Тем не менее другие конечные точки может по-прежнему tooreceive трафика через существующие соединения до эти сеансы прерываются.</span><span class="sxs-lookup"><span data-stu-id="dcad7-296">However, other endpoints might continue tooreceive traffic via existing connections until those sessions are terminated.</span></span> <span data-ttu-id="dcad7-297">tooenable toodrain трафика из существующих подключений, приложений следует ограничить hello длительность сеанса, использовать с каждой конечной точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-297">tooenable traffic toodrain from existing connections, applications should limit hello session duration used with each endpoint.</span></span>

## <a name="traffic-routing-methods"></a><span data-ttu-id="dcad7-298">Методы маршрутизации трафика</span><span class="sxs-lookup"><span data-stu-id="dcad7-298">Traffic-routing methods</span></span>

<span data-ttu-id="dcad7-299">Конечная точка имеет состояние Деградация, больше не возвращаются в запросах tooDNS ответа.</span><span class="sxs-lookup"><span data-stu-id="dcad7-299">When an endpoint has a Degraded status, it is no longer returned in response tooDNS queries.</span></span> <span data-ttu-id="dcad7-300">Вместо этого выбирается и возвращается альтернативная конечная точка.</span><span class="sxs-lookup"><span data-stu-id="dcad7-300">Instead, an alternative endpoint is chosen and returned.</span></span> <span data-ttu-id="dcad7-301">Метод маршрутизации трафика Hello, настроенных в профиле hello определяет, как выбирается альтернативный hello конечной точки.</span><span class="sxs-lookup"><span data-stu-id="dcad7-301">hello traffic-routing method configured in hello profile determines how hello alternative endpoint is chosen.</span></span>

* <span data-ttu-id="dcad7-302">**Приоритет**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-302">**Priority**.</span></span> <span data-ttu-id="dcad7-303">Конечные точки формируют список по приоритетам.</span><span class="sxs-lookup"><span data-stu-id="dcad7-303">Endpoints form a prioritized list.</span></span> <span data-ttu-id="dcad7-304">Hello первой доступной конечной точки в список hello всегда возвращается.</span><span class="sxs-lookup"><span data-stu-id="dcad7-304">hello first available endpoint on hello list is always returned.</span></span> <span data-ttu-id="dcad7-305">Если состояние конечной точки снижается, возвращается hello следующую доступную конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-305">If an endpoint status is Degraded, then hello next available endpoint is returned.</span></span>
* <span data-ttu-id="dcad7-306">**Взвешивание**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-306">**Weighted**.</span></span> <span data-ttu-id="dcad7-307">Любой доступной конечной точки выбирается случайным образом в зависимости от их назначенного веса и hello весов hello других доступных конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-307">Any available endpoint is chosen at random based on their assigned weights and hello weights of hello other available endpoints.</span></span>
* <span data-ttu-id="dcad7-308">**Производительность**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-308">**Performance**.</span></span> <span data-ttu-id="dcad7-309">возвращается Hello конечной точки ближайший toohello конечного пользователя.</span><span class="sxs-lookup"><span data-stu-id="dcad7-309">hello endpoint closest toohello end user is returned.</span></span> <span data-ttu-id="dcad7-310">Недоступность этой конечной точкой, конечной точки выбирается случайным образом из всех hello других доступных конечных точек.</span><span class="sxs-lookup"><span data-stu-id="dcad7-310">If that endpoint is unavailable, an endpoint is randomly chosen from all hello other available endpoints.</span></span> <span data-ttu-id="dcad7-311">Выбор конечной точки случайных помогает избежать каскадных ошибок, которые могут возникнуть при перегрузке ближайшей конечной точки hello.</span><span class="sxs-lookup"><span data-stu-id="dcad7-311">Choosing a random endpoint avoids a cascading failure that can occur when hello next-closest endpoint becomes overloaded.</span></span> <span data-ttu-id="dcad7-312">С помощью [вложенных профилей диспетчера трафика](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region) можно настроить альтернативные планы отработки отказа для повышения производительности маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="dcad7-312">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span></span>
* <span data-ttu-id="dcad7-313">**Географический**.</span><span class="sxs-lookup"><span data-stu-id="dcad7-313">**Geographic**.</span></span> <span data-ttu-id="dcad7-314">Конечная точка Hello сопоставлен tooserve hello географическое расположение в зависимости от hello запрос вернул IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="dcad7-314">hello endpoint mapped tooserve hello geographic location based on hello query request IP’s is returned.</span></span> <span data-ttu-id="dcad7-315">В случае недоступности этой конечной точки другой конечной точкой не будет выбранных toofailover, так как географическое расположение может быть сопоставленный только конечная точка tooone в профиле (Дополнительные сведения находятся в hello [часто задаваемые вопросы о](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span><span class="sxs-lookup"><span data-stu-id="dcad7-315">If that endpoint is unavailable, another endpoint will not be selected toofailover to, since a geographic location can be mapped only tooone endpoint in a profile (more details are in hello [FAQ](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span></span> <span data-ttu-id="dcad7-316">Рекомендуется, при использовании географического маршрутизации мы рекомендуем toouse вложенных профилей диспетчера трафика с более чем одной конечной точкой как конечные точки hello hello профиля.</span><span class="sxs-lookup"><span data-stu-id="dcad7-316">As a best practice, when using geographic routing, we recommend customers toouse nested Traffic Manager profiles with more than one endpoint as hello endpoints of hello profile.</span></span>

<span data-ttu-id="dcad7-317">Дополнительные сведения см. в разделе [Методы маршрутизации трафика диспетчером трафика](traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="dcad7-317">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span></span>

> [!NOTE]
> <span data-ttu-id="dcad7-318">Одно исключение toonormal маршрутизации трафика происходит, когда все подходящие конечные точки со статусом ограниченной.</span><span class="sxs-lookup"><span data-stu-id="dcad7-318">One exception toonormal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span></span> <span data-ttu-id="dcad7-319">Диспетчер трафика делает попытку «максимум усилий» и *будет считать, что все конечные точки состояние Деградация hello фактически находятся в оперативном состоянии*.</span><span class="sxs-lookup"><span data-stu-id="dcad7-319">Traffic Manager makes a "best effort" attempt and *responds as if all hello Degraded status endpoints actually are in an online state*.</span></span> <span data-ttu-id="dcad7-320">Такое поведение является более предпочтительным, чем toohello вместо того, что было бы toonot возвращают любой конечной точке в hello ответ DNS.</span><span class="sxs-lookup"><span data-stu-id="dcad7-320">This behavior is preferable toohello alternative, which would be toonot return any endpoint in hello DNS response.</span></span> <span data-ttu-id="dcad7-321">Отключенные и остановленные конечные точки не отслеживаются, таким образом, они не считаются допустимыми для трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-321">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span></span>
>
> <span data-ttu-id="dcad7-322">Это условие обычно вызвана неправильной конфигурации службы hello, такие как:</span><span class="sxs-lookup"><span data-stu-id="dcad7-322">This condition is commonly caused by improper configuration of hello service, such as:</span></span>
>
> * <span data-ttu-id="dcad7-323">Список управления доступом [ACL] Блокирование проверки работоспособности hello диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-323">An access control list [ACL] blocking hello Traffic Manager health checks.</span></span>
> * <span data-ttu-id="dcad7-324">Неправильная конфигурация hello мониторинга порта или протокол в hello профиль диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-324">An improper configuration of hello monitoring port or protocol in hello Traffic manager profile.</span></span>
>
> <span data-ttu-id="dcad7-325">Hello вследствие такого поведения —, если проверку на работоспособность диспетчера трафика не настроен правильно, она может оказаться hello трафика, как будто Маршрутизация диспетчера трафика *—* работает должным образом.</span><span class="sxs-lookup"><span data-stu-id="dcad7-325">hello consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from hello traffic routing as though Traffic Manager *is* working properly.</span></span> <span data-ttu-id="dcad7-326">Кроме того, в этом случае при сбое конечной точки не происходит отработка отказа, что негативно влияет на общую доступность приложения.</span><span class="sxs-lookup"><span data-stu-id="dcad7-326">However, in this case, endpoint failover cannot happen which affects overall application availability.</span></span> <span data-ttu-id="dcad7-327">Это важные toocheck, что профиль hello показывает состояние не состояние Деградация.</span><span class="sxs-lookup"><span data-stu-id="dcad7-327">It is important toocheck that hello profile shows an Online status, not a Degraded status.</span></span> <span data-ttu-id="dcad7-328">Состояние указывает, hello диспетчера трафика работоспособности проверяет работают надлежащим образом.</span><span class="sxs-lookup"><span data-stu-id="dcad7-328">An Online status indicates that hello Traffic Manager health checks are working as expected.</span></span>

<span data-ttu-id="dcad7-329">Дополнительную информацию об устранении неполадок, вызвавших сбой при проверке работоспособности, см. в разделе [Устранение неполадок с состоянием пониженной функциональности в диспетчере трафика Azure](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="dcad7-329">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span>



## <a name="next-steps"></a><span data-ttu-id="dcad7-330">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="dcad7-330">Next steps</span></span>

<span data-ttu-id="dcad7-331">Узнайте о том, [как работает диспетчер трафика](traffic-manager-how-traffic-manager-works.md)</span><span class="sxs-lookup"><span data-stu-id="dcad7-331">Learn [how Traffic Manager works](traffic-manager-how-traffic-manager-works.md)</span></span>

<span data-ttu-id="dcad7-332">Дополнительные сведения о hello [методов маршрутизации трафика](traffic-manager-routing-methods.md) поддерживается диспетчером трафика</span><span class="sxs-lookup"><span data-stu-id="dcad7-332">Learn more about hello [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span></span>

<span data-ttu-id="dcad7-333">Узнайте, каким образом слишком[создать профиль диспетчера трафика](traffic-manager-manage-profiles.md)</span><span class="sxs-lookup"><span data-stu-id="dcad7-333">Learn how too[create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span></span>

<span data-ttu-id="dcad7-334">[устранении неполадок с состоянием пониженной функциональности](traffic-manager-troubleshooting-degraded.md) конечной точки диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="dcad7-334">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span></span>
