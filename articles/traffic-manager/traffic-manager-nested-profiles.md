---
title: "Профили диспетчера трафика aaaNested | Документы Microsoft"
description: "В этой статье описывается функция «Вложенных профилей» hello диспетчера трафика Azure"
services: traffic-manager
documentationcenter: 
author: kumudd
manager: timlt
editor: 
ms.assetid: f1b112c4-a3b1-496e-90eb-41e235a49609
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/22/2017
ms.author: kumud
ms.openlocfilehash: e476d58a82ed94d12731156280c9665f980de0e4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="nested-traffic-manager-profiles"></a>Вложенные профили диспетчера трафика

Диспетчер трафика включает широкий набор методов маршрутизации трафика, позволяющие toocontrol, каким образом выбирает диспетчера трафика конечной точки, которая должна получать трафик из всех конечных пользователей. Дополнительные сведения см. в разделе [Методы маршрутизации трафика диспетчером трафика](traffic-manager-routing-methods.md).

Каждый профиль диспетчера трафика определяет один метод маршрутизации трафика. Однако существуют сценарии, требующие более сложные маршрутизации трафика, чем hello маршрутизации, предоставляемые единый профиль диспетчера трафика. Можно вложить профилей диспетчера трафика toocombine преимущества hello более чем один метод маршрутизации трафика. Вложенные профили позволяют toooverride hello по умолчанию диспетчер трафика поведение toosupport больших и сложных развертываний приложений.

Привет, следующие примеры иллюстрируют, как toouse вложенных профилей диспетчера трафика в различных сценариях.

## <a name="example-1-combining-performance-and-weighted-traffic-routing"></a>Пример 1. Объединение маршрутизации трафика для повышения производительности и маршрутизации трафика со взвешиванием

Предположим, что развернутой приложения в следующих регионах Azure hello: Запад США, Восточная Азия и Западная Европа. Использовании диспетчера трафика «Производительность» Маршрутизация трафика метод toodistribute трафика toohello области ближайший toohello user.

![Отдельный профиль диспетчера трафика][4]

Теперь предположим, что вы хотите tootest tooyour обновления перед его реализацией более широко. Вы хотите toouse hello «взвешенного» Маршрутизация трафика метод toodirect небольшой процент от трафика tooyour тестирования развертывания. Настройка развертывания тестов hello вместе с hello существующую рабочую среду в Западной Европе.

И вы не можете использовать одновременно два метода маршрутизации трафика в одном профиле. toosupport этот сценарий создания профиля диспетчера трафика с помощью конечных точек двух hello Западной Европе и метод маршрутизации трафика «Взвешенное» hello. Далее этот профиль 'child' Добавить как профиль toohello конечной точки «parent». Hello родительским профилем по-прежнему использует метод маршрутизации трафика производительности hello и содержит другие глобального развертывания hello как конечные точки.

Привет, следующая схема иллюстрирует этот пример:

![Вложенные профили диспетчера трафика][2]

В этой конфигурации трафик, направленный через hello родительский профиль распределяет трафик по регионам обычно. В Западной Европе hello вложенного профиля распределяет трафик toohello рабочего и тестового конечных точек в соответствии с toohello весовые.

Когда родительский профиль hello использует метод маршрутизации трафика «Производительность» hello, каждой конечной точки должно быть назначено расположение. расположение Hello назначается при настройке конечной точки hello. Выберите ближайший развертывания tooyour hello регион Azure. Hello Azure области — это значения расположения hello поддерживается hello таблицы задержек Интернета. Дополнительные сведения см. в разделе [Метод маршрутизации трафика по приоритету](traffic-manager-routing-methods.md#performance).

## <a name="example-2-endpoint-monitoring-in-nested-profiles"></a>Пример 2. Мониторинг конечных точек во вложенных профилях

Диспетчер трафика активно отслеживает работоспособность hello каждой конечной точки службы. Если неработоспособен конечной точки, диспетчер трафика направляет пользователей tooalternative конечные точки toopreserve hello доступности службы. Это поведение конечной точки мониторинг и отработка отказа применяется tooall методов маршрутизации трафика. Дополнительные сведения см. в статье [Мониторинг и отработка отказов конечной точки диспетчера трафика](traffic-manager-monitoring.md). Мониторинг конечных точек выполняется иначе для вложенных профилей. С помощью вложенных профилей hello родительский профиль не выполняет проверку работоспособности на дочернем hello напрямую. Вместо этого hello работоспособности конечных точек hello дочернем профиле является используется toocalculate hello общую работоспособность hello дочернем профиле. Эта информация распространяется вверх по иерархии вложенных hello профиля. Hello родительский профиль использует этот toodetermine сводной работоспособности ли toodirect трафика toohello дочернем профиле. В разделе hello [часто задаваемые вопросы о](traffic-manager-FAQs.md#traffic-manager-nested-profiles) полные сведения о вложенных профилей наблюдение за работоспособностью.

Возвращение toohello предыдущего примера, предположим, что происходит сбой развертывания рабочей hello в Западной Европе. По умолчанию hello 'child' профиль направляет трафик toohello тестовое развертывание всех. Если тестовое развертывание hello также завершается ошибкой, hello родительский профиль определяет hello дочернем профиле не должен принимать трафик, так как все конечные точки дочерних находятся в неработоспособном состоянии. Затем hello родительским профилем распределяет трафик toohello других регионах.

![Отработка отказа вложенного профиля (поведение по умолчанию)][3]

Возможно, такой подход вас вполне устроит. Или может возникнуть вопрос, весь трафик для Западной Европе теперь будет toohello тестовое развертывание вместо трафика ограниченный набор. Независимо от работоспособности hello hello тестирования, развертывания, требуется toofail к toohello других регионах при сбое hello рабочее развертывание в Западной Европе. tooenable перехода на другой ресурс, можно задать параметр «MinChildEndpoints» hello при настройке hello дочернем профиле в качестве конечной точки в родительском профиле hello. параметр Hello определяет минимальное количество доступных конечных точек в дочернем профиле hello hello. значение по умолчанию Hello — "1". Для этого сценария набор too2 значение MinChildEndpoints hello. Ниже данного порога hello родительским профилем рассматривает toobe профиль hello все дочерние недоступна и направляет трафик toohello другими конечными точками.

Hello следующей схеме показана эта конфигурация:

![Отработка отказа для вложенных профилей при MinChildEndpoints = 2][4]

> [!NOTE]
> Метод маршрутизации трафика «Приоритет» Hello распределяет трафик tooa отдельную конечную точку. Поэтому в таком случае нет смысла задавать значение выше 1 для параметра MinChildEndpoints.

## <a name="example-3-prioritized-failover-regions-in-performance-traffic-routing"></a>Пример 3. Расположенные по приоритетам регионы отработки отказа при маршрутизации трафика для повышения производительности

поведение по умолчанию Hello hello метод маршрутизации трафика «Производительность» — спроектированный tooavoid чрезмерную загрузку hello рядом ближайшего конечной точки и вызывают каскадных серии отказов. При сбое конечной точки, весь трафик, который может попасть, конечная точка toothat будет равномерно распределенных toohello других конечных точек во всех областях.

![Маршрутизация трафика по производительности с отработкой отказа по умолчанию][5]

Тем не менее Предположим, что вы предпочитаете hello Западной Европе трафика отработки отказа tooWest нам только направить трафик tooother области, когда обе конечные точки будут недоступны. Можно создать это решение, использование в дочерний профиль с hello метод маршрутизации трафика «Приоритет».

![Маршрутизация трафика для повышения производительности с отработкой отказа по предпочтению][6]

Так как конечная точка Западной Европе hello имеет более высокий приоритет, чем конечная точка hello Запад США, весь трафик отправляется конечной точки toohello Западной Европе, если обе конечные точки находятся в оперативном режиме. При сбое Западной Европе, его трафика — расширенный tooWest США. С профилем hello вложенные трафика является направленной tooEast Азия только в том случае, если Западная Европа, Запад США завершиться ошибкой.

Этот шаблон можно распространить на все регионы. Замените все три конечные точки в родительском профиле hello три дочерних профилей, каждый из которых обеспечивает последовательность приоритетов отработки отказа.

## <a name="example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-hello-same-region"></a>Пример 4: Управление маршрутизации между несколькими конечными точками в hello же трафика «Производительность» область

Предположим, что hello производительности метод маршрутизации трафика используется в профиль, имеющий более одной конечной точки в определенном регионе. По умолчанию трафик направлены области toothat распределяется равномерно между доступных конечных точек в этом регионе.

![Распределение трафика в регионе при маршрутизации трафика по производительности (поведение по умолчанию)][7]

Чтобы не добавлять в регион Западная Европа несколько конечных точек, мы можем заключить их в отдельный дочерний профиль. Hello дочернем профиле добавляется родительский toohello как hello только конечной точки в Западной Европе. Параметры Hello в дочернем профиле hello позволяют управлять hello распределение трафика с Западной Европе, включив, входящие в эту область для маршрутизации трафика на основании приоритета или взвешенного.

![Маршрутизация трафика по производительности с пользовательской настройкой распределения трафика в регионе][8]

## <a name="example-5-per-endpoint-monitoring-settings"></a>Пример 5. Параметры мониторинга каждой конечной точки

Предположим, что вы используете toosmoothly диспетчера трафика переноса трафика из прежних версий в локальной веб-сайта tooa новой облачной версии размещенных в Azure. Для предыдущих версий сайта hello требуется toomonitor toouse hello Домашняя страница URI работоспособность сайта. Но для hello новой облачной версии, при реализации пользовательской страницы мониторинга (путь "/ monitor.aspx"), включающего дополнительные проверки.

![Мониторинг конечных точек диспетчером трафика (поведение по умолчанию)][9]

параметры мониторинга Hello в профиле диспетчера трафика применяются tooall конечных точек в одном профиле. С помощью вложенных профилей используется другим дочерним профиль каждого узла toodefine разные параметры мониторинга.

![Мониторинг диспетчером трафика конечных точек с индивидуальными параметрами][10]

## <a name="next-steps"></a>Дальнейшие действия

Узнайте больше о [профилях диспетчера трафика](traffic-manager-overview.md).

Узнайте, каким образом слишком[создать профиль диспетчера трафика](traffic-manager-create-profile.md)

<!--Image references-->
[1]: ./media/traffic-manager-nested-profiles/figure-1.png
[2]: ./media/traffic-manager-nested-profiles/figure-2.png
[3]: ./media/traffic-manager-nested-profiles/figure-3.png
[4]: ./media/traffic-manager-nested-profiles/figure-4.png
[5]: ./media/traffic-manager-nested-profiles/figure-5.png
[6]: ./media/traffic-manager-nested-profiles/figure-6.png
[7]: ./media/traffic-manager-nested-profiles/figure-7.png
[8]: ./media/traffic-manager-nested-profiles/figure-8.png
[9]: ./media/traffic-manager-nested-profiles/figure-9.png
[10]: ./media/traffic-manager-nested-profiles/figure-10.png
