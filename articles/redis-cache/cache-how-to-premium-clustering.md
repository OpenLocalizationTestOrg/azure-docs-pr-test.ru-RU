---
title: "aaaHow tooconfigure Redis кластеризации для кэша Redis Azure Premium | Документы Microsoft"
description: "Узнайте, как toocreate и управления ими кластеризации для повышенного уровня экземпляров кэша Redis для Azure Redis"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 62208eec-52ae-4713-b077-62659fd844ab
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 07/05/2017
ms.author: sdanie
ms.openlocfilehash: 44d520facb9d1af145b69f1b58f082aabb655d4a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-redis-clustering-for-a-premium-azure-redis-cache"></a><span data-ttu-id="c6bb0-103">Как tooconfigure Redis кластеризации для кэша Redis Azure Premium</span><span class="sxs-lookup"><span data-stu-id="c6bb0-103">How tooconfigure Redis clustering for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="c6bb0-104">Кэш Azure Redis имеет разные предложения кэша, которые обеспечивают гибкость при hello Выбор размера кэша и функций, включая возможности уровня Premium кластеризации, сохраняемости и поддержки виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="c6bb0-105">В этой статье описывается, как tooconfigure кластеризации в расширенной Azure Redis кэш экземпляра.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-105">This article describes how tooconfigure clustering in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="c6bb0-106">Сведения о других функций кэша premium см. в разделе [уровня Premium кэша Redis Azure введение toohello](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-106">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-redis-cluster"></a><span data-ttu-id="c6bb0-107">Что такое кластер Redis?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-107">What is Redis Cluster?</span></span>
<span data-ttu-id="c6bb0-108">Кэш Redis для Azure предлагает кластер Redis в том виде, как это [реализовано в Redis](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-108">Azure Redis Cache offers Redis cluster as [implemented in Redis](http://redis.io/topics/cluster-tutorial).</span></span> <span data-ttu-id="c6bb0-109">С помощью Redis кластера можно получить следующие преимущества hello:</span><span class="sxs-lookup"><span data-stu-id="c6bb0-109">With Redis Cluster, you get hello following benefits:</span></span> 

* <span data-ttu-id="c6bb0-110">Hello tooautomatically возможность разделить набор данных между несколькими узлами.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-110">hello ability tooautomatically split your dataset among multiple nodes.</span></span> 
* <span data-ttu-id="c6bb0-111">Hello возможность toocontinue операций при подмножество узлов hello возникли сбои или являются не удается toocommunicate с остальной hello hello кластера.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-111">hello ability toocontinue operations when a subset of hello nodes is experiencing failures or are unable toocommunicate with hello rest of hello cluster.</span></span> 
* <span data-ttu-id="c6bb0-112">Более высокая пропускная способность: пропускная способность линейно увеличивается по мере увеличения hello количество сегментов.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-112">More throughput: Throughput increases linearly as you increase hello number of shards.</span></span> 
* <span data-ttu-id="c6bb0-113">Дополнительные объем памяти: линейно возрастает по мере увеличения hello количество сегментов.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-113">More memory size: Increases linearly as you increase hello number of shards.</span></span>  

<span data-ttu-id="c6bb0-114">Дополнительные сведения о размере, пропускной способности и полосе пропускания для кэшей уровня "Премиум" см. в разделе [Какое предложение и размер кэша Redis нужно использовать?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)</span><span class="sxs-lookup"><span data-stu-id="c6bb0-114">For more information about size, throughput, and bandwidth with premium caches, see [What Redis Cache offering and size should I use?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)</span></span>

<span data-ttu-id="c6bb0-115">В Azure кластере Redis предлагается как первичный и реплика модели, где каждый сегмент имеет пару первичный/реплика с репликацией где репликации hello управляется службой кэша Azure Redis.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-115">In Azure, Redis cluster is offered as a primary/replica model where each shard has a primary/replica pair with replication where hello replication is managed by Azure Redis Cache service.</span></span> 

## <a name="clustering"></a><span data-ttu-id="c6bb0-116">Кластеризация</span><span class="sxs-lookup"><span data-stu-id="c6bb0-116">Clustering</span></span>
<span data-ttu-id="c6bb0-117">Hello включена кластеризация **новый кэш Redis** колонке во время создания кэша.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-117">Clustering is enabled on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="c6bb0-118">Кластеризация настраивается на hello **Redis кластера** колонку.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-118">Clustering is configured on hello **Redis Cluster** blade.</span></span>

![Кластеризация][redis-cache-clustering]

<span data-ttu-id="c6bb0-120">Можно создать до too10 сегментов в кластере hello.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-120">You can have up too10 shards in hello cluster.</span></span> <span data-ttu-id="c6bb0-121">Нажмите кнопку **включено** и передвиньте ползунок hello, или введите число от 1 до 10 для **количества сегментов** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-121">Click **Enabled** and slide hello slider or type a number between 1 and 10 for **Shard count** and click **OK**.</span></span>

<span data-ttu-id="c6bb0-122">Каждый сегмент — это пара кэша первичный/реплика, управляет Azure и общий размер кэша hello hello вычисляется путем умножения на размер кэша hello, выбранного в ценовой категории hello hello количество сегментов.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-122">Each shard is a primary/replica cache pair managed by Azure, and hello total size of hello cache is calculated by multiplying hello number of shards by hello cache size selected in hello pricing tier.</span></span> 

![Кластеризация][redis-cache-clustering-selected]

<span data-ttu-id="c6bb0-124">После создания кэша hello подключения tooit и используется только как кэш некластеризованных и Redis распределяет данные hello в сегменты кэша hello.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-124">Once hello cache is created you connect tooit and use it just like a non-clustered cache, and Redis distributes hello data throughout hello Cache shards.</span></span> <span data-ttu-id="c6bb0-125">Если Диагностика [включен](cache-how-to-monitor.md#enable-cache-diagnostics), метрики записываются отдельно для каждого сегмента и может быть [просмотреть](cache-how-to-monitor.md) в колонку кэша Redis hello.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-125">If diagnostics is [enabled](cache-how-to-monitor.md#enable-cache-diagnostics), metrics are captured separately for each shard and can be [viewed](cache-how-to-monitor.md) in hello Redis Cache blade.</span></span> 

> [!NOTE]
> 
> <span data-ttu-id="c6bb0-126">Существует ряд незначительных отличий, необходимых в клиентском приложении для настройки кластеризации.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-126">There are some minor differences required in your client application when clustering is configured.</span></span> <span data-ttu-id="c6bb0-127">Дополнительные сведения см. в разделе [необходимо toomake любые изменения toomy клиентского приложения toouse кластеризации?](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)</span><span class="sxs-lookup"><span data-stu-id="c6bb0-127">For more information, see [Do I need toomake any changes toomy client application toouse clustering?](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)</span></span>
> 
> 

<span data-ttu-id="c6bb0-128">Пример кода по работе с кластером с клиента StackExchange.Redis hello, в разделе hello [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) часть hello [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) образца.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-128">For sample code on working with clustering with hello StackExchange.Redis client, see hello [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) portion of hello [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) sample.</span></span>

<a name="cluster-size"></a>

## <a name="change-hello-cluster-size-on-a-running-premium-cache"></a><span data-ttu-id="c6bb0-129">Изменение размера hello кластера, на котором установлена кэша premium</span><span class="sxs-lookup"><span data-stu-id="c6bb0-129">Change hello cluster size on a running premium cache</span></span>
<span data-ttu-id="c6bb0-130">размер кластера hello toochange на выполнение расширенной кэш с кластеризации включено, щелкните **Redis размер кластера** из hello **ресурсов меню**.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-130">toochange hello cluster size on a running premium cache with clustering enabled, click **Redis Cluster Size** from hello **Resource menu**.</span></span>

> [!NOTE]
> <span data-ttu-id="c6bb0-131">Хотя hello Azure Redis кэша Premium уровня был выпущен tooGeneral доступности, hello Redis размер кластера компонент в настоящий момент в режиме предварительного просмотра.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-131">While hello Azure Redis Cache Premium tier has been released tooGeneral Availability, hello Redis Cluster Size feature is currently in preview.</span></span>
> 
> 

![Размер кластера Redis][redis-cache-redis-cluster-size]

<span data-ttu-id="c6bb0-133">размер кластера toochange hello, используйте ползунок hello, или введите число от 1 до 10 в hello **количества сегментов** текстовое поле и нажмите кнопку **ОК** toosave.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-133">toochange hello cluster size, use hello slider or type a number between 1 and 10 in hello **Shard count** text box and click **OK** toosave.</span></span>

> [!NOTE]
> <span data-ttu-id="c6bb0-134">Масштабирование на кластере выполняется hello [МИГРАЦИИ](https://redis.io/commands/migrate) команду, которая является ресурсоемким, поэтому для минимальное влияние рассмотрите возможность выполнения этой операции во время нерабочего времени.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-134">Scaling a cluster runs hello [MIGRATE](https://redis.io/commands/migrate) command, which is an expensive command, so for minimal impact, consider running this operation during non-peak hours.</span></span> <span data-ttu-id="c6bb0-135">Во время процесса миграции hello будет отмечен пик в нагрузки сервера.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-135">During hello migration process, you will see a spike in server load.</span></span> <span data-ttu-id="c6bb0-136">Масштабирование кластера long запущен процесс и hello длительность зависит от числа hello ключей и размера hello значения, связанные с этими ключами.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-136">Scaling a cluster is a long running process and hello amount of time taken depends on hello number of keys and size of hello values associated with those keys.</span></span>
> 
> 

## <a name="clustering-faq"></a><span data-ttu-id="c6bb0-137">Часто задаваемые вопросы по кластеризации</span><span class="sxs-lookup"><span data-stu-id="c6bb0-137">Clustering FAQ</span></span>
<span data-ttu-id="c6bb0-138">Hello следующий список содержит toocommonly ответы, вопросы и ответы о кластеризации кэша Redis для Azure.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-138">hello following list contains answers toocommonly asked questions about Azure Redis Cache clustering.</span></span>

* [<span data-ttu-id="c6bb0-139">Зачем мне toomake любые изменения toomy клиентского приложения toouse кластеризации?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-139">Do I need toomake any changes toomy client application toouse clustering?</span></span>](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)
* [<span data-ttu-id="c6bb0-140">Распределение ключей в кластере</span><span class="sxs-lookup"><span data-stu-id="c6bb0-140">How are keys distributed in a cluster?</span></span>](#how-are-keys-distributed-in-a-cluster)
* [<span data-ttu-id="c6bb0-141">Что такое размер кэша наибольшее hello, которые я могу создать?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-141">What is hello largest cache size I can create?</span></span>](#what-is-the-largest-cache-size-i-can-create)
* [<span data-ttu-id="c6bb0-142">Все ли клиенты Redis поддерживают кластеризацию?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-142">Do all Redis clients support clustering?</span></span>](#do-all-redis-clients-support-clustering)
* [<span data-ttu-id="c6bb0-143">Как подключаться toomy кэша, если включена кластеризация?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-143">How do I connect toomy cache when clustering is enabled?</span></span>](#how-do-i-connect-to-my-cache-when-clustering-is-enabled)
* [<span data-ttu-id="c6bb0-144">Можно напрямую подключить отдельные сегменты toohello Мой кэша?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-144">Can I directly connect toohello individual shards of my cache?</span></span>](#can-i-directly-connect-to-the-individual-shards-of-my-cache)
* [<span data-ttu-id="c6bb0-145">Можно ли настроить кластеризацию для ранее созданного кэша?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-145">Can I configure clustering for a previously created cache?</span></span>](#can-i-configure-clustering-for-a-previously-created-cache)
* [<span data-ttu-id="c6bb0-146">Можно ли настроить кластеризацию для кэша уровней Базовый и Стандартный?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-146">Can I configure clustering for a basic or standard cache?</span></span>](#can-i-configure-clustering-for-a-basic-or-standard-cache)
* [<span data-ttu-id="c6bb0-147">Можно ли использовать кластеризации с поставщиками состояний сеансов ASP.NET Redis и кэширования вывода hello</span><span class="sxs-lookup"><span data-stu-id="c6bb0-147">Can I use clustering with hello Redis ASP.NET Session State and Output Caching providers?</span></span>](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)
* [<span data-ttu-id="c6bb0-148">При использовании StackExchange.Redis и кластеризации порождаются исключения MOVE. Что делать?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-148">I am getting MOVE exceptions when using StackExchange.Redis and clustering, what should I do?</span></span>](#i-am-getting-move-exceptions-when-using-stackexchangeredis-and-clustering-what-should-i-do)

### <a name="do-i-need-toomake-any-changes-toomy-client-application-toouse-clustering"></a><span data-ttu-id="c6bb0-149">Зачем мне toomake любые изменения toomy клиентского приложения toouse кластеризации?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-149">Do I need toomake any changes toomy client application toouse clustering?</span></span>
* <span data-ttu-id="c6bb0-150">Если кластеризация включена, доступна только база данных 0.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-150">When clustering is enabled, only database 0 is available.</span></span> <span data-ttu-id="c6bb0-151">Если клиентское приложение использует несколько баз данных, и она попытается tooread или записи базы данных tooa, отличное от 0, hello следующие исключения.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-151">If your client application uses multiple databases and it tries tooread or write tooa database other than 0, hello following exception is thrown.</span></span> <span data-ttu-id="c6bb0-152">`Unhandled Exception: StackExchange.Redis.RedisConnectionException: ProtocolFailure on GET --->` `StackExchange.Redis.RedisCommandException: Multiple databases are not supported on this server; cannot switch toodatabase: 6`</span><span class="sxs-lookup"><span data-stu-id="c6bb0-152">`Unhandled Exception: StackExchange.Redis.RedisConnectionException: ProtocolFailure on GET --->` `StackExchange.Redis.RedisCommandException: Multiple databases are not supported on this server; cannot switch toodatabase: 6`</span></span>
  
  <span data-ttu-id="c6bb0-153">Дополнительные сведения см. в разделе "Implemented subset" (Реализованное подмножество) статьи [Redis Cluster Specification](http://redis.io/topics/cluster-spec#implemented-subset) (Спецификация кластера Redis).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-153">For more information, see [Redis Cluster Specification - Implemented subset](http://redis.io/topics/cluster-spec#implemented-subset).</span></span>
* <span data-ttu-id="c6bb0-154">Если вы используете клиент [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/), необходимо установить версию 1.0.481 или более позднюю.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-154">If you are using [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/), you must use 1.0.481 or later.</span></span> <span data-ttu-id="c6bb0-155">Подключение toohello кэша с помощью hello же [конечных точек, порты и ключи](cache-configure.md#properties) , используемый при соединении tooa кэша, у которого нет кластеризации включена.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-155">You connect toohello cache using hello same [endpoints, ports, and keys](cache-configure.md#properties) that you use when connecting tooa cache that does not have clustering enabled.</span></span> <span data-ttu-id="c6bb0-156">Hello единственное отличие заключается в том, что все операции чтения и записи должны выполняться toodatabase 0.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-156">hello only difference is that all reads and writes must be done toodatabase 0.</span></span>
  
  * <span data-ttu-id="c6bb0-157">Требования других клиентов могут отличаться.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-157">Other clients may have different requirements.</span></span> <span data-ttu-id="c6bb0-158">Ознакомьтесь с разделом [Все ли клиенты Redis поддерживают кластеризацию?](#do-all-redis-clients-support-clustering)</span><span class="sxs-lookup"><span data-stu-id="c6bb0-158">See [Do all Redis clients support clustering?](#do-all-redis-clients-support-clustering)</span></span>
* <span data-ttu-id="c6bb0-159">Если приложение использует несколько операций с ключом объединены в одну команду, все ключи должны находиться в hello же сегментов.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-159">If your application uses multiple key operations batched into a single command, all keys must be located in hello same shard.</span></span> <span data-ttu-id="c6bb0-160">ключи toolocate в hello же сегментов см. в разделе [ключи распределение в кластере?](#how-are-keys-distributed-in-a-cluster)</span><span class="sxs-lookup"><span data-stu-id="c6bb0-160">toolocate keys in hello same shard, see [How are keys distributed in a cluster?](#how-are-keys-distributed-in-a-cluster)</span></span>
* <span data-ttu-id="c6bb0-161">Если вы используете поставщик состояний сеансов ASP.NET Redis, вам необходимо установить версию 2.0.1 или более позднюю версию.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-161">If you are using Redis ASP.NET Session State provider you must use 2.0.1 or higher.</span></span> <span data-ttu-id="c6bb0-162">В разделе [используется кластеризация с поставщиками состояний сеансов ASP.NET Redis и кэширования вывода hello?](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)</span><span class="sxs-lookup"><span data-stu-id="c6bb0-162">See [Can I use clustering with hello Redis ASP.NET Session State and Output Caching providers?](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)</span></span>

### <a name="how-are-keys-distributed-in-a-cluster"></a><span data-ttu-id="c6bb0-163">Распределение ключей в кластере</span><span class="sxs-lookup"><span data-stu-id="c6bb0-163">How are keys distributed in a cluster?</span></span>
<span data-ttu-id="c6bb0-164">На hello Redis [модели распространения ключей](http://redis.io/topics/cluster-spec#keys-distribution-model) документации: клавиша "пробел" hello разбивается на 16384 слотов.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-164">Per hello Redis [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model) documentation: hello key space is split into 16384 slots.</span></span> <span data-ttu-id="c6bb0-165">Каждый ключ является хэшируются и назначенный tooone эти слотов, которые распределены между узлами hello hello кластера.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-165">Each key is hashed and assigned tooone of these slots, which are distributed across hello nodes of hello cluster.</span></span> <span data-ttu-id="c6bb0-166">Настраивается хэшированных tooensure, которые находятся несколько ключей, в какие входит ключ hello hello же сегментов с помощью тегов хэш.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-166">You can configure which part of hello key is hashed tooensure that multiple keys are located in hello same shard using hash tags.</span></span>

* <span data-ttu-id="c6bb0-167">Ключи с тегом хэш - Если заключен в любой части ключа hello `{` и `}`, только эту часть ключа hello хэшируется для целей hello определения hello слот хэш ключа.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-167">Keys with a hash tag - if any part of hello key is enclosed in `{` and `}`, only that part of hello key is hashed for hello purposes of determining hello hash slot of a key.</span></span> <span data-ttu-id="c6bb0-168">Например, следующие 3 ключи hello будут размещены в hello же сегментов: `{key}1`, `{key}2`, и `{key}3` с момента только hello `key` часть имени hello хэшируется.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-168">For example, hello following 3 keys would be located in hello same shard: `{key}1`, `{key}2`, and `{key}3` since only hello `key` part of hello name is hashed.</span></span> <span data-ttu-id="c6bb0-169">Полный список спецификаций для хэш-тегов ключей см. в разделе [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags) (Хэш-теги ключей).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-169">For a complete list of keys hash tag specifications, see [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags).</span></span>
* <span data-ttu-id="c6bb0-170">Ключи без тега хэш - hello весь раздел используется для хэширования.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-170">Keys without a hash tag - hello entire key name is used for hashing.</span></span> <span data-ttu-id="c6bb0-171">В результате статистически равномерное распределение по сегментам hello hello кэша.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-171">This results in a statistically even distribution across hello shards of hello cache.</span></span>

<span data-ttu-id="c6bb0-172">Для оптимальной производительности и пропускной способности рекомендуется равномерно распределить hello ключей.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-172">For best performance and throughput, we recommend distributing hello keys evenly.</span></span> <span data-ttu-id="c6bb0-173">При использовании ключей с тегом хэш это приложение hello ответственности tooensure hello ключи распределяются равномерно.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-173">If you are using keys with a hash tag it is hello application's responsibility tooensure hello keys are distributed evenly.</span></span>

<span data-ttu-id="c6bb0-174">Дополнительные сведения см. в разделах [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model) (Модель распределения ключей), [Redis Cluster data sharding](http://redis.io/topics/cluster-tutorial#redis-cluster-data-sharding) (Сегментирование данных в кластере Redis) и [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags) (Хэш-теги ключей).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-174">For more information, see [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model), [Redis Cluster data sharding](http://redis.io/topics/cluster-tutorial#redis-cluster-data-sharding), and [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags).</span></span>

<span data-ttu-id="c6bb0-175">Пример кода по работе с кластеризацией и Поиск ключей в hello hello см же сегментировать данные с помощью клиента StackExchange.Redis hello, [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) часть hello [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) образца.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-175">For sample code on working with clustering and locating keys in hello same shard with hello StackExchange.Redis client, see hello [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) portion of hello [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) sample.</span></span>

### <a name="what-is-hello-largest-cache-size-i-can-create"></a><span data-ttu-id="c6bb0-176">Что такое размер кэша наибольшее hello, которые я могу создать?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-176">What is hello largest cache size I can create?</span></span>
<span data-ttu-id="c6bb0-177">Hello наибольший размер кэша premium — 53 ГБ.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-177">hello largest premium cache size is 53 GB.</span></span> <span data-ttu-id="c6bb0-178">Можно создать копию too10 сегментов, предоставляя максимальный размер 530 ГБ.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-178">You can create up too10 shards giving you a maximum size of 530 GB.</span></span> <span data-ttu-id="c6bb0-179">Если требуется больший размер, вы можете [отправить запрос на получение дополнительного места](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-179">If you need a larger size you can [request more](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase).</span></span> <span data-ttu-id="c6bb0-180">Подробные сведения см. на странице [Цены на кэш Redis для Azure](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-180">For more information, see [Azure Redis Cache Pricing](https://azure.microsoft.com/pricing/details/cache/).</span></span>

### <a name="do-all-redis-clients-support-clustering"></a><span data-ttu-id="c6bb0-181">Все ли клиенты Redis поддерживают кластеризацию?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-181">Do all Redis clients support clustering?</span></span>
<span data-ttu-id="c6bb0-182">В hello в настоящее время поддерживают не все клиенты Redis кластеризации.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-182">At hello present time not all clients support Redis clustering.</span></span> <span data-ttu-id="c6bb0-183">Например, ее не поддерживает StackExchange.Redis.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-183">StackExchange.Redis is one that does support for it.</span></span> <span data-ttu-id="c6bb0-184">Дополнительные сведения о других клиентов см. в разделе hello [воспроизведение с кластером hello](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) раздел hello [Redis кластера учебника](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-184">For more information on other clients, see hello [Playing with hello cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) section of hello [Redis cluster tutorial](http://redis.io/topics/cluster-tutorial).</span></span>

> [!NOTE]
> <span data-ttu-id="c6bb0-185">При использовании StackExchange.Redis в качестве клиента убедитесь в использовании hello последнюю версию [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 или более поздней версии для кластеризации toowork правильно.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-185">If you are using StackExchange.Redis as your client, ensure you are using hello latest version of [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 or later for clustering toowork correctly.</span></span> <span data-ttu-id="c6bb0-186">При возникновении проблем с исключениями MOVE ознакомьтесь с дополнительными сведениями [здесь](#move-exceptions).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-186">If you have any issues with move exceptions, see [move exceptions](#move-exceptions) for more information.</span></span>
> 
> 

### <a name="how-do-i-connect-toomy-cache-when-clustering-is-enabled"></a><span data-ttu-id="c6bb0-187">Как подключаться toomy кэша, если включена кластеризация?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-187">How do I connect toomy cache when clustering is enabled?</span></span>
<span data-ttu-id="c6bb0-188">Tooyour кэша можно подключиться с помощью hello же [конечные точки](cache-configure.md#properties), [порты](cache-configure.md#properties), и [ключей](cache-configure.md#access-keys) , используемый при соединении tooa кэша, у которого нет кластеризации включена.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-188">You can connect tooyour cache using hello same [endpoints](cache-configure.md#properties), [ports](cache-configure.md#properties), and [keys](cache-configure.md#access-keys) that you use when connecting tooa cache that does not have clustering enabled.</span></span> <span data-ttu-id="c6bb0-189">Redis управляет hello кластеризации hello серверную часть, поэтому не нужно toomanage его из клиента.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-189">Redis manages hello clustering on hello backend so you don't have toomanage it from your client.</span></span>

### <a name="can-i-directly-connect-toohello-individual-shards-of-my-cache"></a><span data-ttu-id="c6bb0-190">Можно напрямую подключить отдельные сегменты toohello Мой кэша?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-190">Can I directly connect toohello individual shards of my cache?</span></span>
<span data-ttu-id="c6bb0-191">Официально это не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-191">This is not officially supported.</span></span> <span data-ttu-id="c6bb0-192">Тем не менее каждый сегмент включает пару, которая включает основной кэш и его реплику и называется экземпляром кэша.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-192">With that said, each shard consists of a primary/replica cache pair, collectively known as a cache instance.</span></span> <span data-ttu-id="c6bb0-193">Можно подключиться с помощью служебной программы redis cli hello в hello экземпляров кэша toothese [работает нестабильно](http://redis.io/download) ветви hello Redis репозитория в GitHub.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-193">You can connect toothese cache instances using hello redis-cli utility in hello [unstable](http://redis.io/download) branch of hello Redis repository at GitHub.</span></span> <span data-ttu-id="c6bb0-194">Эта версия реализует базовую поддержку при работе с hello `-c` переключения.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-194">This version implements basic support when started with hello `-c` switch.</span></span> <span data-ttu-id="c6bb0-195">Дополнительные сведения см. [воспроизведение с кластером hello](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) на [http://redis.io](http://redis.io) в hello [Redis кластера учебника](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-195">For more information see [Playing with hello cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) on [http://redis.io](http://redis.io) in hello [Redis cluster tutorial](http://redis.io/topics/cluster-tutorial).</span></span>

<span data-ttu-id="c6bb0-196">Для не ssl используйте следующие команды hello.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-196">For non-ssl, use hello following commands.</span></span>

    Redis-cli.exe –h <<cachename>> -p 13000 (tooconnect tooinstance 0)
    Redis-cli.exe –h <<cachename>> -p 13001 (tooconnect tooinstance 1)
    Redis-cli.exe –h <<cachename>> -p 13002 (tooconnect tooinstance 2)
    ...
    Redis-cli.exe –h <<cachename>> -p 1300N (tooconnect tooinstance N)

<span data-ttu-id="c6bb0-197">Для SSL замените `1300N` на `1500N`.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-197">For ssl, replace `1300N` with `1500N`.</span></span>

### <a name="can-i-configure-clustering-for-a-previously-created-cache"></a><span data-ttu-id="c6bb0-198">Можно ли настроить кластеризацию для ранее созданного кэша?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-198">Can I configure clustering for a previously created cache?</span></span>
<span data-ttu-id="c6bb0-199">В настоящее время включить кластеризацию можно только при создании кэша.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-199">Currently you can only enable clustering when you create a cache.</span></span> <span data-ttu-id="c6bb0-200">Размер кластера hello можно изменить после создания кэша hello, но нельзя добавлять кластеризации кэша premium tooa или удалить кластер из кэша premium после создания кэша hello.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-200">You can change hello cluster size after hello cache is created, but you can't add clustering tooa premium cache or remove clustering from a premium cache after hello cache is created.</span></span> <span data-ttu-id="c6bb0-201">Кэша premium с включенной кластеризацией и только одного сегмента отличается от кэша premium hello такого же размера, с без кластеризации.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-201">A premium cache with clustering enabled and only one shard is different than a premium cache of hello same size with no clustering.</span></span>

### <a name="can-i-configure-clustering-for-a-basic-or-standard-cache"></a><span data-ttu-id="c6bb0-202">Можно ли настроить кластеризацию для кэша уровней Базовый и Стандартный?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-202">Can I configure clustering for a basic or standard cache?</span></span>
<span data-ttu-id="c6bb0-203">Кластеризация доступна только для кэша уровня Премиум.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-203">Clustering is only available for premium caches.</span></span>

### <a name="can-i-use-clustering-with-hello-redis-aspnet-session-state-and-output-caching-providers"></a><span data-ttu-id="c6bb0-204">Можно ли использовать кластеризации с поставщиками состояний сеансов ASP.NET Redis и кэширования вывода hello</span><span class="sxs-lookup"><span data-stu-id="c6bb0-204">Can I use clustering with hello Redis ASP.NET Session State and Output Caching providers?</span></span>
* <span data-ttu-id="c6bb0-205">**Поставщик кэша вывода Redis** — изменения не требуются.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-205">**Redis Output Cache provider** - no changes required.</span></span>
* <span data-ttu-id="c6bb0-206">**Поставщик состояния сеанса redis** -toouse кластеризации, необходимо использовать [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 или более поздней версии или исключение возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-206">**Redis Session State provider** - toouse clustering, you must use [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 or higher or an exception is thrown.</span></span> <span data-ttu-id="c6bb0-207">Это критическое изменение. Дополнительные сведения см. на странице [v2.0.0 Breaking Change Details](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details) (Подробные сведения о критических изменениях в версии 2.0.0).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-207">This is a breaking change; for more information see [v2.0.0 Breaking Change Details](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details).</span></span>

<a name="move-exceptions"></a>

### <a name="i-am-getting-move-exceptions-when-using-stackexchangeredis-and-clustering-what-should-i-do"></a><span data-ttu-id="c6bb0-208">При использовании StackExchange.Redis и кластеризации порождаются исключения MOVE. Что делать?</span><span class="sxs-lookup"><span data-stu-id="c6bb0-208">I am getting MOVE exceptions when using StackExchange.Redis and clustering, what should I do?</span></span>
<span data-ttu-id="c6bb0-209">Если вы применяете StackExchange.Redis и получаете исключения `MOVE` при кластеризации, убедитесь, что вы используете [StackExchange.Redis 1.1.603](https://www.nuget.org/packages/StackExchange.Redis/) или более позднюю версию.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-209">If you are using StackExchange.Redis and receive `MOVE` exceptions when using clustering, ensure that you are using [StackExchange.Redis 1.1.603](https://www.nuget.org/packages/StackExchange.Redis/) or later.</span></span> <span data-ttu-id="c6bb0-210">Инструкции по настройке вашей toouse приложений .NET StackExchange.Redis см. в разделе [Настройка клиентов кэша hello](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span><span class="sxs-lookup"><span data-stu-id="c6bb0-210">For instructions on configuring your .NET applications toouse StackExchange.Redis, see [Configure hello cache clients](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span></span>

## <a name="next-steps"></a><span data-ttu-id="c6bb0-211">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c6bb0-211">Next steps</span></span>
<span data-ttu-id="c6bb0-212">Узнайте, как toouse более "премиум" кэша функции.</span><span class="sxs-lookup"><span data-stu-id="c6bb0-212">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="c6bb0-213">Уровень Premium кэша Redis Azure toohello введение</span><span class="sxs-lookup"><span data-stu-id="c6bb0-213">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-clustering]: ./media/cache-how-to-premium-clustering/redis-cache-clustering.png

[redis-cache-clustering-selected]: ./media/cache-how-to-premium-clustering/redis-cache-clustering-selected.png

[redis-cache-redis-cluster-size]: ./media/cache-how-to-premium-clustering/redis-cache-redis-cluster-size.png







