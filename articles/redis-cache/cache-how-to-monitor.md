---
title: "Как отслеживать кэш Redis для Azure | Документация Майкрософт"
description: "Узнайте, как отслеживать работоспособность и производительность экземпляров кэша Redis для Azure."
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 7e70b153-9c87-4290-85af-2228f31df118
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: sdanie
ms.openlocfilehash: 8996f5ce03e39557d9cc9c3de1ec214f5cd664b4
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="how-to-monitor-azure-redis-cache"></a><span data-ttu-id="66c06-103">Как отслеживать кэш Redis для Azure</span><span class="sxs-lookup"><span data-stu-id="66c06-103">How to monitor Azure Redis Cache</span></span>
<span data-ttu-id="66c06-104">В кэше Redis для Azure используется платформа [Azure Monitor](https://docs.microsoft.com/azure/monitoring-and-diagnostics/), которая предоставляет несколько функций для мониторинга экземпляров кэша.</span><span class="sxs-lookup"><span data-stu-id="66c06-104">Azure Redis Cache uses [Azure Monitor](https://docs.microsoft.com/azure/monitoring-and-diagnostics/) to provide several options for monitoring your cache instances.</span></span> <span data-ttu-id="66c06-105">Вы можете просматривать метрики, закреплять диаграммы метрик на начальной панели, настраивать диапазоны дат и времени для диаграмм мониторинга, добавлять и удалять метрики в диаграммах, а также настраивать отправку оповещений при выполнении определенных условий.</span><span class="sxs-lookup"><span data-stu-id="66c06-105">You can view metrics, pin metrics charts to the Startboard, customize the date and time range of monitoring charts, add and remove metrics from the charts, and set alerts when certain conditions are met.</span></span> <span data-ttu-id="66c06-106">Эти инструменты позволяют наблюдать за работоспособностью экземпляров кэша Redis для Azure и помогают управлять кэшируемыми приложениями.</span><span class="sxs-lookup"><span data-stu-id="66c06-106">These tools enable you to monitor the health of your Azure Redis Cache instances and help you manage your caching applications.</span></span>

<span data-ttu-id="66c06-107">Метрики для экземпляров кэша Redis для Azure собираются с помощью команды Redis [INFO](http://redis.io/commands/info) примерно два раза каждую минуту, автоматически сохраняются в течение 30 дней (если вы хотите настроить другую политику хранения, см. раздел [Экспорт метрик кэша](#export-cache-metrics)), отображаются в диаграммах метрик и оцениваются правилами генерации оповещений.</span><span class="sxs-lookup"><span data-stu-id="66c06-107">Metrics for Azure Redis Cache instances are collected using the Redis [INFO](http://redis.io/commands/info) command approximately twice per minute and automatically stored for 30 days (see [Export cache metrics](#export-cache-metrics) to configure a different retention policy) so they can be displayed in the metrics charts and evaluated by alert rules.</span></span> <span data-ttu-id="66c06-108">Дополнительные сведения о различных значениях INFO, используемых для каждой метрики кэша, см. в разделе [Доступные метрики и интервалы отчетности](#available-metrics-and-reporting-intervals).</span><span class="sxs-lookup"><span data-stu-id="66c06-108">For more information about the different INFO values used for each cache metric, see [Available metrics and reporting intervals](#available-metrics-and-reporting-intervals).</span></span>

<a name="view-cache-metrics"></a>

<span data-ttu-id="66c06-109">Чтобы просмотреть метрики кэша, [перейдите](cache-configure.md#configure-redis-cache-settings) к своему экземпляру кэша на [портале Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="66c06-109">To view cache metrics, [browse](cache-configure.md#configure-redis-cache-settings) to your cache instance in the [Azure portal](https://portal.azure.com).</span></span>  <span data-ttu-id="66c06-110">Кэш Redis для Azure содержит несколько встроенных диаграмм в колонках **Обзор** и **Метрики Redis**.</span><span class="sxs-lookup"><span data-stu-id="66c06-110">Azure Redis Cache provides some built-in charts on the **Overview** blade and the **Redis metrics** blade.</span></span> <span data-ttu-id="66c06-111">Каждую из этих диаграмм можно настроить путем добавления и удаления метрик либо изменения интервала отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-111">Each chart can be customized by adding or removing metrics and changing the reporting interval.</span></span>

![Метрики Redis](./media/cache-how-to-monitor/redis-cache-redis-metrics-blade.png)

## <a name="view-pre-configured-metrics-charts"></a><span data-ttu-id="66c06-113">Просмотр предварительно настроенных диаграмм метрик</span><span class="sxs-lookup"><span data-stu-id="66c06-113">View pre-configured metrics charts</span></span>

<span data-ttu-id="66c06-114">Колонка **Обзор** содержит следующие предварительно настроенные диаграммы мониторинга.</span><span class="sxs-lookup"><span data-stu-id="66c06-114">The **Overview** blade has the following pre-configured monitoring charts.</span></span>

* [<span data-ttu-id="66c06-115">Диаграммы мониторинга</span><span class="sxs-lookup"><span data-stu-id="66c06-115">Monitoring charts</span></span>](#monitoring-charts)
* [<span data-ttu-id="66c06-116">Диаграммы использования</span><span class="sxs-lookup"><span data-stu-id="66c06-116">Usage charts</span></span>](#usage-charts)

### <a name="monitoring-charts"></a><span data-ttu-id="66c06-117">Диаграммы мониторинга</span><span class="sxs-lookup"><span data-stu-id="66c06-117">Monitoring charts</span></span>
<span data-ttu-id="66c06-118">В разделе **Мониторинг** колонки **Обзор** есть диаграммы **Попадания и промахи**, **Извлечения и занесения**, **Подключения** и **Всего команд**.</span><span class="sxs-lookup"><span data-stu-id="66c06-118">The **Monitoring** section in the **Overview** blade has **Hits and Misses**, **Gets and Sets**, **Connections**, and **Total Commands** charts.</span></span>

![Диаграммы мониторинга](./media/cache-how-to-monitor/redis-cache-monitoring-part.png)

### <a name="usage-charts"></a><span data-ttu-id="66c06-120">Диаграммы использования</span><span class="sxs-lookup"><span data-stu-id="66c06-120">Usage charts</span></span>
<span data-ttu-id="66c06-121">В разделе **Использование** колонки **Обзор** представлены диаграммы **Нагрузка сервера Redis**, **Использование памяти**, **Пропускная способность сети** и **Использование ЦП**, а также указана **ценовая категория** для экземпляра кэша.</span><span class="sxs-lookup"><span data-stu-id="66c06-121">The **Usage** section in the **Overview** blade has **Redis Server Load**, **Memory Usage**, **Network Bandwith**, and **CPU Usage** charts, and also displays the **Pricing tier** for the cache instance.</span></span>

![Диаграммы использования](./media/cache-how-to-monitor/redis-cache-usage-part.png)

<span data-ttu-id="66c06-123">В разделе **Ценовая категория** отображается ценовая категория кэша, и здесь его можно [перевести](cache-how-to-scale.md) в другую категорию.</span><span class="sxs-lookup"><span data-stu-id="66c06-123">The **Pricing tier** displays the cache pricing tier, and can be used to [scale](cache-how-to-scale.md) the cache to a different pricing tier.</span></span>

## <a name="view-metrics-with-azure-monitor"></a><span data-ttu-id="66c06-124">Просмотр метрик с помощью Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="66c06-124">View metrics with Azure monitor</span></span>
<span data-ttu-id="66c06-125">Чтобы просмотреть метрики Redis и создать собственные диаграммы в Azure Monitor, щелкните **Метрики** в меню **Ресурсы**. Здесь вы сможете настроить тип диаграммы, отображаемые метрики, интервал составления отчетов и другие параметры.</span><span class="sxs-lookup"><span data-stu-id="66c06-125">To view Redis metrics and create custom charts using Azure Monitor, click **Metrics** from the **Resource menu**, and customize your chart using the desired metrics, reporting interval, chart type, and more.</span></span>

![Метрики Redis](./media/cache-how-to-monitor/redis-cache-monitor.png)

<span data-ttu-id="66c06-127">Дополнительные сведения о работе с метриками в Azure Monitor см. в статье [Обзор метрик в Microsoft Azure](../monitoring-and-diagnostics/monitoring-overview-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="66c06-127">For more information on working with metrics using Azure Monitor, see [Overview of metrics in Microsoft Azure](../monitoring-and-diagnostics/monitoring-overview-metrics.md).</span></span>

<a name="how-to-view-metrics-and-customize-chart"></a>
<a name="enable-cache-diagnostics"></a>
## <a name="export-cache-metrics"></a><span data-ttu-id="66c06-128">Экспорт метрик кэша</span><span class="sxs-lookup"><span data-stu-id="66c06-128">Export cache metrics</span></span>
<span data-ttu-id="66c06-129">По умолчанию в Azure Monitor метрики кэша [хранятся в течение 30 дней](../monitoring-and-diagnostics/monitoring-overview-azure-monitor.md#store-and-archive), а затем удаляются.</span><span class="sxs-lookup"><span data-stu-id="66c06-129">By default, cache metrics in Azure Monitor are [stored for 30 days](../monitoring-and-diagnostics/monitoring-overview-azure-monitor.md#store-and-archive) and then deleted.</span></span> <span data-ttu-id="66c06-130">Чтобы хранить метрики кэша дольше 30 дней, назначьте для метрик кэша [выделенную учетную запись хранения](../monitoring-and-diagnostics/monitoring-archive-diagnostic-logs.md) и укажите для них политику **Хранение (дни)**.</span><span class="sxs-lookup"><span data-stu-id="66c06-130">To persist your cache metrics for longer than 30 days, you can [designate a storage account](../monitoring-and-diagnostics/monitoring-archive-diagnostic-logs.md) and specify a **Retention (days)** policy for your cache metrics.</span></span> 

<span data-ttu-id="66c06-131">Чтобы настроить учетную запись хранения для метрик кэша, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="66c06-131">To configure a storage account for your cache metrics:</span></span>

1. <span data-ttu-id="66c06-132">В колонке **Кэш Redis** выберите меню **Ресурсы** и щелкните **Диагностика**.</span><span class="sxs-lookup"><span data-stu-id="66c06-132">Click **Diagnostics** from the **Resource menu** in the **Redis Cache** blade.</span></span>
2. <span data-ttu-id="66c06-133">Щелкните **Вкл.**</span><span class="sxs-lookup"><span data-stu-id="66c06-133">Click **On**.</span></span>
3. <span data-ttu-id="66c06-134">Установите флажок **Архивировать в учетной записи хранения**.</span><span class="sxs-lookup"><span data-stu-id="66c06-134">Check **Archive to a storage account**.</span></span>
4. <span data-ttu-id="66c06-135">Выберите учетную запись хранения, в которой будут храниться метрики кэша.</span><span class="sxs-lookup"><span data-stu-id="66c06-135">Select the storage account in which to store the cache metrics.</span></span>
5. <span data-ttu-id="66c06-136">Установите флажок **1 минута** и укажите политику **Хранение (дни)**.</span><span class="sxs-lookup"><span data-stu-id="66c06-136">Check the **1 minute** checkbox and specify a **Retention (days)** policy.</span></span> <span data-ttu-id="66c06-137">Если вы не хотите применять политику хранения, а предпочитаете хранить данные неограниченное время, укажите для параметра **Хранение (дни)** значение **0**;</span><span class="sxs-lookup"><span data-stu-id="66c06-137">If you do not want to apply any retention policy and retain data forever, set **Retention (days)** to **0**.</span></span>
6. <span data-ttu-id="66c06-138">Щелкните **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="66c06-138">Click **Save**.</span></span>

![Диагностика Redis](./media/cache-how-to-monitor/redis-cache-diagnostics.png)

>[!NOTE]
><span data-ttu-id="66c06-140">В дополнение к архивированию метрик кэша в хранилище вы можете настроить для них [потоковую передачу в концентратор событий или отправку в журнал Log Analytics](../monitoring-and-diagnostics/monitoring-overview-metrics.md#export-metrics).</span><span class="sxs-lookup"><span data-stu-id="66c06-140">In addition to archiving your cache metrics to storage, you can also [stream them to an Event hub or send them to Log Analytics](../monitoring-and-diagnostics/monitoring-overview-metrics.md#export-metrics).</span></span>
>
>

<span data-ttu-id="66c06-141">Чтобы просмотреть метрики, их можно открыть на портале Azure, как описано выше в этой статье, или же обратиться к ним с помощью [REST API для метрик Azure Monitor](../monitoring-and-diagnostics/monitoring-overview-metrics.md#access-metrics-via-the-rest-api).</span><span class="sxs-lookup"><span data-stu-id="66c06-141">To access your metrics, you can view them in the Azure portal as previously described in this article, and you can also access them using the [Azure Monitor Metrics REST API](../monitoring-and-diagnostics/monitoring-overview-metrics.md#access-metrics-via-the-rest-api).</span></span>

> [!NOTE]
> <span data-ttu-id="66c06-142">В случае ее смены данные из прежней учетной записи хранения можно будет скачать, однако они не будут отображаться на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="66c06-142">If you change storage accounts, the data in the previously configured storage account remains available for download, but it is not displayed in the Azure portal.</span></span>  
> 
> 

## <a name="available-metrics-and-reporting-intervals"></a><span data-ttu-id="66c06-143">Доступные метрики и интервалы отчетности</span><span class="sxs-lookup"><span data-stu-id="66c06-143">Available metrics and reporting intervals</span></span>
<span data-ttu-id="66c06-144">Показатели кэша регистрируются с определенной периодичностью: **за последний час**, **за сегодня**, **за последнюю неделю** и с **настраиваемым** интервалом.</span><span class="sxs-lookup"><span data-stu-id="66c06-144">Cache metrics are reported using several reporting intervals, including **Past hour**, **Today**, **Past week**, and **Custom**.</span></span> <span data-ttu-id="66c06-145">В колонке **Метрика** для каждой диаграммы метрик отображаются среднее, минимальное и максимальное значения каждой метрики на данной диаграмме, а для некоторых также можно увидеть суммарное значение за весь интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-145">The **Metric** blade for each metrics chart displays the average, minimum, and maximum values for each metric in the chart, and some metrics display a total for the reporting interval.</span></span> 

<span data-ttu-id="66c06-146">Каждый показатель имеет две версии.</span><span class="sxs-lookup"><span data-stu-id="66c06-146">Each metric includes two versions.</span></span> <span data-ttu-id="66c06-147">Один показатель измеряет производительность для всего кэша, а также для кэшей, использующих [кластеризацию](cache-how-to-premium-clustering.md), а вторая версия метрики, имя которой содержит `(Shard 0-9)`, измеряет производительность отдельного сегмента в кэше.</span><span class="sxs-lookup"><span data-stu-id="66c06-147">One metric measures performance for the entire cache, and for caches that use [clustering](cache-how-to-premium-clustering.md), a second version of the metric that includes `(Shard 0-9)` in the name measures performance for a single shard in a cache.</span></span> <span data-ttu-id="66c06-148">Например если кэш содержит 4 сегмента, `Cache Hits` отражает общее количество попаданий для всего кэша, а `Cache Hits (Shard 3)` — количество попаданий для отдельного сегмента кэша.</span><span class="sxs-lookup"><span data-stu-id="66c06-148">For example if a cache has 4 shards, `Cache Hits` is the total amount of hits for the entire cache, and `Cache Hits (Shard 3)` is just the hits for that shard of the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="66c06-149">Даже когда кэш неактивен и к нему не подключены активные клиентские приложения, вы можете наблюдать определенную активность (подключенных клиентов, использование памяти и выполнение операций).</span><span class="sxs-lookup"><span data-stu-id="66c06-149">Even when the cache is idle with no connected active client applications, you may see some cache activity, such as connected clients, memory usage, and operations being performed.</span></span> <span data-ttu-id="66c06-150">Это нормальное явление в штатном режиме работы экземпляра кэша Redis для Azure.</span><span class="sxs-lookup"><span data-stu-id="66c06-150">This activity is normal during the operation of an Azure Redis Cache instance.</span></span>
> 
> 

| <span data-ttu-id="66c06-151">Метрика</span><span class="sxs-lookup"><span data-stu-id="66c06-151">Metric</span></span> | <span data-ttu-id="66c06-152">Описание</span><span class="sxs-lookup"><span data-stu-id="66c06-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="66c06-153">Попаданий в кэш</span><span class="sxs-lookup"><span data-stu-id="66c06-153">Cache Hits</span></span> |<span data-ttu-id="66c06-154">Количество успешных операций поиска по ключу за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-154">The number of successful key lookups during the specified reporting interval.</span></span> <span data-ttu-id="66c06-155">Это значение соответствует значению `keyspace_hits` команды [INFO](http://redis.io/commands/info) Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-155">This maps to `keyspace_hits` from the Redis [INFO](http://redis.io/commands/info) command.</span></span> |
| <span data-ttu-id="66c06-156">Промахов в кэше</span><span class="sxs-lookup"><span data-stu-id="66c06-156">Cache Misses</span></span> |<span data-ttu-id="66c06-157">Количество неудачных операций поиска по ключу за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-157">The number of failed key lookups during the specified reporting interval.</span></span> <span data-ttu-id="66c06-158">Это значение соответствует значению `keyspace_misses` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-158">This maps to `keyspace_misses` from the Redis INFO command.</span></span> <span data-ttu-id="66c06-159">Промахи в кэше не означают, что с кэшем возникли какие-то неполадки.</span><span class="sxs-lookup"><span data-stu-id="66c06-159">Cache misses do not necessarily mean there is an issue with the cache.</span></span> <span data-ttu-id="66c06-160">Например, при использовании шаблона программирования "Отдельно от кэша" приложение сначала ищет элемент в кэше.</span><span class="sxs-lookup"><span data-stu-id="66c06-160">For example, when using the cache-aside programming pattern, an application looks first in the cache for an item.</span></span> <span data-ttu-id="66c06-161">Если он там отсутствует (то есть фиксируется промах), элемент извлекается из базы данных и добавляется в кэш.</span><span class="sxs-lookup"><span data-stu-id="66c06-161">If the item is not there (cache miss), the item is retrieved from the database and added to the cache for next time.</span></span> <span data-ttu-id="66c06-162">Промахи в кэше – нормальное явление для программирования на базе шаблона "Отдельно от кэше".</span><span class="sxs-lookup"><span data-stu-id="66c06-162">Cache misses are normal behavior for the cache-aside programming pattern.</span></span> <span data-ttu-id="66c06-163">Если количество промахов в кэше больше, чем предполагается, проанализируйте алгоритм приложения, который заполняет кэш и считывает оттуда значения.</span><span class="sxs-lookup"><span data-stu-id="66c06-163">If the number of cache misses is higher than expected, examine the application logic that populates and reads from the cache.</span></span> <span data-ttu-id="66c06-164">Промахи также могут возникать в случае удаления из кэша элементов из-за нехватки памяти, однако для контроля состояния памяти лучше использовать метрики `Used Memory` и `Evicted Keys`.</span><span class="sxs-lookup"><span data-stu-id="66c06-164">If items are being evicted from the cache due to memory pressure then there may be some cache misses, but a better metric to monitor for memory pressure would be `Used Memory` or `Evicted Keys`.</span></span> |
| <span data-ttu-id="66c06-165">Подключенные клиенты</span><span class="sxs-lookup"><span data-stu-id="66c06-165">Connected Clients</span></span> |<span data-ttu-id="66c06-166">Количество подключенных к кэшу клиентов за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-166">The number of client connections to the cache during the specified reporting interval.</span></span> <span data-ttu-id="66c06-167">Это значение соответствует значению `connected_clients` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-167">This maps to `connected_clients` from the Redis INFO command.</span></span> <span data-ttu-id="66c06-168">При достижении [предельного числа подключений](cache-configure.md#default-redis-server-configuration) последующие попытки подключения к кэшу завершаются ошибкой.</span><span class="sxs-lookup"><span data-stu-id="66c06-168">Once the [connection limit](cache-configure.md#default-redis-server-configuration) is reached subsequent connection attempts to the cache will fail.</span></span> <span data-ttu-id="66c06-169">Обратите внимание на то, что даже при отсутствии активных клиентских приложений к кэшу может быть подключено несколько клиентов, которые соответствуют внутренним процессам и подключениям.</span><span class="sxs-lookup"><span data-stu-id="66c06-169">Note that even if there are no active client application, there may still be a few instances of connected clients due to internal processes and connections.</span></span> |
| <span data-ttu-id="66c06-170">Исключенные ключи</span><span class="sxs-lookup"><span data-stu-id="66c06-170">Evicted Keys</span></span> |<span data-ttu-id="66c06-171">Количество ключей, исключенных из кэша за указанный интервал отчетности из-за ограничения `maxmemory` .</span><span class="sxs-lookup"><span data-stu-id="66c06-171">The number of items evicted from the cache during the specified reporting interval due to the `maxmemory` limit.</span></span> <span data-ttu-id="66c06-172">Это значение соответствует значению `evicted_keys` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-172">This maps to `evicted_keys` from the Redis INFO command.</span></span> |
| <span data-ttu-id="66c06-173">Ключи с истекшим сроком действия</span><span class="sxs-lookup"><span data-stu-id="66c06-173">Expired Keys</span></span> |<span data-ttu-id="66c06-174">Количество ключей, для которых истек срок действия за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-174">The number of items expired from the cache during the specified reporting interval.</span></span> <span data-ttu-id="66c06-175">Это значение соответствует значению `expired_keys` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-175">This value maps to `expired_keys` from the Redis INFO command.</span></span> |
| <span data-ttu-id="66c06-176">Всего ключей</span><span class="sxs-lookup"><span data-stu-id="66c06-176">Total Keys</span></span>  | <span data-ttu-id="66c06-177">Максимальное количество ключей в кэше за последний отчетный период.</span><span class="sxs-lookup"><span data-stu-id="66c06-177">The maximum number of keys in the cache during the past reporting time period.</span></span> <span data-ttu-id="66c06-178">Это значение соответствует значению `keyspace` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-178">This maps to `keyspace` from the Redis INFO command.</span></span> <span data-ttu-id="66c06-179">Из-за ограничений базовой системы метрик для кэшей с включенной кластеризацией параметр "Всего ключей" возвращает максимальное количество ключей одного сегмента, в котором за отчетный период зарегистрировано максимальное количество ключей.</span><span class="sxs-lookup"><span data-stu-id="66c06-179">Due to a limitation of the underlying metrics system, for caches with clustering enabled, Total Keys returns the maximum number of keys of the shard that had the maximum number of keys during the reporting interval.</span></span>  |
| <span data-ttu-id="66c06-180">Операций считывания</span><span class="sxs-lookup"><span data-stu-id="66c06-180">Gets</span></span> |<span data-ttu-id="66c06-181">Количество операций считывания из кэша за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-181">The number of get operations from the cache during the specified reporting interval.</span></span> <span data-ttu-id="66c06-182">Эта метрика представляет собой сумму следующих значений INFO-команды Redis: `cmdstat_get`, `cmdstat_hget`, `cmdstat_hgetall`, `cmdstat_hmget`, `cmdstat_mget`, `cmdstat_getbit` и `cmdstat_getrange` Она эквивалентна сумме попаданий и промахов за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-182">This value is the sum of the following values from the Redis INFO all command: `cmdstat_get`, `cmdstat_hget`, `cmdstat_hgetall`, `cmdstat_hmget`, `cmdstat_mget`, `cmdstat_getbit`, and `cmdstat_getrange`, and is equivalent to the sum of cache hits and misses during the reporting interval.</span></span> |
| <span data-ttu-id="66c06-183">Загрузка сервера Redis</span><span class="sxs-lookup"><span data-stu-id="66c06-183">Redis Server Load</span></span> |<span data-ttu-id="66c06-184">Процентная доля циклов, в течение которых сервер Redis занят обработкой и не находится в неактивном состоянии, ожидая поступления сообщений.</span><span class="sxs-lookup"><span data-stu-id="66c06-184">The percentage of cycles in which the Redis server is busy processing and not waiting idle for messages.</span></span> <span data-ttu-id="66c06-185">Если эта метрика достигает значения 100, это говорит о том, что сервер Redis достиг максимальной производительности и ЦП не может работать быстрее.</span><span class="sxs-lookup"><span data-stu-id="66c06-185">If this counter reaches 100 it means the Redis server has hit a performance ceiling and the CPU can't process work any faster.</span></span> <span data-ttu-id="66c06-186">При высоком показателе загрузки сервера Redis в клиенте возникают исключения из-за истечения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="66c06-186">If you are seeing high Redis Server Load then you will see timeout exceptions in the client.</span></span> <span data-ttu-id="66c06-187">В этом случае имеет смысл увеличить масштаб или сегментировать данные на несколько экземпляров кэша.</span><span class="sxs-lookup"><span data-stu-id="66c06-187">In this case you should consider scaling up or partitioning your data into multiple caches.</span></span> |
| <span data-ttu-id="66c06-188">Операций записи</span><span class="sxs-lookup"><span data-stu-id="66c06-188">Sets</span></span> |<span data-ttu-id="66c06-189">Количество операций записи в кэш за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-189">The number of set operations to the cache during the specified reporting interval.</span></span> <span data-ttu-id="66c06-190">Эта метрика представляет собой сумму следующих значений INFO-команды all Redis: `cmdstat_set`, `cmdstat_hset`, `cmdstat_hmset`, `cmdstat_hsetnx`, `cmdstat_lset`, `cmdstat_mset`, `cmdstat_msetnx`, `cmdstat_setbit`, `cmdstat_setex`, `cmdstat_setrange` и `cmdstat_setnx`.</span><span class="sxs-lookup"><span data-stu-id="66c06-190">This value is the sum of the following values from the Redis INFO all command: `cmdstat_set`, `cmdstat_hset`, `cmdstat_hmset`, `cmdstat_hsetnx`, `cmdstat_lset`, `cmdstat_mset`, `cmdstat_msetnx`, `cmdstat_setbit`, `cmdstat_setex`, `cmdstat_setrange`, and `cmdstat_setnx`.</span></span> |
| <span data-ttu-id="66c06-191">Всего операций</span><span class="sxs-lookup"><span data-stu-id="66c06-191">Total Operations</span></span> |<span data-ttu-id="66c06-192">Общее количество команд, обработанных сервером кэша за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-192">The total number of commands processed by the cache server during the specified reporting interval.</span></span> <span data-ttu-id="66c06-193">Это значение соответствует значению `total_commands_processed` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-193">This value maps to `total_commands_processed` from the Redis INFO command.</span></span> <span data-ttu-id="66c06-194">Обратите внимание на то, что при использовании кэша Redis для Azure исключительно в режиме pub/sub метрики `Cache Hits`, `Cache Misses`, `Gets` и `Sets` не отслеживаются. Вместо них фиксируется метрика `Total Operations`, которая отражает использование кэша операциями pub/sub.</span><span class="sxs-lookup"><span data-stu-id="66c06-194">Note that when Azure Redis Cache is used purely for pub/sub there will be no metrics for `Cache Hits`, `Cache Misses`, `Gets`, or `Sets`, but there will be `Total Operations` metrics that reflect the cache usage for pub/sub operations.</span></span> |
| <span data-ttu-id="66c06-195">Используемая память</span><span class="sxs-lookup"><span data-stu-id="66c06-195">Used Memory</span></span> |<span data-ttu-id="66c06-196">Объем памяти кэша, используемой для хранения пар «ключ — значение» (в МБ), за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-196">The amount of cache memory used for key/value pairs in the cache in MB during the specified reporting interval.</span></span> <span data-ttu-id="66c06-197">Это значение соответствует значению `used_memory` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-197">This value maps to `used_memory` from the Redis INFO command.</span></span> <span data-ttu-id="66c06-198">Не содержит метаданных или фрагментации.</span><span class="sxs-lookup"><span data-stu-id="66c06-198">This does not include metadata or fragmentation.</span></span> |
| <span data-ttu-id="66c06-199">RSS используемой памяти</span><span class="sxs-lookup"><span data-stu-id="66c06-199">Used Memory RSS</span></span> |<span data-ttu-id="66c06-200">Объем используемой памяти кэша (в МБ) за указанный интервал отчетности с учетом фрагментации и метаданных.</span><span class="sxs-lookup"><span data-stu-id="66c06-200">The amount of cache memory used in MB during the specified reporting interval, including fragmentation and metadata.</span></span> <span data-ttu-id="66c06-201">Это значение соответствует значению `used_memory_rss` команды INFO Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-201">This value maps to `used_memory_rss` from the Redis INFO command.</span></span> |
| <span data-ttu-id="66c06-202">ЦП</span><span class="sxs-lookup"><span data-stu-id="66c06-202">CPU</span></span> |<span data-ttu-id="66c06-203">Использование ресурсов ЦП сервером кэша Redis для Azure (в виде процентной доли) за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-203">The CPU utilization of the Azure Redis Cache server as a percentage during the specified reporting interval.</span></span> <span data-ttu-id="66c06-204">Это значение соответствует счетчику производительности `\Processor(_Total)\% Processor Time` в операционной системе.</span><span class="sxs-lookup"><span data-stu-id="66c06-204">This value maps to the operating system `\Processor(_Total)\% Processor Time` performance counter.</span></span> |
| <span data-ttu-id="66c06-205">Чтение из кэша</span><span class="sxs-lookup"><span data-stu-id="66c06-205">Cache Read</span></span> |<span data-ttu-id="66c06-206">Объем данных (в МБ/с), считанных из кэша за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-206">The amount of data read from the cache in Megabytes per second (MB/s) during the specified reporting interval.</span></span> <span data-ttu-id="66c06-207">Это значение рассчитывается на основе трафика сетевых адаптеров, поддерживающих виртуальную машину, на которой размещен кэш, и не связано непосредственно с системой Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-207">This value is derived from the network interface cards that support the virtual machine that hosts the cache and is not Redis specific.</span></span> <span data-ttu-id="66c06-208">**Это значение соответствует пропускной способности сети для этого кэша. Если вы хотите настроить оповещения об ограничениях пропускной способности сети на стороне сервера, создайте их с помощью этого счетчика `Cache Read`. В [этой таблице](cache-faq.md#cache-performance) приводятся наблюдаемые ограничения пропускной способности для различных ценовых категорий и размеров кэша.**</span><span class="sxs-lookup"><span data-stu-id="66c06-208">**This value corresponds to the network bandwidth used by this cache. If you want to set up alerts for server side network bandwidth limits, then create it using this `Cache Read` counter. See [this table](cache-faq.md#cache-performance) for the observed bandwidth limits for various cache pricing tiers and sizes.**</span></span> |
| <span data-ttu-id="66c06-209">Запись в кэш</span><span class="sxs-lookup"><span data-stu-id="66c06-209">Cache Write</span></span> |<span data-ttu-id="66c06-210">Объем данных (в МБ/с), записываемых в кэш за указанный интервал отчетности.</span><span class="sxs-lookup"><span data-stu-id="66c06-210">The amount of data written to the cache in Megabytes per second (MB/s) during the specified reporting interval.</span></span> <span data-ttu-id="66c06-211">Это значение рассчитывается на основе трафика сетевых адаптеров, поддерживающих виртуальную машину, на которой размещен кэш, и не связано непосредственно с системой Redis.</span><span class="sxs-lookup"><span data-stu-id="66c06-211">This value is derived from the network interface cards that support the virtual machine that hosts the cache and is not Redis specific.</span></span> <span data-ttu-id="66c06-212">Это значение соответствует пропускной способности сети в отношении данных, отправляемых из кэша клиенту.</span><span class="sxs-lookup"><span data-stu-id="66c06-212">This value corresponds to the network bandwidth of data sent to the cache from the client.</span></span> |

<a name="operations-and-alerts"></a>
## <a name="alerts"></a><span data-ttu-id="66c06-213">Оповещения</span><span class="sxs-lookup"><span data-stu-id="66c06-213">Alerts</span></span>
<span data-ttu-id="66c06-214">Вы можете настроить получение уведомлений на основе метрик и журналов действий.</span><span class="sxs-lookup"><span data-stu-id="66c06-214">You can configure to receive alerts based on metrics and activity logs.</span></span> <span data-ttu-id="66c06-215">Azure Monitor позволяет настроить действие, выполняемое при активации оповещения:</span><span class="sxs-lookup"><span data-stu-id="66c06-215">Azure Monitor allows you to configure an alert to do the following when it triggers:</span></span>

* <span data-ttu-id="66c06-216">Отправка уведомления по электронной почте.</span><span class="sxs-lookup"><span data-stu-id="66c06-216">Send an email notification</span></span>
* <span data-ttu-id="66c06-217">Вызов webhook.</span><span class="sxs-lookup"><span data-stu-id="66c06-217">Call a webhook</span></span>
* <span data-ttu-id="66c06-218">Вызов приложения логики Azure.</span><span class="sxs-lookup"><span data-stu-id="66c06-218">Invoke an Azure Logic App</span></span>

<span data-ttu-id="66c06-219">Чтобы настроить правила генерации оповещений для кэша, щелкните **Правила оповещения** в меню **Ресурсы**.</span><span class="sxs-lookup"><span data-stu-id="66c06-219">To configure Alert rules for your cache, click **Alert rules** from the **Resource menu**.</span></span>

![Мониторинг](./media/cache-how-to-monitor/redis-cache-monitoring.png)

<span data-ttu-id="66c06-221">Дополнительные сведения о настройке и использовании оповещений см. в статье [Создание оповещений метрик в Azure Monitor для служб Azure с помощью портала Azure](../monitoring-and-diagnostics/insights-alerts-portal.md).</span><span class="sxs-lookup"><span data-stu-id="66c06-221">For more information about configuring and using Alerts, see [Overview of Alerts](../monitoring-and-diagnostics/insights-alerts-portal.md).</span></span>

## <a name="activity-logs"></a><span data-ttu-id="66c06-222">Журналы действий</span><span class="sxs-lookup"><span data-stu-id="66c06-222">Activity Logs</span></span>
<span data-ttu-id="66c06-223">Журналы действий позволяют подробно проанализировать операции, выполненные с экземплярами кэша Redis для Azure.</span><span class="sxs-lookup"><span data-stu-id="66c06-223">Activity logs provide insight into the operations that were performed on your Azure Redis Cache instances.</span></span> <span data-ttu-id="66c06-224">Ранее они назывались журналами аудита или журналами операций.</span><span class="sxs-lookup"><span data-stu-id="66c06-224">It was previously known as "audit logs" or "operational logs".</span></span> <span data-ttu-id="66c06-225">С помощью журналов действий можно получить ответы на вопросы "что? кто? когда?" в отношении любой операции записи (PUT, POST, DELETE), выполненной в экземплярах кэша Redis для Azure.</span><span class="sxs-lookup"><span data-stu-id="66c06-225">Using activity logs, you can determine the "what, who, and when" for any write operations (PUT, POST, DELETE) taken on your Azure Redis Cache instances.</span></span> 

> [!NOTE]
> <span data-ttu-id="66c06-226">Журнал действий не содержит сведений об операциях чтения (GET).</span><span class="sxs-lookup"><span data-stu-id="66c06-226">Activity logs do not include read (GET) operations.</span></span>
>
>

<span data-ttu-id="66c06-227">Чтобы просмотреть журналы действий для кэша, щелкните **Журналы действий** в меню **Ресурсы**.</span><span class="sxs-lookup"><span data-stu-id="66c06-227">To view activity logs for your cache, click **Activity logs** from the **Resource menu**.</span></span>

<span data-ttu-id="66c06-228">Дополнительные сведения о журналах действий см. в статье [Общие сведения о журнале действий Azure](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md).</span><span class="sxs-lookup"><span data-stu-id="66c06-228">For more information about Activity logs, see [Overview of the Azure Activity Log](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md).</span></span>











