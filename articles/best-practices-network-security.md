---
title: "рекомендации по обеспечению безопасности сети aaaAzure | Документы Microsoft"
description: "Узнать некоторые основные функции hello в Azure toohelp Создание безопасных сетевых сред"
services: virtual-network
documentationcenter: na
author: tracsman
manager: rossort
editor: 
ms.assetid: d169387a-1243-4867-a602-01d6f2d8a2a1
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/03/2017
ms.author: jonor
ms.openlocfilehash: b851b2862428a8bd5e7525c85584fc1c14ffcabe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="microsoft-cloud-services-and-network-security"></a><span data-ttu-id="19212-103">Облачные службы Microsoft Cloud и сетевая безопасность</span><span class="sxs-lookup"><span data-stu-id="19212-103">Microsoft cloud services and network security</span></span>
<span data-ttu-id="19212-104">Облачные службы (Майкрософт) позволяют пользоваться масштабируемыми службами и инфраструктурой, возможностями корпоративного класса и множеством вариантов гибридных подключений.</span><span class="sxs-lookup"><span data-stu-id="19212-104">Microsoft cloud services deliver hyper-scale services and infrastructure, enterprise-grade capabilities, and many choices for hybrid connectivity.</span></span> <span data-ttu-id="19212-105">Клиенты могут выбрать tooaccess этих служб через Интернет hello или Azure ExpressRoute, который позволяет устанавливать подключение частной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-105">Customers can choose tooaccess these services either via hello Internet or with Azure ExpressRoute, which provides private network connectivity.</span></span> <span data-ttu-id="19212-106">Hello платформы Microsoft Azure позволяет клиентам tooseamlessly расширения своей инфраструктуры в облако hello и построения многоуровневых архитектурах.</span><span class="sxs-lookup"><span data-stu-id="19212-106">hello Microsoft Azure platform allows customers tooseamlessly extend their infrastructure into hello cloud and build multi-tier architectures.</span></span> <span data-ttu-id="19212-107">Кроме того, сторонние производители могут получить дополнительные возможности путем предоставления служб безопасности и виртуальных устройств.</span><span class="sxs-lookup"><span data-stu-id="19212-107">Additionally, third parties can enable enhanced capabilities by offering security services and virtual appliances.</span></span> <span data-ttu-id="19212-108">В этом техническом документе мы предлагаем обзор вопросов, касающихся безопасности и архитектуры, которые необходимо учитывать при использовании облачных служб Microsoft Cloud с помощью ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="19212-108">This white paper provides an overview of security and architectural issues that customers should consider when using Microsoft cloud services accessed via ExpressRoute.</span></span> <span data-ttu-id="19212-109">В нем также рассматриваются более безопасные службы в виртуальных сетях Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-109">It also covers creating more secure services in Azure virtual networks.</span></span>

## <a name="fast-start"></a><span data-ttu-id="19212-110">Выбор решения</span><span class="sxs-lookup"><span data-stu-id="19212-110">Fast start</span></span>
<span data-ttu-id="19212-111">Следующая диаграмма логику Hello можно направить вы tooa конкретный пример hello многие методы обеспечения безопасности с hello платформы Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-111">hello following logic chart can direct you tooa specific example of hello many security techniques available with hello Azure platform.</span></span> <span data-ttu-id="19212-112">Для быстрого ознакомления найти пример hello, которые наилучшим образом соответствуют вашему обращению.</span><span class="sxs-lookup"><span data-stu-id="19212-112">For quick reference, find hello example that best fits your case.</span></span> <span data-ttu-id="19212-113">Развернутое описание, чтобы продолжайте чтение через hello бумаги.</span><span class="sxs-lookup"><span data-stu-id="19212-113">For expanded explanations, continue reading through hello paper.</span></span>
<span data-ttu-id="19212-114">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="19212-114">[![0]][0]</span></span>

[<span data-ttu-id="19212-115">Пример 1: Построение сети периметра (также известный как DMZ, демилитаризованная зона или экранированная подсеть) toohelp защитить приложения с группами безопасности сети (Nsg).</span><span class="sxs-lookup"><span data-stu-id="19212-115">Example 1: Build a perimeter network (also known as DMZ, demilitarized zone, or screened subnet) toohelp protect applications with network security groups (NSGs).</span></span>](#example-1-build-a-perimeter-network-to-help-protect-applications-with-nsgs)</br><span data-ttu-id="19212-116">
[Пример 2: Построение периметра сети toohelp защитить приложения с брандмауэром и Nsg.](#example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs)</span><span class="sxs-lookup"><span data-stu-id="19212-116">
[Example 2: Build a perimeter network toohelp protect applications with a firewall and NSGs.](#example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs)</span></span></br><span data-ttu-id="19212-117">
[Пример 3: Построение периметра сети toohelp защитить сеть с помощью брандмауэра, определяемых пользователем маршрутов (UDR) и NSG.](#example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg)</span><span class="sxs-lookup"><span data-stu-id="19212-117">
[Example 3: Build a perimeter network toohelp protect networks with a firewall, user-defined route (UDR), and NSG.](#example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg)</span></span></br><span data-ttu-id="19212-118">
[Пример 4. Добавление гибридного подключения типа "сеть — сеть" с виртуальным устройством и виртуальной частной сетью (VPN).](#example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn)</span><span class="sxs-lookup"><span data-stu-id="19212-118">
[Example 4: Add a hybrid connection with a site-to-site, virtual appliance virtual private network (VPN).](#example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn)</span></span></br><span data-ttu-id="19212-119">
[Пример 5. Добавление гибридного подключения типа "сеть — сеть" с VPN-шлюзом Azure.](#example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway)</span><span class="sxs-lookup"><span data-stu-id="19212-119">
[Example 5: Add a hybrid connection with a site-to-site, Azure VPN gateway.](#example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway)</span></span></br><span data-ttu-id="19212-120">
[Пример 6. Добавление гибридного подключения с использованием ExpressRoute.](#example-6-add-a-hybrid-connection-with-expressroute)</span><span class="sxs-lookup"><span data-stu-id="19212-120">
[Example 6: Add a hybrid connection with ExpressRoute.](#example-6-add-a-hybrid-connection-with-expressroute)</span></span></br>
<span data-ttu-id="19212-121">Примеры для добавления соединений между виртуальными сетями, высокий уровень доступности и цепочки службы будут добавлены toothis документа через hello следующих нескольких месяцев.</span><span class="sxs-lookup"><span data-stu-id="19212-121">Examples for adding connections between virtual networks, high availability, and service chaining will be added toothis document over hello next few months.</span></span>

## <a name="microsoft-compliance-and-infrastructure-protection"></a><span data-ttu-id="19212-122">Соответствие нормативным требованиям и защита инфраструктуры Майкрософт</span><span class="sxs-lookup"><span data-stu-id="19212-122">Microsoft compliance and infrastructure protection</span></span>
<span data-ttu-id="19212-123">организациям toohelp соответствует национальным, региональным и отраслевые требования регулирующих hello сбора и использования данных отдельных пользователей, корпорация Майкрософт предлагает более 40 сертификация и attestations.</span><span class="sxs-lookup"><span data-stu-id="19212-123">toohelp organizations comply with national, regional, and industry-specific requirements governing hello collection and use of individuals’ data, Microsoft offers over 40 certifications and attestations.</span></span> <span data-ttu-id="19212-124">Hello самый полный набор любого поставщика облачных служб.</span><span class="sxs-lookup"><span data-stu-id="19212-124">hello most comprehensive set of any cloud service provider.</span></span>

<span data-ttu-id="19212-125">Дополнительные сведения см. в разделе сведений о соответствии hello на hello [Центр управления безопасностью Microsoft][TrustCenter].</span><span class="sxs-lookup"><span data-stu-id="19212-125">For more information, see hello compliance information on hello [Microsoft Trust Center][TrustCenter].</span></span>

<span data-ttu-id="19212-126">Корпорация Майкрософт имеет комплексный подход tooprotect облака инфраструктуру toorun крупномасштабных глобальных служб.</span><span class="sxs-lookup"><span data-stu-id="19212-126">Microsoft has a comprehensive approach tooprotect cloud infrastructure needed toorun hyper-scale global services.</span></span> <span data-ttu-id="19212-127">Облачная инфраструктура Майкрософт включает оборудования, программного обеспечения, сети и администратора, и сотрудникам, кроме toohello физического центры обработки данных.</span><span class="sxs-lookup"><span data-stu-id="19212-127">Microsoft cloud infrastructure includes hardware, software, networks, and administrative and operations staff, in addition toohello physical data centers.</span></span>

<span data-ttu-id="19212-128">![2]</span><span class="sxs-lookup"><span data-stu-id="19212-128">![2]</span></span>

<span data-ttu-id="19212-129">Такой подход обеспечивает более надежный фундамент для клиентов toodeploy свои службы в облако Microsoft hello.</span><span class="sxs-lookup"><span data-stu-id="19212-129">This approach provides a more secure foundation for customers toodeploy their services in hello Microsoft cloud.</span></span> <span data-ttu-id="19212-130">Следующий шаг Hello для toodesign клиентов и создать tooprotect архитектуры безопасности этих служб.</span><span class="sxs-lookup"><span data-stu-id="19212-130">hello next step is for customers toodesign and create a security architecture tooprotect these services.</span></span>

## <a name="traditional-security-architectures-and-perimeter-networks"></a><span data-ttu-id="19212-131">Традиционные архитектуры для систем безопасности и сетей периметра</span><span class="sxs-lookup"><span data-stu-id="19212-131">Traditional security architectures and perimeter networks</span></span>
<span data-ttu-id="19212-132">Несмотря на то, что корпорация Майкрософт вкладывает сильно средства защиты hello облачной инфраструктуры, пользователи также должны защищать их облачных служб и группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="19212-132">Although Microsoft invests heavily in protecting hello cloud infrastructure, customers must also protect their cloud services and resource groups.</span></span> <span data-ttu-id="19212-133">Toosecurity многоуровневого подхода предоставляет лучшим способом защиты hello.</span><span class="sxs-lookup"><span data-stu-id="19212-133">A multilayered approach toosecurity provides hello best defense.</span></span> <span data-ttu-id="19212-134">Зона безопасности сети периметра защищает внутренние сетевые ресурсы от ненадежных сетей.</span><span class="sxs-lookup"><span data-stu-id="19212-134">A perimeter network security zone protects internal network resources from an untrusted network.</span></span> <span data-ttu-id="19212-135">В сети периметра ссылается краев toohello или части сети hello, расположенные между hello Интернета и защищенные hello корпоративных ИТ-инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="19212-135">A perimeter network refers toohello edges or parts of hello network that sit between hello Internet and hello protected enterprise IT infrastructure.</span></span>

<span data-ttu-id="19212-136">В типичных корпоративных сетей hello базовой инфраструктуры сильно fortified на периметра hello, несколько уровней безопасности устройств.</span><span class="sxs-lookup"><span data-stu-id="19212-136">In typical enterprise networks, hello core infrastructure is heavily fortified at hello perimeters, with multiple layers of security devices.</span></span> <span data-ttu-id="19212-137">Hello границ каждого слоя состоит из устройств и точки применения политики.</span><span class="sxs-lookup"><span data-stu-id="19212-137">hello boundary of each layer consists of devices and policy enforcement points.</span></span> <span data-ttu-id="19212-138">Каждый слой может содержать сочетание hello следующие сетевые устройства безопасности: брандмауэры, защиты от отказа в обслуживании (DoS), обнаружения вторжений или системы защиты (Идентификаторы или IP-адреса) и VPN-устройства.</span><span class="sxs-lookup"><span data-stu-id="19212-138">Each layer can include a combination of hello following network security devices: firewalls, Denial of Service (DoS) prevention, Intrusion Detection or Protection Systems (IDS/IPS), and VPN devices.</span></span> <span data-ttu-id="19212-139">Применение политики может занять формы hello политики брандмауэра, списки управления доступом (ACL) или определенного маршрута.</span><span class="sxs-lookup"><span data-stu-id="19212-139">Policy enforcement can take hello form of firewall policies, access control lists (ACLs), or specific routing.</span></span> <span data-ttu-id="19212-140">Hello первую линию защиты в сети hello, непосредственно принимать входящий трафик от hello Интернет, представляет собой сочетание этих механизмов tooblock атак и вредоносного трафика, позволяет дополнительно допустимые запросы в сеть hello.</span><span class="sxs-lookup"><span data-stu-id="19212-140">hello first line of defense in hello network, directly accepting incoming traffic from hello Internet, is a combination of these mechanisms tooblock attacks and harmful traffic while allowing legitimate requests further into hello network.</span></span> <span data-ttu-id="19212-141">Этот трафик будет направлять непосредственно tooresources в сети периметра hello.</span><span class="sxs-lookup"><span data-stu-id="19212-141">This traffic routes directly tooresources in hello perimeter network.</span></span> <span data-ttu-id="19212-142">Этот ресурс может затем «общаться» tooresources глубже в сети hello, transiting hello следующей границы для проверки первого.</span><span class="sxs-lookup"><span data-stu-id="19212-142">That resource may then “talk” tooresources deeper in hello network, transiting hello next boundary for validation first.</span></span> <span data-ttu-id="19212-143">Hello внешней слой называется hello сети периметра, так как эта часть hello сети предоставляется toohello Интернет, обычно с использованием некоторой типа защиты с обеих сторон.</span><span class="sxs-lookup"><span data-stu-id="19212-143">hello outermost layer is called hello perimeter network because this part of hello network is exposed toohello Internet, usually with some form of protection on both sides.</span></span> <span data-ttu-id="19212-144">Hello на этом рисунке показан пример сети периметра одной подсети в корпоративной сети, с двумя границы безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-144">hello following figure shows an example of a single subnet perimeter network in a corporate network, with two security boundaries.</span></span>

<span data-ttu-id="19212-145">![3]</span><span class="sxs-lookup"><span data-stu-id="19212-145">![3]</span></span>

<span data-ttu-id="19212-146">Существует много tooimplement архитектур, которые используются в сети периметра.</span><span class="sxs-lookup"><span data-stu-id="19212-146">There are many architectures used tooimplement a perimeter network.</span></span> <span data-ttu-id="19212-147">Эти архитектуры можно с помощью различных механизмов на каждый границ tooblock трафик в диапазоне от сети периметра несколькими подсетями tooa подсистемы балансировки нагрузки простой и защитить hello более глубокого уровня hello корпоративной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-147">These architectures can range from a simple load balancer tooa multiple-subnet perimeter network with varied mechanisms at each boundary tooblock traffic and protect hello deeper layers of hello corporate network.</span></span> <span data-ttu-id="19212-148">Построение сети периметра hello зависит от конкретных потребностей организации hello и его общего рискам hello.</span><span class="sxs-lookup"><span data-stu-id="19212-148">How hello perimeter network is built depends on hello specific needs of hello organization and its overall risk tolerance.</span></span>

<span data-ttu-id="19212-149">Клиенты перемещают своих рабочих нагрузок toopublic облаках, это критическое toosupport подобных возможностей для архитектуры сети периметра в Azure toomeet соответствия и требований к безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-149">As customers move their workloads toopublic clouds, it is critical toosupport similar capabilities for perimeter network architecture in Azure toomeet compliance and security requirements.</span></span> <span data-ttu-id="19212-150">В этом документе приведены рекомендации по построению безопасной сетевой среды в Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-150">This document provides guidelines on how customers can build a secure network environment in Azure.</span></span> <span data-ttu-id="19212-151">Основное внимание уделяется hello сети периметра, но также включает подробного обсуждения многие аспекты безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="19212-151">It focuses on hello perimeter network, but also includes a comprehensive discussion of many aspects of network security.</span></span> <span data-ttu-id="19212-152">следующие вопросы Hello сообщает данного обсуждения:</span><span class="sxs-lookup"><span data-stu-id="19212-152">hello following questions inform this discussion:</span></span>

* <span data-ttu-id="19212-153">Как построить сеть периметра в Azure?</span><span class="sxs-lookup"><span data-stu-id="19212-153">How can a perimeter network in Azure be built?</span></span>
* <span data-ttu-id="19212-154">Что такое некоторые из сети периметра hello toobuild доступные компоненты Azure hello</span><span class="sxs-lookup"><span data-stu-id="19212-154">What are some of hello Azure features available toobuild hello perimeter network?</span></span>
* <span data-ttu-id="19212-155">Как защитить серверную часть рабочей нагрузки?</span><span class="sxs-lookup"><span data-stu-id="19212-155">How can back-end workloads be protected?</span></span>
* <span data-ttu-id="19212-156">Как организуется Интернет связи управляются toohello и рабочих нагрузок в Azure?</span><span class="sxs-lookup"><span data-stu-id="19212-156">How are Internet communications controlled toohello workloads in Azure?</span></span>
* <span data-ttu-id="19212-157">Как hello локальные сети могут быть защищены с развертываниями в Azure?</span><span class="sxs-lookup"><span data-stu-id="19212-157">How can hello on-premises networks be protected from deployments in Azure?</span></span>
* <span data-ttu-id="19212-158">Когда лучше использовать собственные функции безопасности Azure, а когда — устройства или службы сторонних производителей?</span><span class="sxs-lookup"><span data-stu-id="19212-158">When should native Azure security features be used versus third-party appliances or services?</span></span>

<span data-ttu-id="19212-159">Привет, следующая диаграмма показывает различные уровни безопасности, предоставляемые Azure toocustomers.</span><span class="sxs-lookup"><span data-stu-id="19212-159">hello following diagram shows various layers of security Azure provides toocustomers.</span></span> <span data-ttu-id="19212-160">Такими слоями являются машинный код в самой платформы Azure hello и определяемых пользователем функций:</span><span class="sxs-lookup"><span data-stu-id="19212-160">These layers are both native in hello Azure platform itself and customer-defined features:</span></span>

<span data-ttu-id="19212-161">![4]</span><span class="sxs-lookup"><span data-stu-id="19212-161">![4]</span></span>

<span data-ttu-id="19212-162">Входящего трафика из hello Интернета, помогает защититься от Azure крупномасштабных атак DDoS Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-162">Inbound from hello Internet, Azure DDoS helps protect against large-scale attacks against Azure.</span></span> <span data-ttu-id="19212-163">Следующий уровень Hello — пользовательское общих IP-адресов (конечные точки), используемые toodetermine, какой трафик может проходить по hello облачной службы toohello виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-163">hello next layer is customer-defined public IP addresses (endpoints), which are used toodetermine which traffic can pass through hello cloud service toohello virtual network.</span></span> <span data-ttu-id="19212-164">Виртуальная сеть Azure имеет встроенную систему изоляции от всех остальных сетей, и этот трафик может проходить только теми путями и методами, которые настроены пользователем.</span><span class="sxs-lookup"><span data-stu-id="19212-164">Native Azure virtual network isolation ensures complete isolation from all other networks and that traffic only flows through user configured paths and methods.</span></span> <span data-ttu-id="19212-165">Эти пути и методы являются hello следующего уровня, где Nsg, UDR и виртуальных сетевых устройств могут быть toocreate используется безопасности границы tooprotect hello развертывания приложений в сети защищенных hello.</span><span class="sxs-lookup"><span data-stu-id="19212-165">These paths and methods are hello next layer, where NSGs, UDR, and network virtual appliances can be used toocreate security boundaries tooprotect hello application deployments in hello protected network.</span></span>

<span data-ttu-id="19212-166">Hello следующем разделе приведены общие сведения о виртуальных сетях Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-166">hello next section provides an overview of Azure virtual networks.</span></span> <span data-ttu-id="19212-167">Эти виртуальные сети создаются пользователями и используются для подключения развернутых рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="19212-167">These virtual networks are created by customers, and are what their deployed workloads are connected to.</span></span> <span data-ttu-id="19212-168">Виртуальные сети — это hello основой для всех средств сетевой безопасности hello обязательных tooestablish периметра сети tooprotect клиента в Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-168">Virtual networks are hello basis of all hello network security features required tooestablish a perimeter network tooprotect customer deployments in Azure.</span></span>

## <a name="overview-of-azure-virtual-networks"></a><span data-ttu-id="19212-169">Общие сведения о виртуальных сетях Azure</span><span class="sxs-lookup"><span data-stu-id="19212-169">Overview of Azure virtual networks</span></span>
<span data-ttu-id="19212-170">Прежде чем Интернет-трафика можно получить toohello виртуальные сети Azure, существует два уровня безопасности специфические toohello платформы Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-170">Before Internet traffic can get toohello Azure virtual networks, there are two layers of security inherent toohello Azure platform:</span></span>

1.    <span data-ttu-id="19212-171">**Защита от атак DDoS**: защита от атак DDoS представляет собой уровень hello Azure физической сети, защищающий hello платформы Azure, сам от крупномасштабных Интернет-атак.</span><span class="sxs-lookup"><span data-stu-id="19212-171">**DDoS protection**: DDoS protection is a layer of hello Azure physical network that protects hello Azure platform itself from large-scale Internet-based attacks.</span></span> <span data-ttu-id="19212-172">Эти атаки использовать несколько узлов «нижняя» в toooverwhelm попытки службы в IIS.</span><span class="sxs-lookup"><span data-stu-id="19212-172">These attacks use multiple “bot” nodes in an attempt toooverwhelm an Internet service.</span></span> <span data-ttu-id="19212-173">Платформа Azure надежно защищена от атак DDoS на всех интерфейсах, принимающих входящий, исходящий и межрегиональный трафик.</span><span class="sxs-lookup"><span data-stu-id="19212-173">Azure has a robust DDoS protection mesh on all inbound, outbound, and cross-Azure region connectivity.</span></span> <span data-ttu-id="19212-174">Этот уровень защиты от атак DDoS нет настраиваемых атрибутов пользователя и не доступен toohello клиента.</span><span class="sxs-lookup"><span data-stu-id="19212-174">This DDoS protection layer has no user configurable attributes and is not accessible toohello customer.</span></span> <span data-ttu-id="19212-175">уровень защиты от атак DDoS Hello защищает Azure как платформу в крупномасштабных атак, она также отслеживает трафика область между Azure и исходящего трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-175">hello DDoS protection layer protects Azure as a platform from large-scale attacks, it also monitors out-bound traffic and cross-Azure region traffic.</span></span> <span data-ttu-id="19212-176">С помощью виртуальных сетевых устройств на hello виртуальной сети, дополнительные уровни устойчивости можно настроить клиентом hello от небольших шкалы атаки, не быть hello платформы уровень защиты.</span><span class="sxs-lookup"><span data-stu-id="19212-176">Using network virtual appliances on hello VNet, additional layers of resilience can be configured by hello customer against a smaller scale attack that doesn't trip hello platform level protection.</span></span> <span data-ttu-id="19212-177">Пример DDoS в действие; Если IP-адрес с выходом в Интернет был атакованы крупномасштабных атак DDoS, Azure может определить источники hello атак hello и очистить hello неправильная трафика перед достижением пункт назначения.</span><span class="sxs-lookup"><span data-stu-id="19212-177">An example of DDoS in action; if an internet facing IP address was attacked by a large-scale DDoS attack, Azure would detect hello sources of hello attacks and scrub hello offending traffic before it reached its intended destination.</span></span> <span data-ttu-id="19212-178">В большинстве случаев hello атакуемой конечной точки не влияет hello атаки.</span><span class="sxs-lookup"><span data-stu-id="19212-178">In almost all cases, hello attacked endpoint isn't affected by hello attack.</span></span> <span data-ttu-id="19212-179">В редких случаях hello, что изменяется конечной точки трафик не является уязвимой tooother конечных точек, только конечная точка hello атаке.</span><span class="sxs-lookup"><span data-stu-id="19212-179">In hello rare cases that an endpoint is affected, no traffic is affected tooother endpoints, only hello attacked endpoint.</span></span> <span data-ttu-id="19212-180">Кроме того, такая атака не повлияет на других клиентов и другие службы.</span><span class="sxs-lookup"><span data-stu-id="19212-180">Thus other customers and services would see no impact from that attack.</span></span> <span data-ttu-id="19212-181">Это критическое toonote, только ищет крупномасштабных атак Azure DDoS.</span><span class="sxs-lookup"><span data-stu-id="19212-181">It's critical toonote that Azure DDoS is only looking for large-scale attacks.</span></span> <span data-ttu-id="19212-182">Это возможно, прежде чем превышении hello платформы уровень защиты может переполниться определенной службы.</span><span class="sxs-lookup"><span data-stu-id="19212-182">It is possible that your specific service could be overwhelmed before hello platform level protection thresholds are exceeded.</span></span> <span data-ttu-id="19212-183">Например, атака DDoS может перевести веб-сайт на одном сервере A0 IIS в автономный режим, прежде чем уровень защиты Azure от атак DDoS зарегистрирует угрозу.</span><span class="sxs-lookup"><span data-stu-id="19212-183">For example, a web site on a single A0 IIS server, could be taken offline by a DDoS attack before Azure platform level DDoS protection registered a threat.</span></span>

2.  <span data-ttu-id="19212-184">**Общедоступные IP-адреса**: общедоступный IP-адрес облачных служб разрешать адреса (включена посредством адреса конечных точек службы, общедоступный IP-адрес, шлюз приложений и другие компоненты Azure, представляющих открытый ресурс IP-адреса toohello маршрутизации Интернета tooyour) или группы ресурсов, toohave открытый Интернет IP-адресов и портов.</span><span class="sxs-lookup"><span data-stu-id="19212-184">**Public IP Addresses**: Public IP addresses (enabled via service endpoints, Public IP addresses, Application Gateway, and other Azure features that present a public IP address toohello internet routed tooyour resource) allow cloud services or resource groups toohave public Internet IP addresses and ports exposed.</span></span> <span data-ttu-id="19212-185">Конечная точка Hello использует внутренний адрес трафика tooroute toohello сетевых адресов (NAT) и порт на hello виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-185">hello endpoint uses Network Address Translation (NAT) tooroute traffic toohello internal address and port on hello Azure virtual network.</span></span> <span data-ttu-id="19212-186">Этот путь является основной способ hello toopass внешний трафик в виртуальной сети hello.</span><span class="sxs-lookup"><span data-stu-id="19212-186">This path is hello primary way for external traffic toopass into hello virtual network.</span></span> <span data-ttu-id="19212-187">как и где он преобразуется в виртуальной сети toohello Hello общедоступные IP-адреса являются toodetermine можно настроить, какие трафик передается в</span><span class="sxs-lookup"><span data-stu-id="19212-187">hello Public IP addresses are configurable toodetermine which traffic is passed in, and how and where it's translated on toohello virtual network.</span></span>

<span data-ttu-id="19212-188">По достижении трафика hello виртуальной сети существует множество функций, которые следует учитывать.</span><span class="sxs-lookup"><span data-stu-id="19212-188">Once traffic reaches hello virtual network, there are many features that come into play.</span></span> <span data-ttu-id="19212-189">Виртуальные сети Azure являются hello основу для клиентов tooattach их рабочих нагрузок и когда применяет основные безопасность на уровне сети.</span><span class="sxs-lookup"><span data-stu-id="19212-189">Azure virtual networks are hello foundation for customers tooattach their workloads and where basic network-level security applies.</span></span> <span data-ttu-id="19212-190">Это частная сеть (наложение виртуальной сети) в Azure для клиентов с hello следующие возможности и характеристики:</span><span class="sxs-lookup"><span data-stu-id="19212-190">It is a private network (a virtual network overlay) in Azure for customers with hello following features and characteristics:</span></span>

* <span data-ttu-id="19212-191">**Изоляция трафика**: виртуальная сеть — hello границы изоляции трафика на hello платформы Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-191">**Traffic isolation**: A virtual network is hello traffic isolation boundary on hello Azure platform.</span></span> <span data-ttu-id="19212-192">Виртуальные машины (ВМ) в одной виртуальной сети не могут взаимодействовать напрямую tooVMs в другую виртуальную сеть, даже если обе виртуальные сети создаются с Привет одному клиенту.</span><span class="sxs-lookup"><span data-stu-id="19212-192">Virtual machines (VMs) in one virtual network cannot communicate directly tooVMs in a different virtual network, even if both virtual networks are created by hello same customer.</span></span> <span data-ttu-id="19212-193">Это критически важное свойство, которое гарантирует, что виртуальные машины и все коммуникации клиента останутся закрытыми в пределах виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-193">Isolation is a critical property that ensures customer VMs and communication remains private within a virtual network.</span></span>

>[!NOTE]
><span data-ttu-id="19212-194">Изоляция трафика относится только tootraffic *входящий* toohello виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-194">Traffic isolation refers only tootraffic *inbound* toohello virtual network.</span></span> <span data-ttu-id="19212-195">По исходящий трафик по умолчанию hello toohello виртуальной сети Интернет разрешена, но можно предотвратить, при необходимости, Nsg.</span><span class="sxs-lookup"><span data-stu-id="19212-195">By default outbound traffic from hello VNet toohello internet is allowed, but can be prevented if desired by NSGs.</span></span>
>
>

* <span data-ttu-id="19212-196">**Многоуровневая топология**: виртуальные сети позволяют клиентам toodefine многоуровневой топологии путем выделения подсетей и назначения отдельных адресные пространства для различных элементов или «уровнями «их рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="19212-196">**Multi-tier topology**: Virtual networks allow customers toodefine multi-tier topology by allocating subnets and designating separate address spaces for different elements or “tiers” of their workloads.</span></span> <span data-ttu-id="19212-197">Эти логические группы и топологии включить заказчиков toodefine различный уровень доступа политики на основе типов hello рабочей нагрузки и управляют потоки трафика между уровнями hello.</span><span class="sxs-lookup"><span data-stu-id="19212-197">These logical groupings and topologies enable customers toodefine different access policy based on hello workload types, and also control traffic flows between hello tiers.</span></span>
* <span data-ttu-id="19212-198">**Распределенное подключение.** Клиенты могут установить подключение между виртуальной сетью и несколькими локальными сайтами или другими виртуальными сетями в Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-198">**Cross-premises connectivity**: Customers can establish cross-premises connectivity between a virtual network and multiple on-premises sites or other virtual networks in Azure.</span></span> <span data-ttu-id="19212-199">tooconstruct соединение, клиенты могут использовать Пиринг виртуальной сети, VPN-шлюзы Azure, виртуальных устройств сети сторонних разработчиков или ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="19212-199">tooconstruct a connection, customers can use VNet Peering, Azure VPN Gateways, third-party network virtual appliances, or ExpressRoute.</span></span> <span data-ttu-id="19212-200">Azure поддерживает VPN типа "сеть — сеть" со стандартными протоколами IPsec/IKE, а также службу частного соединения ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="19212-200">Azure supports site-to-site (S2S) VPNs using standard IPsec/IKE protocols and ExpressRoute private connectivity.</span></span>
* <span data-ttu-id="19212-201">**NSG** позволяет клиентам toocreate правил (ACL) на уровне гранулярности hello требуемого: сетевые интерфейсы, отдельных виртуальных машин или виртуальные подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-201">**NSG** allows customers toocreate rules (ACLs) at hello desired level of granularity: network interfaces, individual VMs, or virtual subnets.</span></span> <span data-ttu-id="19212-202">Пользователи могут управлять доступом, разрешение или запрет обмен данными между hello рабочих нагрузок в виртуальной сети, от систем в сети клиента через подключения между организациями или прямой обмен данными через Интернет.</span><span class="sxs-lookup"><span data-stu-id="19212-202">Customers can control access by permitting or denying communication between hello workloads within a virtual network, from systems on customer’s networks via cross-premises connectivity, or direct Internet communication.</span></span>
* <span data-ttu-id="19212-203">**UDR** и **IP-пересылка** позволяют клиентам пути обмена данными hello toodefine между различными уровнями в виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-203">**UDR** and **IP Forwarding** allow customers toodefine hello communication paths between different tiers within a virtual network.</span></span> <span data-ttu-id="19212-204">Клиенты могут развернуть брандмауэр, устройство IDS/IPS или другие виртуальные устройства и направить сетевой трафик через эти устройства безопасности, что позволяет применять, контролировать и проверять политики границ безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-204">Customers can deploy a firewall, IDS/IPS, and other virtual appliances, and route network traffic through these security appliances for security boundary policy enforcement, auditing, and inspection.</span></span>
* <span data-ttu-id="19212-205">**Сети виртуальных приборов** в hello Azure Marketplace: устройства для обеспечения безопасности, таких как брандмауэры, подсистемы балансировки нагрузки и Идентификаторы или IP-адресов в Azure Marketplace hello и hello коллекции образов виртуальных Машин.</span><span class="sxs-lookup"><span data-stu-id="19212-205">**Network virtual appliances** in hello Azure Marketplace: Security appliances such as firewalls, load balancers, and IDS/IPS are available in hello Azure Marketplace and hello VM Image Gallery.</span></span> <span data-ttu-id="19212-206">Клиенты могут развернуть эти устройства в своих виртуальных сетей и в частности, в их безопасности границы (включая hello подсети сети периметра) toocomplete многоуровневых безопасной сетевой среде.</span><span class="sxs-lookup"><span data-stu-id="19212-206">Customers can deploy these appliances into their virtual networks, and specifically, at their security boundaries (including hello perimeter network subnets) toocomplete a multi-tiered secure network environment.</span></span>

<span data-ttu-id="19212-207">С помощью этих функций и возможностей одним из примеров как архитектуру сети периметра может создаваться в Azure — hello, следующая схема:</span><span class="sxs-lookup"><span data-stu-id="19212-207">With these features and capabilities, one example of how a perimeter network architecture could be constructed in Azure is hello following diagram:</span></span>

<span data-ttu-id="19212-208">![5]</span><span class="sxs-lookup"><span data-stu-id="19212-208">![5]</span></span>

## <a name="perimeter-network-characteristics-and-requirements"></a><span data-ttu-id="19212-209">Характеристики сети периметра и требования к ней</span><span class="sxs-lookup"><span data-stu-id="19212-209">Perimeter network characteristics and requirements</span></span>
<span data-ttu-id="19212-210">сеть периметра Hello представляет hello интерфейсной части сети hello, непосредственно взаимодействие связь с hello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-210">hello perimeter network is hello front end of hello network, directly interfacing communication from hello Internet.</span></span> <span data-ttu-id="19212-211">входящие пакеты приветствия должен проходить устройства для обеспечения безопасности hello, например hello брандмауэра, Идентификаторы и IP-адресов, до достижения hello внутренними серверами.</span><span class="sxs-lookup"><span data-stu-id="19212-211">hello incoming packets should flow through hello security appliances, such as hello firewall, IDS, and IPS, before reaching hello back-end servers.</span></span> <span data-ttu-id="19212-212">Также обмен пакетами Интернета из рабочих нагрузок hello помощью hello безопасности устройств в сети периметра hello для принудительного применения политики, проверки и проверки перед выходом из сети hello.</span><span class="sxs-lookup"><span data-stu-id="19212-212">Internet-bound packets from hello workloads can also flow through hello security appliances in hello perimeter network for policy enforcement, inspection, and auditing purposes, before leaving hello network.</span></span> <span data-ttu-id="19212-213">Кроме того сети периметра hello можно разместить между организациями шлюзах VPN между виртуальными сетями клиентов и локальным сетям.</span><span class="sxs-lookup"><span data-stu-id="19212-213">Additionally, hello perimeter network can host cross-premises VPN gateways between customer virtual networks and on-premises networks.</span></span>

### <a name="perimeter-network-characteristics"></a><span data-ttu-id="19212-214">Характеристики сети периметра</span><span class="sxs-lookup"><span data-stu-id="19212-214">Perimeter network characteristics</span></span>
<span data-ttu-id="19212-215">Создание ссылок на предыдущем рисунке hello, некоторые характеристики hello хорошо пограничной сети таковы:</span><span class="sxs-lookup"><span data-stu-id="19212-215">Referencing hello previous figure, some of hello characteristics of a good perimeter network are as follows:</span></span>

* <span data-ttu-id="19212-216">Выход в Интернет:</span><span class="sxs-lookup"><span data-stu-id="19212-216">Internet-facing:</span></span>
  * <span data-ttu-id="19212-217">подсеть сети периметра Hello сам является с выходом в Интернет, напрямую взаимодействовать hello Интернет.</span><span class="sxs-lookup"><span data-stu-id="19212-217">hello perimeter network subnet itself is Internet-facing, directly communicating with hello Internet.</span></span>
  * <span data-ttu-id="19212-218">Общих IP-адресов, виртуальные IP-адреса и/или конечных точек службы передачи Интернет трафика toohello внешней сети и устройства.</span><span class="sxs-lookup"><span data-stu-id="19212-218">Public IP addresses, VIPs, and/or service endpoints pass Internet traffic toohello front-end network and devices.</span></span>
  * <span data-ttu-id="19212-219">Входящий трафик из Интернета проходит через устройств безопасности перед другими ресурсами интерфейса сети hello приветствия.</span><span class="sxs-lookup"><span data-stu-id="19212-219">Inbound traffic from hello Internet passes through security devices before other resources on hello front-end network.</span></span>
  * <span data-ttu-id="19212-220">Если включена безопасность исходящих подключений, прохождение трафика устройств безопасности, hello последнем этапе перед передачей toohello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-220">If outbound security is enabled, traffic passes through security devices, as hello final step, before passing toohello Internet.</span></span>
* <span data-ttu-id="19212-221">Защищенная сеть:</span><span class="sxs-lookup"><span data-stu-id="19212-221">Protected network:</span></span>
  * <span data-ttu-id="19212-222">Отсутствует прямой путь из hello Internet toohello базовой инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="19212-222">There is no direct path from hello Internet toohello core infrastructure.</span></span>
  * <span data-ttu-id="19212-223">Каналы toohello базовой инфраструктуры должен перехода по безопасности устройств, таких как Nsg, брандмауэров и VPN-устройства.</span><span class="sxs-lookup"><span data-stu-id="19212-223">Channels toohello core infrastructure must traverse through security devices such as NSGs, firewalls, or VPN devices.</span></span>
  * <span data-ttu-id="19212-224">Другие устройства не должно установить мост Интернет» и «hello базовой инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="19212-224">Other devices must not bridge Internet and hello core infrastructure.</span></span>
  * <span data-ttu-id="19212-225">Устройств безопасности как на hello с выходом в Интернет и защищенные сетевые hello сторону границы hello пограничной сети (например, hello два брандмауэра значки, представленные на предыдущем рисунке hello) фактически может быть одного виртуального устройства с дифференцированной правила или интерфейсы для каждой границы.</span><span class="sxs-lookup"><span data-stu-id="19212-225">Security devices on both hello Internet-facing and hello protected network facing boundaries of hello perimeter network (for example, hello two firewall icons shown in hello previous figure) may actually be a single virtual appliance with differentiated rules or interfaces for each boundary.</span></span> <span data-ttu-id="19212-226">Например одно физическое устройство, логически разделяя обработки нагрузки hello для границ hello пограничной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-226">For example, one physical device, logically separated, handling hello load for both boundaries of hello perimeter network.</span></span>
* <span data-ttu-id="19212-227">Другие общие рекомендации и ограничения:</span><span class="sxs-lookup"><span data-stu-id="19212-227">Other common practices and constraints:</span></span>
  * <span data-ttu-id="19212-228">В рабочих нагрузках не может храниться критически важная информация.</span><span class="sxs-lookup"><span data-stu-id="19212-228">Workloads must not store business critical information.</span></span>
  * <span data-ttu-id="19212-229">Доступ и обновление конфигурации сети tooperimeter и развертывания, ограниченный tooonly прав администраторов.</span><span class="sxs-lookup"><span data-stu-id="19212-229">Access and updates tooperimeter network configurations and deployments are limited tooonly authorized administrators.</span></span>

### <a name="perimeter-network-requirements"></a><span data-ttu-id="19212-230">Требования к сети периметра</span><span class="sxs-lookup"><span data-stu-id="19212-230">Perimeter network requirements</span></span>
<span data-ttu-id="19212-231">tooenable эти характеристики придерживайтесь следующих правил на tooimplement требования к виртуальной сети успешно демилитаризованной:</span><span class="sxs-lookup"><span data-stu-id="19212-231">tooenable these characteristics, follow these guidelines on virtual network requirements tooimplement a successful perimeter network:</span></span>

* <span data-ttu-id="19212-232">**Архитектура подсети:** укажите hello виртуальной сети таким образом, что выделенный всю подсеть в сети периметра hello, отделен от других подсетей в hello же виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-232">**Subnet architecture:** Specify hello virtual network such that an entire subnet is dedicated as hello perimeter network, separated from other subnets in hello same virtual network.</span></span> <span data-ttu-id="19212-233">Подобное разделение обеспечивает hello трафик между демилитаризованной hello и других потоков уровней внутреннего или частного подсети через брандмауэр или Идентификаторы или IP-адреса виртуального устройства.</span><span class="sxs-lookup"><span data-stu-id="19212-233">This separation ensures hello traffic between hello perimeter network and other internal or private subnet tiers flows through a firewall or IDS/IPS virtual appliance.</span></span>  <span data-ttu-id="19212-234">Определяемые пользователем маршруты на границе hello подсетей, требуется tooforward этот трафик toohello виртуальное устройство.</span><span class="sxs-lookup"><span data-stu-id="19212-234">User-defined routes on hello boundary subnets are required tooforward this traffic toohello virtual appliance.</span></span>
* <span data-ttu-id="19212-235">**NSG:** подсети сети периметра hello сам должен быть открытым tooallow связь с hello Internet, но это не значит, клиенты должны обход Nsg.</span><span class="sxs-lookup"><span data-stu-id="19212-235">**NSG:** hello perimeter network subnet itself should be open tooallow communication with hello Internet, but that does not mean customers should be bypassing NSGs.</span></span> <span data-ttu-id="19212-236">Выполните общие безопасности и рекомендации toominimize hello сети предоставляется поверхности toohello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-236">Follow common security practices toominimize hello network surfaces exposed toohello Internet.</span></span> <span data-ttu-id="19212-237">Заблокировать разрешенных tooaccess hello развертываний или протоколов конкретного приложения hello и портов, открытых диапазоны удаленный адрес hello.</span><span class="sxs-lookup"><span data-stu-id="19212-237">Lock down hello remote address ranges allowed tooaccess hello deployments or hello specific application protocols and ports that are open.</span></span> <span data-ttu-id="19212-238">При этом могут возникнуть обстоятельства, в которых полная блокировка невозможна.</span><span class="sxs-lookup"><span data-stu-id="19212-238">There may be circumstances, however, in which a complete lock-down is not possible.</span></span> <span data-ttu-id="19212-239">Например, если у клиентов имеется внешний веб-сайт в Azure, hello сети периметра следует разрешить hello входящие запросы из любой общих IP-адресов, но только следует открыть порты приложения hello web: TCP через порт 80 и TCP через порт 443.</span><span class="sxs-lookup"><span data-stu-id="19212-239">For example, if customers have an external website in Azure, hello perimeter network should allow hello incoming web requests from any public IP addresses, but should only open hello web application ports: TCP on port 80 and/or TCP on port 443.</span></span>
* <span data-ttu-id="19212-240">**Таблица маршрутизации:** подсети сети периметра hello сам должен быть доступ toocommunicate toohello Internet непосредственно, но не должен позволять tooand прямой обмен данными из hello назад окончания или локальных сетей без прохода через брандмауэр или Система безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-240">**Routing table:** hello perimeter network subnet itself should be able toocommunicate toohello Internet directly, but should not allow direct communication tooand from hello back end or on-premises networks without going through a firewall or security appliance.</span></span>
* <span data-ttu-id="19212-241">**Конфигурация безопасности устройства:** tooroute и проверки пакетов между сетью периметра hello и rest hello hello защищенных сетей hello безопасности устройств, таких как брандмауэры, Идентификаторы, и IP-адреса устройств может быть многосетевой.</span><span class="sxs-lookup"><span data-stu-id="19212-241">**Security appliance configuration:** tooroute and inspect packets between hello perimeter network and hello rest of hello protected networks, hello security appliances such as firewall, IDS, and IPS devices may be multi-homed.</span></span> <span data-ttu-id="19212-242">Они могут испытывать отдельные сетевые адаптеры для сети периметра hello и hello внутренней подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-242">They may have separate NICs for hello perimeter network and hello back-end subnets.</span></span> <span data-ttu-id="19212-243">Hello сетевых адаптеров в сети периметра hello непосредственно взаимодействовать tooand из hello Интернета, с hello соответствующие Nsg и hello периметра сети таблицу маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="19212-243">hello NICs in hello perimeter network communicate directly tooand from hello Internet, with hello corresponding NSGs and hello perimeter network routing table.</span></span> <span data-ttu-id="19212-244">сетевые адаптеры Hello подключение toohello внутренней подсети имеют больше ограничений, Nsg и hello соответствующие подсети внутренней таблицы маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="19212-244">hello NICs connecting toohello back-end subnets have more restricted NSGs and routing tables of hello corresponding back-end subnets.</span></span>
* <span data-ttu-id="19212-245">**Функциональные возможности устройства безопасности:** hello устройства для обеспечения безопасности развернутого в сети периметра hello, обычно выполнения hello следующие функциональные возможности:</span><span class="sxs-lookup"><span data-stu-id="19212-245">**Security appliance functionality:** hello security appliances deployed in hello perimeter network typically perform hello following functionality:</span></span>
  * <span data-ttu-id="19212-246">Брандмауэр: Применение правил брандмауэра или политики управления доступом для hello входящих запросов.</span><span class="sxs-lookup"><span data-stu-id="19212-246">Firewall: Enforcing firewall rules or access control policies for hello incoming requests.</span></span>
  * <span data-ttu-id="19212-247">Угрозы для выявления и предотвращения: обнаружение и Сдерживание атак злоумышленников из Интернета hello.</span><span class="sxs-lookup"><span data-stu-id="19212-247">Threat detection and prevention: Detecting and mitigating malicious attacks from hello Internet.</span></span>
  * <span data-ttu-id="19212-248">Аудит и ведение журнала — ведение подробных журналов аудита и анализа.</span><span class="sxs-lookup"><span data-stu-id="19212-248">Auditing and logging: Maintaining detailed logs for auditing and analysis.</span></span>
  * <span data-ttu-id="19212-249">Обратный прокси-сервер: перенаправление hello входящих запросов toohello соответствующих внутренних серверах.</span><span class="sxs-lookup"><span data-stu-id="19212-249">Reverse proxy: Redirecting hello incoming requests toohello corresponding back-end servers.</span></span> <span data-ttu-id="19212-250">Это перенаправление включает в себя сопоставление и обычно перевод адреса назначения hello на устройствах переднего плана hello, брандмауэры, toohello адреса внутреннего сервера.</span><span class="sxs-lookup"><span data-stu-id="19212-250">This redirection involves mapping and translating hello destination addresses on hello front-end devices, typically firewalls, toohello back-end server addresses.</span></span>
  * <span data-ttu-id="19212-251">Прокси-сервера пересылки: предоставление NAT и выполнении аудита для обмена данными, инициированный внутри toohello hello виртуальной сети Интернет.</span><span class="sxs-lookup"><span data-stu-id="19212-251">Forward proxy: Providing NAT and performing auditing for communication initiated from within hello virtual network toohello Internet.</span></span>
  * <span data-ttu-id="19212-252">Маршрутизатор: Перенаправления входящих, так и между подсетями трафика внутри виртуальной сети hello.</span><span class="sxs-lookup"><span data-stu-id="19212-252">Router: Forwarding incoming and cross-subnet traffic inside hello virtual network.</span></span>
  * <span data-ttu-id="19212-253">VPN-устройства: выступает в роли hello между организациями шлюзах VPN для нескольких организаций VPN-подключение между локальными сетями клиентов и виртуальными сетями Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-253">VPN device: Acting as hello cross-premises VPN gateways for cross-premises VPN connectivity between customer on-premises networks and Azure virtual networks.</span></span>
  * <span data-ttu-id="19212-254">VPN-сервера: принимает подключение tooAzure виртуальных сетей VPN-клиентов.</span><span class="sxs-lookup"><span data-stu-id="19212-254">VPN server: Accepting VPN clients connecting tooAzure virtual networks.</span></span>

> [!TIP]
> <span data-ttu-id="19212-255">Сохранить следующие два отдельных групп hello: hello пользователям право tooaccess hello периметра сетевой безопасности шестеренки и hello частных лиц авторизован как администраторы операции, разработки и развертывания приложения.</span><span class="sxs-lookup"><span data-stu-id="19212-255">Keep hello following two groups separate: hello individuals authorized tooaccess hello perimeter network security gear and hello individuals authorized as application development, deployment, or operations administrators.</span></span> <span data-ttu-id="19212-256">Разделение этих групп обеспечивает распределение обязанностей и не позволит одному человеку обойти одновременно систему безопасности приложений и систему безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="19212-256">Keeping these groups separate allows for a segregation of duties and prevents a single person from bypassing both applications security and network security controls.</span></span>
>
>

### <a name="questions-toobe-asked-when-building-network-boundaries"></a><span data-ttu-id="19212-257">Toobe вопросы, задаваемые при создании границы сети</span><span class="sxs-lookup"><span data-stu-id="19212-257">Questions toobe asked when building network boundaries</span></span>
<span data-ttu-id="19212-258">В этом разделе, если только специально упоминалось, hello термин «сети» относится tooprivate Azure виртуальные сети, созданной администратором подписки.</span><span class="sxs-lookup"><span data-stu-id="19212-258">In this section, unless specifically mentioned, hello term "networks" refers tooprivate Azure virtual networks created by a subscription administrator.</span></span> <span data-ttu-id="19212-259">Термин Hello не ссылаются toohello базового физических сетей в Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-259">hello term doesn't refer toohello underlying physical networks within Azure.</span></span>

<span data-ttu-id="19212-260">Кроме того виртуальные сети Azure чаще используется tooextend традиционной локальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-260">Also, Azure virtual networks are often used tooextend traditional on-premises networks.</span></span> <span data-ttu-id="19212-261">Это возможно tooincorporate сайт сайт или ExpressRoute гибридных сетевых решений с архитектурой сети периметра.</span><span class="sxs-lookup"><span data-stu-id="19212-261">It is possible tooincorporate either site-to-site or ExpressRoute hybrid networking solutions with perimeter network architectures.</span></span> <span data-ttu-id="19212-262">Это важно учитывать при создании границ безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="19212-262">This hybrid link is an important consideration in building network security boundaries.</span></span>

<span data-ttu-id="19212-263">Hello следующие три вопросы, важные tooanswer при построении сети в сети периметра и несколько защитных границ.</span><span class="sxs-lookup"><span data-stu-id="19212-263">hello following three questions are critical tooanswer when you're building a network with a perimeter network and multiple security boundaries.</span></span>

#### <a name="1-how-many-boundaries-are-needed"></a><span data-ttu-id="19212-264">1) Сколько границ необходимо?</span><span class="sxs-lookup"><span data-stu-id="19212-264">1) How many boundaries are needed?</span></span>
<span data-ttu-id="19212-265">Hello первой точки принятия решений — toodecide, сколько границы безопасности требуются в данном сценарии:</span><span class="sxs-lookup"><span data-stu-id="19212-265">hello first decision point is toodecide how many security boundaries are needed in a given scenario:</span></span>

* <span data-ttu-id="19212-266">Одна граница: одно hello интерфейса локальной сети, между hello виртуальную сеть и Интернет hello.</span><span class="sxs-lookup"><span data-stu-id="19212-266">A single boundary: One on hello front-end perimeter network, between hello virtual network and hello Internet.</span></span>
* <span data-ttu-id="19212-267">Две границы: один на hello Интернет части hello сети периметра, а другой между hello подсети сети периметра и подсети внутренней hello в hello виртуальные сети Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-267">Two boundaries: One on hello Internet side of hello perimeter network, and another between hello perimeter network subnet and hello back-end subnets in hello Azure virtual networks.</span></span>
* <span data-ttu-id="19212-268">Три границы: на стороне Интернет hello hello сети периметра, по одному между сетью периметра hello и подсетей серверной части и один между подсетями внутренней hello и hello в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-268">Three boundaries: One on hello Internet side of hello perimeter network, one between hello perimeter network and back-end subnets, and one between hello back-end subnets and hello on-premises network.</span></span>
* <span data-ttu-id="19212-269">N границ: переменное количество.</span><span class="sxs-lookup"><span data-stu-id="19212-269">N boundaries: A variable number.</span></span> <span data-ttu-id="19212-270">В зависимости от требований безопасности отсутствует номер toohello предел границ безопасности, которые могут быть применены в данной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-270">Depending on security requirements, there is no limit toohello number of security boundaries that can be applied in a given network.</span></span>

<span data-ttu-id="19212-271">Hello число и тип границы, необходимо изменять на основе компании риск отказоустойчивость и hello конкретного сценария реализации.</span><span class="sxs-lookup"><span data-stu-id="19212-271">hello number and type of boundaries needed vary based on a company’s risk tolerance and hello specific scenario being implemented.</span></span> <span data-ttu-id="19212-272">Часто это решение совместно принимают несколько групп внутри организации. В их число часто входят отдел управления рисками и стандартами, отдел эксплуатации сети и платформы и команда разработчиков приложений.</span><span class="sxs-lookup"><span data-stu-id="19212-272">This decision is often made together with multiple groups within an organization, often including a risk and compliance team, a network and platform team, and an application development team.</span></span> <span data-ttu-id="19212-273">Люди с использованием сведений безопасности, тестовых данных hello и технологию hello должны иметь say в этой защиты решение tooensure hello безопасности для каждой реализации.</span><span class="sxs-lookup"><span data-stu-id="19212-273">People with knowledge of security, hello data involved, and hello technologies being used should have a say in this decision tooensure hello appropriate security stance for each implementation.</span></span>

> [!TIP]
> <span data-ttu-id="19212-274">Используйте наименьшее количество hello границы, которые удовлетворяют требованиям безопасности hello для определенной ситуации.</span><span class="sxs-lookup"><span data-stu-id="19212-274">Use hello smallest number of boundaries that satisfy hello security requirements for a given situation.</span></span> <span data-ttu-id="19212-275">С дополнительные границы операций и устранения неполадок можно быть более сложным, а также hello управления нагрузка с управлением hello несколько политик границ со временем.</span><span class="sxs-lookup"><span data-stu-id="19212-275">With more boundaries, operations and troubleshooting can be more difficult, as well as hello management overhead involved with managing hello multiple boundary policies over time.</span></span> <span data-ttu-id="19212-276">При этом недостаточное количество периметров повышает риск.</span><span class="sxs-lookup"><span data-stu-id="19212-276">However, insufficient boundaries increase risk.</span></span> <span data-ttu-id="19212-277">Поиск hello баланс важен.</span><span class="sxs-lookup"><span data-stu-id="19212-277">Finding hello balance is critical.</span></span>
>
>

<span data-ttu-id="19212-278">![6]</span><span class="sxs-lookup"><span data-stu-id="19212-278">![6]</span></span>

<span data-ttu-id="19212-279">Hello выше рисунке показано высокоуровневое представление границ три безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="19212-279">hello preceding figure shows a high-level view of a three security boundary network.</span></span> <span data-ttu-id="19212-280">являются Hello границы между демилитаризованной hello и hello Интернета, hello Azure переднего плана и частные подсети серверной части и hello Azure конечной подсети и hello локальной корпоративной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-280">hello boundaries are between hello perimeter network and hello Internet, hello Azure front-end and back-end private subnets, and hello Azure back-end subnet and hello on-premises corporate network.</span></span>

#### <a name="2-where-are-hello-boundaries-located"></a><span data-ttu-id="19212-281">(2) границ hello расположение?</span><span class="sxs-lookup"><span data-stu-id="19212-281">2) Where are hello boundaries located?</span></span>
<span data-ttu-id="19212-282">После выбираются hello количество границ, где их является tooimplement hello следующей точки принятия решений.</span><span class="sxs-lookup"><span data-stu-id="19212-282">Once hello number of boundaries are decided, where tooimplement them is hello next decision point.</span></span> <span data-ttu-id="19212-283">Обычно существует три варианта расположения:</span><span class="sxs-lookup"><span data-stu-id="19212-283">There are generally three choices:</span></span>

* <span data-ttu-id="19212-284">С помощью промежуточной интернет-службы (например облачного брандмауэра веб-приложения; этот вариант не рассматривается в данном документе).</span><span class="sxs-lookup"><span data-stu-id="19212-284">Using an Internet-based intermediary service (for example, a cloud-based Web application firewall, which is not discussed in this document)</span></span>
* <span data-ttu-id="19212-285">С помощью встроенных функций или виртуальных сетевых устройств в Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-285">Using native features and/or network virtual appliances in Azure</span></span>
* <span data-ttu-id="19212-286">С помощью физических устройств hello в локальной сети</span><span class="sxs-lookup"><span data-stu-id="19212-286">Using physical devices on hello on-premises network</span></span>

<span data-ttu-id="19212-287">В сетях исключительно Azure hello значения встроенных возможностей Azure (например, Azure подсистемы балансировки нагрузки) или виртуальных сетевых устройств из hello Широкая сеть партнеров платформы Azure (например, брандмауэры Check Point).</span><span class="sxs-lookup"><span data-stu-id="19212-287">On purely Azure networks, hello options are native Azure features (for example, Azure Load Balancers) or network virtual appliances from hello rich partner ecosystem of Azure (for example, Check Point firewalls).</span></span>

<span data-ttu-id="19212-288">При необходимости границы между Azure и локальной сетью hello устройств безопасности, может находиться на обеих сторонах соединения hello (или обе).</span><span class="sxs-lookup"><span data-stu-id="19212-288">If a boundary is needed between Azure and an on-premises network, hello security devices can reside on either side of hello connection (or both sides).</span></span> <span data-ttu-id="19212-289">Таким образом принятия решений должны вноситься на шестеренки безопасности tooplace расположение hello.</span><span class="sxs-lookup"><span data-stu-id="19212-289">Thus a decision must be made on hello location tooplace security gear.</span></span>

<span data-ttu-id="19212-290">В предыдущем рисунке hello сети Интернет периметр hello границы front назад end hello полностью содержится в Azure и должно быть встроенным функциям Azure или виртуальных сетевых устройств.</span><span class="sxs-lookup"><span data-stu-id="19212-290">In hello previous figure, hello Internet-to-perimeter network and hello front-to-back-end boundaries are entirely contained within Azure, and must be either native Azure features or network virtual appliances.</span></span> <span data-ttu-id="19212-291">Здравствуйте, устройства безопасности на границу между Azure (конечной подсети) и hello корпоративной сети может быть либо на стороне Azure hello hello локальной стороне или даже сочетание устройства на обеих сторонах.</span><span class="sxs-lookup"><span data-stu-id="19212-291">Security devices on hello boundary between Azure (back-end subnet) and hello corporate network could be either on hello Azure side or hello on-premises side, or even a combination of devices on both sides.</span></span> <span data-ttu-id="19212-292">Может существовать значительные преимущества и недостатки tooeither параметр, который должен считаться серьезно.</span><span class="sxs-lookup"><span data-stu-id="19212-292">There can be significant advantages and disadvantages tooeither option that must be seriously considered.</span></span>

<span data-ttu-id="19212-293">Например с помощью имеющемся оборудовании физической безопасности на hello в локальном стороне сети имеет преимущество hello, что нет новых шестеренки необходимо.</span><span class="sxs-lookup"><span data-stu-id="19212-293">For example, using existing physical security gear on hello on-premises network side has hello advantage that no new gear is needed.</span></span> <span data-ttu-id="19212-294">Достаточно ее перенастроить.</span><span class="sxs-lookup"><span data-stu-id="19212-294">It just needs reconfiguration.</span></span> <span data-ttu-id="19212-295">Недостаток Hello, то весь трафик должен возвращаться из Azure toohello в локальной сети toobe точки зрения безопасности шестеренки hello.</span><span class="sxs-lookup"><span data-stu-id="19212-295">hello disadvantage, however, is that all traffic must come back from Azure toohello on-premises network toobe seen by hello security gear.</span></span> <span data-ttu-id="19212-296">Таким образом трафика Azure для Azure может повлечь существенные задержки и повлиять на приложения производительности и взаимодействия с пользователем, если она была принудительно toohello назад в локальной сети для применения политики безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-296">Thus Azure-to-Azure traffic could incur significant latency, and affect application performance and user experience, if it was forced back toohello on-premises network for security policy enforcement.</span></span>

#### <a name="3-how-are-hello-boundaries-implemented"></a><span data-ttu-id="19212-297">(3) как реализованы границы hello</span><span class="sxs-lookup"><span data-stu-id="19212-297">3) How are hello boundaries implemented?</span></span>
<span data-ttu-id="19212-298">Каждая граница безопасности, скорее всего будет требования различными возможностями (например, Идентификаторы и правила брандмауэра на hello Интернет части сети периметра hello, но только списки управления доступом между сетью периметра hello и внутренней подсети).</span><span class="sxs-lookup"><span data-stu-id="19212-298">Each security boundary will likely have different capability requirements (for example, IDS and firewall rules on hello Internet side of hello perimeter network, but only ACLs between hello perimeter network and back-end subnet).</span></span> <span data-ttu-id="19212-299">Выбор на какое устройство (или сколько устройств), зависит от toouse hello сценарии и требования к безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-299">Deciding on which device (or how many devices) toouse depends on hello scenario and security requirements.</span></span> <span data-ttu-id="19212-300">В следующем разделе hello примеры, 1, 2 и 3 рассматриваются некоторые параметры, которые могут использоваться.</span><span class="sxs-lookup"><span data-stu-id="19212-300">In hello following section, examples 1, 2, and 3 discuss some options that could be used.</span></span> <span data-ttu-id="19212-301">Обзор Azure собственного сетевые функции hello и hello устройств, доступные в Azure из партнеров hello показывает доступные toosolve hello множество параметров практически в любой ситуации.</span><span class="sxs-lookup"><span data-stu-id="19212-301">Reviewing hello Azure native network features and hello devices available in Azure from hello partner ecosystem shows hello myriad options available toosolve virtually any scenario.</span></span>

<span data-ttu-id="19212-302">Другим важным аспектом реализации ключа является как tooconnect hello в локальной сети с помощью Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-302">Another key implementation decision point is how tooconnect hello on-premises network with Azure.</span></span> <span data-ttu-id="19212-303">Следует ли использовать hello Azure виртуальный шлюз или устройство виртуальной сети?</span><span class="sxs-lookup"><span data-stu-id="19212-303">Should you use hello Azure virtual gateway or a network virtual appliance?</span></span> <span data-ttu-id="19212-304">Эти варианты рассматриваются более подробно в следующем разделе (примеры 4, 5 и 6) hello.</span><span class="sxs-lookup"><span data-stu-id="19212-304">These options are discussed in greater detail in hello following section (examples 4, 5, and 6).</span></span>

<span data-ttu-id="19212-305">Кроме того, может потребоваться трафик между виртуальными сетями в Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-305">Additionally, traffic between virtual networks within Azure may be needed.</span></span> <span data-ttu-id="19212-306">Эти сценарии будут добавлены в будущем hello.</span><span class="sxs-lookup"><span data-stu-id="19212-306">These scenarios will be added in hello future.</span></span>

<span data-ttu-id="19212-307">Здравствуйте, узнав hello ответы toohello предыдущие вопросы, [быстрого запуска](#fast-start) раздел поможет определить, какие примеры является наиболее подходящим для данного сценария.</span><span class="sxs-lookup"><span data-stu-id="19212-307">Once you know hello answers toohello previous questions, hello [Fast Start](#fast-start) section can help identify which examples are most appropriate for a given scenario.</span></span>

## <a name="examples-building-security-boundaries-with-azure-virtual-networks"></a><span data-ttu-id="19212-308">Примеры. Создание границ безопасности для виртуальных сетей Azure</span><span class="sxs-lookup"><span data-stu-id="19212-308">Examples: Building security boundaries with Azure virtual networks</span></span>
### <a name="example-1-build-a-perimeter-network-toohelp-protect-applications-with-nsgs"></a><span data-ttu-id="19212-309">Пример 1 сборки toohelp сети периметра защитить приложения с Nsg</span><span class="sxs-lookup"><span data-stu-id="19212-309">Example 1 Build a perimeter network toohelp protect applications with NSGs</span></span>
<span data-ttu-id="19212-310">[Резервное начала tooFast](#fast-start) | [подробные инструкции по построению для данного примера][Example1]</span><span class="sxs-lookup"><span data-stu-id="19212-310">[Back tooFast start](#fast-start) | [Detailed build instructions for this example][Example1]</span></span>

<span data-ttu-id="19212-311">[![7]][7]</span><span class="sxs-lookup"><span data-stu-id="19212-311">[![7]][7]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="19212-312">Описание среды</span><span class="sxs-lookup"><span data-stu-id="19212-312">Environment description</span></span>
<span data-ttu-id="19212-313">В этом примере имеется подписка, содержащий hello следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="19212-313">In this example, there is a subscription that contains hello following resources:</span></span>

- <span data-ttu-id="19212-314">одну группу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="19212-314">A single resource group</span></span>
- <span data-ttu-id="19212-315">виртуальную сеть с двумя подсетями (интерфейсной и внутренней);</span><span class="sxs-lookup"><span data-stu-id="19212-315">A virtual network with two subnets: “FrontEnd” and “BackEnd”</span></span>
- <span data-ttu-id="19212-316">Сетевую группу безопасности, примененных tooboth подсети</span><span class="sxs-lookup"><span data-stu-id="19212-316">A Network Security Group that is applied tooboth subnets</span></span>
- <span data-ttu-id="19212-317">сервер Windows Server, который представляет веб-сервер приложений (IIS01);</span><span class="sxs-lookup"><span data-stu-id="19212-317">A Windows server that represents an application web server (“IIS01”)</span></span>
- <span data-ttu-id="19212-318">два сервера Windows Server, представляющих тыловые серверы приложений (AppVM01, AppVM02);</span><span class="sxs-lookup"><span data-stu-id="19212-318">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
- <span data-ttu-id="19212-319">сервер Windows Server, который представляет DNS-сервер (DNS01).</span><span class="sxs-lookup"><span data-stu-id="19212-319">A Windows server that represents a DNS server (“DNS01”)</span></span>
- <span data-ttu-id="19212-320">Общедоступный IP-адрес, связанный с веб-сервера приложения hello</span><span class="sxs-lookup"><span data-stu-id="19212-320">A public IP associated with hello application web server</span></span>

<span data-ttu-id="19212-321">Для шаблона диспетчера ресурсов Azure и сценарии, в разделе hello [подробные инструкции по сборке][Example1].</span><span class="sxs-lookup"><span data-stu-id="19212-321">For scripts and an Azure Resource Manager template, see hello [detailed build instructions][Example1].</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="19212-322">Описание группы безопасности сети</span><span class="sxs-lookup"><span data-stu-id="19212-322">NSG description</span></span>
<span data-ttu-id="19212-323">В этом примере создается группа безопасности сети, после чего в нее загружаются шесть правил.</span><span class="sxs-lookup"><span data-stu-id="19212-323">In this example, an NSG group is built and then loaded with six rules.</span></span>

> [!TIP]
> <span data-ttu-id="19212-324">Вообще говоря, вам следует создать определенные правила «Разрешить» во-первых, следуют hello более универсальный правила «запретить».</span><span class="sxs-lookup"><span data-stu-id="19212-324">Generally speaking, you should create your specific “Allow” rules first, followed by hello more generic “Deny” rules.</span></span> <span data-ttu-id="19212-325">Привет, получающие приоритет определяет, какие правила вычисляются первыми.</span><span class="sxs-lookup"><span data-stu-id="19212-325">hello given priority dictates which rules are evaluated first.</span></span> <span data-ttu-id="19212-326">После обнаружения tooapply tooa конкретного правила трафика вычисляются другим правилам.</span><span class="sxs-lookup"><span data-stu-id="19212-326">Once traffic is found tooapply tooa specific rule, no further rules are evaluated.</span></span> <span data-ttu-id="19212-327">Правила NSG можно применять либо hello входящего и исходящего направления (с точки зрения hello hello подсети).</span><span class="sxs-lookup"><span data-stu-id="19212-327">NSG rules can apply in either hello inbound or outbound direction (from hello perspective of hello subnet).</span></span>
>
>

<span data-ttu-id="19212-328">Создаются декларативно, hello следующие правила для входящего трафика:</span><span class="sxs-lookup"><span data-stu-id="19212-328">Declaratively, hello following rules are being built for inbound traffic:</span></span>

1. <span data-ttu-id="19212-329">Внутренний трафик DNS (порт 53) разрешается.</span><span class="sxs-lookup"><span data-stu-id="19212-329">Internal DNS traffic (port 53) is allowed.</span></span>
2. <span data-ttu-id="19212-330">RDP (порт 3389) из Интернета hello tooany виртуальной машины-трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-330">RDP traffic (port 3389) from hello Internet tooany Virtual Machine is allowed.</span></span>
3. <span data-ttu-id="19212-331">HTTP (порт 80) с сервера tooweb hello Интернета (IIS01)-трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-331">HTTP traffic (port 80) from hello Internet tooweb server (IIS01) is allowed.</span></span>
4. <span data-ttu-id="19212-332">Все (все порты) из IIS01 tooAppVM1-трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-332">Any traffic (all ports) from IIS01 tooAppVM1 is allowed.</span></span>
5. <span data-ttu-id="19212-333">Любой трафик (все порты) из hello Internet toohello всей виртуальной сети (оба подсети) запрещен.</span><span class="sxs-lookup"><span data-stu-id="19212-333">Any traffic (all ports) from hello Internet toohello entire virtual network (both subnets) is denied.</span></span>
6. <span data-ttu-id="19212-334">Любой трафик (все порты) из hello интерфейса подсети toohello внутренней подсети запрещен.</span><span class="sxs-lookup"><span data-stu-id="19212-334">Any traffic (all ports) from hello front-end subnet toohello back-end subnet is denied.</span></span>

<span data-ttu-id="19212-335">С подсетью привязанного tooeach эти правила, если входящие данные от hello Internet toohello веб-сервера HTTP-запроса оба правила 3 (Разрешить) и 5 (запретить) будет применена.</span><span class="sxs-lookup"><span data-stu-id="19212-335">With these rules bound tooeach subnet, if an HTTP request was inbound from hello Internet toohello web server, both rules 3 (allow) and 5 (deny) would apply.</span></span> <span data-ttu-id="19212-336">Но поскольку правило 3 имеет более высокий приоритет, то будет применено только оно, а правило 5 не будет использовано.</span><span class="sxs-lookup"><span data-stu-id="19212-336">But because rule 3 has a higher priority, only it would apply, and rule 5 would not come into play.</span></span> <span data-ttu-id="19212-337">Таким образом hello HTTP-запроса допускается toohello веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="19212-337">Thus hello HTTP request would be allowed toohello web server.</span></span> <span data-ttu-id="19212-338">Если же трафик пытается tooreach hello DNS01 сервера, правило 5 (запретить) будет hello первый tooapply и не будет разрешен трафик hello toopass toohello сервера.</span><span class="sxs-lookup"><span data-stu-id="19212-338">If that same traffic was trying tooreach hello DNS01 server, rule 5 (deny) would be hello first tooapply, and hello traffic would not be allowed toopass toohello server.</span></span> <span data-ttu-id="19212-339">Правила 6 (запретить), блоки hello интерфейса подсети из взаимодействии toohello внутренней подсети (за исключением разрешенного трафика в правилах 1 и 4).</span><span class="sxs-lookup"><span data-stu-id="19212-339">Rule 6 (deny) blocks hello front-end subnet from talking toohello back-end subnet (except for allowed traffic in rules 1 and 4).</span></span> <span data-ttu-id="19212-340">Этот набор правил защищает hello внутренней сети, в случае, если злоумышленник взломает hello веб-приложение hello интерфейсной части.</span><span class="sxs-lookup"><span data-stu-id="19212-340">This rule-set protects hello back-end network in case an attacker compromises hello web application on hello front end.</span></span> <span data-ttu-id="19212-341">Hello злоумышленник будет ограничен доступ toohello внутренней «защищенные» сети (только tooresources, предоставляемые на сервере AppVM01 hello).</span><span class="sxs-lookup"><span data-stu-id="19212-341">hello attacker would have limited access toohello back-end “protected” network (only tooresources exposed on hello AppVM01 server).</span></span>

<span data-ttu-id="19212-342">Нет исходящих правило по умолчанию, разрешающее трафик, исходящий toohello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-342">There is a default outbound rule that allows traffic out toohello Internet.</span></span> <span data-ttu-id="19212-343">В этом примере мы разрешаем исходящий трафик и не меняем никаких исходящих правил.</span><span class="sxs-lookup"><span data-stu-id="19212-343">For this example, we’re allowing outbound traffic and not modifying any outbound rules.</span></span> <span data-ttu-id="19212-344">определяемые пользователем маршрутизации требуется toolock трафик в обоих направлениях (см. Пример 3).</span><span class="sxs-lookup"><span data-stu-id="19212-344">toolock down traffic in both directions, user-defined routing is required (see example 3).</span></span>

#### <a name="conclusion"></a><span data-ttu-id="19212-345">Заключение</span><span class="sxs-lookup"><span data-stu-id="19212-345">Conclusion</span></span>
<span data-ttu-id="19212-346">В этом примере является сравнительно простым и понятным способом изоляции hello внутренней подсети из входящего трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-346">This example is a relatively simple and straightforward way of isolating hello back-end subnet from inbound traffic.</span></span> <span data-ttu-id="19212-347">Дополнительные сведения см. в разделе hello [подробные инструкции по сборке][Example1].</span><span class="sxs-lookup"><span data-stu-id="19212-347">For more information, see hello [detailed build instructions][Example1].</span></span> <span data-ttu-id="19212-348">Эти инструкции включают:</span><span class="sxs-lookup"><span data-stu-id="19212-348">These instructions include:</span></span>

* <span data-ttu-id="19212-349">Как toobuild этого периметра сети с помощью классической сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19212-349">How toobuild this perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="19212-350">Как toobuild этого периметра сети с помощью шаблона диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-350">How toobuild this perimeter network with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="19212-351">Подробное описание каждой команды NSG.</span><span class="sxs-lookup"><span data-stu-id="19212-351">Detailed descriptions of each NSG command.</span></span>
* <span data-ttu-id="19212-352">Подробные сценарии прохождения трафика с демонстрацией разрешений и запретов на каждом уровне.</span><span class="sxs-lookup"><span data-stu-id="19212-352">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>


### <a name="example-2-build-a-perimeter-network-toohelp-protect-applications-with-a-firewall-and-nsgs"></a><span data-ttu-id="19212-353">Пример 2 сборки toohelp сети периметра защитить приложения с брандмауэром и Nsg</span><span class="sxs-lookup"><span data-stu-id="19212-353">Example 2 Build a perimeter network toohelp protect applications with a firewall and NSGs</span></span>
<span data-ttu-id="19212-354">[Резервное начала tooFast](#fast-start) | [подробные инструкции по построению для данного примера][Example2]</span><span class="sxs-lookup"><span data-stu-id="19212-354">[Back tooFast start](#fast-start) | [Detailed build instructions for this example][Example2]</span></span>

<span data-ttu-id="19212-355">[![8]][8]</span><span class="sxs-lookup"><span data-stu-id="19212-355">[![8]][8]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="19212-356">Описание среды</span><span class="sxs-lookup"><span data-stu-id="19212-356">Environment description</span></span>
<span data-ttu-id="19212-357">В этом примере имеется подписка, содержащий hello следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="19212-357">In this example, there is a subscription that contains hello following resources:</span></span>

* <span data-ttu-id="19212-358">одну группу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="19212-358">A single resource group</span></span>
* <span data-ttu-id="19212-359">виртуальную сеть с двумя подсетями (интерфейсной и внутренней);</span><span class="sxs-lookup"><span data-stu-id="19212-359">A virtual network with two subnets: “FrontEnd” and “BackEnd”</span></span>
* <span data-ttu-id="19212-360">Сетевую группу безопасности, примененных tooboth подсети</span><span class="sxs-lookup"><span data-stu-id="19212-360">A Network Security Group that is applied tooboth subnets</span></span>
* <span data-ttu-id="19212-361">Устройство виртуальной сети, в данном случае брандмауэра, подключение интерфейса подсети toohello</span><span class="sxs-lookup"><span data-stu-id="19212-361">A network virtual appliance, in this case a firewall, connected toohello front-end subnet</span></span>
* <span data-ttu-id="19212-362">сервер Windows Server, который представляет веб-сервер приложений (IIS01);</span><span class="sxs-lookup"><span data-stu-id="19212-362">A Windows server that represents an application web server (“IIS01”)</span></span>
* <span data-ttu-id="19212-363">два сервера Windows Server, представляющих тыловые серверы приложений (AppVM01, AppVM02);</span><span class="sxs-lookup"><span data-stu-id="19212-363">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
* <span data-ttu-id="19212-364">сервер Windows Server, который представляет DNS-сервер (DNS01).</span><span class="sxs-lookup"><span data-stu-id="19212-364">A Windows server that represents a DNS server (“DNS01”)</span></span>

<span data-ttu-id="19212-365">Для шаблона диспетчера ресурсов Azure и сценарии, в разделе hello [подробные инструкции по сборке][Example2].</span><span class="sxs-lookup"><span data-stu-id="19212-365">For scripts and an Azure Resource Manager template, see hello [detailed build instructions][Example2].</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="19212-366">Описание группы безопасности сети</span><span class="sxs-lookup"><span data-stu-id="19212-366">NSG description</span></span>
<span data-ttu-id="19212-367">В этом примере создается группа безопасности сети, после чего в нее загружаются шесть правил.</span><span class="sxs-lookup"><span data-stu-id="19212-367">In this example, an NSG group is built and then loaded with six rules.</span></span>

> [!TIP]
> <span data-ttu-id="19212-368">Вообще говоря, вам следует создать определенные правила «Разрешить» во-первых, следуют hello более универсальный правила «запретить».</span><span class="sxs-lookup"><span data-stu-id="19212-368">Generally speaking, you should create your specific “Allow” rules first, followed by hello more generic “Deny” rules.</span></span> <span data-ttu-id="19212-369">Привет, получающие приоритет определяет, какие правила вычисляются первыми.</span><span class="sxs-lookup"><span data-stu-id="19212-369">hello given priority dictates which rules are evaluated first.</span></span> <span data-ttu-id="19212-370">После обнаружения tooapply tooa конкретного правила трафика вычисляются другим правилам.</span><span class="sxs-lookup"><span data-stu-id="19212-370">Once traffic is found tooapply tooa specific rule, no further rules are evaluated.</span></span> <span data-ttu-id="19212-371">Правила NSG можно применять либо hello входящего и исходящего направления (с точки зрения hello hello подсети).</span><span class="sxs-lookup"><span data-stu-id="19212-371">NSG rules can apply in either hello inbound or outbound direction (from hello perspective of hello subnet).</span></span>
>
>

<span data-ttu-id="19212-372">Создаются декларативно, hello следующие правила для входящего трафика:</span><span class="sxs-lookup"><span data-stu-id="19212-372">Declaratively, hello following rules are being built for inbound traffic:</span></span>

1. <span data-ttu-id="19212-373">Внутренний трафик DNS (порт 53) разрешается.</span><span class="sxs-lookup"><span data-stu-id="19212-373">Internal DNS traffic (port 53) is allowed.</span></span>
2. <span data-ttu-id="19212-374">RDP (порт 3389) из Интернета hello tooany виртуальной машины-трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-374">RDP traffic (port 3389) from hello Internet tooany Virtual Machine is allowed.</span></span>
3. <span data-ttu-id="19212-375">Может быть любой Интернет трафика (все порты) toohello сети виртуальное устройство (брандмауэром).</span><span class="sxs-lookup"><span data-stu-id="19212-375">Any Internet traffic (all ports) toohello network virtual appliance (firewall) is allowed.</span></span>
4. <span data-ttu-id="19212-376">Все (все порты) из IIS01 tooAppVM1-трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-376">Any traffic (all ports) from IIS01 tooAppVM1 is allowed.</span></span>
5. <span data-ttu-id="19212-377">Любой трафик (все порты) из hello Internet toohello всей виртуальной сети (оба подсети) запрещен.</span><span class="sxs-lookup"><span data-stu-id="19212-377">Any traffic (all ports) from hello Internet toohello entire virtual network (both subnets) is denied.</span></span>
6. <span data-ttu-id="19212-378">Любой трафик (все порты) из hello интерфейса подсети toohello внутренней подсети запрещен.</span><span class="sxs-lookup"><span data-stu-id="19212-378">Any traffic (all ports) from hello front-end subnet toohello back-end subnet is denied.</span></span>

<span data-ttu-id="19212-379">С подсетью привязанного tooeach эти правила, если HTTP-запросе был входящие данные от toohello брандмауэр hello оба правила 3 (Разрешить) и 5 (запретить) будет применена.</span><span class="sxs-lookup"><span data-stu-id="19212-379">With these rules bound tooeach subnet, if an HTTP request was inbound from hello Internet toohello firewall, both rules 3 (allow) and 5 (deny) would apply.</span></span> <span data-ttu-id="19212-380">Но поскольку правило 3 имеет более высокий приоритет, то будет применено только оно, а правило 5 не будет использовано.</span><span class="sxs-lookup"><span data-stu-id="19212-380">But because rule 3 has a higher priority, only it would apply, and rule 5 would not come into play.</span></span> <span data-ttu-id="19212-381">Таким образом запрос hello HTTP допустимы toohello брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-381">Thus hello HTTP request would be allowed toohello firewall.</span></span> <span data-ttu-id="19212-382">Если же трафик пытается server hello IIS01 tooreach, даже если он находится в подсети интерфейса hello, правило 5 (запретить) будет применена, и не будет разрешен трафик hello toopass toohello сервера.</span><span class="sxs-lookup"><span data-stu-id="19212-382">If that same traffic was trying tooreach hello IIS01 server, even though it’s on hello front-end subnet, rule 5 (deny) would apply, and hello traffic would not be allowed toopass toohello server.</span></span> <span data-ttu-id="19212-383">Правила 6 (запретить), блоки hello интерфейса подсети из взаимодействии toohello внутренней подсети (за исключением разрешенного трафика в правилах 1 и 4).</span><span class="sxs-lookup"><span data-stu-id="19212-383">Rule 6 (deny) blocks hello front-end subnet from talking toohello back-end subnet (except for allowed traffic in rules 1 and 4).</span></span> <span data-ttu-id="19212-384">Этот набор правил защищает hello внутренней сети, в случае, если злоумышленник взломает hello веб-приложение hello интерфейсной части.</span><span class="sxs-lookup"><span data-stu-id="19212-384">This rule-set protects hello back-end network in case an attacker compromises hello web application on hello front end.</span></span> <span data-ttu-id="19212-385">Hello злоумышленник будет ограничен доступ toohello внутренней «защищенные» сети (только tooresources, предоставляемые на сервере AppVM01 hello).</span><span class="sxs-lookup"><span data-stu-id="19212-385">hello attacker would have limited access toohello back-end “protected” network (only tooresources exposed on hello AppVM01 server).</span></span>

<span data-ttu-id="19212-386">Нет исходящих правило по умолчанию, разрешающее трафик, исходящий toohello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-386">There is a default outbound rule that allows traffic out toohello Internet.</span></span> <span data-ttu-id="19212-387">В этом примере мы разрешаем исходящий трафик и не меняем никаких исходящих правил.</span><span class="sxs-lookup"><span data-stu-id="19212-387">For this example, we’re allowing outbound traffic and not modifying any outbound rules.</span></span> <span data-ttu-id="19212-388">определяемые пользователем маршрутизации требуется toolock трафик в обоих направлениях (см. Пример 3).</span><span class="sxs-lookup"><span data-stu-id="19212-388">toolock down traffic in both directions, user-defined routing is required (see example 3).</span></span>

#### <a name="firewall-rule-description"></a><span data-ttu-id="19212-389">Описание правил брандмауэра</span><span class="sxs-lookup"><span data-stu-id="19212-389">Firewall rule description</span></span>
<span data-ttu-id="19212-390">На брандмауэре hello правила перенаправления должен быть создан.</span><span class="sxs-lookup"><span data-stu-id="19212-390">On hello firewall, forwarding rules should be created.</span></span> <span data-ttu-id="19212-391">Поскольку этот пример только маршруты Интернета трафик входящих toohello брандмауэра и затем toohello веб-сервер, только одно перенаправление преобразование сетевых адресов (NAT) требуется правило.</span><span class="sxs-lookup"><span data-stu-id="19212-391">Since this example only routes Internet traffic in-bound toohello firewall and then toohello web server, only one forwarding network address translation (NAT) rule is needed.</span></span>

<span data-ttu-id="19212-392">Правило пересылки Hello принимает любой входящих исходный адрес, который попадает брандмауэра hello попытки tooreach HTTP (порт 80 или 443 для HTTPS).</span><span class="sxs-lookup"><span data-stu-id="19212-392">hello forwarding rule accepts any inbound source address that hits hello firewall trying tooreach HTTP (port 80 or 443 for HTTPS).</span></span> <span data-ttu-id="19212-393">Он отправке из локального интерфейса hello брандмауэра, а перенаправляется toohello веб-сервер с IP-адрес 10.0.1.5 hello.</span><span class="sxs-lookup"><span data-stu-id="19212-393">It's sent out of hello firewall’s local interface and redirected toohello web server with hello IP Address of 10.0.1.5.</span></span>

#### <a name="conclusion"></a><span data-ttu-id="19212-394">Заключение</span><span class="sxs-lookup"><span data-stu-id="19212-394">Conclusion</span></span>
<span data-ttu-id="19212-395">Данный пример является относительно простой и понятный способ защиты приложения с брандмауэром и изоляции hello внутренней подсети из входящего трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-395">This example is a relatively straightforward way of protecting your application with a firewall and isolating hello back-end subnet from inbound traffic.</span></span> <span data-ttu-id="19212-396">Дополнительные сведения см. в разделе hello [подробные инструкции по сборке][Example2].</span><span class="sxs-lookup"><span data-stu-id="19212-396">For more information, see hello [detailed build instructions][Example2].</span></span> <span data-ttu-id="19212-397">Эти инструкции включают:</span><span class="sxs-lookup"><span data-stu-id="19212-397">These instructions include:</span></span>

* <span data-ttu-id="19212-398">Как toobuild этого периметра сети с помощью классической сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19212-398">How toobuild this perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="19212-399">Как toobuild в этом примере с помощью шаблона диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-399">How toobuild this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="19212-400">Подробное описание каждой команды группы безопасности сети и каждого правила брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-400">Detailed descriptions of each NSG command and firewall rule.</span></span>
* <span data-ttu-id="19212-401">Подробные сценарии прохождения трафика с демонстрацией разрешений и запретов на каждом уровне.</span><span class="sxs-lookup"><span data-stu-id="19212-401">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>

### <a name="example-3-build-a-perimeter-network-toohelp-protect-networks-with-a-firewall-and-udr-and-nsg"></a><span data-ttu-id="19212-402">Пример 3 построения toohelp сети периметра защитить сеть с помощью брандмауэра и UDR и NSG</span><span class="sxs-lookup"><span data-stu-id="19212-402">Example 3 Build a perimeter network toohelp protect networks with a firewall and UDR and NSG</span></span>
<span data-ttu-id="19212-403">[Резервное начала tooFast](#fast-start) | [подробные инструкции по построению для данного примера][Example3]</span><span class="sxs-lookup"><span data-stu-id="19212-403">[Back tooFast start](#fast-start) | [Detailed build instructions for this example][Example3]</span></span>

<span data-ttu-id="19212-404">[![9]][9]</span><span class="sxs-lookup"><span data-stu-id="19212-404">[![9]][9]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="19212-405">Описание среды</span><span class="sxs-lookup"><span data-stu-id="19212-405">Environment description</span></span>
<span data-ttu-id="19212-406">В этом примере имеется подписка, содержащий hello следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="19212-406">In this example, there is a subscription that contains hello following resources:</span></span>

* <span data-ttu-id="19212-407">одну группу ресурсов.</span><span class="sxs-lookup"><span data-stu-id="19212-407">A single resource group</span></span>
* <span data-ttu-id="19212-408">виртуальную сеть с тремя подсетями (SecNet, FrontEnd и BackEnd);</span><span class="sxs-lookup"><span data-stu-id="19212-408">A virtual network with three subnets: “SecNet”, “FrontEnd”, and “BackEnd”</span></span>
* <span data-ttu-id="19212-409">Устройство виртуальной сети, в данном случае брандмауэра, подключение toohello SecNet подсети</span><span class="sxs-lookup"><span data-stu-id="19212-409">A network virtual appliance, in this case a firewall, connected toohello SecNet subnet</span></span>
* <span data-ttu-id="19212-410">сервер Windows Server, который представляет веб-сервер приложений (IIS01);</span><span class="sxs-lookup"><span data-stu-id="19212-410">A Windows server that represents an application web server (“IIS01”)</span></span>
* <span data-ttu-id="19212-411">два сервера Windows Server, представляющих тыловые серверы приложений (AppVM01, AppVM02);</span><span class="sxs-lookup"><span data-stu-id="19212-411">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
* <span data-ttu-id="19212-412">сервер Windows Server, который представляет DNS-сервер (DNS01).</span><span class="sxs-lookup"><span data-stu-id="19212-412">A Windows server that represents a DNS server (“DNS01”)</span></span>

<span data-ttu-id="19212-413">Для шаблона диспетчера ресурсов Azure и сценарии, в разделе hello [подробные инструкции по сборке][Example3].</span><span class="sxs-lookup"><span data-stu-id="19212-413">For scripts and an Azure Resource Manager template, see hello [detailed build instructions][Example3].</span></span>

#### <a name="udr-description"></a><span data-ttu-id="19212-414">Описание определяемого пользователем маршрута</span><span class="sxs-lookup"><span data-stu-id="19212-414">UDR description</span></span>
<span data-ttu-id="19212-415">По умолчанию hello следующие маршруты системы определяются как:</span><span class="sxs-lookup"><span data-stu-id="19212-415">By default, hello following system routes are defined as:</span></span>

        Effective routes :
         Address Prefix    Next hop type    Next hop IP address Status   Source     
         --------------    -------------    ------------------- ------   ------     
         {10.0.0.0/16}     VNETLocal                            Active   Default    
         {0.0.0.0/0}       Internet                             Active   Default    
         {10.0.0.0/8}      Null                                 Active   Default    
         {100.64.0.0/10}   Null                                 Active   Default    
         {172.16.0.0/12}   Null                                 Active   Default    
         {192.168.0.0/16}  Null                                 Active   Default

<span data-ttu-id="19212-416">Hello VNETLocal всегда имеет один или несколько префиксов определенных адресов, составляющих hello виртуальной сети для этой конкретной сети (то есть он меняется из сети toovirtual виртуальной сети, в зависимости от способа определения каждой конкретной виртуальной сети).</span><span class="sxs-lookup"><span data-stu-id="19212-416">hello VNETLocal is always one or more defined address prefixes that make up hello virtual network for that specific network (that is, it changes from virtual network toovirtual network, depending on how each specific virtual network is defined).</span></span> <span data-ttu-id="19212-417">Оставшиеся системы маршруты Hello являются статическими, а также по умолчанию, как указано в таблице hello.</span><span class="sxs-lookup"><span data-stu-id="19212-417">hello remaining system routes are static and default as indicated in hello table.</span></span>

<span data-ttu-id="19212-418">В этом примере две таблицы маршрутизации создаются, по одной для внешнего и внутреннего интерфейса подсети hello.</span><span class="sxs-lookup"><span data-stu-id="19212-418">In this example, two routing tables are created, one each for hello front-end and back-end subnets.</span></span> <span data-ttu-id="19212-419">Каждая таблица загружается статические маршруты, соответствующие заданному подсети hello.</span><span class="sxs-lookup"><span data-stu-id="19212-419">Each table is loaded with static routes appropriate for hello given subnet.</span></span> <span data-ttu-id="19212-420">В этом примере каждая таблица имеет три маршруты, которые будут направлять весь трафик (0.0.0.0/0) через брандмауэр hello (следующего прыжка = виртуального устройства IP-адрес):</span><span class="sxs-lookup"><span data-stu-id="19212-420">In this example, each table has three routes that direct all traffic (0.0.0.0/0) through hello firewall (Next hop = Virtual Appliance IP address):</span></span>

1. <span data-ttu-id="19212-421">Локальной подсети трафика со следующего прыжка определен tooallow локальной подсети трафика toobypass hello брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-421">Local subnet traffic with no Next Hop defined tooallow local subnet traffic toobypass hello firewall.</span></span>
2. <span data-ttu-id="19212-422">Для трафика виртуальной сети значением следующего прыжка установлен адрес брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-422">Virtual network traffic with a Next Hop defined as firewall.</span></span> <span data-ttu-id="19212-423">Следующий прыжок переопределяет правило по умолчанию hello, которое позволяет tooroute трафика виртуальной локальной сети напрямую.</span><span class="sxs-lookup"><span data-stu-id="19212-423">This next hop overrides hello default rule that allows local virtual network traffic tooroute directly.</span></span>
3. <span data-ttu-id="19212-424">Все остальные трафика (0-0) с помощью следующего прыжка определен как hello брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-424">All remaining traffic (0/0) with a Next Hop defined as hello firewall.</span></span>

> [!TIP]
> <span data-ttu-id="19212-425">Отсутствия в hello связи локальной подсети разрывов UDR запись hello локальной подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-425">Not having hello local subnet entry in hello UDR breaks local subnet communications.</span></span>
>
> * <span data-ttu-id="19212-426">В нашем примере указывающий tooVNETLocal 10.0.1.0/24 важно!</span><span class="sxs-lookup"><span data-stu-id="19212-426">In our example, 10.0.1.0/24 pointing tooVNETLocal is critical!</span></span> <span data-ttu-id="19212-427">Без него оставляя hello процессом веб-сервера (10.0.1.4) tooanother локального сервера (например) 10.0.1.25 пакетов завершится ошибкой, как они будут отправлены toohello Уязвимости.</span><span class="sxs-lookup"><span data-stu-id="19212-427">Without it, packet leaving hello Web Server (10.0.1.4) destined tooanother local server (for example) 10.0.1.25 will fail as they will be sent toohello NVA.</span></span> <span data-ttu-id="19212-428">Hello Уязвимости отправит его toohello подсети и подсети hello будет отправку toohello Уязвимости в бесконечный цикл.</span><span class="sxs-lookup"><span data-stu-id="19212-428">hello NVA will send it toohello subnet, and hello subnet will resend it toohello NVA in an infinite loop.</span></span>
> * <span data-ttu-id="19212-429">вероятность Hello зацикливание маршрутизации обычно выше, на устройствах с несколькими сетевыми адаптерами, подключенных tooseparate подсети, которые чаще всего традиционный, локальных устройств.</span><span class="sxs-lookup"><span data-stu-id="19212-429">hello chances of a routing loop are typically higher on appliances with multiple NICs that are connected tooseparate subnets, which is often of traditional, on-premises appliances.</span></span>
>
>

<span data-ttu-id="19212-430">После создания таблицы маршрутизации hello, они должны быть привязанного tootheir подсетей.</span><span class="sxs-lookup"><span data-stu-id="19212-430">Once hello routing tables are created, they must be bound tootheir subnets.</span></span> <span data-ttu-id="19212-431">Здравствуйте интерфейса подсети, таблицы маршрутизации, после ее создания и привязать toohello подсети, выглядит следующим образом эти выходные данные:</span><span class="sxs-lookup"><span data-stu-id="19212-431">hello front-end subnet routing table, once created and bound toohello subnet, would look like this output:</span></span>

        Effective routes :
         Address Prefix    Next hop type    Next hop IP address Status   Source     
         --------------    -------------    ------------------- ------   ------     
         {10.0.1.0/24}     VNETLocal                            Active
         {10.0.0.0/16}     VirtualAppliance 10.0.0.4            Active    
         {0.0.0.0/0}       VirtualAppliance 10.0.0.4            Active

> [!NOTE]
> <span data-ttu-id="19212-432">UDR теперь может быть применен toohello подсеть шлюза, на какие hello ExpressRoute подключен канала.</span><span class="sxs-lookup"><span data-stu-id="19212-432">UDR can now be applied toohello gateway subnet on which hello ExpressRoute circuit is connected.</span></span>
>
> <span data-ttu-id="19212-433">Примеры как tooenable вашей локальной сети с ExpressRoute или сайт сайт сети приведены в примерах, 3 и 4.</span><span class="sxs-lookup"><span data-stu-id="19212-433">Examples of how tooenable your perimeter network with ExpressRoute or site-to-site networking are shown in examples 3 and 4.</span></span>
>
>

#### <a name="ip-forwarding-description"></a><span data-ttu-id="19212-434">Описание IP-пересылки</span><span class="sxs-lookup"><span data-stu-id="19212-434">IP Forwarding description</span></span>
<span data-ttu-id="19212-435">IP-пересылка является tooUDR сопутствующих компонентов.</span><span class="sxs-lookup"><span data-stu-id="19212-435">IP Forwarding is a companion feature tooUDR.</span></span> <span data-ttu-id="19212-436">IP-пересылка — это параметр на виртуального устройства, который позволит tooreceive трафик не toohello устройства, а затем пересылаться tooits конечного назначения этого трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-436">IP Forwarding is a setting on a virtual appliance that allows it tooreceive traffic not specifically addressed toohello appliance, and then forward that traffic tooits ultimate destination.</span></span>

<span data-ttu-id="19212-437">Например если сервер DNS01 toohello запрос становится AppVM01, UDR бы маршрутизацию этот брандмауэр toohello трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-437">For example, if AppVM01 makes a request toohello DNS01 server, UDR would route this traffic toohello firewall.</span></span> <span data-ttu-id="19212-438">С IP-пересылка включена принимаемое hello устройства (10.0.0.4) и пересылаются конечного назначения tooits (10.0.2.4) hello трафика для назначения DNS01 hello (10.0.2.4).</span><span class="sxs-lookup"><span data-stu-id="19212-438">With IP Forwarding enabled, hello traffic for hello DNS01 destination (10.0.2.4) is accepted by hello appliance (10.0.0.4) and then forwarded tooits ultimate destination (10.0.2.4).</span></span> <span data-ttu-id="19212-439">Без IP-пересылка включена на брандмауэре hello трафик будет не будут приниматься с устройством hello даже при таблицы маршрутов hello брандмауэра hello как hello следующего прыжка.</span><span class="sxs-lookup"><span data-stu-id="19212-439">Without IP Forwarding enabled on hello firewall, traffic would not be accepted by hello appliance even though hello route table has hello firewall as hello next hop.</span></span> <span data-ttu-id="19212-440">toouse виртуального устройства, это критическое tooremember tooenable IP пересылки вместе с UDR.</span><span class="sxs-lookup"><span data-stu-id="19212-440">toouse a virtual appliance, it’s critical tooremember tooenable IP Forwarding along with UDR.</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="19212-441">Описание группы безопасности сети</span><span class="sxs-lookup"><span data-stu-id="19212-441">NSG description</span></span>
<span data-ttu-id="19212-442">В этом примере создается группа безопасности сети, после чего в нее загружается одно правило.</span><span class="sxs-lookup"><span data-stu-id="19212-442">In this example, an NSG group is built and then loaded with a single rule.</span></span> <span data-ttu-id="19212-443">Эта группа будет привязан только toohello внешнего и внутреннего интерфейса подсети (не hello SecNet).</span><span class="sxs-lookup"><span data-stu-id="19212-443">This group is then bound only toohello front-end and back-end subnets (not hello SecNet).</span></span> <span data-ttu-id="19212-444">Декларативно, строится hello следующие правила:</span><span class="sxs-lookup"><span data-stu-id="19212-444">Declaratively hello following rule is being built:</span></span>

* <span data-ttu-id="19212-445">Любой трафик (все порты) из hello Internet toohello всей виртуальной сети (все подсети) запрещен.</span><span class="sxs-lookup"><span data-stu-id="19212-445">Any traffic (all ports) from hello Internet toohello entire virtual network (all subnets) is denied.</span></span>

<span data-ttu-id="19212-446">В этом примере используются группы безопасности сети, но его основной целью является создание дополнительного уровня защиты от неправильной настройки вручную.</span><span class="sxs-lookup"><span data-stu-id="19212-446">Although NSGs are used in this example, its main purpose is as a secondary layer of defense against manual misconfiguration.</span></span> <span data-ttu-id="19212-447">Hello цель — tooblock весь входящий трафик от tooeither Интернет hello hello переднего плана или внутренней подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-447">hello goal is tooblock all inbound traffic from hello Internet tooeither hello front-end or back-end subnets.</span></span> <span data-ttu-id="19212-448">Только поток трафика через брандмауэр toohello подсети SecNet hello (а затем, при необходимости в toohello переднего плана или внутренней подсетях).</span><span class="sxs-lookup"><span data-stu-id="19212-448">Traffic should only flow through hello SecNet subnet toohello firewall (and then, if appropriate, on toohello front-end or back-end subnets).</span></span> <span data-ttu-id="19212-449">Кроме того с правилами UDR hello в месте, любой трафик, который сделать hello переднего плана или внутренней подсети будет направляться out toohello брандмауэра (спасибо tooUDR).</span><span class="sxs-lookup"><span data-stu-id="19212-449">Plus, with hello UDR rules in place, any traffic that did make it into hello front-end or back-end subnets would be directed out toohello firewall (thanks tooUDR).</span></span> <span data-ttu-id="19212-450">брандмауэр Hello будут отображаться этот трафик как поток асимметричного и уменьшится hello исходящего трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-450">hello firewall would see this traffic as an asymmetric flow and would drop hello outbound traffic.</span></span> <span data-ttu-id="19212-451">Таким образом, существует три уровня безопасности, защищая подсетей hello.</span><span class="sxs-lookup"><span data-stu-id="19212-451">Thus there are three layers of security protecting hello subnets:</span></span>

* <span data-ttu-id="19212-452">На сетевых адаптерах подсети FrontEnd или BackEnd нет общедоступных IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="19212-452">No Public IP addresses on any FrontEnd or BackEnd NICs.</span></span>
* <span data-ttu-id="19212-453">Запрет трафика из Интернета hello Nsg.</span><span class="sxs-lookup"><span data-stu-id="19212-453">NSGs denying traffic from hello Internet.</span></span>
* <span data-ttu-id="19212-454">Hello брандмауэра удаление асимметричного трафика.</span><span class="sxs-lookup"><span data-stu-id="19212-454">hello firewall dropping asymmetric traffic.</span></span>

<span data-ttu-id="19212-455">Один интересный момент относительно hello NSG в этом примере является то, что он содержит только одно правило, которое является toodeny Интернет трафика toohello всей виртуальной сети, включая подсеть безопасности hello.</span><span class="sxs-lookup"><span data-stu-id="19212-455">One interesting point regarding hello NSG in this example is that it contains only one rule, which is toodeny Internet traffic toohello entire virtual network, including hello Security subnet.</span></span> <span data-ttu-id="19212-456">Тем не менее поскольку hello NSG — только привязан toohello переднего плана и внутренней подсетях, hello правило не обрабатывается на трафик входящих подключений подсети toohello безопасности.</span><span class="sxs-lookup"><span data-stu-id="19212-456">However, since hello NSG is only bound toohello front-end and back-end subnets, hello rule isn’t processed on traffic inbound toohello Security subnet.</span></span> <span data-ttu-id="19212-457">В результате трафик проходит toohello безопасности подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-457">As a result, traffic flows toohello Security subnet.</span></span>

#### <a name="firewall-rules"></a><span data-ttu-id="19212-458">Правила файрволла</span><span class="sxs-lookup"><span data-stu-id="19212-458">Firewall rules</span></span>
<span data-ttu-id="19212-459">На брандмауэре hello правила перенаправления должен быть создан.</span><span class="sxs-lookup"><span data-stu-id="19212-459">On hello firewall, forwarding rules should be created.</span></span> <span data-ttu-id="19212-460">Поскольку hello брандмауэр блокирует или пересылки все входящие, Исходящие и трафика внутри виртуальной сети, требуется много правил брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-460">Since hello firewall is blocking or forwarding all inbound, outbound, and intra-virtual network traffic, many firewall rules are needed.</span></span> <span data-ttu-id="19212-461">Кроме того, весь входящий трафик достигнет hello службы безопасности общедоступный IP-адрес (по различным портам), toobe обрабатываемых hello брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-461">Also, all inbound traffic hits hello Security Service public IP address (on different ports), toobe processed by hello firewall.</span></span> <span data-ttu-id="19212-462">Лучший способ — toodiagram hello логических потоков перед настройкой подсети hello и правила брандмауэра, tooavoid переработать позже.</span><span class="sxs-lookup"><span data-stu-id="19212-462">A best practice is toodiagram hello logical flows before setting up hello subnets and firewall rules, tooavoid rework later.</span></span> <span data-ttu-id="19212-463">Hello на этом рисунке — это логическое представление hello правила брандмауэра для этого примера:</span><span class="sxs-lookup"><span data-stu-id="19212-463">hello following figure is a logical view of hello firewall rules for this example:</span></span>

<span data-ttu-id="19212-464">![10]</span><span class="sxs-lookup"><span data-stu-id="19212-464">![10]</span></span>

> [!NOTE]
> <span data-ttu-id="19212-465">На основании hello используется виртуальное устройство в сети, порты управления hello различаются.</span><span class="sxs-lookup"><span data-stu-id="19212-465">Based on hello Network Virtual Appliance used, hello management ports vary.</span></span> <span data-ttu-id="19212-466">В этом примере брандмауэр Barracuda NextGen Firewall использует порты 22, 801 и 807.</span><span class="sxs-lookup"><span data-stu-id="19212-466">In this example, a Barracuda NextGen Firewall is referenced, which uses ports 22, 801, and 807.</span></span> <span data-ttu-id="19212-467">Обратитесь к hello устройства поставщика документации toofind hello точное порты, используемые для управления hello устройства, используемого.</span><span class="sxs-lookup"><span data-stu-id="19212-467">Consult hello appliance vendor documentation toofind hello exact ports used for management of hello device being used.</span></span>
>
>

#### <a name="firewall-rules-description"></a><span data-ttu-id="19212-468">Описание правила брандмауэра</span><span class="sxs-lookup"><span data-stu-id="19212-468">Firewall rules description</span></span>
<span data-ttu-id="19212-469">В предыдущих логическая схема hello hello безопасности подсети не показаны, поскольку брандмауэр hello — hello только ресурс в этой подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-469">In hello preceding logical diagram, hello security subnet is not shown because hello firewall is hello only resource on that subnet.</span></span> <span data-ttu-id="19212-470">Hello диаграмме показан правила брандмауэра hello и как они логически разрешить или запретить трафик, поступающий, не hello фактический перенаправленное путь.</span><span class="sxs-lookup"><span data-stu-id="19212-470">hello diagram is showing hello firewall rules and how they logically allow or deny traffic flows, not hello actual routed path.</span></span> <span data-ttu-id="19212-471">Кроме того, hello внешними портами, выбранный для hello трафик RDP, выше диапазоны портов (8014 — 8026) и были выбранного tooloosely соответствовать hello последние два октета hello локальный IP-адрес для упрощения восприятия (например, адрес локального сервера 10.0.1.4 связан с помощью внешнего порта 8014).</span><span class="sxs-lookup"><span data-stu-id="19212-471">Also, hello external ports selected for hello RDP traffic are higher ranged ports (8014 – 8026) and were selected tooloosely align with hello last two octets of hello local IP address for easier readability (for example, local server address 10.0.1.4 is associated with external port 8014).</span></span> <span data-ttu-id="19212-472">Тем не менее можно использовать любые неконфликтующие порты более высокого диапазона.</span><span class="sxs-lookup"><span data-stu-id="19212-472">Any higher non-conflicting ports, however, could be used.</span></span>

<span data-ttu-id="19212-473">В этом примере нам нужно семь типов правил:</span><span class="sxs-lookup"><span data-stu-id="19212-473">For this example, we need seven types of rules:</span></span>

* <span data-ttu-id="19212-474">Внешние правила (для входящего трафика).</span><span class="sxs-lookup"><span data-stu-id="19212-474">External rules (for inbound traffic):</span></span>
  1. <span data-ttu-id="19212-475">Правило брандмауэра управления: правила перенаправления это приложение позволяет toopass трафика порты управления toohello hello сети виртуальных устройств.</span><span class="sxs-lookup"><span data-stu-id="19212-475">Firewall management rule: This App Redirect rule allows traffic toopass toohello management ports of hello network virtual appliance.</span></span>
  2. <span data-ttu-id="19212-476">Правила протокола удаленного рабочего СТОЛА (для каждого сервера Windows): эти четыре правила (по одному для каждого сервера) позволяет осуществлять управление hello отдельных серверах с помощью протокола удаленного рабочего СТОЛА.</span><span class="sxs-lookup"><span data-stu-id="19212-476">RDP rules (for each Windows server): These four rules (one for each server) allow management of hello individual servers via RDP.</span></span> <span data-ttu-id="19212-477">также будет сворачиваться Hello четыре правила протокола удаленного рабочего СТОЛА в одно правило, в зависимости от возможностей hello hello сети виртуальной машины используется.</span><span class="sxs-lookup"><span data-stu-id="19212-477">hello four RDP rules could also be collapsed into one rule, depending on hello capabilities of hello network virtual appliance being used.</span></span>
  3. <span data-ttu-id="19212-478">Применение правил трафика: два этих правил, hello сначала для hello интерфейсный веб-трафика и hello второй для трафика внутренней hello (например, веб-сервера toodata уровня).</span><span class="sxs-lookup"><span data-stu-id="19212-478">Application traffic rules: There are two of these rules, hello first for hello front-end web traffic, and hello second for hello back-end traffic (for example, web server toodata tier).</span></span> <span data-ttu-id="19212-479">Конфигурация Hello эти правила зависит от того, архитектура сети hello (где располагаются серверов) и трафик, поступающий (hello какие направление трафик проходит и порты, используемые).</span><span class="sxs-lookup"><span data-stu-id="19212-479">hello configuration of these rules depends on hello network architecture (where your servers are placed) and traffic flows (which direction hello traffic flows, and which ports are used).</span></span>
     * <span data-ttu-id="19212-480">Первое правило Hello позволяет hello hello фактического приложения трафика tooreach сервера приложений.</span><span class="sxs-lookup"><span data-stu-id="19212-480">hello first rule allows hello actual application traffic tooreach hello application server.</span></span> <span data-ttu-id="19212-481">Хотя hello другие правила разрешают передачу для управления и обеспечения безопасности, правила трафика приложения заданы, что разрешить внешние tooaccess пользователям или службам приложения hello.</span><span class="sxs-lookup"><span data-stu-id="19212-481">While hello other rules allow for security and management, application traffic rules are what allow external users or services tooaccess hello applications.</span></span> <span data-ttu-id="19212-482">В этом примере используется один веб-сервер с портом 80.</span><span class="sxs-lookup"><span data-stu-id="19212-482">For this example, there is a single web server on port 80.</span></span> <span data-ttu-id="19212-483">Таким образом одно приложение правило брандмауэра перенаправляет входящий трафик toohello внешний IP-адрес, toohello web внутренний IP-адрес сервера.</span><span class="sxs-lookup"><span data-stu-id="19212-483">Thus a single firewall application rule redirects inbound traffic toohello external IP, toohello web servers internal IP address.</span></span> <span data-ttu-id="19212-484">Hello перенаправление трафика сеанса будет преобразован через NAT toohello внутреннего сервера.</span><span class="sxs-lookup"><span data-stu-id="19212-484">hello redirected traffic session would be translated via NAT toohello internal server.</span></span>
     * <span data-ttu-id="19212-485">Второе правило Hello является hello правило серверной части tooallow hello веб-сервера tootalk toohello AppVM01 сервера (но не AppVM02) через любой порт.</span><span class="sxs-lookup"><span data-stu-id="19212-485">hello second rule is hello back-end rule tooallow hello web server tootalk toohello AppVM01 server (but not AppVM02) via any port.</span></span>
* <span data-ttu-id="19212-486">Внутренние правила (для трафика внутри виртуальной сети)</span><span class="sxs-lookup"><span data-stu-id="19212-486">Internal rules (for intra-virtual network traffic)</span></span>
  1. <span data-ttu-id="19212-487">Правило исходящего tooInternet: это правило разрешает трафик с какой-либо сети toopass toohello выбранной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-487">Outbound tooInternet rule: This rule allows traffic from any network toopass toohello selected networks.</span></span> <span data-ttu-id="19212-488">Это правило обычно является правилом по умолчанию уже на брандмауэре hello, но в отключенном состоянии.</span><span class="sxs-lookup"><span data-stu-id="19212-488">This rule is usually a default rule already on hello firewall, but in a disabled state.</span></span> <span data-ttu-id="19212-489">В нашем примере это правило следует активировать.</span><span class="sxs-lookup"><span data-stu-id="19212-489">This rule should be enabled for this example.</span></span>
  2. <span data-ttu-id="19212-490">Правило DNS: это правило разрешает только DNS (порт 53) трафика toopass toohello DNS-сервер.</span><span class="sxs-lookup"><span data-stu-id="19212-490">DNS rule: This rule allows only DNS (port 53) traffic toopass toohello DNS server.</span></span> <span data-ttu-id="19212-491">Большая часть трафика из hello внешнего интерфейса toohello серверной части блокируется для этой среды.</span><span class="sxs-lookup"><span data-stu-id="19212-491">For this environment, most traffic from hello front end toohello back end is blocked.</span></span> <span data-ttu-id="19212-492">В частности, это правило явно разрешает трафик DNS из любой локальной подсети.</span><span class="sxs-lookup"><span data-stu-id="19212-492">This rule specifically allows DNS from any local subnet.</span></span>
  3. <span data-ttu-id="19212-493">Правило toosubnet подсети: это правило является tooallow любой сервер, на сервере tooany tooconnect hello внутренней подсети на интерфейсном подсети hello (но не hello обратного).</span><span class="sxs-lookup"><span data-stu-id="19212-493">Subnet toosubnet rule: This rule is tooallow any server on hello back-end subnet tooconnect tooany server on hello front-end subnet (but not hello reverse).</span></span>
* <span data-ttu-id="19212-494">Резервный правило (для трафика, который не соответствует любой из предыдущих hello):</span><span class="sxs-lookup"><span data-stu-id="19212-494">Fail-safe rule (for traffic that doesn’t meet any of hello previous):</span></span>
  1. <span data-ttu-id="19212-495">Запретить все правила трафика: это правило deny всегда должны содержать hello окончательного правило (с точки зрения приоритета), и таким образом в случае поток трафика toomatch любой из предыдущих правил hello он удаляется с помощью этого правила.</span><span class="sxs-lookup"><span data-stu-id="19212-495">Deny all traffic rule: This deny rule should always be hello final rule (in terms of priority), and as such if a traffic flow fails toomatch any of hello preceding rules it is dropped by this rule.</span></span> <span data-ttu-id="19212-496">Это правило по умолчанию обычно уже установлено и активировано.</span><span class="sxs-lookup"><span data-stu-id="19212-496">This rule is a default rule and usually in-place and active.</span></span> <span data-ttu-id="19212-497">Обычно требуется toothis правило, без изменений.</span><span class="sxs-lookup"><span data-stu-id="19212-497">No modifications are usually needed toothis rule.</span></span>

> [!TIP]
> <span data-ttu-id="19212-498">На hello второе приложение трафика правило toosimplify в этом примере разрешено любой порт.</span><span class="sxs-lookup"><span data-stu-id="19212-498">On hello second application traffic rule, toosimplify this example, any port is allowed.</span></span> <span data-ttu-id="19212-499">В реальном сценарии hello наиболее конкретный порт а также диапазоны адресов следует уязвимость hello используется tooreduce данного правила.</span><span class="sxs-lookup"><span data-stu-id="19212-499">In a real scenario, hello most specific port and address ranges should be used tooreduce hello attack surface of this rule.</span></span>
>
>

<span data-ttu-id="19212-500">После того как созданы предыдущими правилами hello, очень важно, разрешен или запрещен при желании tooreview hello приоритета трафика tooensure каждого правила.</span><span class="sxs-lookup"><span data-stu-id="19212-500">Once hello previous rules are created, it’s important tooreview hello priority of each rule tooensure traffic is allowed or denied as desired.</span></span> <span data-ttu-id="19212-501">В этом примере hello правила следуют в порядке приоритета.</span><span class="sxs-lookup"><span data-stu-id="19212-501">For this example, hello rules are in priority order.</span></span>

#### <a name="conclusion"></a><span data-ttu-id="19212-502">Заключение</span><span class="sxs-lookup"><span data-stu-id="19212-502">Conclusion</span></span>
<span data-ttu-id="19212-503">Данный пример является сложнее, но выполнить способ защиты и изоляции сети hello, чем hello предыдущих примерах.</span><span class="sxs-lookup"><span data-stu-id="19212-503">This example is a more complex but complete way of protecting and isolating hello network than hello previous examples.</span></span> <span data-ttu-id="19212-504">(Пример 2 защищает только приложение hello и пример 1 только изолирует подсети).</span><span class="sxs-lookup"><span data-stu-id="19212-504">(Example 2 protects just hello application, and Example 1 just isolates subnets).</span></span> <span data-ttu-id="19212-505">Такая конфигурация обеспечивает мониторинг трафика в обоих направлениях и защищает не только сервера входящей приложения hello, но обеспечивает политика сетевой безопасности для всех серверов в этой сети.</span><span class="sxs-lookup"><span data-stu-id="19212-505">This design allows for monitoring traffic in both directions, and protects not just hello inbound application server but enforces network security policy for all servers on this network.</span></span> <span data-ttu-id="19212-506">Кроме того в зависимости от устройства hello использовать полный трафика аудита и учета может осуществляться.</span><span class="sxs-lookup"><span data-stu-id="19212-506">Also, depending on hello appliance used, full traffic auditing and awareness can be achieved.</span></span> <span data-ttu-id="19212-507">Дополнительные сведения см. в разделе hello [подробные инструкции по сборке][Example3].</span><span class="sxs-lookup"><span data-stu-id="19212-507">For more information, see hello [detailed build instructions][Example3].</span></span> <span data-ttu-id="19212-508">Эти инструкции включают:</span><span class="sxs-lookup"><span data-stu-id="19212-508">These instructions include:</span></span>

* <span data-ttu-id="19212-509">Как toobuild этого примера периметра сети с помощью классической сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19212-509">How toobuild this example perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="19212-510">Как toobuild в этом примере с помощью шаблона диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-510">How toobuild this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="19212-511">Подробное описание каждой команды UDR, NSG и правил брандмауэра.</span><span class="sxs-lookup"><span data-stu-id="19212-511">Detailed descriptions of each UDR, NSG command, and firewall rule.</span></span>
* <span data-ttu-id="19212-512">Подробные сценарии прохождения трафика с демонстрацией разрешений и запретов на каждом уровне.</span><span class="sxs-lookup"><span data-stu-id="19212-512">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>

### <a name="example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn"></a><span data-ttu-id="19212-513">Пример 4. Добавление гибридного подключения типа "сеть — сеть" и виртуального VPN-устройства</span><span class="sxs-lookup"><span data-stu-id="19212-513">Example 4 Add a hybrid connection with a site-to-site, virtual appliance VPN</span></span>
<span data-ttu-id="19212-514">[Резервное начала tooFast](#fast-start) | Подробные инструкции сборки, доступные скоро</span><span class="sxs-lookup"><span data-stu-id="19212-514">[Back tooFast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="19212-515">[![11]][11]</span><span class="sxs-lookup"><span data-stu-id="19212-515">[![11]][11]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="19212-516">Описание среды</span><span class="sxs-lookup"><span data-stu-id="19212-516">Environment description</span></span>
<span data-ttu-id="19212-517">Гибридные сети, с помощью виртуального устройства сети (Уязвимости) могут быть добавлены tooany типов сети периметра hello, описанные в примерах 1, 2 или 3.</span><span class="sxs-lookup"><span data-stu-id="19212-517">Hybrid networking using a network virtual appliance (NVA) can be added tooany of hello perimeter network types described in examples 1, 2, or 3.</span></span>

<span data-ttu-id="19212-518">Как показано на предыдущем рисунке hello, VPN-подключение по hello Интернет (сеть сеть) — используется tooconnect в локальной сети tooan виртуальной сети Azure через оценки уязвимости сети.</span><span class="sxs-lookup"><span data-stu-id="19212-518">As shown in hello previous figure, a VPN connection over hello Internet (site-to-site) is used tooconnect an on-premises network tooan Azure virtual network via an NVA.</span></span>

> [!NOTE]
> <span data-ttu-id="19212-519">При использовании с включенным параметром hello Azure для общедоступного Пиринга ExpressRoute, должны создаваться статических маршрутов.</span><span class="sxs-lookup"><span data-stu-id="19212-519">If you use ExpressRoute with hello Azure Public Peering option enabled, a static route should be created.</span></span> <span data-ttu-id="19212-520">Этот статический маршрут должен отправить toohello уязвимости сети IP-адрес VPN out объединенной корпоративной сети, а не через hello подключение ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="19212-520">This static route should route toohello NVA VPN IP address out your corporate Internet and not via hello ExpressRoute connection.</span></span> <span data-ttu-id="19212-521">Hello NAT на hello параметр открытого Пиринга ExpressRoute Azure может нарушить работу сеанса VPN hello.</span><span class="sxs-lookup"><span data-stu-id="19212-521">hello NAT required on hello ExpressRoute Azure Public Peering option can break hello VPN session.</span></span>
>
>

<span data-ttu-id="19212-522">После оценки уязвимости сети hello hello VPN находится в месте, становится hello централизованного концентратора для всех сетей и подсетей.</span><span class="sxs-lookup"><span data-stu-id="19212-522">Once hello VPN is in place, hello NVA becomes hello central hub for all networks and subnets.</span></span> <span data-ttu-id="19212-523">Hello брандмауэра пересылки правила определяют, какой трафик разрешаются потока, преобразуются через NAT, перенаправляются или удаляются (даже для потока трафика между hello локальной сетью и Azure).</span><span class="sxs-lookup"><span data-stu-id="19212-523">hello firewall forwarding rules determine which traffic flows are allowed, are translated via NAT, are redirected, or are dropped (even for traffic flows between hello on-premises network and Azure).</span></span>

<span data-ttu-id="19212-524">Трафик, поступающий следует использовать осторожно, как они могут быть оптимизированы или понизить этот шаблон проектирования, в зависимости от конкретных hello варианта использования.</span><span class="sxs-lookup"><span data-stu-id="19212-524">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on hello specific use case.</span></span>

<span data-ttu-id="19212-525">С помощью среды hello, созданного в примере 3, а затем добавление гибридного сети сеть сеть VPN-подключения, выводятся hello следующий конструктор:</span><span class="sxs-lookup"><span data-stu-id="19212-525">Using hello environment built in example 3, and then adding a site-to-site VPN hybrid network connection, produces hello following design:</span></span>

<span data-ttu-id="19212-526">[![12]][12]</span><span class="sxs-lookup"><span data-stu-id="19212-526">[![12]][12]</span></span>

<span data-ttu-id="19212-527">Hello локального маршрутизатора или другого сетевого устройства, совместимого с вашей Уязвимости для VPN, будет hello VPN-клиента.</span><span class="sxs-lookup"><span data-stu-id="19212-527">hello on-premises router, or any other network device that is compatible with your NVA for VPN, would be hello VPN client.</span></span> <span data-ttu-id="19212-528">Данное физическое устройство будет отвечать за инициацию и поддержание hello VPN-подключение к уязвимости вашей сети.</span><span class="sxs-lookup"><span data-stu-id="19212-528">This physical device would be responsible for initiating and maintaining hello VPN connection with your NVA.</span></span>

<span data-ttu-id="19212-529">Логически toohello Уязвимости сети hello выглядит четырех отдельных «зоны безопасности» с правилами hello на hello Уязвимости, основной директора hello трафика между эти зоны:</span><span class="sxs-lookup"><span data-stu-id="19212-529">Logically toohello NVA, hello network looks like four separate “security zones” with hello rules on hello NVA being hello primary director of traffic between these zones:</span></span>

<span data-ttu-id="19212-530">![13]</span><span class="sxs-lookup"><span data-stu-id="19212-530">![13]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="19212-531">Заключение</span><span class="sxs-lookup"><span data-stu-id="19212-531">Conclusion</span></span>
<span data-ttu-id="19212-532">Добавление Hello tooan подключение сети гибридного VPN сайт сайт виртуальной сети Azure можно расширить hello локальной сети в Azure в безопасном режиме.</span><span class="sxs-lookup"><span data-stu-id="19212-532">hello addition of a site-to-site VPN hybrid network connection tooan Azure virtual network can extend hello on-premises network into Azure in a secure manner.</span></span> <span data-ttu-id="19212-533">С помощью VPN-подключение, трафик шифруется и направляет через Интернет hello.</span><span class="sxs-lookup"><span data-stu-id="19212-533">In using a VPN connection, your traffic is encrypted and routes via hello Internet.</span></span> <span data-ttu-id="19212-534">Hello Уязвимости в этом примере tooenforce центрального расположения и управление политикой безопасности hello.</span><span class="sxs-lookup"><span data-stu-id="19212-534">hello NVA in this example provides a central location tooenforce and manage hello security policy.</span></span> <span data-ttu-id="19212-535">Дополнительные сведения см. в разделе подробные hello (ожидаемую) инструкции по построению.</span><span class="sxs-lookup"><span data-stu-id="19212-535">For more information, see hello detailed build instructions (forthcoming).</span></span> <span data-ttu-id="19212-536">Эти инструкции включают:</span><span class="sxs-lookup"><span data-stu-id="19212-536">These instructions include:</span></span>

* <span data-ttu-id="19212-537">Как toobuild этого примера периметра сети с помощью сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19212-537">How toobuild this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="19212-538">Как toobuild в этом примере с помощью шаблона диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-538">How toobuild this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="19212-539">Подробные сценарии потоков трафика, демонстрирующие прохождение трафика через эту схему сети.</span><span class="sxs-lookup"><span data-stu-id="19212-539">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

### <a name="example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway"></a><span data-ttu-id="19212-540">Пример 5. Добавление гибридного подключения типа "сеть — сеть" с VPN-шлюзом Azure</span><span class="sxs-lookup"><span data-stu-id="19212-540">Example 5 Add a hybrid connection with a site-to-site, Azure VPN gateway</span></span>
<span data-ttu-id="19212-541">[Резервное начала tooFast](#fast-start) | Подробные инструкции сборки, доступные скоро</span><span class="sxs-lookup"><span data-stu-id="19212-541">[Back tooFast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="19212-542">[![14]][14]</span><span class="sxs-lookup"><span data-stu-id="19212-542">[![14]][14]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="19212-543">Описание среды</span><span class="sxs-lookup"><span data-stu-id="19212-543">Environment description</span></span>
<span data-ttu-id="19212-544">Гибридными сетями через шлюз Azure VPN можно добавить тип сети периметра tooeither, описанный в примерах 1 или 2.</span><span class="sxs-lookup"><span data-stu-id="19212-544">Hybrid networking using an Azure VPN gateway can be added tooeither perimeter network type described in examples 1 or 2.</span></span>

<span data-ttu-id="19212-545">Как показано в предшествующих рисунок hello, VPN-подключение по hello Интернет (сеть сеть) — используется tooconnect в локальной сети tooan виртуальной сети Azure через VPN-шлюз Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-545">As shown in hello preceding figure, a VPN connection over hello Internet (site-to-site) is used tooconnect an on-premises network tooan Azure virtual network via an Azure VPN gateway.</span></span>

> [!NOTE]
> <span data-ttu-id="19212-546">При использовании с включенным параметром hello Azure для общедоступного Пиринга ExpressRoute, должны создаваться статических маршрутов.</span><span class="sxs-lookup"><span data-stu-id="19212-546">If you use ExpressRoute with hello Azure Public Peering option enabled, a static route should be created.</span></span> <span data-ttu-id="19212-547">Этот статический маршрут должен отправить toohello уязвимости сети IP-адрес VPN объединенной корпоративной сети и не с помощью ExpressRoute WAN hello.</span><span class="sxs-lookup"><span data-stu-id="19212-547">This  static route should route toohello NVA VPN IP address out your corporate Internet and not via hello ExpressRoute WAN.</span></span> <span data-ttu-id="19212-548">Hello NAT на hello параметр открытого Пиринга ExpressRoute Azure может нарушить работу сеанса VPN hello.</span><span class="sxs-lookup"><span data-stu-id="19212-548">hello NAT required on hello ExpressRoute Azure Public Peering option can break hello VPN session.</span></span>
>
>

<span data-ttu-id="19212-549">Hello на этом рисунке показано hello две границы сети в этом примере.</span><span class="sxs-lookup"><span data-stu-id="19212-549">hello following figure shows hello two network edges in this example.</span></span> <span data-ttu-id="19212-550">Hello первого края hello Уязвимости и Nsg контроля потока трафика для сетей внутри Azure, а также между Azure и hello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-550">On hello first edge, hello NVA and NSGs control traffic flows for intra-Azure networks and between Azure and hello Internet.</span></span> <span data-ttu-id="19212-551">второй границей Hello является шлюз Azure VPN hello, который между локальной средой и Azure отдельных и изолированной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-551">hello second edge is hello Azure VPN gateway, which is a separate and isolated network edge between on-premises and Azure.</span></span>

<span data-ttu-id="19212-552">Трафик, поступающий следует использовать осторожно, как они могут быть оптимизированы или понизить этот шаблон проектирования, в зависимости от конкретных hello варианта использования.</span><span class="sxs-lookup"><span data-stu-id="19212-552">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on hello specific use case.</span></span>

<span data-ttu-id="19212-553">С помощью среды hello, созданного в примере 1, а затем добавление гибридного сети сеть сеть VPN-подключения, выводятся hello следующий конструктор:</span><span class="sxs-lookup"><span data-stu-id="19212-553">Using hello environment built in example 1, and then adding a site-to-site VPN hybrid network connection, produces hello following design:</span></span>

<span data-ttu-id="19212-554">[![15]][15]</span><span class="sxs-lookup"><span data-stu-id="19212-554">[![15]][15]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="19212-555">Заключение</span><span class="sxs-lookup"><span data-stu-id="19212-555">Conclusion</span></span>
<span data-ttu-id="19212-556">Добавление Hello tooan подключение сети гибридного VPN сайт сайт виртуальной сети Azure можно расширить hello локальной сети в Azure в безопасном режиме.</span><span class="sxs-lookup"><span data-stu-id="19212-556">hello addition of a site-to-site VPN hybrid network connection tooan Azure virtual network can extend hello on-premises network into Azure in a secure manner.</span></span> <span data-ttu-id="19212-557">Использование собственного шлюза Azure VPN hello, трафика зашифрованный с помощью IPSec и направляет через Интернет hello.</span><span class="sxs-lookup"><span data-stu-id="19212-557">Using hello native Azure VPN gateway, your traffic is IPSec encrypted and routes via hello Internet.</span></span> <span data-ttu-id="19212-558">Кроме того использование hello VPN-шлюз Azure обеспечивает экономичное параметр, (нет дополнительная лицензия затрат с помощью сторонних NVAs).</span><span class="sxs-lookup"><span data-stu-id="19212-558">Also, using hello Azure VPN gateway can provide a lower-cost option (no additional licensing cost as with third-party NVAs).</span></span> <span data-ttu-id="19212-559">Для примера 1, в котором не используются виртуальные сетевые устройства, этот вариант будет самым экономичным.</span><span class="sxs-lookup"><span data-stu-id="19212-559">This option is most economical in example 1, where no NVA is used.</span></span> <span data-ttu-id="19212-560">Дополнительные сведения см. в разделе подробные hello (ожидаемую) инструкции по построению.</span><span class="sxs-lookup"><span data-stu-id="19212-560">For more information, see hello detailed build instructions (forthcoming).</span></span> <span data-ttu-id="19212-561">Эти инструкции включают:</span><span class="sxs-lookup"><span data-stu-id="19212-561">These instructions include:</span></span>

* <span data-ttu-id="19212-562">Как toobuild этого примера периметра сети с помощью сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19212-562">How toobuild this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="19212-563">Как toobuild в этом примере с помощью шаблона диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-563">How toobuild this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="19212-564">Подробные сценарии потоков трафика, демонстрирующие прохождение трафика через эту схему сети.</span><span class="sxs-lookup"><span data-stu-id="19212-564">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

### <a name="example-6-add-a-hybrid-connection-with-expressroute"></a><span data-ttu-id="19212-565">Пример 6. Добавление гибридного подключения с использованием ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="19212-565">Example 6 Add a hybrid connection with ExpressRoute</span></span>
<span data-ttu-id="19212-566">[Резервное начала tooFast](#fast-start) | Подробные инструкции сборки, доступные скоро</span><span class="sxs-lookup"><span data-stu-id="19212-566">[Back tooFast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="19212-567">[![16]][16]</span><span class="sxs-lookup"><span data-stu-id="19212-567">[![16]][16]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="19212-568">Описание среды</span><span class="sxs-lookup"><span data-stu-id="19212-568">Environment description</span></span>
<span data-ttu-id="19212-569">Гибридные сети, с помощью ExpressRoute для частного пиринга подключения может быть добавлен тип сети периметра tooeither, описанный в примерах 1 или 2.</span><span class="sxs-lookup"><span data-stu-id="19212-569">Hybrid networking using an ExpressRoute private peering connection can be added tooeither perimeter network type described in examples 1 or 2.</span></span>

<span data-ttu-id="19212-570">Как показано в предшествующих рисунок hello частного пиринга ExpressRoute предоставляет прямое соединение между локальной сетью и hello виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-570">As shown in hello preceding figure, ExpressRoute private peering provides a direct connection between your on-premises network and hello Azure virtual network.</span></span> <span data-ttu-id="19212-571">Трафик изменится только сети поставщика услуг hello и сеть Microsoft Azure hello, никогда не касаясь hello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-571">Traffic transits only hello service provider network and hello Microsoft Azure network, never touching hello Internet.</span></span>

> [!TIP]
> <span data-ttu-id="19212-572">С помощью ExpressRoute отслеживает корпоративной сетевой трафик off hello Интернета.</span><span class="sxs-lookup"><span data-stu-id="19212-572">Using ExpressRoute keeps corporate network traffic off hello Internet.</span></span> <span data-ttu-id="19212-573">Это также позволяет использовать соглашения об уровне обслуживания поставщика службы ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="19212-573">It also allows for service level agreements from your ExpressRoute provider.</span></span> <span data-ttu-id="19212-574">Hello шлюза Azure можно передать вверх too10 Гбит/с с ExpressRoute, тогда как с VPN сайтами, максимальная пропускная способность шлюза Azure hello — 200 Мбит/с.</span><span class="sxs-lookup"><span data-stu-id="19212-574">hello Azure Gateway can pass up too10 Gbps with ExpressRoute, whereas with site-to-site VPNs, hello Azure Gateway maximum throughput is 200 Mbps.</span></span>
>
>

<span data-ttu-id="19212-575">По результатам hello, следующая схема, с помощью этого параметра hello среды теперь имеет два границы сети.</span><span class="sxs-lookup"><span data-stu-id="19212-575">As seen in hello following diagram, with this option hello environment now has two network edges.</span></span> <span data-ttu-id="19212-576">Hello Уязвимости и NSG управления трафик, поступающий внутри Azure сетей, а также между Azure и hello Интернета, пока шлюз hello между локальной средой и Azure отдельных и изолированной сети.</span><span class="sxs-lookup"><span data-stu-id="19212-576">hello NVA and NSG control traffic flows for intra-Azure networks and between Azure and hello Internet, while hello gateway is a separate and isolated network edge between on-premises and Azure.</span></span>

<span data-ttu-id="19212-577">Трафик, поступающий следует использовать осторожно, как они могут быть оптимизированы или понизить этот шаблон проектирования, в зависимости от конкретных hello варианта использования.</span><span class="sxs-lookup"><span data-stu-id="19212-577">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on hello specific use case.</span></span>

<span data-ttu-id="19212-578">С помощью среды hello, созданного в примере 1, а затем добавление гибридного сетевого подключения ExpressRoute, выводятся hello следующий конструктор:</span><span class="sxs-lookup"><span data-stu-id="19212-578">Using hello environment built in example 1, and then adding an ExpressRoute hybrid network connection, produces hello following design:</span></span>

<span data-ttu-id="19212-579">[![17]][17]</span><span class="sxs-lookup"><span data-stu-id="19212-579">[![17]][17]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="19212-580">Заключение</span><span class="sxs-lookup"><span data-stu-id="19212-580">Conclusion</span></span>
<span data-ttu-id="19212-581">Добавление Hello Пиринг ExpressRoute частного сетевого подключения может быть расширен hello локальной сети Azure безопасного нижней задержки, выше выполнение способом.</span><span class="sxs-lookup"><span data-stu-id="19212-581">hello addition of an ExpressRoute Private Peering network connection can extend hello on-premises network into Azure in a secure, lower latency, higher performing manner.</span></span> <span data-ttu-id="19212-582">Кроме того с помощью hello собственного шлюза Azure, как показано в примере, позволяет экономичные (дополнительные лицензии с помощью сторонних NVAs).</span><span class="sxs-lookup"><span data-stu-id="19212-582">Also, using hello native Azure Gateway, as in this example, provides a lower-cost option (no additional licensing as with third-party NVAs).</span></span> <span data-ttu-id="19212-583">Дополнительные сведения см. в разделе подробные hello (ожидаемую) инструкции по построению.</span><span class="sxs-lookup"><span data-stu-id="19212-583">For more information, see hello detailed build instructions (forthcoming).</span></span> <span data-ttu-id="19212-584">Эти инструкции включают:</span><span class="sxs-lookup"><span data-stu-id="19212-584">These instructions include:</span></span>

* <span data-ttu-id="19212-585">Как toobuild этого примера периметра сети с помощью сценариев PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19212-585">How toobuild this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="19212-586">Как toobuild в этом примере с помощью шаблона диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="19212-586">How toobuild this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="19212-587">Подробные сценарии потоков трафика, демонстрирующие прохождение трафика через эту схему сети.</span><span class="sxs-lookup"><span data-stu-id="19212-587">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

## <a name="references"></a><span data-ttu-id="19212-588">Ссылки</span><span class="sxs-lookup"><span data-stu-id="19212-588">References</span></span>
### <a name="helpful-websites-and-documentation"></a><span data-ttu-id="19212-589">Полезные веб-сайты и документация</span><span class="sxs-lookup"><span data-stu-id="19212-589">Helpful websites and documentation</span></span>
* <span data-ttu-id="19212-590">Доступ к Azure с Azure Resource Manager:</span><span class="sxs-lookup"><span data-stu-id="19212-590">Access Azure with Azure Resource Manager:</span></span>
* <span data-ttu-id="19212-591">Доступ к Azure с помощью PowerShell: [https://docs.microsoft.com/powershell/azureps-cmdlets-docs/](/powershell/azure/overview)</span><span class="sxs-lookup"><span data-stu-id="19212-591">Accessing Azure with PowerShell: [https://docs.microsoft.com/powershell/azureps-cmdlets-docs/](/powershell/azure/overview)</span></span>
* <span data-ttu-id="19212-592">Документация по виртуальным сетям: [https://docs.microsoft.com/azure/virtual-network/](https://docs.microsoft.com/azure/virtual-network/)</span><span class="sxs-lookup"><span data-stu-id="19212-592">Virtual networking documentation: [https://docs.microsoft.com/azure/virtual-network/](https://docs.microsoft.com/azure/virtual-network/)</span></span>
* <span data-ttu-id="19212-593">Документация по группам безопасности сети: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg](virtual-network/virtual-networks-nsg.md)</span><span class="sxs-lookup"><span data-stu-id="19212-593">Network security group documentation: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg](virtual-network/virtual-networks-nsg.md)</span></span>
* <span data-ttu-id="19212-594">Документация по определяемым пользователем маршрутам: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-udr-overview](virtual-network/virtual-networks-udr-overview.md)</span><span class="sxs-lookup"><span data-stu-id="19212-594">User-defined routing documentation: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-udr-overview](virtual-network/virtual-networks-udr-overview.md)</span></span>
* <span data-ttu-id="19212-595">Виртуальные шлюзы Azure: [https://docs.microsoft.com/azure/vpn-gateway/](https://docs.microsoft.com/azure/vpn-gateway/)</span><span class="sxs-lookup"><span data-stu-id="19212-595">Azure virtual gateways: [https://docs.microsoft.com/azure/vpn-gateway/](https://docs.microsoft.com/azure/vpn-gateway/)</span></span>
* <span data-ttu-id="19212-596">VPN типа "сеть — сеть": [https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell](vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="19212-596">Site-to-Site VPNs: [https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell](vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)</span></span>
* <span data-ttu-id="19212-597">(Будет убедиться, что toocheck out hello разделы «Приступая к работе» и «как») документации по ExpressRoute: [https://docs.microsoft.com/azure/expressroute/](https://docs.microsoft.com/azure/expressroute/)</span><span class="sxs-lookup"><span data-stu-id="19212-597">ExpressRoute documentation (be sure toocheck out hello “Getting Started” and “How To” sections): [https://docs.microsoft.com/azure/expressroute/](https://docs.microsoft.com/azure/expressroute/)</span></span>

<!--Image References-->
[0]: ./media/best-practices-network-security/flowchart.png "Блок-схема вариантов системы безопасности"
[2]: ./media/best-practices-network-security/azuresecurityfeatures.png "Функции безопасности Azure"
[3]: ./media/best-practices-network-security/dmzcorporate.png "Сеть периметра в корпоративной сети"
[4]: ./media/best-practices-network-security/azuresecurityarchitecture.png "Архитектура безопасности Azure"
[5]: ./media/best-practices-network-security/dmzazure.png "Сеть периметра в виртуальной сети Azure"
[6]: ./media/best-practices-network-security/dmzhybrid.png "Гибридная сеть с тремя границами безопасности"
[7]: ./media/best-practices-network-security/example1design.png "Входящая сеть периметра с группой безопасности сети"
[8]: ./media/best-practices-network-security/example2design.png "Входящая сеть периметра с виртуальным сетевым устройством и группой безопасности сети"
[9]: ./media/best-practices-network-security/example3design.png "Двунаправленная сеть периметра с виртуальным сетевым устройством, группой безопасности сети и определяемыми пользователем маршрутами"
[10]: ./media/best-practices-network-security/example3firewalllogical.png "логическое представление hello правила брандмауэра"
[11]: ./media/best-practices-network-security/example3designoptions.png "Сеть периметра с гибридной сетью, подключенной через виртуальное сетевое устройство"
[12]: ./media/best-practices-network-security/example4designs2s.png "Сеть периметра с виртуальным сетевым устройством и VPN-подключением типа "сеть — сеть""
[13]: ./media/best-practices-network-security/example4networklogical.png "Логическая сеть с точки зрения виртуального сетевого устройства"
[14]: ./media/best-practices-network-security/example5designoptions.png "Сеть периметра с гибридным сетевым подключением типа "сеть — сеть" через шлюз Azure"
[15]: ./media/best-practices-network-security/example5designs2s.png "Сеть периметра со шлюзом Azure и VPN-подключением типа "сеть — сеть""
[16]: ./media/best-practices-network-security/example6designoptions.png "Сеть периметра с гибридным сетевым подключением ExpressRoute через шлюз Azure"
[17]: ./media/best-practices-network-security/example6designexpressroute.png "Сеть периметра со шлюзом Azure и подключением ExpressRoute"

<!--Link References-->
[TrustCenter]: https://azure.microsoft.com/support/trust-center/compliance/
[Example1]: ./virtual-network/virtual-networks-dmz-nsg.md
[Example2]: ./virtual-network/virtual-networks-dmz-nsg-fw-asm.md
[Example3]: ./virtual-network/virtual-networks-dmz-nsg-fw-udr-asm.md
[Example4]: ./virtual-network/virtual-networks-hybrid-s2s-nva-asm.md
[Example5]: ./virtual-network/virtual-networks-hybrid-s2s-agw-asm.md
[Example6]: ./virtual-network/virtual-networks-hybrid-expressroute-asm.md
[Example7]: ./virtual-network/virtual-networks-vnet2vnet-direct-asm.md
[Example8]: ./virtual-network/virtual-networks-vnet2vnet-transit-asm.md
