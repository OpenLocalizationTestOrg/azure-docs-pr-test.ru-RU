---
title: "Часто задаваемые вопросы о ретрансляторе Azure | Документация Майкрософт"
description: "Получите ответы на некоторые часто задаваемые вопросы о ретрансляторе Azure."
services: service-bus-relay
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 886d2c7f-838f-4938-bd23-466662fb1c8e
ms.service: service-bus-relay
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: e8c146f4b6d02449be6ad9e991e52db8dfd58e04
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="azure-relay-faqs"></a>Часто задаваемые вопросы о ретрансляторе Azure

В этой статье содержатся ответы на некоторые часто задаваемые вопросы о [ретрансляторе Azure](https://azure.microsoft.com/services/service-bus/). Общие сведения о расценках и поддержке Azure см. на странице [Часто задаваемые вопросы о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083).

## <a name="general-questions"></a>Общие вопросы
### <a name="what-is-azure-relay"></a>Что такое ретранслятор Azure?
[Служба ретранслятора Azure](relay-what-is-it.md) упрощает работу с гибридными приложениями, позволяя безопаснее предоставлять в общедоступном облаке службы, используемые в корпоративной сети предприятия. Вам не нужно открывать подключения брандмауэра или вносить значительные изменения в инфраструктуру корпоративной сети.

### <a name="what-is-a-relay-namespace"></a>Что такое пространство имен ретранслятора?
[Пространство имен](relay-create-namespace-portal.md) — это контейнер, который можно использовать для адресации ресурсов ретранслятора в вашем приложении. Чтобы использовать ретранслятор, необходимо создать пространство имен. Это один из первых шагов для начала работы.

### <a name="what-happened-to-service-bus-relay-service"></a>Что случилось со службой ретранслятора служебной шины?
Служба, которая называлась службой ретранслятора служебной шины, теперь называется ретранслятором WCF. Вы можете использовать эту службу как обычно. Функция гибридных подключений представляет собой обновленную версию службы, перенесенной из служб BizTalk Azure. Ретранслятор WCF и гибридные подключения будут и дальше поддерживаться.

## <a name="pricing"></a>Цены
В этом разделе содержатся ответы на некоторые часто задаваемые вопросы о ценах на использование ретранслятора. Общие сведения о расценках Azure см. на странице [Часто задаваемые вопросы о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083). Дополнительные сведения о ценах на использование ретранслятора см. на странице [цен на служебную шину][Pricing overview].

### <a name="how-do-you-charge-for-hybrid-connections-and-wcf-relay"></a>Как выставляется цена за гибридные подключения и ретранслятор WCF?
Подробные сведения см. в таблице [гибридных подключений и ретрансляторов WCF][Pricing overview] на странице с ценами на служебную шину. Помимо платы, указанной на этой странице, также взимается плата за связанные операции передачи данных, исходящих из центра данных, в котором подготавливается ваше приложение.

### <a name="how-am-i-billed-for-hybrid-connections"></a>Как рассчитывается стоимость использования гибридных подключений?
Ниже приведены три примера сценария выставления счетов за гибридные подключения.

*   Сценарий 1.
    *   У вас есть один прослушиватель, например диспетчер гибридных подключений, который постоянно работает в течение месяца.
    *   В течение месяца вы передаете через это подключение 3 ГБ данных. 
    *   В этом случае общая стоимость составит 5 долл. США.
*   Сценарий 2.
    *   У вас есть один прослушиватель, например диспетчер гибридных подключений, который постоянно работает в течение месяца.
    *   В течение месяца вы передаете через это подключение 10 ГБ данных.
    *   В этом случае общая стоимость составит 7,50 долл. США. Это 5 долл. США за подключение и первые 5 ГБ + 2,50 долл. США за дополнительные 5 ГБ данных.
*   Сценарий 3.
    *   У вас есть два экземпляра диспетчера гибридных подключений, А и Б, которые постоянно работают в течение месяца.
    *   В течение месяца вы передаете через подключение А 3 ГБ данных,
    *   а через подключение Б — 6 ГБ данных.
    *   В этом случае общая стоимость составит 10,50 долл. США. Это 5 долл. США за подключение А + 5 долл. США за подключение Б + 0,50 долл. США (за шестой гигабайт через подключение Б).

Обратите внимание, что в примерах расчетов использованы цены на период действия предварительной версии гибридного подключения. После выхода общедоступной версии гибридных подключений цена может измениться.

### <a name="how-are-hours-calculated-for-relay"></a>Как вычисляются часы ретрансляции?

Ретранслятор WCF доступен только в пространствах имен уровня "Стандартный". В остальном расценки и [квоты подключения](../service-bus-messaging/service-bus-quotas.md) для ретрансляторов остались неизменными. Это означает, что тарификация для них будет по-прежнему выполняться на основе количества сообщений (а не операций) и часов ретрансляции. Дополнительные сведения см. в таблице [гибридных подключений и ретрансляторов WCF](https://azure.microsoft.com/pricing/details/service-bus/) на странице с ценами.

### <a name="what-if-i-have-more-than-one-listener-connected-to-a-specific-relay"></a>Что делать, если к конкретному ретранслятору подключено несколько прослушивателей?
В некоторых случаях к одному ретранслятору могут подключаться несколько прослушивателей. Ретранслятор считается открытым, если к нему подключен хотя бы один прослушиватель. Добавление прослушивателей к открытому ретранслятору приведет к появлению дополнительных часов ретрансляции. Количество отправителей ретрансляции (клиентов, вызывающих или отправляющих сообщения ретрансляторам), подключенных к ретранслятору, не влияет на подсчет часов ретрансляции.

### <a name="how-is-the-messages-meter-calculated-for-wcf-relays"></a>Как вычисляется количество сообщений ретрансляторам WCF?
(**Следующие сведения касаются только ретрансляторов WCF. Цена на сообщения никак не связана со стоимостью гибридных подключений.**)

В целом количество оплачиваемых сообщений для ретрансляторов вычисляется так же, как и для сущностей, использующих брокер (очередей, разделов и подписок), как описано ранее. Тем не менее существует несколько важных отличий.

Отправка сообщения ретранслятору служебной шины рассматривается как полностью осуществленная отправка прослушивателю ретрансляции, который получает сообщение, а не как операция отправки сообщения в ретранслятор служебной шины с последующей его доставкой в прослушиватель ретрансляции. При вызове службы типа "запрос — ответ" (размером до 64 КБ) на уровне прослушивателя ретрансляции будут зафиксированы следующие сообщения: одно оплачиваемое сообщение для запроса и одно оплачиваемое сообщение для ответа (при условии, что размер ответа также не превышает 64 КБ). Это отличается от механизма использования очереди в качестве посредника между клиентом и службой. При использовании очереди в качестве посредника между клиентом и службой в рамках одного и того же алгоритма "запрос — ответ" предусмотрена отправка запроса в очередь с последующим изъятием из очереди и доставкой в службы, отправкой ответа в другую очередь, а также изъятием из очереди и доставкой клиенту. Если размер вызова не превышает 64 КБ, использование схемы с посредником в виде очереди приводит к выставлению счета за 4 оплачиваемых сообщения. При этом плата за количество сообщений в два раза выше, чем при реализации аналогичной схемы с использованием ретранслятора. Конечно, использование такой схемы связано с определенными преимуществами, включая надежность и выравнивание нагрузки. Эти преимущества могут оправдать дополнительные расходы.

Ретрансляторы, открытые с помощью привязки WCF **netTCPRelay**, обрабатывают сообщения не по отдельности, а как поток данных, передаваемых через систему. Сведения о формировании отдельных сообщений, отправленных и полученных с помощью этой привязки, доступны только отправителю и прослушивателю. Для ретрансляторов, использующих привязку **netTCPRelay**, все данные обрабатываются как поток при вычислении количества оплачиваемых сообщений. В этом случае служебная шина вычисляет общий объем данных, отправленных или полученных в ходе отдельной ретрансляции с 5-минутными интервалами. Затем общий объем данных будет поделен на блоки по 64 КБ, чтобы определить количество оплачиваемых сообщений ретранслятору, обработанных за заданный период времени.

## <a name="quotas"></a>Квоты
| Имя квоты | Область | Тип | Поведение при превышении квот | Значение |
| --- | --- | --- | --- | --- |
| Параллельные прослушиватели ретранслятора |Сущность |Статическое |Запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. |25 |
| Параллельные прослушиватели ретрансляции |Во всей системе |Статическое |Запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. |2 000 |
| Параллельные подключения ретрансляции для всех конечных точек ретрансляции в пространстве имен службы |Во всей системе |Статическое |- |5 000 |
| Конечные точки ретрансляции на одно пространство имен службы |Во всей системе |Статическое |- |10 000 |
| Размер сообщения для ретрансляций [NetOnewayRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.netonewayrelaybinding.aspx) и [NetEventRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.neteventrelaybinding.aspx) |Во всей системе |Статическое |Входящие сообщения, размер которых превышает эти значения, отклоняются, а в вызывающем коде возникает исключение. |64 КБ |
| Размер сообщения для ретрансляций [HttpRelayTransportBindingElement](https://msdn.microsoft.com/library/microsoft.servicebus.httprelaytransportbindingelement.aspx) и [NetTcpRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.nettcprelaybinding.aspx) |Во всей системе |Статическое |- |Без ограничений |

### <a name="does-relay-have-any-usage-quotas"></a>Есть ли у ретранслятора квоты использования?
По умолчанию для любой облачной службы Майкрософт устанавливается квота совокупного месячного использования в рамках всех подписок клиента. Мы понимаем, что в некоторых случаях вам может потребоваться больше, чем разрешено этими ограничениями. Вы можете в любой момент обратиться в службу поддержки клиентов и договориться об изменении квот в соответствии с вашими потребностями. Для служебной шины установлены следующие квоты общего использования:

* 5 миллиардов сообщений;
* 2 миллиона часов ретрансляции.

Мы оставляем за собой право отключить учетную запись в случае превышения месячных квот использования. Но перед выполнением каких-либо действий мы отправляем уведомления по электронной почте, а также предпринимаем несколько попыток связаться с клиентом. Клиентам, превысившим свои квоты, будут выставлены соответствующие счета.

### <a name="naming-restrictions"></a>Ограничения для имен
Имя пространства имен ретранслятора должно содержать от 6 до 50 знаков.

## <a name="subscription-and-namespace-management"></a>Управление подпиской и пространством имен
### <a name="how-do-i-migrate-a-namespace-to-another-azure-subscription"></a>Как перенести пространство имен в другую подписку Azure?

Чтобы переместить пространство имен из одной подписки Azure в другую, можно воспользоваться [порталом Azure](https://portal.azure.com) или выполнить команды PowerShell. При перемещении пространство имен должно быть активно. Пользователь, выполняющий команды, должен обладать правами администратора как в исходной, так и в целевой подписках.

#### <a name="azure-portal"></a>Портал Azure

Сведения об использовании портала Azure для переноса пространства имен ретранслятора Azure из одной подписки в другую см. в разделе [С помощью портала](../azure-resource-manager/resource-group-move-resources.md#use-portal). 

#### <a name="powershell"></a>PowerShell

Чтобы переместить пространство имен из одной подписки Azure в другую с помощью PowerShell, выполните указанную ниже последовательность команд. Для выполнения этой операции пространство имен уже должно быть активным, а пользователь, выполняющий команды PowerShell, должен обладать правами администратора в исходной и целевой подписках.

```powershell
# Create a new resource group in the target subscription.
Select-AzureRmSubscription -SubscriptionId 'ffffffff-ffff-ffff-ffff-ffffffffffff'
New-AzureRmResourceGroup -Name 'targetRG' -Location 'East US'

# Move the namespace from the source subscription to the target subscription.
Select-AzureRmSubscription -SubscriptionId 'aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa'
$res = Find-AzureRmResource -ResourceNameContains mynamespace -ResourceType 'Microsoft.ServiceBus/namespaces'
Move-AzureRmResource -DestinationResourceGroupName 'targetRG' -DestinationSubscriptionId 'ffffffff-ffff-ffff-ffff-ffffffffffff' -ResourceId $res.ResourceId
```

## <a name="troubleshooting"></a>Устранение неполадок
### <a name="what-are-some-of-the-exceptions-generated-by-azure-relay-apis-and-suggested-actions-you-can-take"></a>Какие исключения создаются API ретранслятора Azure? Какие действия можно предпринять?
Описание распространенных исключений и сведения о действиях, которые можно предпринять, см. в статье [Исключения ретранслятора][Relay exceptions].

### <a name="what-is-a-shared-access-signature-and-which-languages-can-i-use-to-generate-a-signature"></a>Что такое подписанный URL-адрес? На каких языках можно создавать подписи?
Подписанные URL-адреса (SAS) представляют собой механизм аутентификации на базе алгоритма безопасного хэширования SHA-256 или URI. Дополнительные сведения о том, как создавать собственные подписи с использованием Node, PHP, Java, C и C#, см. в статье [Аутентификация служебной шины с помощью подписанных URL-адресов][Shared Access Signatures].

### <a name="is-it-possible-to-whitelist-relay-endpoints"></a>Можно ли добавить конечные точки ретрансляции в список разрешений?
Да. Клиент ретрансляции устанавливает подключения к службе ретрансляции Azure, используя полные доменные имена. Пользователи могут добавить запись для `*.servicebus.windows.net` в брандмауэры, поддерживающие добавление в список разрешений DNS.

## <a name="next-steps"></a>Дальнейшие действия
* [Создание пространства имен](relay-create-namespace-portal.md)
* [Приступая к работе с .NET](relay-hybrid-connections-dotnet-get-started.md)
* [Приступая к работе с Node](relay-hybrid-connections-node-get-started.md)

[Pricing overview]: https://azure.microsoft.com/pricing/details/service-bus/
[Relay exceptions]: relay-exceptions.md
[Shared access signatures]: ../service-bus-messaging/service-bus-sas.md