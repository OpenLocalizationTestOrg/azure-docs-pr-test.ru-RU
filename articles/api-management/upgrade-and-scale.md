---
title: "Обновление и масштабирование экземпляра службы управления API Azure | Документация Майкрософт"
description: "В этой статье описано, как обновлять и масштабировать экземпляры службы управления API Azure."
services: api-management
documentationcenter: 
author: vladvino
manager: anneta
editor: 
ms.service: api-management
ms.workload: integration
ms.topic: article
ms.date: 08/17/2017
ms.author: apimpm
ms.openlocfilehash: 6ae977344101c02222fd9930e26a083bf5e3f800
ms.sourcegitcommit: aaba209b9cea87cb983e6f498e7a820616a77471
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="upgrade-and-scale-an-api-management-instance"></a>Обновление и масштабирование экземпляра API Management 

Клиенты могут масштабировать экземпляр управления API (APIM), добавляя или удаляя единицы. **Единицы** состоят из выделенных ресурсов Azure c определенной способностью выдерживать нагрузку, представленную числом вызовов API в месяц. Это число никак не связано с предельным числом вызовов, а представляет собой допустимое значение максимальной пропускной способности при предварительном планировании ресурсов. Фактическая пропускная способность и задержка могут сильно отличаться в зависимости от многих факторов, включая число и частоту параллельных подключений, виды и число настроенных политик, размеры запросов и ответов, а также задержку серверной части.

Емкость и цена каждой единицы зависят от **уровня**, на котором существует эта единица. Можно выбрать между четырех уровнях: **разработчика**, **основные**, **Стандартная**, **Premium**. Если вы хотите увеличить производительность службы, не изменяя уровень, добавьте новую единицу. Если выбранный уровень экземпляра APIM уже не позволяет добавлять единицы, необходимо обновить его до более высокого уровня. 

Цена каждой единицы и доступные функции (например, развертывания в нескольких регионах) зависят от уровня, который вы выбрали для конкретного экземпляра службы управления API. В [этой статье](https://azure.microsoft.com/pricing/details/api-management/?ref=microsoft.com&utm_source=microsoft.com&utm_medium=docs&utm_campaign=visualstudio) указаны цены за единицу и описаны доступные функции для каждого уровня. 

>[!NOTE]
>В [этой статье](https://azure.microsoft.com/pricing/details/api-management/?ref=microsoft.com&utm_source=microsoft.com&utm_medium=docs&utm_campaign=visualstudio) представлены примерные данные о производительности единиц для каждого уровня. Чтобы получить более точные сведения, изучите приближенный к реальному сценарий использования API. В этом вам поможет представленный ниже раздел "Как правильно оценить производительность".

## <a name="prerequisites"></a>Технические условия

Чтобы выполнить действия, описанные в этой статье, необходимо следующее.

+ Активная подписка Azure.

    [!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

+ Экземпляр APIM. Дополнительные сведения см. в статье о [создании экземпляра управления API Azure](get-started-create-service-instance.md).

## <a name="how-to-plan-for-capacity"></a>Как правильно оценить производительность?

Чтобы убедиться, что имеющееся число единиц справится с реальным трафиком, протестируйте ожидаемые рабочие нагрузки. 

Как упоминалось выше, число запросов, обрабатываемых единицей службы управления API в секунду, зависит от многих переменных. Здесь важны характер соединений, размеры запросов и ответов, настроенные для API политики, число клиентов и т. п.

Используйте **метрики** (в рамках возможностей Azure Monitor), чтобы оценить используемую производительность в указанный момент времени.

### <a name="use-the-azure-portal-to-examine-metrics"></a>Изучение метрик с помощью портала Azure 

1. Перейдите к экземпляру APIM на [портале Azure](https://portal.azure.com/).
2. Выберите **Метрики**.
3. Выберите метрику **Производительность** из списка **Доступные метрики**. 

    Метрики производительности дают определенное представление о том, какой объем доступных вычислительных ресурсов используется в клиенте. Значение объема рассчитывается на основе используемых клиентом вычислительных ресурсов, таких как память, ЦП и длина очереди сети. Это не прямой расчет числа обрабатываемых запросов. Для проверки вы можете увеличить нагрузку запросов на клиент и отследить, какое значение метрики производительности соответствует пиковой нагрузке. Также можно настроить оповещение по метрикам, чтобы получать информацию о непредвиденных ситуациях. Например, если для экземпляра службы управления API превышен ожидаемый предел производительности в течение десяти минут.

    >[!TIP]
    > С помощью оповещений вы можете узнать, что служба исчерпала емкость, или настроить вызов приложения логики для автоматического масштабирования, добавив единицу.

## <a name="upgrade-and-scale"></a>Обновление и масштабирование 

Как упоминалось ранее, можно выбрать между четырех уровнях: **разработчика**, **основные**, **Стандартная** и **Premium**. Уровень **Developer** предназначен только для оценки службы. Не используйте его в рабочей среде. Уровень **Developer** не предусматривает соглашение об уровне обслуживания и не поддерживает масштабирование (не позволяет добавлять или удалять единицы). 

**Основные**, **Стандартная** и **Premium** — рабочей уровни, которые имеют соглашения об уровне ОБСЛУЖИВАНИЯ и могут масштабироваться. **Основные** уровень является уровнем дешевые, имеющий соглашение об уровне ОБСЛУЖИВАНИЯ и может быть единицы масштабирования не более 2 **Стандартная** уровень может масштабироваться до четырех единиц. На уровне **Premium** вы можете добавлять неограниченное число единиц.

Уровень **Premium** позволяет распределить один экземпляр управления API между любым числом регионов Azure на ваш выбор. Экземпляр создаваемой службы управления API содержит только одну единицу. Он размещается в одном регионе Azure. Этот начальной регион считается для экземпляра **основным** регионом. Вы можете легко добавить дополнительные регионы. При добавлении региона укажите число выделяемых для него единиц. Например, вы можете использовать одну единицу в **основном** регионе и пять единиц в любом другом регионе. Можно распределить число единиц с учетом характеристик трафика в каждом регионе. Дополнительные сведения см. в статье [Развертывание экземпляра службы управления Azure API в различных регионах Azure](api-management-howto-deploy-multi-region.md).

Вы всегда можете повысить или понизить уровень в любых комбинациях. Обратите внимание, что повышения или понижения можно удалить некоторые функции — например, виртуальных сетей или развертывание в нескольких регионах, при понижении стандартные или базовые от уровня Premium.

>[!NOTE]
>Процесс обновления или масштабирования может занять от 15 до 45 минут. Вы получите уведомление, когда он завершится.

### <a name="use-the-azure-portal-to-upgrade-and-scale"></a>Использование портала Azure для обновления и масштабирования

1. Перейдите к экземпляру APIM на [портале Azure](https://portal.azure.com/).
2. Выберите элемент **Масштабирование и цены**.
3. Выберите нужный уровень.
4. Укажите число **единиц**, которое нужно добавить. Для этого можно передвинуть ползунок или ввести число.<br/>
    Если выбран уровень **Премиум**, следует также выбрать регион.
5. Нажмите кнопку **Сохранить**.

## <a name="next-steps"></a>Дальнейшие действия

[Развертывание экземпляра службы управления Azure API в различных регионах Azure](api-management-howto-deploy-multi-region.md)

