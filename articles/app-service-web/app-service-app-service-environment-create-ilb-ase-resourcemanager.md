---
title: "Как создать среду службы приложений с внутренним балансировщиком нагрузки с помощью шаблонов Azure Resource Manager | Документация Майкрософт"
description: "Узнайте, как создать ASE с внутренним балансировщиком нагрузки с помощью шаблонов Azure Resource Manager."
services: app-service
documentationcenter: 
author: stefsch
manager: nirma
editor: 
ms.assetid: 091decb6-b0de-42a1-9f2f-c18d9b2e67df
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: stefsch
ms.openlocfilehash: 147ab76d38c8bbbf34d35ed6c2a194d97fe711ab
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="how-to-create-an-ilb-ase-using-azure-resource-manager-templates"></a><span data-ttu-id="8cead-103">Создание среды службы приложений с внутренним балансировщиком нагрузки с помощью шаблонов Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8cead-103">How To Create an ILB ASE Using Azure Resource Manager Templates</span></span>

> [!NOTE] 
> <span data-ttu-id="8cead-104">Эта статья посвящена среде службы приложений версии 1.</span><span class="sxs-lookup"><span data-stu-id="8cead-104">This article is about the App Service Environment v1.</span></span> <span data-ttu-id="8cead-105">Имеется более новая версия среды службы приложений, которая проще в использовании и которая работает на более мощной инфраструктуре.</span><span class="sxs-lookup"><span data-stu-id="8cead-105">There is a newer version of the App Service Environment that is easier to use and runs on more powerful infrastructure.</span></span> <span data-ttu-id="8cead-106">Чтобы узнать больше о новой версии, начните с изучения статьи [Введение в среду службы приложения](../app-service/app-service-environment/intro.md).</span><span class="sxs-lookup"><span data-stu-id="8cead-106">To learn more about the new version start with the [Introduction to the App  Service Environment](../app-service/app-service-environment/intro.md).</span></span>
>

## <a name="overview"></a><span data-ttu-id="8cead-107">Обзор</span><span class="sxs-lookup"><span data-stu-id="8cead-107">Overview</span></span>
<span data-ttu-id="8cead-108">Вместо общедоступного виртуального IP-адреса для создания среды службы приложений (ASE) можно использовать внутренний адрес виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="8cead-108">App Service Environments can be created with a virtual network internal address instead of a public VIP.</span></span>  <span data-ttu-id="8cead-109">Этот внутренний адрес принадлежит компоненту Azure, который называется внутренним балансировщиком нагрузки.</span><span class="sxs-lookup"><span data-stu-id="8cead-109">This internal address is provided by an Azure component called the internal load balancer (ILB).</span></span>  <span data-ttu-id="8cead-110">Среду ASE с внутренним балансировщиком нагрузки можно создать на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="8cead-110">An ILB ASE can be created using the Azure portal.</span></span>  <span data-ttu-id="8cead-111">Ее также можно создать автоматически с помощью шаблонов Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="8cead-111">It can also be created using automation by way of Azure Resource Manager templates.</span></span>  <span data-ttu-id="8cead-112">В этой статье описаны действия и синтаксис, необходимые для создания ASE с внутренним балансировщиком нагрузки с помощью шаблонов Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="8cead-112">This article walks through the steps and syntax needed to create an ILB ASE with Azure Resource Manager templates.</span></span>

<span data-ttu-id="8cead-113">Автоматическое создание среды ASE с внутренним балансировщиком нагрузки предусматривает три шага:</span><span class="sxs-lookup"><span data-stu-id="8cead-113">There are three steps involved in automating creation of an ILB ASE:</span></span>

1. <span data-ttu-id="8cead-114">Сначала в виртуальной сети создается базовая среда ASE, для чего вместо общедоступного виртуального IP-адреса используется адрес внутреннего балансировщика нагрузки.</span><span class="sxs-lookup"><span data-stu-id="8cead-114">First the base ASE is created in a virtual network using an internal load balancer address instead of a public VIP.</span></span>  <span data-ttu-id="8cead-115">Кроме того, на этом шаге ASE с внутренним балансировщиком нагрузки присваивается имя корневого домена.</span><span class="sxs-lookup"><span data-stu-id="8cead-115">As part of this step, a root domain name is assigned to the ILB ASE.</span></span>
2. <span data-ttu-id="8cead-116">После создания ASE с внутренним балансировщиком нагрузки загружается SSL-сертификат.</span><span class="sxs-lookup"><span data-stu-id="8cead-116">Once the ILB ASE is created, an SSL certificate is uploaded.</span></span>  
3. <span data-ttu-id="8cead-117">Переданный SSL-сертификат явным образом назначается ASE с внутренним балансировщиком нагрузки в качестве SSL-сертификата по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8cead-117">The uploaded SSL certificate is explicitly assigned to the ILB ASE as its "default" SSL certificate.</span></span>  <span data-ttu-id="8cead-118">Этот сертификат будет использоваться для передачи трафика SSL в приложения в среде службы приложений с внутренним балансировщиком нагрузки, если при обращении к ним используется общий корневой домен, назначенный этой среде (например, https://someapp.mycustomrootcomain.com).</span><span class="sxs-lookup"><span data-stu-id="8cead-118">This SSL certificate will be used for SSL traffic to apps on the ILB ASE when the apps are addressed using the common root domain assigned to the ASE (e.g. https://someapp.mycustomrootcomain.com)</span></span>

## <a name="creating-the-base-ilb-ase"></a><span data-ttu-id="8cead-119">Создание базовой среды ASE с внутренним балансировщиком нагрузки</span><span class="sxs-lookup"><span data-stu-id="8cead-119">Creating the Base ILB ASE</span></span>
<span data-ttu-id="8cead-120">Пример шаблона Azure Resource Manager и соответствующий файл параметров доступны на сайте GitHub [здесь][quickstartilbasecreate].</span><span class="sxs-lookup"><span data-stu-id="8cead-120">An example Azure Resource Manager template, and its associated parameters file, are available on GitHub [here][quickstartilbasecreate].</span></span>

<span data-ttu-id="8cead-121">Большинство параметров в файле *azuredeploy.parameters.json* используются при создании как ASE с внутренним балансировщиком нагрузки, так и ASE с привязкой к общедоступному виртуальному IP-адресу.</span><span class="sxs-lookup"><span data-stu-id="8cead-121">Most of the parameters in the *azuredeploy.parameters.json* file are common to creating both ILB ASEs, as well as ASEs bound to a public VIP.</span></span>  <span data-ttu-id="8cead-122">Ниже приведены параметры с особыми примечаниями и уникальные параметры, используемые при создании ASE с внутренним балансировщиком нагрузки.</span><span class="sxs-lookup"><span data-stu-id="8cead-122">The list below calls out parameters of special note, or that are unique, when creating an ILB ASE:</span></span>

* <span data-ttu-id="8cead-123">*interalLoadBalancingMode*. В большинстве случаев для этого параметра нужно задать значение 3. В таком случае трафик HTTP и HTTPS на портах 80 и 443 и порты канала данных и канала управления, прослушиваемые FTP-службой в среде службы приложений, будут привязаны к внутреннему адресу в виртуальной сети, выделенному внутренним балансировщиком нагрузки.</span><span class="sxs-lookup"><span data-stu-id="8cead-123">*interalLoadBalancingMode*:  In most cases set this to 3, which means both HTTP/HTTPS traffic on ports 80/443, and the control/data channel ports listened to by the FTP service on the ASE, will be bound to an ILB allocated virtual network internal address.</span></span>  <span data-ttu-id="8cead-124">Если задать для этого свойства значение 2, к адресу внутреннего балансировщика нагрузки будут привязаны только порты, связанные со службой FTP (канала данных и канала управления), а HTTP- и HTTP-трафик останется привязанным к общедоступному виртуальному IP-адресу.</span><span class="sxs-lookup"><span data-stu-id="8cead-124">If this property is instead set to 2, then only the FTP service related ports (both control and data channels) will be bound to an ILB address, while the HTTP/HTTPS traffic will remain on the public VIP.</span></span>
* <span data-ttu-id="8cead-125">*dnsSuffix*. Этот параметр определяет корневой домен по умолчанию, который будет назначен среде службы приложений.</span><span class="sxs-lookup"><span data-stu-id="8cead-125">*dnsSuffix*:  This parameter defines the default root domain that will be assigned to the ASE.</span></span>  <span data-ttu-id="8cead-126">В общедоступной версии службы приложений Azure корневой домен по умолчанию для всех веб-приложений — *azurewebsites.net*.</span><span class="sxs-lookup"><span data-stu-id="8cead-126">In the public variation of Azure App Service, the default root domain for all web apps is *azurewebsites.net*.</span></span>  <span data-ttu-id="8cead-127">Однако так как ASE с внутренним балансировщиком нагрузки является внутренней для виртуальной сети пользователя, бессмысленно использовать корневой домен по умолчанию общедоступной службы.</span><span class="sxs-lookup"><span data-stu-id="8cead-127">However since an ILB ASE is internal to a customer's virtual network, it doesn't make sense to use the public service's default root domain.</span></span>  <span data-ttu-id="8cead-128">Вместо этого ASE с внутренним балансировщиком нагрузки необходимо назначить корневой домен по умолчанию, который целесообразно использовать в пределах внутренней виртуальной сети компании.</span><span class="sxs-lookup"><span data-stu-id="8cead-128">Instead, an ILB ASE should have a default root domain that makes sense for use within a company's internal virtual network.</span></span>  <span data-ttu-id="8cead-129">Например, гипотетическая компания Contoso может использовать корневой домен по умолчанию *internal-contoso.com* для приложений, которые должны быть разрешаемыми и доступными только в виртуальной сети компании Contoso.</span><span class="sxs-lookup"><span data-stu-id="8cead-129">For example, a hypothetical Contoso Corporation might use a default root domain of *internal-contoso.com* for apps that are intended to only be resolvable and accessible within Contoso's virtual network.</span></span> 
* <span data-ttu-id="8cead-130">*ipSslAddressCount*. Для этого параметра в файле *azuredeploy.json* автоматически задается значение 0, так как средам службы приложений с внутренним балансировщиком нагрузки назначен только адрес этого балансировщика.</span><span class="sxs-lookup"><span data-stu-id="8cead-130">*ipSslAddressCount*:  This parameter is automatically defaulted to a value of 0 in the *azuredeploy.json* file because ILB ASEs only have a single ILB address.</span></span>  <span data-ttu-id="8cead-131">Для ASE с внутренним балансировщиком нагрузки нет явно заданных адресов SSL на основе IP, поэтому для пула этих адресов необходимо задать значение 0. В противном случае произойдет ошибка подготовки.</span><span class="sxs-lookup"><span data-stu-id="8cead-131">There are no explicit IP-SSL addresses for an ILB ASE, and hence the IP-SSL address pool for an ILB ASE must be set to zero, otherwise a provisioning error will occur.</span></span> 

<span data-ttu-id="8cead-132">Когда файл *azuredeploy.parameters.json* для ASE с внутренним балансировщиком нагрузки будет заполнен, можно приступить к созданию соответствующей среды с помощью приведенного ниже фрагмента кода Powershell.</span><span class="sxs-lookup"><span data-stu-id="8cead-132">Once the *azuredeploy.parameters.json* file has been filled in for an ILB ASE, the ILB ASE can then be created using the following Powershell code snippet.</span></span>  <span data-ttu-id="8cead-133">Измените пути к файлам в соответствии с расположением файлов шаблонов Azure Resource Manager на вашем компьютере.</span><span class="sxs-lookup"><span data-stu-id="8cead-133">Change the file PATHs to match where the Azure Resource Manager template files are located on your machine.</span></span>  <span data-ttu-id="8cead-134">Кроме того, введите собственные значения для имени развертывания Azure Resource Manager и группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="8cead-134">Also remember to supply your own values for the Azure Resource Manager deployment name, and resource group name.</span></span>

    $templatePath="PATH\azuredeploy.json"
    $parameterPath="PATH\azuredeploy.parameters.json"

    New-AzureRmResourceGroupDeployment -Name "CHANGEME" -ResourceGroupName "YOUR-RG-NAME-HERE" -TemplateFile $templatePath -TemplateParameterFile $parameterPath

<span data-ttu-id="8cead-135">После отправки шаблона Azure Resource Manager для создания ASE с внутренним балансировщиком нагрузки потребуется несколько часов.</span><span class="sxs-lookup"><span data-stu-id="8cead-135">After the Azure Resource Manager template is submitted it will take a few hours for the ILB ASE to be created.</span></span>  <span data-ttu-id="8cead-136">Созданная ASE с внутренним балансировщиком нагрузки появится на портале в списке сред службы приложений для подписки, использованной для развертывания.</span><span class="sxs-lookup"><span data-stu-id="8cead-136">Once the creation completes, the ILB ASE will show up in the portal UX in the list of App Service Environments for the subscription that triggered the deployment.</span></span>

## <a name="uploading-and-configuring-the-default-ssl-certificate"></a><span data-ttu-id="8cead-137">Загрузка и настройка SSL-сертификата по умолчанию</span><span class="sxs-lookup"><span data-stu-id="8cead-137">Uploading and Configuring the "Default" SSL Certificate</span></span>
<span data-ttu-id="8cead-138">После создания среды ASE с внутренним балансировщиком нагрузки ей необходимо назначить SSL-сертификат по умолчанию, который будет использоваться для установки SSL-подключений к приложениям.</span><span class="sxs-lookup"><span data-stu-id="8cead-138">Once the ILB ASE is created, an SSL certificate should be associated with the ASE as the "default" SSL certificate use for establishing SSL connections to apps.</span></span>  <span data-ttu-id="8cead-139">Если DNS-суффикс по умолчанию среды службы приложений все той же гипотетической компании Contoso — *internal-contoso.com*, то для подключения к *https://случайному_приложению.internal-contoso.com* требуется сертификат SSL, действительный для домена **.internal-contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="8cead-139">Continuing with the hypothetical Contoso Corporation example, if the ASE's default DNS suffix is *internal-contoso.com*, then a connection to *https://some-random-app.internal-contoso.com* requires an SSL certificate that is valid for **.internal-contoso.com*.</span></span> 

<span data-ttu-id="8cead-140">Есть множество способов получить действительный SSL-сертификат, в частности можно получить сертификат от внутреннего центра сертификации, приобрести его у внешнего поставщика и использовать самозаверяющий сертификат.</span><span class="sxs-lookup"><span data-stu-id="8cead-140">There are a variety of ways to obtain a valid SSL certificate including internal CAs, purchasing a certificate from an external issuer, and using a self-signed certificate.</span></span>  <span data-ttu-id="8cead-141">Независимо от источника SSL-сертификата для него необходимо соответствующим образом настроить следующие атрибуты:</span><span class="sxs-lookup"><span data-stu-id="8cead-141">Regardless of the source of the SSL certificate, the following certificate attributes need to be configured properly:</span></span>

* <span data-ttu-id="8cead-142">*Subject* — для этого атрибута необходимо задать значение *.имя_корневого_домена.com*.</span><span class="sxs-lookup"><span data-stu-id="8cead-142">*Subject*:  This attribute must be set to **.your-root-domain-here.com*</span></span>
* <span data-ttu-id="8cead-143">*Subject Alternative Name* — этот атрибут должен содержать два значения: *.имя_корневого_домена.com* и *.scm.имя_корневого_домена.com*.</span><span class="sxs-lookup"><span data-stu-id="8cead-143">*Subject Alternative Name*:  This attribute must include both **.your-root-domain-here.com*, and **.scm.your-root-domain-here.com*.</span></span>  <span data-ttu-id="8cead-144">Вторая запись требуется, так как для SSL-подключений к сайту SCM или Kudu, связанному с каждым приложением, будет использоваться адрес в формате *имя_приложения.scm.имя_корневого_домена.com*.</span><span class="sxs-lookup"><span data-stu-id="8cead-144">The reason for the second entry is that SSL connections to the SCM/Kudu site associated with each app will be made using an address of the form *your-app-name.scm.your-root-domain-here.com*.</span></span>

<span data-ttu-id="8cead-145">После получения действительного SSL-сертификата требуется выполнить еще два дополнительных подготовительных действия.</span><span class="sxs-lookup"><span data-stu-id="8cead-145">With a valid SSL certificate in hand, two additional preparatory steps are needed.</span></span>  <span data-ttu-id="8cead-146">SSL-сертификат необходимо преобразовать в PFX-файл и сохранить в таком формате.</span><span class="sxs-lookup"><span data-stu-id="8cead-146">The SSL certificate needs to be converted/saved as a .pfx file.</span></span>  <span data-ttu-id="8cead-147">PFX-файл должен содержать все промежуточные и корневые сертификаты, а также быть защищен паролем.</span><span class="sxs-lookup"><span data-stu-id="8cead-147">Remember that the .pfx file needs to include all intermediate and root certificates, and also needs to be secured with a password.</span></span>

<span data-ttu-id="8cead-148">Затем PFX-файл необходимо преобразовать в строку Base64, так как SSL-сертификат будет загружен с использованием шаблона Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="8cead-148">Then the resultant .pfx file needs to be converted into a base64 string because the SSL certificate will be uploaded using an Azure Resource Manager template.</span></span>  <span data-ttu-id="8cead-149">Эти шаблоны представлены в виде текстовых файлов. Такое преобразование требуется, чтобы добавить PFX-файл в качестве параметра шаблона.</span><span class="sxs-lookup"><span data-stu-id="8cead-149">Since Azure Resource Manager templates are text files, the .pfx file needs to be converted into a base64 string so it can be included as a parameter of the template.</span></span>

<span data-ttu-id="8cead-150">В приведенном ниже фрагменте кода Powershell показано, как создать самозаверяющий сертификат, экспортировать его в формате PFX-файла, преобразовать PFX-файл в строку в кодировке Base64 и сохранить эту строку в отдельном файле.</span><span class="sxs-lookup"><span data-stu-id="8cead-150">The Powershell code snippet below shows an example of generating a self-signed certificate, exporting the certificate as a .pfx file, converting the .pfx file into a base64 encoded string, and then saving the base64 encoded string to a separate file.</span></span>  <span data-ttu-id="8cead-151">Код PowerShell для преобразования в строку в кодировке Base64 взят из [блога скриптов Powershell][examplebase64encoding].</span><span class="sxs-lookup"><span data-stu-id="8cead-151">The Powershell code for base64 encoding was adapted from the [Powershell Scripts Blog][examplebase64encoding].</span></span>

    $certificate = New-SelfSignedCertificate -certstorelocation cert:\localmachine\my -dnsname "*.internal-contoso.com","*.scm.internal-contoso.com"

    $certThumbprint = "cert:\localMachine\my\" + $certificate.Thumbprint
    $password = ConvertTo-SecureString -String "CHANGETHISPASSWORD" -Force -AsPlainText

    $fileName = "exportedcert.pfx"
    Export-PfxCertificate -cert $certThumbprint -FilePath $fileName -Password $password     

    $fileContentBytes = get-content -encoding byte $fileName
    $fileContentEncoded = [System.Convert]::ToBase64String($fileContentBytes)
    $fileContentEncoded | set-content ($fileName + ".b64")

<span data-ttu-id="8cead-152">Когда сертификат SSL будет создан и преобразован в строку в кодировке Base64, можно приступить к [настройке сертификата SSL по умолчанию][configuringDefaultSSLCertificate] с использованием шаблона Azure Resource Manager, размещенного на сайте GitHub.</span><span class="sxs-lookup"><span data-stu-id="8cead-152">Once the SSL certificate has been successfully generated and converted to a base64 encoded string, the example Azure Resource Manager template on GitHub for [configuring the default SSL certificate][configuringDefaultSSLCertificate] can be used.</span></span>

<span data-ttu-id="8cead-153">Ниже перечислены параметры, содержащиеся в файле *azuredeploy.parameters.json* .</span><span class="sxs-lookup"><span data-stu-id="8cead-153">The parameters in the *azuredeploy.parameters.json* file are listed below:</span></span>

* <span data-ttu-id="8cead-154">*appServiceEnvironmentName* — имя настраиваемой среды службы приложений с внутренним балансировщиком нагрузки.</span><span class="sxs-lookup"><span data-stu-id="8cead-154">*appServiceEnvironmentName*:  The name of the ILB ASE being configured.</span></span>
* <span data-ttu-id="8cead-155">*existingAseLocation* — текстовая строка, содержащая регион Azure, где развернута среда службы приложений с внутренним балансировщиком нагрузки.</span><span class="sxs-lookup"><span data-stu-id="8cead-155">*existingAseLocation*:  Text string containing the Azure region where the ILB ASE was deployed.</span></span>  <span data-ttu-id="8cead-156">Например, South Central US.</span><span class="sxs-lookup"><span data-stu-id="8cead-156">For example:  "South Central US".</span></span>
* <span data-ttu-id="8cead-157">*pfxBlobString* — представление PFX-файла в виде строки в кодировке Base64.</span><span class="sxs-lookup"><span data-stu-id="8cead-157">*pfxBlobString*:  The based64 encoded string representation of the .pfx file.</span></span>  <span data-ttu-id="8cead-158">Нужно скопировать строку, содержащуюся в файле exportedcert.pfx.b64, и вставить ее в качестве значения атрибута *pfxBlobString* в фрагменте кода выше.</span><span class="sxs-lookup"><span data-stu-id="8cead-158">Using the code snippet shown earlier, you would copy the string contained in "exportedcert.pfx.b64" and paste it in as the value of the *pfxBlobString* attribute.</span></span>
* <span data-ttu-id="8cead-159">*password* — пароль, используемый для защиты PFX-файла.</span><span class="sxs-lookup"><span data-stu-id="8cead-159">*password*:  The password used to secure the .pfx file.</span></span>
* <span data-ttu-id="8cead-160">*certificateThumbprint* — отпечаток сертификата.</span><span class="sxs-lookup"><span data-stu-id="8cead-160">*certificateThumbprint*:  The certificate's thumbprint.</span></span>  <span data-ttu-id="8cead-161">Если вы получите это значение из Powershell (например, значение *$certificate.Thumbprint* в приведенном выше фрагменте кода), его можно использовать без каких-либо изменений.</span><span class="sxs-lookup"><span data-stu-id="8cead-161">If you retrieve this value from Powershell (e.g. *$certificate.Thumbprint* from the earlier code snippet), you can use the value as-is.</span></span>  <span data-ttu-id="8cead-162">Однако если вы скопируете это значение в диалоговом окне сертификатов Windows, в нем нужно удалить лишние пробелы.</span><span class="sxs-lookup"><span data-stu-id="8cead-162">However if you copy the value from the Windows certificate dialog, remember to strip out the extraneous spaces.</span></span>  <span data-ttu-id="8cead-163">Значение атрибута *certificateThumbprint* должно выглядеть следующим образом: AF3143EB61D43F6727842115BB7F17BBCECAECAE.</span><span class="sxs-lookup"><span data-stu-id="8cead-163">The *certificateThumbprint* should look something like:  AF3143EB61D43F6727842115BB7F17BBCECAECAE</span></span>
* <span data-ttu-id="8cead-164">*certificateName* — понятный идентификатор строки для сертификата. Пользователь может выбрать его по своему усмотрению.</span><span class="sxs-lookup"><span data-stu-id="8cead-164">*certificateName*:  A friendly string identifier of your own choosing used to identity the certificate.</span></span>  <span data-ttu-id="8cead-165">Это имя используется как часть уникального идентификатора Azure Resource Manager для сущности *Microsoft.Web/certificates* , представляющей SSL-сертификат.</span><span class="sxs-lookup"><span data-stu-id="8cead-165">The name is used as part of the unique Azure Resource Manager identifier for the *Microsoft.Web/certificates* entity representing the SSL certificate.</span></span>  <span data-ttu-id="8cead-166">Имя **должно** заканчиваться таким суффиксом: \_имя_ASE_InternalLoadBalancingASE.</span><span class="sxs-lookup"><span data-stu-id="8cead-166">The name **must** end with the following suffix:  \_yourASENameHere_InternalLoadBalancingASE.</span></span>  <span data-ttu-id="8cead-167">Этот суффикс сообщает порталу о том, что для обеспечения безопасности ASE с поддержкой ILB используется сертификат.</span><span class="sxs-lookup"><span data-stu-id="8cead-167">This suffix is used by the portal as an indicator that the certificate is used for securing an ILB-enabled ASE.</span></span>

<span data-ttu-id="8cead-168">Ниже приведен сокращенный пример файла *azuredeploy.parameters.json* .</span><span class="sxs-lookup"><span data-stu-id="8cead-168">An abbreviated example of *azuredeploy.parameters.json* is shown below:</span></span>

    {
         "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json",
         "contentVersion": "1.0.0.0",
         "parameters": {
              "appServiceEnvironmentName": {
                   "value": "yourASENameHere"
              },
              "existingAseLocation": {
                   "value": "East US 2"
              },
              "pfxBlobString": {
                   "value": "MIIKcAIBAz...snip...snip...pkCAgfQ"
              },
              "password": {
                   "value": "PASSWORDGOESHERE"
              },
              "certificateThumbprint": {
                   "value": "AF3143EB61D43F6727842115BB7F17BBCECAECAE"
              },
              "certificateName": {
                   "value": "DefaultCertificateFor_yourASENameHere_InternalLoadBalancingASE"
              }
         }
    }

<span data-ttu-id="8cead-169">Когда файл *azuredeploy.parameters.json* будет заполнен, переходите к настройке SSL-сертификата по умолчанию, используя приведенный ниже фрагмент кода Powershell.</span><span class="sxs-lookup"><span data-stu-id="8cead-169">Once the *azuredeploy.parameters.json* file has been filled in, the default SSL certificate can be configured using the following Powershell code snippet.</span></span>  <span data-ttu-id="8cead-170">Измените пути к файлам в соответствии с расположением файлов шаблонов Azure Resource Manager на вашем компьютере.</span><span class="sxs-lookup"><span data-stu-id="8cead-170">Change the file PATHs to match where the Azure Resource Manager template files are located on your machine.</span></span>  <span data-ttu-id="8cead-171">Кроме того, введите собственные значения для имени развертывания Azure Resource Manager и группы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="8cead-171">Also remember to supply your own values for the Azure Resource Manager deployment name, and resource group name.</span></span>

    $templatePath="PATH\azuredeploy.json"
    $parameterPath="PATH\azuredeploy.parameters.json"

    New-AzureRmResourceGroupDeployment -Name "CHANGEME" -ResourceGroupName "YOUR-RG-NAME-HERE" -TemplateFile $templatePath -TemplateParameterFile $parameterPath

<span data-ttu-id="8cead-172">После отправки шаблона Azure Resource Manager применение изменений для одного внешнего интерфейса ASE займет примерно сорок минут.</span><span class="sxs-lookup"><span data-stu-id="8cead-172">After the Azure Resource Manager template is submitted it will take roughly forty minutes minutes per ASE front-end to apply the change.</span></span>  <span data-ttu-id="8cead-173">Например, для среды ASE с размером по умолчанию, содержащей два внешних интерфейса, реализация шаблона займет примерно один час и двадцать минут.</span><span class="sxs-lookup"><span data-stu-id="8cead-173">For example, with a default sized ASE using two front-ends, the template will take around one hour and twenty minutes to complete.</span></span>  <span data-ttu-id="8cead-174">Во время выполнения шаблона нельзя масштабировать среду ASE.</span><span class="sxs-lookup"><span data-stu-id="8cead-174">While the template is running the ASE will not be able to scaled.</span></span>  

<span data-ttu-id="8cead-175">Когда шаблон будет реализован, к приложениям в среде ASE с внутренним балансировщиком нагрузки можно будет получать доступ по протоколу HTTPS, а подключения будут защищены с помощью SSL-сертификата по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8cead-175">Once the template completes, apps on the ILB ASE can be accessed over HTTPS and the connections will be secured using the default SSL certificate.</span></span>  <span data-ttu-id="8cead-176">SSL-сертификат по умолчанию будет использоваться, если обращение к приложениям в ASE с внутренним балансировщиком нагрузки осуществляется с помощью сочетания имени приложения и имени узла по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8cead-176">The default SSL certificate will be used when apps on the ILB ASE are addressed using a combination of the application name plus the default hostname.</span></span>  <span data-ttu-id="8cead-177">Например, в *https://mycustomapp.internal-contoso.com* будет использоваться сертификат SSL по умолчанию для *.internal-contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="8cead-177">For example *https://mycustomapp.internal-contoso.com* would use the default SSL certificate for **.internal-contoso.com*.</span></span>

<span data-ttu-id="8cead-178">Так же как и для приложений в общедоступной мультитенантной службе, разработчики могут настроить для отдельных приложений пользовательские имена узлов и уникальные привязки сертификатов SNI SSL.</span><span class="sxs-lookup"><span data-stu-id="8cead-178">However, just like apps running on the public multi-tenant service, developers can also configure custom host names for individual apps, and then configure unique SNI SSL certificate bindings for individual apps.</span></span>  

## <a name="getting-started"></a><span data-ttu-id="8cead-179">Приступая к работе</span><span class="sxs-lookup"><span data-stu-id="8cead-179">Getting started</span></span>
<span data-ttu-id="8cead-180">Сведения о том, как начать работу со средами службы приложений, см. в статье [Введение в среду службы приложений](app-service-app-service-environment-intro.md).</span><span class="sxs-lookup"><span data-stu-id="8cead-180">To get started with App Service Environments, see [Introduction to App Service Environment](app-service-app-service-environment-intro.md)</span></span>

<span data-ttu-id="8cead-181">Все статьи и практические руководства, посвященные средам службы приложений, доступны в [файле сведений для сред службы приложений](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="8cead-181">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[quickstartilbasecreate]: https://azure.microsoft.com/documentation/templates/201-web-app-ase-ilb-create/
[examplebase64encoding]: http://powershellscripts.blogspot.com/2007/02/base64-encode-file.html 
[configuringDefaultSSLCertificate]: https://azure.microsoft.com/documentation/templates/201-web-app-ase-ilb-configure-default-ssl/ 

