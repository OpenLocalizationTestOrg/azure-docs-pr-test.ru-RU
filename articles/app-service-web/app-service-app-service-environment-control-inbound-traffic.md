---
title: "aaaHow tooControl входящий трафик tooan среды службы приложений"
description: "Узнайте, как toocontrol правила безопасности сети tooconfigure входящего трафика tooan среды службы приложений."
services: app-service
documentationcenter: 
author: ccompy
manager: erikre
editor: 
ms.assetid: 4cc82439-8791-48a4-9485-de6d8e1d1a08
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/11/2017
ms.author: stefsch
ms.openlocfilehash: e7c6e6201db6a1ea77f7a2eee29a3b5445175495
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="how-toocontrol-inbound-traffic-tooan-app-service-environment"></a><span data-ttu-id="3a09f-103">Как tooan tooControl входящий трафик среды службы приложений</span><span class="sxs-lookup"><span data-stu-id="3a09f-103">How tooControl Inbound Traffic tooan App Service Environment</span></span>
## <a name="overview"></a><span data-ttu-id="3a09f-104">Обзор</span><span class="sxs-lookup"><span data-stu-id="3a09f-104">Overview</span></span>
<span data-ttu-id="3a09f-105">Среду службы приложений можно создать **либо** в виртуальной сети Azure Resource Manager, **либо** в [виртуальной сети][virtualnetwork], использующей классическую модель развертывания.</span><span class="sxs-lookup"><span data-stu-id="3a09f-105">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model [virtual network][virtualnetwork].</span></span>  <span data-ttu-id="3a09f-106">Во время hello при создании среды службы приложений можно определить новую виртуальную сеть и подсеть.</span><span class="sxs-lookup"><span data-stu-id="3a09f-106">A new virtual network and new subnet can be defined at hello time an App Service Environment is created.</span></span>  <span data-ttu-id="3a09f-107">Кроме того, среду службы приложений можно создать в существующих виртуальной сети и подсети.</span><span class="sxs-lookup"><span data-stu-id="3a09f-107">Alternatively, an App Service Environment can be created in a pre-existing virtual network and pre-existing subnet.</span></span>  <span data-ttu-id="3a09f-108">В связи с изменением от июня 2016 г. среды ASE можно также развертывать в виртуальных сетях, использующих либо диапазоны общедоступных адресов, либо адресные пространства RFC1918 (т. е. частные адреса).</span><span class="sxs-lookup"><span data-stu-id="3a09f-108">With a change made in June 2016, ASEs can also be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e. private addresses).</span></span>  <span data-ttu-id="3a09f-109">Дополнительные сведения о создании среды службы приложений см. в разделе [как tooCreate среды службы приложений][HowToCreateAnAppServiceEnvironment].</span><span class="sxs-lookup"><span data-stu-id="3a09f-109">For more details on creating an App Service Environment see [How tooCreate an App Service Environment][HowToCreateAnAppServiceEnvironment].</span></span>

<span data-ttu-id="3a09f-110">Среды службы приложений всегда создаются в одной подсети, так как подсеть предоставляет границы сети, который можно использовать toolock вниз входящий трафик за вышестоящего устройств и служб таким образом, что трафик HTTP и HTTPS принимается только от конкретных вышестоящего IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="3a09f-110">An App Service Environment must always be created within a subnet because a subnet provides a network boundary which can be used toolock down inbound traffic behind upstream devices and services such that HTTP and HTTPS traffic is only accepted from specific upstream IP addresses.</span></span>

<span data-ttu-id="3a09f-111">Входящий и исходящий сетевой трафик в подсети контролируется с помощью [группы сетевой безопасности][NetworkSecurityGroups].</span><span class="sxs-lookup"><span data-stu-id="3a09f-111">Inbound and outbound network traffic on a subnet is controlled using a [network security group][NetworkSecurityGroups].</span></span> <span data-ttu-id="3a09f-112">Входящий трафик управления требует создания правил безопасности сети в группе безопасности сети, а затем добавляют hello сетевой безопасности группы hello подсети содержащего hello среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-112">Controlling inbound traffic requires creating network security rules in a network security group, and then assigning hello network security group hello subnet containing hello App Service Environment.</span></span>

<span data-ttu-id="3a09f-113">После назначения подсети tooa группы безопасности сети, tooapps входящий трафик в приветствия среды службы приложений, разрешены или заблокированы исходя из hello разрешать и запрещать правила, определенные в группы безопасности сети hello.</span><span class="sxs-lookup"><span data-stu-id="3a09f-113">Once a network security group is assigned tooa subnet, inbound traffic tooapps in hello App Service Environment is allowed/blocked based on hello allow and deny rules defined in hello network security group.</span></span>

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="inbound-network-ports-used-in-an-app-service-environment"></a><span data-ttu-id="3a09f-114">Входящие сетевые порты, используемые в среде службы приложений</span><span class="sxs-lookup"><span data-stu-id="3a09f-114">Inbound Network Ports Used in an App Service Environment</span></span>
<span data-ttu-id="3a09f-115">Перед блокировкой вниз входящий сетевой трафик с сетевой группой безопасности, это важные tooknow hello набор обязательных и необязательных сетевые порты, используемые в среде службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-115">Before locking down inbound network traffic with a network security group, it is important tooknow hello set of required and optional network ports used by an App Service Environment.</span></span>  <span data-ttu-id="3a09f-116">Случайное закрытие отключение портов toosome трафика может привести к потере функциональности в среде службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-116">Accidentally closing off traffic toosome ports can result in loss of functionality in an App Service Environment.</span></span>

<span data-ttu-id="3a09f-117">Hello ниже приведен список портов, используемых в среде службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-117">hello following is a list of ports used by an App Service Environment.</span></span> <span data-ttu-id="3a09f-118">Это все **TCP**-порты, если явно не указано иное.</span><span class="sxs-lookup"><span data-stu-id="3a09f-118">All ports are **TCP**, unless otherwise clearly noted:</span></span>

* <span data-ttu-id="3a09f-119">454: **обязательный порт**, используемый инфраструктурой Azure для обслуживания сред службы приложений и управления ими через SSL.</span><span class="sxs-lookup"><span data-stu-id="3a09f-119">454:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="3a09f-120">Не блокируют трафик toothis порта.</span><span class="sxs-lookup"><span data-stu-id="3a09f-120">Do not block traffic toothis port.</span></span>  <span data-ttu-id="3a09f-121">Этот порт всегда является привязанной toohello открытый виртуальный IP-адрес ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-121">This port is always bound toohello public VIP of an ASE.</span></span>
* <span data-ttu-id="3a09f-122">455: **обязательный порт**, используемый инфраструктурой Azure для обслуживания сред службы приложений и управления ими через SSL.</span><span class="sxs-lookup"><span data-stu-id="3a09f-122">455:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="3a09f-123">Не блокируют трафик toothis порта.</span><span class="sxs-lookup"><span data-stu-id="3a09f-123">Do not block traffic toothis port.</span></span>  <span data-ttu-id="3a09f-124">Этот порт всегда является привязанной toohello открытый виртуальный IP-адрес ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-124">This port is always bound toohello public VIP of an ASE.</span></span>
* <span data-ttu-id="3a09f-125">80: порт для входящего трафика HTTP tooapps, работающих в планах обслуживания приложения в среде службы приложений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="3a09f-125">80:  Default port for inbound HTTP traffic tooapps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="3a09f-126">ASE ILB включена этот порт является адрес ILB привязанного toohello hello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-126">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="3a09f-127">443: порт для входящего трафика tooapps SSL, работающих в планах обслуживания приложения в среде службы приложений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="3a09f-127">443: Default port for inbound SSL traffic tooapps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="3a09f-128">ASE ILB включена этот порт является адрес ILB привязанного toohello hello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-128">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="3a09f-129">21: канал управления для FTP.</span><span class="sxs-lookup"><span data-stu-id="3a09f-129">21:  Control channel for FTP.</span></span>  <span data-ttu-id="3a09f-130">Этот порт можно безопасно заблокировано, если FTP не используется.</span><span class="sxs-lookup"><span data-stu-id="3a09f-130">This port can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="3a09f-131">На ASE ILB включена этот порт может быть адрес ILB привязанного toohello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-131">On an ILB-enabled ASE, this port can be bound toohello ILB address for an ASE.</span></span>
* <span data-ttu-id="3a09f-132">990: канал управления для FTPS.</span><span class="sxs-lookup"><span data-stu-id="3a09f-132">990:  Control channel for FTPS.</span></span>  <span data-ttu-id="3a09f-133">Этот порт можно благополучно заблокировать, если не используется FTPS.</span><span class="sxs-lookup"><span data-stu-id="3a09f-133">This port can be safely blocked if FTPS is not being used.</span></span>  <span data-ttu-id="3a09f-134">На ASE ILB включена этот порт может быть адрес ILB привязанного toohello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-134">On an ILB-enabled ASE, this port can be bound toohello ILB address for an ASE.</span></span>
* <span data-ttu-id="3a09f-135">10001 10020: каналы данных для FTP.</span><span class="sxs-lookup"><span data-stu-id="3a09f-135">10001-10020: Data channels for FTP.</span></span>  <span data-ttu-id="3a09f-136">Как канал управления hello, то эти порты безопасно заблокированы, если не используется FTP.</span><span class="sxs-lookup"><span data-stu-id="3a09f-136">As with hello control channel, these ports can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="3a09f-137">На ASE ILB включена этот порт может быть адрес ILB привязанного toohello ASE элемента.</span><span class="sxs-lookup"><span data-stu-id="3a09f-137">On an ILB-enabled ASE, this port can be bound toohello ASE's ILB address.</span></span>
* <span data-ttu-id="3a09f-138">4016: используется для удаленной отладки с помощью Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="3a09f-138">4016: Used for remote debugging with Visual Studio 2012.</span></span>  <span data-ttu-id="3a09f-139">Этот порт может безопасно заблокировано, если не используется функция hello.</span><span class="sxs-lookup"><span data-stu-id="3a09f-139">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="3a09f-140">ASE ILB включена этот порт является адрес ILB привязанного toohello hello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-140">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="3a09f-141">4018: используется для удаленной отладки с помощью Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="3a09f-141">4018: Used for remote debugging with Visual Studio 2013.</span></span>  <span data-ttu-id="3a09f-142">Этот порт может безопасно заблокировано, если не используется функция hello.</span><span class="sxs-lookup"><span data-stu-id="3a09f-142">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="3a09f-143">ASE ILB включена этот порт является адрес ILB привязанного toohello hello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-143">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="3a09f-144">4020: используется для удаленной отладки с помощью Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="3a09f-144">4020: Used for remote debugging with Visual Studio 2015.</span></span>  <span data-ttu-id="3a09f-145">Этот порт может безопасно заблокировано, если не используется функция hello.</span><span class="sxs-lookup"><span data-stu-id="3a09f-145">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="3a09f-146">ASE ILB включена этот порт является адрес ILB привязанного toohello hello ASE.</span><span class="sxs-lookup"><span data-stu-id="3a09f-146">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>

## <a name="outbound-connectivity-and-dns-requirements"></a><span data-ttu-id="3a09f-147">Требования к DNS и исходящим подключениям</span><span class="sxs-lookup"><span data-stu-id="3a09f-147">Outbound Connectivity and DNS Requirements</span></span>
<span data-ttu-id="3a09f-148">Для среды службы приложений toofunction правильно, необходимо также конечные точки toovarious исходящий доступ.</span><span class="sxs-lookup"><span data-stu-id="3a09f-148">For an App Service Environment toofunction properly, it also requires outbound access toovarious endpoints.</span></span> <span data-ttu-id="3a09f-149">Полный список hello внешних конечных точек, используемых ASE представлен в hello раздел «Требуется сетевое подключение» hello [конфигурацию сети для ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) статьи.</span><span class="sxs-lookup"><span data-stu-id="3a09f-149">A full list of hello external endpoints used by an ASE is in hello "Required Network Connectivity" section of hello [Network Configuration for ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) article.</span></span>

<span data-ttu-id="3a09f-150">Среды службы приложений требуется допустимый инфраструктура DNS настроен для hello виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="3a09f-150">App Service Environments require a valid DNS infrastructure configured for hello virtual network.</span></span>  <span data-ttu-id="3a09f-151">Если для любого hello причина будет изменена конфигурация DNS после создания среды службы приложений, разработчики можно принудительно toopick среды службы приложения hello новой конфигурации DNS.</span><span class="sxs-lookup"><span data-stu-id="3a09f-151">If for any reason hello DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment toopick up hello new DNS configuration.</span></span>  <span data-ttu-id="3a09f-152">Последовательное среды перезагрузку, используя значок «Перезапуск» hello hello верхней части колонки управления hello среды службы приложений в hello [портал Azure] [ NewPortal] вызовет toopick среды hello копирование hello новую конфигурацию DNS.</span><span class="sxs-lookup"><span data-stu-id="3a09f-152">Triggering a rolling environment reboot using hello "Restart" icon located at hello top of hello App Service Environment management blade in hello [Azure portal][NewPortal] will cause hello environment toopick up hello new DNS configuration.</span></span>

<span data-ttu-id="3a09f-153">Также рекомендуется обеспечить пользовательские DNS-серверы в виртуальной сети hello установки опережает время предыдущего toocreating среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-153">It is also recommended that any custom DNS servers on hello vnet be setup ahead of time prior toocreating an App Service Environment.</span></span>  <span data-ttu-id="3a09f-154">При создании среды службы приложений при изменении конфигурации DNS виртуальной сети, приведет к сбой процесса создания среды службы приложений hello.</span><span class="sxs-lookup"><span data-stu-id="3a09f-154">If a virtual network's DNS configuration is changed while an App Service Environment is being created, that will result in hello App Service Environment creation process failing.</span></span>  <span data-ttu-id="3a09f-155">Если существует пользовательского DNS-сервера на приветствия другом конце VPN-шлюза и DNS-сервер hello в аналогичные вена, является hello недоступен или недоступен, произойдет сбой процесса создания среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-155">In a similar vein, if a custom DNS server exists on hello other end of a VPN gateway, and hello DNS server is unreachable or unavailable, hello App Service Environment creation process will also fail.</span></span>

## <a name="creating-a-network-security-group"></a><span data-ttu-id="3a09f-156">Создание группы сетевой безопасности</span><span class="sxs-lookup"><span data-stu-id="3a09f-156">Creating a Network Security Group</span></span>
<span data-ttu-id="3a09f-157">Подробные сведения о том, как действия группы безопасности сети см. в разделе ниже hello [сведения][NetworkSecurityGroups].</span><span class="sxs-lookup"><span data-stu-id="3a09f-157">For full details on how network security groups work see hello following [information][NetworkSecurityGroups].</span></span>  <span data-ttu-id="3a09f-158">Пример управления службами Azure Hello ниже штрихи на выделяет групп безопасности сети, имеющий фокус по настройке и применению подсети tooa сетевой безопасности группы, содержащей среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-158">hello Azure Service Management example below touches on highlights of network security groups, with a focus on configuring and applying a network security group tooa subnet that contains an App Service Environment.</span></span>

<span data-ttu-id="3a09f-159">**Примечание:** сетевых групп безопасности можно настроить графически при помощи hello [портала Azure](https://portal.azure.com) или с помощью Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3a09f-159">**Note:** Network security groups can be configured graphically using hello [Azure Portal](https://portal.azure.com) or through Azure PowerShell.</span></span>

<span data-ttu-id="3a09f-160">Сначала группы сетевой безопасности создаются как отдельные сущности, связанные с подпиской.</span><span class="sxs-lookup"><span data-stu-id="3a09f-160">Network security groups are first created as a standalone entity associated with a subscription.</span></span> <span data-ttu-id="3a09f-161">Создания групп безопасности сети в регионе Azure убедитесь в эту группу безопасности сети hello создается в hello же региона, как hello среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-161">Since network security groups are created in an Azure region, ensure that hello network security group is created in hello same region as hello App Service Environment.</span></span>

<span data-ttu-id="3a09f-162">Hello следующий код демонстрирует создание группы безопасности сети:</span><span class="sxs-lookup"><span data-stu-id="3a09f-162">hello following demonstrates creating a network security group:</span></span>

    New-AzureNetworkSecurityGroup -Name "testNSGexample" -Location "South Central US" -Label "Example network security group for an app service environment"

<span data-ttu-id="3a09f-163">После создания группы безопасности сети в одно или несколько правил безопасности сети добавляются tooit.</span><span class="sxs-lookup"><span data-stu-id="3a09f-163">Once a network security group is created, one or more network security rules are added tooit.</span></span>  <span data-ttu-id="3a09f-164">Поскольку hello набор правил может изменяться со временем, рекомендуется toospace out hello схема нумерации, используемый для toomake правило приоритеты его легко tooinsert Дополнительные правила со временем.</span><span class="sxs-lookup"><span data-stu-id="3a09f-164">Since hello set of rules may change over time, it is recommended toospace out hello numbering scheme used for rule priorities toomake it easy tooinsert additional rules over time.</span></span>

<span data-ttu-id="3a09f-165">Hello ниже примере правила, которое явным образом предоставляет порты доступа для управления toohello Затребован toomanage hello инфраструктуры Azure и поддерживать среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-165">hello example below shows a rule that explicitly grants access toohello management ports needed by hello Azure infrastructure toomanage and maintain an App Service Environment.</span></span>  <span data-ttu-id="3a09f-166">Обратите внимание, что весь трафик управления передаются по протоколу SSL и защищен клиентских сертификатов, поэтому несмотря на то, что открыты порты hello они недоступны для любой сущности, отличные от инфраструктуры управления Azure.</span><span class="sxs-lookup"><span data-stu-id="3a09f-166">Note that all management traffic flows over SSL and is secured by client certificates, so even though hello ports are opened they are inaccessible by any entity other than Azure management infrastructure.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "ALLOW AzureMngmt" -Type Inbound -Priority 100 -Action Allow -SourceAddressPrefix 'INTERNET'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '454-455' -Protocol TCP


<span data-ttu-id="3a09f-167">Если блокировка доступа tooport 80 и 443 слишком «скрыть» среды службы приложений за вышестоящего устройства или службы, вы должны будете tooknow hello вышестоящего IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="3a09f-167">When locking down access tooport 80 and 443 too"hide" an App Service Environment behind upstream devices or services, you will need tooknow hello upstream IP address.</span></span>  <span data-ttu-id="3a09f-168">Например, если вы используете брандмауэр веб-приложения (WAF), hello WAF будет иметь собственный IP-адрес (или адреса) который наблюдают использует перенаправление трафика tooa подчиненных среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-168">For example, if you are using a web application firewall (WAF), hello WAF will have its own IP address (or addresses) which it uses when proxying traffic tooa downstream App Service Environment.</span></span>  <span data-ttu-id="3a09f-169">Вам потребуется toouse этот IP-адрес в hello *SourceAddressPrefix* параметр правила безопасности сети.</span><span class="sxs-lookup"><span data-stu-id="3a09f-169">You will need toouse this IP address in hello *SourceAddressPrefix* parameter of a network security rule.</span></span>

<span data-ttu-id="3a09f-170">В следующем примере hello явно разрешенные входящего трафика из конкретного вышестоящего IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="3a09f-170">In hello example below, inbound traffic from a specific upstream IP address is explicitly allowed.</span></span>  <span data-ttu-id="3a09f-171">Здравствуйте, адрес *1.2.3.4* используется как заполнитель для вышестоящего WAF hello IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="3a09f-171">hello address *1.2.3.4* is used as a placeholder for hello IP address of an upstream WAF.</span></span>  <span data-ttu-id="3a09f-172">Изменить hello toomatch значение hello адрес, используемый вышестоящего устройства или службы.</span><span class="sxs-lookup"><span data-stu-id="3a09f-172">Change hello value toomatch hello address used by your upstream device or service.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTP" -Type Inbound -Priority 200 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '80' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTPS" -Type Inbound -Priority 300 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '443' -Protocol TCP

<span data-ttu-id="3a09f-173">Если требуется поддержка FTP, hello правил может использоваться как порт управления FTP toohello шаблона toogrant доступа и портов канала данных.</span><span class="sxs-lookup"><span data-stu-id="3a09f-173">If FTP support is desired, hello following rules can be used as a template toogrant access toohello FTP control port and data channel ports.</span></span>  <span data-ttu-id="3a09f-174">Поскольку FTP — это протокол, с отслеживанием состояния, не могут быть трафик может tooroute FTP через традиционные устройства брандмауэра или прокси-сервера HTTP или HTTPS.</span><span class="sxs-lookup"><span data-stu-id="3a09f-174">Since FTP is a stateful protocol, you may not be able tooroute FTP traffic through a traditional HTTP/HTTPS firewall or proxy device.</span></span>  <span data-ttu-id="3a09f-175">В этом случае вам потребуется tooset hello *SourceAddressPrefix* tooa другое значение — например hello IP адресов машин разработчик или развертывания, на какие FTP клиенты работают под управлением.</span><span class="sxs-lookup"><span data-stu-id="3a09f-175">In this case you will need tooset hello *SourceAddressPrefix* tooa different value - for example hello IP address range of developer or deployment machines on which FTP clients are running.</span></span> 

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPCtrl" -Type Inbound -Priority 400 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '21' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPDataRange" -Type Inbound -Priority 500 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10001-10020' -Protocol TCP

<span data-ttu-id="3a09f-176">(**Примечание:** диапазон портов канала данных hello может измениться в период предварительного просмотра hello.)</span><span class="sxs-lookup"><span data-stu-id="3a09f-176">(**Note:**  hello data channel port range may change during hello preview period.)</span></span>

<span data-ttu-id="3a09f-177">При использовании удаленной отладки в Visual Studio hello правилам показывают, как доступ к toogrant.</span><span class="sxs-lookup"><span data-stu-id="3a09f-177">If remote debugging with Visual Studio is used, hello following rules demonstrate how toogrant access.</span></span>  <span data-ttu-id="3a09f-178">Существует отдельное правило для каждой поддерживаемой версии Visual Studio, поскольку каждая версия использует другой порт для удаленной отладки.</span><span class="sxs-lookup"><span data-stu-id="3a09f-178">There is a separate rule for each supported version of Visual Studio since each version uses a different port for remote debugging.</span></span>  <span data-ttu-id="3a09f-179">Как и для FTP-доступа, трафик удаленной отладки не может правильно проходить через традиционный брандмауэр WAF или прокси-устройство.</span><span class="sxs-lookup"><span data-stu-id="3a09f-179">As with FTP access, remote debugging traffic may not flow properly through a traditional WAF or proxy device.</span></span>  <span data-ttu-id="3a09f-180">Hello *SourceAddressPrefix* можно задать диапазон IP-адресов toohello машин разработчика Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3a09f-180">hello *SourceAddressPrefix* can instead be set toohello IP address range of developer machines running Visual Studio.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2012" -Type Inbound -Priority 600 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4016' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2013" -Type Inbound -Priority 700 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4018' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2015" -Type Inbound -Priority 800 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4020' -Protocol TCP

## <a name="assigning-a-network-security-group-tooa-subnet"></a><span data-ttu-id="3a09f-181">Назначение группы безопасности сети tooa подсети</span><span class="sxs-lookup"><span data-stu-id="3a09f-181">Assigning a Network Security Group tooa Subnet</span></span>
<span data-ttu-id="3a09f-182">Группа безопасности сети имеет правило безопасности по умолчанию, которое запрещает доступ tooall внешнего трафика.</span><span class="sxs-lookup"><span data-stu-id="3a09f-182">A network security group has a default security rule which denies access tooall external traffic.</span></span>  <span data-ttu-id="3a09f-183">Здравствуйте, в результате объединения правил безопасности сети hello, описанной выше и Здравствуйте правило безопасности по умолчанию блокирует входящий трафик, что только трафик из диапазонов адресов источника связан с *Разрешить* смогут действия tooapps toosend трафика, работающих в среде службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-183">hello result from combining hello network security rules described above, and hello default security rule blocking inbound traffic, is that only traffic from source address ranges associated with an *Allow* action will be able toosend traffic tooapps running in an App Service Environment.</span></span>

<span data-ttu-id="3a09f-184">После заполнения группы безопасности сети с правилами безопасности ему назначены toobe toohello подсети, где hello среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-184">After a network security group is populated with security rules, it needs toobe assigned toohello subnet containing hello App Service Environment.</span></span>  <span data-ttu-id="3a09f-185">Команда назначения Hello ссылается обоих имя hello hello виртуальной сети, где находится hello среды службы приложений, а также имя hello hello подсети, где был создан hello среды службы приложений.</span><span class="sxs-lookup"><span data-stu-id="3a09f-185">hello assignment command references both hello name of hello virtual network where hello App Service Environment resides, as well as hello name of hello subnet where hello App Service Environment was created.</span></span>  

<span data-ttu-id="3a09f-186">Hello ниже примере сетевой группы безопасности, присваиваемого tooa подсети и виртуальной сети:</span><span class="sxs-lookup"><span data-stu-id="3a09f-186">hello example below shows a network security group being assigned tooa subnet and virtual network:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityGroupToSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

<span data-ttu-id="3a09f-187">После успешного выполнения Назначение группы безопасности сети hello (hello назначения длительные операции и может занять несколько минут toocomplete), только входящий трафик сопоставления *Разрешить* правила успешно достигнет приложения в приложение hello Среда службы.</span><span class="sxs-lookup"><span data-stu-id="3a09f-187">Once hello network security group assignment succeeds (hello assignment is a long-running operations and can take a few minutes toocomplete), only inbound traffic matching *Allow* rules will successfully reach apps in hello App Service Environment.</span></span>

<span data-ttu-id="3a09f-188">Для полноты hello следующем примере показано, как группировать tooremove и, следовательно, несвязанные сопоставление hello сетевой безопасности из подсети hello:</span><span class="sxs-lookup"><span data-stu-id="3a09f-188">For completeness hello following example shows how tooremove and thus dis-associate hello network security group from hello subnet:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Remove-AzureNetworkSecurityGroupFromSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

## <a name="special-considerations-for-explicit-ip-ssl"></a><span data-ttu-id="3a09f-189">Специальные рекомендации для SSL на основе явного IP</span><span class="sxs-lookup"><span data-stu-id="3a09f-189">Special Considerations for Explicit IP-SSL</span></span>
<span data-ttu-id="3a09f-190">Если приложение настроено с явную SSL на ОСНОВЕ IP-адресом (применимо *только* tooASEs, имеющий открытый виртуальный IP-адрес), вместо того чтобы использовать IP-адрес по умолчанию hello hello среды службы приложений, HTTP и HTTPS-трафик потоков в подсети hello над набором порты, отличные от порты 80 и 443.</span><span class="sxs-lookup"><span data-stu-id="3a09f-190">If an app is configured with an explicit IP-SSL address (applicable *only* tooASEs that have a public VIP), instead of using hello default IP address of hello App Service Environment, both HTTP and HTTPS traffic flows into hello subnet over a different set of ports other than ports 80 and 443.</span></span>

<span data-ttu-id="3a09f-191">Hello отдельные пары порты, используемые каждого SSL на ОСНОВЕ IP-адреса можно найти в hello пользовательского интерфейса портала из колонки UX сведения среды для hello приложения службы.</span><span class="sxs-lookup"><span data-stu-id="3a09f-191">hello individual pair of ports used by each IP-SSL address can be found in hello portal user interface from hello App Service Environment's details UX blade.</span></span>  <span data-ttu-id="3a09f-192">Выберите "Все параметры" > "IP-адреса".</span><span class="sxs-lookup"><span data-stu-id="3a09f-192">Select "All settings" --> "IP addresses".</span></span>  <span data-ttu-id="3a09f-193">Колонка Hello «IP-адреса» показана таблица, все явно настроен SSL на ОСНОВЕ IP-адресов для hello среды службы приложений, вместе с парой особого порта hello, которая используется tooroute трафик HTTP и HTTPS, связанный с каждого SSL на ОСНОВЕ IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="3a09f-193">hello "IP addresses" blade shows a table of all explicitly configured IP-SSL addresses for hello App Service Environment, along with hello special port pair that is used tooroute HTTP and HTTPS traffic associated with each IP-SSL address.</span></span>  <span data-ttu-id="3a09f-194">Это Эта пара порта, который должен использовать hello DestinationPortRange параметров при настройке правила в группе безопасности сети toobe.</span><span class="sxs-lookup"><span data-stu-id="3a09f-194">It is this port pair that needs toobe used for hello DestinationPortRange parameters when configuring rules in a network security group.</span></span>

<span data-ttu-id="3a09f-195">Когда приложения на ASE настроенных toouse SSL на ОСНОВЕ IP, внешних клиентов не будут видеть и не обязательно tooworry о сопоставлении пары hello особого порта.</span><span class="sxs-lookup"><span data-stu-id="3a09f-195">When an app on an ASE is configured toouse IP-SSL, external customers will not see and do not need tooworry about hello special port pair mapping.</span></span>  <span data-ttu-id="3a09f-196">Приложения toohello трафик будет передаваться обычно toohello настроить SSL на ОСНОВЕ IP адрес.</span><span class="sxs-lookup"><span data-stu-id="3a09f-196">Traffic toohello apps will flow normally toohello configured IP-SSL address.</span></span>  <span data-ttu-id="3a09f-197">Пара особого порта toohello перевод Hello автоматически происходит внутренним образом во время hello заключительный сегмент маршрутизации трафика в hello ASE содержащего подсеть hello.</span><span class="sxs-lookup"><span data-stu-id="3a09f-197">hello translation toohello special port pair automatically happens internally during hello final leg of routing traffic into hello subnet containing hello ASE.</span></span> 

## <a name="getting-started"></a><span data-ttu-id="3a09f-198">Приступая к работе</span><span class="sxs-lookup"><span data-stu-id="3a09f-198">Getting started</span></span>
<span data-ttu-id="3a09f-199">tooget к работе с среды службы приложения, в разделе [tooApp введение среды службы][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="3a09f-199">tooget started with App Service Environments, see [Introduction tooApp Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="3a09f-200">Все статьи и как-для пользователя для среды службы приложений теперь доступны в hello [файл README для среды службы приложения](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="3a09f-200">All articles and How-To's for App Service Environments are available in hello [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="3a09f-201">Дополнительные сведения о приложениях безопасного соединения toobackend ресурсов из среды службы приложений см. в разделе [безопасного соединения tooBackend ресурсов из среды службы приложений][SecurelyConnecttoBackend]</span><span class="sxs-lookup"><span data-stu-id="3a09f-201">For details around apps securely connecting toobackend resource from an App Service Environment, see [Securely connecting tooBackend resources from an App Service Environment][SecurelyConnecttoBackend]</span></span>

<span data-ttu-id="3a09f-202">Дополнительные сведения о платформе hello службе приложений Azure см. в разделе [службе приложений Azure][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="3a09f-202">For more information about hello Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[SecurelyConnecttoBackend]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-securely-connecting-to-backend-resources/
[NewPortal]:  https://portal.azure.com  

<!-- IMAGES -->

