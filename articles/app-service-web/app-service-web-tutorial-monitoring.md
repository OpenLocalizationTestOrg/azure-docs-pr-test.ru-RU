---
title: "веб-приложения aaaMonitor | Документы Microsoft"
description: "Узнайте, как tooset копирование мониторинг на веб-приложения"
services: App-Service
keywords: 
author: btardif
ms.author: byvinyal
ms.date: 04/04/2017
ms.topic: article
ms.service: app-service-web
ms.openlocfilehash: c2f5e9842c732a804f1caee5d67e53dad24e190a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-app-service"></a>Мониторинг службы приложений
В этом учебнике рассматриваются путем отслеживания приложения и с помощью hello встроенных средств toosolve проблем платформы, при их возникновении.

Каждый раздел этого документа посвящен определенной функции. Совместное использование функций hello позволяют:
- выявить проблему в приложении;
- Определение, когда hello проблема вызвана вашего кода или hello платформы.
- Отфильтровать hello источник hello проблемы в коде.
- Отладка и исправление проблемы hello.

## <a name="before-you-begin"></a>Перед началом работы
- Требуется toomonitor веб-приложение и выполните hello описанные действия.
    - Можно создать приложение hello действий, описанных в hello [создания приложения ASP.NET в Azure с базой данных SQL](app-service-web-tutorial-dotnet-sqldatabase.md) учебника.

- Если требуется tootry out **удаленной отладки** приложения, требуется Visual Studio.
    - Если у вас еще нет Visual Studio 2017 г. установлен, можно загрузить и использовать hello свободного [2017 г. Visual Studio Community Edition](https://www.visualstudio.com/downloads/).
    - Убедитесь, что включен **разработки Azure** во время установки Visual Studio hello.

## <a name="metrics"></a>Шаг 1. Просмотр метрик
**Метрики** являются полезным toounderstand:
- Работоспособность приложения
- Производительность приложения
- Потребление ресурсов

При исследовании проблемы приложения, просмотрев метрики является toostart лучше всего. Портал Azure имеет toovisually быстрый способ проверить приложения с использованием метрик hello **монитора Azure**.

Метрики обеспечивают историческое представление по нескольким ключевым агрегатам для вашего приложения. Для любого приложения, размещенного в службе приложений необходимо отслеживать hello веб-приложения и hello план служб приложений.

> [!NOTE]
> План службы приложений представляет коллекцию hello toohost физические ресурсы, используемые приложения. Все приложения назначенные tooan службы приложений плана общего ресурса hello ресурсы определяемое позволяя toosave затрат при размещении нескольких приложений.
>
> Планы службы приложений определяют такие компоненты:
> * Регион: Северная Европа, восточная часть США, Юго-Восточная Азия и т. д.
> * Размер экземпляра: небольшой, средний, крупный и т. д.
> * Число масштабируемых элементов: один, два, три экземпляра и т. д.
> * SKU: "Бесплатный", "Общий", "Базовый", "Стандартный", "Премиум" и т. д.

tooreview метрики для веб-приложения, перейдите toohello **Обзор** колонке приложение hello нужно toomonitor. Здесь можно просмотреть диаграмму для метрик приложения в **элементе "Мониторинг"**. Щелкните плитку tooedit hello и настроить какие tooview метрик и hello toodisplay диапазона времени.

По колонки ресурсов по умолчанию hello предоставляет представления для hello запросы приложений и ошибок для hello последний час.
![Мониторинг приложения](media/app-service-web-tutorial-monitoring/app-service-monitor.png)

Как видно в примере hello, у нас есть приложение, которое создает многие **ошибки HTTP сервера**. Hello большого количества ошибок — hello первое Указание, что нам нужна tooinvestigate этого приложения.

> [!TIP]
> Дополнительные сведения о мониторе Azure с hello ссылкам:
> - [Приступая к работе с Azure Monitor](..\monitoring-and-diagnostics\monitoring-overview.md)
> - [Метрики Azure](..\monitoring-and-diagnostics\monitoring-overview-metrics.md)
> - [Метрики, поддерживаемые Azure Monitor](..\monitoring-and-diagnostics\monitoring-supported-metrics.md)
> - [Панели мониторинга Azure](..\azure-portal\azure-portal-dashboards.md)

## <a name="alerts"></a> Шаг 2. Настройка оповещений
**Оповещения** может быть tootrigger, настроенный на определенных условий для вашего приложения.

В [шаг 1 - Просмотр метрик](#metrics), мы узнали, что приложение hello имеет большое количество ошибок.

Позволяет настроить оповещение tooautomatically получение уведомлений при возникновении ошибок. В этом случае мы должны предупреждения toosend hello и электронной почты каждый раз hello количество ошибок HTTP 50 X превышает определенный порог.

toocreate оповещения, перейдите в слишком**мониторинг** > **оповещения** и нажмите кнопку **[+] добавить оповещение**.

![Оповещения](media/app-service-web-tutorial-monitoring/app-service-monitor-alerts.png)

Укажите значения для конфигурации оповещений hello:
- **Ресурс:** hello toomonitor сайта с предупреждением hello.
- **Имя:** имя оповещения, в данном случае это *High HTTP 50X* (Большое число HTTP 50X).
- **Описание:** пояснение, что отслеживает это оповещение, в виде обычного текста.
- **Оповещения включены:** оповещения могут отслеживать метрики или события. В этом примере нас интересуют метрики.
- **Метрика:** какие метрики toomonitor в данном случае: *ошибки HTTP сервера*.
- **Условие:** при tooalert, в данном случае выберите hello *больше* параметр.
- **Пороговое значение:** toolook значение, что в этом случае является: *400*.
- **Период:** оповещения оперируют hello среднее значение метрики. При уменьшении периодов чувствительность оповещений возрастает. В данном случае мы используем значение *5 минут*.
- **Email Owners and contributors** (Участники и владельцы электронной почты): в данном случае установлено значение *Включено*.

Теперь, когда hello предупреждение создается сообщение электронной почты отправляется при каждом hello приложение переходит выше порогового значения настроен hello. Активные предупреждения также могут быть просмотрены hello портал Azure.

![Активированные оповещения](media/app-service-web-tutorial-monitoring/app-service-monitor-alerts-triggered.png)


> [!TIP]
> Дополнительные сведения о Azure Alerts с hello ссылкам:
> - [Что такое оповещения в Microsoft Azure](..\monitoring-and-diagnostics\monitoring-overview-alerts.md)
> - [Действия с метриками](..\monitoring-and-diagnostics\monitoring-overview.md)
> - [Создание оповещений о метриках](..\monitoring-and-diagnostics\insights-alerts-portal.md)

## <a name="companion"></a> Шаг 3. Дополнительное приложение для службы приложений
**Дополнительное приложение службы** обеспечивает удобный способ toomonitor приложения с собственным взаимодействием в мобильном устройстве (iOS или Android).

Вспомогательное приложение для службы приложений Azure позволяет выполнять следующие действия:
- Просматривать метрики приложения.
- Просматривать уведомления для приложения и выполнять необходимые действия, а также получать рекомендации.
- Выполните устранение основных неполадок (обзора, запуск, остановка, перезапуск приложения hello)
- Получать push-уведомления о важных событиях.

![Вспомогательное приложение для службы приложений](media/app-service-web-tutorial-monitoring/app-service-companion.png)

[![Вспомогательное приложение для службы приложений в магазине приложений](media/app-service-web-tutorial-monitoring/app-service-companion-appStore.png)](https://itunes.apple.com/app/azure-app-service-companion/id1146659260)
[![Вспомогательное приложение для службы приложений в Google Play](media/app-service-web-tutorial-monitoring/app-service-companion-googlePlay.png)](https://play.google.com/store/apps/details?id=azureApps.AzureApps)

Вы можете установить дополнительное приложение службы из hello [App Store](https://itunes.apple.com/app/azure-app-service-companion/id1146659260) или [Google Play](https://play.google.com/store/apps/details?id=azureApps.AzureApps)

## <a name="diagnose"></a> Шаг 4. Диагностика и решение проблем
Пункт **Диагностика и решение проблем** помогает отделить проблемы приложений от проблем платформы. Он может предложить возможные меры сдерживания tooget задней toohealthy вашего веб-приложения.

![Диагностика и решение проблем](media/app-service-web-tutorial-monitoring/app-service-monitor-diagnosis.png)

Продолжая hello пример формы предыдущих шагах, мы видим, что приложение hello эксклюзивном возникли проблемы с. Напротив доступность платформы hello не перемещен из 100%.

При приложение hello испытывает проблемы и hello остается платформы вверх, это индикации, сейчас мы работаем с проблемы приложения.

## <a name="logging"></a> Шаг 5. Ведение журналов
Теперь, когда мы сужается tooan приложения hello сбоев проблему, можно взглянуть на tooget журналы сервера и приложения hello Дополнительные сведения.

Ведение журнала позволяет toocollect оба **Application Diagnostics** и **диагностики Web Server** журналов для веб-приложения.

### <a name="application-diagnostics"></a>Диагностика приложений
Диагностика приложений позволяет вам toocapture трассировки, создаваемые во время выполнения приложения hello.

Добавление tooyour трассировки приложения значительно улучшает вашей проблемы точки ПИН-кода и возможность toodebug.

В ASP.NET, можно записывать в журнал трассировки приложения с помощью [класса System.Diagnostics.Trace](https://msdn.microsoft.com/library/system.diagnostics.trace.aspx) toogenerate события, записываемые в журнал инфраструктурой hello. Можно также указать hello серьезность hello трассировки для упрощения фильтрации.

```csharp
public ActionResult Delete(Guid? id)
{
    System.Diagnostics.Trace.TraceInformation("GET /Todos/Delete/" + id);
    if (id == null)
    {
        System.Diagnostics.Trace.TraceError("/Todos/Delete/ failed, ID is null");
        return new HttpStatusCodeResult(HttpStatusCode.BadRequest);
    }
    Todo todo = db.Todoes.Find(id);
    if (todo == null)
    {
        System.Diagnostics.Trace.TraceWarning("/Todos/Delete/ failed, ID: " + id + " could not be found");
        return HttpNotFound();
    }
    System.Diagnostics.Trace.TraceInformation("GET /Todos/Delete/" + id + "completed successfully");
    return View(todo);
}
```
Ведение журналов для приложений tooenable Go слишком**мониторинг** > **журналы диагностики** и включить ведение журнала приложения с помощью переключателей hello.

![Мониторинг приложения](media/app-service-web-tutorial-monitoring/app-service-monitor-applogs.png)

Журналы приложений могут быть хранимые tooyour веб-приложения файловой системы или распространить tooblob хранилища. Для рабочих сценариев это рекомендуемый toouse хранилища больших двоичных объектов.

> [!IMPORTANT]
> Ведение журналов оказывает влияние на производительность приложения и использование ресурсов. В рабочей среде рекомендуется вести журналы ошибок. Более подробное ведение журнала следует использовать только при устранении ошибок.

 ### <a name="web-server-diagnostics"></a>Диагностика веб-сервера
Журналы веб-сервера создаются, даже если приложение не инструментировано. Служба приложений может собирать сведения для трех различных типов журналов сервера:

- **Ведение журнала веб-сервера**
    - Сведения о HTTP-транзакций с помощью hello [расширенного формата файла журнала W3C](https://msdn.microsoft.com/library/windows/desktop/aa814385.aspx).
    - Это удобно при определении общей сайта метрик, таких как количество hello запросы обрабатываются или сколько запросы отправляются определенный IP-адрес.
- **Ведение журнала подробных ошибок**
    - Подробные сведения об ошибке для кодов состояния HTTP, которые указывают на сбой (код состояния 400 и выше).
    - [Дополнительные сведения о подробных журналах ошибок](https://www.iis.net/learn/troubleshoot/diagnosing-http-errors/how-to-use-http-detailed-errors-in-iis)
- **Трассировка невыполненных запросов**
    - Подробные сведения о невыполненных запросов, включая трассировку компонентов IIS hello используется tooprocess hello запроса и hello время, затраченное в каждом компоненте.
    - Журналы невыполненных запросов полезны при попытке tooisolate причину возникновения определенной ошибки HTTP.
    - [Дополнительные сведения о трассировке невыполненных запросов](https://www.iis.net/learn/troubleshoot/using-failed-request-tracing/troubleshooting-failed-requests-using-tracing-in-iis)

Ведение журнала tooenable сервера:
- go слишком**мониторинг** > **журналы диагностики**.
- Включение различных типов hello Web Server диагностики с помощью переключателей hello.

![Мониторинг приложения](media/app-service-web-tutorial-monitoring/app-service-monitor-serverlogs.png)

> [!IMPORTANT]
> Ведение журналов оказывает влияние на производительность приложения и использование ресурсов. В рабочей среде рекомендуется вести журналы ошибок. Более подробное ведение журнала следует использовать только при устранении ошибок.

### <a name="accessing-logs"></a>Доступ к журналам
Для доступа к журналам в хранилище BLOB-объектов используется обозреватель хранилищ Azure. Журналов, хранящихся в файловой системе веб-приложения hello осуществляется по протоколу FTP в разделе hello, следующие пути:

- **Журналы приложений** - `%HOME%/LogFiles/Application/`.
    - Эта папка содержит один или несколько текстовых файлов со сведениями, созданными при ведении журнала приложения.
- **Трассировка невыполненных запросов** - `%HOME%/LogFiles/W3SVC#########/`.
    - Эта папка содержит XSL-файл и один или несколько XML-файлов.
- **Подробные журналы ошибок** - `%HOME%/LogFiles/DetailedErrors/`.
    - Эта папка содержит один или несколько HTML-файлов с подробными сведениями об ошибках HTTP, которые возникли в вашем приложении.
- **Журналы веб-сервера** - `%HOME%/LogFiles/http/RawLogs`.
    - Эта папка содержит один или несколько текстовых файлов в формате с помощью расширенного формата файла журнала hello W3C.

## <a name="streaming"></a> Шаг 6. Потоковая передача журналов
Журналы потоковой передачи удобны при отладке приложения, так как он позволяет сэкономить время, сравнивать слишком[доступе к журналам hello](#Accessing-Logs) по протоколу FTP.

Служба приложения может передавать **журналы приложений** и **журналы веб-сервера** при их создании.

> [!TIP]
> Прежде чем журналы toostream, убедитесь, что вы включили сбор журналов, как описано в hello [ведение журнала](#logging) раздела.

журналы toostream go слишком**мониторинг**> **потока журнала**. Выберите **Журналы приложений** или **Журналы веб-сервера** в зависимости от того, какие сведения вам необходимы. Здесь можно также Приостановка, перезапуск и очистку буфера hello.

![Журналы потоковой передачи](media/app-service-web-tutorial-monitoring/app-service-monitor-logstream.png)

> [!TIP]
> Журналы создаются только в том случае, когда приложение hello трафика, можно также увеличить уровень детализации hello tooget журналы дополнительные события и сведения.

## <a name="remote"></a> Шаг 7. Удаленная отладка
После получения ПИН-кода указывает hello источником проблем приложения hello использовать **удаленной отладки** toowalk посредством кода hello.

Удаленная отладка позволяет присоединить отладчик tooyour веб-приложение работает в облаке hello. Можно установить точки останова, напрямую управлять памяти, пошагового выполнения кода и даже изменить путь кода hello так же, как и для приложения, работающего локально.

tooattach hello отладчик tooyour приложение, работающее в облаке hello:

- С помощью Visual Studio 2017 г., Привет открыть решение для приложения hello требуется toodebug
- Установите несколько точек останова так же, как и для локального приложения.
- Откройте **Cloud Explorer** (CTRL+/, CTRL+X).
- При необходимости войдите в систему с учетными данными Azure.
- Требуется toodebug приложение hello поиска
- Выберите **подключить отладчик** hello формы **действия** области.

![Удаленная отладка](media/app-service-web-tutorial-monitoring/app-service-monitor-vsdebug.png)

Настраивает приложение для удаленной отладки Visual Studio и открывает окно браузера, который осуществляет переход приложения tooyour. Просматривайте заданных точек останова tootrigger приложения и пошагового выполнения кода hello.

> [!WARNING]
> В рабочей среде выполнение в режиме отладки не рекомендуется. Если на рабочее приложение не масштабировать toomultiple экземпляров сервера, отладка не hello веб-сервера от отвечает tooother запросов. Для устранения неполадок производства, лучший ресурс является слишком[настроить ведение журнала](#logging) и [Application Insights](#insights).



## <a name="explorer"></a> Шаг 8. Обозреватель процессов
При масштабировании приложения out toomore более одной операции **обозреватель процессов** может помочь выявить проблемы конкретного экземпляра.

С помощью **обозревателя процессов** можно выполнять следующие действия:

- Перечислить все процессы hello среди различных экземпляров плана служб приложений.
- Детализацию и просмотр hello дескрипторов и модулей, связанных с каждым процессом.
- Число ЦП представление рабочего набора и потока при hello обработать уровня toohelp, необходимо указать предельное число процессов
- Находить открытые дескрипторы файлов и даже завершать конкретные экземпляры процессов.

Чтобы открыть обозреватель процессов, выберите **Мониторинг** > **Обозреватель процессов**.

![Обозреватель процессов](media/app-service-web-tutorial-monitoring/app-service-monitor-processexplorer.png)


## <a name="insights"></a> Шаг 9. Application Insights
**Application Insights** предоставляет функции профилирования и расширенные функции мониторинга для вашего приложения.

Используйте toodetect Application Insights и диагностика исключений и проблем с производительностью в веб-приложения.

Вы можете включить Application Insights для своего веб-приложения в разделе **Мониторинг** > **Application Insights**.

> [!NOTE]
> Application Insights может предложить tooinstall hello Application Insights узел расширения toostart сбора данных. Установка расширения сайта hello вызывает перезапуск приложения.

![Application Insights](media/app-service-web-tutorial-monitoring/app-service-monitor-appinsights.png)

Аналитика приложений имеет обширных возможностей задано, toolearn более, ссылкам hello состава hello [дальнейшие действия](#next) раздела.

## <a name="next"></a> Дальнейшие действия

 - [Что такое Application Insights](..\application-insights\app-insights-overview.md)
 - [Мониторинг производительности веб-приложения Azure с помощью Application Insights](..\application-insights\app-insights-azure-web-apps.md)
 - [Мониторинг доступности и скорости реагирования веб-сайта с помощью Application Insights](..\application-insights\app-insights-monitor-web-app-availability.md)
