---
title: "Устранение неполадок веб-приложения в службе приложений Azure с помощью Visual Studio"
description: "Узнайте, как устранять неполадки в работе веб-приложения Azure с помощью удаленной отладки, трассировки и средств ведения журналов, которые встроены в Visual Studio 2013."
services: app-service
documentationcenter: .net
author: tdykstra
manager: erikre
editor: 
ms.assetid: def8e481-7803-4371-aa55-64025d116c97
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 08/29/2016
ms.author: rachelap
ms.openlocfilehash: abfd9a4c1b346377d7f1fc30455a1487b113537d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="troubleshoot-a-web-app-in-azure-app-service-using-visual-studio"></a><span data-ttu-id="d973a-103">Устранение неполадок веб-приложения в службе приложений Azure с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d973a-103">Troubleshoot a web app in Azure App Service using Visual Studio</span></span>
## <a name="overview"></a><span data-ttu-id="d973a-104">Обзор</span><span class="sxs-lookup"><span data-stu-id="d973a-104">Overview</span></span>
<span data-ttu-id="d973a-105">В этом руководстве показано, как использовать инструменты Visual Studio, которые позволяют отлаживать работу веб-приложения в [службе приложений](http://go.microsoft.com/fwlink/?LinkId=529714) путем запуска веб-приложения удаленно в [режиме отладки](http://www.visualstudio.com/get-started/debug-your-app-vs.aspx) или путем просмотра журналов приложения и веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="d973a-105">This tutorial shows how to use Visual Studio tools that help debug a web app in [App Service](http://go.microsoft.com/fwlink/?LinkId=529714), by running in [debug mode](http://www.visualstudio.com/get-started/debug-your-app-vs.aspx) remotely or by viewing application logs and web server logs.</span></span>

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

<span data-ttu-id="d973a-106">Вы узнаете следующее:</span><span class="sxs-lookup"><span data-stu-id="d973a-106">You'll learn:</span></span>

* <span data-ttu-id="d973a-107">Какие функции управления веб-приложением Azure доступны в среде Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d973a-107">Which Azure web app management functions are available in Visual Studio.</span></span>
* <span data-ttu-id="d973a-108">Как использовать удаленное представление Visual Studio для быстрого изменения удаленного веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-108">How to use Visual Studio remote view to make quick changes in a remote web app.</span></span>
* <span data-ttu-id="d973a-109">Как удаленно запустить режим отладки для веб-приложения и веб-задания, если проект запущен в Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-109">How to run debug mode remotely while a project is running in Azure, both for a web app and for a WebJob.</span></span>
* <span data-ttu-id="d973a-110">Как создать журналы трассировки приложения и просматривать их непосредственно во время создания.</span><span class="sxs-lookup"><span data-stu-id="d973a-110">How to create application trace logs and view them while the application is creating them.</span></span>
* <span data-ttu-id="d973a-111">Как просматривать журналы веб-сервера, включая подробные сообщения об ошибках и трассировку неудачно завершившихся запросов.</span><span class="sxs-lookup"><span data-stu-id="d973a-111">How to view web server logs, including detailed error messages and failed request tracing.</span></span>
* <span data-ttu-id="d973a-112">Как отправлять диагностические журналы в учетную запись хранения Azure и просматривать их там.</span><span class="sxs-lookup"><span data-stu-id="d973a-112">How to send diagnostic logs to an Azure Storage account and view them there.</span></span>

<span data-ttu-id="d973a-113">Если у вас установлена Visual Studio Ultimate, вы также можете использовать [IntelliTrace](http://msdn.microsoft.com/library/vstudio/dd264915.aspx) для отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-113">If you have Visual Studio Ultimate, you can also use [IntelliTrace](http://msdn.microsoft.com/library/vstudio/dd264915.aspx) for debugging.</span></span> <span data-ttu-id="d973a-114">Использование IntelliTrace не рассматривается в этом учебнике.</span><span class="sxs-lookup"><span data-stu-id="d973a-114">IntelliTrace is not covered in this tutorial.</span></span>

## <span data-ttu-id="d973a-115"><a name="prerequisites"></a>Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="d973a-115"><a name="prerequisites"></a>Prerequisites</span></span>
<span data-ttu-id="d973a-116">В этом руководстве речь идет о среде разработки, веб-проекте и веб-приложении Azure, которые вы настроили, следуя инструкциям в статье [Начало работы с Azure и ASP.NET][GetStarted].</span><span class="sxs-lookup"><span data-stu-id="d973a-116">This tutorial works with the development environment, web project, and Azure web app that you set up in [Get started with Azure and ASP.NET][GetStarted].</span></span> <span data-ttu-id="d973a-117">Для разделов, посвященных веб-заданиям, вам понадобится приложение, созданное при изучении руководства [Начало работы с пакетом SDK для Azure для веб-заданий][GetStartedWJ].</span><span class="sxs-lookup"><span data-stu-id="d973a-117">For the WebJobs sections, you'll need the application that you create in [Get Started with the Azure WebJobs SDK][GetStartedWJ].</span></span>

<span data-ttu-id="d973a-118">В этом учебнике приводятся примеры кода для веб-приложения C# MVC, однако в приложениях Visual Basic и веб-форм применяются те же процедуры устранения неполадок.</span><span class="sxs-lookup"><span data-stu-id="d973a-118">The code samples shown in this tutorial are for a C# MVC web application, but the troubleshooting procedures are the same for Visual Basic and Web Forms applications.</span></span>

<span data-ttu-id="d973a-119">В учебнике предполагается, что вы используете Visual Studio 2015 или 2013.</span><span class="sxs-lookup"><span data-stu-id="d973a-119">The tutorial assumes you're using Visual Studio 2015 or 2013.</span></span> <span data-ttu-id="d973a-120">Если вы используете Visual Studio 2013, для веб-заданий требуется [обновление 4](http://go.microsoft.com/fwlink/?LinkID=510314) или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="d973a-120">If you're using Visual Studio 2013, the WebJobs features require [Update 4](http://go.microsoft.com/fwlink/?LinkID=510314) or later.</span></span>

<span data-ttu-id="d973a-121">Журналы потоковой передачи работают только для приложений, которые предназначены для .NET Framework 4 и выше.</span><span class="sxs-lookup"><span data-stu-id="d973a-121">The streaming logs feature only works for applications that target .NET Framework 4 or later.</span></span>

## <span data-ttu-id="d973a-122"><a name="sitemanagement"></a>Настройка веб-приложения и управление им</span><span class="sxs-lookup"><span data-stu-id="d973a-122"><a name="sitemanagement"></a>Web app configuration and management</span></span>
<span data-ttu-id="d973a-123">Visual Studio обеспечивает доступ к подмножеству функций управления веб-приложением и параметров конфигурации, доступных на [портале Azure](http://go.microsoft.com/fwlink/?LinkId=529715).</span><span class="sxs-lookup"><span data-stu-id="d973a-123">Visual Studio provides access to a subset of the web app management functions and configuration settings available in the [Azure Portal](http://go.microsoft.com/fwlink/?LinkId=529715).</span></span> <span data-ttu-id="d973a-124">В этом разделе вы узнаете, какие функции доступны, с помощью **Обозревателя серверов**.</span><span class="sxs-lookup"><span data-stu-id="d973a-124">In this section you'll see what's available by using **Server Explorer**.</span></span> <span data-ttu-id="d973a-125">Для просмотра новых функций интеграции Azure также воспользуйтесь **Обозревателем облака** .</span><span class="sxs-lookup"><span data-stu-id="d973a-125">To see the latest Azure integration features, try out **Cloud Explorer** also.</span></span> <span data-ttu-id="d973a-126">Оба окна можно открыть в меню **Вид** .</span><span class="sxs-lookup"><span data-stu-id="d973a-126">You can open both windows from the **View** menu.</span></span>

1. <span data-ttu-id="d973a-127">Если вы еще не выполнили вход в Azure в Visual Studio, нажмите кнопку **Подключиться к Azure** в **обозревателе сервера**.</span><span class="sxs-lookup"><span data-stu-id="d973a-127">If you aren't already signed in to Azure in Visual Studio, click the **Connect to Azure** button in **Server Explorer**.</span></span>

    <span data-ttu-id="d973a-128">Также вы можете установить сертификат управления, обеспечивающий доступ к вашей учетной записи.</span><span class="sxs-lookup"><span data-stu-id="d973a-128">An alternative is to install a management certificate that enables access to your account.</span></span> <span data-ttu-id="d973a-129">Чтобы установить сертификат, щелкните правой кнопкой мыши узел **Azure** в **обозревателе сервера** и выберите **Управление подписками и их фильтрация** в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="d973a-129">If you choose to install a certificate, right-click the **Azure** node in **Server Explorer**, and then click **Manage and Filter Subscriptions** in the context menu.</span></span> <span data-ttu-id="d973a-130">В диалоговом окне **Manage Azure Subscriptions** (Управление подписками Azure) откройте вкладку **Сертификаты**, а затем щелкните **Импорт**.</span><span class="sxs-lookup"><span data-stu-id="d973a-130">In the **Manage Azure Subscriptions** dialog box, click the **Certificates** tab, and then click **Import**.</span></span> <span data-ttu-id="d973a-131">Следуя указаниям, загрузите и импортируйте файл подписки (файл *.publishsettings* ) для своей учетной записи Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-131">Follow the directions to download and then import a subscription file (also called a *.publishsettings* file) for your Azure account.</span></span>

   > [!NOTE]
   > <span data-ttu-id="d973a-132">Если вы скачиваете файл подписки, сохраните его в папку, не входящую в структуру каталогов с исходными кодами (например, в папку «Загрузки»), а затем удалите его сразу после завершения импорта.</span><span class="sxs-lookup"><span data-stu-id="d973a-132">If you download a subscription file, save it to a folder outside your source code directories (for example, in the Downloads folder), and then delete it once the import has completed.</span></span> <span data-ttu-id="d973a-133">Злоумышленник, получивший доступ к файлу подписки, сможет изменять, создавать и удалять ваши службы Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-133">A malicious user who gains access to the subscription file can edit, create, and delete your Azure services.</span></span>
   >
   >

    <span data-ttu-id="d973a-134">Дополнительные сведения о подключении к ресурсам Azure из Visual Studio см. в разделе [Управление учетными записями, подписками и административными ролями](http://go.microsoft.com/fwlink/?LinkId=324796#BKMK_AccountVCert).</span><span class="sxs-lookup"><span data-stu-id="d973a-134">For more information about connecting to Azure resources from Visual Studio, see [Manage Accounts, Subscriptions, and Administrative Roles](http://go.microsoft.com/fwlink/?LinkId=324796#BKMK_AccountVCert).</span></span>
2. <span data-ttu-id="d973a-135">В **обозревателе сервера** разверните узел **Azure**, а затем — узел **Служба приложений**.</span><span class="sxs-lookup"><span data-stu-id="d973a-135">In **Server Explorer**, expand **Azure** and expand **App Service**.</span></span>
3. <span data-ttu-id="d973a-136">Разверните группу ресурсов, которая содержит веб-приложение, созданное в разделе [Начало работы с Azure и ASP.NET][GetStarted], а затем щелкните узел этого веб-приложения правой кнопкой мыши и выберите **Просмотреть параметры**.</span><span class="sxs-lookup"><span data-stu-id="d973a-136">Expand the resource group that includes the web app that you created in [Getting started with Azure and ASP.NET][GetStarted], and then right-click the web app node and click **View Settings**.</span></span>

    ![Просмотр параметров в обозревателе сервера](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-viewsettings.png)

    <span data-ttu-id="d973a-138">Появится вкладка **Веб-приложение Azure** , где можно просмотреть задачи по управлению и конфигурации, доступные в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d973a-138">The **Azure Web App** tab appears, and you can see there the web app management and configuration tasks that are available in Visual Studio.</span></span>

    ![Окно веб-приложений Azure](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-configtab.png)

    <span data-ttu-id="d973a-140">В этом руководстве используются раскрывающиеся списки ведения журналов и трассировки.</span><span class="sxs-lookup"><span data-stu-id="d973a-140">In this tutorial you'll be using the logging and tracing drop-downs.</span></span> <span data-ttu-id="d973a-141">Для удаленной отладки вы будете использовать другой метод.</span><span class="sxs-lookup"><span data-stu-id="d973a-141">You'll also use remote debugging but you'll use a different method to enable it.</span></span>

    <span data-ttu-id="d973a-142">Сведения о полях параметров приложения и строк подключения в этом окне см. в разделе [Веб-приложения Azure: как работают параметры приложения и строки подключения](http://blogs.msdn.com/b/windowsazure/archive/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-142">For information about the App Settings and Connection Strings boxes in this window, see [Azure Web Apps: How Application Strings and Connection Strings Work](http://blogs.msdn.com/b/windowsazure/archive/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work.aspx).</span></span>

    <span data-ttu-id="d973a-143">Если необходимо выполнить задачу по управлению веб-приложением, которую невозможно выполнить в этом окне, щелкните **Открыть на портале управления** , чтобы открыть портал Azure в браузере.</span><span class="sxs-lookup"><span data-stu-id="d973a-143">If you want to perform a web app management task that can't be done in this window, click **Open in Management Portal** to open a browser window to the Azure portal.</span></span>

## <span data-ttu-id="d973a-144"><a name="remoteview"></a>Доступ к файлам веб-сайта в обозревателе серверов</span><span class="sxs-lookup"><span data-stu-id="d973a-144"><a name="remoteview"></a>Access web app files in Server Explorer</span></span>
<span data-ttu-id="d973a-145">Как правило, при развертывании веб-проекта флагу `customErrors` в файле Web.config присваивается значение `On` или `RemoteOnly`, поэтому вы не видите сообщения о возникающих ошибках.</span><span class="sxs-lookup"><span data-stu-id="d973a-145">You typically deploy a web project with the `customErrors` flag in the Web.config file set to `On` or `RemoteOnly`, which means you don't get a helpful error message when something goes wrong.</span></span> <span data-ttu-id="d973a-146">В большинстве случаев при ошибке отображается страница следующего вида.</span><span class="sxs-lookup"><span data-stu-id="d973a-146">For many errors all you get is a page like one of the following ones.</span></span>

<span data-ttu-id="d973a-147">**Ошибка сервера в приложении "/":**</span><span class="sxs-lookup"><span data-stu-id="d973a-147">**Server Error in '/' Application:**</span></span>

![Неинформативная страница ошибки](./media/web-sites-dotnet-troubleshoot-visual-studio/genericerror.png)

<span data-ttu-id="d973a-149">**Произошла ошибка:**</span><span class="sxs-lookup"><span data-stu-id="d973a-149">**An error occurred:**</span></span>

![Неинформативная страница ошибки](./media/web-sites-dotnet-troubleshoot-visual-studio/genericerror1.png)

<span data-ttu-id="d973a-151">**Не удается отобразить страницу веб-сайта**</span><span class="sxs-lookup"><span data-stu-id="d973a-151">**The website cannot display the page**</span></span>

![Неинформативная страница ошибки](./media/web-sites-dotnet-troubleshoot-visual-studio/genericerror2.png)

<span data-ttu-id="d973a-153">Подробное сообщение об ошибке, как правило, содержит полезные сведения для ее устранения. На предыдущих снимках экрана показано, как включить эту функцию.</span><span class="sxs-lookup"><span data-stu-id="d973a-153">Frequently the easiest way to find the cause of the error is to enable detailed error messages, which the first of the preceding screenshots explains how to do.</span></span> <span data-ttu-id="d973a-154">Для этого необходимо внести изменения в развернутый файл Web.config.</span><span class="sxs-lookup"><span data-stu-id="d973a-154">That requires a change in the deployed Web.config file.</span></span> <span data-ttu-id="d973a-155">Вы можете изменить файл *Web.config* в проекте и повторно развернуть проект либо создать [преобразование Web.config](http://www.asp.net/mvc/tutorials/deployment/visual-studio-web-deployment/web-config-transformations) и развернуть отладочную сборку. Однако вы можете значительно упростить этот процесс с помощью **обозревателя решений**, непосредственно просматривая и редактируя файлы на удаленном сайте с использованием функции *удаленного представления*.</span><span class="sxs-lookup"><span data-stu-id="d973a-155">You could edit the *Web.config* file in the project and redeploy the project, or create a [Web.config transform](http://www.asp.net/mvc/tutorials/deployment/visual-studio-web-deployment/web-config-transformations) and deploy a debug build, but there's a quicker way: in **Solution Explorer** you can directly view and edit files in the remote web app by using the *remote view* feature.</span></span>

1. <span data-ttu-id="d973a-156">В **обозревателе сервера** разверните узлы **Azure**, **Служба приложений** и группу ресурсов, в которой расположено ваше веб-приложение, а затем разверните узел веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-156">In **Server Explorer**, expand **Azure**, expand **App Service**, expand the resource group that your web app is located in, and then expand the node for your web app.</span></span>

    <span data-ttu-id="d973a-157">Откроются узлы, обеспечивающие доступ к файлам содержимого и журналов веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-157">You see nodes that give you access to the web app's content files and log files.</span></span>
2. <span data-ttu-id="d973a-158">Разверните узел **Файлы** и дважды щелкните файл *Web.config* .</span><span class="sxs-lookup"><span data-stu-id="d973a-158">Expand the **Files** node, and double-click the *Web.config* file.</span></span>

    ![Открытие файла Web.config](./media/web-sites-dotnet-troubleshoot-visual-studio/webconfig.png)

    <span data-ttu-id="d973a-160">В Visual Studio откроется файл Web.config удаленного веб-приложения, а в строке заголовка к его имени будет добавлено [Remote].</span><span class="sxs-lookup"><span data-stu-id="d973a-160">Visual Studio opens the Web.config file from the remote web app and shows [Remote] next to the file name in the title bar.</span></span>
3. <span data-ttu-id="d973a-161">Добавьте следующую строку в элемент `system.web` :</span><span class="sxs-lookup"><span data-stu-id="d973a-161">Add the following line to the `system.web` element:</span></span>

    `<customErrors mode="Off"></customErrors>`

    ![Изменение файла Web.config](./media/web-sites-dotnet-troubleshoot-visual-studio/webconfigedit.png)
4. <span data-ttu-id="d973a-163">Обновите окно браузера, в котором отображается неинформативное сообщение. Вы увидите подробную информацию об ошибке, как в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="d973a-163">Refresh the browser that is showing the unhelpful error message, and now you get a detailed error message, such as the following example:</span></span>

    ![Подробные сведение об ошибке](./media/web-sites-dotnet-troubleshoot-visual-studio/detailederror.png)

    <span data-ttu-id="d973a-165">Для создания отображаемой ошибки в файл *Views\Home\Index.cshtml* была добавлена выделенная красным цветом строка.</span><span class="sxs-lookup"><span data-stu-id="d973a-165">(The error shown was created by adding the line shown in red to *Views\Home\Index.cshtml*.)</span></span>

<span data-ttu-id="d973a-166">Изменение файла Web.config — это пример упрощения устранения неполадок путем чтения и редактирования файлов в веб-приложении Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-166">Editing the Web.config file is only one example of scenarios in which the ability to read and edit files on your Azure web app make troubleshooting easier.</span></span>

## <span data-ttu-id="d973a-167"><a name="remotedebug"></a>Удаленная отладка веб-приложений</span><span class="sxs-lookup"><span data-stu-id="d973a-167"><a name="remotedebug"></a>Remote debugging web apps</span></span>
<span data-ttu-id="d973a-168">Если в подробном сообщении об ошибке содержится недостаточно сведений и вы не можете воспроизвести ошибку в локальной системе, попробуйте выполнить отладку в удаленном режиме.</span><span class="sxs-lookup"><span data-stu-id="d973a-168">If the detailed error message doesn't provide enough information, and you can't re-create the error locally, another way to troubleshoot is to run in debug mode remotely.</span></span> <span data-ttu-id="d973a-169">В этом режиме вы можете задавать точки останова, обращаться к памяти напрямую, осуществлять пошаговое выполнение кода и даже изменять путь кода.</span><span class="sxs-lookup"><span data-stu-id="d973a-169">You can set breakpoints, manipulate memory directly, step through code, and even change the code path.</span></span>

<span data-ttu-id="d973a-170">Удаленная отладка не поддерживается в выпусках Visual Studio Express.</span><span class="sxs-lookup"><span data-stu-id="d973a-170">Remote debugging does not work in Express editions of Visual Studio.</span></span>

<span data-ttu-id="d973a-171">В этом разделе демонстрируется удаленная отладка с использованием проекта, созданного в разделе [Начало работы с Azure и ASP.NET][GetStarted].</span><span class="sxs-lookup"><span data-stu-id="d973a-171">This section shows how to debug remotely using the project you create in [Getting started with Azure and ASP.NET][GetStarted].</span></span>

1. <span data-ttu-id="d973a-172">Откройте веб-проект, созданный в разделе [Начало работы с Azure и ASP.NET][GetStarted].</span><span class="sxs-lookup"><span data-stu-id="d973a-172">Open the web project that you created in [Getting started with Azure and ASP.NET][GetStarted].</span></span>
2. <span data-ttu-id="d973a-173">Откройте файл *Controllers\HomeController.cs*.</span><span class="sxs-lookup"><span data-stu-id="d973a-173">Open *Controllers\HomeController.cs*.</span></span>
3. <span data-ttu-id="d973a-174">Удалите метод `About()` и вставьте вместо него следующий код.</span><span class="sxs-lookup"><span data-stu-id="d973a-174">Delete the `About()` method and insert the following code in its place.</span></span>

        public ActionResult About()
        {
            string currentTime = DateTime.Now.ToLongTimeString();
            ViewBag.Message = "The current time is " + currentTime;
            return View();
        }
4. <span data-ttu-id="d973a-175">[Задайте точку останова](http://www.visualstudio.com/get-started/debug-your-app-vs.aspx) в строке `ViewBag.Message`.</span><span class="sxs-lookup"><span data-stu-id="d973a-175">[Set a breakpoint](http://www.visualstudio.com/get-started/debug-your-app-vs.aspx) on the `ViewBag.Message` line.</span></span>
5. <span data-ttu-id="d973a-176">В **обозревателе решений** щелкните правой кнопкой мыши проект и выберите **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-176">In **Solution Explorer**, right-click the project, and click **Publish**.</span></span>
6. <span data-ttu-id="d973a-177">Из раскрывающегося списка **Профиль** выберите тот же профиль, который вы использовали в разделе [Начало работы с Azure и ASP.NET][GetStarted].</span><span class="sxs-lookup"><span data-stu-id="d973a-177">In the **Profile** drop-down list, select the same profile that you used in [Getting started with Azure and ASP.NET][GetStarted].</span></span>
7. <span data-ttu-id="d973a-178">Щелкните вкладку **Параметры** и измените значение **Конфигурация** на **Отладка**, затем щелкните **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-178">Click the **Settings** tab, and change **Configuration** to **Debug**, and then click **Publish**.</span></span>

    ![Публикация в режиме отладки](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-publishdebug.png)
8. <span data-ttu-id="d973a-180">Когда завершится развертывание и откроется URL-адрес Azure вашего веб-приложения, закройте браузер.</span><span class="sxs-lookup"><span data-stu-id="d973a-180">After deployment finishes and your browser opens to the Azure URL of your web app, close the browser.</span></span>
9. <span data-ttu-id="d973a-181">В **обозревателе сервера** щелкните правой кнопкой мыши веб-приложение и выберите **Подключить отладчик**.</span><span class="sxs-lookup"><span data-stu-id="d973a-181">In **Server Explorer**, right-click your web app, and then click **Attach Debugger**.</span></span>

    ![Подключить отладчик](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-attachdebugger.png)

    <span data-ttu-id="d973a-183">В браузере автоматически откроется ваша главная страница, размещенная в Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-183">The browser automatically opens to your home page running in Azure.</span></span> <span data-ttu-id="d973a-184">Возможно, придется подождать около 20 секунд, пока Azure настраивает сервер для отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-184">You might have to wait 20 seconds or so while Azure sets up the server for debugging.</span></span> <span data-ttu-id="d973a-185">Эта задержка возникает только при первом запуске веб-приложения в режиме отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-185">This delay only happens the first time you run in debug mode on a web app.</span></span> <span data-ttu-id="d973a-186">При последующих отладках в течение 48 часов задержки не будет.</span><span class="sxs-lookup"><span data-stu-id="d973a-186">Subsequent times within the next 48 hours when you start debugging again there won't be a delay.</span></span>

    <span data-ttu-id="d973a-187">**Примечание**. При возникновении сложностей с запуском отладчика попробуйте сделать это с помощью **Cloud Explorer**, а не **обозревателя сервера**.</span><span class="sxs-lookup"><span data-stu-id="d973a-187">**Note:** If you have any trouble starting the debugger, try to do it by using **Cloud Explorer** instead of **Server Explorer**.</span></span>
10. <span data-ttu-id="d973a-188">Выберите пункт **О программе** в меню.</span><span class="sxs-lookup"><span data-stu-id="d973a-188">Click **About** in the menu.</span></span>

     <span data-ttu-id="d973a-189">Visual Studio прерывается в точке останова, при этом код выполняется в Azure, а не на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="d973a-189">Visual Studio stops on the breakpoint, and the code is running in Azure, not on your local computer.</span></span>
11. <span data-ttu-id="d973a-190">Наведите указатель мыши на переменную `currentTime` , чтобы просмотреть значение времени.</span><span class="sxs-lookup"><span data-stu-id="d973a-190">Hover over the `currentTime` variable to see the time value.</span></span>

     ![Просмотр переменной в режиме отладки в Azure](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-debugviewinwa.png)

     <span data-ttu-id="d973a-192">Время, которое отображается здесь, является временем сервера Azure, который может находиться в другом часовом поясе, отличном от часового пояса локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="d973a-192">The time you see is the Azure server time, which may be in a different time zone than your local computer.</span></span>
12. <span data-ttu-id="d973a-193">Введите новое значение переменной `currentTime` , например "Теперь выполняется в Azure".</span><span class="sxs-lookup"><span data-stu-id="d973a-193">Enter a new value for the `currentTime` variable, such as "Now running in Azure".</span></span>
13. <span data-ttu-id="d973a-194">Нажмите клавишу F5, чтобы продолжить работу.</span><span class="sxs-lookup"><span data-stu-id="d973a-194">Press F5 to continue running.</span></span>

     <span data-ttu-id="d973a-195">На странице "О программе" в Azure отображается новое значение, введенное в переменной currentTime.</span><span class="sxs-lookup"><span data-stu-id="d973a-195">The About page running in Azure displays the new value that you entered into the currentTime variable.</span></span>

     ![Страница "О программе" с новым значением](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-debugchangeinwa.png)

## <span data-ttu-id="d973a-197"><a name="remotedebugwj"></a> Удаленная отладка веб-заданий</span><span class="sxs-lookup"><span data-stu-id="d973a-197"><a name="remotedebugwj"></a> Remote debugging WebJobs</span></span>
<span data-ttu-id="d973a-198">В этом разделе демонстрируется удаленная отладка с использованием проекта и веб-приложения, созданного на этапе [Начало работы с пакетом SDK веб-заданий Azure](websites-dotnet-webjobs-sdk.md).</span><span class="sxs-lookup"><span data-stu-id="d973a-198">This section shows how to debug remotely using the project and web app you create in [Get Started with the Azure WebJobs SDK](websites-dotnet-webjobs-sdk.md).</span></span>

<span data-ttu-id="d973a-199">Функции, приведенные в этом разделе, доступны только в Visual Studio 2013 с обновлением 4 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="d973a-199">The features shown in this section are available only in Visual Studio 2013 with Update 4 or later.</span></span>

<span data-ttu-id="d973a-200">Удаленная отладка работает только с непрерывными веб-заданиями.</span><span class="sxs-lookup"><span data-stu-id="d973a-200">Remote debugging only works with continuous WebJobs.</span></span> <span data-ttu-id="d973a-201">Веб-задания по расписанию и по требованию не поддерживают отладку.</span><span class="sxs-lookup"><span data-stu-id="d973a-201">Scheduled and on-demand WebJobs don't support debugging.</span></span>

1. <span data-ttu-id="d973a-202">Откройте веб-проект, созданный в разделе [Информация о пакете SDK веб-заданий][GetStartedWJ].</span><span class="sxs-lookup"><span data-stu-id="d973a-202">Open the web project that you created in [Get Started with the Azure WebJobs SDK][GetStartedWJ].</span></span>
2. <span data-ttu-id="d973a-203">В проекте ContosoAdsWebJob откройте *Functions.cs*.</span><span class="sxs-lookup"><span data-stu-id="d973a-203">In the ContosoAdsWebJob project, open *Functions.cs*.</span></span>
3. <span data-ttu-id="d973a-204">[Установите точку останова](http://www.visualstudio.com/get-started/debug-your-app-vs.aspx) в первом операторе метода `GnerateThumbnail`.</span><span class="sxs-lookup"><span data-stu-id="d973a-204">[Set a breakpoint](http://www.visualstudio.com/get-started/debug-your-app-vs.aspx) on the first statement in the `GnerateThumbnail` method.</span></span>

    ![Задание точки останова](./media/web-sites-dotnet-troubleshoot-visual-studio/wjbreakpoint.png)
4. <span data-ttu-id="d973a-206">В **обозревателе решений** щелкните правой кнопкой мыши веб-проект (не проект веб-задания) и выберите **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-206">In **Solution Explorer**, right-click the web project (not the WebJob project), and click **Publish**.</span></span>
5. <span data-ttu-id="d973a-207">В раскрывающемся списке **Профиль** выберите тот же профиль, который вы использовали в учебнике [Приступая к работе с пакетом SDK для веб-заданий Azure](websites-dotnet-webjobs-sdk.md).</span><span class="sxs-lookup"><span data-stu-id="d973a-207">In the **Profile** drop-down list, select the same profile that you used in [Get Started with the Azure WebJobs SDK](websites-dotnet-webjobs-sdk.md).</span></span>
6. <span data-ttu-id="d973a-208">Щелкните вкладку **Параметры** и измените значение **Конфигурация** на **Отладка**, затем щелкните **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-208">Click the **Settings** tab, and change **Configuration** to **Debug**, and then click **Publish**.</span></span>

    <span data-ttu-id="d973a-209">Visual Studio развертывает веб-проекты и проекты веб-заданий и открывает в браузере URL-адрес Azure вашего веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-209">Visual Studio deploys the web and WebJob projects, and your browser opens to the Azure URL of your web app.</span></span>
7. <span data-ttu-id="d973a-210">В **обозревателе решений** разверните узлы **Azure > Служба приложений > ваша группа ресурсов > ваше веб-приложение > WebJobs > Continuous**, а затем щелкните правой кнопкой мыши **ContosoAdsWebJob**.</span><span class="sxs-lookup"><span data-stu-id="d973a-210">In **Server Explorer** expand **Azure > App Service > your resource group > your web app > WebJobs > Continuous**, and then right-click **ContosoAdsWebJob**.</span></span>
8. <span data-ttu-id="d973a-211">Щелкните **Подключить отладчик**.</span><span class="sxs-lookup"><span data-stu-id="d973a-211">Click **Attach Debugger**.</span></span>

    ![Подключить отладчик](./media/web-sites-dotnet-troubleshoot-visual-studio/wjattach.png)

    <span data-ttu-id="d973a-213">В браузере автоматически откроется ваша главная страница, размещенная в Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-213">The browser automatically opens to your home page running in Azure.</span></span> <span data-ttu-id="d973a-214">Возможно, придется подождать около 20 секунд, пока Azure настраивает сервер для отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-214">You might have to wait 20 seconds or so while Azure sets up the server for debugging.</span></span> <span data-ttu-id="d973a-215">Эта задержка возникает только при первом запуске веб-приложения в режиме отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-215">This delay only happens the first time you run in debug mode on a web app.</span></span> <span data-ttu-id="d973a-216">В следующий раз, когда вы присоедините отладчик, задержки не будет, если режим отладки запускался на протяжении последних 48 часов.</span><span class="sxs-lookup"><span data-stu-id="d973a-216">The next time you attach the debugger there won't be a delay, if you do it within 48 hours.</span></span>
9. <span data-ttu-id="d973a-217">В веб-браузере на главной странице Contoso Ads создайте новое объявление.</span><span class="sxs-lookup"><span data-stu-id="d973a-217">In the web browser that is opened to the Contoso Ads home page, create a new ad.</span></span>

    <span data-ttu-id="d973a-218">Создание рекламы приводит к созданию сообщения очереди, которое забирается и обрабатывается веб-заданиями.</span><span class="sxs-lookup"><span data-stu-id="d973a-218">Creating an ad causes a queue message to be created, which will be picked up by the WebJob and processed.</span></span> <span data-ttu-id="d973a-219">Когда пакет SDK веб-заданий вызывает функцию для обработки сообщения очереди, выполнение кода прерывается в точке останова.</span><span class="sxs-lookup"><span data-stu-id="d973a-219">When the WebJobs SDK calls the function to process the queue message, the code will hit your breakpoint.</span></span>
10. <span data-ttu-id="d973a-220">Когда отладчик останавливается в точке останова, вы можете проверить и изменить значения переменных, пока программа выполняется в облаке.</span><span class="sxs-lookup"><span data-stu-id="d973a-220">When the debugger breaks at your breakpoint, you can examine and change variable values while the program is running the cloud.</span></span> <span data-ttu-id="d973a-221">На следующем рисунке отладчик показывает содержимое объекта blobInfo, который был передан в метод GenerateThumbnail.</span><span class="sxs-lookup"><span data-stu-id="d973a-221">In the following illustration the debugger shows the contents of the blobInfo object that was passed to the GenerateThumbnail method.</span></span>

     ![Объект blobInfo в отладчике](./media/web-sites-dotnet-troubleshoot-visual-studio/blobinfo.png)
11. <span data-ttu-id="d973a-223">Нажмите клавишу F5, чтобы продолжить работу.</span><span class="sxs-lookup"><span data-stu-id="d973a-223">Press F5 to continue running.</span></span>

     <span data-ttu-id="d973a-224">Метод GenerateThumbnail завершает создание эскиза.</span><span class="sxs-lookup"><span data-stu-id="d973a-224">The GenerateThumbnail method finishes creating the thumbnail.</span></span>
12. <span data-ttu-id="d973a-225">В браузере обновите страницу индекса и посмотрите эскиз.</span><span class="sxs-lookup"><span data-stu-id="d973a-225">In the browser, refresh the Index page and you see the thumbnail.</span></span>
13. <span data-ttu-id="d973a-226">В Visual Studio нажмите сочетание клавиш SHIFT+F5, чтобы остановить отладку.</span><span class="sxs-lookup"><span data-stu-id="d973a-226">In Visual Studio, press SHIFT+F5 to stop debugging.</span></span>
14. <span data-ttu-id="d973a-227">В **обозревателе сервера** щелкните правой кнопкой мыши узел ContosoAdsWebJob и щелкните **Просмотреть панель мониторинга**.</span><span class="sxs-lookup"><span data-stu-id="d973a-227">In **Server Explorer**, right-click the ContosoAdsWebJob node and click **View Dashboard**.</span></span>
15. <span data-ttu-id="d973a-228">Выполните вход с использованием ваших учетных данных Azure и щелкните имя веб-задания, чтобы перейти к странице вашего веб-задания.</span><span class="sxs-lookup"><span data-stu-id="d973a-228">Sign in with your Azure credentials, and then click the WebJob name to go to the page for your WebJob.</span></span>

     ![Щелкните ContosoAdsWebJob](./media/web-sites-dotnet-troubleshoot-visual-studio/clickcaw.png)

     <span data-ttu-id="d973a-230">Панель мониторинга показывает, что функция GenerateThumbnail выполнена недавно.</span><span class="sxs-lookup"><span data-stu-id="d973a-230">The Dashboard shows that the GenerateThumbnail function executed recently.</span></span>

     <span data-ttu-id="d973a-231">(В следующий раз при нажатии кнопки **Представление панели мониторинга**не нужно выполнять вход, браузер перейдет непосредственно на страницу вашего веб-задания.)</span><span class="sxs-lookup"><span data-stu-id="d973a-231">(The next time you click **View Dashboard**, you don't have to sign in, and the browser goes directly to the page for your WebJob.)</span></span>
16. <span data-ttu-id="d973a-232">Щелкните имя функции для просмотра подробных сведений о выполнении функции.</span><span class="sxs-lookup"><span data-stu-id="d973a-232">Click the function name to see details about the function execution.</span></span>

     ![Сведения о функции](./media/web-sites-dotnet-troubleshoot-visual-studio/funcdetails.png)

<span data-ttu-id="d973a-234">Если функция [записала журналы](websites-dotnet-webjobs-sdk-storage-queues-how-to.md#logs), для их просмотра щелкните пункт **ToggleOutput** .</span><span class="sxs-lookup"><span data-stu-id="d973a-234">If your function [wrote logs](websites-dotnet-webjobs-sdk-storage-queues-how-to.md#logs), you could click **ToggleOutput** to see them.</span></span>

## <a name="notes-about-remote-debugging"></a><span data-ttu-id="d973a-235">Примечания о режиме удаленной отладки</span><span class="sxs-lookup"><span data-stu-id="d973a-235">Notes about remote debugging</span></span>
* <span data-ttu-id="d973a-236">В рабочей среде выполнение в режиме отладки не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="d973a-236">Running in debug mode in production is not recommended.</span></span> <span data-ttu-id="d973a-237">Если ваше рабочее веб-приложение не масштабировано до нескольких экземпляров сервера, отладка не позволит веб-серверу отвечать на другие запросы.</span><span class="sxs-lookup"><span data-stu-id="d973a-237">If your production web app is not scaled out to multiple server instances, debugging will prevent the web server from responding to other requests.</span></span> <span data-ttu-id="d973a-238">Если имеется несколько экземпляров веб-сервера, при присоединении отладчика будет использован случайно выбранный экземпляр и не будет никаких возможностей убедиться в том, что запросы браузера передаются именно на этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="d973a-238">If you do have multiple web server instances, when you attach to the debugger you'll get a random instance, and you have no way to ensure that subsequent browser requests will go to that instance.</span></span> <span data-ttu-id="d973a-239">Кроме того, как правило, отладочная сборка не развертывается в производственной среде, а оптимизации компилятора для разворачиваемых сборок делают невозможным построковое отображения действий в исходном коде.</span><span class="sxs-lookup"><span data-stu-id="d973a-239">Also, you typically don't deploy a debug build to production, and compiler optimizations for release builds might make it impossible to show what is happening line by line in your source code.</span></span> <span data-ttu-id="d973a-240">Для устранения неполадок в рабочей среде лучше всего использовать журналы веб-сервера и трассировки приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-240">For troubleshooting production problems, your best resource is application tracing and web server logs.</span></span>
* <span data-ttu-id="d973a-241">Во время удаленной отладки избегайте длинных остановок на точках останова.</span><span class="sxs-lookup"><span data-stu-id="d973a-241">Avoid long stops at breakpoints when remote debugging.</span></span> <span data-ttu-id="d973a-242">Azure обрабатывает процесс, остановленный дольше, чем на несколько минут, как процесс, не отвечающий на запросы, и закрывает его.</span><span class="sxs-lookup"><span data-stu-id="d973a-242">Azure treats a process that is stopped for longer than a few minutes as an unresponsive process, and shuts it down.</span></span>
* <span data-ttu-id="d973a-243">Во время отладки сервер отправляет данные в среду Visual Studio, что может повлиять на расходы, связанные с пропускной способностью.</span><span class="sxs-lookup"><span data-stu-id="d973a-243">While you're debugging, the server is sending data to Visual Studio, which could affect bandwidth charges.</span></span> <span data-ttu-id="d973a-244">Сведения о тарифах на пропускную способность см. в разделе [Цены на Azure](https://azure.microsoft.com/pricing/calculator/).</span><span class="sxs-lookup"><span data-stu-id="d973a-244">For information about bandwidth rates, see [Azure Pricing](https://azure.microsoft.com/pricing/calculator/).</span></span>
* <span data-ttu-id="d973a-245">Убедитесь, что атрибут `debug` элемента `compilation` в файле *Web.config* имеет значение true.</span><span class="sxs-lookup"><span data-stu-id="d973a-245">Make sure that the `debug` attribute of the `compilation` element in the *Web.config* file is set to true.</span></span> <span data-ttu-id="d973a-246">По умолчанию при публикации отладочной конфигурации сборки для него задано значение true.</span><span class="sxs-lookup"><span data-stu-id="d973a-246">It is set to true by default when you publish a debug build configuration.</span></span>

        <system.web>
          <compilation debug="true" targetFramework="4.5" />
          <httpRuntime targetFramework="4.5" />
        </system.web>
* <span data-ttu-id="d973a-247">Если вы обнаружите, что отладчик не выполняет пошаговое прохождение кода, который требуется отладить, может потребоваться изменить параметр "Только мой код".</span><span class="sxs-lookup"><span data-stu-id="d973a-247">If you find that the debugger won't step into code that you want to debug, you might have to change the Just My Code setting.</span></span>  <span data-ttu-id="d973a-248">Дополнительные сведения см. в разделе [Ограничение выполнения шагов только моим кодом](http://msdn.microsoft.com/library/vstudio/y740d9d3.aspx#BKMK_Restrict_stepping_to_Just_My_Code).</span><span class="sxs-lookup"><span data-stu-id="d973a-248">For more information, see [Restrict stepping to Just My Code](http://msdn.microsoft.com/library/vstudio/y740d9d3.aspx#BKMK_Restrict_stepping_to_Just_My_Code).</span></span>
* <span data-ttu-id="d973a-249">При активации функции удаленной отладки на сервере запускается таймер, который автоматически отключает эту функцию по истечении 48 часов.</span><span class="sxs-lookup"><span data-stu-id="d973a-249">A timer starts on the server when you enable the remote debugging feature, and after 48 hours the feature is automatically turned off.</span></span> <span data-ttu-id="d973a-250">Это 48-часовое ограничение существует в целях повышения безопасности и производительности.</span><span class="sxs-lookup"><span data-stu-id="d973a-250">This 48 hour limit is done for security and performance reasons.</span></span> <span data-ttu-id="d973a-251">Вы можете в любое время снова активировать эту функцию.</span><span class="sxs-lookup"><span data-stu-id="d973a-251">You can easily turn the feature back on as many times as you like.</span></span> <span data-ttu-id="d973a-252">Если вы не ведете отладку, эту функцию рекомендуется оставить отключенной.</span><span class="sxs-lookup"><span data-stu-id="d973a-252">We recommend leaving it disabled when you are not actively debugging.</span></span>
* <span data-ttu-id="d973a-253">Вы можете вручную присоединить отладчик к любому процессу, а не только к процессу веб-приложения (w3wp.exe).</span><span class="sxs-lookup"><span data-stu-id="d973a-253">You can manually attach the debugger to any process, not only the web app process (w3wp.exe).</span></span> <span data-ttu-id="d973a-254">Дополнительные сведения о том, как использовать режим отладки в Visual Studio, см. в разделе [Отладка в Visual Studio](http://msdn.microsoft.com/library/vstudio/sc65sadd.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-254">For more information about how to use debug mode in Visual Studio, see [Debugging in Visual Studio](http://msdn.microsoft.com/library/vstudio/sc65sadd.aspx).</span></span>

## <span data-ttu-id="d973a-255"><a name="logsoverview"></a>Обзор журналов диагностики</span><span class="sxs-lookup"><span data-stu-id="d973a-255"><a name="logsoverview"></a>Diagnostic logs overview</span></span>
<span data-ttu-id="d973a-256">Приложение ASP.NET, которое работает в веб-приложении Azure, может создавать следующие виды журналов:</span><span class="sxs-lookup"><span data-stu-id="d973a-256">An ASP.NET application that runs in an Azure web app can create the following kinds of logs:</span></span>

* <span data-ttu-id="d973a-257">**Журналы трассировки приложения**</span><span class="sxs-lookup"><span data-stu-id="d973a-257">**Application tracing logs**</span></span><br/>
  <span data-ttu-id="d973a-258">Приложение создает эти журналы, вызывая методы класса [System.Diagnostics.Trace](http://msdn.microsoft.com/library/system.diagnostics.trace.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d973a-258">The application creates these logs by calling methods of the [System.Diagnostics.Trace](http://msdn.microsoft.com/library/system.diagnostics.trace.aspx) class.</span></span>
* <span data-ttu-id="d973a-259">**Журналы веб-сервера**</span><span class="sxs-lookup"><span data-stu-id="d973a-259">**Web server logs**</span></span><br/>
  <span data-ttu-id="d973a-260">Веб-сервер создает запись журнала для каждого HTTP-запроса, адресованного сайту.</span><span class="sxs-lookup"><span data-stu-id="d973a-260">The web server creates a log entry for every HTTP request to the web app.</span></span>
* <span data-ttu-id="d973a-261">**Подробные журналы сообщений об ошибках**</span><span class="sxs-lookup"><span data-stu-id="d973a-261">**Detailed error message logs**</span></span><br/>
  <span data-ttu-id="d973a-262">Веб-сервер создает страницу HTML с некоторой дополнительной информацией об ошибочных HTTP-запросах (те запросы, которые приводят к появлению кода состояния 400 и выше).</span><span class="sxs-lookup"><span data-stu-id="d973a-262">The web server creates an HTML page with some additional information for failed HTTP requests (those that result in status code 400 or greater).</span></span>
* <span data-ttu-id="d973a-263">**Журналы трассировки неудачно завершенных запросов**</span><span class="sxs-lookup"><span data-stu-id="d973a-263">**Failed request tracing logs**</span></span><br/>
  <span data-ttu-id="d973a-264">Веб-сервер создает XML-файл с подробными сведениями трассировки ошибочных HTTP-запросов.</span><span class="sxs-lookup"><span data-stu-id="d973a-264">The web server creates an XML file with detailed tracing information for failed HTTP requests.</span></span> <span data-ttu-id="d973a-265">Веб-сервер также предоставляет XSL-файл для форматирования XML-кода в браузере.</span><span class="sxs-lookup"><span data-stu-id="d973a-265">The web server also provides an XSL file to format the XML in a browser.</span></span>

<span data-ttu-id="d973a-266">Ведение журнала влияет на производительность веб-приложения, поэтому Azure предоставляет возможность при необходимости включить или отключить каждый тип журнала.</span><span class="sxs-lookup"><span data-stu-id="d973a-266">Logging affects web app performance, so Azure gives you the ability to enable or disable each type of log as needed.</span></span> <span data-ttu-id="d973a-267">Для журналов приложений можно указать, что следует писать только журналы с уровнем серьезности выше заданного.</span><span class="sxs-lookup"><span data-stu-id="d973a-267">For application logs, you can specify that only logs above a certain severity level should be written.</span></span> <span data-ttu-id="d973a-268">При создании нового веб-приложения ведение журналов по умолчанию отключено.</span><span class="sxs-lookup"><span data-stu-id="d973a-268">When you create a new web app, by default all logging is disabled.</span></span>

<span data-ttu-id="d973a-269">Журналы записываются в файлы, содержащиеся в папке *LogFiles* файловой системы вашего веб-сайта, и доступны через FTP.</span><span class="sxs-lookup"><span data-stu-id="d973a-269">Logs are written to files in a *LogFiles* folder in the file system of your web app and are accessible via FTP.</span></span> <span data-ttu-id="d973a-270">Журналы приложений и журналы веб-сервера также могут записываться в учетную запись хранения Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-270">Web server logs and application logs can also be written to an Azure Storage account.</span></span> <span data-ttu-id="d973a-271">В учетной записи хранения можно держать больший объем журналов, чем в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="d973a-271">You can retain a greater volume of logs in a storage account than is possible in the file system.</span></span> <span data-ttu-id="d973a-272">При использовании файловой системы на журналы отводится 100 мегабайтов.</span><span class="sxs-lookup"><span data-stu-id="d973a-272">You're limited to a maximum of 100 megabytes of logs when you use the file system.</span></span> <span data-ttu-id="d973a-273">Журналы файловой системы хранятся в течение короткого срока.</span><span class="sxs-lookup"><span data-stu-id="d973a-273">(File system logs are only for short-term retention.</span></span> <span data-ttu-id="d973a-274">При достижении установленного ограничения Azure удаляет старые файлы журналов, чтобы освободить место под новые.</span><span class="sxs-lookup"><span data-stu-id="d973a-274">Azure deletes old log files to make room for new ones after the limit is reached.)</span></span>  

## <span data-ttu-id="d973a-275"><a name="apptracelogs"></a>Создание и просмотр журналов трассировки приложения</span><span class="sxs-lookup"><span data-stu-id="d973a-275"><a name="apptracelogs"></a>Create and view application trace logs</span></span>
<span data-ttu-id="d973a-276">В этом разделе предстоит выполнить следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="d973a-276">In this section you'll do the following tasks:</span></span>

* <span data-ttu-id="d973a-277">Добавление инструкций трассировки в веб-проект, созданный в разделе [Развертывание веб-приложения ASP.NET в службе приложений Azure с помощью Visual Studio][GetStarted].</span><span class="sxs-lookup"><span data-stu-id="d973a-277">Add tracing statements to the web project that you created in [Get started with Azure and ASP.NET][GetStarted].</span></span>
* <span data-ttu-id="d973a-278">Просмотр журналов при локальном выполнении проекта.</span><span class="sxs-lookup"><span data-stu-id="d973a-278">View the logs when you run the project locally.</span></span>
* <span data-ttu-id="d973a-279">Просмотр журналов, создаваемых во время работы приложения в Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-279">View the logs as they are generated by the application running in Azure.</span></span>

<span data-ttu-id="d973a-280">Сведения о том, как создавать журналы приложений в веб-заданиях, см. в разделе [Работа с хранилищем очередей Azure с помощью пакета SDK веб-заданий — создание записей в журналах](websites-dotnet-webjobs-sdk-storage-queues-how-to.md#logs).</span><span class="sxs-lookup"><span data-stu-id="d973a-280">For information about how to create application logs in WebJobs, see [How to work with Azure queue storage using the WebJobs SDK - How to write logs](websites-dotnet-webjobs-sdk-storage-queues-how-to.md#logs).</span></span> <span data-ttu-id="d973a-281">Следующие инструкции для просмотра журналов и управления их хранением в Azure также применяются для журналов приложений, созданных с помощью Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-281">The following instructions for viewing logs and controlling how they're stored in Azure apply also to application logs created by WebJobs.</span></span>

### <a name="add-tracing-statements-to-the-application"></a><span data-ttu-id="d973a-282">Добавление инструкций трассировки в приложение</span><span class="sxs-lookup"><span data-stu-id="d973a-282">Add tracing statements to the application</span></span>
1. <span data-ttu-id="d973a-283">Откройте файл *Controllers\HomeController.cs* и замените методы `Index`, `About` и `Contact` приведенным ниже кодом, чтобы добавить инструкции `Trace` и инструкцию `using` для `System.Diagnostics`.</span><span class="sxs-lookup"><span data-stu-id="d973a-283">Open *Controllers\HomeController.cs*, and replace the `Index`, `About`, and `Contact` methods with the following code in order to add `Trace` statements and a `using` statement for `System.Diagnostics`:</span></span>

        public ActionResult Index()
        {
            Trace.WriteLine("Entering Index method");
            ViewBag.Message = "Modify this template to jump-start your ASP.NET MVC application.";
            Trace.TraceInformation("Displaying the Index page at " + DateTime.Now.ToLongTimeString());
            Trace.WriteLine("Leaving Index method");
            return View();
        }

        public ActionResult About()
        {
            Trace.WriteLine("Entering About method");
            ViewBag.Message = "Your app description page.";
            Trace.TraceWarning("Transient error on the About page at " + DateTime.Now.ToShortTimeString());
            Trace.WriteLine("Leaving About method");
            return View();
        }

        public ActionResult Contact()
        {
            Trace.WriteLine("Entering Contact method");
            ViewBag.Message = "Your contact page.";
            Trace.TraceError("Fatal error on the Contact page at " + DateTime.Now.ToLongTimeString());
            Trace.WriteLine("Leaving Contact method");
            return View();
        }        
2. <span data-ttu-id="d973a-284">Добавьте в начало файла инструкцию `using System.Diagnostics;` .</span><span class="sxs-lookup"><span data-stu-id="d973a-284">Add a `using System.Diagnostics;` statement to the top of the file.</span></span>

### <a name="view-the-tracing-output-locally"></a><span data-ttu-id="d973a-285">Просмотр результатов трассировки локально</span><span class="sxs-lookup"><span data-stu-id="d973a-285">View the tracing output locally</span></span>
1. <span data-ttu-id="d973a-286">Нажмите F5, чтобы выполнить приложение в режиме отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-286">Press F5 to run the application in debug mode.</span></span>

    <span data-ttu-id="d973a-287">Прослушиватель трассировки по умолчанию записывает весь вывод трассировки в окно **Вывод** вместе со всем остальным выводом отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-287">The default trace listener writes all trace output to the **Output** window, along with other Debug output.</span></span> <span data-ttu-id="d973a-288">На следующем рисунке показан вывод инструкций трассировки, добавленных в метод `Index` .</span><span class="sxs-lookup"><span data-stu-id="d973a-288">The following illustration shows the output from the trace statements that you added to the `Index` method.</span></span>

    ![Трассировка в окне отладки](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-debugtracing.png)

    <span data-ttu-id="d973a-290">Ниже показано, как просмотреть выходные данные трассировки на веб-странице без компиляции в режиме отладки.</span><span class="sxs-lookup"><span data-stu-id="d973a-290">The following steps show how to view trace output in a web page, without compiling in debug mode.</span></span>
2. <span data-ttu-id="d973a-291">Откройте файл Web.config приложения (находится в папке проекта) и добавьте элемент `<system.diagnostics>` в конец файла непосредственно перед закрывающим элементом `</configuration>`:</span><span class="sxs-lookup"><span data-stu-id="d973a-291">Open the application Web.config file (the one located in the project folder) and add a `<system.diagnostics>` element at the end of the file just before the closing `</configuration>` element:</span></span>

          <system.diagnostics>
            <trace>
              <listeners>
                <add name="WebPageTraceListener"
                    type="System.Web.WebPageTraceListener,
                    System.Web,
                    Version=4.0.0.0,
                    Culture=neutral,
                    PublicKeyToken=b03f5f7f11d50a3a" />
              </listeners>
            </trace>
          </system.diagnostics>

    <span data-ttu-id="d973a-292">`WebPageTraceListener` позволяет просматривать результаты трассировки, открыв `/trace.axd`.</span><span class="sxs-lookup"><span data-stu-id="d973a-292">The `WebPageTraceListener` lets you view trace output by browsing to `/trace.axd`.</span></span>
3. <span data-ttu-id="d973a-293">Добавьте <a href="http://msdn.microsoft.com/library/vstudio/6915t83k(v=vs.100).aspx">элемент трассировки</a> под `<system.web>` в файле Web.config, например так:</span><span class="sxs-lookup"><span data-stu-id="d973a-293">Add a <a href="http://msdn.microsoft.com/library/vstudio/6915t83k(v=vs.100).aspx">trace element</a> under `<system.web>` in the Web.config file, such as the following example:</span></span>

        <trace enabled="true" writeToDiagnosticsTrace="true" mostRecent="true" pageOutput="false" />
4. <span data-ttu-id="d973a-294">Для запуска приложения нажмите сочетание клавиш CTRL+F5.</span><span class="sxs-lookup"><span data-stu-id="d973a-294">Press CTRL+F5 to run the application.</span></span>
5. <span data-ttu-id="d973a-295">В адресной строке окна браузера добавьте *trace.axd* к URL-адресу и нажмите клавишу ВВОД (URL-адрес должен быть аналогичен http://localhost:53370/trace.axd).</span><span class="sxs-lookup"><span data-stu-id="d973a-295">In the address bar of the browser window, add *trace.axd* to the URL, and then press Enter (the URL will be similar to http://localhost:53370/trace.axd).</span></span>
6. <span data-ttu-id="d973a-296">На странице **Трассировка приложения** щелкните **Просмотр сведений** в первой строке (не в строке BrowserLink).</span><span class="sxs-lookup"><span data-stu-id="d973a-296">On the **Application Trace** page, click **View Details** on the first line (not the BrowserLink line).</span></span>

    ![trace.axd](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-traceaxd1.png)

    <span data-ttu-id="d973a-298">Откроется страница **Сведения о запросе**, где в разделе **Сведения о трассировке** отображаются выходные данные инструкций трассировки, добавленных в метод `Index`.</span><span class="sxs-lookup"><span data-stu-id="d973a-298">The **Request Details** page appears, and in the **Trace Information** section you see the output from the trace statements that you added to the `Index` method.</span></span>

    ![trace.axd](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-traceaxd2.png)

    <span data-ttu-id="d973a-300">По умолчанию `trace.axd` доступен только локально.</span><span class="sxs-lookup"><span data-stu-id="d973a-300">By default, `trace.axd` is only available locally.</span></span> <span data-ttu-id="d973a-301">Если он должен быть доступен также в удаленном веб-приложении, можно добавить строку `localOnly="false"` в элемент `trace` файла *Web.config*, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="d973a-301">If you wanted to make it available from a remote web app, you could add `localOnly="false"` to the `trace` element in the *Web.config* file, as shown in the following example:</span></span>

        <trace enabled="true" writeToDiagnosticsTrace="true" localOnly="false" mostRecent="true" pageOutput="false" />

    <span data-ttu-id="d973a-302">Но включение `trace.axd` в рабочем веб-приложении обычно не рекомендуется по соображениям безопасности. В следующих разделах вы ознакомитесь с более простым способом чтения журналов трассировки веб-приложения Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-302">However, enabling `trace.axd` in a production web app is generally not recommended for security reasons, and in the following sections you'll see an easier way to read tracing logs in an Azure web app.</span></span>

### <a name="view-the-tracing-output-in-azure"></a><span data-ttu-id="d973a-303">Просмотр результатов трассировки в Azure</span><span class="sxs-lookup"><span data-stu-id="d973a-303">View the tracing output in Azure</span></span>
1. <span data-ttu-id="d973a-304">В **обозревателе решений** щелкните правой кнопкой веб-проект и выберите **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-304">In **Solution Explorer**, right-click the web project and click **Publish**.</span></span>
2. <span data-ttu-id="d973a-305">В диалоговом окне **Публикация веб-сайта** щелкните **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-305">In the **Publish Web** dialog box, click **Publish**.</span></span>

    <span data-ttu-id="d973a-306">После того как Visual Studio опубликует обновление, главная страница откроется в окне браузера (если не снят флажок **URL-адрес назначения** на вкладке **Подключение**).</span><span class="sxs-lookup"><span data-stu-id="d973a-306">After Visual Studio publishes your update, it opens a browser window to your home page (assuming you didn't clear **Destination URL** on the **Connection** tab).</span></span>
3. <span data-ttu-id="d973a-307">В **обозревателе сервера** щелкните правой кнопкой мыши веб-приложение и выберите **Просмотр журналов потоковой передачи**.</span><span class="sxs-lookup"><span data-stu-id="d973a-307">In **Server Explorer**, right-click your web app and select **View Streaming Logs**.</span></span>

    ![Просмотр журналов потоковой передачи в контекстном меню](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-viewlogsmenu.png)

    <span data-ttu-id="d973a-309">В окне **Вывод** показано, что вы подключены к службе потоковой передачи журналов; каждую минуту, когда отсутствует журнал для отображения, появляется строка уведомления.</span><span class="sxs-lookup"><span data-stu-id="d973a-309">The **Output** window shows that you are connected to the log-streaming service, and adds a notification line each minute that goes by without a log to display.</span></span>

    ![Просмотр журналов потоковой передачи в контекстном меню](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-nologsyet.png)
4. <span data-ttu-id="d973a-311">В окне браузера с открытой главной страницей щелкните пункт **Contact**.</span><span class="sxs-lookup"><span data-stu-id="d973a-311">In the browser window that shows your application home page, click **Contact**.</span></span>

    <span data-ttu-id="d973a-312">Через несколько секунд в окне `Contact`Вывод **появятся результаты трассировки уровня ошибки, добавленные в метод** .</span><span class="sxs-lookup"><span data-stu-id="d973a-312">Within a few seconds the output from the error-level trace you added to the `Contact` method appears in the **Output** window.</span></span>

    ![Трассировка ошибок в окне вывода](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-errortrace.png)

    <span data-ttu-id="d973a-314">Visual Studio отображает только трассировки уровня ошибок, так как это настройка выставляется по умолчанию при включении службы мониторинга журналов.</span><span class="sxs-lookup"><span data-stu-id="d973a-314">Visual Studio is only showing error-level traces because that is the default setting when you enable the log monitoring service.</span></span> <span data-ttu-id="d973a-315">При создании нового веб-приложения Azure ведение всех журналов по умолчанию отключено. Вы могли убедиться в этом ранее при открытии страницы параметров сайта.</span><span class="sxs-lookup"><span data-stu-id="d973a-315">When you create a new Azure web app, all logging is disabled by default, as you saw when you opened the settings page earlier:</span></span>

    ![Выключение ведение журнала приложения](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-apploggingoff.png)

    <span data-ttu-id="d973a-317">Однако при выборе **Просмотр журналов потоковой передачи** Visual Studio автоматически изменяет значение параметра **Ведение журнала приложений (файловая система)** на **Ошибка**, что означает представление только журналов уровня ошибок.</span><span class="sxs-lookup"><span data-stu-id="d973a-317">However, when you selected **View Streaming Logs**, Visual Studio automatically changed **Application Logging(File System)** to **Error**, which means error-level logs get reported.</span></span> <span data-ttu-id="d973a-318">Чтобы просмотреть все журналы трассировки, следует изменить значение этого параметра на **Подробно**.</span><span class="sxs-lookup"><span data-stu-id="d973a-318">In order to see all of your tracing logs, you can change this setting to **Verbose**.</span></span> <span data-ttu-id="d973a-319">Если выбран уровень серьезности меньше уровня ошибок, начинают предоставляться и все журналы с более высокими уровнями серьезности.</span><span class="sxs-lookup"><span data-stu-id="d973a-319">When you select a severity level lower than error, all logs for higher severity levels are also reported.</span></span> <span data-ttu-id="d973a-320">Поэтому при выборе подробного уровня вы также сможете просматривать журналы информационных сообщений, предупреждений и ошибок.</span><span class="sxs-lookup"><span data-stu-id="d973a-320">So when you select verbose, you also see information, warning, and error logs.</span></span>  

1. <span data-ttu-id="d973a-321">В **обозревателе сервера** щелкните правой кнопкой мыши веб-приложение, затем щелкните **Просмотреть параметры**, как и раньше.</span><span class="sxs-lookup"><span data-stu-id="d973a-321">In **Server Explorer**, right-click the web app, and then click **View Settings** as you did earlier.</span></span>
2. <span data-ttu-id="d973a-322">Измените значение параметра **Ведение журнала приложения (файловая система)** на **Подробно**, затем нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="d973a-322">Change **Application Logging (File System)** to **Verbose**, and then click **Save**.</span></span>

    ![Уровень трассировки "Подробно"](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-applogverbose.png)
3. <span data-ttu-id="d973a-324">В окне браузера, в котором теперь отображается страница **Contact** (Контактная информация), щелкните **Home** (Главная), затем **About** (О программе) и щелкните **Contact** (Контактная информация).</span><span class="sxs-lookup"><span data-stu-id="d973a-324">In the browser window that is now showing your **Contact** page, click **Home**, then click **About**, and then click **Contact**.</span></span>

    <span data-ttu-id="d973a-325">Через несколько секунд в окне **Вывод** появятся все результаты трассировки.</span><span class="sxs-lookup"><span data-stu-id="d973a-325">Within a few seconds, the **Output** window shows all of your tracing output.</span></span>

    ![Подробные результаты трассировки](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-verbosetraces.png)

    <span data-ttu-id="d973a-327">В этом разделе вы включили и отключили ведение журналов с помощью параметров веб-приложения Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-327">In this section you enabled and disabled logging by using Azure web app settings.</span></span> <span data-ttu-id="d973a-328">Можно также включить и отключить прослушиватели трассировки, изменив содержимое файла Web.config.</span><span class="sxs-lookup"><span data-stu-id="d973a-328">You can also enable and disable trace listeners by modifying the Web.config file.</span></span> <span data-ttu-id="d973a-329">Но изменение файла Web.config приводит к перезапуску домена приложения, тогда как включение ведения журналов через настройку веб-приложения не приводит к таким результатам.</span><span class="sxs-lookup"><span data-stu-id="d973a-329">However, modifying the Web.config file causes the app domain to recycle, while enabling logging via the web app configuration doesn't do that.</span></span> <span data-ttu-id="d973a-330">Если воспроизведение проблемы занимает много времени или проблема возникает только периодически, перезапуск домена приложения может устранить неполадку, так что вам придется ждать следующего ее возникновения.</span><span class="sxs-lookup"><span data-stu-id="d973a-330">If the problem takes a long time to reproduce, or is intermittent, recycling the app domain might "fix" it and force you to wait until it happens again.</span></span> <span data-ttu-id="d973a-331">Включение диагностики в Azure не приводит к подобным результатам, поэтому сбор сведений об ошибках можно начать незамедлительно.</span><span class="sxs-lookup"><span data-stu-id="d973a-331">Enabling diagnostics in Azure doesn't do this, so you can start capturing error information immediately.</span></span>

### <a name="output-window-features"></a><span data-ttu-id="d973a-332">Функции окна вывода</span><span class="sxs-lookup"><span data-stu-id="d973a-332">Output window features</span></span>
<span data-ttu-id="d973a-333">На вкладке **Журналы Azure** окна **Вывод** расположено несколько кнопок и текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="d973a-333">The **Azure Logs** tab of the **Output** Window has several buttons and a text box:</span></span>

![Кнопки вкладки журналов](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-icons.png)

<span data-ttu-id="d973a-335">Служат для выполнения следующих функций:</span><span class="sxs-lookup"><span data-stu-id="d973a-335">These perform the following functions:</span></span>

* <span data-ttu-id="d973a-336">Очистка окна **Вывод** .</span><span class="sxs-lookup"><span data-stu-id="d973a-336">Clear the **Output** window.</span></span>
* <span data-ttu-id="d973a-337">Включение или отключение переноса слов.</span><span class="sxs-lookup"><span data-stu-id="d973a-337">Enable or disable word wrap.</span></span>
* <span data-ttu-id="d973a-338">Запуск или остановка журналов мониторинга.</span><span class="sxs-lookup"><span data-stu-id="d973a-338">Start or stop monitoring logs.</span></span>
* <span data-ttu-id="d973a-339">Определение журналов мониторинга.</span><span class="sxs-lookup"><span data-stu-id="d973a-339">Specify which logs to monitor.</span></span>
* <span data-ttu-id="d973a-340">Скачивание журналов.</span><span class="sxs-lookup"><span data-stu-id="d973a-340">Download logs.</span></span>
* <span data-ttu-id="d973a-341">Фильтрация журналов на основе регулярного выражения или строки поиска.</span><span class="sxs-lookup"><span data-stu-id="d973a-341">Filter logs based on a search string or a regular expression.</span></span>
* <span data-ttu-id="d973a-342">Закрытие окна **Вывод** .</span><span class="sxs-lookup"><span data-stu-id="d973a-342">Close the **Output** window.</span></span>

<span data-ttu-id="d973a-343">Если ввести строку поиска или регулярное выражение, Visual Studio фильтрует сведения в журналах на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="d973a-343">If you enter a search string or regular expression, Visual Studio filters logging information at the client.</span></span> <span data-ttu-id="d973a-344">Это означает, что можно ввести критерии после отображения журналов в окне **Вывод** , а также изменить критерии фильтрации без необходимости повторного создания журналов.</span><span class="sxs-lookup"><span data-stu-id="d973a-344">That means you can enter the criteria after the logs are displayed in the **Output** window and you can change filtering criteria without having to regenerate the logs.</span></span>

## <span data-ttu-id="d973a-345"><a name="webserverlogs"></a>Просмотр журналов веб-сервера</span><span class="sxs-lookup"><span data-stu-id="d973a-345"><a name="webserverlogs"></a>View web server logs</span></span>
<span data-ttu-id="d973a-346">Журналы веб-сервера регистрируют все действия по протоколу HTTP в веб-приложении.</span><span class="sxs-lookup"><span data-stu-id="d973a-346">Web server logs record all HTTP activity for the web app.</span></span> <span data-ttu-id="d973a-347">Чтобы увидеть их в окне **Вывод** , включите их в веб-приложении и дайте команду Visual Studio отслеживать их.</span><span class="sxs-lookup"><span data-stu-id="d973a-347">In order to see them in the **Output** window you have to enable them for the web app and tell Visual Studio that you want to monitor them.</span></span>

1. <span data-ttu-id="d973a-348">На вкладке **Конфигурация веб-приложения Azure**, открытой в **обозревателе сервера**, измените значение параметра "Ведение журналов веб-сервера" на **Включено** и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="d973a-348">In the **Azure Web App Configuration** tab that you opened from **Server Explorer**, change Web Server Logging to **On**, and then click **Save**.</span></span>

    ![Включение ведения журналов веб-сервера](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-webserverloggingon.png)
2. <span data-ttu-id="d973a-350">В окне **Вывод** нажмите кнопку **Укажите, какие журналы Azure отслеживать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-350">In the **Output** Window, click the **Specify which Azure logs to monitor** button.</span></span>

    ![Укажите, какие журналы Azure отслеживать](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-specifylogs.png)
3. <span data-ttu-id="d973a-352">В диалоговом окне **Параметры ведения журналов Azure** выберите **Журналы веб-сервера** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="d973a-352">In the **Azure Logging Options** dialog box, select **Web server logs**, and then click **OK**.</span></span>

    ![Мониторинг журналов веб-сервера](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-monitorwslogson.png)
4. <span data-ttu-id="d973a-354">В окне браузера, в котором отображается веб-приложение, щелкните **Home** (Главная), затем **About** (О программе) и **Contact** (Контактная информация).</span><span class="sxs-lookup"><span data-stu-id="d973a-354">In the browser window that shows the web app, click **Home**, then click **About**, and then click **Contact**.</span></span>

    <span data-ttu-id="d973a-355">Как правило, первыми отображаются журналы приложений, за которыми следуют журналы веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="d973a-355">The application logs generally appear first, followed by the web server logs.</span></span> <span data-ttu-id="d973a-356">Подождите некоторое время, чтобы дождаться отображения журналов.</span><span class="sxs-lookup"><span data-stu-id="d973a-356">You might have to wait a while for the logs to appear.</span></span>

    ![Журналы веб-сервера в окне вывода](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-wslogs.png)

<span data-ttu-id="d973a-358">По умолчанию при первом включении журналов веб-сервера с помощью Visual Studio Azure записывает журналы в файловой системе.</span><span class="sxs-lookup"><span data-stu-id="d973a-358">By default, when you first enable web server logs by using Visual Studio, Azure writes the logs to the file system.</span></span> <span data-ttu-id="d973a-359">В качестве альтернативы на портале Azure можно указать, что журналы веб-сервера должны записываться в контейнер больших двоичных объектов в учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-359">As an alternative, you can use the Azure portal to specify that web server logs should be written to a blob container in a storage account.</span></span>

<span data-ttu-id="d973a-360">Если включить ведение журналов веб-сервера для учетной записи хранения Azure с помощью портала, а затем отключить ведение журналов в Visual Studio, то при повторном включении ведения журналов в Visual Studio восстанавливаются параметры учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-360">If you use the portal to enable web server logging to an Azure storage account, and then disable logging in Visual Studio, when you re-enable logging in Visual Studio your storage account settings are restored.</span></span>

## <span data-ttu-id="d973a-361"><a name="detailederrorlogs"></a>Просмотр подробных журналов сообщений об ошибках</span><span class="sxs-lookup"><span data-stu-id="d973a-361"><a name="detailederrorlogs"></a>View detailed error message logs</span></span>
<span data-ttu-id="d973a-362">Подробные журналы сообщений об ошибках представляют некоторые дополнительные сведения о HTTP-запросах, которые завершаются с кодом ошибки (400 или выше).</span><span class="sxs-lookup"><span data-stu-id="d973a-362">Detailed error logs provide some additional information about HTTP requests that result in error response codes (400 or above).</span></span> <span data-ttu-id="d973a-363">Чтобы увидеть их в окне **Вывод** , включите их в веб-приложении и дайте команду Visual Studio отслеживать их.</span><span class="sxs-lookup"><span data-stu-id="d973a-363">In order to see them in the **Output** window, you have to enable them for the web app and tell Visual Studio that you want to monitor them.</span></span>

1. <span data-ttu-id="d973a-364">На вкладке **Конфигурация веб-приложения Azure**, открытой в **обозревателе сервера**, измените значение параметра **Подробные сообщения об ошибках** на **Включено**, затем нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="d973a-364">In the **Azure Web App Configuration** tab that you opened from **Server Explorer**, change **Detailed Error Messages** to **On**, and then click **Save**.</span></span>

    ![Включение подробных сообщений об ошибках](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-detailedlogson.png)
2. <span data-ttu-id="d973a-366">В окне **Вывод** нажмите кнопку **Укажите, какие журналы Azure отслеживать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-366">In the **Output** Window, click the **Specify which Azure logs to monitor** button.</span></span>
3. <span data-ttu-id="d973a-367">В диалоговом окне **Параметры ведения журналов Azure** выберите **Все журналы** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="d973a-367">In the **Azure Logging Options** dialog box, click **All logs**, and then click **OK**.</span></span>

    ![Отслеживание всех журналов](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-monitorall.png)
4. <span data-ttu-id="d973a-369">В адресной строке окна браузера добавьте дополнительный символ в URL-адрес, чтобы вызвать ошибку 404 (например, `http://localhost:53370/Home/Contactx`), и нажмите клавишу "ВВОД".</span><span class="sxs-lookup"><span data-stu-id="d973a-369">In the address bar of the browser window, add an extra character to the URL to cause a 404 error (for example, `http://localhost:53370/Home/Contactx`), and press Enter.</span></span>

    <span data-ttu-id="d973a-370">После нескольких секунд в окне Visual Studio **Вывод** появится подробный журнал ошибок.</span><span class="sxs-lookup"><span data-stu-id="d973a-370">After several seconds the detailed error log appears in the Visual Studio **Output** window.</span></span>

    ![Подробный журнал ошибок в окне вывода](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-detailederrorlog.png)

    <span data-ttu-id="d973a-372">Щелкните ссылку, удерживая нажатой клавишу CTRL, чтобы просмотреть форматированные выходные данные журнала в браузере:</span><span class="sxs-lookup"><span data-stu-id="d973a-372">Control+click the link to see the log output formatted in a browser:</span></span>

    ![Подробный журнал ошибок в окне браузера](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-detailederrorloginbrowser.png)

## <span data-ttu-id="d973a-374"><a name="downloadlogs"></a>Загрузка журналов файловой системы</span><span class="sxs-lookup"><span data-stu-id="d973a-374"><a name="downloadlogs"></a>Download file system logs</span></span>
<span data-ttu-id="d973a-375">Все журналы, которые можно отслеживать в окне **Вывод** , также можно загрузить в виде файла *ZIP* .</span><span class="sxs-lookup"><span data-stu-id="d973a-375">Any logs that you can monitor in the **Output** window can also be downloaded as a *.zip* file.</span></span>

1. <span data-ttu-id="d973a-376">В окне **Вывод** щелкните **Загрузить журналы потоковой передачи**.</span><span class="sxs-lookup"><span data-stu-id="d973a-376">In the **Output** window, click **Download Streaming Logs**.</span></span>

    ![Кнопки вкладки журналов](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-downloadicon.png)

    <span data-ttu-id="d973a-378">В проводнике открывается папка *Загрузки* с выбранным загруженным файлом.</span><span class="sxs-lookup"><span data-stu-id="d973a-378">File Explorer opens to your *Downloads* folder with the downloaded file selected.</span></span>

    ![Загруженный файл](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-downloadedfile.png)
2. <span data-ttu-id="d973a-380">Извлеките содержимое *ZIP* -файла, чтобы увидеть структуру папки, аналогичную следующей:</span><span class="sxs-lookup"><span data-stu-id="d973a-380">Extract the *.zip* file, and you see the following folder structure:</span></span>

    ![Загруженный файл](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-logfilefolders.png)

   * <span data-ttu-id="d973a-382">Журналы трассировки приложения хранятся в *TXT*-файлах в папке *LogFiles\Application*.</span><span class="sxs-lookup"><span data-stu-id="d973a-382">Application tracing logs are in *.txt* files in the *LogFiles\Application* folder.</span></span>
   * <span data-ttu-id="d973a-383">Журналы веб-сервера хранятся в *LOG*-файлах в папке *LogFiles\http\RawLogs*.</span><span class="sxs-lookup"><span data-stu-id="d973a-383">Web server logs are in *.log* files in the *LogFiles\http\RawLogs* folder.</span></span> <span data-ttu-id="d973a-384">Можно использовать средство, аналогичное [Log Parser](http://www.microsoft.com/download/details.aspx?displaylang=en&id=24659) для просмотра и обработки этих файлов.</span><span class="sxs-lookup"><span data-stu-id="d973a-384">You can use a tool such as [Log Parser](http://www.microsoft.com/download/details.aspx?displaylang=en&id=24659) to view and manipulate these files.</span></span>
   * <span data-ttu-id="d973a-385">Подробные журналы сообщений об ошибках хранятся в *HTML*-файлах в папке *LogFiles\DetailedErrors*.</span><span class="sxs-lookup"><span data-stu-id="d973a-385">Detailed error message logs are in *.html* files in the *LogFiles\DetailedErrors* folder.</span></span>

     <span data-ttu-id="d973a-386">(Папка *deployments* предназначена для файлов, созданных при публикации системы управления версиями; она никак не связана с публикациями Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d973a-386">(The *deployments* folder is for files created by source control publishing; it doesn't have anything related to Visual Studio publishing.</span></span> <span data-ttu-id="d973a-387">Папка *Git* предназначена для трассировок, относящихся к публикациям системы управления версиями и службы потоковой передачи файлов журналов.)</span><span class="sxs-lookup"><span data-stu-id="d973a-387">The *Git* folder is for traces related to source control publishing and the log file streaming service.)</span></span>  

## <span data-ttu-id="d973a-388"><a name="storagelogs"></a>Просмотр журналов хранилища</span><span class="sxs-lookup"><span data-stu-id="d973a-388"><a name="storagelogs"></a>View storage logs</span></span>
<span data-ttu-id="d973a-389">Журналы трассировки приложения также могут быть переданы в учетную запись хранения Azure, после чего их можно просмотреть в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d973a-389">Application tracing logs can also be sent to an Azure storage account, and you can view them in Visual Studio.</span></span> <span data-ttu-id="d973a-390">Для этого необходимо создать учетную запись хранения, включить журналы хранилища на классическом портале и просмотреть их на вкладке **Журналы** окна **Веб-приложение Azure**.</span><span class="sxs-lookup"><span data-stu-id="d973a-390">To do that you'll create a storage account, enable storage logs in the classic portal, and view them in the **Logs** tab of the **Azure Web App** window.</span></span>

<span data-ttu-id="d973a-391">Журналы можно отправить в любое из трех мест назначения:</span><span class="sxs-lookup"><span data-stu-id="d973a-391">You can send logs to any or all of three destinations:</span></span>

* <span data-ttu-id="d973a-392">Файловая система.</span><span class="sxs-lookup"><span data-stu-id="d973a-392">The file system.</span></span>
* <span data-ttu-id="d973a-393">Таблицы учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-393">Storage account tables.</span></span>
* <span data-ttu-id="d973a-394">Большие двоичные объекты учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-394">Storage account blobs.</span></span>

<span data-ttu-id="d973a-395">Для каждого места назначения вы можете задать отдельный уровень серьезности.</span><span class="sxs-lookup"><span data-stu-id="d973a-395">You can specify a different severity level for each destination.</span></span>

<span data-ttu-id="d973a-396">Таблицы удобны для просмотра данных журналов в Интернете и поддерживают потоковую передачу. Это позволяет запрашивать новые журналы из таблиц по мере их создания.</span><span class="sxs-lookup"><span data-stu-id="d973a-396">Tables make it easy to view details of logs online, and they support streaming; you can query logs in tables and see new logs as they are being created.</span></span> <span data-ttu-id="d973a-397">Используя BLOB-объекты, вы можете загрузить журналы в файл для последующего анализа в средстве HDInsight, которое поддерживает такой формат данных.</span><span class="sxs-lookup"><span data-stu-id="d973a-397">Blobs make it easy to download logs in files and to analyze them using HDInsight, because HDInsight knows how to work with blob storage.</span></span> <span data-ttu-id="d973a-398">Дополнительные сведения см. в разделе **Hadoop и MapReduce** статьи [Варианты хранения данных (создание реальных облачных приложений в Azure)](http://www.asp.net/aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/data-storage-options).</span><span class="sxs-lookup"><span data-stu-id="d973a-398">For more information, see **Hadoop and MapReduce** in [Data Storage Options (Building Real-World Cloud Apps with Azure)](http://www.asp.net/aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/data-storage-options).</span></span>

<span data-ttu-id="d973a-399">На данный момент вы настроили подробное ведение журналов файловой системы. Далее вы настроите журналы информационного уровня, которые будут передаваться в таблицы учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-399">You currently have file system logs set to verbose level; the following steps walk you through setting up information level logs to go to storage account tables.</span></span> <span data-ttu-id="d973a-400">Информационный уровень означает, что все журналы, созданные вызовом методов `Trace.TraceInformation`, `Trace.TraceWarning` и `Trace.TraceError`, будут отображаться, однако не будут отображаться журналы, созданные при вызове `Trace.WriteLine`.</span><span class="sxs-lookup"><span data-stu-id="d973a-400">Information level means all logs created by calling `Trace.TraceInformation`, `Trace.TraceWarning`, and `Trace.TraceError` will be displayed, but not logs created by calling `Trace.WriteLine`.</span></span>

<span data-ttu-id="d973a-401">Учетные записи хранения, в отличие от файловой системы, обеспечивают длительное хранение больших объемов данных журналов.</span><span class="sxs-lookup"><span data-stu-id="d973a-401">Storage accounts offer more storage and longer-lasting retention for logs compared to the file system.</span></span> <span data-ttu-id="d973a-402">Еще одним преимуществом отправки журналов трассировки приложений в систему хранения является получение некоторых дополнительных сведений вместе с каждым журналом, которые недоступны при использовании журналов из файловой системы.</span><span class="sxs-lookup"><span data-stu-id="d973a-402">Another advantage of sending application tracing logs to storage is that you get some additional information with each log that you don't get from file system logs.</span></span>

1. <span data-ttu-id="d973a-403">Щелкните правой кнопкой мыши **Хранилище** в узле Azure и выберите пункт **Создать учетную запись хранения**.</span><span class="sxs-lookup"><span data-stu-id="d973a-403">Right-click **Storage** under the Azure node, and then click **Create Storage Account**.</span></span>

![Учетная запись хранения](./media/web-sites-dotnet-troubleshoot-visual-studio/createstor.png)

1. <span data-ttu-id="d973a-405">В диалоговом окне **Создание учетной записи хранения** введите имя для учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-405">In the **Create Storage Account** dialog, enter a name for the storage account.</span></span>

    <span data-ttu-id="d973a-406">Имя должно быть уникальным (не допускается существование учетных записей хранения Azure с одинаковыми именами).</span><span class="sxs-lookup"><span data-stu-id="d973a-406">The name must be must be unique (no other Azure storage account can have the same name).</span></span> <span data-ttu-id="d973a-407">Если введенное имя уже используется, вы получите возможность изменить его.</span><span class="sxs-lookup"><span data-stu-id="d973a-407">If the name you enter is already in use you'll get a chance to change it.</span></span>

    <span data-ttu-id="d973a-408">URL-адрес для доступа к вашей учетной записи хранения будет выглядеть следующим образом: *{имя}*.core.windows.net.</span><span class="sxs-lookup"><span data-stu-id="d973a-408">The URL to access your storage account will be *{name}*.core.windows.net.</span></span>
2. <span data-ttu-id="d973a-409">В раскрывающемся списке **Регион или территориальная группа** укажите ближайший к вам регион.</span><span class="sxs-lookup"><span data-stu-id="d973a-409">Set the **Region or Affinity Group** drop-down list to the region closest to you.</span></span>

    <span data-ttu-id="d973a-410">Этот параметр указывает, в каком центре обработки данных Azure будет размещаться учетная запись хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-410">This setting specifies which Azure datacenter will host your storage account.</span></span> <span data-ttu-id="d973a-411">Теоретически этот выбор не имеет большого значения. Но для рабочего веб-приложения веб-сервер и учетная запись хранения должны находиться в одном регионе, чтобы свести к минимуму задержку и стоимость исходящих данных.</span><span class="sxs-lookup"><span data-stu-id="d973a-411">For this tutorial your choice won't make a noticeable difference, but for a production web app you want your web server and your storage account to be in the same region to minimize latency and data egress charges.</span></span> <span data-ttu-id="d973a-412">Веб-приложение (которое будет создано позже) должно быть размещено физически как можно ближе к браузерам, получившим доступ к нему, чтобы свести к минимуму задержку.</span><span class="sxs-lookup"><span data-stu-id="d973a-412">The web app (which you'll create later) should run in a region as close as possible to the browsers accessing your web app in order to minimize latency.</span></span>
3. <span data-ttu-id="d973a-413">В раскрывающемся списке **Репликация** установите значение **Локально избыточное**.</span><span class="sxs-lookup"><span data-stu-id="d973a-413">Set the **Replication** drop-down list to **Locally redundant**.</span></span>
   
    <span data-ttu-id="d973a-414">При включении георепликации для учетной записи хранения хранящиеся данные реплицируются в дополнительный центр обработки данных для обеспечения возможности отработки отказа в это расположение в случае крупной аварии в основном расположении.</span><span class="sxs-lookup"><span data-stu-id="d973a-414">When geo-replication is enabled for a storage account, the stored content is replicated to a secondary datacenter to enable failover to that location in case of a major disaster in the primary location.</span></span> <span data-ttu-id="d973a-415">Георепликация может потребовать дополнительных затрат.</span><span class="sxs-lookup"><span data-stu-id="d973a-415">Geo-replication can incur additional costs.</span></span> <span data-ttu-id="d973a-416">Для учетных записей тестирования и разработки оплачивать георепликацию обычно не требуется.</span><span class="sxs-lookup"><span data-stu-id="d973a-416">For test and development accounts, you generally don't want to pay for geo-replication.</span></span> <span data-ttu-id="d973a-417">Дополнительные сведения см. в статье [Об учетных записях хранения Azure](../storage/common/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="d973a-417">For more information, see [Create, manage, or delete a storage account](../storage/common/storage-create-storage-account.md).</span></span>
4. <span data-ttu-id="d973a-418">Щелкните **Создать**.</span><span class="sxs-lookup"><span data-stu-id="d973a-418">Click **Create**.</span></span>

    ![Новая учетная запись хранения](./media/web-sites-dotnet-troubleshoot-visual-studio/newstorage.png)    
5. <span data-ttu-id="d973a-420">В окне Visual Studio **Веб-приложение Azure** откройте вкладку **Журналы**, а затем щелкните **Настроить ведение журнала на портале управления**.</span><span class="sxs-lookup"><span data-stu-id="d973a-420">In the Visual Studio **Azure Web App** window, click the **Logs** tab, and then click **Configure Logging in Management Portal**.</span></span>

    <!-- todo:screenshot of new portal if the VS page link goes to new portal -->
    ![Настройка журнала](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-configlogging.png)

    <span data-ttu-id="d973a-422">После этого на классическом портале Azure откроется вкладка **Настройка** для вашего веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-422">This opens the **Configure** tab in the classic portal for your web app.</span></span>
6. <span data-ttu-id="d973a-423">На вкладке **Настройка** классического портала прокрутите вниз до раздела диагностики приложения и установите переключатель **Ведение журнала приложения (хранилище таблиц)** в положение **Включено**.</span><span class="sxs-lookup"><span data-stu-id="d973a-423">In the classic portal's **Configure** tab, scroll down to the application diagnostics section, and then change **Application Logging (Table Storage)** to **On**.</span></span>
7. <span data-ttu-id="d973a-424">Измените значение параметра **Уровень ведения журнала** на **Сведения**.</span><span class="sxs-lookup"><span data-stu-id="d973a-424">Change **Logging Level** to **Information**.</span></span>
8. <span data-ttu-id="d973a-425">Щелкните **Управление табличным хранилищем**.</span><span class="sxs-lookup"><span data-stu-id="d973a-425">Click **Manage Table Storage**.</span></span>

    ![Щелкните "Управление табличным хранилищем"](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-stgsettingsmgmtportal.png)

    <span data-ttu-id="d973a-427">В поле **Управление табличным хранилищем для диагностики приложений** можно выбрать учетную запись хранения, если у вас их несколько.</span><span class="sxs-lookup"><span data-stu-id="d973a-427">In the **Manage table storage for application diagnostics** box, you can choose your storage account if you have more than one.</span></span> <span data-ttu-id="d973a-428">Вы можете как создать новую, так и использовать существующую таблицу.</span><span class="sxs-lookup"><span data-stu-id="d973a-428">You can create a new table or use an existing one.</span></span>

    ![Управление табличным хранилищем](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-choosestorageacct.png)
9. <span data-ttu-id="d973a-430">В поле **Управление табличным хранилищем для диагностики приложений** щелкните флажок, чтобы закрыть окно.</span><span class="sxs-lookup"><span data-stu-id="d973a-430">In the **Manage table storage for application diagnostics** box click the check mark to close the box.</span></span>
10. <span data-ttu-id="d973a-431">На вкладке **Настройка** классического портала нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="d973a-431">In the classic portal's **Configure** tab, click **Save**.</span></span>
11. <span data-ttu-id="d973a-432">В окне браузера, в котором отображается веб-приложение приложения, щелкните **Home** (Главная), затем **About** (О программе) и **Contact** (Контактная информация).</span><span class="sxs-lookup"><span data-stu-id="d973a-432">In the browser window that displays the application web app, click **Home**, then click **About**, and then click **Contact**.</span></span>

     <span data-ttu-id="d973a-433">Ведение журнала сведений, полученных при просмотре веб-страниц, будут записаны в учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="d973a-433">The logging information produced by browsing these web pages will be written to the storage account.</span></span>
12. <span data-ttu-id="d973a-434">На вкладке **Журналы** окна **Веб-приложение Azure** в Visual Studio щелкните **Обновить** в разделе **Сводка по диагностике**.</span><span class="sxs-lookup"><span data-stu-id="d973a-434">In the **Logs** tab of the **Azure Web App** window in Visual Studio, click **Refresh** under **Diagnostic Summary**.</span></span>

     ![Щелкните "Обновить"](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-refreshstorage.png)

     <span data-ttu-id="d973a-436">В разделе **Сводка по диагностике** по умолчанию отображаются журналы за последние 15 минут.</span><span class="sxs-lookup"><span data-stu-id="d973a-436">The **Diagnostic Summary** section shows logs for the last 15 minutes by default.</span></span> <span data-ttu-id="d973a-437">Можно изменить период для просмотра дополнительных журналов.</span><span class="sxs-lookup"><span data-stu-id="d973a-437">You can change the period to see more logs.</span></span>

     <span data-ttu-id="d973a-438">(При появлении ошибки "Таблица не найдена" убедитесь, что вы перешли к страницам, которые выполняют трассировку, после включения параметра **Ведение журнала приложения (хранилище)** и нажатия кнопки **Сохранить**.)</span><span class="sxs-lookup"><span data-stu-id="d973a-438">(If you get a "table not found" error, verify that you browsed to the pages that do the tracing after you enabled **Application Logging (Storage)** and after you clicked **Save**.)</span></span>

     ![Журналы хранилища](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-storagelogs.png)

     <span data-ttu-id="d973a-440">Обратите внимание, что в этом представлении отображаются **ИД процесса** и **ИД потока** для каждого журнала, что отсутствует в журналах файловой системы.</span><span class="sxs-lookup"><span data-stu-id="d973a-440">Notice that in this view you see **Process ID** and **Thread ID** for each log, which you don't get in the file system logs.</span></span> <span data-ttu-id="d973a-441">Дополнительные поля можно увидеть, напрямую просмотрев таблицу хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-441">You can see additional fields by viewing the Azure storage table directly.</span></span>
13. <span data-ttu-id="d973a-442">Щелкните **Просмотреть все журналы приложений**</span><span class="sxs-lookup"><span data-stu-id="d973a-442">Click **View all application logs**.</span></span>

     <span data-ttu-id="d973a-443">Таблица журнала трассировки отображается в средстве просмотра таблицы хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-443">The trace log table appears in the Azure storage table viewer.</span></span>

     <span data-ttu-id="d973a-444">(Если возникает ошибка "последовательность не содержит элементов", откройте **обозреватель сервера**, разверните узел своей учетной записи хранения в разделе **Azure**, а затем щелкните правой кнопкой мыши **Tables** и выберите **Обновить**.)</span><span class="sxs-lookup"><span data-stu-id="d973a-444">(If you get a "sequence contains no elements" error, open **Server Explorer**, expand the node for your storage account under the **Azure** node, and then right-click **Tables** and click **Refresh**.)</span></span>

     ![Журналы хранилища в табличном представлении](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-tracelogtableview.png)

     <span data-ttu-id="d973a-446">Это представление показывает дополнительные поля, которые не отображаются в других представлениях.</span><span class="sxs-lookup"><span data-stu-id="d973a-446">This view shows additional fields you don't see in any other views.</span></span> <span data-ttu-id="d973a-447">Это представление также позволяет фильтровать журналы, используя для создания запроса специальный пользовательский интерфейс построителя запросов.</span><span class="sxs-lookup"><span data-stu-id="d973a-447">This view also enables you to filter logs by using special Query Builder UI for constructing a query.</span></span> <span data-ttu-id="d973a-448">Дополнительные сведения см. в разделе "Работа с ресурсами таблицы – фильтрация объектов" руководства [Обзор ресурсов хранилища с помощью обозревателя сервера](http://msdn.microsoft.com/library/ff683677.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-448">For more information, see Working with Table Resources - Filtering Entities in [Browsing Storage Resources with Server Explorer](http://msdn.microsoft.com/library/ff683677.aspx).</span></span>
14. <span data-ttu-id="d973a-449">Чтобы просмотреть подробные сведения по отдельной строке, дважды щелкните одну из строк.</span><span class="sxs-lookup"><span data-stu-id="d973a-449">To look at the details for a single row, double-click one of the rows.</span></span>

     ![Таблица трассировки в обозревателе сервера](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-tracetablerow.png)

## <span data-ttu-id="d973a-451"><a name="failedrequestlogs"></a>Просмотр журналов неудачно завершенных запросов</span><span class="sxs-lookup"><span data-stu-id="d973a-451"><a name="failedrequestlogs"></a>View failed request tracing logs</span></span>
<span data-ttu-id="d973a-452">Журналы трассировки неудачно завершенных запросов полезны при просмотре подробных сведений по обработке IIS HTTP-запроса в таких сценариях, как перезапись URL-адреса, или при возникновении проблем, связанных с проблемами проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="d973a-452">Failed request tracing logs are useful when you need to understand the details of how IIS is handling an HTTP request, in scenarios such as URL rewriting or authentication problems.</span></span>

<span data-ttu-id="d973a-453">Веб-приложения Azure используют те же функциональные возможности трассировки неудачно завершенных запросов, которые доступны в IIS, начиная с версии 7.0.</span><span class="sxs-lookup"><span data-stu-id="d973a-453">Azure web apps use the same failed request tracing functionality that has been available with IIS 7.0 and later.</span></span> <span data-ttu-id="d973a-454">Однако у вас нет доступа к параметрам IIS, которые определяют, какие ошибки будут регистрироваться.</span><span class="sxs-lookup"><span data-stu-id="d973a-454">You don't have access to the IIS settings that configure which errors get logged, however.</span></span> <span data-ttu-id="d973a-455">При включении трассировки неудачно завершенных запросов захватываются все ошибки.</span><span class="sxs-lookup"><span data-stu-id="d973a-455">When you enable failed request tracing, all errors are captured.</span></span>

<span data-ttu-id="d973a-456">Можно включить трассировку неудачно завершенных запросов с помощью Visual Studio, однако эту трассировку невозможно просмотреть в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d973a-456">You can enable failed request tracing by using Visual Studio, but you can't view them in Visual Studio.</span></span> <span data-ttu-id="d973a-457">Эти журналы представляют собой XML-файлы.</span><span class="sxs-lookup"><span data-stu-id="d973a-457">These logs are XML files.</span></span> <span data-ttu-id="d973a-458">Служба потоковой передачи журналов только отслеживает файлы, которые могут быть прочтены в режиме обычного текста: это *TXT*-, *HTML*- и *LOG*-файлы.</span><span class="sxs-lookup"><span data-stu-id="d973a-458">The streaming log service only monitors files that are deemed readable in plain text mode:  *.txt*, *.html*, and *.log* files.</span></span>

<span data-ttu-id="d973a-459">Журналы трассировки неудачно завершенных запросов можно просматривать напрямую в браузере через FTP или локально после загрузки их на локальный компьютер с помощью средства для работы с FTP.</span><span class="sxs-lookup"><span data-stu-id="d973a-459">You can view failed request tracing logs in a browser directly via FTP or locally after using an FTP tool to download them to your local computer.</span></span> <span data-ttu-id="d973a-460">В этом разделе они будут просматриваться непосредственно в браузере.</span><span class="sxs-lookup"><span data-stu-id="d973a-460">In this section you'll view them in a browser directly.</span></span>

1. <span data-ttu-id="d973a-461">На вкладке **Конфигурация** окна **Веб-приложение Azure**, открытого в **обозревателе сервера**, измените значение параметра **Трассировка неудачно завершенных запросов** на **Включено**, затем нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="d973a-461">In the **Configuration** tab of the **Azure Web App** window that you opened from **Server Explorer**, change **Failed Request Tracing** to **On**, and then click **Save**.</span></span>

    ![Включение трассировки неудачно завершенных запросов](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-failedrequeston.png)
2. <span data-ttu-id="d973a-463">В адресной строке окна браузера, в котором отображается веб-приложение, добавьте дополнительный символ в URL-адрес, чтобы вызвать ошибку 404, и нажмите клавишу "ВВОД".</span><span class="sxs-lookup"><span data-stu-id="d973a-463">In the address bar of the browser window that shows the web app, add an extra character to the URL and click Enter to cause a 404 error.</span></span>

    <span data-ttu-id="d973a-464">Это приведет к созданию журнала трассировки неудачно завершенных запросов. Ниже приведены действия, демонстрирующие, как просмотреть или загрузить журнал.</span><span class="sxs-lookup"><span data-stu-id="d973a-464">This causes a failed request tracing log to be created, and the following steps show how to view or download the log.</span></span>
3. <span data-ttu-id="d973a-465">В Visual Studio на вкладке **Конфигурация** окна **Веб-приложение Azure** щелкните **Открыть на портале управления**.</span><span class="sxs-lookup"><span data-stu-id="d973a-465">In Visual Studio, in the **Configuration** tab of the **Azure Web App** window, click **Open in Management Portal**.</span></span>
4. <span data-ttu-id="d973a-466">На [портале Azure](https://portal.azure.com) в колонке **Параметры** вашего веб-приложения щелкните **Учетные данные развертывания**, а затем введите новые имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="d973a-466">In the [Azure Portal](https://portal.azure.com) **Settings** blade for your web app, click **Deployment credentials**, and then enter a new user name and password.</span></span>

    ![Новое имя пользователя и пароль FTP](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-enterftpcredentials.png)

    <span data-ttu-id="d973a-468">**Для входа необходимо использовать полное имя пользователя с префиксом в виде имени веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-468">**When you log in, you have to use the full user name with the web app name prefixed to it.</span></span> <span data-ttu-id="d973a-469">Например, если ввести имя пользователя myid и сайт myexample, то полным именем будет myexample\myid.</span><span class="sxs-lookup"><span data-stu-id="d973a-469">For example, if you enter "myid" as a user name and the site is "myexample", you log in as "myexample\myid".</span></span>
5. <span data-ttu-id="d973a-470">В новом окне браузера перейдите по URL-адресу, показанному в поле **Имя узла FTP** или **Имя узла FTPS** в колонке **Веб-приложение**.</span><span class="sxs-lookup"><span data-stu-id="d973a-470">In a new browser window, go to the URL that is shown under **FTP hostname** or **FTPS hostname** in the **Web App** blade for your web app.</span></span>
6. <span data-ttu-id="d973a-471">Выполните вход с использованием учетных данных FTP, созданных ранее (включая имя веб-приложения в виде префикса к имени пользователя).</span><span class="sxs-lookup"><span data-stu-id="d973a-471">Log in using the FTP credentials that you created earlier (including the web app name prefix for the user name).</span></span>

    <span data-ttu-id="d973a-472">В браузере отображается корневая папка веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d973a-472">The browser shows the root folder of the web app.</span></span>
7. <span data-ttu-id="d973a-473">Откройте папку *LogFiles* .</span><span class="sxs-lookup"><span data-stu-id="d973a-473">Open the *LogFiles* folder.</span></span>

    ![Откройте папку LogFiles](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-logfilesfolder.png)
8. <span data-ttu-id="d973a-475">Откройте папку с именем W3SVC плюс числовое значение.</span><span class="sxs-lookup"><span data-stu-id="d973a-475">Open the folder that is named W3SVC plus a numeric value.</span></span>

    ![Откройте папку W3SVC](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-w3svcfolder.png)

    <span data-ttu-id="d973a-477">Папка содержит XML-файлы, связанные с любыми ошибками, которые были зарегистрированы после включения трассировки неудачно завершенных запросов, а также XSL-файл, который может использоваться браузером для форматирования XML.</span><span class="sxs-lookup"><span data-stu-id="d973a-477">The folder contains XML files for any errors that have been logged after you enabled failed request tracing, and an XSL file that a browser can use to format the XML.</span></span>

    ![Папка W3SVC](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-w3svcfoldercontents.png)
9. <span data-ttu-id="d973a-479">Щелкните XML-файл, связанный с неудачно завершенным запросом, данные трассировки которого необходимо просмотреть.</span><span class="sxs-lookup"><span data-stu-id="d973a-479">Click the XML file for the failed request that you want to see tracing information for.</span></span>

    <span data-ttu-id="d973a-480">На следующем рисунке показана часть сведений трассировки примерной ошибки.</span><span class="sxs-lookup"><span data-stu-id="d973a-480">The following illustration shows part of the tracing information for a sample error.</span></span>

    ![Трассировка неудачно завершенных запросов в браузере](./media/web-sites-dotnet-troubleshoot-visual-studio/tws-failedrequestinbrowser.png)

## <span data-ttu-id="d973a-482"><a name="nextsteps"></a>Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d973a-482"><a name="nextsteps"></a>Next Steps</span></span>
<span data-ttu-id="d973a-483">Вы видели, как Visual Studio позволяет легко просматривать журналы, созданные веб-приложением Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-483">You've seen how Visual Studio makes it easy to view logs created by an Azure web app.</span></span> <span data-ttu-id="d973a-484">В следующих разделах содержатся ссылки на дополнительные ресурсы на связанные темы:</span><span class="sxs-lookup"><span data-stu-id="d973a-484">The following sections provide links to more resources on related topics:</span></span>

* <span data-ttu-id="d973a-485">Устранение неполадок веб-приложения Azure</span><span class="sxs-lookup"><span data-stu-id="d973a-485">Azure web app troubleshooting</span></span>
* <span data-ttu-id="d973a-486">Отладка в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d973a-486">Debugging in Visual Studio</span></span>
* <span data-ttu-id="d973a-487">Удаленная отладка в Azure</span><span class="sxs-lookup"><span data-stu-id="d973a-487">Remote debugging in Azure</span></span>
* <span data-ttu-id="d973a-488">Трассировка в приложениях ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d973a-488">Tracing in ASP.NET applications</span></span>
* <span data-ttu-id="d973a-489">Анализ журналов веб-сервера</span><span class="sxs-lookup"><span data-stu-id="d973a-489">Analyzing web server logs</span></span>
* <span data-ttu-id="d973a-490">Анализ журналов трассировки неудачно завершенных запросов</span><span class="sxs-lookup"><span data-stu-id="d973a-490">Analyzing failed request tracing logs</span></span>
* <span data-ttu-id="d973a-491">Отладка облачных служб</span><span class="sxs-lookup"><span data-stu-id="d973a-491">Debugging Cloud Services</span></span>

### <a name="azure-web-app-troubleshooting"></a><span data-ttu-id="d973a-492">Устранение неполадок веб-приложения Azure</span><span class="sxs-lookup"><span data-stu-id="d973a-492">Azure web app troubleshooting</span></span>
<span data-ttu-id="d973a-493">Дополнительную информацию об устранении неполадок, связанных с веб-приложениями в службе приложений Azure, см. на следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="d973a-493">For more information about troubleshooting web apps in Azure App Service, see the following resources:</span></span>

* [<span data-ttu-id="d973a-494">Мониторинг веб-приложений</span><span class="sxs-lookup"><span data-stu-id="d973a-494">How to monitor web apps</span></span>](/manage/services/web-sites/how-to-monitor-websites/)
* <span data-ttu-id="d973a-495">[Исследование проблемы утечки памяти в веб-приложениях Azure с использованием Visual Studio 2013](http://blogs.msdn.com/b/visualstudioalm/archive/2013/12/20/investigating-memory-leaks-in-azure-web-sites-with-visual-studio-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-495">[Investigating Memory Leaks in Azure Web Apps with Visual Studio 2013](http://blogs.msdn.com/b/visualstudioalm/archive/2013/12/20/investigating-memory-leaks-in-azure-web-sites-with-visual-studio-2013.aspx).</span></span> <span data-ttu-id="d973a-496">Запись блога Microsoft ALM о функциях Visual Studio для анализа проблем с управляемой памятью.</span><span class="sxs-lookup"><span data-stu-id="d973a-496">Microsoft ALM blog post about Visual Studio features for analyzing managed memory issues.</span></span>
* <span data-ttu-id="d973a-497">[Онлайн-инструменты веб-приложений Azure, о которых вам следует знать](https://azure.microsoft.com/blog/2014/03/28/windows-azure-websites-online-tools-you-should-know-about-2/).</span><span class="sxs-lookup"><span data-stu-id="d973a-497">[Azure web apps online tools you should know about](https://azure.microsoft.com/blog/2014/03/28/windows-azure-websites-online-tools-you-should-know-about-2/).</span></span> <span data-ttu-id="d973a-498">Запись в блоге Амита Эппла (Amit Apple).</span><span class="sxs-lookup"><span data-stu-id="d973a-498">Blog post by Amit Apple.</span></span>

<span data-ttu-id="d973a-499">Справочные данные об определенном вопросе, связанном с устранением неполадок, можно получить, начав беседу на одном из следующих форумов:</span><span class="sxs-lookup"><span data-stu-id="d973a-499">For help with a specific troubleshooting question, start a thread in one of the following forums:</span></span>

* <span data-ttu-id="d973a-500">[Форум Azure на веб-сайте ASP.NET](http://forums.asp.net/1247.aspx/1?Azure+and+ASP+NET).</span><span class="sxs-lookup"><span data-stu-id="d973a-500">[The Azure forum on the ASP.NET site](http://forums.asp.net/1247.aspx/1?Azure+and+ASP+NET).</span></span>
* <span data-ttu-id="d973a-501">[Форум Azure на портале MSDN](http://social.msdn.microsoft.com/Forums/windowsazure/).</span><span class="sxs-lookup"><span data-stu-id="d973a-501">[The Azure forum on MSDN](http://social.msdn.microsoft.com/Forums/windowsazure/).</span></span>
* <span data-ttu-id="d973a-502">[StackOverflow.com](http://www.stackoverflow.com).</span><span class="sxs-lookup"><span data-stu-id="d973a-502">[StackOverflow.com](http://www.stackoverflow.com).</span></span>

### <a name="debugging-in-visual-studio"></a><span data-ttu-id="d973a-503">Отладка в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d973a-503">Debugging in Visual Studio</span></span>
<span data-ttu-id="d973a-504">Дополнительные сведения об использовании режима отладки в Visual Studio см. в разделе MSDN [Отладка в Visual Studio](http://msdn.microsoft.com/library/vstudio/sc65sadd.aspx) и статье [Рекомендации по отладке в Visual Studio 2010](http://weblogs.asp.net/scottgu/archive/2010/08/18/debugging-tips-with-visual-studio-2010.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-504">For more information about how to use debug mode in Visual Studio, see the [Debugging in Visual Studio](http://msdn.microsoft.com/library/vstudio/sc65sadd.aspx) MSDN topic and [Debugging Tips with Visual Studio 2010](http://weblogs.asp.net/scottgu/archive/2010/08/18/debugging-tips-with-visual-studio-2010.aspx).</span></span>

### <a name="remote-debugging-in-azure"></a><span data-ttu-id="d973a-505">Удаленная отладка в Azure</span><span class="sxs-lookup"><span data-stu-id="d973a-505">Remote debugging in Azure</span></span>
<span data-ttu-id="d973a-506">Для получения дополнительных сведений об удаленной отладке для веб-приложений Azure и веб-заданий см. следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="d973a-506">For more information about remote debugging for Azure web apps and WebJobs, see the following resources:</span></span>

* <span data-ttu-id="d973a-507">[Общие сведения об удаленной отладке веб-приложений службы приложений Azure](https://azure.microsoft.com/blog/2014/05/06/introduction-to-remote-debugging-on-azure-web-sites/).</span><span class="sxs-lookup"><span data-stu-id="d973a-507">[Introduction to Remote Debugging Azure App Service Web Apps](https://azure.microsoft.com/blog/2014/05/06/introduction-to-remote-debugging-on-azure-web-sites/).</span></span>
* [<span data-ttu-id="d973a-508">Общие сведения об удаленной отладке веб-приложений службы приложений Azure (часть 2) — подробнее об удаленной отладке</span><span class="sxs-lookup"><span data-stu-id="d973a-508">Introduction to Remote Debugging Azure App Service Web Apps part 2 - Inside Remote debugging</span></span>](https://azure.microsoft.com/blog/2014/05/07/introduction-to-remote-debugging-azure-web-sites-part-2-inside-remote-debugging/)
* [<span data-ttu-id="d973a-509">Общие сведения об удаленной отладке веб-приложений службы приложений Azure (часть 3) — среда с несколькими экземплярами и GIT</span><span class="sxs-lookup"><span data-stu-id="d973a-509">Introduction to Remote Debugging on Azure App Service Web Apps part 3 - Multi-Instance environment and GIT</span></span>](https://azure.microsoft.com/blog/2014/05/08/introduction-to-remote-debugging-on-azure-web-sites-part-3-multi-instance-environment-and-git/)
* [<span data-ttu-id="d973a-510">Отладка веб-заданий (видео)</span><span class="sxs-lookup"><span data-stu-id="d973a-510">WebJobs Debugging (video)</span></span>](https://www.youtube.com/watch?v=ncQm9q5ZFZs&list=UU_SjTh-ZltPmTYzAybypB-g&index=1)

<span data-ttu-id="d973a-511">Если в вашем веб-приложении используется веб-API Azure или серверная часть мобильных служб, вы можете получить дополнительные сведения об отладке в разделе [Отладка серверной части .NET в Visual Studio](http://blogs.msdn.com/b/azuremobile/archive/2014/03/14/debugging-net-backend-in-visual-studio.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-511">If your web app uses an Azure Web API or Mobile Services back-end and you need to debug that, see [Debugging .NET Backend in Visual Studio](http://blogs.msdn.com/b/azuremobile/archive/2014/03/14/debugging-net-backend-in-visual-studio.aspx).</span></span>

### <a name="tracing-in-aspnet-applications"></a><span data-ttu-id="d973a-512">Трассировка в приложениях ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d973a-512">Tracing in ASP.NET applications</span></span>
<span data-ttu-id="d973a-513">В Интернете отсутствуют обновленные и подробные вводные данные по трассировке ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d973a-513">There are no thorough and up-to-date introductions to ASP.NET tracing available on the Internet.</span></span> <span data-ttu-id="d973a-514">Лучшее, что можно сделать, это начать со старых вводных материалов, написанных для Web Forms, так как тогда MVC еще не существовало. А также дополнить эти сведения новыми постами из блогов, посвященных тем или иным конкретным вопросам.</span><span class="sxs-lookup"><span data-stu-id="d973a-514">The best you can do is get started with old introductory materials written for Web Forms because MVC didn't exist yet, and supplement that with newer blog posts that focus on specific issues.</span></span> <span data-ttu-id="d973a-515">Можно также продуктивно начать изучение со следующих ресурсов:</span><span class="sxs-lookup"><span data-stu-id="d973a-515">Some good places to start are the following resources:</span></span>

* <span data-ttu-id="d973a-516">[Мониторинг и телеметрия (создание реальных облачных приложений в Azure)](http://www.asp.net/aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/monitoring-and-telemetry).</span><span class="sxs-lookup"><span data-stu-id="d973a-516">[Monitoring and Telemetry (Building Real-World Cloud Apps with Azure)](http://www.asp.net/aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/monitoring-and-telemetry).</span></span><br>
  <span data-ttu-id="d973a-517">Глава электронной книги с рекомендациями по трассировке в облачных приложениях Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-517">E-book chapter with recommendations for tracing in Azure cloud applications.</span></span>
* [<span data-ttu-id="d973a-518">Трассировка ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d973a-518">ASP.NET Tracing</span></span>](http://msdn.microsoft.com/library/ms972204.aspx)<br/>
  <span data-ttu-id="d973a-519">Старый, но по-прежнему хороший ресурс для введения в тему.</span><span class="sxs-lookup"><span data-stu-id="d973a-519">Old but still a good resource for a basic introduction to the subject.</span></span>
* [<span data-ttu-id="d973a-520">Прослушиватели трассировки</span><span class="sxs-lookup"><span data-stu-id="d973a-520">Trace Listeners</span></span>](http://msdn.microsoft.com/library/4y5y10s7.aspx)<br/>
  <span data-ttu-id="d973a-521">Сведения о прослушивателях трассировки, но без упоминания [WebPageTraceListener](http://msdn.microsoft.com/library/system.web.webpagetracelistener.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-521">Information about trace listeners but doesn't mention the [WebPageTraceListener](http://msdn.microsoft.com/library/system.web.webpagetracelistener.aspx).</span></span>
* [<span data-ttu-id="d973a-522">Пошаговое руководство: интеграция трассировки ASP.NET с трассировкой System.Diagnostics</span><span class="sxs-lookup"><span data-stu-id="d973a-522">Walkthrough: Integrating ASP.NET Tracing with System.Diagnostics Tracing</span></span>](http://msdn.microsoft.com/library/b0ectfxd.aspx)<br/>
  <span data-ttu-id="d973a-523">Это также старый ресурс, который, однако, содержит некоторые дополнительные сведения, которые не освещаются во вводной статье.</span><span class="sxs-lookup"><span data-stu-id="d973a-523">This too is old, but includes some additional information that the introductory article doesn't cover.</span></span>
* [<span data-ttu-id="d973a-524">Трассировка в представлениях ASP.NET MVC Razor</span><span class="sxs-lookup"><span data-stu-id="d973a-524">Tracing in ASP.NET MVC Razor Views</span></span>](http://blogs.msdn.com/b/webdev/archive/2013/07/16/tracing-in-asp-net-mvc-razor-views.aspx)<br/>
  <span data-ttu-id="d973a-525">Помимо трассировки в представлениях Razor, в этом посте также описывается, как создать фильтр ошибок, чтобы регистрировать все необработанные исключения в приложении MVC.</span><span class="sxs-lookup"><span data-stu-id="d973a-525">Besides tracing in Razor views, the post also explains how to create an error filter in order to log all unhandled exceptions in an MVC application.</span></span> <span data-ttu-id="d973a-526">Сведения о записи в журнал всех необработанных исключений в приложении Web Forms представлены в примере Global.asax в разделе [Полный пример для обработчиков ошибок](http://msdn.microsoft.com/library/bb397417.aspx) на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="d973a-526">For information about how to log all unhandled exceptions in a Web Forms application, see the Global.asax example in [Complete Example for Error Handlers](http://msdn.microsoft.com/library/bb397417.aspx) on MSDN.</span></span> <span data-ttu-id="d973a-527">Если в MVC или Web Forms понадобится зарегистрировать определенные исключения, но позволить платформе их обрабатывать, можно перехватить и повторно создать элементы, как показано на следующем примере:</span><span class="sxs-lookup"><span data-stu-id="d973a-527">In either MVC or Web Forms, if you want to log certain exceptions but let the default framework handling take effect for them, you can catch and rethrow as in the following example:</span></span>

        try
        {
           // Your code that might cause an exception to be thrown.
        }
        catch (Exception ex)
        {
            Trace.TraceError("Exception: " + ex.ToString());
            throw;
        }
* [<span data-ttu-id="d973a-528">Потоковая передача диагностических журналов трассировки из командной строки Azure (включая Glimpse!)</span><span class="sxs-lookup"><span data-stu-id="d973a-528">Streaming Diagnostics Trace Logging from the Azure Command Line (plus Glimpse!)</span></span>](http://www.hanselman.com/blog/StreamingDiagnosticsTraceLoggingFromTheAzureCommandLinePlusGlimpse.aspx)<br/>
  <span data-ttu-id="d973a-529">Как использовать командную строку, чтобы сделать все, что показано в этом руководстве на примере Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d973a-529">How to use the command line to do what this tutorial shows how to do in Visual Studio.</span></span> <span data-ttu-id="d973a-530">[Glimpse](http://www.hanselman.com/blog/IfYoureNotUsingGlimpseWithASPNETForDebuggingAndProfilingYoureMissingOut.aspx) – это средство для отладки приложений ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d973a-530">[Glimpse](http://www.hanselman.com/blog/IfYoureNotUsingGlimpseWithASPNETForDebuggingAndProfilingYoureMissingOut.aspx) is a tool for debugging ASP.NET applications.</span></span>
* <span data-ttu-id="d973a-531">[Использование функций диагностики и ведения журнала для веб-приложений с Дэвидом Эббо (David Ebbo)](/documentation/videos/azure-web-site-logging-and-diagnostics/) и [Потоковая передача журналов из веб-приложений с Дэвидом Эббо (David Ebbo)](/documentation/videos/log-streaming-with-azure-web-sites/)</span><span class="sxs-lookup"><span data-stu-id="d973a-531">[Using Web Apps Logging and Diagnostics - with David Ebbo](/documentation/videos/azure-web-site-logging-and-diagnostics/) and [Streaming Logs from Web Apps - with David Ebbo](/documentation/videos/log-streaming-with-azure-web-sites/)</span></span><br>
  <span data-ttu-id="d973a-532">Авторы видео: Скотт Хансельман (Scott Hanselman) и Дэвид Эббо (David Ebbo).</span><span class="sxs-lookup"><span data-stu-id="d973a-532">Videos by Scott Hanselman and David Ebbo.</span></span>

<span data-ttu-id="d973a-533">Для ведения журнала ошибок вместо написания своего кода трассировки можно использовать платформу ведения журналов с открытым кодом, например [ELMAH](http://nuget.org/packages/elmah/).</span><span class="sxs-lookup"><span data-stu-id="d973a-533">For error logging, an alternative to writing your own tracing code is to use an open-source logging framework such as [ELMAH](http://nuget.org/packages/elmah/).</span></span> <span data-ttu-id="d973a-534">Дополнительные сведения см. в [записях блога Скотта Хансельмана (Scott Hanselman), посвященных ELMAH](http://www.hanselman.com/blog/NuGetPackageOfTheWeek7ELMAHErrorLoggingModulesAndHandlersWithSQLServerCompact.aspx).</span><span class="sxs-lookup"><span data-stu-id="d973a-534">For more information, see [Scott Hanselman's blog posts about ELMAH](http://www.hanselman.com/blog/NuGetPackageOfTheWeek7ELMAHErrorLoggingModulesAndHandlersWithSQLServerCompact.aspx).</span></span>

<span data-ttu-id="d973a-535">Обратите внимание, что не нужно использовать трассировку ASP.NET или System.Diagnostics для получения потоковых журналов из Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-535">Also, note that you don't have to use ASP.NET or System.Diagnostics tracing if you want to get streaming logs from Azure.</span></span> <span data-ttu-id="d973a-536">Служба потоковой передачи журналов веб-сайта Azure будет передавать любые *TXT*-, *HTML*- или *LOG*-файлы, которые будут найдены в папке *LogFiles*.</span><span class="sxs-lookup"><span data-stu-id="d973a-536">The Azure web app streaming log service will stream any *.txt*, *.html*, or *.log* file that it finds in the *LogFiles* folder.</span></span> <span data-ttu-id="d973a-537">Поэтому можно создать собственную систему ведения журналов, которая записывает данные в файловую систему или в веб-приложение, а файлы будут автоматически передаваться и загружаться.</span><span class="sxs-lookup"><span data-stu-id="d973a-537">Therefore, you could create your own logging system that writes to the file system of the web app, and your file will be automatically streamed and downloaded.</span></span> <span data-ttu-id="d973a-538">Все, что нужно сделать, — это написать код приложения, который создает файлы в папке *d:\home\logfiles*.</span><span class="sxs-lookup"><span data-stu-id="d973a-538">All you have to do is write application code that creates files in the *d:\home\logfiles* folder.</span></span>

### <a name="analyzing-web-server-logs"></a><span data-ttu-id="d973a-539">Анализ журналов веб-сервера</span><span class="sxs-lookup"><span data-stu-id="d973a-539">Analyzing web server logs</span></span>
<span data-ttu-id="d973a-540">Дополнительные сведения об анализе журналов веб-сервера см. на следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="d973a-540">For more information about analyzing web server logs, see the following resources:</span></span>

* [<span data-ttu-id="d973a-541">LogParser</span><span class="sxs-lookup"><span data-stu-id="d973a-541">LogParser</span></span>](http://www.microsoft.com/download/details.aspx?id=24659)<br/>
  <span data-ttu-id="d973a-542">Инструмент для просмотра данных в журналах веб-сервера (*LOG* -файлов).</span><span class="sxs-lookup"><span data-stu-id="d973a-542">A tool for viewing data in web server logs (*.log* files).</span></span>
* [<span data-ttu-id="d973a-543">Устранение неполадок, связанных с производительностью IIS, или ошибок приложений с помощью LogParser</span><span class="sxs-lookup"><span data-stu-id="d973a-543">Troubleshooting IIS Performance Issues or Application Errors using LogParser </span></span>](http://www.iis.net/learn/troubleshoot/performance-issues/troubleshooting-iis-performance-issues-or-application-errors-using-logparser)<br/>
  <span data-ttu-id="d973a-544">Введение в средство LogParser, которое можно использовать для анализа журналов веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="d973a-544">An introduction to the Log Parser tool that you can use to analyze web server logs.</span></span>
* [<span data-ttu-id="d973a-545">Записи блога Роберта Мак-Мюррея (Robert McMurray), посвященные использованию LogParser</span><span class="sxs-lookup"><span data-stu-id="d973a-545">Blog posts by Robert McMurray on using LogParser</span></span>](http://blogs.msdn.com/b/robert_mcmurray/archive/tags/logparser/)<br/>
* [<span data-ttu-id="d973a-546">Код состояния HTTP в IIS 7.0, IIS 7.5 и IIS 8.0</span><span class="sxs-lookup"><span data-stu-id="d973a-546">The HTTP status code in IIS 7.0, IIS 7.5, and IIS 8.0</span></span>](http://support.microsoft.com/kb/943891)

### <a name="analyzing-failed-request-tracing-logs"></a><span data-ttu-id="d973a-547">Анализ журналов трассировки неудачно завершенных запросов</span><span class="sxs-lookup"><span data-stu-id="d973a-547">Analyzing failed request tracing logs</span></span>
<span data-ttu-id="d973a-548">Веб-сайт Microsoft TechNet содержит раздел [Использование трассировки неудачно завершенных запросов](http://www.iis.net/learn/troubleshoot/using-failed-request-tracing) , который может оказаться полезным для понимания того, как используются эти журналы.</span><span class="sxs-lookup"><span data-stu-id="d973a-548">The Microsoft TechNet website includes a [Using Failed Request Tracing](http://www.iis.net/learn/troubleshoot/using-failed-request-tracing) section which may be helpful for understanding how to use these logs.</span></span> <span data-ttu-id="d973a-549">Но эта документация посвящена преимущественно настройке трассировки неудачно завершенных запросов в IIS, которую невозможно выполнить в веб-приложениях Azure.</span><span class="sxs-lookup"><span data-stu-id="d973a-549">However, this documentation focuses mainly on configuring failed request tracing in IIS, which you can't do in Azure Web Apps.</span></span>

[GetStarted]: app-service-web-get-started-dotnet.md
[GetStartedWJ]: websites-dotnet-webjobs-sdk.md
