---
title: "aaaGeo масштаба распределенных со среды службы приложений"
description: "Узнайте, как toohorizontally масштабирование приложений с помощью географического распределения с диспетчера трафика и среды службы приложения."
services: app-service
documentationcenter: 
author: stefsch
manager: erikre
editor: 
ms.assetid: c1b05ca8-3703-4d87-a9ae-819d741787fb
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/07/2016
ms.author: stefsch
ms.openlocfilehash: 9b441f637d8b7f679b3d83240baf99b8ee57e8f3
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="geo-distributed-scale-with-app-service-environments"></a>Географически распределенное масштабирование с использованием сред службы приложений
## <a name="overview"></a>Обзор
Сценарии приложений, которым требуется очень высокий уровень масштабирования может превышать hello вычислительных ресурсов емкости доступных tooa одного развертывания приложения.  К примерам таких сценариев относятся проведение голосования, организация спортивных событий и телевизионных трансляций. Можно выполнить требований высокой масштабируемостью, горизонтальное масштабирование приложений, с несколькими развертываниями приложений, внесенного в одном регионе, а также по регионам, требования к чрезмерной нагрузки toohandle.

Идеальной платформой для горизонтального масштабирования являются среды службы приложений.  После выбора конфигурации среды службы приложений, может поддерживать скорость известных запроса, разработчики могут развертывать дополнительные среды службы приложения в форме «штампа» tooattain требуемой пиковую нагрузки.

Например, предположим, что приложение, запущенное на конфигурации среды службы приложений была протестированных toohandle 20 КБ запросов в секунду.  Если hello требуемой пиковой нагрузки емкость составляет 100 КБ RPS, среды службы приложения пяти (5) могут быть созданы и настроенного tooensure hello приложение может обрабатывать максимальной нагрузки проецируемых hello.

Поскольку клиенты обычно доступ приложений с помощью настраиваемых (или именного) домена, разработчики должны приложении toodistribute способом запросов для всех экземпляров среды службы приложения hello.  Хорошим способом tooaccomplish, это с помощью пользовательского домена hello tooresolve [профиль диспетчера трафика Azure][AzureTrafficManagerProfile].  Hello диспетчера трафика профиль может быть настроенный toopoint всех hello соответствующей среды службы приложения.  Диспетчер трафика автоматически будет обрабатывать распределение клиентов по всем hello среды службы приложения в зависимости от параметров в профиле диспетчера трафика hello балансировки нагрузки hello.  Такой подход работает независимо от того все среды службы приложения hello будут развернуты в одном регионе Azure, или по нескольким регионам Azure, развернутым по всему миру.

Кроме того поскольку клиентам получать доступ к приложениям через hello именного домена, клиенты, независимо от числа hello среды службы приложений, запуск приложения.  Поэтому разработчики могут быстро добавлять и удалять среды службы приложений в зависимости от ожидаемого трафика.

Hello концептуальной приведенной ниже схеме показан приложения горизонтально масштабировать по три среды службы приложения в одном регионе.

![Концепция архитектуры][ConceptualArchitecture] 

Hello оставшейся части этого раздела вы научитесь hello действия, связанные с настройкой распределенной топологии для примера приложения hello, с помощью нескольких средах службы приложений.

## <a name="planning-hello-topology"></a>Планирование топологии hello
Перед построением out объем распределенного приложения, он помогает toohave несколько частей сведения заранее.

* **Пользовательский домен, чтобы приложение hello:** возможности hello пользовательское доменное имя, что клиенты будут использовать приложение hello tooaccess?  Имя для пользовательского домена приложения образец hello hello — *www.scalableasedemo.com*
* **Домен диспетчера трафика:** имя домена должно toobe, выбранных при создании [профиль диспетчера трафика Azure][AzureTrafficManagerProfile].  Это имя будет добавляться к hello *trafficmanager.net* суффикс tooregister запись домена, который управляется диспетчером трафика.  Для примера приложения hello, — имя выбранного hello *масштабируемой ase Демонстрация*.  В результате будет hello полное доменное имя, которое управляется диспетчером трафика *масштабируемой ase demo.trafficmanager.net*.
* **Стратегии для масштабирования занимаемое место приложение hello:** будут распространяться место, занимаемое приложением hello в нескольких средах службы приложений в одном регионе?  в нескольких регионах,  или вы будете применять гибридный подход?  где трафик клиента будет получен, а также как хорошо hello остальной части приложения, поддерживающие серверной инфраструктуры можно масштабировать ожидания должен быть основан Hello принятия решений.  Например, приложение, не хранящее сведения о состоянии, можно масштабировать, развернув конфигурацию из нескольких сред службы приложений в одном регионе, а также в нескольких регионах Azure.  С 15 + открытый регионах Azure доступны toochoose из клиентам действительно создавать объем мире крупномасштабных приложений.  Для пример приложения hello, используется для данной статьи три среды службы приложения были созданы в одном регионе Azure (Юг центральной части США).
* **Соглашения об именовании для среды службы приложения hello:** Each среды службы приложений требует уникального имени.  За один или два среды службы приложения является полезным toohave соглашение об именовании toohelp идентификации каждой среды службы приложений.  Пример приложения hello была использована простая соглашение об именовании.  Hello среды службы приложения hello трех называются *fe1ase*, *fe2ase*, и *fe3ase*.
* **Соглашения об именовании для приложения hello:** так, как будет выполнено несколько экземпляров приложения hello, требуется указать имя для каждого экземпляра приложения hello развертывания.  Один малоизвестных, но очень удобное средство среды службы приложения является, имя приложения может использоваться в нескольких средах службы приложения hello.  Поскольку каждый среды службы приложений имеет уникальный доменный суффикс, разработчики могут выбрать использование toore hello точное имя приложения в каждой среде.  Например, разработчик может назвать приложения так: *myapp.foo1.p.azurewebsites.net*, *myapp.foo2.p.azurewebsites.net*, *myapp.foo3.p.azurewebsites.net* и т. п.  Для примера приложения hello хотя каждый экземпляр приложения также имеет уникальное имя.  Hello приложения экземпляра называются *webfrontend1*, *webfrontend2*, и *webfrontend3*.

## <a name="setting-up-hello-traffic-manager-profile"></a>Настройка hello профиля диспетчера трафика
После развертывания в нескольких средах службы приложений несколько экземпляров приложения hello отдельным приложениям экземпляры могут быть зарегистрированы с помощью диспетчера трафика.  Пример приложения hello диспетчера трафика профиль необходима для *масштабируемой ase demo.trafficmanager.net* , можно направить экземпляров приложения tooany из hello после развертывания клиентов:

* **webfrontend1.fe1ase.p.azurewebsites.NET:** экземпляр пример приложения hello, развернутый на hello первый среды службы приложений.
* **webfrontend2.fe2ase.p.azurewebsites.NET:** экземпляр пример приложения hello, развернутый на hello второй среды службы приложений.
* **webfrontend3.fe3ase.p.azurewebsites.NET:** экземпляр пример приложения hello, развернутый на hello третий среды службы приложений.

Здравствуйте, наиболее простым способом tooregister несколько службе приложений Azure конечных точек, работают в hello **же** регион Azure — с hello Powershell [поддержки диспетчера трафика Azure Resource Manager] [ ARMTrafficManager].  

Hello первым шагом является toocreate профиль диспетчера трафика Azure.  Hello код демонстрирует, как был создан профиль hello для примера приложения hello:

    $profile = New-AzureTrafficManagerProfile –Name scalableasedemo -ResourceGroupName yourRGNameHere -TrafficRoutingMethod Weighted -RelativeDnsName scalable-ase-demo -Ttl 30 -MonitorProtocol HTTP -MonitorPort 80 -MonitorPath "/"

Обратите внимание, каким образом hello *RelativeDnsName* параметра было задано слишком*масштабируемой ase Демонстрация*.  Это как hello доменное имя *масштабируемой ase demo.trafficmanager.net* и связывается с профилем диспетчера трафика.

Hello *TrafficRoutingMethod* параметр определяет hello политики балансировки нагрузки диспетчера трафика будет использовать toodetermine, как загрузить toospread клиента во всех доступных конечных точек hello.  В этом примере hello *Взвешенное* выбрали метод.  Это приведет к во всех конечных точек приложения hello зарегистрированные основании hello относительный вес, связанный с каждой конечной точки на другие запросы от клиентов. 

Hello профиль создан каждый экземпляр приложения добавляется toohello профиль как собственный конечной точки Azure.  Приведенный ниже код Hello извлекает ссылку tooeach внешнего интерфейса веб-приложения и добавляет каждое приложение как конечную точку диспетчера трафика посредством hello *идентификатором TargetResourceId* параметра.

    $webapp1 = Get-AzureRMWebApp -Name webfrontend1
    Add-AzureTrafficManagerEndpointConfig –EndpointName webfrontend1 –TrafficManagerProfile $profile –Type AzureEndpoints -TargetResourceId $webapp1.Id –EndpointStatus Enabled –Weight 10

    $webapp2 = Get-AzureRMWebApp -Name webfrontend2
    Add-AzureTrafficManagerEndpointConfig –EndpointName webfrontend2 –TrafficManagerProfile $profile –Type AzureEndpoints -TargetResourceId $webapp2.Id –EndpointStatus Enabled –Weight 10

    $webapp3 = Get-AzureRMWebApp -Name webfrontend3
    Add-AzureTrafficManagerEndpointConfig –EndpointName webfrontend3 –TrafficManagerProfile $profile –Type AzureEndpoints -TargetResourceId $webapp3.Id –EndpointStatus Enabled –Weight 10

    Set-AzureTrafficManagerProfile –TrafficManagerProfile $profile

Обратите внимание на один вызов слишком*AzureTrafficManagerEndpointConfig добавить* для каждого экземпляра для отдельных приложений.  Hello *идентификатором TargetResourceId* параметр в каждой команде Powershell ссылается на один из трех экземпляров развернутое приложение hello.  Hello профиля диспетчера трафика будет распределяться нагрузки все три конечные точки, зарегистрированные в профиле hello.

Все три конечные точки используют hello hello такие же значения (10) hello *вес* параметра.  поэтому диспетчер трафика распределяет клиентские запросы между всеми тремя экземплярами приложения относительно равномерно. 

## <a name="pointing-hello-apps-custom-domain-at-hello-traffic-manager-domain"></a>Указывает приложение hello пользовательского домена в домен диспетчера трафика hello
последним шагом Hello необходимые является toopoint hello пользовательского домена приложения hello в домен диспетчера трафика hello.  Пример приложения hello это означает, указывающий *www.scalableasedemo.com* в *масштабируемой ase demo.trafficmanager.net*.  Этот шаг должен toobe завершилась hello регистратора, который управляет hello пользовательского домена.  

С помощью средств управления регистратора домена toobe потребностей записей CNAME какие точек hello личный домен создан на домен диспетчера трафика hello.  Hello рисунке ниже показан пример того, как выглядит эта конфигурация CNAME.

![CNAME для именного домена][CNAMEforCustomDomain] 

Несмотря на то, что в этом разделе не рассматриваются, помните, что каждому экземпляру отдельным приложениям требуются пользовательского домена toohave hello зарегистрированных в нем также.  В противном случае — запрос выполняет экземпляр приложения tooan приложения hello нет hello пользовательский домен, зарегистрированный на приложение hello, hello запрос завершится ошибкой.  

В этом примере hello доменом является *www.scalableasedemo.com*, и каждый экземпляр приложения hello пользовательский домен, связанный с ним.

![Личный домен][CustomDomain] 

Повторение по регистрации пользовательского домена приложений служб приложений Azure, в разделе hello следующей статьей [регистрации пользовательских доменов][RegisterCustomDomain].

## <a name="trying-out-hello-distributed-topology"></a>Ознакомление hello Распределенная топология
Hello конечным результатом hello конфигурации диспетчера трафика и DNS является требованием для *www.scalableasedemo.com* будет проходить через hello следующая последовательность:

1. Браузер или устройство выполняет поиск *www.scalableasedemo.com*
2. запись CNAME у регистратора имен доменов hello Hello вызывает hello DNS подстановки перенаправлен toobe tooAzure диспетчера трафика.
3. Уточняющий запрос DNS выполняется для *масштабируемой ase demo.trafficmanager.net* к одному из серверов DNS диспетчера трафика Azure hello.
4. На основе политика балансировки нагрузки hello (hello *TrafficRoutingMethod* использовалось ранее, при создании профиля диспетчера трафика hello параметра), диспетчер трафика будет выбрать одну из hello настроить конечные точки и возвращают hello, полное доменное имя Конечная точка toohello браузер или устройство.
5. Так как полное доменное имя конечной точки hello hello hello URL-адрес экземпляра приложения, выполняющегося в среде службы приложений, hello браузер или устройство запрашивает Microsoft Azure DNS-сервер tooresolve hello полное доменное имя tooan IP-адрес. 
6. Hello браузер или устройство будет отправлять hello HTTP/S запроса toohello IP-адрес.  
7. запрос Hello будут поступать в один из экземпляров приложения hello, запущенной на одном из среды службы приложения hello.

Hello консоли рисунке ниже показаны поиска DNS для пример приложения hello пользовательский домен успешно разрешение tooan приложения, работающий на одном из образца hello три среды службы приложений (в этом случае hello среды службы приложения hello три секунды):

![Поиск в DNS][DNSLookup] 

## <a name="additional-links-and-information"></a>Дополнительные ссылки и сведения
Все статьи и как-для пользователя для среды службы приложений теперь доступны в hello [файл README для среды службы приложения](../app-service/app-service-app-service-environments-readme.md).

Документацию по hello Powershell [поддержки диспетчера трафика Azure Resource Manager][ARMTrafficManager].  

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[AzureTrafficManagerProfile]: ../traffic-manager/traffic-manager-manage-profiles.md
[ARMTrafficManager]: ../traffic-manager/traffic-manager-powershell-arm.md
[RegisterCustomDomain]: app-service-web-tutorial-custom-domain.md


<!-- IMAGES -->
[ConceptualArchitecture]: ./media/app-service-app-service-environment-geo-distributed-scale/ConceptualArchitecture-1.png
[CNAMEforCustomDomain]:  ./media/app-service-app-service-environment-geo-distributed-scale/CNAMECustomDomain-1.png
[DNSLookup]:  ./media/app-service-app-service-environment-geo-distributed-scale/DNSLookup-1.png
[CustomDomain]:  ./media/app-service-app-service-environment-geo-distributed-scale/CustomDomain-1.png 
