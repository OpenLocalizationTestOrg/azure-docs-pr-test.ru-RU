---
title: "aaaDesign рекомендации для набора масштабирования виртуальной машины Azure | Документы Microsoft"
description: "Узнайте о рекомендациях по проектированию для масштабируемых наборов виртуальных машин Azure"
keywords: "Виртуальная машина Linux, наборы масштабирования виртуальных машин"
services: virtual-machine-scale-sets
documentationcenter: 
author: gatneil
manager: madhana
editor: tysonn
tags: azure-resource-manager
ms.assetid: c27c6a59-a0ab-4117-a01b-42b049464ca1
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 06/01/2017
ms.author: negat
ms.openlocfilehash: f8644d36fe5903bd4b74df26dca5dc3211ee3516
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="design-considerations-for-scale-sets"></a><span data-ttu-id="36ed4-104">Рекомендации по проектированию масштабируемых наборов</span><span class="sxs-lookup"><span data-stu-id="36ed4-104">Design Considerations For Scale Sets</span></span>
<span data-ttu-id="36ed4-105">В этом разделе рассматриваются вопросы проектирования наборов масштабирования виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="36ed4-105">This topic discusses design considerations for Virtual Machine Scale Sets.</span></span> <span data-ttu-id="36ed4-106">Сведения о том, что наборы масштабирования виртуальных машин, см. в разделе слишком[обзор наборов масштабирования виртуальных машин](virtual-machine-scale-sets-overview.md).</span><span class="sxs-lookup"><span data-stu-id="36ed4-106">For information about what Virtual Machine Scale Sets are, refer too[Virtual Machine Scale Sets Overview](virtual-machine-scale-sets-overview.md).</span></span>

## <a name="when-toouse-scale-sets-instead-of-virtual-machines"></a><span data-ttu-id="36ed4-107">Когда масштаб toouse задает вместо виртуальных машин?</span><span class="sxs-lookup"><span data-stu-id="36ed4-107">When toouse scale sets instead of virtual machines?</span></span>
<span data-ttu-id="36ed4-108">Как правило, масштабируемые наборы полезны при развертывании инфраструктуры высокой доступности с набором виртуальных машин одинаковой конфигурации.</span><span class="sxs-lookup"><span data-stu-id="36ed4-108">Generally, scale sets are useful for deploying highly available infrastructure where a set of machines have similar configuration.</span></span> <span data-ttu-id="36ed4-109">Тем не менее некоторые возможности доступны только в масштабируемых наборах, а другие — только в виртуальных машинах.</span><span class="sxs-lookup"><span data-stu-id="36ed4-109">However, some features are only available in scale sets while other features are only available in VMs.</span></span> <span data-ttu-id="36ed4-110">Чтобы toomake обоснованное решение о том, когда toouse каждой из технологий, мы должны сначала рассмотрим некоторые hello часто используемых функций, доступных в наборы масштабирования, но не виртуальных машин:</span><span class="sxs-lookup"><span data-stu-id="36ed4-110">In order toomake an informed decision about when toouse each technology, we should first take a look at some of hello commonly used features that are available in scale sets but not VMs:</span></span>

### <a name="scale-set-specific-features"></a><span data-ttu-id="36ed4-111">Возможности масштабируемого набора</span><span class="sxs-lookup"><span data-stu-id="36ed4-111">Scale set-specific features</span></span>

- <span data-ttu-id="36ed4-112">После задания конфигурации набора масштабирования hello, можно просто обновить hello «емкость» свойство toodeploy больше виртуальных машин в параллельном режиме.</span><span class="sxs-lookup"><span data-stu-id="36ed4-112">Once you specify hello scale set configuration, you can simply update hello "capacity" property toodeploy more VMs in parallel.</span></span> <span data-ttu-id="36ed4-113">Это гораздо проще, чем написание сценариев tooorchestrate, развертывание много отдельных виртуальных машин в параллельном режиме.</span><span class="sxs-lookup"><span data-stu-id="36ed4-113">This is much simpler than writing a script tooorchestrate deploying many individual VMs in parallel.</span></span>
- <span data-ttu-id="36ed4-114">Вы можете [tooautomatically автомасштабирования Azure используйте масштабирование набор масштабирования](./virtual-machine-scale-sets-autoscale-overview.md) , но не для отдельных виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="36ed4-114">You can [use Azure Autoscale tooautomatically scale a scale set](./virtual-machine-scale-sets-autoscale-overview.md) but not individual VMs.</span></span>
- <span data-ttu-id="36ed4-115">Вы можете [пересоздать образ виртуальных машин масштабируемого набора](https://docs.microsoft.com/rest/api/virtualmachinescalesets/manage-a-vm), но [не отдельных виртуальных машин](https://docs.microsoft.com/rest/api/compute/virtualmachines).</span><span class="sxs-lookup"><span data-stu-id="36ed4-115">You can [reimage scale set VMs](https://docs.microsoft.com/rest/api/virtualmachinescalesets/manage-a-vm) but [not individual VMs](https://docs.microsoft.com/rest/api/compute/virtualmachines).</span></span>
- <span data-ttu-id="36ed4-116">Виртуальные машины масштабируемого набора можно [избыточно подготовить](./virtual-machine-scale-sets-design-overview.md), чтобы улучшить надежность и сократить время развертывания.</span><span class="sxs-lookup"><span data-stu-id="36ed4-116">You can [overprovision](./virtual-machine-scale-sets-design-overview.md) scale set VMs for increased reliability and quicker deployment times.</span></span> <span data-ttu-id="36ed4-117">Это невозможно с отдельными виртуальными машинами, если написать пользовательский код toodo это.</span><span class="sxs-lookup"><span data-stu-id="36ed4-117">You cannot do this with individual VMs unless you write custom code toodo this.</span></span>
- <span data-ttu-id="36ed4-118">Можно указать [обновление политики](./virtual-machine-scale-sets-upgrade-scale-set.md) toomake его легко tooroll ожидания обновления в виртуальных машинах в наборе масштабирования.</span><span class="sxs-lookup"><span data-stu-id="36ed4-118">You can specify an [upgrade policy](./virtual-machine-scale-sets-upgrade-scale-set.md) toomake it easy tooroll out upgrades across VMs in your scale set.</span></span> <span data-ttu-id="36ed4-119">Обновления для отдельных виртуальных машин необходимо оркестрировать самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="36ed4-119">With individual VMs, you must orchestrate updates yourself.</span></span>

### <a name="vm-specific-features"></a><span data-ttu-id="36ed4-120">Возможности отдельных виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="36ed4-120">VM-specific features</span></span>

<span data-ttu-id="36ed4-121">На Здравствуйте другой стороны, некоторые возможности доступны только в виртуальных машинах (по крайней мере за то, что время hello):</span><span class="sxs-lookup"><span data-stu-id="36ed4-121">On hello other hand, some features are only available in VMs (at least for hello time being):</span></span>

- <span data-ttu-id="36ed4-122">Можно присоединить toospecific диски данных отдельных виртуальных машин, но подключенные диски данных настроены для всех виртуальных машин в наборе масштабирования.</span><span class="sxs-lookup"><span data-stu-id="36ed4-122">You can attach data disks toospecific individual VMs, but attached data disks are configured for all VMs in a scale set.</span></span>
- <span data-ttu-id="36ed4-123">Можно присоединить tooindividual диски данных непустой виртуальные машины, но не для виртуальных машин в наборе масштабирования.</span><span class="sxs-lookup"><span data-stu-id="36ed4-123">You can attach non-empty data disks tooindividual VMs but not VMs in a scale set.</span></span>
- <span data-ttu-id="36ed4-124">Можно сделать моментальный снимок отдельной виртуальной машины, но не машины в масштабируемом наборе.</span><span class="sxs-lookup"><span data-stu-id="36ed4-124">You can snapshot an individual VM but not a VM in a scale set.</span></span>
- <span data-ttu-id="36ed4-125">Можно записать образ отдельной виртуальной машины, но не машины в масштабируемом наборе.</span><span class="sxs-lookup"><span data-stu-id="36ed4-125">You can capture an image from an individual VM but not from a VM in a scale set.</span></span>
- <span data-ttu-id="36ed4-126">Можно выполнить миграцию отдельных виртуальных Машин из дисков toomanaged дисках с размером сектора, но не поддерживается для виртуальных машин в наборе масштабирования.</span><span class="sxs-lookup"><span data-stu-id="36ed4-126">You can migrate an individual VM from native disks toomanaged disks, but you cannot do this for VMs in a scale set.</span></span>
- <span data-ttu-id="36ed4-127">Можно назначить общих IP-адресов IPv6 tooindividual сетевых адаптеров виртуальной Машины, но невозможно сделать для виртуальных машин в наборе масштабирования.</span><span class="sxs-lookup"><span data-stu-id="36ed4-127">You can assign IPv6 public IP addresses tooindividual VM nics but cannot do so for VMs in a scale set.</span></span> <span data-ttu-id="36ed4-128">Обратите внимание, что можно назначить общих IP-адресов IPv6 tooload балансировки нагрузки перед либо отдельных виртуальных машин или набора масштабирования виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="36ed4-128">Note that you can assign IPv6 public IP addresses tooload balancers in front of either individual VMs or scale set VMs.</span></span>

## <a name="storage"></a><span data-ttu-id="36ed4-129">Хранилище</span><span class="sxs-lookup"><span data-stu-id="36ed4-129">Storage</span></span>

### <a name="scale-sets-with-azure-managed-disks"></a><span data-ttu-id="36ed4-130">Масштабируемые наборы с компонентом "Управляемые диски" Azure</span><span class="sxs-lookup"><span data-stu-id="36ed4-130">Scale sets with Azure Managed Disks</span></span>
<span data-ttu-id="36ed4-131">Вместо обычных учетных записей хранения Azure для создания масштабируемых наборов можно использовать [компонент "Управляемые диски" Azure](../virtual-machines/windows/managed-disks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="36ed4-131">Scale sets can be created with [Azure Managed Disks](../virtual-machines/windows/managed-disks-overview.md) instead of traditional Azure storage accounts.</span></span> <span data-ttu-id="36ed4-132">Управляемый диски предоставляют hello следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="36ed4-132">Managed Disks provide hello following benefits:</span></span>
- <span data-ttu-id="36ed4-133">У вас toopre-создания нескольких учетных записей хранилища Azure для hello в наборе виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="36ed4-133">You do not have toopre-create a set of Azure storage accounts for hello scale set VMs.</span></span>
- <span data-ttu-id="36ed4-134">Можно определить [присоединенных дисков с данными](virtual-machine-scale-sets-attached-disks.md) hello виртуальных машин в шкалу набор.</span><span class="sxs-lookup"><span data-stu-id="36ed4-134">You can define [attached data disks](virtual-machine-scale-sets-attached-disks.md) for hello VMs in your scale set.</span></span>
- <span data-ttu-id="36ed4-135">Наборы масштабирования можно настроить слишком[поддерживает систему too1 000 виртуальных машин в наборе](virtual-machine-scale-sets-placement-groups.md).</span><span class="sxs-lookup"><span data-stu-id="36ed4-135">Scale sets can be configured too[support up too1,000 VMs in a set](virtual-machine-scale-sets-placement-groups.md).</span></span> 

<span data-ttu-id="36ed4-136">При наличии существующего шаблона, можно также [обновление toouse шаблона hello управляемый дисков](virtual-machine-scale-sets-convert-template-to-md.md).</span><span class="sxs-lookup"><span data-stu-id="36ed4-136">If you have an existing template, you can also [update hello template toouse Managed Disks](virtual-machine-scale-sets-convert-template-to-md.md).</span></span>

### <a name="user-managed-storage"></a><span data-ttu-id="36ed4-137">Управляемое пользователем хранилище</span><span class="sxs-lookup"><span data-stu-id="36ed4-137">User-managed Storage</span></span>
<span data-ttu-id="36ed4-138">Набор масштабирования, который не определен с управлять дисками Azure использует пользовательские учетные записи toostore hello ОС дисков hello виртуальных машин в наборе hello.</span><span class="sxs-lookup"><span data-stu-id="36ed4-138">A scale set that is not defined with Azure Managed Disks relies on user-created storage accounts toostore hello OS disks of hello VMs in hello set.</span></span> <span data-ttu-id="36ed4-139">Коэффициент 20 виртуальных машин на учетную запись хранения или менее рекомендуется tooachieve максимальное операции ввода-ВЫВОДА, а также воспользоваться преимуществами _избыток_ (см. ниже).</span><span class="sxs-lookup"><span data-stu-id="36ed4-139">A ratio of 20 VMs per storage account or less is recommended tooachieve maximum IO and also take advantage of _overprovisioning_ (see below).</span></span> <span data-ttu-id="36ed4-140">Также рекомендуется, символы начала hello имен учетных записей хранилища hello распределяться hello алфавита.</span><span class="sxs-lookup"><span data-stu-id="36ed4-140">It is also recommended that you spread hello beginning characters of hello storage account names across hello alphabet.</span></span> <span data-ttu-id="36ed4-141">Это поможет распределить нагрузку между разными внутренними системами.</span><span class="sxs-lookup"><span data-stu-id="36ed4-141">Doing so helps spread load across different internal systems.</span></span> 


## <a name="overprovisioning"></a><span data-ttu-id="36ed4-142">Избыточная подготовка</span><span class="sxs-lookup"><span data-stu-id="36ed4-142">Overprovisioning</span></span>
<span data-ttu-id="36ed4-143">Масштаб группы по умолчанию слишком «избыток» ВМ в данный момент.</span><span class="sxs-lookup"><span data-stu-id="36ed4-143">Scale sets currently default too"overprovisioning" VMs.</span></span> <span data-ttu-id="36ed4-144">С избыток включен, масштаб hello задайте фактически включается несколько виртуальных машин, чем вы искали, а затем удаляет приветствия успешной инициализации дополнительных виртуальных машин после hello запрошенного числа виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="36ed4-144">With overprovisioning turned on, hello scale set actually spins up more VMs than you asked for, then deletes hello extra VMs once hello requested number of VMs are successfully provisioned.</span></span> <span data-ttu-id="36ed4-145">Избыточная подготовка повышает процент успешной подготовки к работе и сокращает процесс развертывания.</span><span class="sxs-lookup"><span data-stu-id="36ed4-145">Overprovisioning improves provisioning success rates and reduces deployment time.</span></span> <span data-ttu-id="36ed4-146">Для hello дополнительные виртуальные машины и они не учитываются вашей квоты не выставляются.</span><span class="sxs-lookup"><span data-stu-id="36ed4-146">You are not billed for hello extra VMs, and they do not count toward your quota limits.</span></span>

<span data-ttu-id="36ed4-147">Хотя избыточного повысить подготовки показатели успеха, он может привести к нежелательным последствиям для приложения, — не специально toohandle дополнительных виртуальных машин, появляющихся, то затем исчезает.</span><span class="sxs-lookup"><span data-stu-id="36ed4-147">While overprovisioning does improve provisioning success rates, it can cause confusing behavior for an application that is not designed toohandle extra VMs appearing and then disappearing.</span></span> <span data-ttu-id="36ed4-148">tooturn избыток off, обязательно hello строкой в шаблоне: `"overprovision": "false"`.</span><span class="sxs-lookup"><span data-stu-id="36ed4-148">tooturn overprovisioning off, ensure you have hello following string in your template: `"overprovision": "false"`.</span></span> <span data-ttu-id="36ed4-149">Дополнительные сведения можно найти в hello [документации по API REST заданного масштаба](/rest/api/virtualmachinescalesets/create-or-update-a-set).</span><span class="sxs-lookup"><span data-stu-id="36ed4-149">More details can be found in hello [Scale Set REST API documentation](/rest/api/virtualmachinescalesets/create-or-update-a-set).</span></span>

<span data-ttu-id="36ed4-150">Если ваш набор масштабирования используются управляемые пользователем хранилища, и отключить избыток, может иметь более 20 виртуальных машин на учетную запись хранения, но не рекомендуется toogo выше 40 для повышения производительности операций ввода-ВЫВОДА.</span><span class="sxs-lookup"><span data-stu-id="36ed4-150">If your scale set uses user-managed storage, and you turn off overprovisioning, you can have more than 20 VMs per storage account, but it is not recommended toogo above 40 for IO performance reasons.</span></span> 

## <a name="limits"></a><span data-ttu-id="36ed4-151">Ограничения</span><span class="sxs-lookup"><span data-stu-id="36ed4-151">Limits</span></span>
<span data-ttu-id="36ed4-152">Набор масштабирования основаны на образа Marketplace (также известный как образ платформы) и настроить toouse управляемых дисков Azure поддерживает емкость вверх too1 000 виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="36ed4-152">A scale set built on a Marketplace image (also known as a platform image) and configured toouse Azure Managed Disks supports a capacity of up too1,000 VMs.</span></span> <span data-ttu-id="36ed4-153">При настройке вашего toosupport набор масштабирования виртуальных машин более 100 не вся работа сценариев hello же (для примера с балансировкой нагрузки).</span><span class="sxs-lookup"><span data-stu-id="36ed4-153">If you configure your scale set toosupport more than 100 VMs, not all scenarios work hello same (for example load balancing).</span></span> <span data-ttu-id="36ed4-154">Дополнительные сведения см. в статье [Работа с крупными масштабируемыми наборами виртуальных машин](virtual-machine-scale-sets-placement-groups.md).</span><span class="sxs-lookup"><span data-stu-id="36ed4-154">For more information, see [Working with large virtual machine scale sets](virtual-machine-scale-sets-placement-groups.md).</span></span> 

<span data-ttu-id="36ed4-155">Настроены учетные записи хранения, управляемые пользователем наборе масштабирования виртуальных машин в настоящее время составляет too100 (и не рекомендуется использовать для этой шкалы 5 учетных записей хранилища).</span><span class="sxs-lookup"><span data-stu-id="36ed4-155">A scale set configured with user-managed storage accounts is currently limited too100 VMs (and 5 storage accounts are recommended for this scale).</span></span>

<span data-ttu-id="36ed4-156">Набор масштабирования, построенные на настраиваемого образа (созданной вами) может иметь емкость виртуальных машин too100 при использовании управляемых Azure диски.</span><span class="sxs-lookup"><span data-stu-id="36ed4-156">A scale set built on a custom image (one built by you) can have a capacity of up too100 VMs when configured with Azure Managed disks.</span></span> <span data-ttu-id="36ed4-157">Если набор масштабирования hello настроен с учетными записями хранения, управляемые пользователем, его необходимо создать всех виртуальных жестких дисков операционной системы, в пределах одной учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="36ed4-157">If hello scale set is configured with user-managed storage accounts, it must create all OS disk VHDs within one storage account.</span></span> <span data-ttu-id="36ed4-158">В результате hello максимальный рекомендуемый число виртуальных машин в наборе масштабирования, построенные на пользовательского образа и управляемые пользователем хранилища — 20.</span><span class="sxs-lookup"><span data-stu-id="36ed4-158">As a result, hello maximum recommended number of VMs in a scale set built on a custom image and user-managed storage is 20.</span></span> <span data-ttu-id="36ed4-159">Если вы отключаете избыток, можно перейти too40.</span><span class="sxs-lookup"><span data-stu-id="36ed4-159">If you turn off overprovisioning, you can go up too40.</span></span>

<span data-ttu-id="36ed4-160">Для нескольких виртуальных машин, чем разрешить эти ограничения, необходимо toodeploy несколько шкалы задает, как показано в [этот шаблон](https://github.com/Azure/azure-quickstart-templates/tree/master/301-custom-images-at-scale).</span><span class="sxs-lookup"><span data-stu-id="36ed4-160">For more VMs than these limits allow, you need toodeploy multiple scale sets as shown in [this template](https://github.com/Azure/azure-quickstart-templates/tree/master/301-custom-images-at-scale).</span></span>

