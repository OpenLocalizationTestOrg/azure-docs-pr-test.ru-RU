---
title: "Автомасштабирование aaaTroubleshoot с наборы масштабирования виртуальных машин | Документы Microsoft"
description: "Устранение неполадок при автомасштабировании масштабируемых наборов виртуальных машин. Типичные проблемы, возникшие понять и каким образом tooresolve их."
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: c7d87b72-ee24-4e52-9377-a42f337f76fa
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: windows
ms.devlang: na
ms.topic: article
ms.date: 10/28/2016
ms.author: guybo
ms.openlocfilehash: 4c9a70992348d87fb43646421a90a027bf400a17
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-autoscale-with-virtual-machine-scale-sets"></a>Устранение неполадок при автомасштабировании масштабируемых наборов виртуальных машин
**Проблема** — вы создали инфраструктуру автоматическое масштабирование в диспетчере ресурсов Azure с помощью набора масштабирования виртуальных Машин — например, при развертывании шаблона следующим образом: https://github.com/Azure/azure-quickstart-templates/tree/master/201- vmss-bottle автомасштабирования — у вас есть определенные правила масштабирования и работает отлично, за исключением того, независимо от того, какая нагрузка поместить hello виртуальные машины, но не автомасштабирования.

## <a name="troubleshooting-steps"></a>Действия по устранению неполадок
Некоторые действия tooconsider включают:

* Сколько ядер у каждой виртуальной Машины и загружаются каждое ядро? выше шаблон быстрый запуск Azure пример Hello имеет do_work.php сценарий, который загружает одного ядра. Если вы используете виртуальную Машину, больше, чем одном ядре размер виртуальной Машины как Standard_A1 или D1, то потребуется toorun этой загрузки несколько раз. Узнать количество ядер в виртуальных машинах вам поможет статья [Размеры виртуальных машин в Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
* Сколько виртуальных машин в hello набора масштабирования виртуальных Машин, делает работу с каждого из них?
  
    Событие для горизонтального масштабирования только происходить, когда hello среднее число ЦП по **все** hello виртуальные машины в наборе масштабирования превышает hello пороговое значение, со временем hello внутренней определить в правилах автоматического масштабирования hello.
* Возможно, вы пропустили события масштабирования?
  
    Убедитесь, что журналы аудита hello в hello портала Azure для масштабирования события. Возможно, вы пропустили произошедшее увеличение или уменьшение масштаба. Можно отфильтровать элементы, введя в соответствующее поле запрос "Масштаб".
  
    ![Журналы аудита][audit]
* Отличаются ли пороговые значения для увеличения и уменьшения масштаба?
  
    Предположим, что установить tooscale правило, если средняя загрузка ЦП больше 50% за 5 минут и tooscale в при средняя загрузка ЦП составляет менее 50%. Это приведет к «flapping» проблему при ЦП закрыть toothis порог, hello постоянно увеличение и уменьшение масштаба действия размер набора hello. По этой причине hello автомасштабирования служба пытается tooprevent «неустойчивый», которой могут проявляться в виде не масштабируется. Поэтому убедитесь, что горизонтального масштабирования и масштабирования в пороговые значения, существенно различающихся tooallow место между масштабирования.
* Вы сами написали шаблон JSON?
  
    Это легко toomake ошибок, таким образом запуска с использованием шаблона, например друг над которой подтверждается toowork hello и внести небольшие добавочные изменения. 
* Можете ли вы выполнить увеличение или уменьшение масштаба вручную?
  
    Попробуйте вручную повторного развертывания hello ресурсов набора масштабирования виртуальных Машин с разных «объем» параметр toochange hello количеством виртуальных машин. Пример шаблона toodo, это здесь: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing — необходимо убедиться, что он имеет hello toomake шаблона hello tooedit же размер машины, как с помощью набора масштабирования. Если успешно hello число виртуальных машин можно изменить вручную, затем известно, что проблема hello является изолированной tooautoscale.
* Проверьте вашей Microsoft.Compute/virtualMachineScaleSet и ресурсов с помощью Microsoft.Insights в hello [обозревателя ресурсов Azure](https://resources.azure.com/)
  
    Это незаменимый Устранение неполадок средства, в котором отображается состояние ресурсов Azure Resource Manager "hello". Щелкните подписку и посмотрите на hello устраняются группы ресурсов. При использовании поставщика ресурсов вычислений hello рассмотрим hello набора масштабирования виртуальных Машин вы создали и проверьте hello представление экземпляра, в котором отображается hello состояние развертывания. Также следует проверьте представление экземпляра hello виртуальных машин в hello набора масштабирования виртуальных Машин. Затем перейдите к поставщику ресурсов помощью Microsoft.Insights hello и убедитесь, что хорошо выглядят правил автомасштабирования hello.
* Работа hello диагностического расширения и отправке данных о производительности?
  
    **Обновление:** Azure автоматически не улучшенные toouse узел на основе метрик конвейера, который больше не требует установки toobe расширения диагностики. Это означает, что hello Далее несколько абзацев больше не применяются при создании автоматического масштабирования приложения, использующего новый конвейер hello. Является примером шаблоны Azure, которым были преобразованный toouse hello узла конвейера: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale. 
  
    С помощью показателей на основе узла для автоматического масштабирования является наиболее подходящим для hello следующих причин:
  
  * Меньшее число частей как расширения диагностики не должны toobe установлен.
  * Простые шаблоны. Просто добавьте существующие шкалы правила автомасштабирования tooan аналитики набора шаблонов.
  * Более надежная система отчетов и ускоренный запуск новых виртуальных машин.
    
    Hello только причин можно с помощью диагностического расширения tookeep бы случай памяти диагностики отчеты или масштабирование. Метрики на основе узла не позволяют формировать отчеты о памяти.
    
    С учетом только выполните hello оставшейся части этой статьи, если по-прежнему используется диагностического расширения для вашего автоматического масштабирования.
    
    Автомасштабирование диспетчера ресурсов Azure можно работать (но больше не нужно) с помощью расширения ВМ, вызывается hello расширения диагностики. Он создает учетную запись хранилища производительности данных tooa, задаются в шаблоне hello. Эти данные объединяются службой мониторинга Azure hello.
    
    Если hello службе аналитики не могут считывать данные из hello виртуальных машин, он должен toosend вам сообщение электронной почты — например если виртуальные машины hello, поэтому проверьте свою электронную почту (hello был указан при создании hello учетная запись Azure).
    
    Можно также перейти, просматривать данные hello самостоятельно. Рассмотрим hello учетной записи хранилища Azure с помощью обозревателя облака. Например, с помощью hello [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), войдите и выберите hello подписки Azure, вы используете и hello имя на которые ссылается hello определения расширения диагностики в вашем развертывании учетная запись хранения диагностики шаблон...
    
    ![Cloud Explorer][explorer]
    
    Здесь вы увидите множество таблиц хранения hello данные из каждой виртуальной Машины. Принимая Linux и hello метрики ЦП в качестве примера, взгляните на самой последней строки hello. обозревателе облако Hello Visual Studio поддерживает язык запросов, поэтому можно выполнить запрос наподобие «Timestamp gt datetime'2016-02-02T21:20:00Z "» toomake убедиться, что получить самые последние события hello (предполагается время представлено в формате UTC). Hello данные, отображаемые в существует соответствуют toohello масштабировать правила, которые вы настроили? В следующем примере hello hello ЦП для машины 20 работы too100% увеличение объема hello последние 5 минут...
    
    ![Таблицы хранилища][tables]
    
    Если hello данных отсутствует, затем он означает, что hello связана с диагностического расширения hello в hello виртуальных машин. Если данные hello существует, это означает, что либо проблема на правила масштабирования или со службой аналитики hello. Проверьте [состояние Azure](https://azure.microsoft.com/status/).
    
    После стали шаги выполнения этого действия, если вы по-прежнему возникают проблемы автоматического масштабирования можно попробовать форумах hello [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), или [переполнение стека](http://stackoverflow.com/questions/tagged/azure), или журнала поддержки по телефону. Быть шаблон подготовленного tooshare hello и представление данных о производительности hello.

[audit]: ./media/virtual-machine-scale-sets-troubleshoot/image3.png
[explorer]: ./media/virtual-machine-scale-sets-troubleshoot/image1.png
[tables]: ./media/virtual-machine-scale-sets-troubleshoot/image4.png
