---
title: "Отработка отказа и аварийное восстановление для устройств StorSimple серии 8000 | Документация Майкрософт"
description: "Информация о том, как выполнить отработку отказа устройства StorSimple на то же устройство либо другое физическое или облачное устройство."
services: storsimple
documentationcenter: 
author: alkohli
manager: timlt
editor: 
ms.assetid: 
ms.service: storsimple
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/03/2017
ms.author: alkohli
ms.openlocfilehash: 5dc4a98bf889d38c62c76364289c2d58c14d771e
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="failover-and-disaster-recovery-for-your-storsimple-8000-series-device"></a>Отработка отказа и аварийное восстановление для устройств StorSimple серии 8000

## <a name="overview"></a>Обзор

В этой статье описывается функция отработки отказа для устройства StorSimple серии 8000, а также каким образом эту функцию можно использовать для восстановления устройств StorSimple в случае аварии. StorSimple использует функцию отработки отказа устройства для переноса данных с исходного устройства в центре обработки данных на другое целевое устройство. Рекомендации в этой статье относятся к физическим устройствам и облачным устройствам StorSimple серии 8000 под управлением версий программного обеспечения с обновлением 3 и более поздних.

Чтобы запустить функцию отработки отказа устройства в случае аварии, в StorSimple используется колонка **Устройства**. В этой колонке представлены все устройства StorSimple, подключенные к службе диспетчера устройств StorSimple.

![Колонка "Устройства"](./media/storsimple-8000-device-failover-disaster-recovery/failover-phy-dev1.png)


## <a name="disaster-recovery-dr-and-device-failover"></a>Отработка отказа и аварийное восстановление

В сценарии аварийного восстановления основное устройство прекращает функционировать. StorSimple использует основное устройство в качестве _источника_ и перемещает связанные облачные данные на _целевое_ устройство. Этот процесс называется *отработка отказа*. Он проиллюстрирован на схеме ниже.

![Что происходит при отработке отказа устройства?](./media/storsimple-8000-device-failover-disaster-recovery/failover-dr-flow.png)

Целевое устройство для отработки отказа может быть как физическим, так и облачным. Целевое устройство может находиться в том же географическом регионе, что и исходное устройство, или отличном.

Во время отработки отказа можно выбрать контейнеры томов для переноса. Затем StorSimple изменит владельца этих контейнеров томов с исходного устройства на целевое. Когда у контейнеров томов меняется владелец, StorSimple удаляет их с исходного устройства. По завершении удаления можно выполнить восстановление размещения целевого устройства. _Восстановление размещения_ передает владение обратно исходному устройству.

### <a name="cloud-snapshot-used-during-device-failover"></a>Моментальный снимок облака во время отработки отказа устройства

После аварийного восстановления для восстановления данных на целевом устройстве используется последняя облачная резервная копия. Дополнительные сведения о моментальных снимках облака см. в разделе [Резервное копирование вручную](storsimple-8000-manage-backup-policies-u2.md#take-a-manual-backup).

В StorSimple серии 8000 политики резервного копирования связаны с резервными копиями. При наличии нескольких политик резервного копирования для одного тома StorSimple выбирает политику с большим количеством томов. Для восстановления данных на целевом устройстве StorSimple использует самую последнюю резервную копию из выбранной политики резервного копирования.

Предположим, что существует две политики резервного копирования *defaultPol* и *customPol*.

* *defaultPol*: один том (*vol1*), выполняется ежедневно, начиная с 22:30.
* *customPol*: четыре тома (*vol1*, *vol2*, *vol3* и *vol4*), выполняется ежедневно, начиная с 22:00.

В этом случае будет использоваться политика *customPol*, так как у нее больше томов, и, соответственно, выше отказоустойчивость. Для восстановления данных используется последняя резервная копия из этой политики. Дополнительные сведения о способах создания политик резервного копирования и управления ими см. в статье [Use the StorSimple Device Manager service in Azure portal to manage backup policies](storsimple-8000-manage-backup-policies-u2.md) (Использование службы диспетчера устройств StorSimple для управления политиками резервного копирования).

## <a name="common-considerations-for-device-failover"></a>Общие рекомендации по отработке отказа устройства

Перед отработкой отказа устройства ознакомьтесь со следующей информацией.

* Перед началом отработки отказа устройства все тома в контейнере томов должны быть отключены. В случае незапланированной отработки отказа тома StotSimple автоматически перейдут в автономный режим. Однако при выполнении плановой отработки отказа (для тестирования аварийного восстановления) необходимо переключить все тома в автономный режим.
* Для аварийного восстановления указаны только те контейнеры томов, которые имеют связанный с ними моментальный снимок облака. Для восстановления данных должен существовать по крайней мере один контейнер томов со связанным моментальным снимком облака.
* При наличии облачных моментальных снимков, охватывающих несколько контейнеров томов, StorSimple выполняет отработку отказа этих контейнеров томов как набора. В редких случаях если существуют локальные моментальные снимки, которые охватывают несколько контейнеров томов, для которых отсутствуют связанные облачные моментальные снимки, StorSimple выполняет отработку отказа локальных моментальных снимков, при этом локальные данные будут потеряны.
* в качестве целевых устройств для аварийного восстановления можно использовать устройства, на которых достаточно пространства для размещения выбранных контейнеров томов; Все устройства, которые не имеют достаточно места, не указываются в качестве целевых устройств.
* После аварийного восстановления в течение ограниченного времени скорость доступа к данным может быть существенно снижена, так как устройству потребуется получить доступ к данным в облаке и сохранить их локально.

#### <a name="device-failover-across-software-versions"></a>Отработка отказа устройством в разных версиях программного обеспечения

Служба диспетчера устройств StorSimple в развертывании может обслуживать несколько устройств, физических и облачных, на которых могут выполняться разные версии программного обеспечения.

Используйте следующую таблицу, чтобы определить, можно ли отработать отказ или восстановить размещение с переключением на другое устройство, которое отличается версией ПО и поведением типов томов, во время аварийного восстановления.

#### <a name="failover-and-failback-across-software-versions"></a>Отработка отказа и восстановление размещения в разных версиях программного обеспечения

| Отработка отказа или восстановление размещения | Физическое устройство | Облачное устройство |
| --- | --- | --- |
| Обновление 3 на обновление 4 |Многоуровневые тома после отработки отказа остаются многоуровневыми. <br></br>Локально закрепленные тома после отработки отказа остаются локально закрепленными. <br></br> После отработки отказа при создании моментального снимка на устройстве с обновлением 4 будет запущено [отслеживание на основе тепловой карты](storsimple-update4-release-notes.md#whats-new-in-update-4). |Локально закрепленные тома после отработки отказа становятся многоуровневыми. |
| Обновление 4 на обновление 3 |Многоуровневые тома после отработки отказа остаются многоуровневыми. <br></br>Локально закрепленные тома после отработки отказа остаются локально закрепленными. <br></br> Резервные копии, используемые для восстановления метаданных тепловой карты. <br></br>Отслеживания на основе тепловой карты недоступно в обновлении 3 после восстановления размещения. |Локально закрепленные тома после отработки отказа становятся многоуровневыми. |


## <a name="device-failover-scenarios"></a>Сценарии отработки отказа устройства

В случае аварии можно выбрать отработку отказа устройства StorSimple:

* [на физическое устройство;](storsimple-8000-device-failover-physical-device.md)
* [на само устройство;](storsimple-8000-device-failover-same-device.md)
* [на облачное устройство.](storsimple-8000-device-failover-cloud-appliance.md)

Указанные выше статьи содержат подробное описание действий для каждого из вышеперечисленных случаев отработки отказа.


## <a name="failback"></a>Восстановление размещения

Для ПО с обновлением 3 и более поздних версий StorSimple также поддерживает восстановление размещения. Процесс восстановления размещения является противоположным процессу отработки отказа, во время которого целевой объект становится источником, а исходное устройство во время отработки отказа становится целевым устройством. 

При восстановлении размещения StorSimple повторно синхронизирует данные обратно в основное расположение, останавливает операции ввода-вывода и действия приложений и переходит обратно в исходное расположение.

После завершения отработки отказа StorSimple выполняет следующие действия:

* StorSimple удаляет контейнеры томов, для которых выполнена отработка отказа, с исходного устройства.
* StorSimple запускает фоновое задание для контейнера томов (для которого выполнена отработка отказа) на исходном устройстве. При попытке восстановить размещение во время выполнения задания отобразится оповещение об этом. Дождитесь завершения задачи, чтобы начать восстановление размещения.
* Длительность удаления контейнеров томов зависит от различных факторов, таких как объем данных, возраст данных, количество резервных копий и доступная пропускная способность сети для операции.

Если вы планируете выполнить тестовую отработку отказа или тестовое восстановление размещения, то рекомендуем использовать для тестирования контейнеры томов с меньшим объемом данных (ГБ). Обычно восстановление размещения можно начать через 24 часа после отработки отказа.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

В. **Что происходит в случае сбоя аварийного восстановления или его частичного выполнения?**

О. В случае сбоя аварийного восстановления рекомендуется повторить попытку восстановления. При последующем запуске аварийного восстановления известно о прогрессе первого задания, поэтому процесс будет возобновлен с момента остановки.

В. **Можно ли удалить устройство во время отработки отказа устройства?**

а. Во время выполнения аварийного восстановления невозможно удалить устройство. Устройство можно удалить только после завершения аварийного восстановления. Ход выполнения задания отработки отказа устройства можно отслеживать в колонке **Задания**.

В. **Когда на исходном устройстве начинается сборка мусора, чтобы удалить с него локальные данные?**

О. Сборка мусора на исходном устройстве запускается только после его полной очистки. Очистка исходного устройства включает в себя удаление объектов, для которых была выполнена отработка отказа, таких как тома, объекты резервного копирования (не данные), контейнеры томов и политики.

В. **Что произойдет в случае сбоя задания удаления, связанного с контейнерами томов на исходном устройстве?**

О.  В случае сбоя удаления контейнеры томов можно удалить вручную. В колонке **Устройства** выберите исходное устройство и щелкните **Контейнеры томов**. Выберите контейнеры томов, для которых была выполнена отработка отказа, и внизу колонки нажмите кнопку **Удалить**. После удаления с исходного устройства всех контейнеров томов, для которых выполнена отработка отказа, можно начать восстановление размещения. Дополнительные сведения см. в разделе [Удаление контейнера томов](storsimple-8000-manage-volume-containers.md#delete-a-volume-container).

## <a name="business-continuity-disaster-recovery-bcdr"></a>Аварийное восстановление непрерывности бизнеса (BCDR)

Сценарий аварийного восстановления непрерывности бизнеса (BCDR) реализуется, когда весь центр обработки данных Azure прекращает работу. Это может повлиять на службу диспетчера устройств StorSimple и связанные устройства StorSimple.

Если есть устройства StorSimple, зарегистрированные непосредственно перед сбоем, этим устройствам может потребоваться восстановление заводских настроек. После аварии устройство StorSimple отображается на портале Azure как автономное. Такое устройство следует удалить с портала. Сбросьте настройки устройства до заводских и зарегистрируйте его в службе повторно.

## <a name="next-steps"></a>Дальнейшие действия

Если вы готовы выполнить отработку отказа устройства, выберите один из следующих сценариев, чтобы получить подробные инструкции.

- [Отработка отказа на физическое устройство](storsimple-8000-device-failover-physical-device.md)
- [Отработка отказа на то же устройство](storsimple-8000-device-failover-same-device.md)
- [Отработка отказа на облачное устройство StorSimple](storsimple-8000-device-failover-cloud-appliance.md)

Если вы выполнили отработку отказа устройства, выберите один из следующих вариантов:

* [Отключение и удаление устройства StorSimple](storsimple-8000-deactivate-and-delete-device.md)
* [Использование службы диспетчера устройств StorSimple для администрирования устройства StorSimple](storsimple-8000-manager-service-administration.md)

