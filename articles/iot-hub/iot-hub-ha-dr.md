---
title: "Центр IoT высокой доступности и аварийного восстановления aaaAzure | Документы Microsoft"
description: "Описание возможностей Azure и центр IoT hello, помогающие решения высокого уровня доступности Azure IoT toobuild с возможности аварийного восстановления."
services: iot-hub
documentationcenter: 
author: fsautomata
manager: timlt
editor: 
ms.assetid: ae320e58-aa20-45b9-abdc-fa4faae8e6dd
ms.service: iot-hub
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/16/2016
ms.author: elioda
ms.openlocfilehash: 74e1fa1682258819ffb3fd84eb79e42fc6e4120f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="iot-hub-high-availability-and-disaster-recovery"></a><span data-ttu-id="4d5e0-103">Высокая доступность и аварийное восстановление центра IoT</span><span class="sxs-lookup"><span data-stu-id="4d5e0-103">IoT Hub high availability and disaster recovery</span></span>
<span data-ttu-id="4d5e0-104">Как службу Azure центра IoT обеспечивает высокий уровень доступности (HA) с использованием избыточных данных на уровне hello регион Azure, не требуется никаких дополнительных действий, предусмотренного hello решения.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-104">As an Azure service, IoT Hub provides high availability (HA) using redundancies at hello Azure region level, without any additional work required by hello solution.</span></span> <span data-ttu-id="4d5e0-105">Hello платформы Microsoft Azure также включает функции toohelp построения решений с помощью возможности аварийного восстановления (DR) или доступности в различных регионах.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-105">hello Microsoft Azure platform also includes features toohelp you build solutions with disaster recovery (DR) capabilities or cross-region availability.</span></span> <span data-ttu-id="4d5e0-106">Следует tooprovide глобальной межрегиональное высокий уровень доступности для устройства или пользователей, проектирования и подготовьте решениях tootake преимуществами этих возможностей аварийного восстановления Azure.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-106">If you want tooprovide global, cross-region high availability for devices or users, design and prepare your solutions tootake advantage of these Azure DR features.</span></span> <span data-ttu-id="4d5e0-107">статья Hello [техническое руководство по непрерывности бизнеса Azure](../resiliency/resiliency-technical-guidance.md) Описывает встроенные функции hello в Azure для непрерывности и аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-107">hello article [Azure Business Continuity Technical Guidance](../resiliency/resiliency-technical-guidance.md) describes hello built-in features in Azure for business continuity and DR.</span></span> <span data-ttu-id="4d5e0-108">Hello [аварийное восстановление и высокий уровень доступности для приложений Azure] [ Disaster recovery and high availability for Azure applications] документ содержит руководство по архитектуре на стратегий для приложения Azure tooachieve высокого уровня ДОСТУПНОСТИ и аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-108">hello [Disaster recovery and high availability for Azure applications][Disaster recovery and high availability for Azure applications] paper provides architecture guidance on strategies for Azure applications tooachieve HA and DR.</span></span>

## <a name="azure-iot-hub-dr"></a><span data-ttu-id="4d5e0-109">Аварийное восстановление центра IoT Azure</span><span class="sxs-lookup"><span data-stu-id="4d5e0-109">Azure IoT Hub DR</span></span>
<span data-ttu-id="4d5e0-110">Кроме того региона toointra высокого уровня ДОСТУПНОСТИ, центр IoT реализует механизмы отказоустойчивости для аварийного восстановления, которые не требуют вмешательства пользователя hello.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-110">In addition toointra-region HA, IoT Hub implements failover mechanisms for disaster recovery that require no intervention from hello user.</span></span> <span data-ttu-id="4d5e0-111">IoT Hub DR инициируется самостоятельно и имеет время восстановления (RTO) 2 26 часа и hello следующие целями точки восстановления (RPO).</span><span class="sxs-lookup"><span data-stu-id="4d5e0-111">IoT Hub DR is self-initiated and has a recovery time objective (RTO) of 2-26 hours, and hello following recovery point objectives (RPOs).</span></span>

| <span data-ttu-id="4d5e0-112">Функции</span><span class="sxs-lookup"><span data-stu-id="4d5e0-112">Functionality</span></span> | <span data-ttu-id="4d5e0-113">RPO</span><span class="sxs-lookup"><span data-stu-id="4d5e0-113">RPO</span></span> |
| --- | --- |
| <span data-ttu-id="4d5e0-114">Доступность службы для операций с реестром и операций взаимодействия</span><span class="sxs-lookup"><span data-stu-id="4d5e0-114">Service availability for registry and communication operations</span></span> |<span data-ttu-id="4d5e0-115">Возможна потеря записи CName</span><span class="sxs-lookup"><span data-stu-id="4d5e0-115">Possible CName loss</span></span> |
| <span data-ttu-id="4d5e0-116">Данные удостоверений в реестре удостоверений</span><span class="sxs-lookup"><span data-stu-id="4d5e0-116">Identity data in identity registry</span></span> |<span data-ttu-id="4d5e0-117">Потеря 0–5 мин данных</span><span class="sxs-lookup"><span data-stu-id="4d5e0-117">0-5 mins data loss</span></span> |
| <span data-ttu-id="4d5e0-118">Отправка сообщений с устройства в облако</span><span class="sxs-lookup"><span data-stu-id="4d5e0-118">Device-to-cloud messages</span></span> |<span data-ttu-id="4d5e0-119">Теряются все непрочитанные сообщения</span><span class="sxs-lookup"><span data-stu-id="4d5e0-119">All unread messages are lost</span></span> |
| <span data-ttu-id="4d5e0-120">Отправка сообщений о мониторинге операций</span><span class="sxs-lookup"><span data-stu-id="4d5e0-120">Operations monitoring messages</span></span> |<span data-ttu-id="4d5e0-121">Теряются все непрочитанные сообщения</span><span class="sxs-lookup"><span data-stu-id="4d5e0-121">All unread messages are lost</span></span> |
| <span data-ttu-id="4d5e0-122">Получение сообщений из облака на устройство</span><span class="sxs-lookup"><span data-stu-id="4d5e0-122">Cloud-to-device messages</span></span> |<span data-ttu-id="4d5e0-123">Потеря 0–5 мин данных</span><span class="sxs-lookup"><span data-stu-id="4d5e0-123">0-5 mins data loss</span></span> |
| <span data-ttu-id="4d5e0-124">Очередь отзывов из облака на устройство</span><span class="sxs-lookup"><span data-stu-id="4d5e0-124">Cloud-to-device feedback queue</span></span> |<span data-ttu-id="4d5e0-125">Теряются все непрочитанные сообщения</span><span class="sxs-lookup"><span data-stu-id="4d5e0-125">All unread messages are lost</span></span> |

## <a name="regional-failover-with-iot-hub"></a><span data-ttu-id="4d5e0-126">Отработка отказа между регионами с помощью центра IoT</span><span class="sxs-lookup"><span data-stu-id="4d5e0-126">Regional failover with IoT Hub</span></span>
<span data-ttu-id="4d5e0-127">Полное раскрытие топологии развертывания в решениях IoT выходит за рамки данной статьи hello.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-127">A complete treatment of deployment topologies in IoT solutions is outside hello scope of this article.</span></span> <span data-ttu-id="4d5e0-128">Hello рассматривается hello *региональной отработки отказа* модели развертывания высокого уровня доступности и аварийного восстановления с целью hello.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-128">hello article discusses hello *regional failover* deployment model for hello purpose of high availability and disaster recovery.</span></span>

<span data-ttu-id="4d5e0-129">В модели региональной отработки отказа hello решения задней запускает главным образом в расположении одного центра обработки данных и вторичной центр IoT и серверной части развертываются в другое расположение центра обработки данных.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-129">In a regional failover model, hello solution back end runs primarily in one datacenter location, and a secondary IoT hub and back end are deployed in another datacenter location.</span></span> <span data-ttu-id="4d5e0-130">Если центр IoT hello в основном центре обработки данных hello подвергается атаке сбоя или нарушено сетевое подключение hello из hello устройства toohello основного центра обработки данных.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-130">If hello IoT hub in hello primary datacenter suffers an outage or hello network connectivity from hello device toohello primary datacenter is interrupted.</span></span> <span data-ttu-id="4d5e0-131">Устройства используют конечную точку службы получателя всякий раз, когда не удается связаться со шлюзом основной hello.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-131">Devices use a secondary service endpoint whenever hello primary gateway cannot be reached.</span></span> <span data-ttu-id="4d5e0-132">С возможностью отработки отказа в различных регионах доступность решения hello может быть улучшена за высокого уровня доступности hello одной области.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-132">With a cross-region failover capability, hello solution availability can be improved beyond hello high availability of a single region.</span></span>

<span data-ttu-id="4d5e0-133">На высоком уровне tooimplement модель региональной отработки отказа с центром IoT требуется hello следующее:</span><span class="sxs-lookup"><span data-stu-id="4d5e0-133">At a high level, tooimplement a regional failover model with IoT Hub, you need hello following:</span></span>

* <span data-ttu-id="4d5e0-134">**Центр IoT и устройства, логику маршрутизации вторичной**: В случае перебоев в работе службы в основном регионе hello, устройства необходимо запустить подключение tooyour дополнительный регион.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-134">**A secondary IoT hub and device routing logic**: In hello case of a service disruption in your primary region, devices must start connecting tooyour secondary region.</span></span> <span data-ttu-id="4d5e0-135">Условии hello учитывать состояние характера участвующих большинство служб, часто бывает процесс отработки отказа между области hello tootrigger Администраторы решения.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-135">Given hello state-aware nature of most services involved, it is common for solution administrators tootrigger hello inter-region failover process.</span></span> <span data-ttu-id="4d5e0-136">Hello лучшим способом toocommunicate hello новой конечной точки toodevices, сохраняя контроль над процессом hello, — их Регулярная проверка toohave *concierge* hello текущей активной конечной точки службы.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-136">hello best way toocommunicate hello new endpoint toodevices, while maintaining control of hello process, is toohave them regularly check a *concierge* service for hello current active endpoint.</span></span> <span data-ttu-id="4d5e0-137">Hello дежурная служба может быть веб-приложения, репликации, которую достижимым методами перенаправления DNS (например, с помощью [диспетчера трафика Azure][Azure Traffic Manager]).</span><span class="sxs-lookup"><span data-stu-id="4d5e0-137">hello concierge service can be a web application that is replicated and kept reachable using DNS-redirection techniques (for example, using [Azure Traffic Manager][Azure Traffic Manager]).</span></span>
* <span data-ttu-id="4d5e0-138">**Репликация реестра удостоверений** -toobe можно использовать вторичный центр IoT hello должен содержать все удостоверения устройства подключаются toohello решения.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-138">**Identity registry replication** - toobe usable, hello secondary IoT hub must contain all device identities that can connect toohello solution.</span></span> <span data-ttu-id="4d5e0-139">Hello решения необходимо сохранить резервные копии на георепликацией удостоверений устройств и отправить вторичного центра IoT toohello перед переключением hello активную конечную точку для hello устройств.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-139">hello solution should keep geo-replicated backups of device identities, and upload them toohello secondary IoT hub before switching hello active endpoint for hello devices.</span></span> <span data-ttu-id="4d5e0-140">в этом контексте полезно Hello функциональные возможности экспорта устройства удостоверение из центра IoT.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-140">hello device identity export functionality of IoT Hub is useful in this context.</span></span> <span data-ttu-id="4d5e0-141">Дополнительные сведения см. в [разделе, посвященном реестру удостоверений, руководства разработчика для Центра Интернета вещей][IoT Hub developer guide - identity registry].</span><span class="sxs-lookup"><span data-stu-id="4d5e0-141">For more information, see [IoT Hub developer guide - identity registry][IoT Hub developer guide - identity registry].</span></span>
* <span data-ttu-id="4d5e0-142">**Слияние логику** — Если основной регион hello снова становится доступной, все hello состояние и данные, которые были созданы в hello вторичный сайт должен быть основной регион перенесенных toohello назад.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-142">**Merging logic** - When hello primary region becomes available again, all hello state and data that have been created in hello secondary site must be migrated back toohello primary region.</span></span> <span data-ttu-id="4d5e0-143">Это состояние и данные практически связывает toodevice удостоверений и метаданные приложения, которые должны быть объединены с hello первичный центр IoT и другим хранилищам конкретного приложения в основном регионе hello.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-143">This state and data mostly relates toodevice identities and application metadata, which must be merged with hello primary IoT hub and any other application-specific stores in hello primary region.</span></span> <span data-ttu-id="4d5e0-144">toosimplify этот шаг следует использовать операции идемпотентными.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-144">toosimplify this step, you should use idempotent operations.</span></span> <span data-ttu-id="4d5e0-145">Операции идемпотентными свести к минимуму hello побочные эффекты от окончательной равномерным распределением hello событий и от дубликаты или доставки ожидания неупорядоченных событий.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-145">Idempotent operations minimize hello side-effects from hello eventual consistent distribution of events, and from duplicates or out-of-order delivery of events.</span></span> <span data-ttu-id="4d5e0-146">Кроме того логика приложения hello может потенциальных несоответствий спроектированный tootolerate «немного» из состояния даты.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-146">In addition, hello application logic should be designed tootolerate potential inconsistencies or "slightly" out of date-state.</span></span> <span data-ttu-id="4d5e0-147">Такая ситуация может возникнуть из-за toohello дополнительное время, необходимое для системы hello слишком «автоматическое восстановление» с учетом целей точки восстановления (RPO).</span><span class="sxs-lookup"><span data-stu-id="4d5e0-147">This situation can occur due toohello additional time it takes for hello system too"heal" based on recovery point objectives (RPO).</span></span>

## <a name="next-steps"></a><span data-ttu-id="4d5e0-148">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="4d5e0-148">Next steps</span></span>
<span data-ttu-id="4d5e0-149">Выполните эти дополнительные сведения о Azure IoT Hub toolearn ссылки.</span><span class="sxs-lookup"><span data-stu-id="4d5e0-149">Follow these links toolearn more about Azure IoT Hub:</span></span>

* <span data-ttu-id="4d5e0-150">[Приступая к работе с Центром Интернета вещей Azure][lnk-get-started]</span><span class="sxs-lookup"><span data-stu-id="4d5e0-150">[Get started with IoT Hubs (Tutorial)][lnk-get-started]</span></span>
* <span data-ttu-id="4d5e0-151">[Что такое центр IoT в Azure?][What is Azure IoT Hub?]</span><span class="sxs-lookup"><span data-stu-id="4d5e0-151">[What is Azure IoT Hub?][What is Azure IoT Hub?]</span></span>

[Disaster recovery and high availability for Azure applications]: ../resiliency/resiliency-disaster-recovery-high-availability-azure-applications.md
[Azure Business Continuity Technical Guidance]: https://azure.microsoft.com/documentation/articles/resiliency-technical-guidance/
[Azure Traffic Manager]: https://azure.microsoft.com/documentation/services/traffic-manager/
[IoT Hub developer guide - identity registry]: iot-hub-devguide-identity-registry.md

[lnk-get-started]: iot-hub-csharp-csharp-getstarted.md
[What is Azure IoT Hub?]: iot-hub-what-is-iot-hub.md
