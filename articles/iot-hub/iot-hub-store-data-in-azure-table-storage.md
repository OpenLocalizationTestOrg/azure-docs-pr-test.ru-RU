---
title: "Сохранение сообщений Центра Интернета вещей в хранилище данных Azure | Документация Майкрософт"
description: "Используйте маршрутизацию сообщений Центра Интернета вещей для их сохранения в хранилище BLOB-объектов Azure. Сообщения Центра Интернета вещей содержат такие сведения, как данные датчиков, отправленные из устройства Интернета вещей."
services: iot-hub
documentationcenter: 
author: shizn
manager: timlt
tags: 
keywords: "хранилище данных Центра Интернета вещей, хранилище для данных датчиков Центра Интернета вещей"
ms.assetid: 62fd14fd-aaaa-4b3d-8367-75c1111b6269
ms.service: iot-hub
ms.devlang: arduino
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 10/04/2017
ms.author: xshi
ms.openlocfilehash: 5419f0fb86f2a7b051ffc7fda17c74cf15178a6b
ms.sourcegitcommit: c25cf136aab5f082caaf93d598df78dc23e327b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2017
---
# <a name="save-iot-hub-messages-that-contain-sensor-data-to-your-azure-blob-storage"></a>Сохранение сообщений Центра Интернета вещей, которые содержат данные датчиков, в хранилище BLOB-объектов Azure

![Сквозная схема](media/iot-hub-store-data-in-azure-table-storage/1_route-to-storage.png)

[!INCLUDE [iot-hub-get-started-note](../../includes/iot-hub-get-started-note.md)]

## <a name="what-you-learn"></a>Что вы узнаете

Вы узнаете, как создать учетную запись хранения Azure и приложение-функцию Azure для сохранения сообщений Центра Интернета вещей в хранилище BLOB-объектов.

## <a name="what-you-do"></a>В рамках этого руководства мы:

- Создайте учетную запись хранения Azure.
- Подготовим Центр Интернета вещей для маршрутизации сообщений в хранилище.

## <a name="what-you-need"></a>Необходимые элементы

- [Настройте свое устройство](iot-hub-raspberry-pi-kit-node-get-started.md). У вас должны быть следующие компоненты:
  - активная подписка Azure;
  - Центр Интернета вещей в подписке; 
  - работающее приложение, отправляющее сообщения в Центр Интернета вещей.

## <a name="create-an-azure-storage-account"></a>Создание учетной записи хранения Azure

1. На [портале Azure](https://portal.azure.com/) щелкните **Создать** > **Хранилище** > **Учетная запись хранения** > **Создать**.

2. Введите необходимые сведения для учетной записи хранения:

   ![Создание учетной записи хранения на портале Azure](media\iot-hub-store-data-in-azure-table-storage\1_azure-portal-create-storage-account.png)

   * **Имя**. Имя учетной записи хранения. Оно должно быть глобально уникальным.

   * **Группа ресурсов**. Выберите ту же группу ресурсов, которую использует Центр Интернета вещей.

   * **Закрепить на панели мониторинга.** Установите этот флажок, чтобы быстро открывать Центр Интернета вещей с помощью панели мониторинга.

3. Щелкните **Создать**.

## <a name="prepare-your-iot-hub-to-route-messages-to-storage"></a>Подготовка Центра Интернета вещей для маршрутизации сообщений в хранилище

Центр Интернета вещей изначально поддерживает маршрутизацию сообщений в хранилище Azure в качестве больших двоичных объектов.

### <a name="add-storage-as-a-custom-endpoint"></a>Добавление хранилища в качестве пользовательской конечной точки

Перейдите в Центр Интернета вещей на портале Azure. Щелкните **Конечные точки** > **Добавить**. Назовите конечную точку и выберите **Контейнер службы хранилища Azure** в качестве типа конечной точки. С помощью средства выбора выберите учетную запись хранения, созданную в предыдущем разделе. Создайте контейнер хранилища, а затем выберите его и щелкните **ОК**.

  ![Создание пользовательской конечной точки в Центре Интернета вещей](media\iot-hub-store-data-in-azure-table-storage\2_custom-storage-endpoint.png)

### <a name="add-a-route-to-route-data-to-storage"></a>Добавление маршрута для маршрутизации данных в хранилище

Щелкните **Маршруты** > **Добавить** и введите имя маршрута. Выберите **Device Messages** (Сообщения устройства) в качестве источника данных и созданную конечную точку хранилища в качестве конечной точки маршрута. Введите `true` в качестве строки запроса, а затем щелкните **Сохранить**.

  ![Создание маршрута в Центре Интернета вещей](media\iot-hub-store-data-in-azure-table-storage\3_create-route.png)
  
### <a name="add-a-route-for-hot-path-telemetry-optional"></a>Добавление маршрута для телеметрии критического пути (необязательно)

По умолчанию Центр Интернета вещей направляет все сообщения, которые не соответствуют другим маршрутам, на встроенную конечную точку. Так как все сообщения телеметрии теперь соответствуют правилу, которое направляет сообщения в хранилище, нужно добавить еще один маршрут для сообщений, которые будут записаны во встроенную конечную точку. Дополнительная плата за маршрутизацию сообщений в несколько конечных точек не взимается.

> [!NOTE]
> Этот шаг можно пропустить, если дополнительная обработка сообщений телеметрии не выполняется.

В области "Маршруты" щелкните **Добавить** и введите имя маршрута. Выберите **Device Messages** (Сообщения устройства) в качестве источника данных и **события** в качестве конечной точки. Введите `true` в качестве строки запроса, а затем щелкните **Сохранить**.

  ![Создание маршрута критического пути в Центре Интернета вещей](media\iot-hub-store-data-in-azure-table-storage\4_hot-path-route.png)

## <a name="verify-your-message-in-your-storage-container"></a>Проверка сообщения в контейнере хранилища

1. Выполните пример приложения на устройстве, чтобы отправить сообщения в Центр Интернета вещей.

2. [Скачайте и установите обозреватель хранилищ Azure](http://storageexplorer.com/).

3. Откройте обозреватель хранилищ, щелкните **Add an Azure Account** (Добавление учетной записи Azure)  > **Вход**, а затем выполните вход в свою учетную запись Azure.

4. Щелкните подписку Azure, выберите **Учетные записи хранения** > ваша учетная запись хранения > **Контейнеры больших двоичных объектов** и щелкните нужный контейнер.

   Вы должны увидеть сообщения, отправленные с устройства в Центр Интернета вещей, в контейнере большого двоичного объекта.

## <a name="next-steps"></a>Дальнейшие действия

Вы успешно создали учетную запись хранения Azure и перенаправили сообщения из Центр Интернета вещей в контейнер больших двоичных объектов в учетной записи хранения.

[!INCLUDE [iot-hub-get-started-next-steps](../../includes/iot-hub-get-started-next-steps.md)]
