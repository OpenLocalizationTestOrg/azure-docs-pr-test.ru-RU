---
title: "обмен сообщениями aaaUnderstand центр IoT Azure облака на устройство | Документы Microsoft"
description: "Руководство разработчика - как toouse облака на устройство обмена сообщениями с центром IoT. Содержит сведения о параметрах конфигурации и жизненный цикл сообщения hello."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: dobett
ms.openlocfilehash: 5c747b50163873d823556a8baa769c4b8f7f8c44
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="send-cloud-to-device-messages-from-iot-hub"></a><span data-ttu-id="9a3f2-104">Отправка сообщений, пересылаемых из облака на устройство, из Центра Интернета вещей</span><span class="sxs-lookup"><span data-stu-id="9a3f2-104">Send cloud-to-device messages from IoT Hub</span></span>

<span data-ttu-id="9a3f2-105">приложение для устройства toohello toosend одностороннего уведомления из серверной части вашего решения, отправлять сообщения облака для устройства с устройства tooyour концентратора IoT.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-105">toosend one-way notifications toohello device app from your solution back end, send cloud-to-devices messages from your IoT hub tooyour device.</span></span> <span data-ttu-id="9a3f2-106">Обсуждение других вариантов передачи данных из облака на устройство, поддерживаемых Центром Интернета вещей, см. в [руководстве по обмену данными между облаком и устройством][lnk-c2d-guidance].</span><span class="sxs-lookup"><span data-stu-id="9a3f2-106">For a discussion of other cloud-to-devices options supported by IoT Hub, see [Cloud-to-device communications guidance][lnk-c2d-guidance].</span></span>

<span data-ttu-id="9a3f2-107">Сообщения из облака на устройство можно отправлять через конечную точку, обращенную к службе (**/messages/devicebound**).</span><span class="sxs-lookup"><span data-stu-id="9a3f2-107">You send cloud-to-device messages through a service-facing endpoint (**/messages/devicebound**).</span></span> <span data-ttu-id="9a3f2-108">Устройство получает сообщения hello через конечную точку конкретного устройства (**/devices/ {deviceId} / сообщений/devicebound**).</span><span class="sxs-lookup"><span data-stu-id="9a3f2-108">A device then receives hello messages through a device-specific endpoint (**/devices/{deviceId}/messages/devicebound**).</span></span>

<span data-ttu-id="9a3f2-109">Каждое сообщение облака на устройство распространяется на отдельном устройстве параметр hello **для** свойство слишком**/devices/ {deviceId} / сообщений/devicebound**.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-109">Each cloud-to-device message is targeted at a single device by setting hello **to** property too**/devices/{deviceId}/messages/devicebound**.</span></span>

<span data-ttu-id="9a3f2-110">Одна очередь устройства содержит не более 50 сообщений, отправляемых из облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-110">Each device queue holds at most 50 cloud-to-device messages.</span></span> <span data-ttu-id="9a3f2-111">Попытка toosend toohello дополнительные сообщения одного устройства приводит к ошибке.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-111">Trying toosend more messages toohello same device results in an error.</span></span>

## <a name="hello-cloud-to-device-message-lifecycle"></a><span data-ttu-id="9a3f2-112">жизненный цикл облака на устройство сообщение Hello</span><span class="sxs-lookup"><span data-stu-id="9a3f2-112">hello cloud-to-device message lifecycle</span></span>

<span data-ttu-id="9a3f2-113">Центр IoT доставки сообщений в однократная tooguarantee сохраняет облака на устройство сообщений в очереди на устройство.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-113">tooguarantee at-least-once message delivery, IoT Hub persists cloud-to-device messages in per-device queues.</span></span> <span data-ttu-id="9a3f2-114">Устройства должны явным образом признаете *завершения* для центра IoT tooremove их из hello очереди.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-114">Devices must explicitly acknowledge *completion* for IoT Hub tooremove them from hello queue.</span></span> <span data-ttu-id="9a3f2-115">Этот способ гарантирует устойчивость к сбоям подключения и ошибкам устройств.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-115">This approach guarantees resiliency against connectivity and device failures.</span></span>

<span data-ttu-id="9a3f2-116">Hello следующей схеме показаны hello графа состояния жизненного цикла для облака на устройство сообщения в центр IoT.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-116">hello following diagram shows hello lifecycle state graph for a cloud-to-device message in IoT Hub.</span></span>

![Жизненный цикл сообщений, отправляемых из облака на устройство][img-lifecycle]

<span data-ttu-id="9a3f2-118">При hello IoT Hub service отправляет сообщение tooa устройства, hello службы задает состояние сообщения hello слишком**сообщений в очереди**.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-118">When hello IoT Hub service sends a message tooa device, hello service sets hello message state too**Enqueued**.</span></span> <span data-ttu-id="9a3f2-119">Когда устройство хочет слишком*получать* сообщение центра IoT *блокировки* приветственное сообщение (, установив состояние hello слишком**невидимой**), разрешающее других потоков на устройстве toostart hello Получение других сообщений.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-119">When a device wants too*receive* a message, IoT Hub *locks* hello message (by setting hello state too**Invisible**), which allows other threads on hello device toostart receiving other messages.</span></span> <span data-ttu-id="9a3f2-120">Если устройства поток завершает обработку сообщения hello, уведомит центра IoT, *Завершение* приветственное сообщение.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-120">When a device thread completes hello processing of a message, it notifies IoT Hub by *completing* hello message.</span></span> <span data-ttu-id="9a3f2-121">Центр IoT затем устанавливает состояние hello слишком**завершено**.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-121">IoT Hub then sets hello state too**Completed**.</span></span>

<span data-ttu-id="9a3f2-122">Устройство также может:</span><span class="sxs-lookup"><span data-stu-id="9a3f2-122">A device can also choose to:</span></span>

* <span data-ttu-id="9a3f2-123">*Отклонить* приветственное сообщение, что приведет к тому tooset центр IoT его toohello **считается недоставленным** состояния.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-123">*Reject* hello message, which causes IoT Hub tooset it toohello **Deadlettered** state.</span></span> <span data-ttu-id="9a3f2-124">Устройства, подключаемые через протокол MQTT hello не удается отклонить сообщения облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-124">Devices that connect over hello MQTT protocol cannot reject cloud-to-device messages.</span></span>
* <span data-ttu-id="9a3f2-125">*Прервать* сообщения hello, который вызывает центр IoT tooput приветственное сообщение обратно в очередь hello с состоянием hello задать слишком**сообщений в очереди**.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-125">*Abandon* hello message, which causes IoT Hub tooput hello message back in hello queue, with hello state set too**Enqueued**.</span></span>

<span data-ttu-id="9a3f2-126">Поток может завершиться ошибкой tooprocess сообщение без уведомления центра IoT.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-126">A thread could fail tooprocess a message without notifying IoT Hub.</span></span> <span data-ttu-id="9a3f2-127">В этом случае сообщения автоматически переход из hello **невидимой** toohello назад состояние **поставленных в очередь** состояния после *время ожидания видимости (или блокировка)*.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-127">In this case, messages automatically transition from hello **Invisible** state back toohello **Enqueued** state after a *visibility (or lock) timeout*.</span></span> <span data-ttu-id="9a3f2-128">значение по умолчанию Hello это время ожидания составляет одну минуту.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-128">hello default value of this timeout is one minute.</span></span>

<span data-ttu-id="9a3f2-129">Сообщения можно переходить между hello **сообщений в очереди** и **невидимой** состояний, не более hello количество времени, указанного в hello **Макс. Число доставок** свойство центр IoT.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-129">A message can transition between hello **Enqueued** and **Invisible** states for, at most, hello number of times specified in hello **max delivery count** property on IoT Hub.</span></span> <span data-ttu-id="9a3f2-130">После этого числа переходов центра IoT задает состояние hello приветственное сообщение, слишком**считается недоставленным**.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-130">After that number of transitions, IoT Hub sets hello state of hello message too**Deadlettered**.</span></span> <span data-ttu-id="9a3f2-131">Аналогичным образом, центр IoT задает состояние hello сообщения слишком**считается недоставленным** после истечения срока (в разделе [время toolive][lnk-ttl]).</span><span class="sxs-lookup"><span data-stu-id="9a3f2-131">Similarly, IoT Hub sets hello state of a message too**Deadlettered** after its expiration time (see [Time toolive][lnk-ttl]).</span></span>

<span data-ttu-id="9a3f2-132">Hello [способ сообщений toosend облака на устройство с центром IoT] [ lnk-c2d-tutorial] отображаются как облака на устройство toosend сообщения hello облако и получать их на устройстве.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-132">hello [How toosend cloud-to-device messages with IoT Hub][lnk-c2d-tutorial] shows you how toosend cloud-to-device messages from hello cloud and receive them on a device.</span></span>

<span data-ttu-id="9a3f2-133">Как правило устройство завершает сообщение облака на устройство при потере приветственное сообщение hello не влияет на логику приложения hello.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-133">Typically, a device completes a cloud-to-device message when hello loss of hello message does not affect hello application logic.</span></span> <span data-ttu-id="9a3f2-134">Например, при hello устройство имеет постоянное сообщение hello содержимое локально, или успешного выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-134">For example, when hello device has persisted hello message content locally or has successfully executed an operation.</span></span> <span data-ttu-id="9a3f2-135">приветственное сообщение также можно захватить промежуточной информации, не повлияет на которого потери hello функциональных возможностей приложения hello.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-135">hello message could also carry transient information, whose loss would not impact hello functionality of hello application.</span></span> <span data-ttu-id="9a3f2-136">В некоторых случаях для длительно выполняемых задач сообщение hello облака на устройство можно выполнить после сохранения hello описание задачи в локальном хранилище.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-136">Sometimes, for long-running tasks, you can complete hello cloud-to-device message after persisting hello task description in local storage.</span></span> <span data-ttu-id="9a3f2-137">Затем можно уведомить hello решения серверной части с одно или несколько сообщений устройства в облако на различных этапах хода выполнения задачи «hello».</span><span class="sxs-lookup"><span data-stu-id="9a3f2-137">Then you can notify hello solution back end with one or more device-to-cloud messages at various stages of progress of hello task.</span></span>

## <a name="message-expiration-time-toolive"></a><span data-ttu-id="9a3f2-138">Срок действия сообщения (время toolive)</span><span class="sxs-lookup"><span data-stu-id="9a3f2-138">Message expiration (time toolive)</span></span>

<span data-ttu-id="9a3f2-139">Каждое сообщение из облака на устройство имеет срок действия.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-139">Every cloud-to-device message has an expiration time.</span></span> <span data-ttu-id="9a3f2-140">Это время задается службой hello (в hello **ExpiryTimeUtc** свойства), или с помощью по умолчанию hello центра IoT *toolive время* указан как свойство центр IoT.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-140">This time is set either by hello service (in hello **ExpiryTimeUtc** property), or by IoT Hub using hello default *time toolive* specified as an IoT Hub property.</span></span> <span data-ttu-id="9a3f2-141">Ознакомьтесь с разделом [Параметры конфигурации сообщений, отправляемых из облака на устройство][lnk-c2d-configuration].</span><span class="sxs-lookup"><span data-stu-id="9a3f2-141">See [Cloud-to-device configuration options][lnk-c2d-configuration].</span></span>

<span data-ttu-id="9a3f2-142">Общий способ tootake преимуществами сообщений истечение срока действия и избежать отправки сообщений toodisconnected устройства, tooset toolive значения короткое время.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-142">A common way tootake advantage of message expiration and avoid sending messages toodisconnected devices, is tooset short time toolive values.</span></span> <span data-ttu-id="9a3f2-143">Такой подход позволяет достичь hello же результат как поддержки состояния подключения устройства hello, являются более эффективными.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-143">This approach achieves hello same result as maintaining hello device connection state, while being more efficient.</span></span> <span data-ttu-id="9a3f2-144">При запросе подтверждения сообщений центра IoT уведомляет устройств, которые могут tooreceive сообщений, и устройства, которые не находятся в сети, или произошел сбой.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-144">When you request message acknowledgements, IoT Hub notifies you which devices are able tooreceive messages, and which devices are not online or have failed.</span></span>

## <a name="message-feedback"></a><span data-ttu-id="9a3f2-145">Отзыв на сообщение</span><span class="sxs-lookup"><span data-stu-id="9a3f2-145">Message feedback</span></span>

<span data-ttu-id="9a3f2-146">При отправке сообщения облака на устройство hello служба может запросить hello доставки каждого сообщения отзывов о hello конечное состояние этого сообщения.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-146">When you send a cloud-to-device message, hello service can request hello delivery of per-message feedback regarding hello final state of that message.</span></span>

| <span data-ttu-id="9a3f2-147">Свойство Ack</span><span class="sxs-lookup"><span data-stu-id="9a3f2-147">Ack property</span></span> | <span data-ttu-id="9a3f2-148">Поведение</span><span class="sxs-lookup"><span data-stu-id="9a3f2-148">Behavior</span></span> |
| ------------ | -------- |
| <span data-ttu-id="9a3f2-149">**positive**</span><span class="sxs-lookup"><span data-stu-id="9a3f2-149">**positive**</span></span> | <span data-ttu-id="9a3f2-150">Центр IoT создает сообщение обратной связи, если и только если сообщение hello облака на устройство достигло hello **завершено** состояния.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-150">IoT Hub generates a feedback message if, and only if, hello cloud-to-device message reached hello **Completed** state.</span></span> |
| <span data-ttu-id="9a3f2-151">**negative**</span><span class="sxs-lookup"><span data-stu-id="9a3f2-151">**negative**</span></span> | <span data-ttu-id="9a3f2-152">Центр IoT создает сообщение обратной связи, если и только если сообщение hello облака на устройство достигает hello **считается недоставленным** состояния.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-152">IoT Hub generates a feedback message, if and only if, hello cloud-to-device message reaches hello **Deadlettered** state.</span></span> |
| <span data-ttu-id="9a3f2-153">**full**</span><span class="sxs-lookup"><span data-stu-id="9a3f2-153">**full**</span></span>     | <span data-ttu-id="9a3f2-154">Центр Интернета вещей создает отзыв на сообщение в любом случае.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-154">IoT Hub generates a feedback message in either case.</span></span> |

<span data-ttu-id="9a3f2-155">Если **Ack** — **полного**и вы не будете получать сообщение обратной связи, это означает, что истек срок действия сообщения hello обратной связи.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-155">If **Ack** is **full**, and you don't receive a feedback message, it means that hello feedback message expired.</span></span> <span data-ttu-id="9a3f2-156">Здравствуйте, служба не может знать, какая ошибка toohello исходного сообщения.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-156">hello service can't know what happened toohello original message.</span></span> <span data-ttu-id="9a3f2-157">На практике службы следует убедиться, возможность обработки отзывов hello до истечения срока его действия.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-157">In practice, a service should ensure that it can process hello feedback before it expires.</span></span> <span data-ttu-id="9a3f2-158">Hello максимальный срок действия составляет двух дней, и это означает, что немало времени tooget hello службы снова выполнить при возникновении сбоя.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-158">hello maximum expiry time is two days, which allows plenty of time tooget hello service running again if a failure occurs.</span></span>

<span data-ttu-id="9a3f2-159">Как описано в статье [Endpoints][lnk-endpoints] (Конечные точки), Центр Интернета вещей предоставляет отзывы в виде сообщений через конечную точку, доступную для службы (**/messages/servicebound/feedback**).</span><span class="sxs-lookup"><span data-stu-id="9a3f2-159">As explained in [Endpoints][lnk-endpoints], IoT Hub delivers feedback through a service-facing endpoint (**/messages/servicebound/feedback**) as messages.</span></span> <span data-ttu-id="9a3f2-160">Hello семантику для получения отзывов hello таким же как и для облака на устройство сообщения и иметь hello же [жизненный цикл сообщения][lnk-lifecycle].</span><span class="sxs-lookup"><span data-stu-id="9a3f2-160">hello semantics for receiving feedback are hello same as for cloud-to-device messages, and have hello same [Message lifecycle][lnk-lifecycle].</span></span> <span data-ttu-id="9a3f2-161">По возможности отзыв сообщения пакетных в одном сообщении с hello следующий формат:</span><span class="sxs-lookup"><span data-stu-id="9a3f2-161">Whenever possible, message feedback is batched in a single message, with hello following format:</span></span>

| <span data-ttu-id="9a3f2-162">Свойство</span><span class="sxs-lookup"><span data-stu-id="9a3f2-162">Property</span></span>     | <span data-ttu-id="9a3f2-163">Описание</span><span class="sxs-lookup"><span data-stu-id="9a3f2-163">Description</span></span> |
| ------------ | ----------- |
| <span data-ttu-id="9a3f2-164">EnqueuedTime</span><span class="sxs-lookup"><span data-stu-id="9a3f2-164">EnqueuedTime</span></span> | <span data-ttu-id="9a3f2-165">Отметка времени, указывающее, время создания приветственных сообщений.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-165">Timestamp indicating when hello message was created.</span></span> |
| <span data-ttu-id="9a3f2-166">UserId</span><span class="sxs-lookup"><span data-stu-id="9a3f2-166">UserId</span></span>       | `{iot hub name}` |
| <span data-ttu-id="9a3f2-167">ContentType</span><span class="sxs-lookup"><span data-stu-id="9a3f2-167">ContentType</span></span>  | `application/vnd.microsoft.iothub.feedback.json` |

<span data-ttu-id="9a3f2-168">текст Hello используется сериализации JSON массив записей, каждая из которых hello следующие свойства:</span><span class="sxs-lookup"><span data-stu-id="9a3f2-168">hello body is a JSON-serialized array of records, each with hello following properties:</span></span>

| <span data-ttu-id="9a3f2-169">Свойство</span><span class="sxs-lookup"><span data-stu-id="9a3f2-169">Property</span></span>           | <span data-ttu-id="9a3f2-170">Описание</span><span class="sxs-lookup"><span data-stu-id="9a3f2-170">Description</span></span> |
| ------------------ | ----------- |
| <span data-ttu-id="9a3f2-171">EnqueuedTimeUtc</span><span class="sxs-lookup"><span data-stu-id="9a3f2-171">EnqueuedTimeUtc</span></span>    | <span data-ttu-id="9a3f2-172">Отметка времени, указывающее, когда произошли результат приветственное сообщение hello.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-172">Timestamp indicating when hello outcome of hello message happened.</span></span> <span data-ttu-id="9a3f2-173">Например, hello устройства завершен или истек срок действия сообщения hello.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-173">For example, hello device completed or hello message expired.</span></span> |
| <span data-ttu-id="9a3f2-174">OriginalMessageId</span><span class="sxs-lookup"><span data-stu-id="9a3f2-174">OriginalMessageId</span></span>  | <span data-ttu-id="9a3f2-175">**Код (ID)** из toowhich облака на устройство сообщение hello связывает информацию для обратной связи.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-175">**MessageId** of hello cloud-to-device message toowhich this feedback information relates.</span></span> |
| <span data-ttu-id="9a3f2-176">StatusCode</span><span class="sxs-lookup"><span data-stu-id="9a3f2-176">StatusCode</span></span>         | <span data-ttu-id="9a3f2-177">Обязательная строка.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-177">Required string.</span></span> <span data-ttu-id="9a3f2-178">Используется в отзывах, созданных центром IoT.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-178">Used in feedback messages generated by IoT Hub.</span></span> <br/> <span data-ttu-id="9a3f2-179">'Success'</span><span class="sxs-lookup"><span data-stu-id="9a3f2-179">'Success'</span></span> <br/> <span data-ttu-id="9a3f2-180">'Expired'</span><span class="sxs-lookup"><span data-stu-id="9a3f2-180">'Expired'</span></span> <br/> <span data-ttu-id="9a3f2-181">'DeliveryCountExceeded'</span><span class="sxs-lookup"><span data-stu-id="9a3f2-181">'DeliveryCountExceeded'</span></span> <br/> <span data-ttu-id="9a3f2-182">'Rejected'</span><span class="sxs-lookup"><span data-stu-id="9a3f2-182">'Rejected'</span></span> <br/> <span data-ttu-id="9a3f2-183">'Purged'</span><span class="sxs-lookup"><span data-stu-id="9a3f2-183">'Purged'</span></span> |
| <span data-ttu-id="9a3f2-184">Описание</span><span class="sxs-lookup"><span data-stu-id="9a3f2-184">Description</span></span>        | <span data-ttu-id="9a3f2-185">Строковые значения **StatusCode**.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-185">String values for **StatusCode**.</span></span> |
| <span data-ttu-id="9a3f2-186">deviceId</span><span class="sxs-lookup"><span data-stu-id="9a3f2-186">DeviceId</span></span>           | <span data-ttu-id="9a3f2-187">**DeviceId** hello целевого устройства из toowhich облака на устройство сообщение hello относится эта часть обратной связи.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-187">**DeviceId** of hello target device of hello cloud-to-device message toowhich this piece of feedback relates.</span></span> |
| <span data-ttu-id="9a3f2-188">DeviceGenerationId</span><span class="sxs-lookup"><span data-stu-id="9a3f2-188">DeviceGenerationId</span></span> | <span data-ttu-id="9a3f2-189">**DeviceGenerationId** из целевого устройства hello toowhich облака на устройство сообщение hello относится эта часть обратной связи.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-189">**DeviceGenerationId** of hello target device of hello cloud-to-device message toowhich this piece of feedback relates.</span></span> |

<span data-ttu-id="9a3f2-190">необходимо указать службы Hello **MessageId** для hello облака на устройство сообщения может toocorrelate toobe его обратной связи с исходное сообщение hello.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-190">hello service must specify a **MessageId** for hello cloud-to-device message toobe able toocorrelate its feedback with hello original message.</span></span>

<span data-ttu-id="9a3f2-191">Hello пример hello тела сообщения обратной связи.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-191">hello following example shows hello body of a feedback message.</span></span>

```json
[
  {
    "OriginalMessageId": "0987654321",
    "EnqueuedTimeUtc": "2015-07-28T16:24:48.789Z",
    "StatusCode": 0,
    "Description": "Success",
    "DeviceId": "123",
    "DeviceGenerationId": "abcdefghijklmnopqrstuvwxyz"
  },
  {
    ...
  },
  ...
]
```

## <a name="cloud-to-device-configuration-options"></a><span data-ttu-id="9a3f2-192">Параметры конфигурации сообщений, отправляемых из облака на устройство</span><span class="sxs-lookup"><span data-stu-id="9a3f2-192">Cloud-to-device configuration options</span></span>

<span data-ttu-id="9a3f2-193">Каждый центр IoT предоставляет следующие параметры конфигурации для облака на устройство сообщений hello.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-193">Each IoT hub exposes hello following configuration options for cloud-to-device messaging:</span></span>

| <span data-ttu-id="9a3f2-194">Свойство</span><span class="sxs-lookup"><span data-stu-id="9a3f2-194">Property</span></span>                  | <span data-ttu-id="9a3f2-195">Описание</span><span class="sxs-lookup"><span data-stu-id="9a3f2-195">Description</span></span> | <span data-ttu-id="9a3f2-196">Диапазон и значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="9a3f2-196">Range and default</span></span> |
| ------------------------- | ----------- | ----------------- |
| <span data-ttu-id="9a3f2-197">defaultTtlAsIso8601</span><span class="sxs-lookup"><span data-stu-id="9a3f2-197">defaultTtlAsIso8601</span></span>       | <span data-ttu-id="9a3f2-198">Заданный по умолчанию срок жизни для сообщений, отправляемых из облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-198">Default TTL for cloud-to-device messages.</span></span> | <span data-ttu-id="9a3f2-199">Интервал ISO_8601 копирование too2D (минимальное 1 минута).</span><span class="sxs-lookup"><span data-stu-id="9a3f2-199">ISO_8601 interval up too2D (minimum 1 minute).</span></span> <span data-ttu-id="9a3f2-200">Значение по умолчанию — 1 час.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-200">Default: 1 hour.</span></span> |
| <span data-ttu-id="9a3f2-201">maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="9a3f2-201">maxDeliveryCount</span></span>          | <span data-ttu-id="9a3f2-202">Лимит доставки для очереди доставки сообщений, отправляемых из облака на устройство, для каждого отдельного устройства.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-202">Maximum delivery count for cloud-to-device per-device queues.</span></span> | <span data-ttu-id="9a3f2-203">1 too100.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-203">1 too100.</span></span> <span data-ttu-id="9a3f2-204">Значение по умолчанию — 10.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-204">Default: 10.</span></span> |
| <span data-ttu-id="9a3f2-205">feedback.ttlAsIso8601</span><span class="sxs-lookup"><span data-stu-id="9a3f2-205">feedback.ttlAsIso8601</span></span>     | <span data-ttu-id="9a3f2-206">Хранение отзывов, направленных службе.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-206">Retention for service-bound feedback messages.</span></span> | <span data-ttu-id="9a3f2-207">Интервал ISO_8601 копирование too2D (минимальное 1 минута).</span><span class="sxs-lookup"><span data-stu-id="9a3f2-207">ISO_8601 interval up too2D (minimum 1 minute).</span></span> <span data-ttu-id="9a3f2-208">Значение по умолчанию — 1 час.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-208">Default: 1 hour.</span></span> |
| <span data-ttu-id="9a3f2-209">feedback.maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="9a3f2-209">feedback.maxDeliveryCount</span></span> |<span data-ttu-id="9a3f2-210">Лимит доставок для очереди отзывов.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-210">Maximum delivery count for feedback queue.</span></span> | <span data-ttu-id="9a3f2-211">1 too100.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-211">1 too100.</span></span> <span data-ttu-id="9a3f2-212">Значение по умолчанию — 100.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-212">Default: 100.</span></span> |

<span data-ttu-id="9a3f2-213">Дополнительные сведения о tooset эти параметры конфигурации см. в статье [центры IoT создания][lnk-portal].</span><span class="sxs-lookup"><span data-stu-id="9a3f2-213">For more information about how tooset these configuration options, see [Create IoT hubs][lnk-portal].</span></span>

## <a name="next-steps"></a><span data-ttu-id="9a3f2-214">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="9a3f2-214">Next steps</span></span>

<span data-ttu-id="9a3f2-215">Сведения о пакетах SDK hello можно использовать сообщения tooreceive облака на устройство см [пакеты SDK Azure IoT][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="9a3f2-215">For information about hello SDKs you can use tooreceive cloud-to-device messages, see [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="9a3f2-216">tootry ожидания получения сообщений облака на устройство. в разделе hello [отправки облака на устройство] [ lnk-c2d-tutorial] учебника.</span><span class="sxs-lookup"><span data-stu-id="9a3f2-216">tootry out receiving cloud-to-device messages, see hello [Send cloud-to-device][lnk-c2d-tutorial] tutorial.</span></span>

[img-lifecycle]: ./media/iot-hub-devguide-messages-c2d/lifecycle.png

[lnk-portal]: iot-hub-create-through-portal.md
[lnk-c2d-guidance]: iot-hub-devguide-c2d-guidance.md
[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-ttl]: #message-expiration-time-to-live
[lnk-c2d-configuration]: #cloud-to-device-configuration-options
[lnk-lifecycle]: #message-lifecycle
[lnk-c2d-tutorial]: iot-hub-csharp-csharp-c2d.md
