---
title: "Принципы отправки сообщений Центра Интернета вещей Azure из облака на устройство | Документы Майкрософт"
description: "Руководство разработчика — обмен сообщениями между облаком и устройством с помощью Центра Интернета вещей. Статья содержит сведения о жизненном цикле сообщения и параметрах конфигурации."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: dobett
ms.openlocfilehash: 04ac46498c912b0503036f70b7f3d0e28e5a82b8
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="send-cloud-to-device-messages-from-iot-hub"></a><span data-ttu-id="c3217-104">Отправка сообщений, пересылаемых из облака на устройство, из Центра Интернета вещей</span><span class="sxs-lookup"><span data-stu-id="c3217-104">Send cloud-to-device messages from IoT Hub</span></span>

<span data-ttu-id="c3217-105">Для отправки односторонних уведомлений из серверной части вашего решения в приложение на устройстве используются сообщения "из облака на устройство", отправляемые из Центра Интернета вещей на ваше устройство.</span><span class="sxs-lookup"><span data-stu-id="c3217-105">To send one-way notifications to the device app from your solution back end, send cloud-to-devices messages from your IoT hub to your device.</span></span> <span data-ttu-id="c3217-106">Обсуждение других вариантов передачи данных из облака на устройство, поддерживаемых Центром Интернета вещей, см. в [руководстве по обмену данными между облаком и устройством][lnk-c2d-guidance].</span><span class="sxs-lookup"><span data-stu-id="c3217-106">For a discussion of other cloud-to-devices options supported by IoT Hub, see [Cloud-to-device communications guidance][lnk-c2d-guidance].</span></span>

<span data-ttu-id="c3217-107">Сообщения из облака на устройство можно отправлять через конечную точку, обращенную к службе (**/messages/devicebound**).</span><span class="sxs-lookup"><span data-stu-id="c3217-107">You send cloud-to-device messages through a service-facing endpoint (**/messages/devicebound**).</span></span> <span data-ttu-id="c3217-108">Устройства затем получают эти сообщения через конечную точку конкретного устройства (**/devices/{ИД_устройства}/messages/devicebound**).</span><span class="sxs-lookup"><span data-stu-id="c3217-108">A device then receives the messages through a device-specific endpoint (**/devices/{deviceId}/messages/devicebound**).</span></span>

<span data-ttu-id="c3217-109">Каждое сообщение, отправляемое из облака на устройство, адресовано отдельному устройству, то есть для свойства **to** задается значение **/devices/{deviceId}/messages/devicebound**.</span><span class="sxs-lookup"><span data-stu-id="c3217-109">Each cloud-to-device message is targeted at a single device by setting the **to** property to **/devices/{deviceId}/messages/devicebound**.</span></span>

<span data-ttu-id="c3217-110">Одна очередь устройства содержит не более 50 сообщений, отправляемых из облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="c3217-110">Each device queue holds at most 50 cloud-to-device messages.</span></span> <span data-ttu-id="c3217-111">Попытка отправить на устройство большее количество сообщений приведет к ошибке.</span><span class="sxs-lookup"><span data-stu-id="c3217-111">Trying to send more messages to the same device results in an error.</span></span>

## <a name="the-cloud-to-device-message-lifecycle"></a><span data-ttu-id="c3217-112">Жизненный цикл сообщений, отправляемых из облака на устройство</span><span class="sxs-lookup"><span data-stu-id="c3217-112">The cloud-to-device message lifecycle</span></span>

<span data-ttu-id="c3217-113">Чтобы гарантировать как минимум однократную доставку, Центр Интернета вещей помещает сообщения, отправляемые из облака на устройство, в очередь устройства.</span><span class="sxs-lookup"><span data-stu-id="c3217-113">To guarantee at-least-once message delivery, IoT Hub persists cloud-to-device messages in per-device queues.</span></span> <span data-ttu-id="c3217-114">Сами устройства должны явно подтвердить *завершение* доставки, чтобы центр IoT мог удалить сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="c3217-114">Devices must explicitly acknowledge *completion* for IoT Hub to remove them from the queue.</span></span> <span data-ttu-id="c3217-115">Этот способ гарантирует устойчивость к сбоям подключения и ошибкам устройств.</span><span class="sxs-lookup"><span data-stu-id="c3217-115">This approach guarantees resiliency against connectivity and device failures.</span></span>

<span data-ttu-id="c3217-116">На следующей схеме показан жизненный цикл сообщений, отправляемых с облака в устройство, в Центре Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="c3217-116">The following diagram shows the lifecycle state graph for a cloud-to-device message in IoT Hub.</span></span>

![Жизненный цикл сообщений, отправляемых из облака на устройство][img-lifecycle]

<span data-ttu-id="c3217-118">Когда служба Центра Интернета вещей отправляет сообщение на устройство, она задает для него состояние **В очереди**.</span><span class="sxs-lookup"><span data-stu-id="c3217-118">When the IoT Hub service sends a message to a device, the service sets the message state to **Enqueued**.</span></span> <span data-ttu-id="c3217-119">Когда устройству нужно *получить* сообщение, Центр Интернета вещей *блокирует* сообщение (задавая состояние **Невидимо**), чтобы другие потоки на том же устройстве начали получать другие сообщения.</span><span class="sxs-lookup"><span data-stu-id="c3217-119">When a device wants to *receive* a message, IoT Hub *locks* the message (by setting the state to **Invisible**), which allows other threads on the device to start receiving other messages.</span></span> <span data-ttu-id="c3217-120">Когда поток устройства завершает обработку сообщения, он уведомляет центр IoT путем *завершения* сообщения.</span><span class="sxs-lookup"><span data-stu-id="c3217-120">When a device thread completes the processing of a message, it notifies IoT Hub by *completing* the message.</span></span> <span data-ttu-id="c3217-121">Затем Центр Интернета вещей задает состояние **Завершено**.</span><span class="sxs-lookup"><span data-stu-id="c3217-121">IoT Hub then sets the state to **Completed**.</span></span>

<span data-ttu-id="c3217-122">Устройство также может:</span><span class="sxs-lookup"><span data-stu-id="c3217-122">A device can also choose to:</span></span>

* <span data-ttu-id="c3217-123">*отклонить* сообщение, в результате чего центр IoT переводит его в состояние **Deadlettered** (Не доставлено);</span><span class="sxs-lookup"><span data-stu-id="c3217-123">*Reject* the message, which causes IoT Hub to set it to the **Deadlettered** state.</span></span> <span data-ttu-id="c3217-124">Устройства, подключаемые по протоколу MQTT, не могут отклонять сообщения, передаваемые из облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="c3217-124">Devices that connect over the MQTT protocol cannot reject cloud-to-device messages.</span></span>
* <span data-ttu-id="c3217-125">*прервать* сообщение, в результате чего центр IoT помещает его в очередь с состоянием **Enqueued**(Поставлено в очередь).</span><span class="sxs-lookup"><span data-stu-id="c3217-125">*Abandon* the message, which causes IoT Hub to put the message back in the queue, with the state set to **Enqueued**.</span></span>

<span data-ttu-id="c3217-126">При обработке сообщения потоком может произойти ошибка без уведомления центра IoT.</span><span class="sxs-lookup"><span data-stu-id="c3217-126">A thread could fail to process a message without notifying IoT Hub.</span></span> <span data-ttu-id="c3217-127">В этом случае состояние сообщения автоматически меняется с **Невидимо** на **Enqueued** (Поставлено в очередь) после *истечения срока видимости (или блокировки)*.</span><span class="sxs-lookup"><span data-stu-id="c3217-127">In this case, messages automatically transition from the **Invisible** state back to the **Enqueued** state after a *visibility (or lock) timeout*.</span></span> <span data-ttu-id="c3217-128">Значение по умолчанию — одна минута.</span><span class="sxs-lookup"><span data-stu-id="c3217-128">The default value of this timeout is one minute.</span></span>

<span data-ttu-id="c3217-129">Состояние сообщения может изменяться с **Enqueued** (Поставлено в очередь) на **Невидимо** и наоборот столько раз, сколько указано в свойстве **Максимальное число доставок** Центра Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="c3217-129">A message can transition between the **Enqueued** and **Invisible** states for, at most, the number of times specified in the **max delivery count** property on IoT Hub.</span></span> <span data-ttu-id="c3217-130">После выполнения такого количества изменений Центр Интернета вещей устанавливает для сообщения состояние **Deadlettered** (Не доставлено).</span><span class="sxs-lookup"><span data-stu-id="c3217-130">After that number of transitions, IoT Hub sets the state of the message to **Deadlettered**.</span></span> <span data-ttu-id="c3217-131">Таким же образом Центр Интернета вещей устанавливает для сообщения состояние **Deadlettered** (Не доставлено) после истечения срока действия сообщения (см. раздел [Срок действия сообщения (срок жизни)][lnk-ttl]).</span><span class="sxs-lookup"><span data-stu-id="c3217-131">Similarly, IoT Hub sets the state of a message to **Deadlettered** after its expiration time (see [Time to live][lnk-ttl]).</span></span>

<span data-ttu-id="c3217-132">В руководстве [Отправка сообщений из облака на устройство с помощью Центра Интернета вещей][lnk-c2d-tutorial] демонстрируется отправка сообщений "из облака на устройство" из облака и их получение на устройстве.</span><span class="sxs-lookup"><span data-stu-id="c3217-132">The [How to send cloud-to-device messages with IoT Hub][lnk-c2d-tutorial] shows you how to send cloud-to-device messages from the cloud and receive them on a device.</span></span>

<span data-ttu-id="c3217-133">Обычно, если потеря сообщения, отправляемого с облака в устройство, никак не влияет на логику приложения, это сообщение завершается устройством.</span><span class="sxs-lookup"><span data-stu-id="c3217-133">Typically, a device completes a cloud-to-device message when the loss of the message does not affect the application logic.</span></span> <span data-ttu-id="c3217-134">Например, если устройство сохраняет содержимое сообщения локально или успешно выполняет операцию.</span><span class="sxs-lookup"><span data-stu-id="c3217-134">For example, when the device has persisted the message content locally or has successfully executed an operation.</span></span> <span data-ttu-id="c3217-135">Сообщение может также содержать временные сведения, потеря которых не влияет на функциональность приложения.</span><span class="sxs-lookup"><span data-stu-id="c3217-135">The message could also carry transient information, whose loss would not impact the functionality of the application.</span></span> <span data-ttu-id="c3217-136">Иногда при работе с долгосрочной задачей сообщение, отправляемое с облака в устройство, можно завершить после того, как описание задачи сохранится в локальном хранилище.</span><span class="sxs-lookup"><span data-stu-id="c3217-136">Sometimes, for long-running tasks, you can complete the cloud-to-device message after persisting the task description in local storage.</span></span> <span data-ttu-id="c3217-137">После этого на различных этапах выполнения задачи в серверную часть решения отправляется одно или несколько сообщений (с устройства в облако).</span><span class="sxs-lookup"><span data-stu-id="c3217-137">Then you can notify the solution back end with one or more device-to-cloud messages at various stages of progress of the task.</span></span>

## <a name="message-expiration-time-to-live"></a><span data-ttu-id="c3217-138">Срок действия сообщения (срок жизни)</span><span class="sxs-lookup"><span data-stu-id="c3217-138">Message expiration (time to live)</span></span>

<span data-ttu-id="c3217-139">Каждое сообщение из облака на устройство имеет срок действия.</span><span class="sxs-lookup"><span data-stu-id="c3217-139">Every cloud-to-device message has an expiration time.</span></span> <span data-ttu-id="c3217-140">Его может задавать служба (в свойстве **ExpiryTimeUtc**) или Центр Интернета вещей, в котором задан *срок жизни* по умолчанию, указанный в соответствующем свойстве Центра Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="c3217-140">This time is set either by the service (in the **ExpiryTimeUtc** property), or by IoT Hub using the default *time to live* specified as an IoT Hub property.</span></span> <span data-ttu-id="c3217-141">Ознакомьтесь с разделом [Параметры конфигурации сообщений, отправляемых из облака на устройство][lnk-c2d-configuration].</span><span class="sxs-lookup"><span data-stu-id="c3217-141">See [Cloud-to-device configuration options][lnk-c2d-configuration].</span></span>

<span data-ttu-id="c3217-142">Распространенный способ воспользоваться сроком действия, чтобы сообщения не отправлялись на отключенные устройства — задать короткий срок жизни.</span><span class="sxs-lookup"><span data-stu-id="c3217-142">A common way to take advantage of message expiration and avoid sending messages to disconnected devices, is to set short time to live values.</span></span> <span data-ttu-id="c3217-143">Этот подход позволяет добиться того же результата, что и поддержание состояния подключения устройства, но при этом обладает большей эффективностью.</span><span class="sxs-lookup"><span data-stu-id="c3217-143">This approach achieves the same result as maintaining the device connection state, while being more efficient.</span></span> <span data-ttu-id="c3217-144">При запросе подтверждения сообщений Центр Интернета вещей сообщает о том, какие устройства могут получать сообщения, а какие находятся в автономном режиме или в состоянии сбоя.</span><span class="sxs-lookup"><span data-stu-id="c3217-144">When you request message acknowledgements, IoT Hub notifies you which devices are able to receive messages, and which devices are not online or have failed.</span></span>

## <a name="message-feedback"></a><span data-ttu-id="c3217-145">Отзыв на сообщение</span><span class="sxs-lookup"><span data-stu-id="c3217-145">Message feedback</span></span>

<span data-ttu-id="c3217-146">При отправке сообщений с облака в устройство служба может запросить отзыв на каждое сообщение, уведомляющий о его конечном состоянии.</span><span class="sxs-lookup"><span data-stu-id="c3217-146">When you send a cloud-to-device message, the service can request the delivery of per-message feedback regarding the final state of that message.</span></span>

| <span data-ttu-id="c3217-147">Свойство Ack</span><span class="sxs-lookup"><span data-stu-id="c3217-147">Ack property</span></span> | <span data-ttu-id="c3217-148">Поведение</span><span class="sxs-lookup"><span data-stu-id="c3217-148">Behavior</span></span> |
| ------------ | -------- |
| <span data-ttu-id="c3217-149">**positive**</span><span class="sxs-lookup"><span data-stu-id="c3217-149">**positive**</span></span> | <span data-ttu-id="c3217-150">Центр Интернета вещей создает отзыв на сообщение, только если сообщение, отправляемое из облака на устройство, достигает состояния **Completed** (Завершено).</span><span class="sxs-lookup"><span data-stu-id="c3217-150">IoT Hub generates a feedback message if, and only if, the cloud-to-device message reached the **Completed** state.</span></span> |
| <span data-ttu-id="c3217-151">**negative**</span><span class="sxs-lookup"><span data-stu-id="c3217-151">**negative**</span></span> | <span data-ttu-id="c3217-152">Центр Интернета вещей создает отзыв на сообщение, только если сообщение, отправляемое из облака на устройство, достигает состояния **Deadlettered** (Не доставлено).</span><span class="sxs-lookup"><span data-stu-id="c3217-152">IoT Hub generates a feedback message, if and only if, the cloud-to-device message reaches the **Deadlettered** state.</span></span> |
| <span data-ttu-id="c3217-153">**full**</span><span class="sxs-lookup"><span data-stu-id="c3217-153">**full**</span></span>     | <span data-ttu-id="c3217-154">Центр Интернета вещей создает отзыв на сообщение в любом случае.</span><span class="sxs-lookup"><span data-stu-id="c3217-154">IoT Hub generates a feedback message in either case.</span></span> |

<span data-ttu-id="c3217-155">Если свойство **Ack** имеет значение **full** и отзыв не получен, то это означает, что срок действия отзыва истек.</span><span class="sxs-lookup"><span data-stu-id="c3217-155">If **Ack** is **full**, and you don't receive a feedback message, it means that the feedback message expired.</span></span> <span data-ttu-id="c3217-156">Служба не знает, что случилось с исходным сообщением.</span><span class="sxs-lookup"><span data-stu-id="c3217-156">The service can't know what happened to the original message.</span></span> <span data-ttu-id="c3217-157">На практике служба должна убедиться, что может обработать отзыв до истечения срока его действия.</span><span class="sxs-lookup"><span data-stu-id="c3217-157">In practice, a service should ensure that it can process the feedback before it expires.</span></span> <span data-ttu-id="c3217-158">Максимальный срок действия составляет два дня, и этого времени достаточно для повторного запуска службы при сбое.</span><span class="sxs-lookup"><span data-stu-id="c3217-158">The maximum expiry time is two days, which allows plenty of time to get the service running again if a failure occurs.</span></span>

<span data-ttu-id="c3217-159">Как описано в статье [Endpoints][lnk-endpoints] (Конечные точки), Центр Интернета вещей предоставляет отзывы в виде сообщений через конечную точку, доступную для службы (**/messages/servicebound/feedback**).</span><span class="sxs-lookup"><span data-stu-id="c3217-159">As explained in [Endpoints][lnk-endpoints], IoT Hub delivers feedback through a service-facing endpoint (**/messages/servicebound/feedback**) as messages.</span></span> <span data-ttu-id="c3217-160">Семантика получения отзыва идентична семантике, используемой для сообщений, отправляемых из облака на устройство, с тем же [жизненным циклом сообщения][lnk-lifecycle].</span><span class="sxs-lookup"><span data-stu-id="c3217-160">The semantics for receiving feedback are the same as for cloud-to-device messages, and have the same [Message lifecycle][lnk-lifecycle].</span></span> <span data-ttu-id="c3217-161">По возможности отзывы на сообщения группируются в одно сообщение, имеющее приведенный ниже формат:</span><span class="sxs-lookup"><span data-stu-id="c3217-161">Whenever possible, message feedback is batched in a single message, with the following format:</span></span>

| <span data-ttu-id="c3217-162">Свойство</span><span class="sxs-lookup"><span data-stu-id="c3217-162">Property</span></span>     | <span data-ttu-id="c3217-163">Описание</span><span class="sxs-lookup"><span data-stu-id="c3217-163">Description</span></span> |
| ------------ | ----------- |
| <span data-ttu-id="c3217-164">EnqueuedTime</span><span class="sxs-lookup"><span data-stu-id="c3217-164">EnqueuedTime</span></span> | <span data-ttu-id="c3217-165">Метка времени, указывающая, когда было создано сообщение.</span><span class="sxs-lookup"><span data-stu-id="c3217-165">Timestamp indicating when the message was created.</span></span> |
| <span data-ttu-id="c3217-166">UserId</span><span class="sxs-lookup"><span data-stu-id="c3217-166">UserId</span></span>       | `{iot hub name}` |
| <span data-ttu-id="c3217-167">ContentType</span><span class="sxs-lookup"><span data-stu-id="c3217-167">ContentType</span></span>  | `application/vnd.microsoft.iothub.feedback.json` |

<span data-ttu-id="c3217-168">Основная часть — это сериализованный массив записей JSON, каждая из которых имеет следующие свойства:</span><span class="sxs-lookup"><span data-stu-id="c3217-168">The body is a JSON-serialized array of records, each with the following properties:</span></span>

| <span data-ttu-id="c3217-169">Свойство</span><span class="sxs-lookup"><span data-stu-id="c3217-169">Property</span></span>           | <span data-ttu-id="c3217-170">Описание</span><span class="sxs-lookup"><span data-stu-id="c3217-170">Description</span></span> |
| ------------------ | ----------- |
| <span data-ttu-id="c3217-171">EnqueuedTimeUtc</span><span class="sxs-lookup"><span data-stu-id="c3217-171">EnqueuedTimeUtc</span></span>    | <span data-ttu-id="c3217-172">Метка времени, указывающая, когда отобразился результат сообщения.</span><span class="sxs-lookup"><span data-stu-id="c3217-172">Timestamp indicating when the outcome of the message happened.</span></span> <span data-ttu-id="c3217-173">Например, устройство завершило его или истек срок его действия.</span><span class="sxs-lookup"><span data-stu-id="c3217-173">For example, the device completed or the message expired.</span></span> |
| <span data-ttu-id="c3217-174">OriginalMessageId</span><span class="sxs-lookup"><span data-stu-id="c3217-174">OriginalMessageId</span></span>  | <span data-ttu-id="c3217-175">Идентификатор **MessageId** сообщения, которое отправляется из облака на устройство и к которому относятся эти сведения отзыва.</span><span class="sxs-lookup"><span data-stu-id="c3217-175">**MessageId** of the cloud-to-device message to which this feedback information relates.</span></span> |
| <span data-ttu-id="c3217-176">StatusCode</span><span class="sxs-lookup"><span data-stu-id="c3217-176">StatusCode</span></span>         | <span data-ttu-id="c3217-177">Обязательная строка.</span><span class="sxs-lookup"><span data-stu-id="c3217-177">Required string.</span></span> <span data-ttu-id="c3217-178">Используется в отзывах, созданных центром IoT.</span><span class="sxs-lookup"><span data-stu-id="c3217-178">Used in feedback messages generated by IoT Hub.</span></span> <br/> <span data-ttu-id="c3217-179">'Success'</span><span class="sxs-lookup"><span data-stu-id="c3217-179">'Success'</span></span> <br/> <span data-ttu-id="c3217-180">'Expired'</span><span class="sxs-lookup"><span data-stu-id="c3217-180">'Expired'</span></span> <br/> <span data-ttu-id="c3217-181">'DeliveryCountExceeded'</span><span class="sxs-lookup"><span data-stu-id="c3217-181">'DeliveryCountExceeded'</span></span> <br/> <span data-ttu-id="c3217-182">'Rejected'</span><span class="sxs-lookup"><span data-stu-id="c3217-182">'Rejected'</span></span> <br/> <span data-ttu-id="c3217-183">'Purged'</span><span class="sxs-lookup"><span data-stu-id="c3217-183">'Purged'</span></span> |
| <span data-ttu-id="c3217-184">Описание</span><span class="sxs-lookup"><span data-stu-id="c3217-184">Description</span></span>        | <span data-ttu-id="c3217-185">Строковые значения **StatusCode**.</span><span class="sxs-lookup"><span data-stu-id="c3217-185">String values for **StatusCode**.</span></span> |
| <span data-ttu-id="c3217-186">deviceId</span><span class="sxs-lookup"><span data-stu-id="c3217-186">DeviceId</span></span>           | <span data-ttu-id="c3217-187">Идентификатор **DeviceId** целевого устройства, которому отправляется сообщение из облака и к которому относится этот отзыв.</span><span class="sxs-lookup"><span data-stu-id="c3217-187">**DeviceId** of the target device of the cloud-to-device message to which this piece of feedback relates.</span></span> |
| <span data-ttu-id="c3217-188">DeviceGenerationId</span><span class="sxs-lookup"><span data-stu-id="c3217-188">DeviceGenerationId</span></span> | <span data-ttu-id="c3217-189">Идентификатор **DeviceGenerationId** целевого устройства, которому отправляется сообщение из облака и к которому относится этот отзыв.</span><span class="sxs-lookup"><span data-stu-id="c3217-189">**DeviceGenerationId** of the target device of the cloud-to-device message to which this piece of feedback relates.</span></span> |

<span data-ttu-id="c3217-190">Служба должна указать идентификатор **MessageId** для сообщения, отправляемого из облака на устройство, чтобы соотнести свой отзыв с исходным сообщением.</span><span class="sxs-lookup"><span data-stu-id="c3217-190">The service must specify a **MessageId** for the cloud-to-device message to be able to correlate its feedback with the original message.</span></span>

<span data-ttu-id="c3217-191">Ниже приведен пример текста сообщения отзыва.</span><span class="sxs-lookup"><span data-stu-id="c3217-191">The following example shows the body of a feedback message.</span></span>

```json
[
  {
    "OriginalMessageId": "0987654321",
    "EnqueuedTimeUtc": "2015-07-28T16:24:48.789Z",
    "StatusCode": 0,
    "Description": "Success",
    "DeviceId": "123",
    "DeviceGenerationId": "abcdefghijklmnopqrstuvwxyz"
  },
  {
    ...
  },
  ...
]
```

## <a name="cloud-to-device-configuration-options"></a><span data-ttu-id="c3217-192">Параметры конфигурации сообщений, отправляемых из облака на устройство</span><span class="sxs-lookup"><span data-stu-id="c3217-192">Cloud-to-device configuration options</span></span>

<span data-ttu-id="c3217-193">Каждый Центр Интернета вещей предоставляет следующие параметры конфигурации для отправки сообщений из облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="c3217-193">Each IoT hub exposes the following configuration options for cloud-to-device messaging:</span></span>

| <span data-ttu-id="c3217-194">Свойство</span><span class="sxs-lookup"><span data-stu-id="c3217-194">Property</span></span>                  | <span data-ttu-id="c3217-195">Описание</span><span class="sxs-lookup"><span data-stu-id="c3217-195">Description</span></span> | <span data-ttu-id="c3217-196">Диапазон и значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="c3217-196">Range and default</span></span> |
| ------------------------- | ----------- | ----------------- |
| <span data-ttu-id="c3217-197">defaultTtlAsIso8601</span><span class="sxs-lookup"><span data-stu-id="c3217-197">defaultTtlAsIso8601</span></span>       | <span data-ttu-id="c3217-198">Заданный по умолчанию срок жизни для сообщений, отправляемых из облака на устройство.</span><span class="sxs-lookup"><span data-stu-id="c3217-198">Default TTL for cloud-to-device messages.</span></span> | <span data-ttu-id="c3217-199">Интервал ISO_8601 — до 2 устройств (минимум 1 минута).</span><span class="sxs-lookup"><span data-stu-id="c3217-199">ISO_8601 interval up to 2D (minimum 1 minute).</span></span> <span data-ttu-id="c3217-200">Значение по умолчанию — 1 час.</span><span class="sxs-lookup"><span data-stu-id="c3217-200">Default: 1 hour.</span></span> |
| <span data-ttu-id="c3217-201">maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="c3217-201">maxDeliveryCount</span></span>          | <span data-ttu-id="c3217-202">Лимит доставки для очереди доставки сообщений, отправляемых из облака на устройство, для каждого отдельного устройства.</span><span class="sxs-lookup"><span data-stu-id="c3217-202">Maximum delivery count for cloud-to-device per-device queues.</span></span> | <span data-ttu-id="c3217-203">От 1 до 100.</span><span class="sxs-lookup"><span data-stu-id="c3217-203">1 to 100.</span></span> <span data-ttu-id="c3217-204">Значение по умолчанию — 10.</span><span class="sxs-lookup"><span data-stu-id="c3217-204">Default: 10.</span></span> |
| <span data-ttu-id="c3217-205">feedback.ttlAsIso8601</span><span class="sxs-lookup"><span data-stu-id="c3217-205">feedback.ttlAsIso8601</span></span>     | <span data-ttu-id="c3217-206">Хранение отзывов, направленных службе.</span><span class="sxs-lookup"><span data-stu-id="c3217-206">Retention for service-bound feedback messages.</span></span> | <span data-ttu-id="c3217-207">Интервал ISO_8601 — до 2 устройств (минимум 1 минута).</span><span class="sxs-lookup"><span data-stu-id="c3217-207">ISO_8601 interval up to 2D (minimum 1 minute).</span></span> <span data-ttu-id="c3217-208">Значение по умолчанию — 1 час.</span><span class="sxs-lookup"><span data-stu-id="c3217-208">Default: 1 hour.</span></span> |
| <span data-ttu-id="c3217-209">feedback.maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="c3217-209">feedback.maxDeliveryCount</span></span> |<span data-ttu-id="c3217-210">Лимит доставок для очереди отзывов.</span><span class="sxs-lookup"><span data-stu-id="c3217-210">Maximum delivery count for feedback queue.</span></span> | <span data-ttu-id="c3217-211">От 1 до 100.</span><span class="sxs-lookup"><span data-stu-id="c3217-211">1 to 100.</span></span> <span data-ttu-id="c3217-212">Значение по умолчанию — 100.</span><span class="sxs-lookup"><span data-stu-id="c3217-212">Default: 100.</span></span> |

<span data-ttu-id="c3217-213">Дополнительные сведения о настройке этих параметров конфигурации см. в статье [Создание Центра Интернета вещей][lnk-portal].</span><span class="sxs-lookup"><span data-stu-id="c3217-213">For more information about how to set these configuration options, see [Create IoT hubs][lnk-portal].</span></span>

## <a name="next-steps"></a><span data-ttu-id="c3217-214">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c3217-214">Next steps</span></span>

<span data-ttu-id="c3217-215">Дополнительные сведения о пакетах SDK, которые можно использовать для приема сообщений, отправляемых с устройства в облако, см. в статье, посвященной [пакетам SDK для Azure IoT][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="c3217-215">For information about the SDKs you can use to receive cloud-to-device messages, see [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="c3217-216">Инструкции по настройке получения сообщений, передаваемых из облака на устройство, см. в статье, посвященной [отправке сообщений из облака на устройство][lnk-c2d-tutorial].</span><span class="sxs-lookup"><span data-stu-id="c3217-216">To try out receiving cloud-to-device messages, see the [Send cloud-to-device][lnk-c2d-tutorial] tutorial.</span></span>

[img-lifecycle]: ./media/iot-hub-devguide-messages-c2d/lifecycle.png

[lnk-portal]: iot-hub-create-through-portal.md
[lnk-c2d-guidance]: iot-hub-devguide-c2d-guidance.md
[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-ttl]: #message-expiration-time-to-live
[lnk-c2d-configuration]: #cloud-to-device-configuration-options
[lnk-lifecycle]: #message-lifecycle
[lnk-c2d-tutorial]: iot-hub-csharp-csharp-c2d.md
