---
title: "aaaAzure связи центра IoT протоколы и порты | Документы Microsoft"
description: "Руководство разработчика по - описание hello поддерживается протоколы связи для связи устройства в облако и облака на устройство и hello номера портов, которые должны быть открыты."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 3fc5f1a3-3711-4611-9897-d4db079b4250
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: dobett
ms.openlocfilehash: 31cb948f1d30edd87edb13ad0dd859c02bcc3239
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# Справочник — выбор протокола связи

Центр IoT позволяет устройств toouse [MQTT][lnk-mqtt], MQTT через WebSockets, [AMQP][lnk-amqp], протоколы AMQP через WebSockets и HTTP для устройства для обмена информацией. Сведения о поддержке протоколов, используемых компонентами Центра Интернета вещей, см. в [руководстве по обмену данными между устройством и облаком][lnk-d2c-guidance] и [руководстве по обмену данными между облаком и устройством][lnk-c2d-guidance].

Hello следующей таблице приведены общие рекомендации по вашему выбору протокола hello.

| Протокол | Когда следует выбрать этот протокол |
| --- | --- |
| MQTT <br> MQTT через WebSocket |Использовать на всех устройствах, которые не требуют tooconnect несколько устройств (на каждом из которых свои собственные учетные данные на устройство) через hello же TLS-подключение. |
| AMQP <br> AMQP через WebSocket |Используйте поле и облака шлюзы tootake преимуществами подключения мультиплексирование на устройствах. |
| HTTP |Используйте для устройств, которые не поддерживают другие протоколы. |

Примите во внимание следующие точки, при выборе протокол для обмена данными стороне устройства hello.

* **Шаблон сообщения из облака на устройство**. HTTP не поддерживает push server tooimplement эффективным способом. Таким образом, при использовании протокола HTTP устройства опрашивают Центр Интернета вещей на предмет наличия сообщений из облака на устройство. Этот подход неэффективен для устройства hello и центр IoT. Согласно текущим рекомендациям для протокола HTTP каждое устройство должно выполнять опрос не реже, чем раз в 25 минут. На Здравствуйте другой стороны, MQTT и AMQP поддерживают принудительной сервера при получении сообщений облака на устройство. Они позволяют немедленно отправок сообщения с устройства toohello центр IoT. Задержка доставки является серьезной проблемой, MQTT или AMQP являются наиболее toouse протоколы hello. Для редко подключаемых устройств также подходит протокол HTTP.
* **Шлюзы поля**. При использовании MQTT и HTTP, при подключении нескольких устройств (на каждом из которых свои собственные учетные данные на устройство) с помощью того же TLS-подключение "hello". Таким образом, для [поле сценарии использования шлюза][lnk-azure-gateway-guidance], эти протоколы неоптимальных, так как они требуют одно TLS подключение между шлюзом поле hello и центр IoT для всех шлюзов, поле toohello подключенных устройств.
* **Устройства с небольшим количеством ресурсов**. Hello MQTT и библиотек HTTP имеют меньше памяти, чем hello AMQP библиотеки. Таким образом, если hello устройство имеет ограниченные ресурсы (например, меньше 1 МБ ОЗУ), эти протоколы можно hello только реализация протокола доступны.
* **Обход сети**. стандартный протокол AMQP Hello использует порт 5671, а MQTT прослушивает порт 8883, могут вызвать проблемы в сети, которые находятся закрытые toonon протоколы. MQTT через WebSockets AMQP через WebSockets и HTTP, доступные toobe, используемая в этом сценарии.
* **Объем полезных данных**. MQTT и AMQP — это двоичные протоколы, позволяющие передавать более компактные полезные данные, чем HTTP.

> [!WARNING]
> При использовании протокола HTTP каждое устройство должно проверять наличие сообщений, передаваемых из облака на устройство, не реже, чем раз в 25 минут. Однако во время разработки, это допустимые toopoll чаще, чем каждые 25 минут.

## Номера портов

Устройства могут взаимодействовать с центром IoT в Azure с использованием различных протоколов. Как правило hello Выбор протокола передачи определяется hello особенностей hello решения. Hello следующей таблице перечислены hello исходящие порты, которые должны быть открыты для возможности toouse каталога toobe устройства определенного протокола.

| Протокол | Порт |
| --- | --- |
| MQTT |8883 |
| MQTT через WebSocket |443 |
| AMQP |5671 |
| AMQP через WebSocket |443 |
| HTTP |443 |

После создания центра IoT в регионе Azure hello сохраняет концентратора IoT hello же IP-адрес для hello время существования этого центра IoT. Тем не менее toomaintain качество обслуживания, если перемещается Microsoft hello IoT hub tooa другую шкалу единицы, то он назначается новый IP-адрес.


## Дальнейшие действия

в разделе toolearn Дополнительные сведения о том, как центр IoT реализует протокол MQTT hello, [общаться с вашего центра IoT, с помощью протокола hello MQTT][lnk-mqtt-support].

[lnk-d2c-guidance]: iot-hub-devguide-d2c-guidance.md
[lnk-c2d-guidance]: iot-hub-devguide-c2d-guidance.md
[lnk-mqtt-support]: iot-hub-mqtt-support.md
[lnk-amqp]: http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-complete-v1.0-os.pdf
[lnk-mqtt]: http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/mqtt-v3.1.1.pdf
[lnk-azure-gateway-guidance]: iot-hub-devguide-endpoints.md#field-gateways
