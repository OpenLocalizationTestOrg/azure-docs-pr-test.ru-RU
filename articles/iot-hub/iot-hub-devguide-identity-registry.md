---
title: "Общие сведения о реестре удостоверений Центра Интернета вещей Azure | Документация Майкрософт"
description: "Руководство разработчика. Описание реестра удостоверений Центра Интернета вещей, а также сведения о том, как с его помощью управлять своими устройствами. Содержит сведения об импорте и экспорте удостоверений устройств в пакетном режиме."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 0706eccd-e84c-4ae7-bbd4-2b1a22241147
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/08/2017
ms.author: dobett
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: b6e9c7b71fa6fc78f97c0144c735fc44778181d8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="understand-the-identity-registry-in-your-iot-hub"></a><span data-ttu-id="6aed3-104">Общие сведения о реестре удостоверений в Центре Интернета вещей</span><span class="sxs-lookup"><span data-stu-id="6aed3-104">Understand the identity registry in your IoT hub</span></span>

<span data-ttu-id="6aed3-105">В каждом Центре Интернета вещей есть реестр удостоверений, в котором содержатся сведения об устройствах, имеющих разрешение на подключение к Центру Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-105">Every IoT hub has an identity registry that stores information about the devices permitted to connect to the IoT hub.</span></span> <span data-ttu-id="6aed3-106">Перед подключением устройства к Центру Интернета вещей в реестр удостоверений нужно добавить запись об этом устройстве.</span><span class="sxs-lookup"><span data-stu-id="6aed3-106">Before a device can connect to an IoT hub, there must be an entry for that device in the IoT hub's identity registry.</span></span> <span data-ttu-id="6aed3-107">Устройство также должно пройти аутентификацию в Центре Интернета вещей на основе учетных данных, хранящихся в реестре удостоверений.</span><span class="sxs-lookup"><span data-stu-id="6aed3-107">A device must also authenticate with the IoT hub based on credentials stored in the identity registry.</span></span>

<span data-ttu-id="6aed3-108">В идентификаторе устройства, хранящемся в реестре удостоверений, учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="6aed3-108">The device ID stored in the identity registry is case-sensitive.</span></span>

<span data-ttu-id="6aed3-109">На высоком уровне реестр удостоверений является коллекцией с поддержкой REST, состоящей из ресурсов удостоверений устройств.</span><span class="sxs-lookup"><span data-stu-id="6aed3-109">At a high level, the identity registry is a REST-capable collection of device identity resources.</span></span> <span data-ttu-id="6aed3-110">Добавляя записи в реестр удостоверений, Центр Интернета вещей создает уникальные ресурсы устройства (например, очередь с сообщениями, отправленными из облака на устройство).</span><span class="sxs-lookup"><span data-stu-id="6aed3-110">When you add an entry in the identity registry, IoT Hub creates a set of per-device resources such as the queue that contains in-flight cloud-to-device messages.</span></span>

### <a name="when-to-use"></a><span data-ttu-id="6aed3-111">Сценарии использования</span><span class="sxs-lookup"><span data-stu-id="6aed3-111">When to use</span></span>

<span data-ttu-id="6aed3-112">Используйте реестр удостоверений для выполнения следующих действий:</span><span class="sxs-lookup"><span data-stu-id="6aed3-112">Use the identity registry when you need to:</span></span>

* <span data-ttu-id="6aed3-113">подготовка устройств, подключаемых к Центру Интернета вещей;</span><span class="sxs-lookup"><span data-stu-id="6aed3-113">Provision devices that connect to your IoT hub.</span></span>
* <span data-ttu-id="6aed3-114">управление доступом устройств к конечным точкам центра, доступным с устройства.</span><span class="sxs-lookup"><span data-stu-id="6aed3-114">Control per-device access to your hub's device-facing endpoints.</span></span>

> [!NOTE]
> <span data-ttu-id="6aed3-115">Реестр удостоверений не содержит метаданные конкретного приложения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-115">The identity registry does not contain any application-specific metadata.</span></span>

## <a name="identity-registry-operations"></a><span data-ttu-id="6aed3-116">операции с реестром удостоверений.</span><span class="sxs-lookup"><span data-stu-id="6aed3-116">Identity registry operations</span></span>

<span data-ttu-id="6aed3-117">Реестр удостоверений Центра Интернета вещей поддерживает такие операции:</span><span class="sxs-lookup"><span data-stu-id="6aed3-117">The IoT Hub identity registry exposes the following operations:</span></span>

* <span data-ttu-id="6aed3-118">создание удостоверения устройства;</span><span class="sxs-lookup"><span data-stu-id="6aed3-118">Create device identity</span></span>
* <span data-ttu-id="6aed3-119">обновление удостоверения устройства;</span><span class="sxs-lookup"><span data-stu-id="6aed3-119">Update device identity</span></span>
* <span data-ttu-id="6aed3-120">получение удостоверения устройства по идентификатору;</span><span class="sxs-lookup"><span data-stu-id="6aed3-120">Retrieve device identity by ID</span></span>
* <span data-ttu-id="6aed3-121">удаление удостоверения устройства;</span><span class="sxs-lookup"><span data-stu-id="6aed3-121">Delete device identity</span></span>
* <span data-ttu-id="6aed3-122">отображение списка, содержащего до 1000 удостоверений;</span><span class="sxs-lookup"><span data-stu-id="6aed3-122">List up to 1000 identities</span></span>
* <span data-ttu-id="6aed3-123">экспорт всех удостоверений в хранилище BLOB-объектов Azure;</span><span class="sxs-lookup"><span data-stu-id="6aed3-123">Export all identities to Azure blob storage</span></span>
* <span data-ttu-id="6aed3-124">импорт всех удостоверений из хранилища BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="6aed3-124">Import identities from Azure blob storage</span></span>

<span data-ttu-id="6aed3-125">Все эти операции могут использовать оптимистичный параллелизм (согласно [RFC7232][lnk-rfc7232]).</span><span class="sxs-lookup"><span data-stu-id="6aed3-125">All these operations can use optimistic concurrency, as specified in [RFC7232][lnk-rfc7232].</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6aed3-126">Единственный способ получить все удостоверения, которые содержит реестр удостоверений Центра Интернета вещей, — использовать функцию [Экспорт][lnk-export].</span><span class="sxs-lookup"><span data-stu-id="6aed3-126">The only way to retrieve all identities in an IoT hub's identity registry is to use the [Export][lnk-export] functionality.</span></span>

<span data-ttu-id="6aed3-127">Реестр удостоверений Центра Интернета вещей:</span><span class="sxs-lookup"><span data-stu-id="6aed3-127">An IoT Hub identity registry:</span></span>

* <span data-ttu-id="6aed3-128">не содержит метаданные приложения;</span><span class="sxs-lookup"><span data-stu-id="6aed3-128">Does not contain any application metadata.</span></span>
* <span data-ttu-id="6aed3-129">доступен как словарь (в качестве ключа используется свойство **deviceId** );</span><span class="sxs-lookup"><span data-stu-id="6aed3-129">Can be accessed like a dictionary, by using the **deviceId** as the key.</span></span>
* <span data-ttu-id="6aed3-130">не поддерживает выразительные запросы.</span><span class="sxs-lookup"><span data-stu-id="6aed3-130">Does not support expressive queries.</span></span>

<span data-ttu-id="6aed3-131">Решение IoT обычно включает в себя отдельное хранилище, содержащее метаданные приложений.</span><span class="sxs-lookup"><span data-stu-id="6aed3-131">An IoT solution typically has a separate solution-specific store that contains application-specific metadata.</span></span> <span data-ttu-id="6aed3-132">Например, в хранилище решения для интеллектуального здания будут записываться данные о комнате, где установлен датчик температуры.</span><span class="sxs-lookup"><span data-stu-id="6aed3-132">For example, the solution-specific store in a smart building solution would record the room in which a temperature sensor is deployed.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6aed3-133">Реестр удостоверений следует использовать только для управления устройствами и операций подготовки.</span><span class="sxs-lookup"><span data-stu-id="6aed3-133">Only use the identity registry for device management and provisioning operations.</span></span> <span data-ttu-id="6aed3-134">Выполнение операций в реестре удостоверений не должно влиять на пропускную способность операций в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-134">High throughput operations at run time should not depend on performing operations in the identity registry.</span></span> <span data-ttu-id="6aed3-135">Например, проверка состояния подключения устройства перед отправкой команды не является поддерживаемым шаблоном.</span><span class="sxs-lookup"><span data-stu-id="6aed3-135">For example, checking the connection state of a device before sending a command is not a supported pattern.</span></span> <span data-ttu-id="6aed3-136">Проверьте [уровни регулирования][lnk-quotas] реестра удостоверений и шаблон [пульса устройств][lnk-guidance-heartbeat].</span><span class="sxs-lookup"><span data-stu-id="6aed3-136">Make sure to check the [throttling rates][lnk-quotas] for the identity registry, and the [device heartbeat][lnk-guidance-heartbeat] pattern.</span></span>

## <a name="disable-devices"></a><span data-ttu-id="6aed3-137">Отключение устройств</span><span class="sxs-lookup"><span data-stu-id="6aed3-137">Disable devices</span></span>

<span data-ttu-id="6aed3-138">Чтобы отключить устройства, обновите в реестре свойство **status** удостоверения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-138">You can disable devices by updating the **status** property of an identity in the identity registry.</span></span> <span data-ttu-id="6aed3-139">Обычно это свойство используется в двух сценариях.</span><span class="sxs-lookup"><span data-stu-id="6aed3-139">Typically, you use this property in two scenarios:</span></span>

* <span data-ttu-id="6aed3-140">В процессе оркестрации подготовки.</span><span class="sxs-lookup"><span data-stu-id="6aed3-140">During a provisioning orchestration process.</span></span> <span data-ttu-id="6aed3-141">Дополнительные сведения см. в разделе [Подготовка устройств][lnk-guidance-provisioning].</span><span class="sxs-lookup"><span data-stu-id="6aed3-141">For more information, see [Device Provisioning][lnk-guidance-provisioning].</span></span>
* <span data-ttu-id="6aed3-142">Если по какой-либо причине вы решите, что безопасность устройства нарушена или оно является неавторизованным.</span><span class="sxs-lookup"><span data-stu-id="6aed3-142">If, for any reason, you consider a device is compromised or has become unauthorized.</span></span>

## <a name="import-and-export-device-identities"></a><span data-ttu-id="6aed3-143">Импорт и экспорт удостоверений устройств</span><span class="sxs-lookup"><span data-stu-id="6aed3-143">Import and export device identities</span></span>

<span data-ttu-id="6aed3-144">Можно выполнить массовый экспорт удостоверений устройств из реестра удостоверений Центра Интернета вещей, используя асинхронные операции в [конечной точке поставщика ресурсов Центра Интернета вещей][lnk-endpoints].</span><span class="sxs-lookup"><span data-stu-id="6aed3-144">You can export device identities in bulk from an IoT hub's identity registry, by using asynchronous operations on the [IoT Hub resource provider endpoint][lnk-endpoints].</span></span> <span data-ttu-id="6aed3-145">Экспорт — это долгосрочное задание, использующее предоставленный клиентом контейнер больших двоичных объектов, необходимых для сохранения идентификационных данных устройств, прочитанных из реестра удостоверений устройств.</span><span class="sxs-lookup"><span data-stu-id="6aed3-145">Exports are long-running jobs that use a customer-supplied blob container to save device identity data read from the identity registry.</span></span>

<span data-ttu-id="6aed3-146">Можно выполнить массовый импорт удостоверений устройств в реестр удостоверений Центра Интернета вещей, используя асинхронные операции в [конечной точке поставщика ресурсов Центра Интернета вещей][lnk-endpoints].</span><span class="sxs-lookup"><span data-stu-id="6aed3-146">You can import device identities in bulk to an IoT hub's identity registry, by using asynchronous operations on the [IoT Hub resource provider endpoint][lnk-endpoints].</span></span> <span data-ttu-id="6aed3-147">Импорт — это долгосрочное задание, использующее данные в предоставленном клиентом контейнере больших двоичных объектов, необходимых для записи идентификационных данных об устройстве в реестр удостоверений.</span><span class="sxs-lookup"><span data-stu-id="6aed3-147">Imports are long-running jobs that use data in a customer-supplied blob container to write device identity data into the identity registry.</span></span>

* <span data-ttu-id="6aed3-148">Дополнительные сведения об интерфейсах API импорта и экспорта см. в статье [IoT Hub resource provider REST APIs][lnk-resource-provider-apis] (Интерфейсы REST API поставщика ресурсов Центра Интернета вещей).</span><span class="sxs-lookup"><span data-stu-id="6aed3-148">For detailed information about the import and export APIs, see [IoT Hub resource provider REST APIs][lnk-resource-provider-apis].</span></span>
* <span data-ttu-id="6aed3-149">Дополнительные сведения о выполнении заданий импорта и экспорта см. в статье [Массовое управление удостоверениями устройств центра IoT][lnk-bulk-identity].</span><span class="sxs-lookup"><span data-stu-id="6aed3-149">To learn more about running import and export jobs, see [Bulk management of IoT Hub device identities][lnk-bulk-identity].</span></span>

## <a name="device-provisioning"></a><span data-ttu-id="6aed3-150">Подготовка устройств</span><span class="sxs-lookup"><span data-stu-id="6aed3-150">Device provisioning</span></span>

<span data-ttu-id="6aed3-151">Данные устройства, которые хранятся в заданном решении IoT, зависят от конкретных требований этого решения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-151">The device data that a given IoT solution stores depends on the specific requirements of that solution.</span></span> <span data-ttu-id="6aed3-152">Но в решении как минимум должны сохраняться удостоверения устройства и ключи проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="6aed3-152">But, as a minimum, a solution must store device identities and authentication keys.</span></span> <span data-ttu-id="6aed3-153">Центр Интернета вещей Azure имеет реестр удостоверений, который может хранить значения для каждого устройства, например идентификаторы, ключи проверки подлинности и коды состояния.</span><span class="sxs-lookup"><span data-stu-id="6aed3-153">Azure IoT Hub includes an identity registry that can store values for each device such as IDs, authentication keys, and status codes.</span></span> <span data-ttu-id="6aed3-154">Для хранения любых дополнительных данных устройств решение может использовать другие службы Azure, такие как хранилище таблиц, хранилище BLOB-объектов или Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="6aed3-154">A solution can use other Azure services such as table storage, blob storage, or Cosmos DB to store any additional device data.</span></span>

<span data-ttu-id="6aed3-155">*Подготовка устройств* — это процесс добавления исходных данных устройства в хранилища в решении.</span><span class="sxs-lookup"><span data-stu-id="6aed3-155">*Device provisioning* is the process of adding the initial device data to the stores in your solution.</span></span> <span data-ttu-id="6aed3-156">Чтобы предоставить новому устройству доступ к центру, необходимо добавить идентификатор и ключи устройства в реестр удостоверений Центра Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-156">To enable a new device to connect to your hub, you must add a device ID and keys to the IoT Hub identity registry.</span></span> <span data-ttu-id="6aed3-157">В рамках процесса подготовки может потребоваться инициализировать данные устройства в других хранилищах решения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-157">As part of the provisioning process, you might need to initialize device-specific data in other solution stores.</span></span>

## <a name="device-heartbeat"></a><span data-ttu-id="6aed3-158">Пульс устройства</span><span class="sxs-lookup"><span data-stu-id="6aed3-158">Device heartbeat</span></span>

<span data-ttu-id="6aed3-159">Реестр удостоверений Центра Интернета вещей содержит поле **connectionState**.</span><span class="sxs-lookup"><span data-stu-id="6aed3-159">The IoT Hub identity registry contains a field called **connectionState**.</span></span> <span data-ttu-id="6aed3-160">Поле **connectionState** используется только во время разработки и отладки.</span><span class="sxs-lookup"><span data-stu-id="6aed3-160">Only use the **connectionState** field during development and debugging.</span></span> <span data-ttu-id="6aed3-161">Во время выполнения решения Интернета вещей не должны запрашивать это поле.</span><span class="sxs-lookup"><span data-stu-id="6aed3-161">IoT solutions should not query the field at run time.</span></span> <span data-ttu-id="6aed3-162">Например, не запрашивайте поле **connectionState**, чтобы проверить подключение устройства, прежде чем отправить сообщение из облака на устройство или SMS.</span><span class="sxs-lookup"><span data-stu-id="6aed3-162">For example, do not query the **connectionState** field to check if a device is connected before you send a cloud-to-device message or an SMS.</span></span>

<span data-ttu-id="6aed3-163">Если решению Интернета вещей необходимо определять, подключено ли устройство, в него необходимо внедрить *шаблон пульса*.</span><span class="sxs-lookup"><span data-stu-id="6aed3-163">If your IoT solution needs to know if a device is connected, you should implement the *heartbeat pattern*.</span></span>

<span data-ttu-id="6aed3-164">При использовании шаблона пульса устройство отправляет сообщения с устройства в облака с заданной периодичностью (например не реже, чем каждый час).</span><span class="sxs-lookup"><span data-stu-id="6aed3-164">In the heartbeat pattern, the device sends device-to-cloud messages at least once every fixed amount of time (for example, at least once every hour).</span></span> <span data-ttu-id="6aed3-165">Если отправка данных при этом не требуется, устройство отправляет с устройства в облака пустое сообщение (обычно содержащее свойство, идентифицирующее его как пульс).</span><span class="sxs-lookup"><span data-stu-id="6aed3-165">Therefore, even if a device does not have any data to send, it still sends an empty device-to-cloud message (usually with a property that identifies it as a heartbeat).</span></span> <span data-ttu-id="6aed3-166">На стороне службы решение хранит карту последнего пульса, полученного по каждому устройству,</span><span class="sxs-lookup"><span data-stu-id="6aed3-166">On the service side, the solution maintains a map with the last heartbeat received for each device.</span></span> <span data-ttu-id="6aed3-167">и если решение не получает от устройства сообщение пульса в ожидаемое время, то оно сообщает о проблеме.</span><span class="sxs-lookup"><span data-stu-id="6aed3-167">If the solution does not receive a heartbeat message within the expected time from the device, it assumes that there is a problem with the device.</span></span>

<span data-ttu-id="6aed3-168">Более сложные варианты могут включать в себя данные [мониторинга операций][lnk-devguide-opmon], позволяющие определять, какие устройства пытаются, но не могут установить подключение.</span><span class="sxs-lookup"><span data-stu-id="6aed3-168">A more complex implementation could include the information from [operations monitoring][lnk-devguide-opmon] to identify devices that are trying to connect or communicate but failing.</span></span> <span data-ttu-id="6aed3-169">Внедряя в решение шаблон пульса, учитывайте [квоты и ограничения Центра Интернета вещей][lnk-quotas].</span><span class="sxs-lookup"><span data-stu-id="6aed3-169">When you implement the heartbeat pattern, make sure to check [IoT Hub Quotas and Throttles][lnk-quotas].</span></span>

> [!NOTE]
> <span data-ttu-id="6aed3-170">Если решение Интернета вещей использует состояние подключения исключительно для того, чтобы определить, отправлять ли сообщения из облака на устройство, и сообщения не вещаются на большие наборы устройств, то следует рассмотреть более простой способ — использовать *небольшой срок действия*.</span><span class="sxs-lookup"><span data-stu-id="6aed3-170">If an IoT solution uses the connection state solely to determine whether to send cloud-to-device messages, and messages are not broadcast to large sets of devices, consider using the simpler *short expiry time* pattern.</span></span> <span data-ttu-id="6aed3-171">Это позволяет добиться того же результата, что и при обслуживании реестра состояний подключения устройств, действующего по принципу пульса, но с большей эффективностью.</span><span class="sxs-lookup"><span data-stu-id="6aed3-171">This pattern achieves the same result as maintaining a device connection state registry using the heartbeat pattern, while being more efficient.</span></span> <span data-ttu-id="6aed3-172">При запросе подтверждения сообщений Центр Интернета вещей может сообщить о том, какие устройства могут получать сообщения, а какие не могут.</span><span class="sxs-lookup"><span data-stu-id="6aed3-172">If you request message acknowledgements, IoT Hub can notify you about which devices are able to receive messages and which are not.</span></span>

## <a name="device-lifecycle-notifications"></a><span data-ttu-id="6aed3-173">Уведомления жизненного цикла устройств</span><span class="sxs-lookup"><span data-stu-id="6aed3-173">Device lifecycle notifications</span></span>

<span data-ttu-id="6aed3-174">Центр Интернета вещей может уведомлять решение Интернета вещей во время создания или удаления удостоверения устройства путем отправки уведомлений жизненного цикла устройств.</span><span class="sxs-lookup"><span data-stu-id="6aed3-174">IoT Hub can notify your IoT solution when a device identity is created or deleted by sending device lifecycle notifications.</span></span> <span data-ttu-id="6aed3-175">Для этого в решении Интернета вещей необходимо создать маршрут и присвоить источнику данных значение *DeviceLifecycleEvents*.</span><span class="sxs-lookup"><span data-stu-id="6aed3-175">To do so, your IoT solution needs to create a route and to set the Data Source equal to *DeviceLifecycleEvents*.</span></span> <span data-ttu-id="6aed3-176">По умолчанию уведомления жизненного цикла не отправляются, то есть такие маршруты не существуют.</span><span class="sxs-lookup"><span data-stu-id="6aed3-176">By default, no lifecycle notifications are sent, that is, no such routes pre-exist.</span></span> <span data-ttu-id="6aed3-177">Уведомление содержит свойства и текст.</span><span class="sxs-lookup"><span data-stu-id="6aed3-177">The notification message includes properties, and body.</span></span>

<span data-ttu-id="6aed3-178">Свойства: системные свойства сообщений начинаются с символа `'$'`.</span><span class="sxs-lookup"><span data-stu-id="6aed3-178">Properties: Message system properties are prefixed with the `'$'` symbol.</span></span>

| <span data-ttu-id="6aed3-179">Имя</span><span class="sxs-lookup"><span data-stu-id="6aed3-179">Name</span></span> | <span data-ttu-id="6aed3-180">Значение</span><span class="sxs-lookup"><span data-stu-id="6aed3-180">Value</span></span> |
| --- | --- |
<span data-ttu-id="6aed3-181">$content-type</span><span class="sxs-lookup"><span data-stu-id="6aed3-181">$content-type</span></span> | <span data-ttu-id="6aed3-182">приложение/json</span><span class="sxs-lookup"><span data-stu-id="6aed3-182">application/json</span></span> |
<span data-ttu-id="6aed3-183">$iothub-enqueuedtime</span><span class="sxs-lookup"><span data-stu-id="6aed3-183">$iothub-enqueuedtime</span></span> |  <span data-ttu-id="6aed3-184">Время отправки уведомления</span><span class="sxs-lookup"><span data-stu-id="6aed3-184">Time when the notification was sent</span></span> |
<span data-ttu-id="6aed3-185">$iothub-message-source</span><span class="sxs-lookup"><span data-stu-id="6aed3-185">$iothub-message-source</span></span> | <span data-ttu-id="6aed3-186">deviceLifecycleEvents</span><span class="sxs-lookup"><span data-stu-id="6aed3-186">deviceLifecycleEvents</span></span> |
<span data-ttu-id="6aed3-187">$content-encoding</span><span class="sxs-lookup"><span data-stu-id="6aed3-187">$content-encoding</span></span> | <span data-ttu-id="6aed3-188">utf-8</span><span class="sxs-lookup"><span data-stu-id="6aed3-188">utf-8</span></span> |
<span data-ttu-id="6aed3-189">opType</span><span class="sxs-lookup"><span data-stu-id="6aed3-189">opType</span></span> | <span data-ttu-id="6aed3-190">**createDeviceIdentity** или **deleteDeviceIdentity**</span><span class="sxs-lookup"><span data-stu-id="6aed3-190">**createDeviceIdentity** or **deleteDeviceIdentity**</span></span> |
<span data-ttu-id="6aed3-191">hubName</span><span class="sxs-lookup"><span data-stu-id="6aed3-191">hubName</span></span> | <span data-ttu-id="6aed3-192">Имя Центра Интернета вещей</span><span class="sxs-lookup"><span data-stu-id="6aed3-192">Name of IoT Hub</span></span> |
<span data-ttu-id="6aed3-193">deviceId</span><span class="sxs-lookup"><span data-stu-id="6aed3-193">deviceId</span></span> | <span data-ttu-id="6aed3-194">Идентификатор устройства</span><span class="sxs-lookup"><span data-stu-id="6aed3-194">ID of the device</span></span> |
<span data-ttu-id="6aed3-195">operationTimestamp</span><span class="sxs-lookup"><span data-stu-id="6aed3-195">operationTimestamp</span></span> | <span data-ttu-id="6aed3-196">Отметка времени операции по стандарту ISO8601</span><span class="sxs-lookup"><span data-stu-id="6aed3-196">ISO8601 timestamp of operation</span></span> |
<span data-ttu-id="6aed3-197">iothub-message-schema</span><span class="sxs-lookup"><span data-stu-id="6aed3-197">iothub-message-schema</span></span> | <span data-ttu-id="6aed3-198">deviceLifecycleNotification</span><span class="sxs-lookup"><span data-stu-id="6aed3-198">deviceLifecycleNotification</span></span> |

<span data-ttu-id="6aed3-199">Текст: этот раздел имеет формат JSON и представляет двойник созданного удостоверения устройства.</span><span class="sxs-lookup"><span data-stu-id="6aed3-199">Body: This section is in JSON format and represents the twin of the created device identity.</span></span> <span data-ttu-id="6aed3-200">Например,</span><span class="sxs-lookup"><span data-stu-id="6aed3-200">For example,</span></span>

```json
{
    "deviceId":"11576-ailn-test-0-67333793211",
    "etag":"AAAAAAAAAAE=",
    "properties": {
        "desired": {
            "$metadata": {
                "$lastUpdated": "2016-02-30T16:24:48.789Z"
            },
            "$version": 1
        },
        "reported": {
            "$metadata": {
                "$lastUpdated": "2016-02-30T16:24:48.789Z"
            },
            "$version": 1
        }
    }
}
```

## <a name="reference-topics"></a><span data-ttu-id="6aed3-201">Справочные материалы</span><span class="sxs-lookup"><span data-stu-id="6aed3-201">Reference topics:</span></span>

<span data-ttu-id="6aed3-202">В следующих справочных материалах предоставлены дополнительные сведения о реестре удостоверений.</span><span class="sxs-lookup"><span data-stu-id="6aed3-202">The following reference topics provide you with more information about the identity registry.</span></span>

## <a name="device-identity-properties"></a><span data-ttu-id="6aed3-203">Свойства удостоверений устройств</span><span class="sxs-lookup"><span data-stu-id="6aed3-203">Device identity properties</span></span>

<span data-ttu-id="6aed3-204">Удостоверения устройств отображаются как JSON-документы с нижеуказанными свойствами.</span><span class="sxs-lookup"><span data-stu-id="6aed3-204">Device identities are represented as JSON documents with the following properties:</span></span>

| <span data-ttu-id="6aed3-205">Свойство</span><span class="sxs-lookup"><span data-stu-id="6aed3-205">Property</span></span> | <span data-ttu-id="6aed3-206">Параметры</span><span class="sxs-lookup"><span data-stu-id="6aed3-206">Options</span></span> | <span data-ttu-id="6aed3-207">Описание</span><span class="sxs-lookup"><span data-stu-id="6aed3-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6aed3-208">deviceId</span><span class="sxs-lookup"><span data-stu-id="6aed3-208">deviceId</span></span> |<span data-ttu-id="6aed3-209">Обязательно, при обновлениях доступно только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-209">required, read-only on updates</span></span> |<span data-ttu-id="6aed3-210">Строка с учетом регистра (длиной до 128 символов), состоящая из букв и цифр в 7-битовом формате ASCII + `{'-', ':', '.', '+', '%', '_', '#', '*', '?', '!', '(', ')', ',', '=', '@', ';', '$', '''}`.</span><span class="sxs-lookup"><span data-stu-id="6aed3-210">A case-sensitive string (up to 128 characters long) of ASCII 7-bit alphanumeric characters + `{'-', ':', '.', '+', '%', '_', '#', '*', '?', '!', '(', ')', ',', '=', '@', ';', '$', '''}`.</span></span> |
| <span data-ttu-id="6aed3-211">generationId</span><span class="sxs-lookup"><span data-stu-id="6aed3-211">generationId</span></span> |<span data-ttu-id="6aed3-212">Обязательно, только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-212">required, read-only</span></span> |<span data-ttu-id="6aed3-213">Созданная Центром Интернета вещей строка с учетом регистра (длиной до 128 знаков).</span><span class="sxs-lookup"><span data-stu-id="6aed3-213">An IoT hub-generated, case-sensitive string up to 128 characters long.</span></span> <span data-ttu-id="6aed3-214">Это значение позволяет различать устройства с одинаковым свойством **deviceId**, которые были удалены, а затем созданы повторно.</span><span class="sxs-lookup"><span data-stu-id="6aed3-214">This value is used to distinguish devices with the same **deviceId**, when they have been deleted and re-created.</span></span> |
| <span data-ttu-id="6aed3-215">etag</span><span class="sxs-lookup"><span data-stu-id="6aed3-215">etag</span></span> |<span data-ttu-id="6aed3-216">Обязательно, только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-216">required, read-only</span></span> |<span data-ttu-id="6aed3-217">Строка, выполняющая функцию ненадежного заголовка ETag для удостоверения устройства (согласно [RFC7232][lnk-rfc7232]).</span><span class="sxs-lookup"><span data-stu-id="6aed3-217">A string representing a weak ETag for the device identity, as per [RFC7232][lnk-rfc7232].</span></span> |
| <span data-ttu-id="6aed3-218">auth</span><span class="sxs-lookup"><span data-stu-id="6aed3-218">auth</span></span> |<span data-ttu-id="6aed3-219">необязательный</span><span class="sxs-lookup"><span data-stu-id="6aed3-219">optional</span></span> |<span data-ttu-id="6aed3-220">Составной объект, содержащий сведения об аутентификации и материалы безопасности.</span><span class="sxs-lookup"><span data-stu-id="6aed3-220">A composite object containing authentication information and security materials.</span></span> |
| <span data-ttu-id="6aed3-221">auth.symkey</span><span class="sxs-lookup"><span data-stu-id="6aed3-221">auth.symkey</span></span> |<span data-ttu-id="6aed3-222">необязательный</span><span class="sxs-lookup"><span data-stu-id="6aed3-222">optional</span></span> |<span data-ttu-id="6aed3-223">Составной объект, содержащий первичный и вторичный ключи, хранящиеся в формате base64.</span><span class="sxs-lookup"><span data-stu-id="6aed3-223">A composite object containing a primary and a secondary key, stored in base64 format.</span></span> |
| <span data-ttu-id="6aed3-224">status</span><span class="sxs-lookup"><span data-stu-id="6aed3-224">status</span></span> |<span data-ttu-id="6aed3-225">обязательно</span><span class="sxs-lookup"><span data-stu-id="6aed3-225">required</span></span> |<span data-ttu-id="6aed3-226">Индикатор доступа.</span><span class="sxs-lookup"><span data-stu-id="6aed3-226">An access indicator.</span></span> <span data-ttu-id="6aed3-227">Доступно два значения: **Включено** или **Отключено**.</span><span class="sxs-lookup"><span data-stu-id="6aed3-227">Can be **Enabled** or **Disabled**.</span></span> <span data-ttu-id="6aed3-228">Если указано значение **Включено**, устройство может подключаться.</span><span class="sxs-lookup"><span data-stu-id="6aed3-228">If **Enabled**, the device is allowed to connect.</span></span> <span data-ttu-id="6aed3-229">Если указано значение **Отключено**, устройство не может подключаться ни к одной конечной точке, обращенной к устройству.</span><span class="sxs-lookup"><span data-stu-id="6aed3-229">If **Disabled**, this device cannot access any device-facing endpoint.</span></span> |
| <span data-ttu-id="6aed3-230">statusReason</span><span class="sxs-lookup"><span data-stu-id="6aed3-230">statusReason</span></span> |<span data-ttu-id="6aed3-231">необязательный</span><span class="sxs-lookup"><span data-stu-id="6aed3-231">optional</span></span> |<span data-ttu-id="6aed3-232">Строка длиной 128 знаков, указывающая причину, по которой выбран тот или иной статус удостоверения устройства.</span><span class="sxs-lookup"><span data-stu-id="6aed3-232">A 128 character-long string that stores the reason for the device identity status.</span></span> <span data-ttu-id="6aed3-233">Разрешены все символы UTF-8.</span><span class="sxs-lookup"><span data-stu-id="6aed3-233">All UTF-8 characters are allowed.</span></span> |
| <span data-ttu-id="6aed3-234">statusUpdateTime</span><span class="sxs-lookup"><span data-stu-id="6aed3-234">statusUpdateTime</span></span> |<span data-ttu-id="6aed3-235">Только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-235">read-only</span></span> |<span data-ttu-id="6aed3-236">Временной индикатор, показывающий дату и время последнего обновления статуса.</span><span class="sxs-lookup"><span data-stu-id="6aed3-236">A temporal indicator, showing the date and time of the last status update.</span></span> |
| <span data-ttu-id="6aed3-237">connectionState</span><span class="sxs-lookup"><span data-stu-id="6aed3-237">connectionState</span></span> |<span data-ttu-id="6aed3-238">Только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-238">read-only</span></span> |<span data-ttu-id="6aed3-239">Поле, отображающее состояние подключения: **Подключено** или **Отключено**.</span><span class="sxs-lookup"><span data-stu-id="6aed3-239">A field indicating connection status: either **Connected** or **Disconnected**.</span></span> <span data-ttu-id="6aed3-240">Это поле отображает состояние подключения устройства для Центра Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-240">This field represents the IoT Hub view of the device connection status.</span></span> <span data-ttu-id="6aed3-241">**Важно!**Используйте это поле только в целях разработки и отладки.</span><span class="sxs-lookup"><span data-stu-id="6aed3-241">**Important**: This field should be used only for development/debugging purposes.</span></span> <span data-ttu-id="6aed3-242">Состояние подключения обновляется только для устройств, использующих протокол MQTT или AMQP.</span><span class="sxs-lookup"><span data-stu-id="6aed3-242">The connection state is updated only for devices using MQTT or AMQP.</span></span> <span data-ttu-id="6aed3-243">Кроме того, оно определяется по запросам проверки связи (по протоколу MQTT или AMQP) и может иметь максимальную задержку равную всего лишь 5 минутам.</span><span class="sxs-lookup"><span data-stu-id="6aed3-243">Also, it is based on protocol-level pings (MQTT pings, or AMQP pings), and it can have a maximum delay of only 5 minutes.</span></span> <span data-ttu-id="6aed3-244">В связи с этим могут возникать ложно положительные результаты, например, когда отключенные устройства отображаются как подключенные.</span><span class="sxs-lookup"><span data-stu-id="6aed3-244">For these reasons, there can be false positives, such as devices reported as connected but that are disconnected.</span></span> |
| <span data-ttu-id="6aed3-245">connectionStateUpdatedTime</span><span class="sxs-lookup"><span data-stu-id="6aed3-245">connectionStateUpdatedTime</span></span> |<span data-ttu-id="6aed3-246">Только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-246">read-only</span></span> |<span data-ttu-id="6aed3-247">Временной индикатор, показывающий дату и время последнего обновления состояния подключения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-247">A temporal indicator, showing the date and last time the connection state was updated.</span></span> |
| <span data-ttu-id="6aed3-248">lastActivityTime</span><span class="sxs-lookup"><span data-stu-id="6aed3-248">lastActivityTime</span></span> |<span data-ttu-id="6aed3-249">Только для чтения</span><span class="sxs-lookup"><span data-stu-id="6aed3-249">read-only</span></span> |<span data-ttu-id="6aed3-250">Временной индикатор, показывающий дату и время последнего подключения устройства, получения сообщения на устройство и отправки сообщения с него.</span><span class="sxs-lookup"><span data-stu-id="6aed3-250">A temporal indicator, showing the date and last time the device connected, received, or sent a message.</span></span> |

> [!NOTE]
> <span data-ttu-id="6aed3-251">Статус подключения отображает статус подключения для Центра Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-251">Connection state can only represent the IoT Hub view of the status of the connection.</span></span> <span data-ttu-id="6aed3-252">При некоторых состояниях и конфигурациях сети обновления этого состояния могут задерживаться.</span><span class="sxs-lookup"><span data-stu-id="6aed3-252">Updates to this state may be delayed, depending on network conditions and configurations.</span></span>

## <a name="additional-reference-material"></a><span data-ttu-id="6aed3-253">Дополнительные справочные материалы</span><span class="sxs-lookup"><span data-stu-id="6aed3-253">Additional reference material</span></span>

<span data-ttu-id="6aed3-254">Другие справочные статьи в руководстве разработчика для Центра Интернета вещей:</span><span class="sxs-lookup"><span data-stu-id="6aed3-254">Other reference topics in the IoT Hub developer guide include:</span></span>

* <span data-ttu-id="6aed3-255">Статья [IoT Hub endpoints][lnk-endpoints] (Конечные точки Центра Интернета вещей) содержит сведения о конечных точках, которые каждый Центр Интернета вещей предоставляет для операций управления и среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="6aed3-255">[IoT Hub endpoints][lnk-endpoints] describes the various endpoints that each IoT hub exposes for run-time and management operations.</span></span>
* <span data-ttu-id="6aed3-256">Статья [Квоты и регулирование в Центре Интернета вещей][lnk-quotas] содержит сведения о квотах, применимых к службе Центра Интернета вещей, и поведении регулирования.</span><span class="sxs-lookup"><span data-stu-id="6aed3-256">[Throttling and quotas][lnk-quotas] describes the quotas and throttling behaviors that apply to the IoT Hub service.</span></span>
* <span data-ttu-id="6aed3-257">В статье [Пакеты SDK для устройств и служб Интернета вещей Azure][lnk-sdks] указаны различные языковые пакеты SDK, которые можно использовать при разработке приложений для устройств и служб, взаимодействующих с Центром Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-257">[Azure IoT device and service SDKs][lnk-sdks] lists the various language SDKs you can use when you develop both device and service apps that interact with IoT Hub.</span></span>
* <span data-ttu-id="6aed3-258">В статье [Справочник — язык запросов Центра Интернета вещей для двойников устройств, заданий и маршрутизации сообщений][lnk-query] описывается язык запросов, который можно использовать для получения сведений о двойниках устройств и заданиях из Центра Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-258">[IoT Hub query language][lnk-query] describes the query language you can use to retrieve information from IoT Hub about your device twins and jobs.</span></span>
* <span data-ttu-id="6aed3-259">Статья [Поддержка MQTT в Центре Интернета вещей][lnk-devguide-mqtt] содержит дополнительные сведения о поддержке протокола MQTT в Центре Интернета вещей.</span><span class="sxs-lookup"><span data-stu-id="6aed3-259">[IoT Hub MQTT support][lnk-devguide-mqtt] provides more information about IoT Hub support for the MQTT protocol.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6aed3-260">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="6aed3-260">Next steps</span></span>

<span data-ttu-id="6aed3-261">Теперь, когда вы узнали, как использовать реестр удостоверений Центра Интернета вещей, вас могут заинтересовать следующие статьи в руководстве разработчика для Центра Интернета вещей:</span><span class="sxs-lookup"><span data-stu-id="6aed3-261">Now you have learned how to use the IoT Hub identity registry, you may be interested in the following IoT Hub developer guide topics:</span></span>

* <span data-ttu-id="6aed3-262">[Управление доступом к Центру Интернета вещей][lnk-devguide-security]</span><span class="sxs-lookup"><span data-stu-id="6aed3-262">[Control access to IoT Hub][lnk-devguide-security]</span></span>
* <span data-ttu-id="6aed3-263">[Основные сведения о двойниках устройств (предварительная версия)][lnk-devguide-device-twins]</span><span class="sxs-lookup"><span data-stu-id="6aed3-263">[Use device twins to synchronize state and configurations][lnk-devguide-device-twins]</span></span>
* <span data-ttu-id="6aed3-264">[Вызов прямого метода на устройстве (предварительная версия)][lnk-devguide-directmethods]</span><span class="sxs-lookup"><span data-stu-id="6aed3-264">[Invoke a direct method on a device][lnk-devguide-directmethods]</span></span>
* <span data-ttu-id="6aed3-265">[Schedule jobs on multiple devices][lnk-devguide-jobs] (Планирование заданий на нескольких устройствах)</span><span class="sxs-lookup"><span data-stu-id="6aed3-265">[Schedule jobs on multiple devices][lnk-devguide-jobs]</span></span>

<span data-ttu-id="6aed3-266">Если вы хотели бы применить на практике некоторые основные понятия, описанные в этой статье, можно просмотреть следующее руководство по Центру Интернета вещей:</span><span class="sxs-lookup"><span data-stu-id="6aed3-266">If you would like to try out some of the concepts described in this article, you may be interested in the following IoT Hub tutorial:</span></span>

* <span data-ttu-id="6aed3-267">[Приступая к работе с Центром Интернета вещей Azure][lnk-getstarted-tutorial]</span><span class="sxs-lookup"><span data-stu-id="6aed3-267">[Get started with Azure IoT Hub][lnk-getstarted-tutorial]</span></span>

<!-- Links and images -->

[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-quotas]: iot-hub-devguide-quotas-throttling.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-query]: iot-hub-devguide-query-language.md
[lnk-devguide-mqtt]: iot-hub-mqtt-support.md
[lnk-resource-provider-apis]: https://docs.microsoft.com/rest/api/iothub/iothubresource
[lnk-guidance-provisioning]: iot-hub-devguide-identity-registry.md#device-provisioning
[lnk-guidance-heartbeat]: iot-hub-devguide-identity-registry.md#device-heartbeat
[lnk-rfc7232]: https://tools.ietf.org/html/rfc7232
[lnk-bulk-identity]: iot-hub-bulk-identity-mgmt.md
[lnk-export]: iot-hub-devguide-identity-registry.md#import-and-export-device-identities
[lnk-devguide-opmon]: iot-hub-operations-monitoring.md

[lnk-devguide-security]: iot-hub-devguide-security.md
[lnk-devguide-device-twins]: iot-hub-devguide-device-twins.md
[lnk-devguide-directmethods]: iot-hub-devguide-direct-methods.md
[lnk-devguide-jobs]: iot-hub-devguide-jobs.md

[lnk-getstarted-tutorial]: iot-hub-csharp-csharp-getstarted.md
