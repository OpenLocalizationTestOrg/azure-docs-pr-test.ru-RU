---
title: "Центр IoT Azure удостоверения aaaUnderstand hello реестра | Документы Microsoft"
description: "Руководство разработчика - описание hello реестра удостоверений центр IoT и как toouse его toomanage устройств. Содержит сведения о hello Импорт и экспорт удостоверения устройства в пакетном режиме."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 0706eccd-e84c-4ae7-bbd4-2b1a22241147
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/08/2017
ms.author: dobett
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: c9fe3730a4608e28c47807ecb42e13e73f6a2e80
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="understand-hello-identity-registry-in-your-iot-hub"></a>Понимать реестра удостоверений hello в концентратор IoT

Каждый центр IoT имеет удостоверение реестра, который хранит сведения о разрешенных центра IoT toohello tooconnect устройств hello. Прежде чем устройство сможет подключиться центра IoT tooan, должен быть вход для этого устройства в реестре удостоверений центра IoT hello. Устройство также должно проверять подлинность с центром IoT hello на основе учетных данных, хранящиеся в реестре удостоверений hello.

Идентификатор устройства Hello, хранящиеся в реестре удостоверений hello учитывается регистр.

На высоком уровне реестру удостоверений hello является коллекцией поддержкой REST идентификаторов ресурсов устройств. При добавлении записи в реестре удостоверений hello центра IoT создает набор ресурсов на устройство, например hello очередь, которая содержит перераспределяет сообщения облака на устройство.

### <a name="when-toouse"></a>Когда toouse

При необходимости, используйте hello удостоверение реестра:

* Подготовка устройства, подключаемые tooyour центр IoT.
* Управление конечными точками концентратора для каждого из устройств доступа tooyour устройств с выходом.

> [!NOTE]
> Hello реестра удостоверений не содержит все метаданные для конкретного приложения.

## <a name="identity-registry-operations"></a>операции с реестром удостоверений.

Hello реестра удостоверений центра IoT предоставляет hello следующие операции:

* создание удостоверения устройства;
* обновление удостоверения устройства;
* получение удостоверения устройства по идентификатору;
* удаление удостоверения устройства;
* Перечислить копии too1000 удостоверений
* Экспорт всех хранилищ больших двоичных объектов tooAzure удостоверений
* импорт всех удостоверений из хранилища BLOB-объектов Azure.

Все эти операции могут использовать оптимистичный параллелизм (согласно [RFC7232][lnk-rfc7232]).

> [!IMPORTANT]
> Здравствуйте только способом tooretrieve всех удостоверений в реестре удостоверений центр IoT — toouse hello [Экспорт] [ lnk-export] функциональные возможности.

Реестр удостоверений Центра Интернета вещей:

* не содержит метаданные приложения;
* Может осуществляться как словарь, с помощью hello **deviceId** как ключ hello.
* не поддерживает выразительные запросы.

Решение IoT обычно включает в себя отдельное хранилище, содержащее метаданные приложений. Например hello конкретного решения хранилища в решении смарт-построение зафиксирует hello комнаты, в которой развертывается датчика температуры.

> [!IMPORTANT]
> Hello удостоверение реестра следует используйте только для управления устройствами и подготовка operations. Высокая пропускная способность операций во время выполнения, не следует полагаться на выполнение операций в реестре удостоверений hello. Например проверка состояния подключения hello устройства перед отправкой команды не поддерживается шаблон. Убедитесь, что hello toocheck [уровни регулирования] [ lnk-quotas] для реестра удостоверений hello и hello [пульса устройства] [ lnk-guidance-heartbeat] шаблон.

## <a name="disable-devices"></a>Отключение устройств

Можно отключить устройств, обновив hello **состояние** свойство идентификатора в реестре удостоверений hello. Обычно это свойство используется в двух сценариях.

* В процессе оркестрации подготовки. Дополнительные сведения см. в разделе [Подготовка устройств][lnk-guidance-provisioning].
* Если по какой-либо причине вы решите, что безопасность устройства нарушена или оно является неавторизованным.

## <a name="import-and-export-device-identities"></a>Импорт и экспорт удостоверений устройств

Идентификаторы устройств в пакетном режиме можно экспортировать из реестра центр IoT удостоверение, с помощью асинхронных операций в hello [конечной точки поставщика ресурсов центра IoT][lnk-endpoints]. Экспорты долго выполняющихся заданий, использующих большой двоичный объект, предоставляемый пользователем устройства toosave контейнер учетных данных, считываемых из реестра удостоверений hello.

Идентификаторы устройств в реестре удостоверений массового tooan IoT hub, можно импортировать с помощью асинхронных операций в hello [конечной точки поставщика ресурсов центра IoT][lnk-endpoints]. Импорты, длительные задания, использующие данные в большой двоичный объект, предоставляемый пользователем устройства toowrite контейнер учетных данных в реестре удостоверений hello.

* Подробные сведения о hello импорта и экспорта API-интерфейсы в разделе [API REST поставщика ресурсов центра IoT][lnk-resource-provider-apis].
* toolearn больше о запуске импортировать и экспортировать задания см. в разделе [массовое Управление удостоверениями устройства центра IoT][lnk-bulk-identity].

## <a name="device-provisioning"></a>Подготовка устройств

данные устройства Hello хранятся данного решения IoT зависит от hello конкретных требований этого решения. Но в решении как минимум должны сохраняться удостоверения устройства и ключи проверки подлинности. Центр Интернета вещей Azure имеет реестр удостоверений, который может хранить значения для каждого устройства, например идентификаторы, ключи проверки подлинности и коды состояния. Решения можно использовать других служб Azure, таких как хранилище таблиц, хранилище BLOB-объектов или toostore Cosmos DB любые данные дополнительных устройств.

*Подготовка устройств* — hello процесс добавления hello начальной устройства данных toohello магазинов в решении. tooenable новый концентратор tooyour tooconnect устройства, необходимо добавить устройство идентификатор и ключи toohello реестра удостоверений центр IoT. Как часть процесса инициализации hello может потребоваться tooinitialize сведений в других хранилищах решения.

## <a name="device-heartbeat"></a>Пульс устройства

Hello центра IoT удостоверение реестра содержит поле с именем **connectionState**. Использовать только hello **connectionState** во время разработки и отладки. Решения IoT не должен запросить hello поля во время выполнения. Например, не запрос hello **connectionState** toocheck поля, если устройство подключено, перед отправкой сообщения облака на устройство или SMS.

Если вашего решения IoT должен tooknow, если устройство подключено, должны реализовывать hello *пульса шаблон*.

В шаблоне пульса hello hello устройство отправляет сообщения из устройства в облако хотя бы один раз каждые фиксированное количество времени (например, по крайней мере один раз в час). Таким образом даже если устройство не имеет toosend любые данные, он по-прежнему отправляет пустое сообщение устройства в облако (обычно со свойством, которое идентифицирует его как периодический сигнал). На стороне службы hello hello решение поддерживает карту с hello последнего пульса, полученных для каждого устройства. Решение hello не получил сообщение пульса в течение времени hello ожидается от устройства hello, предполагается, проблему с устройством hello.

Более сложные реализации могут включать сведения hello из [мониторинга операций] [ lnk-devguide-opmon] tooidentify устройств, которые пытаются tooconnect или взаимодействия, но произошел сбой. При реализации шаблона hello пульса убедитесь, что toocheck [IoT Hub квот и регулировок][lnk-quotas].

> [!NOTE]
> Если подключение к IoT использует решение hello ли состояние исключительно toodetermine сообщения toosend облака на устройство, и сообщения, не широковещательных toolarge наборы устройств, рассмотрите возможность использования hello проще *короткий срок* шаблон. Этот шаблон позволяет достичь hello же результат от обслуживания реестра состояние подключения устройства, с помощью шаблона пакета пульса hello, являются более эффективными. При запросе подтверждения сообщений, центр IoT может уведомлять о устройства, возможности tooreceive сообщения, а какие — нет.

## <a name="device-lifecycle-notifications"></a>Уведомления жизненного цикла устройств

Центр Интернета вещей может уведомлять решение Интернета вещей во время создания или удаления удостоверения устройства путем отправки уведомлений жизненного цикла устройств. toodo таким образом, вашего решения IoT должен toocreate маршрута и равенства источника данных hello tooset слишком*DeviceLifecycleEvents*. По умолчанию уведомления жизненного цикла не отправляются, то есть такие маршруты не существуют. сообщение уведомления Hello включает свойства и текст.

Свойства: Системные свойства сообщения с префиксом hello `'$'` символов.

| Имя | Значение |
| --- | --- |
$content-type | приложение/json |
$iothub-enqueuedtime |  Время отправки уведомлений hello |
$iothub-message-source | deviceLifecycleEvents |
$content-encoding | utf-8 |
opType | **createDeviceIdentity** или **deleteDeviceIdentity** |
hubName | Имя Центра Интернета вещей |
deviceId | Идентификатор устройства hello |
operationTimestamp | Отметка времени операции по стандарту ISO8601 |
iothub-message-schema | deviceLifecycleNotification |

Текст: В этом разделе в формате JSON и представляет двойных hello объекта hello создания удостоверения устройства. Например,

```json
{
    "deviceId":"11576-ailn-test-0-67333793211",
    "etag":"AAAAAAAAAAE=",
    "properties": {
        "desired": {
            "$metadata": {
                "$lastUpdated": "2016-02-30T16:24:48.789Z"
            },
            "$version": 1
        },
        "reported": {
            "$metadata": {
                "$lastUpdated": "2016-02-30T16:24:48.789Z"
            },
            "$version": 1
        }
    }
}
```

## <a name="reference-topics"></a>Справочные материалы

Hello следующие справочные разделы предоставляют дополнительные сведения о реестре удостоверений hello.

## <a name="device-identity-properties"></a>Свойства удостоверений устройств

Идентификаторы устройств представлены в виде документов JSON с hello следующие свойства:

| Свойство | Параметры | Описание |
| --- | --- | --- |
| deviceId |Обязательно, при обновлениях доступно только для чтения |Строк с учетом регистра (вверх too128 символов) буквенно-цифровых символов ASCII 7-разрядных + `{'-', ':', '.', '+', '%', '_', '#', '*', '?', '!', '(', ')', ',', '=', '@', ';', '$', '''}`. |
| generationId |Обязательно, только для чтения |IoT концентратор создан строк с учетом регистра вверх too128 символов. Это значение является используется toodistinguish устройствами с помощью hello же **deviceId**, когда они удалена и создана заново. |
| etag |Обязательно, только для чтения |Строка, представляющая слабый ETag для идентификации устройства hello, согласно [RFC7232][lnk-rfc7232]. |
| auth |необязательный |Составной объект, содержащий сведения об аутентификации и материалы безопасности. |
| auth.symkey |необязательный |Составной объект, содержащий первичный и вторичный ключи, хранящиеся в формате base64. |
| status |обязательно |Индикатор доступа. Доступно два значения: **Включено** или **Отключено**. Если **включено**, hello устройство может быть tooconnect. Если указано значение **Отключено**, устройство не может подключаться ни к одной конечной точке, обращенной к устройству. |
| statusReason |необязательный |128 символов длиной строки этой причине hello хранилищ состояния идентификаторов устройств hello. Разрешены все символы UTF-8. |
| statusUpdateTime |Только для чтения |Временная индикатор, показывающий hello Дата и время последнего обновления состояния hello. |
| connectionState |Только для чтения |Поле, отображающее состояние подключения: **Подключено** или **Отключено**. Это поле представляет hello зрения центра IoT hello состояние подключения устройства. **Важно!**Используйте это поле только в целях разработки и отладки. состояние соединения Hello обновляется только для устройств с помощью MQTT или AMQP. Кроме того, оно определяется по запросам проверки связи (по протоколу MQTT или AMQP) и может иметь максимальную задержку равную всего лишь 5 минутам. В связи с этим могут возникать ложно положительные результаты, например, когда отключенные устройства отображаются как подключенные. |
| connectionStateUpdatedTime |Только для чтения |Признак temporal Отображение даты hello и последнее состояние подключения hello времени был обновлен. |
| lastActivityTime |Только для чтения |Временная индикатор, показывающий hello даты и времени hello устройство подключен, полученных или отправленных сообщений. |

> [!NOTE]
> Состояние подключения может представлять только hello центра IoT представление состояния hello hello соединения. Состояние обновления toothis с задержкой, в зависимости от состояния сети и конфигурации.

## <a name="additional-reference-material"></a>Дополнительные справочные материалы

Другие разделы ссылку в hello центра IoT руководстве для разработчиков:

* [Конечные точки центра IoT] [ lnk-endpoints] описывает hello различные конечные точки, предоставляемые каждый центр IoT для операций времени выполнения и управления.
* [Регулирование и квоты] [ lnk-quotas] описывает hello квот и регулирования, применяющимся toohello службы центра IoT.
* [Пакеты SDK устройств и служб Azure IoT] [ lnk-sdks] списки hello языка различных пакетов SDK, которые можно использовать при разработке приложений, устройств и служб, которые взаимодействуют с центром IoT.
* [Язык запросов центра IoT] [ lnk-query] описывает hello язык запросов, можно использовать tooretrieve сведения из центра IoT близнецы устройства и заданий.
* [Поддержка MQTT концентратора IoT] [ lnk-devguide-mqtt] приведены более подробные сведения о поддержке центра IoT протокола MQTT hello.

## <a name="next-steps"></a>Дальнейшие действия

Теперь вы узнали, как toouse реестра удостоверений центра IoT hello, вам может быть полезен в следующие разделы руководства разработчика центра IoT hello:

* [Элемент управления доступом tooIoT концентратора][lnk-devguide-security]
* [Конфигурации и состояния toosynchronize близнецы устройства][lnk-devguide-device-twins]
* [Вызов прямого метода на устройстве (предварительная версия)][lnk-devguide-directmethods]
* [Schedule jobs on multiple devices][lnk-devguide-jobs] (Планирование заданий на нескольких устройствах)

При желании tootry некоторые основные понятия hello, описанных в этой статье, могут быть интересны следующие учебника центра IoT hello параметры:

* [Приступая к работе с Центром Интернета вещей Azure][lnk-getstarted-tutorial]

<!-- Links and images -->

[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-quotas]: iot-hub-devguide-quotas-throttling.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-query]: iot-hub-devguide-query-language.md
[lnk-devguide-mqtt]: iot-hub-mqtt-support.md
[lnk-resource-provider-apis]: https://docs.microsoft.com/rest/api/iothub/iothubresource
[lnk-guidance-provisioning]: iot-hub-devguide-identity-registry.md#device-provisioning
[lnk-guidance-heartbeat]: iot-hub-devguide-identity-registry.md#device-heartbeat
[lnk-rfc7232]: https://tools.ietf.org/html/rfc7232
[lnk-bulk-identity]: iot-hub-bulk-identity-mgmt.md
[lnk-export]: iot-hub-devguide-identity-registry.md#import-and-export-device-identities
[lnk-devguide-opmon]: iot-hub-operations-monitoring.md

[lnk-devguide-security]: iot-hub-devguide-security.md
[lnk-devguide-device-twins]: iot-hub-devguide-device-twins.md
[lnk-devguide-directmethods]: iot-hub-devguide-direct-methods.md
[lnk-devguide-jobs]: iot-hub-devguide-jobs.md

[lnk-getstarted-tutorial]: iot-hub-csharp-csharp-getstarted.md
