---
title: "Общие сведения о встроенной конечной точке Центра Интернета вещей Azure | Документация Майкрософт"
description: "В этом руководстве разработчика описано, как читать сообщения, отправляемые с устройства в облако, с помощью встроенной конечной точки, совместимой с концентратором событий."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 10/13/2017
ms.author: dobett
ms.openlocfilehash: c9e6aa03e3a1e0592223630c7b81634bcb09add6
ms.sourcegitcommit: f8437edf5de144b40aed00af5c52a20e35d10ba1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2017
---
# <a name="read-device-to-cloud-messages-from-the-built-in-endpoint"></a>Чтение сообщений, пересылаемых с устройства в облако, из встроенной конечной точки

По умолчанию сообщения направляются во встроенную конечную точку, доступную для службы (**/messages/events**), которая совместима с [концентраторами событий][lnk-event-hubs]. Сейчас эта конечная точка предоставляется только по протоколу [AMQP][lnk-amqp] на порте 5671. Центр Интернета вещей позволяет управлять встроенной конечной точкой обмена сообщениями **messages/events**, совместимой с концентраторами событий, с помощью приведенных ниже свойств.

| Свойство            | Описание |
| ------------------- | ----------- |
| **Количество секций** | Это свойство можно задать во время создания, чтобы определить количество [разделов][lnk-event-hub-partitions] для приема событий сообщений, отправляемых с устройства в облако. |
| **Время хранения**  | Это свойство задает время в днях, в течение которого сообщения хранятся в Центре Интернета вещей. Значение по умолчанию — один день, но это значение можно увеличить до семи дней. |

Центр Интернета вещей также предоставляет возможность управлять группами потребителей во встроенной конечной точке, которая получает сообщения, отправляемые с устройства в облако.

По умолчанию все сообщения, которые явно не соответствуют правилу маршрутизации сообщений, записываются во встроенную конечную точку. Если отключить этот резервный маршрут, то сообщения, которые явно не соответствуют ни одному правилу маршрутизации сообщений, будут удаляться.

Вы можете изменить период хранения на [портале Azure][lnk-management-portal] или программно (с помощью [интерфейсов REST API поставщика ресурсов Центра Интернета вещей][lnk-resource-provider-apis]).

Центр Интернета вещей предоставляет встроенную конечную точку **messages/events**, с помощью которой внутренние службы считывают сообщения, отправляемые в Центр с устройства в облако. Эта конечная точка совместима с концентраторами событий, поэтому можно использовать любой из механизмов для чтения сообщений, который поддерживает служба концентраторов событий.

## <a name="read-from-the-built-in-endpoint"></a>Считывание данных из встроенной конечной точки

При использовании [пакета SDK служебной шины Azure для .NET][lnk-servicebus-sdk] или [концентраторов событий и узла обработчика событий][lnk-eventprocessorhost] вы можете использовать любые строки подключения к Центру Интернета вещей с нужными разрешениями. А затем использовать **messages/events** в качестве имени концентратора событий.

При использовании пакетов SDK (или интеграции продуктов), которые не поддерживают Центр Интернета вещей, следует получить совместимые с концентраторами событий конечную точку и имя в разделе параметров Центра Интернета вещей:

1. Войдите на [портал Azure][lnk-management-portal] и перейдите к своему Центру Интернета вещей.
1. Нажмите кнопку **Конечные точки**.
1. В разделе **Built-in endpoints** (Встроенные конечные точки) щелкните **События**. 
1. Откроется страница свойств со следующими значениями: **Конечная точка, совместимая с концентратором событий**, **Имя, совместимое с концентратором событий**, **Разделы**, **Время хранения** и **Группы потребителей**.

    ![Параметры отправки сообщений с устройства в облако][img-eventhubcompatible]

Для пакета SDK для Центра Интернета вещей требуется указать конечную точку Центра Интернета вещей. Это точка **messages/events**, как показано в разделе **Конечные точки**.

Если для используемого пакета SDK требуется указать **имя узла** или **пространство имен**, то удалите схему из **конечной точки, совместимой с концентраторами событий**. Например, если конечная точка, совместимая с концентратором событий, — **sb://iothub-ns-myiothub-1234.servicebus.windows.net/**, то **именем узла** будет **iothub-ns-myiothub-1234.servicebus.windows.net**. Значением для **пространства имен** будет **iothub-ns-myiothub-1234**.

Затем можно использовать любую политику общего доступа с разрешениями **ServiceConnect**, которые позволяют подключаться к указанному концентратору событий.

Если нужно создать строку подключения к концентратору событий с помощью указанных выше сведений, можно использовать следующий образец:

`Endpoint={Event Hub-compatible endpoint};SharedAccessKeyName={iot hub policy name};SharedAccessKey={iot hub policy key}`

Ниже приведен список пакетов SDK и интеграций, которые можно применять к совместимым с концентраторами событий конечным точкам, которые предоставляет Центр Интернета вещей:

* [клиент концентраторов событий Java;](https://github.com/Azure/azure-event-hubs-java)
* [Воронка Apache Storm](../hdinsight/storm/apache-storm-develop-csharp-event-hub-topology.md). Вы можете просмотреть [источник воронки](https://github.com/apache/storm/tree/master/external/storm-eventhubs) на портале GitHub.
* [интеграция Apache Spark.](../hdinsight/spark/apache-spark-eventhub-streaming.md)

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о конечных точках Центра Интернета вещей см. в руководстве [Конечные точки Центра Интернета вещей][lnk-endpoints].

В руководствах по [началу работы][lnk-get-started] рассказывается, как отправлять сообщения из устройства в облако с имитируемых устройств и читать их из встроенной конечной точки. Дополнительные сведения см. в руководстве [по обработке сообщений Центра Интернета вещей, отправляемых с устройства в облако, с помощью маршрутов][lnk-d2c-tutorial].

Сведения о перенаправлении сообщений, отправляемых с устройства в облако на пользовательские конечные точки, см. в статье [Use message routes and custom endpoints for device-to-cloud messages][lnk-custom] (Использование маршрутов сообщений и пользовательских конечных точек для сообщений, отправляемых с устройства в облако).

[img-eventhubcompatible]: ./media/iot-hub-devguide-messages-read-builtin/eventhubcompatible.png

[lnk-custom]: iot-hub-devguide-messages-read-custom.md
[lnk-get-started]: iot-hub-get-started.md
[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-resource-provider-apis]: https://docs.microsoft.com/rest/api/iothub/iothubresource
[lnk-event-hubs]: http://azure.microsoft.com/documentation/services/event-hubs/
[lnk-management-portal]: https://portal.azure.com
[lnk-d2c-tutorial]: iot-hub-csharp-csharp-process-d2c.md
[lnk-event-hub-partitions]: ../event-hubs/event-hubs-features.md#partitions
[lnk-servicebus-sdk]: https://www.nuget.org/packages/WindowsAzure.ServiceBus
[lnk-eventprocessorhost]: http://blogs.msdn.com/b/servicebus/archive/2015/01/16/event-processor-host-best-practices-part-1.aspx
[lnk-amqp]: https://www.amqp.org/
