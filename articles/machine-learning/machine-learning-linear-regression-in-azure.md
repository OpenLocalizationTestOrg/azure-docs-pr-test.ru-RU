---
title: "Использование линейной регрессии в машинном обучении | Документация Майкрософт"
description: "Сравнение моделей линейной регрессии в Excel и Студии машинного обучения Azure"
metakeywords: 
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 417ae6ab-de4f-4bdd-957a-d96133234656
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/20/2017
ms.author: kbaroni;garye
ms.openlocfilehash: 7feb5d62415850e66f8eb7e22b9ada0d25a7058e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="using-linear-regression-in-azure-machine-learning"></a><span data-ttu-id="cde2b-103">Использование линейной регрессии в Машинном обучении Azure</span><span class="sxs-lookup"><span data-stu-id="cde2b-103">Using linear regression in Azure Machine Learning</span></span>
> <span data-ttu-id="cde2b-104">*Кейт Барони* (Kate Baroni) и *Бен Боутмен* (Ben Boatman) — архитекторы корпоративных решений в Научно-инновационном центре анализа данных корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="cde2b-104">*Kate Baroni* and *Ben Boatman* are enterprise solution architects in Microsoft’s Data Insights Center of Excellence.</span></span> <span data-ttu-id="cde2b-105">В этой статье они описывают свой опыт миграции существующего набора для регрессионного анализа в облачное решение с помощью Машинного обучения Azure.</span><span class="sxs-lookup"><span data-stu-id="cde2b-105">In this article, they describe their experience migrating an existing regression analysis suite to a cloud-based solution using Azure Machine Learning.</span></span> 
> 
> 

&nbsp; 

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="goal"></a><span data-ttu-id="cde2b-106">Цель</span><span class="sxs-lookup"><span data-stu-id="cde2b-106">Goal</span></span>
<span data-ttu-id="cde2b-107">У нашего проекта было две цели:</span><span class="sxs-lookup"><span data-stu-id="cde2b-107">Our project started with two goals in mind:</span></span> 

1. <span data-ttu-id="cde2b-108">Использование прогнозной аналитики для увеличения точности проекции ежемесячных доходов организации.</span><span class="sxs-lookup"><span data-stu-id="cde2b-108">Use predictive analytics to improve the accuracy of our organization’s monthly revenue projections</span></span> 
2. <span data-ttu-id="cde2b-109">Использование Машинного обучения Azure для подтверждения, оптимизации и увеличения скорости получения результатов, а также увеличения их масштаба.</span><span class="sxs-lookup"><span data-stu-id="cde2b-109">Use Azure Machine Learning to confirm, optimize, increase velocity, and scale of our results.</span></span> 

<span data-ttu-id="cde2b-110">Как и множество других компаний, наша организация прогнозирует свой ежемесячный доход.</span><span class="sxs-lookup"><span data-stu-id="cde2b-110">Like many businesses, our organization goes through a monthly revenue forecasting process.</span></span> <span data-ttu-id="cde2b-111">Задача нашей небольшой группы бизнес-аналитиков состояла в использовании Машинного обучения Azure для поддержки процесса прогнозирования и увеличения точности прогноза.</span><span class="sxs-lookup"><span data-stu-id="cde2b-111">Our small team of business analysts was tasked with using Azure Machine Learning to support the process and improve forecast accuracy.</span></span> <span data-ttu-id="cde2b-112">Несколько месяцев группа занималась сбором данных из нескольких источников и статистическим анализом атрибутов данных, который позволил определить ключевые атрибуты, относящиеся к прогнозированию продаж услуг.</span><span class="sxs-lookup"><span data-stu-id="cde2b-112">The team spent several months collecting data from multiple sources and running the data attributes through statistical analysis identifying key attributes relevant to services sales forecasting.</span></span> <span data-ttu-id="cde2b-113">Дальнейшие действия состояли в создании прототипов моделей статистической регрессии для данных в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-113">The next step was to begin prototyping statistical regression models on the data in Excel.</span></span> <span data-ttu-id="cde2b-114">Спустя несколько недель мы получили модель регрессии для Excel, которая превзошла возможности современных процессов отраслевого и финансового прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="cde2b-114">Within a few weeks, we had an Excel regression model that was outperforming the current field and finance forecasting processes.</span></span> <span data-ttu-id="cde2b-115">Это стало базовым результатом прогноза.</span><span class="sxs-lookup"><span data-stu-id="cde2b-115">This became the baseline prediction result.</span></span> 

<span data-ttu-id="cde2b-116">Затем мы предприняли дальнейшие действия по перемещению прогнозной аналитики в Машинное обучение Azure, чтобы выяснить, как эта служба может повысить производительность прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="cde2b-116">We then took the next step to moving our predictive analytics over to Azure Machine Learning to find out how Machine Learning could improve on predictive performance.</span></span>

## <a name="achieving-predictive-performance-parity"></a><span data-ttu-id="cde2b-117">Достижение соответствия производительности прогнозирования</span><span class="sxs-lookup"><span data-stu-id="cde2b-117">Achieving predictive performance parity</span></span>
<span data-ttu-id="cde2b-118">Основным приоритетом было достижение соответствия моделей регрессии машинного обучения и Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-118">Our first priority was to achieve parity between Machine Learning and Excel regression models.</span></span> <span data-ttu-id="cde2b-119">Нам нужно было добиться соответствия производительности прогнозирования машинного обучения и Excel, используя одни и те же данные, которые разделены на одинаковые наборы данных для обучения и тестирования.</span><span class="sxs-lookup"><span data-stu-id="cde2b-119">Given the same data, and the same split for training and testing data, we wanted to achieve predictive performance parity between Excel and Machine Learning.</span></span> <span data-ttu-id="cde2b-120">Сначала нам не удалось выполнить эту задачу.</span><span class="sxs-lookup"><span data-stu-id="cde2b-120">Initially we failed.</span></span> <span data-ttu-id="cde2b-121">Модель Excel превзошла модель машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="cde2b-121">The Excel model outperformed the Machine Learning model.</span></span> <span data-ttu-id="cde2b-122">Это произошло из-за неполного понимания требований к базовым параметрам инструментов в машинном обучении.</span><span class="sxs-lookup"><span data-stu-id="cde2b-122">The failure was due to a lack of understanding of the base tool setting in Machine Learning.</span></span> <span data-ttu-id="cde2b-123">Связавшись с группой разработки машинного обучения, мы лучше поняли принцип действия базовых параметров, требуемых для наборов данных, и добились соответствия двух моделей.</span><span class="sxs-lookup"><span data-stu-id="cde2b-123">After a sync with the Machine Learning product team, we gained a better understanding of the base setting required for our data sets, and achieved parity between the two models.</span></span> 

### <a name="create-regression-model-in-excel"></a><span data-ttu-id="cde2b-124">Создание регрессионной модели в Excel</span><span class="sxs-lookup"><span data-stu-id="cde2b-124">Create regression model in Excel</span></span>
<span data-ttu-id="cde2b-125">Наш метод регрессии в Excel использует стандартную модель линейной регрессии, доступную в пакете анализа Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-125">Our Excel Regression used the standard linear regression model found in the Excel Analysis ToolPak.</span></span> 

<span data-ttu-id="cde2b-126">Мы вычислили *среднюю абсолютную погрешность в процентах* и использовали это значение в качестве меры производительности модели.</span><span class="sxs-lookup"><span data-stu-id="cde2b-126">We calculated *Mean Absolute % Error* and used it as the performance measure for the model.</span></span> <span data-ttu-id="cde2b-127">Создание рабочей модели с использованием Excel заняло 3 месяца.</span><span class="sxs-lookup"><span data-stu-id="cde2b-127">It took 3 months to arrive at a working model using Excel.</span></span> <span data-ttu-id="cde2b-128">Мы использовали многие методы обучения в эксперименте Студии машинного обучения, что в конечном счете помогло нам лучше понять требования.</span><span class="sxs-lookup"><span data-stu-id="cde2b-128">We brought much of the learning into the Machine Learning Studio experiment which ultimately was beneficial in understanding requirements.</span></span>

### <a name="create-comparable-experiment-in-azure-machine-learning"></a><span data-ttu-id="cde2b-129">Создание сравнительного эксперимента в Машинном обучении Azure</span><span class="sxs-lookup"><span data-stu-id="cde2b-129">Create comparable experiment in Azure Machine Learning</span></span>
<span data-ttu-id="cde2b-130">Чтобы создать эксперимент в Студии машинного обучения, мы выполнили такие шаги:</span><span class="sxs-lookup"><span data-stu-id="cde2b-130">We followed these steps to create our experiment in Machine Learning Studio:</span></span> 

1. <span data-ttu-id="cde2b-131">Передача набора данных в виде CSV-файла (очень маленького размера) в Студии машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="cde2b-131">Uploaded the dataset as a csv file to Machine Learning Studio (very small file)</span></span>
2. <span data-ttu-id="cde2b-132">Создание эксперимента и использование модуля [Select Columns in Dataset][select-columns] (Выбор столбцов в наборе данных) для выбора тех же признаков данных, что используются в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-132">Created a new experiment and used the [Select Columns in Dataset][select-columns] module to select the same data features used in Excel</span></span> 
3. <span data-ttu-id="cde2b-133">Использование модуля [Split Data][split] (Разделение данных) в режиме *относительного выражения*, чтобы разделить данные на точно такие же наборы данных для обучения, как в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-133">Used the [Split Data][split] module (with *Relative Expression* mode) to divide the data into the same training datasets as had been done in Excel</span></span> 
4. <span data-ttu-id="cde2b-134">Проведение эксперимента с модулем [Линейная регрессия][linear-regression] (только с параметрами по умолчанию), документирование и сравнение результатов с результатами модели регрессии Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-134">Experimented with the [Linear Regression][linear-regression] module (default options only), documented, and compared the results to our Excel regression model</span></span>

### <a name="review-initial-results"></a><span data-ttu-id="cde2b-135">Просмотр изначальных результатов</span><span class="sxs-lookup"><span data-stu-id="cde2b-135">Review initial results</span></span>
<span data-ttu-id="cde2b-136">Сначала модель Excel явно превзошла модель Студии машинного обучения:</span><span class="sxs-lookup"><span data-stu-id="cde2b-136">At first, the Excel model clearly outperformed the Machine Learning Studio model:</span></span> 

|  | <span data-ttu-id="cde2b-137">Excel</span><span class="sxs-lookup"><span data-stu-id="cde2b-137">Excel</span></span> | <span data-ttu-id="cde2b-138">Студия</span><span class="sxs-lookup"><span data-stu-id="cde2b-138">Studio</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="cde2b-139">Производительность</span><span class="sxs-lookup"><span data-stu-id="cde2b-139">Performance</span></span> | | |
| <ul style="list-style-type: none;"><li><span data-ttu-id="cde2b-140">Скорректированный коэффициент детерминации R-квадрат</span><span class="sxs-lookup"><span data-stu-id="cde2b-140">Adjusted R Square</span></span></li></ul> |<span data-ttu-id="cde2b-141">0,96</span><span class="sxs-lookup"><span data-stu-id="cde2b-141">0.96</span></span> |<span data-ttu-id="cde2b-142">Недоступно</span><span class="sxs-lookup"><span data-stu-id="cde2b-142">N/A</span></span> |
| <ul style="list-style-type: none;"><li><span data-ttu-id="cde2b-143">Коэффициент</span><span class="sxs-lookup"><span data-stu-id="cde2b-143">Coefficient of</span></span> <br /><span data-ttu-id="cde2b-144">определения</span><span class="sxs-lookup"><span data-stu-id="cde2b-144">Determination</span></span></li></ul> |<span data-ttu-id="cde2b-145">Недоступно</span><span class="sxs-lookup"><span data-stu-id="cde2b-145">N/A</span></span> |<span data-ttu-id="cde2b-146">0,78</span><span class="sxs-lookup"><span data-stu-id="cde2b-146">0.78</span></span><br /><span data-ttu-id="cde2b-147">(низкая точность)</span><span class="sxs-lookup"><span data-stu-id="cde2b-147">(low accuracy)</span></span> |
| <span data-ttu-id="cde2b-148">Средняя абсолютная погрешность</span><span class="sxs-lookup"><span data-stu-id="cde2b-148">Mean Absolute Error</span></span> |<span data-ttu-id="cde2b-149">9 500 000 долл. США</span><span class="sxs-lookup"><span data-stu-id="cde2b-149">$9.5M</span></span> |<span data-ttu-id="cde2b-150">19 400 000 долл. США</span><span class="sxs-lookup"><span data-stu-id="cde2b-150">$ 19.4M</span></span> |
| <span data-ttu-id="cde2b-151">Средняя абсолютная погрешность (в %)</span><span class="sxs-lookup"><span data-stu-id="cde2b-151">Mean Absolute Error (%)</span></span> |<span data-ttu-id="cde2b-152">6,03 %</span><span class="sxs-lookup"><span data-stu-id="cde2b-152">6.03%</span></span> |<span data-ttu-id="cde2b-153">12,2 %</span><span class="sxs-lookup"><span data-stu-id="cde2b-153">12.2%</span></span> |

<span data-ttu-id="cde2b-154">Когда мы объяснили принцип выполнения процесса и показали полученные результаты разработчикам и специалистам по обработке и анализу данных из группы разработки машинного обучения, они нам тут же дали несколько полезных советов.</span><span class="sxs-lookup"><span data-stu-id="cde2b-154">When we ran our process and results by the developers and data scientists on the Machine Learning team, they quickly provided some useful tips.</span></span> 

* <span data-ttu-id="cde2b-155">При использовании модуля [Линейная регрессия][linear-regression] в Студии машинного обучения доступно два метода:</span><span class="sxs-lookup"><span data-stu-id="cde2b-155">When you use the [Linear Regression][linear-regression] module in Machine Learning Studio, two methods are provided:</span></span>
  * <span data-ttu-id="cde2b-156">метод градиентного спуска в режиме онлайн — может подойти для крупномасштабных проблем;</span><span class="sxs-lookup"><span data-stu-id="cde2b-156">Online Gradient Descent: May be more suitable for larger-scale problems</span></span>
  * <span data-ttu-id="cde2b-157">метод наименьших квадратов — наиболее распространенный метод линейной регрессии.</span><span class="sxs-lookup"><span data-stu-id="cde2b-157">Ordinary Least Squares: This is the method most people think of when they hear linear regression.</span></span> <span data-ttu-id="cde2b-158">Это самый оптимальный выбор для небольших наборов данных.</span><span class="sxs-lookup"><span data-stu-id="cde2b-158">For small datasets, Ordinary Least Squares can be a more optimal choice.</span></span>
* <span data-ttu-id="cde2b-159">Для повышения производительности следует рассмотреть возможность изменения параметра «Вес регуляризации L2».</span><span class="sxs-lookup"><span data-stu-id="cde2b-159">Consider tweaking the L2 Regularization Weight parameter to improve performance.</span></span> <span data-ttu-id="cde2b-160">Его значение по умолчанию — 0,001. Чтобы повысить производительность, для небольшого набора данных мы установили значение 0,005.</span><span class="sxs-lookup"><span data-stu-id="cde2b-160">It is set to 0.001 by default, but for our small data set we set it to 0.005 to improve performance.</span></span> 

### <a name="mystery-solved"></a><span data-ttu-id="cde2b-161">Решение найдено!</span><span class="sxs-lookup"><span data-stu-id="cde2b-161">Mystery solved!</span></span>
<span data-ttu-id="cde2b-162">Последовав рекомендациям, нам удалось добиться тех же базовых показателей производительности в Студии машинного обучения, что и в Excel:</span><span class="sxs-lookup"><span data-stu-id="cde2b-162">When we applied the recommendations, we achieved the same baseline performance in Machine Learning Studio as with Excel:</span></span> 

|  | <span data-ttu-id="cde2b-163">Excel</span><span class="sxs-lookup"><span data-stu-id="cde2b-163">Excel</span></span> | <span data-ttu-id="cde2b-164">Студия (первоначальная версия)</span><span class="sxs-lookup"><span data-stu-id="cde2b-164">Studio (Initial)</span></span> | <span data-ttu-id="cde2b-165">Студия с методом наименьших квадратов</span><span class="sxs-lookup"><span data-stu-id="cde2b-165">Studio w/ Least Squares</span></span> |
| --- |:---:|:---:|:---:|
| <span data-ttu-id="cde2b-166">Значение с подписью</span><span class="sxs-lookup"><span data-stu-id="cde2b-166">Labeled value</span></span> |<span data-ttu-id="cde2b-167">Фактические значения (числовые)</span><span class="sxs-lookup"><span data-stu-id="cde2b-167">Actuals (numeric)</span></span> |<span data-ttu-id="cde2b-168">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-168">same</span></span> |<span data-ttu-id="cde2b-169">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-169">same</span></span> |
| <span data-ttu-id="cde2b-170">Ученик</span><span class="sxs-lookup"><span data-stu-id="cde2b-170">Learner</span></span> |<span data-ttu-id="cde2b-171">Excel -> "Анализ данных" -> "Регрессия"</span><span class="sxs-lookup"><span data-stu-id="cde2b-171">Excel -> Data Analysis -> Regression</span></span> |<span data-ttu-id="cde2b-172">Линейная регрессия</span><span class="sxs-lookup"><span data-stu-id="cde2b-172">Linear Regression.</span></span> |<span data-ttu-id="cde2b-173">Линейная регрессия</span><span class="sxs-lookup"><span data-stu-id="cde2b-173">Linear Regression</span></span> |
| <span data-ttu-id="cde2b-174">Параметры ученика</span><span class="sxs-lookup"><span data-stu-id="cde2b-174">Learner options</span></span> |<span data-ttu-id="cde2b-175">Недоступно</span><span class="sxs-lookup"><span data-stu-id="cde2b-175">N/A</span></span> |<span data-ttu-id="cde2b-176">Значения по умолчанию</span><span class="sxs-lookup"><span data-stu-id="cde2b-176">Defaults</span></span> |<span data-ttu-id="cde2b-177">Метод наименьших квадратов</span><span class="sxs-lookup"><span data-stu-id="cde2b-177">ordinary least squares</span></span><br /><span data-ttu-id="cde2b-178">L2 = 0,005</span><span class="sxs-lookup"><span data-stu-id="cde2b-178">L2 = 0.005</span></span> |
| <span data-ttu-id="cde2b-179">Набор данных</span><span class="sxs-lookup"><span data-stu-id="cde2b-179">Data Set</span></span> |<span data-ttu-id="cde2b-180">26 строк, 3 признака, 1 метка.</span><span class="sxs-lookup"><span data-stu-id="cde2b-180">26 rows, 3 features, 1 label.</span></span> <span data-ttu-id="cde2b-181">Все значения числовые.</span><span class="sxs-lookup"><span data-stu-id="cde2b-181">All numeric.</span></span> |<span data-ttu-id="cde2b-182">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-182">same</span></span> |<span data-ttu-id="cde2b-183">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-183">same</span></span> |
| <span data-ttu-id="cde2b-184">Разделение: обучение</span><span class="sxs-lookup"><span data-stu-id="cde2b-184">Split: Train</span></span> |<span data-ttu-id="cde2b-185">Обучение Excel выполнено по первым 18 строкам, тестирование — по последним 8 строкам.</span><span class="sxs-lookup"><span data-stu-id="cde2b-185">Excel trained on the first 18 rows, tested on the last 8 rows.</span></span> |<span data-ttu-id="cde2b-186">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-186">same</span></span> |<span data-ttu-id="cde2b-187">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-187">same</span></span> |
| <span data-ttu-id="cde2b-188">Разделение: тестирование</span><span class="sxs-lookup"><span data-stu-id="cde2b-188">Split: Test</span></span> |<span data-ttu-id="cde2b-189">Формула регрессии Excel применяется к последним 8 строкам.</span><span class="sxs-lookup"><span data-stu-id="cde2b-189">Excel regression formula applied to the last 8 rows</span></span> |<span data-ttu-id="cde2b-190">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-190">same</span></span> |<span data-ttu-id="cde2b-191">—||—</span><span class="sxs-lookup"><span data-stu-id="cde2b-191">same</span></span> |
| <span data-ttu-id="cde2b-192">**Производительность**</span><span class="sxs-lookup"><span data-stu-id="cde2b-192">**Performance**</span></span> | | | |
| <span data-ttu-id="cde2b-193">Скорректированный коэффициент детерминации R-квадрат</span><span class="sxs-lookup"><span data-stu-id="cde2b-193">Adjusted R Square</span></span> |<span data-ttu-id="cde2b-194">0,96</span><span class="sxs-lookup"><span data-stu-id="cde2b-194">0.96</span></span> |<span data-ttu-id="cde2b-195">Недоступно</span><span class="sxs-lookup"><span data-stu-id="cde2b-195">N/A</span></span> | |
| <span data-ttu-id="cde2b-196">Коэффициент детерминации</span><span class="sxs-lookup"><span data-stu-id="cde2b-196">Coefficient of Determination</span></span> |<span data-ttu-id="cde2b-197">Недоступно</span><span class="sxs-lookup"><span data-stu-id="cde2b-197">N/A</span></span> |<span data-ttu-id="cde2b-198">0,78</span><span class="sxs-lookup"><span data-stu-id="cde2b-198">0.78</span></span> |<span data-ttu-id="cde2b-199">0,952049</span><span class="sxs-lookup"><span data-stu-id="cde2b-199">0.952049</span></span> |
| <span data-ttu-id="cde2b-200">Средняя абсолютная погрешность</span><span class="sxs-lookup"><span data-stu-id="cde2b-200">Mean Absolute Error</span></span> |<span data-ttu-id="cde2b-201">9 500 000 долл. США</span><span class="sxs-lookup"><span data-stu-id="cde2b-201">$9.5M</span></span> |<span data-ttu-id="cde2b-202">19 400 000 долл. США</span><span class="sxs-lookup"><span data-stu-id="cde2b-202">$ 19.4M</span></span> |<span data-ttu-id="cde2b-203">9 500 000 долл. США</span><span class="sxs-lookup"><span data-stu-id="cde2b-203">$9.5M</span></span> |
| <span data-ttu-id="cde2b-204">Средняя абсолютная погрешность (в %)</span><span class="sxs-lookup"><span data-stu-id="cde2b-204">Mean Absolute Error (%)</span></span> |<span data-ttu-id="cde2b-205"><span style="background-color: 00FF00;"> 6,03 %</span></span><span class="sxs-lookup"><span data-stu-id="cde2b-205"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |<span data-ttu-id="cde2b-206">12,2 %</span><span class="sxs-lookup"><span data-stu-id="cde2b-206">12.2%</span></span> |<span data-ttu-id="cde2b-207"><span style="background-color: 00FF00;"> 6,03 %</span></span><span class="sxs-lookup"><span data-stu-id="cde2b-207"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |

<span data-ttu-id="cde2b-208">Кроме того, мы получили хорошие результаты сравнения коэффициентов Excel и веса признаков в обученной модели Azure:</span><span class="sxs-lookup"><span data-stu-id="cde2b-208">In addition, the Excel coefficients compared well to the feature weights in the Azure trained model:</span></span>

|  | <span data-ttu-id="cde2b-209">Коэффициенты Excel</span><span class="sxs-lookup"><span data-stu-id="cde2b-209">Excel Coefficients</span></span> | <span data-ttu-id="cde2b-210">Весовые коэффициенты компонентов Azure</span><span class="sxs-lookup"><span data-stu-id="cde2b-210">Azure Feature Weights</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="cde2b-211">Отрезок/смещение</span><span class="sxs-lookup"><span data-stu-id="cde2b-211">Intercept/Bias</span></span> |<span data-ttu-id="cde2b-212">19470209,88</span><span class="sxs-lookup"><span data-stu-id="cde2b-212">19470209.88</span></span> |<span data-ttu-id="cde2b-213">19328500</span><span class="sxs-lookup"><span data-stu-id="cde2b-213">19328500</span></span> |
| <span data-ttu-id="cde2b-214">Признак А</span><span class="sxs-lookup"><span data-stu-id="cde2b-214">Feature A</span></span> |<span data-ttu-id="cde2b-215">0,832653063</span><span class="sxs-lookup"><span data-stu-id="cde2b-215">0.832653063</span></span> |<span data-ttu-id="cde2b-216">0,834156</span><span class="sxs-lookup"><span data-stu-id="cde2b-216">0.834156</span></span> |
| <span data-ttu-id="cde2b-217">Признак Б</span><span class="sxs-lookup"><span data-stu-id="cde2b-217">Feature B</span></span> |<span data-ttu-id="cde2b-218">11071967,08</span><span class="sxs-lookup"><span data-stu-id="cde2b-218">11071967.08</span></span> |<span data-ttu-id="cde2b-219">11007300</span><span class="sxs-lookup"><span data-stu-id="cde2b-219">11007300</span></span> |
| <span data-ttu-id="cde2b-220">Признак В</span><span class="sxs-lookup"><span data-stu-id="cde2b-220">Feature C</span></span> |<span data-ttu-id="cde2b-221">25383318,09</span><span class="sxs-lookup"><span data-stu-id="cde2b-221">25383318.09</span></span> |<span data-ttu-id="cde2b-222">25140800</span><span class="sxs-lookup"><span data-stu-id="cde2b-222">25140800</span></span> |

## <a name="next-steps"></a><span data-ttu-id="cde2b-223">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="cde2b-223">Next Steps</span></span>
<span data-ttu-id="cde2b-224">Мы хотели использовать веб-службу машинного обучения в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-224">We wanted to consume the Machine Learning web service within Excel.</span></span> <span data-ttu-id="cde2b-225">Наши бизнес-аналитики полагаются на Excel, и нам нужно было найти способ вызвать веб-службу машинного обучения из строки данных Excel, чтобы она вернула спрогнозированное значение в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-225">Our business analysts rely on Excel and we needed a way to call the Machine Learning web service with a row of Excel data and have it return the predicted value to Excel.</span></span> 

<span data-ttu-id="cde2b-226">Мы также поставили перед собой задачу оптимизировать модель, используя параметры и алгоритмы, доступные в Студии машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="cde2b-226">We also wanted to optimize our model, using the options and algorithms available in Machine Learning Studio.</span></span>

### <a name="integration-with-excel"></a><span data-ttu-id="cde2b-227">Интеграция с Excel</span><span class="sxs-lookup"><span data-stu-id="cde2b-227">Integration with Excel</span></span>
<span data-ttu-id="cde2b-228">Наше решение должно было привести в действие модель регрессии машинного обучения за счет создания веб-службы из обученной модели.</span><span class="sxs-lookup"><span data-stu-id="cde2b-228">Our solution was to operationalize our Machine Learning regression model by creating a web service from the trained model.</span></span> <span data-ttu-id="cde2b-229">Мы создали веб-службу за несколько минут и смогли вызвать ее прямо из Excel, чтобы получить спрогнозированное значение дохода.</span><span class="sxs-lookup"><span data-stu-id="cde2b-229">Within a few minutes, the web service was created and we could call it directly from Excel to return a predicted revenue value.</span></span> 

<span data-ttu-id="cde2b-230">В разделе *Web Services Dashboard* (Панель мониторинга веб-служб) содержится книга Excel, которую можно скачать.</span><span class="sxs-lookup"><span data-stu-id="cde2b-230">The *Web Services Dashboard* section includes a downloadable Excel workbook.</span></span> <span data-ttu-id="cde2b-231">Эта книга предварительно отформатирована с помощью API веб-службы, и в нее внедрена информация о схемах.</span><span class="sxs-lookup"><span data-stu-id="cde2b-231">The workbook comes pre-formatted with the web service API and schema information embedded.</span></span> <span data-ttu-id="cde2b-232">Чтобы скачать книгу, щелкните *Download Excel Workbook* (Скачать книгу Excel). Она откроется, и ее можно будет сохранить на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="cde2b-232">When you click *Download Excel Workbook*, the workbook opens and you can save it to your local computer.</span></span> 

![][1]

<span data-ttu-id="cde2b-233">Пока книга открыта, скопируйте предопределенные параметры в синий раздел «Параметры», показанный ниже.</span><span class="sxs-lookup"><span data-stu-id="cde2b-233">With the workbook open, copy your predefined parameters into the blue Parameter section as shown below.</span></span> <span data-ttu-id="cde2b-234">После ввода параметров Excel вызовет веб-службу машинного обучения, а в зеленом разделе "Спрогнозированные значения" отобразятся спрогнозированные оцененные метки.</span><span class="sxs-lookup"><span data-stu-id="cde2b-234">Once the parameters are entered, Excel calls out to the Machine Learning web service and the predicted scored labels will display in the green Predicted Values section.</span></span> <span data-ttu-id="cde2b-235">Книга продолжит создавать спрогнозированные значения параметров для всех элементов строк, введенных в разделе «Параметры», на основе обученной модели.</span><span class="sxs-lookup"><span data-stu-id="cde2b-235">The workbook will continue to create predictions for parameters based on your trained model for all row items entered under Parameters.</span></span> <span data-ttu-id="cde2b-236">Дополнительные сведения об использовании этой функции см. в статье [Использование веб-службы Машинного обучения Azure в Excel](machine-learning-consuming-from-excel.md).</span><span class="sxs-lookup"><span data-stu-id="cde2b-236">For more information on how to use this feature, see [Consuming an Azure Machine Learning Web Service from Excel](machine-learning-consuming-from-excel.md).</span></span> 

![][2]

### <a name="optimization-and-further-experiments"></a><span data-ttu-id="cde2b-237">Оптимизация и дальнейшие эксперименты</span><span class="sxs-lookup"><span data-stu-id="cde2b-237">Optimization and further experiments</span></span>
<span data-ttu-id="cde2b-238">Определив необходимую модель Excel, мы приступили к оптимизации модели линейной регрессии машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="cde2b-238">Now that we had a baseline with our Excel model, we moved ahead to optimize our Machine Learning Linear Regression Model.</span></span> <span data-ttu-id="cde2b-239">Мы использовали модуль [Filter-Based Feature Selection][filter-based-feature-selection] (Выбор признаков на основе фильтра), чтобы усовершенствовать выбор исходных элементов данных, и это помогло нам добиться повышения производительности — коэффициент средней абсолютной погрешности достиг отметки 4,6 %.</span><span class="sxs-lookup"><span data-stu-id="cde2b-239">We used the module [Filter-Based Feature Selection][filter-based-feature-selection] to improve on our selection of initial data elements and it helped us achieve a performance improvement of 4.6% Mean Absolute Error.</span></span> <span data-ttu-id="cde2b-240">Мы будем использовать эту функцию в будущих проектах, что позволит нам сэкономить несколько недель выполнения итерации атрибутов данных для поиска правильного набора признаков, которые будут использоваться для моделирования.</span><span class="sxs-lookup"><span data-stu-id="cde2b-240">For future projects we will use this feature which could save us weeks in iterating through data attributes to find the right set of features to use for modelling.</span></span> 

<span data-ttu-id="cde2b-241">Далее мы планируем включить в эксперимент дополнительные алгоритмы, такие как [байесовский][bayesian-linear-regression] алгоритм или [увеличивающиеся деревья принятия решений][boosted-decision-tree-regression], для сравнения производительности.</span><span class="sxs-lookup"><span data-stu-id="cde2b-241">Next we plan to include additional algorithms like [Bayesian][bayesian-linear-regression] or [Boosted Decision Trees][boosted-decision-tree-regression] in our experiment to compare performance.</span></span> 

<span data-ttu-id="cde2b-242">Если вы хотите поэкспериментировать с регрессией, попробуйте использовать пример набора данных регрессии энергетического КПД. Он отлично подходит для этого и содержит множество числовых атрибутов.</span><span class="sxs-lookup"><span data-stu-id="cde2b-242">If you want to experiment with regression, a good dataset to try is the Energy Efficiency Regression sample dataset, which has lots of numerical attributes.</span></span> <span data-ttu-id="cde2b-243">Этот набор данных входит в состав примеров наборов данных Студии машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="cde2b-243">The dataset is provided as part of the sample datasets in Machine Learning Studio.</span></span> <span data-ttu-id="cde2b-244">Вы можете использовать множество модулей обучения для прогнозирования отопительной нагрузки или нагрузки по охлаждению.</span><span class="sxs-lookup"><span data-stu-id="cde2b-244">You can use a variety of learning modules to predict either Heating Load or Cooling Load.</span></span> <span data-ttu-id="cde2b-245">В таблице ниже сравнена производительность различных регрессионных моделей обучения и набора данных энергетического КПД для прогнозирования целевой переменной нагрузки по охлаждению:</span><span class="sxs-lookup"><span data-stu-id="cde2b-245">The chart below is a performance comparison of different regression learns against the Energy Efficiency dataset predicting for the target variable Cooling Load:</span></span> 

| <span data-ttu-id="cde2b-246">Модель</span><span class="sxs-lookup"><span data-stu-id="cde2b-246">Model</span></span> | <span data-ttu-id="cde2b-247">Средняя абсолютная погрешность</span><span class="sxs-lookup"><span data-stu-id="cde2b-247">Mean Absolute Error</span></span> | <span data-ttu-id="cde2b-248">Среднеквадратическая погрешность</span><span class="sxs-lookup"><span data-stu-id="cde2b-248">Root Mean Squared Error</span></span> | <span data-ttu-id="cde2b-249">Относительная абсолютная погрешность</span><span class="sxs-lookup"><span data-stu-id="cde2b-249">Relative Absolute Error</span></span> | <span data-ttu-id="cde2b-250">Относительная среднеквадратическая погрешность</span><span class="sxs-lookup"><span data-stu-id="cde2b-250">Relative Squared Error</span></span> | <span data-ttu-id="cde2b-251">Коэффициент детерминации</span><span class="sxs-lookup"><span data-stu-id="cde2b-251">Coefficient of Determination</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="cde2b-252">Увеличивающееся дерево принятия решений</span><span class="sxs-lookup"><span data-stu-id="cde2b-252">Boosted Decision Tree</span></span> |<span data-ttu-id="cde2b-253">0,930113</span><span class="sxs-lookup"><span data-stu-id="cde2b-253">0.930113</span></span> |<span data-ttu-id="cde2b-254">1,4239</span><span class="sxs-lookup"><span data-stu-id="cde2b-254">1.4239</span></span> |<span data-ttu-id="cde2b-255">0,106647</span><span class="sxs-lookup"><span data-stu-id="cde2b-255">0.106647</span></span> |<span data-ttu-id="cde2b-256">0,021662</span><span class="sxs-lookup"><span data-stu-id="cde2b-256">0.021662</span></span> |<span data-ttu-id="cde2b-257">0,978338</span><span class="sxs-lookup"><span data-stu-id="cde2b-257">0.978338</span></span> |
| <span data-ttu-id="cde2b-258">Линейная регрессия (метод градиентного спуска)</span><span class="sxs-lookup"><span data-stu-id="cde2b-258">Linear Regression (Gradient Descent)</span></span> |<span data-ttu-id="cde2b-259">2,035693</span><span class="sxs-lookup"><span data-stu-id="cde2b-259">2.035693</span></span> |<span data-ttu-id="cde2b-260">2,98006</span><span class="sxs-lookup"><span data-stu-id="cde2b-260">2.98006</span></span> |<span data-ttu-id="cde2b-261">0,233414</span><span class="sxs-lookup"><span data-stu-id="cde2b-261">0.233414</span></span> |<span data-ttu-id="cde2b-262">0,094881</span><span class="sxs-lookup"><span data-stu-id="cde2b-262">0.094881</span></span> |<span data-ttu-id="cde2b-263">0,905119</span><span class="sxs-lookup"><span data-stu-id="cde2b-263">0.905119</span></span> |
| <span data-ttu-id="cde2b-264">Регрессия нейронной сети</span><span class="sxs-lookup"><span data-stu-id="cde2b-264">Neural Network Regression</span></span> |<span data-ttu-id="cde2b-265">1,548195</span><span class="sxs-lookup"><span data-stu-id="cde2b-265">1.548195</span></span> |<span data-ttu-id="cde2b-266">2,114617</span><span class="sxs-lookup"><span data-stu-id="cde2b-266">2.114617</span></span> |<span data-ttu-id="cde2b-267">0,177517</span><span class="sxs-lookup"><span data-stu-id="cde2b-267">0.177517</span></span> |<span data-ttu-id="cde2b-268">0,047774</span><span class="sxs-lookup"><span data-stu-id="cde2b-268">0.047774</span></span> |<span data-ttu-id="cde2b-269">0,952226</span><span class="sxs-lookup"><span data-stu-id="cde2b-269">0.952226</span></span> |
| <span data-ttu-id="cde2b-270">Линейная регрессия (метод наименьших квадратов)</span><span class="sxs-lookup"><span data-stu-id="cde2b-270">Linear Regression (Ordinary Least Squares)</span></span> |<span data-ttu-id="cde2b-271">1,428273</span><span class="sxs-lookup"><span data-stu-id="cde2b-271">1.428273</span></span> |<span data-ttu-id="cde2b-272">1,984461</span><span class="sxs-lookup"><span data-stu-id="cde2b-272">1.984461</span></span> |<span data-ttu-id="cde2b-273">0,163767</span><span class="sxs-lookup"><span data-stu-id="cde2b-273">0.163767</span></span> |<span data-ttu-id="cde2b-274">0,042074</span><span class="sxs-lookup"><span data-stu-id="cde2b-274">0.042074</span></span> |<span data-ttu-id="cde2b-275">0,957926</span><span class="sxs-lookup"><span data-stu-id="cde2b-275">0.957926</span></span> |

## <a name="key-takeaways"></a><span data-ttu-id="cde2b-276">Общие выводы</span><span class="sxs-lookup"><span data-stu-id="cde2b-276">Key Takeaways</span></span>
<span data-ttu-id="cde2b-277">Параллельное выполнение экспериментов Машинного обучения Azure и регрессии Excel позволило узнать много нового.</span><span class="sxs-lookup"><span data-stu-id="cde2b-277">We learned a lot by from running Excel regression and Azure Machine Learning experiments in parallel.</span></span> <span data-ttu-id="cde2b-278">Создание базовой модели в Excel и ее сравнение с моделями с использованием [линейной регрессии][linear-regression] машинного обучения помогло нам изучить Машинное обучение Azure. Кроме того, мы обнаружили возможности усовершенствования выбора данных и повышения производительности модели.</span><span class="sxs-lookup"><span data-stu-id="cde2b-278">Creating the baseline model in Excel and comparing it to models using Machine Learning [Linear Regression][linear-regression] helped us learn Azure Machine Learning, and we discovered opportunities to improve data selection and model performance.</span></span> 

<span data-ttu-id="cde2b-279">Мы также поняли, что в будущем для более быстрого получения результатов по проектам прогнозирования целесообразно использовать модуль [Filter-Based Feature Selection][filter-based-feature-selection] (Выбор признаков на основе фильтра).</span><span class="sxs-lookup"><span data-stu-id="cde2b-279">We also found that it is advisable to use [Filter-Based Feature Selection][filter-based-feature-selection] to accelerate future prediction projects.</span></span> <span data-ttu-id="cde2b-280">Применив выбор признаков к данным, можно создать улучшенную модель машинного обучения с более высокой общей производительностью.</span><span class="sxs-lookup"><span data-stu-id="cde2b-280">By applying feature selection to your data, you can create an improved model in Machine Learning with better overall performance.</span></span> 

<span data-ttu-id="cde2b-281">Возможность систематической передачи аналитических прогнозов из машинного обучения в Excel позволяет значительно увеличить способность успешного предоставления результатов широкой аудитории бизнес-пользователей.</span><span class="sxs-lookup"><span data-stu-id="cde2b-281">The ability to transfer the predictive analytic forecasting from Machine Learning to Excel systemically allows a significant increase in the ability to successfully provide results to a broad business user audience.</span></span> 

## <a name="resources"></a><span data-ttu-id="cde2b-282">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="cde2b-282">Resources</span></span>
<span data-ttu-id="cde2b-283">Ниже перечислены некоторые ресурсы, которые помогут вам в работе с регрессией.</span><span class="sxs-lookup"><span data-stu-id="cde2b-283">Here are some resources for helping you work with regression:</span></span> 

* <span data-ttu-id="cde2b-284">Регрессия в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-284">Regression in Excel.</span></span> <span data-ttu-id="cde2b-285">Если вы никогда не работали с регрессией в Excel, этот учебник упростит задачу: [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span><span class="sxs-lookup"><span data-stu-id="cde2b-285">If you’ve never tried regression in Excel, this tutorial makes it easy: [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span></span>
* <span data-ttu-id="cde2b-286">Сравнение регрессии и прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="cde2b-286">Regression vs forecasting.</span></span> <span data-ttu-id="cde2b-287">Тайлер Чессмен (Tyler Chessman) написал статью в блоге, в которой он рассказывает, как спрогнозировать временные ряды в Excel.</span><span class="sxs-lookup"><span data-stu-id="cde2b-287">Tyler Chessman wrote a blog article explaining how to do time series forecasting in Excel, which contains a good beginner’s description of linear regression.</span></span> <span data-ttu-id="cde2b-288">Здесь также представлено хорошее описание линейной регрессии для начинающих: [http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts](http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts).</span><span class="sxs-lookup"><span data-stu-id="cde2b-288">[http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts](http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts)</span></span> 
* <span data-ttu-id="cde2b-289">Линейная регрессия по методу наименьших квадратов. Недостатки, проблемы и ошибки.</span><span class="sxs-lookup"><span data-stu-id="cde2b-289">Ordinary Least Squares Linear Regression: Flaws, Problems and Pitfalls.</span></span> <span data-ttu-id="cde2b-290">Введение в регрессию и ее обсуждение см. по адресу [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/).</span><span class="sxs-lookup"><span data-stu-id="cde2b-290">For an introduction and discussion of Regression: [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span></span>

[1]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-1.png
[2]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-2.png


<!-- Module References -->
[bayesian-linear-regression]: https://msdn.microsoft.com/library/azure/ee12de50-2b34-4145-aec0-23e0485da308/
[boosted-decision-tree-regression]: https://msdn.microsoft.com/library/azure/0207d252-6c41-4c77-84c3-73bdf1ac5960/
[filter-based-feature-selection]: https://msdn.microsoft.com/library/azure/918b356b-045c-412b-aa12-94a1d2dad90f/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/

