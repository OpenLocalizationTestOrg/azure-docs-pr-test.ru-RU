---
title: "Настройка виртуальной машины как сервера IPython Notebook | Документация Майкрософт"
description: "Настройка виртуальной машины Azure для использования в среде обработки и анализа данных с сервером IPython для расширенной аналитики."
services: machine-learning
documentationcenter: 
author: bradsev
manager: cgronlun
editor: cgronlun
ms.assetid: 818617c1-048e-49c2-b941-f9a983f93998
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/04/2017
ms.author: xibingao;bradsev
ms.openlocfilehash: b32aa2325a507f18ffc8b47cddde8637a0a8aabf
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="set-up-an-azure-virtual-machine-as-an-ipython-notebook-server-for-advanced-analytics"></a>Настройка виртуальной машины Azure как сервера IPython Notebook для расширенной аналитики
В этой статье объясняется, как подготовить и настроить виртуальную машину Azure для расширенной аналитики, чтобы она стала частью среды обработки и анализа данных. Виртуальная машина Windows включает в себя вспомогательные средства IPython Notebook, Azure Storage Explorer, AzCopy и другие служебные программы, полезные для проектов расширенной аналитики. Обозреватель хранилищ Azure и AzCopy, например, позволяют с легкостью передавать данные в хранилище BLOB-объектов Azure с локального компьютера и наоборот.

## <a name="create-vm"></a>Шаг 1. Создание виртуальной машины Azure общего назначения
Если у вас уже есть виртуальная машина Azure и осталось только настроить на ней сервер IPython Notebook, можно пропустить этот шаг и перейти сразу на [Шаг 2. Добавление конечной точки для IPython Notebook к существующей виртуальной машине](#add-endpoint).

Прежде чем создавать в Azure виртуальную машину, определитесь с тем, какой у нее должен быть размер, чтобы успешно обрабатывать данные в рамках своих проектов. У небольших машин меньше памяти и ядер ЦП, чем у больших, но они менее дорогие. Сведения о ценах и типах машин см. на странице <a href="http://azure.microsoft.com/pricing/details/virtual-machines/" target="_blank">Цены на виртуальные машины</a>.

1. Войдите на <a href="https://manage.windowsazure.com" target="_blank">классический портал Azure</a> и в левом нижнем углу нажмите кнопку **Создать**. Откроется новое окно. Выберите **Среда выполнения приложений** -> **Виртуальная машина** -> **Из коллекции**.
   
    ![Создание рабочей области][24]
2. Выберите один из образов:
   
   * Центр обработки данных Windows Server 2012 R2
   * Режим Windows Server Essentials (Windows Server 2012 R2).
     
     Затем, чтобы перейти на следующую страницу конфигурации, щелкните в правом нижнем углу стрелку вправо.
     
     ![Создание рабочей области][25]
3. Введите имя виртуальной машины, которую вы хотите создать, выберите размер машины (значение по умолчанию: A3), исходя из размера данных, которые машина будет обрабатывать, и желаемой мощности машины (объем памяти и количество ядер), введите имя пользователя и пароль для машины. Затем, чтобы перейти на следующую страницу конфигурацию, щелкните стрелку вправо.
   
    ![Создание рабочей области][26]
4. Выберите в поле **Регион, территориальная группа, виртуальная сеть** значение, соответствующее учетной записи хранения, которую вы планируете использовать для этой виртуальной машины, а затем выберите нужное значение в поле **Учетная запись хранения**. Добавьте конечную точку внизу в поле **Конечные точки**, указав ее имя (в нашем случае это IPython). Вы можете выбрать любую строку в качестве **имени** конечной точки и любое **доступное** целое число от 0 до 65536 в качестве номера **общего порта**. В столбце **Частный порт** должен быть номер **9999**. **Не следует** использовать общие порты, уже назначенные для служб Интернета. В таблице <a href="http://www.chebucto.ns.ca/~rakerman/port-table.html" target="_blank">Порты для служб Интернета</a> приведен список портов, которые не следует использовать, так как они уже назначены.
   
    ![Создание рабочей области][27]
5. Нажмите кнопку с флажком, чтобы начать подготовку виртуальной машины.
   
    ![Создание рабочей области][28]

Подготовка может занять 15–25 минут. Состояние созданной виртуальной машины должно быть таким: **Выполняется**.

![Создание рабочей области][29]

## <a name="add-endpoint"></a>Шаг 2. Добавление конечной точки для IPython Notebook к существующей виртуальной машине
Если вы создали виртуальную машину, следуя инструкциям шага 1, то конечная точка для IPython Notebook уже создана и текущий шаг можно пропустить.

Если виртуальная машина уже существует и нужно добавить конечную точку для сервера IPython Notebook, который вы установите на шаге 3, сначала войдите на классический портал Azure, выберите виртуальную машину и добавьте конечную точку для сервера IPython Notebook. Рисунок ниже — это снимок экрана, на котором показано состояние портала после того, как конечная точка для IPython Notebook была добавлена в виртуальную машину Windows.

![Создание рабочей области][17]

## <a name="run-commands"></a>Шаг 3. Установка IPython Notebook и других вспомогательных средств
Чтобы войти в созданную виртуальную машину Windows, используйте протокол удаленного рабочего стола (RDP). Инструкции см. в статье [Вход в виртуальную машину под управлением Windows с помощью классического портала Azure](../../virtual-machines/windows/classic/connect-logon.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json). Откройте **командную строку** (**не командное окно Powershell**) с правами **администратора** и выполните приведенную ниже команду.

    set script='https://raw.githubusercontent.com/Azure/Azure-MachineLearning-DataScience/master/Misc/MachineSetup/Azure_VM_Setup_Windows.ps1'

    @powershell -NoProfile -ExecutionPolicy unrestricted -Command "iex ((new-object net.webclient).DownloadString(%script%))"

По завершении установки сервер IPython Notebook автоматически запустится из каталога *C:\\Users\\\<имя пользователя\>\\Documents\\IPython Notebooks*.

Когда появится запрос, введите пароль для IPython Notebook и пароль администратора виртуальной машины. Это позволит серверу IPython Notebook на виртуальной машине работать как служба.

## <a name="access"></a>Шаг 4. Доступ к IPython Notebook из веб-браузера
Чтобы попасть на сервер IPython Notebook, откройте веб-браузер и в текстовом поле URL-адреса введите *https://:&#60;DNS-имя виртуальной машины>:&#60;номер общего порта>*, где *&#60;номер общего порта>* — это номер порта, указанный при добавлении конечной точки IPython Notebook.

*&#60;DNS-имя виртуальной машины>* можно найти на классическом портале Azure. Войдя на классический портал, щелкните **Виртуальные машины**, выберите созданную машину, а затем щелкните **Панель мониторинга**. Отобразится DNS-имя, как показано ниже.

![Создание рабочей области][19]

Появится предупреждение с текстом *Возникла проблема с сертификатом безопасности этого веб-сайта* (Internet Explorer) или *Your connection is not private* (Ваше подключение не защищено) (Chrome), как показано на рисунках ниже. Чтобы продолжить, щелкните **Продолжить открытие этого веб-узла (не рекомендуется)** (Internet Explorer) или **Дополнительно**, а затем — **Перейти к &#60;*DNS-имя*> (небезопасно)** (Chrome). После этого введите пароль, указанный ранее для доступа к IPython Notebook.

**Internet Explorer:**
![Создание рабочей области][20]

**Chrome:**
![Создание рабочей области][21]

Когда вы войдете на сервер IPython Notebook, в браузере отобразится каталог *DataScienceSamples* . В этом каталоге находятся образцы IPython Notebook, которые мы бесплатно предоставляем пользователям, чтобы помочь им с обработкой и анализом данных. Эти примеры объектов IPython Notebook извлекаются из [**репозитория GitHub**](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/iPythonNotebooks) в виртуальные машины во время настройки сервера IPython Notebook. Мы обслуживаем и обновляем этот репозиторий на постоянной основе. В нем пользователи могут найти самые последние версии примеров объектов IPython Notebook.
![Создание рабочей области][18]

## <a name="upload"></a>Шаг 5. Передача существующей записной книжки IPython Notebook с локального компьютера на сервер IPython Notebook
Вы можете с легкостью передать существующую записную книжку IPython Notebook с локального компьютера на виртуальную машину с сервером IPython Notebook. Войдя на сервер IPython Notebook из веб-браузера, выберите **каталог**, в который будет передана записная книжка IPython Notebook. Затем выберите в **проводнике**IPYNB-файл, который нужно передать с локального компьютера, и перетащите этот файл в каталог IPython Notebook в веб-браузере. Чтобы отправить IPYNB-файл на сервер IPython Notebook, нажмите кнопку **Загрузить** . После этого другие люди смогут пользоваться этим файлом из своих веб-браузеров.

![Создание рабочей области][22]

![Создание рабочей области][23]

## <a name="shutdown"></a>Завершение работы и отмена распределения памяти для виртуальной машины, когда она не используется
За виртуальные машины Azure вы **платите только по факту использования**. Чтобы вам не выставляли счета за неиспользуемую виртуальную машину, она должна находиться в состоянии **Остановлена (освобождена)** .

> [!NOTE]
> Если отключить виртуальную машину средствами управления электропитанием Windows, она будет остановлена, но память для нее по-прежнему будет выделена. Чтобы избежать начисления оплаты, всегда останавливайте виртуальные машины на [классическом портале Azure](http://manage.windowsazure.com/). Кроме того, вы можете остановить виртуальную машину из командной строки Powershell, вызвав команду **ShutdownRoleOperation** и указав для параметра PostShutdownAction значение StoppedDeallocated.
> 
> 

Вот как можно выключить виртуальную машину и отменить для нее распределение памяти:

1. Войдите на [классический портал Azure](http://manage.windowsazure.com/), используя свою учетную запись.  
2. На панели навигации слева выберите **ВИРТУАЛЬНЫЕ МАШИНЫ** .
3. В списке виртуальных машин выберите свою и перейдите на страницу **ПАНЕЛЬ МОНИТОРИНГА** .
4. В нижней части страницы нажмите кнопку **ЗАВЕРШЕНИЕ РАБОТЫ**.

![Завершение работы виртуальной машины][15]

Распределение памяти для виртуальной машины будет отменено, но сама виртуальная машина останется. Виртуальную машину можно в любое время перезапустить на классическом портале Azure.

## <a name="your-azure-vm-is-ready-to-use-whats-next"></a>Виртуальная машина Azure готова к использованию: что дальше
Теперь вы можете использовать свою виртуальную машину для обработки и анализа данных. Кроме того, ее можно использовать в качестве сервера IPython Notebook для изучения и обработки данных, а также для других задач, связанных с Машинным обучением Azure и процессом обработки и анализа данных группы.

Дальнейшие действия процесса обработки и анализа данных группы отражены в [схеме обучения](https://azure.microsoft.com/documentation/learning-paths/cortana-analytics-process/). Они могут включать в себя операции с перемещением данных в HDInsight, их обработкой и выборкой для подготовки к обучению по данным с помощью Машинного обучения Azure.

[15]: ./media/setup-virtual-machine/vmshutdown.png
[17]: ./media/setup-virtual-machine/add-endpoints-after-creation.png
[18]: ./media/setup-virtual-machine/sample-ipnbs.png
[19]: ./media/setup-virtual-machine/dns-name-and-host-name.png
[20]: ./media/setup-virtual-machine/browser-warning-ie.png
[21]: ./media/setup-virtual-machine/browser-warning.png
[22]: ./media/setup-virtual-machine/upload-ipnb-1.png
[23]: ./media/setup-virtual-machine/upload-ipnb-2.png
[24]: ./media/setup-virtual-machine/create-virtual-machine-1.png
[25]: ./media/setup-virtual-machine/create-virtual-machine-2.png
[26]: ./media/setup-virtual-machine/create-virtual-machine-3.png
[27]: ./media/setup-virtual-machine/create-virtual-machine-4.png
[28]: ./media/setup-virtual-machine/create-virtual-machine-5.png
[29]: ./media/setup-virtual-machine/create-virtual-machine-6.png
