---
title: "aaaExecute Python машинного самообучения, скрипты | Документы Microsoft"
description: "Описываются принципы проектирования, лежащие в основе поддержки сценариев Python в Машинном обучении Azure, а также основные сценарии использования, возможности и ограничения."
keywords: "машинное обучение Python, pandas, python pandas, сценарии python, выполнение сценариев python"
services: machine-learning
documentationcenter: 
author: bradsev
manager: jhubbard
editor: cgronlun
ms.assetid: ee9eb764-0d3e-4104-a797-19fc29345d39
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: bradsev
ms.openlocfilehash: 8d23aaa972a46cb1a07ea0f18cc1e24933fe3e6f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="execute-python-machine-learning-scripts-in-azure-machine-learning-studio"></a>Выполнение сценариев Python в Студии машинного обучения Azure

В этом разделе описывает принципы разработки hello базовый hello текущая поддержка сценариев Python в машинном обучении Azure. также описаны Hello основных возможностей, включая:

- выполнение базовых сценариев использования;
- оценка эксперимента в веб-службе;
- поддержка импорта имеющегося кода;
- экспорт визуализаций;
- выполнение контролируемого выбора компонентов;
- ознакомление с некоторыми ограничениями.

[Python](https://www.python.org/) незаменимый инструмент в набор инструментов hello объекта многие специалисты по анализу данных. Он имеет:

* изящный и краткий синтаксис; 
* кроссплатформенную поддержку; 
* обширную коллекцию мощных библиотек; 
* современные средства разработки. 

Python используется на всех этапах рабочего процесса, обычно применяемых в моделировании машинного обучения:

- прием и обработка данных; 
- создание компонентов;
- обучение моделей; 
- проверка моделей;
- Развертывание моделей hello

Студия машинного обучения Azure позволяет внедрять сценарии Python в различных частях эксперимента машинного обучения, а также легко опубликовывать их в качестве веб-служб в Microsoft Azure.

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]


## <a name="design-principles-of-python-scripts-in-machine-learning"></a>Принципы проектирования сценариев Python в машинном обучении

tooPython основной интерфейс Hello в студии машинного обучения Azure можно с помощью hello [выполнение сценария Phyton] [ execute-python-script] модуль показано на рисунке 1.

![рисунок 1](./media/machine-learning-execute-python-scripts/execute-machine-learning-python-scripts-module.png)

![рисунок 2](./media/machine-learning-execute-python-scripts/embedded-machine-learning-python-script.png)

Рисунок 1. Hello **выполнение сценария Phyton** модуля.

Hello [выполнение сценария Phyton] [ execute-python-script] модуль в Azure ML Studio принимает оказаться toothree входные данные и создает копии tootwo выходные данные (как описано в следующем разделе hello), как его аналог R hello [ Выполнение скрипта R] [ execute-r-script] модуля. Hello выполнения toobe кода Python, вводится в поле параметра hello как специально именованную точки входа функции, вызываемой `azureml_main`. Ниже приведены ключевые особенности hello принципов, используемых tooimplement этот модуль.

1. *Привычность для пользователей Python.* Большинство пользователей Python видят свой код как функции внутри модулей, поэтому они достаточно редко помещают множество исполняемых операторов в модуль верхнего уровня. В результате поле скрипта hello также принимает специально именованная функция Python как противоположность toojust последовательность инструкций. Hello объекты, предоставленные в функции hello являются стандартных типов библиотек Python например [Pandas](http://pandas.pydata.org/) кадров данных и [NumPy](http://www.numpy.org/) массивов.
2. *Высокая точность при выполнении в локальной и облачной среде.* Hello hello tooexecute используется внутренний код Python основан на [Anaconda](https://store.continuum.io/cshop/anaconda/), широко используемый кросс платформенных научных распространения Python. Он поставляется с закрыть too200 hello наиболее распространенные пакеты Python. Таким образом, специалисты по обработке и анализу данных могут отладить код и обеспечить его работу в своей локальной среде Anaconda, совместимой с Машинным обучением Azure. Использовать существующую среду разработки, например [IPython](http://ipython.org/) записной книжке или [средства Python для Visual Studio](http://aka.ms/ptvs), toorun его как часть эксперимента машинного Обучения Azure. Hello `azureml_main` точкой входа является соответствующего ванили функции Python и поэтому *** могут быть созданы без Azure ML код или hello установленный пакет SDK.
3. *Простота при совместном использовании с другими модулями Машинного обучения Azure.* Hello [выполнение сценария Phyton] [ execute-python-script] модуль принимает в качестве входных и выходных данных, наборы данных стандартные машинного обучения Azure. Базовая архитектура Hello прозрачно и эффективно ликвидирует hello сред выполнения машинного Обучения Azure и Python. Поэтому Python можно использовать в сочетании с существующими рабочими процессами Машинного обучения Azure, включая те, которые вызывают R и SQLite. В результате специалист по анализу и обработке данных может составить рабочие процессы:
   * использующие Python и Pandas для предварительной обработки и очистки данных;
   * веб-канал hello tooa SQL преобразования данных, присоединение несколько компонентов tooform наборов данных
   * Обучение моделей с помощью алгоритмов hello в машинном обучении Azure 
   * Оценка и последующей обработки результатов hello, с помощью языка R.


## <a name="basic-usage-scenarios-in-ml-for-python-scripts"></a>Базовые сценарии использование для сценариев Python в машинном обучении

В этом разделе мы опрос некоторые hello основные варианты использования hello [выполнение сценария Phyton] [ execute-python-script] модуля. Модуль Python toohello входные данные представлены как Pandas кадров данных. Hello функция должна возвращать один кадр данных Pandas упакованные внутри Python [последовательности](https://docs.python.org/2/c-api/sequence.html) например кортежа, список или массив NumPy. затем возвращается hello первый выходной порт модуля hello Hello первый элемент этой последовательности. Схема этого процесса показана на рис. 2.

![image3](./media/machine-learning-execute-python-scripts/map-of-python-script-inputs-outputs.png)

Рис. 2. Сопоставление входных портов tooparameters и возвращаемое значение toooutput порта.

Более подробные семантика hello входных портов, как получить сопоставленных tooparameters hello `azureml_main` функции показаны в таблице 1:

![image1T](./media/machine-learning-execute-python-scripts/python-script-inputs-mapped-to-parameters.png)

Таблица 1. Сопоставление параметров toofunction входных портов.

Сопоставление входных портов и параметров функции Hello является позиционным:

- Первый Hello подключенных входного порта — сопоставленных toohello первый параметр функции hello. 
- Hello вторых входных данных (Если подключен) — сопоставленных toohello второй параметр функции hello.

В разделе *Python для анализа данных* (O'Reilly, 2012 г.), Западная McKinney подробнее на Python Pandas и как его можно использовать toomanipulate данных эффективно и рационально. 


## <a name="translation-of-input-and-output-types"></a>Преобразование типов входных и выходных данных 
Входные наборы данных в Azure ML — это преобразованное toodata кадры в Pandas. Кадры данных выходные данные преобразуются задней tooAzure ML наборов данных. выполняются следующие преобразования Hello.

1. Строковые и числовые столбцы преобразуются как-— и отсутствующих значений в наборе данных, преобразованных too'NA "значения в Pandas. Hello одного преобразования происходит на запомнен hello (NA значений в Pandas — toomissing преобразованные значения в Azure ML).
2. Векторы индексов в Pandas не поддерживаются в Машинном обучении Azure. Все кадры входных данных в функции hello Python всегда имеют 64-разрядных числовой индекс из 0 toohello количества строк минус 1. 
3. Наборы данных Машинного обучения Azure не могут содержать повторяющиеся имена столбцов и имена столбцов, которые не являются строками. Если выходных данных содержит нечисловых столбцов, hello вызывается `str` на приветствия имен столбцов. Аналогичным образом, повторяющиеся имена столбцов являются автоматически искаженное tooinsure hello имена являются уникальными. суффикс Hello (2) добавляется в первый дубликат toohello, второй дубликат toohello (3) и т. д.


## <a name="operationalizing-python-scripts"></a>Выполнение сценариев Python

При публикации в качестве веб-службы вызываются любые модули [Execute Python Script][execute-python-script] (Выполнение сценария Python) в оценивающем эксперименте. На рисунке 3 показано эксперимент оценки, содержащий tooevaluate кода hello одно выражение Python. 

![image4](./media/machine-learning-execute-python-scripts/figure3a.png)

![рисунок 5](./media/machine-learning-execute-python-scripts/python-script-with-python-pandas.png)

Рис. 3. Веб-служба для оценки выражения Python

Веб-служба, созданная в ходе этого эксперимента:

- принимает выражение Python (в виде строки) в качестве входных данных;
- отправляет его toohello интерпретатор Python 
- Возвращает таблицу, содержащую выражение hello и результат вычисляется hello.


## <a name="importing-existing-python-script-modules"></a>Импорт существующих модулей сценариев Python

Используйте обычно многие специалисты по анализу данных — tooincorporate существующих сценариев Python в эксперименты машинного Обучения Azure. Не требует сцеплены и вставить в окно скрипта весь код, hello [выполнение сценария Phyton] [ execute-python-script] модуль принимает ZIP-файл, содержащий модулей Python на hello третьего входного порта. файл Hello распаковал средой выполнения hello во время выполнения и hello содержимое добавляется путь к библиотеке toohello интерпретатора Python hello. Hello `azureml_main` точка входа функции можно непосредственно импортировать эти модули.

Например рассмотрим hello файл Hello.py с простой функцией «Hello, World».

![рисунок 6](./media/machine-learning-execute-python-scripts/figure4.png)

Рис. Определяемая пользователем функция в файле Hello.py

Далее мы создаем файл Hello.zip, содержащий файл Hello.py:

![рисунок 7](./media/machine-learning-execute-python-scripts/figure5.png)

Рис. 5. ZIP-файл, содержащий определяемый пользователем код Python

Отправьте hello ZIP-файл в качестве набора данных в студии машинного обучения Azure. Затем создайте и запустите эксперимент, использующую код Python hello в файле файл Hello.zip hello присоединив toohello третьего входного порта hello **выполнение сценария Phyton** модуля, как показано на рисунке.

![рисунок 8](./media/machine-learning-execute-python-scripts/figure6a.png)

![image9](./media/machine-learning-execute-python-scripts/figure6b.png)

Рис. 6. Пример эксперимента с определяемым пользователем кодом Python, загруженным в качестве ZIP-файла

выходные данные модуля Hello показывает, что hello ZIP-файл был нераспакованным и этой функции hello `print_hello` была выполнена.
 
![image10](./media/machine-learning-execute-python-scripts/figure7.png)

Рис. 7. Определяемая пользователем функция используется внутри hello [выполнение сценария Phyton] [ execute-python-script] модуля.


## <a name="working-with-visualizations"></a>Работа с визуализациями

Диаграммы, созданные с помощью MatplotLib, можно представить в браузере hello может быть возвращен hello [выполнение сценария Phyton][execute-python-script]. Но графики hello не автоматически перенаправленный tooimages, чем при с помощью языка R. Поэтому hello пользователя необходимо явным образом сохранить все графики tooPNG файлы, если они являются toobe возвращается назад tooAzure машинного обучения. 

toogenerate изображений из MatplotLib, необходимо выполнить процедуры hello.

* Переключение серверной hello слишком «AGG» из hello по умолчанию модуль подготовки отчетов на основе Qt 
* Создайте новый объект рисунка. 
* получить оси hello и создания всех графиков в него 
* Сохраните файл PNG tooa рис hello 

Этот процесс показан следующий рис. 8, создающий точечной диаграмме матрицу на основе функции hello scatter_matrix в Pandas hello.

![image1v](./media/machine-learning-execute-python-scripts/figure-v1-8.png)

Рис. 8. Код, MatplotLib схемы tooimages toosave.

Рис. 9 показан эксперимент, использующее hello сценарий, чтобы отобразить ранее tooreturn графиков через hello второй выходной порт.

![image2v](./media/machine-learning-execute-python-scripts/figure-v2-9a.png) 

![image2v](./media/machine-learning-execute-python-scripts/figure-v2-9b.png) 

Рис. 9. Визуализация графиков, созданных из кода Python

Это возможно tooreturn нескольких фигур путем их сохранения на различные изображения, hello воспринимает все образы среды выполнения машинного обучения Azure и объединяет их для визуализации.


## <a name="advanced-examples"></a>Дополнительные примеры

Hello среду Anaconda, установленные в машинном обучении Azure содержит общие пакетов, таких как NumPy, SciPy и Scikits-Learn. которые можно эффективно использовать для выполнения различных задач обработки данных в конвейере машинного обучения. В качестве примера hello следующие эксперимента и скрипт демонстрируют использование hello совокупности учеников в Scikits-Learn оценки важности признака toocompute для набора данных. Hello оценки может быть Выбор компонентов используется tooperform защищено перед вводом в другой модели машинного Обучения.

Ниже приведен оценки важности hello toocompute функция, используемая hello Python и функции hello заказа на основании оценки hello.

![image11](./media/machine-learning-execute-python-scripts/figure8.png)

Рис. Функция toorank функции путем оценки.
 Hello следующие эксперимента затем вычисляет и возвращает оценки важности hello функции в наборе данных «Контроля уровня сахара Территория в Индийском Pima» hello в машинном обучении Azure:

![image12](./media/machine-learning-execute-python-scripts/figure9a.png)
![image13](./media/machine-learning-execute-python-scripts/figure9b.png)    

Рис. 11. Функции toorank эксперимента в наборе данных контроля уровня сахара Территория в Индийском Pima hello.

## <a name="limitations"></a>Ограничения
Hello [выполнение сценария Phyton] [ execute-python-script] в настоящее время имеет hello следующие ограничения:

1. *Выполнение в изолированном режиме.* Среда выполнения Python Hello в настоящее время изолированным и в результате не допускает доступа toohello сети toohello локальной файловой системы или постоянно. Все файлы, сохраненные локально являются изолированных и удалены после завершения выполнения модуля hello. Hello кода Python не может получить доступ к большинство каталогов на hello компьютером, на котором он выполняется, hello, исключение hello в текущем каталоге и его подкаталогах.
2. *Отсутствие расширенной поддержки разработки и отладки.* модуль Python Hello в настоящее время не поддерживает возможности интегрированной среды разработки, такие как intellisense и отладка. Кроме того при сбое во время выполнения модуля hello hello полную трассировку стека Python доступна. Но его необходимо просматривать в журнале hello выходных данных для модуля "hello". В настоящее время рекомендуется разрабатывать и отлаживать скрипты Python в среде, например IPython и затем импортировать hello кода в модуле hello.
3. *Один кадр данных в качестве выходных данных.* точка входа Hello Python — только разрешенные tooreturn кадр данных single в качестве выходных данных. Это не поддерживается в настоящее время tooreturn произвольный Python объекты, такие как обученных моделей непосредственно резервное среды выполнения toohello машинного обучения Azure. Как [выполнение скрипта R][execute-r-script], который имеет hello такое же ограничение возможна во многих случаях объекты toopickle в байтовый массив, а затем возвращать, внутри блока данных.
4. *Toocustomize невозможности установки Python*. В настоящее время hello только способом tooadd пользовательских модулей Python — через механизм файла zip hello, описанных ранее. Хотя этот механизм можно применять для небольших модулей, он не подходит для больших модулей (особенно с встроенными библиотеками DLL) или большого количества модулей. 

## <a name="conclusions"></a>Заключение
Hello [выполнение сценария Phyton] [ execute-python-script] модуль позволяет tooincorporate существующего кода Python специалист по анализу данных в облаке обучения конечных автоматов в машинном обучении Azure и tooseamlessly ввода в эксплуатацию их как часть веб-службы. Модуль сценария Python Здравствуй естественным образом взаимодействует с других модулях машинного обучения Azure. Hello модуль можно использовать широкий набор задач из toopre обработки исследования данных и извлечения признаков и tooevaluation и последующей обработки результатов hello. Среда выполнения Hello серверной части, используемая для выполнения основан на Anaconda, хорошо проверенное и широко используемые распространения Python. Это внутренний упрощает для вас платы tooon существующие ресурсы кода в облаке hello.

Ожидается, что дополнительные функциональные возможности toohello tooprovide [выполнение сценария Phyton] [ execute-python-script] модуль, такие как hello tootrain возможности и эксплуатацию моделей в Python и tooadd Улучшенная поддержка hello Разработка и отладка кода в студии машинного обучения Azure.

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения см. в разделе hello [центре разработчиков Python](https://azure.microsoft.com/develop/python/).

<!-- Module References -->
[execute-python-script]: https://msdn.microsoft.com/library/azure/cdb56f95-7f4c-404d-bde7-5bb972e6f232/
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
