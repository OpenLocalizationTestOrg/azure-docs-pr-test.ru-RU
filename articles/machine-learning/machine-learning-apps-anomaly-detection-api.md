---
title: "API обнаружения аномалий обучения машины aaaAzure | Документы Microsoft"
description: "API обнаружения аномалий — это встроенный в Машинное обучение Microsoft Azure пример API, который обнаруживает аномалии в данных временных рядов и предоставляет результаты в виде числовых значений, равномерно распределенных по времени."
services: machine-learning
documentationcenter: 
author: alokkirpal
manager: jhubbard
editor: cgronlun
ms.assetid: 52fafe1f-e93d-47df-a8ac-9a9a53b60824
ms.service: machine-learning
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: multiple
ms.date: 06/05/2017
ms.author: alok;rotimpe
ms.openlocfilehash: ce153689b8ddb36b67a2ad3607d846ea83ebcf61
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="machine-learning-anomaly-detection-api"></a>API обнаружения аномалий в машинном обучении
## <a name="overview"></a>Обзор
[API обнаружения аномалий](https://gallery.cortanaintelligence.com/MachineLearningAPI/Anomaly-Detection-2) — это пример, построенный на базе машинного обучения Azure, который обнаруживает аномалии в данных временных рядов, содержащих равномерно распределенные по времени числовые значения.

Этот API может обнаруживать hello следующие типы аномальных закономерностей в данных временных рядов:

* **Положительные и отрицательные тенденции**. Например, положительная тенденция для отслеживаемого параметра используемой памяти может быть важным признаком утечки памяти.
* **Изменения в hello динамического диапазона значений**: например, при мониторинге исключений hello в облачной службе, любые изменения в hello динамического диапазона значений может указывать нестабильности в работоспособности службы hello hello и
* **Пиковых и становится заданного**: например, при мониторинге hello количество сбоев входа в службе или число извлечений в сайт электронной коммерции, пиков или частные интерфейсы может указывать Аномальное поведение.

Эти средства обнаружения машинного обучения отслеживают изменения в значениях с течением времени и сообщают о текущих изменениях значений в виде показателей аномалий. Они не требуют настройки adhoc пороговое значение и их оценки можно используется toocontrol false положительное скорость. обнаружение аномалий Hello API полезен в различных сценариях, как наблюдение за службами по отслеживанию ключевые показатели эффективности с течением времени, использования отслеживания с помощью метрик, таких как количество операций поиска, количество щелчков, наблюдение за производительностью, посредством счетчиков, как память, Процессор, файл считывает т. д. во времени.

Обнаружение аномалий предложения Hello поставляется с tooget полезные средства, который был запущен.

* Hello [веб-приложение](http://anomalydetection-aml.azurewebsites.net/) помогает оценить и визуализировать результаты hello обнаружение аномалий API-интерфейсов на данные.

> [!NOTE]
> Попробуйте **ИТ-решение аналитики аномалий** на базе [этого API](https://gallery.cortanaintelligence.com/MachineLearningAPI/Anomaly-Detection-2)
> 
> tooget это конец tooend развернуть решение tooyour подписки Azure <a href="https://gallery.cortanaintelligence.com/Solution/Anomaly-Detection-Pre-Configured-Solution-1" target="_blank"> **начните здесь >**</a>
> 
>

## <a name="api-deployment"></a>Развертывание API
В порядке toouse hello API его необходимо развернуть tooyour подписки Azure, где будет размещаться как к веб-службе машинного обучения Azure.  Это можно сделать из hello [коллекции аналитики Cortana](https://gallery.cortanaintelligence.com/MachineLearningAPI/Anomaly-Detection-2).  Это будет развернуть две веб-службы машинного обучения Azure (и соответствующие ресурсы) tooyour подписка Azure — одного для обнаружения аномалий с сезонности и без сезонности.  После завершения развертывания hello, вы сможете может toomanage собственные интерфейсы API из hello [AzureML веб-службы](https://services.azureml.net/webservices/) страницы.  На этой странице вы будет быть может toofind своих расположений конечную точку, ключи API, а также пример кода для вызова hello API.  Более подробные инструкции см. [здесь](https://docs.microsoft.com/en-us/azure/machine-learning/machine-learning-manage-new-webservice).

## <a name="scaling-hello-api"></a>Масштабирование hello API
По умолчанию для развертывания применяется бесплатный тарифный план для разработки и тестирования. Он предоставляет 1000 транзакций и 2 часа вычислений ежемесячно.  Вы можете обновить план tooanother согласно вашим потребностям.  Подробные сведения о ценах hello разных планов доступны [здесь](https://azure.microsoft.com/en-us/pricing/details/machine-learning/) в разделе «Цены производственного веб-API».

## <a name="managing-aml-plans"></a>Управление планами AML 
Управление тарифным планом осуществляется [здесь](https://services.azureml.net/plans/).  Имя плана Hello будет основываться на имени группы ресурсов hello, выбранное при развертывании hello API, а также строка, являющаяся уникальным tooyour подписки.  Инструкции по как tooupgrade плана доступны [здесь](https://docs.microsoft.com/en-us/azure/machine-learning/machine-learning-manage-new-webservice) в разделе «Управление планы выставления счетов» hello.

## <a name="api-definition"></a>Определение интерфейса API
Hello веб-служба предоставляет API на основе REST по протоколу HTTPS, которые могут использоваться различными способами, включая веб-узлов и мобильного приложения, R, Python, Excel, и т. д.  Отправить службе toothis время рядов данных через вызов API-Интерфейс REST и выполняется сочетание hello аномалий три описанных ниже.

## <a name="calling-hello-api"></a>Вызов hello API
В порядке toocall hello API необходимо будет расположение конечной точки tooknow hello и ключ API.  Оба варианта, а также образцы кода для вызова hello API доступны из hello [AzureML веб-службы](https://services.azureml.net/webservices/) страницы.  Перейдите требуемого toohello API и нажмите кнопку toofind вкладку «Использование» hello их.  Обратите внимание, что можно вызвать API hello как Swagger API-Интерфейс (т. е. с помощью параметра URL-адреса hello `format=swagger`) или как не - Swagger API (т. е. без hello `format` параметра URL-адреса).  Образец кода Hello использует формат Swagger hello.  Ниже представлен пример запроса и ответа без поддержки Swagger.  Эти примеры являются конечной точки toohello сезонности.  Конечная точка не сезонных Hello аналогично.

### <a name="sample-request-body"></a>Пример текста запроса
запрос Hello содержит два объекта: `Inputs` и `GlobalParameters`.  В запросе пример hello ниже, некоторые параметры отправляются явно а другие нет (Прокрутите полный список параметров для каждой конечной точки).  Параметры, которые явно не отправляются в запросе hello будет использовать значения по умолчанию hello, приведены ниже.

    {
                "Inputs": {
                        "input1": {
                                "ColumnNames": ["Time", "Data"],
                                "Values": [
                                        ["5/30/2010 18:07:00", "1"],
                                        ["5/30/2010 18:08:00", "1.4"],
                                        ["5/30/2010 18:09:00", "1.1"]
                                ]
                        }
                },
        "GlobalParameters": {
            "tspikedetector.sensitivity": "3",
            "zspikedetector.sensitivity": "3",
            "bileveldetector.sensitivity": "3.25",
            "detectors.spikesdips": "Both"
        }
    }

### <a name="sample-response"></a>Пример ответа
Обратите внимание, что в порядке hello toosee `ColumnNames` поле, необходимо включить `details=true` как параметр URL-адреса в запрос.  В разделе hello Следующая таблица содержит значение hello за каждый из этих полей.

    {
        "Results": {
            "output1": {
                "type": "table",
                "value": {
                    "Values": [
                        ["5/30/2010 6:07:00 PM", "1", "1", "0", "0", "-0.687952590518378", "0", "-0.687952590518378", "0", "-0.687952590518378", "0"],
                        ["5/30/2010 6:08:00 PM", "1.4", "1.4", "0", "0", "-1.07030497733224", "0", "-0.884548154298423", "0", "-1.07030497733224", "0"],
                        ["5/30/2010 6:09:00 PM", "1.1", "1.1", "0", "0", "-1.30229513613974", "0", "-1.173800281031", "0", "-1.30229513613974", "0"]
                    ],
                    "ColumnNames": ["Time", "OriginalData", "ProcessedData", "TSpike", "ZSpike", "BiLevelChangeScore", "BiLevelChangeAlert", "PosTrendScore", "PosTrendAlert", "NegTrendScore", "NegTrendAlert"],
                    "ColumnTypes": ["DateTime", "Double", "Double", "Double", "Double", "Double", "Int32", "Double", "Int32", "Double", "Int32"]
                }
            }
        }
    }


## <a name="score-api"></a>API оценки
Hello API оценка используется для обнаружения аномалий-сезонных временного ряда данных. Hello API выполняется ряд обнаружения аномалий в данных hello и возвращает их оценки аномалий. Hello на рисунке ниже показан пример аномалий, оценка API может обнаружить приветствия. В этом временном ряду есть 2 отчетливых изменения уровня и 3 пика. красный Hello точек Показывать время hello, на какие hello обнаруживается изменение уровня, а черный hello точек показывает пики обнаружил hello.
![API оценки][1]

### <a name="detectors"></a>Средства обнаружения
обнаружение аномалий Hello API поддерживает датчики в 3 основные категории. Сведения о конкретных входные и выходные данные для каждого средства обнаружения можно найти в следующей таблице hello.

| Категория средства обнаружения | Средство обнаружения | Описание | Входные параметры | Выходные данные |
| --- | --- | --- | --- | --- |
| Средства обнаружения пиков |Средства обнаружения пиков TSpike |Определения пиков и частные интерфейсы в зависимости от значения в диапазоне от первый и третий квартиль дальней приветствия |*tspikedetector.sensitivity:* принимает целое число в диапазоне hello 1-10, по умолчанию: 3; Более высокие значения будет перехватывать дополнительные крайние значения, тем самым создавая меньше чувствительность |TSpike: двоичные значения — 1 при обнаружении пика или спада, в противном случае — 0. |
| Средства обнаружения пиков | Средства обнаружения пиков ZSpike |Определения пиков и частные интерфейсы в зависимости от того, насколько далеко hello точек данных, от среднего |*zspikedetector.sensitivity:* принимать целое число в диапазоне hello 1-10, по умолчанию: 3; Более высокие значения будет перехватывать дополнительные крайние значения, сделав его меньше чувствительность |ZSpike: двоичные значения — 1 при обнаружении пика или спада, в противном случае — 0. | |
| Средство обнаружения медленно развивающихся тенденций |Средство обнаружения медленно развивающихся тенденций |Обнаружение медленной положительное тренда согласно чувствительности набор hello |*trenddetector.sensitivity:* пороговое значение показателя детектор (по умолчанию: 3,25, 3,25 – 5 это tooselect разумный диапазон из; hello выше hello понизит чувствительность) |tscore: число с плавающей точкой, которое используется как показатель аномалий в тенденции |
| Средства обнаружения изменений уровня | Средство обнаружения двунаправленных изменений уровня |Обнаруживает изменения вверх и вниз уровня согласно чувствительности набор hello |*bileveldetector.sensitivity:* пороговое значение показателя детектор (по умолчанию: 3,25, 3,25 – 5 это tooselect разумный диапазон из; hello выше hello понизит чувствительность) |rpscore: число с плавающей точкой, которое используется как показатель аномалий в восходящем и нисходящем изменении уровня | |

### <a name="parameters"></a>Параметры
В следующей таблице hello указывается более подробные сведения об этих входных параметров.

| Входные параметры | Описание | Значение по умолчанию | Тип | Допустимый диапазон значений | Рекомендуемый диапазон значений |
| --- | --- | --- | --- | --- | --- |
| detectors.historyWindow |Глубина анализа (количество используемых точек данных) для вычисления показателей аномалий |500 |целое число |10–2000 |Зависит от временных рядов |
| detectors.spikesdips | Ли toodetect только резко возрастает, только частные интерфейсы или оба |Оба |перечисляемый |Both, Spikes, Dips |Оба |
| bileveldetector.sensitivity |Чувствительность для средства обнаружения двунаправленных изменений уровня. |3.25 |double |None |3,25–5 (чем меньше значение, тем больше чувствительность) |
| trenddetector.sensitivity |Чувствительность для средства обнаружения положительных тенденций |3.25 |double |None |3,25–5 (чем меньше значение, тем больше чувствительность) |
| tspikedetector.sensitivity |Чувствительность для средства обнаружения пиков TSpike |3 |целое число |1–10 |3,5–5 (чем меньше значение, тем выше чувствительность) |
| zspikedetector.sensitivity |Чувствительность для средства обнаружения пиков ZSpike |3 |целое число |1–10 |3,5–5 (чем меньше значение, тем выше чувствительность) |
| postprocess.tailRows |Число последних данных hello указывает toobe, хранящейся в hello выходных результатов |0 |целое число |0 (отключите все точки данных), или укажите количество точек tookeep результатов |Недоступно |

### <a name="output"></a>Выходные данные
Hello API выполняет все датчики на время ряды данных и возвращает оценки аномалий и двоичные пик индикаторы для каждой точки времени. в следующей таблице Hello перечислены выходные данные hello API. 

| outputs | Описание |
| --- | --- |
| Время |Метки времени из необработанных данных или агрегированные (и/или) добавленные данные при применении агрегирования и/или добавления отсутствующих данных |
| Данные |Значения из необработанных данных или агрегированные (и/или) добавленные данные при применении агрегирования и/или добавления отсутствующих данных |
| TSpike |Двоичный индикатор tooindicate обнаружение пик TSpike обнаружения |
| ZSpike |Двоичный индикатор tooindicate обнаружение пик ZSpike обнаружения |
| rpscore |Число с плавающей точкой, которое используется как показатель аномалий в двунаправленном изменении уровня |
| rpalert |значение 1 или 0, указывающее, уровень двунаправленного изменить аномалий в зависимости от входных чувствительности hello |
| tscore |Число с плавающей точкой, которое используется как показатель аномалий в положительной тенденции |
| talert |значение 1 или 0, указывающее, что является положительным тренда аномалий, в зависимости от входных чувствительности hello |

## <a name="scorewithseasonality-api"></a>API ScoreWithSeasonality
Hello ScoreWithSeasonality API используется для выполнения обнаружения аномалий временных рядов, сезонных шаблоны. Этот API является полезным toodetect отклонений в сезонных шаблонов.  
Hello на этом рисунке показан пример аномалий обнаружил сезонных временных рядов. Hello временных рядов содержит один пик (hello 1-го черная точка), две частные интерфейсы (2-й черная точка hello и одно в конце hello) и изменение одного уровня (красная точка). Обратите внимание, что оба hello dip в середине hello hello временных рядов и изменение уровня hello заметно только после сезонных компоненты удаляются из ряда hello.
![API сезонности][2]

### <a name="detectors"></a>Средства обнаружения
датчики Hello в конечной точке сезонных hello, аналогичные toohello из них в конечной точке не сезонных hello, но с немного разные имена параметров (указанные ниже).

### <a name="parameters"></a>Параметры

В следующей таблице hello указывается более подробные сведения об этих входных параметров.

| Входные параметры | Описание | Значение по умолчанию | Тип | Допустимый диапазон значений | Рекомендуемый диапазон значений |
| --- | --- | --- | --- | --- | --- |
| preprocess.aggregationInterval |Интервал агрегации в секундах для агрегирования входных временных рядов |0 (агрегирование не выполняется) |целое число |0 — агрегирование пропускается, в противном случае используется значение больше 0 |день too1 5 минут, зависимые от временных рядов |
| preprocess.aggregationFunc |Функция, используемая для статистической обработки данных в hello указан AggregationInterval |mean |перечисляемый |mean, sum, length |Недоступно |
| preprocess.replaceMissing |Использовать значения tooimpute отсутствующих данных |lkv (последнее известное значение) |перечисляемый |zero, lkv, mean |Недоступно |
| detectors.historyWindow |Глубина анализа (количество используемых точек данных) для вычисления показателей аномалий |500 |целое число |10–2000 |Зависит от временных рядов |
| detectors.spikesdips | Ли toodetect только резко возрастает, только частные интерфейсы или оба |Оба |перечисляемый |Both, Spikes, Dips |Оба |
| bileveldetector.sensitivity |Чувствительность для средства обнаружения двунаправленных изменений уровня. |3.25 |double |None |3,25–5 (чем меньше значение, тем больше чувствительность) |
| postrenddetector.sensitivity |Чувствительность для средства обнаружения положительных тенденций |3.25 |double |None |3,25–5 (чем меньше значение, тем больше чувствительность) |
| negtrenddetector.sensitivity |Чувствительность для средства обнаружения отрицательных тенденций. |3.25 |double |None |3,25–5 (чем меньше значение, тем больше чувствительность) |
| tspikedetector.sensitivity |Чувствительность для средства обнаружения пиков TSpike |3 |целое число |1–10 |3,5–5 (чем меньше значение, тем выше чувствительность) |
| zspikedetector.sensitivity |Чувствительность для средства обнаружения пиков ZSpike |3 |целое число |1–10 |3,5–5 (чем меньше значение, тем выше чувствительность) |
| seasonality.enable |Будет ли анализ сезонности toobe выполняется |Да |Логическое |true, false |Зависит от временных рядов |
| seasonality.numSeasonality |Максимальное количество периодических циклов обнаружил toobe |1 |целое число |1, 2 |1–2 |
| seasonality.transform |Указывает, будут ли перед обнаружением аномалий удаляться сезонные компоненты и компоненты тенденций |deseason |перечисляемый |none, deseason, deseasontrend |Недоступно |
| postprocess.tailRows |Число последних данных hello указывает toobe, хранящейся в hello выходных результатов |0 |целое число |0 (отключите все точки данных), или укажите количество точек tookeep результатов |Недоступно |

### <a name="output"></a>Выходные данные
Hello API выполняет все датчики на время ряды данных и возвращает оценки аномалий и двоичные пик индикаторы для каждой точки времени. в следующей таблице Hello перечислены выходные данные hello API. 

| outputs | Описание |
| --- | --- |
| Время |Метки времени из необработанных данных или агрегированные (и/или) добавленные данные при применении агрегирования и/или добавления отсутствующих данных |
| OriginalData |Значения из необработанных данных или агрегированные (и/или) добавленные данные при применении агрегирования и/или добавления отсутствующих данных |
| ProcessedData |Одно из следующих hello: <ul><li>Временные ряды данных с корректировкой сезонных колебаний, если обнаружены существенные сезонные колебания и активирована функция "deseason".</li><li>Временные ряды данных с корректировкой сезонных колебаний и тенденций, если обнаружены существенные сезонные колебания и активирована функция "deseasontrend".</li><li>в противном случае это hello аналогично OriginalData</li> |
| TSpike |Двоичный индикатор tooindicate обнаружение пик TSpike обнаружения |
| ZSpike |Двоичный индикатор tooindicate обнаружение пик ZSpike обнаружения |
| BiLevelChangeScore |Число с плавающей точкой, которое используется как показатель аномалий в изменении уровня |
| BiLevelChangeAlert |1/0 значение, указывающее, что является изменение уровня аномалий, в зависимости от входных чувствительности hello |
| PosTrendScore |Число с плавающей точкой, которое используется как показатель аномалий в положительной тенденции |
| PosTrendAlert |значение 1 или 0, указывающее, что является положительным тренда аномалий, в зависимости от входных чувствительности hello |
| NegTrendScore |Число с плавающей точкой, которое используется как показатель аномалий в отрицательной тенденции |
| NegTrendAlert |числа соответствуют негативному тренду аномалий, в зависимости от входных чувствительности hello имеет значение 1 или 0, указывающее, существует |

[1]: ./media/machine-learning-apps-anomaly-detection-api/anomaly-detection-score.png
[2]: ./media/machine-learning-apps-anomaly-detection-api/anomaly-detection-seasonal.png

