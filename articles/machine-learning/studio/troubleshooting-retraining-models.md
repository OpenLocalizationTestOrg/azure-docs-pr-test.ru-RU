---
title: "Устранение неполадок при повторном обучении классической веб-службы машинного обучения Azure | Документация Майкрософт"
description: "С помощью этой статьи вы сможете выявить и исправить распространенные проблемы, которые возникают при повторном обучении модели для веб-службы машинного обучения Azure."
services: machine-learning
documentationcenter: 
author: garyericson
manager: raymondl
editor: 
ms.assetid: 75cac53c-185c-437d-863a-5d66d871921e
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 011/01/2017
ms.author: garye
ms.openlocfilehash: 1e5327ad135d9bc8881354679dc3f1b8a472cad3
ms.sourcegitcommit: 5a6e943718a8d2bc5babea3cd624c0557ab67bd5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2017
---
# <a name="troubleshooting-the-retraining-of-an-azure-machine-learning-classic-web-service"></a>Устранение неполадок при повторном обучении классической веб-службы машинного обучения Azure
## <a name="retraining-overview"></a>Сведения о повторном обучении
Когда вы развертываете прогнозный эксперимент в качестве оценивающей веб-службы, вы получаете статическую модель. Если появляются новые данные или у пользователя API есть свои данные, эту модель нужно переобучить. 

Полное описание повторного обучения классической веб-службы см. в статье [Программное переобучение моделей машинного обучения](retrain-models-programmatically.md).

## <a name="retraining-process"></a>Процесс повторного обучения
Чтобы переобучить веб-службу, нужно добавить такие дополнительные компоненты:

* Веб-службу, развернутую из обучающего эксперимента. В рамках эксперимента модуль **выходных данных веб-службы** нужно объединить с выходными данными модуля **Обучение модели**.  
  
    ![Присоедините выходные данные веб-службы к модели обучения.][image1]
* В оценивающую веб-службу нужно добавить новую конечную точку.  Сделать это можно программными средствами, воспользовавшись примером кода из статьи "Программное переобучение моделей машинного обучения", или на портале веб-служб машинного обучения Azure.

Переобучить модель после этого вы можете с помощью примера кода C#, приведенного на странице справки, посвященной обучению API веб-службы. Если вы, оценив результаты, остались ими довольны, обновите оценивающую веб-службу обученной модели с помощью добавленной вами конечной точки.

Когда все компоненты будут готовы, для повторного обучения модели нужно выполнить следующие основные действия:

1. Вызовите обучающую веб-службу (службу пакетного выполнения (BES), а не службу отклика на запросы (RRS)). Сделать вызов можно с помощью примера кода C#, приведенного на странице справки по интерфейсу API. 
2. Найдите значения параметров *BaseLocation*, *RelativeLocation* и *SasBlobToken*. Они находятся в выходных данных, отправленных в ответ на ваш вызов обучающей веб-службы. 
   ![отображает выходные данные примера повторного обучения и значения параметров BaseLocation, RelativeLocation и SasBlobToken.][image6]
3. Обновите добавленную конечную точку оценивающей веб-службы с помощью повторно обученной модели. С помощью примера кода, приведенного в статье "Программное переобучение моделей машинного обучения", обновите новую конечную точку, добавленную вами в оценивающую модель, с помощью повторно обученной модели из обучающей веб-службы.

## <a name="common-obstacles"></a>Распространенные затруднения
### <a name="check-to-see-if-you-have-the-correct-patch-url"></a>Проверьте, правильно ли указан URL-адрес исправления
Используемый вами URL-адрес исправления должен быть связан с новой оценивающей конечной точкой, добавленной в оценивающую веб-службу. Есть разные способы получить URL-адрес исправления.

**Вариант 1: программно**

Чтобы получить правильный URL-адрес исправления, выполните такие действия:

1. Выполните пример кода [AddEndpoint](https://github.com/raymondlaghaeian/AML_EndpointMgmt/blob/master/Program.cs) .
2. В выходных данных AddEndpoint найдите значение *HelpLocation* и скопируйте URL-адрес.
   
   ![HelpLocation в выходных данных примера addEndpoint.][image2]
3. Вставьте URL-адрес в браузер, чтобы перейти на страницу, содержащую ссылки на справочные статьи о веб-службе.
4. Щелкните ссылку **Обновить ресурс**, чтобы открыть страницу справки с информацией об исправлении.

**Вариант 2: с помощью портала веб-служб машинного обучения Azure**

1. Войдите на портал [веб-служб машинного обучения Azure](https://services.azureml.net/).
2. Щелкните **Веб-службы** или **Classic Web Services** (Классические веб-службы) в верхней части экрана.
4. Щелкните веб-службу оценки, с которой вы работаете (если вы не изменяли имя веб-службы по умолчанию, оно будет заканчиваться на "[Scoring Exp.]").
5. Щелкните **+СОЗДАТЬ**.
6. После добавления конечной точки щелкните ее имя.
7. В поле URL-адреса **исправления** щелкните **API Help** (Справка по API), чтобы открыть страницу справки по исправлению.

> [!NOTE]
> Если вы добавите конечную точку не к прогнозной веб-службе, а к веб-службе обучения, при выборе ссылки **Обновить ресурс** появится такая ошибка: "Sorry, but this feature is not supported or available in this context. Эта веб-служба не содержит обновляемых ресурсов. We apologize for the inconvenience and are working on improving this workflow" (К сожалению, эта функция не поддерживается или недоступна в данном контексте. Приносим извинения за неудобства. Мы работаем над исправлением этой ошибки).
> 
> 

Страница исправления содержит URL-адрес исправления, который нужно использовать, и пример кода, с помощью которого можно выполнить вызов.

![URL-адрес исправления.][image5]

### <a name="check-to-see-that-you-are-updating-the-correct-scoring-endpoint"></a>Проверьте, та ли оценивающая конечная точка обновляется
* Исправлять нужно не обучающую, а оценивающую веб-службу.
* Исправлять нужно не ту конечную точку, которая используется по умолчанию в веб-службе, а добавленную вами новую конечную точку оценивающей веб-службы.

Чтобы проверить, в какой веб-службе находится конечная точка, посетите портал веб-служб. 

> [!NOTE]
> Важно добавить конечную точку к прогнозной веб-службе, а не к обучающей. Если вы правильно установили обучающую и прогнозную веб-службы, вы увидите две отдельные веб-службы. Имя прогнозной веб-службы должно заканчиваться на [predictive exp.].
> 
> 

1. Войдите на портал [веб-служб машинного обучения Azure](https://services.azureml.net/).
2. Щелкните **Веб-службы** или **Classic Web Services** (Классические веб-службы).
3. Выберите нужную прогнозную веб-службу.
4. Проверьте, добавлена ли новая конечная точка к веб-службе.

### <a name="check-that-your-workspace-is-in-the-same-region-as-the-web-service"></a>Убедитесь, что рабочая область находится в том же регионе, что и веб-служба
1. Войдите в [Студию машинного обучения](https://studio.azureml.net/).
2. В верхней части экрана щелкните раскрывающийся список рабочих областей.

   ![Пользовательский интерфейс региона машинного обучения.][image4]

3. Проверьте регион, в котором находится рабочая область.

<!-- Image Links -->

[image1]: ./media/troubleshooting-retraining-a-model/ml-studio-tm-connnected-to-web-service-out.png
[image2]: ./media/troubleshooting-retraining-a-model/addEndpoint-output.png
[image3]: ./media/troubleshooting-retraining-a-model/azure-portal-update-resource.png
[image4]: ./media/troubleshooting-retraining-a-model/check-workspace-region.png
[image5]: ./media/troubleshooting-retraining-a-model/ml-help-page-patch-url.png
[image6]: ./media/troubleshooting-retraining-a-model/retraining-output.png
[image7]: ./media/troubleshooting-retraining-a-model/web-services-tab.png
