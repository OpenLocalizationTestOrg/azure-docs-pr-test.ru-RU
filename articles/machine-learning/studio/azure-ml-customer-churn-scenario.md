---
title: "Анализ оттока клиентов с помощью машинного обучения | Документация Майкрософт"
description: "Пример разработки интегрированной модели для анализа и оценки ухода клиентов"
services: machine-learning
documentationcenter: 
author: jeannt
manager: jhubbard
editor: cgronlun
ms.assetid: 1333ffe2-59b8-4f40-9be7-3bf1173fc38d
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/18/2017
ms.author: jeannt
ms.openlocfilehash: e0b82fe8e8c8bc4ac9c45370d90fa9330d749878
ms.sourcegitcommit: 9a8b9a24d67ba7b779fa34e67d7f2b45c941785e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2018
---
# <a name="analyzing-customer-churn-by-using-azure-machine-learning"></a>Анализ оттока клиентов с помощью Машинного обучения Azure
## <a name="overview"></a>Обзор
В этой статье содержатся сведения об эталонной реализации проекта анализа оттока клиентов, созданного в Машинном обучении Azure. Кроме того, здесь рассматриваются соответствующие универсальные модели для комплексного решения проблем оттока промышленных клиентов. Здесь также измеряется точность моделей, построенных с использованием машинного обучения, и оцениваются направления дальнейшего развития.  

### <a name="acknowledgements"></a>Благодарности
Этот эксперимент был разработан и протестирован Сержем Бергером (Serge Berger), старшим научным сотрудником корпорации Майкрософт по обработке данных, и Роджером Барга (Roger Barga), ранее являвшимся руководителем проекта Машинного обучения Microsoft Azure. Группа составителей документации Azure с благодарностью подтверждает их квалификацию и выражает признательность за предоставление этого технического документа.

> [!NOTE]
> Данные, использованные для этого эксперимента, не являются общедоступными. Примером создания модели машинного обучения для анализа оттока может послужить [шаблон модели оттока для розничной торговли](https://gallery.cortanaintelligence.com/Collection/Retail-Customer-Churn-Prediction-Template-1) в [коллекции решений ИИ Azure](http://gallery.cortanaintelligence.com/).
> 
> 

[!INCLUDE [machine-learning-free-trial](../../../includes/machine-learning-free-trial.md)]

## <a name="the-problem-of-customer-churn"></a>Проблема оттока клиентов
Компаниям на потребительском рынке и во всех сегментах корпоративного рынка приходится иметь дело с проблемой оттока клиентов. Иногда показатели оттока слишком велики и влияют на принятие политических решений. Традиционным решением является прогнозирование клиентов с высокой предрасположенностью к уходу и удовлетворение их потребностей за счет внедрения служб поддержки, проведения маркетинговых кампаний или путем применения специальных положений. В каждой отрасли могут существовать собственные подходы. Они зависят от конкретной потребительской категории в рамках одного направления (например, в области телекоммуникаций).

Все предприятия объединяет одно — необходимость минимизации особых усилий по удержанию клиентов. Таким образом, абсолютно естественным вариантом будет оценка каждого клиента на предмет склонности к оттоку и принятие соответствующих мер к самым важным из них. Крупные клиенты могут быть наиболее выгодными. Например, в более сложных сценариях выбор кандидатов для предоставления специальных условий осуществляется на основе уровня их прибыльности. Но эти аспекты являются лишь частью полной стратегии борьбы с оттоком. Компании также должны принимать во внимание риск (и связанную рискоустойчивость), уровень и стоимость вмешательства и обоснованную сегментацию клиентов.  

## <a name="industry-outlook-and-approaches"></a>Отраслевые перспективы и подходы
Сложные решения в процессе работы с оттоком клиентов являются признаком зрелой отрасли. Классическим примером является сфера телекоммуникаций, где абоненты, как известно, часто переходят от одного поставщика к другому. Такой добровольный отток является главной заботой компаний, предоставляющих услуги связи. Кроме того, поставщики накопили большой багаж знаний о *движущих силах оттока*, которые заставляют клиентов переключаться на продукты и услуги то одних, то других производителей.

Например, на рынке мобильных телефонов хорошо известным фактором оттока является выбор нового устройства. В результате начинает действовать популярная политика, а именно субсидирование цен на телефоны для новых абонентов и взимание полной стоимости обновления с существующих клиентов. Исторически сложилось, что такая политика способствует переходам клиентов от одного поставщика услуг к другому, чтобы получить новую скидку. Это, в свою очередь, стимулирует последних на совершенствование стратегий.

Высокий уровень резких колебаний на рынке мобильных телефонов быстро сводит на нет модели оттока, связанные с использованием текущих моделей телефонов. Кроме того, мобильные телефоны являются не только телекоммуникационными устройствами, но и статусными аксессуарами (например, iPhone). Эти социальные средства прогнозирования выходят за рамки обычных телекоммуникационных наборов данных.

Конечным результатом моделирования является невозможность разработки обоснованной политики только путем устранения известных причин оттока. На самом деле, **обязательной**является непрерывная стратегия моделирования, включающая классические модели, количественно оценивающие категориальные переменные (такие как деревья решений).

Используя большие наборы данных, собранные о клиентах, организации анализируют большие объемы информации (в частности, для выявления причин оттока), реализуя, тем самым, эффективный подход к решению проблемы. Более подробную информацию о реализации подхода обработки больших объемов данных для устранения проблемы с оттоком клиентов см. в разделе рекомендаций по ETL-процессам.  

## <a name="methodology-to-model-customer-churn"></a>Методика моделирования процесса оттока клиентов
Общий процесс решения проблем, связанных с оттоком клиентов, представлен на рис. 1–3.  

1. Модель риска позволяет узнать, каким образом действия влияют на вероятность и риск.
2. Модель вмешательства позволяет узнать, каким образом уровень вмешательства может повлиять на вероятность оттока и значение показателя ценности жизненного цикла клиента (CLV).
3. Этот анализ способствует проведению качественного анализа, выходящего на уровень активной маркетинговой кампании, целью которой является предоставление клиентам оптимальных предложений.  

![][1]

Такой дальновидный подход остается оптимальным способом решения проблемы оттока, однако его реализация сопряжена с определенными сложностями, так как она требует разработки многомодельного архетипа и отслеживания зависимостей между моделями. Взаимодействие между моделями может выглядеть следующим образом.  

![][2]

*Рисунок 4: Объединенный многомодельный архетип*  

Если речь идет о формировании целостного подхода к удержанию клиентов, ключевым моментом в его функционировании являются взаимодействия между моделями. С течением времени рабочие характеристики каждой модели обязательно ухудшаются. Поэтому архитектура представляет собой неявный цикл (аналогично архетипу, заданному по стандарту интеллектуального анализа данных CRISP-DM [***3***]).  

Для общего цикла сегментации и декомпозиции "риск-решение-маркетинг" по-прежнему поддерживается обобщенная структура, которая применима ко многим бизнес-задачам. Мощным представителем этой группы проблем выступает анализ оттока, так как он обладает всеми характеристиками сложной бизнес-задачи, для выполнения которой не допускается действие упрощенного прогнозного решения. Несмотря на то, что социальные аспекты современного подхода к вопросу оттока клиентов не обозначены особым образом, они содержатся в смоделированном архетипе так, как если бы они входили в состав любой модели.  

Интересным дополнением является анализ больших объемов данных. Современные телекоммуникационные компании и предприятия розничной торговли собирают исчерпывающие данные о своих клиентах. Учитывая новые направления, такие как Интернет вещей и широкое распространение устройств, позволяющих работать с интеллектуальными решениями на разных уровнях, можно без труда предположить, что потребность многомодельного взаимодействия станет общей тенденцией.  

 

## <a name="implementing-the-modeling-archetype-in-machine-learning-studio"></a>Реализация архетипа моделирования в Студии машинного обучения
Как лучше всего можно реализовать интегрированный подход моделирования и оценки, принимая во внимание только что описанную проблему? В этом разделе демонстрируется выполнение данной задачи с помощью Студии машинного обучения Azure.  

Многомодельный подход является неотъемлемой частью процесса разработки глобального архетипа оттока. Многомодельность должна поддерживаться даже в оценочной (прогнозной) части подхода.  

На следующей схеме показан созданный прототип, в котором в среде Студии машинного обучения для прогнозирования оттока используется четыре различных алгоритма оценки. Причиной внедрения многомодельного подхода является не только необходимость создания классификатора множества для повышения уровня точности, но и обеспечение защиты от чрезмерно близкой подгонки, а также улучшение выбора функций директивного характера.  

![][3]

*Рисунок 5: Прототип метода моделирования оттока*  

Подробнее о прототипе модели оценки, реализованной с помощью Студии машинного обучения, рассказывается в следующих разделах.  

### <a name="data-selection-and-preparation"></a>Выбор и подготовка данных
Данные, используемые для построения моделей и оценки клиентов, были получены из вертикального решения CRM. В целях обеспечения конфиденциальности клиентов их персональные данные были скрыты. Данные содержат информацию о 8000 подписках в США и объединяют в себе три источника: данные о подготовке (метаданные подписки), данные о действиях (использование системы), а также данные о поддержке клиентов. Сюда не включена бизнес-информация, касающаяся клиентов (например, метаданные о лояльности или оценка кредитоспособности).  

В целях упрощения в рамки проекта не входят процессы ETL и очистки данных, так как предполагается, что подготовка данных уже выполнена.   

Выбор признаков для моделирования основан на предварительной оценке значимости множества прогностических факторов, включенных в процесс с помощью модуля алгоритма случайного леса. Для реализации в Студии машинного обучения было рассчитано среднее значение, медиана и диапазон для репрезентативных признаков. Например, были добавлены совокупности для качественных данных, таких как минимальные и максимальные значения для пользовательской активности.    

Кроме того, была собрана временная информация за последние шесть месяцев. В результате анализа данных за один год было установлено, что даже при наличии статистически значимых тенденций влияние на отток значительно уменьшается по истечении шести месяцев.  

И самый существенный момент: весь процесс, включая процедуры ETL (извлечения, преобразования и загрузки данных), выбор признаков и моделирование, был реализован в Студии машинного обучения с использованием источников данных в Microsoft Azure.   

На следующей схеме показаны использовавшиеся данные.  

![][4]

*Рисунок 6: Фрагмент источника данных (скрыт)*  

![][5]

*Рисунок 7: Признаки, извлеченные из источника данных*
 

> Обратите внимание, что эти данные являются частными, поэтому общий доступ к модели и данным должен быть ограничен.
> Тем не менее в примере эксперимента [Telco Customer Churn](http://gallery.cortanaintelligence.com/Experiment/31c19425ee874f628c847f7e2d93e383) из [коллекции решений ИИ Azure](http://gallery.cortanaintelligence.com/) для построения аналогичной модели используются общедоступные данные.
> 
> Чтобы больше узнать о реализации модели анализа оттока клиентов с помощью Cortana Intelligence Suite, просмотрите [это видео](https://info.microsoft.com/Webinar-Harness-Predictive-Customer-Churn-Model.html) с участием старшего руководителя программы Ви Хен Тока (Wee Hyong Tok). 
> 
> 

### <a name="algorithms-used-in-the-prototype"></a>Алгоритмы, используемые в прототипе
Для создания прототипа (без настройки) использовались следующие четыре алгоритма машинного обучения.  

1. Логистическая регрессия (LR).
2. Увеличивающееся дерево принятия решений (BT).
3. Усредненное восприятие (AP).
4. Метод опорных векторов (SVM).  

На следующей схеме показана часть экспериментальной поверхности разработки с последовательностью создания моделей.  

![][6]  

*Рисунок 8: Создание моделей в Студии Машинного обучения*  

### <a name="scoring-methods"></a>Методы количественной оценки
Для оценки четырех моделей использовался маркированный набор данных для обучения.  

Оцениваемый набор данных также отправлялся в сопоставимую модель, созданную с помощью SAS Enterprise Miner 12 для настольных систем. Была измерена точность модели SAS и всех четырех моделей Студии машинного обучения.  

## <a name="results"></a>Результаты
В этом разделе представлены выводы о точности моделей, сделанные на основе набора данных для количественной оценки.  

### <a name="accuracy-and-precision-of-scoring"></a>Точность и презиционность оценки
Как правило, точность реализации в машинном обучении Azure отстает от аналогичного показателя в SAS примерно на 10–15 % (площадь под кривой или AUC).  

Однако наиболее важным количественным показателем оттока является коэффициент неправильной классификации: то есть, какое количество из N основных склонных к оттоку клиентов, предсказанных классификатором, на самом деле **not** ушли, но, тем не менее, удостоились особого внимания? На следующей схеме приводится сравнение коэффициента неправильной классификации для всех моделей.  

![][7]

*Figure 9: Прототип Пассау: площадь под кривой*

### <a name="using-auc-to-compare-results"></a>Использование AUC для сравнения результатов
Площадь под кривой (AUC) — это показатель, представляющий глобальную меру *разделимости* между распределениями оценок для положительных и отрицательных значений. Он похож на стандартный график зависимости чувствительности от частоты ложноположительных заключений (ROC). Необходимо отменить одно важное отличие — для показателя AUC не требуется выбирать пороговое значение. Он суммирует результаты по **всем** возможным вариантам. При этом на стандартном графике ROC положительный показатель представлен на вертикальной оси, коэффициент ложноположительных срабатываний — на горизонтальной оси. На основании этих данных отображается меняющееся пороговое значение.   

AUC обычно используется в качестве меры ценности различных алгоритмов (или разных систем), так как позволяет сравнивать модели с помощью их значений AUC. Этот подход распространен в области метеорологии, биологических наук и многих других отраслях. Таким образом, AUC представляет собой популярный инструмент для оценки производительности классификатора.  

### <a name="comparing-misclassification-rates"></a>Сравнение коэффициентов неправильной классификации
Мы сравнили коэффициенты неправильных классификаций в рассматриваемом наборе данных с помощью данных CRM из приблизительно 8000 подписок.  

* Коэффициент неправильной классификации SAS — 10–15%.
* Коэффициент неправильной классификации в Студии машинного обучения для основных 200–300 клиентов, предрасположенных к уходу, составил 15–20 %.  

В сфере телекоммуникаций очень важно уделять внимание только клиентам с самым высоким уровнем риска оттока. Для этого им предлагаются услуги поддержки или другие специальные режимы и условия. В этом отношении реализация Студии машинного обучения обеспечивает такие же результаты, как и модель SAS.  

К тому же, точность гораздо важнее прецизионности, потому что наибольший интерес в данном случае вызывает правильность классификации потенциальных клиентов, предрасположенных к оттоку.  

На следующей схеме из Википедии это отношение представлено в яркой и простой для понимания форме.  

![][8]

*Рисунок 10: Компромисс между точностью и прецизионностью*

### <a name="accuracy-and-precision-results-for-boosted-decision-tree-model"></a>Результаты точности и прецизионности для модели увеличивающегося дерева
В следующей таблице показаны необработанные результаты оценки с использованием прототипа машинного обучения для модели увеличивающегося дерева принятия решения, которая оказалась самой точной из четырех.  

![][9]

*Рисунок 11: Характеристики модели увеличивающегося дерева решений*

## <a name="performance-comparison"></a>Сравнение производительности
Было проведено сравнение скорости оценки данных с использованием моделей Студии машинного обучения и сопоставимой модели, созданной с помощью SAS Enterprise Miner 12.1 для настольных систем.  

В следующей таблице обобщаются результаты производительности алгоритмов.  

*Таблица 1. Общая производительность (точность) алгоритмов*

| LR | BT | AP | SVM |
| --- | --- | --- | --- |
| Модель средних показателей |Модель максимальных показателей |Недостаточная производительность |Модель средних показателей |

Модели, размещенные в Студии машинного обучения, превзошли SAS на 15–25 % по скорости исполнения, а уровень точности в целом был одинаковым.  

## <a name="discussion-and-recommendations"></a>Обсуждение и рекомендации
В телекоммуникационной отрасли существует несколько методик по анализу оттока, включая следующие.  

* Получение показателей для четырех основных категорий:
  * **Объект (например, подписка)**. Предоставление основной информации о подписке и (или) клиенте, являющегося предметом оттока.
  * **Действия**. Получение всей возможной информации об использовании, касающейся объекта, например количества входов.
  * **Поддержка клиентов**. Сбор информации из журналов поддержки клиентов для определения проблем с подпиской или обращений в службу поддержки клиентов.
  * **Конкурентные данные и бизнес-данные**. Получение любых данных о клиенте (например, данные могут быть недоступными или трудно отслеживаемыми).
* Использование значимости процесса выбора функций. Это означает, что модель увеличивающегося дерева всегда является перспективным подходом.  

Использование этих четырех категорий создает впечатление, что для определения клиентов, подверженных риску оттока, будет достаточно простого *детерминистского* подхода на основе индексов, сформированных на базе разумных факторов в каждой категории. К сожалению, несмотря на кажущуюся правдоподобность, это ложное понимание. Дело в том, что отток является временным эффектом, а факторам, способствующим оттоку, обычно присущи переходные состояния. Причины, по которым происходит отток клиентов сегодня, могут отличаться от завтрашних и, конечно, будут совершенно иными через шесть месяцев. Поэтому следует признать необходимость *вероятностной* модели.  

Это важное наблюдение часто упускается из виду в бизнесе, где, как правило, предпочтение отдается бизнес-аналитике, которую легче продать и проще автоматизировать.  

Тем не менее, аналитика с поддержкой самообслуживания на базе Студии машинного обучения обещает, что четыре категории информации, сгруппированные по подразделениям или отделам, станут ценным источником для машинного обучения в области оттока клиентов.  

Еще одним интересным преимуществом Машинного обучения Azure является возможность добавления настраиваемого модуля в репозиторий уже имеющихся предопределенных модулей. Она, по сути, позволяет выбрать библиотеки и создавать шаблоны для вертикальных рынков. Благодаря ей Машинное обучение Azure занимает выгодную позицию на рынке.  

Надеемся, что эта тема будет рассмотрена в ближайшем будущем, особенно с точки зрения аналитики больших объемов данных.
  

## <a name="conclusion"></a>Заключение
В этой статье описывается разумный подход к решению распространенной проблемы, связанной с оттоком клиентов, на основе единой схемы. Мы рассмотрели прототип для моделей оценки и реализовали его с помощью Машинного обучения Azure. Наконец, мы оценили точность и производительность решения прототипа на уровне сопоставимых алгоритмов в SAS.  

 

## <a name="references"></a>Ссылки
[1] Прогнозная аналитика: За пределами предсказаний, В. МакНайт, Управление информацией, июль/август 2011 г., стр. 18–20.  

[2] Статья из Википедии. [Точность](http://en.wikipedia.org/wiki/Accuracy_and_precision).

[3] [CRISP-DM 1.0: пошаговое руководство по интеллектуальному анализу данных](http://www.the-modeling-agency.com/crisp-dm.pdf)   

[4] [Маркетинг в области больших объемов данных: эффективное привлечение клиентов и стимулирование развития бизнеса](http://www.amazon.com/Big-Data-Marketing-Customers-Effectively/dp/1118733894/ref=sr_1_12?ie=UTF8&qid=1387541531&sr=8-12&keywords=customer+churn)

[5] [Шаблон модели оттока Telco](http://gallery.cortanaintelligence.com/Experiment/Telco-Customer-Churn-5) в [коллекции решений ИИ Azure](http://gallery.cortanaintelligence.com/) 
 

## <a name="appendix"></a>Приложение
![][10]

*Рисунок 12: Снимок экрана с представлением прототипа оттока*

[1]: ./media/azure-ml-customer-churn-scenario/churn-1.png
[2]: ./media/azure-ml-customer-churn-scenario/churn-2.png
[3]: ./media/azure-ml-customer-churn-scenario/churn-3.png
[4]: ./media/azure-ml-customer-churn-scenario/churn-4.png
[5]: ./media/azure-ml-customer-churn-scenario/churn-5.png
[6]: ./media/azure-ml-customer-churn-scenario/churn-6.png
[7]: ./media/azure-ml-customer-churn-scenario/churn-7.png
[8]: ./media/azure-ml-customer-churn-scenario/churn-8.png
[9]: ./media/azure-ml-customer-churn-scenario/churn-9.png
[10]: ./media/azure-ml-customer-churn-scenario/churn-10.png
