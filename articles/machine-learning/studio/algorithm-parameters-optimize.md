---
title: "Оптимизация алгоритмов в Машинном обучении Azure | Документация Майкрософт"
description: "В этой статье содержится информация о том, как выбрать оптимальный набор параметров для алгоритма в Машинном обучении Azure."
services: machine-learning
documentationcenter: 
author: bradsev
manager: cgronlun
editor: cgronlun
ms.assetid: 6717e30e-b8d8-4cc1-ad0b-1d4727928d32
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/29/2017
ms.author: bradsev;garye
ms.openlocfilehash: 664ab97cdfb663d9c8a4cc6c7b748eebfbdf580c
ms.sourcegitcommit: 5a6e943718a8d2bc5babea3cd624c0557ab67bd5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2017
---
# <a name="choose-parameters-to-optimize-your-algorithms-in-azure-machine-learning"></a>Выбор параметров для оптимизации алгоритмов в машинном обучении Azure
В этой статье описывается, как выбрать правильный набор гиперпараметров для алгоритма в Машинном обучении Azure. В большинстве алгоритмов машинного обучения есть параметры, которые необходимо настроить. Например, это требуется сделать при обучении модели. Эффективность обученной модели зависит от выбранных для нее параметров. Процесс определения оптимального набора параметров называется *выбором модели*.

[!INCLUDE [machine-learning-free-trial](../../../includes/machine-learning-free-trial.md)]

Выбор модели осуществляется разными способами. В машинном обучении чаще всего используется перекрестная проверка (которая также представляет стандартный способ выбора модели в машинном обучении Azure). Так как в машинном обучении Azure поддерживаются языки R и Python, вы всегда можете реализовать свой механизм выбора модели, используя привычные вам средства.

Оптимальный набор параметров подбирается в четыре этапа.

1. **Определение пространства параметров**. Сначала мы определяем точные значения параметров, которые будут учитываться алгоритмом.
2. **Определение параметров перекрестной проверки**. Затем нам нужно определить, как будут выбираться свертки перекрестной проверки для набора данных.
3. **Определение метрики**. Также нужно выбрать метрику, которая будет использоваться для определения оптимального набора параметров, включая правильность, среднеквадратическую погрешность, точность, полноту и F-оценку.
4. **Обучение, оценка и сравнение**. После этого для каждого уникального сочетания значений параметров на основе выбранной пользователем метрики погрешности выполняется перекрестная проверка. После оценки и сравнения можно выбрать оптимальную модель.

На следующем рисунке показано, как это осуществляется в машинном обучении Azure.

![Поиск оптимального набора параметров](./media/algorithm-parameters-optimize/fig1.png)

## <a name="define-the-parameter-space"></a>Определение пространства параметров
Набор параметров можно определить на этапе инициализации модели. На панели параметров всех алгоритмов машинного обучения доступны два режима обучения: *Single Parameter* (Один параметр) и *Parameter Range* (Диапазон параметров). Выберите режим с диапазоном параметров. В этом режиме каждому параметру можно присвоить несколько значений. В текстовое поле можно ввести разделенные запятыми значения.

![Двухклассовое увеличивающееся дерево принятия решений](./media/algorithm-parameters-optimize/fig2.png)

 Или же можно с помощью параметра **Use Range Builder** (Использовать построитель диапазонов) можно определить минимальное, максимальное и общее число создаваемых в сетке точек. По умолчанию значения параметров отображаются на линейной шкале. Но если установлен флажок **Log Scale** (Логарифмическая шкала), значения будут отображаться на логарифмической шкале (т. е. соотношение соседних точек останется неизменным). Диапазон для целочисленных параметров можно определить с помощью дефиса. Например, значение "1–10" указывает, что набор параметров образован всеми целыми числами от 1 до 10 (включая крайние). Также поддерживается смешанный режим. Например, набор параметров "1–10, 20, 50" будет включать целые числа от 1 до 10, а также 20 и 50.

![Двухклассовое увеличивающееся дерево принятия решений, диапазон параметров](./media/algorithm-parameters-optimize/fig3.png)

## <a name="define-cross-validation-folds"></a>Определение сверток перекрестной проверки
Модуль [Partition and Sample][partition-and-sample] (Секционирование и выборка) используется для назначения сверток данным в случайном порядке. Ниже приведен пример с конфигурацией модуля, где задано пять сверток и выбран параметр случайного присвоения номеров сверток экземплярам выборки.

![Секционирование и выборка](./media/algorithm-parameters-optimize/fig4.png)

## <a name="define-the-metric"></a>Определение метрики
Модуль [Tune Model Hyperparameters][tune-model-hyperparameters] (Настройка гиперпараметров модели) позволяет эмпирически выбрать оптимальный набор параметров для заданного алгоритма и набора данных. Вместе с другими сведениями об обучении модели на панели **свойств** этого модуля доступна метрика, которая позволяет определить оптимальный набор параметров. На этой панели также есть два раскрывающихся списка для выбора алгоритмов классификации и регрессии. Если рассматривается алгоритм классификации, то метрика регрессии игнорируется и наоборот. В этом примере метрика отображает значение **правильности**.   

![Параметры анализа](./media/algorithm-parameters-optimize/fig5.png)

## <a name="train-evaluate-and-compare"></a>Обучение, оценка и сравнение
Тот же модуль [настройки гиперпараметров модели][tune-model-hyperparameters] обучает все модели, соответствующие набору параметров, оценивает разные метрики, а затем создает оптимально обученную модель на основе выбранной вами метрики. Для этого модуля необходимо обязательно предоставить следующие входные данные:

* необученный обучаемый объект;
* набор данных.

Для модуля также можно указать дополнительный набор данных. Подключите набор данных со сведениями о свертке к обязательному набору данных. Если для набора данных не назначены сведения о свертке, по умолчанию будет автоматически выполняться перекрестная проверка 10 сверток. Если свертка не назначена, а на дополнительный порт набора данных подан проверочный набор данных, будет выбран режим тестового обучения. В этом случае первый набор данных используется для обучения модели с каждой комбинацией параметров.

![Классификатор увеличивающегося дерева решений](./media/algorithm-parameters-optimize/fig6a.png)

Затем в проверочном наборе данных выполняется оценка модели. Левый порт вывода модуля отображает разные метрики как функции значений параметров. Правый порт вывода отображает обученную модель в соответствии с оптимальной моделью и выбранной метрикой (в нашем примере — метрикой **правильности**).  

![Проверочный набор данных](./media/algorithm-parameters-optimize/fig6b.png)

Чтобы просмотреть выбранные параметры, визуализируйте правый порт вывода. Эту модель можно использовать для оценки проверочного набора или в развернутой веб-службе после сохранения обученной модели.

<!-- Module References -->
[partition-and-sample]: https://msdn.microsoft.com/library/azure/a8726e34-1b3e-4515-b59a-3e4a475654b8/
[tune-model-hyperparameters]: https://msdn.microsoft.com/library/azure/038d91b6-c2f2-42a1-9215-1f2c20ed1b40/
