---
title: "Развертывание веб-службы машинного обучения | Документация Майкрософт"
description: "Как преобразовать обучающий эксперимент в прогностический эксперимент, подготовить его к развертыванию, а затем развернуть как веб-службу машинного обучения Azure."
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 73a3e9c6-00d0-41d4-8cf1-2ec87713867e
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/06/2017
ms.author: garye
ms.openlocfilehash: 75577ad318f2ff23a7b7d10cf551f3bced56fb62
ms.sourcegitcommit: 5a6e943718a8d2bc5babea3cd624c0557ab67bd5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2017
---
# <a name="deploy-an-azure-machine-learning-web-service"></a>Развертывание веб-службы машинного обучения Azure
Машинное обучение Azure позволяет создавать, тестировать и развертывать решения для прогнозной аналитики.

Этот процесс можно обобщить до трех этапов:

* **[Создание обучающего эксперимента]**. Студия машинного обучения Azure Studio представляет собой среду совместной визуальной разработки, используемую для обучения и проверки модели прогнозирования с помощью обучающих данных, предоставляемых вами.
* **[Преобразование обучающего эксперимента в прогнозный]** Когда модель обучена с помощью существующих данных и готова для оценки новых данных, вы подготавливаете и оптимизируете свой эксперимент для прогнозов.
* **[Развертывание в качестве веб-службы.]** Прогнозный эксперимент можно развернуть как [новую] или [классическую] веб-службу Azure. Пользователи могут отправлять данные в вашу модель и получать ее прогнозы.

[!INCLUDE [machine-learning-free-trial](../../../includes/machine-learning-free-trial.md)]

## <a name="create-a-training-experiment"></a>Создание обучающего эксперимента
Чтобы обучить модель прогнозирующей аналитики использовании, с помощью Студии машинного обучения Azure вы создаете эксперимент по обучению с различными модулями для загрузки обучающих данных, необходимой подготовки данных, применения алгоритмов машинного обучения и оценки результатов. Вы можете выполнять итерации эксперимента и испытывать разные алгоритмы машинного обучения, чтобы сравнить и оценить результаты.

Процесс создания обучающих экспериментов и управления ими рассматривается более подробно в других материалах. Дополнительные сведения вы найдете в следующих статьях:

* [Создание простого эксперимента в Студии машинного обучения Azure](create-experiment.md)
* [Разработка прогнозирующего решения с помощью машинного обучения Azure](walkthrough-develop-predictive-solution.md)
* [Импорт обучающих данных в Студию машинного обучения Azure](import-data.md)
* [Управление итерациями экспериментов в Студии машинного обучения Azure](manage-experiment-iterations.md)

## <a name="convert-the-training-experiment-to-a-predictive-experiment"></a>Преобразование обучающего эксперимента в прогностический эксперимент
После обучения модели вы можете преобразовать обучающий эксперимент в прогнозный, чтобы оценить новые данные.

После преобразования в прогностический эксперимент ваша модель обучения готова к развертыванию в качестве оценивающей веб-службы. Пользователи веб-службы будут отправлять в модель входные данные, а модель будет возвращать им результаты прогнозов. При преобразовании эксперимента в прогнозный следует учитывать, как пользователи будут использовать эту модель.

Чтобы преобразовать обучающий эксперимент в прогнозный, в нижней части холста эксперимента нажмите кнопку **Run** (Выполнить), а затем щелкните **Set Up Web Service** (Настроить веб-службу) и выберите **Predictive Web Service** (Прогностическая веб-служба).

![Преобразование в эксперимент по оценке](./media/publish-a-machine-learning-web-service/figure-1.png)

Дополнительные сведения о том, как можно выполнить преобразование, см.в статье [Преобразование обучающего эксперимента машинного обучения в прогностический эксперимент](convert-training-experiment-to-scoring-experiment.md).

Ниже описано, как развернуть прогнозный эксперимент в качестве новой веб-службы. Кроме того, эксперимент можно развернуть как классическую веб-службу.

## <a name="deploy-it-as-a-web-service"></a>Развертывание эксперимента в виде веб-службы

Прогнозный эксперимент можно развернуть в качестве новой или классической веб-службы.

### <a name="deploy-the-predictive-experiment-as-a-new-web-service"></a>Развертывание прогнозного эксперимента в качестве новой веб-службы
Теперь, когда прогнозный эксперимент подготовлен, его можно развернуть в качестве новой веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Чтобы развернуть прогнозный эксперимент, в нижней части области эксперимента щелкните **Run** (Выполнить). После завершения эксперимента щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [новую]**.  Откроется страница развертывания на портале веб-службы машинного обучения.

> [!NOTE] 
> Для развертывания новой веб-службы у вас должен быть достаточный уровень разрешений в подписке, в которую выполняется развертывание веб-службы. Дополнительные сведения см. в статье [Управление веб-службой с помощью портала веб-служб машинного обучения Azure](manage-new-webservice.md). 

#### <a name="machine-learning-web-service-portal-deploy-experiment-page"></a>Страница развертывания эксперимента на портале веб-службы машинного обучения
На странице "Deploy Experiment" (Развертывание эксперимента) введите имя веб-службы.
Выберите ценовой план. Если у вас уже имеется ценовой план, то можно выбрать его. В противном случае необходимо создать ценовой план для службы.

1. В раскрывающемся списке **Price Plan** (Ценовой план) выберите существующий план или щелкните **Select new plan** (Выбрать новый план).
2. В поле **Имя плана**введите имя для идентификации плана в счете.
3. Выберите один из вариантов **Monthly Plan Tier**(Уровень ежемесячного плана). По умолчанию указаны уровни плана для вашего региона по умолчанию, и веб-служба развертывается именно в этом регионе.

Щелкните **Deploy** (Развернуть). Откроется страница **быстрого запуска** веб-службы.

На странице быстрого запуска веб-службы доступны рекомендации по выполнению распространенных задач после создания веб-службы. С нее можно быстро перейти на страницу тестирования или использования.

<!-- ![Deploy the web service](./media/publish-a-machine-learning-web-service/figure-2.png)-->

#### <a name="test-your-new-web-service"></a>Тестирование новой веб-службы
Чтобы протестировать новую веб-службу, в разделе общих задач щелкните **Test web service** (Тестировать веб-службу). На странице тестирования веб-службу можно проверить двумя способами: как службу RRS (запрос-ответ) или как службу BES (пакетное выполнение).

На странице тестирования RRS отображаются входные и выходные данные, а также все глобальные параметры, которые были определены для эксперимента. Чтобы протестировать веб-службу, вручную введите необходимые значения для входных данных или предоставьте тестовые значения в файле данных с разделителями-запятыми (CSV).

Для тестирования с помощью службы RRS в режиме представления списка введите необходимые значения для входных данных и щелкните **Test Request-Response**(Тестировать "запрос-ответ"). Результаты прогноза отобразятся в выходном столбце справа.

![Развертывание веб-службы](./media/publish-a-machine-learning-web-service/figure-5-test-request-response.png)

Для тестирования службы BES щелкните **Batch**(Пакетная служба). На странице тестирования "Batch" (Пакетная служба) в разделе входных данных нажмите кнопку "Browse" (Обзор) и выберите CSV-файл, содержащий необходимые примеры значений. Если у вас нет CSV-файла и прогнозный эксперимент вы создали с помощью Студии машинного обучения, скачайте набор данных для своего прогнозного эксперимента и используйте его.

Чтобы скачать набор данных, откройте Студию машинного обучения. Откройте прогнозный эксперимент и щелкните правой кнопкой мыши входные данные своего эксперимента. В контекстном меню выберите **dataset** (набор данных), а затем выберите **Download** (Скачать).

![Развертывание веб-службы](./media/publish-a-machine-learning-web-service/figure-7-mls-download.png)

Нажмите **Проверить**. Состояние задания пакетного выполнения отобразится справа в разделе **Test Batch Jobs**(Тестирование пакетных заданий).

![Развертывание веб-службы](./media/publish-a-machine-learning-web-service/figure-6-test-batch-execution.png)

<!--![Test the web service](./media/publish-a-machine-learning-web-service/figure-3.png)-->

На странице **конфигурации** можно изменить описание или заголовок, обновить ключ учетной записи хранения, а также включить образцы данных для веб-службы.

![Настройка веб-службы](./media/publish-a-machine-learning-web-service/figure-8-arm-configure.png)

После развертывания веб-службы можно сделать следующее:

* **обращаться** к ней через API веб-службы;
* **управлять** ею с помощью портала веб-служб машинного обучения Azure;
* **обновлять** ее при изменении модели.

#### <a name="access-your-new-web-service"></a>Доступ к новой веб-службе
После развертывания веб-службы из студии машинного обучения в эту службу можно отправлять данные и программным способом получать ответы.

Страница **Consume** (Использование) предоставляет всю информацию, необходимую для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе.

Дополнительные сведения о доступе к веб-службе машинного обучения см. в статье [Как использовать веб-службу машинного обучения Azure](consume-web-services.md).

#### <a name="manage-your-new-web-service"></a>Управление новой веб-службой
С помощью портала веб-служб машинного обучения можно осуществлять управление новыми веб-службами. На [главной странице портала](https://services.azureml-test.net/) щелкните **Web Services** (Веб-службы). На странице веб-служб можно удалить службу или скопировать ее. Для наблюдения за конкретной службой выберите службу и щелкните **Dashboard**(Панель мониторинга). Для наблюдения за выполнением пакетных заданий, связанных с веб-службой, щелкните **Batch Request Log**(Журнал пакетных запросов).

### <a name="deploy-the-predictive-experiment-as-a-classic-web-service"></a>Развертывание прогнозного эксперимента в качестве классической веб-службы

Теперь, когда прогностический эксперимент был необходимым образом подготовлен, его можно развернуть в качестве классической веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Чтобы развернуть прогностический эксперимент, нажмите **Run** (Выполнить) в нижней части холста эксперимента, а затем выберите **Deploy Web Service** (Развернуть веб-службу). Веб-служба будет настроена, затем отобразится ее панель мониторинга.

![Развертывание веб-службы](./media/publish-a-machine-learning-web-service/figure-2.png)

#### <a name="test-your-classic-web-service"></a>Тестирование классической веб-службы

Веб-службу можно протестировать на портале веб-служб машинного обучения или в студии машинного обучения.

Чтобы протестировать веб-службу "запрос-ответ", щелкните ссылку **Test** (Проверить) на панели мониторинга веб-службы. Появится диалоговое окно, предлагающее ввести входные данные для службы. Это столбцы, ожидаемые экспериментом по оценке. Введите набор данных и нажмите кнопку **ОК**. Результаты, созданные веб-службой, отображаются внизу панели мониторинга.

Ссылка **Test** (Проверить) позволяет протестировать службу на портале веб-службы машинного обучения Azure, как описано выше в разделе о развертывании новой веб-службы.

Чтобы протестировать службу пакетного выполнения, щелкните ссылку **Test** (Проверить). На странице тестирования "Batch" (Пакетная служба) в разделе входных данных нажмите кнопку "Browse" (Обзор) и выберите CSV-файл, содержащий необходимые примеры значений. Если у вас нет CSV-файла и прогнозный эксперимент вы создали с помощью Студии машинного обучения, скачайте набор данных для своего прогнозного эксперимента и используйте его.

![Тестирование веб-службы](./media/publish-a-machine-learning-web-service/figure-3.png)

На странице **Configuration** (Настройка) можно изменить отображаемое имя службы и добавить ее описание. Имя и описание отображаются на [портале Azure](https://portal.azure.com/), на котором осуществляется управление веб-службами.

Вы можете предоставить описание входных данных, выходных данных и параметров веб-службы, введя строковые данные для каждого столбца в разделах **INPUT SCHEMA** (Схема входных данных), **OUTPUT SCHEMA** (Схема выходных данных) и **Web Service Parameter** (Параметр веб-службы). Эти описания используются в документации по примерам кода для веб-службы.

Включив ведение журнала, вы сможете диагностировать сбои, которые происходят при обращении к веб-службе. Дополнительную информацию см. в статье [Включение функции ведения журналов для веб-служб машинного обучения](web-services-logging.md).

![Настройка веб-службы](./media/publish-a-machine-learning-web-service/figure-4.png)

Кроме того, на портале веб-службы машинного обучения Azure можно настроить конечные точки веб-службы. См. раздел о развертывании новой веб-службы выше. В этом случае будут доступны другие возможности: можно добавить или изменить описание службы, активировать ведение журнала и включить пример данных для тестирования.

#### <a name="access-your-classic-web-service"></a>Доступ к классической веб-службе
После развертывания веб-службы из студии машинного обучения в эту службу можно отправлять данные и программным способом получать ответы.

Панель мониторинга предоставляет всю информацию, необходимую для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе, а страницы справки по API помогут вам приступить к созданию кода.

Дополнительные сведения о доступе к веб-службе машинного обучения см. в статье [Как использовать веб-службу машинного обучения Azure](consume-web-services.md).

#### <a name="manage-your-classic-web-service"></a>Управление классической веб-службой
Веб-службу можно отслеживать разными способами. Ее можно обновить или удалить. Кроме того, для классической веб-службы можно добавить другие конечные точки (в дополнение к созданной при развертывании).

Дополнительные сведения см. в статьях [Управление рабочей областью машинного обучения Azure](manage-workspace.md) и [Управление веб-службой с помощью портала веб-служб машинного обучения Azure](manage-new-webservice.md).

<!-- When this article gets published, fix the link and uncomment
For more information on how to manage Azure Machine Learning web service endpoints using the REST API, see **Azure machine learning web service endpoints**.
-->

## <a name="update-the-web-service"></a>Обновление веб-службы
Вы можете внести изменения в веб-службу, например обновить модель дополнительными обучающими данными, и развернуть ее снова, перезаписав исходную веб-службу.

Чтобы обновить веб-службу, откройте исходный прогностический эксперимент, использованный для развертывания веб-службы, и создайте редактируемую копию, нажав **СОХРАНИТЬ КАК**. Внесите изменения и нажмите **Развернуть веб-службу**.

Так как этот эксперимент уже был развернут, отобразится запрос на перезапись (для классической веб-службы) или обновление (для новой веб-службы) существующей службы. Если нажать **Да** или **Обновить**, существующая веб-служба будет остановлена и вместо нее будет развернут новый прогнозный эксперимент.

> [!NOTE]
> Если вы внесли изменения в конфигурацию исходной веб-службы, например, введя новое отображаемое имя или описание, необходимо будет снова ввести эти значения.
> 
> 

Один из вариантов обновления веб-службы — переобучить модель программно. For more information, see [Программное переобучение моделей машинного обучения](retrain-models-programmatically.md).

<!-- internal links -->
[Создание обучающего эксперимента]: #create-a-training-experiment
[Преобразование обучающего эксперимента в прогнозный]: #convert-the-training-experiment-to-a-predictive-experiment
[Развертывание в качестве веб-службы.]: #deploy-it-as-a-web-service
[новую]: #deploy-the-predictive-experiment-as-a-new-Web-service
[классическую]: #deploy-the-predictive-experiment-as-a-new-Web-service
[Access]: #access-the-Web-service
[Manage]: #manage-the-Web-service-in-the-azure-management-portal
[Update]: #update-the-Web-service
