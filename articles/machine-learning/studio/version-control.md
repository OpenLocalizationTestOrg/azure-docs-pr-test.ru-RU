---
title: "Управление жизненным циклом приложений в машинном обучении Azure | Документация Майкрософт"
description: "Использование рекомендаций по управлению жизненным циклом приложений в студии машинного обучения Azure"
keywords: "ALM, AML, Azure ML, управление жизненным циклом приложений, управление версиями"
services: machine-learning
documentationcenter: 
author: hning86
manager: jhubbard
editor: cgronlun
ms.assetid: 1be6577d-f2c7-425b-b6b9-d5038e52b395
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/27/2016
ms.author: haining
ms.openlocfilehash: 9d1fcc761115c64fafb811d6ca1c2389babfdc15
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="application-lifecycle-management-in-azure-machine-learning-studio"></a>Управление жизненным циклом приложений в студии машинного обучения Azure
Студия машинного обучения Azure — это средство для разработки экспериментов машинного обучения и их применения на базе облачной платформы Azure. Это решение позволяет объединить в рамках одной платформы возможности Visual Studio IDE и масштабируемой облачной службы. Студия машинного обучения Azure поддерживает стандартные методы управления жизненным циклом приложения (ALM), начиная от управления версиями разных ресурсов и заканчивая автоматическим выполнением и развертыванием. В этой статье рассматриваются некоторые возможности и подходы.

## <a name="versioning-experiment"></a>Управление версиями эксперимента
Для управления версиями экспериментов рекомендуется использовать один из двух способов. Можно воспользоваться встроенным журналом выполнения или экспортировать эксперимент в файл формата JSON (нотация объектов JavaScript) и управлять им извне. У каждого подхода есть свои преимущества и недостатки.

### <a name="experiment-snapshots-using-run-history"></a>Моментальные снимки эксперимента с использованием журнала выполнения
Модель выполнения эксперимента в студии машинного обучения Azure устроена так, что при каждом нажатии в редакторе экспериментов кнопки **Выполнить** в планировщик заданий передается неизменяемый снимок эксперимента. Этот список моментальных снимков можно просмотреть, нажав кнопку **Журнал выполнения** на панели команд в представлении редактора экспериментов.

![Кнопка "Журнал выполнения"](./media/version-control/runhistory.png)

Моментальный снимок затем можно открыть в режиме блокировки, щелкнув имя эксперимента, соответствующее моменту отправки на выполнение и создания моментального снимка. Обратите внимание: для редактирования доступен только первый элемент в списке, который представляет текущий эксперимент. Кроме того, моментальные снимки могут быть в разных состояниях, включая завершение или частичное выполнение, сбой, сбой или частичное выполнение, а также черновое состояние.

![Список журнала выполнения](./media/version-control/runhistorylist.png)

Открыв моментальный снимок, вы можете сохранить эксперимент как новый, а затем изменить его. Моментальный снимок эксперимента может содержать такие ресурсы, как обученная модель, преобразование, набор данных и т. д., версии которых были обновлены. В таком случае моментальный снимок будет также содержать ссылки на исходные версии этих ресурсов, соответствующие времени создания снимка. Но если сохранить заблокированный моментальный снимок как новый эксперимент, студия машинного обучения Microsoft Azure определит новую версию этих ресурсов и автоматически обновит их соответствующим образом.

При удалении эксперимента все его моментальные снимки также удаляются.

### <a name="exportimport-experiment-in-json-format"></a>Экспорт и импорт эксперимента в формат JSON
Моментальные снимки журнала выполнения представляют неизменяемую версию эксперимента в студии машинного обучения Azure на момент его отправки на выполнение. Вы также можете сохранить локальную копию эксперимента и включить его в используемую вами систему управления версиями, например Team Foundation Server, чтобы потом повторно создать эксперимент из этого локального файла. Для этого можно использовать такие командлеты [PowerShell студии машинного обучения Azure](http://aka.ms/amlps): [*Export-AmlExperimentGraph*](https://github.com/hning86/azuremlps#export-amlexperimentgraph) и [*Import-AmlExperimentGraph*](https://github.com/hning86/azuremlps#import-amlexperimentgraph).

Обратите внимание, что JSON-файл — это текстовое представление диаграммы эксперимента, которое может включать ссылку на такие ресурсы в рабочей области, как набор данных или обученные модели. Он не содержит сериализованную версию ресурса. Когда вы пытаетесь импортировать документ JSON обратно в рабочую область, ресурсы, на которые ссылается эксперимент, должны уже существовать, а их идентификаторы должны совпадать с идентификаторами ресурсов, ссылки на которые используются в эксперименте. В противном случае вы не сможете получить доступ к импортированному эксперименту.

## <a name="versioning-trained-model"></a>Управление версиями обученной модели
Обученная модель в студии машинного обучения Azure сериализуется в файл в формате ILEARNER. Этот файл хранится в учетной записи хранилища BLOB-объектов Azure, связанной с рабочей областью. Получить копию ILEARNER-файла можно с помощью API переобучения. В [этой статье](retrain-models-programmatically.md) объясняется, как работает API переобучения. Основные действия:

1. Настройте обучающий эксперимент.
2. Добавьте выходной порт веб-службы в модуль "Обучение модели" или модуль, который создает обученную модель, например Настройка гиперпараметра модели" или "Создание модели R".
3. Выполните обучающий эксперимент, а затем разверните его как веб-службу для обучения модели.
4. Вызовите конечную точку BES обучающей веб-службы, а затем укажите имя файла ILEARNER и расположение учетной записи хранения BLOB-объектов, где он будет храниться.
5. После завершения вызова BES будет создан файл .iLearner.

Получить файл ILEARNER можно также с помощью командлета PowerShell [*Download-AmlExperimentNodeOutput*](https://github.com/hning86/azuremlps#download-amlexperimentnodeoutput). Возможно, проще будет просто получить копию файла ILEARNER без переобучения модели программным способом.

Создав файл ILEARNER, содержащий обученную модель, вы можете применить стратегию управления версиями. Стратегия может предусматривать применение префикса или постфикса в рамках соглашения об именовании. При этом файл ILEARNER остается в хранилище BLOB-объектов либо копируется или импортируется в систему управления версиями.

Сохраненный файл iLearner затем можно использовать для оценки через развернутые веб-службы.

## <a name="versioning-web-service"></a>Управление версиями веб-службы
Из эксперимента студии машинного обучения Azure можно развернуть два типа веб-служб. Классическая веб-служба тесно связана с экспериментом и рабочей областью. Новая веб-служба использует платформу Azure Resource Manager. Она больше не связана с исходным экспериментом или с рабочей областью.

### <a name="classic-web-service"></a>Классическая веб-служба
Для управления версиями классической веб-службы можно использовать конструкцию конечной точки веб-службы. Ниже приведена типичная последовательность действий.

1. В прогнозном эксперименте разверните новую классическую веб-службу, содержащую конечную точку по умолчанию.
2. Создайте новую конечную точку с именем ep2, которая предоставляет текущую версию эксперимента или обученной модели.
3. Затем обновите прогнозный эксперимент и обученную модель.
4. После этого повторно разверните прогнозный эксперимент, который, в свою очередь, обновит конечную точку по умолчанию. Но это не изменит конечную точку ep2.
5. Теперь можно создать дополнительную конечную точку с именем ep3, которая предоставляет новую версию эксперимента и обученной модели.
6. Если необходимо, вернитесь к шагу 3.

Со временем у вас может быть несколько конечных точек, созданных в одной и той же веб-службе. Каждая конечная точка представляет копию эксперимента (соответствующую определенной точке во времени), который содержит версию обученной модели (так же соответствующую определенной точке во времени). Затем с помощью внешней логики можно определить, какую конечную точку вызывать, что соответствует выбору обученной модели для оценочного выполнения.

Для получения аналогичного результата можно также создать несколько идентичных конечных точек веб-службы и обновить различные версии файла .iLearner с помощью конечной точки. В [этой статье](create-models-and-endpoints-with-powershell.md) подробно описано, как это сделать.

### <a name="new-web-service"></a>Новая веб-служба
При создании новой веб-службы на основе Azure Resource Manager конструкция конечной точки недоступна. Вместо этого можно создать файлы WSD (определение веб-службы) в формате JSON из прогнозного эксперимента с помощью командлета PowerShell [Export-AmlWebServiceDefinitionFromExperiment](https://github.com/hning86/azuremlps#export-amlwebservicedefinitionfromexperiment) или [*Export-AzureRmMlWebservice*](https://msdn.microsoft.com/library/azure/mt767935.aspx) из уже развернутой веб-службы на основе Resource Manager.

Экспортированный и обработанный с помощью системы управления версиями файл WSD можно развернуть как новую веб-службу в другом плане веб-службы и другом регионе Azure. Но убедитесь, что вы указали правильную конфигурацию учетной записи хранения, а также идентификатор нового плана веб-службы. Чтобы применить исправление в других файлах ILEARNER, можно изменить файл WSD, обновить ссылку на расположение обученной модели и развернуть его в качестве новой веб-службы.

## <a name="automate-experiment-execution-and-deployment"></a>Автоматическое выполнение и развертывание эксперимента
Важным аспектом управления жизненным циклом приложений является возможность автоматического выполнения и развертывания приложения. В студии машинного обучения Azure это можно сделать с помощью [модуля PowerShell](http://aka.ms/amlps). Ниже описан пошаговый стандартный процесс автоматического выполнения и развертывания ALM с помощью [модуля PowerShell студии машинного обучения Azure](http://aka.ms/amlps). Для выполнения каждого шага используется один или несколько командлетов PowerShell.

1. [Отправьте набор данных](https://github.com/hning86/azuremlps#upload-amldataset).
2. Скопируйте обучающий эксперимент в рабочую область из [рабочей области](https://github.com/hning86/azuremlps#copy-amlexperiment) или [коллекции](https://github.com/hning86/azuremlps#copy-amlexperimentfromgallery) или [импортируйте](https://github.com/hning86/azuremlps#import-amlexperimentgraph) [экспортированный](https://github.com/hning86/azuremlps#export-amlexperimentgraph) эксперимент с локального диска.
3. [Обновите набор данных](https://github.com/hning86/azuremlps#update-amlexperimentuserasset) в обучающем эксперименте.
4. [Выполните обучающий эксперимент](https://github.com/hning86/azuremlps#start-amlexperiment).
5. [Повысьте уровень обученной модели](https://github.com/hning86/azuremlps#promote-amltrainedmodel).
6. [Скопируйте прогнозный эксперимент](https://github.com/hning86/azuremlps#copy-amlexperiment) в рабочую область.
7. [Обновите обученную модель](https://github.com/hning86/azuremlps#update-amlexperimentuserasset) в прогнозном эксперименте.
8. [Выполните прогнозный эксперимент](https://github.com/hning86/azuremlps#start-amlexperiment).
9. [Разверните веб-службу](https://github.com/hning86/azuremlps#new-amlwebservice) из прогнозного эксперимента.
10. Протестируйте конечную точку [RRS](https://github.com/hning86/azuremlps#invoke-amlwebservicerrsendpoint) или [BES](https://github.com/hning86/azuremlps#invoke-amlwebservicebesendpoint) веб-службы.

## <a name="next-steps"></a>Дальнейшие действия
* Скачайте модуль [PowerShell студии машинного обучения Azure](http://aka.ms/amlps) и приступайте к автоматизации задач управления жизненным циклом приложений.
* Узнайте, как [создавать большое число моделей машинного обучения и управлять ими, используя только один эксперимент](create-models-and-endpoints-with-powershell.md), с помощью PowerShell и API переобучения.
* См. дополнительные сведения о [развертывании веб-служб машинного обучения Azure](publish-a-machine-learning-web-service.md).
