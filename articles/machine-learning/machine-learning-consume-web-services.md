---
title: "Как использовать веб-службу машинного обучения Azure | Документация Майкрософт"
description: "Развернув службу машинного обучения, доступную веб-службу RESTFul можно использовать в качестве службы обработки запросов и ответов в режиме реального времени или службы пакетного выполнения."
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 804f8211-9437-4982-98e9-ca841b7edf56
ms.service: machine-learning
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: tbd
ms.date: 06/02/2017
ms.author: garye
ms.openlocfilehash: eec9f637b4b2306ab4a888dbd5ef5b9a021bcac5
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-consume-an-azure-machine-learning-web-service"></a>Как использовать веб-службу машинного обучения Azure

После развертывания прогнозной модели машинного обучения Azure в качестве веб-службы можно использовать REST API для отправки данных и получения прогнозов. Данные можно отправлять в режиме реального времени или пакетном режиме.

Дополнительные сведения о способах создания и развертывания веб-службы машинного обучения с помощью Студии машинного обучения можно найти в следующих статьях:

* Руководство по созданию эксперимента в Студии машинного обучения см. в [этой статье](machine-learning-create-experiment.md).
* Дополнительные сведения о развертывании веб-службы см. в [этой статье](machine-learning-publish-a-machine-learning-web-service.md).
* Дополнительные сведения о машинном обучении см. в [центре документации по Машинному обучению Azure](https://azure.microsoft.com/documentation/services/machine-learning/).

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="overview"></a>Обзор
С помощью веб-службы машинного обучения Azure внешнее приложение взаимодействует с рабочим процессом машинного обучения, оценивая модель в режиме реального времени. Вызов веб-службы машинного обучения возвращает результаты прогноза внешнему приложению. Чтобы вызвать веб-службу машинного обучения, следует передать ключ API, создаваемый при развертывании прогноза. Веб-служба машинного обучения работает на основе архитектуры REST, используемой в основном в проектах с веб-программированием.

Машинное обучение Azure содержит два типа служб:

* Служба обработки запросов и ответов (RRS) — высокомасштабируемая служба с малым временем задержки, используемая в качестве интерфейса для моделей без изменения состояния, которые создаются и развертываются в студии машинного обучения Microsoft Azure.
* Служба пакетного выполнения (BES) — асинхронная служба, оценивающая пакет записей данных.

Дополнительные сведения о веб-службах машинного обучения приведены в статье [Развертывание веб-службы машинного обучения Azure](machine-learning-publish-a-machine-learning-web-service.md).

## <a name="get-an-azure-machine-learning-authorization-key"></a>Получение ключа авторизации машинного обучения Azure
При развертывании эксперимента создаются ключи API для веб-службы. Ключи можно извлечь из нескольких расположений.

### <a name="from-the-microsoft-azure-machine-learning-web-services-portal"></a>Из портала веб-службы Машинного обучения Microsoft Azure
Войдите на портал [веб-службы Машинного обучения Microsoft Azure](https://services.azureml.net).

Чтобы получить ключ API для новой веб-службы машинного обучения, сделайте следующее:

1. На портале веб-служб Машинного обучения Azure в верхнем меню щелкните **Веб-службы**.
2. Щелкните веб-службу, для которой требуется получить ключ.
3. В верхнем меню щелкните **Consume**(Использование).
4. Скопируйте и сохраните **Primary Key**(Первичный ключ).

Чтобы получить ключ API для классической веб-службы машинного обучения, сделайте следующее:

1. На портале веб-служб Машинного обучения Azure в верхнем меню щелкните **Classic Web Services** (Классические веб-службы).
2. Выберите веб-службу, с которой вы работаете.
3. Щелкните конечную точку, для которой требуется получить ключ.
4. В верхнем меню щелкните **Consume**(Использование).
5. Скопируйте и сохраните **Primary Key**(Первичный ключ).

### <a name="classic-web-service"></a>Классическая веб-служба
 Ключ для классической веб-службы можно также получить в Студии машинного обучения или на классическом портале Azure.

#### <a name="machine-learning-studio"></a>Студия машинного обучения
1. В студии машинного обучения щелкните **WEB SERVICES** (ВЕБ-СЛУЖБЫ) слева.
2. Щелкните веб-службу. **Ключ API** указан на вкладке **Панель мониторинга**.

#### <a name="azure-classic-portal"></a>классическом портале Azure
1. Щелкните **МАШИННОЕ ОБУЧЕНИЕ** слева.
2. Щелкните рабочую область, в которой находится веб-служба.
3. Щелкните **ВЕБ-СЛУЖБЫ**.
4. Щелкните веб-службу.
5. Щелкните конечную точку. Элемент "КЛЮЧ API" находится в правом нижнем углу.

## <a id="connect"></a>Подключение к веб-службе машинного обучения
К веб-службе машинного обучения можно подключиться, используя любой язык программирования, поддерживающий HTTP-запрос и HTTP-ответ. Примеры на языках C#, Python и R можно просмотреть на странице справки веб-службы машинного обучения.

**Справка по API машинного обучения.** Страница справки по API машинного обучения Azure создается при развертывании веб-службы. См. статью [Шаг 5. Развертывание веб-службы машинного обучения Azure](machine-learning-walkthrough-5-publish-web-service.md).
Справка по API машинного обучения содержит сведения о веб-службе прогнозирования.

1. Выберите веб-службу, с которой вы работаете.
2. Щелкните конечную точку, для которой требуется просмотреть страницу справки по API.
3. В верхнем меню щелкните **Consume**(Использование).
4. Щелкните **API help page** (Страница справки API) под конечными точками "Запрос — ответ" или "Выполнение пакета".

**Просмотр справки по API машинного обучения для новой веб-службы**

На портале веб-служб Машинного обучения Azure:

1. В верхнем меню щелкните **WEB SERVICES** (ВЕБ-СЛУЖБЫ).
2. Щелкните веб-службу, для которой требуется получить ключ.

Щелкните **Consume** (Использование), чтобы получить URI для службы "запрос-ответ" и службы пакетного выполнения, а также для примера кода на C#, R и Python.

Щелкните **Swagger API**, чтобы получить документацию на основе Swagger для интерфейсов API, вызываемых из передаваемых URI.

### <a name="c-sample"></a>Пример на языке C#
Для подключения к веб-службе машинного обучения воспользуйтесь клиентом **HttpClient**, передав ScoreData. Данные набора содержат Вектор свойств, n-мерный вектор числовых параметров, представляющий Данные набора. Службу машинного обучения можно аутентифицировать с помощью ключа API.

Для подключения к веб-службе машинного обучения должен быть установлен пакет NuGet **Microsoft.AspNet.WebApi.Client**.

**Установка Microsoft.AspNet.WebApi.Client NuGet в Visual Studio**

1. Опубликуйте набор данных Загрузки из набора UCI: Adult 2 веб-службы.
2. Выберите **Инструменты** > **Диспетчер пакетов NuGet** > **Консоль диспетчера пакетов**.
3. Выберите **Установить пакет Microsoft.AspNet.WebApi.Client**.

**Для запуска примера выполните следующие действия:**

1. Опубликуйте эксперимент "Пример 1. Загрузка набора данных из UCI: набор данных для класса Adult 2", входящий в набор примеров машинного обучения Azure.
2. Назначьте apiKey ключ из веб-службы. См. раздел **Получение ключа авторизации Машинного обучения Azure** выше.
3. Назначьте serviceUri универсальный код ресурса запроса.

### <a name="python-sample"></a>Пример на Python
Для подключения к веб-службе машинного обучения воспользуйтесь библиотекой **urllib2**, передав ScoreData. Данные набора содержат FeatureVector, n-мерный вектор числовых параметров, представляющий ScoreData. Службу машинного обучения можно аутентифицировать с помощью ключа API.

**Для запуска примера выполните следующие действия:**

1. Разверните эксперимент "Sample 1: Download dataset from UCI: Adult 2 class dataset" (Пример 1. Скачивание набора данных из UCI: набор данных для класса Adult 2), входящий в набор примеров машинного обучения.
2. Назначьте apiKey ключ из веб-службы. См. раздел **Получение ключа авторизации Машинного обучения Azure** в начале этой статьи.
3. Назначьте serviceUri универсальный код ресурса запроса.

