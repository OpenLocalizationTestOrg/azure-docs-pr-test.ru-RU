---
title: "Устранение неполадок при повторном обучении классической веб-службы машинного обучения Azure | Документация Майкрософт"
description: "С помощью этой статьи вы сможете выявить и исправить распространенные проблемы, которые возникают при повторном обучении модели для веб-службы машинного обучения Azure."
services: machine-learning
documentationcenter: 
author: VDonGlover
manager: raymondl
editor: 
ms.assetid: 75cac53c-185c-437d-863a-5d66d871921e
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: v-donglo
ms.openlocfilehash: fc36499ebff88c86635228ff899c85e9166aabed
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshooting-the-retraining-of-an-azure-machine-learning-classic-web-service"></a>Устранение неполадок при повторном обучении классической веб-службы машинного обучения Azure
## <a name="retraining-overview"></a>Сведения о повторном обучении
Когда вы развертываете прогнозный эксперимент в качестве оценивающей веб-службы, вы получаете статическую модель. Если появляются новые данные или у пользователя API есть свои данные, эту модель нужно переобучить. 

Полное описание повторного обучения классической веб-службы см. в статье [Программное переобучение моделей машинного обучения](machine-learning-retrain-models-programmatically.md).

## <a name="retraining-process"></a>Процесс повторного обучения
Чтобы переобучить веб-службу, нужно добавить такие дополнительные компоненты.

* Веб-службу, развернутую из обучающего эксперимента. В рамках эксперимента модуль **выходных данных веб-службы** нужно объединить с выходными данными модуля **Обучение модели**.  
  
    ![Присоедините выходные данные веб-службы к модели обучения.][image1]
* В оценивающую веб-службу нужно добавить новую конечную точку.  Сделать это можно программными средствами, воспользовавшись примером кода из статьи "Программное переобучение моделей машинного обучения", или на классическом портале Azure.

Переобучить модель после этого вы можете с помощью примера кода C#, приведенного на странице справки, посвященной обучению API веб-службы. Если вы, оценив результаты, остались ими довольны, обновите оценивающую веб-службу обученной модели с помощью добавленной вами конечной точки.

Когда все компоненты будут готовы, для повторного обучения модели нужно выполнить следующие основные действия:

1. Вызовите обучающую веб-службу (службу пакетного выполнения (BES), а не службу отклика на запросы (RRS)). Сделать вызов можно с помощью примера кода C#, приведенного на странице справки по интерфейсу API. 
2. Найдите значения параметров *BaseLocation*, *RelativeLocation* и *SasBlobToken*. Они находятся в выходных данных, отправленных в ответ на ваш вызов обучающей веб-службы. 
   ![отображает выходные данные примера повторного обучения и значения параметров BaseLocation, RelativeLocation и SasBlobToken.][image6]
3. Обновите добавленную конечную точку оценивающей веб-службы с помощью повторно обученной модели. С помощью примера кода, приведенного в статье "Программное переобучение моделей машинного обучения", обновите новую конечную точку, добавленную вами в оценивающую модель, с помощью повторно обученной модели из обучающей веб-службы.

## <a name="common-obstacles"></a>Распространенные затруднения
### <a name="check-to-see-if-you-have-the-correct-patch-url"></a>Проверьте, правильно ли указан URL-адрес исправления
Используемый вами URL-адрес исправления должен быть связан с новой оценивающей конечной точкой, добавленной в оценивающую веб-службу. Есть разные способы получить URL-адрес исправления.

**Вариант 1: программно**

Чтобы получить правильный URL-адрес исправления, выполните такие действия:

1. Выполните пример кода [AddEndpoint](https://github.com/raymondlaghaeian/AML_EndpointMgmt/blob/master/Program.cs) .
2. В выходных данных AddEndpoint найдите значение *HelpLocation* и скопируйте URL-адрес.
   
   ![HelpLocation в выходных данных примера addEndpoint.][image2]
3. Вставьте URL-адрес в браузер, чтобы перейти на страницу, содержащую ссылки на справочные статьи о веб-службе.
4. Щелкните ссылку **Обновить ресурс**, чтобы открыть страницу справки с информацией об исправлении.

**Вариант 2: с помощью классического портала Azure**

1. Перейдите на [классический портал Azure](https://manage.windowsazure.com).
2. Перейдите на вкладку "Машинное обучение". 
   ![Вкладка "Машинное обучение".][image4]
3. Щелкните имя рабочей области, а затем выберите **Веб-службы**.
4. Щелкните оценивающую веб-службу, с которой вы работаете. Если вы не изменяли стандартное имя веб-службы, то ее название, скорее всего, заканчивается так: [Scoring Exp.].
5. Щелкните **Добавить конечную точку**.
6. После добавления конечной точки щелкните ее имя. Щелкните **Обновить ресурс** , чтобы открыть страницу справки с информацией об исправлении.

> [!NOTE]
> Если вы добавите конечную точку не к прогнозной веб-службе, а к обучающей веб-службе, при выборе ссылки **Обновить ресурс** появится такая ошибка: Sorry, but this feature is not supported or available in this context (К сожалению, эта функция не поддерживается или недоступна в данном контексте). Эта веб-служба не содержит обновляемых ресурсов. Приносим извинения за неудобства. Мы работаем над исправлением этого.
> 
> 

![Панель мониторинга новой конечной точки.][image3]

Страница исправления содержит URL-адрес исправления, который нужно использовать, и пример кода, с помощью которого можно выполнить вызов.

![URL-адрес исправления.][image5]

### <a name="check-to-see-that-you-are-updating-the-correct-scoring-endpoint"></a>Проверьте, та ли оценивающая конечная точка обновляется
* Исправлять нужно не обучающую, а оценивающую веб-службу.
* Исправлять нужно не ту конечную точку, которая используется по умолчанию в веб-службе, а добавленную вами новую конечную точку оценивающей веб-службы.

Чтобы проверить, в какой веб-службе находится конечная точка, посетите классический портал Azure. 

> [!NOTE]
> Важно добавить конечную точку к прогнозной веб-службе, а не к обучающей. Если вы правильно развернули обучающую и прогнозную веб-службы, вы увидите две отдельные веб-службы. Имя прогнозной веб-службы должно заканчиваться на [predictive exp.].
> 
> 

1. Перейдите на [классический портал Azure](https://manage.windowsazure.com).
2. Перейдите на вкладку "Машинное обучение". 
   ![Пользовательский интерфейс рабочей области машинного обучения.][image4]
3. Щелкните рабочую область.
4. Щелкните **Веб-службы**.
5. Выберите нужную прогнозную веб-службу.
6. Проверьте, добавлена ли новая конечная точка к веб-службе.

### <a name="check-the-workspace-that-your-web-service-is-in-to-ensure-it-is-in-the-correct-region"></a>Чтобы узнать, в правильном ли регионе находится веб-служба, проверьте ее рабочую область.
1. Перейдите на [классический портал Azure](https://manage.windowsazure.com).
2. В меню выберите пункт "Машинное обучение".
   ![Пользовательский интерфейс региона машинного обучения.][image4]
3. Проверьте расположение своей рабочей области.

<!-- Image Links -->

[image1]: ./media/machine-learning-troubleshooting-retraining-a-model/ml-studio-tm-connnected-to-web-service-out.png
[image2]: ./media/machine-learning-troubleshooting-retraining-a-model/addEndpoint-output.png
[image3]: ./media/machine-learning-troubleshooting-retraining-a-model/azure-portal-update-resource.png
[image4]: ./media/machine-learning-troubleshooting-retraining-a-model/azure-portal-machine-learning-tab.png
[image5]: ./media/machine-learning-troubleshooting-retraining-a-model/ml-help-page-patch-url.png
[image6]: ./media/machine-learning-troubleshooting-retraining-a-model/retraining-output.png
[image7]: ./media/machine-learning-troubleshooting-retraining-a-model/web-services-tab.png
