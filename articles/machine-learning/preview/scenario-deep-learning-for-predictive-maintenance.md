---
title: "Глубокое обучение реальным сценариям прогнозного обслуживания в Azure | Документация Майкрософт"
description: "Узнайте больше о репликации руководства по глубокому обучению для прогнозного обслуживания с использованием Azure Machine Learning Workbench."
services: machine-learning
author: FrancescaLazzeri
ms.author: Lazzeri
manager: ireiter
ms.reviewer: garyericson, jasonwhowell, mldocs
ms.service: machine-learning
ms.workload: data-services
ms.custom: 
ms.devlang: 
ms.topic: article
ms.date: 11/22/2017
ms.openlocfilehash: a55209256c29fa62cc2da72f9653fbc7fc0e7c54
ms.sourcegitcommit: 48fce90a4ec357d2fb89183141610789003993d2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2018
---
# <a name="deep-learning-for-predictive-maintenance-real-world-scenarios"></a>Глубокое обучение реальным сценариям прогнозного обслуживания

Глубокое обучение является одной из самых популярных тенденций в машинном обучении. Оно применяется во многих областях, в том числе в беспилотных автомобилях, программах распознавания речи и изображений, робототехнике и финансовой сфере. Глубокое обучение — это набор алгоритмов, созданных на основе строения мозга (биологических нейронных сетей) и машинного обучения. Ученые-когнитивисты, как правило, называют глубокое обучение искусственными нейронными сетями (ANN).

Прогнозное обслуживание также популярно. В прогнозном обслуживании предусмотрено множество различных способов для определения того, в каком состоянии находится оборудование и когда необходимо выполнить обслуживание. Прогнозное обслуживание наиболее часто используется для прогноза сбоя, диагностики сбоя (анализ основных причин), обнаружения сбоя, классификации типов сбоя и рекомендации по устранению рисков или действий обслуживания после сбоя.

В сценариях прогнозного обслуживания время от времени выполняется сбор данных для мониторинга состояния оборудования. Цель состоит в том, чтобы выполнить поиск шаблонов, которые могут быть полезными в прогнозировании и, в конечном счете, предотвращении сбоев. Использование сетей [долгой краткосрочной памяти (LSTM)](http://colah.github.io/posts/2015-08-Understanding-LSTMs/) — метод глубокого обучения, который является особенно удобным в прогнозном обслуживании. Сети LSTM эффективны в обучении на основе последовательностей. Данные временных рядов могут использоваться для ретроспективного взгляда на продолжительные периоды времени, чтобы выявить закономерности сбоев.

В этом руководстве мы создаем сеть LSTM для набора данных и сценария, описанном в статье о [шаблоне прогнозного обслуживания](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Template-3). Мы используем сеть, чтобы спрогнозировать оставшийся период эксплуатации двигателей самолета. В шаблоне для прогнозирования времени выхода из строя двигателя самолета используются значения имитационного датчика самолета. Используя этот метод прогноза, можно заранее запланировать обслуживание, чтобы предотвратить выход из строя.

В этом руководстве используется библиотека глубокого изучения [Keras](https://keras.io/) и набор средств Microsoft Cognitive Toolkit [CNTK](https://docs.microsoft.com/cognitive-toolkit/Using-CNTK-with-Keras) в качестве серверной части.

Открытый репозиторий GitHub, в котором представлены примеры для этого руководства, находится по адресу [https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance](https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance).

## <a name="use-case-overview"></a>Обзор варианта использования

Для демонстрации процесса моделирования прогнозного обслуживания в этом руководстве используется пример имитированных событий эксплуатации двигателей самолета до отказа. 

В описанных здесь смоделированных данных неявно подразумевается, что в ресурсе используется шаблон прогрессирующего снижения. Шаблон отражается в измерениях датчика ресурса. Время от времени проверяя значения датчика ресурса, алгоритм машинного обучения может вычислить связь между значениями датчика, изменениями в них и записями журналов о сбоях. Эта связь используется для прогнозирования сбоев в будущем. 

Прежде чем заменить пример данных собственными данными, мы рекомендуем проверить формат данных и выполнить все три шага шаблона.

## <a name="prerequisites"></a>Необходимые компоненты

- [Учетная запись Azure](https://azure.microsoft.com/free/) (доступны бесплатные пробные версии).
- Azure Machine Learning Workbench с созданной рабочей областью.
- Для ввода модели в эксплуатацию: компонент Azure Machine Learning Operationalization с настроенной средой для локального развертывания и [учетной записью Управления моделями машинного обучения Azure](https://docs.microsoft.com/azure/machine-learning/preview/model-management-overview).

## <a name="create-a-new-workbench-project"></a>Создание проекта в Workbench

Создайте проект, используя в качестве шаблона следующий пример:

1. Откройте Machine Learning Workbench.
2. На странице **Projects** (Проекты) щелкните **+** и выберите **New Project** (Создать проект).
3. В области **Create New Project** (Создание проекта) введите информацию о новом проекте.
4. В поле поиска **Search Project Templates** (Поиск шаблонов проектов) введите **Predictive Maintenance** (Прогнозное обслуживание) и выберите шаблон.
5. Нажмите кнопку **Создать**.

## <a name="prepare-the-notebook-server-computation-target"></a>Подготовка целевого объекта вычислений для сервера записных книжек

На локальном компьютере в меню **File** (Файл) Machine Learning Workbench выберите **Open Command Prompt** (Открыть командную строку) или **Open PowerShell** (Открыть PowerShell). В окне командной строки выбранного варианта выполните следующие команды:

`az ml experiment prepare --target docker --run-configuration docker`

Мы советуем запускать сервер записных книжек на [виртуальной машине Linux (Ubuntu) для обработки и анализа данных (DSVM)](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/microsoft-ads.linux-data-science-vm-ubuntu) категории DS4_V2 Standard. После настройки DSVM выполните следующие команды для подготовки образов Docker:

`az ml computetarget attach remotedocker --name [connection_name] --address [VM_IP_address] --username [VM_username] --password [VM_password]`

`az ml experiment prepare --target [connection_name] --run-configuration [connection_name]`

После подготовки образов Docker откройте сервер записных книжек Jupyter. Чтобы открыть сервер записных книжек Jupyter, перейдите на вкладку **Notebooks** (Записные книжки) в Machine Learning Workbench или запустите сервер в браузере с помощью команды: `az ml notebook start`

Записные книжки хранятся в каталоге Code в среде Jupyter. Запустите эти записные книжки последовательно по нумерации, начиная с Code\1_data_ingestion_and_preparation.ipynb.

Выберите ядро, которое соответствует вашему [имя_подключения] [имя_проекта]_шаблон, а затем выберите **Set Kernel** (Настроить ядро).

## <a name="data-description"></a>Описание данных

В шаблоне используется три набора данных в качестве входных данных в файлах PM_train.txt, PM_test.txt и PM_truth.txt.

-  **Данные для обучения**: данные эксплуатации двигателя самолета до отказа. Данные для обучения (PM_train.txt) состоят из нескольких многомерных линейных временных рядов, в которых *цикл* используется в качестве единицы времени. Они содержат 21 показание датчика для каждого цикла. 

    Можно предположить, что каждый временной ряд создан из другого двигателя того же типа. Предполагается, что каждый двигатель начинает работу с разной степенью начального износа и производственных разновидностей. Эти сведения неизвестны пользователю. 

    В этих смоделированных данных предполагается, что двигатель нормально работает в начале каждого временного ряда. Интенсивность его работы начинает снижаться в определенный момент в течение нескольких циклов работы. Снижение производительности прогрессирует и увеличивается. 

    При достижении предварительно определенного порогового значения двигатель считается небезопасным для дальнейшей эксплуатации. Последний цикл в каждом временном ряду может рассматриваться как точка сбоя соответствующего двигателя.

-   **Данные для тестирования**: данные эксплуатации двигателя самолета без регистрируемых событий сбоя. В данных для тестирования (PM_test.txt) используется та же схема данных, что и в данных для обучения. Единственное отличие заключается в том, что данные не указывают время возникновения сбоя (последний период *не* представляет собой точку сбоя). Неизвестно, сколько еще циклов этот двигатель может отработать до сбоя.

- **Экспериментальные данные**: сведения об оставшихся циклах для каждого двигателя в данных тестирования. Экспериментальные данные указывают количество оставшихся рабочих циклов для двигателей в данных тестирования.

## <a name="scenario-structure"></a>Структура сценария

Содержимое для сценария доступно в [репозитории GitHub] (https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance). 

В [файле сведений] (https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance/blob/master/README.md) репозитория описываются процессы — от подготовки данных до создания и ввода в эксплуатацию модели. Три записные книжки Jupyter доступны в папке [Code] (https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance/tree/master/Code) в репозитории. 

Далее мы пошагово рассмотрим рабочий процесс этого сценария.

### <a name="task-1-data-ingestion-and-preparation"></a>Задача 1. Прием и подготовка данных

Записная книжка Jupyter для приема данных в Code/1_data_ingestion_and_preparation.ipnyb загружает три набора входных данных в формате кадров данных Pandas. Затем она подготавливает данные для моделирования и выполняет предварительную визуализацию данных. Затем данные преобразовываются в формат PySpark и хранятся в контейнере службы хранилища BLOB-объектов Azure в подписке Azure для использования в следующей задаче моделирования.

### <a name="task-2-model-building-and-evaluation"></a>Задача 2. Создание и оценка модели

Записная книжка Jupyter создания моделей в файле Code/2_model_building_and_evaluation.ipnyb PySpark считывает данные для обучения PySpark и тестирует набор данных из хранилища BLOB-объектов. Затем создается сеть LSTM с наборами данных для обучения. Производительность модели измеряется в тестовом наборе. Результирующая модель сериализуется и сохраняется в локальном контексте вычислений для использования в задаче ввода в эксплуатацию.

### <a name="task-3-operationalization"></a>Задача 3. Ввод модели в эксплуатацию

Записная книжка Jupyter ввода в эксплуатацию в файле Code/3_operationalization.ipnyb использует сохраненную модель для создания функций и схемы, необходимой для вызова модели в веб-службе, размещенной в Azure. Записная книжка проверяет функции, а затем архивирует (сжимает) ресурсы ввода в эксплуатацию в ZIP-файл.

Сжатый ZIP-файл содержит эти файлы:

- **modellstm.json** — файл определения схемы для развертывания. 
- **lstmscore.py** — функции **Init()** и **run()**, необходимые для веб-службы Azure.
- **lstm.model** — каталог с описанием модели.

Записная книжка проверяет функции с использованием определения модели, а затем упаковывает эти ресурсы для развертывания. В конце записной книжки добавляются инструкции по развертыванию.


## <a name="conclusion"></a>Заключение

В этом руководстве используется простой сценарий, в котором для составления прогнозов используется только один источник данных (значения датчика). В более сложных сценариях прогнозного обслуживания, таких как [Predictive Maintenance Modelling Guide R Notebook](https://gallery.cortanaintelligence.com/Notebook/Predictive-Maintenance-Modelling-Guide-R-Notebook-1) (Записная книжка R руководства по моделированию прогнозного обслуживания), может использоваться много источников данных. Другие источники данных могут содержать записи журнала обслуживания, журналы ошибок и данные компьютера и оператора. В сетях глубокого обучения для дополнительных источников данных может потребоваться использование различных видов обработки. Кроме того, важно настроить в моделях нужные параметры, такие как для размера окна. 

Вы можете изменить соответствующие части этого сценария и испробовать сценарии различных проблем, например сценарии, описанные в [руководстве по моделированию прогнозного обслуживания](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Modelling-Guide-1), в которых используются несколько источников данных.


## <a name="references"></a>Ссылки

- [Сборник тренировочных заданий для шаблона решения Cortana Intelligence для прогнозируемого обслуживания в аэрокосмических и других компаниях](https://docs.microsoft.com/azure/machine-learning/team-data-science-process/cortana-analytics-playbook-predictive-maintenance)
- [Predictive Maintenance Modelling Guide](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Modelling-Guide-1) (Руководство по моделированию прогнозного обслуживания)
- [Predictive Maintenance Modelling Guide Python Notebook](https://gallery.cortanaintelligence.com/Notebook/Predictive-Maintenance-Modelling-Guide-Python-Notebook-1) (Руководство по моделированию прогнозного обслуживания с помощью записной книжки Python)
- [Predictive Maintenance using PySpark](https://gallery.cortanaintelligence.com/Tutorial/Predictive-Maintenance-using-PySpark) (Прогнозное обслуживание с помощью PySpark)

