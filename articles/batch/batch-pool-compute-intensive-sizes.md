---
title: "aaaUse вычислений виртуальные машины Azure с использованием пакета | Документы Microsoft"
description: "Как tootake преимуществами функцией RDMA или поддержкой графического Процессора виртуальной Машины размером в пулах пакетной службы Azure"
services: batch
documentationcenter: 
author: dlepow
manager: timlt
editor: 
ms.assetid: 
ms.service: batch
ms.workload: big-compute
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/27/2017
ms.author: danlep
ms.openlocfilehash: 6a462a5f2a44ddcec8bf4e5c200d444cac8fafe6
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="use-rdma-capable-or-gpu-enabled-instances-in-batch-pools"></a><span data-ttu-id="434ad-103">Использование экземпляров с поддержкой RDMA или графического процессора (GPU) в пулах пакетной службы</span><span class="sxs-lookup"><span data-stu-id="434ad-103">Use RDMA-capable or GPU-enabled instances in Batch pools</span></span>

<span data-ttu-id="434ad-104">toorun определенных пакетных заданий может потребоваться tootake преимуществами предназначены для крупномасштабных вычисления размеров виртуальных Машин Azure.</span><span class="sxs-lookup"><span data-stu-id="434ad-104">toorun certain Batch jobs, you might want tootake advantage of Azure VM sizes designed for large-scale computation.</span></span> <span data-ttu-id="434ad-105">Например, несколькими экземплярами toorun [рабочих нагрузок MPI](batch-mpi.md), вы можете A8, A9, или H-series размеры, которые есть сеть интерфейс для удаленного прямого доступа к памяти (RDMA).</span><span class="sxs-lookup"><span data-stu-id="434ad-105">For example, toorun multi-instance [MPI workloads](batch-mpi.md), you can choose A8, A9, or H-series sizes that have a network interface for Remote Direct Memory Access (RDMA).</span></span> <span data-ttu-id="434ad-106">Эти размеры подключиться к сети InfiniBand tooan для обмена данными между узлами, которая ускоряет приложений MPI.</span><span class="sxs-lookup"><span data-stu-id="434ad-106">These sizes connect tooan InfiniBand network for inter-node communication, which can accelerate MPI applications.</span></span> <span data-ttu-id="434ad-107">Для приложений CUDA можно выбрать размеры серии N, которые включают карты графического процессора (GPU) NVIDIA Tesla.</span><span class="sxs-lookup"><span data-stu-id="434ad-107">Or for CUDA applications, you can choose N-series sizes that include NVIDIA Tesla graphics processing unit (GPU) cards.</span></span>

<span data-ttu-id="434ad-108">Эта статья содержит рекомендации и примеры toouse специализированные размер Azure в пулах пакета.</span><span class="sxs-lookup"><span data-stu-id="434ad-108">This article provides guidance and examples toouse some of Azure's specialized sizes in Batch pools.</span></span> <span data-ttu-id="434ad-109">Спецификации и общие сведения см. по следующим ссылкам:</span><span class="sxs-lookup"><span data-stu-id="434ad-109">For specs and background, see:</span></span>

* <span data-ttu-id="434ad-110">размеры виртуальных машин, оптимизированных для высокопроизводительных вычислений ([Linux](../virtual-machines/linux/sizes-hpc.md), [Windows](../virtual-machines/windows/sizes-hpc.md));</span><span class="sxs-lookup"><span data-stu-id="434ad-110">High performance compute VM sizes ([Linux](../virtual-machines/linux/sizes-hpc.md), [Windows](../virtual-machines/windows/sizes-hpc.md))</span></span> 

* <span data-ttu-id="434ad-111">размеры виртуальных машин с поддержкой графического процессора (GPU) ([Linux](../virtual-machines/linux/sizes-gpu.md), [Windows](../virtual-machines/windows/sizes-gpu.md)).</span><span class="sxs-lookup"><span data-stu-id="434ad-111">GPU-enabled VM sizes ([Linux](../virtual-machines/linux/sizes-gpu.md), [Windows](../virtual-machines/windows/sizes-gpu.md))</span></span> 


## <a name="subscription-and-account-limits"></a><span data-ttu-id="434ad-112">Ограничения подписки и учетной записи</span><span class="sxs-lookup"><span data-stu-id="434ad-112">Subscription and account limits</span></span>

* <span data-ttu-id="434ad-113">**Квоты** -одну или несколько квот Azure может ограничить число hello или тип узлов можно добавить tooa пула.</span><span class="sxs-lookup"><span data-stu-id="434ad-113">**Quotas** - One or more Azure quotas may limit hello number or type of nodes you can add tooa Batch pool.</span></span> <span data-ttu-id="434ad-114">Вы являетесь, скорее всего, toobe ограниченный при выборе функцией RDMA, GPU включен, или другие многоядерными размеры виртуальных Машин.</span><span class="sxs-lookup"><span data-stu-id="434ad-114">You are more likely toobe limited when you choose RDMA-capable, GPU-enabled, or other multicore VM sizes.</span></span> <span data-ttu-id="434ad-115">В зависимости от типа hello созданную учетную запись пакета квоты hello применить toohello с учетной записью или tooyour подписки.</span><span class="sxs-lookup"><span data-stu-id="434ad-115">Depending on hello type of Batch account you created, hello quotas could apply toohello account itself or tooyour subscription.</span></span>

    * <span data-ttu-id="434ad-116">При создании учетной записи пакета в hello **пакетной службы** конфигурации, ограничиваются hello [Квота выделенных ядер на учетную запись пакетной](batch-quota-limit.md#resource-quotas).</span><span class="sxs-lookup"><span data-stu-id="434ad-116">If you created your Batch account in hello **Batch service** configuration, you are limited by hello [dedicated cores quota per Batch account](batch-quota-limit.md#resource-quotas).</span></span> <span data-ttu-id="434ad-117">По умолчанию задана квота в 20 ядер.</span><span class="sxs-lookup"><span data-stu-id="434ad-117">By default, this quota is 20 cores.</span></span> <span data-ttu-id="434ad-118">Отдельные Квота также применяется[виртуальные машины с низким приоритетом](batch-low-pri-vms.md), если они используются.</span><span class="sxs-lookup"><span data-stu-id="434ad-118">A separate quota applies too[low-priority VMs](batch-low-pri-vms.md), if you use them.</span></span> 

    * <span data-ttu-id="434ad-119">Если вы создали учетную запись hello в hello **подписки пользователя** конфигурации подписки ограничивает число hello Виртуальных машинах в одном регионе.</span><span class="sxs-lookup"><span data-stu-id="434ad-119">If you created hello account in hello **User subscription** configuration, your subscription limits hello number of VM cores per region.</span></span> <span data-ttu-id="434ad-120">Ознакомьтесь со статьей [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="434ad-120">See [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span> <span data-ttu-id="434ad-121">Подписки также применяется региональные квоты размера виртуальной Машины toocertain, включая экземпляры HPC и GPU.</span><span class="sxs-lookup"><span data-stu-id="434ad-121">Your subscription also applies a regional quota toocertain VM sizes, including HPC and GPU instances.</span></span> <span data-ttu-id="434ad-122">В конфигурации подписки пользователя hello без дополнительных квот применяются toohello пакетной учетной записи.</span><span class="sxs-lookup"><span data-stu-id="434ad-122">In hello user subscription configuration, no additional quotas apply toohello Batch account.</span></span> 

  <span data-ttu-id="434ad-123">Может потребоваться tooincrease одну или несколько квот при использовании специализированных размер виртуальной Машины в пакете.</span><span class="sxs-lookup"><span data-stu-id="434ad-123">You might need tooincrease one or more quotas when using a specialized VM size in Batch.</span></span> <span data-ttu-id="434ad-124">Увеличение квоты, откройте toorequest [запрос на получение поддержки сети клиента](../azure-supportability/how-to-create-azure-support-request.md) бесплатно.</span><span class="sxs-lookup"><span data-stu-id="434ad-124">toorequest a quota increase, open an [online customer support request](../azure-supportability/how-to-create-azure-support-request.md) at no charge.</span></span>

* <span data-ttu-id="434ad-125">**Область доступности** - вычислений виртуальные машины могут быть недоступны в регионах hello создаются учетные записи пакета.</span><span class="sxs-lookup"><span data-stu-id="434ad-125">**Region availability** - Compute-intensive VMs might not be available in hello regions where you create your Batch accounts.</span></span> <span data-ttu-id="434ad-126">toocheck, что размер доступен в разделе [продукты, доступные по регионам](https://azure.microsoft.com/regions/services/).</span><span class="sxs-lookup"><span data-stu-id="434ad-126">toocheck that a size is available, see [Products available by region](https://azure.microsoft.com/regions/services/).</span></span>


## <a name="dependencies"></a><span data-ttu-id="434ad-127">Зависимости</span><span class="sxs-lookup"><span data-stu-id="434ad-127">Dependencies</span></span>

<span data-ttu-id="434ad-128">Hello RDMA и возможности GPU размеров большим объемом вычислений, поддерживаются только в определенных операционных системах.</span><span class="sxs-lookup"><span data-stu-id="434ad-128">hello RDMA and GPU capabilities of compute-intensive sizes are supported only in certain operating systems.</span></span> <span data-ttu-id="434ad-129">В зависимости от операционной системы может потребоваться tooinstall или Настройка дополнительных драйверов или другого программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="434ad-129">Depending on your operating system, you might need tooinstall or configure additional driver or other software.</span></span> <span data-ttu-id="434ad-130">Привет, в следующей таблице приведены эти зависимости.</span><span class="sxs-lookup"><span data-stu-id="434ad-130">hello following tables summarize these dependencies.</span></span> <span data-ttu-id="434ad-131">Перейдите по ссылке, чтобы просмотреть дополнительные сведения.</span><span class="sxs-lookup"><span data-stu-id="434ad-131">See linked articles for details.</span></span> <span data-ttu-id="434ad-132">Параметры tooconfigure пакета пулы см. Далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="434ad-132">For options tooconfigure Batch pools, see later in this article.</span></span>


### <a name="linux-pools---virtual-machine-configuration"></a><span data-ttu-id="434ad-133">Пулы Linux — конфигурация виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="434ad-133">Linux pools - Virtual machine configuration</span></span>

| <span data-ttu-id="434ad-134">Размер</span><span class="sxs-lookup"><span data-stu-id="434ad-134">Size</span></span> | <span data-ttu-id="434ad-135">Функция</span><span class="sxs-lookup"><span data-stu-id="434ad-135">Capability</span></span> | <span data-ttu-id="434ad-136">Операционные системы</span><span class="sxs-lookup"><span data-stu-id="434ad-136">Operating systems</span></span> | <span data-ttu-id="434ad-137">Необходимое программное обеспечение</span><span class="sxs-lookup"><span data-stu-id="434ad-137">Required software</span></span> | <span data-ttu-id="434ad-138">Параметры пула</span><span class="sxs-lookup"><span data-stu-id="434ad-138">Pool settings</span></span> |
| -------- | -------- | ----- |  -------- | ----- |
| [<span data-ttu-id="434ad-139">H16r, H16mr, A8, A9</span><span class="sxs-lookup"><span data-stu-id="434ad-139">H16r, H16mr, A8, A9</span></span>](../virtual-machines/linux/sizes-hpc.md#rdma-capable-instances) | <span data-ttu-id="434ad-140">RDMA</span><span class="sxs-lookup"><span data-stu-id="434ad-140">RDMA</span></span> | <span data-ttu-id="434ad-141">SUSE Linux Enterprise Server 12 HPC или</span><span class="sxs-lookup"><span data-stu-id="434ad-141">SUSE Linux Enterprise Server 12 HPC or</span></span><br/><span data-ttu-id="434ad-142">Экземпляр HPC на платформе CentOS</span><span class="sxs-lookup"><span data-stu-id="434ad-142">CentOS-based HPC</span></span><br/><span data-ttu-id="434ad-143">(Microsoft Azure Marketplace)</span><span class="sxs-lookup"><span data-stu-id="434ad-143">(Azure Marketplace)</span></span> | <span data-ttu-id="434ad-144">Intel MPI 5</span><span class="sxs-lookup"><span data-stu-id="434ad-144">Intel MPI 5</span></span> | <span data-ttu-id="434ad-145">Включение связи между узлами, отключение параллельного выполнения задач</span><span class="sxs-lookup"><span data-stu-id="434ad-145">Enable inter-node communication, disable concurrent task execution</span></span> |
| [<span data-ttu-id="434ad-146">Серия NC*</span><span class="sxs-lookup"><span data-stu-id="434ad-146">NC series*</span></span>](../virtual-machines/linux/n-series-driver-setup.md#install-cuda-drivers-for-nc-vms) | <span data-ttu-id="434ad-147">Графический процессор NVIDIA Tesla K80</span><span class="sxs-lookup"><span data-stu-id="434ad-147">NVIDIA Tesla K80 GPU</span></span> | <span data-ttu-id="434ad-148">Ubuntu 16.04 LTS.</span><span class="sxs-lookup"><span data-stu-id="434ad-148">Ubuntu 16.04 LTS.</span></span><br/><span data-ttu-id="434ad-149">Red Hat Enterprise Linux 7.3 или</span><span class="sxs-lookup"><span data-stu-id="434ad-149">Red Hat Enterprise Linux 7.3, or</span></span><br/><span data-ttu-id="434ad-150">Версия 7.3 на основе CentOS</span><span class="sxs-lookup"><span data-stu-id="434ad-150">CentOS-based 7.3</span></span><br/><span data-ttu-id="434ad-151">(Microsoft Azure Marketplace)</span><span class="sxs-lookup"><span data-stu-id="434ad-151">(Azure Marketplace)</span></span> | <span data-ttu-id="434ad-152">Драйверы для набора средств NVIDIA CUDA Toolkit 8.0</span><span class="sxs-lookup"><span data-stu-id="434ad-152">NVIDIA CUDA Toolkit 8.0 drivers</span></span> | <span data-ttu-id="434ad-153">Недоступно</span><span class="sxs-lookup"><span data-stu-id="434ad-153">N/A</span></span> | 
| [<span data-ttu-id="434ad-154">Серия NV</span><span class="sxs-lookup"><span data-stu-id="434ad-154">NV series</span></span>](../virtual-machines/linux/n-series-driver-setup.md#install-grid-drivers-for-nv-vms) | <span data-ttu-id="434ad-155">Графический процессор NVIDIA Tesla M60</span><span class="sxs-lookup"><span data-stu-id="434ad-155">NVIDIA Tesla M60 GPU</span></span> | <span data-ttu-id="434ad-156">Ubuntu 16.04 LTS</span><span class="sxs-lookup"><span data-stu-id="434ad-156">Ubuntu 16.04 LTS</span></span><br/><span data-ttu-id="434ad-157">Red Hat Enterprise Linux 7.3</span><span class="sxs-lookup"><span data-stu-id="434ad-157">Red Hat Enterprise Linux 7.3</span></span><br/><span data-ttu-id="434ad-158">Версия 7.3 на основе CentOS</span><span class="sxs-lookup"><span data-stu-id="434ad-158">CentOS-based 7.3</span></span><br/><span data-ttu-id="434ad-159">(Microsoft Azure Marketplace)</span><span class="sxs-lookup"><span data-stu-id="434ad-159">(Azure Marketplace)</span></span> | <span data-ttu-id="434ad-160">Драйверы для NVIDIA GRID 4.3</span><span class="sxs-lookup"><span data-stu-id="434ad-160">NVIDIA GRID 4.3 drivers</span></span> | <span data-ttu-id="434ad-161">Недоступно</span><span class="sxs-lookup"><span data-stu-id="434ad-161">N/A</span></span> |

<span data-ttu-id="434ad-162">* Подключение RDMA на виртуальных машинах NC24r поддерживается в экземпляре HPC на платформе CentOS 7.3 с Intel MPI.</span><span class="sxs-lookup"><span data-stu-id="434ad-162">*RDMA connectivity on NC24r VMs is supported on CentOS-based 7.3 HPC with Intel MPI.</span></span>



### <a name="windows-pools---virtual-machine-configuration"></a><span data-ttu-id="434ad-163">Пулы Windows — конфигурация виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="434ad-163">Windows pools - Virtual machine configuration</span></span>

| <span data-ttu-id="434ad-164">Размер</span><span class="sxs-lookup"><span data-stu-id="434ad-164">Size</span></span> | <span data-ttu-id="434ad-165">Функция</span><span class="sxs-lookup"><span data-stu-id="434ad-165">Capability</span></span> | <span data-ttu-id="434ad-166">Операционные системы</span><span class="sxs-lookup"><span data-stu-id="434ad-166">Operating systems</span></span> | <span data-ttu-id="434ad-167">Необходимое программное обеспечение</span><span class="sxs-lookup"><span data-stu-id="434ad-167">Required software</span></span> | <span data-ttu-id="434ad-168">Параметры пула</span><span class="sxs-lookup"><span data-stu-id="434ad-168">Pool settings</span></span> |
| -------- | ------ | -------- | -------- | ----- |
| [<span data-ttu-id="434ad-169">H16r, H16mr, A8, A9</span><span class="sxs-lookup"><span data-stu-id="434ad-169">H16r, H16mr, A8, A9</span></span>](../virtual-machines/windows/sizes-hpc.md#rdma-capable-instances) | <span data-ttu-id="434ad-170">RDMA</span><span class="sxs-lookup"><span data-stu-id="434ad-170">RDMA</span></span> | <span data-ttu-id="434ad-171">Windows Server 2012 R2 или</span><span class="sxs-lookup"><span data-stu-id="434ad-171">Windows Server 2012 R2 or</span></span><br/><span data-ttu-id="434ad-172">Windows Server 2012 (Microsoft Azure Marketplace)</span><span class="sxs-lookup"><span data-stu-id="434ad-172">Windows Server 2012 (Azure Marketplace)</span></span> | <span data-ttu-id="434ad-173">Microsoft MPI 2012 R2 или более поздней версии либо</span><span class="sxs-lookup"><span data-stu-id="434ad-173">Microsoft MPI 2012 R2 or later, or</span></span><br/> <span data-ttu-id="434ad-174">Intel MPI 5</span><span class="sxs-lookup"><span data-stu-id="434ad-174">Intel MPI 5</span></span><br/><br/><span data-ttu-id="434ad-175">Расширение виртуальных машин Azure HpcVMDrivers</span><span class="sxs-lookup"><span data-stu-id="434ad-175">HpcVMDrivers Azure VM extension</span></span> | <span data-ttu-id="434ad-176">Включение связи между узлами, отключение параллельного выполнения задач</span><span class="sxs-lookup"><span data-stu-id="434ad-176">Enable inter-node communication, disable concurrent task execution</span></span> |
| [<span data-ttu-id="434ad-177">Серия NC*</span><span class="sxs-lookup"><span data-stu-id="434ad-177">NC series*</span></span>](../virtual-machines/windows/n-series-driver-setup.md) | <span data-ttu-id="434ad-178">Графический процессор NVIDIA Tesla K80</span><span class="sxs-lookup"><span data-stu-id="434ad-178">NVIDIA Tesla K80 GPU</span></span> | <span data-ttu-id="434ad-179">Windows Server 2016 или</span><span class="sxs-lookup"><span data-stu-id="434ad-179">Windows Server 2016 or</span></span> <br/><span data-ttu-id="434ad-180">Windows Server 2012 R2 (Microsoft Azure Marketplace)</span><span class="sxs-lookup"><span data-stu-id="434ad-180">Windows Server 2012 R2 (Azure Marketplace)</span></span> | <span data-ttu-id="434ad-181">Драйверы NVIDIA Tesla или драйверы набора средств CUDA Toolkit 8.0</span><span class="sxs-lookup"><span data-stu-id="434ad-181">NVIDIA Tesla drivers or CUDA Toolkit 8.0 drivers</span></span>| <span data-ttu-id="434ad-182">Недоступно</span><span class="sxs-lookup"><span data-stu-id="434ad-182">N/A</span></span> | 
| [<span data-ttu-id="434ad-183">Серия NV</span><span class="sxs-lookup"><span data-stu-id="434ad-183">NV series</span></span>](../virtual-machines/windows/n-series-driver-setup.md) | <span data-ttu-id="434ad-184">Графический процессор NVIDIA Tesla M60</span><span class="sxs-lookup"><span data-stu-id="434ad-184">NVIDIA Tesla M60 GPU</span></span> | <span data-ttu-id="434ad-185">Windows Server 2016 или</span><span class="sxs-lookup"><span data-stu-id="434ad-185">Windows Server 2016 or</span></span><br/><span data-ttu-id="434ad-186">Windows Server 2012 R2 (Microsoft Azure Marketplace)</span><span class="sxs-lookup"><span data-stu-id="434ad-186">Windows Server 2012 R2 (Azure Marketplace)</span></span> | <span data-ttu-id="434ad-187">Драйверы для NVIDIA GRID 4.3</span><span class="sxs-lookup"><span data-stu-id="434ad-187">NVIDIA GRID 4.3 drivers</span></span> | <span data-ttu-id="434ad-188">Недоступно</span><span class="sxs-lookup"><span data-stu-id="434ad-188">N/A</span></span> |

<span data-ttu-id="434ad-189">* Подключение RDMA на виртуальных машинах NC24r поддерживается на Windows Server 2012 R2 с расширением HpcVMDrivers и Microsoft MPI или Intel MPI.</span><span class="sxs-lookup"><span data-stu-id="434ad-189">*RDMA connectivity on NC24r VMs is supported on Windows Server 2012 R2 with HpcVMDrivers extension and Microsoft MPI or Intel MPI.</span></span>

### <a name="windows-pools---cloud-services-configuration"></a><span data-ttu-id="434ad-190">Пулы Windows — конфигурация облачных служб</span><span class="sxs-lookup"><span data-stu-id="434ad-190">Windows pools - Cloud services configuration</span></span>

> [!NOTE]
> <span data-ttu-id="434ad-191">N-й серии размеры не поддерживаются в пулах пакета с hello конфигурация облачных служб.</span><span class="sxs-lookup"><span data-stu-id="434ad-191">N-series sizes are not supported in Batch pools with hello cloud services configuration.</span></span>
>

| <span data-ttu-id="434ad-192">Размер</span><span class="sxs-lookup"><span data-stu-id="434ad-192">Size</span></span> | <span data-ttu-id="434ad-193">Функция</span><span class="sxs-lookup"><span data-stu-id="434ad-193">Capability</span></span> | <span data-ttu-id="434ad-194">Операционные системы</span><span class="sxs-lookup"><span data-stu-id="434ad-194">Operating systems</span></span> | <span data-ttu-id="434ad-195">Необходимое программное обеспечение</span><span class="sxs-lookup"><span data-stu-id="434ad-195">Required software</span></span> | <span data-ttu-id="434ad-196">Параметры пула</span><span class="sxs-lookup"><span data-stu-id="434ad-196">Pool settings</span></span> |
| -------- | ------- | -------- | -------- | ----- |
| [<span data-ttu-id="434ad-197">H16r, H16mr, A8, A9</span><span class="sxs-lookup"><span data-stu-id="434ad-197">H16r, H16mr, A8, A9</span></span>](../virtual-machines/windows/sizes-hpc.md#rdma-capable-instances) | <span data-ttu-id="434ad-198">RDMA</span><span class="sxs-lookup"><span data-stu-id="434ad-198">RDMA</span></span> | <span data-ttu-id="434ad-199">Windows Server 2012 R2,</span><span class="sxs-lookup"><span data-stu-id="434ad-199">Windows Server 2012 R2,</span></span><br/><span data-ttu-id="434ad-200">Windows Server 2012 или</span><span class="sxs-lookup"><span data-stu-id="434ad-200">Windows Server 2012, or</span></span><br/><span data-ttu-id="434ad-201">Windows Server 2008 R2 (семейство версий гостевой ОС)</span><span class="sxs-lookup"><span data-stu-id="434ad-201">Windows Server 2008 R2 (Guest OS family)</span></span> | <span data-ttu-id="434ad-202">Microsoft MPI 2012 R2 или более поздней версии либо</span><span class="sxs-lookup"><span data-stu-id="434ad-202">Microsoft MPI 2012 R2 or later, or</span></span><br/><span data-ttu-id="434ad-203">Intel MPI 5</span><span class="sxs-lookup"><span data-stu-id="434ad-203">Intel MPI 5</span></span><br/><br/><span data-ttu-id="434ad-204">Расширение виртуальных машин Azure HpcVMDrivers</span><span class="sxs-lookup"><span data-stu-id="434ad-204">HpcVMDrivers Azure VM extension</span></span> | <span data-ttu-id="434ad-205">Включение связи между узлами,</span><span class="sxs-lookup"><span data-stu-id="434ad-205">Enable inter-node communication,</span></span><br/> <span data-ttu-id="434ad-206">отключение параллельного выполнения задач</span><span class="sxs-lookup"><span data-stu-id="434ad-206">disable concurrent task execution</span></span> |





## <a name="pool-configuration-options"></a><span data-ttu-id="434ad-207">Варианты настройки пула</span><span class="sxs-lookup"><span data-stu-id="434ad-207">Pool configuration options</span></span>

<span data-ttu-id="434ad-208">tooconfigure специализированные размер виртуальной Машины для пула, API-интерфейсы пакета hello и средства пакета предоставляют несколько программного обеспечения tooinstall необходимые параметры или драйверов, включая:</span><span class="sxs-lookup"><span data-stu-id="434ad-208">tooconfigure a specialized VM size for your Batch pool, hello Batch APIs and tools provide several options tooinstall required software or drivers, including:</span></span>

* <span data-ttu-id="434ad-209">[Запустить задачу](batch-api-basics.md#start-task) -Загрузите пакет установки как tooan файл ресурсов учетной записи хранилища Azure в hello же регионе, что hello пакетной учетной записи.</span><span class="sxs-lookup"><span data-stu-id="434ad-209">[Start task](batch-api-basics.md#start-task) - Upload an installation package as a resource file tooan Azure storage account in hello same region as hello Batch account.</span></span> <span data-ttu-id="434ad-210">Создания файла ресурсов hello tooinstall начала задачи командной строки без вмешательства пользователя, при запуске пула hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-210">Create a start task command line tooinstall hello resource file silently when hello pool starts.</span></span> <span data-ttu-id="434ad-211">Дополнительные сведения см. в разделе hello [документация по REST API](/rest/api/batchservice/add-a-pool-to-an-account#bk_starttask).</span><span class="sxs-lookup"><span data-stu-id="434ad-211">For more information, see hello [REST API documentation](/rest/api/batchservice/add-a-pool-to-an-account#bk_starttask).</span></span>

  > [!NOTE] 
  > <span data-ttu-id="434ad-212">Задача запуска Hello необходимо запустить с повышенными привилегиями (администратор) разрешениями и дождитесь успешного завершения.</span><span class="sxs-lookup"><span data-stu-id="434ad-212">hello start task must run with elevated (admin) permissions, and it must wait for success.</span></span>
  >

* <span data-ttu-id="434ad-213">[Пакет приложения](batch-application-packages.md) — Добавление ZIP-папки установки пакета tooyour пакетной учетной записи и настройка пакета справочника в пуле hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-213">[Application package](batch-application-packages.md) - Add a zipped installation package tooyour Batch account, and configure a package reference in hello pool.</span></span> <span data-ttu-id="434ad-214">Этот параметр передает и распаковывает hello пакета на всех узлах в кластере hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-214">This setting uploads and unzips hello package on all nodes in hello pool.</span></span> <span data-ttu-id="434ad-215">Если hello пакет установщика, создайте приложение hello установки начала задачи командной строки toosilently на всех узлах пула.</span><span class="sxs-lookup"><span data-stu-id="434ad-215">If hello package is an installer, create a start task command line toosilently install hello app on all pool nodes.</span></span> <span data-ttu-id="434ad-216">Дополнительно можно установите hello пакета, если задача становится запланированных toorun на узле.</span><span class="sxs-lookup"><span data-stu-id="434ad-216">Optionally, install hello package when a task is scheduled toorun on a node.</span></span>

* <span data-ttu-id="434ad-217">[Пул настраиваемых изображений](batch-api-basics.md#pool) — создать пользовательские Windows или образ ВМ Linux, содержащий драйверы, программного обеспечения и другие параметры требуется для hello размер виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="434ad-217">[Custom pool image](batch-api-basics.md#pool) - Create a custom Windows or Linux VM image that contains drivers, software, or other settings required for hello VM size.</span></span> <span data-ttu-id="434ad-218">При создании учетной записи пакета в конфигурации подписки пользователя hello укажите hello пользовательского образа для пула пакета.</span><span class="sxs-lookup"><span data-stu-id="434ad-218">If you created your Batch account in hello user subscription configuration, specify hello custom image for your Batch pool.</span></span> <span data-ttu-id="434ad-219">(Пользовательские образы, не поддерживаются в учетных записях в конфигурации службы пакета hello.) Пользовательские изображения может использоваться только с пулами в конфигурации виртуальной машины hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-219">(Custom images are not supported in accounts in hello Batch service configuration.) Custom images can only be used with pools in hello virtual machine configuration.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="434ad-220">В пулах пакетной службы сейчас нельзя использовать пользовательские образы, созданные с помощью управляемых дисков или хранилища класса Premium.</span><span class="sxs-lookup"><span data-stu-id="434ad-220">In Batch pools, you can't currently use a custom image created with managed disks or with Premium storage.</span></span>
  >



* <span data-ttu-id="434ad-221">[Пакетное Shipyard](https://github.com/Azure/batch-shipyard) автоматически настраивает hello GPU и RDMA toowork прозрачно контейнерного рабочих нагрузок на пакетной службы Azure.</span><span class="sxs-lookup"><span data-stu-id="434ad-221">[Batch Shipyard](https://github.com/Azure/batch-shipyard) automatically configures hello GPU and RDMA toowork transparently with containerized workloads on Azure Batch.</span></span> <span data-ttu-id="434ad-222">Для выполнения действий Batch Shipyard полностью полагается на файлы конфигурации.</span><span class="sxs-lookup"><span data-stu-id="434ad-222">Batch Shipyard is entirely driven with configuration files.</span></span> <span data-ttu-id="434ad-223">Существует много образец рецепт доступны конфигурации, позволяющие GPU и RDMA рабочих нагрузок, например hello [CNTK GPU рецепт](https://github.com/Azure/batch-shipyard/tree/master/recipes/CNTK-GPU-OpenMPI) которого выполняет предварительную настройку GPU драйверы на виртуальные машины серии N и загружает программного обеспечения Microsoft Когнитивных Toolkit как образ Docker.</span><span class="sxs-lookup"><span data-stu-id="434ad-223">There are many sample recipe configurations available that enable GPU and RDMA workloads such as hello [CNTK GPU Recipe](https://github.com/Azure/batch-shipyard/tree/master/recipes/CNTK-GPU-OpenMPI)  which preconfigures GPU drivers on N-series VMs and loads Microsoft Cognitive Toolkit software as a Docker image.</span></span>


## <a name="example-microsoft-mpi-on-an-a8-vm-pool"></a><span data-ttu-id="434ad-224">Пример: Microsoft MPI в пуле виртуальной машины A8</span><span class="sxs-lookup"><span data-stu-id="434ad-224">Example: Microsoft MPI on an A8 VM pool</span></span>

<span data-ttu-id="434ad-225">toorun приложений Windows MPI в пуле узлов Azure A8, необходимо tooinstall поддерживаемой реализации MPI.</span><span class="sxs-lookup"><span data-stu-id="434ad-225">toorun Windows MPI applications on a pool of Azure A8 nodes, you need tooinstall a supported MPI implementation.</span></span> <span data-ttu-id="434ad-226">Вот пример действия tooinstall [Microsoft MPI](https://msdn.microsoft.com/library/bb524831(v=vs.85).aspx) Windows и пула, с помощью пакета приложения пакета.</span><span class="sxs-lookup"><span data-stu-id="434ad-226">Here are sample steps tooinstall [Microsoft MPI](https://msdn.microsoft.com/library/bb524831(v=vs.85).aspx) on a Windows pool using a Batch application package.</span></span>

1. <span data-ttu-id="434ad-227">Загрузите hello [пакет установки](http://go.microsoft.com/FWLink/p/?LinkID=389556) (MSMpiSetup.exe) для hello последнюю версию Microsoft MPI.</span><span class="sxs-lookup"><span data-stu-id="434ad-227">Download hello [setup package](http://go.microsoft.com/FWLink/p/?LinkID=389556) (MSMpiSetup.exe) for hello latest version of Microsoft MPI.</span></span>
2. <span data-ttu-id="434ad-228">Создайте ZIP-файл пакета hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-228">Create a zip file of hello package.</span></span>
3. <span data-ttu-id="434ad-229">Отправьте hello пакета tooyour пакетной учетной записи.</span><span class="sxs-lookup"><span data-stu-id="434ad-229">Upload hello package tooyour Batch account.</span></span> <span data-ttu-id="434ad-230">Пошаговые инструкции см. в разделе hello [пакетов приложений](batch-application-packages.md) рекомендации.</span><span class="sxs-lookup"><span data-stu-id="434ad-230">For steps, see hello [application packages](batch-application-packages.md) guidance.</span></span> <span data-ttu-id="434ad-231">Укажите идентификатор приложения, например *MSMPI*, и его версию, например *8.1*.</span><span class="sxs-lookup"><span data-stu-id="434ad-231">Specify an application id such as *MSMPI*, and a version such as *8.1*.</span></span> 
4. <span data-ttu-id="434ad-232">С помощью API-интерфейсы пакета hello или портал Azure, создание пула в конфигурации службы hello облака с hello требуемого числа узлов и масштаб.</span><span class="sxs-lookup"><span data-stu-id="434ad-232">Using hello Batch APIs or Azure portal, create a pool in hello cloud services configuration with hello desired number of nodes and scale.</span></span> <span data-ttu-id="434ad-233">Hello Следующая таблица показывает пример tooset параметры копирования MPI в автоматическом режиме с помощью задачи запуска:</span><span class="sxs-lookup"><span data-stu-id="434ad-233">hello following table shows sample settings tooset up MPI in unattended mode using a start task:</span></span>

| <span data-ttu-id="434ad-234">Настройка</span><span class="sxs-lookup"><span data-stu-id="434ad-234">Setting</span></span> | <span data-ttu-id="434ad-235">Значение</span><span class="sxs-lookup"><span data-stu-id="434ad-235">Value</span></span> |
| ---- | ----- | 
| <span data-ttu-id="434ad-236">**Тип образа**</span><span class="sxs-lookup"><span data-stu-id="434ad-236">**Image Type**</span></span> | <span data-ttu-id="434ad-237">Облачные службы</span><span class="sxs-lookup"><span data-stu-id="434ad-237">Cloud Services</span></span> |
| <span data-ttu-id="434ad-238">**Семейство ОС**</span><span class="sxs-lookup"><span data-stu-id="434ad-238">**OS family**</span></span> | <span data-ttu-id="434ad-239">Windows Server 2012 R2 (семейство ОС 4)</span><span class="sxs-lookup"><span data-stu-id="434ad-239">Windows Server 2012 R2 (OS family 4)</span></span> |
| <span data-ttu-id="434ad-240">**Размер узла**</span><span class="sxs-lookup"><span data-stu-id="434ad-240">**Node size**</span></span> | <span data-ttu-id="434ad-241">A8 уровня "Стандартный"</span><span class="sxs-lookup"><span data-stu-id="434ad-241">A8 Standard</span></span> |
| <span data-ttu-id="434ad-242">**Включена связь между узлами**</span><span class="sxs-lookup"><span data-stu-id="434ad-242">**Internode communication enabled**</span></span> | <span data-ttu-id="434ad-243">Да</span><span class="sxs-lookup"><span data-stu-id="434ad-243">True</span></span> |
| <span data-ttu-id="434ad-244">**Максимальное число заданий на узел**</span><span class="sxs-lookup"><span data-stu-id="434ad-244">**Max tasks per node**</span></span> | <span data-ttu-id="434ad-245">1</span><span class="sxs-lookup"><span data-stu-id="434ad-245">1</span></span> |
| <span data-ttu-id="434ad-246">**Ссылки на пакет приложения**</span><span class="sxs-lookup"><span data-stu-id="434ad-246">**Application package references**</span></span> | <span data-ttu-id="434ad-247">MSMPI</span><span class="sxs-lookup"><span data-stu-id="434ad-247">MSMPI</span></span> |
| <span data-ttu-id="434ad-248">**Start task enabled** (Включена задача запуска)</span><span class="sxs-lookup"><span data-stu-id="434ad-248">**Start task enabled**</span></span> | <span data-ttu-id="434ad-249">Да</span><span class="sxs-lookup"><span data-stu-id="434ad-249">True</span></span><br><span data-ttu-id="434ad-250">**Командная строка** - `"cmd /c %AZ_BATCH_APP_PACKAGE_MSMPI#8.1%\\MSMpiSetup.exe -unattend -force"`</span><span class="sxs-lookup"><span data-stu-id="434ad-250">**Command line** - `"cmd /c %AZ_BATCH_APP_PACKAGE_MSMPI#8.1%\\MSMpiSetup.exe -unattend -force"`</span></span><br/><span data-ttu-id="434ad-251">**Удостоверение пользователя.** Автоматический пользователь пула, администратор</span><span class="sxs-lookup"><span data-stu-id="434ad-251">**User identity** - Pool autouser, admin</span></span><br/><span data-ttu-id="434ad-252">**Ожидать успешное выполнение.** True</span><span class="sxs-lookup"><span data-stu-id="434ad-252">**Wait for success** - True</span></span>

## <a name="example-nvidia-tesla-drivers-on-nc-vm-pool"></a><span data-ttu-id="434ad-253">Пример: драйверы NVIDIA Tesla в пуле виртуальных машин NC</span><span class="sxs-lookup"><span data-stu-id="434ad-253">Example: NVIDIA Tesla drivers on NC VM pool</span></span>

<span data-ttu-id="434ad-254">toorun CUDA приложений в пуле узлов Linux NC, необходимо tooinstall CUDA Toolkit 8.0 на узлах hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-254">toorun CUDA applications on a pool of Linux NC nodes, you need tooinstall CUDA Toolkit 8.0 on hello nodes.</span></span> <span data-ttu-id="434ad-255">Hello Toolkit устанавливает необходимые драйверы NVIDIA Tesla GPU hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-255">hello Toolkit installs hello necessary NVIDIA Tesla GPU drivers.</span></span> <span data-ttu-id="434ad-256">Вот образец действия toodeploy пользовательского образа Ubuntu 16.04 LTS драйверов GPU hello.</span><span class="sxs-lookup"><span data-stu-id="434ad-256">Here are sample steps toodeploy a custom Ubuntu 16.04 LTS image with hello GPU drivers:</span></span>

1. <span data-ttu-id="434ad-257">Разверните виртуальную машину Azure NC6 под управлением Ubuntu 16.04 LTS.</span><span class="sxs-lookup"><span data-stu-id="434ad-257">Deploy an Azure NC6 VM running Ubuntu 16.04 LTS.</span></span> <span data-ttu-id="434ad-258">Например создайте hello виртуальной Машины в hello нам Южная центральном регионе.</span><span class="sxs-lookup"><span data-stu-id="434ad-258">For example, create hello VM in hello US South Central region.</span></span> <span data-ttu-id="434ad-259">Убедитесь, что создание hello виртуальной Машины, с помощью стандартного хранилища и *без* управляемых дисках.</span><span class="sxs-lookup"><span data-stu-id="434ad-259">Make sure that you create hello VM with standard storage, and *without* managed disks.</span></span>
2. <span data-ttu-id="434ad-260">Выполните toohello tooconnect hello действия виртуальной Машины и [установки драйверов CUDA](../virtual-machines/linux/n-series-driver-setup.md#install-cuda-drivers-for-nc-vms).</span><span class="sxs-lookup"><span data-stu-id="434ad-260">Follow hello steps tooconnect toohello VM and [install CUDA drivers](../virtual-machines/linux/n-series-driver-setup.md#install-cuda-drivers-for-nc-vms).</span></span>
3. <span data-ttu-id="434ad-261">Отзыв агент Linux hello и затем записать образ виртуальной Машины с Linux с помощью команд hello Azure CLI 1.0.</span><span class="sxs-lookup"><span data-stu-id="434ad-261">Deprovision hello Linux agent, and then capture Linux VM image using hello Azure CLI 1.0 commands.</span></span> <span data-ttu-id="434ad-262">Пошаговые инструкции см. в статье [Запись виртуальной машины Linux, работающей в Azure](../virtual-machines/linux/capture-image-nodejs.md).</span><span class="sxs-lookup"><span data-stu-id="434ad-262">For steps, see [Capture a Linux virtual machine running on Azure](../virtual-machines/linux/capture-image-nodejs.md).</span></span> <span data-ttu-id="434ad-263">Запишите образ hello URI.</span><span class="sxs-lookup"><span data-stu-id="434ad-263">Make a note of hello image URI.</span></span>
  > [!IMPORTANT]
  > <span data-ttu-id="434ad-264">Не использовать Azure CLI 2.0 команды toocapture hello изображение для пакета Azure.</span><span class="sxs-lookup"><span data-stu-id="434ad-264">Do not use Azure CLI 2.0 commands toocapture hello image for Azure Batch.</span></span> <span data-ttu-id="434ad-265">В настоящее время команды hello CLI 2.0 записывать только виртуальные машины, созданные с помощью управляемых дисков.</span><span class="sxs-lookup"><span data-stu-id="434ad-265">Currently hello CLI 2.0 commands only capture VMs created using managed disks.</span></span>
  >
4. <span data-ttu-id="434ad-266">Создайте учетную запись пакета, в конфигурации подписки пользователя hello в регионе, который поддерживает виртуальные машины NC.</span><span class="sxs-lookup"><span data-stu-id="434ad-266">Create a Batch account, with hello user subscription configuration, in a region that supports NC VMs.</span></span>
5. <span data-ttu-id="434ad-267">С помощью API-интерфейсы пакета hello или портал Azure, создание пула с помощью пользовательского образа hello и с hello требуемого числа узлов и масштаб.</span><span class="sxs-lookup"><span data-stu-id="434ad-267">Using hello Batch APIs or Azure portal, create a pool using hello custom image and with hello desired number of nodes and scale.</span></span> <span data-ttu-id="434ad-268">Hello следующей таблице показаны параметры пула образец hello образа.</span><span class="sxs-lookup"><span data-stu-id="434ad-268">hello following table shows sample pool settings for hello image:</span></span>

| <span data-ttu-id="434ad-269">Настройка</span><span class="sxs-lookup"><span data-stu-id="434ad-269">Setting</span></span> | <span data-ttu-id="434ad-270">Значение</span><span class="sxs-lookup"><span data-stu-id="434ad-270">Value</span></span> |
| ---- | ---- |
| <span data-ttu-id="434ad-271">**Тип образа**</span><span class="sxs-lookup"><span data-stu-id="434ad-271">**Image Type**</span></span> | <span data-ttu-id="434ad-272">Пользовательский образ</span><span class="sxs-lookup"><span data-stu-id="434ad-272">Custom Image</span></span> |
| <span data-ttu-id="434ad-273">**Пользовательский образ**</span><span class="sxs-lookup"><span data-stu-id="434ad-273">**Custom Image**</span></span> | <span data-ttu-id="434ad-274">URI формы hello изображения`https://yourstorageaccountdisks.blob.core.windows.net/system/Microsoft.Compute/Images/vhds/MyVHDNamePrefix-osDisk.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.vhd`</span><span class="sxs-lookup"><span data-stu-id="434ad-274">Image URI of hello form `https://yourstorageaccountdisks.blob.core.windows.net/system/Microsoft.Compute/Images/vhds/MyVHDNamePrefix-osDisk.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.vhd`</span></span> |
| <span data-ttu-id="434ad-275">**Номер SKU агента узла**</span><span class="sxs-lookup"><span data-stu-id="434ad-275">**Node agent SKU**</span></span> | <span data-ttu-id="434ad-276">batch.node.ubuntu 16.04</span><span class="sxs-lookup"><span data-stu-id="434ad-276">batch.node.ubuntu 16.04</span></span> |
| <span data-ttu-id="434ad-277">**Размер узла**</span><span class="sxs-lookup"><span data-stu-id="434ad-277">**Node size**</span></span> | <span data-ttu-id="434ad-278">NC6 уровня "Стандартный"</span><span class="sxs-lookup"><span data-stu-id="434ad-278">NC6 Standard</span></span> |



## <a name="next-steps"></a><span data-ttu-id="434ad-279">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="434ad-279">Next steps</span></span>

* <span data-ttu-id="434ad-280">задания MPI toorun в пуле пакетной службы Azure см. hello [Windows](batch-mpi.md) или [Linux](https://blogs.technet.microsoft.com/windowshpc/2016/07/20/introducing-mpi-support-for-linux-on-azure-batch/) примеры.</span><span class="sxs-lookup"><span data-stu-id="434ad-280">toorun MPI jobs on an Azure Batch pool, see hello [Windows](batch-mpi.md) or [Linux](https://blogs.technet.microsoft.com/windowshpc/2016/07/20/introducing-mpi-support-for-linux-on-azure-batch/) examples.</span></span>

* <span data-ttu-id="434ad-281">Примеры рабочих нагрузок GPU в пакете см. в разделе hello [Shipyard пакета](https://github.com/Azure/batch-shipyard/) рецептами.</span><span class="sxs-lookup"><span data-stu-id="434ad-281">For examples of GPU workloads on Batch, see hello [Batch Shipyard](https://github.com/Azure/batch-shipyard/) recipes.</span></span>
