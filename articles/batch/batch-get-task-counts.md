---
title: "Ход выполнения задания путем подсчета задачи по состоянию - пакетной службы Azure aaaMonitor | Документы Microsoft"
description: "Отслеживать ход выполнения задания hello путем вызова операции получить количество задач hello toocount задачи для задания. Вы можете подсчитать число активных, выполняющихся, завершенных, успешно и неудачно выполненных задач."
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/02/2017
ms.author: tamram
ms.openlocfilehash: 03957d8a3d678bf44587f3bc7f988a76885c2af0
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="count-tasks-by-state-toomonitor-a-jobs-progress-preview"></a><span data-ttu-id="9a83a-104">Число задач, toomonitor состояние хода выполнения задания (Предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="9a83a-104">Count tasks by state toomonitor a job's progress (Preview)</span></span>

<span data-ttu-id="9a83a-105">Пакет Azure предоставляет эффективный способ toomonitor hello ход выполнения задания во время их выполнения своих задач.</span><span class="sxs-lookup"><span data-stu-id="9a83a-105">Azure Batch provides an efficient way toomonitor hello progress of a job as it runs its tasks.</span></span> <span data-ttu-id="9a83a-106">Вы можете вызвать hello [получить количество задач] [ rest_get_task_counts] toofind операции ожидания количество задач находятся в состоянии active, выполняющегося или завершенного, и сколько — успешно или неудачно.</span><span class="sxs-lookup"><span data-stu-id="9a83a-106">You can call hello [Get Task Counts][rest_get_task_counts] operation toofind out how many tasks are in an active, running, or completed state, and how many have succeeded or failed.</span></span> <span data-ttu-id="9a83a-107">Считая hello число задач в каждом из состояний, можно более просто пользователя tooa ход выполнения задания hello отобразить или обнаружить непредвиденные задержки или ошибки, которые могут повлиять на задания hello.</span><span class="sxs-lookup"><span data-stu-id="9a83a-107">By counting hello number of tasks in each state, you can more easily display hello job's progress tooa user, or detect unexpected delays or failures that may affect hello job.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9a83a-108">Здравствуйте операции получить количество задач в настоящее время находится в предварительной версии и еще не доступен в Azure для государственных, Китай Azure и Azure Германии.</span><span class="sxs-lookup"><span data-stu-id="9a83a-108">hello Get Task Counts operation is currently in preview, and is not yet available in Azure Government, Azure China, and Azure Germany.</span></span> 
>
>

## <a name="how-tasks-are-counted"></a><span data-ttu-id="9a83a-109">Подсчет задач</span><span class="sxs-lookup"><span data-stu-id="9a83a-109">How tasks are counted</span></span>

<span data-ttu-id="9a83a-110">Получить количество задач операции Hello подсчитывает задачи по состоянию, следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9a83a-110">hello Get Task Counts operation counts tasks by state, as follows:</span></span>

- <span data-ttu-id="9a83a-111">Задача считается **active** при это toorun ведения очередей и возможности, но в настоящее время не назначен tooa вычислительных узлов.</span><span class="sxs-lookup"><span data-stu-id="9a83a-111">A task is counted as **active** when it is queued and able toorun, but is not currently assigned tooa compute node.</span></span> <span data-ttu-id="9a83a-112">Задача также считается **активной**, если она зависит от родительской задачи, которая еще не завершена.</span><span class="sxs-lookup"><span data-stu-id="9a83a-112">A task is also counted as **active** if it is dependent on a parent task that has not yet completed.</span></span> <span data-ttu-id="9a83a-113">Дополнительные сведения о зависимости задач см. в разделе [создавать зависимости toorun задачи, которые зависят от других задач](batch-task-dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="9a83a-113">For more information on task dependencies, see [Create task dependencies toorun tasks that depend on other tasks](batch-task-dependencies.md).</span></span> 
- <span data-ttu-id="9a83a-114">Задача считается **под управлением** при он назначен tooa вычислительных узлов, но еще не завершено.</span><span class="sxs-lookup"><span data-stu-id="9a83a-114">A task is counted as **running** when it has been assigned tooa compute node, but has not yet completed.</span></span> <span data-ttu-id="9a83a-115">Задача считается **под управлением** когда он находится в состоянии либо `preparing` или `running`, как указано в hello [получить сведения о задаче] [ rest_get_task] операции.</span><span class="sxs-lookup"><span data-stu-id="9a83a-115">A task is counted as **running** when its state is either `preparing` or `running`, as indicated by hello [Get information about a task][rest_get_task] operation.</span></span>
- <span data-ttu-id="9a83a-116">Задача считается **завершения** когда он больше не toorun право.</span><span class="sxs-lookup"><span data-stu-id="9a83a-116">A task is counted as **completed** when it is no longer eligible toorun.</span></span> <span data-ttu-id="9a83a-117">**Завершенные** задачи обычно завершились успешно или неудачно и исчерпали предел повторных попыток.</span><span class="sxs-lookup"><span data-stu-id="9a83a-117">A task counted as **completed** has typically either finished successfully, or has finished unsuccessfully and has also exhausted its retry limit.</span></span> 

<span data-ttu-id="9a83a-118">Hello получить количество задач операции также сообщает, сколько задач успешно или неудачно.</span><span class="sxs-lookup"><span data-stu-id="9a83a-118">hello Get Task Counts operation also reports how many tasks have succeeded or failed.</span></span> <span data-ttu-id="9a83a-119">Определяет пакет задача успешно ли выполнено, проверив hello **результат** свойство hello [executionInfo] [https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] свойство:</span><span class="sxs-lookup"><span data-stu-id="9a83a-119">Batch determines whether a task has succeeded or failed by checking hello **result** property of hello [executionInfo][https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] property:</span></span>

    - <span data-ttu-id="9a83a-120">Задача считается **успешно** Если hello результат выполнения задачи `success`.</span><span class="sxs-lookup"><span data-stu-id="9a83a-120">A task is counted as **succeeded** if hello result of task execution is `success`.</span></span>
    - <span data-ttu-id="9a83a-121">Задача считается **сбой** Если hello результат выполнения задачи `failure`.</span><span class="sxs-lookup"><span data-stu-id="9a83a-121">A task is counted as **failed** if hello result of task execution is `failure`.</span></span>

<span data-ttu-id="9a83a-122">Дополнительные сведения о состояниях задачи см. в статье [Get information about a task][rest_get_task] (Получение сведений о задаче).</span><span class="sxs-lookup"><span data-stu-id="9a83a-122">For more information about task states, see [Get information about a task][rest_get_task].</span></span>

<span data-ttu-id="9a83a-123">Hello следующий образец кода .NET показано, как количество задач tooretrieve по состояния:</span><span class="sxs-lookup"><span data-stu-id="9a83a-123">hello following .NET code sample shows how tooretrieve task counts by state:</span></span> 

```csharp
var taskCounts = await batchClient.JobOperations.GetTaskCountsAsync("job-1");

Console.WriteLine("Task count in active state: {0}", taskCounts.Active);
Console.WriteLine("Task count in preparing or running state: {0}", taskCounts.Running);
Console.WriteLine("Task count in completed state: {0}", taskCounts.Completed);
Console.WriteLine("Succeeded task count: {0}", taskCounts.Succeeded);
Console.WriteLine("Failed task count: {0}", taskCounts.Failed);
Console.WriteLine("ValidationStatus: {0}", taskCounts.ValidationStatus);
```

> [!NOTE]
> <span data-ttu-id="9a83a-124">Можно использовать аналогичный шаблон для REST и других поддерживаемых языков засчитывается tooget задачи для задания.</span><span class="sxs-lookup"><span data-stu-id="9a83a-124">You can use a similar pattern for REST and other supported languages tooget task counts for a job.</span></span> 
> 
> 

## <a name="consistency-checking-for-task-counts"></a><span data-ttu-id="9a83a-125">Проверка согласованности количества задач</span><span class="sxs-lookup"><span data-stu-id="9a83a-125">Consistency checking for task counts</span></span>

<span data-ttu-id="9a83a-126">Hello пакетная служба собирает счетчики задач путем сбора данных из нескольких частей асинхронной распределенной системе.</span><span class="sxs-lookup"><span data-stu-id="9a83a-126">hello Batch service aggregates task counts by gathering data from multiple parts of an asynchronous distributed system.</span></span> <span data-ttu-id="9a83a-127">tooensure задачей счетчиков, правильно ли указаны пакета обеспечивает дополнительную проверку количество состояний, выполняя проверки согласованности для нескольких компонентов системы hello.</span><span class="sxs-lookup"><span data-stu-id="9a83a-127">tooensure that task counts are correct, Batch provides additional validation for state counts by performing consistency checks against multiple components of hello system.</span></span> <span data-ttu-id="9a83a-128">Пакет выполняет эти проверки согласованности, при условии, что существует не более 200 000 задач в задании hello.</span><span class="sxs-lookup"><span data-stu-id="9a83a-128">Batch performs these consistency checks as long as there are fewer than 200,000 tasks in hello job.</span></span> <span data-ttu-id="9a83a-129">В hello маловероятном случае, проверки согласованности hello находит ошибки пакет исправляет hello результат операции получить количество задач hello, основанных на результатах hello hello проверки согласованности.</span><span class="sxs-lookup"><span data-stu-id="9a83a-129">In hello unlikely event that hello consistency check finds errors, Batch corrects hello result of hello Get Tasks Counts operation based on hello results of hello consistency check.</span></span> <span data-ttu-id="9a83a-130">Hello проверка согласованности является tooensure дополнительные меры, клиенты, получающие hello получить количество задач операции получения hello правильную информацию, необходимую для их решения.</span><span class="sxs-lookup"><span data-stu-id="9a83a-130">hello consistency check is an extra measure tooensure that customers who rely on hello Get Task Counts operation get hello right information they need for their solution.</span></span>

<span data-ttu-id="9a83a-131">Hello **validationStatus** ответа hello указывает ли пакетов производит проверку согласованности hello.</span><span class="sxs-lookup"><span data-stu-id="9a83a-131">hello **validationStatus** property in hello response indicates whether Batch has performed hello consistency check.</span></span> <span data-ttu-id="9a83a-132">Если пакет не был может toocheck состояние вычитается hello фактического состояния, которые содержатся в системе hello, затем hello **validationStatus** задано слишком`unvalidated`.</span><span class="sxs-lookup"><span data-stu-id="9a83a-132">If Batch has not been able toocheck state counts against hello actual states held in hello system, then hello **validationStatus** property is set too`unvalidated`.</span></span> <span data-ttu-id="9a83a-133">Для повышения производительности, пакет не выполнит проверку согласованности hello, если задание hello включает больше, чем 200 000 задачи, поэтому hello **validationStatus** свойство может быть задано слишком`unvalidated` в этом случае.</span><span class="sxs-lookup"><span data-stu-id="9a83a-133">For performance reasons, Batch will not perform hello consistency check if hello job includes more than 200,000 tasks, so hello **validationStatus** property may be set too`unvalidated` in this case.</span></span> <span data-ttu-id="9a83a-134">Однако hello задач неверное количество не обязательно таким образом, как даже в случае потери ограничены данные крайне маловероятно.</span><span class="sxs-lookup"><span data-stu-id="9a83a-134">However, hello task count is not necessarily wrong in this case, as even a very limited data loss is highly unlikely.</span></span> 

<span data-ttu-id="9a83a-135">При изменении состояния задачи hello статистической обработки конвейера обрабатывает hello изменений в течение нескольких секунд.</span><span class="sxs-lookup"><span data-stu-id="9a83a-135">When a task changes state, hello aggregation pipeline processes hello change within few seconds.</span></span> <span data-ttu-id="9a83a-136">Получить количество задач операции Hello отражает hello обновлены счетчики задач в течение указанного периода.</span><span class="sxs-lookup"><span data-stu-id="9a83a-136">hello Get Task Counts operation reflects hello updated task counts within that period.</span></span> <span data-ttu-id="9a83a-137">Однако если hello статистической обработки конвейера промахов изменения состояния задачи, затем изменение не будет зарегистрировать до следующей проверки проверки hello.</span><span class="sxs-lookup"><span data-stu-id="9a83a-137">However, if hello aggregation pipeline misses a change in a task state, then that change is not registered until hello next validation pass.</span></span> <span data-ttu-id="9a83a-138">В течение этого времени количество задач может быть немного неточно, из-за пропущенных событий toohello, но они будут исправлены на следующий этап проверки hello.</span><span class="sxs-lookup"><span data-stu-id="9a83a-138">During this time, task counts may be slightly inaccurate due toohello missed event, but they are corrected on hello next validation pass.</span></span>

## <a name="best-practices-for-counting-a-jobs-tasks"></a><span data-ttu-id="9a83a-139">Рекомендации по подсчету задач задания</span><span class="sxs-lookup"><span data-stu-id="9a83a-139">Best practices for counting a job's tasks</span></span>

<span data-ttu-id="9a83a-140">Вызов операции получить количество задач hello — hello наиболее эффективный способ tooreturn basic количество рабочих заданий по состоянию.</span><span class="sxs-lookup"><span data-stu-id="9a83a-140">Calling hello Get Task Counts operation is hello most efficient way tooreturn a basic count of a job's tasks by state.</span></span> <span data-ttu-id="9a83a-141">При использовании версии пакета обновления 2017 г-06-01.5.1 рекомендуется записью или обновлением toouse ваш код, получить количество задач.</span><span class="sxs-lookup"><span data-stu-id="9a83a-141">If you are using Batch service version 2017-06-01.5.1, we recommend writing or updating your code toouse Get Task Counts.</span></span>

<span data-ttu-id="9a83a-142">Hello получить количество задач операция недоступна в версии пакета обновления более ранней, чем 2017 г-06-01.5.1.</span><span class="sxs-lookup"><span data-stu-id="9a83a-142">hello Get Task Counts operation is not available in Batch service versions earlier than 2017-06-01.5.1.</span></span> <span data-ttu-id="9a83a-143">Если вы используете старую версию службы hello, затем используйте задачи toocount список запросов в задании.</span><span class="sxs-lookup"><span data-stu-id="9a83a-143">If you are using an older version of hello service, then use a list query toocount tasks in a job instead.</span></span> <span data-ttu-id="9a83a-144">Дополнительные сведения см. в разделе [эффективно создавать запросы ресурсы пакета toolist](batch-efficient-list-queries.md).</span><span class="sxs-lookup"><span data-stu-id="9a83a-144">For more information, see [Create queries toolist Batch resources efficiently](batch-efficient-list-queries.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="9a83a-145">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="9a83a-145">Next steps</span></span>

* <span data-ttu-id="9a83a-146">В разделе hello [Обзор возможностей пакетной](batch-api-basics.md) toolearn Дополнительные сведения о пакете основные понятия службы и компоненты.</span><span class="sxs-lookup"><span data-stu-id="9a83a-146">See hello [Batch feature overview](batch-api-basics.md) toolearn more about Batch service concepts and features.</span></span> <span data-ttu-id="9a83a-147">Hello статье обсуждаются hello основными ресурсами пакета пулов, вычислительные узлы, заданий и задач и общие сведения о функции hello службы.</span><span class="sxs-lookup"><span data-stu-id="9a83a-147">hello article discusses hello primary Batch resources such as pools, compute nodes, jobs, and tasks, and provides an overview of hello service's features.</span></span>
* <span data-ttu-id="9a83a-148">Основы hello разработки приложений с поддержкой пакета, используя hello [клиентская библиотека .NET пакета](batch-dotnet-get-started.md) или [Python](batch-python-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="9a83a-148">Learn hello basics of developing a Batch-enabled application using hello [Batch .NET client library](batch-dotnet-get-started.md) or [Python](batch-python-tutorial.md).</span></span> <span data-ttu-id="9a83a-149">Эти статьи вводные инструкциям рабочее приложение, которое использует службы tooexecute hello пакета рабочей нагрузки на нескольких вычислительных узлах.</span><span class="sxs-lookup"><span data-stu-id="9a83a-149">These introductory articles guide you through a working application that uses hello Batch service tooexecute a workload on multiple compute nodes.</span></span>


[rest_get_task_counts]: https://docs.microsoft.com/rest/api/batchservice/get-the-task-counts-for-a-job
[rest_get_task]: https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task
[rest_list_tasks]: https://docs.microsoft.com/rest/api/batchservice/list-the-tasks-associated-with-a-job
