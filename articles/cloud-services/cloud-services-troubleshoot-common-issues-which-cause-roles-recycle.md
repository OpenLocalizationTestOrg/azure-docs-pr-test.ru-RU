---
title: "aaaCommon вызывает повторное использование ролей облачной службы | Документы Microsoft"
description: "Внезапный перезапуск роли облачной службы может привести к длительному простою. Ниже приведены некоторые распространенные проблемы, вызывающие toobe ролей перезапуска, которая может помочь сократить время простоя."
services: cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 533930d1-8035-4402-b16a-cf887b2c4f85
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: tbd
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: 8fa152b33d2b22a8a02f834d4bc38519b4272f7b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="common-issues-that-cause-roles-toorecycle"></a><span data-ttu-id="c9e5e-104">Общие ошибки, вызывающие toorecycle ролей</span><span class="sxs-lookup"><span data-stu-id="c9e5e-104">Common issues that cause roles toorecycle</span></span>
<span data-ttu-id="c9e5e-105">В этой статье рассматриваются некоторые основные причины проблем с развертыванием hello и предоставляет разрешение советы toohelp устранения этих проблем.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-105">This article discusses some of hello common causes of deployment problems and provides troubleshooting tips toohelp you resolve these problems.</span></span> <span data-ttu-id="c9e5e-106">Указывает на то, что возникла проблема с приложением при toostart сбоя экземпляра роли hello или циклически переключается между состояниями инициализации, занятости и остановки hello.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-106">An indication that a problem exists with an application is when hello role instance fails toostart, or it cycles between hello initializing, busy, and stopping states.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

## <a name="missing-runtime-dependencies"></a><span data-ttu-id="c9e5e-107">Отсутствующие зависимости среды выполнения</span><span class="sxs-lookup"><span data-stu-id="c9e5e-107">Missing runtime dependencies</span></span>
<span data-ttu-id="c9e5e-108">Если роль приложения использует любую сборку, не является частью hello .NET Framework или hello Azure управляемой библиотеке, необходимо явно включить эту сборку в пакет приложения hello.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-108">If a role in your application relies on any assembly that is not part of hello .NET Framework or hello Azure managed library, you must explicitly include that assembly in hello application package.</span></span> <span data-ttu-id="c9e5e-109">Имейте в виду, что другие платформы Майкрософт недоступны в Azure по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-109">Keep in mind that other Microsoft frameworks are not available on Azure by default.</span></span> <span data-ttu-id="c9e5e-110">Если ваша роль использует такую платформу, необходимо добавить эти сборки toohello приложения.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-110">If your role relies on such a framework, you must add those assemblies toohello application package.</span></span>

<span data-ttu-id="c9e5e-111">Перед выполнением сборки и пакет приложения, проверьте следующие hello.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-111">Before you build and package your application, verify hello following:</span></span>

* <span data-ttu-id="c9e5e-112">Если с помощью Visual studio, убедитесь, что hello **Копировать локально** задано слишком**True** для каждой связанной сборки в проекте, который не является частью hello Azure SDK или hello .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-112">If using Visual studio, make sure hello **Copy Local** property is set too**True** for each referenced assembly in your project that is not part of hello Azure SDK or hello .NET Framework.</span></span>
* <span data-ttu-id="c9e5e-113">Убедитесь, что файл web.config hello не ссылается на все неиспользуемые сборки из элемент compilation hello.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-113">Make sure hello web.config file does not reference any unused assemblies in hello compilation element.</span></span>
* <span data-ttu-id="c9e5e-114">Hello **действие при построении** каждого cshtml файла задано слишком**содержимого**.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-114">hello **Build Action** of every .cshtml file is set too**Content**.</span></span> <span data-ttu-id="c9e5e-115">Это гарантирует, что файлы hello правильно отображались hello пакета и позволяет tooappear других файлов в пакете hello.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-115">This ensures that hello files will appear correctly in hello package and enables other referenced files tooappear in hello package.</span></span>

## <a name="assembly-targets-wrong-platform"></a><span data-ttu-id="c9e5e-116">Сборка нацелена на неверную платформу.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-116">Assembly targets wrong platform</span></span>
<span data-ttu-id="c9e5e-117">Azure является 64-разрядной средой.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-117">Azure is a 64-bit environment.</span></span> <span data-ttu-id="c9e5e-118">Таким образом, сборки .NET, скомпилированные для 32-разрядной среды, не будут работать в Azure.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-118">Therefore, .NET assemblies compiled for a 32-bit target won't work on Azure.</span></span>

## <a name="role-throws-unhandled-exceptions-while-initializing-or-stopping"></a><span data-ttu-id="c9e5e-119">Роль вызывает необработанные исключения во время инициализации или остановки.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-119">Role throws unhandled exceptions while initializing or stopping</span></span>
<span data-ttu-id="c9e5e-120">Любые исключения, вызванные методами "hello" hello [RoleEntryPoint] класса, содержащего hello [OnStart], [OnStop], и [запуска]метода, являются необработанными исключениями.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-120">Any exceptions that are thrown by hello methods of hello [RoleEntryPoint] class, which includes hello [OnStart], [OnStop], and [Run] methods, are unhandled exceptions.</span></span> <span data-ttu-id="c9e5e-121">Если обнаруживается необработанное исключение в одном из этих методов, hello роль будет перезапущена.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-121">If an unhandled exception occurs in one of these methods, hello role will recycle.</span></span> <span data-ttu-id="c9e5e-122">Если hello роль постоянно перезапускается, может вызывает необработанное исключение каждый раз, он пробует toostart.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-122">If hello role is recycling repeatedly, it may be throwing an unhandled exception each time it tries toostart.</span></span>

## <a name="role-returns-from-run-method"></a><span data-ttu-id="c9e5e-123">Роль возвращается из метода Run.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-123">Role returns from Run method</span></span>
<span data-ttu-id="c9e5e-124">Hello [запуска] метод является предполагаемым toorun бесконечно.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-124">hello [Run] method is intended toorun indefinitely.</span></span> <span data-ttu-id="c9e5e-125">Если код переопределяет hello [запуска] метод, он должен перейти в режим бесконечно.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-125">If your code overrides hello [Run] method, it should sleep indefinitely.</span></span> <span data-ttu-id="c9e5e-126">Если hello [запуска] метод возвращает hello роль перезапускается.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-126">If hello [Run] method returns, hello role recycles.</span></span>

## <a name="incorrect-diagnosticsconnectionstring-setting"></a><span data-ttu-id="c9e5e-127">Неверный параметр DiagnosticsConnectionString</span><span class="sxs-lookup"><span data-stu-id="c9e5e-127">Incorrect DiagnosticsConnectionString setting</span></span>
<span data-ttu-id="c9e5e-128">Если приложение использует диагностику Azure, в файле конфигурации службы необходимо указать hello `DiagnosticsConnectionString` параметр конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-128">If application uses Azure Diagnostics, your service configuration file must specify hello `DiagnosticsConnectionString` configuration setting.</span></span> <span data-ttu-id="c9e5e-129">Этот параметр следует указать учетную запись хранилища tooyour соединения HTTPS в Azure.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-129">This setting should specify an HTTPS connection tooyour storage account in Azure.</span></span>

<span data-ttu-id="c9e5e-130">tooensure, ваш `DiagnosticsConnectionString` значение является правильным, перед развертыванием пакета вашего приложения tooAzure, проверьте следующие hello:</span><span class="sxs-lookup"><span data-stu-id="c9e5e-130">tooensure that your `DiagnosticsConnectionString` setting is correct before you deploy your application package tooAzure, verify hello following:</span></span>  

* <span data-ttu-id="c9e5e-131">Hello `DiagnosticsConnectionString` задания точек tooa действительную учетную запись хранилища в Azure.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-131">hello `DiagnosticsConnectionString` setting points tooa valid storage account in Azure.</span></span>  
  <span data-ttu-id="c9e5e-132">По умолчанию этот параметр указывает toohello эмулированной учетной записи хранилища, поэтому его необходимо явно изменить этот параметр, перед развертыванием пакета приложения.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-132">By default, this setting points toohello emulated storage account, so you must explicitly change this setting before you deploy your application package.</span></span> <span data-ttu-id="c9e5e-133">Если этот параметр не изменяются, когда экземпляр роли hello пытается монитор диагностики hello toostart создается исключение.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-133">If you do not change this setting, an exception is thrown when hello role instance attempts toostart hello diagnostic monitor.</span></span> <span data-ttu-id="c9e5e-134">Это может привести к toorecycle экземпляр роли hello бесконечно.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-134">This may cause hello role instance toorecycle indefinitely.</span></span>
* <span data-ttu-id="c9e5e-135">Hello указана строка подключения в hello ниже [формат](../storage/common/storage-configure-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="c9e5e-135">hello connection string is specified in hello following [format](../storage/common/storage-configure-connection-string.md).</span></span> <span data-ttu-id="c9e5e-136">(hello необходимо указать протокол как HTTPS.) Замените *MyAccountName* с именем hello вашей учетной записи хранилища и *MyAccountKey* с помощью ключа доступа:</span><span class="sxs-lookup"><span data-stu-id="c9e5e-136">(hello protocol must be specified as HTTPS.) Replace *MyAccountName* with hello name of your storage account, and *MyAccountKey* with your access key:</span></span>    

        DefaultEndpointsProtocol=https;AccountName=MyAccountName;AccountKey=MyAccountKey

  <span data-ttu-id="c9e5e-137">При разработке приложения с помощью средств Azure для Microsoft Visual Studio, можно использовать tooset страниц свойств hello, это значение.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-137">If you are developing your application by using Azure Tools for Microsoft Visual Studio, you can use hello property pages tooset this value.</span></span>

## <a name="exported-certificate-does-not-include-private-key"></a><span data-ttu-id="c9e5e-138">Экспортированный сертификат не содержит закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-138">Exported certificate does not include private key</span></span>
<span data-ttu-id="c9e5e-139">toorun SSL веб-роли, необходимо убедиться, ваш экспортированный сертификат управления включает hello закрытый ключ.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-139">toorun a web role under SSL, you must ensure that your exported management certificate includes hello private key.</span></span> <span data-ttu-id="c9e5e-140">При использовании hello *диспетчера сертификатов Windows* tooexport hello сертификата, быть убедиться, что tooselect **Да** для hello **экспорта hello закрытый ключ** параметр.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-140">If you use hello *Windows Certificate Manager* tooexport hello certificate, be sure tooselect **Yes** for hello **Export hello private key** option.</span></span> <span data-ttu-id="c9e5e-141">Hello сертификат необходимо экспортировать в формате PFX hello, который в настоящее время поддерживается только формат hello.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-141">hello certificate must be exported in hello PFX format, which is hello only format currently supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c9e5e-142">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c9e5e-142">Next steps</span></span>
<span data-ttu-id="c9e5e-143">Просмотрите дополнительные [статьи об устранении неполадок](https://azure.microsoft.com/documentation/articles/?tag=top-support-issue&product=cloud-services) в облачных службах.</span><span class="sxs-lookup"><span data-stu-id="c9e5e-143">View more [troubleshooting articles](https://azure.microsoft.com/documentation/articles/?tag=top-support-issue&product=cloud-services) for cloud services.</span></span>

<span data-ttu-id="c9e5e-144">Дополнительные сценарии перезапуска ролей см. в [серии статей в блоге Кевина Уильямсона](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span><span class="sxs-lookup"><span data-stu-id="c9e5e-144">View more role recycling scenarios at [Kevin Williamson's blog series](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span></span>

[RoleEntryPoint]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx
[OnStart]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx
[OnStop]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx
[запуска]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx
