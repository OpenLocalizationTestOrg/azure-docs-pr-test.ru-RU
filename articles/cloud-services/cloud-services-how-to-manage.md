---
title: "Общие задачи управления облачными службами (классические) | Документация Майкрософт"
description: "Узнайте, как управлять облачными службами на классическом портале Azure."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: 41a30e50-067c-485b-96fd-434a6d057abc
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/18/2017
ms.author: adegeo
ms.openlocfilehash: 2ee76dfcb579e53975b1f61a6590f8d78dc0961b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-manage-cloud-services"></a>Управление облачными службами
> [!div class="op_single_selector"]
> * [Портал Azure](cloud-services-how-to-manage-portal.md)
> * [Классический портал Azure](cloud-services-how-to-manage.md)
>
>

В области **Облачные службы** классического портала Azure можно обновить роль службы или развертывание, перенести промежуточное развертывание в рабочую среду, привязать ресурсы к облачной службе для просмотра их зависимостей и масштабирования, а также удалить облачную службу или развертывание.

## <a name="how-to-update-a-cloud-service-role-or-deployment"></a>Практическое руководство. Обновление роли облачной службы или развертывания
Чтобы обновить код приложения для облачной службы, используйте команду **Обновить** на странице**Облачные службы** или **Экземпляры** панели мониторинга. Одновременно можно обновить как одну, так и все роли. При этом также потребуется загрузить новые файлы пакета и конфигурации службы.

1. Войдите на [классический портал Azure](https://manage.windowsazure.com/), откройте панель мониторинга, перейдите на страницу **Облачные службы** или **Экземпляры** и щелкните **Обновить**.

    ![Обновление развертывания](./media/cloud-services-how-to-manage/CloudServices_UpdateDeployment.png)

2. В поле **Метка развернутого приложения**введите имя развертывания, например mycloudservicev2. Заданная метка появится в разделе **Быстрый запуск** на панели мониторинга.
3. В поле **Пакет** щелкните **Обзор** и отправьте файл пакета службы (CSPKG-файл).
4. В поле **Конфигурация** щелкните **Обзор** и отправьте файл конфигурации службы (CSPKG-файл).
5. В поле **Роль** выберите **Все**, если требуется обновить все роли облачной службы. Чтобы обновить только одну конкретную роль, выберите ее. Даже если выбрана конкретная роль, обновления в файле конфигурации службы применяются ко всем ролям.
6. Если в процессе обновления произошло изменение числа или размера ролей, установите флажок **Разрешить обновление при изменении размера или числа ролей** , чтобы выполнить обновление.

    Обратите внимание, что при изменении размера роли (то есть размера виртуальной машины, на которой размещается экземпляр) или числа ролей необходимо повторно установить образ для каждого экземпляра роли (виртуальная машина), в результате чего утрачиваются все локальные данные.

7. Если в облачной службе будут содержаться роли с одним экземпляром, установите флажок **Обновить, даже если одна или несколько ролей содержат один экземпляр** , чтобы обеспечить обновление.

    Служба Azure гарантирует доступность облачной службы в течение 99,95 % времени, только если для каждой роли определены как минимум два экземпляра (виртуальные машины). Такая конфигурация позволяет обрабатывать запросы клиентов на одной виртуальной машине во время обновления другой.

8. Нажмите кнопку **OK** (флажок), чтобы начать обновление службы.

## <a name="how-to-swap-deployments-to-promote-a-staged-deployment-to-production"></a>Практическое руководство. Переключение из промежуточного в рабочее развертывание
Чтобы перенести развертывание облачной службы из промежуточной в рабочую среду, воспользуйтесь командой **Переключить** . Если вы решили развернуть новый выпуск облачной службы, вы можете протестировать его в промежуточном развертывании, а ваши клиенты будут и дальше использовать текущий рабочий выпуск. Когда вы будете готовы к развертыванию нового выпуска в рабочей среде, используйте команду **Переключить** для переключения URL-адресов двух развертываний.

Соответствующая команда представлена на странице **Облачные службы** или на панели мониторинга.

1. На [классическом портале Azure](https://manage.windowsazure.com/)щелкните **Облачные службы**.
2. Выберите нужную облачную службу в списке.
3. Щелкните **Переключить**.

    Откроется следующий запрос подтверждения.

    ![Переключение облачных служб](./media/cloud-services-how-to-manage/CloudServices_Swap.png)

4. Проверьте данные развертывания и нажмите кнопку **Да** , чтобы завершить этот процесс.

    Переключение осуществляется мгновенно, поскольку при этом изменяются только виртуальные IP-адреса развертываний.

    Для экономии вычислительных ресурсов вы можете удалить промежуточную среду после того, как убедитесь в соответствии рабочего развертывания заданным характеристикам.

### <a name="common-questions-about-swapping-deployments"></a>Часто задаваемые вопросы о переключении развертываний

**Каковы предварительные требования для переключения развертываний?**

Существует два ключевых требования для успешного переключения развертываний.

- Если вы хотите использовать статический IP-адрес для вашего рабочего слота, необходимо также зарезервировать такой адрес для промежуточного слота. В противном случае переключение завершится ошибкой.

- Все экземпляры роли должны быть запущены перед выполнением переключения. Вы можете проверить состояние экземпляров на классическом портале Azure или с помощью [команды Get-AzureRole в Windows PowerShell](/powershell/module/azure/get-azurerole?view=azuresmps-3.7.0).

Обратите внимание, что обновления гостевой ОС и операции восстановления службы также могут быть причиной сбоя переключения развертывания. Дополнительные сведения см. в статье [Устранение неполадок, которые могут возникнуть при развертывании облачной службы](cloud-services-troubleshoot-deployment-problems.md).

**Увеличивают ли переключения время простоя приложения? Что делать в этом случае?**

Как описано в предыдущем разделе, переключение развертывания обычно происходит очень быстро, так как это просто изменение конфигурации в Azure Load Balancer. В некоторых случаях, однако, это может занять около десяти секунд и привести к временному сбою подключения. Чтобы ограничить воздействие на клиентов, рассмотрите возможность реализации [логики повтора для клиента](../best-practices-retry-general.md).

## <a name="how-to-link-a-resource-to-a-cloud-service"></a>Практическое руководство. Привязка ресурсов к облачной службе
Чтобы показать зависимости облачной службы от других ресурсов, вы можете привязать экземпляр базы данных SQL или учетную запись хранения Azure к облачной службе. Вы можете привязывать и отменять привязку ресурсов на странице **Связанные ресурсы** , а затем отслеживать их использование на панели мониторинга облачной службы. Если для связанной учетной записи хранения включен мониторинг, вы можете отслеживать общее число запросов на панели мониторинга облачной службы.

Чтобы связать новые или имеющиеся экземпляры базы данных SQL и учетные записи хранения с облачной службой, используйте команду **Связать**. После этого вы сможете масштабировать базу данных со связанной ролью облачной службы на странице **Масштабирование**. В этом случае учетные записи хранения масштабируются автоматически по мере увеличения объемов использования. Дополнительные сведения см. в статье [Автомасштабирование облачной службы](cloud-services-how-to-scale.md).

Вы также можете отслеживать, масштабировать базу данных и управлять ею в области **Базы данных** классического портала Azure.

"Привязка" ресурса не подключает ваше приложение к ресурсу. При создании новой базы данных с помощью команды **Связать**необходимо добавить в код приложения строки подключения и обновить облачную службу. Кроме того, строки подключения необходимо добавить, если в приложении используются ресурсы связанной учетной записи хранения.

Далее описывается процедура связывания с облачной службой нового экземпляра базы данных SQL, развернутого на новом сервере базы данных SQL.

### <a name="to-link-a-sql-database-instance-to-a-cloud-service"></a>Привязка экземпляра базы данных SQL к облачной службе
1. На [классическом портале Azure](http://manage.windowsazure.com/)щелкните **Облачные службы**. Щелкните имя облачной службы, чтобы открыть панель мониторинга.
2. Щелкните **Связанные ресурсы**.

    Откроется страница **Связанные ресурсы** .

    ![Страница «Связанные ресурсы»](./media/cloud-services-how-to-manage/CloudServices_LinkedResourcesPage.png)

3. Щелкните **Привязать ресурс** или **Связать**.

    Откроется мастер **привязки ресурсов** .

    ![Мастер привязки ресурсов, страница 1](./media/cloud-services-how-to-manage/CloudServices_LinkedResources_LinkPage1.png)

4. Щелкните **Создать новый ресурс** или **Привязать существующий ресурс**.
5. Выберите тип связываемого ресурса. На [классическом портале Azure](http://manage.windowsazure.com/) щелкните **База данных SQL**. (Привязать учетную запись хранения к облачной службе можно только на классическом портале Azure.)
6. Выполните настройку базы данных в соответствии с инструкциями в справке для области **Базы данных SQL** классического портала Azure.

    Состояние операции связывания можно контролировать с помощью области сообщений.

    По завершении этого процесса вы можете проконтролировать состояние связанных ресурсов на панели мониторинга облачной службы. Дополнительные сведения о масштабировании связанной базы данных SQL см. в статье [Автомасштабирование облачной службы](cloud-services-how-to-scale.md).

### <a name="to-unlink-a-linked-resource"></a>Отмена привязки ресурсов
1. На [классическом портале Azure](http://manage.windowsazure.com/)щелкните **Облачные службы**. Щелкните имя облачной службы, чтобы открыть панель мониторинга.
2. Щелкните **Связанные ресурсы**и выберите ресурс.
3. Щелкните **Отменить привязку**. Нажмите кнопку **Да** в запросе подтверждения.

    Отмена привязки базы данных SQL не влияет на саму базу или подключения приложений к ней. После этого вы по-прежнему сможете управлять базой данных в области **Базы данных SQL** классического портала Azure.

## <a name="how-to-delete-deployments-and-a-cloud-service"></a>Практическое руководство. Удаление развертываний и облачной службы
До удаления облачной службы необходимо удалить все текущие развертывания.

Для экономии вычислительных ресурсов вы можете удалить промежуточную среду после того, как убедитесь в соответствии рабочего развертывания заданным характеристикам. Обратите внимание, что плата за вычислительные ресурсы для экземпляра роли взимается даже в том случае, если облачная служба не выполняется.

Чтобы удалить развертывание или облачную службу, выполните следующие действия.

1. На [классическом портале Azure](http://manage.windowsazure.com/)щелкните **Облачные службы**.
2. Выберите облачную службу и нажмите кнопку **Удалить**. Чтобы выбрать службу, не открывая панель управления, щелкните в любом месте вне поля с ее именем.

    При наличии промежуточного или рабочего развертывания в нижней части окна появится меню следующего вида. До удаления облачной службы необходимо удалить все текущие развертывания.

    ![Меню удаления](./media/cloud-services-how-to-manage/CloudServices_DeleteMenu.png)

3. Чтобы удалить развертывание, щелкните **Delete production deployment** (Удалить рабочее развертывание) или **Delete staging deployment** (Удалить промежуточное развертывание). Нажмите кнопку **Да**в запросе подтверждения.
4. Если планируется удаление облачной службы, повторите шаг 3, чтобы удалить оставшиеся развертывания.
5. Чтобы удалить службу, щелкните **Удалить облачную службу**. Нажмите кнопку **Да**в запросе подтверждения.

> [!NOTE]
> Если для удаляемой облачной службы был настроен подробный мониторинг, платформа Azure не удаляет данные мониторинга из учетной записи хранения. В этом случае требуется удалить такие данные вручную. Подробнее о расположении таблицы метрик см. в разделе "Практическое руководство. Доступ к данным подробного мониторинга вне классического портала Azure" статьи [Мониторинг облачных служб](cloud-services-how-to-monitor.md).
>
>

## <a name="next-steps"></a>Дальнейшие действия
* [Общая настройка облачной службы](cloud-services-how-to-configure.md).
* Узнайте, как [развернуть облачную службу](cloud-services-how-to-create-deploy.md).
* Настройте [пользовательское доменное имя](cloud-services-custom-domain-name.md).
* Настройка [SSL-сертификатов](cloud-services-configure-ssl-certificate.md).
