---
title: "Устранение неполадок, которые могут возникнуть при развертывании облачной службы | Документация Майкрософт"
description: "Во время развертывания облачной службы в Azure вы можете столкнуться с несколькими типичными проблемами. В этой статье приведены решения некоторых из них."
services: cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: a18ae415-0d1c-4bc4-ab6c-c1ddea02c870
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: tbd
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: 60e06ba292ff1e43d00cd69c1a422f9237d5e5a4
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="troubleshoot-cloud-service-deployment-problems"></a><span data-ttu-id="d6ccd-104">Устранение неполадок, которые могут возникнуть при развертывании облачной службы</span><span class="sxs-lookup"><span data-stu-id="d6ccd-104">Troubleshoot cloud service deployment problems</span></span>
<span data-ttu-id="d6ccd-105">При развертывании пакета приложения облачной службы в Azure сведения о развертывании можно получить на панели **Свойства** портала Azure.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-105">When you deploy a cloud service application package to Azure, you can obtain information about the deployment from the **Properties** pane in the Azure portal.</span></span> <span data-ttu-id="d6ccd-106">Сведения, отображающиеся на этой панели, можно использовать для устранения неполадок в работе облачной службы. Кроме того, вы можете передать эту информацию в службу поддержки Azure при открытии нового запроса на поддержку.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-106">You can use the details in this pane to help you troubleshoot problems with the cloud service, and you can provide this information to Azure Support when opening a new support request.</span></span>

<span data-ttu-id="d6ccd-107">Панель **Свойства** можно найти следующим образом.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-107">You can find the **Properties** pane as follows:</span></span>

* <span data-ttu-id="d6ccd-108">На портале Azure щелкните развертывание нужной облачной службы, выберите **Все параметры**, а затем нажмите кнопку **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-108">In the Azure portal, click the deployment of your cloud service, click **All settings**, and then click **Properties**.</span></span>
* <span data-ttu-id="d6ccd-109">На классическом портале Azure щелкните развертывание нужной облачной службы и выберите **Панель мониторинга** в правом нижнем углу страницы (в разделе **сводки**).</span><span class="sxs-lookup"><span data-stu-id="d6ccd-109">In the Azure classic portal, click the deployment of your cloud service, click **DASHBOARD**, located at the lower-right corner of the page (under **quick glance**).</span></span> <span data-ttu-id="d6ccd-110">Имейте в виду, что на этой панели отсутствует метка "Свойства".</span><span class="sxs-lookup"><span data-stu-id="d6ccd-110">Be aware that there's no "Properties" label on this pane.</span></span>

> [!NOTE]
> <span data-ttu-id="d6ccd-111">Содержимое панели **Свойства** можно скопировать в буфер обмена, щелкнув значок в правом верхнем углу панели.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-111">You can copy the contents of the **Properties** pane to the clipboard by clicking the icon in the upper-right corner of the pane.</span></span>
>
>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

## <a name="problem-i-cannot-access-my-website-but-my-deployment-is-started-and-all-role-instances-are-ready"></a><span data-ttu-id="d6ccd-112">Проблема: у меня нет доступа к моему веб-сайту, но мое развертывание запущено и все экземпляры роли готовы</span><span class="sxs-lookup"><span data-stu-id="d6ccd-112">Problem: I cannot access my website, but my deployment is started and all role instances are ready</span></span>
<span data-ttu-id="d6ccd-113">URL-адрес веб-сайта, отображаемый на портале, не включает в себя порт.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-113">The website URL link shown in the portal does not include the port.</span></span> <span data-ttu-id="d6ccd-114">По умолчанию для веб-сайтов используется порт 80.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-114">The default port for websites is 80.</span></span> <span data-ttu-id="d6ccd-115">Если в приложении настроено использование другого порта, то при открытии веб-сайта в URL-адрес нужно добавить номер нужного порта.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-115">If your application is configured to run in a different port, you must add the correct port number to the URL when accessing the website.</span></span>

1. <span data-ttu-id="d6ccd-116">На портале Azure щелкните развертывание нужной облачной службы.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-116">In the Azure portal, click the deployment of your cloud service.</span></span>
2. <span data-ttu-id="d6ccd-117">На панели **Свойства** портала Azure проверьте порты на наличие экземпляров ролей (в разделе **Входные конечные точки**).</span><span class="sxs-lookup"><span data-stu-id="d6ccd-117">In the **Properties** pane of the Azure portal, check the ports for the role instances (under **Input Endpoints**).</span></span>
3. <span data-ttu-id="d6ccd-118">Если номер порта — не 80, добавьте правильное значение порта в URL-адрес при доступе к приложению.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-118">If the port is not 80, add the correct port value to the URL when you access the application.</span></span> <span data-ttu-id="d6ccd-119">Чтобы указать нестандартный порт, введите URL-адрес, после него поставьте двоеточие (:), а затем укажите номер порта без пробелов.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-119">To specify a non-default port, type the URL, followed by a colon (:), followed by the port number, with no spaces.</span></span>

## <a name="problem-my-role-instances-recycled-without-me-doing-anything"></a><span data-ttu-id="d6ccd-120">Проблема: мои экземпляры ролей перезапускаются автоматически</span><span class="sxs-lookup"><span data-stu-id="d6ccd-120">Problem: My role instances recycled without me doing anything</span></span>
<span data-ttu-id="d6ccd-121">Восстановление службы происходит автоматически, когда Azure обнаруживает проблемные узлы и, следовательно, перемещает экземпляры ролей в новые узлы.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-121">Service healing occurs automatically when Azure detects problem nodes and therefore moves role instances to new nodes.</span></span> <span data-ttu-id="d6ccd-122">В этом случае экземпляры ролей могут перезапускаться автоматически.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-122">When this occurs, you might see your role instances recycling automatically.</span></span> <span data-ttu-id="d6ccd-123">Чтобы определить, произошло ли восстановление службы, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-123">To find out if service healing occurred:</span></span>

1. <span data-ttu-id="d6ccd-124">На портале Azure щелкните развертывание нужной облачной службы.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-124">In the Azure portal, click the deployment of your cloud service.</span></span>
2. <span data-ttu-id="d6ccd-125">На панели **Свойства** портала Azure ознакомьтесь со сведениями и определите, восстанавливалась ли служба во время перезапуска ролей.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-125">In the **Properties** pane of the Azure portal, review the information and determine whether service healing occurred during the time that you observed the roles recycling.</span></span>

<span data-ttu-id="d6ccd-126">Кроме того, роли перезапускаются примерно раз в месяц, когда обновляются ОС узла и гостевая ОС.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-126">Roles will also recycle roughly once per month during host-OS and guest-OS updates.</span></span>  
<span data-ttu-id="d6ccd-127">Дополнительные сведения см. в записи блога [Role Instance Restarts Due to OS Upgrades](http://blogs.msdn.com/b/kwill/archive/2012/09/19/role-instance-restarts-due-to-os-upgrades.aspx) (Перезапуск экземпляра роли из-за обновлений ОС).</span><span class="sxs-lookup"><span data-stu-id="d6ccd-127">For more information, see the blog post [Role Instance Restarts Due to OS Upgrades](http://blogs.msdn.com/b/kwill/archive/2012/09/19/role-instance-restarts-due-to-os-upgrades.aspx)</span></span>

## <a name="problem-i-cannot-do-a-vip-swap-and-receive-an-error"></a><span data-ttu-id="d6ccd-128">Проблема: когда я пробую переключить виртуальный IP-адрес, отображается сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="d6ccd-128">Problem: I cannot do a VIP swap and receive an error</span></span>
<span data-ttu-id="d6ccd-129">Переключение виртуального IP-адреса не допускается, если развертывание обновляется.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-129">A VIP swap is not allowed if a deployment update is in progress.</span></span> <span data-ttu-id="d6ccd-130">Развертывание обновляется автоматически в таких случаях:</span><span class="sxs-lookup"><span data-stu-id="d6ccd-130">Deployment updates can occur automatically when:</span></span>

* <span data-ttu-id="d6ccd-131">доступна новая операционная система на виртуальной машине и на вашем устройстве настроено автоматическое обновление;</span><span class="sxs-lookup"><span data-stu-id="d6ccd-131">A new guest operating system is available and you are configured for automatic updates.</span></span>
* <span data-ttu-id="d6ccd-132">выполняется восстановление службы.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-132">Service healing occurs.</span></span>

<span data-ttu-id="d6ccd-133">Чтобы узнать, препятствует ли автоматическое обновление переключению виртуального IP-адреса, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="d6ccd-133">To find out if an automatic update is preventing you from doing a VIP swap:</span></span>

1. <span data-ttu-id="d6ccd-134">На портале Azure щелкните развертывание нужной облачной службы.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-134">In the Azure portal, click the deployment of your cloud service.</span></span>
2. <span data-ttu-id="d6ccd-135">На панели **Свойства** портала Azure найдите значение параметра **Состояние**.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-135">In the **Properties** pane of the Azure portal, look at the value of **Status**.</span></span> <span data-ttu-id="d6ccd-136">Если указано значение **Готово**, проверьте **последнюю операцию**: возможно, недавно выполнялась операция, которая могла помешать переключению виртуального IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-136">If it is **Ready**, then check **Last operation** to see if one recently happened that might prevent the VIP swap.</span></span>
3. <span data-ttu-id="d6ccd-137">Повторите шаги 1 и 2 для развертывания в производственной среде.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-137">Repeat steps 1 and 2 for the production deployment.</span></span>
4. <span data-ttu-id="d6ccd-138">Если выполняется автоматическое обновление, дождитесь его завершения, прежде чем пытаться переключить виртуальный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-138">If an automatic update is in process, wait for it to finish before trying to do the VIP swap.</span></span>

## <a name="problem-a-role-instance-is-looping-between-started-initializing-busy-and-stopped"></a><span data-ttu-id="d6ccd-139">Проблема: экземпляр роли циклически переключается между состояниями «Запущено», «Инициализация», «Занято» и «Остановлено»</span><span class="sxs-lookup"><span data-stu-id="d6ccd-139">Problem: A role instance is looping between Started, Initializing, Busy, and Stopped</span></span>
<span data-ttu-id="d6ccd-140">Это может указывать на проблему с кодом, пакетом или файлом конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-140">This condition could indicate a problem with your application code, package, or configuration file.</span></span> <span data-ttu-id="d6ccd-141">В этом случае состояние будет изменяться каждые несколько минут, а на портале Azure могут отображаться примерно такие состояния: **Перезапуск**, **Занято** или **Инициализация**.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-141">In that case, you should be able to see the status changing every few minutes and the Azure portal may say something like **Recycling**, **Busy**, or **Initializing**.</span></span> <span data-ttu-id="d6ccd-142">Это означает, что что-то не так с приложением и что эта проблема не дает работать экземпляру роли.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-142">This indicates that there is something wrong with the application that is keeping the role instance from running.</span></span>

<span data-ttu-id="d6ccd-143">Дополнительные сведения об устранении этой проблемы см. в записях блога [Azure PaaS Compute Diagnostics Data](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx) (Данные диагностики для вычислительных сред Azure PaaS) и [Common issues that cause roles to recycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md) (Распространенные проблемы, которые вызывают повторное использование ролей).</span><span class="sxs-lookup"><span data-stu-id="d6ccd-143">For more information on how to troubleshoot for this problem, see the blog post [Azure PaaS Compute Diagnostics Data](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx) and [Common issues that cause roles to recycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span></span>

## <a name="problem-my-application-stopped-working"></a><span data-ttu-id="d6ccd-144">Проблема: мое приложение перестало работать</span><span class="sxs-lookup"><span data-stu-id="d6ccd-144">Problem: My application stopped working</span></span>
1. <span data-ttu-id="d6ccd-145">На портале Azure щелкните экземпляр роли.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-145">In the Azure portal, click the role instance.</span></span>
2. <span data-ttu-id="d6ccd-146">На панели **Свойства** портала Azure ознакомьтесь со следующими условиями, связанными с устранением проблемы:</span><span class="sxs-lookup"><span data-stu-id="d6ccd-146">In the **Properties** pane of the Azure portal, consider the following conditions to resolve your problem:</span></span>
   * <span data-ttu-id="d6ccd-147">Если работа экземпляра роли недавно остановилась (вы можете проверить значение **счетчика прерываний**), развертывание, возможно, обновляется.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-147">If the role instance has recently stopped (you can check the value of **Abort count**), the deployment could be updating.</span></span> <span data-ttu-id="d6ccd-148">Подождите: работа экземпляра роли может возобновиться автоматически.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-148">Wait to see if the role instance resumes functioning on its own.</span></span>
   * <span data-ttu-id="d6ccd-149">Если состояние экземпляра роли — **Занято**, проверьте код приложения: возможно, обрабатывается событие [StatusCheck](https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleenvironment.statuscheck) .</span><span class="sxs-lookup"><span data-stu-id="d6ccd-149">If the role instance is **Busy**, check your application code to see if the [StatusCheck](https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleenvironment.statuscheck) event is handled.</span></span> <span data-ttu-id="d6ccd-150">Может потребоваться добавить или исправить код, который обрабатывает это событие.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-150">You might need to add or fix some code that handles this event.</span></span>
   * <span data-ttu-id="d6ccd-151">Просмотрите данные диагностики и сценарии устранения неполадок в записи блога [Данные компьютерной диагностики PaaS Azure](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span><span class="sxs-lookup"><span data-stu-id="d6ccd-151">Go through the diagnostic data and troubleshooting scenarios in the blog post [Azure PaaS Compute Diagnostics Data](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span></span>

> [!WARNING]
> <span data-ttu-id="d6ccd-152">Если перезапустить облачную службу, будут сброшены свойства развертывания, при этом сведения о первоначальной проблеме будут удалены.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-152">If you recycle your cloud service, you reset the properties for the deployment, effectively erasing the information for the original problem.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="d6ccd-153">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d6ccd-153">Next steps</span></span>
<span data-ttu-id="d6ccd-154">Просмотрите дополнительные [статьи об устранении неполадок](https://azure.microsoft.com/documentation/articles/?tag=top-support-issue&product=cloud-services) в облачных службах.</span><span class="sxs-lookup"><span data-stu-id="d6ccd-154">View more [troubleshooting articles](https://azure.microsoft.com/documentation/articles/?tag=top-support-issue&product=cloud-services) for cloud services.</span></span>

<span data-ttu-id="d6ccd-155">Чтобы узнать, как устранять неполадки ролей облачной службы с помощью диагностических данных компьютеров Azure PaaS, см. [серию статей в блоге Кевина Уильямсона](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span><span class="sxs-lookup"><span data-stu-id="d6ccd-155">To learn how to troubleshoot cloud service role issues by using Azure PaaS computer diagnostics data, see [Kevin Williamson's blog series](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span></span>
