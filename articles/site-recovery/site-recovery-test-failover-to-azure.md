---
title: "aaaTest tooAzure перехода на другой ресурс в Site Recovery | Документы Microsoft"
description: "Дополнительные сведения о выполнении теста отработки отказа из локальной tooAzure"
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/04/2017
ms.author: pratshar
ms.openlocfilehash: fa0a93f409cc9f2c2c06c2d91c65971dc90c507f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="test--failover-tooazure-in-site-recovery"></a><span data-ttu-id="5cecd-103">Тестирование tooAzure отработки отказа в Site Recovery</span><span class="sxs-lookup"><span data-stu-id="5cecd-103">Test  Failover tooAzure in Site Recovery</span></span>



<span data-ttu-id="5cecd-104">Эта статья содержит сведения и инструкции для выполнения тестовой отработки отказа или детализация аварийного восстановления виртуальных машин и физических серверов, защищенных с помощью Azure в качестве hello восстановления сайта Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5cecd-104">This article provides information and instructions for doing a test failover or a DR drill of virtual machines and physical servers that are protected with Site Recovery using Azure as hello recovery site.</span></span>

<span data-ttu-id="5cecd-105">Отправьте все комментарии или вопросы hello нижней части этой статьи, или на hello [форум по службам восстановления Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="5cecd-105">Post any comments or questions at hello bottom of this article, or on hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="5cecd-106">Тестовая отработка отказа выполнять toovalidate стратегии репликации и выполнять аварийного восстановления без потери данных или простоя.</span><span class="sxs-lookup"><span data-stu-id="5cecd-106">Test failover is run toovalidate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span></span> <span data-ttu-id="5cecd-107">Выполнив тестовую отработку отказа нет негативного влияния на выполняющуюся репликацию hello или на рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="5cecd-107">Doing a test failover doesn't have any impact on hello ongoing replication or on your production environment.</span></span> <span data-ttu-id="5cecd-108">Тестовую отработку отказа можно выполнить на виртуальной машине или в [плане восстановления](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="5cecd-108">Test failover can be done either on a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="5cecd-109">После запуска тестовой отработки отказа, необходимо toospecify hello сети toowhich тестовые виртуальные машины могут подключаться к.</span><span class="sxs-lookup"><span data-stu-id="5cecd-109">When triggering a test failover, you need toospecify hello network toowhich test virtual machines would connect to.</span></span> <span data-ttu-id="5cecd-110">После активации тестовой отработки отказа можно отслеживать ход выполнения в hello **заданий** страницы.</span><span class="sxs-lookup"><span data-stu-id="5cecd-110">Once a test failover is triggered, you can track progress in hello **Jobs** page.</span></span>  


## <a name="supported-scenarios"></a><span data-ttu-id="5cecd-111">Поддерживаемые сценарии использования.</span><span class="sxs-lookup"><span data-stu-id="5cecd-111">Supported scenarios</span></span>
<span data-ttu-id="5cecd-112">Тестовая отработка отказа поддерживается во всех сценариях развертывания отличный от [прежних версий tooAzure узла VMware](site-recovery-vmware-to-azure-classic-legacy.md).</span><span class="sxs-lookup"><span data-stu-id="5cecd-112">Test failover is supported in all deployment scenarios other than [legacy VMware site tooAzure](site-recovery-vmware-to-azure-classic-legacy.md).</span></span> <span data-ttu-id="5cecd-113">Тестовая отработка отказа также не поддерживается при сбой виртуальной машины через tooAzure.</span><span class="sxs-lookup"><span data-stu-id="5cecd-113">Test failover is also not supported when virtual machine has been failed over tooAzure.</span></span>  


## <a name="run-a-test-failover"></a><span data-ttu-id="5cecd-114">Запуск тестовой отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-114">Run a test failover</span></span>
<span data-ttu-id="5cecd-115">Эта процедура описывает, как toorun тестовую отработку отказа для восстановления плане.</span><span class="sxs-lookup"><span data-stu-id="5cecd-115">This procedure describes how toorun a test failover for a recovery plan.</span></span> <span data-ttu-id="5cecd-116">В качестве альтернативы также запуском тестовой отработки отказа для одной машины, используя соответствующий параметр hello на нем.</span><span class="sxs-lookup"><span data-stu-id="5cecd-116">Alternatively you can also run test failover for a single machine by using hello appropriate option on it.</span></span>

![Тестирование отработки отказа](./media/site-recovery-test-failover-to-azure/TestFailover.png)


1. <span data-ttu-id="5cecd-118">Выберите **Планы восстановления** > *имя_плана_восстановления*.</span><span class="sxs-lookup"><span data-stu-id="5cecd-118">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="5cecd-119">Щелкните **Тестовая отработка отказа**.</span><span class="sxs-lookup"><span data-stu-id="5cecd-119">Click **Test Failover**.</span></span>
1. <span data-ttu-id="5cecd-120">Выберите **точки восстановления** toofailover для.</span><span class="sxs-lookup"><span data-stu-id="5cecd-120">Select a **Recovery Point** toofailover to.</span></span> <span data-ttu-id="5cecd-121">Можно использовать один из следующих вариантов hello:</span><span class="sxs-lookup"><span data-stu-id="5cecd-121">You can use one of hello following options:</span></span>
    1.  <span data-ttu-id="5cecd-122">**Последняя версия обработки**: этот параметр при сбое все виртуальные машины hello восстановления плана toohello последней точки восстановления, уже был обработан службой Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5cecd-122">**Latest processed**: This option fails over all virtual machines of hello recovery plan toohello latest recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="5cecd-123">При выполнении тестовой отработки отказа виртуальной машины, также отображается отметка времени последней точки восстановления обработан hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-123">When you are doing test failover of a virtual machine, time stamp of hello latest processed recovery point is also shown.</span></span> <span data-ttu-id="5cecd-124">При выполнении отработки отказа плана восстановления, вы можете вернуться tooindividual виртуальной машины и просмотрите **последней точки восстановления** плитки tooget эти сведения.</span><span class="sxs-lookup"><span data-stu-id="5cecd-124">If you are doing failover of a recovery plan, you can go tooindividual virtual machine and look at **Latest Recovery Points** tile tooget this information.</span></span> <span data-ttu-id="5cecd-125">Как долго не tooprocess hello необработанных данных, этот параметр обеспечивает отработке отказа низкий RTO (цель времени восстановления).</span><span class="sxs-lookup"><span data-stu-id="5cecd-125">As no time is spent tooprocess hello unprocessed data, this option provides a low RTO (Recovery Time Objective) failover option.</span></span>
    1.  <span data-ttu-id="5cecd-126">**Последняя версия целостность приложений**: этот параметр при сбое все виртуальные машины hello плана toohello последние приложения восстановления, согласованной точки восстановления, уже был обработан службой Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5cecd-126">**Latest app-consistent**: This option fails over all virtual machines of hello recovery plan toohello latest application consistent recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="5cecd-127">При выполнении тестовой отработки отказа виртуальной машины, также отображается отметка времени последней точки восстановления, согласованной приложения hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-127">When you are doing test failover of a virtual machine, time stamp of hello latest app-consistent recovery point is also shown.</span></span> <span data-ttu-id="5cecd-128">При выполнении отработки отказа плана восстановления, вы можете вернуться tooindividual виртуальной машины и просмотрите **последней точки восстановления** плитки tooget эти сведения.</span><span class="sxs-lookup"><span data-stu-id="5cecd-128">If you are doing failover of a recovery plan, you can go tooindividual virtual machine and look at **Latest Recovery Points** tile tooget this information.</span></span>
    1.  <span data-ttu-id="5cecd-129">**Последние**: этот параметр, сначала обрабатывает все данные hello, был отправлен tooSite восстановления службы toocreate точку восстановления для каждой виртуальной машины до отказа tooit.</span><span class="sxs-lookup"><span data-stu-id="5cecd-129">**Latest**: This option first processes all hello data that has been sent tooSite Recovery service toocreate a recovery point for each virtual machine before failing them over tooit.</span></span> <span data-ttu-id="5cecd-130">Этот параметр обеспечивает hello наименьшее RPO (цель точки восстановления) как hello виртуальную машину, созданную после перехода на другой ресурс все данные hello, репликация службы восстановления tooSite при hello перехода на другой ресурс было запущено.</span><span class="sxs-lookup"><span data-stu-id="5cecd-130">This option provides hello lowest RPO (Recovery Point Objective) as hello virtual machine created after failover will have all hello data that has been replicated tooSite Recovery service when hello failover was triggered.</span></span>
    1.  <span data-ttu-id="5cecd-131">**Последняя обработанная точка нескольких виртуальных машин**. Этот параметр доступен только для планов восстановления, которые содержат по крайней мере одну виртуальную машину с поддержкой согласованности нескольких виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="5cecd-131">**Latest multi-VM processed**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="5cecd-132">Виртуальные машины, которые являются частью репликации группы отказоустойчивого toohello последнюю общих нескольких виртуальных Машин восстановления, согласованной точки.</span><span class="sxs-lookup"><span data-stu-id="5cecd-132">Virtual machines that are part of a replication group failover toohello latest common multi-VM consistent recovery point.</span></span> <span data-ttu-id="5cecd-133">Другие виртуальные машины отработки отказа tootheir последней обработанные точки восстановления.</span><span class="sxs-lookup"><span data-stu-id="5cecd-133">Other virtual machines failover tootheir latest processed recovery point.</span></span>  
    1.  <span data-ttu-id="5cecd-134">**Последняя согласованная с приложением точка нескольких виртуальных машин**. Этот параметр доступен только для планов восстановления, которые содержат по крайней мере одну виртуальную машину с поддержкой согласованности нескольких виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="5cecd-134">**Latest multi-VM app-consistent**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="5cecd-135">Виртуальные машины, которые являются частью репликации группы отказоустойчивого toohello последней общих нескольких виртуальных Машин согласованных с приложениями точки восстановления.</span><span class="sxs-lookup"><span data-stu-id="5cecd-135">Virtual machines that are part of a replication group failover toohello latest common multi-VM application-consistent recovery point.</span></span> <span data-ttu-id="5cecd-136">Другие виртуальные машины отработки отказа tootheir последнюю согласованных с приложением точку восстановления.</span><span class="sxs-lookup"><span data-stu-id="5cecd-136">Other virtual machines failover tootheir latest application-consistent recovery point.</span></span> 
    1.  <span data-ttu-id="5cecd-137">**Настраиваемый**: при выполнении тестовой отработки отказа виртуальной машины, то можно использовать этот параметр toofailover tooa определенной точки восстановления.</span><span class="sxs-lookup"><span data-stu-id="5cecd-137">**Custom**: If you are doing test failover of a virtual machine, then you can use this option toofailover tooa particular recovery point.</span></span>
1. <span data-ttu-id="5cecd-138">Выберите **виртуальной сети Azure**: укажите Azure виртуальной сети, где будут создаваться hello тестовые виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-138">Select an **Azure virtual network**: Provide an Azure virtual network where hello test virtual machines would be created.</span></span> <span data-ttu-id="5cecd-139">Site Recovery пытается toocreate тестовые виртуальные машины в подсети тем же именем и с помощью hello IP-адрес, предоставленный в качестве **вычисления и сеть** параметры hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-139">Site Recovery attempts toocreate test virtual machines in a subnet of same name and using hello same IP as that provided in **Compute and Network** settings of hello virtual machine.</span></span> <span data-ttu-id="5cecd-140">Если подсеть с таким же именем в hello виртуальной сети Azure, предоставленный для теста отработки отказа, недоступен, то тестовая виртуальная машина создается в первом подсети hello в алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="5cecd-140">If subnet of same name is not available in hello Azure virtual network provided for test failover, then test virtual machine is created in hello first subnet alphabetically.</span></span> <span data-ttu-id="5cecd-141">Если IP-адрес недоступен в подсети hello, виртуальная машина получает другой IP-адрес в подсети hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-141">If same IP is not available in hello subnet, then virtual machine gets another IP address available in hello subnet.</span></span> <span data-ttu-id="5cecd-142">Дополнительные сведения см. в [этом разделе](#creating-a-network-for-test-failover).</span><span class="sxs-lookup"><span data-stu-id="5cecd-142">Read this section for [more details](#creating-a-network-for-test-failover)</span></span>
1. <span data-ttu-id="5cecd-143">Если отработка отказа tooAzure и включено шифрование данных, в **ключ шифрования** hello выберите сертификат, выданный при включении шифрования данных во время установки поставщика.</span><span class="sxs-lookup"><span data-stu-id="5cecd-143">If you're failing over tooAzure and data encryption is enabled, in **Encryption Key** select hello certificate that was issued when you enabled data encryption during Provider installation.</span></span> <span data-ttu-id="5cecd-144">Этот шаг можно пропустить, если вы не включили шифрование на виртуальной машине hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-144">You can ignore this step if you have not enabled encryption on hello virtual machine.</span></span>
1. <span data-ttu-id="5cecd-145">Отслеживать ход аварийного переключения на hello **заданий** вкладки. Необходимо будет toosee hello тестовую машину реплики в hello портал Azure.</span><span class="sxs-lookup"><span data-stu-id="5cecd-145">Track failover progress on hello **Jobs** tab. You should be able toosee hello test replica machine in hello Azure portal.</span></span>
1. <span data-ttu-id="5cecd-146">tooinitiate RDP-подключение на виртуальной машине hello, необходимо будет слишком[добавьте общедоступный IP-адрес](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) на hello сетевому интерфейсу hello отработку отказа виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-146">tooinitiate an RDP connection on hello virtual machine, you will need too[add a public ip](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on hello network interface of hello failed over virtual machine.</span></span> <span data-ttu-id="5cecd-147">Если выполняется переход tooa классической виртуальной машины, то нужно слишком[добавить конечную точку](../virtual-machines/windows/classic/setup-endpoints.md) порт 3389</span><span class="sxs-lookup"><span data-stu-id="5cecd-147">If you are failing over tooa Classic virtual machine, then you need too[add an endpoint](../virtual-machines/windows/classic/setup-endpoints.md) on port 3389</span></span>
1. <span data-ttu-id="5cecd-148">После завершения нажмите кнопку **очистку тестовой отработки отказа** hello плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="5cecd-148">Once you're done, click **Cleanup test failover** on hello recovery plan.</span></span> <span data-ttu-id="5cecd-149">В **заметки** записать и сохранить все наблюдения, связанные с тестовой отработки отказа hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-149">In **Notes** record and save any observations associated with hello test failover.</span></span> <span data-ttu-id="5cecd-150">Это удаляет hello виртуальных машин, которые были созданы во время тестовой отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="5cecd-150">This deletes hello virtual machines that were created during test failover.</span></span>


> [!TIP]
> <span data-ttu-id="5cecd-151">Site Recovery пытается toocreate тестовые виртуальные машины в подсети тем же именем и с помощью hello IP-адрес, предоставленный в качестве **вычисления и сеть** параметры hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-151">Site Recovery attempts toocreate test virtual machines in a subnet of same name and using hello same IP as that provided in **Compute and Network** settings of hello virtual machine.</span></span> <span data-ttu-id="5cecd-152">Если подсеть с таким же именем в hello виртуальной сети Azure, предоставленный для теста отработки отказа, недоступен, то тестовая виртуальная машина создается в первом подсети hello в алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="5cecd-152">If subnet of same name is not available in hello Azure virtual network provided for test failover, then test virtual machine is created in hello first subnet alphabetically.</span></span> <span data-ttu-id="5cecd-153">Если hello целевой IP-адрес является частью выбранной подсети hello, восстановления сайта предпринимает toocreate hello теста отработки отказа виртуальной машины с помощью hello целевой IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="5cecd-153">If hello target IP is part of hello chosen subnet, then site recovery tries toocreate hello test failover virtual machine using hello target IP.</span></span> <span data-ttu-id="5cecd-154">Если hello целевой IP-адрес не является частью выбранной подсети hello затем тестовой отработки отказа виртуальной машины создается с помощью любой доступный IP-адрес в hello выбранной подсети.</span><span class="sxs-lookup"><span data-stu-id="5cecd-154">If hello target IP is not part of hello chosen subnet then test failover virtual machine gets created using any available IP in hello chosen subnet.</span></span>
>
>

## <a name="test-failover-job"></a><span data-ttu-id="5cecd-155">Задание тестовой отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-155">Test failover job</span></span>

![Тестирование отработки отказа](./media/site-recovery-test-failover-to-azure/TestFailoverJob.png)

<span data-ttu-id="5cecd-157">Активация тестовой отработки отказа включает следующие этапы.</span><span class="sxs-lookup"><span data-stu-id="5cecd-157">When a test failover is triggered, it involves following steps:</span></span>

1. <span data-ttu-id="5cecd-158">Проверка необходимых компонентов. На этом этапе вы проверяете, соблюдены ли все условия, необходимые для отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="5cecd-158">Prerequisites check: This step ensures that all conditions required for failover are met</span></span>
1. <span data-ttu-id="5cecd-159">Отработка отказа: Этот шаг обрабатывает данные hello и делает все готово для создания виртуальной машине Azure вне его.</span><span class="sxs-lookup"><span data-stu-id="5cecd-159">Failover: This step processes hello data and makes it ready so that an Azure virtual machine can be created out of it.</span></span> <span data-ttu-id="5cecd-160">Если вы выбрали **последнюю** точку восстановления, этот шаг создает точку восстановления из данных hello, которое было отправлено toohello службы.</span><span class="sxs-lookup"><span data-stu-id="5cecd-160">If you have chosen **Latest** recovery point, this step creates a recovery point from hello data that has been sent toohello service.</span></span>
1. <span data-ttu-id="5cecd-161">Начало: На этом шаге создается виртуальная машина Azure с помощью обработки в предыдущем шаге hello данных hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-161">Start: This step creates an Azure virtual machine using hello data processed in hello previous step.</span></span>

## <a name="time-taken-for-failover"></a><span data-ttu-id="5cecd-162">Время, необходимое для отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-162">Time taken for failover</span></span>

<span data-ttu-id="5cecd-163">В некоторых случаях отработки отказа виртуальных машин требуется дополнительный промежуточного шага, обычно занимает около 8 toocomplete too10 минут.</span><span class="sxs-lookup"><span data-stu-id="5cecd-163">In certain cases, failover of virtual machines requires an extra intermediate step that usually takes around 8  too10 minutes toocomplete.</span></span> <span data-ttu-id="5cecd-164">Эти случаи перечислены ниже:</span><span class="sxs-lookup"><span data-stu-id="5cecd-164">These cases are as following:</span></span>

* <span data-ttu-id="5cecd-165">С помощью версии hello старше 9.8 службы мобильности виртуальных машин VMware</span><span class="sxs-lookup"><span data-stu-id="5cecd-165">VMware virtual machines using a version of hello Mobility service older than 9.8</span></span>
* <span data-ttu-id="5cecd-166">физические серверы;</span><span class="sxs-lookup"><span data-stu-id="5cecd-166">Physical servers</span></span>
* <span data-ttu-id="5cecd-167">виртуальные машины VMware на платформе Linux;</span><span class="sxs-lookup"><span data-stu-id="5cecd-167">VMware Linux virtual machines</span></span>
* <span data-ttu-id="5cecd-168">виртуальные машины Hyper-V, защищенные как физические серверы;</span><span class="sxs-lookup"><span data-stu-id="5cecd-168">Hyper-V virtual machines protected as physical servers</span></span>
* <span data-ttu-id="5cecd-169">виртуальные машины VMware, на которых отсутствуют следующие драйверы в качестве драйверов загрузки:</span><span class="sxs-lookup"><span data-stu-id="5cecd-169">VMware virtual machines where following drivers are not present as boot drivers</span></span>
    * <span data-ttu-id="5cecd-170">storvsc;</span><span class="sxs-lookup"><span data-stu-id="5cecd-170">storvsc</span></span>
    * <span data-ttu-id="5cecd-171">vmbus;</span><span class="sxs-lookup"><span data-stu-id="5cecd-171">vmbus</span></span>
    * <span data-ttu-id="5cecd-172">storflt;</span><span class="sxs-lookup"><span data-stu-id="5cecd-172">storflt</span></span>
    * <span data-ttu-id="5cecd-173">intelide;</span><span class="sxs-lookup"><span data-stu-id="5cecd-173">intelide</span></span>
    * <span data-ttu-id="5cecd-174">atapi;</span><span class="sxs-lookup"><span data-stu-id="5cecd-174">atapi</span></span>
* <span data-ttu-id="5cecd-175">виртуальные машины VMware, на которых не включена служба DHCP, вне зависимости от того, используется протокол DHCP или статические IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="5cecd-175">VMware virtual machines that don't have DHCP service enabled irrespective of whether they are using DHCP or static IP addresses</span></span>

<span data-ttu-id="5cecd-176">В hello всех остальных случаях этот промежуточный шаг не требуется и hello время, необходимое для отработки отказа hello значительно ниже.</span><span class="sxs-lookup"><span data-stu-id="5cecd-176">In all hello other cases this intermediate step is not required and hello time taken for hello failover is significantly lower.</span></span>


## <a name="creating-a-network-for-test-failover"></a><span data-ttu-id="5cecd-177">Создание сети для тестовой отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-177">Creating a network for test failover</span></span>
<span data-ttu-id="5cecd-178">Рекомендуется при выполнении тестовой отработки отказа выбрать сеть, которая будет изолирована от рабочей сети сайта восстановления, предоставленный в **вычисления и сеть** параметры hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-178">It is recommended that when you are doing a test failover you choose a network that is isolated from your production recovery site network that you provided in **Compute and Network** settings for hello virtual machine.</span></span> <span data-ttu-id="5cecd-179">При создании виртуальной сети Azure она по умолчанию изолируется от других сетей.</span><span class="sxs-lookup"><span data-stu-id="5cecd-179">By default when you create an Azure virtual network, it is isolated from other networks.</span></span> <span data-ttu-id="5cecd-180">Эта сеть должна имитировать рабочую сеть:</span><span class="sxs-lookup"><span data-stu-id="5cecd-180">This network should mimic your production network:</span></span>

1. <span data-ttu-id="5cecd-181">Тестовой сети должны иметь одинаковое число подсети, что и в сети и с hello одинаковые имена, как hello подсетей в сети.</span><span class="sxs-lookup"><span data-stu-id="5cecd-181">Test network should have same number of subnets as that in your production network and with hello same name as those of hello subnets in your production network.</span></span>
1. <span data-ttu-id="5cecd-182">Следует использовать тестовой сети hello же диапазон IP-адресов, что и к рабочей сети.</span><span class="sxs-lookup"><span data-stu-id="5cecd-182">Test network should use hello same IP range as that of your production network.</span></span>
1. <span data-ttu-id="5cecd-183">Обновление hello DNS hello тестовой сети как hello IP-адреса, Вы дали как конечного Объекта для hello DNS виртуальной машины в группе **вычисления и сеть** параметры.</span><span class="sxs-lookup"><span data-stu-id="5cecd-183">Update hello DNS of hello Test Network as hello IP that you gave as target IP for hello DNS virtual machine under **Compute and Network** settings.</span></span> <span data-ttu-id="5cecd-184">Дополнительные сведения см. в разделе [Рекомендации по тестированию отработки отказа для Active Directory](site-recovery-active-directory.md#test-failover-considerations).</span><span class="sxs-lookup"><span data-stu-id="5cecd-184">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>


## <a name="test-failover-tooa-production-network-on-recovery-site"></a><span data-ttu-id="5cecd-185">Тестирование отработки отказа tooa рабочей сети на сайте восстановления</span><span class="sxs-lookup"><span data-stu-id="5cecd-185">Test failover tooa production network on recovery site</span></span>
<span data-ttu-id="5cecd-186">Рекомендуется при выполнении тестовой отработки отказа выбрать сеть, которая отличается от рабочей сети сайта восстановления, предоставленный в **вычисления и сеть** параметры hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-186">It is recommended that when you are doing a test failover you choose a network that is different from your production recovery site network that you provided in **Compute and Network** settings for hello virtual machine.</span></span> <span data-ttu-id="5cecd-187">Но если действительно toovalidate окончания tooend сетевого подключения в сбоя по виртуальной машины, обратите внимание, hello после точки:</span><span class="sxs-lookup"><span data-stu-id="5cecd-187">But if you really want toovalidate end tooend network connectivity in a failed over virtual machine, note hello following points:</span></span>

1. <span data-ttu-id="5cecd-188">Убедитесь, что основная виртуальная машина, hello выключен, при выполнении тестовой отработки отказа hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-188">Make sure that hello primary virtual machine is shutdown when you are doing hello test failover.</span></span> <span data-ttu-id="5cecd-189">Если не сделать, будет две виртуальные машины с hello удостоверением, работающих в hello сетевых на hello одновременно и, можно привести tooundesired последствия.</span><span class="sxs-lookup"><span data-stu-id="5cecd-189">If you don't do so, there will be two virtual machines with hello same identity running in hello same network at hello same time and that can lead tooundesired consequences.</span></span>
1. <span data-ttu-id="5cecd-190">Будут потеряны все изменения, внесенные в hello тестовые отработки отказа виртуальные машины, когда вы очистки hello тестовые отработки отказа виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-190">Any changes that you make into hello test failover virtual machines would be lost when you cleanup hello test failover virtual machines.</span></span> <span data-ttu-id="5cecd-191">Эти изменения не будут реплицированных задней toohello основной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="5cecd-191">These changes will not be replicated back toohello primary virtual machine.</span></span>
1. <span data-ttu-id="5cecd-192">Такой способ тестировании приводит простой tooa производственного приложения.</span><span class="sxs-lookup"><span data-stu-id="5cecd-192">This way of doing testing leads tooa downtime of your production application.</span></span> <span data-ttu-id="5cecd-193">Пользователи приложения hello вопросы, что выполняется toonot приложения hello используйте при детализации hello аварийного восстановления.</span><span class="sxs-lookup"><span data-stu-id="5cecd-193">Users of hello application should be asked toonot use hello application when hello DR drill is in progress.</span></span>  



## <a name="prepare-active-directory-and-dns"></a><span data-ttu-id="5cecd-194">Подготовка Active Directory и DNS</span><span class="sxs-lookup"><span data-stu-id="5cecd-194">Prepare Active Directory and DNS</span></span>
<span data-ttu-id="5cecd-195">toorun тестовую отработку отказа для тестирования приложений в тестовой среде нужна копия производственной среды Active Directory hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-195">toorun a test failover for application testing, you need a copy of hello production Active Directory environment in your test environment.</span></span> <span data-ttu-id="5cecd-196">Дополнительные сведения см. в разделе [Рекомендации по тестированию отработки отказа для Active Directory](site-recovery-active-directory.md#test-failover-considerations).</span><span class="sxs-lookup"><span data-stu-id="5cecd-196">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>

## <a name="prepare-tooconnect-tooazure-vms-after-failover"></a><span data-ttu-id="5cecd-197">Подготовка виртуальных машин tooAzure tooconnect после отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-197">Prepare tooconnect tooAzure VMs after failover</span></span>

<span data-ttu-id="5cecd-198">Если требуется, чтобы tooconnect tooAzure виртуальных машин с помощью протокола удаленного рабочего СТОЛА, после отработки отказа, убедитесь, что hello действия, перечисленные в таблице hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-198">If you want tooconnect tooAzure VMs using RDP after failover, make sure you do hello actions summarized in hello table.</span></span>

<span data-ttu-id="5cecd-199">**Тип отработки отказа**</span><span class="sxs-lookup"><span data-stu-id="5cecd-199">**Failover**</span></span> | <span data-ttu-id="5cecd-200">**Расположение**</span><span class="sxs-lookup"><span data-stu-id="5cecd-200">**Location**</span></span> | <span data-ttu-id="5cecd-201">**Действия**</span><span class="sxs-lookup"><span data-stu-id="5cecd-201">**Actions**</span></span>
--- | --- | ---
<span data-ttu-id="5cecd-202">**Виртуальная машина Azure под управлением Windows**</span><span class="sxs-lookup"><span data-stu-id="5cecd-202">**Azure VM running Windows**</span></span> | <span data-ttu-id="5cecd-203">На локальном компьютере до отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-203">On on-premises machine before failover</span></span> | <span data-ttu-id="5cecd-204">tooaccess hello виртуальной Машине Azure через Интернет hello, Включение протокола удаленного рабочего СТОЛА, убедитесь, что TCP и UDP правила добавляются для hello **открытый**, и допустимой RDP **брандмауэра Windows** > **разрешено Приложения**, для всех профилей.</span><span class="sxs-lookup"><span data-stu-id="5cecd-204">tooaccess hello Azure VM over hello internet, enable RDP, make sure TCP, and UDP rules are added for hello **Public**, and that RDP is allowed in **Windows Firewall** > **Allowed Apps**, for all profiles.</span></span><br/><br/> <span data-ttu-id="5cecd-205">Включение протокола удаленного рабочего СТОЛА на компьютере hello tooaccess по подключению сайт сайт и убедитесь, что RDP разрешен в hello **брандмауэра Windows** -> **допускается программы и компоненты** для  **Домен и частные** сетей.</span><span class="sxs-lookup"><span data-stu-id="5cecd-205">tooaccess over a site-to-site connection, enable RDP on hello machine, and ensure that RDP is allowed in hello **Windows Firewall** -> **Allowed apps and features** for **Domain and Private** networks.</span></span><br/><br/>  <span data-ttu-id="5cecd-206">Убедитесь, что политики SAN hello операционной системы задано слишком**OnlineAll**.</span><span class="sxs-lookup"><span data-stu-id="5cecd-206">Make sure hello operating system's SAN policy is set too**OnlineAll**.</span></span> <span data-ttu-id="5cecd-207">[Подробнее](https://support.microsoft.com/kb/3031135).</span><span class="sxs-lookup"><span data-stu-id="5cecd-207">[Learn more](https://support.microsoft.com/kb/3031135).</span></span><br/><br/> <span data-ttu-id="5cecd-208">Убедитесь, что существуют не отложенные обновления Windows на виртуальной машине hello, когда создаются для отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="5cecd-208">Make sure there are no Windows updates pending on hello virtual machine when you trigger a failover.</span></span> <span data-ttu-id="5cecd-209">Центр обновления Windows может запускаться при отработки отказа и нельзя будет toologin toohello виртуальной машины до завершения обновления hello.</span><span class="sxs-lookup"><span data-stu-id="5cecd-209">Windows update might start when you failover and you will not be able toologin toohello virtual machine until hello update completes.</span></span> <br/><br/>
<span data-ttu-id="5cecd-210">**Виртуальная машина Azure под управлением Windows**</span><span class="sxs-lookup"><span data-stu-id="5cecd-210">**Azure VM running Windows**</span></span> | <span data-ttu-id="5cecd-211">На виртуальной машине Azure после отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-211">On Azure VM after failover</span></span> | <span data-ttu-id="5cecd-212">Для классической виртуальной машины [добавить общедоступную конечную точку](../virtual-machines/windows/classic/setup-endpoints.md) для hello протокола RDP (порт 3389)</span><span class="sxs-lookup"><span data-stu-id="5cecd-212">For a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) for hello RDP protocol (port 3389)</span></span><br/><br/>  <span data-ttu-id="5cecd-213">На виртуальной машине, развернутой с помощью Resource Manager, [добавьте общедоступный IP-адрес](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="5cecd-213">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="5cecd-214">Здравствуйте, правила группы сетевой безопасности на hello отработку отказа виртуальной Машины, а hello toowhich подсети Azure, в которой он подключен, нужны tooallow входящих подключений toohello RDP-порту.</span><span class="sxs-lookup"><span data-stu-id="5cecd-214">hello network security group rules on hello failed over VM, and hello Azure subnet toowhich it is connected, need tooallow incoming connections toohello RDP port.</span></span><br/><br/> <span data-ttu-id="5cecd-215">Для диспетчера ресурсов виртуальной машины, можно проверить **загрузки диагностики** toolook на снимок экрана приветствия виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="5cecd-215">For a Resource Manager virtual machine, you can check **Boot diagnostics** toolook at a screenshot of hello virtual machine</span></span><br/><br/> <span data-ttu-id="5cecd-216">Если вы не можете подключиться, проверьте hello, что Виртуальная машина запущена, а затем просмотреть эти [советы по устранению неполадок](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="5cecd-216">If you can't connect, check that hello VM is running and then look at these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span><br/><br/>
<span data-ttu-id="5cecd-217">**Виртуальная машина Azure под управлением Linux**</span><span class="sxs-lookup"><span data-stu-id="5cecd-217">**Azure VM running Linux**</span></span> | <span data-ttu-id="5cecd-218">На локальном компьютере до отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-218">On on-premises machine before failover</span></span> | <span data-ttu-id="5cecd-219">Убедитесь, что hello Secure Shell службы на виртуальной Машине Azure hello задается toostart автоматически во время загрузки системы.</span><span class="sxs-lookup"><span data-stu-id="5cecd-219">Ensure that hello Secure Shell service on hello Azure VM is set toostart automatically on system boot.</span></span><br/><br/> <span data-ttu-id="5cecd-220">Проверьте, что правила брандмауэра разрешают tooit подключения SSH.</span><span class="sxs-lookup"><span data-stu-id="5cecd-220">Check that firewall rules allow an SSH connection tooit.</span></span>
<span data-ttu-id="5cecd-221">**Виртуальная машина Azure под управлением Linux**</span><span class="sxs-lookup"><span data-stu-id="5cecd-221">**Azure VM running Linux**</span></span> | <span data-ttu-id="5cecd-222">Виртуальная машина Azure после отработки отказа</span><span class="sxs-lookup"><span data-stu-id="5cecd-222">Azure VM after failover</span></span> | <span data-ttu-id="5cecd-223">Здравствуйте, правила группы сетевой безопасности на hello отработку отказа виртуальной Машины, а hello toowhich подсети Azure, в которой он подключен, нужны tooallow входящих подключений toohello SSH-порта.</span><span class="sxs-lookup"><span data-stu-id="5cecd-223">hello network security group rules on hello failed over VM, and hello Azure subnet toowhich it is connected, need tooallow incoming connections toohello SSH port.</span></span><br/><br/> <span data-ttu-id="5cecd-224">Для классической виртуальной машины [добавить общедоступную конечную точку](../virtual-machines/windows/classic/setup-endpoints.md) должна быть создана; tooallow входящих подключений на hello SSH-порта (TCP-порт 22 по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="5cecd-224">For  a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) should be created, tooallow incoming connections on hello SSH port (TCP port 22 by default).</span></span><br/><br/> <span data-ttu-id="5cecd-225">На виртуальной машине, развернутой с помощью Resource Manager, [добавьте общедоступный IP-адрес](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="5cecd-225">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="5cecd-226">Для диспетчера ресурсов виртуальной машины, можно проверить **загрузки диагностики** toolook на снимок экрана приветствия виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="5cecd-226">For a Resource Manager virtual machine, you can check **Boot diagnostics** toolook at a screenshot of hello virtual machine</span></span><br/><br/>



## <a name="next-steps"></a><span data-ttu-id="5cecd-227">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="5cecd-227">Next steps</span></span>
<span data-ttu-id="5cecd-228">После успешной тестовой отработки отказа можно попробовать выполнить [отработку отказа](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="5cecd-228">Once you have successfully tried a test failover you can try doing a [failover](site-recovery-failover.md).</span></span>
