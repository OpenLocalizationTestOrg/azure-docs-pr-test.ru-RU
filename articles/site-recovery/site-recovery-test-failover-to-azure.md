---
title: "aaaTest tooAzure перехода на другой ресурс в Site Recovery | Документы Microsoft"
description: "Дополнительные сведения о выполнении теста отработки отказа из локальной tooAzure"
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/04/2017
ms.author: pratshar
ms.openlocfilehash: fa0a93f409cc9f2c2c06c2d91c65971dc90c507f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="test--failover-tooazure-in-site-recovery"></a>Тестирование tooAzure отработки отказа в Site Recovery



Эта статья содержит сведения и инструкции для выполнения тестовой отработки отказа или детализация аварийного восстановления виртуальных машин и физических серверов, защищенных с помощью Azure в качестве hello восстановления сайта Site Recovery.

Отправьте все комментарии или вопросы hello нижней части этой статьи, или на hello [форум по службам восстановления Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).

Тестовая отработка отказа выполнять toovalidate стратегии репликации и выполнять аварийного восстановления без потери данных или простоя. Выполнив тестовую отработку отказа нет негативного влияния на выполняющуюся репликацию hello или на рабочую среду. Тестовую отработку отказа можно выполнить на виртуальной машине или в [плане восстановления](site-recovery-create-recovery-plans.md). После запуска тестовой отработки отказа, необходимо toospecify hello сети toowhich тестовые виртуальные машины могут подключаться к. После активации тестовой отработки отказа можно отслеживать ход выполнения в hello **заданий** страницы.  


## <a name="supported-scenarios"></a>Поддерживаемые сценарии использования.
Тестовая отработка отказа поддерживается во всех сценариях развертывания отличный от [прежних версий tooAzure узла VMware](site-recovery-vmware-to-azure-classic-legacy.md). Тестовая отработка отказа также не поддерживается при сбой виртуальной машины через tooAzure.  


## <a name="run-a-test-failover"></a>Запуск тестовой отработки отказа
Эта процедура описывает, как toorun тестовую отработку отказа для восстановления плане. В качестве альтернативы также запуском тестовой отработки отказа для одной машины, используя соответствующий параметр hello на нем.

![Тестирование отработки отказа](./media/site-recovery-test-failover-to-azure/TestFailover.png)


1. Выберите **Планы восстановления** > *имя_плана_восстановления*. Щелкните **Тестовая отработка отказа**.
1. Выберите **точки восстановления** toofailover для. Можно использовать один из следующих вариантов hello:
    1.  **Последняя версия обработки**: этот параметр при сбое все виртуальные машины hello восстановления плана toohello последней точки восстановления, уже был обработан службой Site Recovery. При выполнении тестовой отработки отказа виртуальной машины, также отображается отметка времени последней точки восстановления обработан hello. При выполнении отработки отказа плана восстановления, вы можете вернуться tooindividual виртуальной машины и просмотрите **последней точки восстановления** плитки tooget эти сведения. Как долго не tooprocess hello необработанных данных, этот параметр обеспечивает отработке отказа низкий RTO (цель времени восстановления).
    1.  **Последняя версия целостность приложений**: этот параметр при сбое все виртуальные машины hello плана toohello последние приложения восстановления, согласованной точки восстановления, уже был обработан службой Site Recovery. При выполнении тестовой отработки отказа виртуальной машины, также отображается отметка времени последней точки восстановления, согласованной приложения hello. При выполнении отработки отказа плана восстановления, вы можете вернуться tooindividual виртуальной машины и просмотрите **последней точки восстановления** плитки tooget эти сведения.
    1.  **Последние**: этот параметр, сначала обрабатывает все данные hello, был отправлен tooSite восстановления службы toocreate точку восстановления для каждой виртуальной машины до отказа tooit. Этот параметр обеспечивает hello наименьшее RPO (цель точки восстановления) как hello виртуальную машину, созданную после перехода на другой ресурс все данные hello, репликация службы восстановления tooSite при hello перехода на другой ресурс было запущено.
    1.  **Последняя обработанная точка нескольких виртуальных машин**. Этот параметр доступен только для планов восстановления, которые содержат по крайней мере одну виртуальную машину с поддержкой согласованности нескольких виртуальных машин. Виртуальные машины, которые являются частью репликации группы отказоустойчивого toohello последнюю общих нескольких виртуальных Машин восстановления, согласованной точки. Другие виртуальные машины отработки отказа tootheir последней обработанные точки восстановления.  
    1.  **Последняя согласованная с приложением точка нескольких виртуальных машин**. Этот параметр доступен только для планов восстановления, которые содержат по крайней мере одну виртуальную машину с поддержкой согласованности нескольких виртуальных машин. Виртуальные машины, которые являются частью репликации группы отказоустойчивого toohello последней общих нескольких виртуальных Машин согласованных с приложениями точки восстановления. Другие виртуальные машины отработки отказа tootheir последнюю согласованных с приложением точку восстановления. 
    1.  **Настраиваемый**: при выполнении тестовой отработки отказа виртуальной машины, то можно использовать этот параметр toofailover tooa определенной точки восстановления.
1. Выберите **виртуальной сети Azure**: укажите Azure виртуальной сети, где будут создаваться hello тестовые виртуальные машины. Site Recovery пытается toocreate тестовые виртуальные машины в подсети тем же именем и с помощью hello IP-адрес, предоставленный в качестве **вычисления и сеть** параметры hello виртуальной машины. Если подсеть с таким же именем в hello виртуальной сети Azure, предоставленный для теста отработки отказа, недоступен, то тестовая виртуальная машина создается в первом подсети hello в алфавитном порядке. Если IP-адрес недоступен в подсети hello, виртуальная машина получает другой IP-адрес в подсети hello. Дополнительные сведения см. в [этом разделе](#creating-a-network-for-test-failover).
1. Если отработка отказа tooAzure и включено шифрование данных, в **ключ шифрования** hello выберите сертификат, выданный при включении шифрования данных во время установки поставщика. Этот шаг можно пропустить, если вы не включили шифрование на виртуальной машине hello.
1. Отслеживать ход аварийного переключения на hello **заданий** вкладки. Необходимо будет toosee hello тестовую машину реплики в hello портал Azure.
1. tooinitiate RDP-подключение на виртуальной машине hello, необходимо будет слишком[добавьте общедоступный IP-адрес](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) на hello сетевому интерфейсу hello отработку отказа виртуальной машины. Если выполняется переход tooa классической виртуальной машины, то нужно слишком[добавить конечную точку](../virtual-machines/windows/classic/setup-endpoints.md) порт 3389
1. После завершения нажмите кнопку **очистку тестовой отработки отказа** hello плана восстановления. В **заметки** записать и сохранить все наблюдения, связанные с тестовой отработки отказа hello. Это удаляет hello виртуальных машин, которые были созданы во время тестовой отработки отказа.


> [!TIP]
> Site Recovery пытается toocreate тестовые виртуальные машины в подсети тем же именем и с помощью hello IP-адрес, предоставленный в качестве **вычисления и сеть** параметры hello виртуальной машины. Если подсеть с таким же именем в hello виртуальной сети Azure, предоставленный для теста отработки отказа, недоступен, то тестовая виртуальная машина создается в первом подсети hello в алфавитном порядке. Если hello целевой IP-адрес является частью выбранной подсети hello, восстановления сайта предпринимает toocreate hello теста отработки отказа виртуальной машины с помощью hello целевой IP-адрес. Если hello целевой IP-адрес не является частью выбранной подсети hello затем тестовой отработки отказа виртуальной машины создается с помощью любой доступный IP-адрес в hello выбранной подсети.
>
>

## <a name="test-failover-job"></a>Задание тестовой отработки отказа

![Тестирование отработки отказа](./media/site-recovery-test-failover-to-azure/TestFailoverJob.png)

Активация тестовой отработки отказа включает следующие этапы.

1. Проверка необходимых компонентов. На этом этапе вы проверяете, соблюдены ли все условия, необходимые для отработки отказа.
1. Отработка отказа: Этот шаг обрабатывает данные hello и делает все готово для создания виртуальной машине Azure вне его. Если вы выбрали **последнюю** точку восстановления, этот шаг создает точку восстановления из данных hello, которое было отправлено toohello службы.
1. Начало: На этом шаге создается виртуальная машина Azure с помощью обработки в предыдущем шаге hello данных hello.

## <a name="time-taken-for-failover"></a>Время, необходимое для отработки отказа

В некоторых случаях отработки отказа виртуальных машин требуется дополнительный промежуточного шага, обычно занимает около 8 toocomplete too10 минут. Эти случаи перечислены ниже:

* С помощью версии hello старше 9.8 службы мобильности виртуальных машин VMware
* физические серверы;
* виртуальные машины VMware на платформе Linux;
* виртуальные машины Hyper-V, защищенные как физические серверы;
* виртуальные машины VMware, на которых отсутствуют следующие драйверы в качестве драйверов загрузки:
    * storvsc;
    * vmbus;
    * storflt;
    * intelide;
    * atapi;
* виртуальные машины VMware, на которых не включена служба DHCP, вне зависимости от того, используется протокол DHCP или статические IP-адреса.

В hello всех остальных случаях этот промежуточный шаг не требуется и hello время, необходимое для отработки отказа hello значительно ниже.


## <a name="creating-a-network-for-test-failover"></a>Создание сети для тестовой отработки отказа
Рекомендуется при выполнении тестовой отработки отказа выбрать сеть, которая будет изолирована от рабочей сети сайта восстановления, предоставленный в **вычисления и сеть** параметры hello виртуальной машины. При создании виртуальной сети Azure она по умолчанию изолируется от других сетей. Эта сеть должна имитировать рабочую сеть:

1. Тестовой сети должны иметь одинаковое число подсети, что и в сети и с hello одинаковые имена, как hello подсетей в сети.
1. Следует использовать тестовой сети hello же диапазон IP-адресов, что и к рабочей сети.
1. Обновление hello DNS hello тестовой сети как hello IP-адреса, Вы дали как конечного Объекта для hello DNS виртуальной машины в группе **вычисления и сеть** параметры. Дополнительные сведения см. в разделе [Рекомендации по тестированию отработки отказа для Active Directory](site-recovery-active-directory.md#test-failover-considerations).


## <a name="test-failover-tooa-production-network-on-recovery-site"></a>Тестирование отработки отказа tooa рабочей сети на сайте восстановления
Рекомендуется при выполнении тестовой отработки отказа выбрать сеть, которая отличается от рабочей сети сайта восстановления, предоставленный в **вычисления и сеть** параметры hello виртуальной машины. Но если действительно toovalidate окончания tooend сетевого подключения в сбоя по виртуальной машины, обратите внимание, hello после точки:

1. Убедитесь, что основная виртуальная машина, hello выключен, при выполнении тестовой отработки отказа hello. Если не сделать, будет две виртуальные машины с hello удостоверением, работающих в hello сетевых на hello одновременно и, можно привести tooundesired последствия.
1. Будут потеряны все изменения, внесенные в hello тестовые отработки отказа виртуальные машины, когда вы очистки hello тестовые отработки отказа виртуальные машины. Эти изменения не будут реплицированных задней toohello основной виртуальной машины.
1. Такой способ тестировании приводит простой tooa производственного приложения. Пользователи приложения hello вопросы, что выполняется toonot приложения hello используйте при детализации hello аварийного восстановления.  



## <a name="prepare-active-directory-and-dns"></a>Подготовка Active Directory и DNS
toorun тестовую отработку отказа для тестирования приложений в тестовой среде нужна копия производственной среды Active Directory hello. Дополнительные сведения см. в разделе [Рекомендации по тестированию отработки отказа для Active Directory](site-recovery-active-directory.md#test-failover-considerations).

## <a name="prepare-tooconnect-tooazure-vms-after-failover"></a>Подготовка виртуальных машин tooAzure tooconnect после отработки отказа

Если требуется, чтобы tooconnect tooAzure виртуальных машин с помощью протокола удаленного рабочего СТОЛА, после отработки отказа, убедитесь, что hello действия, перечисленные в таблице hello.

**Тип отработки отказа** | **Расположение** | **Действия**
--- | --- | ---
**Виртуальная машина Azure под управлением Windows** | На локальном компьютере до отработки отказа | tooaccess hello виртуальной Машине Azure через Интернет hello, Включение протокола удаленного рабочего СТОЛА, убедитесь, что TCP и UDP правила добавляются для hello **открытый**, и допустимой RDP **брандмауэра Windows** > **разрешено Приложения**, для всех профилей.<br/><br/> Включение протокола удаленного рабочего СТОЛА на компьютере hello tooaccess по подключению сайт сайт и убедитесь, что RDP разрешен в hello **брандмауэра Windows** -> **допускается программы и компоненты** для  **Домен и частные** сетей.<br/><br/>  Убедитесь, что политики SAN hello операционной системы задано слишком**OnlineAll**. [Подробнее](https://support.microsoft.com/kb/3031135).<br/><br/> Убедитесь, что существуют не отложенные обновления Windows на виртуальной машине hello, когда создаются для отработки отказа. Центр обновления Windows может запускаться при отработки отказа и нельзя будет toologin toohello виртуальной машины до завершения обновления hello. <br/><br/>
**Виртуальная машина Azure под управлением Windows** | На виртуальной машине Azure после отработки отказа | Для классической виртуальной машины [добавить общедоступную конечную точку](../virtual-machines/windows/classic/setup-endpoints.md) для hello протокола RDP (порт 3389)<br/><br/>  На виртуальной машине, развернутой с помощью Resource Manager, [добавьте общедоступный IP-адрес](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine).<br/><br/> Здравствуйте, правила группы сетевой безопасности на hello отработку отказа виртуальной Машины, а hello toowhich подсети Azure, в которой он подключен, нужны tooallow входящих подключений toohello RDP-порту.<br/><br/> Для диспетчера ресурсов виртуальной машины, можно проверить **загрузки диагностики** toolook на снимок экрана приветствия виртуальной машины<br/><br/> Если вы не можете подключиться, проверьте hello, что Виртуальная машина запущена, а затем просмотреть эти [советы по устранению неполадок](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).<br/><br/>
**Виртуальная машина Azure под управлением Linux** | На локальном компьютере до отработки отказа | Убедитесь, что hello Secure Shell службы на виртуальной Машине Azure hello задается toostart автоматически во время загрузки системы.<br/><br/> Проверьте, что правила брандмауэра разрешают tooit подключения SSH.
**Виртуальная машина Azure под управлением Linux** | Виртуальная машина Azure после отработки отказа | Здравствуйте, правила группы сетевой безопасности на hello отработку отказа виртуальной Машины, а hello toowhich подсети Azure, в которой он подключен, нужны tooallow входящих подключений toohello SSH-порта.<br/><br/> Для классической виртуальной машины [добавить общедоступную конечную точку](../virtual-machines/windows/classic/setup-endpoints.md) должна быть создана; tooallow входящих подключений на hello SSH-порта (TCP-порт 22 по умолчанию).<br/><br/> На виртуальной машине, развернутой с помощью Resource Manager, [добавьте общедоступный IP-адрес](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine).<br/><br/> Для диспетчера ресурсов виртуальной машины, можно проверить **загрузки диагностики** toolook на снимок экрана приветствия виртуальной машины<br/><br/>



## <a name="next-steps"></a>Дальнейшие действия
После успешной тестовой отработки отказа можно попробовать выполнить [отработку отказа](site-recovery-failover.md).
