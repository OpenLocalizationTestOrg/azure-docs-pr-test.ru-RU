---
title: "aaaFailover в Site Recovery | Документы Microsoft"
description: "Azure Site Recovery координирует hello репликации, отработки отказа и восстановления виртуальных машин и физических серверов. Дополнительные сведения о tooAzure отработки отказа или вторичный центр обработки данных."
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/04/2017
ms.author: pratshar
ms.openlocfilehash: 7cacea829d78bb7de2b2d67402291b472b10f023
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="failover-in-site-recovery"></a>Отработка отказа в Site Recovery
В этой статье описывается, как toofailover виртуальных машин и физических серверов защищена службой восстановления сайтов.

## <a name="prerequisites"></a>Предварительные требования
1. Прежде чем выполнять отработку отказа, выполните [тестовая отработка отказа](site-recovery-test-failover-to-azure.md) tooensure, что все работает должным образом.
1. [Подготовка сети hello](site-recovery-network-design.md) целевого расположения, прежде чем выполнять отработку отказа.  


## <a name="run-a-failover"></a>Запуск отработки отказа
Эта процедура описывает, как toorun a отработку отказа для [плана восстановления](site-recovery-create-recovery-plans.md). В качестве альтернативы hello отработку отказа для одной виртуальной машины или физическом сервере можно запустить из hello **реплицируются элементы** страницы


![Отработка отказа](./media/site-recovery-failover/Failover.png)

1. Выберите **Планы восстановления** > *имя_плана_восстановления*. Щелкните **Отработка отказа**.
2. На hello **перехода на другой ресурс** выберите **точки восстановления** toofailover для. Можно использовать один из следующих вариантов hello:
    1.  **Последние** (по умолчанию): этот параметр, сначала обрабатывает все данные hello, был отправлен tooSite восстановления службы toocreate точку восстановления для каждой виртуальной машины до отказа tooit. Этот параметр обеспечивает hello наименьшее RPO (цель точки восстановления) как hello виртуальную машину, созданную после перехода на другой ресурс все данные hello, репликация службы восстановления tooSite при hello перехода на другой ресурс было запущено.
    1.  **Последняя версия обработки**: этот параметр при сбое все виртуальные машины hello восстановления плана toohello последней точки восстановления, уже был обработан службой Site Recovery. При выполнении тестовой отработки отказа виртуальной машины, также отображается отметка времени последней точки восстановления обработан hello. При выполнении отработки отказа плана восстановления, вы можете вернуться tooindividual виртуальной машины и просмотрите **последней точки восстановления** плитки tooget эти сведения. Как долго не tooprocess hello необработанных данных, этот параметр обеспечивает отработке отказа низкий RTO (цель времени восстановления).
    1.  **Последняя версия целостность приложений**: этот параметр при сбое все виртуальные машины hello плана toohello последние приложения восстановления, согласованной точки восстановления, уже был обработан службой Site Recovery. При выполнении тестовой отработки отказа виртуальной машины, также отображается отметка времени последней точки восстановления, согласованной приложения hello. При выполнении отработки отказа плана восстановления, вы можете вернуться tooindividual виртуальной машины и просмотрите **последней точки восстановления** плитки tooget эти сведения.
    1.  **Последняя обработанная точка нескольких виртуальных машин**. Этот параметр доступен только для планов восстановления, которые содержат по крайней мере одну виртуальную машину с поддержкой согласованности нескольких виртуальных машин. Виртуальные машины, которые являются частью репликации группы отказоустойчивого toohello последнюю общих нескольких виртуальных Машин восстановления, согласованной точки. Другие виртуальные машины отработки отказа tootheir последней обработанные точки восстановления.  
    1.  **Последняя согласованная с приложением точка нескольких виртуальных машин**. Этот параметр доступен только для планов восстановления, которые содержат по крайней мере одну виртуальную машину с поддержкой согласованности нескольких виртуальных машин. Виртуальные машины, которые являются частью репликации группы отказоустойчивого toohello последней общих нескольких виртуальных Машин согласованных с приложениями точки восстановления. Другие виртуальные машины отработки отказа tootheir последнюю согласованных с приложением точку восстановления.
    1.  **Настраиваемый**: при выполнении тестовой отработки отказа виртуальной машины, то можно использовать этот параметр toofailover tooa определенной точки восстановления.

    > [!NOTE]
    > параметр Hello toochoose точки восстановления доступен только при отработке отказа tooAzure.
    >
    >


1. Если некоторые hello виртуальных машин в плане восстановления hello были отработку отказа во время предыдущего запуска, и теперь hello виртуальные машины активны на исходном и целевом расположении, можно использовать **измените направление** toodecide направление hello в параметр должны быть выполнены hello отработку отказа.
1. Если отработка отказа tooAzure и включено шифрование данных для облака hello (применимо только в том случае, если вы защитили виртуальных машин Hyper-v с сервера VMM) в **ключ шифрования** hello выберите сертификат, выданный при вы включить шифрование данных во время установки на сервере VMM hello.
1. Выберите **завершить работу компьютера перед началом отработки отказа** Если toodo tooattempt Site Recovery выключение исходных виртуальных машин перед тем как запускать hello отработки отказа. Отработка отказа продолжится, даже если их не удастся отключить.  

    > [!NOTE]
    > В случае виртуальных машин Hyper-v этот параметр также помогает toosynchronize hello локальных данных имеет еще не были отправлены toohello службы перед тем как запускать hello перехода на другой ресурс.
    >
    >

1. Вы можете отслеживать ход аварийного переключения hello на hello **заданий** страницы. Даже в случае возникновения ошибки во время внеплановой отработки отказа плана восстановления hello выполняется до завершения.
1. После отработки отказа hello проверьте hello виртуальной машины, ведения журналов в tooit. Если требуется toogo другую точку восстановления для виртуальной машины hello, то можно использовать **изменить точку восстановления** параметр.
1. После проверки hello отработку отказа виртуальной машины можно **зафиксировать** hello отработки отказа. Это удаляет все точки восстановления hello, доступные со службой hello и **изменить точку восстановления** параметр больше не будут доступны.

## <a name="planned-failover"></a>Плановая отработка отказа
Помимо отработки отказа, для виртуальных машин Hyper-V, защищенных с помощью Site Recovery, доступен вариант **Плановая отработка отказа**. В этом варианте потеря данных исключается. После запуска плановой отработки отказа сначала hello исходной виртуальной машины завершения, hello данных еще toobe синхронизации синхронизируется и затем запускается отработка отказа.

> [!NOTE]
> Когда вы отработки отказа Hyper-v виртуальных машин с одного локального сайта tooanother локальных узлов, toocome задней toohello основного локального имеют toofirst **обратную репликацию** сайта задней tooprimary hello виртуальной машины и Затем создаются для отработки отказа. Если основная виртуальная машина hello недоступен, затем еще до запуска слишком**обратную репликацию** у вас есть toorestore hello виртуальной машины из резервной копии.   
>
>

## <a name="failover-job"></a>Задание отработки отказа

![Отработка отказа](./media/site-recovery-failover/FailoverJob.png)

Выполнение отработки отказа включает следующие этапы.

1. Проверка необходимых компонентов. На этом этапе вы проверяете, соблюдены ли все условия, необходимые для отработки отказа.
1. Отработка отказа: Этот шаг обрабатывает данные hello и делает все готово для создания виртуальной машине Azure вне его. Если вы выбрали **последнюю** точку восстановления, этот шаг создает точку восстановления из данных hello, которое было отправлено toohello службы.
1. Начало: На этом шаге создается виртуальная машина Azure с помощью обработки в предыдущем шаге hello данных hello.

> [!WARNING]
> **Не отменять выполняемое отработки отказа**: перед запуском отработки отказа репликации для виртуальной машины hello остановлена. Если вы **отменить** в задании выполняется переход на другой ресурс останавливается, но hello виртуальной машины не запустится tooreplicate. Репликацию невозможно запустить повторно.
>
>

## <a name="time-taken-for-failover-tooazure"></a>Время, затраченное tooAzure отработки отказа

В некоторых случаях отработки отказа виртуальных машин требуется дополнительный промежуточного шага, обычно занимает около 8 toocomplete too10 минут. Эти случаи перечислены ниже:

* виртуальные машины VMware, использующие службу Mobility Service версии ниже 9.8;
* физические серверы; 
* виртуальные машины VMware на платформе Linux;
* виртуальные машины Hyper-V, защищенные как физические серверы;
* виртуальные машины VMware, на которых отсутствуют следующие драйверы в качестве драйверов загрузки: 
    * storvsc; 
    * vmbus; 
    * storflt; 
    * intelide; 
    * atapi;
* виртуальные машины VMware, на которых не включена служба DHCP, вне зависимости от того, используется протокол DHCP или статические IP-адреса.

В hello всех остальных случаях этот промежуточный шаг не требуется и hello время, необходимое для отработки отказа hello значительно ниже. 





## <a name="using-scripts-in-failover"></a>Использование скриптов при отработке отказа
Может потребоваться tooautomate определенные действия во время выполнения отработки отказа. Можно использовать скрипты или [модулей Azure automation Runbook](site-recovery-runbook-automation.md) в [планы восстановления](site-recovery-create-recovery-plans.md) toodo.

## <a name="other-considerations"></a>Дополнительные рекомендации
* **Буква диска** — буква диска hello tooretain на виртуальных машинах после отработки отказа можно задать hello **политики SAN** для hello виртуальной машины слишком**OnlineAll**. [Подробная информация](https://support.microsoft.com/en-us/help/3031135/how-to-preserve-the-drive-letter-for-protected-virtual-machines-that-are-failed-over-or-migrated-to-azure).



## <a name="next-steps"></a>Дальнейшие действия
После перехода виртуальных машин и hello центра обработки данных в локальной среде, следует [ **повторно защитить** ](site-recovery-how-to-reprotect.md) виртуальных машин VMware резервное toohello центра обработки данных в локальной среде.

Используйте [ **Плановая отработка отказа** ](site-recovery-failback-from-azure-to-hyper-v.md) параметр слишком**восстановления размещения** виртуальных машин Hyper-v резервной локальной tooon из Azure.

Если произошел сбой данными локальной tooanother виртуальной машины Hyper-v доступен center под управлением VMM server и hello основной центр обработки данных, затем с помощью **обратная репликация** toohello обратной репликации hello toostart параметр основного центра обработки данных.
