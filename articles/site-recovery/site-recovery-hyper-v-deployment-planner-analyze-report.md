---
title: "Планировщик развертывания Azure Site Recovery для развертывания виртуальных машин Hyper-V в Azure | Документация Майкрософт"
description: "В этой статье описывается, как анализировать созданный отчет планировщика развертывания Azure Site Recovery для сценария развертывания Hyper-V в Azure."
services: site-recovery
documentationcenter: 
author: nsoneji
manager: garavd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 12/02/2017
ms.author: nisoneji
ms.openlocfilehash: 9340fe48c1da874d6c0cf02c026e5dec6ddabbe7
ms.sourcegitcommit: 357afe80eae48e14dffdd51224c863c898303449
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/15/2017
---
# <a name="analyze-the-azure-site-recovery-deployment-planner-report"></a>Анализ отчета планировщика развертывания Azure Site Recovery
Созданный отчет Microsoft Excel содержит следующие листы.

## <a name="on-premises-summary"></a>Сводка по локальной инфраструктуре
На листе On-premises summary (Сводка по локальной инфраструктуре) содержатся общие сведения о профилированной среде Hyper-V. ![сводка по локальной инфраструктуре](media/site-recovery-hyper-v-deployment-planner-analyze-report/on-premises-summary-h2a.png)

**Дата начала** и **Дата окончания** — даты начала и окончания профилирования данных, используемых при создании отчета. По умолчанию "Дата начала" — это дата начала профилирования, а "Дата окончания" — это дата окончания. При создании отчета с этими параметрами им соответствуют значения StartDate и EndDate.

**Total number of profiling days** (Общее число дней профилирования) — общее число дней профилирования между датами начала и окончания, для которых создается отчет.

**Number of compatible virtual machines** (Число совместимых виртуальных машин) — это общее число совместимых виртуальных машин, использующих пропускную способность сети, а также необходимое число учетных записей хранения и ядер Microsoft Azure.

**Total number of disks across all compatible virtual machines** (Общее число дисков на всех совместимых виртуальных машинах) — общее число дисков на всех совместимых виртуальных машинах.

**Average number of disks per compatible virtual machine** (Среднее число дисков на каждой совместимой виртуальной машине) — среднее число дисков, вычисленное для всех совместимых виртуальных машин.

**Average disk size (GB)** (Средний размер диска (ГБ)) — средний размер диска, вычисленный для всех совместимых виртуальных машин.

**Desired RPO (minutes)** (Требуемое значение RPO (в минутах)) — значение целевой точки восстановления по умолчанию или значение, заданное для параметра DesiredRPO во время создания отчета для оценки необходимой пропускной способности.

**Desired bandwidth (Mbps)** (Необходимая пропускная способность (Мбит/с)) — значение, заданное для параметра Bandwidth во время создания отчета для оценки достигаемого значения RPO.

**Observed typical data churn per day (GB)** (Стандартная активность обработки данных в день (ГБ)) — среднее значение обработки данных в течение профилирования.

## <a name="recommendations"></a>Рекомендации  
Лист рекомендаций отчета по развертыванию Hyper-V в Azure содержит следующие сведения с учетом выбранного требуемого значения RPO.

![Рекомендации для отчета по развертыванию VMware в Azure](media/site-recovery-hyper-v-deployment-planner-analyze-report/Recommendations-h2a.png)

### <a name="profile-data"></a>Данные профиля
![Данные профиля](media/site-recovery-hyper-v-deployment-planner-analyze-report/profile-data-h2a.png)

**Profiled data period** (Период профилирования данных) — длительность выполнения профилирования. По умолчанию программа использует для вычисления все данные профилирования, за исключением случаев, когда создается отчет для определенного периода времени с использованием параметров StartDate и EndDate. 

**Number of Hyper-V servers profiled** (Число профилированных серверов Hyper-V) — количество серверов Hyper-V, по виртуальным машинам которых создается отчет. Щелкните число, чтобы увидеть имя сервера Hyper-V. После этого открывается лист с требованиями к локальному хранилищу, где перечислены все серверы с требованиями к хранилищу.    

**Desired RPO** (Требуемое значение RPO) — значение целевой точки восстановления для развертывания. По умолчанию необходимая пропускная способность рассчитывается для значений RPO, равных 15, 30 и 60 минутам. В зависимости от выбора в отчете обновляются затронутые значения. Если во время создания отчета вы использовали параметр DesiredRPOinMin, это значение отображается в результатах по параметру Desired RPO (Требуемое значение RPO).

### <a name="profiling-overview"></a>Общие сведения о профилировании
![Общие сведения о профилировании](media/site-recovery-hyper-v-deployment-planner-analyze-report/profiling-overview-h2a.png)

**Total Profiled Virtual Machines** (Общее число профилированных виртуальных машин) — общее количество виртуальных машин, данные профилирования которых доступны. Если в качестве значений параметра VMListFile заданы виртуальные машины, профилирование которых не выполнялось, они не учитываются при создании отчета и исключаются из общего числа профилированных виртуальных машин.

**Compatible Virtual Machines** (Совместимые виртуальные машины) — число виртуальных машин, которые можно защитить с помощью Azure Site Recovery. Это общее количество совместимых виртуальных машин, для которых вычисляется необходимая пропускная способность сети, количество учетных записей хранения, число ядер в Azure. Сведения о каждой совместимой виртуальной машине см. в соответствующем разделе.

**Incompatible Virtual Machines** (Несовместимые виртуальные машины) — число виртуальных машин, которые нельзя защитить с помощью Azure Site Recovery. Причины несовместимости см. в разделе "Несовместимые виртуальные машины". Если в качестве значений параметра VMListFile заданы виртуальные машины, профилирование которых не выполнялось, они исключаются из общего числа несовместимых виртуальных машин. Эти виртуальные машины перечислены в списке Data not found (Данные не найдены) в нижней части раздела Incompatible Virtual Machines (Несовместимые виртуальные машины).

**Desired RPO** (Требуемое значение RPO) — требуемая целевая точка восстановления в минутах. Отчет создается на основе трех значений RPO: 15, 30 и 60 минут. Рекомендации относительно пропускной способности изменяются в отчете в зависимости от значения, выбранного в раскрывающемся списке Desired RPO (Требуемое значение RPO). Этот список расположен в верхнем правом углу страницы. Если при создании отчета вы использовали другое значение параметра -DesiredRPO, оно будет отображаться в этом раскрывающемся списке в качестве значения по умолчанию.

### <a name="required-network-bandwidth-mbps"></a>Требуемая пропускная способность сети (Мбит/с)
![Требуемая пропускная способность сети](media/site-recovery-hyper-v-deployment-planner-analyze-report/required-network-bandwidth-h2a.png)

**To meet RPO 100 percent of the time** (Соблюдение требований к RPO 100 % времени). Рекомендуемая пропускная способность (в Мбит/с), необходимая для соблюдения требований к RPO в 100 % случаев. Это объем пропускной способности, необходимый для разностной репликации в устойчивом состоянии всех совместимых виртуальных машин, чтобы избежать каких-либо нарушений требований к RPO.

**To meet RPO 90 percent of the time** (Соблюдение требований к RPO 90 % времени). Из-за цены на высокоскоростное подключение или по какой-либо другой причине, когда вы не можете установить объем пропускной способности, необходимый для соблюдения требований к RPO в 100 % случаев, вы можете установить меньший объем пропускной способности, необходимый для соблюдения требований к RPO в 90 % случаев. Чтобы оценить влияние установки меньшего объема, в отчете можно просмотреть сведения о возможном количестве нарушений требований к RPO и их продолжительности.

**Achieved Throughput** (Достигнутая пропускная способность) — это пропускная способность сервера, на котором вы выполнили команду GetThroughput, доступная для региона Azure, где расположена учетная запись хранения. Это значение указывает примерную пропускную способность, которой можно достичь при защите совместимых виртуальных машин с помощью Azure Site Recovery при условии, что характеристики хранилища и сети сервера Hyper-V такие же, как и на сервере, на котором вы запустили программу.

Для всех развертываний Azure Site Recovery в корпоративных средах мы рекомендуем использовать [ExpressRoute](https://aka.ms/expressroute).

### <a name="required-storage-accounts"></a>Диаграмма Required Azure Storage Accounts (Требуемые учетные записи хранения Azure)
На следующей диаграмме показано общее число учетных записей хранения Azure (уровня Standard и Premium), необходимых для защиты всех совместимых виртуальных машин. Чтобы узнать, какую учетную запись хранения необходимо использовать для каждой виртуальной машины, см. раздел "Размещение хранилища виртуальной машины".

![Диаграмма Required Azure Storage Accounts (Требуемые учетные записи хранения Azure)](media/site-recovery-hyper-v-deployment-planner-analyze-report/required-storage-accounts-h2a.png)

### <a name="required-number-of-azure-cores"></a>Область Required Number of Azure Cores (Необходимое число ядер Azure)
Это значение указывает на общее число ядер, которое необходимо задать перед отработкой отказа (или тестовой отработкой отказа) всех совместимых виртуальных машин. Если в подписке доступно слишком мало ядер, Azure Site Recovery не сможет создать виртуальные машины и этот процесс завершится сбоем во время отработки отказа (или тестовой отработки отказа).
![Область Required Number of Azure Cores (Необходимое число ядер Azure)](media/site-recovery-hyper-v-deployment-planner-analyze-report/required-number-of-azure-cores-h2a.png)


### <a name="additional-on-premises-storage-requirement"></a>Дополнительные требования к локальному хранилищу

Обеспечьте наличие общего свободного пространства хранения на серверах Hyper-V для успешной начальной и разностной репликации. Это позволит избежать нежелательных простоев при репликации виртуальных машин. Подробную информацию о требованиях к каждому тому см. в разделе [требований к локальному хранилищу](#on-premises-storage-requirement). 

Сведения о том, зачем нужно свободное пространство для репликации, см. [здесь](#why-do-i-need-free-space-on-the-hyper-v-server-for-the-replication).

![требования к локальному хранилищу и частота копирования](media/site-recovery-hyper-v-deployment-planner-analyze-report/on-premises-storage-and-copy-frequency-h2a.png)

### <a name="maximum-copy-frequency"></a>Максимальная частота копирования
Для достижения нужного значения RPO при репликации нужно настроить рекомендуемую максимальную частоту копирования. Значение по умолчанию — 5 минут. Для оптимизации RPO можно настроить частоту копирования 30 секунд.

### <a name="what-if-analysis"></a>Анализ "что если"
![Анализ "что если"](media/site-recovery-hyper-v-deployment-planner-analyze-report/what-if-analysis-h2a.png) В этом анализе отображаются сведения о возможном количестве нарушений, которые могут произойти в процессе профилирования при установке меньшего объема пропускной способности, необходимой для соблюдения требований к RPO только в 90 % случаев. Это может быть одно или несколько нарушений, которые могут произойти в любой заданный день. На диаграмме показано максимальное значение RPO за день. По результатам анализа вы можете определить, допустимо ли количество нарушений требований к RPO за все время и максимальное значение RPO за день для выделенного объема пропускной способности. В зависимости от результатов вы можете выделить меньший объем пропускной способности для репликации или повысить ее пределы для соблюдения требований к RPO в 100 % случаев. 

### <a name="recommendation-for-successful-initial-replication"></a>Рекомендации для успешной начальной репликации
В этом разделе приведено рекомендуемое количество пакетов, в которых указаны виртуальные машины для защиты, и минимальная пропускная способность, необходимая для успешной начальной репликации (IR). 

![Пакетная обработка IR](media/site-recovery-hyper-v-deployment-planner-analyze-report/ir-batching-h2a.png)

Защита виртуальных машин должна обеспечиваться в порядке пакетов. Каждый пакет имеет определенный список виртуальных машин. Сначала следует обеспечить защиту виртуальных машин из пакета 1, затем из пакета 2, пакета 3 и т. д. После завершения начальной репликации виртуальных машин пакета 1 можно включить ее для виртуальных машин пакета 2, а затем для виртуальных машин пакета 3 и т. д. При несоблюдении порядка следования пакетов во время начальной репликации виртуальных машин, защита которых обеспечивается позже, может быть недостаточно пропускной способности. В результате не удастся выполнить начальную репликацию виртуальных машин или несколько защищенных виртуальных машин могут перейти в режим повторной синхронизации. Для пакетной обработки IR в выбранном листе RPO содержатся подробные сведения о том, какие виртуальные машины должны находиться в каждом пакете.

На диаграмме ниже показаны сведения о распределении пропускной способности для начальной и разностной репликации между пакетами в заданном порядке. При защите виртуальных машин первого пакета для начальной репликации доступна вся пропускная способность. После начальной репликации первого пакета часть пропускной способности потребуется для разностной репликации. Оставшаяся часть пропускной способности будет доступна для начальной репликации виртуальных машин второго пакета. В строке пакета 2 показана требуемая пропускная способность для разностной репликации виртуальных машин пакета 1 и пропускная способность, доступная для начальной репликации виртуальных машин пакета 2. Аналогичным образом в строке 3 показана пропускная способность, необходимая для разностной репликации предыдущих пакетов (виртуальные машины пакета 1 и 2), и пропускная способность, доступная для начальной репликации пакета 3 и т. д.  После начальной репликации всех пакетов в последней строке отображается пропускная способность, необходимая для разностной репликации всех защищенных виртуальных машин. 

**Зачем нужна пакетная обработка начальной репликации?**
Время выполнения начальной репликации зависит от фактического размера диска виртуальной машины, используемого дискового пространства и доступной пропускной способности сети. Подробную информацию можно найти в таблице пакетной обработки IR на выбранном листе RPO.

### <a name="cost-estimation"></a>Оценка затрат
На следующих диаграммах представлена сводка общих затрат на аварийное восстановление (DR) в Azure для выбранного целевого региона и валюты, которые вы указали при создании отчета:
![Результаты оценки затрат.](media/site-recovery-hyper-v-deployment-planner-analyze-report/cost-estimation-summary-h2a.png) Сводка поможет вам составить представление о расходах на хранилище, вычислительные ресурсы, сеть и лицензию при защите всех совместимых виртуальных машин в Azure с помощью Azure Site Recovery. Затраты рассчитываются только для совместимых, а не для всех профилируемых виртуальных машин.  
 
Можно просмотреть расходы за месяц или за год. Узнайте больше о поддерживаемых [целевых регионах](./site-recovery-hyper-v-deployment-planner-cost-estimation.md#supported-target-regions) и [валютах](./site-recovery-hyper-v-deployment-planner-cost-estimation.md#supported-currencies).

**Cost by components** (Затраты по составляющим). Расходы на аварийное восстановление разделены на четыре составляющие: стоимость вычислительных ресурсов, хранилища, сети и лицензии Azure Site Recovery. Затраты рассчитываются на основе данных потребления при репликации и тестировании DR. Сюда входит стоимость вычислительных ресурсов, хранилища (классы Premium и Standard), подключения ExpressRoute или VPN, настроенного между локальной средой и Azure, а также лицензии Azure Site Recovery.

**Cost by states** (Затраты по состояниям). Общие расходы на аварийное восстановление (DR) рассчитываются на основе двух состояний: репликации и тестирования DR. 

**Replication cost** (Затраты на репликацию). Стоимость репликации. Сюда входит стоимость хранилища, сети и лицензии Azure Site Recovery. 

**DR-Drill cost** (Затраты на тестирование DR). Стоимость тестовой отработки отказа. Azure Site Recovery запускает виртуальные машины при тестовой отработке отказа. Затраты на тестирование DR включают расходы на вычислительные ресурсы и хранилище для работающих виртуальных машин. 

**Azure storage cost per Month/Year** (Месячные или годовые затраты на хранилище). Это общие расходы на хранилище классов Premium и Standard при репликации и тестировании DR.
Подробный анализ затрат на виртуальную машину см. на листе [оценки затрат](site-recovery-hyper-v-deployment-planner-cost-estimation.md).

### <a name="growth-factor-and-percentile-values-used"></a>Коэффициент роста и используемые значения процентилей
Этот раздел находится в нижней части страницы. В нем содержатся сведения о значении процентиля, используемом для всех счетчиков производительности профилированных виртуальных машин (по умолчанию 95-й процентиль), а также о коэффициенте роста, используемом во всех вычислениях (по умолчанию — 30 %).

![Коэффициент роста и используемые значения процентилей](media/site-recovery-hyper-v-deployment-planner-run/growth-factor-max-percentile-value.png)

## <a name="recommendations-with-available-bandwidth-as-input"></a>Рекомендации по вводу значения доступной пропускной способности
![Общие сведения о профилировании и ввод значения пропускной способности](media/site-recovery-hyper-v-deployment-planner-analyze-report/profiling-overview-bandwidth-input-h2a.png)

Возможны ситуации, когда вы не сможете установить для репликации Azure Site Recovery достаточный объем пропускной способности. Эта программа позволяет вам во время создания отчета ввести значение доступной пропускной способности (с помощью параметра -Bandwidth) и получить достигаемое значение RPO в минутах. На основе полученного значения вы можете определить, нужно ли подготовить дополнительный объем пропускной способности или можно просто создать решение для аварийного восстановления.

![Достигаемое значение RPO](media/site-recovery-hyper-v-deployment-planner-analyze-report/achivable-rpo-h2a.PNG)

## <a name="vm-storage-placement-recommendation"></a>Рекомендация по размещению хранилища виртуальных машин 

![Размещение хранилища виртуальной машины](media/site-recovery-hyper-v-deployment-planner-analyze-report/vm-storage-placement-h2a.png)

**Disk Storage Type** (Тип хранилища дисков) — учетная запись хранения уровня Standard или Premium, используемая для репликации всех соответствующих виртуальных машин, указанных в столбце **VMs to Place** (Виртуальные машины для размещения).

**Suggested Prefix** (Рекомендуемый префикс) — префикс из трех знаков, который можно использовать для создания имени учетной записи хранения. Вы можете использовать собственный префикс, но для программы мы рекомендуем использовать префикс, соответствующий требованиям [соглашения об именовании секций учетных записей хранения](https://aka.ms/storage-performance-checklist).

**Suggested Account Name** (Рекомендуемое имя учетной записи) — имя учетной записи хранения после добавления рекомендуемого префикса. Замените имя в угловых скобках (< и >) именем своей учетной записи.

**Log Storage Account** (Учетная запись хранения журналов). Все журналы репликации хранятся в учетной записи хранения уровня Standard. Если репликация виртуальных машин выполняется в учетную запись хранения уровня Premium, для хранения журналов необходимо настроить дополнительную учетную запись уровня Standard. Одна учетная запись хранения журналов уровня Standard может использоваться несколькими учетными записями хранения репликации уровня Premium. Виртуальные машины, реплицированные в учетные записи хранения уровня Standard, используют ту же учетную запись хранения для журналов.

**Suggested Log Account Name** (Рекомендуемое имя учетной записи) — имя учетной записи хранения журналов после добавления рекомендуемого префикса. Замените имя в угловых скобках (< и >) именем своей учетной записи.

**Placement Summary** (Сводка размещения) — сводные данные об общем числе виртуальных машин, переданных в учетную запись хранения во время репликации и отработки отказа (или тестовой отработки отказа). В этом столбце содержатся сведения об общем числе виртуальных машин, сопоставленных с учетной записью хранения, общем количестве операций записи и чтения на диск в секунду на всех виртуальных машинах, размещенных в этой учетной записи, общем количестве операций ввода-вывода в секунду при записи (репликации), общем объеме установленного пространства на всех дисках и общем числе дисков.

В столбце **Virtual Machines to Place** (Виртуальные машины для размещения) перечислены все виртуальные машины, которые необходимо поместить в определенную учетную запись хранения для обеспечения оптимальной производительности и эффективного использования.

## <a name="compatible-vms"></a>Совместимые виртуальные машины
В отчете Microsoft Excel, созданном с помощью планировщика развертывания Azure Site Recovery, сведения обо всех совместимых виртуальных машинах содержатся на листе Compatible VMs (Совместимые виртуальные машины).

![Совместимые виртуальные машины](media/site-recovery-hyper-v-deployment-planner-analyze-report/compatible-vms-h2a.png)

**Имя виртуальной машины** — имя виртуальной машины, заданное в качестве значения параметра VMListFile во время создания отчета. В этом столбце также перечислены диски (VHD-файлы), присоединенные к виртуальным машинам. Имена включают имена узлов Hyper-V, на которых были размещены виртуальные машины, при их обнаружении средством во время профилирования.

Параметр **VM Compatibility** (Совместимость виртуальной машины) имеет два значения: **Да** и **Да**\*. Значение **Да**\* используется в тех случаях, когда виртуальная машина подготавливается для [хранилища Azure класса Premium](https://aka.ms/premium-storage-workload). Здесь для профилированного диска с быстро изменяющимися данными или операциями ввода-вывода настраивается диск класса Premium большего размера, чем сопоставленный с ним. Служба хранилища Azure определяет, с каким типом диска хранилища класса Premium сопоставить диск виртуальной машины на основе его размера. 
* если емкость диска составляет меньше 128 ГБ, он сопоставляется с категорией P10;
* если емкость диска составляет от 128 до 256 ГБ, он сопоставляется с категорией P15;
* если емкость диска составляет от 256 до 512 ГБ, он сопоставляется с категорией P20;
* если емкость диска составляет от 512 до 1024 ГБ, он сопоставляется с категорией P30;
* если емкость диска составляет от 1025 до 2048 ГБ, он сопоставляется с категорией P40;
* если емкость диска составляет от 2049 до 4095 ГБ, он сопоставляется с категорией P50.

Например, если из-за характеристик рабочей нагрузки диска виртуальная машина подпадает под категорию P20 или P30, но из-за своего размера этот диск сопоставляется с типом диска хранилища класса Premium более низкой категории, программа добавляет к этой виртуальной машине метку **Да**\*. и рекомендует вам либо изменить размер исходного диска для соответствия рекомендуемому типу диска хранилища класса Premium, либо изменить тип целевого диска после отработки отказа.

**Тип хранилища** — Standard или Premium.

**Suggested Prefix** (Рекомендуемый префикс) — префикс имени учетной записи хранения, состоящий из трех знаков.

**Учетная запись хранения** — имя, к которому добавляется рекомендуемый префикс.

**Peak R/W IOPS (with Growth Factor)** (Пиковое количество операций записи и чтения на диск в секунду (с коэффициентом роста)) — пиковое значение числа операций ввода-вывода в секунду при чтении и записи на диске (95-й процентиль), включая будущий коэффициент роста (по умолчанию — 30 %). Обратите внимание, что общее число операций записи и чтения на диск в секунду не всегда вычисляется путем сложения операций записи и чтения каждого отдельного диска виртуальной машины, так как максимальное число операций записи и чтения в секунду виртуальной машины состоит из максимальных значений каждого отдельного диска в течение каждой минуты процесса профилирования.

**Peak Data Churn in MB/s (with Growth Factor)** (Пиковая активность обработки данных на диске в МБ/с (с коэффициентом роста)) — пиковая скорость обработки данных на диске (95-й процентиль), включая будущий коэффициент роста (по умолчанию — 30 %). Обратите внимание, что общая скорость обработки данных виртуальной машины не всегда вычисляется путем сложения скорости обработки данных на каждом ее отдельном диске, так как максимальная скорость обработки данных виртуальной машины состоит из максимальных значений обработки на каждом отдельном диске в течение каждой минуты процесса профилирования.

**Azure VM Size** (Размер виртуальной машины Azure) — размер виртуальной машины облачных служб Azure, который лучше всего использовать для сопоставления с локальной виртуальной машиной. Это сопоставление выполняется на основе памяти, числа дисков, ядер, сетевых карт и операций записи и чтения на диск в секунду локальной виртуальной машины. Мы рекомендуем всегда использовать виртуальную машину Azure наименьшего размера, характеристики которой соответствуют всем этим характеристикам локальной виртуальной машины.

**Количество дисков** — общее количество дисков (VHD-файлов) на виртуальной машине.

**Размер диска (ГБ)** — общий размер всех дисков виртуальной машины. Эта программа также показывает размер каждого отдельного диска виртуальной машины.

**Ядра** — количество ядер ЦП на виртуальной машине.

**Память (МБ)** — ОЗУ виртуальной машины.

**Сетевые карты** — количество сетевых карт на виртуальной машине.

**Тип загрузки** — тип загрузки виртуальной машины (BIOS или EFI).

## <a name="incompatible-vms"></a>Несовместимые виртуальные машины
В отчете Microsoft Excel, созданном с помощью планировщика развертывания Azure Site Recovery, сведения обо всех несовместимых виртуальных машинах содержатся на листе Incompatible VMs (Несовместимые виртуальные машины).

![Несовместимые виртуальные машины](media/site-recovery-hyper-v-deployment-planner-analyze-report/incompatible-vms-h2a.png)

**Имя виртуальной машины** — имя виртуальной машины, заданное в качестве значения параметра VMListFile во время создания отчета. В этом столбце также перечислены диски (VHD-файлы), присоединенные к виртуальным машинам. Имена включают имена узлов Hyper-V, на которых были размещены виртуальные машины, при их обнаружении средством во время профилирования.

Параметр **VM Compatibility** (Совместимость виртуальной машины) указывает, почему определенная виртуальная машина не поддерживает Site Recovery. Причины приводятся для каждого несовместимого диска виртуальной машины, и в зависимости от опубликованных [ограничений хранилища](https://aka.ms/azure-storage-scalbility-performance) эта проблема может быть вызвана следующим:

* Размер диска превышает 4095 ГБ. Сейчас служба хранилища Azure не поддерживает диски данных емкостью более 4095 ГБ.

* Размер диска ОС превышает 2047 ГБ для виртуальной машины поколения 1 (тип загрузки BIOS).  Azure Site Recovery не поддерживает размер диска ОС, превышающий 2047 ГБ, для виртуальных машин поколения 1.

* Размер диска ОС превышает 300 ГБ для виртуальной машины поколения 2 (тип загрузки EFI). Azure Site Recovery не поддерживает размер диска ОС, превышающий 300 ГБ, для виртуальных машин поколения 2.

* Не поддерживается имя виртуальной машины с любым из следующих символов: “” [] `.  Средству не удастся получить профилируемые данные виртуальных машин, в именах которых содержатся такие символы. 

* Виртуальный жесткий диск совместно используется двумя или более виртуальными машинами. Azure не поддерживает виртуальные машины с общим виртуальным жестким диском.

* Виртуальная машина с виртуальным подключением Fibre Channel не поддерживается. Azure Site Recovery не поддерживает виртуальные машины с виртуальным подключением Fibre Channel.

* В кластере Hyper-V нет брокера репликации. Azure Site Recovery не поддерживает виртуальную машину в кластере Hyper-V, для которого не настроена реплика брокера Hyper-V.

* Виртуальная машина не обеспечивает высокую доступность. Azure Site Recovery не поддерживает виртуальную машину в узле кластера Hyper-V, виртуальные жесткие диски которой хранятся на локальном диске, а не на диске кластера. 

* Общий размер виртуальной машины (репликация и тестовая отработка отказа) превышает поддерживаемый размер учетной записи хранения уровня "Премиум" (35 ТБ). Это обычно происходит на виртуальных машинах с одним диском, показатели производительности которого превышают максимально поддерживаемые ограничения Microsoft Azure или Azure Site Recovery для хранилища класса Standard, используемого для отправки виртуальной машины в зону хранилища класса Premium. Однако максимальный поддерживаемый размер учетной записи хранения класса Premium составляет 35 ТБ, и поэтому невозможно обеспечить защиту одной виртуальной машины в нескольких учетных записях хранения. Кроме того, обратите внимание, что если тестовая отработка отказа выполняется на защищенной виртуальной машине и для отработки отказа настроен неуправляемый диск, этот процесс происходит в той же учетной записи хранения, где выполняется репликация. В этом случае требуется выделить такой же дополнительный объем дискового пространства, что и для репликации. При этом обеспечивается выполнение репликации и успешная параллельная тестовая отработка отказа. При настройке управляемого диска для тестовой отработки отказа дополнительное пространство для виртуальной машины, используемой для тестовой отработки, не требуется.

* Число операций ввода-вывода в секунду источника превышает поддерживаемое хранилищем ограничение в 7500 операций ввода-вывода в секунду на диск.

* Число операций ввода-вывода в секунду источника превышает поддерживаемое хранилищем ограничение в 80 000 операций ввода-вывода в секунду на виртуальную машину.

* Среднее значение скорости обработки данных на исходной виртуальной машине превышает поддерживаемое Azure Site Recovery ограничение в 10 МБ/с для среднего объема ввода-вывода.

* Среднее эффективное значение количества операций ввода-вывода в секунду на исходной виртуальной машине при записи превышает поддерживаемое Azure Site Recovery ограничение в 840 операций.

* Вычисленный объем хранилища моментальных снимков превышает поддерживаемое ограничение в 10 ТБ.

**Peak R/W IOPS (with Growth Factor)** (Пиковое Количество операций записи и чтения на диск в секунду (с коэффициентом роста)) — пиковое значение числа операций ввода-вывода в секунду на диске (95-й процентиль), включая будущий коэффициент роста (по умолчанию — 30 %). Обратите внимание, что общее число операций записи и чтения на диск в секунду не всегда вычисляется путем сложения операций записи и чтения каждого отдельного диска виртуальной машины, так как максимальное число операций записи и чтения в секунду виртуальной машины состоит из максимальных значений каждого отдельного диска в течение каждой минуты процесса профилирования.

**Peak Data Churn in MB/s (with Growth Factor)** (Пиковая активность обработки данных на диске в МБ/с (с коэффициентом роста)) — пиковая скорость обработки данных на диске (95-й процентиль), включая будущий коэффициент роста (по умолчанию — 30 %). Обратите внимание, что общая скорость обработки данных виртуальной машины не всегда вычисляется путем сложения скорости обработки данных на каждом ее отдельном диске, так как максимальная скорость обработки данных виртуальной машины состоит из максимальных значений обработки на каждом отдельном диске в течение каждой минуты процесса профилирования.

**Количество дисков** — общее количество виртуальных жестких дисков на виртуальной машине.

**Размер диска (ГБ)** — общий размер, настроенный на всех дисках виртуальной машины. Эта программа также показывает размер каждого отдельного диска виртуальной машины.

**Ядра** — количество ядер ЦП на виртуальной машине.

**Память (МБ)** — объем ОЗУ виртуальной машины.

**Сетевые карты** — количество сетевых карт на виртуальной машине.

**Тип загрузки** — тип загрузки виртуальной машины (BIOS или EFI).

## <a name="azure-site-recovery-limits"></a>Ограничения Azure Site Recovery
В таблице ниже приведены ограничения Azure Site Recovery. Эти ограничения получены на основе наших проверок, но они не охватывают все возможные сочетания операций ввода-вывода в приложении. Фактические результаты зависят от сочетания операций ввода-вывода приложения. Чтобы получить более точные сведения о производительности приложения, мы рекомендуем всегда выполнять расширенное тестирование приложения с помощью тестовой отработки отказа.
 
**Целевое хранилище репликации** | **Средний объем ввода-вывода на исходной виртуальной машине** |**Среднее значение скорости обработки данных на исходной виртуальной машине** | **Общий размер обработанных данных на исходной виртуальной машине за день**
---|---|---|---
Хранилище уровня "Стандартный" | 8 КБ | 2 МБ/с на виртуальную машину | 168 ГБ на виртуальную машину
Хранилище уровня "Премиум" | 8 КБ  | 5 МБ/с на виртуальную машину | 421 ГБ на виртуальную машину
Хранилище уровня "Премиум" | 16 КБ или выше| 10 МБ/с на виртуальную машину | 842 ГБ на виртуальную машину

В указанных ограничениях по средним значениям предполагается 30-процентное перекрытие операций ввода-вывода. В зависимости от коэффициента перекрытия, размера записи и фактической рабочей нагрузки ввода-вывода Azure Site Recovery может обрабатывать более высокую пропускную способность. В приведенных выше значениях предполагается, что длина очереди невыполненной работы составляет примерно 5 минут, то есть после передачи выполняется обработка данных, а созданная точка восстановления составляет 5 минут.

## <a name="on-premises-storage-requirement"></a>Требования к локальному хранилищу

На листе содержится требование к общему свободному пространству для хранения для каждого тома серверов Hyper-V (где находятся виртуальные жесткие диски) для успешной начальной и разностной репликации. Перед включением репликации добавьте необходимое дисковое пространство в томах, чтобы убедиться, что репликация не вызовет нежелательных простоев рабочих приложений. 

Планировщик развертывания Azure Site Recovery определяет требование к оптимальному объему для хранения, исходя из размера виртуальных жестких дисков и пропускной способности сети, используемой для репликации.

![требования к локальному хранилищу](media/site-recovery-hyper-v-deployment-planner-analyze-report/on-premises-storage-requirement-h2a.png)

### <a name="why-do-i-need-free-space-on-the-hyper-v-server-for-the-replication"></a>Почему необходимо свободное место на сервере Hyper-V для репликации?
* При включении репликации виртуальной машины Azure Site Recovery создает моментальный снимок каждого виртуального жесткого диска виртуальной машины для начальной репликации (IR). Во время начальной репликации приложение записывает новые изменения на диски. Azure Site Recovery отслеживает эти изменения в файлах журналов, которые требуют дополнительного пространства.  До завершения начальной репликации файлы журнала хранятся локально. Если недостаточно места для файлов журнала и моментальных снимков (AVHDX), репликация перейдет в режим повторной синхронизации и никогда не завершится. В худшем случае для начальной репликации потребуется 100 % дополнительного свободного пространства с учетом размера виртуального жесткого диска.
* После начальной репликации запускается разностная репликация. Azure Site Recovery отслеживает эти изменения в файлы журналов, которые хранятся на томе, где находятся виртуальные жесткие диски виртуальной машины. Эти файлы журналов реплицируются в Azure с периодичностью, настроенной для копирования. Исходя из доступной пропускной способности, репликация файлов журналов в Azure занимает некоторое время. Если недостаточно свободного места для хранения файлов журнала, репликация будет приостановлена, а состояние репликации виртуальной машины изменится на повторную синхронизацию (требуемое состояние).
* Если пропускной способности сети недостаточно для отправки файлов журналов в Azure, они накапливаются на томе. В худшем случае, если файлы журналов занимают 50 % от размера виртуального жесткого диска, репликация виртуальной машины перейдет в требуемое состояние повторной синхронизации. В худшем случае для разностной репликации потребуется 50 % дополнительного свободного пространства с учетом размера виртуального жесткого диска.

**Hyper-V host** (Узел Hyper-V). Список профилируемых серверов Hyper-V. Если сервер входит в кластер Hyper-V, все узлы кластера группируются вместе.

**Volume (VHD path)** (Том (путь к виртуальному жесткому диску)). Каждый том узла Hyper-V с VHD-файлами или VHDX-файлами. 

**Free space available (GB)** (Доступное свободное пространство (ГБ)). Свободное место, доступное в томе.

**Total storage space required on the volume (GB)** (Общий объем дискового пространства, требуемый на томе (ГБ)). Общее свободное дисковое пространство, требуемое на томе для успешной начальной и разностной репликации. 

**Total additional storage to be provisioned on the volume for successful replication** (Общее дополнительное пространство, которое нужно подготовить в томе для успешной репликации). Рекомендуемое общее дополнительное пространство, которое необходимо подготовить в томе для успешной начальной и разностной репликации.

## <a name="initial-replication-batching"></a>Пакетная обработка для начальной репликации 

### <a name="why-do-i-need-initial-replication-ir-batching"></a>Зачем нужна пакетная обработка для начальной репликации?
Если обеспечивается защита всех виртуальных машин одновременно, требование к свободному пространству гораздо выше. Если пространства недостаточно, репликация виртуальных машин перейдет в режим повторной синхронизации. Кроме того, требование к пропускной способности сети гораздо выше для успешной начальной репликации всех виртуальных машин одновременно. 

### <a name="initial-replication-batching-for-a-selected-rpo"></a>Пакетная обработка при начальной репликации для выбранного значения RPO
На этом листе предоставлены подробные сведения о каждом пакете для начальной репликации (IR). Для каждого значения RPO создается отдельный лист по пакетной обработке IR. 

После выполнения рекомендаций по требованиям к локальному хранилищу для каждого тома вы можете ознакомиться с основными сведениями, необходимыми для репликации. Это список виртуальных машин, которые можно защитить в параллельном режиме. Эти виртуальные машины сгруппированы в одном пакете. Пакетов может быть несколько. Защита виртуальных машин должна обеспечиваться в порядке пакетов. Сначала следует обеспечить защиту виртуальных машин из пакета 1. После завершения начальной репликации можно защитить виртуальные машины из пакета 2 и т. д. На этом листе можно просмотреть список пакетов и соответствующих виртуальных машин. 

![Дополнительные сведения о пакетной обработке для IR1](media/site-recovery-hyper-v-deployment-planner-analyze-report/ir-batching-for-rpo-h2a.png)
![Дополнительные сведения о пакетной обработке для IR2](media/site-recovery-hyper-v-deployment-planner-analyze-report/ir-batching-for-rpo2-h2a.png)

### <a name="each-batch-provides-the-following-information"></a>Сведения о каждом пакете 
**Hyper-V host** (Узел Hyper-V). Узел Hyper-V виртуальной машины, защиту которой требуется обеспечить.
Виртуальная машина. Виртуальная машина, которую требуется защитить. 

**Комментарии.** Если для конкретного тома виртуальной машины требуется выполнить какие-либо действие, здесь указывается соответствующий комментарий.  Например, если на томе недостаточно свободного места, в комментариях будет указано сообщение "Добавьте дополнительное пространство для защиты этой виртуальной машины".

**Volume (VHD path)** (Том (путь к виртуальному жесткому диску)). Имя тома, на котором находятся виртуальные жесткие диски виртуальной машины. Free space available on the volume (GB). (Свободное место на томе (ГБ)). Свободное дисковое пространство на томе для виртуальной машины. При вычислении свободного места на томах учитывается дисковое пространство, используемое для разностной репликации виртуальных машин из предыдущих пакетов, виртуальные жесткие диски которых находятся на том же томе.  

Например, VM1, VM2 и VM3 размещаются на томе E:\VHDpath. Перед репликацией на томе есть 500 ГБ свободного места. VM1 входит в пакет 1, VM2 — в пакет 2 и VM3 — пакет 3.  Для VM1 доступно 500 ГБ свободного места. Свободное место для VM2 составит 500 – место на диске, требуемое для разностной репликации для VM1.  Предположим, что для разностной репликации VM1 требуется 300 ГБ дискового пространства, поэтому для VM2 будет доступно 500 – 300 ГБ = 200 ГБ.  Аналогичным образом для разностной репликации VM2 потребуется 300 ГБ. Свободное место для VM3 составит 200 – 300 ГБ = –100 ГБ.

**Storage required on the volume for initial replication (GB)** (Хранилище, необходимое на томе для начальной репликации (ГБ)). Свободное дисковое пространство, требуемое на томе для начальной репликации виртуальной машины.

**Storage required on the volume for delta replication (GB)** (Хранилище, необходимое на томе для разностной репликации (ГБ)). Свободное дисковое пространство, требуемое на томе для разностной репликации виртуальной машины.

**Additional storage required based on deficit to avoid replication failure (GB)** (Дополнительное хранилище, необходимое при нехватке места во избежание сбоя репликации (ГБ)). Дополнительное пространство, требуемое на томе для виртуальной машины.  Это максимальное значение свободного пространства на томе, требуемое для начальной и разностной репликации.

**Minimum bandwidth required for initial replication (Mbps)** (Минимальная пропускная способность, необходимая для начальной репликации (Мбит/с)). Минимальная пропускная способность, необходимая для начальной репликации виртуальной машины.

**Minimum bandwidth required for delta replication (Mbps)** (Минимальная пропускная способность, необходимая для разностной репликации (Мбит/с)). Минимальная пропускная способность, необходимая для разностной репликации виртуальной машины.

### <a name="network-utilization-details-for-each-batch"></a>Подробные сведения об использовании сети для каждого пакета 
В каждой таблице пакета представлена сводка по использованию сети для пакета.

**Bandwidth available for Batch** (Пропускная способность, доступная для пакета). Пропускная способность, доступная для пакета после учета пропускной способности для разностной репликации предыдущего пакета.

**Approximate bandwidth available for initial replication of batch** (Приблизительная пропускная способность, доступная для начальной репликации пакета). Пропускная способность, доступная для начальной репликации виртуальных машин пакета. 

**Approximate bandwidth consumed for delta replication of batch** (Приблизительная пропускная способность, используемая для разностной репликации пакета). Пропускная способность, требуемая для разностной репликации виртуальных машин пакета. 

**Estimated Initial Replication time for Batch (HH:MM)** (Предполагаемое время начальной репликации для пакета (ЧЧ:ММ)). Предполагаемое время начальной репликации в часах и минутах.

## <a name="cost-estimation"></a>Оценка затрат
Подробнее об [оценке затрат](site-recovery-hyper-v-deployment-planner-cost-estimation.md). 

## <a name="next-steps"></a>Дальнейшие действия
Подробнее об [оценке затрат](site-recovery-hyper-v-deployment-planner-cost-estimation.md).