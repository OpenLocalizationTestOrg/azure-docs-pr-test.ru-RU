---
title: "aaaExclude дисков из группы защиты с помощью Azure Site Recovery | Документы Microsoft"
description: "Описывает, почему и как tooexclude ВМ диски из репликации для сценариев VMware tooAzure и tooAzure Hyper-V."
services: site-recovery
documentationcenter: 
author: nsoneji
manager: garavd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 06/05/2017
ms.author: nisoneji
ms.openlocfilehash: f47146bc57aeab3fce90123d0894fa86dde93417
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="exclude-disks-from-replication"></a><span data-ttu-id="fff10-103">Исключение дисков из репликации</span><span class="sxs-lookup"><span data-stu-id="fff10-103">Exclude disks from replication</span></span>
<span data-ttu-id="fff10-104">В этой статье описывается, как tooexclude диски из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-104">This article describes how tooexclude disks from replication.</span></span> <span data-ttu-id="fff10-105">Это исключение можно оптимизировать пропускную способность репликации потребляет hello или оптимизировать ресурсы целевую сторону hello, использующие такие диски.</span><span class="sxs-lookup"><span data-stu-id="fff10-105">This exclusion can optimize hello consumed replication bandwidth or optimize hello target-side resources that such disks utilize.</span></span> <span data-ttu-id="fff10-106">функция Hello поддерживается для сценариев VMware tooAzure и tooAzure Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="fff10-106">hello feature is supported for scenarios of VMware tooAzure and Hyper-V tooAzure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="fff10-107">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="fff10-107">Prerequisites</span></span>

<span data-ttu-id="fff10-108">По умолчанию реплицируются все диски на виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="fff10-108">By default, all disks on a machine are replicated.</span></span> <span data-ttu-id="fff10-109">tooexclude диск из репликации, необходимо вручную установить hello службы Mobility service на компьютере hello перед включением репликации при репликации из VMware tooAzure.</span><span class="sxs-lookup"><span data-stu-id="fff10-109">tooexclude a disk from replication, you must manually install hello Mobility service on hello machine before you enable replication if you are replicating from VMware tooAzure.</span></span>


## <a name="why-exclude-disks-from-replication"></a><span data-ttu-id="fff10-110">Зачем исключать диски из репликации</span><span class="sxs-lookup"><span data-stu-id="fff10-110">Why exclude disks from replication?</span></span>
<span data-ttu-id="fff10-111">Исключение дисков из репликации часто бывает необходимо:</span><span class="sxs-lookup"><span data-stu-id="fff10-111">Excluding disks from replication is often necessary because:</span></span>

- <span data-ttu-id="fff10-112">данные Hello, churned на диске исключен hello не важны или не требуется реплицировать toobe.</span><span class="sxs-lookup"><span data-stu-id="fff10-112">hello data that's churned on hello excluded disk is not important or doesn’t need toobe replicated.</span></span>

- <span data-ttu-id="fff10-113">Вы собираетесь toosave ресурсы хранилища и сети, не копируя этой обработки.</span><span class="sxs-lookup"><span data-stu-id="fff10-113">You want toosave storage and network resources by not replicating this churn.</span></span>

## <a name="what-are-hello-typical-scenarios"></a><span data-ttu-id="fff10-114">Каковы основные сценарии hello</span><span class="sxs-lookup"><span data-stu-id="fff10-114">What are hello typical scenarios?</span></span>
<span data-ttu-id="fff10-115">Вы можете определить конкретные примеры потоков данных, которые подходят для исключения.</span><span class="sxs-lookup"><span data-stu-id="fff10-115">You can identify specific examples of data churn that are great candidates for exclusion.</span></span> <span data-ttu-id="fff10-116">Примеры могут включать записывает tooa файла подкачки (pagefile.sys) и записывает файл базы данных tempdb toohello сервера Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fff10-116">Examples might include writes tooa paging file (pagefile.sys) and writes toohello tempdb file of Microsoft SQL Server.</span></span> <span data-ttu-id="fff10-117">В зависимости от рабочей нагрузки hello и hello подсистемы хранилища файл подкачки hello можно зарегистрировать значительный объем обработки.</span><span class="sxs-lookup"><span data-stu-id="fff10-117">Depending on hello workload and hello storage subsystem, hello paging file can register a significant amount of churn.</span></span> <span data-ttu-id="fff10-118">Однако репликация эти данные из основного сайта tooAzure hello бы много ресурсов.</span><span class="sxs-lookup"><span data-stu-id="fff10-118">However, replicating this data from hello primary site tooAzure would be resource intensive.</span></span> <span data-ttu-id="fff10-119">Таким образом можно использовать следующие шаги toooptimize репликации виртуальной машины с одного виртуального диска с hello операционной системы и файл подкачки hello hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-119">Thus, you can use hello following steps toooptimize replication of a virtual machine with a single virtual disk that has both hello operating system and hello paging file:</span></span>

1. <span data-ttu-id="fff10-120">Один виртуальный диск hello разбить на два виртуальных диска.</span><span class="sxs-lookup"><span data-stu-id="fff10-120">Split hello single virtual disk into two virtual disks.</span></span> <span data-ttu-id="fff10-121">Один виртуальный диск имеет hello операционной системы и других hello hello файла подкачки.</span><span class="sxs-lookup"><span data-stu-id="fff10-121">One virtual disk has hello operating system, and hello other has hello paging file.</span></span>
2. <span data-ttu-id="fff10-122">Исключите файл подкачки hello диск из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-122">Exclude hello paging file disk from replication.</span></span>

<span data-ttu-id="fff10-123">Аналогичным образом можно использовать следующие шаги toooptimize диск, который имеет оба hello Microsoft SQL Server tempdb полей hello и hello файл системной базы данных:</span><span class="sxs-lookup"><span data-stu-id="fff10-123">Similarly, you can use hello following steps toooptimize a disk that has both hello Microsoft SQL Server tempdb fie and hello system database file:</span></span>

1. <span data-ttu-id="fff10-124">Следите за hello системной базы данных и базы данных tempdb на двух различных дисках.</span><span class="sxs-lookup"><span data-stu-id="fff10-124">Keep hello system database and tempdb on two different disks.</span></span>
2. <span data-ttu-id="fff10-125">Диск базы данных tempdb hello исключите из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-125">Exclude hello tempdb disk from replication.</span></span>

## <a name="how-tooexclude-disks-from-replication"></a><span data-ttu-id="fff10-126">Как tooexclude диски из репликации?</span><span class="sxs-lookup"><span data-stu-id="fff10-126">How tooexclude disks from replication?</span></span>

### <a name="vmware-tooazure"></a><span data-ttu-id="fff10-127">VMware tooAzure</span><span class="sxs-lookup"><span data-stu-id="fff10-127">VMware tooAzure</span></span>
<span data-ttu-id="fff10-128">Выполните hello [включить репликацию](site-recovery-vmware-to-azure.md) tooprotect рабочий процесс виртуальной машины из портала Azure Site Recovery hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-128">Follow hello [Enable replication](site-recovery-vmware-to-azure.md) workflow tooprotect a virtual machine from hello Azure Site Recovery portal.</span></span> <span data-ttu-id="fff10-129">В hello четвертый шаг hello рабочего процесса, используйте hello **tooREPLICATE диска** дисков tooexclude столбца из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-129">In hello fourth step of hello workflow, use hello **DISK tooREPLICATE** column tooexclude disks from replication.</span></span> <span data-ttu-id="fff10-130">По умолчанию для репликации выбраны все диски.</span><span class="sxs-lookup"><span data-stu-id="fff10-130">By default, all disks are selected for replication.</span></span> <span data-ttu-id="fff10-131">Снимите флажок hello дисков, которые должны tooexclude из репликации и последующем выполнении hello действия tooenable репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-131">Clear hello check box of disks that you want tooexclude from replication, and then complete hello steps tooenable replication.</span></span>

![Исключить из репликации дисков и включить репликацию для восстановления размещения tooAzure VMware](./media/site-recovery-exclude-disk/v2a-enable-replication-exclude-disk1.png)


>[!NOTE]
>
> * <span data-ttu-id="fff10-133">Можно исключить только диски, для которых уже установлена служба Mobility hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-133">You can exclude only disks that already have hello Mobility service installed.</span></span> <span data-ttu-id="fff10-134">Необходимо toomanually службу Mobility hello установки, поскольку hello службы Mobility service устанавливается с помощью механизма принудительной hello после включения репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-134">You need toomanually install hello Mobility service, because hello Mobility service is only installed by using hello push mechanism after replication is enabled.</span></span>
> * <span data-ttu-id="fff10-135">Из репликации можно исключать только базовые диски.</span><span class="sxs-lookup"><span data-stu-id="fff10-135">Only basic disks can be excluded from replication.</span></span> <span data-ttu-id="fff10-136">Вы не можете исключать диски операционной системы или динамические диски.</span><span class="sxs-lookup"><span data-stu-id="fff10-136">You can't exclude operating system or dynamic disks.</span></span>
> * <span data-ttu-id="fff10-137">После включения репликации добавить или удалить диски для репликации нельзя.</span><span class="sxs-lookup"><span data-stu-id="fff10-137">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="fff10-138">Если требуется tooadd или исключить диск, требуется toodisable защиту для машины hello и включите ее снова.</span><span class="sxs-lookup"><span data-stu-id="fff10-138">If you want tooadd or exclude a disk, you need toodisable protection for hello machine and then enable it again.</span></span>
> * <span data-ttu-id="fff10-139">Если вы исключите диск, который требуется для toooperate приложения после отработки отказа tooAzure, необходим диск hello toocreate вручную в Azure, для запуска приложения hello репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-139">If you exclude a disk that's needed for an application toooperate, after failover tooAzure, you’ll need toocreate hello disk manually in Azure so that hello replicated application can run.</span></span> <span data-ttu-id="fff10-140">Кроме того службы автоматизации Azure можно интегрировать в диск hello toocreate плана восстановления при сбое машины hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-140">Alternatively, you can integrate Azure automation into a recovery plan toocreate hello disk during failover of hello machine.</span></span>
> * <span data-ttu-id="fff10-141">Виртуальная машина Windows. Диски, создаваемые в Azure вручную, не восстанавливаются.</span><span class="sxs-lookup"><span data-stu-id="fff10-141">Window virtual machine: Disks that you create manually in Azure are not failed back.</span></span> <span data-ttu-id="fff10-142">Например, если вы выполните отработку отказа трех дисков и создадите два диска непосредственно на виртуальной машине Azure, то восстановление размещения будет выполнено только для трех дисков, задействованных при отработке отказа.</span><span class="sxs-lookup"><span data-stu-id="fff10-142">For example, if you fail over three disks and create two disk directly in Azure Virtual Machines, only three disks that were failed over are failed back.</span></span> <span data-ttu-id="fff10-143">Нельзя включать дисков, созданных вручную в восстановление после сбоя или повторной защиты из локальной tooAzure.</span><span class="sxs-lookup"><span data-stu-id="fff10-143">You can't include disks that you created manually in failback or in reprotect from on-premises tooAzure.</span></span>
> * <span data-ttu-id="fff10-144">Виртуальная машина Linux. Диски, создаваемые в Azure вручную, восстанавливаются.</span><span class="sxs-lookup"><span data-stu-id="fff10-144">Linux virtual machine: Disks that you create manually in Azure are failed back.</span></span> <span data-ttu-id="fff10-145">Например, если для трех дисков выполняется отработка отказа, а еще два создаются непосредственно в виртуальных машинах Azure, восстановление будет выполнено для всех пяти дисков.</span><span class="sxs-lookup"><span data-stu-id="fff10-145">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, all five will be failed back.</span></span> <span data-ttu-id="fff10-146">Диски, созданные вручную при восстановлении расположения, исключать нельзя.</span><span class="sxs-lookup"><span data-stu-id="fff10-146">You can't exclude disks that were created manually from failback.</span></span>
>

### <a name="hyper-v-tooazure"></a><span data-ttu-id="fff10-147">TooAzure Hyper-V</span><span class="sxs-lookup"><span data-stu-id="fff10-147">Hyper-V tooAzure</span></span>
<span data-ttu-id="fff10-148">Выполните hello [включить репликацию](site-recovery-hyper-v-site-to-azure.md) tooprotect рабочий процесс виртуальной машины из портала Azure Site Recovery hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-148">Follow hello [Enable replication](site-recovery-hyper-v-site-to-azure.md) workflow tooprotect a virtual machine from hello Azure Site Recovery portal.</span></span> <span data-ttu-id="fff10-149">В hello четвертый шаг hello рабочего процесса, используйте hello **tooREPLICATE диска** дисков tooexclude столбца из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-149">In hello fourth step of hello workflow, use hello **DISK tooREPLICATE** column tooexclude disks from replication.</span></span> <span data-ttu-id="fff10-150">По умолчанию для репликации выбраны все диски.</span><span class="sxs-lookup"><span data-stu-id="fff10-150">By default, all disks are selected for replication.</span></span> <span data-ttu-id="fff10-151">Снимите флажок hello дисков, которые должны tooexclude из репликации и последующем выполнении hello действия tooenable репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-151">Clear hello check box of disks that you want tooexclude from replication, and then complete hello steps tooenable replication.</span></span>

![Исключить из репликации дисков и включить репликацию для восстановления размещения tooAzure Hyper-V](./media/site-recovery-vmm-to-azure/enable-replication6-with-exclude-disk.png)

>[!NOTE]
>
> * <span data-ttu-id="fff10-153">Вы можете исключать из репликации только базовые диски.</span><span class="sxs-lookup"><span data-stu-id="fff10-153">You can exclude only basic disks from replication.</span></span> <span data-ttu-id="fff10-154">Вы не можете исключать диски операционной системы.</span><span class="sxs-lookup"><span data-stu-id="fff10-154">You can't exclude operating system disks.</span></span> <span data-ttu-id="fff10-155">Исключать динамические диски не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="fff10-155">We recommend that you do not exclude dynamic disks.</span></span> <span data-ttu-id="fff10-156">Azure Site Recovery не удалось определить, какие виртуального жесткого диска (VHD), базовый или динамический hello гостевой виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="fff10-156">Azure Site Recovery cannot identify which virtual hard disk (VHD) is basic or dynamic in hello guest virtual machine.</span></span>  <span data-ttu-id="fff10-157">Если все зависимые динамические диски не исключены, защищенного динамического диска hello становится отказавшего диска на виртуальной машине отработки отказа и hello данные на этом диске не доступен.</span><span class="sxs-lookup"><span data-stu-id="fff10-157">If all dependent dynamic volume disks are not excluded, hello protected dynamic disk becomes a failed disk on a failover virtual machine, and hello data on that disk is not accessible.</span></span>
> * <span data-ttu-id="fff10-158">После включения репликации добавить или удалить диски для репликации нельзя.</span><span class="sxs-lookup"><span data-stu-id="fff10-158">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="fff10-159">Если требуется tooadd или исключить диск, требуется toodisable защиты для виртуальной машины hello и включите ее снова.</span><span class="sxs-lookup"><span data-stu-id="fff10-159">If you want tooadd or exclude a disk, you need toodisable protection for hello virtual machine and then enable it again.</span></span>
> * <span data-ttu-id="fff10-160">Если исключить диск, который требуется для toooperate приложения после отработки отказа tooAzure необходим toocreate hello диск вручную в Azure, позволяющие выполнять приложения hello репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-160">If you exclude a disk that's needed for an application toooperate, after failover tooAzure you’ll need toocreate hello disk manually in Azure so that hello replicated application can run.</span></span> <span data-ttu-id="fff10-161">Кроме того службы автоматизации Azure можно интегрировать в диск hello toocreate плана восстановления при сбое машины hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-161">Alternatively, you can integrate Azure automation into a recovery plan toocreate hello disk during failover of hello machine.</span></span>
> * <span data-ttu-id="fff10-162">Диски, создаваемые в Azure вручную, не будут восстановлены в исходном расположении.</span><span class="sxs-lookup"><span data-stu-id="fff10-162">Disks that you create manually in Azure will not be failed back.</span></span> <span data-ttu-id="fff10-163">Например если сбой более чем трех дисков и создать два диска непосредственно на виртуальных машинах Azure, только три дисков, которые были отработка отказа не будет выполнен обратно из Azure tooHyper-V.</span><span class="sxs-lookup"><span data-stu-id="fff10-163">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, only three disks that were failed over will be failed back from Azure tooHyper-V.</span></span> <span data-ttu-id="fff10-164">Нельзя включать диски, которые были созданы вручную в восстановление после сбоя или обратная репликация из tooAzure Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="fff10-164">You can't include disks that were created manually in failback or in reverse replication from Hyper-V tooAzure.</span></span>



## <a name="end-to-end-scenarios-of-exclude-disks"></a><span data-ttu-id="fff10-165">Полные сценарии исключения дисков</span><span class="sxs-lookup"><span data-stu-id="fff10-165">End-to-end scenarios of exclude disks</span></span>
<span data-ttu-id="fff10-166">Давайте рассмотрим функция двух сценариев toounderstand hello исключить диск:</span><span class="sxs-lookup"><span data-stu-id="fff10-166">Let's consider two scenarios toounderstand hello exclude disk feature:</span></span>

- <span data-ttu-id="fff10-167">Диск с файлом tempdb SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fff10-167">SQL Server tempdb disk</span></span>
- <span data-ttu-id="fff10-168">Диск с файлом подкачки (pagefile.sys).</span><span class="sxs-lookup"><span data-stu-id="fff10-168">Paging file (pagefile.sys) disk</span></span>

### <a name="exclude-hello-sql-server-tempdb-disk"></a><span data-ttu-id="fff10-169">Исключить диск базы данных tempdb SQL Server hello</span><span class="sxs-lookup"><span data-stu-id="fff10-169">Exclude hello SQL Server tempdb disk</span></span>
<span data-ttu-id="fff10-170">Рассмотрим виртуальную машину SQL Server с диском tempdb, который может быть исключен из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-170">Let's consider a SQL Server virtual machine that has a tempdb that can be excluded.</span></span>

<span data-ttu-id="fff10-171">Hello hello виртуальный диск называется SalesDB.</span><span class="sxs-lookup"><span data-stu-id="fff10-171">hello name of hello virtual disk is SalesDB.</span></span>

<span data-ttu-id="fff10-172">Ниже приведены диски hello исходной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="fff10-172">Disks on hello source virtual machine are as follows:</span></span>


<span data-ttu-id="fff10-173">**Имя диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-173">**Disk name**</span></span> | <span data-ttu-id="fff10-174">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-174">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-175">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-175">**Drive letter**</span></span> | <span data-ttu-id="fff10-176">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-176">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="fff10-177">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="fff10-177">DB-Disk0-OS</span></span> | <span data-ttu-id="fff10-178">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-178">DISK0</span></span> | <span data-ttu-id="fff10-179">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-179">C:\\</span></span> | <span data-ttu-id="fff10-180">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-180">Operating system disk</span></span>
<span data-ttu-id="fff10-181">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="fff10-181">DB-Disk1</span></span>| <span data-ttu-id="fff10-182">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-182">Disk1</span></span> | <span data-ttu-id="fff10-183">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-183">D:\\</span></span> | <span data-ttu-id="fff10-184">Системная база данных SQL и база данных пользователя Database1</span><span class="sxs-lookup"><span data-stu-id="fff10-184">SQL system database and User Database1</span></span>
<span data-ttu-id="fff10-185">DB-Disk2 (диск hello исключенных из защиты)</span><span class="sxs-lookup"><span data-stu-id="fff10-185">DB-Disk2 (Excluded hello disk from protection)</span></span> | <span data-ttu-id="fff10-186">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-186">Disk2</span></span> | <span data-ttu-id="fff10-187">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-187">E:\\</span></span> | <span data-ttu-id="fff10-188">Временные файлы</span><span class="sxs-lookup"><span data-stu-id="fff10-188">Temp files</span></span>
<span data-ttu-id="fff10-189">DB-Disk3 (диск hello исключенных из защиты)</span><span class="sxs-lookup"><span data-stu-id="fff10-189">DB-Disk3 (Excluded hello disk from protection)</span></span> | <span data-ttu-id="fff10-190">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-190">Disk3</span></span> | <span data-ttu-id="fff10-191">F:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-191">F:\\</span></span> | <span data-ttu-id="fff10-192">База данных tempdb SQL (путь к папке (F:\MSSQL\Data\) < /br/>< /br/> Запишите путь к папке hello перед выполнением отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="fff10-192">SQL tempdb database (folder path(F:\MSSQL\Data\) </br /> </br />Write down hello folder path before failover.</span></span>
<span data-ttu-id="fff10-193">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="fff10-193">DB-Disk4</span></span> | <span data-ttu-id="fff10-194">Диск 4</span><span class="sxs-lookup"><span data-stu-id="fff10-194">Disk4</span></span> |<span data-ttu-id="fff10-195">G:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-195">G:\\</span></span> |<span data-ttu-id="fff10-196">База данных пользователя Database2</span><span class="sxs-lookup"><span data-stu-id="fff10-196">User Database2</span></span>

<span data-ttu-id="fff10-197">Поскольку обработка данных на два диска hello виртуальной машины является временным, защиту виртуальной машины SalesDB hello, исключите из репликации Disk2 и Disk3.</span><span class="sxs-lookup"><span data-stu-id="fff10-197">Because data churn on two disks of hello virtual machine is temporary, while you protect hello SalesDB virtual machine, exclude Disk2 and Disk3 from replication.</span></span> <span data-ttu-id="fff10-198">Эти диски не будут реплицироваться в Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="fff10-198">Azure Site Recovery will not replicate those disks.</span></span> <span data-ttu-id="fff10-199">При отработке отказа этих дисков не присутствовать на hello отработки отказа виртуальной машины в Azure.</span><span class="sxs-lookup"><span data-stu-id="fff10-199">On failover, those disks will not be present on hello failover virtual machine on Azure.</span></span>

<span data-ttu-id="fff10-200">Существуют следующие диски виртуальной машины Azure после отработки отказа hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-200">Disks on hello Azure virtual machine after failover are as follows:</span></span>

<span data-ttu-id="fff10-201">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-201">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-202">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-202">**Drive letter**</span></span> | <span data-ttu-id="fff10-203">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-203">**Data type on hello disk**</span></span>
--- | --- | ---
<span data-ttu-id="fff10-204">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-204">DISK0</span></span> | <span data-ttu-id="fff10-205">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-205">C:\\</span></span> | <span data-ttu-id="fff10-206">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-206">Operating system disk</span></span>
<span data-ttu-id="fff10-207">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-207">Disk1</span></span> | <span data-ttu-id="fff10-208">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-208">E:\\</span></span> | <span data-ttu-id="fff10-209">Временное хранилище < /br / >< /br / > Azure добавляет этот диск и назначает hello первая доступная буква диска.</span><span class="sxs-lookup"><span data-stu-id="fff10-209">Temporary storage</br /> </br />Azure adds this disk and assigns hello first available drive letter.</span></span>
<span data-ttu-id="fff10-210">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-210">Disk2</span></span> | <span data-ttu-id="fff10-211">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-211">D:\\</span></span> | <span data-ttu-id="fff10-212">Системная база данных SQL и база данных пользователя Database1</span><span class="sxs-lookup"><span data-stu-id="fff10-212">SQL system database and User Database1</span></span>
<span data-ttu-id="fff10-213">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-213">Disk3</span></span> | <span data-ttu-id="fff10-214">G:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-214">G:\\</span></span> | <span data-ttu-id="fff10-215">База данных пользователя Database2</span><span class="sxs-lookup"><span data-stu-id="fff10-215">User Database2</span></span>

<span data-ttu-id="fff10-216">Поскольку Disk2 и Disk3 были исключены из hello SalesDB виртуальной машины, E: является hello первую букву диска из списка доступных hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-216">Because Disk2 and Disk3 were excluded from hello SalesDB virtual machine, E: is hello first drive letter from hello available list.</span></span> <span data-ttu-id="fff10-217">Azure назначает E: объемом временного хранилища toohello.</span><span class="sxs-lookup"><span data-stu-id="fff10-217">Azure assigns E: toohello temporary storage volume.</span></span> <span data-ttu-id="fff10-218">Для всех дисков hello репликации остаются буквы диска hello hello таким же.</span><span class="sxs-lookup"><span data-stu-id="fff10-218">For all hello replicated disks, hello drive letters remain hello same.</span></span>

<span data-ttu-id="fff10-219">Disk3, бывшее диска базы данных tempdb SQL hello (путь к папке базы данных tempdb F:\MSSQL\Data\), был исключен из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-219">Disk3, which was hello SQL tempdb disk (tempdb folder path F:\MSSQL\Data\), was excluded from replication.</span></span> <span data-ttu-id="fff10-220">Hello диске доступно не на hello отработки отказа виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="fff10-220">hello disk is not available on hello failover virtual machine.</span></span> <span data-ttu-id="fff10-221">В результате hello службы SQL Server находится в остановленном состоянии, и ему путь F:\MSSQL\Data hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-221">As a result, hello SQL service is in a stopped state, and it needs hello F:\MSSQL\Data path.</span></span>

<span data-ttu-id="fff10-222">Существует два способа toocreate этот путь:</span><span class="sxs-lookup"><span data-stu-id="fff10-222">There are two ways toocreate this path:</span></span>

- <span data-ttu-id="fff10-223">Добавьте новый диск и назначьте путь к папке tempdb.</span><span class="sxs-lookup"><span data-stu-id="fff10-223">Add a new disk and assign tempdb folder path.</span></span>
- <span data-ttu-id="fff10-224">Используйте существующий диск временного хранилища для hello путь к папке базы данных tempdb.</span><span class="sxs-lookup"><span data-stu-id="fff10-224">Use an existing temporary storage disk for hello tempdb folder path.</span></span>

#### <a name="add-a-new-disk"></a><span data-ttu-id="fff10-225">Добавьте новый диск:</span><span class="sxs-lookup"><span data-stu-id="fff10-225">Add a new disk:</span></span>

1. <span data-ttu-id="fff10-226">Запишите пути hello SQL tempdb.mdf и tempdb.ldf перед выполнением отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="fff10-226">Write down hello paths of SQL tempdb.mdf and tempdb.ldf before failover.</span></span>
2. <span data-ttu-id="fff10-227">С помощью hello портал Azure добавьте новый диск toohello отработки отказа виртуальной машины с hello того же или больше размера, что и база данных tempdb SQL исходного hello диска (Disk3).</span><span class="sxs-lookup"><span data-stu-id="fff10-227">From hello Azure portal, add a new disk toohello failover virtual machine with hello same or more size as that of hello source SQL tempdb disk (Disk3).</span></span>
3. <span data-ttu-id="fff10-228">Войдите в систему toohello виртуальной машины Azure.</span><span class="sxs-lookup"><span data-stu-id="fff10-228">Sign in toohello Azure virtual machine.</span></span> <span data-ttu-id="fff10-229">Из консоли управления (diskmgmt.msc) дисками hello инициализации и форматирования hello добавленным диска.</span><span class="sxs-lookup"><span data-stu-id="fff10-229">From hello disk management (diskmgmt.msc) console, initialize and format hello newly added disk.</span></span>
4. <span data-ttu-id="fff10-230">Назначение hello одинаковую букву, затраченный на диске базы данных tempdb SQL hello (F:) диска.</span><span class="sxs-lookup"><span data-stu-id="fff10-230">Assign hello same drive letter that was used by hello SQL tempdb disk (F:).</span></span>
5. <span data-ttu-id="fff10-231">Создайте папку базы данных tempdb на hello тома F: (F:\MSSQL\Data).</span><span class="sxs-lookup"><span data-stu-id="fff10-231">Create a tempdb folder on hello F: volume (F:\MSSQL\Data).</span></span>
6. <span data-ttu-id="fff10-232">Запуск службы SQL Server hello из консоли службы hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-232">Start hello SQL service from hello service console.</span></span>

#### <a name="use-an-existing-temporary-storage-disk-for-hello-sql-tempdb-folder-path"></a><span data-ttu-id="fff10-233">Используйте существующий диск временного хранилища для путь к папке базы данных tempdb SQL hello:</span><span class="sxs-lookup"><span data-stu-id="fff10-233">Use an existing temporary storage disk for hello SQL tempdb folder path:</span></span>

1. <span data-ttu-id="fff10-234">Откройте окно командной строки.</span><span class="sxs-lookup"><span data-stu-id="fff10-234">Open a command prompt.</span></span>
2. <span data-ttu-id="fff10-235">Запустите SQL Server в режиме восстановления из командной строки hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-235">Run SQL Server in recovery mode from hello command prompt.</span></span>

        Net start MSSQLSERVER /f / T3608

3. <span data-ttu-id="fff10-236">Запустите hello sqlcmd toochange hello tempdb путь toohello нового пути.</span><span class="sxs-lookup"><span data-stu-id="fff10-236">Run hello following sqlcmd toochange hello tempdb path toohello new path.</span></span>

        sqlcmd -A -S SalesDB        **Use your SQL DBname**
        USE master;     
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = tempdev, FILENAME = 'E:\MSSQL\tempdata\tempdb.mdf');
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = templog, FILENAME = 'E:\MSSQL\tempdata\templog.ldf');       
        GO


4. <span data-ttu-id="fff10-237">Остановка службы Microsoft SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-237">Stop hello Microsoft SQL Server service.</span></span>

        Net stop MSSQLSERVER
5. <span data-ttu-id="fff10-238">Запуск службы Microsoft SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-238">Start hello Microsoft SQL Server service.</span></span>

        Net start MSSQLSERVER

<span data-ttu-id="fff10-239">См. следующие Azure направляющих для временного хранения диска toohello:</span><span class="sxs-lookup"><span data-stu-id="fff10-239">Refer toohello following Azure guideline for temporary storage disk:</span></span>

* [<span data-ttu-id="fff10-240">Использование SSD на виртуальных машинах Azure toostore SQL Server TempDB и расширений буферного пула</span><span class="sxs-lookup"><span data-stu-id="fff10-240">Using SSDs in Azure VMs toostore SQL Server TempDB and Buffer Pool Extensions</span></span>](https://blogs.technet.microsoft.com/dataplatforminsider/2014/09/25/using-ssds-in-azure-vms-to-store-sql-server-tempdb-and-buffer-pool-extensions/)
* [<span data-ttu-id="fff10-241">Рекомендации по оптимизации производительности SQL Server на виртуальных машинах Azure</span><span class="sxs-lookup"><span data-stu-id="fff10-241">Performance best practices for SQL Server in Azure Virtual Machines</span></span>](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-performance)

### <a name="failback-from-azure-tooan-on-premises-host"></a><span data-ttu-id="fff10-242">Восстановление после сбоя (из Azure tooan локального узла)</span><span class="sxs-lookup"><span data-stu-id="fff10-242">Failback (from Azure tooan on-premises host)</span></span>
<span data-ttu-id="fff10-243">Теперь рассмотрим реплицируемых после отработки отказа с узла Hyper-V или VMware локальной Azure tooyour дисков hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-243">Now let's understand hello disks that are replicated when you fail over from Azure tooyour on-premises VMware or Hyper-V host.</span></span> <span data-ttu-id="fff10-244">Диски, созданные в Azure вручную, не будут реплицированы.</span><span class="sxs-lookup"><span data-stu-id="fff10-244">Disks that you create manually in Azure will not be replicated.</span></span> <span data-ttu-id="fff10-245">Например, если вы выполните отработку отказа трех дисков и создадите два диска непосредственно на виртуальных машинах Azure, то восстановление размещения будет выполнено только для трех дисков, задействованных при отработке отказа.</span><span class="sxs-lookup"><span data-stu-id="fff10-245">For example, if you fail over three disks and create two directly in Azure Virtual Machines, only three disks that were failed over will be failed back.</span></span> <span data-ttu-id="fff10-246">Нельзя включать диски, которые были созданы вручную в восстановление после сбоя или повторной защиты из локальной tooAzure.</span><span class="sxs-lookup"><span data-stu-id="fff10-246">You can't include disks that were created manually in failback or in reprotect from on-premises tooAzure.</span></span> <span data-ttu-id="fff10-247">Он также не реплицирует узлов tooon локальный диск временного хранилища hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-247">It also does not replicate hello temporary storage disk tooon-premises hosts.</span></span>

#### <a name="failback-toooriginal-location-recovery"></a><span data-ttu-id="fff10-248">Восстановление после сбоя toooriginal расположении восстановления</span><span class="sxs-lookup"><span data-stu-id="fff10-248">Failback toooriginal location recovery</span></span>

<span data-ttu-id="fff10-249">В предыдущем примере hello конфигурация диска виртуальной машины Azure hello выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="fff10-249">In hello previous example, hello Azure virtual machine disk configuration is as follows:</span></span>

<span data-ttu-id="fff10-250">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-250">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-251">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-251">**Drive letter**</span></span> | <span data-ttu-id="fff10-252">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-252">**Data type on hello disk**</span></span>
--- | --- | ---
<span data-ttu-id="fff10-253">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-253">DISK0</span></span> | <span data-ttu-id="fff10-254">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-254">C:\\</span></span> | <span data-ttu-id="fff10-255">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-255">Operating system disk</span></span>
<span data-ttu-id="fff10-256">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-256">Disk1</span></span> | <span data-ttu-id="fff10-257">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-257">E:\\</span></span> | <span data-ttu-id="fff10-258">Временное хранилище < /br / >< /br / > Azure добавляет этот диск и назначает hello первая доступная буква диска.</span><span class="sxs-lookup"><span data-stu-id="fff10-258">Temporary storage</br /> </br />Azure adds this disk and assigns hello first available drive letter.</span></span>
<span data-ttu-id="fff10-259">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-259">Disk2</span></span> | <span data-ttu-id="fff10-260">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-260">D:\\</span></span> | <span data-ttu-id="fff10-261">Системная база данных SQL и база данных пользователя Database1</span><span class="sxs-lookup"><span data-stu-id="fff10-261">SQL system database and User Database1</span></span>
<span data-ttu-id="fff10-262">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-262">Disk3</span></span> | <span data-ttu-id="fff10-263">G:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-263">G:\\</span></span> | <span data-ttu-id="fff10-264">База данных пользователя Database2</span><span class="sxs-lookup"><span data-stu-id="fff10-264">User Database2</span></span>


#### <a name="vmware-tooazure"></a><span data-ttu-id="fff10-265">VMware tooAzure</span><span class="sxs-lookup"><span data-stu-id="fff10-265">VMware tooAzure</span></span>
<span data-ttu-id="fff10-266">После завершения восстановления размещения toohello исходное расположение конфигурации диска hello восстановления размещения виртуальной машины не имеет исключенных дисков.</span><span class="sxs-lookup"><span data-stu-id="fff10-266">When failback is done toohello original location, hello failback virtual machine disk configuration does not have excluded disks.</span></span> <span data-ttu-id="fff10-267">Диски, которые были исключены из VMware tooAzure будет недоступен для hello восстановления размещения виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="fff10-267">Disks that were excluded from VMware tooAzure  will not be available on hello failback virtual machine.</span></span>

<span data-ttu-id="fff10-268">После плановой отработки отказа из Azure tooon организациями VMware дискам на виртуальной машине VMWare hello (исходное расположение) будет следующим:</span><span class="sxs-lookup"><span data-stu-id="fff10-268">After planned failover from Azure tooon-premises VMware, disks on hello VMWare virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="fff10-269">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-269">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-270">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-270">**Drive letter**</span></span> | <span data-ttu-id="fff10-271">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-271">**Data type on hello disk**</span></span>
--- | --- | ---
<span data-ttu-id="fff10-272">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-272">DISK0</span></span> | <span data-ttu-id="fff10-273">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-273">C:\\</span></span> | <span data-ttu-id="fff10-274">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-274">Operating system disk</span></span>
<span data-ttu-id="fff10-275">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-275">Disk1</span></span> | <span data-ttu-id="fff10-276">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-276">D:\\</span></span> | <span data-ttu-id="fff10-277">Системная база данных SQL и база данных пользователя Database1</span><span class="sxs-lookup"><span data-stu-id="fff10-277">SQL system database and User Database1</span></span>
<span data-ttu-id="fff10-278">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-278">Disk2</span></span> | <span data-ttu-id="fff10-279">G:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-279">G:\\</span></span> | <span data-ttu-id="fff10-280">База данных пользователя Database2</span><span class="sxs-lookup"><span data-stu-id="fff10-280">User Database2</span></span>

#### <a name="hyper-v-tooazure"></a><span data-ttu-id="fff10-281">TooAzure Hyper-V</span><span class="sxs-lookup"><span data-stu-id="fff10-281">Hyper-V tooAzure</span></span>
<span data-ttu-id="fff10-282">Если восстановление размещения toohello исходное расположение, hello восстановления размещения виртуальной машины диск конфигурации остается hello таким же, что и исходный конфигурация диска виртуальной машины Hyper-v.</span><span class="sxs-lookup"><span data-stu-id="fff10-282">When failback is toohello original location, hello failback virtual machine disk configuration remains hello same as that of original virtual machine disk configuration for Hyper-V.</span></span> <span data-ttu-id="fff10-283">Диски, которые были исключены из tooAzure узла Hyper-V доступны на hello восстановления размещения виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="fff10-283">Disks that were excluded from Hyper-V site tooAzure are available on hello failback virtual machine.</span></span>

<span data-ttu-id="fff10-284">После плановой отработки отказа из Azure tooon организациями Hyper-V дисков на виртуальной машине Hyper-V hello (исходное расположение) будет следующим:</span><span class="sxs-lookup"><span data-stu-id="fff10-284">After planned failover from Azure tooon-premises Hyper-V, disks on hello Hyper-V virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="fff10-285">**Имя диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-285">**Disk Name**</span></span> | <span data-ttu-id="fff10-286">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-286">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-287">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-287">**Drive letter**</span></span> | <span data-ttu-id="fff10-288">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-288">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="fff10-289">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="fff10-289">DB-Disk0-OS</span></span> | <span data-ttu-id="fff10-290">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-290">DISK0</span></span> |   <span data-ttu-id="fff10-291">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-291">C:\\</span></span> | <span data-ttu-id="fff10-292">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-292">Operating system disk</span></span>
<span data-ttu-id="fff10-293">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="fff10-293">DB-Disk1</span></span> | <span data-ttu-id="fff10-294">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-294">Disk1</span></span> | <span data-ttu-id="fff10-295">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-295">D:\\</span></span> | <span data-ttu-id="fff10-296">Системная база данных SQL и база данных пользователя Database1</span><span class="sxs-lookup"><span data-stu-id="fff10-296">SQL system database and User Database1</span></span>
<span data-ttu-id="fff10-297">DB-Disk2 (исключенный из репликации)</span><span class="sxs-lookup"><span data-stu-id="fff10-297">DB-Disk2 (Excluded disk)</span></span> | <span data-ttu-id="fff10-298">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-298">Disk2</span></span> | <span data-ttu-id="fff10-299">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-299">E:\\</span></span> | <span data-ttu-id="fff10-300">Временные файлы</span><span class="sxs-lookup"><span data-stu-id="fff10-300">Temp files</span></span>
<span data-ttu-id="fff10-301">DB-Disk3 (исключенный из репликации)</span><span class="sxs-lookup"><span data-stu-id="fff10-301">DB-Disk3 (Excluded disk)</span></span> | <span data-ttu-id="fff10-302">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-302">Disk3</span></span> | <span data-ttu-id="fff10-303">F:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-303">F:\\</span></span> | <span data-ttu-id="fff10-304">База данных tempdb SQL (путь к папке — F:\MSSQL\Data\)</span><span class="sxs-lookup"><span data-stu-id="fff10-304">SQL tempdb database (folder path(F:\MSSQL\Data\)</span></span>
<span data-ttu-id="fff10-305">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="fff10-305">DB-Disk4</span></span> | <span data-ttu-id="fff10-306">Диск 4</span><span class="sxs-lookup"><span data-stu-id="fff10-306">Disk4</span></span> | <span data-ttu-id="fff10-307">G:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-307">G:\\</span></span> | <span data-ttu-id="fff10-308">База данных пользователя Database2</span><span class="sxs-lookup"><span data-stu-id="fff10-308">User Database2</span></span>


#### <a name="exclude-hello-paging-file-pagefilesys-disk"></a><span data-ttu-id="fff10-309">Исключить дискового файла (pagefile.sys) подкачки hello</span><span class="sxs-lookup"><span data-stu-id="fff10-309">Exclude hello paging file (pagefile.sys) disk</span></span>

<span data-ttu-id="fff10-310">Рассмотрим виртуальную машину с диском с файлом подкачки, который можно исключить из репликации.</span><span class="sxs-lookup"><span data-stu-id="fff10-310">Let's consider a virtual machine that has a paging file disk that can be excluded.</span></span>
<span data-ttu-id="fff10-311">Есть два способа.</span><span class="sxs-lookup"><span data-stu-id="fff10-311">There are two cases.</span></span>

#### <a name="case-1-hello-paging-file-is-configured-on-hello-d-drive"></a><span data-ttu-id="fff10-312">Вариант 1: файл подкачки hello настроен на диске D: hello</span><span class="sxs-lookup"><span data-stu-id="fff10-312">Case 1: hello paging file is configured on hello D: drive</span></span>
<span data-ttu-id="fff10-313">Ниже приведен конфигурации диска hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-313">Here's hello disk configuration:</span></span>


<span data-ttu-id="fff10-314">**Имя диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-314">**Disk name**</span></span> | <span data-ttu-id="fff10-315">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-315">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-316">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-316">**Drive letter**</span></span> | <span data-ttu-id="fff10-317">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-317">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="fff10-318">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="fff10-318">DB-Disk0-OS</span></span> | <span data-ttu-id="fff10-319">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-319">DISK0</span></span> | <span data-ttu-id="fff10-320">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-320">C:\\</span></span> | <span data-ttu-id="fff10-321">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-321">Operating system disk</span></span>
<span data-ttu-id="fff10-322">DB-диск 1 (диск hello исключенных из защиты hello)</span><span class="sxs-lookup"><span data-stu-id="fff10-322">DB-Disk1 (Excluded hello disk from hello protection)</span></span> | <span data-ttu-id="fff10-323">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-323">Disk1</span></span> | <span data-ttu-id="fff10-324">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-324">D:\\</span></span> | <span data-ttu-id="fff10-325">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="fff10-325">pagefile.sys</span></span>
<span data-ttu-id="fff10-326">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="fff10-326">DB-Disk2</span></span> | <span data-ttu-id="fff10-327">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-327">Disk2</span></span> | <span data-ttu-id="fff10-328">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-328">E:\\</span></span> | <span data-ttu-id="fff10-329">Пользовательские данные 1</span><span class="sxs-lookup"><span data-stu-id="fff10-329">User data 1</span></span>
<span data-ttu-id="fff10-330">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="fff10-330">DB-Disk3</span></span> | <span data-ttu-id="fff10-331">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-331">Disk3</span></span> | <span data-ttu-id="fff10-332">F:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-332">F:\\</span></span> | <span data-ttu-id="fff10-333">Пользовательские данные 2</span><span class="sxs-lookup"><span data-stu-id="fff10-333">User data 2</span></span>

<span data-ttu-id="fff10-334">Ниже приведены hello параметров файла подкачки на hello исходной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="fff10-334">Here are hello paging file settings on hello source virtual machine:</span></span>

![Параметры файла подкачки на исходной виртуальной машине](./media/site-recovery-exclude-disk/pagefile-on-d-drive-sourceVM.png)


<span data-ttu-id="fff10-336">После отработки отказа виртуальной машины hello с VMware tooAzure или tooAzure Hyper-V дисков на виртуальной машине Azure hello выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="fff10-336">After failover of hello virtual machine from VMware tooAzure or Hyper-V tooAzure, disks on hello Azure virtual machine are as follows:</span></span>

<span data-ttu-id="fff10-337">**Имя диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-337">**Disk name**</span></span> | <span data-ttu-id="fff10-338">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-338">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-339">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-339">**Drive letter**</span></span> | <span data-ttu-id="fff10-340">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-340">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="fff10-341">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="fff10-341">DB-Disk0-OS</span></span> | <span data-ttu-id="fff10-342">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-342">DISK0</span></span> | <span data-ttu-id="fff10-343">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-343">C:\\</span></span> | <span data-ttu-id="fff10-344">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-344">Operating system disk</span></span>
<span data-ttu-id="fff10-345">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="fff10-345">DB-Disk1</span></span> | <span data-ttu-id="fff10-346">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-346">Disk1</span></span> | <span data-ttu-id="fff10-347">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-347">D:\\</span></span> | <span data-ttu-id="fff10-348">Временное хранилище</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="fff10-348">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="fff10-349">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="fff10-349">DB-Disk2</span></span> | <span data-ttu-id="fff10-350">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-350">Disk2</span></span> | <span data-ttu-id="fff10-351">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-351">E:\\</span></span> | <span data-ttu-id="fff10-352">Пользовательские данные 1</span><span class="sxs-lookup"><span data-stu-id="fff10-352">User data 1</span></span>
<span data-ttu-id="fff10-353">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="fff10-353">DB-Disk3</span></span> | <span data-ttu-id="fff10-354">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-354">Disk3</span></span> | <span data-ttu-id="fff10-355">F:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-355">F:\\</span></span> | <span data-ttu-id="fff10-356">Пользовательские данные 2</span><span class="sxs-lookup"><span data-stu-id="fff10-356">User data 2</span></span>

<span data-ttu-id="fff10-357">Поскольку диск 1 (D:) была исключена, D: является hello первую букву диска из списка доступных hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-357">Because Disk1 (D:) was excluded, D: is hello first drive letter from hello available list.</span></span> <span data-ttu-id="fff10-358">Azure назначает D: объемом временного хранилища toohello.</span><span class="sxs-lookup"><span data-stu-id="fff10-358">Azure assigns D: toohello temporary storage volume.</span></span> <span data-ttu-id="fff10-359">Поскольку виртуальная машина Azure hello D:, hello hello файла подкачки hello виртуальной машины остается таким же.</span><span class="sxs-lookup"><span data-stu-id="fff10-359">Because D: is available on hello Azure virtual machine, hello paging file setting of hello virtual machine remains hello same.</span></span>

<span data-ttu-id="fff10-360">Ниже приведены hello параметров файла подкачки на виртуальной машине Azure hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-360">Here are hello paging file settings on hello Azure virtual machine:</span></span>

![Параметры файла подкачки на виртуальной машине Azure](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover.png)

#### <a name="case-2-hello-paging-file-is-configured-on-another-drive-other-than-d-drive"></a><span data-ttu-id="fff10-362">Вариант 2: файл подкачки hello настроен на другом диске (кроме диск D:)</span><span class="sxs-lookup"><span data-stu-id="fff10-362">Case 2: hello paging file is configured on another drive (other than D: drive)</span></span>

<span data-ttu-id="fff10-363">Ниже приведен конфигурации диска hello исходной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="fff10-363">Here's hello source virtual machine disk configuration:</span></span>

<span data-ttu-id="fff10-364">**Имя диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-364">**Disk name**</span></span> | <span data-ttu-id="fff10-365">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-365">**Guest operating system disk#**</span></span> | <span data-ttu-id="fff10-366">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-366">**Drive letter**</span></span> | <span data-ttu-id="fff10-367">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-367">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="fff10-368">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="fff10-368">DB-Disk0-OS</span></span> | <span data-ttu-id="fff10-369">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-369">DISK0</span></span> | <span data-ttu-id="fff10-370">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-370">C:\\</span></span> | <span data-ttu-id="fff10-371">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-371">Operating system disk</span></span>
<span data-ttu-id="fff10-372">DB-диск 1 (диск hello исключенных из защиты)</span><span class="sxs-lookup"><span data-stu-id="fff10-372">DB-Disk1 (Excluded hello disk from protection)</span></span> | <span data-ttu-id="fff10-373">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-373">Disk1</span></span> | <span data-ttu-id="fff10-374">G:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-374">G:\\</span></span> | <span data-ttu-id="fff10-375">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="fff10-375">pagefile.sys</span></span>
<span data-ttu-id="fff10-376">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="fff10-376">DB-Disk2</span></span> | <span data-ttu-id="fff10-377">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-377">Disk2</span></span> | <span data-ttu-id="fff10-378">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-378">E:\\</span></span> | <span data-ttu-id="fff10-379">Пользовательские данные 1</span><span class="sxs-lookup"><span data-stu-id="fff10-379">User data 1</span></span>
<span data-ttu-id="fff10-380">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="fff10-380">DB-Disk3</span></span> | <span data-ttu-id="fff10-381">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-381">Disk3</span></span> | <span data-ttu-id="fff10-382">F:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-382">F:\\</span></span> | <span data-ttu-id="fff10-383">Пользовательские данные 2</span><span class="sxs-lookup"><span data-stu-id="fff10-383">User data 2</span></span>

<span data-ttu-id="fff10-384">Ниже приведены hello параметров файла подкачки на hello локальной виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="fff10-384">Here are hello paging file settings on hello on-premises virtual machine:</span></span>

![Разбивка на страницы параметров файла на виртуальной машине hello в локальной среде](./media/site-recovery-exclude-disk/pagefile-on-g-drive-sourceVM.png)

<span data-ttu-id="fff10-386">После отработки отказа виртуальной машины hello с VMware или Hyper-V tooAzure дисков на виртуальной машине Azure hello выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="fff10-386">After failover of hello virtual machine from VMware/Hyper-V tooAzure, disks on hello Azure virtual machine are as follows:</span></span>

<span data-ttu-id="fff10-387">**Имя диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-387">**Disk name**</span></span>| <span data-ttu-id="fff10-388">**№ диска операционной системы на виртуальной машине**</span><span class="sxs-lookup"><span data-stu-id="fff10-388">**Guest operating system disk#**</span></span>| <span data-ttu-id="fff10-389">**Буква диска**</span><span class="sxs-lookup"><span data-stu-id="fff10-389">**Drive letter**</span></span> | <span data-ttu-id="fff10-390">**Тип данных на диске hello**</span><span class="sxs-lookup"><span data-stu-id="fff10-390">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="fff10-391">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="fff10-391">DB-Disk0-OS</span></span> | <span data-ttu-id="fff10-392">Диск 0</span><span class="sxs-lookup"><span data-stu-id="fff10-392">DISK0</span></span>  |<span data-ttu-id="fff10-393">C:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-393">C:\\</span></span> |<span data-ttu-id="fff10-394">Диск операционной системы</span><span class="sxs-lookup"><span data-stu-id="fff10-394">Operating system disk</span></span>
<span data-ttu-id="fff10-395">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="fff10-395">DB-Disk1</span></span> | <span data-ttu-id="fff10-396">Диск 1</span><span class="sxs-lookup"><span data-stu-id="fff10-396">Disk1</span></span> | <span data-ttu-id="fff10-397">D:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-397">D:\\</span></span> | <span data-ttu-id="fff10-398">Временное хранилище</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="fff10-398">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="fff10-399">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="fff10-399">DB-Disk2</span></span> | <span data-ttu-id="fff10-400">Диск 2</span><span class="sxs-lookup"><span data-stu-id="fff10-400">Disk2</span></span> | <span data-ttu-id="fff10-401">E:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-401">E:\\</span></span> | <span data-ttu-id="fff10-402">Пользовательские данные 1</span><span class="sxs-lookup"><span data-stu-id="fff10-402">User data 1</span></span>
<span data-ttu-id="fff10-403">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="fff10-403">DB-Disk3</span></span> | <span data-ttu-id="fff10-404">Диск 3</span><span class="sxs-lookup"><span data-stu-id="fff10-404">Disk3</span></span> | <span data-ttu-id="fff10-405">F:\\</span><span class="sxs-lookup"><span data-stu-id="fff10-405">F:\\</span></span> | <span data-ttu-id="fff10-406">Пользовательские данные 2</span><span class="sxs-lookup"><span data-stu-id="fff10-406">User data 2</span></span>

<span data-ttu-id="fff10-407">Поскольку D: hello первая буква диска из списка доступных hello, Azure назначает D: объемом временного хранилища toohello.</span><span class="sxs-lookup"><span data-stu-id="fff10-407">Because D: is hello first drive letter from available hello list, Azure assigns D: toohello temporary storage volume.</span></span> <span data-ttu-id="fff10-408">Для всех дисков hello репликации остается букву диска hello hello таким же.</span><span class="sxs-lookup"><span data-stu-id="fff10-408">For all hello replicated disks, hello drive letter remains hello same.</span></span> <span data-ttu-id="fff10-409">Поскольку hello G: диск недоступен, hello система будет использовать диск C: hello для hello, файл подкачки.</span><span class="sxs-lookup"><span data-stu-id="fff10-409">Because hello G: disk is not available, hello system will use hello C: drive for hello paging file.</span></span>

<span data-ttu-id="fff10-410">Ниже приведены hello параметров файла подкачки на виртуальной машине Azure hello.</span><span class="sxs-lookup"><span data-stu-id="fff10-410">Here are hello paging file settings on hello Azure virtual machine:</span></span>

![Параметры файла подкачки на виртуальной машине Azure](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover-2.png)

## <a name="next-steps"></a><span data-ttu-id="fff10-412">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="fff10-412">Next steps</span></span>
<span data-ttu-id="fff10-413">Настроив и запустив развертывание, вы можете ознакомиться с [дополнительными сведениями](site-recovery-failover.md) о различных типах обработки отказа.</span><span class="sxs-lookup"><span data-stu-id="fff10-413">After your deployment is set up and running, [learn more](site-recovery-failover.md) about different types of failover.</span></span>
