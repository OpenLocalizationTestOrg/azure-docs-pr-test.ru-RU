---
title: "aaaPlan емкости и масштабирования для VMware tooAzure репликации с помощью Azure Site Recovery | Документы Microsoft"
description: "Использование этой статьи tooplan емкости и масштабирования, при репликации виртуальных машин VMware tooAzure с Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: 0a1cd8eb-a8f7-4228-ab84-9449e0b2887b
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 05/24/2017
ms.author: rayne
ms.openlocfilehash: 7ca9147d1b4611f6b4a67c3de3f27fb9878f4c4f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="plan-capacity-and-scaling-for-vmware-replication-with-azure-site-recovery"></a>Планирование загрузки и масштабирования для репликации из VMware с помощью Azure Site Recovery

Использование этой статьи toofigure Планирование емкости и масштабирования, когда репликация локальных виртуальных машин VMware и физических серверов tooAzure с [Azure Site Recovery](site-recovery-overview.md).

## <a name="how-do-i-start-capacity-planning"></a>С чего начать планирование загрузки?

Соберите сведения об среды репликации, выполнив hello [планировщик развертывания восстановления сайта Azure](https://aka.ms/asr-deployment-planner-doc) для репликации VMware. См. [дополнительные сведения](site-recovery-deployment-planner.md) об этом средстве. Планировщик поможет вам собрать данные о виртуальных машинах (совместимых и несовместимых), дисках на каждой виртуальной машине и обновлениях данных на каждом диске. Средство Hello также рассматриваются требования к пропускной способности сети и hello инфраструктуры Azure, необходимые для успешной отработке отказа репликации и тестирования.

## <a name="capacity-considerations"></a>Рекомендации по емкости

**Компонент** | **Дополнительные сведения** |
--- | --- | ---
**Репликация** | **Максимальная скорость ежедневного изменения:** защищенного компьютера можно использовать только один сервер обработки, и один процесс сервера может обрабатывать ежедневного скорость изменения копии too2 ТБ. Таким образом 2 ТБ — hello Максимальная частота ежедневного изменения данных, поддерживаемый для защищенного компьютера.<br/><br/> **Максимальная пропускная способность:** реплицированной машины могут принадлежать tooone учетной записи хранилища в Azure. Стандартная учетная запись хранения может обрабатывать более 20 000 запросов в секунду, и мы рекомендуем обеспечить hello число операций ввода вывода в секунду (IOPS) с различными too20 исходного компьютера, 000. Например если исходная машина с 5 дисками и каждого диска приводит к возникновению ошибки 120 операций ввода-ВЫВОДА (размером 8 КБ) на исходном компьютере hello, затем он будет в течение hello Azure предел операций ввода-ВЫВОДА диска 500. (hello необходимые учетные записи хранения не равно toohello общее компьютере-источнике операций ввода-ВЫВОДА, разделенное на 20 000.)
**Сервер конфигурации** | Сервер конфигурации Hello должны быть может toohandle hello ежедневной изменение скорости мощности на всех рабочих нагрузок на защищенные виртуальные машины, а должен достаточно toocontinuously пропускной способности реплицировать tooAzure данных хранилища.<br/><br/> Рекомендуется, найдите сервер конфигурации hello в hello одной сети и сегмент локальной сети как hello требуется tooprotect машины. Он может располагаться на другую сеть, но требуется tooprotect должны иметь tooit видимость слоя 3 сетевых компьютеров.<br/><br/> Размер рекомендации по конфигурации сервера hello, приведены в таблице hello в следующем разделе hello.
**Сервер обработки** | Первый сервер обработки Hello устанавливается по умолчанию на сервере конфигурации hello. Можно развернуть серверы tooscale дополнительных процессов среды. <br/><br/> сервер обработки Hello получает данные репликации из защищенных машин и выполняет оптимизацию для кэширования, сжатия и шифрования. Затем он отправляет данные tooAzure hello. машины server процесса Hello должен иметь достаточно ресурсов tooperform эти задачи.<br/><br/> сервер обработки Hello использует дисковый кэш. Используйте отдельный кэш диск 600 ГБ или более изменений toohandle данных, хранящихся в hello событие является узким местом в сети или простоя.

## <a name="size-recommendations-for-hello-configuration-server"></a>Размер рекомендации по конфигурации сервера hello

**ЦП** | **Память** | **Размер диска кэша** | **Частота изменения данных** | **Защищенные компьютеры**
--- | --- | --- | --- | ---
8 виртуальных ЦП (2 сокета * 4 ядра с частотой 2,5 ГГц) | 16 ГБ | 300 ГБ | 500 ГБ или менее | Репликация не более 100 компьютеров
12 виртуальных ЦП (2 сокета * 6 ядер с частотой 2,5 ГГц) | 18 ГБ | 600 ГБ | 500 ГБ too1 ТБ | Репликация от 100 до 150 компьютеров
16 виртуальных ЦП (2 сокета * 8 ядер с частотой 2,5 ГГц) | 32 ГБ | 1 TБ | 1 ТБ too2 ТБ | Репликация от 150 до 200 компьютеров
Разверните другой сервер обработки | | | Более 2 ТБ | Разверните серверы дополнительной обработки, если выполняется репликация более чем 200 компьютеров, или если hello ежедневного изменения данных частота превышает 2 ТБ.

Описание

* Для каждого исходного компьютера настраивается 3 диска объемом по 100 ГБ каждый.
* Чтобы измерить показатели диска кэша, мы использовали хранилище для тестирования производительности с 8 дисками SAS с частотой вращения шпинделя 10 000 об/мин в конфигурации RAID 10.

## <a name="size-recommendations-for-hello-process-server"></a>Размер рекомендации для сервера обработки hello

Если необходимо tooprotect более чем 200 компьютеров, или скорость изменения ежедневного hello больше 2 ТБ, можно добавить процесс серверов toohandle hello репликации нагрузки. tooscale ожидания, можно сделать следующее.

* Увеличьте число hello конфигурации серверов. Например можно защитить too400 машин с использованием двух серверов конфигурации.
* Добавьте дополнительные серверы обработки и используйте эти toohandle трафика вместо (или в дополнение к) hello конфигурации сервера.

Привет, в следующей таблице описаны сценарий, в котором:

* Сервер конфигурации hello toouse что и сервер обработки не планируется.
* Вы настроили дополнительный сервер обработки.
* Вы настроили сервер дополнительной обработки hello toouse защищенных виртуальных машин.
* Для каждого защищенного исходного компьютера настраивается три диска объемом 100 ГБ каждый.

**Сервер конфигурации** | **Дополнительный сервер обработки** | **Размер диска кэша** | **Частота изменения данных** | **Защищенные компьютеры**
--- | --- | --- | --- | ---
8 виртуальных ЦП (2 сокета * 4 ядра с частотой 2,5 ГГц), 16 ГБ памяти | 4 виртуальных ЦП (2 сокета * 2 ядра с частотой 2,5 ГГц), 8 ГБ памяти | 300 ГБ | 250 ГБ или менее | Вы можете реплицировать до 85 компьютеров.
8 виртуальных ЦП (2 сокета * 4 ядра с частотой 2,5 ГГц), 16 ГБ памяти | 8 виртуальных ЦП (2 сокета * 4 ядра с частотой 2,5 ГГц), 12 ГБ памяти | 600 ГБ | 250 ГБ too1 ТБ | Репликация от 85 до 150 компьютеров
12 виртуальных ЦП (2 сокета * 6 ядер с частотой 2,5 ГГц), 18 ГБ памяти | 12 виртуальных ЦП (2 сокета * 6 ядер с частотой 2,5 ГГц), 24 ГБ памяти | 1 TБ | 1 ТБ too2 ТБ | Репликация от 150 до 225 компьютеров

Hello способом, в котором масштабировать серверы зависит от настроек для масштабирования, вертикального или горизонтального масштабирования модели.  Вы можете увеличить масштаб, развернув несколько современных серверов конфигурации и обработки, или выполнить развертывание, развернув несколько серверов с меньшим объемом ресурсов. Например при необходимости машин 220 tooprotect, можно выполнить одно из следующих hello:

* Настройка сервера конфигурации hello с 12 виртуальных процессоров, 18 ГБ памяти и сервере дополнительных процесса с 12 виртуальных процессоров, 24 ГБ памяти. Настройте сервер обработки дополнительных hello toouse защищенные виртуальные машины только.
* Настройка двух серверов конфигурации (2 x 8 виртуальных процессоров, 16 ГБ ОЗУ) и два дополнительных процессов сервера (1 x 8 виртуальных процессоров и 4 виртуальных процессора x 1 toohandle 135 + 85 [220] машины). Настройте серверы обработки дополнительных hello toouse защищенные виртуальные машины только.


## <a name="control-network-bandwidth"></a>Управление пропускной способностью сети

После использовали hello [планировщика развертывания hello](site-recovery-deployment-planner.md) пропускной способности toocalculate hello, необходимые для репликации (hello начальной репликации и затем дельта), можно управлять hello объем пропускной способности, используемой для репликации, несколько из вариантов:

* **Регулирование полосы пропускания**: VMware данные, реплицируемые tooAzure направляются через сервер определенного процесса. Может регулировать пропускную способность hello компьютеров, работающих как серверы обработки.
* **Повлиять на пропускную способность**: вы можете влиять hello пропускной способности, используемой для репликации, используя несколько разделов реестра:
  * Hello **Backup\UploadThreadsPerVM Azure параметру** значение реестра указывает hello количество потоков, используемых для передачи данных (репликация исходного или разностные) диска. Более высокое значение повышает пропускную способность сети hello, используемым для репликации.
  * Hello **Backup\DownloadThreadsPerVM Azure параметру** указывает hello количество потоков, используемых для передачи данных во время восстановления размещения.

### <a name="throttle-bandwidth"></a>Регулирование пропускной способности

1. Откройте hello оснастки MMC службы архивации Azure на машине действующего hello от сервера обработки hello. По умолчанию ярлык для резервного копирования доступен на рабочем столе hello, или в следующие папки hello: C:\Program Files\Microsoft Azure Recovery Services Agent\bin\wabadmin.
2. В оснастке hello, нажмите кнопку **изменить свойства**.

    ![Снимок экрана из Azure Backup MMC оснастку toochange свойств](./media/site-recovery-vmware-to-azure/throttle1.png)
3. На hello **регулирование** выберите **включить регулирования для операций резервного копирования использование пропускной способности Интернета**. Hello установить предельные значения для рабочих и нерабочих часов. Допустимые диапазоны: от 512 Кбит/с too102 Мбит/с в секунду.

    ![Снимок экрана с диалоговым окном свойства службы архивации Azure](./media/site-recovery-vmware-to-azure/throttle2.png)

Можно также использовать hello [Set-OBMachineSetting](https://technet.microsoft.com/library/hh770409.aspx) регулирования tooset командлета. Рассмотрим пример:

    $mon = [System.DayOfWeek]::Monday
    $tue = [System.DayOfWeek]::Tuesday
    Set-OBMachineSetting -WorkDay $mon, $tue -StartWorkHour "9:00:00" -EndWorkHour "18:00:00" -WorkHourBandwidth  (512*1024) -NonWorkHourBandwidth (2048*1024)

**Set-OBMachineSetting -NoThrottle** указывает, что регулирование не требуется.

### <a name="influence-network-bandwidth-for-a-vm"></a>Изменение пропускной способности сети для виртуальной машины

1. В реестре виртуальной Машины hello перейдите слишком**Backup\Replication Azure параметру**.
   * tooinfluence hello пропускную способность трафика на репликацию диска, измените значение hello **UploadThreadsPerVM**, или создать ключ hello в том случае, если он не существует.
   * пропускная способность hello tooinfluence для восстановления размещения трафик из Azure, измените значение hello **DownloadThreadsPerVM**.
2. значение по умолчанию Hello — 4. В сети «избыточная Подготовка» следует изменить эти разделы реестра из значения по умолчанию hello. Hello максимальное — 32. Мониторинг трафика toooptimize hello значение.


## <a name="deploy-additional-process-servers"></a>Развертывание дополнительных серверов обработки

При наличии tooscale out развертывания за пределы 200 исходных компьютеров, или у вас есть всего ежедневно обработка скорость более 2 ТБ, необходимо объем трафика hello toohandle серверы дополнительные процедуры. Выполните эти инструкции tooset hello процесса сервера. После настройки сервера hello, переносе исходной машины toouse его.

1. В **серверы Site Recovery**выберите сервер конфигурации hello и нажмите кнопку **сервера обработки**.

    ![Снимок экрана Site Recovery серверов параметр tooadd сервера обработки](./media/site-recovery-vmware-to-azure/migrate-ps1.png)
2. В поле **Тип сервера** щелкните **Process server (on-premises)** (Сервер обработки (локальный)).

    ![Снимок экрана с диалоговым окном "Сервер обработки"](./media/site-recovery-vmware-to-azure/migrate-ps2.png)
3. Загрузите файл hello установка единой Site Recovery и запустите его tooinstall hello процесса сервера. Это также регистрирует его в хранилище hello.
4. В **перед началом**выберите **Добавление дополнительных процессов tooscale серверы out развертывания**.
5. Мастер завершения hello в hello так же, как если вы [Настройка](#step-2-set-up-the-source-environment) hello конфигурации сервера.

    ![Снимок экрана с мастером единой установки Azure Site Recovery](./media/site-recovery-vmware-to-azure/add-ps1.png)
6. В **сведения о сервере конфигурации**, укажите hello IP-адрес сервера конфигурации hello и hello парольную фразу. Парольная фраза hello tooobtain, запустите **[SiteRecoveryInstallationFolder]\home\sysystems\bin\genpassphrase.exe – n** на сервере конфигурации hello.

    ![Снимок экрана со страницей сведений о сервере конфигурации](./media/site-recovery-vmware-to-azure/add-ps2.png)

### <a name="migrate-machines-toouse-hello-new-process-server"></a>Перенос нового сервера обработки компьютеры toouse hello
1. В **параметры** > **серверы Site Recovery**, выберите сервер конфигурации hello, а затем разверните **обработки серверов**.

    ![Снимок экрана с диалоговым окном "Сервер обработки"](./media/site-recovery-vmware-to-azure/migrate-ps2.png)
2. Щелкните правой кнопкой мыши сервер обработки hello в настоящий момент и нажмите кнопку **коммутатор**.

    ![Снимок экрана с диалоговым окном "Сервер конфигурации"](./media/site-recovery-vmware-to-azure/migrate-ps3.png)
3. В **выберите целевой сервер обработки**выберите hello нового сервера обработки toouse и затем выберите hello виртуальных машин будет обрабатывать этот сервер hello. Щелкните hello значок tooget сведения о сервере hello. toohelp следует расположить загрузки решения hello среднее пространство, которое требуется tooreplicate отображается каждой выбранной виртуальной машины toohello нового сервера обработки. Щелкните флажок toostart hello, репликация toohello нового сервера обработки.


## <a name="next-steps"></a>Дальнейшие действия

Загрузите и запустите hello [планировщик развертывания восстановления сайта Azure](https://aka.ms/asr-deployment-planner)
