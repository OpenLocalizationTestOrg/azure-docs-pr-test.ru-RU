---
title: "Создание планов восстановления для отработки отказа и восстановления в Azure Site Recovery | Документация Майкрософт"
description: "В этой статье описывается создание и настройка планов восстановления в Azure Site Recovery для отработки отказа и восстановления виртуальных машин и физических серверов."
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: 72408c62-fcb6-4ee2-8ff5-cab1218773f2
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/23/2017
ms.author: raynew
ms.openlocfilehash: 1b0d64cd592c4738311797b826e490639340f92a
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="create-recovery-plans"></a><span data-ttu-id="c730d-103">Создание планов восстановления</span><span class="sxs-lookup"><span data-stu-id="c730d-103">Create recovery plans</span></span>


<span data-ttu-id="c730d-104">В этой статье содержится информация о создании и настройке планов восстановления в [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c730d-104">This article provides information about creating and customizing recovery plans in [Azure Site Recovery](site-recovery-overview.md).</span></span>

<span data-ttu-id="c730d-105">Комментарии или вопросы можно добавить в конце этой статьи или на [форуме по службам восстановления Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="c730d-105">Post any comments or questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

 <span data-ttu-id="c730d-106">Созданные планы восстановления делают следующее:</span><span class="sxs-lookup"><span data-stu-id="c730d-106">Create recovery plans to do the following:</span></span>

* <span data-ttu-id="c730d-107">Определяют группы компьютеров, для которых отработка отказа и запуск выполняются одновременно.</span><span class="sxs-lookup"><span data-stu-id="c730d-107">Define groups of machines that fail over together, and then start up together.</span></span>
* <span data-ttu-id="c730d-108">Моделируют зависимости между компьютерами, объединяя их в группы плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-108">Model dependencies between machines, by grouping them together into a recovery plan group.</span></span> <span data-ttu-id="c730d-109">Например, если отработка отказа и восстановление выполняются для конкретного приложения, все виртуальные машины этого приложения следует объединить в одну группу плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-109">For example, to fail over and bring up a specific application, you group all of the VMs for that application into the same recovery plan group.</span></span>
* <span data-ttu-id="c730d-110">Выполняют отработку отказа.</span><span class="sxs-lookup"><span data-stu-id="c730d-110">Run a failover.</span></span> <span data-ttu-id="c730d-111">Вы можете запустить тестовую, плановую или внеплановую отработку отказа в плане восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-111">You can run a test, planned, or unplanned failover on a recovery plan.</span></span>


## <a name="create-a-recovery-plan"></a><span data-ttu-id="c730d-112">Создайте план восстановления</span><span class="sxs-lookup"><span data-stu-id="c730d-112">Create a recovery plan</span></span>

1. <span data-ttu-id="c730d-113">Щелкните **Планы восстановления** > **Создать план восстановления**.</span><span class="sxs-lookup"><span data-stu-id="c730d-113">Click **Recovery Plans** > **Create Recovery Plan**.</span></span>
   <span data-ttu-id="c730d-114">Укажите имя плана восстановления, а также исходный и целевой серверы.</span><span class="sxs-lookup"><span data-stu-id="c730d-114">Specify a name for the recovery plan, and a source and target.</span></span> <span data-ttu-id="c730d-115">Исходное расположение должно содержать виртуальные машины, на которых настроены отработка отказа и восстановление.</span><span class="sxs-lookup"><span data-stu-id="c730d-115">The source location must have virtual machines that are enabled for failover and recovery.</span></span>

    - <span data-ttu-id="c730d-116">Для репликации между серверами VMM выберите **Тип источника** > **VMM**, а также укажите исходный и целевой серверы VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-116">For VMM to VMM replication, select **Source Type** > **VMM**, and the source and target VMM servers.</span></span> <span data-ttu-id="c730d-117">Щелкните **Hyper-V**, чтобы просмотреть защищенные облака.</span><span class="sxs-lookup"><span data-stu-id="c730d-117">Click **Hyper-V** to see clouds that are protected.</span></span>
    - <span data-ttu-id="c730d-118">Для репликации из VMM в Azure выберите **Тип источника** > **VMM**.</span><span class="sxs-lookup"><span data-stu-id="c730d-118">For VMM to Azure, select **Source Type** > **VMM**.</span></span>  <span data-ttu-id="c730d-119">Затем выберите исходный сервер VMM, а в качестве целевого сервера — **Azure**.</span><span class="sxs-lookup"><span data-stu-id="c730d-119">Select the source VMM server, and **Azure** as the target.</span></span>
    - <span data-ttu-id="c730d-120">Для репликации Hyper-V в Azure (без использования VMM), выберите **Тип источника** > **Узел Hyper-V**.</span><span class="sxs-lookup"><span data-stu-id="c730d-120">For Hyper-V replication to Azure (without VMM), select **Source Type** > **Hyper-V site**.</span></span> <span data-ttu-id="c730d-121">Выберите нужный сайт в качестве источника, а в качестве целевого сервера — **Azure**.</span><span class="sxs-lookup"><span data-stu-id="c730d-121">Select the site as the source, and **Azure** as the target.</span></span>
    - <span data-ttu-id="c730d-122">Для репликации виртуальной машины VMware или локального физического сервера в Azure выберите в качестве источника сервер конфигурации, а в качестве целевого сервера — **Azure**.</span><span class="sxs-lookup"><span data-stu-id="c730d-122">For a VMware VM or a physical on-premises server to Azure, select a configuration server as the source, and **Azure** as the target.</span></span>
    - <span data-ttu-id="c730d-123">Для плана восстановления из Azure в Azure выберите регион Azure, который является источником, и вторичный регион Azure, который является целевым.</span><span class="sxs-lookup"><span data-stu-id="c730d-123">For a Azure to Azure recovery plan, select a Azure region as the source, and a secondary Azure region as the target.</span></span> <span data-ttu-id="c730d-124">Ко вторичным регионам Azure относятся только регионы, в которых защищены виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="c730d-124">The secondary Azure regions are only those to which virtual machines are protected.</span></span>
2. <span data-ttu-id="c730d-125">В окне **Выбор виртуальных машин** укажите виртуальные машины (или группу репликации), которые хотите добавить в группу по умолчанию (Group 1) в плане восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-125">In **Select virtual machines**, select the virtual machines (or replication group) that you want to add to the default group (Group 1) in the recovery plan.</span></span>

## <a name="customize-and-extend-recovery-plans"></a><span data-ttu-id="c730d-126">Настройка и расширение планов восстановления</span><span class="sxs-lookup"><span data-stu-id="c730d-126">Customize and extend recovery plans</span></span>

<span data-ttu-id="c730d-127">Вы можете настраивать и расширять планы восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-127">You can customize and extend recovery plans:</span></span>

- <span data-ttu-id="c730d-128">**Добавление новых групп**. Кроме группы по умолчанию, в план восстановления можно добавить до семи дополнительных групп, а затем добавлять в них виртуальные машины или группы репликации.</span><span class="sxs-lookup"><span data-stu-id="c730d-128">**Add new groups**—Add additional recovery plan groups (up to seven) to the default group, and then add more machines or replication groups to those recovery plan groups.</span></span> <span data-ttu-id="c730d-129">Новые группы нумеруются в порядке добавления.</span><span class="sxs-lookup"><span data-stu-id="c730d-129">Groups are numbered in the order in which you add them.</span></span> <span data-ttu-id="c730d-130">Каждую виртуальную машину или группу репликации можно включить только в одну группу плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-130">A virtual machine, or replication group, can only be included in one recovery plan group.</span></span>
- <span data-ttu-id="c730d-131">**Добавление ручного действия**. Вы можете добавить ручные действия, выполняемые до или после группы плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-131">**Add a manual action**—You can add manual actions that run before or after a recovery plan group.</span></span> <span data-ttu-id="c730d-132">При выполнении план восстановления он останавливается в той точке, куда вы добавили выполняемое вручную действие.</span><span class="sxs-lookup"><span data-stu-id="c730d-132">When the recovery plan runs, it stops at the point at which you inserted the manual action.</span></span> <span data-ttu-id="c730d-133">При этом появляется диалоговое окно с предложением подтвердить, что это действие выполнено вручную.</span><span class="sxs-lookup"><span data-stu-id="c730d-133">A dialog box prompts you to specify that the manual action was completed.</span></span>
- <span data-ttu-id="c730d-134">**Добавление скрипта**. Вы можете добавить скрипты, выполняемые до или после группы плана восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-134">**Add a script**—You can add scripts that run before or after a recovery plan group.</span></span> <span data-ttu-id="c730d-135">Каждый новый скрипт добавляет к группе новый набор действий.</span><span class="sxs-lookup"><span data-stu-id="c730d-135">When you add a script, it adds a new set of actions for the group.</span></span> <span data-ttu-id="c730d-136">Например, для группы с именем "Group 1" создается набор предварительных действий с именем "Group 1: Pre-steps".</span><span class="sxs-lookup"><span data-stu-id="c730d-136">For example, a set of pre-steps for Group 1 will be created with the name: Group 1: pre-steps.</span></span> <span data-ttu-id="c730d-137">Все предварительные действия будут перечислены в этом наборе.</span><span class="sxs-lookup"><span data-stu-id="c730d-137">All pre-steps will be listed inside this set.</span></span> <span data-ttu-id="c730d-138">Чтобы добавить скрипт, на основном сайте должен быть развернут сервер VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-138">You can only add a script on the primary site if you have a VMM server deployed.</span></span>
- <span data-ttu-id="c730d-139">**Добавление модулей Runbook Azure**.Чтобы расширить план восстановления, вы можете применить модули Runbook Azure.</span><span class="sxs-lookup"><span data-stu-id="c730d-139">**Add Azure runbooks**—You can extend recovery plans with Azure runbooks.</span></span> <span data-ttu-id="c730d-140">Они позволяют автоматизировать задачи или выполнять пошаговое восстановление.</span><span class="sxs-lookup"><span data-stu-id="c730d-140">For example, to automate tasks, or to create single-step recovery.</span></span> <span data-ttu-id="c730d-141">[Подробнее](site-recovery-runbook-automation.md).</span><span class="sxs-lookup"><span data-stu-id="c730d-141">[Learn more](site-recovery-runbook-automation.md).</span></span>

## <a name="add-scripts"></a><span data-ttu-id="c730d-142">Добавление скриптов</span><span class="sxs-lookup"><span data-stu-id="c730d-142">Add scripts</span></span>

<span data-ttu-id="c730d-143">В планах восстановления можно использовать скрипты PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c730d-143">You can use PowerShell scripts in your recovery plans.</span></span>

 - <span data-ttu-id="c730d-144">Для аккуратной обработки исключений сценарии должны включать блоки try-catch.</span><span class="sxs-lookup"><span data-stu-id="c730d-144">Ensure that scripts use try-catch blocks so that the exceptions are handled gracefully.</span></span>
    - <span data-ttu-id="c730d-145">Если в скрипте возникает исключение, выполнение скрипта останавливается и задача помечается как невыполненная.</span><span class="sxs-lookup"><span data-stu-id="c730d-145">If there is an exception in the script, it stops running and the task shows as failed.</span></span>
    - <span data-ttu-id="c730d-146">При возникновении ошибки оставшаяся часть скрипта не выполняется.</span><span class="sxs-lookup"><span data-stu-id="c730d-146">If an error occurs, any remaining part of the script doesn't run.</span></span>
    - <span data-ttu-id="c730d-147">Если ошибка происходит при выполнении внеплановой отработки отказа, выполнение плана восстановления продолжается.</span><span class="sxs-lookup"><span data-stu-id="c730d-147">If an error occurs when you run an unplanned failover, the recovery plan continues.</span></span>
    - <span data-ttu-id="c730d-148">Если ошибка происходит при выполнении плановой отработки отказа, выполнение плана восстановления останавливается.</span><span class="sxs-lookup"><span data-stu-id="c730d-148">If an error occurs when you run a planned failover, the recovery plan stops.</span></span> <span data-ttu-id="c730d-149">В этом случае исправьте скрипт, убедитесь, что он выполняется должным образом, и повторно запустите план восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-149">You need to fix the script, check that it runs as expected, and then run the recovery plan again.</span></span>
- <span data-ttu-id="c730d-150">Команда Write-Host не работает в сценарии плана восстановления, и сценарий завершится с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="c730d-150">The Write-Host command doesn’t work in a recovery plan script, and the script will fail.</span></span> <span data-ttu-id="c730d-151">Для создания выходного файла создайте скрипт прокси, который выполняется в основном скрипте.</span><span class="sxs-lookup"><span data-stu-id="c730d-151">To create output, create a proxy script that in turn runs your main script.</span></span> <span data-ttu-id="c730d-152">Убедитесь, что все выходные данные перенаправляются с помощью команды ">>".</span><span class="sxs-lookup"><span data-stu-id="c730d-152">Make sure that all output is piped out using the >> command.</span></span>
  * <span data-ttu-id="c730d-153">Если скрипт не завершается в течение 600 секунд, он будет остановлен.</span><span class="sxs-lookup"><span data-stu-id="c730d-153">The script times out if it doesn't return within 600 seconds.</span></span>
  * <span data-ttu-id="c730d-154">Если от скрипта поступят любые данные в вывод STDERR, он будет считаться завершившимся с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="c730d-154">If anything is written out to STDERR, the script is classified as failed.</span></span> <span data-ttu-id="c730d-155">Эти сведения отображаются в данных о выполнении скрипта.</span><span class="sxs-lookup"><span data-stu-id="c730d-155">This information is displayed in the script execution details.</span></span>

<span data-ttu-id="c730d-156">Если в вашем развертывании есть VMM, учтите следующее.</span><span class="sxs-lookup"><span data-stu-id="c730d-156">If you're using VMM in your deployment:</span></span>

* <span data-ttu-id="c730d-157">Сценарии в плане восстановления выполняются в контексте учетной записи службы VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-157">Scripts in a recovery plan run in the context of the VMM Service account.</span></span> <span data-ttu-id="c730d-158">Эта учетная запись должна иметь разрешения на чтение для удаленной общей папки, в которой расположен скрипт.</span><span class="sxs-lookup"><span data-stu-id="c730d-158">Make sure this account has Read permissions for the remote share on which the script is located.</span></span> <span data-ttu-id="c730d-159">Скрипт должен успешно выполняться на уровне привилегий учетной записи службы VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-159">Test the script to run at the VMM service account privilege level.</span></span>
* <span data-ttu-id="c730d-160">Командлеты VMM предоставляются в модуле Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c730d-160">VMM cmdlets are delivered in a Windows PowerShell module.</span></span> <span data-ttu-id="c730d-161">Этот модуль устанавливается одновременно с консолью VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-161">The module is installed when you install the VMM console.</span></span> <span data-ttu-id="c730d-162">Его можно загрузить в скрипт, используя следующую команду:</span><span class="sxs-lookup"><span data-stu-id="c730d-162">It can be loaded into your script, using the following command in the script:</span></span>
   - <span data-ttu-id="c730d-163">Import-Module -Name virtualmachinemanager.</span><span class="sxs-lookup"><span data-stu-id="c730d-163">Import-Module -Name virtualmachinemanager.</span></span> <span data-ttu-id="c730d-164">[Подробнее](https://technet.microsoft.com/library/hh875013.aspx).</span><span class="sxs-lookup"><span data-stu-id="c730d-164">[Learn more](https://technet.microsoft.com/library/hh875013.aspx).</span></span>
* <span data-ttu-id="c730d-165">Убедитесь в наличии хотя бы одного сервера библиотеки в вашем развертывании VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-165">Ensure you have at least one library server in your VMM deployment.</span></span> <span data-ttu-id="c730d-166">По умолчанию общая папка библиотеки для сервера VMM размещается на сервере VMM в локальной папке с именем MSCVMMLibrary.</span><span class="sxs-lookup"><span data-stu-id="c730d-166">By default, the library share path for a VMM server is located locally on the VMM server, with the folder name MSCVMMLibrary.</span></span>
    * <span data-ttu-id="c730d-167">Если ваша общая папка библиотеки находится на удаленном сервере (или расположена локально, но не совпадает с папкой MSCVMMLibrary), настройте общую папку, как описано ниже (\\\libserver2.contoso.com\share\ используется в качестве примера).</span><span class="sxs-lookup"><span data-stu-id="c730d-167">If your library share path is remote (or local but not shared with MSCVMMLibrary), configure the share as follows (using \\libserver2.contoso.com\share\ as an example):</span></span>
      * <span data-ttu-id="c730d-168">Откройте редактор реестра и найдите запись **HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\Azure Site Recovery\Registration**.</span><span class="sxs-lookup"><span data-stu-id="c730d-168">Open the Registry Editor and navigate to **HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\Azure Site Recovery\Registration**.</span></span>
      * <span data-ttu-id="c730d-169">Для параметра **ScriptLibraryPath** укажите значение \\\libserver2.contoso.com\share\..</span><span class="sxs-lookup"><span data-stu-id="c730d-169">Edit the value **ScriptLibraryPath** and place it as \\libserver2.contoso.com\share\.</span></span> <span data-ttu-id="c730d-170">Укажите полное доменное имя.</span><span class="sxs-lookup"><span data-stu-id="c730d-170">Specify the full FQDN.</span></span> <span data-ttu-id="c730d-171">Предоставьте разрешения для расположения общей папки.</span><span class="sxs-lookup"><span data-stu-id="c730d-171">Provide permissions to the share location.</span></span>
      * <span data-ttu-id="c730d-172">Для тестирования скрипта используйте учетную запись с теми же разрешениями, которые есть у учетной записи службы VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-172">Ensure that you test the script with a user account that has the same permissions as the VMM service account.</span></span> <span data-ttu-id="c730d-173">Это позволит гарантировать, что локально скрипт выполняется в тех же условиях, что и в планах восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-173">This checks that standalone tested scripts run in the same way as they will in recovery plans.</span></span> <span data-ttu-id="c730d-174">На сервере VMM установите обход политики выполнения следующих образом:</span><span class="sxs-lookup"><span data-stu-id="c730d-174">On the VMM server, set the execution policy to bypass as follows:</span></span>
        * <span data-ttu-id="c730d-175">Откройте консоль 64-разрядной Windows PowerShell с повышенными привилегиями.</span><span class="sxs-lookup"><span data-stu-id="c730d-175">Open the 64-bit Windows PowerShell console using elevated privileges.</span></span>
        * <span data-ttu-id="c730d-176">Введите: **Set-executionpolicy bypass**.</span><span class="sxs-lookup"><span data-stu-id="c730d-176">Type: **Set-executionpolicy bypass**.</span></span> <span data-ttu-id="c730d-177">[Подробнее](https://technet.microsoft.com/library/ee176961.aspx).</span><span class="sxs-lookup"><span data-stu-id="c730d-177">[Learn more](https://technet.microsoft.com/library/ee176961.aspx).</span></span>

## <a name="add-a-script-or-manual-action-to-a-plan"></a><span data-ttu-id="c730d-178">Добавление в план скрипта или ручного действия</span><span class="sxs-lookup"><span data-stu-id="c730d-178">Add a script or manual action to a plan</span></span>

<span data-ttu-id="c730d-179">Когда вы создадите план восстановления и добавите в группу по умолчанию виртуальные машины или группы репликации, в эту группу можно добавить скрипт.</span><span class="sxs-lookup"><span data-stu-id="c730d-179">You can add a script to the default recovery plan group after you've added VMs or replication groups to it, and created the plan.</span></span>

1. <span data-ttu-id="c730d-180">Откройте план восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-180">Open the recovery plan.</span></span>
2. <span data-ttu-id="c730d-181">Щелкните любой элемент в списке **Step** (Шаг), затем выберите **Script** (Скрипт) или **Manual Action** (Ручное действие).</span><span class="sxs-lookup"><span data-stu-id="c730d-181">Click an item in the **Step** list, and then click **Script** or **Manual Action**.</span></span>
3. <span data-ttu-id="c730d-182">Укажите, следует ли добавить сценарий или действие до или после выбранного элемента.</span><span class="sxs-lookup"><span data-stu-id="c730d-182">Specify whether to want to add the script or action before or after the selected item.</span></span> <span data-ttu-id="c730d-183">Используя кнопки управления **Move Up** (Переместить выше) и **Move Down** (Переместить ниже), можно изменить положение скрипта.</span><span class="sxs-lookup"><span data-stu-id="c730d-183">Use the **Move Up** and **Move Down**  buttons, to move the position of the script up or down.</span></span>
4. <span data-ttu-id="c730d-184">Если вы добавляете скрипт VMM, выберите **Failover to VMM script** (Отработка отказа в скрипт VMM).</span><span class="sxs-lookup"><span data-stu-id="c730d-184">If you add a VMM script, select **Failover to VMM script**.</span></span> <span data-ttu-id="c730d-185">Для параметра **Script Path** (Путь к скрипту) укажите относительный путь к общей папке.</span><span class="sxs-lookup"><span data-stu-id="c730d-185">In **Script Path**, type the relative path to the share.</span></span> <span data-ttu-id="c730d-186">В следующем примере для VMM это будет путь **\RPScripts\RPScript.PS1**.</span><span class="sxs-lookup"><span data-stu-id="c730d-186">In the VMM example below, you specify the path: **\RPScripts\RPScript.PS1**.</span></span>
5. <span data-ttu-id="c730d-187">Если вы добавляете модуль Runbook службы автоматизации Azure, укажите учетную запись службы автоматизации Azure, в которой расположен этот модуль Runbook, а затем выберите нужный скрипт модуля Runbook Azure.</span><span class="sxs-lookup"><span data-stu-id="c730d-187">If you add an Azure automation run book, specify the Azure Automation account in which the runbook is located, and select the appropriate Azure runbook script.</span></span>
6. <span data-ttu-id="c730d-188">Выполните отработку отказа по плану восстановления, чтобы убедиться в правильности работы скрипта.</span><span class="sxs-lookup"><span data-stu-id="c730d-188">Do a failover of the recovery plan, to make sure the script works as expected.</span></span>


### <a name="add-a-vmm-script"></a><span data-ttu-id="c730d-189">Добавление скрипта VMM</span><span class="sxs-lookup"><span data-stu-id="c730d-189">Add a VMM script</span></span>

<span data-ttu-id="c730d-190">Если используется исходный сайт VMM, вы можете создать скрипт на сервере VMM и включить его в план восстановления.</span><span class="sxs-lookup"><span data-stu-id="c730d-190">If you have a VMM source site, you can create a script on the VMM server, and include it in your recovery plan.</span></span>

1. <span data-ttu-id="c730d-191">Создайте новую папку в общей папке библиотеки.</span><span class="sxs-lookup"><span data-stu-id="c730d-191">Create a new folder in the library share.</span></span> <span data-ttu-id="c730d-192">Например \<VMMServerName>\MSSCVMMLibrary\RPScripts.</span><span class="sxs-lookup"><span data-stu-id="c730d-192">For example, \<VMMServerName>\MSSCVMMLibrary\RPScripts.</span></span> <span data-ttu-id="c730d-193">Разместите ее на исходном и целевом серверах VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-193">Place it on the source and target VMM servers.</span></span>
2. <span data-ttu-id="c730d-194">Создайте сценарий (например, RPScript) и убедитесь, что он работает должным образом</span><span class="sxs-lookup"><span data-stu-id="c730d-194">Create the script (for example RPScript), and check it works as expected.</span></span>
3. <span data-ttu-id="c730d-195">Поместите скрипт в папку \<VMMServerName>\MSSCVMMLibrary на исходном и целевом серверах VMM.</span><span class="sxs-lookup"><span data-stu-id="c730d-195">Place the script in the location \<VMMServerName>\MSSCVMMLibrary, on the source and target VMM servers.</span></span>


## <a name="next-steps"></a><span data-ttu-id="c730d-196">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c730d-196">Next steps</span></span>

<span data-ttu-id="c730d-197">[Дополнительные сведения](site-recovery-failover.md) о выполнении отработки отказа.</span><span class="sxs-lookup"><span data-stu-id="c730d-197">[Learn more](site-recovery-failover.md) about running failovers.</span></span>
