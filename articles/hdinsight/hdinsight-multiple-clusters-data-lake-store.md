---
title: "aaaUse HDInsight нескольких кластеров с помощью учетной записи хранилища Озера данных Azure - Azure | Документы Microsoft"
description: "Узнайте, как toouse больше, чем один HDInsight кластер с одной учетной записи хранилища Озера данных"
keywords: "хранилище HDInsight, HDFS, структурированные данные, неструктурированные данные, Data Lake Store"
services: hdinsight,storage
documentationcenter: 
tags: azure-portal
author: nitinme
manager: jhubbard
editor: cgronlun
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/02/2017
ms.author: nitinme
ms.openlocfilehash: 3a125b91fcc1e436270a1bd349f7a2d8f27e06fb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="use-multiple-hdinsight-clusters-with-an-azure-data-lake-store-account"></a>Использование нескольких кластеров HDInsight с учетной записью Azure Data Lake Store

Начиная с версии 3.5 HDInsight, можно создать кластеры HDInsight с учетными записями хранилища Озера данных Azure как файловой системы по умолчанию hello.
Data Lake Store поддерживает неограниченное пространство для хранения данных, поэтому оно идеально подходит не только для хранения больших объемов данных, но и для размещения нескольких кластеров HDInsight, которые совместно используют одну и ту же учетную запись Data Lake Store. Instructionson как toocreate HDInsight кластер с хранилища Озера данных в виде hello хранилища, в разделе [HDInsight, создания кластеров с хранилищем данных Озера](../data-lake-store/data-lake-store-hdinsight-hadoop-use-portal.md).

Эта статья содержит администратор хранилища Озера данных toohello рекомендации по настройке одинарных или общего хранения учетной записи Озера данных, можно использовать в нескольких **active** кластеров HDInsight. Эти рекомендации применяются toohosting несколько Hadoop безопасности, а также незащищенные кластеры общей учетной записи хранилища Озера данных.


## <a name="data-lake-store-file-and-folder-level-acls"></a>Списки управления доступом на уровне файла и папки в Data Lake Store

Hello оставшейся части этой статьи предполагается, что хорошо знать файлов и папок уровня списки управления доступом в хранилище Озера данных Azure, который описан в статье [управление доступом в хранилище Озера данных Azure](../data-lake-store/data-lake-store-access-control.md).

## <a name="data-lake-store-setup-for-multiple-hdinsight-clusters"></a>Настройка Data Lake Store для нескольких кластеров HDInsight
Сообщите нам занять иерархию папок двухуровневой tooexplain hello рекомендации по использованию множества кластеров HDInsight с помощью учетной записи хранилища Озера данных. Рекомендуется иметь учетную запись хранилища Озера данных со структурой папок hello **finance/кластеры/**. При такой структуре все кластеры hello, необходимо для организации процент hello можно использовать /clusters/finance в качестве места хранения hello. В будущем, если другой организации, скажем отдела маркетинга, хочет кластерами HDInsight toocreate с помощью Здравствуйте учетную запись хранилища Озера данных, они могут создавать /clusters/marketing hello. Пока давайте использовать папку **/clusters/finance**.

tooenable toobe структуры этой папки фактически используемые в кластерах HDInsight, Здравствуйте, администратор хранилища Озера данных необходимо назначить соответствующие разрешения, как описано в таблице hello. Hello разрешения, указанные в таблице hello соответствуют tooAccess ACL, а не по умолчанию списки управления доступом. 


|Папка  |Разрешения  |владельца  |группы владельцев  | Именованный пользователь | Разрешения именованного пользователя | Именованная группа | Разрешения именованной группы |
|---------|---------|---------|---------|---------|---------|---------|---------|
|/ | rwxr-x--x  |admin |admin  |Субъект-служба |--x  |FINGRP   |r-x         |
|/clusters | rwxr-x--x |admin |admin |Субъект-служба |--x  |FINGRP |r-x         |
|/clusters/finance | rwxr-x--t |admin |FINGRP  |Субъект-служба |rwx  |-  |-     |

В таблице hello

- **Администратор** является создателем hello и администратора hello хранилища Озера данных.
- **Субъект-служба** — hello Azure Active Directory (AAD) служба участника связанный с учетной записью hello.
- **FINGRP** является группой пользователей, созданные в Azure Active Directory, содержащую пользователей из организации процент hello.

Инструкции по статье toocreate приложение AAD (который также создает субъект-службу), [создать приложение AAD](../azure-resource-manager/resource-group-create-service-principal-portal.md#create-an-azure-active-directory-application). Инструкции по toocreate группу пользователей в Azure Active Directory, в статье [управления группами в Azure Active Directory](../active-directory/active-directory-accessmanagement-manage-groups.md).

Tooconsider некоторые ключевые моменты.

- Структура Hello два уровня папок (**/кластеры/finance/**) должно быть создано и предоставлены соответствующие разрешения с Здравствуйте, администратор хранилища Озера данных **перед** с помощью учетной записи хранилища hello для кластеров. Эта структура не создается автоматически при создании кластеров.
- приведенном выше примере Hello рекомендует параметр hello, которой принадлежит группа **finance/кластеры/** как **FINGRP** и позволяя **r-x** доступ к tooFINGRP toohello всю папку, в иерархии начиная с корневого hello. Это гарантирует, члены hello FINGRP можно перейти hello структуру папок, начиная с корня.
- В случае hello при разных участников службы AAD можно создавать кластеры под **finance/кластеры/**, hello прикрепленные бита (на hello **процент** папки) гарантирует, что созданы одной службой Невозможно удалить участника hello других.
- Создает после hello структуру папок и разрешения на месте, в процессе создания кластера HDInsight местоположение хранения конкретного кластера, в разделе **/кластеры/finance/**. Например, может быть hello хранилища для кластера с именем fincluster01 hello **/clusters/finance/fincluster01**. Hello владения и разрешений для папок hello, созданное кластером HDInsight отображается в таблице hello здесь.

    |Папка  |Разрешения  |владельца  |группы владельцев  | Именованный пользователь | Разрешения именованного пользователя | Именованная группа | Разрешения именованной группы |
    |---------|---------|---------|---------|---------|---------|---------|---------|
    |/clusters/finanace/ fincluster01 | rwxr-x---  |Субъект-служба |FINGRP  |- |-  |-   |-  | 
   


## <a name="recommendations-for-job-input-and-output-data"></a>Рекомендации по входным и выходным данным задания

Мы рекомендуется входных данных tooa задания и hello выходные данные задания храниться в папке за пределами **/кластеры**. Это гарантирует, что даже если папки кластера hello удаленные tooreclaim некоторые места для хранения hello задания выходы и входы по-прежнему доступны для использования в будущем. В этом случае убедитесь, что разрешает hello иерархии папок для хранения hello задания входных и выходных данных соответствующий уровень доступа для hello участника-службы.

## <a name="limit-on-clusters-sharing-a-single-storage-account"></a>Ограничение на число кластеров, которые могут использовать общую учетную запись хранения

максимально Hello hello количество кластеров, которые могут совместно использовать одну учетную запись хранилища Озера данных зависит от рабочей нагрузки hello, выполняемая на этих кластерах. В кластерах hello, которые совместно используют учетную запись хранения, имеющих слишком много кластеров или очень больших рабочих нагрузок может привести к регулированию и выхода tooget hello хранилища учетной записи.

## <a name="support-for-default-acls"></a>Поддержка списков управления доступом по умолчанию

При создании участника службы с помощью доступа с именем пользователя (как показано в приведенной выше таблице hello), мы рекомендуем **не** Добавление hello с именем пользователя по умолчанию-списка управления доступом. Подготовка доступа с именем пользователя, с помощью списков ACL по умолчанию результаты в назначении hello 770 разрешений владеет пользователь, владеющий группы и др. Хотя в этом режиме сохраняются все разрешения для пользователя-владельца (7) и группы-владельца (7), все разрешения для других пользователей удаляются (0). Это приведет к известная проблема с одного определенного вариантов использования, подробно рассматривается в hello [известные проблемы и обходные пути](#known-issues-and-workarounds) раздела.

## <a name="known-issues-and-workarounds"></a>Известные проблемы и их решения

В этом разделе перечислены известные проблемы, связанные с HDInsight хранилища Озера данных и их решения hello.

### <a name="publicly-visible-localized-yarn-resources"></a>Открытые локализованные ресурсы YARN

При создании новой учетной записи хранилища Озера данных Azure hello корневой каталог автоматически снабжаются too770 набор битов разрешений доступа ACL. Hello корневую папку, которой принадлежит пользователь является пользователем toohello набор, для создания учетной записи hello (Здравствуйте, администратор хранилища Озера данных) и владельца группы hello устанавливается основная группа toohello hello пользователя, создавшего hello учетной записи. Доступ для других пользователей не предоставляется.

Эти параметры перечислены известные tooaffect одного определенного HDInsight вариантов использования захвачен при [YARN 247](https://hwxmonarch.atlassian.net/browse/YARN-247). Сбой отправки заданий toothis аналогичные ошибки сообщения:

    Resource XXXX is not publicly accessible and as such cannot be part of hello public cache.

Как указано в hello YARN JIRA привязан ранее, при локализации общих ресурсов hello, что локализатора проверяет все hello запрошенных ресурсов открыты на самом деле, проверьте их разрешения для hello удаленной файловой системы. Все локальные ресурсы, не соответствующие этому условию, не локализуются. Здравствуйте, проверьте наличие разрешений, включает файл toohello доступ на чтение для «другие». Этот сценарий работает out of box при размещении кластерами HDInsight на Озера данных Azure, поскольку Озера данных Azure слишком запрещает любой доступ «другие» на корневом уровне папки.

#### <a name="workaround"></a>Возможное решение
Набор чтения — разрешения на выполнение **другие** через иерархию hello, например в  **/** , **/кластеры** и   **/кластеры/finance**  как показано в приведенной выше таблице hello.

## <a name="see-also"></a>См. также

* [Создание кластера HDInsight с хранилищем озера данных в качестве хранилища](../data-lake-store/data-lake-store-hdinsight-hadoop-use-portal.md)


