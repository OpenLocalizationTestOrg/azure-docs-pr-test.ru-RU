---
title: "Обработка данных с датчиков автомобилей с использованием Apache Storm в HDInsight | Документация Майкрософт"
description: "Узнайте, как обрабатывать данные с датчиков автомобилей из концентраторов событий с использованием средств Apache Storm в HDInsight. Добавление модели данных из Azure Cosmos DB и сохранение выходных данных в хранилище."
services: hdinsight,documentdb,notification-hubs
documentationcenter: 
author: Blackmist
manager: jhubbard
editor: cgronlun
ms.assetid: 78980635-8bef-4c33-96c3-fae50e932e31
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 05/03/2017
ms.author: larryfr
ms.openlocfilehash: 8e8ebc724e1c70e8fcd56312adef5da2342373ea
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="process-vehicle-sensor-data-from-azure-event-hubs-using-apache-storm-on-hdinsight"></a><span data-ttu-id="820ca-104">Обработка данных с датчиков автомобилей из концентраторов событий Azure с использованием средств Apache Storm в HDInsight.</span><span class="sxs-lookup"><span data-stu-id="820ca-104">Process vehicle sensor data from Azure Event Hubs using Apache Storm on HDInsight</span></span>

<span data-ttu-id="820ca-105">Узнайте, как обрабатывать данные с датчиков автомобилей из концентраторов событий Azure с использованием средств Apache Storm в HDInsight.</span><span class="sxs-lookup"><span data-stu-id="820ca-105">Learn how to process vehicle sensor data from Azure Event Hubs using Apache Storm on HDInsight.</span></span> <span data-ttu-id="820ca-106">В этом примере производится считывание данных с датчиков из концентраторов событий Azure, которые дополняются сведениями из Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="820ca-106">This example reads sensor data from Azure Event Hubs, enriches the data by referencing data stored in Azure Cosmos DB.</span></span> <span data-ttu-id="820ca-107">Данные хранятся в службе хранилища Azure с использованием файловой системы Hadoop (HDFS).</span><span class="sxs-lookup"><span data-stu-id="820ca-107">The data is stored into Azure Storage using the Hadoop File System (HDFS).</span></span>

![HDInsight и схема архитектуры Интернета вещей (IoT)](./media/hdinsight-storm-iot-eventhub-documentdb/iot.png)

## <a name="overview"></a><span data-ttu-id="820ca-109">Обзор</span><span class="sxs-lookup"><span data-stu-id="820ca-109">Overview</span></span>

<span data-ttu-id="820ca-110">Датчики на автомобилях помогают прогнозировать возникновение неполадок оборудования на основе тенденций в массивах статистических данных,</span><span class="sxs-lookup"><span data-stu-id="820ca-110">Adding sensors to vehicles allows you to predict equipment problems based on historical data trends.</span></span> <span data-ttu-id="820ca-111">а также совершенствовать последующие версии датчиков, руководствуясь результатами анализа закономерностей в их использовании.</span><span class="sxs-lookup"><span data-stu-id="820ca-111">It also allows you to make improvements to future versions based on usage pattern analysis.</span></span> <span data-ttu-id="820ca-112">Необходима возможность быстро и эффективно загружать данные со всех автомобилей в систему Hadoop до начала их обработки средствами MapReduce.</span><span class="sxs-lookup"><span data-stu-id="820ca-112">You must be able to quickly and efficiently load the data from all vehicles into Hadoop before MapReduce processing can occur.</span></span> <span data-ttu-id="820ca-113">Кроме того, целесообразно реализовать анализ путей критических отказов (температуры в двигателе, неполадок тормозной системы и т. д.) в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="820ca-113">Additionally, you may wish to do analysis for critical failure paths (engine temperature, brakes, etc.) in real time.</span></span>

<span data-ttu-id="820ca-114">Концентраторы событий Azure позволяют справляться с большими объемами данных, поступающих с датчиков.</span><span class="sxs-lookup"><span data-stu-id="820ca-114">Azure Event Hubs is built to handle the massive volume of data generated by sensors.</span></span> <span data-ttu-id="820ca-115">С помощью средств Apache Storm можно реализовать загрузку и обработку данных перед их сохранением в HDFS.</span><span class="sxs-lookup"><span data-stu-id="820ca-115">Apache Storm can be used to load and process the data before storing it into HDFS.</span></span>

## <a name="solution"></a><span data-ttu-id="820ca-116">Решение</span><span class="sxs-lookup"><span data-stu-id="820ca-116">Solution</span></span>

<span data-ttu-id="820ca-117">Данные телеметрии, связанные с температурой двигателя и окружающей среды, и также со скоростью автомобиля, фиксируются датчиками</span><span class="sxs-lookup"><span data-stu-id="820ca-117">Telemetry data for engine temperature, ambient temperature, and vehicle speed is recorded by sensors.</span></span> <span data-ttu-id="820ca-118">и отправляются в концентраторы событий вместе с идентификационным номером автомобиля (VIN-кодом) и меткой времени.</span><span class="sxs-lookup"><span data-stu-id="820ca-118">Data is then sent to Event Hubs along with the car's Vehicle Identification Number (VIN) and a time stamp.</span></span> <span data-ttu-id="820ca-119">Топология Storm, работающая на платформе Apache Storm в кластере HDInsight, считывает эту информацию оттуда, обрабатывает ее и сохраняет в системе HDFS.</span><span class="sxs-lookup"><span data-stu-id="820ca-119">From there, a Storm Topology running on an Apache Storm on HDInsight cluster reads the data, processes it, and stores it into HDFS.</span></span>

<span data-ttu-id="820ca-120">Во время обработки VIN-код используется для извлечения сведений о модели автомобиля из базы Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="820ca-120">During processing, the VIN is used to retrieve model information from Cosmos DB.</span></span> <span data-ttu-id="820ca-121">Они добавляются в поток данных перед его сохранением.</span><span class="sxs-lookup"><span data-stu-id="820ca-121">This data is added to the data stream before it is stored.</span></span>

<span data-ttu-id="820ca-122">В топологии Storm используются перечисленные ниже компоненты.</span><span class="sxs-lookup"><span data-stu-id="820ca-122">The components used in the Storm Topology are:</span></span>

* <span data-ttu-id="820ca-123">**EventHubSpout** : считывает данные из концентраторов событий Azure.</span><span class="sxs-lookup"><span data-stu-id="820ca-123">**EventHubSpout** - reads data from Azure Event Hubs</span></span>
* <span data-ttu-id="820ca-124">**TypeConversionBolt** преобразует строку JSON, полученную из концентраторов событий, в кортеж, содержащий следующие данные датчиков:</span><span class="sxs-lookup"><span data-stu-id="820ca-124">**TypeConversionBolt** - converts the JSON string from Event Hubs into a tuple containing the following sensor data:</span></span>
    * <span data-ttu-id="820ca-125">engineTemperature</span><span class="sxs-lookup"><span data-stu-id="820ca-125">Engine temperature</span></span>
    * <span data-ttu-id="820ca-126">температура окружающей среды;</span><span class="sxs-lookup"><span data-stu-id="820ca-126">Ambient temperature</span></span>
    * <span data-ttu-id="820ca-127">Speed</span><span class="sxs-lookup"><span data-stu-id="820ca-127">Speed</span></span>
    * <span data-ttu-id="820ca-128">VIN</span><span class="sxs-lookup"><span data-stu-id="820ca-128">VIN</span></span>
    * <span data-ttu-id="820ca-129">Timestamp</span><span class="sxs-lookup"><span data-stu-id="820ca-129">Timestamp</span></span>
* <span data-ttu-id="820ca-130">**DataReferencBolt** ищет сведения о модели автомобиля в Cosmos DB на основе VIN-кода.</span><span class="sxs-lookup"><span data-stu-id="820ca-130">**DataReferencBolt** - looks up the vehicle model from Cosmos DB using the VIN</span></span>
* <span data-ttu-id="820ca-131">**WasbStoreBolt** : сохраняет данные в HDFS (хранилище Azure).</span><span class="sxs-lookup"><span data-stu-id="820ca-131">**WasbStoreBolt** - stores the data to HDFS (Azure Storage)</span></span>

<span data-ttu-id="820ca-132">Ниже представлена схема этого решения.</span><span class="sxs-lookup"><span data-stu-id="820ca-132">The following image is a diagram of this solution:</span></span>

![топология Storm](./media/hdinsight-storm-iot-eventhub-documentdb/iottopology.png)

## <a name="implementation"></a><span data-ttu-id="820ca-134">Реализация</span><span class="sxs-lookup"><span data-stu-id="820ca-134">Implementation</span></span>

<span data-ttu-id="820ca-135">Полное автоматизированное решение на базе этого сценария доступно в репозитории [HDInsight-Storm-Examples](https://github.com/hdinsight/hdinsight-storm-examples) на сайте GitHub.</span><span class="sxs-lookup"><span data-stu-id="820ca-135">A complete, automated solution for this scenario is available as part of the [HDInsight-Storm-Examples](https://github.com/hdinsight/hdinsight-storm-examples) repository on GitHub.</span></span> <span data-ttu-id="820ca-136">Чтобы воспользоваться этим примером, следуйте инструкциям в файле [IoTExample README.MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).</span><span class="sxs-lookup"><span data-stu-id="820ca-136">To use this example, follow the steps in the [IoTExample README.MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="820ca-137">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="820ca-137">Next Steps</span></span>

<span data-ttu-id="820ca-138">Другие примеры топологий Storm см. в статье [Примеры топологий и компонентов Storm для Apache Storm в HDInsight](hdinsight-storm-example-topology.md).</span><span class="sxs-lookup"><span data-stu-id="820ca-138">For more example Storm topologies, see [Example topologies for Storm on HDInsight](hdinsight-storm-example-topology.md).</span></span>

