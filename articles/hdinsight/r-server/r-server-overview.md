---
title: "Основные сведения об R Server в HDInsight | Документация Майкрософт"
description: "Узнайте, как с помощью R Server в HDInsight создать приложения для анализа больших данных."
services: hdinsight
documentationcenter: 
author: bradsev
manager: jhubbard
editor: cgronlun
ms.assetid: 6dc21bf5-4429-435f-a0fb-eea856e0ea96
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 06/19/2017
ms.author: bradsev
ms.openlocfilehash: 860099b2634765f3088199c89341f0b48b20b801
ms.sourcegitcommit: 176c575aea7602682afd6214880aad0be6167c52
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/09/2018
---
#<a name="introduction-to-r-server-and-open-source-r-capabilities-on-hdinsight"></a>Основные сведения об R Server и возможностях открытого кода R в HDInsight

Microsoft R Server доступен в качестве варианта развертывания при создании кластеров HDInsight в Azure. Это новшество позволяет специалистам по обработке и анализу данных, статистикам и программистам на R получать доступ к масштабируемым, распределенным методам аналитики в HDInsight по требованию.

[!INCLUDE [hdinsight-price-change](../../../includes/hdinsight-enhancements.md)]

Кластеры можно масштабировать в соответствии с размерами существующих проектов и задач, а также удалять, когда они больше не требуются. Так как такие кластеры входят в Azure HDInsight, они поставляются с круглосуточной поддержкой корпоративного уровня, гарантией бесперебойной работы в течение 99,9 % времени и возможностью интеграции с другими компонентами экосистемы Azure.

R Server в HDInsight предоставляет новейшие возможности для анализа наборов данных практически любого размера, загруженных в хранилище BLOB-объектов Azure или Data Lake Store, на базе языка R. Так как R Server основывается на R с открытым кодом, вы сможете использовать в своих приложениях на основе R любые из более чем 8000 пакетов R с открытым кодом. Также доступны процедуры из ScaleR — пакета аналитики больших данных от Майкрософт, который входит в состав R Server.

Для подключения к кластеру и выполнения скриптов на языке R удобно использовать граничный узел кластеров. На граничном узле вы можете выполнять распараллеленные распределенные функции ScaleR на ядрах сервера граничного узла. Кроме того, вы можете выполнять эти функции на узлах кластера с помощью контекста вычислений Hadoop Map Reduce или Spark ScaleR.

Модели или прогнозы, которые получаются в результате анализа, можно загрузить для локального использования. Их также можно использовать в любой службе Azure, в частности в [веб-службе](../../machine-learning/studio/publish-a-machine-learning-web-service.md) [Студия машинного обучения Microsoft Azure](http://studio.azureml.net).

## <a name="get-started-with-r-on-hdinsight"></a>Начало работы с R Server в HDInsight
Чтобы добавить R Server в кластер HDInsight, необходимо выбрать тип кластера R Server при создании кластера HDInsight на портале Azure. Тип кластера R Server включает в себя R Server на узлах данных кластера и R Server на граничном узле, который служит платформой для анализа данных на базе R Server. Пошаговые инструкции по созданию кластера см. в статье [Приступая к работе с R Server в HDInsight](r-server-get-started.md).

## <a name="learn-about-data-storage-options"></a>Варианты хранилищ данных
Объем хранилища по умолчанию для файловой системы HDFS в кластерах HDInsight можно связать с учетной записи хранения Azure или Azure Data Lake Store. Такая связь гарантирует сохранение данных независимо от того, какие данные передаются в хранилище кластера в ходе анализа. Существуют различные инструменты для обработки передачи данных в выбранное вами хранилище, включая средства передачи портала, доступные учетной записи хранения, и служебную программу [AzCopy](../../storage/common/storage-use-azcopy.md).

Независимо от выбранного основного хранилища вы можете настроить доступ к дополнительным хранилищам BLOB-объектов или Data Lake Store во время подготовки кластера. Сведения о настройке доступа к дополнительным учетным записям см. в статье [Приступая к работе с R Server в HDInsight](https://docs.microsoft.com/azure/hdinsight/hdinsight-hadoop-r-server-get-started). Сведения об использовании нескольких учетных записей хранения см. в дополнительной статье [Параметры службы хранилища Azure для R Server в HDInsight](https://docs.microsoft.com/azure/hdinsight/hdinsight-hadoop-r-server-storage).

На граничном узле для хранения данных можно также использовать [файлы Azure](../../storage/files/storage-how-to-use-files-linux.md). Они позволяют подключить общую папку, созданную в службе хранения Azure, к файловой системе Linux. Дополнительные сведения об этих вариантах хранения данных для R Server в кластере HDInsight см. в статье [Параметры службы хранилища Azure для R Server в кластерах HDInsight](r-server-storage.md).

## <a name="access-r-server-on-the-cluster"></a>Доступ к R Server в кластере
Можно подключить R Server к граничному узлу с помощью браузера. Он устанавливается по умолчанию во время создания кластера. Дополнительные сведения см. в статье [Приступая к работе с R Server в HDInsight](r-server-get-started.md).

Для доступа к консоли R можно также подключиться к R Server из командной строки с помощью SSH или PuTTY. 

## <a name="develop-and-run-r-scripts"></a>Разработка и выполнение сценариев R
Для создания и выполнения скриптов R можно использовать не только распараллеленные распределенные процедуры из библиотеки ScaleR, но и более 8000 пакетов R с открытым исходным кодом. Как правило, скрипт, выполняемый R Server на граничном узле, выполняется в интерпретаторе R на этом узле. Исключением являются действия, которым необходимо вызывать функцию ScaleR с контекстом вычислений Hadoop Map Reduce (RxHadoopMR) или Spark (RxSpark). В этих случаях функция выполняется в распределенном режиме на узлах данных (задач) кластера, связанных с соответствующими данными. Дополнительные сведения о различных параметрах контекста вычислений см. в статье [Параметры контекста вычислений для R Server в HDInsight (предварительная версия)](r-server-compute-contexts.md).

## <a name="operationalize-a-model"></a>Ввод модели в эксплуатацию
После того как моделирование данных будет завершено, вы можете запустить модель в эксплуатацию для составления прогнозов на основе новых данных в Azure или в локальной среде. Этот процесс называется оценкой. Оценка может осуществляться в HDInsight, Машинном обучении Azure или локальной среде.

### <a name="score-in-hdinsight"></a>Оценка в HDInsight
Для оценки в HDInsight напишите функцию R, которая вызывает модель для создания прогнозов для нового файла данных, загруженного в учетную запись хранения. Сохраните прогнозы в учетной записи хранения. Эту процедуру можно выполнять на граничном узле кластера по требованию или по расписанию.  

### <a name="score-in-azure-machine-learning-aml"></a>Оценка в Машинном обучении Azure
Для оценки с помощью веб-службы машинного обучения Azure используйте пакет R с открытым кодом для Машинного обучения Azure, известный как [AzureML](https://cran.r-project.org/web/packages/AzureML/vignettes/getting_started.html), чтобы опубликовать модель как веб-службу Azure. Для удобства этот пакет предварительно установлен на граничном узле. Используйте средства машинного обучения, чтобы создать пользовательский интерфейс для веб-службы. Затем вызовите веб-службу, чтобы выполнить оценку.

При выборе этого варианта объекты модели ScaleR необходимо преобразовать в эквивалентные объекты модели с открытым исходным кодом для использования с веб-службой. Для этого используйте функции приведения ScaleR, такие как `as.randomForest()`, для моделей на основе ансамблей.

### <a name="score-on-premises"></a>Оценка в локальной среде
Для оценки в локальной среде созданную модель можно сериализовать в R, загрузить на локальный компьютер, десериализовать, а затем использовать для оценки новых данных. Вы можете оценить новые данные, используя подход, описанный ранее в статье [Общие сведения об R Server в HDInsight (предварительная версия)](#scoring-in-hdinsight), или с помощью [DeployR](https://deployr.revolutionanalytics.com/).

## <a name="maintain-the-cluster"></a>Обслуживание кластера
### <a name="install-and-maintain-r-packages"></a>Установка и обслуживание пакетов R
Большинство используемых вами пакетов R должны находиться на граничном узле, так как именно там выполняется основная часть действий скриптов R. Для установки дополнительных пакетов R на граничном узле можно использовать обычный для R метод `install.packages()` .

Если вы пользуетесь только подпрограммами из библиотеки ScaleR в кластере, устанавливать дополнительные пакеты R на узлы данных, как правило, не требуется. Однако дополнительные пакеты могут потребоваться для выполнения метода **rxExec** или **RxDataStep** на узлах данных.

В таких случаях после создания кластера дополнительные пакеты можно установить с помощью действия скрипта. Дополнительные сведения см. в статье [Приступая к работе с R Server в HDInsight (предварительная версия)](r-server-get-started.md).   

### <a name="change-hadoop-map-reduce-memory-settings"></a>Изменение параметров памяти Hadoop MapReduce
Изменив кластер, можно скорректировать объем памяти, который будет доступен R Server при выполнении задания MapReduce. Чтобы изменить кластер, используйте пользовательский интерфейс Ambari, который вы найдете в колонке своего кластера на портале Azure. Инструкции по получению доступа к пользовательскому интерфейсу Ambari для кластера см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](../hdinsight-hadoop-manage-ambari.md).

Вы также можете изменить объем памяти, доступной для R Server, с помощью параметров Hadoop в вызове метода **RxHadoopMR** , как показано ниже.

    hadoopSwitches = "-libjars /etc/hadoop/conf -Dmapred.job.map.memory.mb=6656"  

### <a name="scale-your-cluster"></a>Масштабирование кластера
Существующий кластер можно увеличить или уменьшить на портале. Благодаря масштабированию вы получаете дополнительную мощность, которая может потребоваться для более ресурсоемких задач. Также масштабирование позволяет свернуть кластер во время простоя. Инструкции по масштабированию кластера см. в статье [Управление кластерами Hadoop в HDInsight с помощью портала Azure](../hdinsight-administer-use-portal-linux.md).

### <a name="maintain-the-system"></a>Поддержка системы
Обслуживание, включающее в себя установку исправлений ОС и других обновлений, проводится на базовых виртуальных машинах Linux в кластере HDInsight в нерабочее время. Как правило, обслуживание проводится каждый понедельник и четверг в 3:30 (по местному времени для виртуальной машины). Обновления выполняются таким образом, чтобы они не влияли более чем на четверть кластера одновременно.  

Так как головные узлы избыточны, а затрагиваются не все узлы данных, выполнение заданий в это время может занимать больше времени. Но они все равно будут выполняться до завершения. Обслуживание не затрагивает установленное пользовательское программное обеспечение или локальные данные, если только в системе не возникнет неустранимая ошибка, требующая повторной сборки кластера.

## <a name="learn-about-ide-options-for-r-server-on-an-hdinsight-cluster"></a>Параметры IDE для R Server в кластере HDInsight
Граничный узел Linux в кластере HDInsight используется в качестве платформы для анализа на основе R. В последних версиях HDInsight RStudio Server по умолчанию устанавливается на граничный узел в качестве интегрированной среды разработки на основе браузера. Использование RStudio Server в качестве интегрированной среды разработки для разработки и выполнение сценариев R может быть намного более эффективным, чем использование только консоли R.

Еще один способ получить полноценную интегрированную среду разработки — установить классическую интегрированную среду разработки и использовать ее для доступа к кластеру посредством удаленного контекста вычислений Map Reduce или Spark. К возможным вариантам относятся [Инструменты R для Visual Studio](https://www.visualstudio.com/features/rtvs-vs.aspx), RStudio и [StatET](http://www.walware.de/goto/statet) на базе Eclipse от Walware.

Наконец, доступ к консоли R Server на граничном узле можно получить, просто введя **R** в командной строке Linux после подключения с помощью SSH или PuTY. При работе с консолью будет удобнее, если вы откроете текстовый редактор для разработки скрипта R в другом окне и будете вырезать и вставлять необходимые фрагменты скрипта в консоль R.

## <a name="learn-about-pricing"></a>Информация о ценах
Кластер HDInsight с R Server оплачивается по такой же схеме, что и стандартные кластеры HDInsight. Стоимость кластера зависит от размера основной виртуальной машины на разных узлах имен, узлах данных и граничных узлах, а также от наценки за ядро-час в кластере. Подробные сведения о ценах на HDInsight см. [здесь](https://azure.microsoft.com/pricing/details/hdinsight/).

## <a name="next-steps"></a>Дополнительная информация
Дополнительные сведения об использовании R Server для работы с кластерами HDInsight см. в следующих статьях:

* [Приступая к работе с R Server в HDInsight (предварительная версия)](r-server-get-started.md)
* [Варианты контекста вычислений для R Server в HDInsight](r-server-compute-contexts.md)
* [Параметры службы хранилища Azure для R Server в HDInsight (предварительная версия)](r-server-storage.md)
