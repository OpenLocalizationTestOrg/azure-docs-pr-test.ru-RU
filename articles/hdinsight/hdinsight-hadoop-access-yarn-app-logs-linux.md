---
title: "Доступ к журналам приложений Hadoop YARN в HDInsight под управлением Linux — Azure | Документы Майкрософт"
description: "Узнайте, как получить доступ к журналам приложений YARN в кластере HDInsight (Hadoop) под управлением Linux с помощью как командной строки, так и веб-браузера."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: Blackmist
manager: jhubbard
editor: cgronlun
ms.assetid: 3ec08d20-4f19-4a8e-ac86-639c04d2f12e
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/31/2017
ms.author: larryfr
ms.openlocfilehash: fbbbddc47f24a46eac9bc64d4420ee8429ed4ad1
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="access-yarn-application-logs-on-linux-based-hdinsight"></a><span data-ttu-id="ba7ed-103">Доступ к журналам приложений YARN в HDInsight под управлением Linux</span><span class="sxs-lookup"><span data-stu-id="ba7ed-103">Access YARN application logs on Linux-based HDInsight</span></span>

<span data-ttu-id="ba7ed-104">Узнайте, как получить доступ к журналам приложений YARN (Yet Another Resource Negotiator) в кластере Hadoop в Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-104">Learn how to access the logs for YARN (Yet Another Resource Negotiator) applications on a Hadoop cluster in Azure HDInsight.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ba7ed-105">Для выполнения действий, описанных в этом документе, необходим кластер HDInsight под управлением Linux.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-105">The steps in this document require an HDInsight cluster that uses Linux.</span></span> <span data-ttu-id="ba7ed-106">Linux — это единственная операционная система, используемая для работы с HDInsight 3.4 или более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-106">Linux is the only operating system used on HDInsight version 3.4 or greater.</span></span> <span data-ttu-id="ba7ed-107">Дополнительные сведения см. в разделе [Что представляют собой различные компоненты и версии Hadoop, доступные в HDInsight?](hdinsight-component-versioning.md#hdinsight-windows-retirement)</span><span class="sxs-lookup"><span data-stu-id="ba7ed-107">For more information, see [HDInsight component versioning](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span></span>

## <span data-ttu-id="ba7ed-108"><a name="YARNTimelineServer"></a>YARN Timeline Server</span><span class="sxs-lookup"><span data-stu-id="ba7ed-108"><a name="YARNTimelineServer"></a>YARN Timeline Server</span></span>

<span data-ttu-id="ba7ed-109">[YARN Timeline Server](http://hadoop.apache.org/docs/r2.4.0/hadoop-yarn/hadoop-yarn-site/TimelineServer.html) предоставляет общие сведения о завершенных приложениях, а также зависящие от платформы сведения о приложениях через два разных интерфейса.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-109">The [YARN Timeline Server](http://hadoop.apache.org/docs/r2.4.0/hadoop-yarn/hadoop-yarn-site/TimelineServer.html) provides generic information on completed applications and framework-specific application information through two different interfaces.</span></span> <span data-ttu-id="ba7ed-110">В частности:</span><span class="sxs-lookup"><span data-stu-id="ba7ed-110">Specifically:</span></span>

* <span data-ttu-id="ba7ed-111">Возможность хранения и извлечения общей информации о приложениях в кластерах HDInsight появилась, начиная с версии 3.1.1.374.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-111">Storage and retrieval of generic application information on HDInsight clusters has been enabled with version 3.1.1.374 or higher.</span></span>
* <span data-ttu-id="ba7ed-112">В настоящее время компонент сервера временной шкалы, предоставляющий сведения о приложениях для конкретной платформы, недоступен в кластерах HDInsight.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-112">The framework-specific application information component of the Timeline Server is not currently available on HDInsight clusters.</span></span>

<span data-ttu-id="ba7ed-113">К общим сведениям о приложениях относятся следующие типы данных:</span><span class="sxs-lookup"><span data-stu-id="ba7ed-113">Generic information on applications includes the following type of data:</span></span>

* <span data-ttu-id="ba7ed-114">уникальный идентификатор приложения;</span><span class="sxs-lookup"><span data-stu-id="ba7ed-114">The application ID, a unique identifier of an application</span></span>
* <span data-ttu-id="ba7ed-115">имя пользователя, запустившего приложение;</span><span class="sxs-lookup"><span data-stu-id="ba7ed-115">The user who started the application</span></span>
* <span data-ttu-id="ba7ed-116">информация о попытках завершить приложение;</span><span class="sxs-lookup"><span data-stu-id="ba7ed-116">Information on attempts made to complete the application</span></span>
* <span data-ttu-id="ba7ed-117">информация о контейнерах, которые использовались во время каждой из попыток.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-117">The containers used by any given application attempt</span></span>

## <span data-ttu-id="ba7ed-118"><a name="YARNAppsAndLogs"></a>Приложения и журналы YARN</span><span class="sxs-lookup"><span data-stu-id="ba7ed-118"><a name="YARNAppsAndLogs"></a>YARN applications and logs</span></span>

<span data-ttu-id="ba7ed-119">YARN поддерживает несколько моделей программирования (в том числе MapReduce), отделяя управление ресурсами от планирования и мониторинга приложений.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-119">YARN supports multiple programming models (MapReduce being one of them) by decoupling resource management from application scheduling/monitoring.</span></span> <span data-ttu-id="ba7ed-120">YARN использует глобальный диспетчер *ResourceManager*, *диспетчеры узлов* на каждый рабочий узел и *диспетчеры приложений* на каждое приложение.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-120">YARN uses a global *ResourceManager* (RM), per-worker-node *NodeManagers* (NMs), and per-application *ApplicationMasters* (AMs).</span></span> <span data-ttu-id="ba7ed-121">Диспетчер приложений согласовывает ресурсы (ЦП, память, диск, сеть), необходимые для работы приложения, с диспетчером ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-121">The per-application AM negotiates resources (CPU, memory, disk, network) for running your application with the RM.</span></span> <span data-ttu-id="ba7ed-122">Диспетчер ресурсов совместно с диспетчером узлов предоставляют эти ресурсы в виде *контейнеров*.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-122">The RM works with NMs to grant these resources, which are granted as *containers*.</span></span> <span data-ttu-id="ba7ed-123">Диспетчер приложений отвечает за отслеживание хода выполнения контейнеров, назначаемых ему диспетчером ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-123">The AM is responsible for tracking the progress of the containers assigned to it by the RM.</span></span> <span data-ttu-id="ba7ed-124">Приложению может потребоваться много контейнеров в зависимости от характера приложения.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-124">An application may require many containers depending on the nature of the application.</span></span>

<span data-ttu-id="ba7ed-125">Для выполнения приложения может потребоваться несколько *попыток*.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-125">Each application may consist of multiple *application attempts*.</span></span> <span data-ttu-id="ba7ed-126">Если выполнение приложения завершается ошибкой, его можно повторить как новую попытку.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-126">If an application fails, it may be retried as a new attempt.</span></span> <span data-ttu-id="ba7ed-127">Каждая попытка выполняется в контейнере.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-127">Each attempt runs in a container.</span></span> <span data-ttu-id="ba7ed-128">В некотором смысле контейнер обеспечивает контекст основной единице работы, выполняемой приложением YARN,</span><span class="sxs-lookup"><span data-stu-id="ba7ed-128">In a sense, a container provides the context for basic unit of work performed by a YARN application.</span></span> <span data-ttu-id="ba7ed-129">и вся работа, выполняемая в контексте контейнера, выполняется на одном рабочем узле, где был выделен контейнер.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-129">All work that is done within the context of a container is performed on the single worker node on which the container was allocated.</span></span> <span data-ttu-id="ba7ed-130">Дополнительные сведения см. в статье об [основных понятиях YARN][YARN-concepts].</span><span class="sxs-lookup"><span data-stu-id="ba7ed-130">See [YARN Concepts][YARN-concepts] for further reference.</span></span>

<span data-ttu-id="ba7ed-131">Журналы приложений (и соответствующие журналы контейнеров) крайне важны для отладки проблемных приложений Hadoop.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-131">Application logs (and the associated container logs) are critical in debugging problematic Hadoop applications.</span></span> <span data-ttu-id="ba7ed-132">YARN предоставляет хорошую платформу для сбора, объединения и хранения журналов приложений с функцией [объединения журналов][log-aggregation].</span><span class="sxs-lookup"><span data-stu-id="ba7ed-132">YARN provides a nice framework for collecting, aggregating, and storing application logs with the [Log Aggregation][log-aggregation] feature.</span></span> <span data-ttu-id="ba7ed-133">Функция объединения журналов делает доступ к журналам приложений более детерминированным,</span><span class="sxs-lookup"><span data-stu-id="ba7ed-133">The Log Aggregation feature makes accessing application logs more deterministic.</span></span> <span data-ttu-id="ba7ed-134">так как она объединяет журналы со всех контейнеров на рабочем узле и хранит их как один сводный файл журнала на рабочем узле</span><span class="sxs-lookup"><span data-stu-id="ba7ed-134">It aggregates logs across all containers on a worker node and stores them as one aggregated log file per worker node.</span></span> <span data-ttu-id="ba7ed-135">в файловой системе по умолчанию после завершения приложения.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-135">The log is stored on the default file system after an application finishes.</span></span> <span data-ttu-id="ba7ed-136">Ваше приложение может использовать сотни или тысячи контейнеров, но журналы для всех контейнеров, выполненных на одном рабочем узле, всегда объединяются в один файл.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-136">Your application may use hundreds or thousands of containers, but logs for all containers run on a single worker node are always aggregated to a single file.</span></span> <span data-ttu-id="ba7ed-137">Поэтому на каждый рабочий узел, используемый приложением, приходится один файл журнала.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-137">So there is only 1 log per worker node used by your application.</span></span> <span data-ttu-id="ba7ed-138">Объединение журналов включено по умолчанию на кластерах HDInsight версии 3.0 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-138">Log Aggregation is enabled by default on HDInsight clusters version 3.0 and above.</span></span> <span data-ttu-id="ba7ed-139">Объединенные журналы находятся в хранилище по умолчанию для кластера.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-139">Aggregated logs are located in default storage for the cluster.</span></span> <span data-ttu-id="ba7ed-140">В качестве пути HDFS к журналам используется следующий путь:</span><span class="sxs-lookup"><span data-stu-id="ba7ed-140">The following path is the HDFS path to the logs:</span></span>

    /app-logs/<user>/logs/<applicationId>

<span data-ttu-id="ba7ed-141">В пути `user` — это имя пользователя, запустившего приложение.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-141">In the path, `user` is the name of the user who started the application.</span></span> <span data-ttu-id="ba7ed-142">`applicationId` является уникальным идентификатором, назначенным YARN RM приложению.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-142">The `applicationId` is the unique identifier assigned to an application by the YARN RM.</span></span>

<span data-ttu-id="ba7ed-143">Сводные журналы не могут считываться напрямую, так как они записаны в [TFile][T-file], [двоичном формате][binary-format], индексированном контейнером.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-143">The aggregated logs are not directly readable, as they are written in a [TFile][T-file], [binary format][binary-format] indexed by container.</span></span> <span data-ttu-id="ba7ed-144">Чтобы отобразить эти журналы для интересующих вас приложений или контейнеров в виде обычного текста, используйте журналы YARN ResourceManager или средства CLI.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-144">Use the YARN ResourceManager logs or CLI tools to view these logs as plain text for applications or containers of interest.</span></span>

## <a name="yarn-cli-tools"></a><span data-ttu-id="ba7ed-145">Средства CLI для YARN</span><span class="sxs-lookup"><span data-stu-id="ba7ed-145">YARN CLI tools</span></span>

<span data-ttu-id="ba7ed-146">Чтобы использовать инструменты интерфейса командной строки для YARN, необходимо сначала подключиться к кластеру HDInsight с помощью SSH.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-146">To use the YARN CLI tools, you must first connect to the HDInsight cluster using SSH.</span></span> <span data-ttu-id="ba7ed-147">См. дополнительные сведения об [использовании SSH в HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="ba7ed-147">For information, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>

<span data-ttu-id="ba7ed-148">Эти журналы можно отобразить в виде обычного текста, запустив одну из указанных ниже команд.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-148">You can view these logs as plain text by running one of the following commands:</span></span>

    yarn logs -applicationId <applicationId> -appOwner <user-who-started-the-application>
    yarn logs -applicationId <applicationId> -appOwner <user-who-started-the-application> -containerId <containerId> -nodeAddress <worker-node-address>

<span data-ttu-id="ba7ed-149">При выполнении этих команд необходимо указать параметры &lt;applicationId>, &lt;user-who-started-the-application>, &lt;containerId> и &lt;worker-node-address>.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-149">Specify the &lt;applicationId>, &lt;user-who-started-the-application>, &lt;containerId>, and &lt;worker-node-address> information when running these commands.</span></span>

## <a name="yarn-resourcemanager-ui"></a><span data-ttu-id="ba7ed-150">Пользовательский интерфейс YARN ResourceManager</span><span class="sxs-lookup"><span data-stu-id="ba7ed-150">YARN ResourceManager UI</span></span>

<span data-ttu-id="ba7ed-151">Пользовательский интерфейс YARN ResourceManager работает на головном узле кластера.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-151">The YARN ResourceManager UI runs on the cluster headnode.</span></span> <span data-ttu-id="ba7ed-152">Доступ к нему осуществляется через веб-интерфейс Ambari.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-152">It is accessed through the Ambari web UI.</span></span> <span data-ttu-id="ba7ed-153">Чтобы просмотреть журналы YARN, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="ba7ed-153">Use the following steps to view the YARN logs:</span></span>

1. <span data-ttu-id="ba7ed-154">В веб-браузере перейдите на сайт https://имя_кластера.azurehdinsight.net.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-154">In your web browser, navigate to https://CLUSTERNAME.azurehdinsight.net.</span></span> <span data-ttu-id="ba7ed-155">Параметр CLUSTERNAME нужно заменить именем кластера HDInsight.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-155">Replace CLUSTERNAME with the name of your HDInsight cluster.</span></span>
2. <span data-ttu-id="ba7ed-156">В списке служб в левой части страницы выберите **YARN**.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-156">From the list of services on the left, select **YARN**.</span></span>

    ![Выбранные службы Yarn](./media/hdinsight-hadoop-access-yarn-app-logs-linux/yarnservice.png)
3. <span data-ttu-id="ba7ed-158">В раскрывающемся списке **Быстрые ссылки** выберите один из главных узлов кластера, а затем щелкните **Журнал Resource Manager**.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-158">From the **Quick Links** dropdown, select one of the cluster head nodes and then select **ResourceManager Log**.</span></span>

    ![Быстрые ссылки для Yarn](./media/hdinsight-hadoop-access-yarn-app-logs-linux/yarnquicklinks.png)

    <span data-ttu-id="ba7ed-160">Отобразится список ссылок на журналы YARN.</span><span class="sxs-lookup"><span data-stu-id="ba7ed-160">You are presented with a list of links to YARN logs.</span></span>

[YARN-timeline-server]:http://hadoop.apache.org/docs/r2.4.0/hadoop-yarn/hadoop-yarn-site/TimelineServer.html
[log-aggregation]:http://hortonworks.com/blog/simplifying-user-logs-management-and-access-in-yarn/
[T-file]:https://issues.apache.org/jira/secure/attachment/12396286/TFile%20Specification%2020081217.pdf
[binary-format]:https://issues.apache.org/jira/browse/HADOOP-3315
[YARN-concepts]:http://hortonworks.com/blog/apache-hadoop-yarn-concepts-and-applications/
