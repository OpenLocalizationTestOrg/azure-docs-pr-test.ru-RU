---
title: "aaaConnect tooHadoop Excel с помощью Power Query - Azure HDInsight | Документы Microsoft"
description: "Узнайте, как сохранить преимущества tootake компонентов бизнес-аналитики и используйте Power Query для Excel tooaccess данных в Hadoop в HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 1213849f1bc04e0ed206750b80766ff2268664b4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="connect-excel-toohadoop-by-using-power-query"></a><span data-ttu-id="be03c-103">Подключение Excel tooHadoop с помощью Power Query</span><span class="sxs-lookup"><span data-stu-id="be03c-103">Connect Excel tooHadoop by using Power Query</span></span>
<span data-ttu-id="be03c-104">Одна важная особенность решения для больших данных Майкрософт hello — hello интеграции компонентов бизнес-аналитики (BI) Майкрософт с кластерами Hadoop в Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="be03c-104">One key feature of hello Microsoft big-data solution is hello integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="be03c-105">Основной пример — hello возможность tooconnect Excel toohello учетной записи хранилища Azure, которая содержит hello данных, связанной с кластером Hadoop с помощью надстройки Excel для hello Microsoft Power Query.</span><span class="sxs-lookup"><span data-stu-id="be03c-105">A primary example is hello ability tooconnect Excel toohello Azure Storage account that contains hello data associated with your Hadoop cluster by using hello Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="be03c-106">В этой статье описывается управление tooset копирование и использование Power Query tooquery данные, связанные с кластеру с HDInsight.</span><span class="sxs-lookup"><span data-stu-id="be03c-106">This article walks you through how tooset up and use Power Query tooquery data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="be03c-107">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="be03c-107">Prerequisites</span></span>
<span data-ttu-id="be03c-108">Прежде чем приступать к этой статье, необходимо иметь hello следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="be03c-108">Before you begin this article, you must have hello following items:</span></span>

* <span data-ttu-id="be03c-109">**Кластер HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="be03c-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="be03c-110">разделе tooconfigure, [Приступая к работе с Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="be03c-110">tooconfigure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="be03c-111">**Рабочая станция** под управлением Windows 7, Windows Server 2008 R2 или последующих версий операционной системы.</span><span class="sxs-lookup"><span data-stu-id="be03c-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="be03c-112">**Office 2016, Office 2013 профессиональный плюс, Office 365 профессиональный плюс, Excel 2013 автономный или Office профессиональный плюс 2010**.</span><span class="sxs-lookup"><span data-stu-id="be03c-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="be03c-113">Установка Power Query</span><span class="sxs-lookup"><span data-stu-id="be03c-113">Install Power Query</span></span>
<span data-ttu-id="be03c-114">Power Query может импортировать данные, которые были выведены или созданы заданием Hadoop, выполняющимся в кластере HDInsight.</span><span class="sxs-lookup"><span data-stu-id="be03c-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="be03c-115">В Excel 2016 Power Query встроено в ленте данных hello в разделе hello Get и преобразование раздела.</span><span class="sxs-lookup"><span data-stu-id="be03c-115">In Excel 2016, Power Query has been integrated into hello Data ribbon under hello Get & Transform section.</span></span> <span data-ttu-id="be03c-116">Для более старых версиях Excel, загрузите Microsoft Power Query для Excel с hello [центра загрузки Майкрософт] [ powerquery-download] и установить его.</span><span class="sxs-lookup"><span data-stu-id="be03c-116">For older Excel versions, download Microsoft Power Query for Excel from hello [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="be03c-117">Импорт данных HDInsight в Excel</span><span class="sxs-lookup"><span data-stu-id="be03c-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="be03c-118">Hello надстройка Power Query для Excel позволяет легко tooimport данные из кластера HDInsight в Excel, где средств бизнес-Аналитики, такие как PowerPivot и Power карты могут быть используется tooinspect, анализа и представления данных hello.</span><span class="sxs-lookup"><span data-stu-id="be03c-118">hello Power Query add-in for Excel makes it easy tooimport data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used tooinspect, analyze, and present hello data.</span></span>

<span data-ttu-id="be03c-119">**tooimport данные из кластера HDInsight**</span><span class="sxs-lookup"><span data-stu-id="be03c-119">**tooimport data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="be03c-120">Откройте Excel.</span><span class="sxs-lookup"><span data-stu-id="be03c-120">Open Excel.</span></span>
2. <span data-ttu-id="be03c-121">Создайте новую пустую книгу.</span><span class="sxs-lookup"><span data-stu-id="be03c-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="be03c-122">Выполните следующие действия в зависимости от версии Excel hello hello.</span><span class="sxs-lookup"><span data-stu-id="be03c-122">Perform hello following steps based on hello Excel version:</span></span>

    - <span data-ttu-id="be03c-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="be03c-123">Excel 2016</span></span>

        - <span data-ttu-id="be03c-124">Нажмите кнопку hello **данные** меню, нажмите кнопку **получить данные** из hello **получения и преобразования данных** ленты, нажмите кнопку **из Azure**и нажмите кнопку  **Из Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="be03c-124">Click hello **Data** menu, click **Get Data** from hello **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="be03c-126">Excel 2013 или 2010</span><span class="sxs-lookup"><span data-stu-id="be03c-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="be03c-127">Щелкните hello **Power Query** меню, нажмите кнопку **из Azure**, а затем нажмите кнопку **из Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="be03c-127">Click hello **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="be03c-129">**Примечание:** Если вы не видите hello **Power Query** меню перейдите слишком**файл** > **параметры** > **Add-Ins**и выберите **надстройки COM** из раскрывающегося списка hello **управление** в нижней части вкладки hello страницы приветствия.</span><span class="sxs-lookup"><span data-stu-id="be03c-129">**Note:** If you don't see hello **Power Query** menu, go too**File** > **Options** > **Add-Ins**, and select **COM Add-ins** from hello drop-down **Manage** box at hello bottom of hello page.</span></span> <span data-ttu-id="be03c-130">Выберите hello **перейдите...**  кнопку и убедитесь в этом окне приветствия, для проверки hello Power Query для надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="be03c-130">Select hello **Go...** button and verify that hello box for hello Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="be03c-131">**Примечание:** Power Query также позволяет tooimport данных из HDFS, щелкнув **из других источников**.</span><span class="sxs-lookup"><span data-stu-id="be03c-131">**Note:** Power Query also allows you tooimport data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="be03c-132">Для **имя учетной записи**, введите имя учетной записи хранилища больших двоичных объектов Azure hello связанной с кластером hello и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="be03c-132">For **Account Name**, enter hello name of hello Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="be03c-133">Эта учетная запись может быть hello [учетная запись хранения по умолчанию](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) или связанной учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="be03c-133">This account can be hello [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="be03c-134">Формат Hello *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="be03c-134">hello format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="be03c-135">Для **ключ учетной записи**, введите ключ hello для hello учетной записи хранилища больших двоичных объектов и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="be03c-135">For **Account Key**, enter hello key for hello Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="be03c-136">(Требуется только hello сведения учетной записи tooenter hello первого просмотра этого хранилища.)</span><span class="sxs-lookup"><span data-stu-id="be03c-136">(You need tooenter hello account information only hello first time you access this store.)</span></span>
6. <span data-ttu-id="be03c-137">В hello **Навигатор** панели hello левой части редактора запросов hello, дважды щелкните имя контейнера хранилища больших двоичных объектов hello.</span><span class="sxs-lookup"><span data-stu-id="be03c-137">In hello **Navigator** pane on hello left of hello Query Editor, double-click hello Blob storage container name.</span></span> <span data-ttu-id="be03c-138">По умолчанию имя контейнера hello hello таким же именем, как имя кластера hello.</span><span class="sxs-lookup"><span data-stu-id="be03c-138">By default, hello container name is hello same name as hello cluster name.</span></span>
7. <span data-ttu-id="be03c-139">Найдите **HiveSampleData.txt** в hello **имя** столбца (путь к папке hello **... hive, хранилища и hivesampletable/**), а затем нажмите кнопку **двоичных** hello левой стороны HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="be03c-139">Locate **HiveSampleData.txt** in hello **Name** column (hello folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on hello left of HiveSampleData.txt.</span></span> <span data-ttu-id="be03c-140">HiveSampleData.txt поставляется с всех кластеров hello.</span><span class="sxs-lookup"><span data-stu-id="be03c-140">HiveSampleData.txt comes with all hello cluster.</span></span> <span data-ttu-id="be03c-141">При необходимости можно использовать собственный файл.</span><span class="sxs-lookup"><span data-stu-id="be03c-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="be03c-143">Если требуется, можно переименовать hello имена столбцов.</span><span class="sxs-lookup"><span data-stu-id="be03c-143">If you want, you can rename hello column names.</span></span> <span data-ttu-id="be03c-144">Когда будете готовы, щелкните **Закрыть и загрузить**.</span><span class="sxs-lookup"><span data-stu-id="be03c-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="be03c-145">Hello данных был загружен tooyour книги.</span><span class="sxs-lookup"><span data-stu-id="be03c-145">hello data has been loaded tooyour workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="be03c-147">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="be03c-147">Next steps</span></span>
<span data-ttu-id="be03c-148">В этой статье вы узнали, как toouse tooretrieve данные Power Query из HDInsight в Excel.</span><span class="sxs-lookup"><span data-stu-id="be03c-148">In this article, you learned how toouse Power Query tooretrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="be03c-149">Аналогичным образом можно извлекать данные из HDInsight в SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="be03c-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="be03c-150">Это также возможно tooupload данных в HDInsight.</span><span class="sxs-lookup"><span data-stu-id="be03c-150">It is also possible tooupload data into HDInsight.</span></span> <span data-ttu-id="be03c-151">toolearn более, см. следующие статьи hello.</span><span class="sxs-lookup"><span data-stu-id="be03c-151">toolearn more, see hello following articles:</span></span>

* <span data-ttu-id="be03c-152">[Связь с hello Hive драйвер ODBC для Microsoft Excel tooHDInsight][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="be03c-152">[Connect Excel tooHDInsight with hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="be03c-153">[Отправка данных tooHDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="be03c-153">[Upload Data tooHDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
