---
title: "aaaWorking с использованием модулей Node.js"
description: "Узнайте, как toowork с использованием модулей Node.js при использовании службы приложений Azure или облачных служб."
services: 
documentationcenter: nodejs
author: TomArcher
manager: routlaw
editor: 
ms.assetid: c0e6cd3d-932d-433e-b72d-e513e23b4eb6
ms.service: multiple
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 08/17/2016
ms.author: tarcher
ms.openlocfilehash: 926358b7eb80a659dbc1015686b06a30d8c9b8f0
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="using-nodejs-modules-with-azure-applications"></a><span data-ttu-id="6f696-103">Использование модулей Node.js с приложениями Azure</span><span class="sxs-lookup"><span data-stu-id="6f696-103">Using Node.js Modules with Azure applications</span></span>
<span data-ttu-id="6f696-104">Этот документ содержит указания по использованию модулей Node.js с приложениями, размещенными в Azure.</span><span class="sxs-lookup"><span data-stu-id="6f696-104">This document provides guidance on using Node.js modules with applications hosted on Azure.</span></span> <span data-ttu-id="6f696-105">В нем описывается, как обеспечить использование конкретной версии модуля приложением и как использовать собственные модули вместе с Azure.</span><span class="sxs-lookup"><span data-stu-id="6f696-105">It provides guidance on ensuring that your application uses a specific version of module as well as using native modules with Azure.</span></span>

<span data-ttu-id="6f696-106">Если вы уже знакомы с использованием модулей Node.js **package.json** и **npm shrinkwrap.json** файлы, hello следующую информацию содержит краткую сводку что описанные в этой статье:</span><span class="sxs-lookup"><span data-stu-id="6f696-106">If you are already familiar with using Node.js modules, **package.json** and **npm-shrinkwrap.json** files, hello following information provides a quick summary of what is discussed in this article:</span></span>

* <span data-ttu-id="6f696-107">Служба приложений Azure может считывать файлы **package.json** и **npm-shrinkwrap.json** и устанавливать модули на основании записей в этих файлах.</span><span class="sxs-lookup"><span data-stu-id="6f696-107">Azure App Service understands **package.json** and **npm-shrinkwrap.json** files and can install modules based on entries in these files.</span></span>

* <span data-ttu-id="6f696-108">Облачные службы Azure ожидается, что все toobe модули, установленные в среде разработки hello и hello **узел\_модули** toobe каталога, включенного в пакет развертывания hello.</span><span class="sxs-lookup"><span data-stu-id="6f696-108">Azure Cloud Services expect all modules toobe installed on hello development environment, and hello **node\_modules** directory toobe included as part of hello deployment package.</span></span> <span data-ttu-id="6f696-109">Это возможно tooenable поддержка установки модулей с помощью **package.json** или **npm shrinkwrap.json** файлов на облачные службы; Однако эта конфигурация требует настройки по умолчанию hello скрипты, используемые в проектах облачных служб.</span><span class="sxs-lookup"><span data-stu-id="6f696-109">It is possible tooenable support for installing modules using **package.json** or **npm-shrinkwrap.json** files on Cloud Services; however, this configuration requires customization of hello default scripts used by Cloud Service projects.</span></span> <span data-ttu-id="6f696-110">Пример того, как tooconfigure этой среды. в разделе [npm toorun задачи запуска Azure установите tooavoid развертывание модулей узла](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span><span class="sxs-lookup"><span data-stu-id="6f696-110">For an example of how tooconfigure this environment, see [Azure Startup task toorun npm install tooavoid deploying node modules](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span></span>

> [!NOTE]
> <span data-ttu-id="6f696-111">Виртуальные машины Azure не рассматривается в этой статье, как hello опыт развертывания на виртуальной машине, зависит от операционной системе hello, размещаемую hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="6f696-111">Azure Virtual Machines are not discussed in this article, as hello deployment experience in a VM is dependent on hello operating system hosted by hello Virtual Machine.</span></span>
> 
> 

## <a name="nodejs-modules"></a><span data-ttu-id="6f696-112">Модули Node.js</span><span class="sxs-lookup"><span data-stu-id="6f696-112">Node.js Modules</span></span>
<span data-ttu-id="6f696-113">Модули — это загружаемые пакеты JavaScript, предоставляющие вашему приложению определенные функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="6f696-113">Modules are loadable JavaScript packages that provide specific functionality for your application.</span></span> <span data-ttu-id="6f696-114">Обычно модули устанавливаются с помощью hello **npm** командной строки средства, однако некоторые модули (например, HTTP-модуль hello) предоставляются как часть пакета Node.js core hello.</span><span class="sxs-lookup"><span data-stu-id="6f696-114">Modules are usually installed using hello **npm** command-line tool, however some modules (such as hello http module) are provided as part of hello core Node.js package.</span></span>

<span data-ttu-id="6f696-115">Если установлены модули, они хранятся в hello **узел\_модули** каталог в корне hello структуры каталога приложения.</span><span class="sxs-lookup"><span data-stu-id="6f696-115">When modules are installed, they are stored in hello **node\_modules** directory at hello root of your application directory structure.</span></span> <span data-ttu-id="6f696-116">Каждый модуль в пределах hello **узел\_модули** directory поддерживает собственный **узел\_модули** каталог, содержащий модули, которые он зависит, а это поведение повторяет для каждого модуля все способом hello цепочке зависимостей hello.</span><span class="sxs-lookup"><span data-stu-id="6f696-116">Each module within hello **node\_modules** directory maintains its own **node\_modules** directory that contains any modules that it depends on, and this behavior repeats for every module all hello way down hello dependency chain.</span></span> <span data-ttu-id="6f696-117">Эта среда позволяет каждый модуль установлен toohave свои собственные требования к версии для модулей hello, он зависит, однако это может привести к очень больших структуру каталогов.</span><span class="sxs-lookup"><span data-stu-id="6f696-117">This environment allows each module installed toohave its own version requirements for hello modules it depends on, however it can result in quite a large directory structure.</span></span>

<span data-ttu-id="6f696-118">Развертывание hello **узел\_модули** каталога, как часть вашего приложения увеличивает размер hello hello развертывания при сравнении toousing **package.json** или  **npm shrinkwrap.json** файл; Однако он гарантирует, что версии hello hello модули, используемые в рабочей среде hello таким же как hello модули, используемые при разработке.</span><span class="sxs-lookup"><span data-stu-id="6f696-118">Deploying hello **node\_modules** directory as part of your application increases hello size of hello deployment when compared toousing a **package.json** or **npm-shrinkwrap.json** file; however, it does guarantee that hello versions of hello modules used in production are hello same as hello modules used in development.</span></span>

### <a name="native-modules"></a><span data-ttu-id="6f696-119">Собственные модули</span><span class="sxs-lookup"><span data-stu-id="6f696-119">Native Modules</span></span>
<span data-ttu-id="6f696-120">Хотя большинство модулей представляют собой просто текстовые файлы JavaScript, некоторые модули являются двоичными образами, предназначенными для конкретной платформы.</span><span class="sxs-lookup"><span data-stu-id="6f696-120">While most modules are simply plain-text JavaScript files, some modules are platform-specific binary images.</span></span> <span data-ttu-id="6f696-121">Такие модули обычно компилируются во время установки, обычно для этого используется Python и node-gyp.</span><span class="sxs-lookup"><span data-stu-id="6f696-121">These modules are compiled at install time, usually by using Python and node-gyp.</span></span> <span data-ttu-id="6f696-122">Так как облачные службы Azure используют hello **узел\_модули** папки развертывания как часть приложения hello, любой собственный модуль, включается как часть hello установлены модули должны работать в облачной службе, при условии, что она была установлен и компилируется в системе разработки Windows.</span><span class="sxs-lookup"><span data-stu-id="6f696-122">Since Azure Cloud Services rely on hello **node\_modules** folder being deployed as part of hello application, any native module included as part of hello installed modules should work in a cloud service as long as it was installed and compiled on a Windows development system.</span></span>

<span data-ttu-id="6f696-123">Служба приложений Azure не поддерживает все собственные модули и может сообщать об ошибках при компиляции модулей со специфическими предварительными требованиями.</span><span class="sxs-lookup"><span data-stu-id="6f696-123">Azure App Service does not support all native modules, and might fail when compiling modules with specific prerequisites.</span></span> <span data-ttu-id="6f696-124">Хотя у некоторых популярных модулей, например MongoDB, имеются дополнительные собственные зависимости, и они прекрасно работают без них, было найдено два обходных решения, подходящих почти для всех собственных модулей, доступных в настоящее время:</span><span class="sxs-lookup"><span data-stu-id="6f696-124">While some popular modules like MongoDB have optional native dependencies and work fine without them, two workarounds proved successful with almost all native modules available today:</span></span>

* <span data-ttu-id="6f696-125">Запустите **установки npm** на компьютере Windows, где установлены необходимые компоненты для всех hello собственного модуля.</span><span class="sxs-lookup"><span data-stu-id="6f696-125">Run **npm install** on a Windows machine that has all hello native module's prerequisites installed.</span></span> <span data-ttu-id="6f696-126">Затем разверните hello создан **узел\_модули** папки как часть приложения hello tooAzure службы приложений.</span><span class="sxs-lookup"><span data-stu-id="6f696-126">Then, deploy hello created **node\_modules** folder as part of hello application tooAzure App Service.</span></span>

  * <span data-ttu-id="6f696-127">Перед компиляцией, убедитесь, что локальной установки Node.js имеет соответствующий архитектуру и версии hello совпадали возможных toohello использован в Azure (hello текущие значения может быть проверено на выполнения из свойств **process.arch**и **process.version**).</span><span class="sxs-lookup"><span data-stu-id="6f696-127">Before compiling, check that your local Node.js installation has matching architecture and hello version is as close as possible toohello one used in Azure (hello current values can be checked on runtime from properties **process.arch** and **process.version**).</span></span>

* <span data-ttu-id="6f696-128">Служба приложений Azure может быть пользовательских bash настроенных tooexecute или сценариев оболочки во время развертывания, предоставляя hello возможности tooexecute пользовательские команды и точно настроить hello способом **установки npm** запущена.</span><span class="sxs-lookup"><span data-stu-id="6f696-128">Azure App Service can be configured tooexecute custom bash or shell scripts during deployment, giving you hello opportunity tooexecute custom commands and precisely configure hello way **npm install** is being run.</span></span> <span data-ttu-id="6f696-129">Для видео отображение как tooconfigure этой среды. в разделе [пользовательские скрипты развертывания веб-сайта с Kudu].</span><span class="sxs-lookup"><span data-stu-id="6f696-129">For a video showing how tooconfigure that environment, see [Custom Website Deployment Scripts with Kudu].</span></span>

### <a name="using-a-packagejson-file"></a><span data-ttu-id="6f696-130">Использование файла package.json</span><span class="sxs-lookup"><span data-stu-id="6f696-130">Using a package.json file</span></span>
<span data-ttu-id="6f696-131">Hello **package.json** файл является способом toospecify hello верхнего уровня зависимостей приложение требует, чтобы hello размещения платформы можно установить зависимости hello не требует от tooinclude hello **узла \_пакетов** папки в процессе развертывания hello.</span><span class="sxs-lookup"><span data-stu-id="6f696-131">hello **package.json** file is a way toospecify hello top-level dependencies your application requires so that hello hosting platform can install hello dependencies, rather than requiring you tooinclude hello **node\_packages** folder as part of hello deployment.</span></span> <span data-ttu-id="6f696-132">После развертывания приложения hello hello **установки npm** команды — hello используется tooparse **package.json** файл и установить все перечисленные зависимости hello.</span><span class="sxs-lookup"><span data-stu-id="6f696-132">After hello application has been deployed, hello **npm install** command is used tooparse hello **package.json** file and install all hello dependencies listed.</span></span>

<span data-ttu-id="6f696-133">Во время разработки, можно использовать hello **--Сохранить**, **--save-dev**, или **— необязательное сохранение** параметры при установке tooadd модули записи для модуля hello tooyour **package.json** файл автоматически.</span><span class="sxs-lookup"><span data-stu-id="6f696-133">During development, you can use hello **--save**, **--save-dev**, or **--save-optional** parameters when installing modules tooadd an entry for hello module tooyour **package.json** file automatically.</span></span> <span data-ttu-id="6f696-134">Дополнительные сведения см. в разделе с описанием [npm-install](https://docs.npmjs.com/cli/install).</span><span class="sxs-lookup"><span data-stu-id="6f696-134">For more information, see [npm-install](https://docs.npmjs.com/cli/install).</span></span>

<span data-ttu-id="6f696-135">Потенциальные неполадки hello **package.json** файл является то, что он только указывает версию hello для верхнего уровня зависимостей.</span><span class="sxs-lookup"><span data-stu-id="6f696-135">One potential problem with hello **package.json** file is that it only specifies hello version for top-level dependencies.</span></span> <span data-ttu-id="6f696-136">Каждый модуль может или не может указывать версию hello hello модулей, от которых он зависит, и поэтому может оказаться, что может оказаться с разных зависимость, чем hello, один для использования в разработке.</span><span class="sxs-lookup"><span data-stu-id="6f696-136">Each module installed may or may not specify hello version of hello modules it depends on, and so it is possible that you may end up with a different dependency chain than hello one used in development.</span></span>

> [!NOTE]
> <span data-ttu-id="6f696-137">Если при развертывании службы приложений tooAzure вашей <b>package.json</b> файл ссылается на модуль в машинном коде может появиться ошибка примерно toohello следующий пример, при публикации приложения hello, с помощью Git:</span><span class="sxs-lookup"><span data-stu-id="6f696-137">When deploying tooAzure App Service, if your <b>package.json</b> file references a native module you might see an error similar toohello following example when publishing hello application using Git:</span></span>
> 
> <span data-ttu-id="6f696-138">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="6f696-138">npm ERR!</span></span> <span data-ttu-id="6f696-139">module-name@0.6.0 install: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="6f696-139">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="6f696-140">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="6f696-140">npm ERR!</span></span> <span data-ttu-id="6f696-141">'cmd "/c" "node-gyp configure build"' failed with 1</span><span class="sxs-lookup"><span data-stu-id="6f696-141">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

### <a name="using-a-npm-shrinkwrapjson-file"></a><span data-ttu-id="6f696-142">Использование файла npm-shrinkwrap.json</span><span class="sxs-lookup"><span data-stu-id="6f696-142">Using a npm-shrinkwrap.json file</span></span>
<span data-ttu-id="6f696-143">Hello **npm shrinkwrap.json** файл — попытка tooaddress hello модуля управления версиями ограничения hello **package.json** файла.</span><span class="sxs-lookup"><span data-stu-id="6f696-143">hello **npm-shrinkwrap.json** file is an attempt tooaddress hello module versioning limitations of hello **package.json** file.</span></span> <span data-ttu-id="6f696-144">При hello **package.json** файл включает только версии для hello модули верхнего уровня, hello **npm shrinkwrap.json** файл содержит требования к версии hello для hello цепочку зависимостей полный модуля.</span><span class="sxs-lookup"><span data-stu-id="6f696-144">While hello **package.json** file only includes versions for hello top-level modules, hello **npm-shrinkwrap.json** file contains hello version requirements for hello full module dependency chain.</span></span>

<span data-ttu-id="6f696-145">Когда приложение будет готово для рабочей среды, можно заблокировать требования к версии и создать **npm shrinkwrap.json** файла с помощью hello **npm shrinkwrap** команды.</span><span class="sxs-lookup"><span data-stu-id="6f696-145">When your application is ready for production, you can lock down version requirements and create an **npm-shrinkwrap.json** file by using hello **npm shrinkwrap** command.</span></span> <span data-ttu-id="6f696-146">Эта команда будет использовать версии hello, установленные в hello **узел\_модули** папки и запишите эти версии toohello **npm shrinkwrap.json** файла.</span><span class="sxs-lookup"><span data-stu-id="6f696-146">This command will use hello versions currently installed in hello **node\_modules** folder, and record these versions toohello **npm-shrinkwrap.json** file.</span></span> <span data-ttu-id="6f696-147">После приложения hello развернутой toohello среду размещения, hello **установки npm** команды — hello используется tooparse **npm shrinkwrap.json** файл и установить все перечисленные зависимости hello.</span><span class="sxs-lookup"><span data-stu-id="6f696-147">After hello application has been deployed toohello hosting environment, hello **npm install** command is used tooparse hello **npm-shrinkwrap.json** file and install all hello dependencies listed.</span></span> <span data-ttu-id="6f696-148">Дополнительные сведения см. в статье о [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span><span class="sxs-lookup"><span data-stu-id="6f696-148">For more information, see [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span></span>

> [!NOTE]
> <span data-ttu-id="6f696-149">Если при развертывании службы приложений tooAzure вашей <b>npm shrinkwrap.json</b> файл ссылается на модуль в машинном коде может появиться ошибка примерно toohello следующий пример, при публикации приложения hello, с помощью Git:</span><span class="sxs-lookup"><span data-stu-id="6f696-149">When deploying tooAzure App Service, if your <b>npm-shrinkwrap.json</b> file references a native module you might see an error similar toohello following example when publishing hello application using Git:</span></span>
> 
> <span data-ttu-id="6f696-150">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="6f696-150">npm ERR!</span></span> <span data-ttu-id="6f696-151">module-name@0.6.0 install: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="6f696-151">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="6f696-152">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="6f696-152">npm ERR!</span></span> <span data-ttu-id="6f696-153">'cmd "/c" "node-gyp configure build"' failed with 1</span><span class="sxs-lookup"><span data-stu-id="6f696-153">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="6f696-154">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="6f696-154">Next steps</span></span>
<span data-ttu-id="6f696-155">Теперь, когда вы знаете как toouse модулей Node.js в Azure, узнайте, как слишком[укажите версию Node.js hello], [построения и развертывания веб-приложения Node.js](app-service-web/app-service-web-get-started-nodejs.md), и [как toouse hello Azure командной строки Интерфейс для Mac и Linux].</span><span class="sxs-lookup"><span data-stu-id="6f696-155">Now that you understand how toouse Node.js modules with Azure, learn how too[specify hello Node.js version], [build and deploy a Node.js web app](app-service-web/app-service-web-get-started-nodejs.md), and [How toouse hello Azure Command-Line Interface for Mac and Linux].</span></span>

<span data-ttu-id="6f696-156">Дополнительные сведения см. в разделе hello [Центр разработчика Node.js](/nodejs/azure/).</span><span class="sxs-lookup"><span data-stu-id="6f696-156">For more information, see hello [Node.js Developer Center](/nodejs/azure/).</span></span>

[укажите версию Node.js hello]: nodejs-specify-node-version-azure-apps.md
[как toouse hello Azure командной строки Интерфейс для Mac и Linux]:cli-install-nodejs.md
[пользовательские скрипты развертывания веб-сайта с Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo
