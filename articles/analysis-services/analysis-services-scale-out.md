---
title: "Горизонтальное масштабирование служб Azure Analysis Services | Документация Майкрософт"
description: "Репликация серверов Azure Analysis Services с помощью горизонтального масштабирования."
services: analysis-services
documentationcenter: 
author: minewiskan
manager: erikre
editor: 
ms.assetid: 
ms.service: analysis-services
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/06/2017
ms.author: owend
ms.openlocfilehash: 14bdbf3dd6d940cc3f4b665658f0c789916a2597
ms.sourcegitcommit: b07d06ea51a20e32fdc61980667e801cb5db7333
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2017
---
# <a name="azure-analysis-services-scale-out"></a>Горизонтальное масштабирование служб Azure Analysis Services

С помощью горизонтального масштабирования клиентские запросы можно распределить между несколькими *репликами запросов* в пуле запросов, уменьшив время отклика при рабочих нагрузках с большим числом запросов. Операции обработки могут выполняться отдельно от пула запросов, чтобы эти операции не оказывали отрицательного влияния на клиентские запросы. Горизонтальное масштабирование можно настроить на портале Azure или с помощью REST API служб Analysis Services.

## <a name="how-it-works"></a>Принцип работы

В обычном развертывании сервера один сервер выступает в роли сервера обработки и сервера запросов. Если количество клиентских запросов к моделям на сервере превышает число единиц обработки запросов (QPU) в плане сервера или обработка модели производится во время выполнения рабочей нагрузки с большим числом запросов, это может привести к снижению производительности. 

Благодаря функции горизонтального масштабирования вы можете создать пул запросов, который содержит до семи дополнительных реплик запросов (всего восемь, включая сервер). Можно масштабировать число реплик запросов, чтобы удовлетворять требования к QPU в критические моменты времени, и в любое время можно отделить сервер обработки от пула запросов. 

Независимо от числа реплик запросов, имеющихся в пуле запросов, обработка рабочих нагрузок не распределяется между репликами запросов. Один сервер выступает в качестве сервера обработки. Реплики запросов обслуживают только запросы к моделям, синхронизируемым между всеми репликами в пуле запросов. 

После завершения операции обработки необходимо выполнить синхронизацию сервера обработки и серверов-реплик запросов. При автоматизации операций обработки важно настроить синхронизацию после их успешного завершения. Синхронизацию можно выполнить вручную на портале или с помощью PowerShell либо REST API.

> [!NOTE]
> Горизонтальное масштабирование доступно для серверов в ценовой категории "Стандартный". Каждая реплика запросов оплачивается по той же ставке, что и сервер.

> [!NOTE]
> Горизонтальное масштабирование не увеличивает объем доступной памяти сервера. Чтобы увеличить объем памяти, необходимо изменить план.

## <a name="monitor-qpu-usage"></a>Мониторинг использования QPU

 Чтобы определить, требуется ли горизонтальное масштабирование для вашего сервера, можно отслеживать его работу с помощью метрик на портале Azure. Регулярно используется максимальное число QPU, это означает, что количество запросов к моделям превышает квоту QPU для плана. Значение метрики длины очереди заданий для пула запросов также увеличивается, когда количество запросов в очереди пула потока запросов превышает доступную квоту QPU. Чтобы узнать больше, ознакомьтесь с [отслеживанием метрик сервера](analysis-services-monitor.md).

## <a name="configure-scale-out"></a>Настройка горизонтального масштабирования

### <a name="in-azure-portal"></a>На портале Azure

1. На портале щелкните **Масштабируемый**. Используйте ползунок, чтобы выбрать количество серверов-реплик запросов. Число выбранных реплик помимо существующего сервера.

2. В разделе **Отделить сервер обработки от пула запросов** выберите "Да", чтобы отделить сервер обработки от серверов запросов.

   ![Ползунок горизонтального масштабирования](media/analysis-services-scale-out/aas-scale-out-slider.png)

3. Нажмите кнопку **Сохранить**, чтобы подготовить новые серверы-реплики запросов. 

Табличные модели на сервере-источнике синхронизируются с серверами-репликами. После завершения синхронизации пул запросов начинает распределять входящие запросы между серверами-репликами. 


## <a name="synchronization"></a>Синхронизация 

При подготовке новых реплик запросов службы Azure Analysis Services автоматически реплицируют модели во всех репликах. Можно также выполнить синхронизацию вручную с помощью портала или REST API. При обработке моделей следует выполнять синхронизацию, чтобы обновления синхронизировались между репликами запросов.

### <a name="in-azure-portal"></a>На портале Azure

Выберите **Обзор** > модель > **Синхронизировать модель**.

![Ползунок горизонтального масштабирования](media/analysis-services-scale-out/aas-scale-out-sync.png)

### <a name="rest-api"></a>ИНТЕРФЕЙС REST API
Используйте операцию **sync**.

#### <a name="synchronize-a-model"></a>Синхронизация модели:   
`POST https://<region>.asazure.windows.net/servers/<servername>:rw/models/<modelname>/sync`

#### <a name="get-sync-status"></a>Получение состояния синхронизации  
`GET https://<region>.asazure.windows.net/servers/<servername>:rw/models/<modelname>/sync`

### <a name="powershell"></a>PowerShell
Чтобы запустить синхронизацию из PowerShell, [обновите модуль AzureRM до версии](https://github.com/Azure/azure-powershell/releases) 5.01 или более поздней версии. Используйте командлет [Sync-AzureAnalysisServicesInstance](https://docs.microsoft.com/powershell/module/azurerm.analysisservices/sync-azureanalysisservicesinstance).

## <a name="connections"></a>Подключения

На странице "Обзор" вашего сервера указаны два имени сервера. Если вы еще не настроили горизонтальное масштабирование для сервера, оба его имени работают одинаково. После настройки горизонтального масштабирования для сервера потребуется указывать соответствующее имя сервера в зависимости от типа подключения. 

Для таких клиентских подключений пользователей, как Power BI Desktop, Excel и настраиваемые приложения, используйте **имя сервера**. 

Для SSMS, SSDT, строк подключения в PowerShell, приложений службы "Функции Azure" и AMO используйте **имя сервера управления**. Имя сервера управления содержит специальный квалификатор `:rw` (чтение и запись). Все операции обработки выполняются на сервере управления.

![имена серверов;](media/analysis-services-scale-out/aas-scale-out-name.png)

## <a name="related-information"></a>Связанные сведения

[Мониторинг метрик сервера](analysis-services-monitor.md)   
[Управление службами Azure Analysis Services](analysis-services-manage.md) 

