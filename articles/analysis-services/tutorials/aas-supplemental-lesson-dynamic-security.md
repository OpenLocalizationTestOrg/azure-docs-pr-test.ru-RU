---
<span data-ttu-id="ca10c-101">Заголовок: aaa» Azure Analysis Services tutorial дополнительного занятия: динамическая безопасность | Документы Microsoft» Описание: описание, как фильтры toouse динамической безопасности с помощью строки в учебнике hello Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ca10c-101">title: aaa"Azure Analysis Services tutorial supplemental lesson: Dynamic security | Microsoft Docs" description: Describes how toouse dynamic security by using row filters in hello Azure Analysis Services tutorial.</span></span>
<span data-ttu-id="ca10c-102">службы: documentationcenter служб analysis services: '' Автор: диспетчер minewiskan: редактор erikre: '' теги: ''</span><span class="sxs-lookup"><span data-stu-id="ca10c-102">services: analysis-services documentationcenter: '' author: minewiskan manager: erikre editor: '' tags: ''</span></span>

<span data-ttu-id="ca10c-103">MS.AssetId: ms.service: ms.devlang служб analysis services: н/д ms.topic: get-started-article ms.tgt_pltfrm: ms.workload н/д: н/д ms.date: 26/05/2017 ms.author: owend</span><span class="sxs-lookup"><span data-stu-id="ca10c-103">ms.assetid: ms.service: analysis-services ms.devlang: NA ms.topic: get-started-article ms.tgt_pltfrm: NA ms.workload: na ms.date: 05/26/2017 ms.author: owend</span></span>
---
# <a name="supplemental-lesson---dynamic-security"></a><span data-ttu-id="ca10c-104">Дополнительное занятие. Динамическая безопасность</span><span class="sxs-lookup"><span data-stu-id="ca10c-104">Supplemental lesson - Dynamic security</span></span>

[!INCLUDE[analysis-services-appliesto-aas-sql2017-later](../../../includes/analysis-services-appliesto-aas-sql2017-later.md)]

<span data-ttu-id="ca10c-105">В этом дополнительном занятии вы создадите дополнительную роль, реализующую динамическую безопасность.</span><span class="sxs-lookup"><span data-stu-id="ca10c-105">In this supplemental lesson, you create an additional role that implements dynamic security.</span></span> <span data-ttu-id="ca10c-106">Динамическая безопасность обеспечивает безопасность на уровне строк на основе hello пользователя имя или имя входа кода hello пользователя, вошедшего в систему.</span><span class="sxs-lookup"><span data-stu-id="ca10c-106">Dynamic security provides row-level security based on hello user name or login id of hello user currently logged on.</span></span> 
  
<span data-ttu-id="ca10c-107">tooimplement динамической безопасности, добавьте модели tooyour таблицы, содержащей имена пользователей hello тех пользователей, которые могут подключаться toohello модели и просматривать объекты и модели данных.</span><span class="sxs-lookup"><span data-stu-id="ca10c-107">tooimplement dynamic security, you add a table tooyour model containing hello user names of those users that can connect toohello model and browse model objects and data.</span></span> <span data-ttu-id="ca10c-108">Hello модели, созданные с помощью этого учебника находится в контексте hello Adventure Works; Тем не менее, toocomplete это занятие, необходимо добавить таблицу, содержащую пользователей из собственного домена.</span><span class="sxs-lookup"><span data-stu-id="ca10c-108">hello model you create using this tutorial is in hello context of Adventure Works; however, toocomplete this lesson, you must add a table containing users from your own domain.</span></span> <span data-ttu-id="ca10c-109">Не обязательно hello пароли для hello имена пользователей, которые были добавлены.</span><span class="sxs-lookup"><span data-stu-id="ca10c-109">You do not need hello passwords for hello user names that are added.</span></span> <span data-ttu-id="ca10c-110">toocreate таблицу EmployeeSecurity с небольшой выборкой пользователей из собственного домена используется функция hello вставки данных из электронной таблицы Excel.</span><span class="sxs-lookup"><span data-stu-id="ca10c-110">toocreate an EmployeeSecurity table, with a small sample of users from your own domain, you use hello Paste feature, pasting employee data from an Excel spreadsheet.</span></span> <span data-ttu-id="ca10c-111">В реальном сценарии hello таблицу, содержащую имена пользователей обычно можно привести таблицу из фактической базы данных в качестве источника данных; Например, реальную таблицу DimEmployee.</span><span class="sxs-lookup"><span data-stu-id="ca10c-111">In a real-world scenario, hello table containing user names would typically be a table from an actual database as a data source; for example, a real DimEmployee table.</span></span>  
  
<span data-ttu-id="ca10c-112">tooimplement динамической безопасности, используйте две функции DAX: [функция USERNAME (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) и [функция LOOKUPVALUE (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span><span class="sxs-lookup"><span data-stu-id="ca10c-112">tooimplement dynamic security, you use two DAX functions: [USERNAME Function (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) and [LOOKUPVALUE Function (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span></span> <span data-ttu-id="ca10c-113">Такие функции, применяемые в формуле фильтра строк, определяются в новой роли.</span><span class="sxs-lookup"><span data-stu-id="ca10c-113">These functions, applied in a row filter formula, are defined in a new role.</span></span> <span data-ttu-id="ca10c-114">С помощью функции LOOKUPVALUE hello, формула hello указывает значение из таблицы EmployeeSecurity hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-114">By using hello LOOKUPVALUE function, hello formula specifies a value from hello EmployeeSecurity table.</span></span> <span data-ttu-id="ca10c-115">Формула Hello затем передает, значение toohello USERNAME, функция, которая указывает имя пользователя hello hello пользователя, зарегистрированного в системе относится toothis роли.</span><span class="sxs-lookup"><span data-stu-id="ca10c-115">hello formula then passes that value toohello USERNAME function, which specifies hello user name of hello user logged on belongs toothis role.</span></span> <span data-ttu-id="ca10c-116">Hello пользователь может просматривать только данные, заданные hello фильтры строк.</span><span class="sxs-lookup"><span data-stu-id="ca10c-116">hello user can then browse only data specified by hello role’s row filters.</span></span> <span data-ttu-id="ca10c-117">В этом случае укажите, что сотрудники отдела продаж могут просматривать только те данные Интернет-продаж для hello территорий продаж, в которых они являются членами.</span><span class="sxs-lookup"><span data-stu-id="ca10c-117">In this scenario, you specify that sales employees can only browse Internet sales data for hello sales territories in which they are a member.</span></span>  
  
<span data-ttu-id="ca10c-118">Таким образом определяются задачи, которые являются уникальными toothis сценария табличной модели Adventure Works, но они не обязательно tooa реальном сценарии.</span><span class="sxs-lookup"><span data-stu-id="ca10c-118">Those tasks that are unique toothis Adventure Works tabular model scenario, but would not necessarily apply tooa real-world scenario are identified as such.</span></span> <span data-ttu-id="ca10c-119">Каждое задание включает дополнительные сведения, описывающие цель hello задачу hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-119">Each task includes additional information describing hello purpose of hello task.</span></span>  
  
<span data-ttu-id="ca10c-120">Предполагаемое время toocomplete на этом занятии: **30 минут**</span><span class="sxs-lookup"><span data-stu-id="ca10c-120">Estimated time toocomplete this lesson: **30 minutes**</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="ca10c-121">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="ca10c-121">Prerequisites</span></span>  
<span data-ttu-id="ca10c-122">Это дополнительное занятие входит в учебник по табличному моделированию, который следует изучать в предложенном порядке.</span><span class="sxs-lookup"><span data-stu-id="ca10c-122">This supplemental lesson topic is part of a tabular modeling tutorial, which should be completed in order.</span></span> <span data-ttu-id="ca10c-123">Перед выполнением задачи hello в этом дополнительном занятии, необходимо завершить все предыдущие занятия.</span><span class="sxs-lookup"><span data-stu-id="ca10c-123">Before performing hello tasks in this supplemental lesson, you should have completed all previous lessons.</span></span>  
  
## <a name="add-hello-dimsalesterritory-table-toohello-aw-internet-sales-tabular-model-project"></a><span data-ttu-id="ca10c-124">Добавить toohello таблицы DimSalesTerritory hello проекта табличной модели AW Internet Sales</span><span class="sxs-lookup"><span data-stu-id="ca10c-124">Add hello DimSalesTerritory table toohello AW Internet Sales Tabular Model Project</span></span>  
<span data-ttu-id="ca10c-125">tooimplement динамической безопасности для этого сценария Adventure Works, необходимо добавить две модели tooyour дополнительных таблиц.</span><span class="sxs-lookup"><span data-stu-id="ca10c-125">tooimplement dynamic security for this Adventure Works scenario, you must add two additional tables tooyour model.</span></span> <span data-ttu-id="ca10c-126">Hello первой таблицы, добавляемого называется DimSalesTerritory (т Территория продаж) из hello одной базы данных AdventureWorksDW.</span><span class="sxs-lookup"><span data-stu-id="ca10c-126">hello first table you add is DimSalesTerritory (as Sales Territory) from hello same AdventureWorksDW database.</span></span> <span data-ttu-id="ca10c-127">Затем применять таблицы SalesTerritory toohello фильтр строк, которая определяет hello данных можно просмотреть hello, вошедшего в систему пользователя.</span><span class="sxs-lookup"><span data-stu-id="ca10c-127">You later apply a row filter toohello SalesTerritory table that defines hello particular data hello logged on user can browse.</span></span>  
  
#### <a name="tooadd-hello-dimsalesterritory-table"></a><span data-ttu-id="ca10c-128">таблицы DimSalesTerritory tooadd hello</span><span class="sxs-lookup"><span data-stu-id="ca10c-128">tooadd hello DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="ca10c-129">В обозревателе табличных моделей выберите **Источники данных**, щелкните правой кнопкой мыши подключение и выберите элемент **Импортировать новые таблицы**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-129">In Tabular Model Explorer > **Data Sources**, right-click your connection, and then click **Import New Tables**.</span></span>  

    <span data-ttu-id="ca10c-130">Если появится диалоговое окно учетные данные олицетворения hello, введите учетные данные олицетворения hello, который использовался в занятии 2: Добавление данных.</span><span class="sxs-lookup"><span data-stu-id="ca10c-130">If hello Impersonation Credentials dialog box appears, type hello impersonation credentials you used in Lesson 2: Add Data.</span></span>
  
2.  <span data-ttu-id="ca10c-131">Выберите в навигаторе hello **DimSalesTerritory** , а затем выберите пункт **ОК**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-131">In Navigator, select hello **DimSalesTerritory** table, and then click **OK**.</span></span>    
  
3.  <span data-ttu-id="ca10c-132">В редакторе запросов щелкните hello **DimSalesTerritory** запроса, а затем удалите **SalesTerritoryAlternateKey** столбца.</span><span class="sxs-lookup"><span data-stu-id="ca10c-132">In Query Editor, click hello **DimSalesTerritory** query, and then remove **SalesTerritoryAlternateKey** column.</span></span>  
  
7.  <span data-ttu-id="ca10c-133">Щелкните **Импорт**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-133">Click **Import**.</span></span>  
  
    <span data-ttu-id="ca10c-134">область toohello модели добавляется новая таблица Hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-134">hello new table is added toohello model workspace.</span></span> <span data-ttu-id="ca10c-135">Затем объекты и данные из исходной таблицы DimSalesTerritory hello импортируются в табличной модели AW Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="ca10c-135">Objects and data from hello source DimSalesTerritory table are then imported into your AW Internet Sales Tabular Model.</span></span>  
  
9. <span data-ttu-id="ca10c-136">После успешного импорта таблицы hello, нажмите кнопку **закрыть**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-136">After hello table has been imported successfully, click **Close**.</span></span>  

## <a name="add-a-table-with-user-name-data"></a><span data-ttu-id="ca10c-137">Добавление таблицы с именами пользователей</span><span class="sxs-lookup"><span data-stu-id="ca10c-137">Add a table with user name data</span></span>  
<span data-ttu-id="ca10c-138">Hello таблица DimEmployee в образце базы данных AdventureWorksDW hello содержит пользователей из домена AdventureWorks hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-138">hello DimEmployee table in hello AdventureWorksDW sample database contains users from hello AdventureWorks domain.</span></span> <span data-ttu-id="ca10c-139">Эти имена пользователей не существуют в вашей среде.</span><span class="sxs-lookup"><span data-stu-id="ca10c-139">Those user names do not exist in your own environment.</span></span> <span data-ttu-id="ca10c-140">Необходимо создать в модели таблицу, содержащую небольшую выборку данных фактических пользователей из вашей организации (по крайней мере трех).</span><span class="sxs-lookup"><span data-stu-id="ca10c-140">You must create a table in your model that contains a small sample (at least three) of actual users from your organization.</span></span> <span data-ttu-id="ca10c-141">Затем добавьте этих пользователей как членов toohello новой роли.</span><span class="sxs-lookup"><span data-stu-id="ca10c-141">You then add these users as members toohello new role.</span></span> <span data-ttu-id="ca10c-142">Нет необходимости hello пароли для имен пользователей образец hello, но вам нужен имена реальных пользователей Windows из собственного домена.</span><span class="sxs-lookup"><span data-stu-id="ca10c-142">You do not need hello passwords for hello sample user names, but you do need actual Windows user names from your own domain.</span></span>  
  
#### <a name="tooadd-an-employeesecurity-table"></a><span data-ttu-id="ca10c-143">tooadd EmployeeSecurity таблицы</span><span class="sxs-lookup"><span data-stu-id="ca10c-143">tooadd an EmployeeSecurity table</span></span>  
  
1.  <span data-ttu-id="ca10c-144">Откройте Microsoft Excel и создайте лист.</span><span class="sxs-lookup"><span data-stu-id="ca10c-144">Open Microsoft Excel, creating a worksheet.</span></span>  
  
2.  <span data-ttu-id="ca10c-145">Hello в следующей таблице, включая строку заголовка hello, скопируйте и вставьте его в лист hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-145">Copy hello following table, including hello header row, and then paste it into hello worksheet.</span></span>  

    ```
      |EmployeeId|SalesTerritoryId|FirstName|LastName|LoginId|  
      |---------------|----------------------|--------------|-------------|------------|  
      |1|2|<user first name>|<user last name>|\<domain\username>|  
      |1|3|<user first name>|<user last name>|\<domain\username>|  
      |2|4|<user first name>|<user last name>|\<domain\username>|  
      |3|5|<user first name>|<user last name>|\<domain\username>|  
    ```

3.  <span data-ttu-id="ca10c-146">Замените hello имя, фамилию и домен\имя_пользователя hello имена и идентификаторы входа трех пользователей в вашей организации.</span><span class="sxs-lookup"><span data-stu-id="ca10c-146">Replace hello first name, last name, and domain\username with hello names and login ids of three users in your organization.</span></span> <span data-ttu-id="ca10c-147">Поместите hello одного пользователя на первые две строки hello 1 EmployeeId, показывающая принадлежит этот пользователь toomore чем одной территории продаж.</span><span class="sxs-lookup"><span data-stu-id="ca10c-147">Put hello same user on hello first two rows, for EmployeeId 1, showing this user belongs toomore than one sales territory.</span></span> <span data-ttu-id="ca10c-148">Оставьте hello EmployeeId и SalesTerritoryId поля, как они являются.</span><span class="sxs-lookup"><span data-stu-id="ca10c-148">Leave hello EmployeeId and SalesTerritoryId fields as they are.</span></span>  
  
4.  <span data-ttu-id="ca10c-149">Сохраните лист hello как **SampleEmployee**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-149">Save hello worksheet as **SampleEmployee**.</span></span>  
  
5.  <span data-ttu-id="ca10c-150">На листе hello выделить все ячейки hello с данными о сотрудниках, включая заголовки hello, а затем щелкните правой кнопкой мыши выбранные hello данных и нажмите кнопку **копирования**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-150">In hello worksheet, select all hello cells with employee data, including hello headers, then right-click hello selected data, and then click **Copy**.</span></span>  
  
6.  <span data-ttu-id="ca10c-151">В SSDT выберите hello **изменить** меню, а затем нажмите **вставить**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-151">In SSDT, click hello **Edit** menu, and then click **Paste**.</span></span>  
  
    <span data-ttu-id="ca10c-152">Если вставить неактивен, щелкните любой столбец в любой таблице в окне конструктора моделей hello и повторите попытку.</span><span class="sxs-lookup"><span data-stu-id="ca10c-152">If Paste is grayed out, click any column in any table in hello model designer window, and try again.</span></span>  
  
7.  <span data-ttu-id="ca10c-153">В hello **Просмотр вставки** диалогового **имя таблицы**, тип **EmployeeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-153">In hello **Paste Preview** dialog box, in **Table Name**, type **EmployeeSecurity**.</span></span>  
  
8.  <span data-ttu-id="ca10c-154">В **toobe данных вставить**, проверьте hello данные включают все данные пользователя hello и заголовки из листа SampleEmployee hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-154">In **Data toobe pasted**, verify hello data includes all hello user data and headers from hello SampleEmployee worksheet.</span></span>  
  
9. <span data-ttu-id="ca10c-155">Установите флажок **Использовать первую строку в качестве заголовков столбцов** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-155">Verify **Use first row as column headers** is checked, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="ca10c-156">Создается новую таблицу с именем EmployeeSecurity с данными о сотрудниках копируются из листа SampleEmployee hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-156">A new table named EmployeeSecurity with employee data copied from hello SampleEmployee worksheet is created.</span></span>  
  
## <a name="create-relationships-between-factinternetsales-dimgeography-and-dimsalesterritory-table"></a><span data-ttu-id="ca10c-157">Создание связей между таблицами FactInternetSales DimGeography и DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="ca10c-157">Create relationships between FactInternetSales, DimGeography, and DimSalesTerritory table</span></span>  
<span data-ttu-id="ca10c-158">Hello FactInternetSales DimGeography и DimSalesTerritory таблицы все имеют общий столбец, SalesTerritoryId.</span><span class="sxs-lookup"><span data-stu-id="ca10c-158">hello FactInternetSales, DimGeography, and DimSalesTerritory table all contain a common column, SalesTerritoryId.</span></span> <span data-ttu-id="ca10c-159">столбец SalesTerritoryId Hello таблицы DimSalesTerritory hello содержит значения с другим идентификатором для каждой территории продаж.</span><span class="sxs-lookup"><span data-stu-id="ca10c-159">hello SalesTerritoryId column in hello DimSalesTerritory table contains values with a different Id for each sales territory.</span></span>  
  
#### <a name="toocreate-relationships-between-hello-factinternetsales-dimgeography-and-hello-dimsalesterritory-table"></a><span data-ttu-id="ca10c-160">toocreate связи между hello FactInternetSales DimGeography и таблицы DimSalesTerritory hello</span><span class="sxs-lookup"><span data-stu-id="ca10c-160">toocreate relationships between hello FactInternetSales, DimGeography, and hello DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="ca10c-161">В представлении диаграммы, в hello **DimGeography** таблицы, нажмите и удерживайте на hello **SalesTerritoryId** столбца, а затем перетащите hello курсор toohello **SalesTerritoryId** столбца в hello **DimSalesTerritory** таблицы, а затем отпустите.</span><span class="sxs-lookup"><span data-stu-id="ca10c-161">In Diagram View, in hello **DimGeography** table, click, and hold on hello **SalesTerritoryId** column, then drag hello cursor toohello **SalesTerritoryId** column in hello **DimSalesTerritory** table, and then release.</span></span>  
  
2.  <span data-ttu-id="ca10c-162">В hello **FactInternetSales** таблицы, нажмите и удерживайте на hello **SalesTerritoryId** столбца, а затем перетащите hello курсор toohello **SalesTerritoryId** столбца в hello  **DimSalesTerritory** таблицы, а затем отпустите.</span><span class="sxs-lookup"><span data-stu-id="ca10c-162">In hello **FactInternetSales** table, click, and hold on hello **SalesTerritoryId** column, then drag hello cursor toohello **SalesTerritoryId** column in hello **DimSalesTerritory** table, and then release.</span></span>  
  
    <span data-ttu-id="ca10c-163">Обратите внимание hello активного свойства для этого отношения имеет значение False, это означает, что он неактивен.</span><span class="sxs-lookup"><span data-stu-id="ca10c-163">Notice hello Active property for this relationship is False, meaning it's inactive.</span></span> <span data-ttu-id="ca10c-164">таблицы FactInternetSales Hello уже содержит другую активную связь.</span><span class="sxs-lookup"><span data-stu-id="ca10c-164">hello FactInternetSales table already has another active relationship.</span></span>  
  
## <a name="hide-hello-employeesecurity-table-from-client-applications"></a><span data-ttu-id="ca10c-165">Скрыть hello EmployeeSecurity таблицы от клиентских приложений</span><span class="sxs-lookup"><span data-stu-id="ca10c-165">Hide hello EmployeeSecurity Table from client applications</span></span>  
<span data-ttu-id="ca10c-166">В этой задаче вы скрыть таблицу EmployeeSecurity hello, поддерживая ее появления в списке полей клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="ca10c-166">In this task, you hide hello EmployeeSecurity table, keeping it from appearing in a client application’s field list.</span></span> <span data-ttu-id="ca10c-167">Имейте в виду, что скрытие таблицы не повышает ее защищенность.</span><span class="sxs-lookup"><span data-stu-id="ca10c-167">Keep in mind that hiding a table does not secure it.</span></span> <span data-ttu-id="ca10c-168">Пользователи по-прежнему могут запрашивать данные из таблицы EmployeeSecurity, если они знают, как это сделать.</span><span class="sxs-lookup"><span data-stu-id="ca10c-168">Users can still query EmployeeSecurity table data if they know how.</span></span> <span data-ttu-id="ca10c-169">toosecure Здравствуйте EmployeeSecurity данных таблицы, препятствующие пользователи могли tooquery какие-либо его данные, применить фильтр в одной из следующих задач.</span><span class="sxs-lookup"><span data-stu-id="ca10c-169">toosecure hello EmployeeSecurity table data, preventing users from being able tooquery any of its data, you apply a filter in a later task.</span></span>  
  
#### <a name="toohide-hello-employeesecurity-table-from-client-applications"></a><span data-ttu-id="ca10c-170">toohide hello EmployeeSecurity таблицы от клиентских приложений</span><span class="sxs-lookup"><span data-stu-id="ca10c-170">toohide hello EmployeeSecurity table from client applications</span></span>  
  
-   <span data-ttu-id="ca10c-171">В конструкторе моделей hello в представлении диаграммы, щелкните правой кнопкой мыши hello **сотрудника** заголовок таблицы, а затем нажмите кнопку **скрыть от клиентских средств**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-171">In hello model designer, in Diagram View, right-click hello **Employee** table heading, and then click **Hide from Client Tools**.</span></span>  
  
## <a name="create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="ca10c-172">Создание роли пользователя "Торговые специалисты по территориям"</span><span class="sxs-lookup"><span data-stu-id="ca10c-172">Create a Sales Employees by Territory user role</span></span>  
<span data-ttu-id="ca10c-173">В этой задаче вы создадите роль пользователя.</span><span class="sxs-lookup"><span data-stu-id="ca10c-173">In this task, you create a user role.</span></span> <span data-ttu-id="ca10c-174">Эта роль включает фильтр строк, определяющий, какие строки таблицы DimSalesTerritory hello являются видимыми toousers.</span><span class="sxs-lookup"><span data-stu-id="ca10c-174">This role includes a row filter defining which rows of hello DimSalesTerritory table are visible toousers.</span></span> <span data-ttu-id="ca10c-175">Hello фильтр будет применен в отношении hello один ко многим другим направление tooall таблиц связанных tooDimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="ca10c-175">hello filter is then applied in hello one-to-many relationship direction tooall other tables related tooDimSalesTerritory.</span></span> <span data-ttu-id="ca10c-176">Можно также применить фильтр, обеспечивающий безопасность всей таблицы EmployeeSecurity hello могли направлять к любой пользователь, который является членом роли hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-176">You also apply a filter that secures hello entire EmployeeSecurity table from being queryable by any user that is a member of hello role.</span></span>  
  
> [!NOTE]  
> <span data-ttu-id="ca10c-177">Hello сотрудники отдела продаж по территории, создаваемая на этом занятии ограничивает элементы toobrowse (или запрос) только данные о продажах для hello toowhich территории продаж, которые они входят.</span><span class="sxs-lookup"><span data-stu-id="ca10c-177">hello Sales Employees by Territory role you create in this lesson restricts members toobrowse (or query) only sales data for hello sales territory toowhich they belong.</span></span> <span data-ttu-id="ca10c-178">При добавлении пользователя в качестве члена toohello сотрудники отдела продаж по территории, также существует как в роли для создания в [занятие 11: Создание ролей](../tutorials/aas-lesson-11-create-roles.md), вы получаете сочетание разрешений.</span><span class="sxs-lookup"><span data-stu-id="ca10c-178">If you add a user as a member toohello Sales Employees by Territory role that also exists as a member in a role created in [Lesson 11: Create Roles](../tutorials/aas-lesson-11-create-roles.md), you get a combination of permissions.</span></span> <span data-ttu-id="ca10c-179">Если пользователь входит в несколько ролей, разрешения hello и фильтров строк, определенными для каждой из них.</span><span class="sxs-lookup"><span data-stu-id="ca10c-179">When a user is a member of multiple roles, hello permissions, and row filters defined for each role are cumulative.</span></span> <span data-ttu-id="ca10c-180">То есть hello пользователем hello большими разрешениями, определяется hello комбинации ролей.</span><span class="sxs-lookup"><span data-stu-id="ca10c-180">That is, hello user has hello greater permissions determined by hello combination of roles.</span></span>  
  
#### <a name="toocreate-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="ca10c-181">toocreate сотрудники отдела продаж по территории роли пользователя</span><span class="sxs-lookup"><span data-stu-id="ca10c-181">toocreate a Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="ca10c-182">В SSDT выберите hello **модель** меню, а затем нажмите **ролей**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-182">In SSDT, click hello **Model** menu, and then click **Roles**.</span></span>  
  
2.  <span data-ttu-id="ca10c-183">В **диспетчере ролей** нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-183">In **Role Manager**, click **New**.</span></span>  
  
    <span data-ttu-id="ca10c-184">Новая роль с hello None разрешение добавлен список toohello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-184">A new role with hello None permission is added toohello list.</span></span>  
  
3.  <span data-ttu-id="ca10c-185">Щелкните новую роль hello, а затем в hello **имя** столбца, слишком переименовать роль hello**сотрудники отдела продаж по территории**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-185">Click hello new role, and then in hello **Name** column, rename hello role too**Sales Employees by Territory**.</span></span>  
  
4.  <span data-ttu-id="ca10c-186">В hello **разрешений** столбец, нажмите кнопку раскрывающегося списка hello, а затем выберите hello **чтения** разрешение.</span><span class="sxs-lookup"><span data-stu-id="ca10c-186">In hello **Permissions** column, click hello dropdown list, and then select hello **Read** permission.</span></span>  
  
5.  <span data-ttu-id="ca10c-187">Нажмите кнопку hello **элементы** , а затем щелкните **добавить**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-187">Click hello **Members** tab, and then click **Add**.</span></span>  
  
6.  <span data-ttu-id="ca10c-188">В hello **Выбор пользователя или группы** диалогового **ввод hello объекта с именем tooselect**, тип hello первый пример имя пользователя, используемое при создании таблицы EmployeeSecurity hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-188">In hello **Select User or Group** dialog box, in **Enter hello object named tooselect**, type hello first sample user name you used when creating hello EmployeeSecurity table.</span></span> <span data-ttu-id="ca10c-189">Нажмите кнопку **проверить имена** tooverify hello пользователя имя является допустимым и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-189">Click **Check Names** tooverify hello user name is valid, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="ca10c-190">Повторите этот шаг, добавляя hello другие имена из выборки пользователей, используемые при создании таблицы EmployeeSecurity hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-190">Repeat this step, adding hello other sample user names you used when creating hello EmployeeSecurity table.</span></span>  
  
7.  <span data-ttu-id="ca10c-191">Нажмите кнопку hello **фильтры строк** вкладки.</span><span class="sxs-lookup"><span data-stu-id="ca10c-191">Click hello **Row Filters** tab.</span></span>  
  
8.  <span data-ttu-id="ca10c-192">Для hello **EmployeeSecurity** таблицы в hello **фильтр DAX** столбец, тип hello следующую формулу:</span><span class="sxs-lookup"><span data-stu-id="ca10c-192">For hello **EmployeeSecurity** table, in hello **DAX Filter** column, type hello following formula:</span></span>  
  
    ```
      =FALSE()  
    ```
  
    <span data-ttu-id="ca10c-193">Эта формула указывает, что все столбцы решаются toohello false логическое условие.</span><span class="sxs-lookup"><span data-stu-id="ca10c-193">This formula specifies that all columns resolve toohello false Boolean condition.</span></span> <span data-ttu-id="ca10c-194">Не указаны столбцы для таблицы EmployeeSecurity hello могут запрашиваться членом hello сотрудники отдела продаж по территории роли пользователя.</span><span class="sxs-lookup"><span data-stu-id="ca10c-194">No columns for hello EmployeeSecurity table can be queried by a member of hello Sales Employees by Territory user role.</span></span>  
  
9. <span data-ttu-id="ca10c-195">Для hello **DimSalesTerritory** таблицы, тип hello следующую формулу:</span><span class="sxs-lookup"><span data-stu-id="ca10c-195">For hello **DimSalesTerritory** table, type hello following formula:</span></span>  

    ```  
    ='Sales Territory'[Sales Territory Id]=LOOKUPVALUE('Employee Security'[Sales Territory Id], 
      'Employee Security'[Login Id], USERNAME(), 
      'Employee Security'[Sales Territory Id], 
      'Sales Territory'[Sales Territory Id]) 
    ```
  
    <span data-ttu-id="ca10c-196">В этой формуле hello функция LOOKUPVALUE возвращает все значения для столбца [SalesTerritoryId] DimEmployeeSecurity hello, где hello EmployeeSecurity [LoginId] hello же, как hello текущего входа имя пользователя Windows и EmployeeSecurity [ SalesTerritoryId] hello аналогично hello DimSalesTerritory [SalesTerritoryId].</span><span class="sxs-lookup"><span data-stu-id="ca10c-196">In this formula, hello LOOKUPVALUE function returns all values for hello DimEmployeeSecurity[SalesTerritoryId] column, where hello EmployeeSecurity[LoginId] is hello same as hello current logged on Windows user name, and EmployeeSecurity[SalesTerritoryId] is hello same as hello DimSalesTerritory[SalesTerritoryId].</span></span>  
  
    <span data-ttu-id="ca10c-197">Hello набор идентификаторов территории продаж, возвращенные функцией LOOKUPVALUE будет использоваться toorestrict hello строк, отображаемых в hello таблицы DimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="ca10c-197">hello set of sales territory IDs returned by LOOKUPVALUE is then used toorestrict hello rows shown in hello DimSalesTerritory table.</span></span> <span data-ttu-id="ca10c-198">Отображаются только строки, где hello SalesTerritoryID для hello строки в набор идентификаторов, возвращенных функцией LOOKUPVALUE hello hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-198">Only rows where hello SalesTerritoryID for hello row is in hello set of IDs returned by hello LOOKUPVALUE function are displayed.</span></span>  
  
10. <span data-ttu-id="ca10c-199">В диспетчере ролей нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-199">In Role Manager, click **Ok**.</span></span>  
  
## <a name="test-hello-sales-employees-by-territory-user-role"></a><span data-ttu-id="ca10c-200">Тестирование hello сотрудники отдела продаж по территории роли пользователя</span><span class="sxs-lookup"><span data-stu-id="ca10c-200">Test hello Sales Employees by Territory User Role</span></span>  
<span data-ttu-id="ca10c-201">В этой задаче вы используете hello анализ в Excel в SSDT tootest hello эффективность hello сотрудники отдела продаж по территории роли пользователя.</span><span class="sxs-lookup"><span data-stu-id="ca10c-201">In this task, you use hello Analyze in Excel feature in SSDT tootest hello efficacy of hello Sales Employees by Territory user role.</span></span> <span data-ttu-id="ca10c-202">Можно указать один приветствия имен пользователей добавлены toohello EmployeeSecurity таблицы и в качестве члена роли hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-202">You specify one of hello user names you added toohello EmployeeSecurity table and as a member of hello role.</span></span> <span data-ttu-id="ca10c-203">Это имя пользователя затем используется как имя действующего пользователя hello в hello соединения, установленного между Excel и hello модели.</span><span class="sxs-lookup"><span data-stu-id="ca10c-203">This user name is then used as hello effective user name in hello connection created between Excel and hello model.</span></span>  
  
#### <a name="tootest-hello-sales-employees-by-territory-user-role"></a><span data-ttu-id="ca10c-204">hello tootest сотрудники отдела продаж по территории роли пользователя</span><span class="sxs-lookup"><span data-stu-id="ca10c-204">tootest hello Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="ca10c-205">В SSDT выберите hello **модель** меню, а затем нажмите **анализ в Excel**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-205">In SSDT, click hello **Model** menu, and then click **Analyze in Excel**.</span></span>  
  
2.  <span data-ttu-id="ca10c-206">В hello **анализ в Excel** диалогового **укажите hello имя или роль toouse tooconnect toohello модели пользователя**выберите **другой пользователь Windows**и нажмите кнопку **Обзор**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-206">In hello **Analyze in Excel** dialog box, in **Specify hello user name or role toouse tooconnect toohello model**, select **Other Windows User**, and then click **Browse**.</span></span>  
  
3.  <span data-ttu-id="ca10c-207">В hello **Выбор пользователя или группы** диалогового **введите имя tooselect hello объекта**, введите имя пользователя, включенные в таблице EmployeeSecurity hello и нажмите кнопку **проверить имена**.</span><span class="sxs-lookup"><span data-stu-id="ca10c-207">In hello **Select User or Group** dialog box, in **Enter hello object name tooselect**, type a user name you included in hello EmployeeSecurity table, and then click **Check Names**.</span></span>  
  
4.  <span data-ttu-id="ca10c-208">Нажмите кнопку **ОК** tooclose hello **Выбор пользователя или группы** диалоговое окно, а затем щелкните **ОК** tooclose hello **анализ в Excel** диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="ca10c-208">Click **Ok** tooclose hello **Select User or Group** dialog box, and then click **Ok** tooclose hello **Analyze in Excel** dialog box.</span></span>  
  
    <span data-ttu-id="ca10c-209">В Excel открывается новая книга.</span><span class="sxs-lookup"><span data-stu-id="ca10c-209">Excel opens with a new workbook.</span></span> <span data-ttu-id="ca10c-210">Автоматически создается сводная таблица.</span><span class="sxs-lookup"><span data-stu-id="ca10c-210">A PivotTable is automatically created.</span></span> <span data-ttu-id="ca10c-211">Hello список полей сводной таблицы включает большинство полей данных hello, доступные в новой модели.</span><span class="sxs-lookup"><span data-stu-id="ca10c-211">hello PivotTable Fields list includes most of hello data fields available in your new model.</span></span>  
  
    <span data-ttu-id="ca10c-212">Обратите внимание hello EmployeeSecurity таблица не отображается в списке полей сводной таблицы hello.</span><span class="sxs-lookup"><span data-stu-id="ca10c-212">Notice hello EmployeeSecurity table is not visible in hello PivotTable Fields list.</span></span> <span data-ttu-id="ca10c-213">Вы скрыли ее для клиентских средств в предыдущей задаче.</span><span class="sxs-lookup"><span data-stu-id="ca10c-213">You hid this table from client tools in a previous task.</span></span>  
  
5.  <span data-ttu-id="ca10c-214">В hello **поля** в списке **∑ Интернет-продаж** (меры) выберите hello **InternetTotalSales** мер.</span><span class="sxs-lookup"><span data-stu-id="ca10c-214">In hello **Fields** list, in **∑ Internet Sales** (measures), select hello **InternetTotalSales** measure.</span></span> <span data-ttu-id="ca10c-215">мера Hello вводится в hello **значения** поля.</span><span class="sxs-lookup"><span data-stu-id="ca10c-215">hello measure is entered into hello **Values** fields.</span></span>  
  
6.  <span data-ttu-id="ca10c-216">Выберите hello **SalesTerritoryId** столбец из hello **DimSalesTerritory** таблицы.</span><span class="sxs-lookup"><span data-stu-id="ca10c-216">Select hello **SalesTerritoryId** column from hello **DimSalesTerritory** table.</span></span> <span data-ttu-id="ca10c-217">столбец Hello вводится в hello **метки строк** поля.</span><span class="sxs-lookup"><span data-stu-id="ca10c-217">hello column is entered into hello **Row Labels** fields.</span></span>  
  
    <span data-ttu-id="ca10c-218">Уведомление Internet цифры продаж появятся только для hello один регион toowhich hello действующего пользователя именем, которое принадлежит.</span><span class="sxs-lookup"><span data-stu-id="ca10c-218">Notice Internet sales figures appear only for hello one region toowhich hello effective user name you used belongs.</span></span> <span data-ttu-id="ca10c-219">Если выбрать другой столбец, как город из таблицы DimGeography hello поле метки строки, только города hello территории продаж toowhich hello действующего пользователя, принадлежащего отображаются.</span><span class="sxs-lookup"><span data-stu-id="ca10c-219">If you select another column, like City from hello DimGeography table as Row Label field, only cities in hello sales territory toowhich hello effective user belongs are displayed.</span></span>  
  
    <span data-ttu-id="ca10c-220">Этот пользователь не может просмотреть или запросить данных Интернет-продаж для других hello один они принадлежат к территорий.</span><span class="sxs-lookup"><span data-stu-id="ca10c-220">This user cannot browse or query any Internet sales data for territories other than hello one they belong to.</span></span> <span data-ttu-id="ca10c-221">Это ограничение обусловлено hello фильтр строк, определенных для таблицы DimSalesTerritory hello в hello сотрудники отдела продаж по территории роли пользователя, защищает данные для всех данных, связанных с tooother территорий продаж.</span><span class="sxs-lookup"><span data-stu-id="ca10c-221">This restriction is because hello row filter defined for hello DimSalesTerritory table, in hello Sales Employees by Territory user role, secures data for all data related tooother sales territories.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ca10c-222">См. также</span><span class="sxs-lookup"><span data-stu-id="ca10c-222">See Also</span></span>  
[<span data-ttu-id="ca10c-223">Функция USERNAME (DAX)</span><span class="sxs-lookup"><span data-stu-id="ca10c-223">USERNAME Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh230954.aspx)  
[<span data-ttu-id="ca10c-224">Функция LOOKUPVALUE (DAX)</span><span class="sxs-lookup"><span data-stu-id="ca10c-224">LOOKUPVALUE Function (DAX)</span></span>](https://msdn.microsoft.com/library/gg492170.aspx)  
[<span data-ttu-id="ca10c-225">Функция CUSTOMDATA (DAX)</span><span class="sxs-lookup"><span data-stu-id="ca10c-225">CUSTOMDATA Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh213140.aspx)  