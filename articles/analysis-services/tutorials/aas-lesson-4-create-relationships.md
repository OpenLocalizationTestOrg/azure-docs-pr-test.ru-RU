---
title: "Учебник по службам Azure Analysis Services: занятие 4 \"Создание связей\" | Документы Майкрософт"
description: "Описывает создание связей в учебном проекте служб Azure Analysis Services."
services: analysis-services
documentationcenter: 
author: Minewiskan
manager: kfile
editor: 
tags: 
ms.assetid: 
ms.service: analysis-services
ms.devlang: NA
ms.topic: get-started-article
ms.tgt_pltfrm: NA
ms.workload: na
ms.date: 01/08/2018
ms.author: owend
ms.openlocfilehash: 57b3a172445047291f0aea5b1616b9dcbf6bf745
ms.sourcegitcommit: 176c575aea7602682afd6214880aad0be6167c52
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/09/2018
---
# <a name="create-relationships"></a>Создать связи

В этом занятии вы проверите связи, созданные автоматически при импорте данных, а также добавите новые связи между различными таблицами. Связь — это соединение между двумя таблицами, определяющее, как именно должны соотноситься данные в них. Например, таблицы DimProduct и DimProductSubcategory имеют связь, основанную на том факте, что каждый продукт принадлежит подкатегории. Дополнительные сведения см. в статье [Связи](https://docs.microsoft.com/sql/analysis-services/tabular-models/relationships-ssas-tabular).
  
Предполагаемое время выполнения этого занятия: **10 минут**  
  
## <a name="prerequisites"></a>Необходимые компоненты  
Этот раздел входит в учебник по табличному моделированию, который следует изучать в предложенном порядке. Прежде чем выполнять задачи в этом разделе, нужно завершить предыдущее занятие: [Занятие 3. Обозначение таблицы дат](../tutorials/aas-lesson-3-mark-as-date-table.md). 
  
## <a name="review-existing-relationships-and-add-new-relationships"></a>Просмотр существующих и добавление новых связей  
При импорте данных с помощью функции получения данных вы получили из базы данных AdventureWorksDW2014 семь таблиц. В общем случае при импорте данных из реляционного источника вместе с ними автоматически импортируются и существующие связи. Чтобы функция получения данных могла автоматически создать связи в модели данных, должны быть установлены связи между таблицами в источнике данных.

Прежде чем продолжить создание модели, нужно убедиться, что эти связи между таблицами созданы правильно. В этом руководстве вы также добавите три новых связи.  

  
#### <a name="to-review-existing-relationships"></a>Просмотр существующих связей  
  
1.  Щелкните меню **Модель** и выберите **Представление модели** > **Представление схемы**.  

    Теперь конструктор моделей находится в представлении схемы — графическом формате, когда все импортированные таблицы отображаются с линиями между ними. Линии между таблицами обозначают связи, созданные автоматически при импорте данных.
    
    ![aas-lesson4-diagram](../tutorials/media/aas-lesson4-diagram.png)
  
    > [!NOTE]
    > Если вы не видите никаких связей между таблицами, скорее всего, это означает, что между этими таблицами нет связей в источнике данных.

    Включите максимальное число таблиц, используя элементы управления мини-карты в правом нижнем углу конструктора моделей. Вы также можете щелкнуть и перетащить таблицы в другое место, сблизив их или расположив в определенном порядке. Перемещение таблиц не влияет на связи между ними. Для просмотра всех столбцов в определенной таблице щелкните и перетащите ее край, чтобы развернуть или уменьшить ее.  
  
2.  Щелкните сплошную линию между таблицами **DimCustomer** и **DimGeography**. Сплошная линия между этими двумя таблицами показывает, что связь активна, то есть используется по умолчанию при вычислении формул DAX.  
  
    Обратите внимание, что столбец **GeographyKey** таблицы **DimCustomer** и столбец **GeographyKey** таблицы **DimGeography** вместе появились в поле. Эти столбцы используются для построения связи. Свойства связи теперь отображаются в окне **Свойства**.  
  
    > [!TIP]  
    > Кроме использования конструктора моделей в представлении схемы, можно также воспользоваться диалоговым окном "Управление связями" для демонстрации связей между всеми таблицами в табличном формате. В обозревателе табличных моделей щелкните правой кнопкой мыши **Связи** > **Управление связями**.
  
3.  Убедитесь, что при импорте каждой таблицы из базы данных AdventureWorksDW были созданы следующие связи:  
  
    |Активна|Таблица|Соответствующая таблица подстановки|  
    |----------|---------|------------------------|  
    |Yes|**DimCustomer [GeographyKey]**|**DimGeography [GeographyKey]**|  
    |Yes|**DimProduct [ProductSubcategoryKey]**|**DimProductSubcategory [ProductSubcategoryKey]**|  
    |Yes|**DimProductSubcategory [ProductCategoryKey]**|**DimProductCategory [ProductCategoryKey]**|  
    |Yes|**FactInternetSales [CustomerKey]**|**DimCustomer [CustomerKey]**|  
    |Yes|**FactInternetSales [ProductKey]**|**DimProduct [ProductKey]**|  
  
    При отсутствии связей убедитесь, что модель включает в себя следующие таблицы: DimCustomer, DimDate, DimGeography, DimProduct, DimProductCategory, DimProductSubcategory и FactInternetSales. Если таблицы из одного подключения к источнику данных импортируются в разное время, связи между ними не создаются автоматически, поэтому их нужно настроить вручную. Если связи не отображаются, это значит, что в источнике данных нет связей. Их можно создать вручную в модели данных.

### <a name="take-a-closer-look"></a>Более подробный взгляд
В представлении схемы на линиях, обозначающих связи между таблицами, отображается стрелка, звездочка и число.

![aas-lesson4-line](../tutorials/media/aas-lesson4-line.png)

Стрелка указывает на направление фильтрации. Звездочка показывает, что эта таблица относится к множественной стороне в кратности связи, а число 1 показывает, что эта таблица относится к одиночной стороне связи. Если нужно изменить связь, например ее направление фильтрации или кратность, дважды щелкните линию связи, чтобы открыть диалоговое окно "Изменение связи".

![aas-lesson4-edit](../tutorials/media/aas-lesson4-edit.png)

Эти функции предназначены для расширенного моделирования данных и выходят за рамки данного учебника. Дополнительные сведения см. в разделе [Двунаправленные кросс-фильтры для табличных моделей в службах Analysis Services](https://docs.microsoft.com/sql/analysis-services/tabular-models/bi-directional-cross-filters-tabular-models-analysis-services).

В некоторых случаях может потребоваться создать дополнительные связи между таблицами в модели для реализации определенной бизнес-логики. В этом учебнике вам нужно создать три дополнительные связи между таблицами FactInternetSales и DimDate.  
  
#### <a name="to-add-new-relationships-between-tables"></a>Добавление новых связей между таблицами  
  
1.  В таблице **FactInternetSales** в конструкторе моделей нажмите и удерживайте столбец **OrderDate**, затем перетащите курсор в столбец **Date** таблицы **DimDate**.  

    Появится сплошная линия, указывающая на создание активной связи между столбцом **OrderDate** таблицы **Internet Sales** и столбцом**Date** таблицы **Date**. 
  
      ![aas-lesson4-new](../tutorials/media/aas-lesson4-new.png) 
  
    > [!NOTE]  
    > При создании связей кратность и направление фильтрации между основной таблицей и таблицей подстановки выбираются автоматически.  
  
2.  В таблице **FactInternetSales** нажмите и удерживайте столбец **DueDate** и перетащите курсор в столбец **Date** таблицы **DimDate**.  
  
    Появится пунктирная линия, обозначающая созданную неактивную связь между столбцом **DueDate** таблицы **FactInternetSales** и столбцом **Date** таблицы **DimDate**. Можно использовать несколько связей между таблицами, но одновременно может быть активна только одна из них. Неактивные связи можно сделать активными для выполнения специальных статистических вычислений в пользовательских выражений DAX.  
  
3.  Теперь создайте еще одну связь. В таблице **FactInternetSales** нажмите и удерживайте столбец **ShipDate** и перетащите курсор в столбец **Date** таблицы **DimDate**.  
    
     ![aas-lesson4-newinactive](../tutorials/media/aas-lesson4-newinactive.png)
  
## <a name="whats-next"></a>Что дальше?
[Занятие 5. Создание вычисляемых столбцов](../tutorials/aas-lesson-5-create-calculated-columns.md).
  
  
  
