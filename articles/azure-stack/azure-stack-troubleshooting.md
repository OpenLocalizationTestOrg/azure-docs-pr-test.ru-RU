---
title: "Устранение неполадок стека Microsoft Azure | Документы Microsoft"
description: "Azure стека устранения неполадок."
services: azure-stack
documentationcenter: 
author: heathl17
manager: byronr
editor: 
ms.assetid: a20bea32-3705-45e8-9168-f198cfac51af
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/10/2017
ms.author: helaw
ms.openlocfilehash: a7309693d8f7971e42768a13d12fa0a8bd81925a
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="microsoft-azure-stack-troubleshooting"></a><span data-ttu-id="2808a-103">Устранение неполадок стека Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="2808a-103">Microsoft Azure Stack troubleshooting</span></span>
<span data-ttu-id="2808a-104">Этот документ содержит общие сведения об устранении неполадок для Azure стека.</span><span class="sxs-lookup"><span data-stu-id="2808a-104">This document provides common troubleshooting information for Azure Stack.</span></span> 

<span data-ttu-id="2808a-105">Так как технические комплекта разработки Azure стека предлагается как среде оценки, не поддерживается официальный из службы поддержки Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="2808a-105">Because the Azure Stack Technical Development Kit is offered as an evaluation environment, there is no official support from Microsoft Customer Support Services.</span></span>  <span data-ttu-id="2808a-106">Если вы испытываете проблемы, не описанной, не забудьте проверить [форум MSDN стек Azure](https://social.msdn.microsoft.com/Forums/azure/home?forum=azurestack) для получения дополнительной помощи и сведения.</span><span class="sxs-lookup"><span data-stu-id="2808a-106">If you are experiencing an issue not documented, make sure to check the [Azure Stack MSDN Forum](https://social.msdn.microsoft.com/Forums/azure/home?forum=azurestack) for further assistance and information.</span></span>  

<span data-ttu-id="2808a-107">Рекомендации по устранению неполадок, описанные в этом разделе являются производными от нескольких источников и может или не может разрешить конкретной проблемы.</span><span class="sxs-lookup"><span data-stu-id="2808a-107">The recommendations for troubleshooting issues that are described in this section are derived from several sources and may or may not resolve your particular issue.</span></span> <span data-ttu-id="2808a-108">Примеры кода предоставляются как есть, и ожидаемые результаты не гарантируется.</span><span class="sxs-lookup"><span data-stu-id="2808a-108">Code examples are provided as is and expected results cannot be guaranteed.</span></span> <span data-ttu-id="2808a-109">В этом разделе регулируется частые изменения и обновления как реализованы улучшения продукта.</span><span class="sxs-lookup"><span data-stu-id="2808a-109">This section is subject to frequent edits and updates as improvements to the product are implemented.</span></span>

## <a name="deployment"></a><span data-ttu-id="2808a-110">Развертывание</span><span class="sxs-lookup"><span data-stu-id="2808a-110">Deployment</span></span>
### <a name="deployment-failure"></a><span data-ttu-id="2808a-111">Сбой развертывания</span><span class="sxs-lookup"><span data-stu-id="2808a-111">Deployment failure</span></span>
<span data-ttu-id="2808a-112">При возникновении сбоя во время установки, можно использовать параметр повторного запуска скрипта развертывания для перезапустить развертывание из ошибочного шага.</span><span class="sxs-lookup"><span data-stu-id="2808a-112">If you experience a failure during installation, you can use use the rerun option of the deployment script to restart the deployment from the failed step.</span></span>  


### <a name="at-the-end-of-the-deployment-the-powershell-session-is-still-open-and-doesnt-show-any-output"></a><span data-ttu-id="2808a-113">В конце развертывания сеанс PowerShell все еще открыто и не отображается никаких выходных данных</span><span class="sxs-lookup"><span data-stu-id="2808a-113">At the end of the deployment, the PowerShell session is still open and doesn’t show any output</span></span>
<span data-ttu-id="2808a-114">Это поведение, скорее всего, является результат по умолчанию командное окно PowerShell Если был выбран.</span><span class="sxs-lookup"><span data-stu-id="2808a-114">This behavior is probably just the result of the default behavior of a PowerShell command window, when it has been selected.</span></span> <span data-ttu-id="2808a-115">Фактически успешного развертывания комплект средств для разработки, но скрипт был приостановлен, при выборе окна.</span><span class="sxs-lookup"><span data-stu-id="2808a-115">The development kit deployment has actually succeeded but the script was paused when selecting the window.</span></span> <span data-ttu-id="2808a-116">Чтобы проверить это условие выполняется путем поиска слова «select» в строке заголовка окна команд.</span><span class="sxs-lookup"><span data-stu-id="2808a-116">You can verify this is the case by looking for the word "select" in the titlebar of the command window.</span></span>  <span data-ttu-id="2808a-117">Нажмите клавишу ESC, чтобы отменить его выбор, и после него должно быть показано сообщение о завершении.</span><span class="sxs-lookup"><span data-stu-id="2808a-117">Press the ESC key to unselect it, and the completion message should be shown after it.</span></span>

## <a name="templates"></a><span data-ttu-id="2808a-118">Шаблоны</span><span class="sxs-lookup"><span data-stu-id="2808a-118">Templates</span></span>
### <a name="azure-template-wont-deploy-to-azure-stack"></a><span data-ttu-id="2808a-119">Шаблон Azure не будут развертываться на стек Azure</span><span class="sxs-lookup"><span data-stu-id="2808a-119">Azure template won't deploy to Azure Stack</span></span>
<span data-ttu-id="2808a-120">Убедитесь, что:</span><span class="sxs-lookup"><span data-stu-id="2808a-120">Make sure that:</span></span>

* <span data-ttu-id="2808a-121">Службы Microsoft Azure уже доступен или в режиме просмотра стека Azure необходимо использовать шаблон.</span><span class="sxs-lookup"><span data-stu-id="2808a-121">The template must be using a Microsoft Azure service that is already available or in preview in Azure Stack.</span></span>
* <span data-ttu-id="2808a-122">API, используемые для определенного ресурса поддерживаются локальным экземпляром Azure стека, и вы используете допустимое расположение («local» в пакете средств разработки Azure стека, vs «Восток США» или «Южной Индии» в Azure).</span><span class="sxs-lookup"><span data-stu-id="2808a-122">The APIs used for a specific resource are supported by the local Azure Stack instance, and that you are targeting a valid location (“local” in Azure Stack development kit, vs the “East US” or “South India” in Azure).</span></span>
* <span data-ttu-id="2808a-123">Просмотреть [в этой статье](https://github.com/Azure/AzureStack-QuickStart-Templates/blob/master/README.md) о командлетах AzureRmResourceGroupDeployment теста, который перехватывать небольшие различия в синтаксисе диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="2808a-123">You review [this article](https://github.com/Azure/AzureStack-QuickStart-Templates/blob/master/README.md) about the Test-AzureRmResourceGroupDeployment cmdlets, which catch small differences in Azure Resource Manager syntax.</span></span>

<span data-ttu-id="2808a-124">Также можно использовать шаблоны Azure стека, уже содержится в [репозитории GitHub](http://aka.ms/AzureStackGitHub/) помогут вам приступить к работе.</span><span class="sxs-lookup"><span data-stu-id="2808a-124">You can also use the Azure Stack templates already provided in the [GitHub repository](http://aka.ms/AzureStackGitHub/) to help you get started.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="2808a-125">Виртуальные машины</span><span class="sxs-lookup"><span data-stu-id="2808a-125">Virtual machines</span></span>
### <a name="default-image-and-gallery-item"></a><span data-ttu-id="2808a-126">По умолчанию элемент изображения и коллекции</span><span class="sxs-lookup"><span data-stu-id="2808a-126">Default image and gallery item</span></span>
<span data-ttu-id="2808a-127">Перед развертыванием виртуальных машин в Azure стека, необходимо сначала добавить Windows Server изображения и коллекции элементов.</span><span class="sxs-lookup"><span data-stu-id="2808a-127">You must first add a Windows Server image and gallery item before deploying VMs in Azure Stack.</span></span>

### <a name="after-restarting-my-azure-stack-host-some-vms-may-not-automatically-start"></a><span data-ttu-id="2808a-128">После перезагрузки узла Azure стека, некоторые виртуальные машины могут не запускаться автоматически.</span><span class="sxs-lookup"><span data-stu-id="2808a-128">After restarting my Azure Stack host, some VMs may not automatically start.</span></span>
<span data-ttu-id="2808a-129">После перезагрузки узла, можно заметить, что службы Azure стека не сразу становятся доступными.</span><span class="sxs-lookup"><span data-stu-id="2808a-129">After rebooting your host, you may notice Azure Stack services are not immediately available.</span></span>  <span data-ttu-id="2808a-130">Это обусловлено стека Azure [инфраструктуры виртуальных машин](azure-stack-architecture.md#virtual-machine-roles) и RPs принимают немного позже для проверки согласованности, но в конечном итоге будет запускаться автоматически.</span><span class="sxs-lookup"><span data-stu-id="2808a-130">This is because Azure Stack [infrastructure VMs](azure-stack-architecture.md#virtual-machine-roles) and RPs take a little bit to check consistency, but will eventually start automatically.</span></span>

<span data-ttu-id="2808a-131">Также можно заметить этого клиента, виртуальные машины не запускаются автоматически после перезагрузки узла комплект средств для разработки Azure стека.</span><span class="sxs-lookup"><span data-stu-id="2808a-131">You may also notice that tenant VMs don't automatically start after a reboot of the Azure Stack development kit host.</span></span>  <span data-ttu-id="2808a-132">Это известная проблема и требуется несколько действий вручную, чтобы перевести в оперативный режим:</span><span class="sxs-lookup"><span data-stu-id="2808a-132">This is a known issue, and just requires a few manual steps to bring them online:</span></span>

1.  <span data-ttu-id="2808a-133">На узле комплект средств для разработки Azure стека запуска **Диспетчер отказоустойчивости кластеров** из меню "Пуск".</span><span class="sxs-lookup"><span data-stu-id="2808a-133">On the Azure Stack development kit host, start **Failover Cluster Manager** from the Start Menu.</span></span>
2.  <span data-ttu-id="2808a-134">Выберите кластер **S Cluster.azurestack.local**.</span><span class="sxs-lookup"><span data-stu-id="2808a-134">Select the cluster **S-Cluster.azurestack.local**.</span></span>
3.  <span data-ttu-id="2808a-135">Выберите **Роли**.</span><span class="sxs-lookup"><span data-stu-id="2808a-135">Select **Roles**.</span></span>
4.  <span data-ttu-id="2808a-136">Виртуальные машины клиента будет отображаться в *Сохранить* состояния.</span><span class="sxs-lookup"><span data-stu-id="2808a-136">Tenant VMs will appear in a *saved* state.</span></span>  <span data-ttu-id="2808a-137">После запуска всех виртуальных машин в инфраструктуре, щелкните правой кнопкой мыши виртуальные машины клиента и выберите **запустить** возобновить виртуальную Машину.</span><span class="sxs-lookup"><span data-stu-id="2808a-137">Once all Infrastructure VMs are running, right-click the tenant VMs and select **Start** to resume the VM.</span></span>

### <a name="i-have-deleted-some-virtual-machines-but-still-see-the-vhd-files-on-disk-is-this-behavior-expected"></a><span data-ttu-id="2808a-138">Я удалил некоторые виртуальные машины, но по-прежнему отображается VHD-файлы на диске.</span><span class="sxs-lookup"><span data-stu-id="2808a-138">I have deleted some virtual machines, but still see the VHD files on disk.</span></span> <span data-ttu-id="2808a-139">Это поведение ожидается?</span><span class="sxs-lookup"><span data-stu-id="2808a-139">Is this behavior expected?</span></span>
<span data-ttu-id="2808a-140">Да, это поведение, ожидаемое.</span><span class="sxs-lookup"><span data-stu-id="2808a-140">Yes, this is behavior expected.</span></span> <span data-ttu-id="2808a-141">Он был разработан таким образом, так как:</span><span class="sxs-lookup"><span data-stu-id="2808a-141">It was designed this way because:</span></span>

* <span data-ttu-id="2808a-142">При удалении виртуальной Машины, виртуальные жесткие диски не удаляются.</span><span class="sxs-lookup"><span data-stu-id="2808a-142">When you delete a VM, VHDs are not deleted.</span></span> <span data-ttu-id="2808a-143">Диски представляют собой отдельные ресурсы в группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="2808a-143">Disks are separate resources in the resource group.</span></span>
* <span data-ttu-id="2808a-144">При удалении учетной записи хранилища возвращает удаление отображается непосредственно через диспетчер ресурсов Azure (портал, PowerShell), а диски, которые он может содержать все еще хранятся в хранилище, пока не будет запущен сборщик мусора.</span><span class="sxs-lookup"><span data-stu-id="2808a-144">When a storage account gets deleted, the deletion is visible immediately through Azure Resource Manager (portal, PowerShell) but the disks it may contain are still kept in storage until garbage collection runs.</span></span>

<span data-ttu-id="2808a-145">При появлении виртуальные жесткие диски «потерянных объектов», важно знать, если они являются частью папки для учетной записи хранения, который был удален.</span><span class="sxs-lookup"><span data-stu-id="2808a-145">If you see "orphan" VHDs, it is important to know if they are part of the folder for a storage account that was deleted.</span></span> <span data-ttu-id="2808a-146">Если учетная запись хранения не был удален, обычный, что они по-прежнему существуют.</span><span class="sxs-lookup"><span data-stu-id="2808a-146">If the storage account was not deleted, it's normal they are still there.</span></span>

<span data-ttu-id="2808a-147">Вы можете прочитать больше о настройке хранения по требованию и пороговое значение в освобождение [управление учетными записями хранения](azure-stack-manage-storage-accounts.md).</span><span class="sxs-lookup"><span data-stu-id="2808a-147">You can read more about configuring the retention threshold and on-demand reclamation in [manage storage accounts](azure-stack-manage-storage-accounts.md).</span></span>

## <a name="storage"></a><span data-ttu-id="2808a-148">Хранилище</span><span class="sxs-lookup"><span data-stu-id="2808a-148">Storage</span></span>
### <a name="storage-reclamation"></a><span data-ttu-id="2808a-149">Освобождение хранилища</span><span class="sxs-lookup"><span data-stu-id="2808a-149">Storage reclamation</span></span>
<span data-ttu-id="2808a-150">Он может занять до Четырнадцать часов утилизируемого емкости отображались на портале.</span><span class="sxs-lookup"><span data-stu-id="2808a-150">It may take up to fourteen hours for reclaimed capacity to show up in the portal.</span></span> <span data-ttu-id="2808a-151">Освобождение пространства зависит от различных факторов, включая процент использования внутренних контейнера файлов в хранилище BLOB-объект блока.</span><span class="sxs-lookup"><span data-stu-id="2808a-151">Space reclamation depends on various factors including usage percentage of internal container files in block blob store.</span></span> <span data-ttu-id="2808a-152">Таким образом в зависимости от того, какой объем данных удаляется, нет никакой гарантии на объем пространства, могли быть освобождены при запуске сборщика мусора.</span><span class="sxs-lookup"><span data-stu-id="2808a-152">Therefore, depending on how much data is deleted, there is no guarantee on the amount of space that could be reclaimed when garbage collector runs.</span></span>

## <a name="powershell"></a><span data-ttu-id="2808a-153">PowerShell</span><span class="sxs-lookup"><span data-stu-id="2808a-153">PowerShell</span></span>
### <a name="resource-providers-not-registered"></a><span data-ttu-id="2808a-154">Поставщики ресурсов не зарегистрирована</span><span class="sxs-lookup"><span data-stu-id="2808a-154">Resource Providers not registered</span></span>
<span data-ttu-id="2808a-155">При подключении к подпискам клиента с помощью PowerShell, вы заметите, что поставщики ресурсов не регистрируются автоматически.</span><span class="sxs-lookup"><span data-stu-id="2808a-155">When connecting to tenant subscriptions with PowerShell, you will notice that the resource providers are not automatically registered.</span></span> <span data-ttu-id="2808a-156">Используйте [с помощью модуля Connect](https://github.com/Azure/AzureStack-Tools/tree/master/Connect), или выполните следующую команду из PowerShell (после вы [Установка и подключение](azure-stack-connect-powershell.md) как клиента):</span><span class="sxs-lookup"><span data-stu-id="2808a-156">Use the [Connect module](https://github.com/Azure/AzureStack-Tools/tree/master/Connect), or run the following command from PowerShell (after you [install and connect](azure-stack-connect-powershell.md) as a tenant):</span></span> 
  
       Get-AzureRMResourceProvider | Register-AzureRmResourceProvider

## <a name="cli"></a><span data-ttu-id="2808a-157">Интерфейс командной строки</span><span class="sxs-lookup"><span data-stu-id="2808a-157">CLI</span></span>

* <span data-ttu-id="2808a-158">Интерактивный режим CLI т. е.</span><span class="sxs-lookup"><span data-stu-id="2808a-158">The CLI interactive mode i.e</span></span> <span data-ttu-id="2808a-159">`az interactive` команда еще не поддерживается в Azure стека.</span><span class="sxs-lookup"><span data-stu-id="2808a-159">the `az interactive` command is not yet supported in Azure Stack.</span></span>
* <span data-ttu-id="2808a-160">Чтобы получить список образов виртуальных машин, доступных в Azure стека, используйте `az vm images list --all` вместо `az vm image list` команды.</span><span class="sxs-lookup"><span data-stu-id="2808a-160">To get the list of virtual machine images available in Azure Stack, use the `az vm images list --all` command instead of the `az vm image list` command.</span></span> <span data-ttu-id="2808a-161">Указание `--all` option гарантирует, что ответ возвращает только изображения, которые доступны в среде Azure стека.</span><span class="sxs-lookup"><span data-stu-id="2808a-161">Specifying the `--all` option makes sure that response returns only the images that are available in your Azure Stack environment.</span></span> 
* <span data-ttu-id="2808a-162">Псевдонимы образ виртуальной машины, доступные в Azure может оказаться неприменимым для Azure стека.</span><span class="sxs-lookup"><span data-stu-id="2808a-162">Virtual machine image aliases that are available in Azure may not be applicable to Azure Stack.</span></span> <span data-ttu-id="2808a-163">При использовании образов виртуальных машин, необходимо использовать параметр всей URN (канонические: UbuntuServer:14.04.3-LTS:1.0.0) вместо изображения псевдонима.</span><span class="sxs-lookup"><span data-stu-id="2808a-163">When using virtual machine images, you must use the entire URN parameter (Canonical:UbuntuServer:14.04.3-LTS:1.0.0) instead of the image alias.</span></span> <span data-ttu-id="2808a-164">И это URNmust соответствует спецификации изображения, производный от `az vm images list` команды.</span><span class="sxs-lookup"><span data-stu-id="2808a-164">And this URNmust match the image specifications as derived from the `az vm images list` command.</span></span>
* <span data-ttu-id="2808a-165">По умолчанию CLI 2.0 использует «Standard_DS1_v2» в качестве размер образа виртуальной машины по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="2808a-165">By default, CLI 2.0 uses “Standard_DS1_v2” as the default virtual machine image size.</span></span> <span data-ttu-id="2808a-166">Тем не менее, этот размер еще не доступны в стек Azure, таким образом, необходимо указать `--size` параметр явным образом при создании виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="2808a-166">However, this size is not yet available in Azure Stack, so, you need to specify the `--size` parameter explicitly when creating a virtual machine.</span></span> <span data-ttu-id="2808a-167">Вы можете получить список размеров виртуальных машин, доступных в стек Azure с помощью `az vm list-sizes --location <locationName>` команды.</span><span class="sxs-lookup"><span data-stu-id="2808a-167">You can get the list of virtual machine sizes that are available in Azure Stack by using the `az vm list-sizes --location <locationName>` command.</span></span>


## <a name="windows-azure-pack-connector"></a><span data-ttu-id="2808a-168">Соединитель Windows Azure Pack</span><span class="sxs-lookup"><span data-stu-id="2808a-168">Windows Azure Pack Connector</span></span>
* <span data-ttu-id="2808a-169">Если изменить пароль учетной записи, azurestackadmin после развертывания пакета средств разработки Azure стека, больше не можно настроить режим несколько компонентов в облаке.</span><span class="sxs-lookup"><span data-stu-id="2808a-169">If you change the password of the azurestackadmin account after you deploy Azure Stack development kit, you can no longer configure multi-cloud mode.</span></span> <span data-ttu-id="2808a-170">Таким образом будет невозможно подключиться к целевой среде Windows Azure Pack.</span><span class="sxs-lookup"><span data-stu-id="2808a-170">Therefore, it won't be possible to connect to the target Windows Azure Pack environment.</span></span>
* <span data-ttu-id="2808a-171">После настройки режима несколько компонентов в облаке:</span><span class="sxs-lookup"><span data-stu-id="2808a-171">After you set up multi-cloud mode:</span></span>
    * <span data-ttu-id="2808a-172">Пользователь видит панели мониторинга только после их Сброс параметров портала.</span><span class="sxs-lookup"><span data-stu-id="2808a-172">A user can see the dashboard only after they reset the portal settings.</span></span> <span data-ttu-id="2808a-173">(На пользовательском портале щелкните значок "Параметры портала" (значок шестеренки в правом верхнем углу).</span><span class="sxs-lookup"><span data-stu-id="2808a-173">(In the user portal, click the portal settings icon (gear icon in the top-right corner).</span></span> <span data-ttu-id="2808a-174">В разделе **восстановить параметры по умолчанию**, нажмите кнопку **применить**.)</span><span class="sxs-lookup"><span data-stu-id="2808a-174">Under **Restore default settings**, click **Apply**.)</span></span>
    * <span data-ttu-id="2808a-175">Заголовки панели мониторинга могут не отображаться.</span><span class="sxs-lookup"><span data-stu-id="2808a-175">The dashboard titles may not appear.</span></span> <span data-ttu-id="2808a-176">При возникновении этой проблемы, необходимо вручную добавить их снова.</span><span class="sxs-lookup"><span data-stu-id="2808a-176">If this issue occurs, you must manually add them back.</span></span>
    * <span data-ttu-id="2808a-177">Некоторые разделы могут показывать некорректно при первом добавлении их на панель мониторинга.</span><span class="sxs-lookup"><span data-stu-id="2808a-177">Some tiles may not show correctly when you first add them to the dashboard.</span></span> <span data-ttu-id="2808a-178">Чтобы устранить эту проблему, обновите браузер.</span><span class="sxs-lookup"><span data-stu-id="2808a-178">To fix this issue, refresh the browser.</span></span>



