---
title: "Делегирование предложений в Azure Stack | Документация Майкрософт"
description: "Узнайте, как привлечь других людей к созданию предложений и регистрации пользователей."
services: azure-stack
documentationcenter: 
author: AlfredoPizzirani
manager: byronr
editor: 
ms.assetid: 157f0207-bddc-42e5-8351-197ec23f9d46
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/25/2017
ms.author: alfredop
ms.openlocfilehash: 1a1f2789076b610ee557bde5981a331c55cc1c95
ms.sourcegitcommit: e5355615d11d69fc8d3101ca97067b3ebb3a45ef
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="delegate-offers-in-azure-stack"></a>Делегирование предложений в Azure Stack

*Область применения: интегрированные системы Azure Stack и комплект разработки Azure Stack*

Как оператору Azure Stack, вам часто приходится привлекать других людей к созданию предложений и регистрации пользователей. Например, если вы являетесь поставщиком услуг, посредники должны регистрировать клиентов и управлять ими от вашего имени. Или, например, ваше подразделение является частью центральной ИТ-группы предприятия, и вам нужно, чтобы подразделения регистрировали пользователей без вашего вмешательства.

Выполнить эти задачи поможет делегирование. Оно обеспечивает охват и администрирование большего числа пользователей, чем при непосредственной регистрации. На следующем рисунке показан один уровень делегирования, хотя Azure Stack поддерживает несколько уровней. Делегированные поставщики могут, в свою очередь, делегировать обязанности другим поставщикам (до пяти уровней).

![Уровни делегирования](media/azure-stack-delegated-provider/image1.png)

Операторы Azure Stack могут делегировать создание предложений и пользователей другим пользователям с помощью функции делегирования.

## <a name="roles-and-steps-in-delegation"></a>Роли и действия в делегировании
В рамках делегирования задействовано три роли:

* *Оператор Azure Stack* управляет инфраструктурой Azure Stack, создает шаблон предложения и делегирует другим пользователям возможность предлагать его своим пользователям.

* Делегированные операторы Azure Stack называются *делегированными поставщиками*. Они могут относиться к другим организациям (например, к другим пользователям Azure Active Directory).

* *Пользователи* регистрируются для получения предложений и используют их для управления своими рабочими нагрузками, создания виртуальных машин, хранения данных и т. д.

Как показано на представленном ниже изображении, настройка делегирования состоит из двух шагов.

1. *Идентификация делегированных поставщиков.* Идентификация реализуется с помощью подписки поставщиков на предложение на основе плана, который содержит только службу подписки. Пользователи, подписавшиеся на это предложение, получают некоторые возможности оператора Azure Stack, включая возможность расширения предложений и регистрации пользователей для их использования.

2. *Делегирование предложения делегированному поставщику.* Это шаблон предложения для делегированного поставщика. Теперь делегированный поставщик может принимать предложение. Выберите имя предложения (но не изменяйте службы и квоты) и предлагайте его клиентам.

![Создание учетной записи делегированного поставщика и предоставление ему возможности регистрировать пользователей](media/azure-stack-delegated-provider/image2.png)

Чтобы выступать в роли делегированных поставщиков, пользователям необходимо установить связь с основным поставщиком. Иными словами, им необходимо создать подписку. В этом сценарии эта подписка идентифицирует делегированного поставщика как имеющего право представлять предложения от имени основного поставщика.

После установления этой связи оператор Azure Stack может делегировать предложение делегированному поставщику. Делегированный поставщик теперь может принять предложение, переименовать его (но не изменять его содержание) и предложить своим клиентам.

В следующих разделах описывается, как создать делегированного поставщика, делегировать предложение и проверить, могут ли пользователи зарегистрироваться для его получения.

## <a name="set-up-roles"></a>Настройка ролей

Чтобы понять, что может делать делегированный поставщик, необходимо добавить дополнительные учетные записи Azure AD к учетной записи оператора Azure Stack. Если их нет, создайте две учетные записи. Они могут принадлежать любому пользователю Azure AD. Мы будем называть их делегированным поставщиком и пользователем.

| **Роль** | **Права в организации** |
| --- | --- |
| Делегированный поставщик |Пользователь |
| Пользователь |Пользователь |

## <a name="identify-the-delegated-providers"></a>Идентификация делегированных поставщиков
1. Войдите с помощью учетных данных оператора Azure Stack.

2. Создайте предложение, которое позволяет пользователям стать делегированными поставщиками.
   
   а.  [Создайте план](azure-stack-create-plan.md).
       Этот план должен содержать только службу подписки. В этой статье используется план с именем **PlanForDelegation**.
   
   b.  [Создайте предложение](azure-stack-create-offer.md) на основе этого плана. В этой статье используется предложение с именем **OfferToDP**.
   
   c.  Создав предложение, добавьте делегированного поставщика в качестве подписчика этого предложения. Для этого выберите **Подписки** > **Добавить** > **Новая подписка клиента**.
   
   ![Добавление делегированного поставщика в качестве подписчика](media/azure-stack-delegated-provider/image3.png)

> [!NOTE]
> Как и для всех предложений Azure Stack, у вас есть два варианта действий. Можно сделать предложение общедоступным и разрешить пользователям регистрироваться в нем или оставить его частным и позволить оператору Azure Stack управлять регистрациями. Делегированные поставщики, как правило, представляют собой небольшую группу. Вам нужно будет контролировать допуск в эту группу. Поэтому в большинстве случаев целесообразнее вариант частного доступа.
> 
> 

## <a name="azure-stack-operator-creates-the-delegated-offer"></a>Создание делегированного предложения оператором Azure Stack

Итак, создан делегированный поставщик. Следующим шагом является создание плана и предложения, которое необходимо делегировать и которое будут использовать клиенты. Рекомендуем определить это предложение так, как его должны видеть клиенты — делегированный поставщик не сможет изменить включаемые планы и квоты.

1. Как оператор Azure Stack [создайте план](azure-stack-create-plan.md) и [предложение](azure-stack-create-offer.md) на его основе. В этой статье используется предложение с именем **DelegatedOffer**.
   
   > [!NOTE]
   > Это предложение не обязательно должно быть общедоступным. При желании вы можете сделать его общедоступным. Но в большинстве случаев вам понадобится ограничить к нему доступ, то есть разрешить его только делегированным поставщикам. После делегирования частного предложения, как описано в представленных ниже инструкциях, делегированный поставщик получит к нему доступ.
   > 
   > 
1. Делегируйте предложение. Выберите предложение **DelegatedOffer**. На панели **Параметры** выберите **Делегированные поставщики** > **Добавить**.

2. Выберите подписку делегированного поставщика из раскрывающегося списка и нажмите кнопку **Делегировать**.

> ![Добавление делегированного поставщика](media/azure-stack-delegated-provider/image4.png)
> 
> 

## <a name="delegated-provider-customizes-the-offer"></a>Настройка предложения делегированным поставщиком

Войдите на портал пользователя с помощью учетных данных делегированного поставщика. Затем создайте новое предложение, используя делегированное в качестве шаблона.

1. Выберите **Создать** > **Предложения и планы клиента** > **Предложение**.

    ![Создание нового предложения](media/azure-stack-delegated-provider/image5.png)


1. Присвойте имя предложению. Здесь используется имя **ResellerOffer**. Выберите делегированное предложение для использования в качестве основы и нажмите кнопку **Создать**.
   
   ![Присвоение имени](media/azure-stack-delegated-provider/image6.png)

    >[!NOTE] 
    > Обратите внимание, что по сравнению с созданием предложения в качестве оператора Azure Stack тут есть различие. Делегированный поставщик не создает предложение на основе базовых и дополнительных планов. Он может только выбирать делегированные ему предложения без возможности вносить изменения.

1. Чтобы сделать предложение общедоступным, выберите **Обзор** и нажмите **Предложения**. Выберите предложение и нажмите **Изменить состояние**.

2. Делегированный поставщик предоставляет эти предложения через свой собственный URL-адрес портала. Они видимы только на делегированном портале. Чтобы найти и изменить этот URL-адрес:
   
    а.  Выберите **Обзор** > **Другие службы** >  **Подписки**. Выберите подписку делегированного поставщика. В нашем случае это подписка **DPSubscription** > **Свойства**.
   
    b.  Скопируйте URL-адрес портала в отдельное расположение, например в Блокнот.
   
    ![Выбор подписки делегированного поставщика](media/azure-stack-delegated-provider/dpportaluri.png)  
   
   Вы создали делегированное предложение от имени делегированного поставщика. Выйдите из системы как делегированный поставщик. Закройте окно браузера.

## <a name="sign-up-for-the-offer"></a>Регистрация для получения предложения
1. В новом окне браузера перейдите по URL-адресу делегированного портала, сохраненному на предыдущем шаге. Войдите на портал в качестве пользователя. 
   
   >[!NOTE]
   > Используйте на этом шаге делегированный портал. Иначе делегированное предложение не отобразится.

2. На панели мониторинга выберите **Получить подписку**. Вы увидите, что для пользователя отображаются только делегированные предложения, созданные делегированным поставщиком:

> ![Просмотр и выбор предложений](media/azure-stack-delegated-provider/image8.png)
> 
> 

Делегирование предложения завершено. Теперь пользователь может зарегистрироваться на это предложение, получив подписку на него.

## <a name="multiple-tier-delegation"></a>Многоуровневая делегация

Многоуровневый подход позволяет поставщику делегировать предложение другим сущностям. Такое делегирование позволяет создавать комплексные каналы торговых посредников, в которых поставщик, управляющий Azure Stack, делегирует предложение распространителю. Распространитель, в свою очередь, делегирует его посреднику. Azure Stack поддерживает до пяти уровней делегирования.

Для создания нескольких уровней делегирования предложения делегированные поставщики в свою очередь делегируют предложение следующему поставщику. Процесс одинаков как для делегированного поставщика, так и для оператора Azure Stack (дополнительные сведения см. в разделе [Создание делегированного предложения оператором Azure Stack](#cloud-operator-creates-the-delegated-offer)).

## <a name="next-steps"></a>Дальнейшие действия
[Создание тестовой виртуальной машины в Azure Stack](azure-stack-provision-vm.md)

