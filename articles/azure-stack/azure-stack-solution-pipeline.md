---
title: "Развернуть приложение в Azure и Azure стек | Документы Microsoft"
description: "Дополнительные сведения о развертывание приложений для Azure и Azure стека с конвейером гибридного CI или компакт-диска."
services: azure-stack
documentationcenter: 
author: HeathL17
manager: byronr
editor: 
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: helaw
ms.custom: mvc
ms.openlocfilehash: 019d743b0b3104e16a6690f438e7841fa63f09d0
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="deploy-apps-to-azure-and-azure-stack"></a>Развертывание приложений для Azure и Azure стека
Гибридной [непрерывной интеграции](https://www.visualstudio.com/learn/what-is-continuous-integration/)/[непрерывной поставки](https://www.visualstudio.com/learn/what-is-continuous-delivery/)конвейера (CI/CD) дает возможность создания, тестирования и развертывания приложения с несколькими облаками.  В этом учебнике сборки примере среды, чтобы узнать, как конвейер CI/CD гибридного может помочь:
 
> [!div class="checklist"]
> * Запуск новой сборки, исходя из кода фиксации в репозиторий, Visual Studio Team Services (VSTS).
> * Развертывание в Azure автоматически созданный код для пользовательского приемочного тестирования.
> * После прохождения проверки кода автоматически разверните Azure стека. 


## <a name="prerequisites"></a>Предварительные требования
Несколько компоненты необходимы для построения конвейера гибридного CI/CD и может занять некоторое время для подготовки.  Если у вас уже есть некоторые из этих компонентов, убедитесь, что они отвечают требованиям перед началом.

В этом разделе также предполагается, что имеется знание Azure и Azure стека. Если вы хотите узнать больше, прежде чем продолжить, убедитесь, что начните с этих разделов:

- [Введение в Azure](https://docs.microsoft.com/azure/fundamentals-introduction-to-azure)
- [Основные понятия стек Azure](azure-stack-key-features.md)

### <a name="azure"></a>Таблицы Azure
 - Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.
 - Создание [веб-приложения](../app-service-web/app-service-web-how-to-create-a-web-app-in-an-ase.md)и настройте его для [FTP-публикацию](../app-service-web/app-service-deploy-ftp.md).  Запишите новый URL-адрес приложения, как будет использоваться позднее.


### <a name="azure-stack"></a>Azure Stack
 - [Развертывание Azure стека](azure-stack-run-powershell-script.md).  Установка обычно занимает несколько часов, чтобы завершить, поэтому планирование соответствующим образом.
 - Развертывание [службы приложений](azure-stack-app-service-deploy.md) служб PaaS стек Azure.
 - Создать веб-приложения и настроить его для [FTP-публикацию](azure-stack-app-service-enable-ftp.md).  Запишите новый URL-адрес приложения, как будет использоваться позднее.  

### <a name="developer-tools"></a>Инструменты для разработчиков
 - Создание [VSTS рабочей](https://www.visualstudio.com/docs/setup-admin/team-services/sign-up-for-visual-studio-team-services).  Процесс регистрации создает проект с именем «MyFirstProject.»  
 - [Установка Visual Studio 2017 г](https://docs.microsoft.com/visualstudio/install/install-visual-studio) и [входа в VSTS](https://www.visualstudio.com/docs/setup-admin/team-services/connect-to-visual-studio-team-services#connect-and-share-code-from-visual-studio)
 - Подключитесь к проекту и [клонировать локально](https://www.visualstudio.com/docs/git/gitquickstart).
 - Создание [пул агентов](https://www.visualstudio.com/docs/build/concepts/agents/pools-queues#creating-agent-pools-and-queues) в VSTS.
 - Установка Visual Studio и развертывание [агент сборки VSTS](https://www.visualstudio.com/docs/build/actions/agents/v2-windows) к виртуальной машине Azure стек. 
 

## <a name="create-app--push-to-vsts"></a>Создание приложения и отправьте данные в VSTS

### <a name="create-application"></a>Создание приложения
В этом разделе также создать простое приложение ASP.NET и передать его в VSTS.  Эти шаги представляют обычного разработчика рабочего процесса, а также может быть адаптирована для разработчиков средств и языков. 

1.  Откройте Visual Studio.
2.  Из Team Explorer пространства и **решения... ** область, щелкните **New**.
3.  Выберите **Visual C#** > **Web** > **веб-приложения ASP.NET (.NET Framework)**.
4.  Укажите имя для приложения и нажмите кнопку **ОК**.
5.  На следующем экране, оставьте значения по умолчанию (Web forms), а затем нажмите **ОК**.

### <a name="commit-and-push-changes-to-vsts"></a>Зафиксируйте и отправьте изменения в VSTS
1.  С помощью Team Explorer в Visual Studio, щелкните раскрывающийся список и нажмите кнопку **изменения**.
2.  Введите сообщение фиксации и выберите **фиксации на всех**. Вам может быть предложено сохранить файл решения, нажмите "Да", чтобы сохранить все.
3.  После фиксации, Visual Studio предлагает синхронизировать изменения, внесенные в проект. Выберите **синхронизации**.

    ![на изображении показан экран фиксации после фиксации](./media/azure-stack-solution-pipeline/image1.png)

4.  На вкладке «синхронизация» в разделе *исходящие*, появится новый фиксации.  Выберите **Push** для синхронизации изменений в VSTS.

    ![шаги синхронизации отображение изображений](./media/azure-stack-solution-pipeline/image2.png)

### <a name="review-code-in-vsts"></a>Проверьте код в VSTS
После фиксации изменений и помещено в VSTS, проверьте код на портале VSTS.  Выберите **кода**, а затем **файлы** в раскрывающемся меню.  Вы увидите решение, которое вы создали.

## <a name="create-build-definition"></a>Создание определения сборки
Процесс построения определяет, построения и упаковки для развертывания на каждой фиксации изменений кода приложения. В нашем примере мы используем включенный шаблон для настройки процесса построения для приложения ASP.NET, хотя эта конфигурация может быть адаптирован в зависимости от приложения.

1.  Войдите в рабочую область VSTS веб-браузере.
2.  В баннере, выберите **построения и выпуска** и затем **строит**.
3.  Нажмите кнопку **+ новое определение**.
4.  В списке шаблонов выберите **ASP.NET (Предварительная версия)** и выберите **применить**.
5.  Изменить *Аргументы MSBuild* в *построить решение* шаг для:

    `/p:DeployOnBuild=True /p:WebPublishMethod=FileSystem /p:DeployDefaultTarget=WebPublish /p:publishUrl="$(build.artifactstagingdirectory)\\"`

6.  Выберите **параметры** и выберите очередь агента для агента построения, развертывания для виртуальной машины в Azure стека. 
7.  Выберите **триггеры** и включите **непрерывной интеграции**.
7.  Нажмите кнопку **сохранить & очередь** , а затем выберите **Сохранить** из раскрывающегося списка. 

## <a name="create-release-definition"></a>Создание определения выпуска
Процесс выпуска определяет развертывание сборок из предыдущего шага в среде.  В этом учебнике мы опубликовать нашего приложения ASP.NET с использованием FTP веб-приложение Azure. Чтобы настроить выпуска в Azure, выполните следующие действия:

1.  В баннере VSTS выберите **построения и выпуска** и затем **выпуски**.
2.  Нажмите зеленую **+ новое определение**.
3.  Выберите **пустой** и нажмите кнопку **Далее**.
4.  Установите флажок для *непрерывного развертывания*, а затем нажмите кнопку **создать**.

Создания определения пустой выпуска и он привязан к построению, мы добавляем действия для среды Azure:

1.  Нажмите зеленую ** + ** для добавления задач.
2.  Выберите **все**, а затем в списке, добавьте **отправить FTP** и выберите **закрыть**.
3.  Выберите **отправить FTP** задачу необходимо просто добавить и настроить следующие параметры:
    
    | Параметр | Значение |
    | ----- | ----- |
    |Метод проверки подлинности| Введите учетные данные|
    |URL-адрес сервера | Получить URL-адрес FTP приложения с портала Azure |
    |Имя пользователя | Имя пользователя, которые были настроены при создании учетных данных FTP для веб-приложения |
    |Пароль | Пароль, созданный при установке учетные данные FTP для веб-приложения|
    |Исходный каталог | $(System.DefaultWorkingDirectory)\**\ |
    |Удаленный каталог | /Site/wwwroot / |
    |Сохранить пути к файлам | Включен (флажок установлен)|

4.  Нажмите кнопку **Сохранить**

Наконец настроить определение выпуска для использования агента пул, содержащий агент развертывания, выполнив следующие действия:
1.  Выберите определение выпуска и нажмите кнопку **изменить**.
2.  Выберите **выполняются на агенте** в центральном столбце.  В столбце справа выберите очереди агента, содержащий агент построения, выполняющий стек Azure.  
    ![изображение конфигурации Отображение определения выпуска для использования определенной очереди](./media/azure-stack-solution-pipeline/image3.png)


## <a name="deploy-your-app-to-azure"></a>Развертывание приложения в Azure
Этот шаг использует созданный конвейер CI или компакт-диска для развертывания приложения ASP.NET на веб-приложения в Azure. 

1.  Баннер в VSTS, выберите **построения и выпуска**, а затем выберите **строит**.
2.  Нажмите кнопку **... ** в определении построения ранее созданный и выберите **в очередь новую сборку**.
3.  Примите значения по умолчанию и нажмите кнопку **ОК**.  Построение начинается и отображает ход выполнения.
4.  После завершения построения можно отслеживать состояние, выбрав **построения и выпуска** и выбрав **выпуски**.
5.  После завершения построения, посетите веб-сайт, используя URL-адрес, указанных при создании веб-приложения.    


## <a name="add-azure-stack-to-pipeline"></a>Добавление Azure стека конвейерная передача
Теперь, когда развертывание в Azure, когда работа конвейер CI/CD, пора добавить Azure стека в конвейер.  В следующих шагах создать новую среду и добавить задачу передачи FTP для развертывания приложения в Azure стек.  Можно также добавить утверждающий выпуска служит для имитации «подпись» на выпуск кода в стек Azure.  

1.  В определении выпуска выберите **+ добавить среду** и **Создание новой среды**.
2.  Выберите **пустой**, нажмите кнопку **Далее**.
3.  Выберите **конкретных пользователей** и укажите учетную запись.  Нажмите кнопку **Создать**.
4.  Переименовать среду, выбрав имя существующего и введя *стека Azure*.
5.  Выбор среды стека Azure, затем выберите, **добавьте задачи**.
6.  Выберите **отправить FTP** задач и выберите **добавить**, а затем выберите **закрыть**.


### <a name="configure-ftp-task"></a>Настройка задачи «FTP»
После создания выпуска следует настроить действия, необходимые для публикации в веб-приложения Azure стек.  Так же, как вы настроили задачи передачи FTP для Azure, можно настроить задачу для стека Azure:

1.  Выберите **отправить FTP** задачу необходимо просто добавить и настроить следующие параметры:
    
    | Параметр | Значение |
    | -----     | ----- |
    |Метод проверки подлинности| Введите учетные данные|
    |URL-адрес сервера | Получить URL-адрес FTP приложения с портала Azure стека |
    |Имя пользователя | Имя пользователя, которые были настроены при создании учетных данных FTP для веб-приложения |
    |Пароль | Пароль, созданный при установке учетные данные FTP для веб-приложения|
    |Исходный каталог | $(System.DefaultWorkingDirectory)\**\ |
    |Удаленный каталог | /Site/wwwroot /|
    |Сохранить пути к файлам | Включен (флажок установлен)|

2.  Нажмите кнопку **Сохранить**

И наконец настройте определение выпуска для использования агента пул, содержащий агент развертывания, выполнив следующие действия:
1.  Выберите определение выпуска и нажмите кнопку **изменение**
2.  Выберите **выполняются на агенте** в центральном столбце. В столбце справа выберите очереди агента, содержащий агент построения, выполняющий стек Azure.  
    ![изображение конфигурации Отображение определения выпуска для использования определенной очереди](./media/azure-stack-solution-pipeline/image3.png)

## <a name="deploy-new-code"></a>Развертывание нового кода
Теперь можно проверить конвейер CI/CD гибридного с последнего шага, публикация в Azure стека.  В этом разделе изменения нижней части страницы сайта и запустить развертывание по конвейеру.  После завершения вы увидите развертывания в Azure для просмотра изменений, а затем после подтверждения выпуска, они будут опубликованы в стек Azure.

1. В Visual Studio откройте *site.master* файл и измените следующую строку:
    
    `
        <p>&copy; <%: DateTime.Now.Year %> - My ASP.NET Application</p>
    `

    на такой:

    `
        <p>&copy; <%: DateTime.Now.Year %> - My ASP.NET Application delivered by VSTS, Azure, and Azure Stack</p>
    `
3.  Сохранить изменения и синхронизировать в VSTS.  
4.  В рабочей области VSTS для проверки состояния сборки выберите **построения и выпуска** > **построения**
5.  Вы увидите построение выполняется.  Дважды щелкните состояние, и можно отслеживать ход выполнения сборок.  После просмотра «По завершении сборки» в консоли, перейти к проверьте выпуска из **построения и выпуска** > **выпуска**.  Дважды щелкните выпуска.
6.  Вы получите уведомление, что выпуск необходим анализ. Проверьте URL-адрес приложения и убедитесь, что новые изменения.  Утверждение выпуска в VSTS.
    ![изображение конфигурации Отображение определения выпуска для использования определенной очереди](./media/azure-stack-solution-pipeline/image4.png)
    
7.  Проверьте публикацию в Azure стека завершение, посетив веб-сайт, используя URL-адрес, указанных при создании веб-приложения.
    ![изображение ASP. NEt приложения с нижним колонтитулом изменен](./media/azure-stack-solution-pipeline/image5.png)


Теперь можно использовать новый конвейер CI/CD гибридного как стандартный блок для других шаблонов гибридного облака.

## <a name="next-steps"></a>Дальнейшие действия
В этом учебнике вы узнали, как создать гибридную CI/CD конвейера, который:

> [!div class="checklist"]
> * Инициирует новую сборку на основе кода фиксации в репозиторий, Visual Studio Team Services (VSTS).
> * Развертывает в Azure автоматически созданный код для пользовательского приемочного тестирования.
> * После прохождения проверки кода автоматически разворачивает Azure стека. 

Теперь, когда конвейер CI/CD гибридного продолжения, изучив для разработки приложений для Azure стека.

> [!div class="nextstepaction"]
> [Разработка для Azure Stack](azure-stack-developer.md)


