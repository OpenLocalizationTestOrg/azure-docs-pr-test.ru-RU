---
title: "Развернуть приложение в Azure и Azure стек | Документы Microsoft"
description: "Дополнительные сведения о развертывание приложений для Azure и Azure стека с конвейером гибридного CI или компакт-диска."
services: azure-stack
documentationcenter: 
author: HeathL17
manager: byronr
editor: 
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: helaw
ms.custom: mvc
ms.openlocfilehash: 019d743b0b3104e16a6690f438e7841fa63f09d0
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="deploy-apps-to-azure-and-azure-stack"></a><span data-ttu-id="3b9b0-103">Развертывание приложений для Azure и Azure стека</span><span class="sxs-lookup"><span data-stu-id="3b9b0-103">Deploy apps to Azure and Azure Stack</span></span>
<span data-ttu-id="3b9b0-104">Гибридной [непрерывной интеграции](https://www.visualstudio.com/learn/what-is-continuous-integration/)/[непрерывной поставки](https://www.visualstudio.com/learn/what-is-continuous-delivery/)конвейера (CI/CD) дает возможность создания, тестирования и развертывания приложения с несколькими облаками.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-104">A hybrid [continuous integration](https://www.visualstudio.com/learn/what-is-continuous-integration/)/[continuous delivery](https://www.visualstudio.com/learn/what-is-continuous-delivery/)(CI/CD) pipeline enables you to build, test, and deploy your app to multiple clouds.</span></span>  <span data-ttu-id="3b9b0-105">В этом учебнике сборки примере среды, чтобы узнать, как конвейер CI/CD гибридного может помочь:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-105">In this tutorial, you build a sample environment to learn how a hybrid CI/CD pipeline can help you:</span></span>
 
> [!div class="checklist"]
> * <span data-ttu-id="3b9b0-106">Запуск новой сборки, исходя из кода фиксации в репозиторий, Visual Studio Team Services (VSTS).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-106">Initiate a new build based on code commits to your Visual Studio Team Services (VSTS) repository.</span></span>
> * <span data-ttu-id="3b9b0-107">Развертывание в Azure автоматически созданный код для пользовательского приемочного тестирования.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-107">Automatically deploy your newly built code to Azure for user acceptance testing.</span></span>
> * <span data-ttu-id="3b9b0-108">После прохождения проверки кода автоматически разверните Azure стека.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-108">Once your code has passed testing, automatically deploy to Azure Stack.</span></span> 


## <a name="prerequisites"></a><span data-ttu-id="3b9b0-109">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="3b9b0-109">Prerequisites</span></span>
<span data-ttu-id="3b9b0-110">Несколько компоненты необходимы для построения конвейера гибридного CI/CD и может занять некоторое время для подготовки.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-110">A few components are required to build a hybrid CI/CD pipeline, and may take some time to prepare.</span></span>  <span data-ttu-id="3b9b0-111">Если у вас уже есть некоторые из этих компонентов, убедитесь, что они отвечают требованиям перед началом.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-111">If you already have some of these components, make sure they meet the requirements before beginning.</span></span>

<span data-ttu-id="3b9b0-112">В этом разделе также предполагается, что имеется знание Azure и Azure стека.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-112">This topic also assumes that you have some knowledge of Azure and Azure Stack.</span></span> <span data-ttu-id="3b9b0-113">Если вы хотите узнать больше, прежде чем продолжить, убедитесь, что начните с этих разделов:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-113">If you want to learn more before proceeding, be sure to start with these topics:</span></span>

- [<span data-ttu-id="3b9b0-114">Введение в Azure</span><span class="sxs-lookup"><span data-stu-id="3b9b0-114">Introduction to Azure</span></span>](https://docs.microsoft.com/azure/fundamentals-introduction-to-azure)
- [<span data-ttu-id="3b9b0-115">Основные понятия стек Azure</span><span class="sxs-lookup"><span data-stu-id="3b9b0-115">Azure Stack Key Concepts</span></span>](azure-stack-key-features.md)

### <a name="azure"></a><span data-ttu-id="3b9b0-116">Таблицы Azure</span><span class="sxs-lookup"><span data-stu-id="3b9b0-116">Azure</span></span>
 - <span data-ttu-id="3b9b0-117">Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-117">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) before you begin.</span></span>
 - <span data-ttu-id="3b9b0-118">Создание [веб-приложения](../app-service-web/app-service-web-how-to-create-a-web-app-in-an-ase.md)и настройте его для [FTP-публикацию](../app-service-web/app-service-deploy-ftp.md).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-118">Create a [Web App](../app-service-web/app-service-web-how-to-create-a-web-app-in-an-ase.md), and configure it for [FTP publishing](../app-service-web/app-service-deploy-ftp.md).</span></span>  <span data-ttu-id="3b9b0-119">Запишите новый URL-адрес приложения, как будет использоваться позднее.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-119">Make note of the new Web App URL, as it is used later.</span></span>


### <a name="azure-stack"></a><span data-ttu-id="3b9b0-120">Azure Stack</span><span class="sxs-lookup"><span data-stu-id="3b9b0-120">Azure Stack</span></span>
 - <span data-ttu-id="3b9b0-121">[Развертывание Azure стека](azure-stack-run-powershell-script.md).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-121">[Deploy Azure Stack](azure-stack-run-powershell-script.md).</span></span>  <span data-ttu-id="3b9b0-122">Установка обычно занимает несколько часов, чтобы завершить, поэтому планирование соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-122">The installation usually takes a few hours to complete, so plan accordingly.</span></span>
 - <span data-ttu-id="3b9b0-123">Развертывание [службы приложений](azure-stack-app-service-deploy.md) служб PaaS стек Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-123">Deploy [App Service](azure-stack-app-service-deploy.md) PaaS services to Azure Stack.</span></span>
 - <span data-ttu-id="3b9b0-124">Создать веб-приложения и настроить его для [FTP-публикацию](azure-stack-app-service-enable-ftp.md).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-124">Create a Web App and configure it for [FTP publishing](azure-stack-app-service-enable-ftp.md).</span></span>  <span data-ttu-id="3b9b0-125">Запишите новый URL-адрес приложения, как будет использоваться позднее.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-125">Make note of the new Web App URL, as it is used later.</span></span>  

### <a name="developer-tools"></a><span data-ttu-id="3b9b0-126">Инструменты для разработчиков</span><span class="sxs-lookup"><span data-stu-id="3b9b0-126">Developer tools</span></span>
 - <span data-ttu-id="3b9b0-127">Создание [VSTS рабочей](https://www.visualstudio.com/docs/setup-admin/team-services/sign-up-for-visual-studio-team-services).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-127">Create a [VSTS workspace](https://www.visualstudio.com/docs/setup-admin/team-services/sign-up-for-visual-studio-team-services).</span></span>  <span data-ttu-id="3b9b0-128">Процесс регистрации создает проект с именем «MyFirstProject.»</span><span class="sxs-lookup"><span data-stu-id="3b9b0-128">The sign-up process creates a project named "MyFirstProject."</span></span>  
 - <span data-ttu-id="3b9b0-129">[Установка Visual Studio 2017 г](https://docs.microsoft.com/visualstudio/install/install-visual-studio) и [входа в VSTS](https://www.visualstudio.com/docs/setup-admin/team-services/connect-to-visual-studio-team-services#connect-and-share-code-from-visual-studio)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-129">[Install Visual Studio 2017](https://docs.microsoft.com/visualstudio/install/install-visual-studio) and [sign-in to VSTS](https://www.visualstudio.com/docs/setup-admin/team-services/connect-to-visual-studio-team-services#connect-and-share-code-from-visual-studio)</span></span>
 - <span data-ttu-id="3b9b0-130">Подключитесь к проекту и [клонировать локально](https://www.visualstudio.com/docs/git/gitquickstart).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-130">Connect to the project and [clone locally](https://www.visualstudio.com/docs/git/gitquickstart).</span></span>
 - <span data-ttu-id="3b9b0-131">Создание [пул агентов](https://www.visualstudio.com/docs/build/concepts/agents/pools-queues#creating-agent-pools-and-queues) в VSTS.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-131">Create an [agent pool](https://www.visualstudio.com/docs/build/concepts/agents/pools-queues#creating-agent-pools-and-queues) in VSTS.</span></span>
 - <span data-ttu-id="3b9b0-132">Установка Visual Studio и развертывание [агент сборки VSTS](https://www.visualstudio.com/docs/build/actions/agents/v2-windows) к виртуальной машине Azure стек.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-132">Install Visual Studio and deploy a [VSTS build agent](https://www.visualstudio.com/docs/build/actions/agents/v2-windows) to a virtual machine on Azure Stack.</span></span> 
 

## <a name="create-app--push-to-vsts"></a><span data-ttu-id="3b9b0-133">Создание приложения и отправьте данные в VSTS</span><span class="sxs-lookup"><span data-stu-id="3b9b0-133">Create app & push to VSTS</span></span>

### <a name="create-application"></a><span data-ttu-id="3b9b0-134">Создание приложения</span><span class="sxs-lookup"><span data-stu-id="3b9b0-134">Create application</span></span>
<span data-ttu-id="3b9b0-135">В этом разделе также создать простое приложение ASP.NET и передать его в VSTS.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-135">In this section, you create a simple ASP.NET application and push it to VSTS.</span></span>  <span data-ttu-id="3b9b0-136">Эти шаги представляют обычного разработчика рабочего процесса, а также может быть адаптирована для разработчиков средств и языков.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-136">These steps represent the normal developer workflow, and could be adapted for developer tools and languages.</span></span> 

1.  <span data-ttu-id="3b9b0-137">Откройте Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-137">Open Visual Studio.</span></span>
2.  <span data-ttu-id="3b9b0-138">Из Team Explorer пространства и **решения... ** область, щелкните **New**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-138">From the Team Explorer space and **Solutions...** area, click **New**.</span></span>
3.  <span data-ttu-id="3b9b0-139">Выберите **Visual C#** > **Web** > **веб-приложения ASP.NET (.NET Framework)**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-139">Select **Visual C#** > **Web** > **ASP.NET Web Application (.NET Framework)**.</span></span>
4.  <span data-ttu-id="3b9b0-140">Укажите имя для приложения и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-140">Provide a name for the application and click **OK**.</span></span>
5.  <span data-ttu-id="3b9b0-141">На следующем экране, оставьте значения по умолчанию (Web forms), а затем нажмите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-141">On the next screen, keep the defaults (Web forms) and click **OK**.</span></span>

### <a name="commit-and-push-changes-to-vsts"></a><span data-ttu-id="3b9b0-142">Зафиксируйте и отправьте изменения в VSTS</span><span class="sxs-lookup"><span data-stu-id="3b9b0-142">Commit and push changes to VSTS</span></span>
1.  <span data-ttu-id="3b9b0-143">С помощью Team Explorer в Visual Studio, щелкните раскрывающийся список и нажмите кнопку **изменения**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-143">Using Team Explorer in Visual Studio, select the dropdown and click **Changes**.</span></span>
2.  <span data-ttu-id="3b9b0-144">Введите сообщение фиксации и выберите **фиксации на всех**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-144">Provide a commit message and select **Commit all**.</span></span> <span data-ttu-id="3b9b0-145">Вам может быть предложено сохранить файл решения, нажмите "Да", чтобы сохранить все.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-145">You may be prompted to save the solution file, click yes to save all.</span></span>
3.  <span data-ttu-id="3b9b0-146">После фиксации, Visual Studio предлагает синхронизировать изменения, внесенные в проект.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-146">Once committed, Visual Studio offers to sync changes to your project.</span></span> <span data-ttu-id="3b9b0-147">Выберите **синхронизации**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-147">Select **Sync**.</span></span>

    ![на изображении показан экран фиксации после фиксации](./media/azure-stack-solution-pipeline/image1.png)

4.  <span data-ttu-id="3b9b0-149">На вкладке «синхронизация» в разделе *исходящие*, появится новый фиксации.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-149">In the synchronization tab, under *Outgoing*, you see your new commit.</span></span>  <span data-ttu-id="3b9b0-150">Выберите **Push** для синхронизации изменений в VSTS.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-150">Select **Push** to synchronize the change to VSTS.</span></span>

    ![шаги синхронизации отображение изображений](./media/azure-stack-solution-pipeline/image2.png)

### <a name="review-code-in-vsts"></a><span data-ttu-id="3b9b0-152">Проверьте код в VSTS</span><span class="sxs-lookup"><span data-stu-id="3b9b0-152">Review code in VSTS</span></span>
<span data-ttu-id="3b9b0-153">После фиксации изменений и помещено в VSTS, проверьте код на портале VSTS.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-153">Once you've committed a change and pushed to VSTS, check your code from the VSTS portal.</span></span>  <span data-ttu-id="3b9b0-154">Выберите **кода**, а затем **файлы** в раскрывающемся меню.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-154">Select **Code**, and then **Files** from the dropdown menu.</span></span>  <span data-ttu-id="3b9b0-155">Вы увидите решение, которое вы создали.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-155">You can see the solution you created.</span></span>

## <a name="create-build-definition"></a><span data-ttu-id="3b9b0-156">Создание определения сборки</span><span class="sxs-lookup"><span data-stu-id="3b9b0-156">Create build definition</span></span>
<span data-ttu-id="3b9b0-157">Процесс построения определяет, построения и упаковки для развертывания на каждой фиксации изменений кода приложения.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-157">The build process defines how your application is built and packaged for deployment on each commit of code changes.</span></span> <span data-ttu-id="3b9b0-158">В нашем примере мы используем включенный шаблон для настройки процесса построения для приложения ASP.NET, хотя эта конфигурация может быть адаптирован в зависимости от приложения.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-158">In our example, we use the included template to configure the build process for an ASP.NET app, though this configuration could be adapted depending on your application.</span></span>

1.  <span data-ttu-id="3b9b0-159">Войдите в рабочую область VSTS веб-браузере.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-159">Sign in to your VSTS workspace from a web browser.</span></span>
2.  <span data-ttu-id="3b9b0-160">В баннере, выберите **построения и выпуска** и затем **строит**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-160">From the banner, select **Build & Release**  and then **Builds**.</span></span>
3.  <span data-ttu-id="3b9b0-161">Нажмите кнопку **+ новое определение**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-161">Click **+ New definition**.</span></span>
4.  <span data-ttu-id="3b9b0-162">В списке шаблонов выберите **ASP.NET (Предварительная версия)** и выберите **применить**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-162">From the list of templates, select **ASP.NET (Preview)** and select **Apply**.</span></span>
5.  <span data-ttu-id="3b9b0-163">Изменить *Аргументы MSBuild* в *построить решение* шаг для:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-163">Modify the *MSBuild Arguments* field in *Build Solution* step to:</span></span>

    `/p:DeployOnBuild=True /p:WebPublishMethod=FileSystem /p:DeployDefaultTarget=WebPublish /p:publishUrl="$(build.artifactstagingdirectory)\\"`

6.  <span data-ttu-id="3b9b0-164">Выберите **параметры** и выберите очередь агента для агента построения, развертывания для виртуальной машины в Azure стека.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-164">Select the **Options** tab, and select the agent queue for the build agent you deployed to a virtual machine on Azure Stack.</span></span> 
7.  <span data-ttu-id="3b9b0-165">Выберите **триггеры** и включите **непрерывной интеграции**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-165">Select the **Triggers** tab, and enable **Continuous Integration**.</span></span>
7.  <span data-ttu-id="3b9b0-166">Нажмите кнопку **сохранить & очередь** , а затем выберите **Сохранить** из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-166">Click **Save & queue** and then select **Save** from the dropdown.</span></span> 

## <a name="create-release-definition"></a><span data-ttu-id="3b9b0-167">Создание определения выпуска</span><span class="sxs-lookup"><span data-stu-id="3b9b0-167">Create release definition</span></span>
<span data-ttu-id="3b9b0-168">Процесс выпуска определяет развертывание сборок из предыдущего шага в среде.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-168">The release process defines how builds from the previous step are deployed to an environment.</span></span>  <span data-ttu-id="3b9b0-169">В этом учебнике мы опубликовать нашего приложения ASP.NET с использованием FTP веб-приложение Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-169">In this tutorial, we publish our ASP.NET app with FTP to an Azure Web App.</span></span> <span data-ttu-id="3b9b0-170">Чтобы настроить выпуска в Azure, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-170">To configure a release to Azure, use the following steps:</span></span>

1.  <span data-ttu-id="3b9b0-171">В баннере VSTS выберите **построения и выпуска** и затем **выпуски**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-171">From the VSTS banner, select **Build & Release**  and then **Releases**.</span></span>
2.  <span data-ttu-id="3b9b0-172">Нажмите зеленую **+ новое определение**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-172">Click the green **+ New definition**.</span></span>
3.  <span data-ttu-id="3b9b0-173">Выберите **пустой** и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-173">Select **Empty** and click **Next**.</span></span>
4.  <span data-ttu-id="3b9b0-174">Установите флажок для *непрерывного развертывания*, а затем нажмите кнопку **создать**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-174">Check the box for *Continuous deployment*, and then click **Create**.</span></span>

<span data-ttu-id="3b9b0-175">Создания определения пустой выпуска и он привязан к построению, мы добавляем действия для среды Azure:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-175">Now that you've created an empty release definition and tied it to the build, we add steps for the Azure environment:</span></span>

1.  <span data-ttu-id="3b9b0-176">Нажмите зеленую ** + ** для добавления задач.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-176">Click the green **+** to add tasks.</span></span>
2.  <span data-ttu-id="3b9b0-177">Выберите **все**, а затем в списке, добавьте **отправить FTP** и выберите **закрыть**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-177">Select **All**, and then from the list, add **FTP Upload** and select **Close**.</span></span>
3.  <span data-ttu-id="3b9b0-178">Выберите **отправить FTP** задачу необходимо просто добавить и настроить следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-178">Select the **FTP Upload** task you just added, and configure the following parameters:</span></span>
    
    | <span data-ttu-id="3b9b0-179">Параметр</span><span class="sxs-lookup"><span data-stu-id="3b9b0-179">Parameter</span></span> | <span data-ttu-id="3b9b0-180">Значение</span><span class="sxs-lookup"><span data-stu-id="3b9b0-180">Value</span></span> |
    | ----- | ----- |
    |<span data-ttu-id="3b9b0-181">Метод проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="3b9b0-181">Authentication Method</span></span>| <span data-ttu-id="3b9b0-182">Введите учетные данные</span><span class="sxs-lookup"><span data-stu-id="3b9b0-182">Enter Credentials</span></span>|
    |<span data-ttu-id="3b9b0-183">URL-адрес сервера</span><span class="sxs-lookup"><span data-stu-id="3b9b0-183">Server URL</span></span> | <span data-ttu-id="3b9b0-184">Получить URL-адрес FTP приложения с портала Azure</span><span class="sxs-lookup"><span data-stu-id="3b9b0-184">Web App FTP URL retrieved from Azure portal</span></span> |
    |<span data-ttu-id="3b9b0-185">Имя пользователя</span><span class="sxs-lookup"><span data-stu-id="3b9b0-185">Username</span></span> | <span data-ttu-id="3b9b0-186">Имя пользователя, которые были настроены при создании учетных данных FTP для веб-приложения</span><span class="sxs-lookup"><span data-stu-id="3b9b0-186">Username you configured when creating FTP Credentials for Web App</span></span> |
    |<span data-ttu-id="3b9b0-187">Пароль</span><span class="sxs-lookup"><span data-stu-id="3b9b0-187">Password</span></span> | <span data-ttu-id="3b9b0-188">Пароль, созданный при установке учетные данные FTP для веб-приложения</span><span class="sxs-lookup"><span data-stu-id="3b9b0-188">Password you created when establishing FTP credentials for Web App</span></span>|
    |<span data-ttu-id="3b9b0-189">Исходный каталог</span><span class="sxs-lookup"><span data-stu-id="3b9b0-189">Source Directory</span></span> | <span data-ttu-id="3b9b0-190">$(System.DefaultWorkingDirectory)\**\\</span><span class="sxs-lookup"><span data-stu-id="3b9b0-190">$(System.DefaultWorkingDirectory)\**\\</span></span> |
    |<span data-ttu-id="3b9b0-191">Удаленный каталог</span><span class="sxs-lookup"><span data-stu-id="3b9b0-191">Remote Directory</span></span> | <span data-ttu-id="3b9b0-192">/Site/wwwroot /</span><span class="sxs-lookup"><span data-stu-id="3b9b0-192">/site/wwwroot/</span></span> |
    |<span data-ttu-id="3b9b0-193">Сохранить пути к файлам</span><span class="sxs-lookup"><span data-stu-id="3b9b0-193">Preserve file paths</span></span> | <span data-ttu-id="3b9b0-194">Включен (флажок установлен)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-194">Enabled (checked)</span></span>|

4.  <span data-ttu-id="3b9b0-195">Нажмите кнопку **Сохранить**</span><span class="sxs-lookup"><span data-stu-id="3b9b0-195">Click **Save**</span></span>

<span data-ttu-id="3b9b0-196">Наконец настроить определение выпуска для использования агента пул, содержащий агент развертывания, выполнив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-196">Finally, you configure the release definition to use the agent pool containing the agent deployed using the following steps:</span></span>
1.  <span data-ttu-id="3b9b0-197">Выберите определение выпуска и нажмите кнопку **изменить**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-197">Select the release definition and click **Edit**.</span></span>
2.  <span data-ttu-id="3b9b0-198">Выберите **выполняются на агенте** в центральном столбце.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-198">Select **Run on agent** from the middle column.</span></span>  <span data-ttu-id="3b9b0-199">В столбце справа выберите очереди агента, содержащий агент построения, выполняющий стек Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-199">In the right column, select the agent queue containing the build agent running on Azure Stack.</span></span>  
    <span data-ttu-id="3b9b0-200">![изображение конфигурации Отображение определения выпуска для использования определенной очереди](./media/azure-stack-solution-pipeline/image3.png)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-200">![image showing configuration of release definition to use specific queue](./media/azure-stack-solution-pipeline/image3.png)</span></span>


## <a name="deploy-your-app-to-azure"></a><span data-ttu-id="3b9b0-201">Развертывание приложения в Azure</span><span class="sxs-lookup"><span data-stu-id="3b9b0-201">Deploy your app to Azure</span></span>
<span data-ttu-id="3b9b0-202">Этот шаг использует созданный конвейер CI или компакт-диска для развертывания приложения ASP.NET на веб-приложения в Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-202">This step uses your newly built CI/CD pipeline to deploy the ASP.NET app to a Web App on Azure.</span></span> 

1.  <span data-ttu-id="3b9b0-203">Баннер в VSTS, выберите **построения и выпуска**, а затем выберите **строит**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-203">From the banner in VSTS, select **Build & Release**, and then select **Builds**.</span></span>
2.  <span data-ttu-id="3b9b0-204">Нажмите кнопку **... ** в определении построения ранее созданный и выберите **в очередь новую сборку**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-204">Click **...** on the build definition previously created, and select **Queue new build**.</span></span>
3.  <span data-ttu-id="3b9b0-205">Примите значения по умолчанию и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-205">Accept the defaults and click **Ok**.</span></span>  <span data-ttu-id="3b9b0-206">Построение начинается и отображает ход выполнения.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-206">The build begins and displays progress.</span></span>
4.  <span data-ttu-id="3b9b0-207">После завершения построения можно отслеживать состояние, выбрав **построения и выпуска** и выбрав **выпуски**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-207">Once the build is complete, you can track the status by selecting **Build & Release** and selecting **Releases**.</span></span>
5.  <span data-ttu-id="3b9b0-208">После завершения построения, посетите веб-сайт, используя URL-адрес, указанных при создании веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-208">After the build is complete, visit the website using the URL noted when creating the Web App.</span></span>    


## <a name="add-azure-stack-to-pipeline"></a><span data-ttu-id="3b9b0-209">Добавление Azure стека конвейерная передача</span><span class="sxs-lookup"><span data-stu-id="3b9b0-209">Add Azure Stack to pipeline</span></span>
<span data-ttu-id="3b9b0-210">Теперь, когда развертывание в Azure, когда работа конвейер CI/CD, пора добавить Azure стека в конвейер.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-210">Now that you've tested your CI/CD pipeline by deploying to Azure, it's time to add Azure Stack to the pipeline.</span></span>  <span data-ttu-id="3b9b0-211">В следующих шагах создать новую среду и добавить задачу передачи FTP для развертывания приложения в Azure стек.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-211">In the following steps, you create a new environment and add an FTP Upload task to deploy your app to Azure Stack.</span></span>  <span data-ttu-id="3b9b0-212">Можно также добавить утверждающий выпуска служит для имитации «подпись» на выпуск кода в стек Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-212">You also add a release approver, which serves as a way to simulate "signing off" on a code release to Azure Stack.</span></span>  

1.  <span data-ttu-id="3b9b0-213">В определении выпуска выберите **+ добавить среду** и **Создание новой среды**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-213">In the Release definition, select **+ Add Environment** and **Create new environment**.</span></span>
2.  <span data-ttu-id="3b9b0-214">Выберите **пустой**, нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-214">Select **Empty**, click **Next**.</span></span>
3.  <span data-ttu-id="3b9b0-215">Выберите **конкретных пользователей** и укажите учетную запись.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-215">Select **Specific users** and specify your account.</span></span>  <span data-ttu-id="3b9b0-216">Нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-216">Select **Create**.</span></span>
4.  <span data-ttu-id="3b9b0-217">Переименовать среду, выбрав имя существующего и введя *стека Azure*.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-217">Rename the environment by selecting the existing name and typing *Azure Stack*.</span></span>
5.  <span data-ttu-id="3b9b0-218">Выбор среды стека Azure, затем выберите, **добавьте задачи**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-218">Now, selection the Azure Stack environment, then select **Add tasks**.</span></span>
6.  <span data-ttu-id="3b9b0-219">Выберите **отправить FTP** задач и выберите **добавить**, а затем выберите **закрыть**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-219">Select the **FTP Upload** task and select **Add**, then select **Close**.</span></span>


### <a name="configure-ftp-task"></a><span data-ttu-id="3b9b0-220">Настройка задачи «FTP»</span><span class="sxs-lookup"><span data-stu-id="3b9b0-220">Configure FTP task</span></span>
<span data-ttu-id="3b9b0-221">После создания выпуска следует настроить действия, необходимые для публикации в веб-приложения Azure стек.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-221">Now that you've created a release, you'll configure the steps required for publishing to the Web App on Azure Stack.</span></span>  <span data-ttu-id="3b9b0-222">Так же, как вы настроили задачи передачи FTP для Azure, можно настроить задачу для стека Azure:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-222">Just like you configured the FTP Upload task for Azure, you configure the task for Azure Stack:</span></span>

1.  <span data-ttu-id="3b9b0-223">Выберите **отправить FTP** задачу необходимо просто добавить и настроить следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-223">Select the **FTP Upload** task you just added, and configure the following parameters:</span></span>
    
    | <span data-ttu-id="3b9b0-224">Параметр</span><span class="sxs-lookup"><span data-stu-id="3b9b0-224">Parameter</span></span> | <span data-ttu-id="3b9b0-225">Значение</span><span class="sxs-lookup"><span data-stu-id="3b9b0-225">Value</span></span> |
    | -----     | ----- |
    |<span data-ttu-id="3b9b0-226">Метод проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="3b9b0-226">Authentication Method</span></span>| <span data-ttu-id="3b9b0-227">Введите учетные данные</span><span class="sxs-lookup"><span data-stu-id="3b9b0-227">Enter Credentials</span></span>|
    |<span data-ttu-id="3b9b0-228">URL-адрес сервера</span><span class="sxs-lookup"><span data-stu-id="3b9b0-228">Server URL</span></span> | <span data-ttu-id="3b9b0-229">Получить URL-адрес FTP приложения с портала Azure стека</span><span class="sxs-lookup"><span data-stu-id="3b9b0-229">Web App FTP URL retrieved from Azure Stack portal</span></span> |
    |<span data-ttu-id="3b9b0-230">Имя пользователя</span><span class="sxs-lookup"><span data-stu-id="3b9b0-230">Username</span></span> | <span data-ttu-id="3b9b0-231">Имя пользователя, которые были настроены при создании учетных данных FTP для веб-приложения</span><span class="sxs-lookup"><span data-stu-id="3b9b0-231">Username you configured when creating FTP Credentials for Web App</span></span> |
    |<span data-ttu-id="3b9b0-232">Пароль</span><span class="sxs-lookup"><span data-stu-id="3b9b0-232">Password</span></span> | <span data-ttu-id="3b9b0-233">Пароль, созданный при установке учетные данные FTP для веб-приложения</span><span class="sxs-lookup"><span data-stu-id="3b9b0-233">Password you created when establishing FTP credentials for Web App</span></span>|
    |<span data-ttu-id="3b9b0-234">Исходный каталог</span><span class="sxs-lookup"><span data-stu-id="3b9b0-234">Source Directory</span></span> | <span data-ttu-id="3b9b0-235">$(System.DefaultWorkingDirectory)\**\\</span><span class="sxs-lookup"><span data-stu-id="3b9b0-235">$(System.DefaultWorkingDirectory)\**\\</span></span> |
    |<span data-ttu-id="3b9b0-236">Удаленный каталог</span><span class="sxs-lookup"><span data-stu-id="3b9b0-236">Remote Directory</span></span> | <span data-ttu-id="3b9b0-237">/Site/wwwroot /</span><span class="sxs-lookup"><span data-stu-id="3b9b0-237">/site/wwwroot/</span></span>|
    |<span data-ttu-id="3b9b0-238">Сохранить пути к файлам</span><span class="sxs-lookup"><span data-stu-id="3b9b0-238">Preserve file paths</span></span> | <span data-ttu-id="3b9b0-239">Включен (флажок установлен)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-239">Enabled (checked)</span></span>|

2.  <span data-ttu-id="3b9b0-240">Нажмите кнопку **Сохранить**</span><span class="sxs-lookup"><span data-stu-id="3b9b0-240">Click **Save**</span></span>

<span data-ttu-id="3b9b0-241">И наконец настройте определение выпуска для использования агента пул, содержащий агент развертывания, выполнив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-241">Finally, configure the release definition to use the agent pool containing the agent deployed using the following steps:</span></span>
1.  <span data-ttu-id="3b9b0-242">Выберите определение выпуска и нажмите кнопку **изменение**</span><span class="sxs-lookup"><span data-stu-id="3b9b0-242">Select the release definition and click **Edit**</span></span>
2.  <span data-ttu-id="3b9b0-243">Выберите **выполняются на агенте** в центральном столбце.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-243">Select **Run on agent** from the middle column.</span></span> <span data-ttu-id="3b9b0-244">В столбце справа выберите очереди агента, содержащий агент построения, выполняющий стек Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-244">In the right column, select the agent queue containing the build agent running on Azure Stack.</span></span>  
    <span data-ttu-id="3b9b0-245">![изображение конфигурации Отображение определения выпуска для использования определенной очереди](./media/azure-stack-solution-pipeline/image3.png)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-245">![image showing configuration of release definition to use specific queue](./media/azure-stack-solution-pipeline/image3.png)</span></span>

## <a name="deploy-new-code"></a><span data-ttu-id="3b9b0-246">Развертывание нового кода</span><span class="sxs-lookup"><span data-stu-id="3b9b0-246">Deploy new code</span></span>
<span data-ttu-id="3b9b0-247">Теперь можно проверить конвейер CI/CD гибридного с последнего шага, публикация в Azure стека.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-247">You can now test the hybrid CI/CD pipeline, with the final step publishing to Azure Stack.</span></span>  <span data-ttu-id="3b9b0-248">В этом разделе изменения нижней части страницы сайта и запустить развертывание по конвейеру.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-248">In this section, you modify the site's footer and start deployment through the pipeline.</span></span>  <span data-ttu-id="3b9b0-249">После завершения вы увидите развертывания в Azure для просмотра изменений, а затем после подтверждения выпуска, они будут опубликованы в стек Azure.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-249">Once complete, you will see your changes deployed to Azure for review, then once you approve the release, they are published to Azure Stack.</span></span>

1. <span data-ttu-id="3b9b0-250">В Visual Studio откройте *site.master* файл и измените следующую строку:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-250">In Visual Studio, open the *site.master* file and change this line:</span></span>
    
    `
        <p>&copy; <%: DateTime.Now.Year %> - My ASP.NET Application</p>
    `

    <span data-ttu-id="3b9b0-251">на такой:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-251">to this:</span></span>

    `
        <p>&copy; <%: DateTime.Now.Year %> - My ASP.NET Application delivered by VSTS, Azure, and Azure Stack</p>
    `
3.  <span data-ttu-id="3b9b0-252">Сохранить изменения и синхронизировать в VSTS.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-252">Commit the changes and sync to VSTS.</span></span>  
4.  <span data-ttu-id="3b9b0-253">В рабочей области VSTS для проверки состояния сборки выберите **построения и выпуска** > **построения**</span><span class="sxs-lookup"><span data-stu-id="3b9b0-253">From the VSTS workspace, check the build status by selecting **Build & Release** > **Build**</span></span>
5.  <span data-ttu-id="3b9b0-254">Вы увидите построение выполняется.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-254">You will see a build in progress.</span></span>  <span data-ttu-id="3b9b0-255">Дважды щелкните состояние, и можно отслеживать ход выполнения сборок.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-255">Double-click the status, and you can watch the build progress.</span></span>  <span data-ttu-id="3b9b0-256">После просмотра «По завершении сборки» в консоли, перейти к проверьте выпуска из **построения и выпуска** > **выпуска**.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-256">Once you see "Finished build" in the console, move on to check the release from **Build & Release** > **Release**.</span></span>  <span data-ttu-id="3b9b0-257">Дважды щелкните выпуска.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-257">Double-click the release.</span></span>
6.  <span data-ttu-id="3b9b0-258">Вы получите уведомление, что выпуск необходим анализ.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-258">You will receive notification that a release requires review.</span></span> <span data-ttu-id="3b9b0-259">Проверьте URL-адрес приложения и убедитесь, что новые изменения.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-259">Check the Web App URL and verify the new changes are present.</span></span>  <span data-ttu-id="3b9b0-260">Утверждение выпуска в VSTS.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-260">Approve the release in VSTS.</span></span>
    <span data-ttu-id="3b9b0-261">![изображение конфигурации Отображение определения выпуска для использования определенной очереди](./media/azure-stack-solution-pipeline/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-261">![image showing configuration of release definition to use specific queue](./media/azure-stack-solution-pipeline/image4.png)</span></span>
    
7.  <span data-ttu-id="3b9b0-262">Проверьте публикацию в Azure стека завершение, посетив веб-сайт, используя URL-адрес, указанных при создании веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-262">Verify publishing to Azure Stack is complete by visiting the website using the URL noted when creating the Web App.</span></span>
    <span data-ttu-id="3b9b0-263">![изображение ASP. NEt приложения с нижним колонтитулом изменен](./media/azure-stack-solution-pipeline/image5.png)</span><span class="sxs-lookup"><span data-stu-id="3b9b0-263">![image showing ASP.NEt app with footer changed](./media/azure-stack-solution-pipeline/image5.png)</span></span>


<span data-ttu-id="3b9b0-264">Теперь можно использовать новый конвейер CI/CD гибридного как стандартный блок для других шаблонов гибридного облака.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-264">You can now use your new hybrid CI/CD pipeline as a building block for other hybrid cloud patterns.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3b9b0-265">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="3b9b0-265">Next steps</span></span>
<span data-ttu-id="3b9b0-266">В этом учебнике вы узнали, как создать гибридную CI/CD конвейера, который:</span><span class="sxs-lookup"><span data-stu-id="3b9b0-266">In this tutorial, you learned how to build a hybrid CI/CD pipeline that:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="3b9b0-267">Инициирует новую сборку на основе кода фиксации в репозиторий, Visual Studio Team Services (VSTS).</span><span class="sxs-lookup"><span data-stu-id="3b9b0-267">Initiates a new build based on code commits to your Visual Studio Team Services (VSTS) repository.</span></span>
> * <span data-ttu-id="3b9b0-268">Развертывает в Azure автоматически созданный код для пользовательского приемочного тестирования.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-268">Automatically deploys your newly built code to Azure for user acceptance testing.</span></span>
> * <span data-ttu-id="3b9b0-269">После прохождения проверки кода автоматически разворачивает Azure стека.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-269">Once your code has passed testing, automatically deploys to Azure Stack.</span></span> 

<span data-ttu-id="3b9b0-270">Теперь, когда конвейер CI/CD гибридного продолжения, изучив для разработки приложений для Azure стека.</span><span class="sxs-lookup"><span data-stu-id="3b9b0-270">Now that you have a hybrid CI/CD pipeline, continue by learning how to develop apps for Azure Stack.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="3b9b0-271">Разработка для Azure Stack</span><span class="sxs-lookup"><span data-stu-id="3b9b0-271">Develop for Azure Stack</span></span>](azure-stack-developer.md)


