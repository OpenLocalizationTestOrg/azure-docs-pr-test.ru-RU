---
title: "Использование поставщика ресурсов API | Документы Microsoft"
description: "Ссылку для использования ресурсов API, которая получить сведения об использовании Azure стека."
services: azure-stack
documentationcenter: 
author: AlfredoPizzirani
manager: byronr
editor: 
ms.assetid: b6055923-b6a6-45f0-8979-225b713150ae
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/10/2017
ms.author: alfredop
ms.openlocfilehash: f43ec070e0269fad89b83c3075101e610a90ad96
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="provider-resource-usage-api"></a>Использование поставщика ресурсов API
Термин поставщика применяется для администратора службы и любых делегированного поставщиков. Администраторы службы и делегированные поставщики могут использовать API использования поставщика для просмотра использования своих прямых клиентов. Например P0 может вызывать API-Интерфейс поставщика для получения сведений об использовании на его P1 и P2 в прямом использовании и P1 можно вызвать для получения сведений об использовании на P3 и P4.

![Концептуальная модель поставщика иерархии](media/azure-stack-provider-resource-api/image1.png)

## <a name="api-call-reference"></a>Вызов API-ссылка
### <a name="request"></a>Запрос
Запрос возвращает сведения о потреблении для запрошенной подписки, а также для запрошенного периода времени. Нет текста запроса нет.

Такое использование API является API-Интерфейс поставщика, поэтому вызывающая сторона должна быть назначена владельца, участника или чтения в подписке поставщика.

| **Метод** | **URI запроса** |
| --- | --- |
| ПОЛУЧЕНИЕ |https://{armendpoint}/subscriptions/{subId}/providers/Microsoft.Commerce/subscriberUsageAggregates?reportedStartTime={reportedStartTime}&reportedEndTime={reportedEndTime}&aggregationGranularity={granularity}& subscriberId = {sub1.1} & api-version = 2015-06-01-preview & continuationToken = {значение маркера} |

### <a name="arguments"></a>Аргументы
| **Аргумент** | **Описание** |
| --- | --- |
| *armendpoint* |Конечная точка Azure диспетчер ресурсов среды Azure стека. Стек Azure соглашение является имя конечной точки диспетчера ресурсов Azure в формате `https://adminmanagement.{domain-name}`. Например, если имя домена local.azurestack.external, затем конечную точку диспетчера ресурсов является `https://adminmanagement.local.azurestack.external`. |
| *subId* |Идентификатор подписки пользователя, который выполняет вызов. |
| *reportedStartTime* |Запуск запроса. Значение для *DateTime* должно быть в формате UTC и в начале часа, 13:00. Для ежедневного статистической обработки это значение до полуночи в формате UTC. Недопустимый формат *escape-последовательность* ISO 8601, например, 2015-06-16T18% 3a53% 3a11% 2b00% 3a00Z, где двоеточие, экранируется % 3a и плюс, экранируется % 2b, чтобы оно было понятное URI. |
| *reportedEndTime* |Время окончания запроса. Ограничения, которые применяются к *reportedStartTime* также применяются для данного аргумента. Значение для *reportedEndTime* не может быть в будущем или текущей даты. Если это так, результат имеет значение «обработка не полный.» |
| *aggregationGranularity* |Необязательный параметр, который имеет два дискретных возможные значения: дням или часам. Как предложить значения, один возвращает данные в дням, а другой — почасовой разрешения. Ежедневный вариант используется по умолчанию. |
| *subscriberId* |Идентификатор подписки. Чтобы получить отфильтрованных данных, требуется идентификатор подписки прямой клиента поставщика. Если задано ни одного параметра идентификатор подписки, вызов возвращает данные об использовании для прямых клиентов поставщика. |
| *версия API* |Версия протокола, используемого для выполнения этого запроса. Это значение 2015-06-01-preview. |
| *continuationToken* |Маркер извлекается из последнего вызова API использования поставщика. Этот токен необходим в том случае, когда ответ больше 1 000 строк, и он действует в качестве закладки для хода выполнения. Если он отсутствует, данные извлекаются с самого начала дня или переданный часа, в зависимости от гранулярности. |

### <a name="response"></a>Ответ
ПОЛУЧИТЬ /subscriptions/sub1/providers/Microsoft.Commerce/subscriberUsageAggregates?reportedStartTime=reportedStartTime=2014-05-01T00%3a00%3a00%2b00%3a00 & reportedEndTime = 2015-06-01T00% 3a00% 3a00% 2b00% 3a00 & aggregationGranularity = ежедневно & subscriberId = sub1.1 & api-version = 1,0

{

«значение»:\[

{

«Идентификатор»: «/subscriptions/sub1.1/providers/Microsoft.Commerce/UsageAggregate/sub1.1-

meterID1»,

«Имя»: «sub1.1-meterID1»

«Тип»: «Microsoft.Commerce/UsageAggregate»

"properties": {

«subscriptionId»: «sub1.1»

«usageStartTime»: «2015-03-03T00:00:00 + 00:00»,

«usageEndTime»: «2015-03-04T00:00:00 + 00:00»,

«instanceData»: «{\\» Microsoft.Resources\\«: {\\» resourceUri\\»:\\» resourceUri1\\»,\\«местоположение\\

«:\\«Аляска\\»,\\«теги\\»: имеет значение null,\\» additionalInfo\\«: null}}»,

:2.4000000000 «quantity»

«meterId»: «meterID1»

}

},

…

### <a name="response-details"></a>Сведения об ответе
| **Аргумент** | **Описание** |
| --- | --- |
| *id* |Уникальный идентификатор использования статистической функции |
| *name* |Имя агрегатной функции использования |
| *type* |Определение ресурсов |
| *subscriptionId* |Идентификатор подписки Azure стека пользователя |
| *usageStartTime* |Время использования сегмента, к которому принадлежит это статистическое выражение использования начала UTC |
| *usageEndTime* |В формате UTC окончания использования сегмента, к которому принадлежит это статистическое выражение использования |
| *instanceData* |Подробные сведения об экземпляре (в новом формате) пар ключ значение:<br> *resourceUri*: полный идентификатор ресурса, включая группы ресурсов и имя экземпляра <br> *расположение*: область, в котором эта служба была запущена <br> *теги*: теги ресурсов, указанных пользователем <br> *additionalInfo*: более подробные сведения о ресурсе, которое было получено, например, тип версии или образа ОС |
| *количество* |Объем потребления ресурсов, возникшее в этот промежуток времени |
| *meterId* |Уникальный идентификатор ресурса, которое было получено (также называемый *ResourceID*) |

## <a name="next-steps"></a>Дальнейшие действия
[Использование ресурсов клиента Справочник по API](azure-stack-tenant-resource-usage-api.md)

[Часто задаваемые вопросы, относящиеся к использованию](azure-stack-usage-related-faq.md)

