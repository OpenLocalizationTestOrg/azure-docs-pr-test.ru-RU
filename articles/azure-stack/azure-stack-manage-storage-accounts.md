---
title: "Управление учетными записями хранилища Azure стек | Документы Microsoft"
description: "Узнайте, как найти, управление, восстановление и освободить учетных записей хранилища Azure стека"
services: azure-stack
documentationcenter: 
author: AniAnirudh
manager: darmour
editor: 
ms.assetid: 627d355b-4812-45cb-bc1e-ce62476dab34
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 4/6/2017
ms.author: anirudha
ms.openlocfilehash: 6e14bd6312135b45984a82099e68a934ec2a4a70
ms.sourcegitcommit: 90e2cced6a773b1b52f999ba73cd8877305d270b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="manage-storage-accounts-in-azure-stack"></a>Управление учетными записями хранения в стек Azure
Узнайте, как управлять учетными записями хранилища Azure стека для поиска, восстановление и освобождения пространства хранения, исходя из потребностей бизнеса.

## <a name="find"></a>Найти учетную запись хранения
Можно просмотреть список учетных записей хранения в регионе в Azure стека с помощью:

1. В веб-браузер перейдите к https://adminportal.local.azurestack.external.
2. Войдите на портал администрирования стек Azure как оператор облака (с использованием учетных данных, предоставленные во время развертывания)
3. Найдите на панели мониторинга по умолчанию — **область управления** списке и нажмите кнопку область, необходимо просмотреть. Например **(локальный**).
   
   ![](media/azure-stack-manage-storage-accounts/image1.png)
4. Выберите **хранения** из **поставщиков ресурсов** списка.
   
   ![](media/azure-stack-manage-storage-accounts/image2.png)
5. Теперь, в колонке администратора поставщика ресурсов хранилища – прокрутите вниз до **учетные записи хранения** и щелкните его.
   
   ![](media/azure-stack-manage-storage-accounts/image3.png)
   
   Страницы приведен список учетных записей хранения в этом регионе.
   
   ![](media/azure-stack-manage-storage-accounts/image4.png)

По умолчанию отображаются первые 10 учетных записей. Вы можете получить более, щелкнув **дополнительной загрузки** ссылку в нижней части списка.

ИЛИ

Если вы заинтересованы в определенной учетной записи хранения — вы можете **фильтрации и получения соответствующих учетных записей** только.


**Для фильтрации для учетных записей:**

1. Нажмите кнопку **фильтра** в верхней части колонки.
2. В колонке фильтр, он позволяет указать **имя учетной записи**, **идентификатор подписки** или **состояние** для точной настройки в списке учетных записей хранилища для отображения. Используйте их соответствующим образом.
3. Нажмите кнопку **Обновить**. Список следует обновить соответствующим образом.
   
    ![](media/azure-stack-manage-storage-accounts/image5.png)
4. Чтобы сбросить фильтр: щелкните **фильтра**, очистить выбранные элементы и обновлять.

Поле поиска (в верхней части колонки список учетных записей хранилища) позволяет выделить тексту, выбранному в списке учетных записей. Это очень удобно в случае, если полное имя или идентификатор легко недоступен.

Произвольный текст здесь можно использовать для поиска учетной записи, которые вас интересуют.

![](media/azure-stack-manage-storage-accounts/image6.png)

## <a name="look-at-account-details"></a>Просмотрите сведения об учетной записи
После того как вы нашли учетные записи, которые вас интересуют просмотра, можно щелкнуть определенной учетной записи для просмотра определенных сведений. Открывается новая колонка с учетные данные, такие как: тип учетной записи, время создания, расположение и т. д.

![](media/azure-stack-manage-storage-accounts/image7.png)

## <a name="recover-a-deleted-account"></a>Восстановление удаленной учетной записи
Возможно, в ситуации, когда необходимо для восстановления удаленной учетной записи.

В стеке Azure есть очень простой способ сделать это:

1. Перейдите к списку учетных записей хранилища. В разделе [найти учетную запись хранения](#find) в этом разделе для получения дополнительной информации.
2. Найдите этой конкретной учетной записи в списке. Необходимо фильтровать.
3. Проверьте *состояние* учетной записи. Должно быть указано **Deleted**.
4. Выберите учетную запись, которая открывает колонку сведения об учетной записи.
5. На основе этой колонки найдите **восстановить** кнопку и щелкните его.
6. Нажмите кнопку **Да** для подтверждения.
   
   ![](media/azure-stack-manage-storage-accounts/image8.png)
7. Восстановления находится в *обработать... Подождите* для указывает на то, что она выполнена успешно.
   Также можно щелкнуть значок «колокольчика» в верхней части портала, чтобы просмотреть ход выполнения указаний.
   
   ![](media/azure-stack-manage-storage-accounts/image9.png)
   
   После восстановленной учетная запись успешно синхронизирован, он может использоваться повторно.

### <a name="some-gotchas"></a>Некоторые проблемы
* Учетной записи удаленных отобразится состояние в качестве **за пределы хранения**.
  
  Это означает, что срок хранения превысил удаленной учетной записи и не может быть восстановлен.
* На удаленной учетной записи не отображается в списке учетных записей.
  
  Это может означать, что удаленная учетная запись уже была сбора мусора. В этом случае его будет невозможно. В разделе [освобождения пространства](#reclaim) в этом разделе.

## <a name="set-the-retention-period"></a>Установить срок хранения
Настройка срока хранения позволяет оператор облака указать период времени в дней (от 0 до 9999 дней), в течение которых любой удаленной учетной записи потенциально могут быть восстановлены. Срок хранения по умолчанию равно 15 дней. При установке значения «0» означает, что любой удаленной учетной записи немедленно выходит за хранение и помеченных для периодическую сборку мусора.

**Чтобы изменить срок хранения:**

1. В веб-браузер перейдите к https://adminportal.local.azurestack.external.
2. Войдите на портал администрирования стек Azure как оператор облака (с использованием учетных данных, предоставленные во время развертывания)
3. Найдите на панели мониторинга по умолчанию — **область управления** списке и нажмите кнопку область, необходимо изучить — например **(локальный**).
4. Выберите **хранения** из **поставщиков ресурсов** списка.
5. Нажмите кнопку **параметры** вверху, чтобы открыть колонку параметров.
6. Нажмите кнопку **конфигурации** затем измените значения срока хранения.

   Задайте количество дней, а затем сохраните его.
   
   Это значение немедленно и задать для всего региона.

   ![](media/azure-stack-manage-storage-accounts/image10.png)

## <a name="reclaim"></a>Освобождения пространства
Одним из побочных эффектов наличия срок хранения является удаленной учетной записи продолжает потребления мощностей, пока они поступают из срока хранения. Как оператор облако может потребоваться возможность освободить место удаленной учетной записи, даже если еще не истек срок хранения.

Можно освободить с помощью PowerShell или портала емкости.

**Для освобождения пространства с помощью портала:**
1. Перейдите к колонке учетные записи хранения. В разделе [найти учетную запись хранения](#find).
2. Нажмите кнопку **освобождения пространства** в верхней части колонки.
3. Прочтите сообщение и нажмите кнопку **ОК**.

    ![](media/azure-stack-manage-storage-accounts/image11.png)
4. Дождитесь, пока уведомление об успехе см. в разделе значок колокольчика на портале.

    ![](media/azure-stack-manage-storage-accounts/image12.png)
5. Обновите страницу учетных записей хранилища. Удаленные учетные записи больше не отображаются в списке, так как они были удалены.

Можно также использовать PowerShell явно переопределить срок хранения и немедленно освобождения пространства.

**Для освобождения пространства с помощью PowerShell:**   

1. Убедитесь, что Azure PowerShell установлен и настроен. Если нет, выполните следующие действия: 
   * Чтобы установить последнюю версию Azure PowerShell и связать ее с подпиской Azure, в разделе [описывается установка и настройка Azure PowerShell](http://azure.microsoft.com/documentation/articles/powershell-install-configure/).
   Дополнительные сведения о командлетах Azure Resource Manager см. в разделе [с помощью Azure PowerShell с помощью диспетчера ресурсов Azure](http://go.microsoft.com/fwlink/?LinkId=394767)
2. Выполните следующий командлет:

> [!NOTE]
> При выполнении этого командлета можно удалить без возможности восстановления учетной записи и ее содержимое. Восстановить его будет невозможно. Это следует используйте с осторожностью.


        Clear-ACSStorageAccount -ResourceGroupName system.local -FarmName <farm ID>


Дополнительные сведения см. в [документации стек Azure powershell.](https://msdn.microsoft.com/library/mt637964.aspx)
 

## <a name="migrate-a-container"></a>Перенос контейнера
Из-за неравномерной хранилища, используемые клиентами оператор облако может найти один или более базовых клиента общих папок с помощью больше места, чем другие. В этом случае оператор облака можно попытаться Освободите место на этом ресурсе нагрузкой путем миграции некоторых контейнеров больших двоичных объектов еще одну общую папку вручную. 

Необходимо использовать PowerShell для миграции контейнеров.
> [!NOTE]
>Миграция контейнер больших двоичных объектов не поддерживает динамическую миграцию и в настоящее время является операцией вне сети. Во время миграции и до завершения базового BLOB-объектов в этот контейнер не может использоваться и «вне сети». 

**Чтобы перенести контейнеры с помощью PowerShell:**

1. Убедитесь, что Azure PowerShell установлен и настроен. Если нет, выполните следующие действия:
    * Чтобы установить последнюю версию Azure PowerShell и связать ее с подпиской Azure, в разделе [описывается установка и настройка Azure PowerShell](http://azure.microsoft.com/documentation/articles/powershell-install-configure/). Дополнительные сведения о командлетах Azure Resource Manager см. в разделе [с помощью Azure PowerShell с помощью диспетчера ресурсов Azure](http://go.microsoft.com/fwlink/?LinkId=394767)
2. Получите имя фермы: 
      
      `$farm = Get-ACSFarm -ResourceGroupName system.local`
3. Получение общих папок: 

   `$shares = Get-ACSShare -ResourceGroupName system.local -FarmName $farm.FarmName`

4. Получите контейнеры для одного общего ресурса. Обратите внимание, что количество и намерением необязательные параметры:
            
   `$containers = Get-ACSContainer -ResourceGroupName system.local -FarmName $farm.FarmName -ShareName $shares[0].ShareName -Count 4 -Intent Migration`  

   Затем проверьте $containers:

   `$containers`

    ![](media/azure-stack-manage-storage-accounts/image13.png)
5. Получите наиболее общие папки назначения для миграции контейнера:

    `$destinationshares= Get-ACSSharesForMigration  -ResourceGroupName system.local -FarmName $farm.farmname -SourceShareName $shares[0].ShareName`

    Затем проверьте $destinationshares:

    `$destinationshares`

    ![](media/azure-stack-manage-storage-accounts/image14.png)
6. Начнем миграции для контейнера, обратите внимание, что это реализацию async, поэтому один цикл все контейнеры в общей папке и отслеживать состояние с помощью идентификатора возвращенные задания.

    `$jobId = Start-ACSContainerMigration -ResourceGroupName system.local -FarmName $farm.farmname -ContainerToMigrate $containers[1] -DestinationShareUncPath $destinationshares.UncPath`

    Затем проверьте $jobId:

   ```
   $jobId
   d1d5277f-6b8d-4923-9db3-8bb00fa61b65
   ```
7. Проверьте состояние задания миграции по идентификатору задания. По завершении миграции контейнера MigrationStatus имеет значение «Completed».

    `Get-ACSContainerMigrationStatus -ResourceGroupName system.local -FarmName $farm.farmname -JobId $jobId`

    ![](media/azure-stack-manage-storage-accounts/image15.png)

8. Вы можете отменить задание миграции в процессе выполнения. Это является асинхронной операцией и могут отслеживаться с помощью $jobid еще раз:

    `Stop-ACSContainerMigration-ResourceGroupName system.local -FarmName $farm.farmname -JobId $jobId-Verbose`

    ![](media/azure-stack-manage-storage-accounts/image16.png)

    Можно проверить состояние отмены миграции еще раз:

    `Get-ACSContainerMigrationStatus-ResourceGroupName system.local -FarmName $farm.farmname -JobId $jobId`

    ![](media/azure-stack-manage-storage-accounts/image17.png)




  
  