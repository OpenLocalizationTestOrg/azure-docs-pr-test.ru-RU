---
title: "Обновления схемы от 1 июня 2016 г. Azure Logic Apps | Документация Майкрософт"
description: "Создание определений JSON для Azure Logic Apps с версией схемы 2016-06-01"
author: jeffhollan
manager: anneta
editor: 
services: logic-apps
documentationcenter: 
ms.assetid: 349d57e8-f62b-4ec6-a92f-a6e0242d6c0e
ms.service: logic-apps
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.custom: H1Hack27Feb2017
ms.date: 07/25/2016
ms.author: LADocs; jehollan
ms.openlocfilehash: 43df04d6478e44c82c88b17d916cfc9fe4afc03e
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="schema-updates-for-azure-logic-apps---june-1-2016"></a>Обновления схемы для Azure Logic Apps от 1 июня 2016 г.

Эта новая версия схемы и API для Azure Logic Apps включает основные улучшения, которые повышают надежность и простоту использования приложений логики.

* [Области](#scopes) позволяют группировать или вкладывать действия в виде набора действий.
* [Условия и циклы](#conditions-loops) — это действия первого класса.
* Более точный порядок выполняющихся действий со свойством `runAfter` вместо `dependsOn`.

Сведения об обновлении приложений логики с предварительной версии схемы от 1 августа 2015 г. до схемы от 1 июня 2016 г. см. в [соответствующем разделе](##upgrade-your-schema).

<a name="scopes"></a>
## <a name="scopes"></a>Области действия

Эта схема включает области, позволяющие группировать несколько действий или вложить одно действие в другое. Например, одно условие может содержать в себе другое условие. Узнайте больше о [синтаксисе областей](../logic-apps/logic-apps-loops-and-scopes.md) или просмотрите базовый пример области, приведенный ниже.

```
{
    "actions": {
        "My_Scope": {
            "type": "scope",
            "actions": {                
                "Http": {
                    "inputs": {
                        "method": "GET",
                        "uri": "http://www.bing.com"
                    },
                    "runAfter": {},
                    "type": "Http"
                }
            }
        }
    }
}
```

<a name="conditions-loops"></a>
## <a name="conditions-and-loops-changes"></a>Изменения в условиях и циклах

В предыдущих версиях схемы условия и циклы были параметрами, связанными с каким-то одним действием. В этой схеме отсутствует такое ограничение, поэтому условия и циклы теперь отображаются как типы действий. Узнайте больше о [циклах и областях](../logic-apps/logic-apps-loops-and-scopes.md) или просмотрите этот базовый пример условия:

```
{
    "If_trigger_is_some-trigger": {
        "type": "If",
        "expression": "@equals(triggerBody(), 'some-trigger')",
        "runAfter": { },
        "actions": {
            "Http_2": {
                "inputs": {
                    "method": "GET",
                    "uri": "http://www.bing.com"
                },
                "runAfter": {},
                "type": "Http"
            }
        },
        "else": 
        {
            "if_trigger_is_another-trigger": "..."
        }      
    }
}
```

<a name="run-after"></a>
## <a name="runafter-property"></a>Свойство runAfter

Свойство `runAfter` заменяет свойство `dependsOn`, обеспечивая более точный порядок выполнения действий на основе состояния предыдущих действий.

Свойство `dependsOn` означало "действие запущено и успешно выполнено" независимо от того, сколько раз нужно выполнить действие и каким было завершение предыдущего действия: успешным, неудавшимся или пропущенным. Свойство `runAfter` обеспечивает нужную гибкость в виде объекта, который указывает все имена действий, а затем выполняется. Оно также определяет массив состояний, которые можно использовать в качестве триггеров. Например, если вы хотите выполнить активацию после успешного завершения действия A и успешного завершения или сбоя действия B, требуется такое свойство `runAfter`:

```
{
    "...",
    "runAfter": {
        "A": ["Succeeded"],
        "B": ["Succeeded", "Failed"]
    }
}
```

## <a name="upgrade-your-schema"></a>Обновление схемы

Выполнить обновление схемы до новой версии очень просто. Вот что входит в процесс обновления: запуск скрипта обновления, сохранение в качестве нового приложения логики и, если нужно, перезапись предыдущего приложения логики.

1. Откройте приложение логики на портале Azure.

2. Перейдите на вкладку **Обзор**. На панели инструментов приложения логики выберите **Обновить схему**.
   
    ![Выбор параметра "Обновить схему"][1]
   
    Обновленное определение возвращается. При необходимости его можно скопировать и вставить в определение ресурса. 
    Однако мы **настоятельно рекомендуем** нажать кнопку **Сохранить как**, чтобы в обновленном приложении логики все ссылки на подключение были рабочими.

3. Нажмите кнопку **Сохранить как** на панели инструментов колонки обновления.

4. Введите имя и состояние логики. Чтобы развернуть обновленное приложение логики, выберите **Создать**.

5. Убедитесь, что обновленное приложение логики работает правильно.
   
   > [!NOTE]
   > Если вы используете триггер запуска вручную или триггер запроса, в новом приложении логики URL-адрес обратного вызова будет новым. Проверьте новый URL-адрес, чтобы убедиться, что приложение работает полноценно. Вы можете клонировать имеющееся приложение логики, чтобы сохранить предыдущие URL-адреса.

6. *Необязательно.* Чтобы перезаписать предыдущее приложение логики, заменив его новой версией схемы, щелкните **Клонировать** на панели инструментов возле значка **Обновить схему**. Этот шаг необходим, только если нужно сохранить код ресурса или URL-адрес триггера запроса вашего приложения логики.

### <a name="upgrade-tool-notes"></a>Примечания о средстве обновления

#### <a name="mapping-conditions"></a>Условия сопоставления

В обновленном определении это средство в качестве области максимально эффективно собирает вместе действия ветвления true и false. В частности, шаблон конструктора `@equals(actions('a').status, 'Skipped')` должен отображаться как действие `else`. Но если средство обнаруживает нераспознаваемые шаблоны, оно создает отдельные условия для ветвей true и false. При необходимости можно сопоставить действия после обновления.

#### <a name="foreach-loop-with-condition"></a>Цикл foreach с условием

В новой схеме можно использовать действие фильтра для репликации шаблона цикла `foreach` с одним условием на элемент, но в то же время это изменение должно автоматически выполняться при обновлении. Условие становится действием фильтра до запуска цикла foreach, чтобы вернулся только массив элементов, которые соответствуют условию. Этот массив передается в действие foreach. Пример см. в статье [Циклы, области действия и индивидуальная обработка приложений логики](../logic-apps/logic-apps-loops-and-scopes.md).

#### <a name="resource-tags"></a>Теги ресурсов

После обновления теги ресурсов удаляются, поэтому их нужно сбросить для обновленного рабочего процесса.

## <a name="other-changes"></a>Другие изменения

### <a name="renamed-manual-trigger-to-request-trigger"></a>Переименование триггера запуска вручную на триггер запроса

Тип триггера `manual` устарел, поэтому он переименован на `request` с типом `http`. Это изменение лучше соответствует типу шаблона, для построения которого используется триггер.

### <a name="new-filter-action"></a>Новое действие "фильтр"

Для фильтрации большого массива в меньший набор элементов новый тип `filter` принимает массив и условие, оценивает соответствие каждого элемента условию и возвращает только те элементы, которые соответствуют условию.

### <a name="restrictions-for-foreach-and-until-actions"></a>Ограничения действий foreach и until

Циклы `foreach` и `until` ограничены одним действием.

### <a name="new-trackedproperties-for-actions"></a>Новое свойство trackedProperties для действий

Теперь у действий может быть дополнительное свойство (элемент того же уровня, что и `runAfter` и `type`) с именем `trackedProperties`. Этот объект указывает, что некоторые выходные или входные данные действия нужно включить в телеметрию службы диагностики Azure. Эта телеметрия отправляется в рамках рабочего процесса. Например:

```
{                
    "Http": {
        "inputs": {
            "method": "GET",
            "uri": "http://www.bing.com"
        },
        "runAfter": {},
        "type": "Http",
        "trackedProperties": {
            "responseCode": "@action().outputs.statusCode",
            "uri": "@action().inputs.uri"
        }
    }
}
```

## <a name="next-steps"></a>Дальнейшие действия
* [Создание определений приложений логики](../logic-apps/logic-apps-author-definitions.md)
* [Создание шаблона развертывания приложения логики](../logic-apps/logic-apps-create-deploy-template.md)

<!-- Image references -->
[1]: ./media/logic-apps-schema-2016-04-01/upgradeButton.png
