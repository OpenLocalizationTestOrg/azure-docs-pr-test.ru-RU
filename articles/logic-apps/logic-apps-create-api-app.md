---
title: "aaaCreate web API-интерфейсов и API-интерфейс REST соединителей - приложения логики Azure | Документы Microsoft"
description: "Создание toocall web API-интерфейсов и API-интерфейс REST ваш API-интерфейсы, службы или системы в рабочих процессах для системы интеграции с приложениями логики Azure"
keywords: "веб-интерфейсы API, интерфейсы REST API, соединители, рабочие процессы, интеграция систем"
services: logic-apps
author: jeffhollan
manager: anneta
editor: 
documentationcenter: 
ms.assetid: bd229179-7199-4aab-bae0-1baf072c7659
ms.service: logic-apps
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 5/26/2017
ms.author: LADocs; jehollan
ms.openlocfilehash: 2792204d1d298a6f810e75211c1789ee204c2fdf
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="create-custom-apis-as-connectors-for-logic-apps"></a>Создание пользовательских API в качестве соединителей для приложений логики

Несмотря на то, что приложения логики Azure предлагает [100 + встроенные соединители](../connectors/apis-list.md) можно использовать в рабочих процессах логики приложения, может потребоваться toocall API, в системах, и службы, которые не доступны в качестве соединители. Можно создать собственные пользовательские API, которые предоставляют toouse действий и триггеров в приложениях для логики. Ниже приведены другие причины, почему может потребоваться toocreate собственных API используют слишком соединителей в приложениях для логики:

* Расширение текущих рабочих процессов интеграции систем и данных.
* Помочь пользователям использовать службы toomanage профессиональных или личных задач.
* Разверните hello reach, возможность обнаружения и использования для службы.

По сути, соединители — это веб-интерфейсы API, использующие REST для модульных интерфейсов, [формат метаданных Swagger](http://swagger.io/specification/) для документации и формат JSON для обмена данными. Соединители являются интерфейсами REST API, которые обмениваются данными через конечные точки HTTP, и для их создания можно использовать любой язык, например .NET, Java или Node.js. Вы также можете разместить собственные интерфейсы API на [службе приложений Azure](../app-service/app-service-value-prop-what-is.md), платформа как услуги (PaaS), предоставляющий одним из способов наиболее простым и максимально масштабируемые hello для API размещения. 

Для пользовательских интерфейсов API toowork с приложениями логики, можно предоставить API [ *действия* ](./logic-apps-what-are-logic-apps.md#logic-app-concepts) , выполнять определенные задачи в рабочих процессах логику приложения. Кроме того, API может действовать как [*триггер*](./logic-apps-what-are-logic-apps.md#logic-app-concepts), запускающий рабочий процесс приложения логики, если новые данные или событие соответствует заданному условию. В этом разделе описаны общие шаблоны, которые необходимо выполнить для создания действий и триггеров в ваш API на основе поведения hello, которые должны tooprovide ваш API.

> [!TIP] 
> Несмотря на то, что вы можете развернуть интерфейсы API, как [веб-приложений](../app-service-web/app-service-web-overview.md), следует рассмотреть возможность развертывания интерфейсы API, как [приложения API](../app-service-api/app-service-api-apps-why-best-platform.md), который может облегчить вашу работу при построении, размещения и использовать интерфейсы API в облаке hello и на локальном компьютере. Не нужно toochange любого кода в собственные интерфейсы API — просто развертывания приложения API tooan кода. Узнайте, каким образом слишком [построения API приложений, созданных с помощью ASP.NET](../app-service-api/app-service-api-dotnet-get-started.md), [Java](../app-service-api/app-service-api-java-api-app.md), или [Node.js](../app-service-api/app-service-api-nodejs-api-app.md). 
>
> Примеры API приложений, созданных для логики приложений, на сайте hello [репозитории GitHub приложения логики Azure](http://github.com/logicappsio) или [блог](http://aka.ms/logicappsblog).

## <a name="helpful-tools"></a>Полезные инструменты

Пользовательский API лучше всего работает с приложениями логики при hello API также имеет [Swagger документа](http://swagger.io/specification/) , описывающий операции hello API-Интерфейсы и параметры.
Многие библиотеки, например [Swashbuckle](https://github.com/domaindrivendev/Swashbuckle), можно автоматически создать файл Swagger hello для вас. файл Swagger tooannotate hello для отображаемые имена, типы свойств и так далее, можно также использовать [TRex](https://github.com/nihaue/TRex) , чтобы файла Swagger хорошо работает с логикой приложения.

<a name="actions"></a>

## <a name="action-patterns"></a>Модели действий

Для выполнения задач tooperform логику приложения, должен предоставить настраиваемого API [ *действия*](./logic-apps-what-are-logic-apps.md#logic-app-concepts). Каждой операции в API сопоставляет tooan действие. Базовое действие — это контроллер, который принимает запросы HTTP и возвращает ответы HTTP. Например приложение логики отправляет HTTP запроса tooyour веб-приложения или приложения API. Приложение возвращает HTTP-ответа, вместе с содержимым, hello логика может обрабатывать приложение.

Для стандартных действий можно написать метод HTTP-запроса в API и описать этот метод в файле Swagger. Затем можно напрямую вызвать API при помощи [действия HTTP](../connectors/connectors-native-http.md) или [HTTP + Swagger](../connectors/connectors-native-http-swagger.md). По умолчанию ответы должны возвращаться в hello [предельное время ожидания запроса](./logic-apps-limits-and-config.md). 

![Модель стандартного действия](./media/logic-apps-create-api-app/standard-action.png)

<a name="pattern-overview"></a>toomake приложения логики, подождите, пока API завершения больше времени, выполняемых задач, API можно выполнить hello [шаблон асинхронной опроса](#async-pattern) или hello [шаблон асинхронной веб-перехватчика](#webhook-actions) описанные в этом разделе. Для аналогией, позволяет визуализировать эти шаблоны различные виды поведения Представьте себе упорядочение пользовательских Пирожное из bakery процесс hello. шаблон опроса Hello отражает поведение hello вызова hello bakery каждые 20 минут toocheck ли Пирожное hello готов. шаблон веб-перехватчика Hello отражает поведение hello, где hello bakery предложит вам ввести свой номер телефона, они могут вызывать вы при готовности Пирожное hello.

Образцы, посетите hello [репозитории GitHub логику приложения](https://github.com/logicappsio). А также узнайте больше о [метриках использования для действий](logic-apps-pricing.md).

<a name="async-pattern"></a>

### <a name="perform-long-running-tasks-with-hello-polling-action-pattern"></a>Выполнять длительные задачи с помощью hello опроса шаблон действия

API выполнять задачи, которые могут выполняться дольше, чем hello toohave [предельное время ожидания запроса](./logic-apps-limits-and-config.md), можно использовать шаблон асинхронных опроса hello. Этот шаблон имеет вашей API работать в отдельном потоке, но сохранить обработчик Logic Apps toohello активное соединение. Таким образом, приложение hello логику время ожидания не истекает или продолжайте, воспользовавшись hello следующий шаг в рабочем процессе hello API после окончания работы.

Вот общий шаблон hello.

1. Убедитесь, что этот обработчик hello знает, что API принял запрос hello и начал работу.
2. Когда обработчик hello делает последующие запросы на состояние задания, позволяют engine hello узнавать, когда API завершает задачу hello.
3. Возвращать engine toohello важные данные, что продолжения рабочего процесса приложения логики hello.

<a name="bakery-polling-action"></a>Теперь применить предыдущий шаблон опроса toohello bakery аналогию hello и представьте, что вы вызывать bakery и порядок пользовательских Пирожное для доставки. процесс создания Пирожное hello Hello занимает время, а вы не хотите toowait на телефоне hello hello bakery работает на Пирожное hello. Hello bakery подтверждает ваш заказ, а также имеет возможность вызывать каждые 20 минут для hello Пирожное состояния. После передачи 20 минут, вызовите hello bakery, но они видно, что ваш Пирожное не выполняется и что следует вызывать в другом 20 минут. Этот процесс вперед и назад продолжается, пока не вызывается и hello bakery означает, что ваш заказ готов, а доставляет вашей Пирожное. 

А теперь рассмотрим модель опроса. Hello bakery представляет настраиваемого API, тогда как вы клиента Пирожное hello, представляют собой механизм логики приложения hello. При вызове подсистемой hello API с помощью запроса, API подтверждает запрос hello и реакцию с hello интервал времени, hello engine можно проверить состояние задания. Обработчик Hello продолжается, проверки состояния задания, пока не ответит API, сделать это задание hello и возвращает данные tooyour логику приложение, которое затем продолжает операции рабочего процесса. 

![Модель действия опроса](./media/logic-apps-create-api-app/custom-api-async-action-pattern.png)

Ниже приведены конкретные действия hello по вашей toofollow API, описанных с точки зрения hello API-интерфейса.

1. Если API возвращает HTTP запроса toostart работы, немедленно вернуться HTTP `202 ACCEPTED` ответ с hello `location` заголовок, описанные далее в этом шаге. Этот ответ позволяет hello Logic Apps engine знать, что есть API hello запроса, принятые hello запрос полезных данных входных данных, а теперь обработки. 
   
   Hello `202 ACCEPTED` ответ должен содержать следующие заголовки:
   
   * *Требуется*: A `location` заголовок, который указывает URL tooa hello абсолютный путь, где hello Logic Apps engine можно проверить состояние задания интерфейса API

   * *Необязательный*: A `retry-after` заголовок, который указывает hello количество секунд, которые hello engine будет ожидать перед проверкой hello `location` URL-адрес для состояния задания. 

     По умолчанию hello ядро проверяет каждые 20 секунд. toospecify другой интервал включают hello `retry-after` заголовок и hello число секунд, пока следующий опрос hello.

2. После hello указанного времени, логика приложения hello ядра hello опрашивает `location` состояние задания toocheck URL-адрес. После этих проверок из API должны поступать следующие ответы:
   
   * Если выполнена hello возвращают HTTP `200 OK` ответ, а также полезные данные ответа hello (входные данные для hello следующий шаг).

   * Если по-прежнему обрабатывается задание hello, возвращают другой HTTP `202 ACCEPTED` ответа, но с hello же заголовки как исходное ответ hello.

При API соответствует данному шаблону, не нужно toodo ничего в hello логику приложения рабочего процесса определения toocontinue проверке состояния задания. Когда hello получает HTTP `202 ACCEPTED` ответа и является допустимым `location` заголовок, hello engine отношениях hello асинхронный шаблон и проверяет hello `location` заголовок до API возвращает ответ не 202.

> [!TIP]
> Ознакомьтесь с примером асинхронной модели в этом [образце ответа асинхронного контроллера в GitHub](https://github.com/logicappsio/LogicAppsAsyncResponseSample).

<a name="webhook-actions"></a>

### <a name="perform-long-running-tasks-with-hello-webhook-action-pattern"></a>Выполнять длительные задачи с шаблоном действие hello веб-перехватчика

В качестве альтернативы можно использовать шаблон веб-перехватчика hello длительно выполняемых задач и асинхронной обработки. Этот шаблон имеет приложение hello логику приостановить и дождаться «callback» из вашей toofinish API обработки для продолжения рабочего процесса. Этот обратный вызов выполняется HTTP POST, отправляет сообщения tooa URL-адрес, когда происходит событие. 

<a name="bakery-webhook-action"></a>Теперь применение hello предыдущих bakery аналогию toohello веб-перехватчика шаблона и представьте, что вы вызывать bakery и порядок пользовательских Пирожное для доставки. процесс создания Пирожное hello Hello занимает время, а вы не хотите toowait на телефоне hello hello bakery работает на Пирожное hello. Hello bakery подтверждения заказа, но на этот раз вы даете им ваш номер телефона, они могут вызывать при завершении Пирожное hello. На этот раз hello bakery сообщает при ваш заказ готов и доставляет вашей Пирожное.

Если мы сопоставим эту модель веб-перехватчика обратно, hello bakery представляет настраиваемого API, вы, hello Пирожное клиента, представляют Привет Logic Apps ядра. ядро Hello вызывает API, с помощью запроса и включает URL-адрес «callback».
По завершении задания hello API использует механизм hello toonotify URL-адрес hello и возвращать данные tooyour логику приложение, которое затем продолжает операции рабочего процесса. 

Для этой модели настройте на контроллере две конечные точки: `subscribe` и`unsubscribe`

*  `subscribe`Конечная точка: модуль, когда выполнение достигает интерфейса API действия в рабочем процессе hello, hello логику приложения hello вызовов `subscribe` конечной точки. В результате этого действия hello логику приложения toocreate URL-адрес обратного вызова содержит API, которое затем ожидания hello обратного вызова из API, когда работа будет завершена. API, затем выполняет обратный вызов toohello URL-адрес HTTP POST и передает любого полученного содержимого и заголовки в качестве входного toohello логику приложения.

* `unsubscribe`Конечная точка: при отмене запуска приложений логики hello hello Logic Apps ядра hello вызовов `unsubscribe` конечной точки. API можно отменить регистрацию URL-адрес обратного вызова hello и остановите все процессы при необходимости.

![Модель действия веб-перехватчика](./media/logic-apps-create-api-app/custom-api-webhook-action-pattern.png)

> [!NOTE]
> В настоящее время конструктор логику приложения hello не поддерживает обнаружение конечных точек веб-перехватчика через Swagger. Поэтому для этого шаблона имеют tooadd [ **веб-перехватчика** действия](../connectors/connectors-native-webhook.md) и укажите URL-адрес hello, заголовки и текст для запроса. Также см. раздел [Действия и триггеры рабочего процесса](logic-apps-workflow-actions-triggers.md#api-connection-webhook-action). toopass в URL-адрес обратного вызова hello использовать hello `@listCallbackUrl()` функции рабочего процесса в любой из предыдущих полей hello при необходимости.

> [!TIP]
> Пример модели веб-перехватчика см. в [образце триггера веб-перехватчика в GitHub](https://github.com/logicappsio/LogicAppTriggersExample/blob/master/LogicAppTriggers/Controllers/WebhookTriggerController.cs).

<a name="triggers"></a>

## <a name="trigger-patterns"></a>Модели триггеров

Пользовательский API может действовать как [*триггер*](./logic-apps-what-are-logic-apps.md#logic-app-concepts), запускающий приложение логики, если новые данные или событие соответствует заданному условию. Этот триггер может как выполнять регулярную проверку, так и ожидать передачи новых данных или информации о событиях в конечной точке службы. Если новые данные или событие соответствует Здравствуйте указанному условию, hello триггер срабатывает и запускает логику приложение hello, которое прослушивает toothat триггер. приложения логики toostart таким образом, API можно выполнить hello [ *триггер опроса* ](#polling-triggers) или hello [ *веб-перехватчика триггер* ](#webhook-triggers) шаблон. Эти шаблоны являются аналогичные tootheir для [опроса действия](#async-pattern) и [действия веб-перехватчика](#webhook-actions). См. дополнительные сведения о [метриках использования для триггеров](logic-apps-pricing.md).

<a name="polling-triggers"></a>

### <a name="check-for-new-data-or-events-regularly-with-hello-polling-trigger-pattern"></a>Регулярно проверять наличие новых данных или событий с hello опроса шаблон триггера

Объект *триггер опроса* действует аналогично hello [опроса действие](#async-pattern) описанный ранее в этом разделе. механизм логики приложения Hello периодически вызывает и проверяет конечную точку триггер hello для новых данных или событий. Если обработчик hello находит новые данные или события, указанным условиям, срабатывает триггер hello. Затем обработчик hello создает экземпляр логики приложения, который обрабатывает данные hello в качестве входных данных. 

![Модель опрашивающего триггера](./media/logic-apps-create-api-app/custom-api-polling-trigger-pattern.png)

> [!NOTE]
> Каждый опрашивающий запрос считается выполнением действия, даже если экземпляр логики приложения не создается. Обработка tooprevent hello и тех же данных несколько раз, триггер должен очистить данные, уже был считывается и передается toohello логику приложения.

Ниже приведены конкретные шаги для триггера опроса, описанных с точки зрения hello API-интерфейса.

| Найдены ли новые данные или событие?  | Ответ API | 
| ------------------------- | ------------ |
| Найдено | Возвращает HTTP `200 OK` состояния с полезными данными ответа hello (входные данные для следующего шага). <br/>Этот ответ создает экземпляр логику приложения и запускает рабочий процесс hello. |
| Не найдено | Возврат данных состояние HTTP `202 ACCEPTED` с заголовками `location` и `retry-after`. <br/>Триггеры, hello `location` также должен содержать заголовок `triggerState` параметра запроса, который обычно является «метка времени». API можно использовать этот идентификатор tootrack hello hello логику время последнего запуска приложения. |

Например tooperiodically проверьте службу для новых файлов, можно построить опроса триггер, который ведет себя следующим образом:

| Включает ли запрос `triggerState`? | Ответ API |
| -------------------------------- | -------------|
| Нет | Возвращают HTTP `202 ACCEPTED` состояния, а также `location` заголовок с `triggerState` задать toohello текущее время и hello `retry-after` too15 интервал в секундах. |
| Да | Проверьте службу для файлов, добавленных после hello `DateTime` для `triggerState`. |

| Количество найденных файлов | Ответ API |
| --------------------- | -------------|
| Один файл | Возвращают HTTP `200 OK` состояние и hello содержимого полезных данных, обновление `triggerState` toohello `DateTime` для hello возвращаемый файл и задайте `retry-after` too15 интервал в секундах. |
| Разделение на несколько файлов | Возвращать одному файлу за раз и HTTP `200 OK` состояния, обновление `triggerState`и набор hello `retry-after` too0 интервал в секундах. </br>Эти действия позволяют engine hello знать, что доступно больше данных, ядро hello следует немедленно hello данные запроса URL-адрес hello в hello `location` заголовок. |
| Нет файлов | Возвращает HTTP `202 ACCEPTED` состояния, не изменяйте `triggerState`и набор hello `retry-after` too15 интервал в секундах. |

> [!TIP]
> Пример модели опрашивающего триггера см. в [образце контроллера опрашивающего триггера в GitHub](https://github.com/logicappsio/LogicAppTriggersExample/blob/master/LogicAppTriggers/Controllers/PollTriggerController.cs).

<a name="webhook-triggers"></a>

### <a name="wait-and-listen-for-new-data-or-events-with-hello-webhook-trigger-pattern"></a>Подождите и прослушивания событий с шаблоном триггер веб-перехватчика hello или новых данных

Триггер веб-перехватчика — *извещающий триггер*, который ожидает передачи новых данных или информации о событиях в конечной точке службы. Если новые данные или событие соответствует указанным условиям, триггер срабатывает hello hello и создает экземпляр приложения логика обрабатывает данные hello в качестве входных данных.
Веб-перехватчика Триггеры действуют аналогично hello [действия веб-перехватчика](#webhook-actions) ранее описанные в этом разделе и настроить с `subscribe` и `unsubscribe` конечных точек. 

* `subscribe`Конечная точка: при добавлении и сохранить веб-перехватчика триггера в приложении логику приложения hello логики подсистемы hello вызовов `subscribe` конечной точки. В результате этого действия hello логику приложения toocreate API хранит URL-адрес обратного вызова. При наличии новых данных или события, отвечающего hello указанному условию, обратный вызов API toohello URL-адрес HTTP POST. полезные данные содержимого Hello и заголовки передать в качестве входного toohello логику приложения.

* `unsubscribe`Конечная точка: при удалении триггера веб-перехватчика hello или вся логика приложения hello Logic Apps ядра hello вызовов `unsubscribe` конечной точки. API можно отменить регистрацию URL-адрес обратного вызова hello и остановите все процессы при необходимости.

![Модель триггера веб-перехватчика](./media/logic-apps-create-api-app/custom-api-webhook-trigger-pattern.png)

> [!NOTE]
> В настоящее время конструктор логику приложения hello не поддерживает обнаружение конечных точек веб-перехватчика через Swagger. Поэтому для этого шаблона имеют tooadd [ **веб-перехватчика** триггер](../connectors/connectors-native-webhook.md) и укажите URL-адрес hello, заголовки и текст для запроса. См. раздел [Триггер httpWebhook](logic-apps-workflow-actions-triggers.md#httpwebhook-trigger). toopass в URL-адрес обратного вызова hello использовать hello `@listCallbackUrl()` функции рабочего процесса в любой из предыдущих полей hello при необходимости.
>
> Обработка tooprevent hello и тех же данных несколько раз, триггер должен очистить данные, уже был считывается и передается toohello логику приложения.

> [!TIP]
> Пример модели веб-перехватчика см. в [образце контроллера триггера веб-перехватчика в GitHub](https://github.com/logicappsio/LogicAppTriggersExample/blob/master/LogicAppTriggers/Controllers/WebhookTriggerController.cs).

## <a name="deploy-call-and-secure-custom-apis"></a>Развертывание, вызов и защита пользовательских API

После создания пользовательских API настройте их для развертывания, чтобы обеспечить безопасность при вызове интерфейсов. Узнайте, каким образом слишком[развертывания, вызовите и защищать пользовательских API для приложения логики](./logic-apps-custom-hosted-api.md).

## <a name="publish-custom-apis-tooazure"></a>Публикация пользовательских tooAzure API-интерфейсы

toomake собственные пользовательские интерфейсы API, доступных для общего использования в Azure, отправка вашей заявки toohello [программы Microsoft Azure Certified](https://azure.microsoft.com/marketplace/programs/certified/logic-apps/).

## <a name="get-help"></a>Получение справки

За специализированной помощью по пользовательским API обращайтесь по адресу [customapishelp@microsoft.com](mailto:customapishelp@microsoft.com).

tooask вопросы, ответы на вопросы и см. какие другие пользователи приложения логики Azure делают, посетите hello [форуме по Azure логику приложений](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps).

toohelp улучшить логику приложений и соединителей, проголосовать или отправить идеями hello [веб-сайт отзывов пользователей приложения логики](http://aka.ms/logicapps-wish). 

## <a name="next-steps"></a>Дальнейшие действия

* [Метрики использования для действий и триггеров](logic-apps-pricing.md)
* [Обработка типов содержимого](./logic-apps-content-type.md)
* [Обработка ошибок и исключений](./logic-apps-exception-handling.md)
* [Защита доступа к tooyour логику приложения](./logic-apps-securing-a-logic-app.md)
* [Вызовы, срабатывания триггеров и создание вложенных приложений логики с конечными точками HTTP](./logic-apps-http-endpoint.md)