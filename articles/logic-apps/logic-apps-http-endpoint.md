---
title: "для вызова aaaCall, или вложить рабочих процессов с конечными точками HTTP - приложения логики Azure | Документы Microsoft"
description: "Настройка toocall конечные точки HTTP, триггер или вложенные рабочие процессы для логики приложений Azure"
services: logic-apps
keywords: "рабочие процессы, конечные точки HTTP"
author: jeffhollan
manager: anneta
editor: 
documentationcenter: 
ms.assetid: 73ba2a70-03e9-4982-bfc8-ebfaad798bc2
ms.service: logic-apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: integration
ms.custom: H1Hack27Feb2017
ms.date: 03/31/2017
ms.author: LADocs; jehollan
ms.openlocfilehash: 072a314c3bff75ab7696f86bb063bb7c03c4ae89
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="call-trigger-or-nest-workflows-with-http-endpoints-in-logic-apps"></a>Вызовы, срабатывания триггеров и создание вложенных рабочих процессов в приложениях логики

Вы можете предоставлять доступ к синхронным конечным точкам HTTP, выступающим в качестве триггеров в приложениях логики, с помощью которых можно активировать или вызвать приложение логики через URL-адрес. Также вы можете создавать вложенные рабочие процессы в приложениях логики с помощью шаблона вызываемых конечных точек.

toocreate конечные точки HTTP, можно добавить эти триггеры, чтобы логика приложения могли получать входящие запросы.

* [Запрос](../connectors/connectors-native-reqres.md)

* [webhook API подключения;](logic-apps-workflow-actions-triggers.md#api-connection-trigger)

* [webhook HTTP](../connectors/connectors-native-webhook.md)

   > [!NOTE]
   > Несмотря на то, что наши примеры использования hello **запроса** триггера, можно использовать любой из hello в списке триггеры HTTP, и все принципы применимы идентично toohello других типов триггеров.

## <a name="set-up-an-http-endpoint-for-your-logic-app"></a>Настройка конечной точки HTTP для приложения логики

toocreate конечную точку HTTP, добавьте триггер, который может принимать входящие запросы.

1. Войдите в toohello [портал Azure](https://portal.azure.com "портал Azure"). Перейдите tooyour логику приложения и откройте конструктор логику приложения.

2. Добавьте триггер, который позволяет приложению логики получать входящие запросы. Например, добавить hello **запроса** триггер tooyour логику приложения.

3.  В разделе **схемы JSON тело запроса**, при необходимости можно ввести схему JSON для hello полезных данных, предполагается, что триггер tooreceive hello.

    Конструктор Hello эта схема используется для создания токенов, логика приложения можно использовать tooconsume, синтаксический анализ и передачи данных из триггера hello через рабочий процесс. 
    Дополнительные сведения о [токенах, созданных из схем JSON](#generated-tokens).

    Например введите схему hello, показанные в конструкторе hello:

    ```json
    {
      "type": "object",
      "properties": {
        "address": {
          "type": "string"
        }
      },
      "required": [
        "address"
      ]
    }
    ```

    ![Добавить действие hello запроса][1]

    > [!TIP]
    > 
    > Можно создать схему для образца полезных данных JSON из средств, например [jsonschema.net](http://jsonschema.net/), или в hello **запроса** триггер, выбрав **используйте образец полезных данных toogenerate схемы**. 
    > Введите образец полезных данных и выберите **Готово**.

    Например, образец полезных данных

    ```json
    {
       "address": "21 2nd Street, New York, New York"
    }
    ```

    создает эту схему:

    ```json
    }
       "type": "object",
       "properties": {
          "address": {
             "type": "string" 
          }
       }
    }
    ```

4.  Сохраните приложение логики. В разделе **URL-адрес HTTP POST toothis**, теперь необходимо найти URL-адрес созданного обратного вызова, как в следующем примере:

    ![Созданный URL-адрес обратного вызова для конечной точки](./media/logic-apps-http-endpoint/generated-endpoint-url.png)

    Этот URL-адрес содержит ключ подписи общего доступа (SAS) в параметрах запроса hello, которые используются для проверки подлинности. 
    Можно также получить URL-адрес конечной точки HTTP hello из вашего Обзор приложений логики в hello портал Azure. В разделе **Журнал триггеров** выберите триггер:

    ![Получение URL-адреса конечной точки HTTP на портале Azure][2]

    Или hello URL-адрес можно получить, выполнив вызов:

    ```
    POST https://management.azure.com/{logic-app-resourceID}/triggers/{myendpointtrigger}/listCallbackURL?api-version=2016-06-01
    ```

## <a name="change-hello-http-method-for-your-trigger"></a>Измените триггер hello HTTP-метод

По умолчанию hello **запроса** триггер ожидает запрос HTTP POST, но можно использовать другой метод HTTP. 

> [!NOTE]
> Вы можете указать только один тип метода.

1. Для триггера **запроса** выберите **Показать дополнительные параметры**.

2. Откройте hello **метод** списка. В этом примере выберите **GET**, чтобы вы могли позже проверить URL-адрес конечной точки HTTP.

    > [!NOTE]
    > Вы можете выбрать любой другой метод HTTP или указать пользовательский метод для своего приложения логики.

    ![Изменение метода HTTP](./media/logic-apps-http-endpoint/change-method.png)

## <a name="accept-parameters-through-your-http-endpoint-url"></a>Принятие параметров через URL-адрес конечной точки HTTP

При необходимости параметры tooaccept URL-адрес конечной точки HTTP необходимо настроить код триггера относительный путь.

1. Для триггера **запроса** выберите **Показать дополнительные параметры**. 

2. В разделе **метод**, укажите метод hello HTTP, которые должны toouse ваш запрос. Для этого примера выберите hello **получить** метод, если вы еще не сделали этого, благодаря чему можно протестировать URL-адрес конечной точки HTTP.

      > [!NOTE]
      > Когда вы указываете относительный путь для своего триггера, вы должны явно указать для триггера метод HTTP.

3. В разделе **относительный путь**, укажите hello относительный путь для параметра hello, допускаемые URL-адрес, например, `customers/{customerID}`.

    ![Укажите метод HTTP hello и относительный путь для параметра](./media/logic-apps-http-endpoint/relativeurl.png)

4. toouse Здравствуйте параметра, добавьте **ответ** действие tooyour логику приложения. (Для вашего триггера выберите **Новый шаг** > **Добавить действие** > **Ответ**.) 

5. В ваш ответ **текст**, включают hello маркер параметра hello, указанное в код триггера относительный путь.

    Например, tooreturn `Hello {customerID}`, обновите ваш ответ **текст** с `Hello {customerID token}`. 
    Hello динамического содержимого списка должны отображаться и демонстрировать hello `customerID` маркера для вас tooselect.

    ![Добавьте параметр tooresponse тело](./media/logic-apps-http-endpoint/relativeurlresponse.png)

    Поле **текста** должно выглядеть, как в следующем примере:

    ![Поле текста ответа с параметром](./media/logic-apps-http-endpoint/relative-url-with-parameter.png)

6. Сохраните приложение логики. 

    URL-адрес конечной точки HTTP теперь включает hello относительный путь, например: 

    https&#58;//prod-00.southcentralus.logic.azure.com/workflows/f90cb66c52ea4e9cabe0abf4e197deff/triggers/manual/paths/invoke/customers/{customerID}...

7. tootest ваш конечная точка HTTP, копировать и вставить hello обновленный URL-адрес в другом окне браузера, но заменить `{customerID}` с `123456`, и нажмите клавишу ВВОД.

    Браузер должен вывести следующий текст: 

    `Hello 123456`

<a name="generated-tokens"></a>
### <a name="tokens-generated-from-json-schemas-for-your-logic-app"></a>Токены, создаваемые из схем JSON для вашего приложения логики

При указании схемы JSON в вашей **запроса** триггера, hello конструктор логику приложения создает токены для свойств в этой схеме. Затем эти токены можно использовать для передачи данных через рабочий процесс приложения логики.

Например, если добавить hello `title` и `name` схемы JSON свойства tooyour, токены, становятся доступны toouse на последующих этапах рабочего процесса. 

Ниже приведен полный схемы JSON hello.

```json
{
   "type": "object",
   "properties": {
      "address": {
         "type": "string"
      },
      "title": {
         "type": "string"
      },
      "name": {
         "type": "string"
      }
   },
   "required": [
      "address",
      "title",
      "name"
   ]
}
```

## <a name="create-nested-workflows-for-logic-apps"></a>Создание вложенных рабочих процессов для приложений логики

Вы можете вкладывать рабочие процессы в свое приложение логики путем добавления других приложений логики, которые могут принимать запросы. tooinclude добавить эти логику приложения hello **приложения логики Azure - выберите рабочий процесс приложения логики** действие tooyour триггера. Затем вы можете выбрать подходящие приложения логики.

![Добавление другого приложения логики](./media/logic-apps-http-endpoint/choose-logic-apps-workflow.png)

## <a name="call-or-trigger-logic-apps-through-http-endpoints"></a>Вызов или запуск приложений логики через конечные точки HTTP

После создания конечной точки HTTP, вы можете активировать логику приложения с помощью `POST` полный URL-адрес метода toohello. Приложения логики имеют встроенную поддержку конечных точек прямого доступа.

## <a name="reference-content-from-an-incoming-request"></a>Ссылка на содержимое входящего запроса

Если тип содержимого hello должен `application/json`, можно указать свойства hello входящий запрос. В противном случае содержимое обрабатывается как единый двоичный, можно передать tooother API-интерфейсы. tooreference это содержимое внутри hello рабочего процесса, необходимо преобразовать этого содержимого. Например, если передать `application/xml` содержимого, можно использовать `@xpath()` для извлечения XPath, или `@json()` для преобразования XML tooJSON. Дополнительные сведения о [работе с типами содержимого](../logic-apps/logic-apps-content-type.md).

tooget hello выходные данные из входящего запроса, можно использовать hello `@triggerOutputs()` функции. выходные данные Hello может выглядеть как в следующем примере:

```json
{
    "headers": {
        "content-type" : "application/json"
    },
    "body": {
        "myProperty" : "property value"
    }
}
```

tooaccess hello `body` свойства, в частности, можно использовать hello `@triggerBody()` ярлык. 

## <a name="respond-toorequests"></a>Ответ toorequests

Может потребоваться toorespond toocertain запросы, начинающиеся приложения логики, возвращая содержимое toohello вызывающего объекта. Код состояния tooconstruct hello, заголовок и текст ответа, можно использовать hello **ответ** действие. Это действие может находиться в любом месте логики приложения, не только в конце hello рабочего процесса.

> [!NOTE] 
> Если логика приложения не включает **ответ**, hello HTTP конечная точка отвечает *немедленно* с **202 принято** состояния. Кроме того, для hello исходный запрос tooget hello ответ, все действия, необходимые для ответа hello должен быть завершен в пределах hello [предельное время ожидания запроса](./logic-apps-limits-and-config.md) только при вызове рабочего процесса hello как приложение вложенных логики. Если ответ не выполняется в течение этого предела, hello входящий запрос времени ожидания и получает hello HTTP-ответа **408 время ожидания клиента**. Для вложенных logic apps hello родительского логику приложения по-прежнему toowait ответа до завершения, независимо от того, сколько времени требуется.

### <a name="construct-hello-response"></a>Конструкция hello ответа

Можно включить несколько заголовков и содержимого в тексте hello. В нашем примере ответ заголовок hello указывает, что ответ hello имеет тип содержимого `application/json`. и содержит текст hello `title` и `name`, на основе схемы JSON hello ранее обновление для hello **запроса** триггера.

![Действие ответа HTTP][3]

У ответов есть следующие свойства:

| Свойство | Описание |
| --- | --- |
| statusCode |Указывает код состояния hello HTTP для отвечает toohello входящего запроса. Это может быть любой допустимый код состояния, который начинается с 2xx, 4xx или 5xx. Но коды состояния 3xx не допускаются. |
| headers |Определяет любое количество заголовков tooinclude в ответ hello. |
| текст |Определяет объект текста. Это может быть строка, объект JSON и даже двоичное содержимое из предыдущего шага. |

Вот какие схемы JSON hello выглядит как теперь для hello **ответ** действия:

``` json
"Response": {
   "inputs": {
      "body": {
         "title": "@{triggerBody()?['title']}",
         "name": "@{triggerBody()?['name']}"
      },
      "headers": {
           "content-type": "application/json"
      },
      "statusCode": 200
   },
   "runAfter": {},
   "type": "Response"
}
```

> [!TIP]
> Выберите tooview hello полное JSON определение приложения логики на hello конструктор логики приложения, **кода представление**.

## <a name="q--a"></a>Вопросы и ответы

#### <a name="q-what-about-url-security"></a>Вопрос. Как обеспечивается безопасность URL-адресов?

Ответ. При создании URL-адресов обратного вызова Azure обеспечивает безопасность с помощью подписанного URL-адреса. Подпись передается в качестве параметра запроса и проверяется перед запуском приложения логики. Azure создает уникальное сочетание секретный ключ для каждого приложения логики, имя триггера hello и hello операцию, выполняемую с помощью подписи hello. Поэтому если кто-то не содержит ключ доступа toohello секретный логики приложения, не может создавать действительной подписи.

   > [!IMPORTANT]
   > Для рабочих сред и систем безопасности настоятельно не рекомендуется вызов логику приложения непосредственно из браузера hello, так как:
   > 
   > * в URL-адрес hello появится Hello общий ключ доступа.
   > * Нельзя управлять безопасного содержимого политики из-за tooshared домены среди клиентов приложения логики.

#### <a name="q-can-i-configure-http-endpoints-further"></a>Вопрос. Могу ли я дополнительно настроить конечные точки HTTP?

Ответ. Да, конечные точки HTTP поддерживают расширенную конфигурацию через [**управление API**](../api-management/api-management-key-concepts.md). Эта служба также обеспечивает возможность hello, для всех API, включая логику приложения управления вы tooconsistently, настроить пользовательские имена доменов, используйте дополнительные методы проверки подлинности и многое другое, например:

* [Измените метод запроса hello](https://docs.microsoft.com/azure/api-management/api-management-advanced-policies#SetRequestMethod)
* [Изменить hello сегменты URL-адреса запроса hello](https://docs.microsoft.com/azure/api-management/api-management-transformation-policies#RewriteURL)
* Настроить домены управления API в hello [портал Azure](https://portal.azure.com/ "портал Azure")
* Настройка политики toocheck для обычной проверки подлинности

#### <a name="q-what-changed-when-hello-schema-migrated-from-hello-december-1-2014-preview"></a>Вопрос. что изменилось, при миграции схемы hello из предварительной версии hello 1 декабря 2014 г.?

Ответ. Вот сводка об этих изменениях:

| Предварительная версия от 1 декабря 2014 года | 1 июня 2016 года |
| --- | --- |
| Щелкните приложение API **Прослушиватель HTTP**. |Щелкните **Ручной триггер** (приложение API не требуется). |
| Параметр прослушивателя HTTP*Sends response automatically*(Отправляет ответ автоматически). |Либо включить **ответ** действия или не находится в определение рабочего процесса hello |
| Настройка базовой проверки подлинности или OAuth |с помощью управления API |
| Настройка метода HTTP |В разделе **Показать дополнительные параметры** выберите метод HTTP |
| Настройка относительного пути |В разделе **Показать дополнительные параметры** добавьте относительный путь |
| Справочник по hello тела входящего запроса через`@triggerOutputs().body.Content` |Используйте для ссылки `@triggerOutputs().body` |
| **Отправить ответ HTTP** действие hello прослушиватель HTTP |Нажмите кнопку **запроса tooHTTP ответ** (требуется приложение не API) |

## <a name="get-help"></a>Получение справки

вопросы tooask ответить на вопросы и узнайте, какие другие логику приложения Azure пользователи делают, посетите hello [форуме по Azure логику приложений](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps).

toohelp улучшить логику приложения Azure и соединителей, проголосовать или отправить идеями hello [веб-сайт отзывов пользователей приложения логики Azure](http://aka.ms/logicapps-wish).

## <a name="next-steps"></a>Дальнейшие действия

* [Создание определений приложений логики](./logic-apps-author-definitions.md)
* [Обработка ошибок и исключений](./logic-apps-exception-handling.md)

[1]: ./media/logic-apps-http-endpoint/manualtrigger.png
[2]: ./media/logic-apps-http-endpoint/manualtriggerurl.png
[3]: ./media/logic-apps-http-endpoint/response.png
