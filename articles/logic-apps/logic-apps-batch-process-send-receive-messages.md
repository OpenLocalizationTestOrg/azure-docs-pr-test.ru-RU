---
title: "Обработка сообщений aaaBatch как группы или коллекции - приложения логики Azure | Документы Microsoft"
description: "Отправка и получение сообщений для пакетной обработки в приложениях логики"
keywords: "пакет, пакетная обработка"
author: jonfancey
manager: anneta
editor: 
services: logic-apps
documentationcenter: 
ms.assetid: 
ms.service: logic-apps
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/7/2017
ms.author: LADocs; estfan; jonfan
ms.openlocfilehash: 2603db71ee0659d5b6bf5ce3d32f1b0d13c34194
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="send-receive-and-batch-process-messages-in-logic-apps"></a>Отправка, получение и пакетная обработка сообщений в приложениях логики

tooprocess сообщений в группах, можно отправить данные tooa элементы или сообщений, *пакета*, а затем пакетной обработки этих элементов. Этот подход полезен, если нужно убедиться, что элементы данных toomake группируются особым образом и обрабатываются вместе. 

Можно создать логику приложения, получающие элементов в виде пакета с помощью hello **пакета** триггера. Затем можно создать логику приложения, отправить пакет tooa элементов с помощью hello **пакета** действие.

В этом разделе показано, как создать решение пакетной обработки, выполнив следующие задачи: 

* [Создание приложения логики, которое получает и собирает элементы как пакет](#batch-receiver). Это приложение логики «пакета получатель» указывает hello пакета имя и выпуск критерии toomeet перед логику приложения hello приемника освобождает и обрабатывает элементы. 

* [Создание приложения логики, который отправляет пакет tooa элементы](#batch-sender). Это приложение логики «пакета отправителя» указывает, где toosend элементов, которые должны быть существующие приложения логики приемника пакета. Можно также указать уникальный ключ, например, номер клиента, слишком «секции» или разделить целевом пакете hello в подмножества, на основе такого ключа. Таким образом все элементы с этим ключом будут собираться и обрабатываться вместе. 

## <a name="requirements"></a>Требования

toofollow в этом примере потребуется следующее:

* Подписка Azure. Если у вас нет подписки, вы можете [создать бесплатную пробную версию учетной записи Azure](https://azure.microsoft.com/free/). В противном случае вы можете [зарегистрироваться на получение подписки с оплатой по мере использования](https://azure.microsoft.com/pricing/purchase-options/).

* Базовые знания о [как toocreate приложения логики](../logic-apps/logic-apps-create-a-logic-app.md) 

* Учетная запись электронной почты любого [поставщика электронной почты, поддерживаемого Azure Logic Apps](../connectors/apis-list.md).

<a name="batch-receiver"></a>

## <a name="create-logic-apps-that-receive-messages-as-a-batch"></a>Создание приложения логики, которое получает сообщения как пакет

Перед тем как отправлять сообщения tooa пакет, сначала необходимо создать приложение логику «получатель пакета» с hello **пакета** триггера. Таким образом, можно выбрать этот получатель приложения логики, при создании приложения логики hello отправителя. Для получателя hello укажите имя пакета hello, условия выпуска и другие параметры. 

Приложения логики отправителя необходимы сведения, где элементы toosend, пока получатель логику приложения не требуется tooknow что-либо о отправителей hello.

1. В hello [портал Azure](https://portal.azure.com), создание логики приложения с таким именем: «BatchReceiver» 

2. В конструкторе приложений логики добавьте hello **пакета** срабатывание триггера, который запускает рабочий процесс приложения логики. В поле поиска hello введите «раздел» фильтра. Выберите триггер **Пакет — Пакетные сообщения**.

   ![Добавление триггера "Пакет"](./media/logic-apps-batch-process-send-receive-messages/add-batch-receiver-trigger.png)

3. Укажите имя для пакета hello и укажите критерии освобождения hello пакета, например:

   * **Имя пакета**: hello имя, используемое tooidentify hello пакетах, что в этом примере является «TestBatch».
   * **Число сообщений**: hello число toohold сообщения в виде пакета, не отпуская для обработки, который является «5» в этом примере.

   ![Ввод сведений для триггера "Пакет"](./media/logic-apps-batch-process-send-receive-messages/receive-batch-trigger-details.png)

4. Добавьте другое действие, которое отправляет сообщение электронной почты, когда срабатывает триггер hello пакета. Каждый пакет hello времени имеет пять элементов, приложение hello логику отправляет сообщение электронной почты.

   1. В разделе hello пакета триггер, выберите **+ новый шаг** > **добавить действие**.

   2. В поле поиска hello введите «email» фильтра.
   Выберите соединитель электронной почты в зависимости от своего поставщика электронной почты.
   
      Например при наличии рабочей или учебной учетной записи выберите соединитель hello Office 365 Outlook. 
      Если учетную запись Gmail, выберите соединитель Gmail hello.

   3. Выберите это действие для соединителя: **{*поставщик электронной почты*} - Отправить электронное письмо**

      Например:

      ![Выбор действия "Отправить электронное письмо" для поставщика электронной почты](./media/logic-apps-batch-process-send-receive-messages/add-send-email-action.png)

5. Если вы еще не создали подключение для поставщика электронной почты, то укажите учетные данные электронной почты для аутентификации при появлении соответствующего запроса. Дополнительные сведения об аутентификации учетных данных электронной почты см. в [этой статье](../logic-apps/logic-apps-create-a-logic-app.md).

6. Установить свойства hello hello действие, которое вы только что добавили.

   * В hello **для** введите адрес электронной почты получателя hello. 
   Для тестировании можете использовать свой собственный адрес.

   * В hello **субъекта** поле, когда hello **динамическое содержимое** появится список, выберите hello **имя секции** поля.

     ![Выберите из списка «Динамического содержимого» hello «Раздела»](./media/logic-apps-batch-process-send-receive-messages/send-email-action-details.png)

     В следующем разделе можно указать ключ уникальную секцию, разделяет hello целевом пакете в логические наборы toowhere можно отправлять сообщения. 
     Каждый набор имеет уникальный номер, создаваемое приложение логики hello отправителя. 
     Эта возможность позволяет использовать один пакет с несколькими подмножеств и определить каждое подмножество с указываемое имя hello.

   * В hello **текст** поле, когда hello **динамическое содержимое** появится список, выберите hello **идентификатор сообщения** поля.

     ![Выбор значения "Идентификатор сообщения" для поля "Текст"](./media/logic-apps-batch-process-send-receive-messages/send-email-action-details-for-each.png)

     Поскольку hello входные данные для действия электронной почты для отправки hello является массивом, hello конструктор автоматически добавляет **для каждого** цикла вокруг hello **отправить сообщение электронной почты** действие. 
     Этот цикл выполняет внутреннее действие hello для каждого элемента в пакете hello. 
     Таким образом элементы toofive set триггера пакета hello, вы получаете пять сообщений электронной почты, который срабатывает триггер hello каждый раз.

7.  Когда приложение логики для получения пакета создано, сохраните это приложение.

    ![Сохранение приложения логики](./media/logic-apps-batch-process-send-receive-messages/save-batch-receiver-logic-app.png)

<a name="batch-sender"></a>

## <a name="create-logic-apps-that-send-messages-tooa-batch"></a>Создавать логику приложения, отправляющие сообщения tooa пакета

Теперь можно создайте один или несколько логики приложения, отправить пакет toohello элементов определяются hello приемника логику приложения. Для отправителя hello укажите hello приемника логику приложения и имя пакета, содержимое сообщения и все другие параметры. Дополнительно можно присвоить hello пакета ключей toodivide уникальную секцию в подмножеств toocollect элементы с этим ключом.

Приложения логики отправителя необходимы сведения, где элементы toosend, пока получатель логику приложения не требуется tooknow что-либо о отправителей hello.

1. Создайте второе приложение логики с именем BatchSender.

   1. В поле поиска hello введите «повторение» фильтра. 
   Выберите триггер **Расписание — повторение**.

      ![Добавить триггер hello «Периодичности расписания»](./media/logic-apps-batch-process-send-receive-messages/add-schedule-trigger-batch-receiver.png)

   2. Задайте частоту hello и интервала toorun hello отправителя логику приложения каждую минуту.

      ![Настройка частоты и интервала триггера повторения](./media/logic-apps-batch-process-send-receive-messages/recurrence-trigger-batch-receiver-details.png)

2. Добавьте новое действие для отправки сообщений tooa пакета.

   1. В разделе hello повторения триггера, выберите **+ новый шаг** > **добавить действие**.

   2. В поле поиска hello введите «раздел» фильтра. 

   3. Выберите это действие: **отправки сообщений toobatch: выберите рабочий процесс приложения логики с триггером пакета**

      ![Выберите «Отправить сообщения toobatch»](./media/logic-apps-batch-process-send-receive-messages/send-messages-batch-action.png)

   4. Теперь выберите приложение логики BatchReceiver, которое вы создали ранее и которое теперь доступно как действие.

      ![Выбор приложения логики для "получения пакета"](./media/logic-apps-batch-process-send-receive-messages/send-batch-select-batch-receiver.png)

      > [!NOTE]
      > Hello также перечислены другие приложения логики которых определены триггеры пакета.

3. Установить свойства пакета hello.

   * **Имя пакета**: имя пакета hello, определяемое приложение логики hello получателя, то в этом примере является «TestBatch» и выполняется проверка во время выполнения.

     > [!IMPORTANT]
     > Убедитесь, что не изменять имя пакета hello, которое должно совпадать с именем пакета hello, определяемый hello приемника логику приложения.
     > Изменение имени пакета hello приводит отправителя hello toofail логику приложения.

   * **Содержимое сообщения**: hello, которые должны toosend содержимое сообщения. 
   Для этого примера добавьте это выражение вставок hello текущую дату и время в сообщение hello отправки toohello пакета содержимого:

     1. Здравствуйте, когда **динамическое содержимое** появится список, выберите **выражение**. 
     2. Введите выражение hello **utcnow()**и выберите **ОК**. 

        ![В поле "Содержимое сообщения" выберите "Выражение". Введите utcnow().](./media/logic-apps-batch-process-send-receive-messages/send-batch-receiver-details.png)

4. Теперь настройка секции для пакетной hello. В hello действие «BatchReceiver», выберите **Показывать дополнительные параметры**.

   * **Имя секции**: необязательное секционирование уникальных ключей toouse разделения hello целевого пакета. Например, добавьте выражение, которое генерирует случайное число от 1 до 5.
   
     1. Здравствуйте, когда **динамическое содержимое** появится список, выберите **выражение**.
     2. Введите следующее выражение: **rand(1,6)**

        ![Настройка секции для целевого пакета](./media/logic-apps-batch-process-send-receive-messages/send-batch-receiver-partition-advanced-options.png)

        Эта функция **rand** генерирует число от 1 до 5. 
        То есть пакет разделяется на пять нумерованных секций, которые динамически задаются этим выражением.

   * **Идентификатор сообщения**: необязательный идентификатор сообщения. Если это поле оставить пустым, то генерируется идентификатор GUID. 
   Для данного примера оставьте это поле пустым.

5. Сохраните приложение логики. Логика приложения отправителя теперь выглядит аналогичный пример toothis:

   ![Сохранение отправляющего приложения логики](./media/logic-apps-batch-process-send-receive-messages/send-batch-receiver-details-finished.png)

## <a name="test-your-logic-apps"></a>Тестирование приложений логики

tootest вашей пакетной обработки решений, оставьте свои приложения логики, выполняться несколько минут. Скоро вы начните получать сообщения электронной почты в пяти группах, с hello же ключ раздела.

BatchSender логику приложения запускается каждую минуту, создает случайное число в диапазоне от одного до пяти и использует этот созданный номер в качестве ключа секции hello для hello целевого пакета, куда должны отправляться сообщения. Каждый раз hello пакета содержит пять элементов с hello одинаковым ключом секции BatchReceiver логику приложения срабатывает и отправляет сообщения для каждого сообщения.

> [!IMPORTANT]
> После завершения тестирования, убедитесь, что отключение hello BatchSender логику приложения toostop отправки сообщений и избежать перегрузки папку "Входящие".

## <a name="next-steps"></a>Дальнейшие действия

* [Создание определений рабочих процессов для приложений логики с помощью JSON](../logic-apps/logic-apps-author-definitions.md)
* [Создание бессерверного приложения в Visual Studio с использованием приложений логики и функций](../logic-apps/logic-apps-serverless-get-started-vs.md)
* [Сценарий обработки исключений и ведения журнала ошибок для приложений логики](../logic-apps/logic-apps-scenario-error-and-exception-handling.md)
