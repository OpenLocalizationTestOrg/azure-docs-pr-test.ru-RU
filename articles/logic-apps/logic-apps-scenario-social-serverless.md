---
title: "Сценарий создания панели мониторинга сведений о клиентах с использованием беcсерверных средств в Azure | Документация Майкрософт"
description: "Пример того, как можно создать панель мониторинга для управления отзывами от клиентов, социальными данными и многим другим с помощью Функций Azure и Azure Logic Apps."
keywords: 
services: logic-apps
author: jeffhollan
manager: anneta
editor: 
documentationcenter: 
ms.assetid: d565873c-6b1b-4057-9250-cf81a96180ae
ms.service: logic-apps
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/29/2017
ms.author: jehollan
ms.openlocfilehash: 0b6e118cb13ab8185d8eeb42bec6147155967967
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="create-a-real-time-customer-insights-dashboard-with-azure-logic-apps-and-azure-functions"></a>Создание панели мониторинга сведений о клиентах в режиме реального времени с помощью Функций Azure и Azure Logic Apps.

беcсерверные средства Azure предоставляют широкие возможности для быстрого создания и размещения приложений в облаке, не задумываясь об инфраструктуре.  В рамках этого сценария мы создадим панель мониторинга, которая будет запускаться при получении отзывов от клиентов, анализировать отзывы с помощью машинного обучения и публиковать аналитику в Power BI или Azure Data Lake.

## <a name="overview-of-the-scenario-and-tools-used"></a>Краткий обзор сценария и используемых инструментов

Чтобы реализовать это решение, мы будем использовать два ключевых компонента беcсерверных приложений в Azure: [Функции Azure](https://azure.microsoft.com/services/functions/) и [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/).

Приложения логики — это беcсерверный обработчик рабочего процесса в облаке.  Он обеспечивает оркестрацию беcсерверных компонентов и подключается к более чем 100 службам и интерфейсам API.  В рамках этого сценария мы создадим приложение логики, которое будет запускаться при получении отзывов от клиентов.  Ниже перечислены некоторые соединители, которые могут реагировать на отзывы от клиентов, включая Outlook.com, Office 365, Survey Monkey, Twitter и HTTP-запрос [из веб-формы](https://blogs.msdn.microsoft.com/logicapps/2017/01/30/calling-a-logic-app-from-an-html-form/).  В описанном ниже рабочем процессе мы будем отслеживать хэштег в Twitter.

Функции предоставляют беcсерверные вычисления в облаке.  В этом случае будут использоваться Функции Azure для пометки твитов от клиентов на основе набора предварительно определенных ключевых слов.

Решение можно целиком [создать в Visual Studio](logic-apps-deploy-from-vs.md) и [развернуть как часть шаблона ресурсов](logic-apps-create-deploy-template.md).  Существует также видеоруководство [на Channel 9](http://aka.ms/logicappsdemo).

## <a name="build-the-logic-app-to-trigger-on-customer-data"></a>Создание приложения логики, которое будет запускаться при получении клиентских данных

После [создания приложения логики](logic-apps-create-a-logic-app.md) в Visual Studio или на портале Azure:

1. Добавьте триггер, который будет активироваться при размещении **новых твитов** в Twitter.
2. Настройте триггер для прослушивания твитов по ключевому слову или хэш-тегу.

   > [!NOTE]
   > Свойство повторения триггера определяет, как часто приложение логики будет проверять наличие новых элементов с помощью триггеров на основе опроса.

   ![Пример триггера Twitter][1]

Это приложение будет реагировать на все новые твиты.  Затем можно подробнее проанализировать тональность выраженного мнения.  Для этого используется [Azure Cognitive Service](https://azure.microsoft.com/services/cognitive-services/).

1. Нажмите кнопку **Новый шаг**.
1. Выберите или найдите соединитель **Текстовая аналитика**.
1. Выберите операцию **Detect Sentiment** (Определение тональности).
1. При запросе введите допустимый ключ Cognitive Services для службы текстовой аналитики.
1. Добавьте **текст твита** в качестве текста для анализа.

Теперь, когда получены данные и аналитические сведения о твите, можно использовать ряд других соединителей:
* Power BI. Добавляются строки в набор данных потоковой передачи. Твиты можно просматривать в режиме реального времени на панели мониторинга Power BI.
* Azure Data Lake. Добавляется файл. Данные клиента добавляются в набор данных Azure Data Lake для включения в задания аналитики.
* SQL. Добавляются строки. Данные можно сохранить в базе данных для последующего извлечения.
* Slack. Отправляется сообщение. Канал Slack получает оповещение об отрицательном отзыве, для которого нужно предпринять действия.

Функцию Azure также можно использовать для настраиваемых вычислений на основе данных.

## <a name="enriching-the-data-with-an-azure-function"></a>Обогащение данных с помощью Функции Azure

Чтобы создать функцию, необходимо иметь приложение-функцию в подписке Azure.  Сведения о создании Функции Azure на портале можно найти [здесь](../azure-functions/functions-create-first-azure-function-azure-portal.md).

Чтобы функция могла вызываться непосредственно из приложения логики, для нее необходимо настроить привязку триггера HTTP.  Мы советуем использовать шаблон **HttpTrigger**.

В этом случае текстом запроса Функции Azure будет текст твита.  В коде функции просто задайте логику для текста твита, содержащего ключевое слово или фразу.  Сама функция может быть простой или сложной в зависимости от сценария.

В конце функции просто верните в приложение логики ответ с данными.  Это может быть простое логическое значение (например, `containsKeyword`) или сложный объект.

![Настройка шага Функции Azure][2]

> [!TIP]
> При доступе к сложному ответу от функции в приложении логики используйте действие "Анализ JSON".

После сохранения функции ее можно добавить в приложение логики, созданное ранее.  В приложении логики:

1. Щелкните **Новый шаг**.
1. Выберите соединитель **Функции Azure**.
1. Щелкните, чтобы выбрать существующую функцию, и перейдите к созданной функции.
1. Отправьте **текст твита** в качестве **текста запроса**.

## <a name="running-and-monitoring-the-solution"></a>Выполнение и отслеживание решения

Одним из преимуществ создания беcсерверных оркестраций в Logic Apps являются широкие возможности отладки и мониторинга.  Любое выполнение (текущее или прошлое) можно просмотреть в среде Visual Studio, на портале Azure или с помощью REST API и пакетов SDK.

Один из самых простых способов тестирования приложения логики — использовать кнопку **запуска** в конструкторе.  После нажатия кнопки **запуска** триггер будет опрашиваться каждые 5 секунд, пока не будет обнаружено событие, после чего появится возможность наблюдать за ходом выполнения в режиме реального времени.

В колонке обзора на портале Azure или с помощью Visual Studio Cloud Explorer можно просмотреть историю предыдущих выполнений.

## <a name="creating-a-deployment-template-for-automated-deployments"></a>Создание шаблона развертывания для автоматического развертывания

После разработки решения его можно записать и развернуть с помощью шаблона развертывания Azure в любом регионе Azure в мире.  Это полезно для изменения параметров разных версий этого рабочего процесса, а также для интеграции этого решения в конвейер сборки и выпуска.  Дополнительные сведения о создании шаблона развертывания см. [в этой статье](logic-apps-create-deploy-template.md).

Функции Azure также могут быть включены в шаблон развертывания таким образом, чтобы всем решением вместе со всеми зависимостями можно было управлять как одним шаблоном.  Пример шаблона развертывания функции можно найти в [репозитории шаблонов быстрого запуска Azure](https://github.com/Azure/azure-quickstart-templates/tree/master/101-function-app-create-dynamic).

## <a name="next-steps"></a>Дальнейшие действия

* [Примеры и распространенные сценарии для Azure Logic Apps](logic-apps-examples-and-scenarios.md)
* [Пошаговое видеоруководство по созданию этого решения](http://aka.ms/logicappsdemo)
* [Обработка ошибок и исключений в Azure Logic Apps](logic-apps-exception-handling.md)

<!-- Image References -->
[1]: ./media/logic-apps-scenario-social-serverless/twitter.png
[2]: ./media/logic-apps-scenario-social-serverless/function.png