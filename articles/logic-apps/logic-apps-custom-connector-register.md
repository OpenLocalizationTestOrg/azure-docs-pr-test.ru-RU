---
title: "Регистрация настраиваемых соединителей — Azure Logic Apps | Документация Майкрософт"
description: "Настройка настраиваемых соединителей для Azure Logic Apps"
author: ecfan
manager: anneta
editor: 
services: logic-apps
documentationcenter: 
ms.assetid: 
ms.service: logic-apps
ms.workload: logic-apps
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/22/2017
ms.author: LADocs; estfan
ms.openlocfilehash: 9e3d88abe751b37700590cc68c458f208d5868d2
ms.sourcegitcommit: e5355615d11d69fc8d3101ca97067b3ebb3a45ef
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="register-custom-connectors-in-azure-logic-apps"></a>Регистрация настраиваемых соединителей в Azure Logic Apps

После сборки REST API, настройки проверки подлинности и получения файла определения OpenAPI или коллекции Postman можно зарегистрировать соединитель. 

## <a name="prerequisites"></a>Предварительные требования

Чтобы зарегистрировать настраиваемый соединитель, вам потребуются:

* Сведения для регистрации соединителя в Azure: имя, подписка Azure, группа ресурсов Azure и расположение, которое необходимо использовать.

* Файл OpenAPI (Swagger) или коллекция Postman с описанием вашего API.

  В этом руководстве можно использовать [образец файла OpenAPI Azure Resources Manager](http://pwrappssamples.blob.core.windows.net/samples/AzureResourceManager.json).

* Значок, соответствующий соединителю.

* Краткое описание соединителя.

* Расположение узла API.

## <a name="1-create-your-connector"></a>1. Создание соединителя

1. На портале Azure в главном меню выберите вкладку **Создать**. В поле поиска введите "соединитель Logic Apps" в качестве фильтра и нажмите клавишу ВВОД.

   !["Создать", поиск по фильтру "соединитель Logic Apps"](./media/logic-apps-custom-connector-register/create-logic-apps-connector.png)

2. В списке результатов выберите **Logic Apps Connector** (Соединитель Logic Apps) > **Создать**.

   ![Создание соединителя Logic Apps](./media/logic-apps-custom-connector-register/choose-logic-apps-connector.png)

3. Укажите сведения для регистрации соединителя, как описано в таблице. По завершении выберите **Закрепить на панели мониторинга** > **Создать**.

   ![Сведения о настраиваемом соединителе Logic Apps](./media/logic-apps-custom-connector-register/logic-apps-connector-details.png)

   | Свойство | Рекомендуемое значение | Описание | 
   | -------- | --------------- | ----------- | 
   | **Имя** | *custom-connector-name* | Укажите имя соединителя. | 
   | **Подписка** | *Azure-subscription-name* | Выберите подписку Azure. | 
   | **Группа ресурсов** | *Azure-resource-group-name* | Создайте или выберите группу Azure, чтобы упорядочить ресурсы Azure. | 
   | **Расположение** | *deployment-region* | Выберите регион развертывания для соединителя. | 
   |||| 

   Когда Azure развернет ваш соединитель, его меню откроется автоматически. 
   В противном случае выберите нужный настраиваемый соединитель на панели мониторинга Azure.

## <a name="2-define-your-connector"></a>2) Определение соединителя

Теперь укажите файл OpenAPI или коллекцию Postman для создания соединителя, способ проверки подлинности, который он будет использовать, действия и триггеры, которые этот соединитель предоставляет, а также их параметры.

### <a name="2a-specify-the-openapi-file-or-postman-collection-for-your-connector"></a>2.1. Указание файла OpenAPI или коллекции Postman для соединителя

1. В меню соединителя выберите вкладку **Logic Apps Connector** (Соединитель Logic Apps), если еще не сделали это. На панели инструментов нажмите кнопку **Изменить**.

   ![Изменение настраиваемого соединителя](./media/logic-apps-custom-connector-register/edit-custom-connector.png)

2. Выберите раздел **Общие**, где в соответствующих таблицах можно указать сведения, чтобы создать и определить действия и триггеры настраиваемого соединителя, а также обеспечить их безопасность.

   1. Если вы используете **Custom connectors** (Настраиваемые соединители), выберите параметр, позволяющий указать файл OpenAPI (Swagger), который описывает ваш API.

      ![Указание файла OpenAPI для API](./media/logic-apps-custom-connector-register/provide-openapi-file.png)

      | Параметр | Формат |Описание | 
      | ------ | ------ | ----------- | 
      | **Upload an OpenAPI file** (Передать файл OpenAPI) | *JSON-файл-OpenAPI (Swagger)* | Перейдите к расположению файла OpenAPI и выберите этот файл. | 
      | **Use an OpenAPI URL** (Использовать URL-адрес OpenAPI) | http://*путь-к-JSON-файлу-Swagger* | Укажите URL-адрес файла OpenAPI для API. | 
      | **Upload Postman collection V1** (Передать V1-файл коллекции Postman) | *V1-файл-экспортированной-коллекции-Postman* | Перейдите в папку, куда следует экспортировать коллекцию Postman в формате V1. | 
      |||| 

   2. В окне **General information** (Общие сведения) передайте значок соединителя. 
   Как правило, поля **Описание**, **Узел** и **Базовый URL-адрес** автоматически заполняются с использованием файла OpenAPI. 
   Но если они не заполнены, укажите сведения, как описано в таблице, и нажмите кнопку **Продолжить**. 

      ![Сведения о соединителе](./media/logic-apps-custom-connector-register/add-connector-details.png)

      | Параметр | Формат | Описание | 
      | ----------------- | ------ | ----------- | 
      | **Upload Icon** (Отправить значок) | *PNG-или-JPG-файл-меньше-1-МБ* | Значок, соответствующий соединителю. <p>Цвет: желательно белый логотип на цветном фоне. <p>Размеры: логотип размером около 160 пикселей в квадрате 230 пикселей. | 
      | **Icon background color** (Цвет фона значка) | *шестнадцатеричный-код-цвета-фирменной-символики-значка* | <p>Цвет вне значка, соответствующий цвету фона в файле значка. <p>Формат: шестнадцатеричный. Например, #007ee5 соответствует синему цвету. | 
      | **Описание** | *описание-соединителя* | Укажите краткое описание соединителя. | 
      | **Host** | *узел-соединителя* | Укажите домен узла для веб-API. | 
      | **Базовый URL-адрес** | *базовый-URL-адрес-соединителя* | Укажите базовый URL-адрес веб-API. | 
      |||| 

### <a name="2b-describe-the-authentication-that-your-connector-uses"></a>2.2. Описание проверки подлинности, которую использует соединитель

1. Теперь щелкните **Безопасность**, чтобы просмотреть или указать данные о проверке подлинности, которую использует соединитель. Проверка подлинности обеспечивает надлежащее использование пользовательских удостоверений между службой и всеми клиентами.

   ![Authentication type (Тип проверки подлинности)](./media/logic-apps-custom-connector-register/security.png)

   * При передаче файла OpenAPI мастер регистрации автоматически определяет тип проверки подлинности в веб-API и автоматически заполняет раздел **Безопасность** в мастере на основе объекта `securityDefinitions` в этом файле. Например, вот раздел, в котором указано использование OAuth 2.0:

     ``` json
     "securityDefinitions": {
       "AAD": {
       "type": "oauth2",
       "flow": "accessCode",
       "authorizationUrl": "https://login.windows.net/common/oauth2/authorize",
       "tokenUrl": "https://login.windows.net/common/oauth2/token",
       "scopes": {}
       }
     },
     ```

   * Если в файле OpenAPI не заполнены тип проверки подлинности и свойства, нажмите кнопку **Изменить**, чтобы добавить эти сведения. 
   
     К примеру, если ранее вы [настроили проверку подлинности Azure AD с помощью этого руководства](../logic-apps/custom-connector-azure-active-directory-authentication.md), значит созданы приложения Microsoft Azure Active Directory, обеспечивающие безопасность веб-API и соединителя. 
     Теперь можно ввести идентификатор приложения и ключ клиента, сохраненные ранее:
    
     | Настройка | Рекомендуемое значение | Описание | 
     | ------- | --------------- | ----------- | 
     | **Тип проверки подлинности** | OAuth 2.0 | | 
     | **Поставщик удостоверений** | Azure Active Directory | | 
     | **Идентификатор клиента** | *идентификатор-приложения-Azure-AD-соединителя* | Сохраненный идентификатор для приложения соединителя Azure AD. | 
     | **Секрет клиента** | *ключ-клиента-для-приложения-Azure-AD-соединителя* | Ключ клиента для приложения Azure AD вашего соединителя. | 
     | **Login URL** (URL-адрес для входа) | `https://login.windows.net` | | 
     | **URL-адрес ресурса** | `https://management.core.windows.net/` | Убедитесь, что URL-адрес указан точно: вместе с заключительной косой чертой. | 
     |||| 

   * Коллекция Postman автоматически создает файл OpenAPI, но заполняет параметр типа проверки подлинности *только* при использовании поддерживаемого типа, такого как OAuth 2.0 или "Обычная".

2. Чтобы сохранить соединитель после ввода сведений безопасности, в верхней части страницы щелкните **Update connector** (Обновить соединитель), а затем **Продолжить**. 

### <a name="2c-review-update-or-define-actions-and-triggers-for-your-connector"></a>2.3. Проверка, обновление и определение действий и триггеров для соединителя

1. Теперь щелкните **Определение**. В этом разделе можно просмотреть, изменить и определить действия и триггеры, чтобы пользователи добавляли их в свои рабочие процессы.

   Действия и триггеры основываются на операциях, определенных в файле OpenAPI или коллекции Postman, которые служат для автоматического заполнения страницы **Определение** и содержат значения запросов и ответов. Следовательно, если на странице отображаются требуемые операции, можно приступить к следующему шагу регистрации, не внося изменения.

   ![Определение соединителя](./media/logic-apps-custom-connector-register/definition.png)

2. Кроме того, при необходимости можно изменить имеющиеся или добавить новые действия и триггеры.

<a name="add-action-or-trigger"></a> 

#### <a name="edit-or-add-actions-for-your-connector"></a>Изменение и добавление действий для соединителя

1. Чтобы изменить имеющееся действие, выберите для него число. Чтобы добавить действие, отсутствующее в файле OpenAPI или коллекции Postman, в разделе **Действия** щелкните **New action** (Новое действие).

2. В разделе **Общие** укажите или измените сведения о действии:
   
   | Настройка | Рекомендуемое значение | Описание | 
   | ------- | --------------- | ----------- | 
   | **Сводка** | *имя-операции* | Название этого действия. | 
   | **Описание** | *описание-операции* | Описание этого действия. <p>**Совет**. В конце описания нужно поставить точку. |
   | **ИД операции** | *идентификатор-операции* | Уникальное имя этого действия. Используйте "верблюжий" стиль, например getPullRequest. | 
   |**Видимость**| **none** (нет), **advanced** (дополнительная), **internal** (внутренняя) или **important** (важно). | Видимость этого действия в пользовательском интерфейсе. Дополнительные сведения см. в разделе о [расширениях OpenAPI](../logic-apps/custom-connector-openapi-extensions.md#visibility). | 
   |||| 

3. Теперь определите запрос для действия.
  
   1. В разделе **Запрос** щелкните **Import from sample** (Импорт из примера). 

   2. На странице **Import from sample** (Импорт из примера) вставьте пример запроса. 

      Как правило, примеры запросов, а также сведения о параметрах **Verb** (Команда) и **URL-адрес**, полях **Заголовки** и **Текст** доступны в документации к API. Пример см. в [документации по API текстовой аналитики](https://westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c7).

      ![Импорт примера запроса](./media/logic-apps-custom-connector-register/import-sample-operation-request.png)

      > [!IMPORTANT]
      > Если вы создали соединитель из коллекции Postman, не забудьте удалить заголовок `Content-type` из действий и триггеров. Logic Apps автоматически добавляет этот заголовок. Кроме того, удалите определенные заголовки аутентификации действий и триггеров в разделе `Security`.

      Дополнительные сведения о других возможностях OpenAPI см. в статье о [расширениях OpenAPI для настраиваемых соединителей](../logic-apps/custom-connector-openapi-extensions.md).

   3. Чтобы завершить определение запроса, нажмите кнопку **Импорт**.

4. Теперь определите ответ для действия.

   1. В разделе **Ответ** можно указать ответ по умолчанию. 
   Щелкните **Add default response** (Добавить ответ по умолчанию).

   2. На странице **Import from sample** (Импорт из примера) вставьте пример запроса, а затем нажмите кнопку **Импорт**.

5. Наконец, в разделе **Проверка** просмотрите и исправьте все возможные проблемы, выявленные для действия.

#### <a name="edit-or-add-triggers-for-your-connector"></a>Изменение и добавление триггеров для соединителя

1. Чтобы изменить имеющийся триггер, выберите для него число. Чтобы добавить триггер, отсутствующий в файле OpenAPI или коллекции Postman, в разделе **Триггеры** щелкните **Новый триггер**.

2. В разделе **Общие** укажите или измените сведения для триггера:

   | Настройка | Рекомендуемое значение | Описание | 
   | ------- | --------------- | ----------- | 
   | **Сводка** | *имя-операции* | Название этого триггера. | 
   | **Описание** | *описание-операции* | Описание этого триггера. <p>**Совет**. В конце описания нужно поставить точку. | 
   | **ИД операции** | *идентификатор-операции* | Уникальное имя этого триггера. Используйте "верблюжий" стиль, например triggerOnGitHubPushEvent. | 
   |**Видимость**| **none** (нет), **advanced** (дополнительная), **internal** (внутренняя) или **important** (важно). | Видимость этого триггера в пользовательском интерфейсе. Дополнительные сведения см. в разделе о [расширениях OpenAPI](../logic-apps/custom-connector-openapi-extensions.md#visibility). | 
   | **Тип триггера** | **Веб-перехватчик** или **Polling** (Опрашивающий) | Тип этого триггера. Например, прежде чем сработать, триггер веб-перехватчика ожидает, пока произойдет определенное событие. Опрашивающий триггер регулярно проверяет конечную точку службы с указанными интервалом и частотой. <p>Дополнительные сведения о шаблонах триггера веб-перехватчика и опрашивающего триггера см. в статье о [создании настраиваемых API](../logic-apps/logic-apps-create-api-app.md). | 
   |||| 

3. Теперь определите запрос, который создает триггер. 

   1. В разделе **Запрос** щелкните **Import from sample** (Импорт из примера).

   2. На странице **Import from sample** (Импорт из примера) вставьте пример запроса. 

      Как правило, примеры запросов, а также сведения о параметрах **Verb** (Команда) и **URL-адрес**, полях **Заголовки** и **Текст** доступны в документации к API. Пример см. в [документации по API текстовой аналитики](https://westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c7).

      ![Импорт примера запроса](./media/logic-apps-custom-connector-register/import-sample-operation-request.png)

      > [!IMPORTANT]
      > Если вы создали соединитель из коллекции Postman, не забудьте удалить заголовок `Content-type` из действий и триггеров. Logic Apps автоматически добавляет этот заголовок. Кроме того, удалите определенные заголовки аутентификации действий и триггеров в разделе `Security`.

      Дополнительные сведения о других возможностях OpenAPI см. в статье о [расширениях OpenAPI для настраиваемых соединителей](../logic-apps/custom-connector-openapi-extensions.md).

   3. Чтобы завершить определение запроса, нажмите кнопку **Импорт**. 

4. Теперь определите ответ триггера. В разделе **Ответ** в зависимости от типа триггера выполните следующее:

   **Триггер веб-перехватчика**
   1. В **Webhook Response** (Ответ веб-перехватчика) щелкните **Импорт из примера**. 

   2. На странице **Import from sample** (Импорт из примера) вставьте пример запроса, а затем нажмите кнопку **Импорт**. Пример ответа см. в подразделе справочника API GitHub по созданию веб-перехватчика [здесь](https://developer.github.com/v3/repos/hooks/#create-a-hook).

   3. В разделе **Trigger configuration** (Конфигурация триггера) выберите параметр, который следует использовать запросу на создание веб-перехватчика. Logic Apps использует значение этого параметра, чтобы заполнить поле URL-адреса обратного вызова, который служба использует для взаимодействия с триггером.

   **Опрашивающий триггер**
   1. В разделе **Ответ** можно указать ответ по умолчанию. 
   Щелкните **Add default response** (Добавить ответ по умолчанию).

   2. На странице **Import from sample** (Импорт из примера) вставьте пример запроса, а затем нажмите кнопку **Импорт**.

   3. В разделе **Trigger configuration** (Конфигурация триггера) задайте параметр запроса, значение для параметра и *указание триггера*, определяющее правильный интервал опроса для следующего запроса.

5. Наконец, в разделе **Проверка** просмотрите и исправьте все возможные проблемы, выявленные для триггера.

#### <a name="review-reference-definitions-for-your-connector"></a>Просмотр определений ссылок для соединителя

Раздел **Ссылки** автоматически заполняется данными описания API, здесь также содержится описание всех полей параметров, на которые могут ссылаться действия и триггеры. 

1. В разделе **Ссылки** выберите число для определения ссылки, которую необходимо просмотреть.

2. В разделе **Имя** просмотрите или обновите имя определения ссылки.

3. В разделе **Проверка** просмотрите и исправьте все возможные проблемы, выявленные для определения ссылки.

## <a name="3-finish-creating-your-connector"></a>3. Завершение создания соединителя

Когда все будет готово, щелкните **Создать**, чтобы развернуть соединитель. Щелкните **Update connector** (Обновить соединитель), если необходимо обновить существующий соединитель.

Поздравляем! Теперь при создании приложения логики вы сможете найти соединитель в конструкторе Logic Apps и добавить его в свое приложение логики.

![Поиск соединителя в конструкторе Logic Apps](./media/logic-apps-custom-connector-register/custom-connector-created.png)

## <a name="share-your-connector-with-other-logic-apps-users"></a>Предоставление общего доступа к соединителю пользователям Logic Apps

Зарегистрированные, но несертифицированные пользовательские соединители работают как соединители, управляемые корпорацией Майкрософт. При этом они отображаются и доступны *только* своим создателям и пользователям с тем же клиентом Azure Active Directory и той же подпиской Azure для приложений логики в регионе, где развернуты эти приложения. Предоставление общего доступа не обязательно, но в некоторых сценариях может потребоваться использовать соединители совместно с другими пользователями. 

> [!IMPORTANT]
> Если предоставить общий доступ к соединителю, то у других пользователей может возникнуть зависимость от этого соединителя. 
> ***При удалении соединителя удаляются все подключения к нему.***
 
Чтобы предоставить общий доступ к соединителю для внешних пользователей, находящихся за этими пределами, например для всех пользователей Logic Apps, Flow и PowerApps, [отправьте соединитель на сертификацию Майкрософт](../logic-apps/custom-connector-submit-certification.md).

## <a name="faq"></a>Часто задаваемые вопросы

**В.** Есть ли ограничения для настраиваемых соединителей? </br>
**О.** Да, [ограничения для настраиваемых соединителей см. здесь](../logic-apps/logic-apps-limits-and-config.md#custom-connector-limits).

## <a name="get-support"></a>Получение поддержки

* Чтобы получить поддержку по разработке и подключению или запросить возможности, недоступные в мастере регистрации, обратитесь по адресу [condevhelp@microsoft.com](mailto:condevhelp@microsoft.com). Мы отслеживаем эту учетную запись на наличие вопросов от разработчиков и направляем их соответствующей группе поддержки.

* Чтобы задать вопросы или ответить на них, узнать, что делают другие пользователи, посетите [форум по Azure Logic Apps](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps).

* Чтобы улучшить Logic Apps, голосуйте за идеи или предлагайте собственные на [сайте обратной связи Logic Apps](http://aka.ms/logicapps-wish). 

## <a name="next-steps"></a>Дальнейшие действия

* [Отправка пользовательских соединителей на сертификацию Майкрософт](../logic-apps/custom-connector-submit-certification.md)
* [Часто задаваемые вопросы о настраиваемых соединителях](../logic-apps/custom-connector-faq.md)