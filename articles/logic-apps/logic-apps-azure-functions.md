---
title: "Применение пользовательского кода в Azure Logic Apps с помощью Функций Azure | Документация Майкрософт"
description: "Узнайте, как создавать и выполнять пользовательский код для Azure Logic Apps с помощью Функций Azure."
services: logic-apps,functions
documentationcenter: .net,nodejs,java
author: jeffhollan
manager: anneta
editor: 
ms.assetid: 9fab1050-cfbc-4a8b-b1b3-5531bee92856
ms.service: logic-apps
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: integration
ms.custom: H1Hack27Feb2017
ms.date: 10/18/2016
ms.author: LADocs; jehollan
ms.openlocfilehash: 18442c87b049200fac5ed41cc7034ba7a848b8d3
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="add-and-run-custom-code-for-logic-apps-through-azure-functions"></a>Добавление и выполнение пользовательского кода для приложений логики с помощью Функций Azure

Для выполнения пользовательских фрагментов кода C# или Node.js в приложениях логики можно с помощью Функций Azure создать пользовательские функции. 
[Функции Azure](../azure-functions/functions-overview.md) позволяют производить в Microsoft Azure вычисления без использования серверов. Они полезны для выполнения следующих задач:

* Расширенные функции форматирования или вычисления полей в приложениях логики.
* Выполнение вычислений в рабочем процессе.
* Расширение функциональных возможностей приложения логики с помощью функций, поддерживаемых в C# или Node.js.

## <a name="create-custom-functions-for-your-logic-apps"></a>Создание пользовательских функций для приложений логики

Мы рекомендуем создавать новые функции на портале функций Azure с помощью шаблона **Generic Webhook - Node** или **Generic Webhook - C#**. В результате создается автоматически заполняемый шаблон, который принимает `application/json` из приложения логики. Функции, которые создаются из этих шаблонов, обнаруживаются автоматически и отображаются в конструкторе приложений логики в разделе **Azure Functions in my region** (Функции Azure в моем регионе).

На портале Azure в области **Интегрировать** функции для шаблона должен отображаться **Режим** **Веб-перехватчик**, а **Тип webhook** — **Generic JSON** (Универсальный JSON). 

Функции веб-перехватчика принимают запрос и передают его методу в виде переменной `data` . Для доступа к свойствам рабочей нагрузки можно использовать запись с точками типа `data.function-name`. Вот пример простой функции JavaScript, которая преобразует значение DateTime в строку даты:

```
function start(req, res){
    var data = req.body;
    res = {
        body: data.date.ToDateString();
    }
}
```

## <a name="call-azure-functions-from-logic-apps"></a>Вызов Функций Azure из приложений логики

Для перечисления контейнеров в подписке и выбора функции, которую необходимо вызвать, в конструкторе приложений логики щелкните меню **Действия** и выберите функцию из списка **Azure Functions in my Region** (Функции Azure в моем регионе).

После выбора функции вам будет предложено указать объект входных данных. Этот объект — сообщение, которое приложение логики передает функции и которое должно быть объектом в формате JSON. Например, если вы хотите передать **дату последнего изменения** из триггера Salesforce, то полезные данные функции могут выглядеть как в этом примере:

![Дата последнего изменения][1]

## <a name="trigger-logic-apps-from-a-function"></a>Запуск приложения логики из функции

Приложение логики можно запустить из функции. Ознакомьтесь со статьей [Приложения логики как вызываемые конечные точки](logic-apps-http-endpoint.md). Создайте приложение логики с ручным триггером. Затем из функции создайте HTTP-запрос POST к URL-адресу ручного триггера, включающий полезные данные, которые нужно отправить в приложение логики.

### <a name="create-a-function-from-logic-app-designer"></a>Создание функции из конструктора приложений логики

Функцию webhook node.js можно также создать из конструктора. Для начала выберите раздел **Функции Azure в моем регионе** , а затем контейнер для своей функции. Если у вас еще нет контейнера, его необходимо создать на [портале функций Azure](https://functions.azure.com/signin). Щелкните **Создать**.  

Чтобы создать шаблон на основе данных для вычисления, укажите объект контекста, который будет передан в функцию. Это должен быть объект JSON. Например, если передать содержимое файла из действия FTP, то полезные данные контекста будут выглядеть как в этом примере:

![Полезные данные контекста][2]

> [!NOTE]
> Поскольку для объекта не выполнялось приведение к строковому типу, содержимое добавляется непосредственно в полезные данные JSON. Но если объект не является маркером JSON (т. е. строкой, объектом или массивом JSON), то возникает ошибка. Чтобы преобразовать объект в строку, заключите его в кавычки, как показано на первом рисунке в этой статье.
> 

Затем конструктор создаст шаблон функции, который позволит создавать встроенные функции. Переменные создаются заранее в зависимости от содержимого, которое вы планируете передать в функцию.

<!--Image references-->
[1]: ./media/logic-apps-azure-functions/callfunction.png
[2]: ./media/logic-apps-azure-functions/createfunction.png
