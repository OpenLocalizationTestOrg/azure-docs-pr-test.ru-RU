---
title: "Доставка содержимого клиентам | Документация Майкрософт"
description: "В этой статье представлен обзор доставки содержимого с помощью служб мультимедиа Azure."
services: media-services
documentationcenter: 
author: Juliako
manager: cfowler
editor: 
ms.assetid: 89ede54a-6a9c-4814-9858-dcfbb5f4fed5
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/29/2017
ms.author: juliako
ms.openlocfilehash: 46dccd5a50b6dc7c7a93700b8fae554587385031
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="deliver-content-to-customers"></a><span data-ttu-id="fac48-103">Доставка содержимого клиентам</span><span class="sxs-lookup"><span data-stu-id="fac48-103">Deliver content to customers</span></span>
<span data-ttu-id="fac48-104">При доставке содержимого клиентам в виде потоковой трансляции или видео по запросу ваша задача — доставлять видео высокого качества для различных устройств в разных сетевых условиях.</span><span class="sxs-lookup"><span data-stu-id="fac48-104">When you're delivering your streaming or video-on-demand content to customers, your goal is to deliver high-quality video to various devices under different network conditions.</span></span>

<span data-ttu-id="fac48-105">Для достижения этой цели можно сделать следующее.</span><span class="sxs-lookup"><span data-stu-id="fac48-105">To achieve this goal, you can:</span></span>

* <span data-ttu-id="fac48-106">Можно кодировать поток в видеопоток с разными скоростями (с переменной скоростью).</span><span class="sxs-lookup"><span data-stu-id="fac48-106">Encode your stream to a multi-bitrate (adaptive bitrate) video stream.</span></span> <span data-ttu-id="fac48-107">Это позволит соблюдать различные уровни качества и условия сети.</span><span class="sxs-lookup"><span data-stu-id="fac48-107">This will take care of quality and network conditions.</span></span>
* <span data-ttu-id="fac48-108">Можно также использовать [динамическую упаковку](media-services-dynamic-packaging-overview.md) служб мультимедиа Microsoft Azure для динамической перепаковки потока в разные протоколы.</span><span class="sxs-lookup"><span data-stu-id="fac48-108">Use Microsoft Azure Media Services [dynamic packaging](media-services-dynamic-packaging-overview.md) to dynamically re-package your stream into different protocols.</span></span> <span data-ttu-id="fac48-109">Это позволит транслировать поток на разных устройствах.</span><span class="sxs-lookup"><span data-stu-id="fac48-109">This will take care of streaming on different devices.</span></span> <span data-ttu-id="fac48-110">Службы мультимедиа поддерживают доставку данных в следующих форматах потоковой передачи с переменной скоростью: HTTP Live Streaming (HLS), Smooth Streaming и MPEG-DASH.</span><span class="sxs-lookup"><span data-stu-id="fac48-110">Media Services supports delivery of the following adaptive bitrate streaming technologies: HTTP Live Streaming (HLS), Smooth Streaming, and MPEG-DASH.</span></span>

>[!NOTE]
><span data-ttu-id="fac48-111">При создании учетной записи AMS в нее добавляется конечная точка потоковой передачи **по умолчанию** в состоянии **Остановлена**.</span><span class="sxs-lookup"><span data-stu-id="fac48-111">When your AMS account is created a **default** streaming endpoint is added to your account in the **Stopped** state.</span></span> <span data-ttu-id="fac48-112">Чтобы начать потоковую передачу содержимого и воспользоваться динамической упаковкой и динамическим шифрованием, конечная точка потоковой передачи, из которой необходимо выполнять потоковую передачу содержимого, должна находиться в состоянии **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="fac48-112">To start streaming your content and take advantage of dynamic packaging and dynamic encryption, the streaming endpoint from which you want to stream content has to be in the **Running** state.</span></span> 

<span data-ttu-id="fac48-113">В этой статье приводится обзор важных понятий, связанных с доставкой содержимого.</span><span class="sxs-lookup"><span data-stu-id="fac48-113">This article gives an overview of important content delivery concepts.</span></span>

<span data-ttu-id="fac48-114">Сведения об известных проблемах см. в разделе [Известные проблемы](media-services-deliver-content-overview.md#known-issues).</span><span class="sxs-lookup"><span data-stu-id="fac48-114">To check known issues, see [Known issues](media-services-deliver-content-overview.md#known-issues).</span></span>

## <a name="dynamic-packaging"></a><span data-ttu-id="fac48-115">Динамическая упаковка</span><span class="sxs-lookup"><span data-stu-id="fac48-115">Dynamic packaging</span></span>
<span data-ttu-id="fac48-116">Применение динамической упаковки служб мультимедиа позволяет доставлять закодированное содержимое MP4-файлов с переменной скоростью или содержимое Smooth Streaming в форматах потоковой передачи с поддержкой служб мультимедиа (MPEG-DASH, HLS, Smooth Streaming) без необходимости перепаковки в эти форматы.</span><span class="sxs-lookup"><span data-stu-id="fac48-116">With the dynamic packaging that Media Services provides, you can deliver your adaptive bitrate MP4 or Smooth Streaming encoded content in streaming formats supported by Media Services (MPEG-DASH, HLS, Smooth Streaming,) without having to re-package into these streaming formats.</span></span> <span data-ttu-id="fac48-117">Мы рекомендуем доставлять содержимое с помощью динамической упаковки.</span><span class="sxs-lookup"><span data-stu-id="fac48-117">We recommend delivering your content with dynamic packaging.</span></span>

<span data-ttu-id="fac48-118">Чтобы воспользоваться динамической упаковкой, закодируйте мезонинный (исходный) файл в набор файлов формата MP4 или потоковой передачи Smooth Streaming с переменной скоростью.</span><span class="sxs-lookup"><span data-stu-id="fac48-118">To take advantage of dynamic packaging, you need to encode your mezzanine (source) file into a set of adaptive-bitrate MP4 files or adaptive bitrate Smooth Streaming files.</span></span>

<span data-ttu-id="fac48-119">Используя динамическую упаковку, можно хранить и оплачивать файлы в одном формате хранения.</span><span class="sxs-lookup"><span data-stu-id="fac48-119">With dynamic packaging, you store and pay for the files in single storage format.</span></span> <span data-ttu-id="fac48-120">Службы мультимедиа будут создавать и обрабатывать соответствующий ответ с учетом ваших запросов.</span><span class="sxs-lookup"><span data-stu-id="fac48-120">Media Services will build and serve the appropriate response based on your requests.</span></span>

<span data-ttu-id="fac48-121">Динамическая упаковка доступна для конечных точек потоковой передачи уровня "Стандартный" и "Премиум".</span><span class="sxs-lookup"><span data-stu-id="fac48-121">Dynamic packaging is available for standard and premium streaming endpoints.</span></span> 

<span data-ttu-id="fac48-122">Чтобы узнать больше, ознакомьтесь со [Dynamic packaging](media-services-dynamic-packaging-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fac48-122">For more information, see [Dynamic packaging](media-services-dynamic-packaging-overview.md).</span></span>

## <a name="filters-and-dynamic-manifests"></a><span data-ttu-id="fac48-123">Фильтры и динамические манифесты</span><span class="sxs-lookup"><span data-stu-id="fac48-123">Filters and dynamic manifests</span></span>
<span data-ttu-id="fac48-124">Службы мультимедиа позволяют определять фильтры для ресурсов-контейнеров.</span><span class="sxs-lookup"><span data-stu-id="fac48-124">You can define filters for your assets with Media Services.</span></span> <span data-ttu-id="fac48-125">Эти фильтры представляют собой правила на стороне сервера, помогающие пользователям выполнять такие действия, как воспроизведение определенной части видео или указание подмножества представлений аудио и видео, которые может обрабатывать устройство клиента (вместо всех представлений, связанных с ресурсом-контейнером).</span><span class="sxs-lookup"><span data-stu-id="fac48-125">These filters are server-side rules that help your customers do things like play a specific section of a video or specify a subset of audio and video renditions that your customer's device can handle (instead of all the renditions that are associated with the asset).</span></span> <span data-ttu-id="fac48-126">Такая фильтрация осуществляется с помощью *динамических манифестов* , которые создаются, когда клиент запрашивает потоковую передачу видео на основе одного или нескольких указанных фильтров.</span><span class="sxs-lookup"><span data-stu-id="fac48-126">This filtering is achieved through *dynamic manifests* that are created when your customer requests to stream a video based on one or more specified filters.</span></span>

<span data-ttu-id="fac48-127">Чтобы узнать больше, ознакомьтесь со [Фильтры и динамические манифесты](media-services-dynamic-manifest-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fac48-127">For more information, see [Filters and dynamic manifests](media-services-dynamic-manifest-overview.md).</span></span>

## <a name="locators"></a><span data-ttu-id="fac48-128">Локаторы</span><span class="sxs-lookup"><span data-stu-id="fac48-128">Locators</span></span>
<span data-ttu-id="fac48-129">Чтобы предоставить пользователю URL-адрес, который можно использовать для потоковой передачи или скачивания содержимого, сначала необходимо опубликовать ресурс-контейнер, создав указатель.</span><span class="sxs-lookup"><span data-stu-id="fac48-129">To provide your user with a URL that can be used to stream or download your content, you first need to publish your asset by creating a locator.</span></span> <span data-ttu-id="fac48-130">Указатель предоставляет точку входа для доступа к файлам в ресурсе-контейнере.</span><span class="sxs-lookup"><span data-stu-id="fac48-130">A locator provides an entry point to access the files contained in an asset.</span></span> <span data-ttu-id="fac48-131">Службы мультимедиа поддерживают два типа указателей:</span><span class="sxs-lookup"><span data-stu-id="fac48-131">Media Services supports two types of locators:</span></span>

* <span data-ttu-id="fac48-132">Указатели OnDemandOrigin.</span><span class="sxs-lookup"><span data-stu-id="fac48-132">OnDemandOrigin locators.</span></span> <span data-ttu-id="fac48-133">Они используются для потоковой передачи мультимедиа (например, в формате MPEG DASH, HLS или Smooth Streaming) или поэтапной загрузки файлов.</span><span class="sxs-lookup"><span data-stu-id="fac48-133">These are used to stream media (for example, MPEG-DASH, HLS, or Smooth Streaming) or progressively download files.</span></span>
* <span data-ttu-id="fac48-134">Указатели подписанного URL-адреса (SAS).</span><span class="sxs-lookup"><span data-stu-id="fac48-134">Shared access signature (SAS) URL locators.</span></span> <span data-ttu-id="fac48-135">Они используются для скачивания файлов мультимедиа на локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="fac48-135">These are used to download media files to your local computer.</span></span>

<span data-ttu-id="fac48-136">*Политика доступа* используется для определения разрешений (например, для чтения, записи и перечисления) и длительности доступа клиента к определенному ресурсу-контейнеру.</span><span class="sxs-lookup"><span data-stu-id="fac48-136">An *access policy* is used to define the permissions (such as read, write, and list) and duration for which a client has access for a particular asset.</span></span> <span data-ttu-id="fac48-137">Обратите внимание, что разрешение перечисления (AccessPermissions.List) не следует использовать при создании указателя OrDemandOrigin.</span><span class="sxs-lookup"><span data-stu-id="fac48-137">Note that the list permission (AccessPermissions.List) should not be used in creating an OrDemandOrigin locator.</span></span>

<span data-ttu-id="fac48-138">Указатели имеют срок действия.</span><span class="sxs-lookup"><span data-stu-id="fac48-138">Locators have expiration dates.</span></span> <span data-ttu-id="fac48-139">Портал Azure задает для указателей срок действия в 100 лет.</span><span class="sxs-lookup"><span data-stu-id="fac48-139">The Azure portal sets an expiration date 100 years in the future for locators.</span></span>

> [!NOTE]
> <span data-ttu-id="fac48-140">Если вы создавали указатели на портале Azure до марта 2015 года, то их срок действия составлял два года.</span><span class="sxs-lookup"><span data-stu-id="fac48-140">If you used the Azure portal to create locators before March 2015, those locators were set to expire after two years.</span></span>
> 
> 

<span data-ttu-id="fac48-141">Чтобы обновить срок действия указателя, используйте [REST API](https://docs.microsoft.com/rest/api/media/operations/locator#update_a_locator) или [.NET API](http://go.microsoft.com/fwlink/?LinkID=533259).</span><span class="sxs-lookup"><span data-stu-id="fac48-141">To update an expiration date on a locator, use [REST](https://docs.microsoft.com/rest/api/media/operations/locator#update_a_locator) or [.NET](http://go.microsoft.com/fwlink/?LinkID=533259) APIs.</span></span> <span data-ttu-id="fac48-142">Обратите внимание, что при обновлении срока действия указателя SAS изменяется URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="fac48-142">Note that when you update the expiration date of a SAS locator, the URL changes.</span></span>

<span data-ttu-id="fac48-143">Указатели не предназначены для управления доступом на уровне пользователей.</span><span class="sxs-lookup"><span data-stu-id="fac48-143">Locators are not designed to manage per-user access control.</span></span> <span data-ttu-id="fac48-144">Вы можете предоставлять различные права доступа отдельным пользователям, используя решения для управления цифровыми правами.</span><span class="sxs-lookup"><span data-stu-id="fac48-144">You can give different access rights to individual users by using Digital Rights Management (DRM) solutions.</span></span> <span data-ttu-id="fac48-145">Дополнительные сведения см. в разделе [Службы мультимедиа — потоковая передача по запросу](http://msdn.microsoft.com/library/azure/dn282272.aspx).</span><span class="sxs-lookup"><span data-stu-id="fac48-145">For more information, see [Securing Media](http://msdn.microsoft.com/library/azure/dn282272.aspx).</span></span>

<span data-ttu-id="fac48-146">При создании указателя может возникать 30-секундная задержка из-за необходимых процессов сохранения и распространения в службе хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="fac48-146">When you create a locator, there may be a 30-second delay due to required storage and propagation processes in Azure Storage.</span></span>

## <a name="adaptive-streaming"></a><span data-ttu-id="fac48-147">Адаптивная потоковая передача</span><span class="sxs-lookup"><span data-stu-id="fac48-147">Adaptive streaming</span></span>
<span data-ttu-id="fac48-148">Технологии передачи с переменной скоростью позволяют видеопроигрывателю определить условия работы сети и выбрать одну из нескольких скоростей.</span><span class="sxs-lookup"><span data-stu-id="fac48-148">Adaptive bitrate technologies allow video player applications to determine network conditions and select from several bitrates.</span></span> <span data-ttu-id="fac48-149">Если условия передачи в сети ухудшаются, клиент может выбрать более низкую скорость, позволяя видеопроигрывателю продолжать воспроизводить видео в более низком качестве.</span><span class="sxs-lookup"><span data-stu-id="fac48-149">When network communication degrades, the client can select a lower bitrate so playback can continue with lower video quality.</span></span> <span data-ttu-id="fac48-150">Если состояние сети улучшается, то клиент может переключиться на более высокую скорость с более высоким качеством видео.</span><span class="sxs-lookup"><span data-stu-id="fac48-150">As network conditions improve, the client can switch to a higher bitrate with improved video quality.</span></span> <span data-ttu-id="fac48-151">Службы мультимедиа Azure поддерживают следующие технологии передачи с переменной скоростью: HTTP Live Streaming (HLS), Smooth Streaming и MPEG-DASH.</span><span class="sxs-lookup"><span data-stu-id="fac48-151">Azure Media Services supports the following adaptive bitrate technologies: HTTP Live Streaming (HLS), Smooth Streaming, and MPEG-DASH.</span></span>

<span data-ttu-id="fac48-152">Чтобы предоставить пользователям URL-адреса потоковой передачи, сначала необходимо создать указатель OnDemandOrigin.</span><span class="sxs-lookup"><span data-stu-id="fac48-152">To provide users with streaming URLs, you first must create an OnDemandOrigin locator.</span></span> <span data-ttu-id="fac48-153">При создании указателя вы получите базовый путь к ресурсу-контейнеру, в котором находится содержимое для потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="fac48-153">Creating the locator gives you the base path to the asset that contains the content you want to stream.</span></span> <span data-ttu-id="fac48-154">Тем не менее, чтобы получить возможность потоковой передачи содержимого, необходимо изменить этот путь.</span><span class="sxs-lookup"><span data-stu-id="fac48-154">However, to be able to stream this content, you need to modify this path further.</span></span> <span data-ttu-id="fac48-155">Чтобы сформировать полный URL-адрес к файлу манифеста потоковой передачи, необходимо сцепить значение пути указателя и имя файла манифеста (filename.ism).</span><span class="sxs-lookup"><span data-stu-id="fac48-155">To construct a full URL to the streaming manifest file, you must concatenate the locator’s path value and the manifest (filename.ism) file name.</span></span> <span data-ttu-id="fac48-156">Затем добавьте **/Manifest** и соответствующий формат (если нужно) в путь указателя.</span><span class="sxs-lookup"><span data-stu-id="fac48-156">Then append **/Manifest** and an appropriate format (if needed) to the locator path.</span></span>

> [!NOTE]
> <span data-ttu-id="fac48-157">Также по SSL-подключению можно выполнять потоковую передачу содержимого.</span><span class="sxs-lookup"><span data-stu-id="fac48-157">You can also stream your content over an SSL connection.</span></span> <span data-ttu-id="fac48-158">Для этого убедитесь, что URL-адреса потоковой передачи начинаются с HTTPS.</span><span class="sxs-lookup"><span data-stu-id="fac48-158">To do this, make sure your streaming URLs start with HTTPS.</span></span> <span data-ttu-id="fac48-159">Обратите внимание, что в настоящее время AMS не поддерживает SSL для личных доменов.</span><span class="sxs-lookup"><span data-stu-id="fac48-159">Note that, currently, AMS doesn’t support SSL with custom domains.</span></span>  
> 


<span data-ttu-id="fac48-160">Потоковая передача через подключение SSL возможна только в том случае, если конечная точка потоковой передачи, из которой доставляется содержимое, была создана после 10 сентября 2014 года.</span><span class="sxs-lookup"><span data-stu-id="fac48-160">You can only stream over SSL if the streaming endpoint from which you deliver your content was created after September 10th, 2014.</span></span> <span data-ttu-id="fac48-161">Если URL-адреса потоковой передачи основаны на конечных точках потоковой передачи, созданных после 10 сентября 2014 года, то они содержат "streaming.mediaservices.windows.net".</span><span class="sxs-lookup"><span data-stu-id="fac48-161">If your streaming URLs are based on the streaming endpoints created after September 10th, 2014, the URL contains “streaming.mediaservices.windows.net.”</span></span> <span data-ttu-id="fac48-162">URL-адреса потоковой передачи, который содержат "origin.mediaservices.windows.net" (старый формат), не поддерживают SSL.</span><span class="sxs-lookup"><span data-stu-id="fac48-162">Streaming URLs that contain “origin.mediaservices.windows.net” (the old format) do not support SSL.</span></span> <span data-ttu-id="fac48-163">Если URL-адрес имеет старый формат и необходимо организовать передачу через SSL, нужно создать новую конечную точку.</span><span class="sxs-lookup"><span data-stu-id="fac48-163">If your URL is in the old format and you want to be able to stream over SSL, create a new streaming endpoint.</span></span> <span data-ttu-id="fac48-164">Используйте URL-адреса на основе новой конечной точки потоковой передачи для потоковой передачи содержимого через подключение SSL.</span><span class="sxs-lookup"><span data-stu-id="fac48-164">Use URLs based on the new streaming endpoint to stream your content over SSL.</span></span>

## <a name="streaming-url-formats"></a><span data-ttu-id="fac48-165">Форматы URL-адресов потоковой передачи</span><span class="sxs-lookup"><span data-stu-id="fac48-165">Streaming URL formats</span></span>
### <a name="mpeg-dash-format"></a><span data-ttu-id="fac48-166">Формат MPEG-DASH</span><span class="sxs-lookup"><span data-stu-id="fac48-166">MPEG-DASH format</span></span>
<span data-ttu-id="fac48-167">{имя конечной точки потоковой передачи - имя учетной записи служб мультимедиа}.streaming.mediaservices.windows.net/{идентификатор указателя}/{имя файла}.ism/Manifest(format=mpd-time-csf)</span><span class="sxs-lookup"><span data-stu-id="fac48-167">{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=mpd-time-csf)</span></span>

<span data-ttu-id="fac48-168">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=mpd-time-csf)</span><span class="sxs-lookup"><span data-stu-id="fac48-168">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=mpd-time-csf)</span></span>

### <a name="apple-http-live-streaming-hls-v4-format"></a><span data-ttu-id="fac48-169">Формат Apple HTTP Live Streaming (HLS) V4</span><span class="sxs-lookup"><span data-stu-id="fac48-169">Apple HTTP Live Streaming (HLS) V4 format</span></span>
<span data-ttu-id="fac48-170">{имя конечной точки потоковой передачи - имя учетной записи служб мультимедиа}.streaming.mediaservices.windows.net/{идентификатор указателя}/{имя файла}.ism/Manifest(format=m3u8-aapl)</span><span class="sxs-lookup"><span data-stu-id="fac48-170">{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=m3u8-aapl)</span></span>

<span data-ttu-id="fac48-171">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl)</span><span class="sxs-lookup"><span data-stu-id="fac48-171">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl)</span></span>

### <a name="apple-http-live-streaming-hls-v3-format"></a><span data-ttu-id="fac48-172">Формат Apple HTTP Live Streaming (HLS) V3</span><span class="sxs-lookup"><span data-stu-id="fac48-172">Apple HTTP Live Streaming (HLS) V3 format</span></span>
<span data-ttu-id="fac48-173">{имя конечной точки потоковой передачи - имя учетной записи служб мультимедиа}.streaming.mediaservices.windows.net/{идентификатор указателя}/{имя файла}.ism/Manifest(format=m3u8-aapl-v3)</span><span class="sxs-lookup"><span data-stu-id="fac48-173">{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=m3u8-aapl-v3)</span></span>

<span data-ttu-id="fac48-174">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl-v3)</span><span class="sxs-lookup"><span data-stu-id="fac48-174">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl-v3)</span></span>

### <a name="apple-http-live-streaming-hls-format-with-audio-only-filter"></a><span data-ttu-id="fac48-175">Формат Apple HTTP Live Streaming (HLS) с фильтром "только аудио"</span><span class="sxs-lookup"><span data-stu-id="fac48-175">Apple HTTP Live Streaming (HLS) format with audio-only filter</span></span>
<span data-ttu-id="fac48-176">По умолчанию дорожки, содержащие только аудио, включены в манифест HLS.</span><span class="sxs-lookup"><span data-stu-id="fac48-176">By default, audio-only tracks are included in the HLS manifest.</span></span> <span data-ttu-id="fac48-177">Это требуется для сертификации магазина Apple для сетей мобильной связи.</span><span class="sxs-lookup"><span data-stu-id="fac48-177">This is required for Apple Store certification for cellular networks.</span></span> <span data-ttu-id="fac48-178">В этом случае, если клиент не имеет достаточную пропускную способность или подключен через сеть 2G, то он переключается на воспроизведение только аудио дорожки.</span><span class="sxs-lookup"><span data-stu-id="fac48-178">In this case, if a client doesn’t have sufficient bandwidth or is connected over a 2G connection, playback switches to audio-only.</span></span> <span data-ttu-id="fac48-179">Это позволяет осуществлять потоковую передачу содержимого без необходимости буферизации, но и видео при этом не отображается.</span><span class="sxs-lookup"><span data-stu-id="fac48-179">This helps to keep content streaming without buffering, but there is no video.</span></span> <span data-ttu-id="fac48-180">В некоторых сценариях буферизация проигрывателя может быть предпочтительнее воспроизведения лишь аудио дорожки.</span><span class="sxs-lookup"><span data-stu-id="fac48-180">In some scenarios, player buffering might be preferred over audio-only.</span></span> <span data-ttu-id="fac48-181">Для удаления дорожки, содержащей только аудио, добавьте к URL-адресу **audio-only=false** .</span><span class="sxs-lookup"><span data-stu-id="fac48-181">If you want to remove the audio-only track, add **audio-only=false** to the URL.</span></span>

<span data-ttu-id="fac48-182">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl-v3,audio-only=false)</span><span class="sxs-lookup"><span data-stu-id="fac48-182">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl-v3,audio-only=false)</span></span>

<span data-ttu-id="fac48-183">Дополнительные сведения см. в записи блога [Azure Media Services – Dynamic Manifest Composition support and HLS output additional features](https://azure.microsoft.com/blog/azure-media-services-release-dynamic-manifest-composition-remove-hls-audio-only-track-and-hls-i-frame-track-support/) (Службы мультимедиа Azure — поддержка динамического создания манифестов и дополнительные функции вывода HLS).</span><span class="sxs-lookup"><span data-stu-id="fac48-183">For more information, see [Dynamic Manifest Composition support and HLS output additional features](https://azure.microsoft.com/blog/azure-media-services-release-dynamic-manifest-composition-remove-hls-audio-only-track-and-hls-i-frame-track-support/).</span></span>

### <a name="smooth-streaming-format"></a><span data-ttu-id="fac48-184">Формат Smooth Streaming</span><span class="sxs-lookup"><span data-stu-id="fac48-184">Smooth Streaming format</span></span>
<span data-ttu-id="fac48-185">{имя конечной точки потоковой передачи - имя учетной записи служб мультимедиа}.streaming.mediaservices.windows.net/{идентификатор указателя}/{имя файла}.ism/Manifest</span><span class="sxs-lookup"><span data-stu-id="fac48-185">{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest</span></span>

<span data-ttu-id="fac48-186">Пример:</span><span class="sxs-lookup"><span data-stu-id="fac48-186">Example:</span></span>

<span data-ttu-id="fac48-187">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest</span><span class="sxs-lookup"><span data-stu-id="fac48-187">http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest</span></span>

### <span data-ttu-id="fac48-188"><a id="fmp4_v20"></a>Манифест Smooth Streaming 2.0 (манифест прежних версий)</span><span class="sxs-lookup"><span data-stu-id="fac48-188"><a id="fmp4_v20"></a>Smooth Streaming 2.0 manifest (legacy manifest)</span></span>
<span data-ttu-id="fac48-189">По умолчанию формат манифеста Smooth Streaming содержит тег повтора (r-tag).</span><span class="sxs-lookup"><span data-stu-id="fac48-189">By default, Smooth Streaming manifest format contains the repeat tag (r-tag).</span></span> <span data-ttu-id="fac48-190">Однако некоторые проигрыватели не поддерживают r-tag.</span><span class="sxs-lookup"><span data-stu-id="fac48-190">However, some players do not support the r-tag.</span></span> <span data-ttu-id="fac48-191">Клиенты с этими проигрывателями могут использовать формат, который отключает r-tag.</span><span class="sxs-lookup"><span data-stu-id="fac48-191">Clients with these players can use a format that disables the r-tag:</span></span>

<span data-ttu-id="fac48-192">{имя конечной точки потоковой передачи - имя учетной записи служб мультимедиа}.streaming.mediaservices.windows.net/{идентификатор указателя}/{имя файла}.ism/Manifest(format=fmp4-v20)</span><span class="sxs-lookup"><span data-stu-id="fac48-192">{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=fmp4-v20)</span></span>

    http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=fmp4-v20)

## <a name="progressive-download"></a><span data-ttu-id="fac48-193">Прогрессивное скачивание</span><span class="sxs-lookup"><span data-stu-id="fac48-193">Progressive download</span></span>
<span data-ttu-id="fac48-194">Поэтапная загрузка позволяет начать воспроизведение мультимедиа до окончания скачивания всего файла.</span><span class="sxs-lookup"><span data-stu-id="fac48-194">With progressive download, you can start playing media before the entire file has been downloaded.</span></span> <span data-ttu-id="fac48-195">ISMV-, ISMA-, ISMT- и ISMC-файлы не могут быть загружены поэтапно.</span><span class="sxs-lookup"><span data-stu-id="fac48-195">You cannot progressively download .ism* (ismv, isma, ismt, or ismc) files.</span></span>

<span data-ttu-id="fac48-196">Для последовательной загрузки содержимого используйте тип указателя OnDemandOrigin.</span><span class="sxs-lookup"><span data-stu-id="fac48-196">To progressively download content, use the OnDemandOrigin type of locator.</span></span> <span data-ttu-id="fac48-197">В следующем примере показан URL-адрес, основанный на типе указателя OnDemandOrigin.</span><span class="sxs-lookup"><span data-stu-id="fac48-197">The following example shows the URL that is based on the OnDemandOrigin type of locator:</span></span>

    http://amstest1.streaming.mediaservices.windows.net/3c5fe676-199c-4620-9b03-ba014900f214/BigBuckBunny_H264_650kbps_AAC_und_ch2_96kbps.mp4

<span data-ttu-id="fac48-198">Необходимо расшифровать все зашифрованные в хранилище ресурсы-контейнеры, которые требуется передать из исходной службы для поэтапной загрузки.</span><span class="sxs-lookup"><span data-stu-id="fac48-198">You must decrypt any storage-encrypted assets that you want to stream from the origin service for progressive download.</span></span>

## <a name="download"></a><span data-ttu-id="fac48-199">Загрузить</span><span class="sxs-lookup"><span data-stu-id="fac48-199">Download</span></span>
<span data-ttu-id="fac48-200">Для скачивания содержимого на клиентское устройство необходимо создать указатель SAS.</span><span class="sxs-lookup"><span data-stu-id="fac48-200">To download your content to a client device, you must create a SAS Locator.</span></span> <span data-ttu-id="fac48-201">Он предоставляет доступ к контейнеру службы хранилища Azure, в котором расположен ваш файл.</span><span class="sxs-lookup"><span data-stu-id="fac48-201">The SAS locator gives you access to the Azure Storage container where your file is located.</span></span> <span data-ttu-id="fac48-202">Чтобы создать URL-адрес загрузки, необходимо вставить имя файла между узлом и подписью SAS.</span><span class="sxs-lookup"><span data-stu-id="fac48-202">To build the download URL, you have to embed the file name between the host and SAS signature.</span></span>

<span data-ttu-id="fac48-203">В следующем примере показан URL-адрес, основанный на типе указателя SAS.</span><span class="sxs-lookup"><span data-stu-id="fac48-203">The following example shows the URL that is based on the SAS locator:</span></span>

    https://test001.blob.core.windows.net/asset-ca7a4c3f-9eb5-4fd8-a898-459cb17761bd/BigBuckBunny.mp4?sv=2012-02-12&se=2014-05-03T01%3A23%3A50Z&sr=c&si=7c093e7c-7dab-45b4-beb4-2bfdff764bb5&sig=msEHP90c6JHXEOtTyIWqD7xio91GtVg0UIzjdpFscHk%3D

<span data-ttu-id="fac48-204">Действительны следующие условия.</span><span class="sxs-lookup"><span data-stu-id="fac48-204">The following considerations apply:</span></span>

* <span data-ttu-id="fac48-205">Необходимо расшифровать все зашифрованные в хранилище ресурсы-контейнеры, которые требуется передать из исходной службы для поэтапной загрузки.</span><span class="sxs-lookup"><span data-stu-id="fac48-205">You must decrypt any storage-encrypted assets that you want to stream from the origin service for progressive download.</span></span>
* <span data-ttu-id="fac48-206">Процесс скачивания, не завершенный в течение 12 часов, завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="fac48-206">A download that has not finished within 12 hours will fail.</span></span>

## <a name="streaming-endpoints"></a><span data-ttu-id="fac48-207">Конечные точки потоковой передачи</span><span class="sxs-lookup"><span data-stu-id="fac48-207">Streaming endpoints</span></span>

<span data-ttu-id="fac48-208">Конечная точка потоковой передачи — это служба потоковой передачи, которая может доставить содержимое непосредственно в клиентское приложение проигрывателя или в сеть доставки содержимого (CDN) для дальнейшего распространения.</span><span class="sxs-lookup"><span data-stu-id="fac48-208">A streaming endpoint represents a streaming service that can deliver content directly to a client player application or to a content delivery network (CDN) for further distribution.</span></span> <span data-ttu-id="fac48-209">Исходящим потоком службы конечной точки потоковой передачи может быть динамический поток или ресурс-контейнер видео по запросу в учетной записи служб мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="fac48-209">The outbound stream from a streaming endpoint service can be a live stream or a video-on-demand asset in your Media Services account.</span></span> <span data-ttu-id="fac48-210">Существует два типа конечных точек потоковой передачи: **стандартные** и **Премиум**.</span><span class="sxs-lookup"><span data-stu-id="fac48-210">There are two types of streaming endpoints, **standard** and **premium**.</span></span> <span data-ttu-id="fac48-211">Дополнительные сведения см. в статье [Общие сведения о конечных точках потоковой передачи](media-services-streaming-endpoints-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fac48-211">For more information, see [Streaming endpoints overview](media-services-streaming-endpoints-overview.md).</span></span>

>[!NOTE]
><span data-ttu-id="fac48-212">При создании учетной записи AMS в нее добавляется конечная точка потоковой передачи **по умолчанию** в состоянии **Остановлена**.</span><span class="sxs-lookup"><span data-stu-id="fac48-212">When your AMS account is created a **default** streaming endpoint is added to your account in the **Stopped** state.</span></span> <span data-ttu-id="fac48-213">Чтобы начать потоковую передачу содержимого и воспользоваться динамической упаковкой и динамическим шифрованием, конечная точка потоковой передачи, из которой необходимо выполнять потоковую передачу содержимого, должна находиться в состоянии **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="fac48-213">To start streaming your content and take advantage of dynamic packaging and dynamic encryption, the streaming endpoint from which you want to stream content has to be in the **Running** state.</span></span> 

## <a name="known-issues"></a><span data-ttu-id="fac48-214">Известные проблемы</span><span class="sxs-lookup"><span data-stu-id="fac48-214">Known issues</span></span>
### <a name="changes-to-smooth-streaming-manifest-version"></a><span data-ttu-id="fac48-215">Изменения в версии манифеста Smooth Streaming</span><span class="sxs-lookup"><span data-stu-id="fac48-215">Changes to Smooth Streaming manifest version</span></span>
<span data-ttu-id="fac48-216">До выпуска набора исправлений в июле 2016 года дело обстояло так. Когда ресурсы-контейнеры, генерируемые стандартным кодировщиком мультимедиа, расширенным рабочим процессом кодировщика мультимедиа или устаревшим кодировщиком мультимедиа Azure, передавались в потоке с помощью динамической упаковки, выдавался манифест Smooth Streaming версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="fac48-216">Before the July 2016 service release--when assets produced by Media Encoder Standard, Media Encoder Premium Workflow, or the earlier Azure Media Encoder were streamed by using dynamic packaging--the Smooth Streaming manifest returned would conform to version 2.0.</span></span> <span data-ttu-id="fac48-217">В нем для длительностей фрагментов не использовались так называемые теги повтора (r-tag).</span><span class="sxs-lookup"><span data-stu-id="fac48-217">In version 2.0, the fragment durations do not use the so-called repeat (‘r’) tags.</span></span> <span data-ttu-id="fac48-218">Например:</span><span class="sxs-lookup"><span data-stu-id="fac48-218">For example:</span></span>

<?xml version="1.0" encoding="UTF-8"?>
    <SmoothStreamingMedia MajorVersion="2" MinorVersion="0" Duration="8000" TimeScale="1000">
        <StreamIndex Chunks="4" Type="video" Url="QualityLevels({bitrate})/Fragments(video={start time})" QualityLevels="3" Subtype="" Name="video" TimeScale="1000">
            <QualityLevel Index="0" Bitrate="1000000" FourCC="AVC1" MaxWidth="640" MaxHeight="360" CodecPrivateData="00000001674D4029965201405FF2E02A100000030010000003032E0A000F42400040167F18E3050007A12000200B3F8C70ED0B16890000000168EB7352" />
            <c t="0" d="2000" n="0" />
            <c d="2000" />
            <c d="2000" />
            <c d="2000" />
        </StreamIndex>
    </SmoothStreamingMedia>

<span data-ttu-id="fac48-219">После выпуска набора исправлений в июле 2016 года создаваемый манифест Smooth Streaming соответствует версии 2.2, в которой для длительностей фрагментов используются теги повтора.</span><span class="sxs-lookup"><span data-stu-id="fac48-219">In the July 2016 service release, the generated Smooth Streaming manifest conforms to version 2.2, with fragment durations using repeat tags.</span></span> <span data-ttu-id="fac48-220">Например:</span><span class="sxs-lookup"><span data-stu-id="fac48-220">For example:</span></span>

    <?xml version="1.0" encoding="UTF-8"?>
    <SmoothStreamingMedia MajorVersion="2" MinorVersion="2" Duration="8000" TimeScale="1000">
        <StreamIndex Chunks="4" Type="video" Url="QualityLevels({bitrate})/Fragments(video={start time})" QualityLevels="3" Subtype="" Name="video" TimeScale="1000">
            <QualityLevel Index="0" Bitrate="1000000" FourCC="AVC1" MaxWidth="640" MaxHeight="360" CodecPrivateData="00000001674D4029965201405FF2E02A100000030010000003032E0A000F42400040167F18E3050007A12000200B3F8C70ED0B16890000000168EB7352" />
            <c t="0" d="2000" r="4" />
        </StreamIndex>
    </SmoothStreamingMedia>

<span data-ttu-id="fac48-221">Некоторые устаревшие клиенты Smooth Streaming могут не поддерживать теги повтора и поэтому не загружать манифест.</span><span class="sxs-lookup"><span data-stu-id="fac48-221">Some of the legacy Smooth Streaming clients may not support the repeat tags and will fail to load the manifest.</span></span> <span data-ttu-id="fac48-222">Чтобы устранить эту проблему, воспользуйтесь параметром формата манифеста прежних версий **(format=fmp4-v20)** или обновите свой клиент до последней версии, поддерживающей теги повтора.</span><span class="sxs-lookup"><span data-stu-id="fac48-222">To mitigate this issue, you can use the legacy manifest format parameter **(format=fmp4-v20)** or update your client to the latest version, which supports repeat tags.</span></span> <span data-ttu-id="fac48-223">Чтобы узнать больше, ознакомьтесь со [Smooth Streaming 2.0](media-services-deliver-content-overview.md#fmp4_v20).</span><span class="sxs-lookup"><span data-stu-id="fac48-223">For more information, see [Smooth Streaming 2.0](media-services-deliver-content-overview.md#fmp4_v20).</span></span>

## <a name="media-services-learning-paths"></a><span data-ttu-id="fac48-224">Схемы обучения работе со службами мультимедиа</span><span class="sxs-lookup"><span data-stu-id="fac48-224">Media Services learning paths</span></span>
[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a><span data-ttu-id="fac48-225">Отзывы</span><span class="sxs-lookup"><span data-stu-id="fac48-225">Provide feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

## <a name="related-topics"></a><span data-ttu-id="fac48-226">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="fac48-226">Related topics</span></span>
[<span data-ttu-id="fac48-227">Обновление указателей служб мультимедиа после отката ключей хранилища</span><span class="sxs-lookup"><span data-stu-id="fac48-227">Update Media Services locators after rolling storage keys</span></span>](media-services-roll-storage-access-keys.md)

