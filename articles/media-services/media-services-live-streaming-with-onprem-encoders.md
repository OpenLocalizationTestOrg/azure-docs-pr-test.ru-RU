---
title: "Потоковая трансляция с помощью локальных кодировщиков, создающих потоки с разными скоростями | Документация Майкрософт"
description: "В этой статье описывается настройка канала, который получает динамический поток с поддержкой нескольких скоростей от локального кодировщика. Далее этот поток можно доставлять в клиентские приложения для воспроизведения через одну или несколько конечных точек потоковой передачи по одному из следующих протоколов потоковой передачи с переменной скоростью: HLS, Smooth Streaming или DASH."
services: media-services
documentationcenter: 
author: Juliako
manager: cfowler
editor: 
ms.assetid: d9f0912d-39ec-4c9c-817b-e5d9fcf1f7ea
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: ne
ms.topic: article
ms.date: 04/12/2017
ms.author: cenkd;juliako
ms.openlocfilehash: 3f6569d32708c42247e0ffec70389f2e0f07389e
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="live-streaming-with-on-premises-encoders-that-create-multi-bitrate-streams"></a><span data-ttu-id="b85da-104">Потоковая трансляция с помощью локальных кодировщиков, создающих потоки с разными скоростями</span><span class="sxs-lookup"><span data-stu-id="b85da-104">Live streaming with on-premises encoders that create multi-bitrate streams</span></span>
## <a name="overview"></a><span data-ttu-id="b85da-105">Обзор</span><span class="sxs-lookup"><span data-stu-id="b85da-105">Overview</span></span>
<span data-ttu-id="b85da-106">В службах мультимедиа Azure *канал* представляет собой конвейер для обработки контента, передаваемого в потоковом режиме.</span><span class="sxs-lookup"><span data-stu-id="b85da-106">In Azure Media Services, a *channel* represents a pipeline for processing live-streaming content.</span></span> <span data-ttu-id="b85da-107">Канал получает входные потоки одним из двух способов.</span><span class="sxs-lookup"><span data-stu-id="b85da-107">A channel receives live input streams in one of two ways:</span></span>

* <span data-ttu-id="b85da-108">Локальный динамический кодировщик передает содержимое в формате RTMP или формате потока Smooth Streaming (фрагментированный MP4) с несколькими скоростями в канал, для которого не включена поддержка кодирования в реальном времени с помощью служб мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="b85da-108">An on-premises live encoder sends a multi-bitrate RTMP or Smooth Streaming (fragmented MP4) stream to the channel that is not enabled to perform live encoding with Media Services.</span></span> <span data-ttu-id="b85da-109">Полученные потоки передаются через каналы без дальнейшей обработки.</span><span class="sxs-lookup"><span data-stu-id="b85da-109">The ingested streams pass through channels without any further processing.</span></span> <span data-ttu-id="b85da-110">Этот способ называется *сквозной передачей*.</span><span class="sxs-lookup"><span data-stu-id="b85da-110">This method is called *pass-through*.</span></span> <span data-ttu-id="b85da-111">Вы можете использовать следующие динамические кодировщики, выдающие содержимое в формате потоковой передачи Smooth Streaming с несколькими скоростями: MediaExcel, Ateme, Imagine Communications, Envivio, Cisco и Elemental.</span><span class="sxs-lookup"><span data-stu-id="b85da-111">You can use the following live encoders that have multi-bitrate Smooth Streaming as output: Media Excel, Ateme, Imagine Communications, Envivio, Cisco, and Elemental.</span></span> <span data-ttu-id="b85da-112">Следующие динамические кодировщики выдают содержимое в формате RTMP: Adobe Flash Media Live Encoder, Telestream Wirecast, Haivision, Teradek и Tricaster.</span><span class="sxs-lookup"><span data-stu-id="b85da-112">The following live encoders have RTMP as output: Adobe Flash Media Live Encoder, Telestream Wirecast, Haivision, Teradek, and TriCaster.</span></span> <span data-ttu-id="b85da-113">Динамический кодировщик может также передавать односкоростной поток в канал, для которого не включено кодирование в реальном времени, но это не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="b85da-113">A live encoder can also send a single-bitrate stream to a channel that is not enabled for live encoding, but we don't recommend that.</span></span> <span data-ttu-id="b85da-114">При получении запроса службы мультимедиа предоставляют потоки запрашивающим клиентам.</span><span class="sxs-lookup"><span data-stu-id="b85da-114">Media Services delivers the stream to customers who request it.</span></span>

  > [!NOTE]
  > <span data-ttu-id="b85da-115">Использование сквозной передачи является наиболее экономичным способом потоковой передачи в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="b85da-115">Using a pass-through method is the most economical way to do live streaming.</span></span>


* <span data-ttu-id="b85da-116">Локальный динамический кодировщик передает односкоростной поток в канал, который может осуществлять кодирование в реальном времени с помощью служб мультимедиа, в одном из следующих форматов: RTP (MPEG-TS), RTMP или Smooth Streaming (фрагментированный MP4).</span><span class="sxs-lookup"><span data-stu-id="b85da-116">An on-premises live encoder sends a single-bitrate stream to the channel that is enabled to perform live encoding with Media Services in one of the following formats: RTP (MPEG-TS), RTMP, or Smooth Streaming (fragmented MP4).</span></span> <span data-ttu-id="b85da-117">Затем канал кодирует входящий односкоростной поток в реальном времени в многоскоростной (адаптивный) видеопоток.</span><span class="sxs-lookup"><span data-stu-id="b85da-117">The channel then performs live encoding of the incoming single-bitrate stream to a multi-bitrate (adaptive) video stream.</span></span> <span data-ttu-id="b85da-118">При получении запроса службы мультимедиа предоставляют потоки запрашивающим клиентам.</span><span class="sxs-lookup"><span data-stu-id="b85da-118">Media Services delivers the stream to customers who request it.</span></span>

<span data-ttu-id="b85da-119">Начиная с выпуска 2.10 служб мультимедиа при создании канала можно указать, как он должен принимать входной поток</span><span class="sxs-lookup"><span data-stu-id="b85da-119">Starting with the Media Services 2.10 release, when you create a channel, you can specify how you want your channel to receive the input stream.</span></span> <span data-ttu-id="b85da-120">и должен ли он выполнять его кодирование в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="b85da-120">You can also specify whether you want the channel to perform live encoding of your stream.</span></span> <span data-ttu-id="b85da-121">Существует два варианта.</span><span class="sxs-lookup"><span data-stu-id="b85da-121">You have two options:</span></span>

* <span data-ttu-id="b85da-122">**Сквозная передача** — задайте это значение, если вы собираетесь использовать локальный динамический кодировщик, который будет использовать поток с несколькими скоростями (сквозной) для вывода.</span><span class="sxs-lookup"><span data-stu-id="b85da-122">**Pass Through**: Specify this value if you plan to use an on-premises live encoder that will have a multi-bitrate stream (a pass-through stream) as output.</span></span> <span data-ttu-id="b85da-123">В этом случае входящий поток передается на выход без кодирования.</span><span class="sxs-lookup"><span data-stu-id="b85da-123">In this case, the incoming stream passes through to the output without any encoding.</span></span> <span data-ttu-id="b85da-124">Таким образом каналы работали до выпуска 2.10.</span><span class="sxs-lookup"><span data-stu-id="b85da-124">This is the behavior of a channel before the 2.10 release.</span></span> <span data-ttu-id="b85da-125">В этой статье приведены подробные сведения о работе с каналами такого типа.</span><span class="sxs-lookup"><span data-stu-id="b85da-125">This topic gives details about working with channels of this type.</span></span>
* <span data-ttu-id="b85da-126">**Кодирование в реальном времени** — выберите это значение, если собираетесь использовать службы мультимедиа для кодирования односкоростного динамического потока в поток с несколькими скоростями.</span><span class="sxs-lookup"><span data-stu-id="b85da-126">**Live Encoding**: Choose this value if you plan to use Media Services to encode your single-bitrate live stream to a multi-bitrate stream.</span></span> <span data-ttu-id="b85da-127">Помните о том, что если вы оставите канал кодирования в реальном времени в состоянии **Работает**, вам будут выставлены соответствующие счета.</span><span class="sxs-lookup"><span data-stu-id="b85da-127">Be aware that leaving a live encoding channel in a **Running** state will incur billing charges.</span></span> <span data-ttu-id="b85da-128">Рекомендуется сразу же прекращать работу канала после завершения потоковой передачи в реальном времени во избежание оплаты дополнительных часов.</span><span class="sxs-lookup"><span data-stu-id="b85da-128">We recommend that you immediately stop your running channels after your live-streaming event is complete to avoid extra hourly charges.</span></span> <span data-ttu-id="b85da-129">При получении запроса службы мультимедиа предоставляют потоки запрашивающим клиентам.</span><span class="sxs-lookup"><span data-stu-id="b85da-129">Media Services delivers the stream to customers who request it.</span></span>

> [!NOTE]
> <span data-ttu-id="b85da-130">В этой статье рассматриваются атрибуты каналов, которые не поддерживают кодирование в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="b85da-130">This topic discusses attributes of channels that are not enabled to perform live encoding.</span></span> <span data-ttu-id="b85da-131">Сведения о работе с каналами, которые поддерживают кодирование в реальном времени, см. в статье [Потоковая трансляция с использованием служб мультимедиа Azure для создания потоков с разными скоростями](media-services-manage-live-encoder-enabled-channels.md).</span><span class="sxs-lookup"><span data-stu-id="b85da-131">For information about working with channels that are enabled to perform live encoding, see [Live streaming using Azure Media Services to create multi-bitrate streams](media-services-manage-live-encoder-enabled-channels.md).</span></span>
>
>

<span data-ttu-id="b85da-132">На следующей схеме показан рабочий процесс динамической потоковой передачи, использующий локальный динамический кодировщик для вывода потоков с разными скоростями RTMP или фрагментированного потока MP4 (Smooth Streaming).</span><span class="sxs-lookup"><span data-stu-id="b85da-132">The following diagram represents a live-streaming workflow that uses an on-premises live encoder to have multi-bitrate RTMP or fragmented MP4 (Smooth Streaming) streams as output.</span></span>

![Динамический рабочий процесс][live-overview]

## <span data-ttu-id="b85da-134"><a id="scenario"></a>Стандартный сценарий потоковой передачи в режиме реального времени</span><span class="sxs-lookup"><span data-stu-id="b85da-134"><a id="scenario"></a>Common live-streaming scenario</span></span>
<span data-ttu-id="b85da-135">Далее описываются задачи, связанные с созданием распространенных приложений динамической потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="b85da-135">The following steps describe tasks involved in creating common live-streaming applications.</span></span>

1. <span data-ttu-id="b85da-136">Подключите видеокамеру к компьютеру.</span><span class="sxs-lookup"><span data-stu-id="b85da-136">Connect a video camera to a computer.</span></span> <span data-ttu-id="b85da-137">Запустите и настройте локальный динамический кодировщик, который выводит поток с разными скоростями RTMP или поток в формате "фрагментированный MP4" (Smooth Streaming).</span><span class="sxs-lookup"><span data-stu-id="b85da-137">Start and configure an on-premises live encoder that has a multi-bitrate RTMP or fragmented MP4 (Smooth Streaming) stream as output.</span></span> <span data-ttu-id="b85da-138">Дополнительные сведения см. в статье о [поддержке протокола RTMP в службах мультимедиа Azure и о динамических кодировщиках](http://go.microsoft.com/fwlink/?LinkId=532824).</span><span class="sxs-lookup"><span data-stu-id="b85da-138">For more information, see [Azure Media Services RTMP Support and Live Encoders](http://go.microsoft.com/fwlink/?LinkId=532824).</span></span>

    <span data-ttu-id="b85da-139">Это действие также можно выполнить после создания канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-139">You can also perform this step after you create your channel.</span></span>
2. <span data-ttu-id="b85da-140">Создайте и запустите канал.</span><span class="sxs-lookup"><span data-stu-id="b85da-140">Create and start a channel.</span></span>

3. <span data-ttu-id="b85da-141">Получение входного URL-адреса канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-141">Retrieve the channel ingest URL.</span></span>

    <span data-ttu-id="b85da-142">URL-адрес приема используется динамическим кодировщиком для отправки потока в канал.</span><span class="sxs-lookup"><span data-stu-id="b85da-142">The live encoder uses the ingest URL to send the stream to the channel.</span></span>
4. <span data-ttu-id="b85da-143">Получите URL-адрес предварительного просмотра канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-143">Retrieve the channel preview URL.</span></span>

    <span data-ttu-id="b85da-144">С его помощью можно убедиться в том, что канал надлежащим образом получает поток.</span><span class="sxs-lookup"><span data-stu-id="b85da-144">Use this URL to verify that your channel is properly receiving the live stream.</span></span>
5. <span data-ttu-id="b85da-145">Создайте программу.</span><span class="sxs-lookup"><span data-stu-id="b85da-145">Create a program.</span></span>

    <span data-ttu-id="b85da-146">Если вы используете портал Azure, то при создании программы также создается ресурс-контейнер.</span><span class="sxs-lookup"><span data-stu-id="b85da-146">When you use the Azure portal, creating a program also creates an asset.</span></span>

    <span data-ttu-id="b85da-147">Если вы используете пакет .NET SDK или REST, необходимо создать ресурс и указать его при создании программы.</span><span class="sxs-lookup"><span data-stu-id="b85da-147">When you use the .NET SDK or REST, you need to create an asset and specify to use this asset when creating a program.</span></span>
6. <span data-ttu-id="b85da-148">Опубликуйте ресурс, связанный с программой.</span><span class="sxs-lookup"><span data-stu-id="b85da-148">Publish the asset that's associated with the program.</span></span>   

    >[!NOTE]
    ><span data-ttu-id="b85da-149">При создании учетной записи служб мультимедиа Azure в нее добавляется конечная точка потоковой передачи **по умолчанию** в состоянии **Остановлена**.</span><span class="sxs-lookup"><span data-stu-id="b85da-149">When your Azure Media Services account is created, a **default** streaming endpoint is added to your account in the **Stopped** state.</span></span> <span data-ttu-id="b85da-150">Конечная точка потоковой передачи, из которой нужно передавать содержимое потоком, должна находиться в состоянии **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="b85da-150">The streaming endpoint from which you want to stream content has to be in the **Running** state.</span></span>

7. <span data-ttu-id="b85da-151">Когда вы будете готовы начать потоковую передачу и архивацию, запустите программу.</span><span class="sxs-lookup"><span data-stu-id="b85da-151">Start the program when you're ready to start streaming and archiving.</span></span>

8. <span data-ttu-id="b85da-152">При необходимости динамическому кодировщику можно дать сигнал начать показ рекламы.</span><span class="sxs-lookup"><span data-stu-id="b85da-152">Optionally, the live encoder can be signaled to start an advertisement.</span></span> <span data-ttu-id="b85da-153">Реклама вставляется в выходной поток.</span><span class="sxs-lookup"><span data-stu-id="b85da-153">The advertisement is inserted in the output stream.</span></span>

9. <span data-ttu-id="b85da-154">Чтобы остановить потоковую передачу и архивацию содержимого мероприятия, завершите работу программы.</span><span class="sxs-lookup"><span data-stu-id="b85da-154">Stop the program whenever you want to stop streaming and archiving the event.</span></span>

10. <span data-ttu-id="b85da-155">Удалите программу (и при необходимости ресурс).</span><span class="sxs-lookup"><span data-stu-id="b85da-155">Delete the program (and optionally delete the asset).</span></span>     

## <span data-ttu-id="b85da-156"><a id="channel"></a>Описание канала и связанных с ним компонентов</span><span class="sxs-lookup"><span data-stu-id="b85da-156"><a id="channel"></a>Description of a channel and its related components</span></span>
### <span data-ttu-id="b85da-157"><a id="channel_input"></a>Конфигурации входа (приема) канала</span><span class="sxs-lookup"><span data-stu-id="b85da-157"><a id="channel_input"></a>Channel input (ingest) configurations</span></span>
#### <span data-ttu-id="b85da-158"><a id="ingest_protocols"></a>Протокол входного потока</span><span class="sxs-lookup"><span data-stu-id="b85da-158"><a id="ingest_protocols"></a>Ingest streaming protocol</span></span>
<span data-ttu-id="b85da-159">Службы мультимедиа поддерживают прием динамических каналов с использованием фрагментированного MP4 и RTMP с поддержкой разных скоростей в качестве потоковых протоколов.</span><span class="sxs-lookup"><span data-stu-id="b85da-159">Media Services supports ingesting live feeds by using multi-bitrate fragmented MP4 and multi-bitrate RTMP as streaming protocols.</span></span> <span data-ttu-id="b85da-160">Если выбран протокол потоковой передачи RTMP, для канала создаются две конечные точки приема (ввода):</span><span class="sxs-lookup"><span data-stu-id="b85da-160">When the RTMP ingest streaming protocol is selected, two ingest (input) endpoints are created for the channel:</span></span>

* <span data-ttu-id="b85da-161">**Основной URL-адрес**задает полный URL-адрес основной конечной точки приема RTMP канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-161">**Primary URL**: Specifies the fully qualified URL of the channel's primary RTMP ingest endpoint.</span></span>
* <span data-ttu-id="b85da-162">**Дополнительный URL-адрес** (необязательно) задает полный URL-адрес дополнительной конечной точки приема RTMP канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-162">**Secondary URL** (optional): Specifies the fully qualified URL of the channel's secondary RTMP ingest endpoint.</span></span>

<span data-ttu-id="b85da-163">Используйте дополнительный URL-адрес, чтобы повысить надежность и отказоустойчивость потока приема, а также отказоустойчивость кодировщика, особенно в следующих сценариях.</span><span class="sxs-lookup"><span data-stu-id="b85da-163">Use the secondary URL if you want to improve the durability and fault tolerance of your ingest stream (as well as encoder failover and fault tolerance), especially for the following scenarios:</span></span>

- <span data-ttu-id="b85da-164">Двойная передача одного кодировщика как по основному, так и по дополнительному URL-адресам.</span><span class="sxs-lookup"><span data-stu-id="b85da-164">Single encoder double-pushing to both primary and secondary URLs:</span></span>

    <span data-ttu-id="b85da-165">Основная цель такого приема — повысить устойчивость к колебаниям сети и ухудшению качества сигнала.</span><span class="sxs-lookup"><span data-stu-id="b85da-165">The main purpose of this scenario is to provide more resiliency to network fluctuations and jitters.</span></span> <span data-ttu-id="b85da-166">Некоторые кодировщики RTMP не очень хорошо справляются с сетевыми отключениями.</span><span class="sxs-lookup"><span data-stu-id="b85da-166">Some RTMP encoders don't handle network disconnects well.</span></span> <span data-ttu-id="b85da-167">При отключении от сети кодировщик может прекратить кодирование, не отправляя буферизованные данные при возобновлении подключения.</span><span class="sxs-lookup"><span data-stu-id="b85da-167">When a network disconnect happens, an encoder might stop encoding and then not send the buffered data when a reconnect happens.</span></span> <span data-ttu-id="b85da-168">Это ведет к перебоям в работе и потере данных.</span><span class="sxs-lookup"><span data-stu-id="b85da-168">This causes discontinuities and data loss.</span></span> <span data-ttu-id="b85da-169">Отключение сети может происходить из-за ее неисправности или во время технического обслуживания со стороны Azure.</span><span class="sxs-lookup"><span data-stu-id="b85da-169">Network disconnects can happen because of a bad network or maintenance on the Azure side.</span></span> <span data-ttu-id="b85da-170">Основной и дополнительный URL-адреса минимизируют проблемы с сетью, а также обеспечивают управляемый процесс обновления.</span><span class="sxs-lookup"><span data-stu-id="b85da-170">Primary/secondary URLs reduce the network problems and provide a controlled upgrade process.</span></span> <span data-ttu-id="b85da-171">При каждом плановом отключении сети службы мультимедиа управляют первичным и вторичным отключением, обеспечивая отложенное отключение между двумя адресами.</span><span class="sxs-lookup"><span data-stu-id="b85da-171">Each time a scheduled network disconnect happens, Media Services manages the primary and secondary disconnects and provides a delayed disconnect between the two.</span></span> <span data-ttu-id="b85da-172">Это дает время кодировщикам поддерживать отправку данных и возобновлять подключение.</span><span class="sxs-lookup"><span data-stu-id="b85da-172">Encoders then have time to keep sending data and reconnect again.</span></span> <span data-ttu-id="b85da-173">Порядок отключений может быть случайным, но задержка между отключением основного и дополнительного или дополнительного и основного URL-адресов будет присутствовать всегда.</span><span class="sxs-lookup"><span data-stu-id="b85da-173">The order of the disconnects can be random, but there will always be a delay between primary/secondary or secondary/primary URLs.</span></span> <span data-ttu-id="b85da-174">В этом сценарии кодировщик по-прежнему является единственной точкой отказа.</span><span class="sxs-lookup"><span data-stu-id="b85da-174">In this scenario, the encoder is still the single point of failure.</span></span>

- <span data-ttu-id="b85da-175">Несколько кодировщиков, каждый из которых осуществляет передачу в выделенную точку.</span><span class="sxs-lookup"><span data-stu-id="b85da-175">Multiple encoders, with each encoder pushing to a dedicated point:</span></span>

    <span data-ttu-id="b85da-176">Этот сценарий обеспечивает избыточность как кодировщиков, так и приема.</span><span class="sxs-lookup"><span data-stu-id="b85da-176">This scenario provides both encoder and ingest redundancy.</span></span> <span data-ttu-id="b85da-177">В этом сценарии кодировщик1 передает сигнал на основной URL-адрес, а кодировщик2 — на дополнительный URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="b85da-177">In this scenario, encoder1 pushes to the primary URL, and encoder2 pushes to the secondary URL.</span></span> <span data-ttu-id="b85da-178">При сбое одного из кодировщиков другой может по-прежнему отправлять данные.</span><span class="sxs-lookup"><span data-stu-id="b85da-178">When an encoder fails, the other encoder can keep sending data.</span></span> <span data-ttu-id="b85da-179">Избыточность данных при этом все равно поддерживается, так как службы мультимедиа не отключают основной и дополнительный URL-адреса одновременно.</span><span class="sxs-lookup"><span data-stu-id="b85da-179">Data redundancy can be maintained because Media Services does not disconnect primary and secondary URLs at the same time.</span></span> <span data-ttu-id="b85da-180">В этом сценарии предполагается, что кодировщики синхронизированы по времени и предоставляют абсолютно одинаковые данные.</span><span class="sxs-lookup"><span data-stu-id="b85da-180">This scenario assumes that encoders are time synced and provide exactly the same data.</span></span>  

- <span data-ttu-id="b85da-181">Несколько кодировщиков, осуществляющих двойную передачу как по основному, так и по дополнительному URL-адресам.</span><span class="sxs-lookup"><span data-stu-id="b85da-181">Multiple encoders double-pushing to both primary and secondary URLs:</span></span>

    <span data-ttu-id="b85da-182">В этом сценарии оба кодировщика передают данные по основному и дополнительному URL-адресам.</span><span class="sxs-lookup"><span data-stu-id="b85da-182">In this scenario, both encoders push data to both primary and secondary URLs.</span></span> <span data-ttu-id="b85da-183">Это обеспечивает самую высокую надежность и отказоустойчивость, а также избыточность данных.</span><span class="sxs-lookup"><span data-stu-id="b85da-183">This provides the best reliability and fault tolerance, as well as data redundancy.</span></span> <span data-ttu-id="b85da-184">Такая конфигурация может выдержать отключения и сбои обоих кодировщиков, даже если один из кодировщиков перестанет работать.</span><span class="sxs-lookup"><span data-stu-id="b85da-184">This scenario can tolerate both encoder failures and disconnects, even if one encoder stops working.</span></span> <span data-ttu-id="b85da-185">В этом сценарии предполагается, что кодировщики синхронизированы по времени и предоставляют абсолютно одинаковые данные.</span><span class="sxs-lookup"><span data-stu-id="b85da-185">It assumes that encoders are time synced and provide exactly the same data.</span></span>  

<span data-ttu-id="b85da-186">Сведения о динамических кодировщиках RTMP см. в записи блога [Azure Media Services RTMP Support and Live Encoders](http://go.microsoft.com/fwlink/?LinkId=532824) (Поддержка RTMP в службах мультимедиа Azure и динамические кодировщики).</span><span class="sxs-lookup"><span data-stu-id="b85da-186">For information about RTMP live encoders, see [Azure Media Services RTMP Support and Live Encoders](http://go.microsoft.com/fwlink/?LinkId=532824).</span></span>

#### <a name="ingest-urls-endpoints"></a><span data-ttu-id="b85da-187">URL-адреса приема (конечные точки)</span><span class="sxs-lookup"><span data-stu-id="b85da-187">Ingest URLs (endpoints)</span></span>
<span data-ttu-id="b85da-188">Канал предоставляет входную конечную точку (URL-адрес приема), которая определяется в динамическом кодировщике, чтобы кодировщик мог передать потоки в каналы.</span><span class="sxs-lookup"><span data-stu-id="b85da-188">A channel provides an input endpoint (ingest URL) that you specify in the live encoder, so the encoder can push streams to your channels.</span></span>   

<span data-ttu-id="b85da-189">URL-адреса приема можно получить при создании канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-189">You can get the ingest URLs when you create the channel.</span></span> <span data-ttu-id="b85da-190">Для этого каналу не обязательно находиться в состоянии **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="b85da-190">For you to get these URLs, the channel does not have to be in the **Running** state.</span></span> <span data-ttu-id="b85da-191">Чтобы начать передавать данные каналу, его нужно перевести в состояние **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="b85da-191">When you're ready to start pushing data to the channel, the channel must be in the **Running** state.</span></span> <span data-ttu-id="b85da-192">После того как канал начинает принимать данные, можно просмотреть поток через URL-адрес предварительного просмотра.</span><span class="sxs-lookup"><span data-stu-id="b85da-192">After the channel starts ingesting data, you can preview your stream through the preview URL.</span></span>

<span data-ttu-id="b85da-193">Предусмотрена возможность приема динамического потока в формате "фрагментированный MP4" (Smooth Streaming) по SSL-подключению.</span><span class="sxs-lookup"><span data-stu-id="b85da-193">You have an option of ingesting a fragmented MP4 (Smooth Streaming) live stream over an SSL connection.</span></span> <span data-ttu-id="b85da-194">Для приема по протоколу SSL измените URL-адрес приема на HTTPS.</span><span class="sxs-lookup"><span data-stu-id="b85da-194">To ingest over SSL, make sure to update the ingest URL to HTTPS.</span></span> <span data-ttu-id="b85da-195">В настоящее время прием RTMP по протоколу SSL не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="b85da-195">Currently, you cannot ingest RTMP over SSL.</span></span>

#### <span data-ttu-id="b85da-196"><a id="keyframe_interval"></a>Интервал опорного кадра</span><span class="sxs-lookup"><span data-stu-id="b85da-196"><a id="keyframe_interval"></a>Keyframe interval</span></span>
<span data-ttu-id="b85da-197">При использовании локального динамического кодировщика для формирования потока с поддержкой нескольких скоростей интервал опорного кадра определяет длительность группы кадров (которая используется внешним кодировщиком).</span><span class="sxs-lookup"><span data-stu-id="b85da-197">When you're using an on-premises live encoder to generate multi-bitrate stream, the keyframe interval specifies the duration of the group of pictures (GOP) as used by that external encoder.</span></span> <span data-ttu-id="b85da-198">После того как канал получит входящий поток, вы можете предоставить динамический поток клиентским приложениям для воспроизведения в любом из следующих форматов: Smooth Streaming, динамическая адаптивная потоковая передача по протоколу HTTP (DASH) и HTTP Live Streaming (HLS).</span><span class="sxs-lookup"><span data-stu-id="b85da-198">After the channel receives this incoming stream, you can deliver your live stream to client playback applications in any of the following formats: Smooth Streaming, Dynamic Adaptive Streaming over HTTP (DASH), and HTTP Live Streaming (HLS).</span></span> <span data-ttu-id="b85da-199">При динамической потоковой трансляции HLS всегда упаковывается динамически.</span><span class="sxs-lookup"><span data-stu-id="b85da-199">When you're doing live streaming, HLS is always packaged dynamically.</span></span> <span data-ttu-id="b85da-200">По умолчанию службы мультимедиа автоматически вычисляют соотношение упаковки сегмента HLS (число фрагментов на сегмент) на основе интервала опорного кадра, полученного из динамического кодировщика.</span><span class="sxs-lookup"><span data-stu-id="b85da-200">By default, Media Services automatically calculates the HLS segment packaging ratio (fragments per segment) based on the keyframe interval that's received from the live encoder.</span></span>

<span data-ttu-id="b85da-201">В следующей таблице показано вычисление длительности сегментов.</span><span class="sxs-lookup"><span data-stu-id="b85da-201">The following table shows how the segment duration is calculated:</span></span>

| <span data-ttu-id="b85da-202">Интервал опорного кадра</span><span class="sxs-lookup"><span data-stu-id="b85da-202">Keyframe interval</span></span> | <span data-ttu-id="b85da-203">Соотношение упаковки сегмента HLS (FragmentsPerSegment)</span><span class="sxs-lookup"><span data-stu-id="b85da-203">HLS segment packaging ratio (FragmentsPerSegment)</span></span> | <span data-ttu-id="b85da-204">Пример</span><span class="sxs-lookup"><span data-stu-id="b85da-204">Example</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b85da-205">Меньше или равно 3 секундам</span><span class="sxs-lookup"><span data-stu-id="b85da-205">Less than or equal to 3 seconds</span></span> |<span data-ttu-id="b85da-206">3:1</span><span class="sxs-lookup"><span data-stu-id="b85da-206">3:1</span></span> |<span data-ttu-id="b85da-207">Если значение KeyFrameInterval (или GOP) равно 2 секундам, соотношение упаковки сегмента HLS по умолчанию будет равно 3 к 1.</span><span class="sxs-lookup"><span data-stu-id="b85da-207">If KeyFrameInterval (or GOP) is 2 seconds, the default HLS segment packaging ratio is 3 to 1.</span></span> <span data-ttu-id="b85da-208">Это приведет к созданию сегмента HLS длительностью 6 секунд.</span><span class="sxs-lookup"><span data-stu-id="b85da-208">This creates a 6-second HLS segment.</span></span> |
| <span data-ttu-id="b85da-209">3–5 секунд</span><span class="sxs-lookup"><span data-stu-id="b85da-209">3 to 5 seconds</span></span> |<span data-ttu-id="b85da-210">2:1</span><span class="sxs-lookup"><span data-stu-id="b85da-210">2:1</span></span> |<span data-ttu-id="b85da-211">Если значение KeyFrameInterval (или GOP) равно 4 секундам, соотношение упаковки сегмента HLS по умолчанию будет равно 2 к 1.</span><span class="sxs-lookup"><span data-stu-id="b85da-211">If KeyFrameInterval (or GOP) is 4 seconds, the default HLS segment packaging ratio is 2 to 1.</span></span> <span data-ttu-id="b85da-212">Это приведет к созданию сегмента HLS длительностью 8 секунд.</span><span class="sxs-lookup"><span data-stu-id="b85da-212">This creates an 8-second HLS segment.</span></span> |
| <span data-ttu-id="b85da-213">Более 5 секунд</span><span class="sxs-lookup"><span data-stu-id="b85da-213">Greater than 5 seconds</span></span> |<span data-ttu-id="b85da-214">1:1</span><span class="sxs-lookup"><span data-stu-id="b85da-214">1:1</span></span> |<span data-ttu-id="b85da-215">Если значение KeyFrameInterval (или GOP) равно 6 секундам, соотношение упаковки сегмента HLS по умолчанию будет равно 1 к 1.</span><span class="sxs-lookup"><span data-stu-id="b85da-215">If KeyFrameInterval (or GOP) is 6 seconds, the default HLS segment packaging ratio is 1 to 1.</span></span> <span data-ttu-id="b85da-216">Это приведет к созданию сегмента HLS длительностью 6 секунд.</span><span class="sxs-lookup"><span data-stu-id="b85da-216">This creates a 6-second HLS segment.</span></span> |

<span data-ttu-id="b85da-217">Можно изменить соотношение фрагментов на сегмент, настроив вывод канала и установив параметр FragmentsPerSegment в ChannelOutputHls.</span><span class="sxs-lookup"><span data-stu-id="b85da-217">You can change the fragments-per-segment ratio by configuring the channel’s output and setting FragmentsPerSegment on ChannelOutputHls.</span></span>

<span data-ttu-id="b85da-218">Также можно изменить значение интервала опорного кадра, установив свойство KeyFrameInterval в ChanneInput.</span><span class="sxs-lookup"><span data-stu-id="b85da-218">You can also change the keyframe interval value by setting the KeyFrameInterval property on ChanneInput.</span></span> <span data-ttu-id="b85da-219">Если явно задать значение KeyFrameInterval, соотношение упаковки сегмента HLS, FragmentsPerSegment, вычисляется с помощью правил, описанных выше.</span><span class="sxs-lookup"><span data-stu-id="b85da-219">If you explicitly set KeyFrameInterval, the HLS segment packaging ratio FragmentsPerSegment is calculated via the rules described previously.</span></span>  

<span data-ttu-id="b85da-220">Если явно задать свойства KeyFrameInterval и FragmentsPerSegment, службы мультимедиа будут использовать значения, указанные пользователем.</span><span class="sxs-lookup"><span data-stu-id="b85da-220">If you explicitly set both KeyFrameInterval and FragmentsPerSegment, Media Services will use the values that you set.</span></span>

#### <a name="allowed-ip-addresses"></a><span data-ttu-id="b85da-221">Разрешенные IP-адреса</span><span class="sxs-lookup"><span data-stu-id="b85da-221">Allowed IP addresses</span></span>
<span data-ttu-id="b85da-222">Вы можете определить IP-адреса, с которых разрешено публиковать видео в этом канале.</span><span class="sxs-lookup"><span data-stu-id="b85da-222">You can define the IP addresses that are allowed to publish video to this channel.</span></span> <span data-ttu-id="b85da-223">Разрешенные IP-адреса можно указать следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b85da-223">An allowed IP address can be specified as one of the following:</span></span>

* <span data-ttu-id="b85da-224">отдельный IP-адрес (например, 10.0.0.1);</span><span class="sxs-lookup"><span data-stu-id="b85da-224">A single IP address (for example, 10.0.0.1)</span></span>
* <span data-ttu-id="b85da-225">диапазон IP-адресов, заданный с помощью IP-адреса и маски подсети CIDR (например,10.0.0.1/22);</span><span class="sxs-lookup"><span data-stu-id="b85da-225">An IP range that uses an IP address and a CIDR subnet mask (for example, 10.0.0.1/22)</span></span>
* <span data-ttu-id="b85da-226">диапазон IP-адресов, заданный с помощью IP-адреса и маски подсети в десятичной записи (например, 10.0.0.1(255.255.252.0)).</span><span class="sxs-lookup"><span data-stu-id="b85da-226">An IP range that uses an IP address and a dotted decimal subnet mask (for example, 10.0.0.1(255.255.252.0))</span></span>

<span data-ttu-id="b85da-227">Если IP-адреса не указаны и правила не заданы, ни один IP-адрес не разрешен.</span><span class="sxs-lookup"><span data-stu-id="b85da-227">If no IP addresses are specified and there's no rule definition, then no IP address will be allowed.</span></span> <span data-ttu-id="b85da-228">Чтобы разрешить все IP-адреса, создайте правило и задайте адрес 0.0.0.0/0.</span><span class="sxs-lookup"><span data-stu-id="b85da-228">To allow any IP address, create a rule and set 0.0.0.0/0.</span></span>

### <a name="channel-preview"></a><span data-ttu-id="b85da-229">Предварительный просмотр канала</span><span class="sxs-lookup"><span data-stu-id="b85da-229">Channel preview</span></span>
#### <a name="preview-urls"></a><span data-ttu-id="b85da-230">URL-адреса предварительного просмотра</span><span class="sxs-lookup"><span data-stu-id="b85da-230">Preview URLs</span></span>
<span data-ttu-id="b85da-231">Канал предоставляет конечную точку (URL-адрес) предварительного просмотра, с помощью которой можно проверить поток перед дальнейшей обработкой и доставкой.</span><span class="sxs-lookup"><span data-stu-id="b85da-231">Channels provide a preview endpoint (preview URL) that you use to preview and validate your stream before further processing and delivery.</span></span>

<span data-ttu-id="b85da-232">Получить URL-адрес предварительного просмотра можно при создании канала.</span><span class="sxs-lookup"><span data-stu-id="b85da-232">You can get the preview URL when you create the channel.</span></span> <span data-ttu-id="b85da-233">Для этого каналу не обязательно находиться в состоянии **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="b85da-233">For you to get the URL, the channel does not have to be in the **Running** state.</span></span> <span data-ttu-id="b85da-234">После запуска канала можно выполнить предварительный просмотр потока.</span><span class="sxs-lookup"><span data-stu-id="b85da-234">After the channel starts ingesting data, you can preview your stream.</span></span>

<span data-ttu-id="b85da-235">В настоящее время поток предварительного просмотра может доставляться только в формате фрагментированного MP4 (Smooth Streaming) вне зависимости от указанного входного типа.</span><span class="sxs-lookup"><span data-stu-id="b85da-235">Currently, the preview stream can be delivered only in fragmented MP4 (Smooth Streaming) format, regardless of the specified input type.</span></span> <span data-ttu-id="b85da-236">Для проверки потока Smooth Streaming можно использовать проигрыватель [Smooth Streaming Health Monitor](http://smf.cloudapp.net/healthmonitor).</span><span class="sxs-lookup"><span data-stu-id="b85da-236">You can use the [Smooth Streaming Health Monitor](http://smf.cloudapp.net/healthmonitor) player to test the smooth stream.</span></span> <span data-ttu-id="b85da-237">Также для просмотра потока можно воспользоваться проигрывателем, размещенным на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="b85da-237">You can also use a player that's hosted in the Azure portal to view your stream.</span></span>

#### <a name="allowed-ip-addresses"></a><span data-ttu-id="b85da-238">Разрешенные IP-адреса</span><span class="sxs-lookup"><span data-stu-id="b85da-238">Allowed IP addresses</span></span>
<span data-ttu-id="b85da-239">Вы можете определить IP-адреса, которым разрешено подключаться к конечной точке предварительного просмотра.</span><span class="sxs-lookup"><span data-stu-id="b85da-239">You can define the IP addresses that are allowed to connect to the preview endpoint.</span></span> <span data-ttu-id="b85da-240">Если этого не сделать, будут разрешены все IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="b85da-240">If no IP addresses are specified, any IP address will be allowed.</span></span> <span data-ttu-id="b85da-241">Разрешенные IP-адреса можно указать следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b85da-241">An allowed IP address can be specified as one of the following:</span></span>

* <span data-ttu-id="b85da-242">отдельный IP-адрес (например, 10.0.0.1);</span><span class="sxs-lookup"><span data-stu-id="b85da-242">A single IP address (for example, 10.0.0.1)</span></span>
* <span data-ttu-id="b85da-243">диапазон IP-адресов, заданный с помощью IP-адреса и маски подсети CIDR (например,10.0.0.1/22);</span><span class="sxs-lookup"><span data-stu-id="b85da-243">An IP range that uses an IP address and a CIDR subnet mask (for example, 10.0.0.1/22)</span></span>
* <span data-ttu-id="b85da-244">диапазон IP-адресов, заданный с помощью IP-адреса и маски подсети в десятичной записи (например, 10.0.0.1(255.255.252.0)).</span><span class="sxs-lookup"><span data-stu-id="b85da-244">An IP range that uses an IP address and a dotted decimal subnet mask (for example, 10.0.0.1(255.255.252.0))</span></span>

### <a name="channel-output"></a><span data-ttu-id="b85da-245">Вывод канала</span><span class="sxs-lookup"><span data-stu-id="b85da-245">Channel output</span></span>
<span data-ttu-id="b85da-246">Дополнительные сведения о выводе канала см.в разделе [Интервал опорного кадра](#keyframe_interval).</span><span class="sxs-lookup"><span data-stu-id="b85da-246">For information about channel output, see the [Keyframe interval](#keyframe_interval) section.</span></span>

### <a name="channel-managed-programs"></a><span data-ttu-id="b85da-247">Программы, управляемые каналом</span><span class="sxs-lookup"><span data-stu-id="b85da-247">Channel-managed programs</span></span>
<span data-ttu-id="b85da-248">Канал связан с программами, с помощью которых вы можете управлять публикацией и хранением сегментов динамического потока.</span><span class="sxs-lookup"><span data-stu-id="b85da-248">A channel is associated with programs that you can use to control the publishing and storage of segments in a live stream.</span></span> <span data-ttu-id="b85da-249">Каналы управляют программами.</span><span class="sxs-lookup"><span data-stu-id="b85da-249">Channels manage programs.</span></span> <span data-ttu-id="b85da-250">Связь между каналом и программой очень похожа на аналогичную взаимосвязь в традиционной мультимедийной отрасли, где по определенному каналу транслируется постоянный поток информации, а программа связана с определенным временным промежутком — мероприятием на этом канале.</span><span class="sxs-lookup"><span data-stu-id="b85da-250">The channel and program relationship is very similar to traditional media, where a channel has a constant stream of content and a program is scoped to some timed event on that channel.</span></span>

<span data-ttu-id="b85da-251">Задать количество часов, в течение которых следует хранить записанное содержимое программы, можно с помощью параметра длины **окна архивирования** .</span><span class="sxs-lookup"><span data-stu-id="b85da-251">You can specify the number of hours you want to retain the recorded content for the program by setting the **Archive Window** length.</span></span> <span data-ttu-id="b85da-252">Для него можно задать значение от 5 минут до 25 часов.</span><span class="sxs-lookup"><span data-stu-id="b85da-252">This value can be set from a minimum of 5 minutes to a maximum of 25 hours.</span></span> <span data-ttu-id="b85da-253">Длина окна архивирования также определяет максимальный период, в пределах которого клиенты могут перемещаться назад во времени относительно текущей позиции в передаваемом потоке данных.</span><span class="sxs-lookup"><span data-stu-id="b85da-253">Archive window length also dictates the maximum amount of time clients can seek back in time from the current live position.</span></span> <span data-ttu-id="b85da-254">Программы могут длиться в течение определенного времени, однако содержимое, выходящее за пределы окна указанной длины, теряется.</span><span class="sxs-lookup"><span data-stu-id="b85da-254">Programs can run over the specified amount of time, but content that falls behind the window length is continuously discarded.</span></span> <span data-ttu-id="b85da-255">Значение этого свойства также определяет максимальный размер манифестов клиентов.</span><span class="sxs-lookup"><span data-stu-id="b85da-255">This value of this property also determines how long the client manifests can grow.</span></span>

<span data-ttu-id="b85da-256">Каждая программа связана с ресурсом, в котором хранится передаваемый в потоковом режиме контент.</span><span class="sxs-lookup"><span data-stu-id="b85da-256">Each program is associated with an asset that stores the streamed content.</span></span> <span data-ttu-id="b85da-257">Ресурс сопоставляется с контейнером блочных BLOB-объектов в учетной записи хранения Azure. Файлы ресурса хранятся в этом контейнере как большие двоичные объекты.</span><span class="sxs-lookup"><span data-stu-id="b85da-257">An asset is mapped to a block blob container in the Azure storage account, and the files in the asset are stored as blobs in that container.</span></span> <span data-ttu-id="b85da-258">Чтобы опубликовать программу для просмотра потока клиентами, необходимо создать указатель OnDemand для соответствующего ресурса.</span><span class="sxs-lookup"><span data-stu-id="b85da-258">To publish the program so your customers can view the stream, you must create an OnDemand locator for the associated asset.</span></span> <span data-ttu-id="b85da-259">С помощью этого указателя можно сформировать URL-адрес потоковой передачи данных, который предоставляется клиентам.</span><span class="sxs-lookup"><span data-stu-id="b85da-259">You can use this locator to build a streaming URL that you can provide to your clients.</span></span>

<span data-ttu-id="b85da-260">Канал поддерживает одновременную потоковую трансляцию до трех программ, поэтому можно создавать по несколько архивов одного и того же входящего потока.</span><span class="sxs-lookup"><span data-stu-id="b85da-260">A channel supports up to three concurrently running programs, so you can create multiple archives of the same incoming stream.</span></span> <span data-ttu-id="b85da-261">Благодаря этому можно публиковать и архивировать разные части транслируемого мероприятия.</span><span class="sxs-lookup"><span data-stu-id="b85da-261">You can publish and archive different parts of an event as needed.</span></span> <span data-ttu-id="b85da-262">Предположим, например, что, согласно существующим нормативам, необходимо архивировать 6 часов программы, а транслировать только последние 10 минут.</span><span class="sxs-lookup"><span data-stu-id="b85da-262">For example, imagine that your business requirement is to archive 6 hours of a program, but to broadcast only the last 10 minutes.</span></span> <span data-ttu-id="b85da-263">Для этого необходимо создать две одновременно работающие программы.</span><span class="sxs-lookup"><span data-stu-id="b85da-263">To accomplish this, you need to create two concurrently running programs.</span></span> <span data-ttu-id="b85da-264">Для одной из них настроено архивирование 6 часов транслируемого мероприятия, но без публикации.</span><span class="sxs-lookup"><span data-stu-id="b85da-264">One program is set to archive 6 hours of the event, but the program is not published.</span></span> <span data-ttu-id="b85da-265">Для второй программы настроено архивирование 10 минут с публикацией.</span><span class="sxs-lookup"><span data-stu-id="b85da-265">The other program is set to archive for 10 minutes, and this program is published.</span></span>

<span data-ttu-id="b85da-266">Не используйте существующие программы повторно для новых мероприятий.</span><span class="sxs-lookup"><span data-stu-id="b85da-266">You should not reuse existing programs for new events.</span></span> <span data-ttu-id="b85da-267">Вместо этого создайте новую программу для каждого события.</span><span class="sxs-lookup"><span data-stu-id="b85da-267">Instead, create a new program for each event.</span></span> <span data-ttu-id="b85da-268">Когда вы будете готовы начать потоковую передачу и архивацию, запустите программу.</span><span class="sxs-lookup"><span data-stu-id="b85da-268">Start the program when you're ready to start streaming and archiving.</span></span> <span data-ttu-id="b85da-269">Чтобы остановить потоковую передачу и архивацию содержимого мероприятия, завершите работу программы.</span><span class="sxs-lookup"><span data-stu-id="b85da-269">Stop the program whenever you want to stop streaming and archiving the event.</span></span>

<span data-ttu-id="b85da-270">Чтобы удалить архивированное содержимое, остановите и удалите программу, а затем удалите связанный с ней ресурс.</span><span class="sxs-lookup"><span data-stu-id="b85da-270">To delete archived content, stop and delete the program, and then delete the associated asset.</span></span> <span data-ttu-id="b85da-271">Ресурс невозможно удалить, пока он используется какой-либо программой.</span><span class="sxs-lookup"><span data-stu-id="b85da-271">An asset cannot be deleted if a program uses it.</span></span> <span data-ttu-id="b85da-272">Сначала нужно удалить программу.</span><span class="sxs-lookup"><span data-stu-id="b85da-272">The program must be deleted first.</span></span>

<span data-ttu-id="b85da-273">Даже после остановки и удаления программы пользователи смогут запрашивать потоковую передачу архивированного видеосодержимого, пока не удален соответствующий ресурс.</span><span class="sxs-lookup"><span data-stu-id="b85da-273">Even after you stop and delete the program, users can stream your archived content as a video on demand, until you delete the asset.</span></span> <span data-ttu-id="b85da-274">Если вы хотите сохранить архивированное содержимое, но при этом заблокировать возможность его потоковой передачи, удалите указатель.</span><span class="sxs-lookup"><span data-stu-id="b85da-274">If you want to retain the archived content but not have it available for streaming, delete the streaming locator.</span></span>

## <span data-ttu-id="b85da-275"><a id="states"></a>Состояния канала и их сопоставление с режимом выставления счетов</span><span class="sxs-lookup"><span data-stu-id="b85da-275"><a id="states"></a>Channel states and billing</span></span>
<span data-ttu-id="b85da-276">Возможные значения для текущего состояния канала:</span><span class="sxs-lookup"><span data-stu-id="b85da-276">Possible values for the current state of a channel include:</span></span>

* <span data-ttu-id="b85da-277">**Остановлен.** Это начальное состояние канала после его создания.</span><span class="sxs-lookup"><span data-stu-id="b85da-277">**Stopped**: This is the initial state of the channel after its creation.</span></span> <span data-ttu-id="b85da-278">В этом состоянии можно изменять свойства канала, но потоковая передача запрещена.</span><span class="sxs-lookup"><span data-stu-id="b85da-278">In this state, the channel properties can be updated but streaming is not allowed.</span></span>
* <span data-ttu-id="b85da-279">**Запуск.** Канал запускается.</span><span class="sxs-lookup"><span data-stu-id="b85da-279">**Starting**: The channel is being started.</span></span> <span data-ttu-id="b85da-280">В этом состоянии обновление и потоковая передача запрещены.</span><span class="sxs-lookup"><span data-stu-id="b85da-280">No updates or streaming is allowed during this state.</span></span> <span data-ttu-id="b85da-281">Если возникает ошибка, канал возвращается в состояние **Остановлен**.</span><span class="sxs-lookup"><span data-stu-id="b85da-281">If an error occurs, the channel returns to the **Stopped** state.</span></span>
* <span data-ttu-id="b85da-282">**Выполняется.** Канал может обрабатывать динамические потоки.</span><span class="sxs-lookup"><span data-stu-id="b85da-282">**Running**: The channel can process live streams.</span></span>
* <span data-ttu-id="b85da-283">**Остановка.** Канал останавливается.</span><span class="sxs-lookup"><span data-stu-id="b85da-283">**Stopping**: The channel is being stopped.</span></span> <span data-ttu-id="b85da-284">В этом состоянии обновление и потоковая передача запрещены.</span><span class="sxs-lookup"><span data-stu-id="b85da-284">No updates or streaming is allowed during this state.</span></span>
* <span data-ttu-id="b85da-285">**Удаление.** Канал удаляется.</span><span class="sxs-lookup"><span data-stu-id="b85da-285">**Deleting**: The channel is being deleted.</span></span> <span data-ttu-id="b85da-286">В этом состоянии обновление и потоковая передача запрещены.</span><span class="sxs-lookup"><span data-stu-id="b85da-286">No updates or streaming is allowed during this state.</span></span>

<span data-ttu-id="b85da-287">В таблице ниже показано, как состояния канала соотносятся с режимом выставления счетов.</span><span class="sxs-lookup"><span data-stu-id="b85da-287">The following table shows how channel states map to the billing mode.</span></span>

| <span data-ttu-id="b85da-288">Состояние канала</span><span class="sxs-lookup"><span data-stu-id="b85da-288">Channel state</span></span> | <span data-ttu-id="b85da-289">Индикаторы в пользовательском интерфейсе портала</span><span class="sxs-lookup"><span data-stu-id="b85da-289">Portal UI indicators</span></span> | <span data-ttu-id="b85da-290">Выставление счетов</span><span class="sxs-lookup"><span data-stu-id="b85da-290">Billed?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="b85da-291">**Запуск**</span><span class="sxs-lookup"><span data-stu-id="b85da-291">**Starting**</span></span> |<span data-ttu-id="b85da-292">**Запуск**</span><span class="sxs-lookup"><span data-stu-id="b85da-292">**Starting**</span></span> |<span data-ttu-id="b85da-293">Нет (переходное состояние)</span><span class="sxs-lookup"><span data-stu-id="b85da-293">No (transient state)</span></span> |
| <span data-ttu-id="b85da-294">**Выполнение**</span><span class="sxs-lookup"><span data-stu-id="b85da-294">**Running**</span></span> |<span data-ttu-id="b85da-295">**Готово** (нет запущенных программ)</span><span class="sxs-lookup"><span data-stu-id="b85da-295">**Ready** (no running programs)</span></span><p><p><span data-ttu-id="b85da-296">или</span><span class="sxs-lookup"><span data-stu-id="b85da-296">or</span></span><p><span data-ttu-id="b85da-297">**Потоковая передача** (запущена по крайней мере одна программа)</span><span class="sxs-lookup"><span data-stu-id="b85da-297">**Streaming** (at least one running program)</span></span> |<span data-ttu-id="b85da-298">Да</span><span class="sxs-lookup"><span data-stu-id="b85da-298">Yes</span></span> |
| <span data-ttu-id="b85da-299">**Остановка**</span><span class="sxs-lookup"><span data-stu-id="b85da-299">**Stopping**</span></span> |<span data-ttu-id="b85da-300">**Остановка**</span><span class="sxs-lookup"><span data-stu-id="b85da-300">**Stopping**</span></span> |<span data-ttu-id="b85da-301">Нет (переходное состояние)</span><span class="sxs-lookup"><span data-stu-id="b85da-301">No (transient state)</span></span> |
| <span data-ttu-id="b85da-302">**Stopped**</span><span class="sxs-lookup"><span data-stu-id="b85da-302">**Stopped**</span></span> |<span data-ttu-id="b85da-303">**Stopped**</span><span class="sxs-lookup"><span data-stu-id="b85da-303">**Stopped**</span></span> |<span data-ttu-id="b85da-304">Нет</span><span class="sxs-lookup"><span data-stu-id="b85da-304">No</span></span> |

## <span data-ttu-id="b85da-305"><a id="cc_and_ads"></a>Вставка субтитров и рекламы</span><span class="sxs-lookup"><span data-stu-id="b85da-305"><a id="cc_and_ads"></a>Closed captioning and ad insertion</span></span>
<span data-ttu-id="b85da-306">В следующей таблице показаны поддерживаемые стандарты субтитров и рекламы.</span><span class="sxs-lookup"><span data-stu-id="b85da-306">The following table demonstrates supported standards for closed captioning and ad insertion.</span></span>

| <span data-ttu-id="b85da-307">Standard</span><span class="sxs-lookup"><span data-stu-id="b85da-307">Standard</span></span> | <span data-ttu-id="b85da-308">Примечания</span><span class="sxs-lookup"><span data-stu-id="b85da-308">Notes</span></span> |
| --- | --- |
| <span data-ttu-id="b85da-309">CEA-708 и EIA-608 (708/608)</span><span class="sxs-lookup"><span data-stu-id="b85da-309">CEA-708 and EIA-608 (708/608)</span></span> |<span data-ttu-id="b85da-310">CEA-708 и EIA-608 — это стандарты субтитров для США и Канады.</span><span class="sxs-lookup"><span data-stu-id="b85da-310">CEA-708 and EIA-608 are closed-captioning standards for the United States and Canada.</span></span><p><p><span data-ttu-id="b85da-311">В настоящее время субтитры поддерживаются, только если они передаются в закодированном входном потоке.</span><span class="sxs-lookup"><span data-stu-id="b85da-311">Currently, captioning is supported only if carried in the encoded input stream.</span></span> <span data-ttu-id="b85da-312">Необходимо использовать динамический кодировщик мультимедиа, который может вставлять субтитры стандарта 608 или 708 в закодированный поток, передаваемый службам мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="b85da-312">You need to use a live media encoder that can insert 608 or 708 captions in the encoded stream that's sent to Media Services.</span></span> <span data-ttu-id="b85da-313">Службы мультимедиа доставляют зрителям контент с субтитрами.</span><span class="sxs-lookup"><span data-stu-id="b85da-313">Media Services delivers the content with inserted captions to your viewers.</span></span> |
| <span data-ttu-id="b85da-314">TTML в ismt (текстовые дорожки Smooth Streaming)</span><span class="sxs-lookup"><span data-stu-id="b85da-314">TTML inside .ismt (Smooth Streaming text tracks)</span></span> |<span data-ttu-id="b85da-315">Динамическая упаковка служб мультимедиа позволяет клиентам выполнять потоковую передачу контента в любом из следующих форматов: DASH, HLS или Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="b85da-315">Media Services dynamic packaging enables your clients to stream content in any of the following formats: DASH, HLS, or Smooth Streaming.</span></span> <span data-ttu-id="b85da-316">Однако если вы принимаете фрагментированный поток MP4 (Smooth Streaming) с субтитрами внутри ISMT (текстовых дорожек Smooth Streaming), вы сможете доставлять контент только клиентам Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="b85da-316">However, if you ingest fragmented MP4 (Smooth Streaming) with captions inside .ismt (Smooth Streaming text tracks), you can deliver the stream to only Smooth Streaming clients.</span></span> |
| <span data-ttu-id="b85da-317">SCTE-35</span><span class="sxs-lookup"><span data-stu-id="b85da-317">SCTE-35</span></span> |<span data-ttu-id="b85da-318">SCTE-35 — это цифровая система передачи сигналов, которая используется для вставки рекламы.</span><span class="sxs-lookup"><span data-stu-id="b85da-318">SCTE-35 is a digital signaling system that's used to cue advertising insertion.</span></span> <span data-ttu-id="b85da-319">Получатели используют сигнал для вставки рекламы в поток на отведенное время.</span><span class="sxs-lookup"><span data-stu-id="b85da-319">Downstream receivers use the signal to splice advertising into the stream for the allotted time.</span></span> <span data-ttu-id="b85da-320">Данные SCTE-35 следует передавать в виде отдельной дорожки во входном потоке.</span><span class="sxs-lookup"><span data-stu-id="b85da-320">SCTE-35 must be sent as a sparse track in the input stream.</span></span><p><p><span data-ttu-id="b85da-321">В настоящее время поддерживается только один формат входного потока, который переносит рекламные сигналы, — фрагментированный MP4 (Smooth Streaming).</span><span class="sxs-lookup"><span data-stu-id="b85da-321">Currently, the only supported input stream format that carries ad signals is fragmented MP4 (Smooth Streaming).</span></span> <span data-ttu-id="b85da-322">Единственным поддерживаемый выходной формат — это также Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="b85da-322">The only supported output format is also Smooth Streaming.</span></span> |

## <span data-ttu-id="b85da-323"><a id="considerations"></a>Рекомендации</span><span class="sxs-lookup"><span data-stu-id="b85da-323"><a id="considerations"></a>Considerations</span></span>
<span data-ttu-id="b85da-324">При использовании локального динамического кодировщика для отправки потока с разными скоростями в канал действуют следующие ограничения.</span><span class="sxs-lookup"><span data-stu-id="b85da-324">When you're using an on-premises live encoder to send a multi-bitrate stream to a channel, the following constraints apply:</span></span>

* <span data-ttu-id="b85da-325">Убедитесь, что имеется достаточно свободных возможностей подключения к Интернету для отправки данных точкам приема.</span><span class="sxs-lookup"><span data-stu-id="b85da-325">Make sure you have sufficient free Internet connectivity to send data to the ingest points.</span></span>
* <span data-ttu-id="b85da-326">Для использования дополнительного URL-адреса приема требуется дополнительная пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="b85da-326">Using a secondary ingest URL requires additional bandwidth.</span></span>
* <span data-ttu-id="b85da-327">Входящий поток с разными скоростями может предоставлять не более 10 уровней качества видео (слоев) и не более 5 звуковых дорожек.</span><span class="sxs-lookup"><span data-stu-id="b85da-327">The incoming multi-bitrate stream can have a maximum of 10 video quality levels (layers) and a maximum of 5 audio tracks.</span></span>
* <span data-ttu-id="b85da-328">Наибольшая средняя скорость передачи для любого из уровней качества видео не должна превышать 10 Мбит/с.</span><span class="sxs-lookup"><span data-stu-id="b85da-328">The highest average bitrate for any of the video quality levels should be below 10 Mbps.</span></span>
* <span data-ttu-id="b85da-329">Общее значение средних скоростей для всех видео- и аудиопотоков всегда должно быть меньше 25 Мбит/с.</span><span class="sxs-lookup"><span data-stu-id="b85da-329">The aggregate of the average bitrates for all the video and audio streams should be below 25 Mbps.</span></span>
* <span data-ttu-id="b85da-330">Во время работы канала или связанных с ним программ входной протокол изменить нельзя.</span><span class="sxs-lookup"><span data-stu-id="b85da-330">You cannot change the input protocol while the channel or its associated programs are running.</span></span> <span data-ttu-id="b85da-331">Если вам нужны другие протоколы, создайте отдельный канал для каждого из них.</span><span class="sxs-lookup"><span data-stu-id="b85da-331">If you require different protocols, you should create separate channels for each input protocol.</span></span>
* <span data-ttu-id="b85da-332">Канал может принимать поток с одной скоростью передачи.</span><span class="sxs-lookup"><span data-stu-id="b85da-332">You can ingest a single bitrate in your channel.</span></span> <span data-ttu-id="b85da-333">Но из-за того, что поток не обрабатывается каналом, клиентские приложения также будут получать поток с одной скоростью.</span><span class="sxs-lookup"><span data-stu-id="b85da-333">But because the channel does not process the stream, the client applications will also receive a single bitrate stream.</span></span> <span data-ttu-id="b85da-334">(Этот вариант не рекомендуется.)</span><span class="sxs-lookup"><span data-stu-id="b85da-334">(We don't recommend this option.)</span></span>

<span data-ttu-id="b85da-335">Ниже приведены другие рекомендации по работе с каналами и связанными компонентами.</span><span class="sxs-lookup"><span data-stu-id="b85da-335">Here are other considerations related to working with channels and related components:</span></span>

* <span data-ttu-id="b85da-336">Каждый раз при повторной настройке динамического кодировщика вызывайте для канала метод **Reset** .</span><span class="sxs-lookup"><span data-stu-id="b85da-336">Every time you reconfigure the live encoder, call the **Reset** method on the channel.</span></span> <span data-ttu-id="b85da-337">Перед сбросом канала нужно остановить программу.</span><span class="sxs-lookup"><span data-stu-id="b85da-337">Before you reset the channel, you have to stop the program.</span></span> <span data-ttu-id="b85da-338">После сброса канала перезапустите программу.</span><span class="sxs-lookup"><span data-stu-id="b85da-338">After you reset the channel, restart the program.</span></span>
* <span data-ttu-id="b85da-339">Канал можно остановить, только если он находится в состоянии **Выполняется** и все передаваемые по нему программы остановлены.</span><span class="sxs-lookup"><span data-stu-id="b85da-339">A channel can be stopped only when it's in the **Running** state and all programs on the channel have been stopped.</span></span>
* <span data-ttu-id="b85da-340">По умолчанию в учетную запись служб мультимедиа можно добавить до 5 каналов.</span><span class="sxs-lookup"><span data-stu-id="b85da-340">By default, you can add only 5 channels to your Media Services account.</span></span> <span data-ttu-id="b85da-341">Дополнительные сведения см. в статье [Квоты и ограничения](media-services-quotas-and-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="b85da-341">For more information, see [Quotas and limitations](media-services-quotas-and-limitations.md).</span></span>
* <span data-ttu-id="b85da-342">Счета выставляются, только когда канал находится в состоянии **Выполняется**.</span><span class="sxs-lookup"><span data-stu-id="b85da-342">You are billed only when your channel is in the **Running** state.</span></span> <span data-ttu-id="b85da-343">Дополнительные сведения см. в разделе [Состояния канала и их сопоставление с режимом выставления счетов](media-services-live-streaming-with-onprem-encoders.md#states).</span><span class="sxs-lookup"><span data-stu-id="b85da-343">For more information, refer to the [Channel states and billing](media-services-live-streaming-with-onprem-encoders.md#states) section.</span></span>

## <a name="media-services-learning-paths"></a><span data-ttu-id="b85da-344">Схемы обучения работе со службами мультимедиа</span><span class="sxs-lookup"><span data-stu-id="b85da-344">Media Services learning paths</span></span>
[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="feedback"></a><span data-ttu-id="b85da-345">Отзыв</span><span class="sxs-lookup"><span data-stu-id="b85da-345">Feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

## <a name="related-topics"></a><span data-ttu-id="b85da-346">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="b85da-346">Related topics</span></span>
[<span data-ttu-id="b85da-347">Спецификация приема фрагментированного потока MP4 в режиме реального времени в службах мультимедиа Azure</span><span class="sxs-lookup"><span data-stu-id="b85da-347">Azure Media Services fragmented MP4 live ingest specification</span></span>](media-services-fmp4-live-ingest-overview.md)

[<span data-ttu-id="b85da-348">Общие сведения о службах мультимедиа Azure и распространенные сценарии</span><span class="sxs-lookup"><span data-stu-id="b85da-348">Azure Media Services overview and common scenarios</span></span>](media-services-overview.md)

[<span data-ttu-id="b85da-349">Основные понятия служб мультимедиа Azure</span><span class="sxs-lookup"><span data-stu-id="b85da-349">Media Services concepts</span></span>](media-services-concepts.md)

[live-overview]: ./media/media-services-manage-channels-overview/media-services-live-streaming-current.png
