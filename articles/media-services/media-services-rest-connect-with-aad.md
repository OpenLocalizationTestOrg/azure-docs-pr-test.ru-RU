---
title: "aaaUse tooaccess проверки подлинности Azure AD API служб мультимедиа Azure с REST | Документы Microsoft"
description: "Узнайте, как tooaccess API служб мультимедиа Azure с проверкой подлинности Azure Active Directory с помощью REST."
services: media-services
documentationcenter: 
author: willzhan
manager: cfowler
editor: 
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/17/2017
ms.author: willzhan;juliako
ms.openlocfilehash: 114f7bdde3a8f5fe6189d712e05b6afdc8a8787a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="use-azure-ad-authentication-tooaccess-hello-azure-media-services-api-with-rest"></a><span data-ttu-id="f36d0-103">Здравствуйте, tooaccess проверки подлинности Azure AD для использования API служб мультимедиа Azure с REST</span><span class="sxs-lookup"><span data-stu-id="f36d0-103">Use Azure AD authentication tooaccess hello Azure Media Services API with REST</span></span>

<span data-ttu-id="f36d0-104">разработчиков служб мультимедиа Azure Hello выпустила поддержка проверки подлинности Azure Active Directory (Azure AD) для доступа к службам мультимедиа Azure.</span><span class="sxs-lookup"><span data-stu-id="f36d0-104">hello Azure Media Services team has released Azure Active Directory (Azure AD) authentication support for Azure Media Services access.</span></span> <span data-ttu-id="f36d0-105">Он также объявлены планы toodeprecate контроля доступа Azure службы проверки подлинности для доступа к службам мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="f36d0-105">It also announced plans toodeprecate Azure Access Control service authentication for Media Services access.</span></span> <span data-ttu-id="f36d0-106">Поскольку каждая подписка Azure и каждая учетная запись служб мультимедиа, клиент вложенного tooan Azure AD, поддержка проверки подлинности Azure AD имеет много преимуществ безопасности.</span><span class="sxs-lookup"><span data-stu-id="f36d0-106">Because every Azure subscription, and every Media Services account, is attached tooan Azure AD tenant, Azure AD authentication support brings many security benefits.</span></span> <span data-ttu-id="f36d0-107">Подробные сведения об этом изменении и миграции (при использовании hello Media Services .NET SDK для приложения), см. ниже hello блога в блогах и статьи:</span><span class="sxs-lookup"><span data-stu-id="f36d0-107">For details about this change and migration (if you use hello Media Services .NET SDK for your app), see hello following blog posts and articles:</span></span>

- <span data-ttu-id="f36d0-108">[Azure Media Services announces support for Azure AD and deprecation of Access Control authentication](https://azure.microsoft.com/blog/azure%20media%20service%20aad%20auth%20and%20acs%20deprecation) (Команда разработчиков служб мультимедиа Azure анонсирует поддержку аутентификации AAD и объявление устаревшей аутентификацию ACS)</span><span class="sxs-lookup"><span data-stu-id="f36d0-108">[Azure Media Services announces support for Azure AD and deprecation of Access Control authentication](https://azure.microsoft.com/blog/azure%20media%20service%20aad%20auth%20and%20acs%20deprecation)</span></span>
- <span data-ttu-id="f36d0-109">[Access Azure Media Services API by using Azure AD authentication](media-services-use-aad-auth-to-access-ams-api.md) (Доступ к API служб мультимедиа Azure с помощью аутентификации Azure AD)</span><span class="sxs-lookup"><span data-stu-id="f36d0-109">[Access Azure Media Services API by using Azure AD authentication](media-services-use-aad-auth-to-access-ams-api.md)</span></span>
- [<span data-ttu-id="f36d0-110">Использование проверки подлинности Azure AD tooaccess API служб мультимедиа Azure с помощью Microsoft .NET</span><span class="sxs-lookup"><span data-stu-id="f36d0-110">Use Azure AD authentication tooaccess Azure Media Services API by using Microsoft .NET</span></span>](media-services-dotnet-get-started-with-aad.md)
- [<span data-ttu-id="f36d0-111">Начало работы с проверкой подлинности Azure AD с помощью hello портал Azure</span><span class="sxs-lookup"><span data-stu-id="f36d0-111">Getting started with Azure AD authentication by using hello Azure portal</span></span>](media-services-portal-get-started-with-aad.md)

<span data-ttu-id="f36d0-112">Некоторые клиенты должны toodevelop своих решений служб мультимедиа в hello следующие ограничения:</span><span class="sxs-lookup"><span data-stu-id="f36d0-112">Some customers need toodevelop their Media Services solutions under hello following constraints:</span></span>

*   <span data-ttu-id="f36d0-113">Они используют язык программирования, который не является Microsoft .NET или C#, или не hello среды выполнения Windows.</span><span class="sxs-lookup"><span data-stu-id="f36d0-113">They use a programming language that is not Microsoft .NET or C#, or hello runtime environment is not Windows.</span></span>
*   <span data-ttu-id="f36d0-114">Библиотеки Azure AD, таких как библиотеки проверки подлинности Active Directory недоступны для языка программирования hello или не может использоваться для своей среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="f36d0-114">Azure AD libraries such as Active Directory Authentication Libraries are not available for hello programming language or can't be used for their runtime environment.</span></span>

<span data-ttu-id="f36d0-115">Некоторые клиенты разработали приложения с помощью REST API для аутентификации ACS и доступа к службам мультимедиа Azure.</span><span class="sxs-lookup"><span data-stu-id="f36d0-115">Some customers have developed applications by using REST API for both Access Control authentication and Azure Media Services access.</span></span> <span data-ttu-id="f36d0-116">Для этих клиентов необходимо типа способом toouse только hello REST API для проверки подлинности Azure AD и доступ к последующих служб мультимедиа Azure.</span><span class="sxs-lookup"><span data-stu-id="f36d0-116">For these customers, you need a way toouse only hello REST API for Azure AD authentication and subsequent Azure Media Services access.</span></span> <span data-ttu-id="f36d0-117">Требуется toonot полагаться на любую из библиотек hello Azure AD или hello Media Services .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="f36d0-117">You need toonot rely on any of hello Azure AD libraries or on hello Media Services .NET SDK.</span></span> <span data-ttu-id="f36d0-118">В этой статье описывается решение и рассматриваются примеры кода для такого сценария.</span><span class="sxs-lookup"><span data-stu-id="f36d0-118">In this article, we describe a solution and provide sample code for this scenario.</span></span> <span data-ttu-id="f36d0-119">Так как код hello — все вызовы REST API, не зависящий от любого Azure AD или библиотеки служб мультимедиа Azure hello кода можно легко быть переведенные tooany другому языку программирования.</span><span class="sxs-lookup"><span data-stu-id="f36d0-119">Because hello code is all REST API calls, with no dependency on any Azure AD or Azure Media Services library, hello code can easily be translated tooany other programming language.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f36d0-120">В настоящее время службы мультимедиа поддерживают модель проверки подлинности служб Azure Access Control hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-120">Currently, Media Services supports hello Azure Access Control services authentication model.</span></span> <span data-ttu-id="f36d0-121">Тем не менее авторизация посредством службы контроля доступа будет объявлена устаревшей 1 июня 2018 года.</span><span class="sxs-lookup"><span data-stu-id="f36d0-121">However, Access Control authentication will be deprecated June 1, 2018.</span></span> <span data-ttu-id="f36d0-122">Рекомендуется как можно быстрее перейти модель проверки подлинности toohello Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f36d0-122">We recommend that you migrate toohello Azure AD authentication model as soon as possible.</span></span>


## <a name="design"></a><span data-ttu-id="f36d0-123">Проектирование</span><span class="sxs-lookup"><span data-stu-id="f36d0-123">Design</span></span>

<span data-ttu-id="f36d0-124">В этой статье мы используем hello после проверки подлинности и авторизации разработки:</span><span class="sxs-lookup"><span data-stu-id="f36d0-124">In this article, we use hello following authentication and authorization design:</span></span>

*  <span data-ttu-id="f36d0-125">Протокол авторизации: OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="f36d0-125">Authorization protocol: OAuth 2.0.</span></span> <span data-ttu-id="f36d0-126">OAuth 2.0 — это стандарт безопасности Интернета, включающий в себя аутентификацию и авторизацию.</span><span class="sxs-lookup"><span data-stu-id="f36d0-126">OAuth 2.0 is a web security standard that covers both authentication and authorization.</span></span> <span data-ttu-id="f36d0-127">Он поддерживается Google, корпорацией Майкрософт, Facebook и PayPal.</span><span class="sxs-lookup"><span data-stu-id="f36d0-127">It is supported by Google, Microsoft, Facebook, and PayPal.</span></span> <span data-ttu-id="f36d0-128">Он был ратифицирован в октябре 2012 года.</span><span class="sxs-lookup"><span data-stu-id="f36d0-128">It was ratified October 2012.</span></span> <span data-ttu-id="f36d0-129">Корпорация Майкрософт твердо поддерживает OAuth 2.0 и OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="f36d0-129">Microsoft firmly supports OAuth 2.0 and OpenID Connect.</span></span> <span data-ttu-id="f36d0-130">Оба эти стандарта поддерживаются во множестве служб и клиентских библиотек, включая Azure Active Directory, Open Web Interface for .NET (OWIN) Katana и библиотеки Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f36d0-130">Both of these standards are supported in multiple services and client libraries, including Azure Active Directory, Open Web Interface for .NET (OWIN) Katana, and Azure AD libraries.</span></span>
*  <span data-ttu-id="f36d0-131">Тип предоставления разрешения: предоставление учетных данных клиента.</span><span class="sxs-lookup"><span data-stu-id="f36d0-131">Grant type: Client credentials grant type.</span></span> <span data-ttu-id="f36d0-132">Учетные данные клиента является одним из типов четыре grant hello в OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="f36d0-132">Client credentials is one of hello four grant types in OAuth 2.0.</span></span> <span data-ttu-id="f36d0-133">Они часто используются для доступа к API Microsoft Graph для Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f36d0-133">It's often used for Azure AD Microsoft Graph API access.</span></span>
*  <span data-ttu-id="f36d0-134">Режим аутентификации: субъект-служба.</span><span class="sxs-lookup"><span data-stu-id="f36d0-134">Authentication mode: Service principal.</span></span> <span data-ttu-id="f36d0-135">Hello других используется проверка подлинности пользователя или интерактивной проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="f36d0-135">hello other authentication mode is user or interactive authentication.</span></span>

<span data-ttu-id="f36d0-136">Всего четыре приложения или службы, участвующих в поток проверки подлинности и авторизации hello Azure AD для использования служб мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="f36d0-136">A total of four applications or services are involved in hello Azure AD authentication and authorization flow for using Media Services.</span></span> <span data-ttu-id="f36d0-137">Hello приложений и служб и потока hello, описаны в следующей таблице hello:</span><span class="sxs-lookup"><span data-stu-id="f36d0-137">hello applications and services, and hello flow, are described in hello following table:</span></span>

|<span data-ttu-id="f36d0-138">Тип приложения</span><span class="sxs-lookup"><span data-stu-id="f36d0-138">Application type</span></span> |<span data-ttu-id="f36d0-139">Приложение</span><span class="sxs-lookup"><span data-stu-id="f36d0-139">Application</span></span> |<span data-ttu-id="f36d0-140">Поток</span><span class="sxs-lookup"><span data-stu-id="f36d0-140">Flow</span></span>|
|---|---|---|
|<span data-ttu-id="f36d0-141">Клиент</span><span class="sxs-lookup"><span data-stu-id="f36d0-141">Client</span></span> | <span data-ttu-id="f36d0-142">Приложение или решение клиента</span><span class="sxs-lookup"><span data-stu-id="f36d0-142">Customer app or solution</span></span> | <span data-ttu-id="f36d0-143">Это приложение (на самом деле, его прокси) регистрируется в hello клиента Azure AD, в которой hello Azure media подписки и hello находятся учетной записи службы.</span><span class="sxs-lookup"><span data-stu-id="f36d0-143">This app (actually, its proxy) is registered in hello Azure AD tenant in which hello Azure subscription and hello media service account reside.</span></span> <span data-ttu-id="f36d0-144">Hello участника-службы приложения hello зарегистрированные предоставляется с владельцем или участником роли в hello управления доступа (IAM) учетной записи службы мультимедиа hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-144">hello service principal of hello registered app is then granted with Owner or Contributor role in hello Access Control (IAM) of hello media service account.</span></span> <span data-ttu-id="f36d0-145">Hello участника-службы будет представлен hello приложения клиента идентификатор и секрет клиента.</span><span class="sxs-lookup"><span data-stu-id="f36d0-145">hello service principal is represented by hello app client ID and client secret.</span></span> |
|<span data-ttu-id="f36d0-146">Поставщик удостоверений (IdP)</span><span class="sxs-lookup"><span data-stu-id="f36d0-146">Identity Provider (IDP)</span></span> | <span data-ttu-id="f36d0-147">Azure AD в качестве поставщика удостоверений</span><span class="sxs-lookup"><span data-stu-id="f36d0-147">Azure AD as IDP</span></span> | <span data-ttu-id="f36d0-148">Hello зарегистрированного приложения субъекта-службы (идентификатор клиента и секрет клиента) проходит проверку подлинности Azure AD в качестве поставщика Удостоверений hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-148">hello registered app service principal (client ID and client secret) is authenticated by Azure AD as hello IDP.</span></span> <span data-ttu-id="f36d0-149">Это внутренняя аутентификация, которая выполняется неявно.</span><span class="sxs-lookup"><span data-stu-id="f36d0-149">This authentication is performed internally and implicitly.</span></span> <span data-ttu-id="f36d0-150">Как и поток клиентских учетных данных клиента hello проходит проверку подлинности вместо пользователя hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-150">As in client credentials flow, hello client is authenticated instead of hello user.</span></span> |
|<span data-ttu-id="f36d0-151">Служба токенов безопасности (STS) или сервер OAuth</span><span class="sxs-lookup"><span data-stu-id="f36d0-151">Secure Token Service (STS)/OAuth server</span></span> | <span data-ttu-id="f36d0-152">Azure AD в качестве службы токенов безопасности</span><span class="sxs-lookup"><span data-stu-id="f36d0-152">Azure AD as STS</span></span> | <span data-ttu-id="f36d0-153">После проверки подлинности поставщика Удостоверений hello (или сервером OAuth в терминах OAuth 2.0), маркер доступа или JSON Web Token (JWT) выданный Azure AD в качестве сервера службы маркеров безопасности или OAuth для ресурса среднего уровня доступа toohello: в нашем случае hello конечной точки API REST служб мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="f36d0-153">After authentication by hello IDP (or OAuth Server in OAuth 2.0 terms), an access token or JSON Web Token (JWT) is issued by Azure AD as STS/OAuth Server for access toohello middle-tier resource: in our case, hello Media Services REST API endpoint.</span></span> |
|<span data-ttu-id="f36d0-154">Ресурс</span><span class="sxs-lookup"><span data-stu-id="f36d0-154">Resource</span></span> | <span data-ttu-id="f36d0-155">REST API для службы мультимедиа</span><span class="sxs-lookup"><span data-stu-id="f36d0-155">Media Services REST API</span></span> | <span data-ttu-id="f36d0-156">Каждый вызов API REST служб мультимедиа авторизован, маркер доступа, выданный Azure AD как STS или сервер OAuth hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-156">Every Media Services REST API call is authorized by an access token that is issued by Azure AD as STS or hello OAuth server.</span></span> |

<span data-ttu-id="f36d0-157">Если запустить пример кода hello и фиксации JWT и маркер доступа, hello JWT имеет hello следующие атрибуты:</span><span class="sxs-lookup"><span data-stu-id="f36d0-157">If you run hello sample code and capture a JWT or an access token, hello JWT has hello following attributes:</span></span>

    aud: "https://rest.media.azure.net",

    iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/",

    iat: 1497146280,

    nbf: 1497146280,
    exp: 1497150180,

    aio: "Y2ZgYDjuy7SptPzO/muf+uRu1B+ZDQA=",

    appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6",

    appidacr: "1",

    idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/",

    oid: "a938cfcc-d3de-479c-b0dd-d4ffe6f50f7c",

    sub: "a938cfcc-d3de-479c-b0dd-d4ffe6f50f7c",

    tid: "72f988bf-86f1-41af-91ab-2d7cd011db47",

<span data-ttu-id="f36d0-158">Ниже приведены hello сопоставления между атрибуты hello hello JWT и hello четыре приложений или служб в предшествующей таблице hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-158">Here are hello mappings between hello attributes in hello JWT and hello four applications or services in hello preceding table:</span></span>

|<span data-ttu-id="f36d0-159">Тип приложения</span><span class="sxs-lookup"><span data-stu-id="f36d0-159">Application type</span></span> |<span data-ttu-id="f36d0-160">Приложение</span><span class="sxs-lookup"><span data-stu-id="f36d0-160">Application</span></span> |<span data-ttu-id="f36d0-161">Атрибут JWT</span><span class="sxs-lookup"><span data-stu-id="f36d0-161">JWT attribute</span></span> |
|---|---|---|
|<span data-ttu-id="f36d0-162">Клиент</span><span class="sxs-lookup"><span data-stu-id="f36d0-162">Client</span></span> |<span data-ttu-id="f36d0-163">Приложение или решение клиента</span><span class="sxs-lookup"><span data-stu-id="f36d0-163">Customer app or solution</span></span> |<span data-ttu-id="f36d0-164">appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6".</span><span class="sxs-lookup"><span data-stu-id="f36d0-164">appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6".</span></span> <span data-ttu-id="f36d0-165">Hello идентификатор клиента приложения tooAzure AD будет зарегистрирован в следующем разделе hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-165">hello client ID of an application you will register tooAzure AD in hello next section.</span></span> |
|<span data-ttu-id="f36d0-166">Поставщик удостоверений (IdP)</span><span class="sxs-lookup"><span data-stu-id="f36d0-166">Identity Provider (IDP)</span></span> | <span data-ttu-id="f36d0-167">Azure AD в качестве поставщика удостоверений</span><span class="sxs-lookup"><span data-stu-id="f36d0-167">Azure AD as IDP</span></span> |<span data-ttu-id="f36d0-168">idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span><span class="sxs-lookup"><span data-stu-id="f36d0-168">idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span></span>  <span data-ttu-id="f36d0-169">Hello GUID — идентификатор Microsoft hello клиента (microsoft.onmicrosoft.com).</span><span class="sxs-lookup"><span data-stu-id="f36d0-169">hello GUID is hello ID of Microsoft tenant (microsoft.onmicrosoft.com).</span></span> <span data-ttu-id="f36d0-170">У каждого клиента есть уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="f36d0-170">Each tenant has its own, unique ID.</span></span> |
|<span data-ttu-id="f36d0-171">Служба токенов безопасности (STS) или сервер OAuth</span><span class="sxs-lookup"><span data-stu-id="f36d0-171">Secure Token Service (STS)/OAuth server</span></span> |<span data-ttu-id="f36d0-172">Azure AD в качестве службы токенов безопасности</span><span class="sxs-lookup"><span data-stu-id="f36d0-172">Azure AD as STS</span></span> | <span data-ttu-id="f36d0-173">iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span><span class="sxs-lookup"><span data-stu-id="f36d0-173">iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span></span> <span data-ttu-id="f36d0-174">Hello GUID — идентификатор Microsoft hello клиента (microsoft.onmicrosoft.com).</span><span class="sxs-lookup"><span data-stu-id="f36d0-174">hello GUID is hello ID of Microsoft tenant (microsoft.onmicrosoft.com).</span></span> |
|<span data-ttu-id="f36d0-175">Ресурс</span><span class="sxs-lookup"><span data-stu-id="f36d0-175">Resource</span></span> | <span data-ttu-id="f36d0-176">REST API для службы мультимедиа</span><span class="sxs-lookup"><span data-stu-id="f36d0-176">Media Services REST API</span></span> |<span data-ttu-id="f36d0-177">aud: "https://rest.media.azure.net".</span><span class="sxs-lookup"><span data-stu-id="f36d0-177">aud: "https://rest.media.azure.net".</span></span> <span data-ttu-id="f36d0-178">Hello получателя или аудитории токена доступа hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-178">hello recipient or audience of hello access token.</span></span> |

## <a name="steps-for-setup"></a><span data-ttu-id="f36d0-179">Настройка</span><span class="sxs-lookup"><span data-stu-id="f36d0-179">Steps for setup</span></span>

<span data-ttu-id="f36d0-180">tooregister и настройка приложения Azure AD для проверки подлинности Azure AD и tooobtain маркер доступа для вызова конечной точки API REST служб мультимедиа Azure hello, полный hello, следующие шаги:</span><span class="sxs-lookup"><span data-stu-id="f36d0-180">tooregister and set up an Azure AD application for Azure AD authentication, and tooobtain an access token for calling hello Azure Media Services REST API endpoint, complete hello following steps:</span></span>

1.  <span data-ttu-id="f36d0-181">В hello [классический портал Azure](http://go.microsoft.com/fwlink/?LinkID=213885), регистрация клиента toohello Azure AD (например, wzmediaservice) приложения Azure AD (например, microsoft.onmicrosoft.com).</span><span class="sxs-lookup"><span data-stu-id="f36d0-181">In hello [Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=213885), register an Azure AD application (for example, wzmediaservice) toohello Azure AD tenant (for example, microsoft.onmicrosoft.com).</span></span> <span data-ttu-id="f36d0-182">Не важно, регистрируете вы собственное приложение или веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="f36d0-182">It doesn't matter whether you registered as web app or native app.</span></span> <span data-ttu-id="f36d0-183">Кроме того, вы можете выбрать любой URL-адрес входа и URL-адрес ответа (например, http://wzmediaservice.com для обоих параметров).</span><span class="sxs-lookup"><span data-stu-id="f36d0-183">Also, you can choose any sign-on URL and reply URL (for example, http://wzmediaservice.com for both).</span></span>
2. <span data-ttu-id="f36d0-184">В hello [классический портал Azure](http://go.microsoft.com/fwlink/?LinkID=213885), go toohello **Настройка** вкладку приложения.</span><span class="sxs-lookup"><span data-stu-id="f36d0-184">In hello [Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=213885), go toohello **Configure** tab of your application.</span></span> <span data-ttu-id="f36d0-185">Примечание hello **идентификатор клиента**.</span><span class="sxs-lookup"><span data-stu-id="f36d0-185">Note hello **client ID**.</span></span> <span data-ttu-id="f36d0-186">После этого в разделе **Ключи** создайте **ключ клиента** (секрет клиента).</span><span class="sxs-lookup"><span data-stu-id="f36d0-186">Then, under **Keys**, generate a **client key** (client secret).</span></span> 

    > [!NOTE] 
    > <span data-ttu-id="f36d0-187">Запишите hello секрет клиента.</span><span class="sxs-lookup"><span data-stu-id="f36d0-187">Take note of hello client secret.</span></span> <span data-ttu-id="f36d0-188">Он больше не будет отображаться.</span><span class="sxs-lookup"><span data-stu-id="f36d0-188">It won't be shown again.</span></span>
    
3.  <span data-ttu-id="f36d0-189">В hello [портал Azure](http://ms.portal.azure.com), go toohello учетная запись служб мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="f36d0-189">In hello [Azure portal](http://ms.portal.azure.com), go toohello Media Services account.</span></span> <span data-ttu-id="f36d0-190">Выберите hello **управления доступом** области (IAM).</span><span class="sxs-lookup"><span data-stu-id="f36d0-190">Select hello **Access Control** (IAM) pane.</span></span> <span data-ttu-id="f36d0-191">Добавьте новый элемент, имеющий hello владельца или участника роли hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-191">Add a new member that has either hello Owner or hello Contributor role.</span></span> <span data-ttu-id="f36d0-192">Для субъекта hello найдите имя приложения hello, зарегистрированное в шаге 1 (в данном примере wzmediaservice).</span><span class="sxs-lookup"><span data-stu-id="f36d0-192">For hello principal, search for hello application name you registered in step 1 (in this example, wzmediaservice).</span></span>

## <a name="info-toocollect"></a><span data-ttu-id="f36d0-193">Сведения о toocollect</span><span class="sxs-lookup"><span data-stu-id="f36d0-193">Info toocollect</span></span>

<span data-ttu-id="f36d0-194">tooprepare REST кодирования, собирать следующие tooinclude точек данных в коде hello hello:</span><span class="sxs-lookup"><span data-stu-id="f36d0-194">tooprepare REST coding, collect hello following data points tooinclude in hello code:</span></span>

*   <span data-ttu-id="f36d0-195">Конечная точка Azure AD в роли службы токенов безопасности: https://login.microsoftonline.com/microsoft.onmicrosoft.com/oauth2/token.</span><span class="sxs-lookup"><span data-stu-id="f36d0-195">Azure AD as an STS endpoint: https://login.microsoftonline.com/microsoft.onmicrosoft.com/oauth2/token.</span></span> <span data-ttu-id="f36d0-196">У этой конечной точки запрашивается маркер доступа JWT.</span><span class="sxs-lookup"><span data-stu-id="f36d0-196">From this endpoint, a JWT access token is requested.</span></span> <span data-ttu-id="f36d0-197">В дополнение к этому tooserving как поставщика Удостоверений Azure AD также служит в качестве STS.</span><span class="sxs-lookup"><span data-stu-id="f36d0-197">In addition tooserving as an IDP, Azure AD also serves as an STS.</span></span> <span data-ttu-id="f36d0-198">Azure AD выдает маркер JWT для доступа к ресурсам (маркер доступа).</span><span class="sxs-lookup"><span data-stu-id="f36d0-198">Azure AD issues a JWT for resource access (an access token).</span></span> <span data-ttu-id="f36d0-199">Маркер JWT содержит различные утверждения.</span><span class="sxs-lookup"><span data-stu-id="f36d0-199">A JWT token has various claims.</span></span>
*   <span data-ttu-id="f36d0-200">REST API служб мультимедиа Azure как ресурс или аудитория: https://rest.media.azure.net.</span><span class="sxs-lookup"><span data-stu-id="f36d0-200">Azure Media Services REST API as resource or audience: https://rest.media.azure.net.</span></span>
*   <span data-ttu-id="f36d0-201">Идентификатор клиента: см. шаг 2 в [инструкциях по настройке](#steps-for-setup).</span><span class="sxs-lookup"><span data-stu-id="f36d0-201">Client ID: See step 2 in [Steps for setup](#steps-for-setup).</span></span>
*   <span data-ttu-id="f36d0-202">Секрет клиента: см. шаг 2 в [инструкциях по настройке](#steps-for-setup).</span><span class="sxs-lookup"><span data-stu-id="f36d0-202">Client secret: See step 2 in  [Steps for setup](#steps-for-setup).</span></span>
*   <span data-ttu-id="f36d0-203">Конечной точке REST API учетной записи служб мультимедиа в кодировке hello:</span><span class="sxs-lookup"><span data-stu-id="f36d0-203">Your Media Services account REST API endpoint in hello following format:</span></span>

    <span data-ttu-id="f36d0-204">https://[учетная_запись_служб_мультимедиа].restv2.[центр_обработки_данных].media.azure.net/API</span><span class="sxs-lookup"><span data-stu-id="f36d0-204">https://[media_service_account_name].restv2.[data_center].media.azure.net/API</span></span> 

    <span data-ttu-id="f36d0-205">Это конечная точка hello, от которого все API REST служб мультимедиа в приложении вызовов.</span><span class="sxs-lookup"><span data-stu-id="f36d0-205">This is hello endpoint against which all Media Services REST API calls in your application are made.</span></span> <span data-ttu-id="f36d0-206">Например, https://willzhanmswjapan.restv2.japanwest.media.azure.net/API.</span><span class="sxs-lookup"><span data-stu-id="f36d0-206">For example, https://willzhanmswjapan.restv2.japanwest.media.azure.net/API.</span></span>

<span data-ttu-id="f36d0-207">Затем можно поместить эти пять параметров в файле web.config или app.config, toouse в коде.</span><span class="sxs-lookup"><span data-stu-id="f36d0-207">You can then put these five parameters in your web.config or app.config file, toouse in your code.</span></span>

## <a name="sample-code"></a><span data-ttu-id="f36d0-208">Пример кода</span><span class="sxs-lookup"><span data-stu-id="f36d0-208">Sample code</span></span>

<span data-ttu-id="f36d0-209">Можно найти примеры кода hello в [проверки подлинности Azure AD для доступа к Azure Media Services: оба через REST API](https://github.com/willzhan/WAMSRESTSoln).</span><span class="sxs-lookup"><span data-stu-id="f36d0-209">You can find hello sample code in [Azure AD Authentication for Azure Media Services Access: Both via REST API](https://github.com/willzhan/WAMSRESTSoln).</span></span>

<span data-ttu-id="f36d0-210">Образец кода Hello состоит из двух частей:</span><span class="sxs-lookup"><span data-stu-id="f36d0-210">hello sample code has two parts:</span></span>

*   <span data-ttu-id="f36d0-211">Проект библиотеки DLL, который содержит весь код hello REST API для проверки подлинности Azure AD и авторизации.</span><span class="sxs-lookup"><span data-stu-id="f36d0-211">A DLL library project that has all hello REST API code for Azure AD authentication and authorization.</span></span> <span data-ttu-id="f36d0-212">Он также содержит метод для выполнения вызовов toohello API REST служб мультимедиа конечной точкой API, с маркером доступа hello.</span><span class="sxs-lookup"><span data-stu-id="f36d0-212">It also has a method for making REST API calls toohello Media Services REST API endpoint, with hello access token.</span></span>
*   <span data-ttu-id="f36d0-213">Тестовый консольный клиент, который инициирует аутентификацию Azure AD и вызывает другой REST API служб мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="f36d0-213">A console test client, which initiates Azure AD authentication and calls different Media Services REST API.</span></span>

<span data-ttu-id="f36d0-214">Образец Hello проекта имеет три функции:</span><span class="sxs-lookup"><span data-stu-id="f36d0-214">hello sample project has three features:</span></span>

*   <span data-ttu-id="f36d0-215">Azure AD подлинности по учетным данным клиента hello предоставляются с помощью только hello REST API.</span><span class="sxs-lookup"><span data-stu-id="f36d0-215">Azure AD authentications via hello client credentials grant by using only hello REST API.</span></span>
*   <span data-ttu-id="f36d0-216">Доступа службы мультимедиа Azure с помощью только hello REST API.</span><span class="sxs-lookup"><span data-stu-id="f36d0-216">Azure Media Services access by using only hello REST API.</span></span>
*   <span data-ttu-id="f36d0-217">Azure доступ к хранилищу, используя только hello REST API (как используемых toocreate учетная запись служб мультимедиа с помощью REST API).</span><span class="sxs-lookup"><span data-stu-id="f36d0-217">Azure Storage access by using only hello REST API (as used toocreate a Media Services account, by using REST API).</span></span>


## <a name="where-is-hello-refresh-token"></a><span data-ttu-id="f36d0-218">Где находится hello токен обновления?</span><span class="sxs-lookup"><span data-stu-id="f36d0-218">Where is hello refresh token?</span></span>

<span data-ttu-id="f36d0-219">Некоторые средства чтения задаться вопросом: где hello токен обновления?</span><span class="sxs-lookup"><span data-stu-id="f36d0-219">Some readers might ask: Where is hello refresh token?</span></span> <span data-ttu-id="f36d0-220">Почему здесь не используется маркер обновления?</span><span class="sxs-lookup"><span data-stu-id="f36d0-220">Why not use a refresh token here?</span></span>

<span data-ttu-id="f36d0-221">Назначение Hello токен обновления не toorefresh маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="f36d0-221">hello purpose of a refresh token is not toorefresh an access token.</span></span> <span data-ttu-id="f36d0-222">Вместо этого он спроектированный toobypass конечным пользователем проверки подлинности или вмешательство пользователя и по-прежнему получить действительный маркер доступа после истечения срока действия маркера ранее.</span><span class="sxs-lookup"><span data-stu-id="f36d0-222">Instead, it is designed toobypass end-user authentication or user intervention and still get a valid access token when an earlier token expires.</span></span> <span data-ttu-id="f36d0-223">Более понятным названием маркера обновления может быть что-то вроде "маркер обхода повторного входа пользователя".</span><span class="sxs-lookup"><span data-stu-id="f36d0-223">A better name for a refresh token might be something like "bypass user re-sign-in token."</span></span>

<span data-ttu-id="f36d0-224">Если вы используете hello потока (имя пользователя и пароль, действуя от имени пользователя) предоставления авторизации OAuth 2.0, токен обновления помогает получения токена доступа продленного без вмешательства пользователя запроса.</span><span class="sxs-lookup"><span data-stu-id="f36d0-224">If you use hello OAuth 2.0 authorization grant flow (username and password, acting on behalf of a user), a refresh token helps you get a renewed access token without requesting user intervention.</span></span> <span data-ttu-id="f36d0-225">Тем не менее для hello поток, который рассматривается в этой статье предоставления учетных данных клиента OAuth 2.0, hello клиент действует от ее собственного имени.</span><span class="sxs-lookup"><span data-stu-id="f36d0-225">However, for hello OAuth 2.0 client credentials grant flow that we describe in this article, hello client acts on its own behalf.</span></span> <span data-ttu-id="f36d0-226">Вмешательство пользователя не требуется во всех, а сервер авторизации hello не требует слишком (и не будет) получить токен обновления.</span><span class="sxs-lookup"><span data-stu-id="f36d0-226">You don't need user intervention at all, and hello authorization server doesn't need too(and won't) give you a refresh token.</span></span> <span data-ttu-id="f36d0-227">При отладке hello **GetUrlEncodedJWT** метода, вы Обратите внимание, что hello ответа от конечной точки маркера hello маркер доступа, но не токен обновления.</span><span class="sxs-lookup"><span data-stu-id="f36d0-227">If you debug hello **GetUrlEncodedJWT** method, you notice that hello response from hello token endpoint has an access token, but no refresh token.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f36d0-228">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="f36d0-228">Next steps</span></span>

<span data-ttu-id="f36d0-229">Приступая к работе с [передача файлов учетная запись tooyour](media-services-dotnet-upload-files.md).</span><span class="sxs-lookup"><span data-stu-id="f36d0-229">Get started with [uploading files tooyour account](media-services-dotnet-upload-files.md).</span></span>
