---
title: "aaaAccess API служб мультимедиа Azure с проверкой подлинности Azure Active Directory | Документы Microsoft"
description: "Дополнительные сведения о концепции и шаги tootake toouse Azure Active Directory (Azure AD) tooauthenticate доступа toohello API служб мультимедиа Azure."
services: media-services
documentationcenter: 
author: Juliako
manager: cfowler
editor: 
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/17/2017
ms.author: juliako
ms.openlocfilehash: bb8f75f39100dc37098260c24ab4a199ef689d46
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="access-hello-azure-media-services-api-with-azure-ad-authentication"></a>Доступ к hello API служб мультимедиа Azure с проверкой подлинности Azure AD
 
Hello API служб мультимедиа Azure — это API RESTful. Можно использовать его tooperform операции на ресурсы мультимедиа с помощью REST API или с помощью доступных клиентских пакетов SDK. Службы мультимедиа Azure предлагают клиентский пакет SDK служб мультимедиа для Microsoft .NET. toobe авторизованных tooaccess ресурсы служб Media Services и hello API служб мультимедиа, вы должны сначала пройти проверку подлинности. 

Службы мультимедиа поддерживают [аутентификацию на основе Azure Active Directory (Azure AD)](../active-directory/active-directory-whatis.md). Hello службы Azure Media REST требует, чтобы hello пользователь или приложение, которое делает запросы к REST API hello либо hello **участника** или **владельца** tooaccess роли hello ресурсы. Дополнительные сведения см. в разделе [приступить к работе с элементом управления доступом на основе ролей в hello портал Azure](../active-directory/role-based-access-control-what-is.md).  

> [!IMPORTANT]
> В настоящее время службы мультимедиа поддерживают модель проверки подлинности службы контроля доступа Azure hello. Тем не менее авторизация посредством службы контроля доступа будет объявлена устаревшей 1 июня 2018 года. Рекомендуется как можно быстрее перейти модель проверки подлинности toohello Azure AD.

В настоящем документе приведены общие сведения о том, как tooaccess hello API служб мультимедиа с помощью API REST или .NET.

## <a name="access-control"></a>управление доступом;

Для toosucceed запрос Azure Media REST hello hello вызывающий пользователь должен иметь роль владельца или участника для учетной записи служб мультимедиа, что оно пытается tooaccess hello.  
Только пользователь с ролью владельца hello может осуществлять носителя ресурсов (учетная запись) доступ toonew пользователей или приложений. роль участника Hello доступны только hello ресурса мультимедиа.
Несанкционированные запросы завершаются сбоем с кодом состояния 401. Если вы видите этот код ошибки, проверьте, имеет ли пользователь hello участника или владельца роли, назначенной для hello Media Services учетной записи пользователя. Это можно проверить в hello портал Azure. Поиск учетной записи носителя и нажмите кнопку hello **управления доступом к** вкладки. 

![Вкладка "Управление доступом"](./media/media-services-use-aad-auth-to-access-ams-api/media-services-access-control.png)

## <a name="types-of-authentication"></a>Типы аутентификации 
 
При использовании аутентификации Azure AD со службами мультимедиа Azure доступны два метода аутентификации.

- **Аутентификация пользователя**. Проверка подлинности пользователя, работающего с toointeract приложения hello с ресурсами службы мультимедиа. интерактивные приложения Hello, сначала следует запрашивать пользователя hello hello учетные данные пользователя. Пример — приложение консоли управления, используемые заданий кодирования toomonitor авторизованных пользователей или динамической потоковой передачи. 
- **Аутентификация субъекта-службы**. Аутентификация службы. Этот метод аутентификации обычно используют приложения, которые выполняют службы управляющей программы, службы среднего уровня или запланированные задания. Примеры: веб-приложения, приложения-функции, приложения логики, интерфейсы API и микрослужбы.

### <a name="user-authentication"></a>Аутентификация пользователей 

Приложения, которые следует использовать метод проверки подлинности пользователя hello, управления и наблюдения за собственных приложений: мобильных приложений, приложений Windows и консольных приложений. Этот тип решения полезно при необходимости взаимодействия со службой hello в одном hello следующие сценарии:

- панель мониторинга для заданий кодирования;
- панель мониторинга для потоковых трансляций;
- Приложение для управления для настольных компьютеров и мобильных пользователей tooadminister ресурсов в учетной записи служб мультимедиа.

> [!NOTE]
> Этот метод аутентификации не должен использоваться для потребительских приложений. 

Собственное приложение необходимо сначала получить токен доступа из Azure AD и затем использовать его при внесении API REST служб мультимедиа toohello запросов HTTP. Добавьте заголовок запроса маркера toohello доступа hello. 

Hello, следующая диаграмма показывает поток проверки подлинности типичного интерактивные приложения: 

![Схема собственных приложений](./media/media-services-use-aad-auth-to-access-ams-api/media-services-native-aad-app1.png)

В предшествующей схеме hello hello цифры представляют Привет потоком запросов hello в хронологическом порядке.

> [!NOTE]
> При использовании метода проверки подлинности пользователя hello, все приложения, совместно использовать hello же идентификатор клиента собственного приложения (по умолчанию) и собственного приложения URI перенаправления. 

1. Запрос учетных данных пользователя.
2. Запрос маркера доступа Azure AD с hello следующие параметры:  

    * Конечная точка клиента Azure AD.

        сведения о клиенте Hello можно получить из hello портал Azure. Наведите указатель на имя пользователя, выполнившего вход hello hello в правом верхнем углу hello.
    * Универсальный код ресурса (URI) для ресурса служб мультимедиа. 

        Этот URI является hello одинаково для учетных записей служб мультимедиа, которые находятся в hello Azure одной среде (например, https://rest.media.azure.net).

    * Идентификатор клиента (собственного) приложения служб мультимедиа.
    * Универсальный код ресурса (URI) перенаправления (собственного) приложения служб мультимедиа.
    * Универсальный код ресурса (URI) для ресурса REST служб мультимедиа.
        
        Hello URI представляет конечную точку REST API hello (например, https://test03.restv2.westus.media.azure.net/api/).

    tooget значения для этих параметров в разделе [использовать параметры проверки подлинности Azure tooaccess портала Azure AD hello](media-services-portal-get-started-with-aad.md) с помощью параметра проверки подлинности пользователя hello.

3. Hello Azure AD токен доступа отправляется toohello клиента.
4. Hello клиент отправляет запрос toohello Azure Media REST API с маркером доступа hello Azure AD.
5. Hello клиент получает hello данных из служб мультимедиа.

Сведения о том, как запрашивает toocommunicate проверки подлинности toouse Azure AD с REST с помощью пакета SDK .NET служб мультимедиа клиента hello. в разделе [tooaccess проверки подлинности используют Azure AD hello API служб мультимедиа с помощью .NET](media-services-dotnet-get-started-with-aad.md). 

Если не используется пакет SDK для клиента .NET служб мультимедиа hello, необходимо вручную создать запрос маркера доступа Azure AD с помощью параметров hello описано в шаге 2. Дополнительные сведения см. в разделе [как tooget библиотеки проверки подлинности Azure AD hello toouse hello Azure AD токен](../active-directory/develop/active-directory-authentication-libraries.md).

### <a name="service-principal-authentication"></a>Проверка подлинности субъекта-службы

Этот метод аутентификации обычно используют приложения, которые выполняют службы среднего уровня и запланированные задания: веб-приложения, приложения-функции, приложения логики, интерфейсы API и микрослужбы. Этот метод проверки подлинности также подходит для интерактивных приложений, в которых может потребоваться toouse ресурсов toomanage учетной записи службы.

При использовании сценариев потребителя toobuild метод основной проверки подлинности hello служб проверки подлинности обычно обрабатываются в hello среднего уровня (через API), а не непосредственно в мобильных или настольных приложений. 

toouse этот метод создания приложения Azure AD и службы субъекта в свой собственный клиент. После создания приложения hello предоставьте hello приложения владельца или участника роли доступа toohello учетная запись служб мультимедиа. Это можно сделать в hello портал Azure с помощью Azure CLI, или с помощью сценария PowerShell. Можно также использовать существующее приложение Azure AD. Вы можете зарегистрировать и управлять приложения Azure AD и субъект-служба [в hello портал Azure](media-services-portal-get-started-with-aad.md). Это можно также сделать с помощью [Azure CLI 2.0](media-services-use-aad-auth-to-access-ams-api.md) или [PowerShell](media-services-powershell-create-and-configure-aad-app.md). 

![Приложения среднего уровня](./media/media-services-use-aad-auth-to-access-ams-api/media-services-principal-service-aad-app1.png)

После создания приложения Azure AD, вы получаете значения hello следующие параметры. Это значения, необходимые для аутентификации.

- Идентификатор клиента 
- Секрет клиента 

В предшествующих рисунок hello hello цифры представляют Привет потоком запросов hello в хронологическом порядке:
    
1. Приложение среднего уровня (веб-API или веб-приложение) запрашивает маркер доступа Azure AD с hello следующие параметры:  

    * Конечная точка клиента Azure AD.

        сведения о клиенте Hello можно получить из hello портал Azure. Наведите указатель на имя пользователя, выполнившего вход hello hello в правом верхнем углу hello.
    * Универсальный код ресурса (URI) для ресурса служб мультимедиа. 

        Этот URI является hello одинаково для учетных записей служб мультимедиа, расположенных в hello Azure одной среде (например, https://rest.media.azure.net).

    * Универсальный код ресурса (URI) для ресурса REST служб мультимедиа.

        Hello URI представляет конечную точку REST API hello (например, https://test03.restv2.westus.media.azure.net/api/).

    * Значения приложения Azure AD: hello идентификатор клиента и секрет клиента.
    
    tooget значения для этих параметров в разделе [использовать параметры проверки подлинности Azure tooaccess портала Azure AD hello](media-services-portal-get-started-with-aad.md) с помощью параметра основной проверки подлинности службы hello.

2. Hello Azure AD токен доступа отправляется toohello среднего уровня.
4. Средний уровень Hello отправляет запрос toohello Azure Media REST API с маркером hello Azure AD.
5. Hello средний уровень возвращает hello данных из служб мультимедиа.

Дополнительные сведения о том, как запрашивает toocommunicate проверки подлинности toouse Azure AD с REST с помощью пакета SDK .NET служб мультимедиа клиента hello см. в разделе [tooaccess проверки подлинности используют Azure AD API служб мультимедиа Azure в .NET Framework](media-services-dotnet-get-started-with-aad.md). 

Если не используется пакет SDK для клиента .NET служб мультимедиа hello, необходимо вручную создать запрос токена Azure AD, используя параметры, описанные в шаге 1. Дополнительные сведения см. в разделе [как tooget библиотеки проверки подлинности Azure AD hello toouse hello Azure AD токен](../active-directory/develop/active-directory-authentication-libraries.md).

## <a name="troubleshooting"></a>Устранение неполадок

Исключение: «hello удаленный сервер вернул ошибку: ошибка проверки подлинности (401).»

Решение: Для toosucceed запрос hello REST служб мультимедиа, hello вызывающего пользователя должно быть владельца или участника роли в учетной записи служб мультимедиа, что оно пытается tooaccess hello. Дополнительные сведения см. в разделе hello [управления доступом к](media-services-use-aad-auth-to-access-ams-api.md#access-control) раздела.

## <a name="resources"></a>Ресурсы

следующие статьи Hello приведены обзоры понятия проверки подлинности Azure AD. 

- [Основы проверки подлинности в Azure AD](../active-directory/develop/active-directory-authentication-scenarios.md#basics-of-authentication-in-azure-ad)
- [Интеграция приложений с Azure Active Directory](../active-directory/develop/active-directory-integrating-applications.md)
- [Управление доступом на основе ролей с помощью Azure PowerShell](../active-directory/role-based-access-control-manage-access-powershell.md)

## <a name="next-steps"></a>Дальнейшие действия

* Использовать портал Azure hello слишком[tooconsume проверки подлинности Azure AD API служб мультимедиа Azure доступ к](media-services-portal-get-started-with-aad.md).
* Использование проверки подлинности Azure AD слишком[доступ к API служб мультимедиа Azure в .NET Framework](media-services-dotnet-get-started-with-aad.md).

