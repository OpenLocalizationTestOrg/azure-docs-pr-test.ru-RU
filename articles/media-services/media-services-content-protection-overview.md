---
title: "Защита содержимого с помощью служб мультимедиа Azure | Документация Майкрософт"
description: "В этой статье представлен обзор защиты содержимого с помощью служб мультимедиа."
services: media-services
documentationcenter: 
author: Juliako
manager: cfowler
editor: 
ms.assetid: 81bc00e1-dcda-4d69-b9ab-8768b793422b
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/29/2017
ms.author: juliako
ms.openlocfilehash: 13447fd9193374d80ed5c2e6af8543f11b95e709
ms.sourcegitcommit: b5c6197f997aa6858f420302d375896360dd7ceb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="content-protection-overview"></a>Общие сведения о защите содержимого
 Службы мультимедиа Azure можно использовать для защиты от времени, когда они покидают ваш компьютер через хранения, обработки и доставки мультимедиа. С помощью служб мультимедиа можно доставлять контент по требованию и динамического шифрования динамически расширенного стандарта шифрования (AES-128) или какой-либо из систем управления Цифровыми правами три основных цифровыми правами: Microsoft PlayReady, Google Widevine и Apple FairPlay. Они также обеспечивают службу доставки ключей AES и лицензий DRM (PlayReady, Widevine и FairPlay) авторизованным клиентам. 

На следующем рисунке показан рабочий процесс защиты контента служб мультимедиа: 

![Защита с помощью PlayReady](./media/media-services-content-protection-overview/media-services-content-protection-with-multi-drm.png)

Объясняются основные понятия и терминология, помогающую понять защиты содержимого с помощью служб мультимедиа. В статье также содержатся ссылки на статьи, в которых обсуждается защита содержимого. 

## <a name="dynamic-encryption"></a>Динамическое шифрование
 Службы мультимедиа позволяют доставлять контент зашифрованных динамически незащищенный ключ AES или DRM шифрования с помощью PlayReady, Widevine или FairPlay. В настоящее время вы можете зашифровать форматов HTTP Live Streaming (HLS), MPEG DASH и Smooth Streaming. Шифрование при поэтапной загрузке не поддерживается. Каждый метод шифрования поддерживает следующие протоколы потоковой передачи:

- AES: MPEG-DASH, Smooth Streaming и HLS.
- PlayReady: MPEG-DASH, Smooth Streaming и HLS.
- Widevine: MPEG-DASH.
- FairPlay: HLS.

Чтобы выполнить шифрование ресурса, необходимо связать ключ шифрования содержимого с ресурсом, а также настроить политику авторизации для ключа. Ключи содержимого можно указать или они автоматически создаются службами мультимедиа.

Потребуется также настроить политику доставки ресурсов. Если вы хотите осуществлять потоковую активов, хранилище зашифровано, убедитесь, что можно указать, как обеспечить путем настройки политики доставки активов.

Когда проигрыватель запрашивает поток, службы мультимедиа используют указанный ключ для динамического шифрования контента с помощью незащищенный ключ AES или шифрования управления цифровыми правами. Чтобы расшифровать поток, проигрыватель запрашивает ключ служба доставки ключей Media Services. Чтобы определить, есть ли у пользователя право на получение ключа, служба оценивает политики авторизации, заданные для ключа.

## <a name="aes-128-clear-key-vs-drm"></a>Vs незащищенный ключ AES-128. DRM
Клиенты часто интересуются, следует ли им использовать шифрование AES или систему DRM. Основное различие между двумя системами — с шифрованием AES ключ содержимого передается клиенту в незашифрованном виде (в состоянии «clear»). В результате ключ, используемый для шифрования содержимого можно просмотреть в сетевой трассировки на стороне клиента в виде обычного текста. Незащищенный ключ шифрования AES-128 подходит для использования случаях, когда средство просмотра доверенной стороной (например, в шифрования корпоративной видео, распределенных в компании для просмотра сотрудниками).

PlayReady, Widevine и FairPlay обеспечивают более высокий уровень шифрования по сравнению с незащищенным ключом AES-128. Ключ содержимого передается в зашифрованном виде. Кроме того в безопасной среде на уровне операционной системы, где более сложным для атаки злоумышленник обрабатывается расшифровки. Для использования случаев, когда средство просмотра может быть доверенной стороной и требуют самый высокий уровень безопасности рекомендуется DRM.

## <a name="storage-encryption"></a>Шифрование хранилища
Шифрование хранилища позволяет зашифровать содержимое локально с помощью AES 256-битного шифрования. Затем можно передать его в хранилище Azure, где она хранится в зашифрованном виде. Активы, защищенные с помощью шифрования хранилища, автоматически дешифруются и помещаются в зашифрованную систему файлов до кодирования. Ресурсы — при необходимости повторно зашифрован перед обратной отправкой в виде нового выходного актива. Основная причина использования шифрования хранилища — для защиты входных файлов мультимедиа высокого качества с помощью стойкого шифрования при хранении на диске.

Чтобы доставить актив, зашифрованный хранилища, необходимо настроить политику доставки актива, чтобы службы мультимедиа получили информацию о способе доставки контента. Перед потоковой актива сервер потоковой передачи расшифровывает и выполняет потоковую передачу содержимого с помощью заданной политики доставки (например, AES, общее шифрование или шифрование).

## <a name="types-of-encryption"></a>Типы шифрования
PlayReady и Widevine используют общее шифрование (AES CTR mode). FairPlay использует шифрование в режиме CBC AES. Незащищенный ключ шифрования AES-128 использует шифрование конвертов.

## <a name="licenses-and-keys-delivery-service"></a>Служба доставки лицензий и ключей
Службы мультимедиа предоставляют службу доставки ключей для доставки лицензий DRM (PlayReady, Widevine и FairPlay) и ключей AES авторизованным клиентам. Можно использовать [портала Azure](media-services-portal-protect-content.md), API-интерфейса REST или пакета SDK служб мультимедиа для .NET для настройки политик авторизации и проверки подлинности для лицензий и ключей.

## <a name="control-content-access"></a>Доступ к содержимому элемента управления
Вы можете контролировать пользователей, имеющих доступ к содержимому, настроив политику авторизации ключа содержимого. Политика авторизации ключа содержимого поддерживает открытую авторизацию или авторизацию с использованием маркера.

### <a name="open-authorization"></a>Открытая авторизация
При использовании политики открытой авторизации ключ содержимого отправляется любому клиенту (без ограничений).

### <a name="token-authorization"></a>Авторизация с помощью маркера
Политики ограниченного токена авторизации ключа контента отправляется только клиент, который представляет допустимый JSON Web Token (JWT) или простой веб-токен (SWT) в запрос ключ лицензии. Этот токен должен быть выдан службой маркеров безопасности (STS). Можно использовать Azure Active Directory в качестве STS или развертывание пользовательских маркеров безопасности. Чтобы создать маркер, подписанный указанным ключом, и получить утверждения, указанные в конфигурации ограничения по маркерам, должна быть настроена служба маркеров безопасности. Служба доставки ключей Media Services возвращает запрошенную лицензию или ключ клиента в том случае, если маркер является допустимым и утверждения в токене соответствуют настроенным для ключа или лицензии.

При настройке политики с ограничением токенов необходимо указать основной ключ проверки, издателя и аудитории параметров. Основной ключ проверки содержит ключ, который был подписан токен. Поставщик является службой маркеров безопасности, которая выдает маркер. Аудитория, иногда называемая областью, описывает назначение маркера или ресурс, доступ к которому обеспечивает маркер. Служба доставки ключей служб мультимедиа проверяет, соответствуют ли эти значения в маркере значениям в шаблоне.

## <a name="streaming-urls"></a>URL-адреса потоковой передачи
Если актива был зашифрован с более чем одной DRM, используется тег шифрования в URL-адрес потоковой передачи: (format = «m3u8-aapl» шифрования = 'xxx').

Действительны следующие условия.

* Вы можете указать не более одного типа шифрования.
* Тип шифрования не должен быть указан в URL-адрес, если только один шифрования был применен к активу.
* Тип шифрования вводится без учета регистра.
* Можно указать следующие типы шифрования:
  * **cenc**: для PlayReady или Widevine (общее шифрование)
  * **cbcs aapl**: для FairPlay (шифрование AES CBC)
  * **CBC**: шифрование AES для конверта

## <a name="next-steps"></a>Дальнейшие действия
В следующих статьях описывается далее шагов, которые помогут вам приступить к работе с защитой содержимого:

* [Шифрование содержимого с помощью шифрования хранилища](media-services-rest-storage-encryption.md)
* [Использование динамического шифрования AES-128 и службы доставки ключей](media-services-protect-with-aes128.md)
* [Использование общего динамического шифрования PlayReady и (или) Widevine DRM](media-services-protect-with-playready-widevine.md)
* [Защита с помощью FairPlay](media-services-protect-hls-with-FairPlay.md)

## <a name="related-links"></a>Связанные ссылки

* [Разъяснение ценовой политики для доставки лицензий PlayReady служб мультимедиа Azure](http://mingfeiy.com/playready-pricing-explained-in-azure-media-services)
* [Отладка для AES зашифрованный поток в службах мультимедиа Azure](http://mingfeiy.com/debug-aes-encrypted-stream-azure-media-services)
* [JWT token Authentication in Azure Media Services and Dynamic Encryption](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/) (Аутентификация токена JWT в службах мультимедиа Azure и динамическое шифрование)
* [Интеграция приложений на основе MVC OWIN служб мультимедиа Azure с Azure Active Directory и ограничения доставки ключа содержимого, на основе утверждений JWT](http://www.gtrifonov.com/2015/01/24/mvc-owin-azure-media-services-ad-integration/)

[content-protection]: ./media/media-services-content-protection-overview/media-services-content-protection.png
