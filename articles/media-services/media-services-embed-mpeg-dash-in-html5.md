---
title: "Встраивание адаптивного потокового видео MPEG-DASH в приложение HTML5 с помощью DASH.js | Документация Майкрософт"
description: "В этом разделе демонстрируется встраивание адаптивного потокового видео MPEG-DASH в приложение HTML5 с помощью DASH.js."
author: Juliako
manager: cfowler
editor: 
services: media-services
documentationcenter: 
ms.assetid: 5aa0e7b6-f5c3-4cc1-aa33-ed16ea4780c2
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2016
ms.author: juliako
ms.openlocfilehash: be0fc51574950cad0558a85b3f20f8b14eafda13
ms.sourcegitcommit: 9a8b9a24d67ba7b779fa34e67d7f2b45c941785e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2018
---
# <a name="embedding-an-mpeg-dash-adaptive-streaming-video-in-an-html5-application-with-dashjs"></a>Встраивание адаптивного потокового видео MPEG-DASH в приложение HTML5 с помощью DASH.js
## <a name="overview"></a>Обзор
MPEG-DASH — это стандарт ISO для адаптивной потоковой передачи видеосодержимого, который обеспечивает значительные преимущества для тех, кому требуется высококачественный адаптивный потоковый вывод видео. С MPEG-DASH поток видео будет автоматически сжиматься до более низкой четкости, если сеть перегружена. Это снижает вероятность того, что зритель увидит видео "на паузе", в то время как проигрыватель будет загружать следующие несколько секунд для воспроизведения (т. н. буферизация). Когда нагрузка на сеть снизится, видеопроигрыватель вернется к потоку более высокого качества. Такая возможность адаптировать требуемую пропускную способность также способствует ускорению запуска видео. Это означает, что первые несколько секунд можно воспроизвести в виде быстро загружаемого сегмента низкого качества, а затем перейти к более высокому качеству, как только достаточный объем содержимого будет загружен в буфер.

Dash.js — это проигрыватель видео MPEG-DASH с открытым кодом, написанный на языке JavaScript. Цель этого проект — предоставить надежный, межплатформенный проигрыватель, который можно свободно встраивать в приложения, требующие воспроизведения видео. Он обеспечивает воспроизведение MPEG-DASH в любом браузере, поддерживающем расширения источников мультимедиа W3C (Media Source Extensions, MSE). На сегодняшний день это Chrome, Microsoft Edge и IE11 (разработчики других браузеров заявили о намерении добавить поддержку MSE). Дополнительные сведения о DASH.js см. в репозитории dash.js на GitHub.

## <a name="creating-a-browser-based-streaming-video-player"></a>Создание браузерного потокового видеопроигрывателя
Чтобы создать простую веб-страницу, на которой будет отображаться видеопроигрыватель с привычными элементами управления для воспроизведения, паузы, перемотки и т. д., выполните следующие действия:

1. Создайте страницу HTML.
2. Добавьте тег video.
3. Добавьте проигрыватель dash.js.
4. Инициализируйте проигрыватель.
5. Добавьте нужный стиль CSS.
6. Просмотрите результаты в браузере, который поддерживает расширения MSE.

Инициализацию проигрывателя можно выполнить всего лишь несколькими строками кода JavaScript. С помощью dash.js встраивать видео MPEG-DASH в браузерные приложения действительно просто.

## <a name="creating-the-html-page"></a>Создание страницы HTML
Первым шагом является создание стандартной страницы HTML, содержащей элемент **video**, и сохранение ее в виде файла с именем basicPlayer.html, как показано в примере ниже.

    <!DOCTYPE html>
    <html>
      <head><title>Adaptive Streaming in HTML5</title></head>
      <body>
        <h1>Adaptive Streaming with HTML5</h1>
        <video id="videoplayer" controls></video>
      </body>
    </html>

## <a name="adding-the-dashjs-player"></a>Добавление проигрывателя DASH.js
Чтобы добавить в приложение эталонную реализацию dash.js, необходимо получить файл dash.all.js из выпуска 1.0 проекта dash.js. Его необходимо сохранить в папку JavaScript вашего приложения. Этот файл создан для удобства и извлекает весь необходимый код dash.js в один файл. В репозитории dash.js содержатся отдельные файлы, тестовый код и многое другое, но если необходимо только использовать dash.js, то файл dash.all.js — то, что вам потребуется.

Чтобы добавить проигрыватель dash.js в приложения, добавьте тег script в раздел head файла basicPlayer.html:

    <!-- DASH-AVC/265 reference implementation -->
    < script src="js/dash.all.js"></script>


Затем создайте функцию для инициализации проигрывателя при загрузке страницы. После строки, в которой загружается dash.all.js, добавьте следующий скрипт:

    <script>
    // setup the video element and attach it to the Dash player
    function setupVideo() {
      var url = "http://wams.edgesuite.net/media/MPTExpressionData02/BigBuckBunny_1080p24_IYUV_2ch.ism/manifest(format=mpd-time-csf)";
      var context = new Dash.di.DashContext();
      var player = new MediaPlayer(context);
                      player.startup();
                      player.attachView(document.querySelector("#videoplayer"));
                      player.attachSource(url);
    }
    </script>

Эта функция сначала создает DashContext. Он используется для настройки приложения для конкретной среды выполнения. С технической точки зрения он определяет классы, которые следует использовать платформой внедрения зависимостей при построении приложения. В большинстве случаев используется Dash.di.DashContext.

Далее создайте экземпляр основного класса платформы dash.js, MediaPlayer. Этот класс содержит основные необходимые методы, такие как воспроизведение и пауза, управляет связью с элементом video, а также управляет интерпретацией для файла описания представления носителя (MPD), в котором описано воспроизводимое видео.

Функция startup() класса MediaPlayer вызывается для обеспечения готовности проигрывателя к воспроизведению видео. Кроме всего прочего эта функция гарантирует, чтобы все необходимые классы (как определено контекстом) были загружены. Когда проигрыватель готов, можно подключить к нему элемент video с помощью функции attachView(). Это позволяет MediaPlayer внедрить видеопоток в элемент, а также управлять воспроизведением при необходимости.

Передайте URL-адрес файла MPD в MediaPlayer, чтобы предоставить ему данные о видео, которое должно быть воспроизведено. Созданная функция setupVideo() должна выполняться после полной загрузки страницы. Сделайте это с помощью события onload в элементе body. Измените элемент <body> на:

    <body onload="setupVideo()">

Наконец, задайте размер элемента video с помощью CSS. В среде адаптивной потоковой передачи это особенно важно, так как размер воспроизводимого видео может меняться по мере адаптации воспроизведения к изменению сетевых условий. В этой простой демонстрации можно принудительно задать для элемента video размер 80 % от доступного окна браузера, добавив следующий код CSS в секцию head страницы:

    <style>
    video {
      width: 80%;
      height: 80%;
    }
    </style>

## <a name="playing-a-video"></a>Воспроизведение видео
Чтобы воспроизвести видео, откройте в браузере файл basicPlayback.html и нажмите кнопку воспроизведения в видеопроигрывателе, который отобразится.

## <a name="media-services-learning-paths"></a>Схемы обучения работе со службами мультимедиа
[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a>Отзывы
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

## <a name="see-also"></a>См. также
[Разработка приложений видеопроигрывателя](media-services-develop-video-players.md)

[Репозиторий dash.js на GitHub](https://github.com/Dash-Industry-Forum/dash.js) 

