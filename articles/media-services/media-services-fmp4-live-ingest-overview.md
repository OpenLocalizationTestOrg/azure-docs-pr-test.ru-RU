---
title: "Спецификация приема aaaAzure Media Services live фрагментированный MP4 | Документы Microsoft"
description: "Эта спецификация описывает протокол hello и формат для фрагментированного MP4-based динамической потоковой передачи приема для служб мультимедиа Azure. Можно использовать событий прямой трансляции toostream служб мультимедиа Azure и вещания содержимого в реальном времени, используя в качестве hello облачной платформы Azure. В этом документе также обсуждаются практические рекомендации по созданию механизмов приема прямой трансляции с высокой избыточностью и надежностью."
services: media-services
documentationcenter: 
author: cenkdin
manager: cfowler
editor: 
ms.assetid: 43fac263-a5ea-44af-8dd5-cc88e423b4de
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/29/2017
ms.author: cenkd;juliako
ms.openlocfilehash: 0c191f8d6c5a595621feaba0e571fb984b666f34
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-media-services-fragmented-mp4-live-ingest-specification"></a>Спецификация приема фрагментированного MP4 в реальном времени в службах мультимедиа Azure
Эта спецификация описывает протокол hello и формат для фрагментированного MP4-based динамической потоковой передачи приема для служб мультимедиа Azure. Службы мультимедиа предоставляют службу потоковой трансляции клиентам использовать toostream событий в реальном времени и вещания содержимого в реальном времени, используя в качестве hello облачной платформы Azure. В этом документе также обсуждаются практические рекомендации по созданию механизмов приема прямой трансляции с высокой избыточностью и надежностью.

## <a name="1-conformance-notation"></a>1. Замечание о соответствии
Hello ключевые слова «должен»» не,» «Обязательно» «SHALL», «должны не должны,» «SHOULD», «Следует не,» «Рекомендуется», «Может» и «ДОПОЛНИТЕЛЬНО» в этом документе, интерпретируется как они описаны в документе RFC 2119 toobe.

## <a name="2-service-diagram"></a>2. Схема службы
Hello следующей схеме показано hello высокоуровневая архитектура hello динамической потоковой передачи службы в службах мультимедиа.

1. Динамический кодировщик отправляет toochannels динамической веб-каналы, создаваемые и подготовить через hello Azure Media Services SDK.
2. Каналы, программы и конечных точек потоковой передачи в дескриптор Media Services live hello все потоковые функции, включая получение, форматирование, облака DVR, безопасность, масштабируемость и избыточность.
3. Кроме того клиенты могут выбрать toodeploy сети доставки содержимого Azure слой между hello потоковой передачи конечной точки и hello клиентских конечных точек.
4. Поток конечных точек клиента из конечной точки потоковой передачи с помощью протоколов адаптивной потоковой передачи HTTP hello. например Microsoft Smooth Streaming, динамическая адаптивная потоковая передача по HTTP (DASH или MPEG-DASH), а также Apple HTTP Live Streaming (HLS).

![поток приема данных][image1]

## <a name="3-bitstream-format--iso-14496-12-fragmented-mp4"></a>3. Формат битового потока — ISO 14496-12, фрагментированный MP4
Hello формат передачи для приема потоковой трансляции обсуждается в этом документе основан на [ISO-14496-12]. Подробные сведения о фрагментированном формате MP4 и расширениях как для файлов видео по запросу, так и для приема потоковой трансляции см. в статье о [[MS-SSTR]](http://msdn.microsoft.com/library/ff469518.aspx).

### <a name="live-ingest-format-definitions"></a>Определения динамических форматов приема
Hello ниже описаны специальные формат определения, которые применяются toolive приема в службы мультимедиа Azure.

1. Hello **ftyp**, **Live поле сервера манифеста**, и **moov** поля, которые должны отправляться с каждым запросом (HTTP POST). Эти поля должны быть отправлены в начале hello потока hello и приема в любое время, кодировщик hello необходимо повторно подключить tooresume потока. Дополнительные сведения см. в разделе 6 в статье [1].
2. Раздел 3.3.2 в статье [1] определяет необязательное поле с именем **StreamManifestBox** для приема динамической передачи. Из-за логики маршрутизации toohello hello балансировки нагрузки Azure с помощью этого поля является устаревшим. поле Hello должны отсутствовать при передаче в службы мультимедиа. При наличии этого поля службы мультимедиа автоматически его игнорируют.
3. Hello **TrackFragmentExtendedHeaderBox** поля, определенные в 3.2.3.2 в [1] должен присутствовать для каждого фрагмента.
4. Версия 2 hello **TrackFragmentExtendedHeaderBox** поле должно быть используется toogenerate сегментами, имеющих одинаковые URL-адресов в нескольких центрах обработки данных. поле индекса фрагмент Hello — REQUIRED для отработки отказа между центрами обработки данных на основе индекса потоковой передачи форматы, например Apple HLS и MPEG-DASH, на основе индекса. между центрами tooenable перехода на другой ресурс, hello фрагменте индекса должны быть синхронизированы между несколькими кодировщиков и увеличивается на 1 для каждого фрагмента последовательных носителя даже через кодировщик перезапуски или сбои.
5. 3.3.6 в [1] определяет поле, называемое **MovieFragmentRandomAccessBox** (**mfra**), могут быть отправлены в конце hello toohello (электрической ПЕРЕГРУЗКИ) канала для приема динамической tooindicate конец потока. Из-за toohello приема логики служб мультимедиа с помощью электрической ПЕРЕГРУЗКИ является устаревшим и hello **mfra** поле для динамической приема не следует отправлять. В случае отправки этого поля службы мультимедиа автоматически его игнорируют. состояние hello tooreset hello приема точкой, мы рекомендуем использовать [сброса канала](https://docs.microsoft.com/rest/api/media/operations/channel#reset_channels). Также рекомендуется использовать [остановить программу](https://msdn.microsoft.com/library/azure/dn783463.aspx#stop_programs) tooend презентации и потоком.
6. Длительность фрагмента Hello MP4 должна быть константой, размер hello tooreduce hello клиентские манифесты. Константа длительность фрагмент MP4 также улучшает эвристики загрузки клиента с использованием hello повторов тегов. Длительность Hello может изменяться toocompensate для частоты кадров, отличный от integer.
7. Длительность фрагмента Hello MP4 должна составлять от приблизительно 2 и 6 секунд.
8. НЕОБХОДИМО обеспечить поступление меток времени и индексов фрагментов MP4 (`fragment_ absolute_ time` и `fragment_index` в **TrackFragmentExtendedHeaderBox**) в порядке возрастания. Несмотря на то, что службы мультимедиа являются устойчивыми tooduplicate фрагментов, имеют ограниченную возможность tooreorder фрагментов в соответствии с временной шкалы мультимедиа toohello.

## <a name="4-protocol-format--http"></a>4. Формат протокола — HTTP
ISO фрагментированной основе MP4 динамическую приема для служб мультимедиа использует стандартные долго выполняющихся HTTP POST запроса tootransmit кодировке носителя данных, содержащийся в службе toohello формате фрагментированного MP4. Каждый HTTP POST отправляет полный фрагментированной bitstream MP4 («stream»), начиная с начала hello с полями заголовок (**ftyp**, **Live поле сервера манифеста**, и **moov** поля) и продолжите последовательность фрагментов (**moof** и **mdat** поля). Синтаксис URL-адрес для hello HTTP-запроса POST см. раздел 9.2 в [1]. Пример hello POST URL-адрес выглядит: 

    http://customer.channel.mediaservices.windows.net/ingest.isml/streams(720p)

### <a name="requirements"></a>Требования
Ниже приведены подробные требования hello:

1. Hello кодировщик должен начинаться hello широковещательную рассылку путем отправки запроса HTTP POST с пустым Здравствуйте, «текст» (нулевой длиной содержимого) с помощью URL-адреса приема. Это может помочь быстро определить конечную точку приема динамической hello является допустимым, и если проверку подлинности или другие условия, необходимые кодировщику hello. По протоколу HTTP hello сервер не отправляет обратно HTTP-ответа, пока не hello целиком, включая тело POST hello, поступает запрос. Условии характера долго выполняющихся hello трансляция без этого шага hello кодировщик может быть toodetect может любая ошибка завершения отправки всех данных hello.
2. Hello кодировщик должен обрабатывать все ошибки и проблемы проверки подлинности из-за (1). Если (1) завершится успешно с ответом 200, продолжайте.
3. кодировщик Hello необходимо запустить новый запрос HTTP POST с потоком MP4 фрагментирован приветствия. полезные данные Hello должно начинаться с поля заголовка hello, следуют фрагментов. Обратите внимание, что hello **ftyp**, **Live поле сервера манифеста**, и **moov** поля (в указанном порядке) должны отправляться с каждым запросом, даже если необходимо повторно подключить hello кодировщика, так как hello Предыдущий запрос был завершен предыдущий toohello конец потока hello. 
4. Hello кодировщик должен использоваться поблочное кодирование для отправки, так как это невозможно toopredict hello всю длину содержимого hello динамические события.
5. При событии hello над, после отправки последнего фрагмента hello, кодировщик hello корректно должно заканчиваться передачи hello Поблочное кодирование сообщений последовательности (большинство стеки HTTP клиента он автоматически обрабатывать). Hello кодировщик должен ожидать кода hello службы tooreturn hello окончательный ответ и затем разрыва подключения hello. 
6. кодировщик Hello не должны использовать hello `Events()` существительное, как описано в 9.2 в [1] для динамической приема в службы мультимедиа.
7. Если завершается запрос HTTP POST hello, или время ожидания с TCP ошибки предыдущего toohello конец потока hello hello кодировщик должен выдать новый запрос POST с помощью нового подключения и выполните hello требования. Кроме того кодировщик hello необходимо повторно отправить hello предыдущих двух фрагментов MP4 для каждой записи в поток hello и возобновить без возникновения разрыв в временной шкалы мультимедиа hello. Повторная отправка hello последних двух фрагментов MP4 для каждой записи гарантирует, что потери данных. Другими словами Если поток содержит аудио и видео дорожка hello текущий запрос POST завершается ошибкой, hello кодировщика должны повторно подключиться и повторить отправку hello двух последних фрагменты для hello звуковой дорожки, которые были ранее успешно отправлены, и двух последних hello фрагменты для Hello видеодорожки, которая ранее успешно отправленные, tooensure, не происходит потери данных. Hello кодировщик должен поддерживать «вперед» буфера фрагментов носителя, которые отправкой после повторного подключения.

## <a name="5-timescale"></a>5. Шкала времени
[[MS-SSTR] ](https://msdn.microsoft.com/library/ff469518.aspx) описывается использование hello шкалы времени для **SmoothStreamingMedia** (раздел 2.2.2.1), **StreamElement** (раздел 2.2.2.3), **StreamFragmentElement**(Раздел 2.2.2.6) и **LiveSMIL** (раздел 2.2.7.3.1). Если значение шкалы времени hello отсутствует, используется значение по умолчанию hello — 10 000 000 (10 МГц). Несмотря на то, что hello Smooth Streaming спецификации формата не блокирует использование других значений шкалы времени, большинство реализаций кодировщика использовать это значение по умолчанию (10 МГц) значение toogenerate Smooth Streaming приема данных. Из-за toohello [динамическое упаковывание мультимедиа Azure](media-services-dynamic-packaging-overview.md) компонентов, рекомендуется использовать шкалы 90 кГц видеопотоков и 44,1 кГц или 48.1 кГц для звуковых потоков. Если разные шкалы времени значения используются для различных потоков, должны отправляться шкалы времени hello уровне потока. Дополнительные сведения см. в статье о [[MS-SSTR]](https://msdn.microsoft.com/library/ff469518.aspx).     

## <a name="6-definition-of-stream"></a>6. Определение потока
Поток имеет hello основной единицей операции в динамической приема для составления презентации, обработка потоковой передачи отработки отказа и сценарии избыточности. Поток определяется как один уникальный фрагментированный битовый поток MP4, который может содержать одну или несколько дорожек. Полная презентации может содержать один или несколько потоков, в соответствии с настройками hello динамических кодировщиков hello. Hello следующие примеры демонстрируют различные параметры использования потоков toocompose полной презентации.

**Пример** 

Клиенту требуется toocreate потоковой передачи презентации в реальном времени, включающий следующие битрейтах аудио/видео hello:

видео — 3000 Кбит/с, 1500 Кбит/с, 750 Кбит/с;

аудио — 128 Кбит/с.

### <a name="option-1-all-tracks-in-one-stream"></a>Вариант 1. Все дорожки в одном потоке
В этом случае один кодировщик формирует все аудио- и видеодорожки и объединяет их в один фрагментированный битовый поток MP4, Hello фрагментированным MP4 bitstream отправляется через одно подключение HTTP POST. В этом примере имеется только один поток для текущей презентации.

![Потоки (одна дорожка)][image2]

### <a name="option-2-each-track-in-a-separate-stream"></a>Вариант 2. Каждая дорожка в отдельном потоке
В этом параметре кодировщика hello помещает одну запись в каждой bitstream фрагмент MP4 и затем отправляет все потоки hello через отдельные подключения по протоколу HTTP. Это можно сделать с помощью одного или нескольких кодировщиков. Динамическая приема Hello видит презентации в реальном времени, состоит из четырех потоков.

![Потоки (отдельные дорожки)][image3]

### <a name="option-3-bundle-audio-track-with-hello-lowest-bitrate-video-track-into-one-stream"></a>Вариант 3: Звуковая дорожка с hello низкий битрейт видеодорожки объединить в один поток
В этом параметре клиента hello выбирает toobundle hello Аудиодорожка с наименьшим скоростями видеодорожки hello в один фрагмент MP4 bitstream и оставьте hello другие два видеодорожек как отдельные потоки. 

![Потоки (аудио- и видеодорожки)][image4]

### <a name="summary"></a>Сводка
Это не исчерпывающий список всех возможных вариантов приема в данном примере. Фактически приемом прямой передачи поддерживается любое группирование дорожек в потоки. Заказчики и поставщики кодировщиков могут выбирать собственные реализации в зависимости от инженерной сложности, емкости кодировщика и соображений избыточности и отработки отказов. Однако в большинстве случаев есть только один звуковой дорожки hello всей презентации в реальном времени. Таким образом он является важным tooensure hello healthiness из hello приема поток, содержащий hello звуковой дорожки. Часто этого вопроса приводит размещение звуковой дорожки hello в собственный поток (как вариант 2) или объединении его с наименьшим скоростями видеодорожки hello (как вариант 3). Кроме того, для повышения избыточности и отказоустойчивости, отправка hello же звуковой дорожки в двух разных потоков (вариант 2 с избыточностью звуковой файл) или объединение hello звуковой дорожки с по крайней мере двух hello низкий битрейт видеодорожек (вариант 3 с объединенными в в аудио как минимум два видеопотоков) динамическую настоятельно рекомендуется для приема в службы мультимедиа.

## <a name="7-service-failover"></a>7. Отработка отказа службы
Данный hello характер потоковой трансляции поддержки хорошо отработки отказа важно для обеспечения доступности hello hello службы. Службы мультимедиа является спроектированный toohandle различных типов сбоев, включая сетевые ошибки, ошибки сервера и неполадок хранилища. При использовании в сочетании с логикой правильный переход на другой ресурс со стороны динамического кодировщика hello клиентов можно добиться высоконадежными службу потоковой трансляции из облака hello.

В этом разделе мы обсудим сценарии отработки отказа службы. В этом случае происходит сбой hello где-либо в службе hello и проявляется как сетевая ошибка. Ниже приведены некоторые рекомендации по реализации hello кодировщика для обработки отработки отказа служб.

1. Используйте более 10 секунд времени ожидания для установления hello TCP-подключения. Если подключение hello tooestablish попытки занимает больше 10 секунд, прервать операцию hello и повторите попытку. 
2. Используйте короткое время ожидания для отправки фрагментов сообщений hello HTTP запроса. Если длительность фрагмент MP4 целевую hello N секунд, используйте время ожидания отправки от N до 2 секунд N; Например если длительность фрагмент MP4 hello составляет 6 секунд, используйте время ожидания 6 too12 секунд. Если время ожидания, сброс подключения hello, открыть новое соединение и возобновить поток приема для hello нового подключения. 
3. Ведение последовательного буфера, содержащего hello последних двух фрагментов для каждой записи, посланных успешно и полностью toohello службы.  Если запрос HTTP POST hello потока завершается или время ожидания предыдущих toohello конец потока hello, открыть новое подключение и начать другой запрос HTTP POST, повторно отправить поток заголовки hello, повторно отправить hello последних двух фрагментов для каждой записи и возобновить hello потока без Представляем разрыв в временной шкалы мультимедиа hello. Это снижает вероятность потери данных hello.
4. Мы рекомендуем этот кодировщик hello не максимальное число повторных попыток tooestablish соединение hello или возобновить потоковой передачи после возникновения ошибки TCP.
5. После возникновения ошибки TCP:
  
    а. НЕОБХОДИМО закрыть текущее соединение Hello и необходимо создать новое соединение для нового запроса HTTP POST.

    b. новый HTTP POST URL-адрес должен быть Hello hello так же, как hello POST URL-адрес.
  
    c. Hello новый HTTP POST необходимо включить заголовки потока (**ftyp**, **Live поле сервера манифеста**, и **moov** поля), являются идентичными toohello заголовков потока в hello первоначального POST.
  
    d. Повторите последние два фрагментов Hello, отправляемых для каждого направления и потоковой передачи необходимо возобновить работу без внесения разрыв в временной шкалы мультимедиа hello. Hello отметки времени фрагмент MP4 необходимо увеличить постоянно, даже через HTTP-запросы POST.
6. Если данные не были отправлены с частотой потребностям длительность фрагмент MP4 hello Hello кодировщик должен завершить работу hello HTTP-запроса POST.  Запрос HTTP POST, которые не отправляют данные можно предотвратить быстро отключение от кодировщика hello в событии hello обновление службы Media Services. По этой причине hello HTTP POST для разреженных отслеживает (рекламный сигнал) должно быть небольшим, прерывание, как можно скорее фрагмент разреженных hello отправляется.

## <a name="8-encoder-failover"></a>8. Отработка отказа кодировщика
Кодировщик отработка отказа — второй тип сценария отработки отказа, который должен обращаться toobe для динамической потоковой передачи доставки конца в конец hello. В этом сценарии hello ошибка возникает на стороне кодировщика hello. 

![Отработка отказа кодировщика][image5]

После ожидания Hello применяются из конечной точки динамической приема hello при отработке кодировщика.

1. Новый экземпляр кодировщика должны создаваться toocontinue потоковой передачи, как показано на схеме hello (поток для видео с пунктирным k 3000).
2. НЕОБХОДИМО использовать hello же запросов URL-адрес для HTTP POST в качестве hello нового кодировщика Hello сбой экземпляра.
3. Hello нового кодировщика POST запрос должен включать hello же фрагментированной MP4 заголовок поля как сбойный экземпляр hello.
4. Hello нового кодировщика необходимо правильно синхронизированы с всех других запущенных кодировщиков, для hello же toogenerate презентации в реальном времени синхронизации образцы аудио/видео с границами выровненных фрагмент.
5. Hello новый поток должен быть семантически эквивалентны с hello предыдущего потока и являются взаимозаменяемыми на уровнях hello заголовок и фрагмент.
6. Hello нового кодировщика следует пробовать toominimize потери данных. Hello `fragment_absolute_time` и `fragment_index` носителей следует увеличить фрагментов из hello точки, где кодировщика hello последнего останова. Hello `fragment_absolute_time` и `fragment_index` следует увеличить непрерывного способом, но не допустимые toointroduce разрыв, при необходимости. Службы мультимедиа игнорирует фрагменты, которые уже получено и обработано, поэтому лучше tooerr со стороны hello повторной отправки фрагментов, чем toointroduce нарушение непрерывности временной шкалы мультимедиа hello. 

## <a name="9-encoder-redundancy"></a>9. Избыточность кодировщиков
Для определенных критических событий, что запросу даже более высокой доступности и качества передачи, мы рекомендуется использовать избыточные кодировщики активных tooachieve эффективное переключение без потери данных.

![Избыточность кодировщиков][image6]

Как показано на этой диаграмме, две группы кодировщиков Принудительная отправка две копии каждого потока одновременно в интерактивную службу hello. Такая конфигурация поддерживается благодаря возможности служб мультимедиа фильтровать повторяющиеся фрагменты на основе идентификатора потока и метки времени фрагмента. Здравствуйте, полученный обновляющегося потока и архив находится по одной копии все потоки hello, hello лучшие возможности статистической обработки из двух источников hello. Например в гипотетической очень редких случаях при условии, что имеется один кодировщик (это не обязательно toobe hello один) под управлением в любой момент времени для каждого потока hello возникающие обновляющегося потока из службы hello является непрерывным без потери данных. 

Hello требования для данного сценария, почти hello же, как требования hello в случае «Кодировщик отработки отказа» hello, за исключением hello, второй набор hello кодировщиков, активных в hello же время как hello основной кодировщиков.

## <a name="10-service-redundancy"></a>10. Избыточность служб
Иногда высокой избыточностью глобального распространения, необходимо иметь аварий регионального toohandle резервного копирования различных регионах. Расширив топологии «Избыточность кодировщика» hello, клиенты могут выбрать toohave избыточное развертывание служб в другом регионе, связанный с hello второй набор кодировщиков. Клиенты также могут работать с toodeploy поставщика сети доставки содержимого глобального диспетчера трафика перед hello две службы развертывания tooseamlessly маршрутизации трафика клиента. Hello требования для hello кодировщиков, hello так же, как hello вариант «Кодировщик избыточность». Hello только исключение — второй набор toobe потребностей кодировщики hello указывает tooa различных динамическую конечную приема. Hello следующей схеме показано этой программы установки.

![избыточность служб][image7]

## <a name="11-special-types-of-ingestion-formats"></a>11. Специальные типы форматов приема
В этом разделе рассматриваются специальные типы динамической приема форматах спроектированный toohandle конкретных сценариев.

### <a name="sparse-track"></a>Разреженная дорожка
При доставке потоковой передачи презентации в реальном времени с широкие возможности клиента, часто ее tootransmit необходимо синхронизировать время события или сообщает по каналу с главной медиаданных hello. Примером этого является динамическая вставка рекламы в текущий поток. Этот тип сигнализации о событиях отличается от обычной потоковой передачи аудио/видео из-за своего разреженного характера. Другими словами сигналов данных обычно не происходит непрерывно и интервал приветствия может быть жестких toopredict hello. Понятие Hello разреженную дорожку было спроектированный tooingest и сигнал данных broadcast по каналу.

Hello следующие действия приведены рекомендуемые реализацию для обработки разреженную дорожку.

1. Создайте отдельный фрагментированный битовый поток MP4, содержащий только разреженные дорожки без звуковых дорожек и видеодорожек.
2. В hello **Live поле сервера манифеста** согласно разделу 6 в [1], использование hello *parentTrackName* имя hello toospecify параметра дорожки родительского hello. Дополнительные сведения см. в разделе 4.2.1.2.1.2 в статье [1].
3. В hello **Live поле сервера манифеста**, **manifestOutput** необходимо задать слишком**true**.
4. Условии hello разреженных характера hello, сообщающее о событии, мы рекомендуем hello следующее:
   
    а. В начале hello трансляция hello, hello кодировщик отправляет hello исходный заголовок поля toohello службу, которая позволяет разреженную дорожку tooregister службы hello hello в манифест клиента hello.
   
    b. Когда данные не были отправлены Hello кодировщик должен завершить работу hello HTTP-запроса POST. Длительные HTTP POST, которые не отправляют данные можно предотвратить быстро отключение от кодировщика hello hello события перезагрузки службы обновлений или сервера служб мультимедиа. В этих случаях hello сервера мультимедиа временно заблокирован в операции получения hello сокете.
   
    c. Во время hello, когда передача сигналов данных недоступен кодировщик hello следует закрывать hello HTTP-запроса POST. Если запрос POST hello активен, hello кодировщик должен отправить данные.

    d. При отправке разреженных фрагментов, hello кодировщика можно задать явные заголовок content-length, если он доступен.

    д. При отправке разреженных фрагментов с новым соединением, кодировщик hello следует начать отправку из поля заголовка hello, следуют hello новых фрагментов. Это для случаев, в какие перехода на другой ресурс происходит в промежутке и новое подключение разреженных hello, установленного tooa новый сервер, который не обнаружил hello разреженную дорожку до.

    f. фрагмент разреженную дорожку Hello становится доступной toohello клиента при hello соответствующий родительский отслеживания фрагмент, который имеет значение больше либо равно timestamp становится доступной toohello клиента. Например, если фрагмент разреженных hello имеет отметку времени, t = 1000, ожидается, после hello клиент видит отметка времени 1000 фрагмента, «видео» (при условии, что имя отслеживания родительского hello «видео») или выше, можно загрузить hello разреженных фрагмент t = 1000. Обратите внимание, что hello фактическое сигнала может использоваться для временной шкалы hello представления в другое место для его указанной цели. В этом примере он, возможно, что hello разреженных фрагмент t = 1000 содержит полезные данные XML, предназначенная для вставки рекламы в позиции, которая через несколько секунд позже.

    ж. полезные данные Hello разреженную дорожку фрагментов можно в различных форматах (например, XML, text или binary) в зависимости от сценария hello.

### <a name="redundant-audio-track"></a>Избыточная звуковая дорожка
В типичном HTTP адаптивной потоковой передачи сценарии (например, Smooth Streaming или дефис) часто имеется только один звуковой дорожки hello всей презентации. В отличие от видеодорожек, которые имеют несколько уровней качества для toochoose клиента hello в состоянии ошибки, звуковая дорожка hello может быть одной точки сбоя, если hello приема hello потока, который содержит hello аудиодорожки разрывается. 

toosolve поддерживает эту проблему, Media Services live приема избыточных звуковых дорожек. Hello идея заключается в том, hello же звуковой дорожки могут быть отосланы несколько раз в разных потоках. Несмотря на то, что hello служба регистрирует только звуковой дорожки hello один раз в манифест клиента hello, можно использовать избыточные звуковые дорожки как резервные копии для получения звуковых фрагментов, если основной аудиодорожки hello вызывает проблемы. tooingest избыточных аудиодорожки hello кодировщик должен:

1. Создайте несколько фрагментов MP4 bitstreams же звуковая дорожка hello. Hello избыточных звуковые дорожки должны быть семантически эквивалентны, с hello же фрагмент отметки времени и взаимозаменяемыми уровне заголовок hello и фрагмент.
2. Убедитесь что hello «звук» запись в hello Live Server манифеста (раздел 6 в [1]) является hello одинаково для избыточных звуковые дорожки.

После реализации Hello рекомендуется для избыточных звуковые дорожки.

1. Передавайте каждую уникальную звуковую дорожку в собственном потоке. Кроме того, отправить избыточных поток для каждого из этих потоков звуковой дорожки, когда hello второго потока отличается от hello сначала только по идентификатору hello в hello HTTP POST на URL-адрес: {протокола}. :// {server-адрес} / {path}/Streams({identifier}) точка публикации.
2. Используйте отдельные потоки toosend hello два наименьшее видео битрейтов. В каждом из этих потоков СЛЕДУЕТ обеспечить наличие копии каждой уникальной звуковой дорожки. Например, при поддержке нескольких языков в эти потоки СЛЕДУЕТ включить звуковые дорожки для каждого языка.
3. Используйте tooencode экземпляров на отдельном сервере (кодировщика) и отправлять hello избыточных потоки, упомянутые в (1) и (2). 

## <a name="media-services-learning-paths"></a>Схемы обучения работе со службами мультимедиа
[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a>Отзывы
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

[image1]: ./media/media-services-fmp4-live-ingest-overview/media-services-image1.png
[image2]: ./media/media-services-fmp4-live-ingest-overview/media-services-image2.png
[image3]: ./media/media-services-fmp4-live-ingest-overview/media-services-image3.png
[image4]: ./media/media-services-fmp4-live-ingest-overview/media-services-image4.png
[image5]: ./media/media-services-fmp4-live-ingest-overview/media-services-image5.png
[image6]: ./media/media-services-fmp4-live-ingest-overview/media-services-image6.png
[image7]: ./media/media-services-fmp4-live-ingest-overview/media-services-image7.png
