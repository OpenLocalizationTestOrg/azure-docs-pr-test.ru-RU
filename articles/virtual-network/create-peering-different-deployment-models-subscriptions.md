---
title: "Создание пиринга виртуальных сетей Azure с разными моделями развертывания в разных подписках | Документация Майкрософт"
description: "Узнайте, как создать пиринг между виртуальными сетями, созданными с помощью разных моделей развертывания Azure, которые существуют в разных подписках Azure."
services: virtual-network
documentationcenter: 
author: jimdial
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/17/2017
ms.author: jdial;narayan;annahar
ms.openlocfilehash: 93d5676e9188e67f1f6a9bba1d4d30a93b3883d8
ms.sourcegitcommit: 422efcbac5b6b68295064bd545132fcc98349d01
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2017
---
# <a name="create-a-virtual-network-peering---different-deployment-models-and-subscriptions"></a><span data-ttu-id="c99e9-103">Создание пиринга виртуальных сетей с разными моделями развертывания в разных подписках</span><span class="sxs-lookup"><span data-stu-id="c99e9-103">Create a virtual network peering - different deployment models and subscriptions</span></span>

<span data-ttu-id="c99e9-104">В этом руководстве вы узнаете, как создать пиринг между виртуальными сетями, созданными с помощью разных моделей развертывания.</span><span class="sxs-lookup"><span data-stu-id="c99e9-104">In this tutorial, you learn to create a virtual network peering between virtual networks created through different deployment models.</span></span> <span data-ttu-id="c99e9-105">Эти виртуальные сети находятся в разных подписках.</span><span class="sxs-lookup"><span data-stu-id="c99e9-105">The virtual networks exist in different subscriptions.</span></span> <span data-ttu-id="c99e9-106">Установление пиринга между двумя виртуальными сетями позволяет ресурсам в разных виртуальных сетях взаимодействовать друг с другом с такими же пропускной способностью и задержкой, как если бы эти ресурсы находились в одной виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="c99e9-106">Peering two virtual networks enables resources in different virtual networks to communicate with each other with the same bandwidth and latency as though the resources were in the same virtual network.</span></span> <span data-ttu-id="c99e9-107">Узнайте больше о [пиринге виртуальных сетей](virtual-network-peering-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c99e9-107">Learn more about [Virtual network peering](virtual-network-peering-overview.md).</span></span> 

<span data-ttu-id="c99e9-108">Действия по созданию пиринга виртуальных сетей зависят от того, находятся ли виртуальные сети в одной или разных подписках, и того, какая [модель развертывания Azure](../azure-resource-manager/resource-manager-deployment-model.md?toc=%2fazure%2fvirtual-network%2ftoc.json) использовалась для их создания.</span><span class="sxs-lookup"><span data-stu-id="c99e9-108">The steps to create a virtual network peering are different, depending on whether the virtual networks are in the same, or different, subscriptions, and which [Azure deployment model](../azure-resource-manager/resource-manager-deployment-model.md?toc=%2fazure%2fvirtual-network%2ftoc.json) the virtual networks are created through.</span></span> <span data-ttu-id="c99e9-109">Узнайте, как создать пиринг виртуальных сетей в других сценариях, щелкнув сценарий в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="c99e9-109">Learn how to create a virtual network peering in other scenarios by clicking the scenario from the following table:</span></span>

|<span data-ttu-id="c99e9-110">Модель развертывания Azure</span><span class="sxs-lookup"><span data-stu-id="c99e9-110">Azure deployment model</span></span>  | <span data-ttu-id="c99e9-111">Подписка Azure.</span><span class="sxs-lookup"><span data-stu-id="c99e9-111">Azure subscription</span></span>  |
|--------- |---------|
|[<span data-ttu-id="c99e9-112">Обе виртуальные сети Resource Manager</span><span class="sxs-lookup"><span data-stu-id="c99e9-112">Both Resource Manager</span></span>](virtual-network-create-peering.md) |<span data-ttu-id="c99e9-113">Аналогично</span><span class="sxs-lookup"><span data-stu-id="c99e9-113">Same</span></span>|
|[<span data-ttu-id="c99e9-114">Обе виртуальные сети Resource Manager</span><span class="sxs-lookup"><span data-stu-id="c99e9-114">Both Resource Manager</span></span>](create-peering-different-subscriptions.md) |<span data-ttu-id="c99e9-115">Разные</span><span class="sxs-lookup"><span data-stu-id="c99e9-115">Different</span></span>|
|[<span data-ttu-id="c99e9-116">Одна виртуальная сеть Resource Manager, одна классическая виртуальная сеть</span><span class="sxs-lookup"><span data-stu-id="c99e9-116">One Resource Manager, one classic</span></span>](create-peering-different-deployment-models.md) |<span data-ttu-id="c99e9-117">Аналогично</span><span class="sxs-lookup"><span data-stu-id="c99e9-117">Same</span></span>|

<span data-ttu-id="c99e9-118">Невозможно создать пиринг между двумя виртуальными сетями, созданными с помощью классической модели развертывания.</span><span class="sxs-lookup"><span data-stu-id="c99e9-118">A virtual network peering cannot be created between two virtual networks deployed through the classic deployment model.</span></span> <span data-ttu-id="c99e9-119">Пиринг виртуальных сетей можно создать только между двумя виртуальными сетями, размещенными в одном регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="c99e9-119">A virtual network peering can only be created between two virtual networks that exist in the same Azure region.</span></span> <span data-ttu-id="c99e9-120">При создании пиринга между виртуальными сетями, которые существуют в разных подписках, эти подписки должны быть связаны с одним клиентом Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c99e9-120">When creating a virtual network peering between virtual networks that exist in different subscriptions, the subscriptions must both be associated to the same Azure Active Directory tenant.</span></span> <span data-ttu-id="c99e9-121">Если у вас еще нет клиента Azure Active Directory, можно быстро [создать его](../active-directory/develop/active-directory-howto-tenant.md?toc=%2fazure%2fvirtual-network%2ftoc.json#start-from-scratch).</span><span class="sxs-lookup"><span data-stu-id="c99e9-121">If you don't already have an Azure Active Directory tenant, you can quickly [create one](../active-directory/develop/active-directory-howto-tenant.md?toc=%2fazure%2fvirtual-network%2ftoc.json#start-from-scratch).</span></span> <span data-ttu-id="c99e9-122">Если вам необходимо подключить виртуальные сети, созданные с помощью классической модели развертывания, расположенные в разных регионах Azure или находящиеся в подписках, связанных с разными клиентами Azure Active Directory, можно использовать [VPN-шлюз](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md?toc=%2fazure%2fvirtual-network%2ftoc.json) Azure.</span><span class="sxs-lookup"><span data-stu-id="c99e9-122">If you need to connect virtual networks that were both created through the classic deployment model, or that exist in different Azure regions, or that exist in subscriptions associated to different Azure Active Directory tenants, you can use an Azure [VPN Gateway](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md?toc=%2fazure%2fvirtual-network%2ftoc.json) to connect the virtual networks.</span></span> 

> [!WARNING]
> <span data-ttu-id="c99e9-123">Функция создания пиринга между виртуальными сетями, созданными с помощью разных моделей развертывания Azure, которые существуют в разных подписках Azure, сейчас находится на этапе предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-123">Creating a virtual network peering between virtual networks in created through different Azure deployment models that exist in different subscriptions is currently in preview.</span></span> <span data-ttu-id="c99e9-124">Пиринги виртуальных сетей, создаваемые в этом сценарии, могут не обеспечивать тот же уровень доступности и надежности, что и пиринг виртуальных сетей, создаваемый в сценариях на основе общедоступного выпуска.</span><span class="sxs-lookup"><span data-stu-id="c99e9-124">Virtual network peerings created in this scenario may not have the same level of availability and reliability as creating a virtual network peering in scenarios in general availability release.</span></span> <span data-ttu-id="c99e9-125">Пиринги виртуальных сетей, создаваемые в этом сценарии, могут поддерживаться, обеспечивать все возможности или быть доступны не во всех регионах Azure.</span><span class="sxs-lookup"><span data-stu-id="c99e9-125">Virtual network peerings created in this scenario are not supported, may have constrained capabilities, and may not be available in all Azure regions.</span></span> <span data-ttu-id="c99e9-126">Актуальные сведения о доступности и состоянии этой функции см. на странице [обновлений виртуальной сети Azure](https://azure.microsoft.com/updates/?product=virtual-network).</span><span class="sxs-lookup"><span data-stu-id="c99e9-126">For the most up-to-date notifications on availability and status of this feature, check the [Azure Virtual Network updates](https://azure.microsoft.com/updates/?product=virtual-network) page.</span></span>

<span data-ttu-id="c99e9-127">Для создания пиринга виртуальных сетей можно использовать [портал Azure](#portal), [интерфейс командной строки](#cli) Azure (Azure CLI) или Azure [PowerShell](#powershell).</span><span class="sxs-lookup"><span data-stu-id="c99e9-127">You can use the [Azure portal](#portal), the Azure [command-line interface](#cli) (CLI), or Azure [PowerShell](#powershell) to create a virtual network peering.</span></span> <span data-ttu-id="c99e9-128">Щелкните любую из предыдущих ссылок на инструмент, чтобы перейти непосредственно к инструкциям по созданию пиринга виртуальных сетей с помощью выбранного инструмента.</span><span class="sxs-lookup"><span data-stu-id="c99e9-128">Click any of the previous tool links to go directly to the steps for creating a virtual network peering using your tool of choice.</span></span>

## <span data-ttu-id="c99e9-129"><a name="register"></a>Регистрация для использования предварительной версии</span><span class="sxs-lookup"><span data-stu-id="c99e9-129"><a name="register"></a>Register for the preview</span></span>

<span data-ttu-id="c99e9-130">Чтобы зарегистрироваться для использования предварительной версии, выполните приведенные ниже действия для обеих подписок, которые содержат виртуальные сети, предназначенные для создания пиринга.</span><span class="sxs-lookup"><span data-stu-id="c99e9-130">To register for the preview, complete the steps that follow for both subscriptions that contain the virtual networks you want to peer.</span></span> <span data-ttu-id="c99e9-131">Единственный инструмент, который можно использовать для регистрации, — PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c99e9-131">The only tool you can use to register for the preview is PowerShell.</span></span>

1. <span data-ttu-id="c99e9-132">Установите последнюю версию модуля [AzureRm](https://www.powershellgallery.com/packages/AzureRM/) PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c99e9-132">Install the latest version of the PowerShell [AzureRm](https://www.powershellgallery.com/packages/AzureRM/) module.</span></span> <span data-ttu-id="c99e9-133">Если вы еще не работали с Azure PowerShell, ознакомьтесь со статьей [Overview of Azure PowerShell](/powershell/azure/overview?toc=%2fazure%2fvirtual-network%2ftoc.json) (Общие сведения об Azure PowerShell).</span><span class="sxs-lookup"><span data-stu-id="c99e9-133">If you're new to Azure PowerShell, see [Azure PowerShell overview](/powershell/azure/overview?toc=%2fazure%2fvirtual-network%2ftoc.json).</span></span>
2. <span data-ttu-id="c99e9-134">Запустите сеанс PowerShell и войдите в Azure с помощью команды `login-azurermaccount`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-134">Start a PowerShell session and log in to Azure using the `login-azurermaccount` command.</span></span>
3. <span data-ttu-id="c99e9-135">Зарегистрируйте подписку для использования предварительной версии, введя следующие команды.</span><span class="sxs-lookup"><span data-stu-id="c99e9-135">Register your subscription for the preview by entering the following commands:</span></span>

    ```powershell
    Register-AzureRmProviderFeature `
      -FeatureName AllowClassicCrossSubscriptionPeering `
      -ProviderNamespace Microsoft.Network
    
    Register-AzureRmResourceProvider `
      -ProviderNamespace Microsoft.Network
    ```
    <span data-ttu-id="c99e9-136">Не выполняйте инструкции в разделах для портала, PowerShell или Azure CLI в этой статье, пока значение **RegistrationState** (Состояние регистрации) в выходных данных приведенной ниже команды не станет **Registered** (Зарегистрировано) для обеих подписок.</span><span class="sxs-lookup"><span data-stu-id="c99e9-136">Do not complete the steps in the Portal, Azure CLI, or PowerShell sections of this article until the **RegistrationState** output you receive after entering the following command is **Registered** for both subscriptions:</span></span>

    ```powershell    
    Get-AzureRmProviderFeature `
      -FeatureName AllowClassicCrossSubscriptionPeering `
      -ProviderNamespace Microsoft.Network
    ```

## <span data-ttu-id="c99e9-137"><a name="portal"></a>Создание пиринга с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="c99e9-137"><a name="portal"></a>Create peering - Azure portal</span></span>

<span data-ttu-id="c99e9-138">В этом руководстве используются разные учетные записи для каждой подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-138">This tutorial uses different accounts for each subscription.</span></span> <span data-ttu-id="c99e9-139">Если вы используете учетную запись, имеющую разрешения для обеих подписок, то можете использовать эту учетную запись для всех действий. Пропустите выход с портала и назначение разрешений еще одного пользователя для виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="c99e9-139">If you're using an account that has permissions to both subscriptions, you can use the same account for all steps, skip the steps for logging out of the portal, and skip the steps for assigning another user permissions to the virtual networks.</span></span> <span data-ttu-id="c99e9-140">Перед выполнением любого из следующих действий необходимо зарегистрироваться для использования предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-140">Before completing any of the following steps, you must register for the preview.</span></span> <span data-ttu-id="c99e9-141">Чтобы зарегистрироваться, выполните действия в разделе [Регистрация для использования предварительной версии](#register) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-141">To register, complete the steps in the [Register for the preview](#register) section of this article.</span></span> <span data-ttu-id="c99e9-142">Не продолжайте остальные действия, пока обе подписки не будут зарегистрированы для использования предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-142">Do not continue with the remaining steps until both subscriptions are registered for the preview.</span></span>
 
1. <span data-ttu-id="c99e9-143">Войдите на [портал Azure](https://portal.azure.com) как пользователь A.</span><span class="sxs-lookup"><span data-stu-id="c99e9-143">Log in to the [Azure portal](https://portal.azure.com) as UserA.</span></span> <span data-ttu-id="c99e9-144">У учетной записи, используемой для входа, должны быть необходимые разрешения для создания пиринга виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="c99e9-144">The account you log in with must have the necessary permissions to create a virtual network peering.</span></span> <span data-ttu-id="c99e9-145">Дополнительные сведения см. в разделе [Разрешения](#permissions) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-145">See the [Permissions](#permissions) section of this article for details.</span></span>
2. <span data-ttu-id="c99e9-146">Щелкните **+ Создать**, выберите **Сети** и щелкните **Виртуальная сеть**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-146">Click **+ New**, click **Networking**, then click **Virtual network**.</span></span>
3. <span data-ttu-id="c99e9-147">В колонке **Создание виртуальной сети** введите или выберите значения для приведенных ниже параметров и щелкните **Создать**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-147">In the **Create virtual network** blade, enter, or select values for the following settings, then click **Create**:</span></span>
    - <span data-ttu-id="c99e9-148">**Имя**: *myVnetA*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-148">**Name**: *myVnetA*</span></span>
    - <span data-ttu-id="c99e9-149">**Адресное пространство**: *10.0.0.0/16*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-149">**Address space**: *10.0.0.0/16*</span></span>
    - <span data-ttu-id="c99e9-150">**Имя подсети**: *по умолчанию*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-150">**Subnet name**: *default*</span></span>
    - <span data-ttu-id="c99e9-151">**Диапазон адресов подсети**: *10.0.0.0/24*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-151">**Subnet address range**: *10.0.0.0/24*</span></span>
    - <span data-ttu-id="c99e9-152">**Подписка**: выберите подписку A.</span><span class="sxs-lookup"><span data-stu-id="c99e9-152">**Subscription**: Select subscription A.</span></span>
    - <span data-ttu-id="c99e9-153">**Группа ресурсов**: установите флажок **Создать** и введите *myResourceGroupA*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-153">**Resource group**: Select **Create new** and enter *myResourceGroupA*</span></span>
    - <span data-ttu-id="c99e9-154">**Расположение**: *Восточная часть США*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-154">**Location**: *East US*</span></span>
4. <span data-ttu-id="c99e9-155">В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetA*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-155">In the **Search resources** box at the top of the portal, type *myVnetA*.</span></span> <span data-ttu-id="c99e9-156">Когда сеть **myVnetA** появится в результатах поиска, щелкните ее.</span><span class="sxs-lookup"><span data-stu-id="c99e9-156">Click **myVnetA** when it appears in the search results.</span></span> <span data-ttu-id="c99e9-157">Отобразится колонка для виртуальной сети **myVnetA**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-157">A blade appears for the **myVnetA** virtual network.</span></span>
5. <span data-ttu-id="c99e9-158">В вертикальном списке параметров в левой части отобразившейся колонки **myVnetA** щелкните **Управление доступом (IAM)**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-158">In the **myVnetA** blade that appears, click **Access control (IAM)** from the vertical list of options on the left side of the blade.</span></span>
6. <span data-ttu-id="c99e9-159">В открывшейся колонке **myVnetA — управление доступом (IAM)** щелкните **+ Добавить**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-159">In the **myVnetA - Access control (IAM)** blade that appears, click **+ Add**.</span></span>
7. <span data-ttu-id="c99e9-160">В отобразившейся колонке **Добавление разрешений** в поле **Роль** выберите **Участник сетей**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-160">In the **Add permissions** blade that appears, select **Network contributor** in the **Role** box.</span></span>
8. <span data-ttu-id="c99e9-161">В поле **Выбор** выберите пользователя B или введите его адрес электронной почты для поиска.</span><span class="sxs-lookup"><span data-stu-id="c99e9-161">In the **Select** box, select UserB, or type UserB's email address to search for it.</span></span> <span data-ttu-id="c99e9-162">Отобразится список пользователей из того же клиента Azure Active Directory, с которым связана виртуальная сеть, с которой вы устанавливаете пиринг.</span><span class="sxs-lookup"><span data-stu-id="c99e9-162">The list of users shown is from the same Azure Active Directory tenant as the virtual network you're setting up the peering for.</span></span> <span data-ttu-id="c99e9-163">Щелкните пользователя B, когда он появится в списке.</span><span class="sxs-lookup"><span data-stu-id="c99e9-163">Click UserB when it appears in the list.</span></span>
9. <span data-ttu-id="c99e9-164">Щелкните **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-164">Click **Save**.</span></span>
10. <span data-ttu-id="c99e9-165">Выйдите с портала как пользователь A, а затем войдите как пользователь B.</span><span class="sxs-lookup"><span data-stu-id="c99e9-165">Log out of the portal as UserA, then log in as UserB.</span></span>
11. <span data-ttu-id="c99e9-166">Щелкните **+ Создать**, введите *Виртуальная сеть* в поле **Поиск по Marketplace**, а затем щелкните **Виртуальная сеть** в результатах поиска.</span><span class="sxs-lookup"><span data-stu-id="c99e9-166">Click **+ New**, type *Virtual network* in the **Search the Marketplace** box, then click **Virtual network** in the search results.</span></span>
12. <span data-ttu-id="c99e9-167">В открывшейся колонке **Виртуальная сеть** в поле **Выбор модели развертывания** выберите **Классический** и нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-167">In the **Virtual Network** blade that appears, select **Classic** in the **Select a deployment model** box, then click **Create**.</span></span>
13.   <span data-ttu-id="c99e9-168">В отобразившейся колонке "Создание виртуальной сети (классической)" введите приведенные ниже значения.</span><span class="sxs-lookup"><span data-stu-id="c99e9-168">In the Create virtual network (classic) box that appears, enter the following values:</span></span>

    - <span data-ttu-id="c99e9-169">**Имя**: *myVnetB*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-169">**Name**: *myVnetB*</span></span>
    - <span data-ttu-id="c99e9-170">**Адресное пространство**: *10.1.0.0/16*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-170">**Address space**: *10.1.0.0/16*</span></span>
    - <span data-ttu-id="c99e9-171">**Имя подсети**: *по умолчанию*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-171">**Subnet name**: *default*</span></span>
    - <span data-ttu-id="c99e9-172">**Диапазон адресов подсети:** *10.1.0.0/24*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-172">**Subnet address range**: *10.1.0.0/24*</span></span>
    - <span data-ttu-id="c99e9-173">**Подписка**: выберите подписку B.</span><span class="sxs-lookup"><span data-stu-id="c99e9-173">**Subscription**: Select subscription B.</span></span>
    - <span data-ttu-id="c99e9-174">**Группа ресурсов**: установите флажок **Создать** и введите *myResourceGroupB*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-174">**Resource group**: Select **Create new** and enter *myResourceGroupB*</span></span>
    - <span data-ttu-id="c99e9-175">**Расположение**: *Восточная часть США*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-175">**Location**: *East US*</span></span>

14. <span data-ttu-id="c99e9-176">В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetB*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-176">In the **Search resources** box at the top of the portal, type *myVnetB*.</span></span> <span data-ttu-id="c99e9-177">Когда сеть **myVnetB** появится в результатах поиска, щелкните ее.</span><span class="sxs-lookup"><span data-stu-id="c99e9-177">Click **myVnetB** when it appears in the search results.</span></span> <span data-ttu-id="c99e9-178">Отобразится колонка для виртуальной сети **myVnetB**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-178">A blade appears for the **myVnetB** virtual network.</span></span>
15. <span data-ttu-id="c99e9-179">В вертикальном списке параметров в левой части отобразившейся колонки **myVnetB** щелкните **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-179">In the **myVnetB** blade that appears, click **Properties** from the vertical list of options on the left side of the blade.</span></span> <span data-ttu-id="c99e9-180">Скопируйте **Идентификатор ресурса**, он понадобится нам позже.</span><span class="sxs-lookup"><span data-stu-id="c99e9-180">Copy the **RESOURCE ID**, which is used in a later step.</span></span> <span data-ttu-id="c99e9-181">Идентификатор ресурса имеет следующий вид: /subscriptions/<Susbscription ID>/resourceGroups/myResoureGroupB/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB.</span><span class="sxs-lookup"><span data-stu-id="c99e9-181">The resource ID is similar to the following example: /subscriptions/<Susbscription ID>/resourceGroups/myResoureGroupB/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB</span></span>
16. <span data-ttu-id="c99e9-182">Выполните шаги 5–9 для myVnetB, указав **пользователя A** на шаге 8.</span><span class="sxs-lookup"><span data-stu-id="c99e9-182">Complete steps 5-9 for myVnetB, entering **UserA** in step 8.</span></span>
17. <span data-ttu-id="c99e9-183">Выйдите с портала как пользователь B, а затем войдите как пользователь A.</span><span class="sxs-lookup"><span data-stu-id="c99e9-183">Log out of the portal as UserB and log in as UserA.</span></span>
18. <span data-ttu-id="c99e9-184">В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetA*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-184">In the **Search resources** box at the top of the portal, type *myVnetA*.</span></span> <span data-ttu-id="c99e9-185">Когда сеть **myVnetA** появится в результатах поиска, щелкните ее.</span><span class="sxs-lookup"><span data-stu-id="c99e9-185">Click **myVnetA** when it appears in the search results.</span></span> <span data-ttu-id="c99e9-186">Отобразится колонка для виртуальной сети **myVnetA**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-186">A blade appears for the **myVnet** virtual network.</span></span>
19. <span data-ttu-id="c99e9-187">Щелкните **myVnetA**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-187">Click **myVnetA**.</span></span>
20. <span data-ttu-id="c99e9-188">В вертикальном списке параметров в левой части отобразившейся колонки **myVnetA** щелкните **Пиринги**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-188">In the **myVnetA** blade that appears, click **Peerings** from the vertical list of options on the left side of the blade.</span></span>
21. <span data-ttu-id="c99e9-189">В открывшейся колонке **myVnetA — пиринги** щелкните **+ Добавить**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-189">In the **myVnetA - Peerings** blade that appeared, click **+ Add**</span></span>
22. <span data-ttu-id="c99e9-190">В открывшейся колонке **Добавить пиринг** введите или выберите значения приведенных ниже параметров, после чего нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-190">In the **Add peering** blade that appears, enter, or select the following options, then click **OK**:</span></span>
     - <span data-ttu-id="c99e9-191">**Имя**: *myVnetAToMyVnetB*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-191">**Name**: *myVnetAToMyVnetB*</span></span>
     - <span data-ttu-id="c99e9-192">**Модель развертывания виртуальной сети**: выберите **Классический**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-192">**Virtual network deployment model**:  Select **Classic**.</span></span>
     - <span data-ttu-id="c99e9-193">**Я знаю идентификатор ресурса**: установите этот флажок.</span><span class="sxs-lookup"><span data-stu-id="c99e9-193">**I know my resource ID**: Check this box.</span></span>
     - <span data-ttu-id="c99e9-194">**Идентификатор ресурса**: введите идентификатор ресурса myVnetB, скопированный на шаге 15.</span><span class="sxs-lookup"><span data-stu-id="c99e9-194">**Resource ID**: Enter the resource ID of myVnetB from step 15.</span></span>
     - <span data-ttu-id="c99e9-195">**Разрешить доступ к виртуальным сетям**: убедитесь, что выбрано значение **Включено**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-195">**Allow virtual network access:** Ensure that **Enabled** is selected.</span></span>
    <span data-ttu-id="c99e9-196">Другие параметры в этом руководстве не используются.</span><span class="sxs-lookup"><span data-stu-id="c99e9-196">No other settings are used in this tutorial.</span></span> <span data-ttu-id="c99e9-197">Чтобы узнать о всех параметрах пиринга, прочитайте раздел [Создание, изменение и удаление пиринга в виртуальной сети](virtual-network-manage-peering.md#create-a-peering).</span><span class="sxs-lookup"><span data-stu-id="c99e9-197">To learn about all peering settings, read [Manage virtual network peerings](virtual-network-manage-peering.md#create-a-peering).</span></span>
23. <span data-ttu-id="c99e9-198">После нажатия кнопки **ОК** на предыдущем шаге колонка **Добавить пиринг** закроется, и вы снова увидите колонку **myVnetA — пиринги**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-198">After clicking **OK** in the previous step, the **Add peering** blade closes and you see the **myVnetA - Peerings** blade again.</span></span> <span data-ttu-id="c99e9-199">Через несколько секунд созданный пиринг отобразится в этой колонке.</span><span class="sxs-lookup"><span data-stu-id="c99e9-199">After a few seconds, the peering you created appears in the blade.</span></span> <span data-ttu-id="c99e9-200">В столбце **Состояние пиринга** для созданного пиринга **myVnetAToMyVnetB** указано состояние **Подключено**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-200">**Connected** is listed in the **PEERING STATUS** column for the **myVnetAToMyVnetB** peering you created.</span></span> <span data-ttu-id="c99e9-201">Пиринг установлен.</span><span class="sxs-lookup"><span data-stu-id="c99e9-201">The peering is now established.</span></span> <span data-ttu-id="c99e9-202">Нет необходимости создавать пиринг между классической виртуальной сетью и виртуальной сетью Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c99e9-202">There is no need to peer the virtual network (classic) to the virtual network (Resource Manager).</span></span>

    <span data-ttu-id="c99e9-203">Теперь все ресурсы Azure, созданные в любой из виртуальных сетей, могут взаимодействовать друг с другом, используя свои IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="c99e9-203">Any Azure resources you create in either virtual network are now able to communicate with each other through their IP addresses.</span></span> <span data-ttu-id="c99e9-204">Если вы используете разрешение имен Azure по умолчанию для виртуальных сетей, то ресурсы в этих виртуальных сетях не смогут разрешать имена между виртуальными сетями.</span><span class="sxs-lookup"><span data-stu-id="c99e9-204">If you're using default Azure name resolution for the virtual networks, the resources in the virtual networks are not able to resolve names across the virtual networks.</span></span> <span data-ttu-id="c99e9-205">Если требуется разрешение имен между виртуальными сетями в пиринге, необходимо создать собственный DNS-сервер.</span><span class="sxs-lookup"><span data-stu-id="c99e9-205">If you want to resolve names across virtual networks in a peering, you must create your own DNS server.</span></span> <span data-ttu-id="c99e9-206">Узнайте, как настроить [разрешение имен с помощью собственного DNS-сервера](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="c99e9-206">Learn how to set up [Name resolution using your own DNS server](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span></span>

24. <span data-ttu-id="c99e9-207">**Необязательно**. Хотя в этом руководстве не рассматривается создание виртуальных машин, можно создать по виртуальной машине в каждой виртуальной сети и подключить их между собой, чтобы проверить связь.</span><span class="sxs-lookup"><span data-stu-id="c99e9-207">**Optional**: Though creating virtual machines is not covered in this tutorial, you can create a virtual machine in each virtual network and connect from one virtual machine to the other, to validate connectivity.</span></span>
25. <span data-ttu-id="c99e9-208">**Необязательно**. Чтобы удалить ресурсы, созданные в этом руководстве, выполните инструкции в разделе [Удаление ресурсов](#delete-portal) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-208">**Optional**: To delete the resources that you create in this tutorial, complete the steps in the [Delete resources](#delete-portal) section of this article.</span></span>

## <span data-ttu-id="c99e9-209"><a name="cli"></a>Создание пиринга с помощью Azure CLI</span><span class="sxs-lookup"><span data-stu-id="c99e9-209"><a name="cli"></a>Create peering - Azure CLI</span></span>

<span data-ttu-id="c99e9-210">В этом руководстве используются разные учетные записи для каждой подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-210">This tutorial uses different accounts for each subscription.</span></span> <span data-ttu-id="c99e9-211">Если вы используете учетную запись, имеющую разрешения для обеих подписок, то можете использовать эту учетную запись для всех действий. Пропустите выход из Azure и удалите строки сценария, назначающие роли пользователей.</span><span class="sxs-lookup"><span data-stu-id="c99e9-211">If you're using an account that has permissions to both subscriptions, you can use the same account for all steps, skip the steps for logging out of Azure, and remove the lines of script that create user role assignments.</span></span> <span data-ttu-id="c99e9-212">Замените UserA@azure.com и UserB@azure.com во всех следующих сценариях именами пользователей, которые вы используете для пользователей A и B.</span><span class="sxs-lookup"><span data-stu-id="c99e9-212">Replace UserA@azure.com and UserB@azure.com in all of the following scripts with the usernames you're using for UserA and UserB.</span></span> 

<span data-ttu-id="c99e9-213">Перед выполнением любого из следующих действий необходимо зарегистрироваться для использования предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-213">Before completing any of the following steps, you must register for the preview.</span></span> <span data-ttu-id="c99e9-214">Чтобы зарегистрироваться, выполните действия в разделе [Регистрация для использования предварительной версии](#register) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-214">To register, complete the steps in the [Register for the preview](#register) section of this article.</span></span> <span data-ttu-id="c99e9-215">Не продолжайте остальные действия, пока обе подписки не будут зарегистрированы для использования предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-215">Do not continue with the remaining steps until both subscriptions are registered for the preview.</span></span>

1. <span data-ttu-id="c99e9-216">[Установите](../cli-install-nodejs.md?toc=%2fazure%2fvirtual-network%2ftoc.json) Azure CLI 1.0 для создания классической виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="c99e9-216">[Install](../cli-install-nodejs.md?toc=%2fazure%2fvirtual-network%2ftoc.json) the Azure CLI 1.0 to create the virtual network (classic).</span></span>
2. <span data-ttu-id="c99e9-217">Запустите сеанс интерфейса командной строки и войдите в Azure как пользователь B с помощью команды `azure login`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-217">Open a CLI session and log in to Azure as UserB using the `azure login` command.</span></span>
3. <span data-ttu-id="c99e9-218">Запустите интерфейс командной строки в режиме управления службами, введя команду `azure config mode asm`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-218">Run the CLI in Service Management mode by entering the `azure config mode asm` command.</span></span>
4. <span data-ttu-id="c99e9-219">Чтобы создать классическую виртуальную сеть, введите приведенную ниже команду.</span><span class="sxs-lookup"><span data-stu-id="c99e9-219">Enter the following command to create the virtual network (classic):</span></span>
 
    ```azurecli
    azure network vnet create --vnet myVnetB --address-space 10.1.0.0 --cidr 16 --location "East US"
    ```
5. <span data-ttu-id="c99e9-220">Остальные действия необходимо выполнить в оболочке Bash с помощью [установленного](/cli/azure/install-azure-cli?toc=%2fazure%2fvirtual-network%2ftoc.json) интерфейса командной строки Azure CLI 2.0.4 или более поздней версии или с помощью Azure Cloud Shell.</span><span class="sxs-lookup"><span data-stu-id="c99e9-220">The remaining steps must be completed using a bash shell with the Azure CLI 2.0.4 or later [installed](/cli/azure/install-azure-cli?toc=%2fazure%2fvirtual-network%2ftoc.json), or by using the Azure Cloud Shell.</span></span> <span data-ttu-id="c99e9-221">Azure Cloud Shell — это бесплатная оболочка Bash, которую можно запускать непосредственно на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="c99e9-221">The Azure Cloud Shell is a free Bash shell that you can run directly within the Azure portal.</span></span> <span data-ttu-id="c99e9-222">Она включает предварительно установленный интерфейс Azure CLI и настроена для использования с вашей учетной записью.</span><span class="sxs-lookup"><span data-stu-id="c99e9-222">It has the Azure CLI preinstalled and configured to use with your account.</span></span> <span data-ttu-id="c99e9-223">Нажмите кнопку **Попробовать** в приведенных ниже сценариях, чтобы запустить службу Cloud Shell, которая выполнит вход в вашу учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="c99e9-223">Click the **Try it** button in the scripts that follow, which opens a Cloud Shell that logs you in to your Azure account.</span></span> <span data-ttu-id="c99e9-224">Сведения о параметрах выполнения сценариев Bash для интерфейса командной строки в клиенте Windows см. в статье [Использование Azure CLI в Windows](../virtual-machines/windows/cli-options.md?toc=%2fazure%2fvirtual-network%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="c99e9-224">For options on running bash CLI scripts on a Windows client, see [Running the Azure CLI in Windows](../virtual-machines/windows/cli-options.md?toc=%2fazure%2fvirtual-network%2ftoc.json).</span></span> 
6. <span data-ttu-id="c99e9-225">Скопируйте следующий сценарий в текстовый редактор на своем компьютере.</span><span class="sxs-lookup"><span data-stu-id="c99e9-225">Copy the following script to a text editor on your PC.</span></span> <span data-ttu-id="c99e9-226">Замените `<SubscriptionB-Id>` идентификатором своей подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-226">Replace `<SubscriptionB-Id>` with your subscription ID.</span></span> <span data-ttu-id="c99e9-227">Если вам неизвестен идентификатор подписки, введите команду `az account show`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-227">If you don't know your subscription Id, enter the `az account show` command.</span></span> <span data-ttu-id="c99e9-228">Значение **id** (Идентификатор) в выходных данных является идентификатором вашей подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-228">The value for **id** in the output is your subscription Id.</span></span> <span data-ttu-id="c99e9-229">Скопируйте измененный сценарий, вставьте его в сеанс Azure CLI 2.0 и нажмите клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-229">Copy the modified script, paste it in to your CLI 2.0 session, and then press `Enter`.</span></span> 

    ```azurecli-interactive
    az role assignment create \
      --assignee UserA@azure.com \
      --role "Classic Network Contributor" \
      --scope /subscriptions/<SubscriptionB-Id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB
    ```

    <span data-ttu-id="c99e9-230">На шаге 4 платформа Azure создала классическую виртуальную сеть в группе ресурсов *Default-Networking*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-230">When you created the virtual network (classic) in step 4, Azure created the virtual network in the *Default-Networking* resource group.</span></span>
7. <span data-ttu-id="c99e9-231">Выйдите из Azure как пользователь B, затем войдите в Azure CLI 2.0 как пользователь A.</span><span class="sxs-lookup"><span data-stu-id="c99e9-231">Log UserB out of Azure and log in as UserA in the CLI 2.0.</span></span>
8. <span data-ttu-id="c99e9-232">Создайте группу ресурсов и виртуальную сеть Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c99e9-232">Create a resource group and a virtual network (Resource Manager).</span></span> <span data-ttu-id="c99e9-233">Скопируйте следующий сценарий, вставьте его в окно сеанса интерфейса командной строки и нажмите клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-233">Copy the following script, paste it in to your CLI session, and then press `Enter`.</span></span> 

    ```azurecli-interactive
    #!/bin/bash

    # Variables for common values used throughout the script.
    rgName="myResourceGroupA"
    location="eastus"

    # Create a resource group.
    az group create \
      --name $rgName \
      --location $location

    # Create virtual network A (Resource Manager).
    az network vnet create \
      --name myVnetA \
      --resource-group $rgName \
      --location $location \
      --address-prefix 10.0.0.0/16

    # Get the id for myVnetA.
    vNetAId=$(az network vnet show \
      --resource-group $rgName \
      --name myVnetA \
      --query id --out tsv)

    # Assign UserB permissions to myVnetA.
    az role assignment create \
      --assignee UserB@azure.com \
      --role "Network Contributor" \
      --scope $vNetAId
    ```

9. <span data-ttu-id="c99e9-234">Создайте пиринг между двумя виртуальными сетями, созданными с помощью разных моделей развертывания.</span><span class="sxs-lookup"><span data-stu-id="c99e9-234">Create a virtual network peering between the two virtual networks created through the different deployment models.</span></span> <span data-ttu-id="c99e9-235">Скопируйте следующий сценарий в текстовый редактор на своем компьютере.</span><span class="sxs-lookup"><span data-stu-id="c99e9-235">Copy the following script to a text editor on your PC.</span></span> <span data-ttu-id="c99e9-236">Замените `<SubscriptionB-id>` идентификатором своей подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-236">Replace `<SubscriptionB-id>` with your subscription Id.</span></span> <span data-ttu-id="c99e9-237">Если вам неизвестен идентификатор подписки, введите команду `az account show`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-237">If you don't know your subscription Id, enter the `az account show` command.</span></span> <span data-ttu-id="c99e9-238">Значение **id** (Идентификатор) в выходных данных является идентификатором вашей подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-238">The value for **id** in the output is your subscription Id.</span></span> <span data-ttu-id="c99e9-239">На шаге 4 платформа Azure создала вашу классическую виртуальную сеть в группе ресурсов *Default-Networking*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-239">Azure created the virtual network (classic) you created in step 4 in a resource group named *Default-Networking*.</span></span> <span data-ttu-id="c99e9-240">Вставьте измененный сценарий в окно сеанса интерфейса командной строки и нажмите клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-240">Paste the modified script in your CLI session, and then press `Enter`.</span></span>

    ```azurecli-interactive
    # Peer VNet1 to VNet2.
    az network vnet peering create \
      --name myVnetAToMyVnetB \
      --resource-group $rgName \
      --vnet-name myVnetA \
      --remote-vnet-id  /subscriptions/<SubscriptionB-id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB \
      --allow-vnet-access
    ```

10. <span data-ttu-id="c99e9-241">После выполнения сценария просмотрите сведения о пиринге виртуальной сети Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c99e9-241">After the script executes, review the peering for the virtual network (Resource Manager).</span></span> <span data-ttu-id="c99e9-242">Скопируйте следующий сценарий и вставьте его в сеанс интерфейса командной строки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-242">Copy the following script, and then paste it in your CLI session:</span></span>

    ```azurecli-interactive
    az network vnet peering list \
      --resource-group $rgName \
      --vnet-name myVnetA \
      --output table
    ```
    <span data-ttu-id="c99e9-243">В выходных данных в столбце **PeeringState** (Состояние пиринга) указано состояние **Connected** (Подключен).</span><span class="sxs-lookup"><span data-stu-id="c99e9-243">The output shows **Connected** in the **PeeringState** column.</span></span>

    <span data-ttu-id="c99e9-244">Теперь все ресурсы Azure, созданные в любой из виртуальных сетей, могут взаимодействовать друг с другом, используя свои IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="c99e9-244">Any Azure resources you create in either virtual network are now able to communicate with each other through their IP addresses.</span></span> <span data-ttu-id="c99e9-245">Если вы используете разрешение имен Azure по умолчанию для виртуальных сетей, то ресурсы в этих виртуальных сетях не смогут разрешать имена между виртуальными сетями.</span><span class="sxs-lookup"><span data-stu-id="c99e9-245">If you're using default Azure name resolution for the virtual networks, the resources in the virtual networks are not able to resolve names across the virtual networks.</span></span> <span data-ttu-id="c99e9-246">Если требуется разрешение имен между виртуальными сетями в пиринге, необходимо создать собственный DNS-сервер.</span><span class="sxs-lookup"><span data-stu-id="c99e9-246">If you want to resolve names across virtual networks in a peering, you must create your own DNS server.</span></span> <span data-ttu-id="c99e9-247">Узнайте, как настроить [разрешение имен с помощью собственного DNS-сервера](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="c99e9-247">Learn how to set up [Name resolution using your own DNS server](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span></span>

11. <span data-ttu-id="c99e9-248">**Необязательно**. Хотя в этом руководстве не рассматривается создание виртуальных машин, можно создать по виртуальной машине в каждой виртуальной сети и подключить их между собой, чтобы проверить связь.</span><span class="sxs-lookup"><span data-stu-id="c99e9-248">**Optional**: Though creating virtual machines is not covered in this tutorial, you can create a virtual machine in each virtual network and connect from one virtual machine to the other, to validate connectivity.</span></span>
12. <span data-ttu-id="c99e9-249">**Необязательно**. Чтобы удалить ресурсы, созданные в этом руководстве, выполните инструкции, описанные в разделе [Удаление ресурсов](#delete-cli) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-249">**Optional**: To delete the resources that you create in this tutorial, complete the steps in [Delete resources](#delete-cli) in this article.</span></span>

## <span data-ttu-id="c99e9-250"><a name="powershell"></a>Создание пиринга с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="c99e9-250"><a name="powershell"></a>Create peering - PowerShell</span></span>

<span data-ttu-id="c99e9-251">В этом руководстве используются разные учетные записи для каждой подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-251">This tutorial uses different accounts for each subscription.</span></span> <span data-ttu-id="c99e9-252">Если вы используете учетную запись, имеющую разрешения для обеих подписок, то можете использовать эту учетную запись для всех действий. Пропустите выход из Azure и удалите строки сценария, назначающие роли пользователей.</span><span class="sxs-lookup"><span data-stu-id="c99e9-252">If you're using an account that has permissions to both subscriptions, you can use the same account for all steps, skip the steps for logging out of Azure, and remove the lines of script that create user role assignments.</span></span> <span data-ttu-id="c99e9-253">Замените UserA@azure.com и UserB@azure.com во всех следующих сценариях именами пользователей, которые вы используете для пользователей A и B.</span><span class="sxs-lookup"><span data-stu-id="c99e9-253">Replace UserA@azure.com and UserB@azure.com in all of the following scripts with the usernames you're using for UserA and UserB.</span></span> 

<span data-ttu-id="c99e9-254">Перед выполнением любого из следующих действий необходимо зарегистрироваться для использования предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-254">Before completing any of the following steps, you must register for the preview.</span></span> <span data-ttu-id="c99e9-255">Чтобы зарегистрироваться, выполните действия в разделе [Регистрация для использования предварительной версии](#register) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-255">To register, complete the steps in the [Register for the preview](#register) section of this article.</span></span> <span data-ttu-id="c99e9-256">Не продолжайте остальные действия, пока обе подписки не будут зарегистрированы для использования предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="c99e9-256">Do not continue with the remaining steps until both subscriptions are registered for the preview.</span></span>

1. <span data-ttu-id="c99e9-257">Установите последние версии модулей PowerShell [Azure](https://www.powershellgallery.com/packages/Azure) и [AzureRm](https://www.powershellgallery.com/packages/AzureRM/).</span><span class="sxs-lookup"><span data-stu-id="c99e9-257">Install the latest version of the PowerShell [Azure](https://www.powershellgallery.com/packages/Azure) and [AzureRm](https://www.powershellgallery.com/packages/AzureRM/) modules.</span></span> <span data-ttu-id="c99e9-258">Если вы еще не работали с Azure PowerShell, ознакомьтесь со статьей [Overview of Azure PowerShell](/powershell/azure/overview?toc=%2fazure%2fvirtual-network%2ftoc.json) (Общие сведения об Azure PowerShell).</span><span class="sxs-lookup"><span data-stu-id="c99e9-258">If you're new to Azure PowerShell, see [Azure PowerShell overview](/powershell/azure/overview?toc=%2fazure%2fvirtual-network%2ftoc.json).</span></span>
2. <span data-ttu-id="c99e9-259">Запустите сеанс PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c99e9-259">Start a PowerShell session.</span></span>
3. <span data-ttu-id="c99e9-260">В PowerShell войдите в подписку пользователя B от имени этого пользователя, введя команду `Add-AzureAccount`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-260">In PowerShell, log in to UserB's subscription as UserB by entering the `Add-AzureAccount` command.</span></span>
4. <span data-ttu-id="c99e9-261">Чтобы создать классическую виртуальную сеть с помощью PowerShell, необходимо создать новый или изменить существующий файл конфигурации сети.</span><span class="sxs-lookup"><span data-stu-id="c99e9-261">To create a virtual network (classic) with PowerShell, you must create a new, or modify an existing, network configuration file.</span></span> <span data-ttu-id="c99e9-262">Узнайте, как [экспортировать, обновлять и импортировать файлы конфигурации сети](virtual-networks-using-network-configuration-file.md).</span><span class="sxs-lookup"><span data-stu-id="c99e9-262">Learn how to [export, update, and import network configuration files](virtual-networks-using-network-configuration-file.md).</span></span> <span data-ttu-id="c99e9-263">Файл должен содержать приведенный ниже элемент **VirtualNetworkSite** для виртуальной сети, используемой в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="c99e9-263">The file should include the following **VirtualNetworkSite** element for the virtual network used in this tutorial:</span></span>

    ```xml
    <VirtualNetworkSite name="myVnetB" Location="East US">
      <AddressSpace>
        <AddressPrefix>10.1.0.0/16</AddressPrefix>
      </AddressSpace>
      <Subnets>
        <Subnet name="default">
          <AddressPrefix>10.1.0.0/24</AddressPrefix>
        </Subnet>
      </Subnets>
    </VirtualNetworkSite>
    ```

    > [!WARNING]
    > <span data-ttu-id="c99e9-264">Импорт измененного файла конфигурации сети может привести к изменениям в классических виртуальных сетях в вашей подписке.</span><span class="sxs-lookup"><span data-stu-id="c99e9-264">Importing a changed network configuration file can cause changes to existing virtual networks (classic) in your subscription.</span></span> <span data-ttu-id="c99e9-265">Убедитесь, что вы добавили только указанную выше виртуальную сеть и не изменили или удалили имеющиеся в своей подписке виртуальные сети.</span><span class="sxs-lookup"><span data-stu-id="c99e9-265">Ensure you only add the previous virtual network and that you don't change or remove any existing virtual networks from your subscription.</span></span> 

5. <span data-ttu-id="c99e9-266">Войдите в подписку пользователя B от имени этого пользователя для выполнения команд Resource Manager, введя команду `login-azurermaccount`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-266">Log in to UserB's subscription as UserB to use Resource Manager commands by entering the `login-azurermaccount` command.</span></span>
6. <span data-ttu-id="c99e9-267">Назначьте разрешения пользователя A виртуальной сети myVnetB. Скопируйте приведенный ниже сценарий в текстовый редактор на своем компьютере и замените `<SubscriptionB-id>` идентификатором подписки B. Если вам неизвестен этот идентификатор подписки, введите команду `Get-AzureRmSubscription`, чтобы просмотреть его.</span><span class="sxs-lookup"><span data-stu-id="c99e9-267">Assign UserA permissions to virtual network B. Copy the following script to a text editor on your PC and replace `<SubscriptionB-id>` with the ID of subscription B. If you don't know the subscription Id, enter the `Get-AzureRmSubscription` command to view it.</span></span> <span data-ttu-id="c99e9-268">Значение **Id** (Идентификатор) в полученных выходных данных является идентификатором вашей подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-268">The value for **Id** in the returned output is your subscription ID.</span></span> <span data-ttu-id="c99e9-269">На шаге 4 платформа Azure создала вашу классическую виртуальную сеть в группе ресурсов *Default-Networking*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-269">Azure created the virtual network (classic) you created in step 4 in a resource group named *Default-Networking*.</span></span> <span data-ttu-id="c99e9-270">Чтобы выполнить сценарий, скопируйте измененный сценарий, вставьте его в окно сеанса PowerShell и нажмите клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-270">To execute the script, copy the modified script, paste it in to PowerShell, and then press `Enter`.</span></span>
    
    ```powershell 
    New-AzureRmRoleAssignment `
      -SignInName UserA@azure.com `
      -RoleDefinitionName "Classic Network Contributor" `
      -Scope /subscriptions/<SubscriptionB-id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB
    ```

7. <span data-ttu-id="c99e9-271">Выйдите из Azure как пользователь B и войдите в подписку пользователя A от имени пользователя A, введя команду `login-azurermaccount`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-271">Log out of Azure as UserB and log in to UserA's subscription as UserA by entering the `login-azurermaccount` command.</span></span> <span data-ttu-id="c99e9-272">У учетной записи, используемой для входа, должны быть необходимые разрешения для создания пиринга виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="c99e9-272">The account you log in with must have the necessary permissions to create a virtual network peering.</span></span> <span data-ttu-id="c99e9-273">Дополнительные сведения см. в разделе [Разрешения](#permissions) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-273">See the [Permissions](#permissions) section of this article for details.</span></span>
8. <span data-ttu-id="c99e9-274">Создайте виртуальную сеть Resource Manager, скопировав следующий сценарий, вставив его PowerShell и нажав клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-274">Create the virtual network (Resource Manager) by copying the following script, pasting it in to PowerShell, and then pressing `Enter`:</span></span>

    ```powershell
    # Variables for common values
      $rgName='MyResourceGroupA'
      $location='eastus'

    # Create a resource group.
    New-AzureRmResourceGroup `
      -Name $rgName `
      -Location $location

    # Create virtual network A.
    $vnetA = New-AzureRmVirtualNetwork `
      -ResourceGroupName $rgName `
      -Name 'myVnetA' `
      -AddressPrefix '10.0.0.0/16' `
      -Location $location
    ```

9. <span data-ttu-id="c99e9-275">Назначьте разрешения пользователя B виртуальной сети myVnetA.</span><span class="sxs-lookup"><span data-stu-id="c99e9-275">Assign UserB permissions to myVnetA.</span></span> <span data-ttu-id="c99e9-276">Скопируйте приведенный ниже сценарий в текстовый редактор на своем компьютере и замените `<SubscriptionA-Id>` идентификатором подписки A. Если вам неизвестен этот идентификатор подписки, введите команду `Get-AzureRmSubscription`, чтобы просмотреть его.</span><span class="sxs-lookup"><span data-stu-id="c99e9-276">Copy the following script to a text editor on your PC and replace `<SubscriptionA-Id>` with the ID of subscription A. If you don't know the subscription Id, enter the `Get-AzureRmSubscription` command to view it.</span></span> <span data-ttu-id="c99e9-277">Значение **Id** (Идентификатор) в полученных выходных данных является идентификатором вашей подписки.</span><span class="sxs-lookup"><span data-stu-id="c99e9-277">The value for **Id** in the returned output is your subscription ID.</span></span> <span data-ttu-id="c99e9-278">Вставьте измененную версию сценарий в окно сеанса PowerShell и нажмите клавишу `Enter`, чтобы выполнить его.</span><span class="sxs-lookup"><span data-stu-id="c99e9-278">Paste the modified version of the script in PowerShell, and then press `Enter` to execute it.</span></span>

    ```powershell
    New-AzureRmRoleAssignment `
      -SignInName UserB@azure.com `
      -RoleDefinitionName "Network Contributor" `
      -Scope /subscriptions/<SubscriptionA-Id>/resourceGroups/myResourceGroupA/providers/Microsoft.Network/VirtualNetworks/myVnetA
    ```

10. <span data-ttu-id="c99e9-279">Скопируйте приведенный ниже сценарий в текстовый редактор на своем компьютере и замените `<SubscriptionB-id>` идентификатором подписки B. Чтобы создать пиринг между myVnetA и myVNetB, скопируйте измененный сценарий, вставьте его в PowerShell и нажмите клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-279">Copy the following script to a text editor on your PC, and replace `<SubscriptionB-id>` with the ID of subscription B. To peer myVnetA to myVNetB, copy the modified script, paste it in to PowerShell, and then press `Enter`.</span></span>

    ```powershell
    Add-AzureRmVirtualNetworkPeering `
      -Name 'myVnetAToMyVnetB' `
      -VirtualNetwork $vnetA `
      -RemoteVirtualNetworkId /subscriptions/<SubscriptionB-id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB
    ```

11. <span data-ttu-id="c99e9-280">Просмотрите состояние пиринга myVnetA, скопировав следующий сценарий в PowerShell и нажав клавишу `Enter`.</span><span class="sxs-lookup"><span data-stu-id="c99e9-280">View the peering state of myVnetA by copying the following script, pasting it into PowerShell, and pressing `Enter`.</span></span>

    ```powershell
    Get-AzureRmVirtualNetworkPeering `
      -ResourceGroupName $rgName `
      -VirtualNetworkName myVnetA `
      | Format-Table VirtualNetworkName, PeeringState
    ```

    <span data-ttu-id="c99e9-281">Отображается состояние **Connected** (Подключено).</span><span class="sxs-lookup"><span data-stu-id="c99e9-281">The state is **Connected**.</span></span> <span data-ttu-id="c99e9-282">Оно принимает значение **Connected** (Подключено) после настройки пиринга из myVnetB к myVnetA.</span><span class="sxs-lookup"><span data-stu-id="c99e9-282">It changes to **Connected** once you setup the peering to myVnetA from myVnetB.</span></span>

    <span data-ttu-id="c99e9-283">Теперь все ресурсы Azure, созданные в любой из виртуальных сетей, могут взаимодействовать друг с другом, используя свои IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="c99e9-283">Any Azure resources you create in either virtual network are now able to communicate with each other through their IP addresses.</span></span> <span data-ttu-id="c99e9-284">Если вы используете разрешение имен Azure по умолчанию для виртуальных сетей, то ресурсы в этих виртуальных сетях не смогут разрешать имена между виртуальными сетями.</span><span class="sxs-lookup"><span data-stu-id="c99e9-284">If you're using default Azure name resolution for the virtual networks, the resources in the virtual networks are not able to resolve names across the virtual networks.</span></span> <span data-ttu-id="c99e9-285">Если требуется разрешение имен между виртуальными сетями в пиринге, необходимо создать собственный DNS-сервер.</span><span class="sxs-lookup"><span data-stu-id="c99e9-285">If you want to resolve names across virtual networks in a peering, you must create your own DNS server.</span></span> <span data-ttu-id="c99e9-286">Узнайте, как настроить [разрешение имен с помощью собственного DNS-сервера](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="c99e9-286">Learn how to set up [Name resolution using your own DNS server](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span></span>

12. <span data-ttu-id="c99e9-287">**Необязательно**. Хотя в этом руководстве не рассматривается создание виртуальных машин, можно создать по виртуальной машине в каждой виртуальной сети и подключить их между собой, чтобы проверить связь.</span><span class="sxs-lookup"><span data-stu-id="c99e9-287">**Optional**: Though creating virtual machines is not covered in this tutorial, you can create a virtual machine in each virtual network and connect from one virtual machine to the other, to validate connectivity.</span></span>
13. <span data-ttu-id="c99e9-288">**Необязательно**. Чтобы удалить ресурсы, созданные в этом руководстве, выполните инструкции, описанные в разделе [Удаление ресурсов](#delete-powershell) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="c99e9-288">**Optional**: To delete the resources that you create in this tutorial, complete the steps in [Delete resources](#delete-powershell) in this article.</span></span>

## <span data-ttu-id="c99e9-289"><a name="permissions"></a>Разрешения</span><span class="sxs-lookup"><span data-stu-id="c99e9-289"><a name="permissions"></a>Permissions</span></span>

<span data-ttu-id="c99e9-290">У учетных записей, используемых для создания пиринга виртуальных сетей, должна быть необходимая роль или разрешения.</span><span class="sxs-lookup"><span data-stu-id="c99e9-290">The accounts you use to create a virtual network peering must have the necessary role or permissions.</span></span> <span data-ttu-id="c99e9-291">Например, при создании пиринга между двумя виртуальными сетями myVnetA и myVnetB вашей учетной записи должны быть назначены следующие минимальные роли или разрешения для каждой виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="c99e9-291">For example, if you were peering two virtual networks named myVnetA and myVnetB, your account must be assigned the following minimum role or permissions for each virtual network:</span></span>
    
|<span data-ttu-id="c99e9-292">Виртуальная сеть</span><span class="sxs-lookup"><span data-stu-id="c99e9-292">Virtual network</span></span>|<span data-ttu-id="c99e9-293">Модель развертывания</span><span class="sxs-lookup"><span data-stu-id="c99e9-293">Deployment model</span></span>|<span data-ttu-id="c99e9-294">Роль</span><span class="sxs-lookup"><span data-stu-id="c99e9-294">Role</span></span>|<span data-ttu-id="c99e9-295">Разрешения</span><span class="sxs-lookup"><span data-stu-id="c99e9-295">Permissions</span></span>|
|---|---|---|---|
|<span data-ttu-id="c99e9-296">myVnetA</span><span class="sxs-lookup"><span data-stu-id="c99e9-296">myVnetA</span></span>|<span data-ttu-id="c99e9-297">Диспетчер ресурсов</span><span class="sxs-lookup"><span data-stu-id="c99e9-297">Resource Manager</span></span>|[<span data-ttu-id="c99e9-298">Участник сети</span><span class="sxs-lookup"><span data-stu-id="c99e9-298">Network Contributor</span></span>](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor)|<span data-ttu-id="c99e9-299">Microsoft.Network/virtualNetworks/virtualNetworkPeerings/write</span><span class="sxs-lookup"><span data-stu-id="c99e9-299">Microsoft.Network/virtualNetworks/virtualNetworkPeerings/write</span></span>|
| |<span data-ttu-id="c99e9-300">Классический</span><span class="sxs-lookup"><span data-stu-id="c99e9-300">Classic</span></span>|[<span data-ttu-id="c99e9-301">Участник классической сети</span><span class="sxs-lookup"><span data-stu-id="c99e9-301">Classic Network Contributor</span></span>](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#classic-network-contributor)|<span data-ttu-id="c99e9-302">Недоступно</span><span class="sxs-lookup"><span data-stu-id="c99e9-302">N/A</span></span>|
|<span data-ttu-id="c99e9-303">myVnetB</span><span class="sxs-lookup"><span data-stu-id="c99e9-303">myVnetB</span></span>|<span data-ttu-id="c99e9-304">Диспетчер ресурсов</span><span class="sxs-lookup"><span data-stu-id="c99e9-304">Resource Manager</span></span>|[<span data-ttu-id="c99e9-305">Участник сети</span><span class="sxs-lookup"><span data-stu-id="c99e9-305">Network Contributor</span></span>](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor)|<span data-ttu-id="c99e9-306">Microsoft.Network/virtualNetworks/peer</span><span class="sxs-lookup"><span data-stu-id="c99e9-306">Microsoft.Network/virtualNetworks/peer</span></span>|
||<span data-ttu-id="c99e9-307">Классический</span><span class="sxs-lookup"><span data-stu-id="c99e9-307">Classic</span></span>|[<span data-ttu-id="c99e9-308">Участник классической сети</span><span class="sxs-lookup"><span data-stu-id="c99e9-308">Classic Network Contributor</span></span>](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#classic-network-contributor)|<span data-ttu-id="c99e9-309">Microsoft.ClassicNetwork/virtualNetworks/peer</span><span class="sxs-lookup"><span data-stu-id="c99e9-309">Microsoft.ClassicNetwork/virtualNetworks/peer</span></span>|

<span data-ttu-id="c99e9-310">Узнайте больше о [встроенных ролях](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor) и назначении разрешений, определенных для [настраиваемых ролей](../active-directory/role-based-access-control-custom-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json) (только для Resource Manager).</span><span class="sxs-lookup"><span data-stu-id="c99e9-310">Learn more about [built-in roles](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor) and assigning specific permissions to [custom roles](../active-directory/role-based-access-control-custom-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json) (Resource Manager only).</span></span>

## <span data-ttu-id="c99e9-311"><a name="delete"></a>Удаление ресурсов</span><span class="sxs-lookup"><span data-stu-id="c99e9-311"><a name="delete"></a>Delete resources</span></span>
<span data-ttu-id="c99e9-312">По завершении работы с этим руководством может потребоваться удалить созданные в его рамках ресурсы, чтобы за их использование не взималась плата.</span><span class="sxs-lookup"><span data-stu-id="c99e9-312">When you've finished this tutorial, you might want to delete the resources you created in the tutorial, so you don't incur usage charges.</span></span> <span data-ttu-id="c99e9-313">При удалении группы ресурсов будут также удалены все ресурсы, содержащиеся в ней.</span><span class="sxs-lookup"><span data-stu-id="c99e9-313">Deleting a resource group also deletes all resources that are in the resource group.</span></span>

### <span data-ttu-id="c99e9-314"><a name="delete-portal"></a>Портал Azure</span><span class="sxs-lookup"><span data-stu-id="c99e9-314"><a name="delete-portal"></a>Azure portal</span></span>

1. <span data-ttu-id="c99e9-315">В поле поиска на портале введите **myResourceGroupA**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-315">In the portal search box, enter **myResourceGroupA**.</span></span> <span data-ttu-id="c99e9-316">В результатах поиска щелкните **myResourceGroupA**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-316">In the search results, click **myResourceGroupA**.</span></span>
2. <span data-ttu-id="c99e9-317">В колонке **myResourceGroupA** щелкните значок **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-317">On the **myResourceGroupA** blade, click the **Delete** icon.</span></span>
3. <span data-ttu-id="c99e9-318">Чтобы подтвердить удаление, введите **myResourceGroupA** в поле **Введите имя группы ресурсов**, а затем щелкните **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-318">To confirm the deletion, in the **TYPE THE RESOURCE GROUP NAME** box, enter **myResourceGroupA**, and then click **Delete**.</span></span>
4. <span data-ttu-id="c99e9-319">В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetB*.</span><span class="sxs-lookup"><span data-stu-id="c99e9-319">In the **Search resources** box at the top of the portal, type *myVnetB*.</span></span> <span data-ttu-id="c99e9-320">Когда сеть **myVnetB** появится в результатах поиска, щелкните ее.</span><span class="sxs-lookup"><span data-stu-id="c99e9-320">Click **myVnetB** when it appears in the search results.</span></span> <span data-ttu-id="c99e9-321">Отобразится колонка для виртуальной сети **myVnetB**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-321">A blade appears for the **myVnetB** virtual network.</span></span>
5. <span data-ttu-id="c99e9-322">В колонке **myVnetB** щелкните **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="c99e9-322">In the **myVnetB** blade, click **Delete**.</span></span>
6. <span data-ttu-id="c99e9-323">В окне **Удалить виртуальную сеть** нажмите кнопку **Да**, чтобы подтвердить удаление.</span><span class="sxs-lookup"><span data-stu-id="c99e9-323">To confirm the deletion, click **Yes** in the **Delete virtual network** box.</span></span>

### <span data-ttu-id="c99e9-324"><a name="delete-cli"></a>Интерфейс командной строки Azure</span><span class="sxs-lookup"><span data-stu-id="c99e9-324"><a name="delete-cli"></a>Azure CLI</span></span>

1. <span data-ttu-id="c99e9-325">Войдите в Azure с помощью Azure CLI 2.0, чтобы удалить виртуальную сеть Resource Manager с помощью приведенной ниже команды.</span><span class="sxs-lookup"><span data-stu-id="c99e9-325">Log in to Azure using the CLI 2.0 to delete the virtual network (Resource Manager) with the following command:</span></span>

    ```azurecli-interactive
    az group delete --name myResourceGroupA --yes
    ```

2. <span data-ttu-id="c99e9-326">Войдите в Azure с помощью Azure CLI 1.0, чтобы удалить классическую виртуальную сеть с помощью приведенных ниже команд.</span><span class="sxs-lookup"><span data-stu-id="c99e9-326">Log in to Azure using the Azure CLI 1.0 to delete the virtual network (classic) with the following commands:</span></span>

    ```azurecli
    azure config mode asm 

    azure network vnet delete --vnet myVnetB --quiet
    ```

### <span data-ttu-id="c99e9-327"><a name="delete-powershell"></a>PowerShell</span><span class="sxs-lookup"><span data-stu-id="c99e9-327"><a name="delete-powershell"></a>PowerShell</span></span>

1. <span data-ttu-id="c99e9-328">В командной строке PowerShell введите приведенную ниже команду, чтобы удалить виртуальную сеть Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c99e9-328">At the PowerShell command prompt, enter the following command to delete the virtual network (Resource Manager):</span></span>

    ```powershell
    Remove-AzureRmResourceGroup -Name myResourceGroupA -Force
    ```

2. <span data-ttu-id="c99e9-329">Чтобы удалить классическую виртуальную сеть с помощью PowerShell, необходимо изменить существующий файл конфигурации сети.</span><span class="sxs-lookup"><span data-stu-id="c99e9-329">To delete the virtual network (classic) with PowerShell, you must modify an existing network configuration file.</span></span> <span data-ttu-id="c99e9-330">Узнайте, как [экспортировать, обновлять и импортировать файлы конфигурации сети](virtual-networks-using-network-configuration-file.md).</span><span class="sxs-lookup"><span data-stu-id="c99e9-330">Learn how to [export, update, and import network configuration files](virtual-networks-using-network-configuration-file.md).</span></span> <span data-ttu-id="c99e9-331">Удалите приведенный ниже элемент VirtualNetworkSite для виртуальной сети, используемой в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="c99e9-331">Remove the following VirtualNetworkSite element for the virtual network used in this tutorial:</span></span>

    ```xml
    <VirtualNetworkSite name="myVnetB" Location="East US">
      <AddressSpace>
        <AddressPrefix>10.1.0.0/16</AddressPrefix>
      </AddressSpace>
      <Subnets>
        <Subnet name="default">
          <AddressPrefix>10.1.0.0/24</AddressPrefix>
        </Subnet>
      </Subnets>
    </VirtualNetworkSite>
    ```

    > [!WARNING]
    > <span data-ttu-id="c99e9-332">Импорт измененного файла конфигурации сети может привести к изменениям в классических виртуальных сетях в вашей подписке.</span><span class="sxs-lookup"><span data-stu-id="c99e9-332">Importing a changed network configuration file can cause changes to existing virtual networks (classic) in your subscription.</span></span> <span data-ttu-id="c99e9-333">Убедитесь, что вы удалили только указанную выше виртуальную сеть и не изменили или удалили другие виртуальные сети в своей подписке.</span><span class="sxs-lookup"><span data-stu-id="c99e9-333">Ensure you only remove the previous virtual network and that you don't change or remove any other existing virtual networks from your subscription.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="c99e9-334">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c99e9-334">Next steps</span></span>

- <span data-ttu-id="c99e9-335">Внимательно ознакомьтесь с важными [ограничениями и особенностями работы пиринга виртуальных сетей](virtual-network-manage-peering.md#requirements-and-constraints), прежде чем создавать пиринг виртуальных сетей для рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="c99e9-335">Thoroughly familiarize yourself with important [virtual network peering constraints and behaviors](virtual-network-manage-peering.md#requirements-and-constraints) before creating a virtual network peering for production use.</span></span>
- <span data-ttu-id="c99e9-336">Узнайте о [параметрах пиринга виртуальных сетей](virtual-network-manage-peering.md#create-a-peering).</span><span class="sxs-lookup"><span data-stu-id="c99e9-336">Learn about all [virtual network peering settings](virtual-network-manage-peering.md#create-a-peering).</span></span>
- <span data-ttu-id="c99e9-337">Узнайте, как [создать звездообразную топологию сети](/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?toc=%2fazure%2fvirtual-network%2ftoc.json#vnet-peering) с помощью пиринга виртуальных сетей.</span><span class="sxs-lookup"><span data-stu-id="c99e9-337">Learn how to [create a hub and spoke network topology](/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?toc=%2fazure%2fvirtual-network%2ftoc.json#vnet-peering) with virtual network peering.</span></span>