---
title: "Добавление или удаление сетевых интерфейсов виртуальных машин Azure | Документация Майкрософт"
description: "Узнайте, как добавлять и удалять сетевые интерфейсы виртуальных машин."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-network
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/25/2017
ms.author: jdial
ms.openlocfilehash: 57f95b765b1b116814683a6643db16091c3041f6
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="add-network-interfaces-to-or-remove-from-virtual-machines"></a>Добавление или удаление сетевых интерфейсов виртуальных машин

Узнайте, как добавить имеющейся сетевой интерфейс при создании виртуальной машины, а также как добавить или удалить сетевые интерфейсы имеющейся виртуальной машины, которая остановлена (освобождена). Сетевой интерфейс позволяет виртуальной машине Azure взаимодействовать с Интернетом, Azure и локальными ресурсами. У виртуальной машины может быть один или несколько сетевых интерфейсов. 

При необходимости см. инструкции по [добавлению, изменению и удалению IP-адресов для сетевых интерфейсов Azure](virtual-network-network-interface-addresses.md). Чтобы создать, изменить или удалить сетевые интерфейсы, ознакомьтесь со статьей [Создание, изменение или удаление сетевых интерфейсов](virtual-network-network-interface.md).

## <a name="before"></a>Перед началом работы

Перед выполнением действий, описанных в любом разделе этой статьи, выполните следующие задачи.

- Чтобы узнать, сколько сетевых интерфейсов поддерживает каждый из размеров виртуальных машин Linux и Windows, прочитайте статьи [Размеры виртуальных машин Linux в Azure](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Размеры виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json).
- Войдите на [портал](https://portal.azure.com) Azure, в интерфейс командной строки Azure (CLI) или Azure PowerShell с использованием учетной записи Azure. Если у вас нет учетной записи Azure, зарегистрируйтесь для получения [бесплатной пробной учетной записи](https://azure.microsoft.com/free).
- Чтобы использовать команды PowerShell для выполнения задач в этой статье, [установите и настройте Azure PowerShell](/powershell/azureps-cmdlets-docs?toc=%2fazure%2fvirtual-network%2ftoc.json). Убедитесь, что у вас установлена самая последняя версия командлетов Azure PowerShell. Для получения справки по командам PowerShell с примерами введите `get-help <command> -full`.
- Чтобы использовать команды интерфейса командной строки Azure (Azure CLI) для выполнения задач в этой статье, [установите и настройте Azure CLI](/cli/azure/install-azure-cli?toc=%2fazure%2fvirtual-network%2ftoc.json). Убедитесь, что у вас установлена самая последняя версия Azure CLI. Для получения справки по командам интерфейса командной строки введите `az <command> --help`. Вы можете не устанавливать интерфейс командной строки и его зависимости, а воспользоваться Azure Cloud Shell. Azure Cloud Shell — это бесплатная оболочка Bash, которую можно запускать непосредственно на портале Azure. Она включает предварительно установленный интерфейс Azure CLI и настроена для использования с вашей учетной записью. Чтобы использовать Cloud Shell, нажмите кнопку **>_** в верхней части [портала](https://portal.azure.com).

## <a name="about"></a>О сетевых интерфейсах и виртуальных машинах

Можно добавить (подключить) имеющийся сетевой интерфейс в виртуальную машину при создании этой виртуальной машины, если этот сетевой интерфейс не подключен к другой виртуальной машине. Сетевой интерфейс можно добавить в имеющуюся виртуальную машину или удалить из нее (отключить), если эта виртуальная машина остановлена (освобождена). При создании виртуальной машины с помощью портала Azure автоматически создается сетевой интерфейс с параметрами по умолчанию. На портале невозможно сделать следующее:

- Указать имеющийся сетевой интерфейс для добавления при создании виртуальной машины.
- Создание виртуальной машины с несколькими сетевыми интерфейсами
- Указать имя сетевого интерфейса (портал создает его с именем по умолчанию).

Чтобы создать сетевой интерфейс или виртуальную машину с атрибутами, указанными выше, для которых нельзя использовать портал, можно применить Azure PowerShell или интерфейс командной строки. Прежде чем приступить к выполнению задач в следующих разделах, обратите внимание на следующие ограничения и поведение.

- Все размеры виртуальной машины поддерживают по крайней мере два сетевых интерфейса, но некоторые размеры поддерживают более двух сетевых интерфейсов. В прошлом некоторые размеры виртуальной машины поддерживали только один сетевой интерфейс. Чтобы узнать, сколько сетевых интерфейсов поддерживается каждым из размеров виртуальной машины, ознакомьтесь со статьями [Размеры виртуальных машин Linux в Azure](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Размеры виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). 
- В прошлом сетевые интерфейсы можно было добавлять только к виртуальным машинам, которые поддерживали несколько сетевых интерфейсов и были созданы с по крайней мере двумя сетевыми интерфейсами. Сетевой интерфейс невозможно было добавить к виртуальной машине, которая была создана с одним сетевым интерфейсом, даже если размер виртуальной машины поддерживал несколько сетевых интерфейсов. И наоборот, сетевые интерфейсы можно было удалять только из виртуальной машины по крайней мере с тремя сетевыми интерфейсами, так как виртуальные машины, созданные по крайней мере с двумя сетевыми интерфейсами, всегда должны были иметь по крайней мере два сетевых интерфейса. Ни одно из этих ограничений больше не действует. Теперь можно создать виртуальную машину с любым количеством сетевых интерфейсов (не превышающим поддерживаемое размером виртуальной машины), а затем добавлять и удалять любое количество сетевых интерфейсов (для этого виртуальные машины должны быть остановлены (освобождены)), но так, чтобы виртуальная машина всегда имела по крайней мере один сетевой интерфейс.
- По умолчанию первый сетевой интерфейс в виртуальной машине определяется в качестве *основного*. Все остальные сетевые интерфейсы в виртуальной машине считаются *дополнительными*.
- Основным сетевым интерфейсам DHCP-серверами Azure назначается шлюз по умолчанию, а дополнительным — не назначается. Так как дополнительным сетевым интерфейсам не назначается шлюз по умолчанию, по умолчанию они не могут обмениваться данными с ресурсами вне своей подсети. Чтобы разрешить дополнительным сетевым интерфейсам виртуальной машины Windows обмениваться данными с ресурсами за пределами своей подсети, добавьте в операционную систему необходимые маршруты, выполнив команду `route add` в командной строке Windows. Так как для виртуальных машин Linux по умолчанию используется слабая модель маршрутизации узлов, мы советуем ограничивать трафик дополнительных сетевых интерфейсов одной подсетью. Если для дополнительных сетевых интерфейсов требуется подключение вне подсети, включите маршрутизацию на основе политик, чтобы для входящего и исходящего трафика использовался один сетевой интерфейс.
- По умолчанию весь исходящий трафик виртуальной машины отправляется с IP-адреса, назначенного основной IP-конфигурации основного сетевого интерфейса. Вы можете контролировать IP-адрес, используемый для отправки исходящего трафика в операционной системе виртуальной машины, но по умолчанию этот трафик проходит через основной сетевой интерфейс.
- В прошлом все виртуальные машины в одной группе доступности должны были иметь один или несколько сетевых интерфейсов. Теперь в одной группе доступности могут находиться виртуальные машины с любым количеством сетевых интерфейсов (в пределах количества, поддерживаемого размером виртуальной машины). Виртуальную машину можно добавить в группу доступности только при ее создании. Чтобы узнать больше о группах доступности, прочитайте статью [Управление доступностью виртуальных машин Windows в Azure](../virtual-machines/windows/manage-availability.md?toc=%2fazure%2fvirtual-network%2ftoc.json#configure-multiple-virtual-machines-in-an-availability-set-for-redundancy).
- Хотя сетевые интерфейсы, подключенные к одной виртуальной машине, можно подключить к разным подсетям в виртуальной сети, все они должны быть подключены к одной виртуальной сети.
- Вы можете добавить любой IP-адрес для любой IP-конфигурации любого основного или дополнительного сетевого интерфейса во внутренний Azure Load Balancer. Раньше во внутренний пул можно было добавить только основной IP-адрес для основного сетевого интерфейса. Чтобы узнать больше об IP-адресах и IP-конфигурациях, прочитайте статью [Добавление, изменение и удаление IP-адресов для сетевых интерфейсов Azure](virtual-network-network-interface-addresses.md).
- При удалении виртуальной машины подключенные к ней сетевые интерфейсы не удаляются. Когда виртуальная машина удаляется, сетевые интерфейсы отключаются от нее. Вы можете добавить эти сетевые интерфейсы в другие виртуальные машины или удалить их.
- Если сетевому интерфейсу назначен частный адрес IPv6, вы сможете подключить его к виртуальной машине только при ее создании. Подключить сетевой интерфейс, которому назначен адрес IPv6, к уже созданной виртуальной машине нельзя. Если вы подключите к создаваемой виртуальной машине сетевой интерфейс с частным адресом IPv6, к такой виртуальной машине нельзя будет подключить другие сетевые интерфейсы, даже если размер виртуальной машины это позволяет. См. дополнительные сведения о [назначении IP-адресов для сетевых интерфейсов](virtual-network-network-interface-addresses.md).

## <a name="vm-create"></a>Добавление имеющихся сетевых интерфейсов к новой виртуальной машине

При создании виртуальной машины с помощью портала автоматически создается сетевой интерфейс с параметрами по умолчанию, который подключается к виртуальной машине. На портале Azure невозможно добавить имеющиеся сетевые интерфейсы в новую виртуальную машину или создать виртуальную машину с несколькими сетевыми интерфейсами. Это можно сделать с помощью интерфейса командной строки или PowerShell. В виртуальную машину можно добавить любое количество сетевых интерфейсов, поддерживаемое размером создаваемой виртуальной машины. Дополнительные сведения об определении числа сетевых интерфейсов, поддерживаемых каждым из размеров виртуальной машины, см. в статьях [Размеры виртуальных машин Linux в Azure](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Размеры виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). Сейчас сетевые интерфейсы, добавляемые в виртуальную машину, невозможно подключить к другой виртуальной машине. Дополнительные сведения о создании сетевых интерфейсов см. в разделе [Создание сетевой карты](virtual-network-network-interface.md#create-a-network-interface).

> [!WARNING]
> Если сетевому интерфейсу назначен частный адрес IPv6, вы сможете подключить этот сетевой интерфейс к виртуальной машине только при ее создании. К виртуальной машине, к которой подключен сетевой интерфейс с назначенным адресом IPv6, можно добавить только один сетевой интерфейс при создании этой виртуальной машины или после ее создания. См. дополнительные сведения о [назначении IP-адресов для сетевых интерфейсов](virtual-network-network-interface-addresses.md).

**Команды**

|Средство|Команда|
|---|---|
|Интерфейс командной строки|[az vm create](/cli/azure/vm?toc=%2fazure%2fvirtual-network%2ftoc.json#create)|
|PowerShell|[New-AzureRmVM](/powershell/module/azurerm.compute/new-azurermvm?toc=%2fazure%2fvirtual-network%2ftoc.json)|

## <a name="vm-add-nic"></a>Добавление имеющегося сетевого интерфейса к имеющейся виртуальной машине

В виртуальную машину можно добавить столько сетевых интерфейсов, сколько поддерживает ее размер. Чтобы узнать, сколько сетевых интерфейсов поддерживается каждым из размеров виртуальной машины, ознакомьтесь со статьями [Размеры виртуальных машин Linux в Azure](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Размеры виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). Виртуальная машина, к которой будет добавлен сетевой интерфейс, должна поддерживать достаточное число сетевых интерфейсов и должна в этот момент быть остановлена (освобождена). Сейчас сетевые интерфейсы, добавляемые в одну виртуальную машину, невозможно подключить к другой виртуальной машине. Невозможно добавить сетевые интерфейсы в имеющуюся виртуальную машину с помощью портала Azure. Чтобы добавить сетевые интерфейсы к существующей виртуальной машине, используйте интерфейс командной строки или PowerShell. 

> [!WARNING]
> Если сетевому интерфейсу назначен частный адрес IPv6, его нельзя добавить к существующей виртуальной машине. Сетевой интерфейс с частным адресом IPv6 можно добавить к виртуальной машине только при ее создании. См. дополнительные сведения о [назначении IP-адресов для сетевых интерфейсов](virtual-network-network-interface-addresses.md).

|Средство|Команда|
|---|---|
|Интерфейс командной строки|az vm nic add — см. [раздел руководства](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#add) или [подробные инструкции](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#add-a-nic-to-a-vm)|
|PowerShell|Add-AzureRmVMNetworkInterface — см. [раздел руководства](/powershell/module/azurerm.compute/add-azurermvmnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json) или [подробные инструкции](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#add-a-nic-to-an-existing-vm)|

## <a name="vm-view-nic"></a> Просмотр сетевых интерфейсов для виртуальной машины

Вы можете просмотреть сетевые интерфейсы, подключенные к виртуальной машине, чтобы изучить конфигурацию каждого из них, а также назначенные им IP-адреса. 

1. Войдите на [портал Azure](https://portal.azure.com) с помощью учетной записи, которой назначены роли "Владелец", "Участник" или "Участник сети" для подписки. Дополнительные сведения о назначении ролей учетным записям см. в статье [Встроенные роли для управления доступом на основе ролей в Azure](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor).
2. В верхней части портала Azure в поле с текстом *Поиск ресурсов* введите *виртуальные машины*. Когда **виртуальные машины** появятся в результатах поиска, щелкните их.
3. В появившейся колонке **Виртуальные машины** щелкните имя виртуальной машины, для которой следует просмотреть сетевые интерфейсы.
4. В разделе **Параметры** колонки "Виртуальная машина", которая отобразилась для выбранной виртуальной машины, щелкните **Сетевые интерфейсы**. Дополнительную информацию о параметрах сетевого интерфейса и сведения об их изменении см. в статье [Создание, изменение или удаление сетевых интерфейсов](virtual-network-network-interface.md). См. дополнительные сведения о [добавлении, изменении и удалении IP-адресов, назначенных сетевому интерфейсу](virtual-network-network-interface-addresses.md).

**Команды**

|Средство|Команда|
|---|---|
|Интерфейс командной строки|[az vm show](/cli/azure/vm?toc=%2fazure%2fvirtual-network%2ftoc.json#show)|
|PowerShell|[Get-AzureRmVM](/powershell/module/azurerm.compute/get-azurermvm?toc=%2fazure%2fvirtual-network%2ftoc.json)|

## <a name="vm-remove-nic"></a> Удаление сетевого интерфейса из виртуальной машины

Виртуальная машина, в которой следует удалить (или отключить) сетевой интерфейс, должна быть остановлена (освобождена), и к ней должны быть подключены по крайней мере два сетевых интерфейса. Вы можете удалить любой сетевой интерфейс, но к виртуальной машине всегда должен быть подключен по крайней мере один сетевой интерфейс. При удалении основного сетевого интерфейса Azure назначает основным сетевой интерфейс, который был подключен к виртуальной машине дольше всего. 

1. Войдите на [портал Azure](https://portal.azure.com) с помощью учетной записи, которой назначены роли "Владелец", "Участник" или "Участник сети" для подписки. Дополнительные сведения о назначении ролей учетным записям см. в статье [Встроенные роли для управления доступом на основе ролей в Azure](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor).
2. В верхней части портала Azure в поле с текстом *Поиск ресурсов* введите *виртуальные машины*. Когда **виртуальные машины** появятся в результатах поиска, щелкните их.
3. В появившейся колонке **Виртуальные машины** щелкните имя виртуальной машины, из которой следует удалить сетевой интерфейс.
4. В разделе **Параметры** колонки "Виртуальная машина", которая отобразилась для выбранной виртуальной машины, щелкните **Сетевые интерфейсы**. Дополнительную информацию о параметрах сетевого интерфейса и сведения об их изменении см. в статье [Создание, изменение или удаление сетевых интерфейсов](virtual-network-network-interface.md). См. дополнительные сведения о [добавлении, изменении и удалении IP-адресов, назначенных сетевому интерфейсу](virtual-network-network-interface-addresses.md).
5. В появившейся колонке "Сетевые интерфейсы" щелкните значок **…** справа от имени сетевого интерфейса, который нужно отключить.
6. Щелкните **Отключить**. Если к виртуальной машине подключен только один сетевой интерфейс, параметр **Отключить** недоступен. Щелкните **Да** в появившемся окне подтверждения.

**Команды**

|Средство|Команда|
|---|---|
|Интерфейс командной строки|az vm nic remove — см. [раздел руководства](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#remove) или [подробные инструкции](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#remove-a-nic-from-a-vm)|
|PowerShell|Remove-AzureRmVMNetworkInterface — см. [раздел руководства](/powershell/module/azurerm.compute/remove-azurermvmnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json) или [подробные инструкции](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#remove-a-nic-from-an-existing-vm)|

## <a name="next-steps"></a>Дальнейшие действия
Чтобы создать виртуальную машину с несколькими сетевыми интерфейсами или IP-адресами, прочитайте приведенные ниже статьи.

**Команды**

|Задача|Средство|
|---|---|
|Создание виртуальной машины с несколькими сетевыми адаптерами|[Интерфейс командной строки](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json), [PowerShell](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json)|
|Создание виртуальной машины с одним сетевым адаптером, которому назначено несколько IPv4-адресов|[Интерфейс командной строки](virtual-network-multiple-ip-addresses-cli.md), [PowerShell](virtual-network-multiple-ip-addresses-powershell.md)|
|Создание виртуальной машины с одним сетевым адаптером, которому назначен частный IPv6-адрес (обслуживаемый Azure Load Balancer).|[Интерфейс командной строки](../load-balancer/load-balancer-ipv6-internet-cli.md?toc=%2fazure%2fvirtual-network%2ftoc.json), [PowerShell](../load-balancer/load-balancer-ipv6-internet-ps.md?toc=%2fazure%2fvirtual-network%2ftoc.json), [шаблон Azure Resource Manager](../load-balancer/load-balancer-ipv6-internet-template.md?toc=%2fazure%2fvirtual-network%2ftoc.json)|
