---
title: "aaaHost несколько сайтов со шлюзом приложения Azure | Документы Microsoft"
description: "Эта страница предоставляет инструкции tooconfigure существующего шлюза приложения Azure для размещения нескольких веб-приложений на hello одного шлюза с портала Azure hello."
documentationcenter: na
services: application-gateway
author: georgewallace
manager: timlt
editor: tysonn
ms.assetid: 95f892f6-fa27-47ee-b980-7abf4f2c66a9
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/23/2017
ms.author: gwallace
ms.openlocfilehash: 2172aa2c80720f6f1ab7dd91745b44654bcaee00
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="configure-an-existing-application-gateway-for-hosting-multiple-web-applications"></a>Настройка шлюза приложений для размещения нескольких веб-приложений

> [!div class="op_single_selector"]
> * [Портал Azure](application-gateway-create-multisite-portal.md)
> * [PowerShell и диспетчер ресурсов Azure](application-gateway-create-multisite-azureresourcemanager-powershell.md)
> 
> 

Размещение нескольких сайтов позволяет toodeploy более одного веб-приложения на hello же шлюз приложений. Он основывается на присутствие заголовка узла в hello входящего запроса HTTP, toodetermine прослушивателя, который будет получать трафик. затем Hello прослушиватель направляет трафик tooappropriate внутреннего пула, настроенным в определение правил hello hello шлюза. В веб-приложениях включен протокол SSL шлюз приложений зависит от hello Указание имени сервера (SNI) расширения toochoose hello правильный прослушивателя для hello веб-трафика. Обычно используются для размещения нескольких сайтов — tooload балансировать нагрузку по запросам для другом доменах toodifferent серверных пулов. Аналогичным образом несколько поддомены одного корневого домена также может быть размещена на приветствия hello же шлюз приложений.

## <a name="scenario"></a>Сценарий

В следующем примере hello, шлюз приложений обслуживает трафик для contoso.com и fabrikam.com с помощью двух серверных пулов: contoso пул серверов и fabrikam пул серверов. Аналогичную программу установки может быть поддомены toohost используется как app.contoso.com и blog.contoso.com.

![сценарий с несколькими сайтами][multisite]

## <a name="before-you-begin"></a>Перед началом работы

Этот сценарий добавляет поддержку нескольких сайтов tooan существующего приложения шлюза. toocomplete этот сценарий существующего шлюза приложения должен доступных tooconfigure toobe. Посетите [создать шлюз приложений с помощью портала hello](application-gateway-create-gateway-portal.md) toolearn как toocreate шлюз простого приложения hello портала.

представлены шаги hello нужен шлюз приложения hello tooupdate Hello:

1. Создание пулов серверной части toouse для каждого сайта.
2. Создание прослушивателя для каждого сайта, который поддерживает шлюз приложений.
3. Создайте правила toomap каждый прослушиватель с hello соответствующие серверной части.

## <a name="requirements"></a>Требования

* **Пул серверных:** hello список IP-адресов серверов hello серверной части. Hello IP-адресов либо должен принадлежать подсети виртуальной сети toohello или должен быть открытый IP-адрес или VIP. Можно также использовать полное доменное имя.
* **Параметры внутреннего пула серверов**. Каждый пул имеет такие параметры, как порт, протокол и сходство на основе файлов cookie. Эти параметры являются связанные tooa пул, а также примененные tooall серверы в пуле hello.
* **Интерфейсный порт:** этой цели используется порт hello открытый порт, который открыт в шлюзе приложения hello. Трафик обращений к этому порту, а затем возвращает перенаправляется tooone серверов hello серверной части.
* **Прослушиватель:** hello прослушиватель имеет интерфейсный порт, протокол (Http или Https, эти значения зависят от регистра) и имя сертификата SSL hello (при настройке протокола SSL разгрузки). Для шлюзов приложений с поддержкой нескольких сайтов также добавляются имя узла и индикаторы SNI.
* **Правило:** правило hello привязывает hello прослушивателя, пул серверных hello и определяет, какие серверных пула hello трафику следует применять направленной toowhen попадании конкретного прослушивателя. Правила обрабатываются в порядке hello, в котором они перечислены, а трафик будет направляться через hello первое подходящее правило вне зависимости от точности. Например при наличии правила с помощью базовых прослушивателя и правила с помощью прослушивателя несколькими сайтами обоих на hello же порт, правило hello с прослушивателя hello нескольких сайтов, необходимо указать перед hello правило с прослушивателем basic hello в порядке для hello toofunction правило нескольких сайтов, как ожидается. 
* **Сертификаты:** каждый прослушиватель должен иметь уникальный сертификат. В этом примере мы создаем 2 прослушивателя для поддержки нескольких сайтов. Два сертификаты PFX-файл и hello пароли для них должны toobe создан.

## <a name="create-back-end-pools-for-each-site"></a>Создание пулов серверной части для каждого узла

Требуется отдельный внутренний пул для каждого сайта, который поддерживает шлюз приложений. В данном случае создаются 2 пула: один для contoso11.com и второй для fabrikam11.com.

### <a name="step-1"></a>Шаг 1

Перейдите tooan существующего шлюза приложения в hello портал Azure (https://portal.azure.com). Выберите **Пулы серверной части** и нажмите кнопку **Добавить**

![Добавление пулов серверной части][7]

### <a name="step-2"></a>Шаг 2

Заполните сведения hello hello серверной части пула **pool1**, добавление hello IP-адресов или полных доменных имен для hello внутренних серверах и нажмите кнопку **ОК**

![Параметры пула серверной части pool1][8]

### <a name="step-3"></a>Шаг 3.

В колонке внутренние пулы hello щелкните **добавить** tooadd пул дополнительных серверной части **pool2**, добавление hello IP-адресов или полных доменных ИМЕН для hello внутренних серверах и нажмите кнопку **ОК**

![Параметры пула серверной части pool2][9]

## <a name="create-listeners-for-each-back-end"></a>Создание прослушивателей для каждой серверной части

Шлюз приложений использует протокол HTTP 1.1 toohost заголовки узлов более одного веб-сайта на hello же общедоступный IP-адрес и порт. создан в портале hello базовый прослушиватель Hello не содержит это свойство.

### <a name="step-1"></a>Шаг 1

Нажмите кнопку **прослушиватели** hello существующего шлюза приложения и нажмите кнопку **многосайтовой** tooadd hello первого прослушивателя.

![Колонка обзора прослушивателей][1]

### <a name="step-2"></a>Шаг 2

Заполните сведения hello hello прослушивателя. В этом примере мы настраиваем оконечную точку SSL, поэтому создайте внешний порт. Отправьте сертификат toobe hello PFX-файл, используемый для завершения запросов SSL. Hello в этой колонке стандартный базовый прослушиватель toohello колонке сравнивается отличается только имя узла hello.

![Колонка свойств прослушивателя][2]

### <a name="step-3"></a>Шаг 3.

Нажмите кнопку **многосайтовой** и создать другой прослушиватель, как описано в hello предыдущий шаг для hello второй узел. Убедитесь в том toouse разные сертификаты для второй прослушивателя hello. Hello в этой колонке стандартный базовый прослушиватель toohello колонке сравнивается отличается только имя узла hello. Введите сведения о hello для прослушивателя hello и нажмите кнопку **ОК**.

![Колонка свойств прослушивателя][3]

> [!NOTE]
> Создание прослушивателей в Azure портал для шлюза приложения hello — длительные задачи, займет некоторое время toocreate hello двух прослушивателей в этом сценарии. При прослушиватели завершения hello отображаться портале hello в hello после изображения:

![Обзор прослушивателей][4]

## <a name="create-rules-toomap-listeners-toobackend-pools"></a>Создание правила toomap прослушиватели toobackend пулов

### <a name="step-1"></a>Шаг 1

Перейдите tooan существующего шлюза приложения в hello портал Azure (https://portal.azure.com). Выберите **правила** и выберите существующее правило по умолчанию hello **правило 1** и нажмите кнопку **изменить**.

### <a name="step-2"></a>Шаг 2

Заполните колонке правила hello в hello после изображения. Выбор первого прослушивателя hello и первого пула и нажав кнопку **Сохранить** завершении выполнения.

![Изменение существующего правила][6]

### <a name="step-3"></a>Шаг 3.

Нажмите кнопку **основное правило** toocreate hello второе правило. Заполните форму hello с hello второй прослушивателя и второй внутренний пул и нажмите кнопку **ОК** toosave.

![Колонка добавления базового правила][10]

Этот сценарий завершения настройки шлюза существующие приложения с поддержкой нескольких сайтов через портал Azure hello.

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как tooprotect веб-сайты с [шлюз приложений - брандмауэр веб-приложения](application-gateway-webapplicationfirewall-overview.md)

<!--Image references-->
[1]: ./media/application-gateway-create-multisite-portal/figure1.png
[2]: ./media/application-gateway-create-multisite-portal/figure2.png
[3]: ./media/application-gateway-create-multisite-portal/figure3.png
[4]: ./media/application-gateway-create-multisite-portal/figure4.png
[5]: ./media/application-gateway-create-multisite-portal/figure5.png
[6]: ./media/application-gateway-create-multisite-portal/figure6.png
[7]: ./media/application-gateway-create-multisite-portal/figure7.png
[8]: ./media/application-gateway-create-multisite-portal/figure8.png
[9]: ./media/application-gateway-create-multisite-portal/figure9.png
[10]: ./media/application-gateway-create-multisite-portal/figure10.png
[multisite]: ./media/application-gateway-create-multisite-portal/multisite.png
