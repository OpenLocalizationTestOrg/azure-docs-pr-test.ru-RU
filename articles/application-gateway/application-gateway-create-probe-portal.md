---
title: "aaaCreate пользовательской проверки - шлюз Azure приложения - портал Azure | Документы Microsoft"
description: "Узнайте, как toocreate пользовательской проверки для шлюза приложения с помощью портала hello"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 33fd5564-43a7-4c54-a9ec-b1235f661f97
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/26/2017
ms.author: gwallace
ms.openlocfilehash: 9e9309045ef33ba1010868783949b4fde31619ec
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="create-a-custom-probe-for-application-gateway-by-using-hello-portal"></a><span data-ttu-id="3bcbe-103">Создать пользовательский зонд для шлюза приложения с помощью портала hello</span><span class="sxs-lookup"><span data-stu-id="3bcbe-103">Create a custom probe for Application Gateway by using hello portal</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="3bcbe-104">Портал Azure</span><span class="sxs-lookup"><span data-stu-id="3bcbe-104">Azure portal</span></span>](application-gateway-create-probe-portal.md)
> * [<span data-ttu-id="3bcbe-105">PowerShell и диспетчер ресурсов Azure</span><span class="sxs-lookup"><span data-stu-id="3bcbe-105">Azure Resource Manager PowerShell</span></span>](application-gateway-create-probe-ps.md)
> * [<span data-ttu-id="3bcbe-106">Классическая модель — Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="3bcbe-106">Azure Classic PowerShell</span></span>](application-gateway-create-probe-classic-ps.md)

<span data-ttu-id="3bcbe-107">В этой статье добавьте пользовательский зонд tooan существующий шлюз приложений через портал Azure hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-107">In this article, you add a custom probe tooan existing application gateway through hello Azure portal.</span></span> <span data-ttu-id="3bcbe-108">Пользовательские зонды полезны для приложений, имеющих страницы проверки работоспособности конкретного или для приложений, которые не предоставляют успешный ответ на веб-приложения по умолчанию hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-108">Custom probes are useful for applications that have a specific health check page or for applications that do not provide a successful response on hello default web application.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="3bcbe-109">Перед началом работы</span><span class="sxs-lookup"><span data-stu-id="3bcbe-109">Before you begin</span></span>

<span data-ttu-id="3bcbe-110">Если вы не сделали этого шлюза приложения, посетите [создания шлюза приложения](application-gateway-create-gateway-portal.md) toocreate toowork шлюза приложения с.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-110">If you do not already have an application gateway, visit [Create an Application Gateway](application-gateway-create-gateway-portal.md) toocreate an application gateway toowork with.</span></span>

## <span data-ttu-id="3bcbe-111"><a name="createprobe"></a>Создать пробу hello</span><span class="sxs-lookup"><span data-stu-id="3bcbe-111"><a name="createprobe"></a>Create hello probe</span></span>

<span data-ttu-id="3bcbe-112">Зонды настраиваются в два этапа через портал hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-112">Probes are configured in a two-step process through hello portal.</span></span> <span data-ttu-id="3bcbe-113">Hello первым шагом является проверка toocreate hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-113">hello first step is toocreate hello probe.</span></span> <span data-ttu-id="3bcbe-114">Hello втором шаге добавьте параметров hello пробы toohello серверного http шлюза приложения hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-114">In hello second step, you add hello probe toohello backend http settings of hello application gateway.</span></span>

1. <span data-ttu-id="3bcbe-115">Войдите в toohello [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="3bcbe-115">Log in toohello [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="3bcbe-116">Если у вас нет учетной записи, вы можете зарегистрироваться для получения [бесплатной пробной версии на один месяц](https://azure.microsoft.com/free).</span><span class="sxs-lookup"><span data-stu-id="3bcbe-116">If you don't already have an account, you can sign up for a [free one-month trial](https://azure.microsoft.com/free)</span></span>

1. <span data-ttu-id="3bcbe-117">В hello портал Azure область "Избранное" выберите все ресурсы.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-117">In hello Azure portal Favorites pane, click All resources.</span></span> <span data-ttu-id="3bcbe-118">Выберите шлюз приложения hello в hello колонке все ресурсы.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-118">Click hello application gateway in hello All resources blade.</span></span> <span data-ttu-id="3bcbe-119">Если подписка hello уже содержит несколько ресурсов, можно ввести partners.contoso.net в hello фильтр по имени...</span><span class="sxs-lookup"><span data-stu-id="3bcbe-119">If hello subscription you selected already has several resources in it, you can enter partners.contoso.net in hello Filter by name…</span></span> <span data-ttu-id="3bcbe-120">шлюз приложения hello доступа tooeasily поле.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-120">box tooeasily access hello application gateway.</span></span>

1. <span data-ttu-id="3bcbe-121">Нажмите кнопку **проверяет** и нажмите кнопку hello **добавить** tooadd кнопку зонда.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-121">Click **Probes** and click hello **Add** button tooadd a probe.</span></span>

  ![Колонка добавления пробы с заполненной информацией][1]

1. <span data-ttu-id="3bcbe-123">На hello **проверки работоспособности добавить** колонки, заполните hello необходимые сведения для проверки hello и по завершении нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-123">On hello **Add health probe** blade, fill out hello required information for hello probe, and when complete click **OK**.</span></span>

  |<span data-ttu-id="3bcbe-124">**Параметр**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-124">**Setting**</span></span> | <span data-ttu-id="3bcbe-125">**Значение**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-125">**Value**</span></span> | <span data-ttu-id="3bcbe-126">**Дополнительные сведения**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-126">**Details**</span></span>|
  |---|---|---|
  |<span data-ttu-id="3bcbe-127">**Имя**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-127">**Name**</span></span>|<span data-ttu-id="3bcbe-128">customProbe</span><span class="sxs-lookup"><span data-stu-id="3bcbe-128">customProbe</span></span>|<span data-ttu-id="3bcbe-129">Это значение является зонда toohello понятное имя, доступной на портале hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-129">This value is a friendly name toohello probe that is accessible in hello portal.</span></span>|
  |<span data-ttu-id="3bcbe-130">**Протокол**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-130">**Protocol**</span></span>|<span data-ttu-id="3bcbe-131">HTTP или HTTPS</span><span class="sxs-lookup"><span data-stu-id="3bcbe-131">HTTP or HTTPS</span></span> | <span data-ttu-id="3bcbe-132">использует протокол Hello, hello проверки работоспособности.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-132">hello protocol that hello health probe uses.</span></span>|
  |<span data-ttu-id="3bcbe-133">**Host**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-133">**Host**</span></span>|<span data-ttu-id="3bcbe-134">Например,</span><span class="sxs-lookup"><span data-stu-id="3bcbe-134">i.e</span></span> <span data-ttu-id="3bcbe-135">contoso.com</span><span class="sxs-lookup"><span data-stu-id="3bcbe-135">contoso.com</span></span>|<span data-ttu-id="3bcbe-136">Это значение является hello имя узла, который используется для проверки hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-136">This value is hello host name that is used for hello probe.</span></span> <span data-ttu-id="3bcbe-137">Применяется только в случае, когда в шлюзе приложений настроено многосайтовое подключение. В противном случае используется значение 127.0.0.1.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-137">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="3bcbe-138">Это значение отличается от hello имя узла виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-138">This value is different from hello VM host name.</span></span>|
  |<span data-ttu-id="3bcbe-139">**Путь**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-139">**Path**</span></span>|<span data-ttu-id="3bcbe-140">/ или другой путь</span><span class="sxs-lookup"><span data-stu-id="3bcbe-140">/ or another path</span></span>|<span data-ttu-id="3bcbe-141">Hello оставшуюся часть hello полный URL-адрес для проверки пользовательских hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-141">hello remainder of hello full url for hello custom probe.</span></span> <span data-ttu-id="3bcbe-142">Путь должен начинаться с /.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-142">A valid path starts with '/'.</span></span> <span data-ttu-id="3bcbe-143">Путь по умолчанию hello http://contoso.com просто используйте «/»</span><span class="sxs-lookup"><span data-stu-id="3bcbe-143">For hello default path of http://contoso.com just use '/'</span></span> |
  |<span data-ttu-id="3bcbe-144">**Интервал (с)**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-144">**Interval (secs)**</span></span>|<span data-ttu-id="3bcbe-145">30</span><span class="sxs-lookup"><span data-stu-id="3bcbe-145">30</span></span>|<span data-ttu-id="3bcbe-146">Как часто hello проверки выполняется toocheck для работоспособности.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-146">How often hello probe is run toocheck for health.</span></span> <span data-ttu-id="3bcbe-147">Не рекомендуется tooset hello меньше 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-147">It is not recommended tooset hello lower than 30 seconds.</span></span>|
  |<span data-ttu-id="3bcbe-148">**Время ожидания (с)**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-148">**Timeout (secs)**</span></span>|<span data-ttu-id="3bcbe-149">30</span><span class="sxs-lookup"><span data-stu-id="3bcbe-149">30</span></span>|<span data-ttu-id="3bcbe-150">объем Hello hello проверки времени ожидания до истечения времени ожидания. доступен Hello время ожидания интервал потребностей toobe достаточно велико, что вызов http можно сделать tooensure hello внутреннего состояния страницы.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-150">hello amount of time hello probe waits before timing out. hello timeout interval needs toobe high enough that an http call can be made tooensure hello backend health page is available.</span></span>|
  |<span data-ttu-id="3bcbe-151">**Пороговое значение сбоя**</span><span class="sxs-lookup"><span data-stu-id="3bcbe-151">**Unhealthy threshold**</span></span>|<span data-ttu-id="3bcbe-152">3</span><span class="sxs-lookup"><span data-stu-id="3bcbe-152">3</span></span>|<span data-ttu-id="3bcbe-153">Число неудачных попыток toobe считаться неработоспособным.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-153">Number of failed attempts toobe considered unhealthy.</span></span> <span data-ttu-id="3bcbe-154">Пороговое значение 0 означает, что при сбое проверки работоспособности hello серверной части определяется неработоспособное немедленно.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-154">A threshold of 0 means that if a health check fails hello back-end is determined unhealthy immediately.</span></span>|

  > [!IMPORTANT]
  > <span data-ttu-id="3bcbe-155">Имя узла Hello hello не совпадает с именем сервера.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-155">hello host name is not hello same as server name.</span></span> <span data-ttu-id="3bcbe-156">Это значение является именем hello hello виртуального узла на сервере приложения hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-156">This value is hello name of hello virtual host running on hello application server.</span></span> <span data-ttu-id="3bcbe-157">зонд Hello отправляется toohttp: / /(host name):(port from httpsetting)/urlPath</span><span class="sxs-lookup"><span data-stu-id="3bcbe-157">hello probe is sent toohttp://(host name):(port from httpsetting)/urlPath</span></span>

## <a name="add-probe-toohello-gateway"></a><span data-ttu-id="3bcbe-158">Добавление проверки toohello шлюза</span><span class="sxs-lookup"><span data-stu-id="3bcbe-158">Add probe toohello gateway</span></span>

<span data-ttu-id="3bcbe-159">Hello проверки будет создана, представляет время tooadd его toohello шлюза.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-159">Now that hello probe has been created, it is time tooadd it toohello gateway.</span></span> <span data-ttu-id="3bcbe-160">Параметры выборки, задаются на параметров серверного http hello шлюза приложения hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-160">Probe settings are set on hello backend http settings of hello application gateway.</span></span>

1. <span data-ttu-id="3bcbe-161">Нажмите кнопку **параметры HTTP** шлюзе приложения hello, toobring вверх колонке конфигурации hello щелкните hello текущие серверной части http параметры перечислены в окне приветствия.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-161">Click **HTTP settings** on hello application gateway, toobring up hello configuration blade click hello current backend http settings listed in hello window.</span></span>

  ![Окно параметров HTTPS][2]

1. <span data-ttu-id="3bcbe-163">На hello **appGatewayBackEndHttpSettings** колонку параметров, проверка hello **используйте пользовательский зонд** флажок и выбрать hello пробы, созданные в hello [пробы hello создать](#createprobe) раздела на hello **пользовательский зонд** раскрывающийся список...</span><span class="sxs-lookup"><span data-stu-id="3bcbe-163">On hello **appGatewayBackEndHttpSettings** settings blade, check hello **Use custom probe** checkbox and choose hello probe created in hello [Create hello probe](#createprobe) section on hello **Custom probe** drop-down..</span></span>
<span data-ttu-id="3bcbe-164">По завершении нажмите кнопку **Сохранить** и применяются параметры hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-164">When complete, click **Save** and hello settings are applied.</span></span>

<span data-ttu-id="3bcbe-165">проба по умолчанию Hello проверяет hello по умолчанию доступ toohello веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-165">hello default probe checks hello default access toohello web application.</span></span> <span data-ttu-id="3bcbe-166">После создания пользовательский зонд шлюз приложения hello использует работоспособности toomonitor пользовательский путь, определенный hello для внутренних серверов hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-166">Now that a custom probe has been created, hello application gateway uses hello custom path defined toomonitor health for hello backend servers.</span></span> <span data-ttu-id="3bcbe-167">На основе hello критериев, был определен, шлюз приложения hello проверяет hello пути, указанному в пробы hello.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-167">Based on hello criteria that was defined, hello application gateway checks hello path specified in hello probe.</span></span> <span data-ttu-id="3bcbe-168">Если hello вызовите toohost:Port / path не возвращает HTTP 200 399 состояние ответа, hello server берется из ротации после hello неработоспособности порога.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-168">If hello call toohost:Port/path does not return an HTTP 200-399 status response, hello server is taken out of rotation after hello unhealthy threshold is reached.</span></span> <span data-ttu-id="3bcbe-169">Проверка продолжается на toodetermine hello неработоспособное экземпляр после его восстановления работоспособности.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-169">Probing continues on hello unhealthy instance toodetermine when it becomes healthy again.</span></span> <span data-ttu-id="3bcbe-170">После добавления пула серверов задней toohealthy экземпляр hello трафик начинает попытку передачи tooit и проверки toohello экземпляр продолжает указанным интервалом пользователя обычным образом.</span><span class="sxs-lookup"><span data-stu-id="3bcbe-170">Once hello instance is added back toohealthy server pool, traffic begins flowing tooit again and probing toohello instance continues at user specified interval as normal.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3bcbe-171">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="3bcbe-171">Next steps</span></span>

<span data-ttu-id="3bcbe-172">toolearn tooconfigure разгрузки SSL со шлюзом приложения Azure, в статье [Настройка разгрузки SSL](application-gateway-ssl-portal.md)</span><span class="sxs-lookup"><span data-stu-id="3bcbe-172">toolearn how tooconfigure SSL Offloading with Azure Application Gateway, see [Configure SSL Offload](application-gateway-ssl-portal.md)</span></span>

[1]: ./media/application-gateway-create-probe-portal/figure1.png
[2]: ./media/application-gateway-create-probe-portal/figure2.png

