---
title: "Обзор монитора для шлюза приложения Azure aaaHealth | Документы Microsoft"
description: "Дополнительные сведения о hello мониторингу в Azure использование шлюза приложений"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7eeba328-bb2d-4d3e-bdac-7552e7900b7f
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/14/2016
ms.author: gwallace
ms.openlocfilehash: 5091d80394a354ff849ce7ccee8cc9d2fd0456db
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="application-gateway-health-monitoring-overview"></a><span data-ttu-id="0776a-103">Обзор мониторинга работоспособности шлюза приложений</span><span class="sxs-lookup"><span data-stu-id="0776a-103">Application Gateway health monitoring overview</span></span>

<span data-ttu-id="0776a-104">Шлюз приложения Azure по умолчанию отслеживает работоспособность hello все ресурсы в своем внутреннем пуле и автоматически удаляет любой ресурс, считаются неисправное из пула hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-104">Azure Application Gateway by default monitors hello health of all resources in its back-end pool and automatically removes any resource considered unhealthy from hello pool.</span></span> <span data-ttu-id="0776a-105">Шлюз приложений по-прежнему неисправных экземпляров toomonitor hello и добавляет их обратно toohello работоспособности пула серверной части, как только они станут доступны и отвечают toohealth зонды.</span><span class="sxs-lookup"><span data-stu-id="0776a-105">Application Gateway continues toomonitor hello unhealthy instances and adds them back toohello healthy back-end pool once they become available and respond toohealth probes.</span></span> <span data-ttu-id="0776a-106">Шлюз приложений отправляет hello зонды работоспособности с hello порт, который определен в параметрах HTTP hello серверной части.</span><span class="sxs-lookup"><span data-stu-id="0776a-106">Application gateway sends hello health probes with hello same port that is defined in hello back-end HTTP settings.</span></span> <span data-ttu-id="0776a-107">Эта конфигурация гарантирует, что этот зонд hello тестирует же порт, что пользователи будут с серверной toohello tooconnect hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-107">This configuration ensures that hello probe is testing hello same port that customers would be using tooconnect toohello backend.</span></span>

![пример проверки работоспособности шлюза приложений][1]

<span data-ttu-id="0776a-109">В дополнение toousing по умолчанию проверки наблюдение за работоспособностью, можно также настроить toosuit проверки работоспособности hello требования вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="0776a-109">In addition toousing default health probe monitoring, you can also customize hello health probe toosuit your application's requirements.</span></span> <span data-ttu-id="0776a-110">В этой статье рассматривается как проверка работоспособности по умолчанию, так и пользовательская проверка работоспособности.</span><span class="sxs-lookup"><span data-stu-id="0776a-110">In this article, both default and custom health probes are covered.</span></span>

> [!NOTE]
> <span data-ttu-id="0776a-111">Если имеется NSG подсеть шлюза приложения, диапазоны портов 65503 65534 должен быть открыт в подсети шлюза приложения hello для входящего трафика.</span><span class="sxs-lookup"><span data-stu-id="0776a-111">If there is an NSG on Application Gateway subnet, port ranges 65503-65534 should be opened on hello Application Gateway subnet for Inbound traffic.</span></span> <span data-ttu-id="0776a-112">Эти порты являются обязательными для toowork API работоспособности внутренних hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-112">These ports are required for hello backend health API toowork.</span></span>

## <a name="default-health-probe"></a><span data-ttu-id="0776a-113">Проверка работоспособности по умолчанию</span><span class="sxs-lookup"><span data-stu-id="0776a-113">Default health probe</span></span>

<span data-ttu-id="0776a-114">Если ни одной из пользовательских проверок работоспособности не настроено, шлюз приложений автоматически настраивает проверку работоспособности по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0776a-114">An application gateway automatically configures a default health probe when you don't set up any custom probe configuration.</span></span> <span data-ttu-id="0776a-115">мониторинг поведения Hello работает эффективное адресов IP-адрес HTTP запроса toohello настроен для пула hello серверной части.</span><span class="sxs-lookup"><span data-stu-id="0776a-115">hello monitoring behavior works by making an HTTP request toohello IP addresses configured for hello back-end pool.</span></span> <span data-ttu-id="0776a-116">Если параметров серверного http hello настроены для протокола HTTPS, hello пробы для проверки по умолчанию использует протокол HTTPS как хорошо tootest работоспособности серверных системах hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-116">For default probes if hello backend http settings are configured for HTTPS, hello probe uses HTTPS as well tootest health of hello backends.</span></span>

<span data-ttu-id="0776a-117">Например: Настройка приложения шлюза toouse серверы A, B и C tooreceive HTTP сетевого трафика через порт 80.</span><span class="sxs-lookup"><span data-stu-id="0776a-117">For example: You configure your application gateway toouse back-end servers A, B, and C tooreceive HTTP network traffic on port 80.</span></span> <span data-ttu-id="0776a-118">Наблюдение за работоспособностью по умолчанию Hello проверяет три сервера hello каждые 30 секунд для работоспособное HTTP-ответа.</span><span class="sxs-lookup"><span data-stu-id="0776a-118">hello default health monitoring tests hello three servers every 30 seconds for a healthy HTTP response.</span></span> <span data-ttu-id="0776a-119">HTTP-ответ, подтверждающий работоспособность, имеет [код состояния](https://msdn.microsoft.com/library/aa287675.aspx) от 200 до 399.</span><span class="sxs-lookup"><span data-stu-id="0776a-119">A healthy HTTP response has a [status code](https://msdn.microsoft.com/library/aa287675.aspx) between 200 and 399.</span></span>

<span data-ttu-id="0776a-120">Если произошел сбой проверки выборки по умолчанию hello сервер A, шлюз приложения hello удаляет его из пула серверной части и сетевой трафик перестает поступать toothis сервера.</span><span class="sxs-lookup"><span data-stu-id="0776a-120">If hello default probe check fails for server A, hello application gateway removes it from its back-end pool, and network traffic stops flowing toothis server.</span></span> <span data-ttu-id="0776a-121">проба по умолчанию Hello по-прежнему продолжает toocheck для сервера каждые 30 секунд.</span><span class="sxs-lookup"><span data-stu-id="0776a-121">hello default probe still continues toocheck for server A every 30 seconds.</span></span> <span data-ttu-id="0776a-122">Когда сервер A успешно отвечает tooone запроса из зонда работоспособности по умолчанию, он добавляется обратно как работоспособное toohello серверной части пула и передаче toohello сервер снова начинает трафика.</span><span class="sxs-lookup"><span data-stu-id="0776a-122">When server A responds successfully tooone request from a default health probe, it is added back as healthy toohello back-end pool, and traffic starts flowing toohello server again.</span></span>

### <a name="default-health-probe-settings"></a><span data-ttu-id="0776a-123">Параметры проверки работоспособности по умолчанию</span><span class="sxs-lookup"><span data-stu-id="0776a-123">Default health probe settings</span></span>

| <span data-ttu-id="0776a-124">Свойства проверки</span><span class="sxs-lookup"><span data-stu-id="0776a-124">Probe property</span></span> | <span data-ttu-id="0776a-125">Значение</span><span class="sxs-lookup"><span data-stu-id="0776a-125">Value</span></span> | <span data-ttu-id="0776a-126">Описание</span><span class="sxs-lookup"><span data-stu-id="0776a-126">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0776a-127">URL-адрес проверки</span><span class="sxs-lookup"><span data-stu-id="0776a-127">Probe URL</span></span> |<span data-ttu-id="0776a-128">http://127.0.0.1:\<порт\>/</span><span class="sxs-lookup"><span data-stu-id="0776a-128">http://127.0.0.1:\<port\>/</span></span> |<span data-ttu-id="0776a-129">URL-адрес</span><span class="sxs-lookup"><span data-stu-id="0776a-129">URL path</span></span> |
| <span data-ttu-id="0776a-130">Интервал</span><span class="sxs-lookup"><span data-stu-id="0776a-130">Interval</span></span> |<span data-ttu-id="0776a-131">30</span><span class="sxs-lookup"><span data-stu-id="0776a-131">30</span></span> |<span data-ttu-id="0776a-132">Интервал проверки в секундах</span><span class="sxs-lookup"><span data-stu-id="0776a-132">Probe interval in seconds</span></span> |
| <span data-ttu-id="0776a-133">Время ожидания</span><span class="sxs-lookup"><span data-stu-id="0776a-133">Time-out</span></span> |<span data-ttu-id="0776a-134">30</span><span class="sxs-lookup"><span data-stu-id="0776a-134">30</span></span> |<span data-ttu-id="0776a-135">Время ожидания проверки в секундах</span><span class="sxs-lookup"><span data-stu-id="0776a-135">Probe time-out in seconds</span></span> |
| <span data-ttu-id="0776a-136">Пороговое значение сбоя</span><span class="sxs-lookup"><span data-stu-id="0776a-136">Unhealthy threshold</span></span> |<span data-ttu-id="0776a-137">3</span><span class="sxs-lookup"><span data-stu-id="0776a-137">3</span></span> |<span data-ttu-id="0776a-138">Количество повторных попыток проверки.</span><span class="sxs-lookup"><span data-stu-id="0776a-138">Probe retry count.</span></span> <span data-ttu-id="0776a-139">Hello внутренний сервер помечен после количество сбоев проверки последовательных hello достигает неработоспособности порога hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-139">hello back-end server is marked down after hello consecutive probe failure count reaches hello unhealthy threshold.</span></span> |

> [!NOTE]
> <span data-ttu-id="0776a-140">Hello порт является hello же порту, как параметры HTTP hello серверной части.</span><span class="sxs-lookup"><span data-stu-id="0776a-140">hello port is hello same port as hello back-end HTTP settings.</span></span>

<span data-ttu-id="0776a-141">проба по умолчанию Hello рассматривает только http://127.0.0.1:\<порт\> toodetermine состояние работоспособности.</span><span class="sxs-lookup"><span data-stu-id="0776a-141">hello default probe looks only at http://127.0.0.1:\<port\> toodetermine health status.</span></span> <span data-ttu-id="0776a-142">При необходимости tooconfigure hello работоспособности проверки toogo tooa пользовательский URL-адрес или при необходимости измените другие параметры, необходимо использовать пользовательский зондов, как описано в hello следующие шаги:</span><span class="sxs-lookup"><span data-stu-id="0776a-142">If you need tooconfigure hello health probe toogo tooa custom URL or modify any other settings, you must use custom probes as described in hello following steps:</span></span>

## <a name="custom-health-probe"></a><span data-ttu-id="0776a-143">Пользовательская проверка работоспособности</span><span class="sxs-lookup"><span data-stu-id="0776a-143">Custom health probe</span></span>

<span data-ttu-id="0776a-144">Пользовательские зонды разрешить toohave более детальный контроль над наблюдение за работоспособностью hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-144">Custom probes allow you toohave a more granular control over hello health monitoring.</span></span> <span data-ttu-id="0776a-145">При использовании пользовательских зондов, можно настроить интервал отправки проб hello, hello tootest URL-адреса и пути и сколько неудачных откликов tooaccept прежде чем помечать hello внутреннем пуле экземпляр неработоспособен.</span><span class="sxs-lookup"><span data-stu-id="0776a-145">When using custom probes, you can configure hello probe interval, hello URL and path tootest, and how many failed responses tooaccept before marking hello back-end pool instance as unhealthy.</span></span>

### <a name="custom-health-probe-settings"></a><span data-ttu-id="0776a-146">Параметры пользовательской проверки работоспособности</span><span class="sxs-lookup"><span data-stu-id="0776a-146">Custom health probe settings</span></span>

<span data-ttu-id="0776a-147">Hello следующей таблице представлены определения для hello зонда работоспособности пользовательских свойств.</span><span class="sxs-lookup"><span data-stu-id="0776a-147">hello following table provides definitions for hello properties of a custom health probe.</span></span>

| <span data-ttu-id="0776a-148">Свойства проверки</span><span class="sxs-lookup"><span data-stu-id="0776a-148">Probe property</span></span> | <span data-ttu-id="0776a-149">Описание</span><span class="sxs-lookup"><span data-stu-id="0776a-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="0776a-150">Имя</span><span class="sxs-lookup"><span data-stu-id="0776a-150">Name</span></span> |<span data-ttu-id="0776a-151">Имя пробы hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-151">Name of hello probe.</span></span> <span data-ttu-id="0776a-152">Это имя уже используется toorefer toohello проверки в серверной части параметров HTTP.</span><span class="sxs-lookup"><span data-stu-id="0776a-152">This name is used toorefer toohello probe in back-end HTTP settings.</span></span> |
| <span data-ttu-id="0776a-153">Протокол</span><span class="sxs-lookup"><span data-stu-id="0776a-153">Protocol</span></span> |<span data-ttu-id="0776a-154">Использовать протокол проверки toosend hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-154">Protocol used toosend hello probe.</span></span> <span data-ttu-id="0776a-155">зонд Hello использует протокол hello, заданного в настройках HTTP hello серверной части</span><span class="sxs-lookup"><span data-stu-id="0776a-155">hello probe uses hello protocol defined in hello back-end HTTP settings</span></span> |
| <span data-ttu-id="0776a-156">Узел</span><span class="sxs-lookup"><span data-stu-id="0776a-156">Host</span></span> |<span data-ttu-id="0776a-157">Зонд hello toosend имя узла.</span><span class="sxs-lookup"><span data-stu-id="0776a-157">Host name toosend hello probe.</span></span> <span data-ttu-id="0776a-158">Применяется только в случае, когда в шлюзе приложений настроено многосайтовое подключение. В противном случае используется значение 127.0.0.1.</span><span class="sxs-lookup"><span data-stu-id="0776a-158">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="0776a-159">Это значение отличается от имени узла виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="0776a-159">This value is different from VM host name.</span></span> |
| <span data-ttu-id="0776a-160">Путь</span><span class="sxs-lookup"><span data-stu-id="0776a-160">Path</span></span> |<span data-ttu-id="0776a-161">Относительный путь проверки hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-161">Relative path of hello probe.</span></span> <span data-ttu-id="0776a-162">Hello допустимый путь начинается с «/».</span><span class="sxs-lookup"><span data-stu-id="0776a-162">hello valid path starts from '/'.</span></span> |
| <span data-ttu-id="0776a-163">Интервал</span><span class="sxs-lookup"><span data-stu-id="0776a-163">Interval</span></span> |<span data-ttu-id="0776a-164">Интервал проверки в секундах.</span><span class="sxs-lookup"><span data-stu-id="0776a-164">Probe interval in seconds.</span></span> <span data-ttu-id="0776a-165">Это значение является hello временной интервал между двумя последовательными зонды.</span><span class="sxs-lookup"><span data-stu-id="0776a-165">This value is hello time interval between two consecutive probes.</span></span> |
| <span data-ttu-id="0776a-166">Время ожидания</span><span class="sxs-lookup"><span data-stu-id="0776a-166">Time-out</span></span> |<span data-ttu-id="0776a-167">Время ожидания проверки в секундах.</span><span class="sxs-lookup"><span data-stu-id="0776a-167">Probe time-out in seconds.</span></span> <span data-ttu-id="0776a-168">Если допустимый ответ не получен в течение этого времени ожидания, пробы hello отмечен как непройденный.</span><span class="sxs-lookup"><span data-stu-id="0776a-168">If a valid response is not received within this time-out period, hello probe is marked as failed.</span></span>  |
| <span data-ttu-id="0776a-169">Пороговое значение сбоя</span><span class="sxs-lookup"><span data-stu-id="0776a-169">Unhealthy threshold</span></span> |<span data-ttu-id="0776a-170">Количество повторных попыток проверки.</span><span class="sxs-lookup"><span data-stu-id="0776a-170">Probe retry count.</span></span> <span data-ttu-id="0776a-171">Hello внутренний сервер помечен после количество сбоев проверки последовательных hello достигает неработоспособности порога hello.</span><span class="sxs-lookup"><span data-stu-id="0776a-171">hello back-end server is marked down after hello consecutive probe failure count reaches hello unhealthy threshold.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="0776a-172">Если шлюз приложение настраивается для одного узла, по умолчанию hello узла имя должно указываться как "127.0.0.1», если в противном случае настроена в пользовательский зонд.</span><span class="sxs-lookup"><span data-stu-id="0776a-172">If Application Gateway is configured for a single site, by default hello Host name should be specified as '127.0.0.1', unless otherwise configured in custom probe.</span></span>
> <span data-ttu-id="0776a-173">Для ссылки на пользовательский зонд отправляется слишком\<протокола\>://\<узла\>:\<порт\>\<путь\>.</span><span class="sxs-lookup"><span data-stu-id="0776a-173">For reference a custom probe is sent too\<protocol\>://\<host\>:\<port\>\<path\>.</span></span> <span data-ttu-id="0776a-174">Hello порт, используемый будет hello тот же порт, как определено в параметры HTTP hello серверной части.</span><span class="sxs-lookup"><span data-stu-id="0776a-174">hello port used will be hello same port as defined in hello back-end HTTP settings.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0776a-175">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="0776a-175">Next steps</span></span>
<span data-ttu-id="0776a-176">После изучения наблюдение за работоспособностью шлюза приложения, вы можете настроить [проверки работоспособности пользовательских](application-gateway-create-probe-portal.md) в hello портал Azure или [проверки работоспособности пользовательских](application-gateway-create-probe-ps.md) с помощью PowerShell и диспетчера ресурсов Azure hello модель развертывания.</span><span class="sxs-lookup"><span data-stu-id="0776a-176">After learning about Application Gateway health monitoring, you can configure a [custom health probe](application-gateway-create-probe-portal.md) in hello Azure portal or a [custom health probe](application-gateway-create-probe-ps.md) using PowerShell and hello Azure Resource Manager deployment model.</span></span>

[1]: ./media/application-gateway-probe-overview/appgatewayprobe.png
