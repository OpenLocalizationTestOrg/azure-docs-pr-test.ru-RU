---
title: "Основные понятия, терминология и иерархия сущностей планировщика | Документация Майкрософт"
description: "Основные понятия, терминология и иерархия сущностей планировщика, включая задания и коллекции заданий.  Подробный пример запланированного задания."
services: scheduler
documentationcenter: .NET
author: derek1ee
manager: kevinlam1
editor: 
ms.assetid: 3ef16fab-d18a-48ba-8e56-3f3e0a1bcb92
ms.service: scheduler
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: get-started-article
ms.date: 08/18/2016
ms.author: deli
ms.openlocfilehash: 0f035b58ccd140a5481703df7e184206da2ed651
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="scheduler-concepts-terminology--entity-hierarchy"></a>Основные понятия, терминология и иерархия сущностей планировщика
## <a name="scheduler-entity-hierarchy"></a>Иерархия сущностей планировщика
В приведенной ниже таблице описаны основные ресурсы, которые предоставляет или использует API планировщика.

| Ресурс | Description (Описание) |
| --- | --- |
| **Коллекция заданий** |Коллекция заданий содержит группу заданий, а также параметры, квоты и регулирования, которые являются общими для заданий в этой коллекции. Коллекция заданий создается владельцем подписки и объединяет задания по областям использования или границам приложений. Коллекция ограничивается одним регионом. Позволяет также применять квоты (MaxJobs и MaxRecurrence) для ограничения использования всех входящих в коллекцию заданий. |
| **Задание.** |Задание определяет одно повторяющееся действие с простой или сложной стратегией выполнения. К действиям относятся HTTP-запросы, запросы к очереди хранилища, запросы к очереди служебной шины и запросы к разделу служебной шины. |
| **Журнал заданий** |Журнал заданий содержит подробные сведения о выполнении заданий. В нем указывается, было ли задание выполнено, а также все данные ответов. |

## <a name="scheduler-entity-management"></a>Управление сущностями планировщика
На высоком уровне планировщик и API управления службами позволяют выполнять с ресурсами следующие операции.

| Функция | Описание и URI-адрес |
| --- | --- |
| **Управление коллекциями заданий** |Поддержка запросов GET, PUT и DELETE для создания и изменения коллекций и содержащихся в них заданий. Коллекция заданий — это контейнер для заданий, который сопоставляется с квотами и общими настройками. В качестве примеров квот (которые подробно описаны ниже) можно привести максимальное число заданий и наименьший интервал повторения. <p>PUT и DELETE: `https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Scheduler/jobCollections/{jobCollectionName}`</p><p>GET: `https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Scheduler/jobCollections/{jobCollectionName}`</p> |
| **Управление заданиями** |Поддержка запросов GET, PUT, POST, PATCH и DELETE для создания и изменения облачных заданий. Все задания должны входить в уже существующую коллекцию, поэтому имплицитное создание коллекций не предусмотрено. <p>`https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Scheduler/jobCollections/{jobCollectionName}/jobs/{jobName}`</p> |
| **Управление журналами заданий** |Поддержка запроса GET для извлечения журнала заданий за последние 60 дней с указанием времени и результатов выполнения. Добавляет поддержку строкового параметра запроса для фильтрации результатов по состоянию и статусу. <P>`https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Scheduler/jobCollections/{jobCollectionName}/jobs/{jobName}/history`</p> |

## <a name="job-types"></a>Типы заданий
Существует несколько типов заданий: задания HTTP (включая задания HTTPS, поддерживающие протокол SSL), задания очереди хранилища, задания очереди служебной шины и задания раздела служебной шины. Задания HTTP применяются, если у вас есть конечная точка существующей рабочей нагрузки или службы. С помощью заданий очереди хранилища сообщения можно помещать в очереди хранилища, а значит, подходят для рабочих нагрузок, использующих очереди хранилища. Аналогичным образом задания служебной шины идеально подходят для рабочих нагрузок, использующих очереди и разделы служебной шины.

## <a name="the-job-entity-in-detail"></a>Сущность задания в деталях
На базовом уровне запланированное задание состоит из нескольких частей.

* Действие, выполняемое при срабатывании таймера задания.  
* (Необязательно.) Время выполнения задания.  
* (Необязательно.) Время и периодичность повторного выполнения.  
* (Необязательно.) Действие, выполняемое в случае невыполнения первичного действия.  

На внутреннем уровне запланированное задание содержит также системные данные, такие как следующее запланированное время выполнения.

В следующем коде приведен подробный пример запланированного задания. Подробности см. в следующих разделах.

    {
        "startTime": "2012-08-04T00:00Z",               // optional
        "action":
        {
            "type": "http",
            "retryPolicy": { "retryType":"none" },
            "request":
            {
                "uri": "http://contoso.com/foo",        // required
                "method": "PUT",                        // required
                "body": "Posting from a timer",         // optional
                "headers":                              // optional

                {
                    "Content-Type": "application/json"
                },
            },
           "errorAction":
           {
               "type": "http",
               "request":
               {
                   "uri": "http://contoso.com/notifyError",
                   "method": "POST",
               },
           },
        },
        "recurrence":                                   // optional
        {
            "frequency": "week",                        // can be "year" "month" "day" "week" "minute"
            "interval": 1,                              // optional, how often to fire (default to 1)
            "schedule":                                 // optional (advanced scheduling specifics)
            {
                "weekDays": ["monday", "wednesday", "friday"],
                "hours": [10, 22]
            },
            "count": 10,                                 // optional (default to recur infinitely)
            "endTime": "2012-11-04",                     // optional (default to recur infinitely)
        },
        "state": "disabled",                           // enabled or disabled
        "status":                                       // controlled by Scheduler service
        {
            "lastExecutionTime": "2007-03-01T13:00:00Z",
            "nextExecutionTime": "2007-03-01T14:00:00Z ",
            "executionCount": 3,
                                                "failureCount": 0,
                                                "faultedCount": 0
        },
    }

Как видно из приведенного выше примера запланированного задания, определение задания состоит из нескольких частей.

* Время начала (startTime).  
* Действие (action), которое включает действие ошибки (errorAction).
* Повторение (recurrence).  
* Состояние (state).  
* Статус (status).  
* Политика повтора (retryPolicy).  

Рассмотрим каждую часть подробно.

## <a name="starttime"></a>startTime
startTime — это время начала, которое позволяет вызывающему объекту указать смещение часового пояса в сети в [формате ISO-8601](http://en.wikipedia.org/wiki/ISO_8601).

## <a name="action-and-erroraction"></a>action и errorAction
action — это действие, вызываемое при каждом выполнении задания и описывающее тип вызова службы. action — это действие, которое будет выполняться по указанному расписанию. Планировщик поддерживает действия, связанные с HTTP, очередью хранилища, разделом служебной шины и очередью служебной шины.

В приведенном выше примере используется действие HTTP. Ниже приведен пример с действием очереди хранилища.

    {
            "type": "storageQueue",
            "queueMessage":
            {
                "storageAccount": "myStorageAccount",  // required
                "queueName": "myqueue",                // required
                "sasToken": "TOKEN",                   // required
                "message":                             // required
                    "My message body",
            },
    }

Ниже приведен пример действия раздела служебной шины.

  "action": { "type": "serviceBusTopic", "serviceBusTopicMessage": { "topicPath": "t1",  
      "namespace": "mySBNamespace", "transportType": "netMessaging", // Может быть netMessaging или AMQP "authentication": { "sasKeyName": "QPolicy", "type": "sharedAccessKey" }, "message": "Сообщение", "brokeredMessageProperties": {}, "customMessageProperties": { "appname": "FromScheduler" } }, }

Ниже приведен пример действия очереди служебной шины.

  "action": { "serviceBusQueueMessage": { "queueName": "q1",  
      "namespace": "mySBNamespace", "transportType": "netMessaging", // Может быть netMessaging или AMQP "authentication": {  
        "sasKeyName": "QPolicy", "type": "sharedAccessKey" }, "message": "Сообщение",  
      "brokeredMessageProperties": {}, "customMessageProperties": { "appname": "FromScheduler" } }, "type": "serviceBusQueue" }

errorAction ― это обработчик ошибок, действие, которое вызывается при невыполнении основного действия. Данная переменная позволяет вызвать конечную точку обработки ошибок или отправить пользователю уведомление. Это можно использовать для того, чтобы достигнуть дополнительной конечной точки, если основная недоступна (например, при аварии на сайте конечной точки), или оповестить конечную точку обработки ошибок. Аналогично основному действию, переменная errorAction может содержать как простой, так и сложный алгоритм в зависимости от других действий. Инструкции по созданию маркера SAS см. в статье о [создании и использовании подписанного URL-адреса](https://msdn.microsoft.com/library/azure/jj721951.aspx).

## <a name="recurrence"></a>recurrence
Параметр recurrence состоит из нескольких частей.

* Частота (frequency): минута, час, день, неделя, месяц или год.  
* Интервал (interval): количество повторений с указанной частотой.  
* Предписанное расписание (schedule): минуты, часы, дни недели, месяцы и числа месяца, в которые будет выполняться повторение.  
* Количество (count): число повторений.  
* Время окончания (endTime): время, после которого задания выполняться не будут.  

Задание повторяется, если его определение JSON включает объект повторения. Если указаны параметры count и endTime, приоритет отдается условию завершения, которое выполняется первым.

## <a name="state"></a>state
Состояние задания может иметь одно из четырех значений: "включено", "отключено", "завершено" или "неисправно". Для перевода заданий в состояние "включено" или "отключено" можно использовать задания PUT и PATCH. Если задание завершено или неисправно, обновить его итоговое состояние нельзя (однако, задание может быть УДАЛЕНО). Пример свойства state выглядит следующим образом:

        "state": "disabled", // enabled, disabled, completed, or faulted
Завершенные и неисправные задания удаляются через 60 дней.

## <a name="status"></a>status
После запуска задания планировщик возвращает информацию о текущем статусе его выполнения. Пользователь не может настраивать этот объект — его задает система. При этом он включается в объект задания (а не является отдельным связанным ресурсом), что позволяет легко узнавать статус задания.

Статус задания содержит время предыдущего выполнения (если задание уже выполнялось), время следующего запланированного выполнения (для незавершенных заданий) и количество выполнений.

## <a name="retrypolicy"></a>retryPolicy
Если задание планировщика выполнить не удается, можно настроить политику повтора, указав условия и порядок повторного выполнения действия. Политика повтора определяется объектом **retryType** — если она не установлена, данный объект имеет значение **none**, как показано выше. Если политика повтора имеется, установите значение **fixed** .

Для настройки политики повторных попыток можно указать два дополнительных параметра: интервал повтора (**retryInterval**) и число повторов (**retryCount**).

Интервал повтора, определяемый объектом **retryInterval** , представляет собой промежуток времени между повторными попытками. Значение по умолчанию составляет 30 секунд, минимальное настраиваемое значение — 15 секунд, а максимальное — 18 месяцев. Для заданий в бесплатных коллекциях минимальное настраиваемое значение составляет 1 час.  Значение устанавливается в формате ISO-8601. Число повторов определяется объектом **retryCount** и представляет собой количество предпринимаемых повторных попыток. Значение по умолчанию — 4, максимальное значение — 20. Параметры **retryInterval** и **retryCount** являются необязательными. Они получают свои значения по умолчанию, если объекту **retryType** присваивается значение **fixed** и никакие другие значения явно не задаются.

## <a name="see-also"></a>Дополнительные материалы
 [Что такое планировщик?](scheduler-intro.md)

 [Приступая к работе с планировщиком Azure на портале Azure](scheduler-get-started-portal.md)

 [Планы и выставление счетов в планировщике Azure](scheduler-plans-billing.md)

 [Как создавать сложные расписания и расширенное повторение с помощью планировщика Azure](scheduler-advanced-complexity.md)

 [Справочник по API REST планировщика Azure](https://msdn.microsoft.com/library/mt629143)

 [Справочник по командлетам PowerShell планировщика Azure](scheduler-powershell-reference.md)

 [Высокая доступность и надежность планировщика Azure](scheduler-high-availability-reliability.md)

 [Ограничения, значения по умолчанию и коды ошибок планировщика Azure](scheduler-limits-defaults-errors.md)

 [Исходящая аутентификация планировщика Azure](scheduler-outbound-authentication.md)

