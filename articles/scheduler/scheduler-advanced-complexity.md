---
title: "aaaHow tooBuild сложных расписаний и расширенные функции повторения с планировщиком Azure"
description: "Как tooBuild комплексного планирует и расширенные функции повторения с планировщиком Azure"
services: scheduler
documentationcenter: .NET
author: derek1ee
manager: kevinlam1
editor: 
ms.assetid: 5c124986-9f29-4cbc-ad5a-c667b37fbe5a
ms.service: scheduler
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 08/18/2016
ms.author: deli
ms.openlocfilehash: 02172791978b12be0ccb3078125d057b2efe8523
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="how-toobuild-complex-schedules-and-advanced-recurrence-with-azure-scheduler"></a>Как tooBuild комплексного планирует и расширенные функции повторения с планировщиком Azure
## <a name="overview"></a>Обзор
Основа hello Azure планировщик заданий — hello *расписание*. расписание Hello определяет, когда и как hello планировщика выполняет задание hello.

Планировщик Azure позволяет toospecify разные одноразовый и повторения расписания для задания. *Одноразовые* расписания запускаются один раз в указанное время — по сути это *повторяющиеся* расписания, которые выполняются только один раз. Повторяющиеся расписания запускаются с указанной периодичностью.

Благодаря этой гибкости планировщик Azure позволяет поддерживать самые разнообразные бизнес-сценарии.

* Периодическая очистка данных, например ежедневное удаление всех твитов старше 3 месяцев.
* Архивный — например, каждый месяц, служба toobackup журнал накладной Push-уведомлений
* Запросы внешних данных, например получение нового прогноза погоды для лыжников от NOAA каждые 15 минут.
* Изображение обработки — например каждый день недели, часы с наименьшей загрузкой, использовать облачных вычислительных изображения toocompress отправлен в этот день

В данной статье будут рассмотрены примеры заданий, которые можно создавать с помощью планировщика Azure. Мы предоставляем hello данных JSON, описывающий каждого расписания. Если вы используете hello [REST API планировщика](https://msdn.microsoft.com/library/mt629143.aspx), можно использовать этот же JSON для [Создание задания планировщика Azure](https://msdn.microsoft.com/library/mt629145.aspx).

## <a name="supported-scenarios"></a>Поддерживаемые сценарии
Многие примеры в этом разделе иллюстрируют hello спектра сценарии, которые планировщик Azure поддерживает Hello. Грубо говоря эти примеры показывают, как toocreate расписания для многих шаблонов поведение, включая hello те ниже:

* Однократное выполнение в определенный день и в конкретное время.
* Выполнение и повтор указанное количество раз.
* Незамедлительное выполнение и повтор.
* Выполнение и повтор через каждые *n* минут, часов, дней, недель или месяцев, начиная с указанного времени.
* Выполнение и повтор на еженедельной или ежемесячной основе, но только в указанные даты, дни недели или числа месяца.
* Выполнение и повтор несколько раз за период, например в последнюю пятницу и понедельник каждого месяца или в 05:15 и 17:15 каждого дня.

## <a name="dates-and-datetimes"></a>Значения даты и даты и времени
Даты в заданий планировщика Azure следуйте hello [спецификации ISO 8601](http://en.wikipedia.org/wiki/ISO_8601) и включать только дата hello.

Ссылки на даты и времени в заданий планировщика Azure следуйте hello [спецификации ISO 8601](http://en.wikipedia.org/wiki/ISO_8601) и включать компоненты даты и времени. Даты и времени, которое не указывает смещение относительно UTC предполагается, что toobe UTC.  

## <a name="how-to-use-json-and-rest-api-for-creating-schedules"></a>Практическое руководство: создание расписаний с помощью JSON и API REST
Здравствуйте, toocreate простое расписание с помощью [REST API планировщика Azure](https://msdn.microsoft.com/library/mt629143), сначала [зарегистрировать подписку с помощью поставщика ресурсов](https://msdn.microsoft.com/library/azure/dn790548.aspx) (hello имя поставщика для планировщика  *Microsoft.Scheduler*), затем [создать коллекцию заданий](https://msdn.microsoft.com/library/mt629159.aspx)и, наконец, [создать задание](https://msdn.microsoft.com/library/mt629145.aspx). При создании задания можно указать планирования и повторения с помощью JSON как hello один отрывок ниже:

    {
        "startTime": "2012-08-04T00:00Z", // optional
         …
        "recurrence":                     // optional
        {
            "frequency": "week",     // can be "year" "month" "day" "week" "hour" "minute"
            "interval": 1,                // optional, how often toofire (default too1)
            "schedule":                   // optional (advanced scheduling specifics)
            {
                "weekDays": ["monday", "wednesday", "friday"],
                "hours": [10, 22]                      
            },
            "count": 10,                  // optional (default toorecur infinitely)
            "endTime": "2012-11-04",      // optional (default toorecur infinitely)
        },
        …
    }

## <a name="overview-job-schema-basics"></a>Общие сведения: основные параметры схемы заданий
Привет, в следующей таблице представлен общий обзор связанных toorecurrence hello основных элементов и планирование задания:

| **Имя JSON** | **Описание** |
|:--- |:--- |
| ***startTime*** |*startTime* — это дата и время. Для простых расписаний *startTime* — первое вхождение hello и для сложных расписаний hello задания начнется, пока не истечет *startTime*. |
| ***recurrence*** |Hello *повторения* объект задает правила повторения для задания hello и hello повторения hello задание будет выполняться с. объект повторения Hello поддерживает элементы hello *интервал, интервал, время окончания, count,* и *расписание*. Если *повторения* определен, *частоты* является обязательным; hello другие элементы *повторения* являются необязательными. |
| ***frequency*** |Hello *частоты* строка, представляющая hello Частотная единица, в какие hello повторения задания. Частота может быть указана в *минутах, часах, днях, неделях* или *месяцах*. |
| ***interval*** |Hello *интервал* является положительным целым числом и обозначает интервал приветствия для hello *частоты* , определяющее, как часто hello задание будет выполняться. Например если *интервал* 3 и *частоты* «неделя» hello задание повторяется каждые 3 недель. Максимальное значение элемента *interval* в планировщике Azure составляет 18 месяцев для ежемесячной частоты, 78 недель для еженедельной частоты и 548 дней для ежедневной частоты. Для часов и минут частоты, hello поддерживается диапазон: 1 < = *интервал* < = 1000. |
| ***endTime*** |Hello *endTime* строка указывает hello даты и времени за какой hello не может выполнить задание. Не является допустимым toohave *endTime* в прошлом hello. Если не *endTime* или указано число, hello задание будет выполняться бесконечно долго. Оба *endTime* и *число* не могут быть включены для hello того же задания. |
| ***count*** |<p>Hello *число* положительное целое число (больше нуля), указывающее hello количество раз, перед завершением должно запускаться данное задание.</p><p>Hello *число* представляет Здравствуйте, сколько раз hello задание выполняется перед определяется как завершенное. Например, для задания, которое выполняется ежедневно с *число* 5 и Дата, с понедельника, hello задание завершается выполнение на пятницу. Если запустить hello даты в прошлом hello, hello первого выполнения, вычисленный на основе времени создания hello.</p><p>Если не *endTime* или *число* указан, задание hello выполняться бесконечно долго. Оба *endTime* и *число* не могут быть включены для hello того же задания.</p> |
| ***schedule*** |Задание с указанной частотой выполняется по расписанию. Оно определяется объектом *schedule*, который содержит изменения с учетом минут, часов, дней недели, чисел месяца и количества недель. |

## <a name="overview-job-schema-defaults-limits-and-examples"></a>Общие сведения: параметры схемы заданий по умолчанию, ограничения и примеры
Ознакомившись с общими сведениями, рассмотрим эти элементы более подробно.

| **Имя JSON** | **Тип значения** | **Обязательный?** | **Значение по умолчанию** | **Допустимые значения** | **Пример** |
|:--- |:--- |:--- |:--- |:--- |:--- |
| ***startTime*** |Строка |Нет |None |Дата и время по спецификации ISO-8601 |<code>"startTime" : "2013-01-09T09:30:00-08:00"</code> |
| ***recurrence*** |Объект |Нет |None |Объект recurrence |<code>"recurrence" : { "frequency" : "monthly", "interval" : 1 }</code> |
| ***frequency*** |Строка |Да |None |"minute" (минута), "hour" (час), "day" (день), "week" (неделя), "month" (месяц) |<code>"frequency" : "hour"</code> |
| ***interval*** |Number |Нет |1 |1 too1000. |<code>"interval":10</code> |
| ***endTime*** |Строка |Нет |None |Значение даты и времени, представляющий время в будущем hello |<code>"endTime" : "2013-02-09T09:30:00-08:00"</code> |
| ***count*** |Number |Нет |None |>=1 |<code>"count": 5</code> |
| ***schedule*** |Объект |Нет |None |Объект schedule |<code>"schedule" : { "minute" : [30], "hour" : [8,17] }</code> |

## <a name="deep-dive-starttime"></a>Подробно: *startTime*
Hello следующей таблице захваты как *startTime* управляет выполнением задания.

| **Значение startTime** | **Количество повторов** | **Повторение без расписания** | **Повторение с расписанием** |
|:--- |:--- |:--- |:--- |
| **Время начала не указано** |Задание выполняется один раз сразу после запуска |Задание выполняется один раз сразу после запуска. Последующие выполнения производятся, исходя из времени предыдущего выполнения. |<p>Задание выполняется один раз сразу после запуска</p><p>Последующие выполнения производятся по расписанию повторов.</p> |
| **Время начала в прошлом** |Задание выполняется один раз сразу после запуска |<p>Время выполнения задания рассчитывается как время первого выполнения после времени начала.</p><p>Последующие выполнения производятся, исходя из времени предыдущего выполнения.</p><p>См. пример под этой таблицей</p> |<p>Задание запускается *не быстрее, чем* hello времени начала. первое вхождение Hello основан на расписание hello, вычисленный на основе времени начала hello</p><p>Последующие выполнения производятся по расписанию повторов.</p> |
| **Время начала в будущем или в настоящем** |Задание выполняется один раз в указанное время начала |<p>Задание выполняется один раз в указанное время начала</p><p>Последующие выполнения производятся, исходя из времени предыдущего выполнения.</p> |<p>Задание запускается *не быстрее, чем* hello времени начала. первое вхождение Hello основан на расписание hello, вычисленный на основе времени начала hello</p><p>Последующие выполнения производятся по расписанию повторов.</p> |

Давайте посмотрим, что происходит с примером где *startTime* в последние, hello с *повторения* , но не *расписание*.  Предположим, что hello текущее время: 2015-04-08 13:00, *startTime* — 2015-04-07 14:00, и *повторения* — каждые 2 дня (с *частоты*: день и *интервал*: 2.) Обратите внимание, что hello *startTime* находится в прошлом hello и предшествует hello текущее время

В этих условиях hello *первого выполнения* будет 2015-04-09 в 14:00\. Планировщик заданий Hello вычисляет случаи выполнения с момента начала hello.  Все экземпляры в прошлом hello не учитываются. Hello подсистемой hello следующего экземпляра в будущем hello.  Поэтому в этом случае *startTime* является 2015-04-07 в 14:00:00, поэтому hello следующего экземпляра через два дня после этого времени является 2015-04-09 в 14:00.

Обратите внимание, что первое выполнение hello бы hello даже при hello startTime 2015-04-05 14:00 или 14:00\ 2015-04-01. После первого выполнения hello, при последующем выполнении вычисляются с помощью hello по расписанию —, они будут иметь один 2015-04-11 в 14:00, затем 2015-04-13 в 14:00, затем 2015-04-15 в 14:00:00 и т. д.

И, наконец, когда задание имеет расписание, если часов или минут не заданы в расписании hello, они по умолчанию toohello часов или минут hello первого выполнения, соответственно.

## <a name="deep-dive-schedule"></a>Подробный обзор: *schedule*
С одной стороны *расписания* можно *ограничение* hello количество выполнений задания.  Например, если задание с частотой «месяц» имеет *расписания* , выполняется только день 31, hello задание выполняется в только эти месяцы, которые имеют 31<sup>st</sup> день.

Здравствуйте, с другой стороны, *расписания* можно также *разверните* hello количество выполнений задания. Например, если задание с частотой «месяц» имеет *расписания* , работает на дни месяца 1 и 2, задание hello, выполняется на hello 1<sup>st</sup> и 2<sup>nd</sup> дни месяца hello, а не только один раз месяц.

Если указано несколько элементов расписания, hello порядок вычисления определяется с наибольшим toosmallest hello — номер недели, месяц, день, неделя, день, час и минуту.

Hello следующей таблице описаны *расписание* элементы подробно.

| **Имя JSON** | **Описание** | **Допустимые значения** |
|:--- |:--- |:--- |
| **minutes** |Час hello какие hello для запуска задания в минутах |<ul><li>Целое число</li><li>массив целых чисел</li></ul> |
| **hours** |Время дня hello какие hello для запуска задания |<ul><li>Целое число</li><li>массив целых чисел</li></ul> |
| **weekDays** |Дни hello недели hello задания будут выполняться. Указываются только при выборе еженедельной частоты. |<ul><li>Понедельник, вторник, среда, четверг, пятница, суббота, воскресенье</li><li>Массив любого hello выше значения (размер массива max 7)</li></ul>*Без учета* регистра |
| **monthlyOccurrences** |Определяет, какие дни hello месяц hello задание будет выполняться. Указываются только при выборе ежемесячной частоты. |<ul><li>Массив объектов monthlyOccurrence:</li></ul> <pre>{ "day": *day*,<br />  "occurrence": *occurrence*<br />}</pre><p> *день* день hello hello недели hello задание будет выполняться, например {воскресенье} — каждое воскресенье hello месяца. Обязательный элемент.</p><p>Вхождение *вхождения* дня hello hello месяц, например {воскресенье, -1} является последнее воскресенье hello месяца "hello". необязательный параметр.</p> |
| **monthDays** |День hello месяц hello задания будут выполняться. Указываются только при выборе ежемесячной частоты. |<ul><li>Любое значение < = –1 и > = –31</li><li>Любое значение > = 1 и < = 31</li><li>Массив указанных выше значений</li></ul> |

## <a name="examples-recurrence-schedules"></a>Примеры: расписания повторений
Hello ниже приведены примеры повторения расписания — hello объекта расписание и его дочерним элементам.

Hello расписания все приведенные ниже предполагается, что hello *интервал* задано too1\. Кроме того, один должен Предположим, частота правой hello в соответствии toowhat hello *расписание* — например, один невозможно использует частоту «день» и «дни месяца» изменение в расписании hello. Эти ограничения описаны выше.

| **Пример** | **Описание** |
|:--- |:--- |
| <code>{"hours":[5]}</code> |Задание выполняется каждый день в 05:00. Планировщик Azure соответствует каждого значения в «часы» значение каждого «в минутах», по одному, toocreate список всегда hello какие hello задания является toobe выполнения. |
| <code>{"minutes":[15], "hours":[5]}</code> |Задание выполняется каждый день в 05:15. |
| <code>{"minutes":[15], "hours":[5,17]}</code> |Задание выполняется каждый день в 05:15 и 17:15. |
| <code>{"minutes":[15,45], "hours":[5,17]}</code> |Задание выполняется каждый день в 05:15, 05:45, 17:15 и 17:45. |
| <code>{"minutes":[0,15,30,45]}</code> |Задание выполняется каждые 15 минут. |
| <code>{hours":[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]}</code> |Задание выполняется каждый час. Это задание выполняется каждый час. минуты Hello управляется hello *startTime*, если он указан, или если не указано, по времени создания hello. Например, если hello время запуска или время создания (какое из них применяется), 12:25 по hello задания будут выполняться в 00:25, 01:25, 02:25,..., 23:25. Hello расписание — эквивалент toohaving задание с *частоты* «час» *интервал* 1, и нет *расписание*. Hello различие — возможность использования этого расписания с разными *частоты* и *интервал* toocreate другие задания слишком. Например, если hello *частоты* были «месяц», hello расписание будет выполняться только один раз в месяц, а не каждый день Если *частоты* были «день» |
| <code>{minutes:[0]}</code> |Проведение hello час каждый час. Это задание также выполняется каждый час, но на час hello (например 12: 00, 13: 00 2 AM и т. д.) Это эквивалент tooa задания с частотой «час», startTime не расписание и ноль минут Если частота hello «день», но если частота hello «недели» или «месяц», hello расписание будет выполнен только один день, неделю или раз в месяц, соответственно. |
| <code>{"minutes":[15]}</code> |Задание выполняется через 15 минут после наступления каждого часа. Задание выполняется каждый час, начиная с 00:15, 01:15, 02:15 и т. д. и заканчивая 22:15 и 23:15. |
| <code>{"hours":[17], "weekDays":["saturday"]}</code> |Задание выполняется в 17:00 каждую субботу. |
| <code>{hours":[17], "weekDays":["monday", "wednesday", "friday"]}</code> |Задание выполняется в 17:00 в каждый понедельник, среду и пятницу. |
| <code>{"minutes":[15,45], "hours":[17], "weekDays":["monday", "wednesday", "friday"]}</code> |Задание выполняется в 17:15 и 17:45 в каждый понедельник, среду и пятницу. |
| <code>{"hours":[5,17], "weekDays":["monday", "wednesday", "friday"]}</code> |Задание выполняется в 05:00 и 17:00 в каждый понедельник, среду и пятницу. |
| <code>{"minutes":[15,45], "hours":[5,17], "weekDays":["monday", "wednesday", "friday"]}</code> |Задание выполняется в 05:15, 05:45, 17:15 и 17:45 в каждый понедельник, среду и пятницу. |
| <code>{"minutes":[0,15,30,45], "weekDays":["monday", "tuesday", "wednesday", "thursday", "friday"]}</code> |Задание выполняется каждые 15 минут в каждый рабочий день. |
| <code>{"minutes":[0,15,30,45], "hours": [9, 10, 11, 12, 13, 14, 15, 16] "weekDays":["monday", "tuesday", "wednesday", "thursday", "friday"]}</code> |Задание выполняется каждые 15 минут в период с 09:00 до 16:45 в каждый рабочий день. |
| <code>{"weekDays":["sunday"]}</code> |Задание выполняется по воскресеньям в указанное время начала. |
| <code>{"weekDays":["tuesday", "thursday"]}</code> |Задание выполняется по вторникам и четвергам в указанное время начала. |
| <code>{"minutes":[0], "hours":[6], "monthDays":[28]}</code> |Запуск с 6: 00 на hello 28 день каждого месяца (при условии, что частота месяц) |
| <code>{"minutes":[0], "hours":[6], "monthDays":[-1]}</code> |Запустите с 6: 00 на последний день месяца hello hello. Если вы хотите toorun задания на hello последний день месяца, используйте значение -1 вместо день 28, 29, 30 или 31. |
| <code>{"minutes":[0], "hours":[6], "monthDays":[1,-1]}</code> |Проведение с 6: 00 hello первый и последний день каждого месяца |
| <code>{monthDays":[1,-1]}</code> |Выполнять hello первый и последний день каждого месяца во время начала |
| <code>{monthDays":[1,14]}</code> |Выполнять hello First и четырнадцатого день каждого месяца во время начала |
| <code>{monthDays":[2]}</code> |Запустите на второй день hello месяц во время запуска hello |
| <code>{"minutes":[0], "hours":[5], "monthlyOccurrences":[{"day":"friday", "occurrence":1}]}</code> |Задание выполняется в первую пятницу каждого месяца в 05:00. |
| <code>{"monthlyOccurrences":[{"day":"friday", "occurrence":1}]}</code> |Задание выполняется в первую пятницу каждого месяца в указанное время начала. |
| <code>{"monthlyOccurrences":[{"day":"friday", "occurrence":-3}]}</code> |Задание выполняется в третью пятницу с конца месяца, каждый месяц в указанное время начала. |
| <code>{"minutes":[15], "hours":[5], "monthlyOccurrences":[{"day":"friday", "occurrence":1},{"day":"friday", "occurrence":-1}]}</code> |Задание выполняется первую и последнюю пятницу каждого месяца в 05:15. |
| <code>{"monthlyOccurrences":[{"day":"friday", "occurrence":1},{"day":"friday", "occurrence":-1}]}</code> |Задание выполняется первую и последнюю пятницу каждого месяца в указанное время начала. |
| <code>{"monthlyOccurrences":[{"day":"friday", "occurrence":5}]}</code> |Задание выполняется в пятую пятницу каждый месяц в указанное время начала. Если не пятый пятницу в месяц, это не работает, так как это запланированное toorun по пятницам только пятый. Можно с помощью -1 вместо 5 вхождение hello задание hello toorun на hello последнего возникновения пятницы hello месяца. |
| <code>{"minutes":[0,15,30,45], "monthlyOccurrences":[{"day":"friday", "occurrence":-1}]}</code> |Запустить каждые 15 минут на последнюю пятницу hello месяца |
| <code>{"minutes":[15,45], "hours":[5,17], "monthlyOccurrences":[{"day":"wednesday", "occurrence":3}]}</code> |Выполните в до 05:15:00, 5:45 AM, 17:15:00 и 5:45 PM на hello сторонних среду каждого месяца |

## <a name="see-also"></a>См. также
 [Что такое планировщик?](scheduler-intro.md)

 [Основные понятия, терминология и иерархия сущностей планировщика Azure](scheduler-concepts-terms.md)

 [Начало работы с планировщиком в hello портал Azure](scheduler-get-started-portal.md)

 [Планы и выставление счетов в планировщике Azure](scheduler-plans-billing.md)

 [Справочник по API REST планировщика Azure](https://msdn.microsoft.com/library/mt629143)

 [Справочник по командлетам PowerShell планировщика Azure](scheduler-powershell-reference.md)

 [Высокая доступность и надежность планировщика Azure](scheduler-high-availability-reliability.md)

 [Ограничения, значения по умолчанию и коды ошибок планировщика Azure](scheduler-limits-defaults-errors.md)

 [Исходящая аутентификация планировщика Azure](scheduler-outbound-authentication.md)

