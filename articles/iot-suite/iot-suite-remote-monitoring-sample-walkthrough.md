---
title: "Архитектура удаленного мониторинга в Azure | Документация Майкрософт"
description: "Пошаговое руководство по архитектуре предварительно настроенного решения удаленного мониторинга."
services: 
suite: iot-suite
documentationcenter: 
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 31fe13af-0482-47be-b4c8-e98e36625855
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/10/2017
ms.author: dobett
ms.openlocfilehash: e19ba9c88e4fbe4f065c45ce7029247436f7155c
ms.sourcegitcommit: bc8d39fa83b3c4a66457fba007d215bccd8be985
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
# <a name="remote-monitoring-preconfigured-solution-architecture"></a>Архитектура предварительно настроенного решения удаленного мониторинга

[Предварительно настроенное решение](iot-suite-what-are-preconfigured-solutions.md) удаленного мониторинга в наборе IoT Suite — это средство, которое позволяет полностью отслеживать несколько компьютеров в удаленных расположениях. Это решение объединяет основные службы Azure, чтобы обеспечить универсальную реализацию бизнес-сценария. Его можно использовать в качестве отправной точки для собственной реализации и [настроить](iot-suite-remote-monitoring-customize.md) в соответствии с потребностями конкретной организации.

В этой статье рассматриваются некоторые основные компоненты решения для удаленного мониторинга, чтобы вы смогли представить, как оно работает. Эти знания помогут вам:

* устранить проблемы, возникшие с решением;
* спланировать настройку решения в соответствии с определенными требованиями;
* спроектировать собственное решение IoT, использующее службы Azure.

## <a name="logical-architecture"></a>Логическая архитектура

На приведенной ниже схеме показаны логические компоненты предварительно настроенного решения удаленного мониторинга, наложенные на [архитектуру IoT](iot-suite-what-is-azure-iot.md):

![Логическая архитектура](media/iot-suite-remote-monitoring-sample-walkthrough/remote-monitoring-architecture.png)

## <a name="why-microservices"></a>Зачем нужны микрослужбы

С момента выпуска корпорацией Майкрософт первых предварительно настроенных решений архитектура облака эволюционировала. [Микрослужбы](https://azure.microsoft.com/blog/microservices-an-application-revolution-powered-by-the-cloud/) — это проверенный метод, который обеспечивает масштабируемость и гибкость без снижения скорости разработки. В некоторых службах Майкрософт по умолчанию используется шаблон архитектуры, который обеспечивает высокую надежность и масштабируемость. В обновленных предварительно настроенных решениях реализованы эти наработки, чтобы вы в полной мере смогли воспользоваться их преимуществами.

> [!TIP]
> Дополнительные сведения об архитектурах микрослужб см. на странице [архитектуры приложения для .NET](https://www.microsoft.com/net/learn/architecture), а также в записи блога, посвященной [возможностям микрослужб для приложений на базе облака](https://azure.microsoft.com/blog/microservices-an-application-revolution-powered-by-the-cloud/).

## <a name="device-connectivity"></a>Взаимодействие устройств

Компоненты логической архитектуры решения, которые связаны с подключением устройств:

### <a name="simulated-devices"></a>Виртуальные устройства

В решение входит микрослужба, предназначенная для управления пулом виртуальных устройств для тестирования сквозного потока решения. Виртуальные устройства выполняют следующие задачи:

* создают данные телеметрии при передаче информации с устройства в облако;
* отвечают на вызовы методов для передачи информации из облака на устройство, поступающие из Центра Интернета вещей.

Микрослужба предоставляет конечную точку RESTful, с помощью которой можно создавать, запускать и останавливать моделирование. Моделирование осуществляется за счет набора виртуальных устройств различных типов, которые отправляют данные телеметрии и отвечают на вызовы методов.

Вы можете подготовить виртуальные устройства с помощью панели мониторинга на портале решения.

### <a name="physical-devices"></a>Физические устройства

Вы можете подключать физические устройства к решению. Можно реализовать поведение виртуальных устройств с помощью пакетов SDK для устройств Azure IoT.

Вы можете подготовить физические устройства с помощью панели мониторинга на портале решения.

### <a name="iot-hub-and-the-iot-manager-microservice"></a>Микрослужба диспетчера IoT и Центра Интернета вещей

[Центр Интернета вещей](../iot-hub/index.md) принимает данные, отправленные с устройств в облако, и предоставляет к ним доступ микрослужбе `telemetry-agent`.

Центр Интернета вещей также выполняет в решении следующие функции:

* Поддерживает реестр удостоверений, в котором хранятся идентификаторы и ключи аутентификации всех устройств с разрешением на подключение к порталу. С помощью реестра удостоверений можно включать и отключать устройства.
* Вызывает на устройствах методы от имени портала устройства.
* Поддерживает двойники устройств для всех зарегистрированных устройств. Двойник устройства хранит значения свойств, сообщаемые устройством. Двойник устройства также хранит требуемые свойства, заданные на портале решения, которые извлекаются устройством при следующем подключении.
* Планирует задания, чтобы задать значения свойств для нескольких устройств или вызвать методы на нескольких устройствах.

В решение входит микрослужба `iot-manager` для обработки следующих операций в Центре Интернета вещей:

* создание устройств IoT и управление ими;
* управление двойниками устройств;
* вызов методов на устройствах;
* управление учетными данными IoT.

Эта служба также выполняет запросы Центра Интернета вещей для извлечения данных устройств, принадлежащих группам, которые определяются пользователем.

Микрослужба предоставляет конечную точку RESTful для управления устройствами и двойниками устройств, вызова методов и выполнения запросов Центра Интернета вещей.

## <a name="data-processing-and-analytics"></a>Обработка данных и аналитика

Компоненты логической архитектуры решения, которые связаны с обработкой данных и аналитикой:

### <a name="device-telemetry"></a>Телеметрия устройства

В решение входят две микрослужбы для обработки данных телеметрии устройства.

Микрослужба [telemetry-agent](https://github.com/Azure/telemetry-agent-dotnet) предназначена для выполнения следующих задач:

* хранение данных телеметрии в Cosmos DB;
* анализ потока телеметрической информации с устройств;
* создание предупреждений по определенным правилам.

Предупреждения хранятся в Cosmos DB.

Микрослужба `telemetry-agent` поддерживает портал решения для чтения данных телеметрии, отправленных с устройства. Эта служба используется на портале решения для выполнения следующих задач:

* Определение правил мониторинга, например пороговых значений, которые запускают сигналы.
* Получение списка последних сигналов.

Для управления данными телеметрии, правилами и предупреждениями используйте конечную точку RESTful, предоставленную этой микрослужбой.

### <a name="storage"></a>Хранилище

Микрослужба [storage-adapter](https://github.com/Azure/pcs-storage-adapter-dotnet) — это адаптер, который находится перед основной службой хранилища, используемой для предварительно настроенных решений. Этот адаптер обеспечивает сбор данных и хранение пар "ключ-значение".

В стандартном развертывании предварительно настроенного решения Cosmos DB используется в качестве основной службы хранилища.

Информация базы данных Cosmos DB хранится в предварительно настроенном решении. Микрослужба **storage-adapter** выполняет роль адаптера для других микрослужб в решении, предоставляя им доступ к службам хранилища.

## <a name="presentation"></a>Уровень представления

Компоненты логической архитектуры решения, которые связаны с представлением данных:

[Веб-интерфейс пользователя — это приложение React Javascript](https://github.com/Azure/pcs-remote-monitoring-webui). Характеристики этого приложения:

* Использует только Javascript React и полностью выполняется в браузере.
* Реализуется с помощью каскадных таблиц стилей.
* Взаимодействует с общедоступными микрослужбами с помощью вызовов AJAX.

Пользовательский интерфейс представляет все функциональные возможности предварительно настроенного решения и взаимодействует с другими службами, которые перечислены ниже.

* Микрослужба [authentication](https://github.com/Azure/pcs-auth-dotnet) используется для защиты данных пользователей.
* Микрослужба [iothub-manager](https://github.com/Azure/iothub-manager-dotnet) используется для отображения устройств IoT и управления ими.

Микрослужба [ui-config](https://github.com/Azure/pcs-config-dotnet) обеспечивает сохранение и извлечение параметров конфигурации пользовательским интерфейсом.

## <a name="next-steps"></a>Дальнейшие действия

Если вы хотите просмотреть исходный код и документацию разработчика, начните с одного из основных репозиториев GitHub:

* [Предварительно настроенное решение для удаленного мониторинга с помощью Azure IoT (.NET)](https://github.com/Azure/azure-iot-pcs-remote-monitoring-dotnet/wiki/).
* [Предварительно настроенное решение для удаленного мониторинга с помощью Azure IoT (Java)](https://github.com/Azure/azure-iot-pcs-remote-monitoring-java).
* [Архитектура предварительно настроенного решения для удаленного мониторинга](https://github.com/Azure/azure-iot-pcs-remote-monitoring-dotnet/wiki/Architecture).

Дополнительные сведения см. в статье о [настройке предварительно настроенных решений для удаленного мониторинга](iot-suite-remote-monitoring-customize.md).
