---
title: "Архитектура безопасности Интернета вещей | Документация Майкрософт"
description: "Рекомендации и советы по архитектуре безопасности IoT"
services: 
suite: iot-suite
documentationcenter: 
author: YuriDio
manager: timlt
editor: 
ms.assetid: 18ed3eb0-9406-44e1-8a3a-93dc6726c7ac
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/03/2017
ms.author: yurid
ms.openlocfilehash: 2482dade7d17d05b2fc90fbf22b0466227a5983b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="internet-of-things-security-architecture"></a>Архитектура безопасности "Интернета вещей"
При разработке системы важно знать угрозы, которым она может подвергаться, а по завершении разработки и создания архитектуры предусмотреть надлежащие средства ее защиты. Особенно важно спланировать стратегию безопасности в самом начале разработки продукта, ведь зная, как злоумышленники могут скомпрометировать систему, можно изначально устранить соответствующие риски. 

## <a name="security-starts-with-a-threat-model"></a>Обеспечение безопасности начинается с рассмотрения модели рисков
Корпорация Майкрософт уже давно использует модели рисков для своих продуктов и сделала процесс моделирования рисков доступным для всех. Опыт корпорации показывает, что кроме быстрого выяснения того, какие угрозы самые серьезные, моделирование предоставляет неожиданные преимущества. Например, таким образом можно обсудить угрозы с пользователями не из команды разработки, чтобы почерпнуть новые идеи и улучшить продукт.

Цель моделирования — понять, как злоумышленники могут скомпрометировать систему, и обеспечить надлежащее устранение рисков. Благодаря моделированию рисков команда разработчиков находит способы устранения рисков во время разработки системы, чтобы их не пришлось искать после ее развертывания. Это крайне важно, так как модернизация средств безопасности для множества устройств в отрасли нецелесообразна, может влечь ошибки и сопровождаться риском для клиентов.

Многие команды удачно устанавливают функциональные требования к системе, что предоставляет преимущества клиентам. Тем не менее, есть более сложная задача — найти в системе неочевидные уязвимости, которыми могут воспользоваться. Моделирование рисков помогает командам разработки понять, что может сделать злоумышленник и почему. В рамках этого структурированного процесса они обсуждают решения по проектированию среды безопасности в системе, а также вносят изменения в архитектуру, связанные с безопасностью. Хотя модель рисков представляет собой всего лишь документ, это идеальный способ обеспечить непрерывную передачу знаний и использование полученного опыта, позволяющий новым командам быстро войти в курс дела. Наконец, моделирование рисков позволяет учесть другие аспекты безопасности, например обязательства в отношении безопасности перед клиентами. В сочетании с моделированием рисков эти обязательства обеспечат осведомленность устройства при тестировании решения "Интернета вещей" (IoT).

### <a name="when-to-threat-model"></a>Когда моделировать риски
[Моделирование рисков](http://www.microsoft.com/security/sdl/adopt/threatmodeling.aspx) — очень ценное преимущество, если его использовать на этапе разработки. При разработке доступны более гибкие возможности внесения изменений для устранения угроз. Таким образом можно изначально устранить угрозы. Это гораздо проще, чем добавлять средства устранения рисков, тестировать их и поддерживать их актуальность. Кроме того, не всегда возможно все это сделать. По мере развития продукта становится все труднее устранять угрозы. В свою очередь, это требует больше работы и более жестких компромиссов, чем моделирование рисков на раннем этапе разработки.

### <a name="what-to-threat-model"></a>Для каких направлений моделировать риски
Моделировать риски следует для всего решения, сосредотачиваясь на следующих функциях:

* обеспечение безопасности и конфиденциальности;
* функции, сбой которых влияет на безопасность;
* функции, работа которых связана с границей доверия. 

### <a name="who-threat-models"></a>Кому следует моделировать риски
Моделирование рисков — такой же процесс, как и все остальные.  Документ модели рисков следует использовать как обычный компонент решения и проверять его соответствующим образом. Многие команды удачно устанавливают функциональные требования к системе, что предоставляет преимущества клиентам. Тем не менее, есть более сложная задача — найти в системе неочевидные уязвимости, которыми могут воспользоваться. Моделирование рисков помогает командам разработки понять, что может сделать злоумышленник и почему.

### <a name="how-to-threat-model"></a>Как моделировать риски
Моделирование рисков предусматривает следующие четыре этапа:

* моделирование применения;
* создание списка угроз;
* устранение рисков;
* проверка устранения рисков.

#### <a name="the-process-steps"></a>Шаги моделирования
При построении модели рисков следует руководствоваться следующими рекомендациями:

1. Создайте схему на основе эталонной архитектуры. 
2. Начните с обзора. Прежде чем углубиться в процесс, получите сведения о системе и сформируйте общее представление.  Таким образом вы сможете сосредоточиться на нужных аспектах.
3. Не процесс должен управлять вами, а вы процессом. Если вы обнаружили проблему на этапе моделирования и хотите изучить ее, сразу же приступайте.  (Не нужно строго придерживаться этих рекомендаций.)  

#### <a name="threats"></a>Риски
Модель рисков предусматривает следующие четыре основных элемента:

* процессы (веб-служб, служб Win32, управляющих программ *nix и т. д.). Обратите внимание, что некоторые сложные сущности (например, полевые шлюзы и датчики) могут быть абстрагированы в качестве процессов, если в соответствующих областях невозможна техническая детализация.
* хранилища данных (любые места хранения данных, например файлы конфигурации или базы данных);
* потоки данных (в которых данные перемещаются между другими элементами приложения);
* внешние сущности (любые элементы, которые взаимодействуют с системой, но не под управлением приложения, к примеру пользователи и вспомогательные веб-каналы).

Все элементы в схеме архитектуры подвержены различным угрозам. В этой статье мы будем использовать для них обозначение STRIDE (спуфинг, незаконное изменение, отказ, раскрытие информации, отказ в обслуживании и несанкционированное повышение привилегий). Дополнительные сведения об элементах STRIDE см. в статье [Threat Modeling Again, STRIDE](https://blogs.msdn.microsoft.com/larryosterman/2007/09/04/threat-modeling-again-stride/) (Дополнительные сведения о моделировании рисков. STRIDE).

Различные элементы схемы приложения подвержены разным угрозам STRIDE:

* процессы подвержены угрозам STRIDE;
* потоки данных — угрозам TID;
* хранилища данных подвержены угрозам TID, а иногда и R, если данные хранятся в файлах журналов;
* внешние сущности подвержены угрозам SRD.

## <a name="security-in-iot"></a>Безопасность в IoT
Перед подключенными специализированными устройствами открывается большое количество возможных зон и шаблонов взаимодействия, которые необходимо учесть при создании инфраструктуры безопасности цифрового доступа к этим устройствам. Здесь термин "цифровой доступ" используется, чтобы отличить соответствующие операции от тех, которые выполняются при прямом взаимодействии с устройством, когда безопасность обеспечивается за счет физического контроля доступа. Например, устройство находится в комнате, дверь которой закрыта на замок. Хотя физический доступ нельзя запретить с помощью программного обеспечения и оборудования, можно предпринять меры, чтобы предотвратить такой доступ и уменьшить вероятность вмешательства в интерфейс системы. 

Исследуя шаблоны взаимодействия, мы уделим одинаковое внимание контролю устройства и данным устройства. Контроль устройства можно классифицировать как ввод любых сведений, предоставленных устройству любой стороной, чтобы изменить его поведение или повлиять на него, а именно на его состояние или состояние его среды. Данные устройства можно классифицировать как любые сведения о его состоянии и наблюдаемом состоянии его среды, которые устройство предоставляет другой стороне.

Чтобы оптимально использовать рекомендации по обеспечению безопасности, советуем разделить типичную архитектуру IoT на несколько компонентов или зон в рамках моделирования рисков. Эти зоны подробно описаны в этом разделе и включают в себя:

* устройство;
* полевой шлюз;
* облачные шлюзы;
* утверждения.

Разделение на зоны — всеобъемлющий способ сегментации решения. Зачастую в каждой зоне содержатся отдельные данные, а также есть требования к проверке подлинности и авторизации. С помощью зоны можно изолировать повреждение и ограничить влияние зон с низким уровнем доверия на те, уровень доверия к которым выше.

Зоны разделяются границами доверия. На схеме ниже они обозначены красной пунктирной линией. Здесь изображен переход сведений или данных из одного источника в другой. Во время этого перехода данные могут подвергаться различным угрозам STRIDE.

![Зоны безопасности IoT](media/iot-security-architecture/iot-security-architecture-fig1.png) 

Компоненты в пределах каждой границы также подвержены угрозам STRIDE, что позволяет получить всеобъемлющую модель рисков для решения. В следующих подразделах содержатся детальные сведения о каждом из компонентов, соответствующие проблемы безопасности, а также решения по их устранению.

В последующих разделах мы обсудим стандартные компоненты, которые, как правило, находятся в этих зонах.

### <a name="the-device-zone"></a>Зона устройства
Среда устройства — это физическое пространство вокруг устройства, в пределах которого к нему можно получить физический доступ и/или цифровой доступ через одноранговую локальную сеть. Под локальной сетью подразумевается уникально идентифицируемая изолированная от общего доступа из Интернета сеть, к которой можно установить сетевой мост. Ею может быть любая технология беспроводной радиосвязи ближнего действия, позволяющая осуществлять одноранговый обмен данными между устройствами. Ею *не* может быть технология сетевой виртуализации, которая создает иллюзию локальной сети, или общедоступные операторские сети, в которых для однорангового обмена данными требуются два устройства, взаимодействующие в пространстве общедоступной сети.

### <a name="the-field-gateway-zone"></a>Зона полевого шлюза
Полевой шлюз — это устройство, программное обеспечение или серверное программное обеспечение общего назначения, которое служит средством реализации обмена данными, а также, по возможности, системой управления устройствами и центром обработки данных, получаемых от устройств. В зоне полевого шлюза находится сам полевой шлюз и все подключенные к нему устройства. Как подразумевает название, полевые шлюзы не используют выделенные средства обработки данных. Обычно они привязаны к расположению, могут подвергаться физическим атакам, а их оперативная избыточность ограничена. Проще говоря, полевой шлюз — обычно именно тот объект, на который могут повлиять или который могут атаковать, так как известны его функции. 

Полевой шлюз отличается от обычного маршрутизатора трафика тем, что ему отведена активная роль в управлении доступом и передачей информации. Это значит, что он является ориентированным на приложения объектом, а также терминалом сетевых подключений или сеансов. Устройства преобразования сетевых адресов и брандмауэры, напротив, не могут считаться полевыми шлюзами, так как они не являются явными терминалами подключений или сеансов. Они просто маршрутизируют (или блокируют) подключения или сеансы, которые осуществляются через них. У полевого шлюза есть две отдельные контактные зоны. Одна из них представляет собой внутреннюю часть зоны и взаимодействует с устройствами, подключенными к шлюзу. Другая же представляет собой границу зоны и взаимодействует со всеми сторонними подключениями.   

### <a name="the-cloud-gateway-zone"></a>Зона облачного шлюза
Облачный шлюз — это система, которая обеспечивает удаленный обмен данными между устройствами или полевыми шлюзами из нескольких различных сайтов через пространство общедоступной сети. Обычно данные передаются в облачную систему управления и анализа данных или федерацию таких систем. В некоторых случаях облачный шлюз позволяет немедленно получить доступ к специализированным устройствам с помощью таких терминалов, как планшеты или телефоны. В этом контексте облако — выделенная система обработки данных, непривязанная к тому же сайту, что подключенные устройства или полевые шлюзы. Кроме того, в зоне облака операционные меры предотвращают целевой физический доступ и не всегда доступны в инфраструктуре общедоступного облака.  

Облачный шлюз можно сопоставить с наложением виртуализации сети, чтобы изолировать трафик этого шлюза и всех устройств или полевых шлюзов, подключенных к нему, от сетевого трафика. Сам облачный шлюз не является ни системой управления устройствами, ни средством обработки или хранения данных устройств. Эти средства только взаимодействуют с ним. Зона облачного шлюза включает в себя сам облачный шлюз и все полевые шлюзы и устройства, прямо или опосредованно подключенные к нему. Граница зоны — это отдельная контактная зона, через которую взаимодействуют все внешние стороны.

### <a name="the-services-zone"></a>Зоны служб
В этом контексте служба — это любой программный компонент или модуль, который взаимодействует с устройствами через полевой или облачный шлюз, чтобы собирать и анализировать данные, а также обеспечивать управление и контроль.  Службы представляют собой посредников. Они используют свои удостоверения, чтобы взаимодействовать со шлюзами и другими подсистемами, хранят и анализируют данные, автономно выполняют команды на устройствах на основе анализа данных или расписаний, а также предоставляют авторизованным пользователям сведения и возможности управления.

### <a name="information-devices-vs-special-purpose-devices"></a>Информационные и специализированные устройства
ПК, телефоны и планшеты — преимущественно интерактивные информационные устройства. Телефоны и планшеты явно оптимизированы для увеличения времени работы от батареи. Они частично переходят в спящий режим, если человек не использует устройство или такие функции, как воспроизведение музыки или навигация. С точки зрения системы люди используют эти информационно-технологические устройства преимущественно в качестве прокси. Они являются воздействующими устройствами, предлагающими действия, и датчиками, которые собирают входные данные. 

Специализированные устройства (простые датчики температуры или сложные фабричные изделия), состоящие из тысяч компонентов, носят совершенно иной характер. Это устройства более узкого предназначения, и даже при наличии пользовательского интерфейса они больше ориентированы на взаимодействие с физическими ресурсами или интеграцию в них. Они измеряют данные окружающей среды и создают отчеты о них, включают клапаны, контролируют работу сервосистемы, подают звуковые сигналы, переключают индикаторы и выполняют множество других задач. Они позволяют делать ту работу, для которой информационные устройства слишком дорогие, большие, непрочные или не предоставляют необходимые функции. Конкретные цели применения позволяют сразу же определить их техническую структуру, а доступный бюджет — объем работы и запланированное время эксплуатации. Вместе эти два ключевых фактора ограничивают занимаемое место и бюджет на потребляемую энергию, а поэтому уменьшают возможности хранения, вычисления и обеспечения безопасности.  

Проблема с автоматически или удаленно управляемыми устройствами, например физический дефект или ошибка в логике управления, может повлечь преднамеренное несанкционированное вторжение и изменение. Это может уничтожить партии изделий, вызвать разграбление здания или пожар, а для людей — травмы или даже смерть. Конечно, этот тип ущерба кардинально отличается от превышения лимита на украденной кредитной карте. Средства безопасности устройств управления, а также для датчиков, которые могут инициировать команды управления, должны быть лучше, чем в любом коммерческом или банковском сценарии. 

### <a name="device-control-and-device-data-interactions"></a>Взаимодействие контроля устройства и данных устройства
Перед подключенными специализированными устройствами открывается большое количество возможных зон и шаблонов взаимодействия, которые необходимо учесть при создании инфраструктуры безопасности цифрового доступа к этим устройствам. Здесь термин "цифровой доступ" используется, чтобы отличить соответствующие операции от тех, которые выполняются при прямом взаимодействии с устройством, когда безопасность обеспечивается за счет физического контроля доступа. Например, устройство находится в комнате, дверь которой закрыта на замок. Хотя физический доступ нельзя запретить с помощью программного обеспечения и оборудования, можно предпринять меры, чтобы предотвратить такой доступ и уменьшить вероятность вмешательства в интерфейс системы. 

Исследуя шаблоны взаимодействия, в рамках моделирования мы уделяли одинаковое внимание контролю устройства и данным устройства. Контроль устройства можно классифицировать как ввод любых сведений, предоставленных устройству любой стороной, чтобы изменить его поведение или повлиять на него, а именно на его состояние или состояние его среды. Данные устройства можно классифицировать как любые сведения о его состоянии и наблюдаемом состоянии его среды, которые устройство предоставляет другой стороне. 

## <a name="threat-modeling-the-azure-iot-reference-architecture"></a>Моделирование рисков эталонной архитектуры Azure IoT
Корпорация Майкрософт использует вышеуказанную платформу, чтобы создавать модели рисков для Azure IoT. В разделе ниже мы используем конкретный пример эталонной архитектуры Azure IoT, чтобы показать, как продумать моделирование рисков для Интернета вещей, а также устранить найденные угрозы. В нашем сценарии мы выявили четыре основных области, на которых следует сосредоточиться:

* устройства и источники данных;
* передача данных;
* обработка устройств и событий;
* Уровень представления

![Моделирование рисков для Azure IoT](media/iot-security-architecture/iot-security-architecture-fig2.png) 

На рисунке ниже показано упрощенное представление архитектуры IoT Microsoft со схемой потоков данных, моделью, которая используется в средстве Майкрософт для моделирования рисков (Microsoft Threat Modeling Tool).

![Моделирование рисков для Azure IoT с помощью средства Microsoft Threat Modeling Tool](media/iot-security-architecture/iot-security-architecture-fig3.png)

Следует отметить, что в этой архитектуре разделены возможности шлюза и устройств. Так пользователь может использовать устройства шлюзов более безопасно: они способны взаимодействовать с облачным шлюзом, используя протоколы безопасности. Обычно это требует больше ресурсов обработки, чем может предоставить собственное устройство, например термостат. Предполагается, что в зоне служб Azure облачный шлюз представлен службой центра IoT Azure.

### <a name="device-and-data-sourcesdata-transport"></a>Устройства, источники данных и передача данных
В этом подразделе подробно рассматривается моделирование рисков вышеописанной архитектуры и приведены общие сведения о том, как устранить некоторые характерные проблемы. Мы рассмотрим следующие основные элементы модели рисков:

* процессы (подконтрольные и внешние);
* взаимодействие (или потоки данных);
* хранение (или хранилища данных).

#### <a name="processes"></a>Процессы
Для каждой из категорий архитектуры Azure IoT мы попытаемся устранить различные риски на разных этапах существования данных: в процессах, при взаимодействии и хранении. Ниже приведен обзор самых распространенных рисков для категории процессов и описание лучших способов того, как их устранить: 

**Спуфинг (Spoofing, далее "S").** Злоумышленник может извлечь материал криптографического ключа из программного обеспечения или оборудования устройства, а затем получить доступ к системе с помощью другого физического или виртуального устройства, используя удостоверение устройства, с которого был украден материал. Хороший пример: с помощью пультов дистанционного управления можно включить любой телевизор, поэтому их часто используют, чтобы подшутить над кем-то.

**Отказ в обслуживании (Denial of Service, далее "D").** Устройство может быть распознано как неработоспособное или неспособное обмениваться данными из-за радиочастотных помех или потому, что обрезаны провода. Например, камера видеонаблюдения, питание или сетевое подключение которой преднамеренно вывели из строя, не будет передавать данные.

**Незаконное изменение (Tampering, далее "T").** Злоумышленник может частично или полностью заменить программное обеспечение, которое работает на устройстве, чтобы другое ПО могло использовать удостоверение подлинности устройства, если материал ключа или средства шифрования, в которых есть материалы ключей, доступны несанкционированной программе. Например, злоумышленник может использовать полученный материал ключа, чтобы перехватить или изъять данные с устройства во время передачи и заменить их ложными данными, для проверки подлинности которых использовался украденный материал ключа.

**Раскрытие информации (Information Disclosure, далее "I").** Если на устройстве работает измененное программное обеспечение, из него возможна утечка данных посторонним лицам. Например, злоумышленник может использовать полученный материал ключа, чтобы вмешаться в обмен данными между устройством и контроллером, полевым или облачным шлюзом, а затем получать сведения.

**Несанкционированное повышение привилегий (Information Disclosure, далее "E").** Устройство, которое выполняет определенную функцию, используют для принудительного выполнения других действий. Например, клапан, запрограммированный открываться наполовину, могут настроить открываться полностью.

| **Компонент** | **Угроза** | **Предотвращение** | **Риск** | **Реализация** |
| --- | --- | --- | --- | --- |
| Устройство |S |Назначить устройству удостоверение и проверять его подлинность |Замена устройства или его части другим устройством. Как узнать, какое из устройств подлинное? |Проверка подлинности устройства с использованием протокола TLS или IPSec. Инфраструктура должна поддерживать общие ключи для тех устройств, которые не выполняют полное асимметричное шифрование. Использование Azure AD, [OAuth](http://www.rfc-editor.org/in-notes/internet-drafts/draft-ietf-ace-oauth-authz-01.txt) |
| TRID |Применить механизмы защиты от незаконного изменения на устройстве, чтобы сделать невозможным извлечение из него ключей и других криптографических материалов |Кто-то может незаконно изменить устройство (физически вмешаться). Нужно убедиться, что устройство не изменили незаконным образом |Устранить риски эффективнее всего позволяет доверенный платформенный модуль. Он позволяет хранить ключи на специальной встроенной схеме, из которой нельзя считать ключи, но их можно использовать только в криптографических операциях, предусматривающих использование ключей без раскрытия. Шифрование памяти устройства. Управление ключами устройства. Подписывание кода | |
| E |Обеспечить контроль доступа к устройству. Применить схему авторизации |Если устройство позволяет выполнять отдельные действия с помощью команд из внешнего источника или даже со скомпрометированного датчика, при атаке оно позволит выполнять операции, которые недоступны при других обстоятельствах |Реализация схемы авторизации для устройства | |
| Полевой шлюз |S |Обеспечить аутентификацию полевого шлюза при доступе к облачному шлюзу (на основе сертификатов, общих ключей, утверждений и т. д.) |Если кто-то может подделать данные полевого шлюза, он сможет выдавать свое устройство за любое другое |TLS RSA/PSK, IPSec, [RFC 4279](https://tools.ietf.org/html/rfc4279). В отношении тех же основных проблем хранения и обеспечения соответствия устройств в целом лучшее решение — использовать доверенный платформенный модуль. Использование расширения 6LowPAN для IPSec, чтобы обеспечить поддержку сетей беспроводных датчиков |
| TRID |Защитить полевой шлюз от незаконного изменения (с помощью доверенного платформенного модуля) |Если спуфингу, направленному на полевой шлюз, подвергнется облачный шлюз, это может повлечь раскрытие информации и незаконное изменение данных |Шифрование памяти, доверенные платформенные модули, проверка подлинности | |
| E |Реализовать механизм контроля доступа для полевого шлюза | | | |

Ниже приведены некоторые примеры угроз, которые могут быть в этой категории.

Спуфинг. Злоумышленник может извлечь материал криптографического ключа из устройства, оборудования или программного обеспечения, а затем получить доступ к системе с помощью другого физического или виртуального устройства, используя удостоверение устройства, с которого украл материал.

**Отказ в обслуживании.** Устройство может быть распознано как неработоспособное или неспособное обмениваться данными из-за радиочастотных помех или потому, что обрезаны провода. Например, камера видеонаблюдения, питание или сетевое подключение которой преднамеренно вывели из строя, не будет передавать данные.

**Незаконное изменение.** Злоумышленник может частично или полностью заменить программное обеспечение, которое работает на устройстве, чтобы ПО могло использовать удостоверение подлинности устройства, если материал ключа или средства шифрования, в которых есть материалы ключей, доступны несанкционированной программе.

**Незаконное изменение.** Чтобы камера видеонаблюдения не засняла злоумышленника, он может настроить в качестве показываемой картинки фотографию пустого коридора. Дымовой или пожарный датчик может передать данные о возгорании, если кто-то держит возле него включенную зажигалку. В обоих случаях устройства полностью технически исправны, но будут сообщать системе сведения, полученные в результате изменений.

**Незаконное изменение.** Злоумышленник может использовать полученный материал ключа, чтобы перехватить или изъять данные с устройства во время передачи и заменить их на ложные данные, а значит аутентифицироваться, используя украденный материал ключа.

**Незаконное изменение.** Злоумышленник может частично или полностью заменить программное обеспечение, которое работает на устройстве, чтобы ПО могло использовать удостоверение подлинности данного устройства, если материал ключа или средства шифрования, в которых есть материалы ключей, доступны несанкционированной программе.

**Раскрытие информации.** Если на устройстве работает измененное программное обеспечение, из него возможна утечка данных посторонним лицам.

**Раскрытие информации.** Злоумышленник может использовать полученный материал ключа, чтобы вмешаться в обмен данными между устройством и контроллером, полевым или облачным шлюзом, а затем получать сведения.

**Отказ в обслуживании.** Устройство может быть отключено или включено в режиме, в котором невозможно поддерживать связь (это могут делать преднамеренно со многими производственными установками).

**Незаконное изменение.** Для устройства могут настроить другое неизвестное системе управления состояние (параметры, которые не относятся к эталонным), из-за чего устройство будет передавать данные, которые можно неправильно интерпретировать.

**Несанкционированное повышение привилегий.** Это случай, когда устройство, которое выполняет определенную функцию, используют для принудительного выполнения других действий. Например, клапан, запрограммированный открываться наполовину, могут настроить открываться полностью.

**Отказ в обслуживании.** Устройство могут перевести в состояние, при котором невозможно поддерживать связь.

**Незаконное изменение.** Для устройства могут настроить другое неизвестное системе управления состояние (параметры, которые не относятся к эталонным), из-за чего устройство будет передавать данные, которые можно неправильно интерпретировать.

**Спуфинг, незаконное изменение данных и отказ.** При отсутствии защиты (она редко используется в потребительских пультах дистанционного управления) злоумышленник может анонимно изменять состояние устройства. Хороший пример: с помощью пультов дистанционного управления можно включить любой телевизор, поэтому их часто используют, чтобы подшутить над кем-то.

#### <a name="communication"></a>Обмен данными
Здесь описаны угрозы, связанные с путем обмена данными между устройствами, устройствами и полевыми или облачными шлюзами. В таблице ниже приведены некоторые рекомендации по использованию открытых портов устройств и VPN:

| **Компонент** | **Угроза** | **Предотвращение** | **Риск** | **Реализация** |
| --- | --- | --- | --- | --- |
| Устройство, центр IoT |TID |(От D) использовать TLS (для общих ключей или RSA), чтобы шифровать трафик |Перехват данных обмена между устройством и шлюзом или вмешательство в обмен |Обеспечение безопасности на уровне протокола. При использовании пользовательских протоколов нужно выяснить, как обеспечить соответствующую защиту. В большинстве случаев устройство отправляет данные в центр IoT (инициирует подключение) |
| Устройство, устройство |TID |(От D) использовать TLS (для общих ключей или RSA), чтобы шифровать трафик |Считывание данных при их передаче между устройствами. Незаконное изменение данных. Перегрузка устройства новыми подключениями |Обеспечение безопасности на уровне протокола (HTTP, HTTPS, AMQP, MQTT или CoAP). При использовании пользовательских протоколов нужно выяснить, как обеспечить соответствующую защиту. Чтобы устранить риск атаки типа "отказ в обслуживании", нужно устанавливать одноранговые подключения устройств через полевой или облачный шлюз, чтобы они работали в качестве клиентов по отношению к сети. Пиринг может повлечь создание прямого подключения между одноранговыми узлами через шлюз |
| Внешняя сущность, устройство |TID |Надежное подключение внешней сущности к устройству |Перехват подключения к устройству. Вмешательство в обмен данными с устройством |Обеспечить безопасное подключение внешней сущности к устройству, используя технологию Bluetooth с низким энергопотреблением или NFC. Обеспечить контроль рабочей панели устройства (физический) |
| Полевой шлюз, облачный шлюз |TID |Использовать TLS (для общих ключей или RSA), чтобы шифровать трафик |Перехват данных обмена между устройством и шлюзом или вмешательство в обмен |Обеспечение безопасности на уровне протокола (HTTP, HTTPS, AMQP, MQTT или CoAP). При использовании пользовательских протоколов нужно выяснить, как обеспечить соответствующую защиту. |
| Устройство, облачный шлюз |TID |Использовать TLS (для общих ключей или RSA), чтобы шифровать трафик |Перехват данных обмена между устройством и шлюзом или вмешательство в обмен |Обеспечение безопасности на уровне протокола (HTTP, HTTPS, AMQP, MQTT или CoAP). При использовании пользовательских протоколов нужно выяснить, как обеспечить соответствующую защиту. |

Ниже приведены некоторые примеры угроз, которые могут быть в этой категории.

**Отказ в обслуживании.** Устройства с ограниченными функциями обычно подвержены угрозе атаки типа "отказ в обслуживании", если активно прослушивают входящие подключения или нежелательные датаграммы в сети, так как злоумышленник может открыть много параллельных подключений, не обслуживать их либо обслуживать их очень медленно или устройство может быть перегружено нежелательным трафиком. В обоих случаях сеть может распознать устройство как неработоспособное.

**Спуфинг, раскрытие информации.** Устройства с ограниченными функциями и специализированные устройства часто используют общие средства защиты, такие как пароль или ПИН-код, или полностью полагаются на доверенную сеть. Это значит, что они будут предоставлять доступ к сведениям устройств в той же сети, которая зачастую защищена только общим ключом. Следовательно, при раскрытии общего секрета устройства или сети можно будет управлять этим устройством или просматривать данные, которые оно отправляет.  

**Спуфинг.** Злоумышленник может перехватить сигнал вещания, частично переопределить его данные или выдать себя за отправителя (вмешаться).

**Незаконное изменение.** Злоумышленник может перехватить сигнал вещания, частично переопределить его данные и отправить ложные сведения. 

**Раскрытие информации.** Злоумышленник может перехватывать сигнал вещания и получить сведения без авторизации. **Отказ в обслуживании.** Злоумышленник может перехватить сигнал вещания и отказать в распространении информации.

#### <a name="storage"></a>Хранилище
У каждого устройства и полевого шлюза есть определенная форма хранилища (место временного хранения очередей данных или образов операционных систем).

| **Компонент** | **Угроза** | **Предотвращение** | **Риск** | **Реализация** |
| --- | --- | --- | --- | --- |
| Хранилище устройства |TRID |Шифрование хранилища, подписывание журналов |Чтение (личных) данных из хранилища, незаконное изменение данных телеметрии. Незаконное изменение данных управления командами, которые находятся в очереди или кэше. Незаконное изменение пакетов обновления конфигурации или встроенного ПО, которые есть в локальной очереди или локальном кэше, может повлечь компрометацию операционной системы или ее компонентов. |Шифрование, использование кода проверки подлинности сообщения или цифровых подписей. Обеспечение строгого контроля доступа к ресурсам с помощью списков управления доступом (ACL) или разрешений |
| Образ ОС устройства |TRID | |Незаконное изменение ОС или замена ее компонентов |Секционирование ОС только для чтения, подписывание образов ОС, шифрование |
| Хранилище полевого шлюза (для хранения очередей данных) |TRID |Шифрование хранилища, подписывание журналов |Чтение (личных) данных из хранилища, незаконное изменение данных телеметрии, а также данных управления командами, которые находятся в очереди или кэше. Незаконное изменение пакетов обновления конфигурации или встроенного ПО (предназначенных для устройств или полевого шлюза), которые есть в локальной очереди или локальном кэше, может повлечь компрометацию операционной системы или ее компонентов. |BitLocker |
| Образ ОС полевого шлюза |TRID | |Незаконное изменение ОС или замена ее компонентов |Секционирование ОС только для чтения, подписывание образов ОС, шифрование |

### <a name="device-and-event-processingcloud-gateway-zone"></a>Обработка устройств и событий. Зона облачного шлюза
Облачный шлюз — это система, которая обеспечивает удаленный обмен данными между устройствами или полевыми шлюзами поля из нескольких различных сайтов через пространство общедоступной сети. Обычно данные передаются в облачную систему управления и анализа данных или федерацию таких систем. В некоторых случаях облачный шлюз позволяет немедленно получить доступ к специализированным устройствам с помощью таких терминалов, как планшеты или телефоны. В этом контексте под облаком подразумевается выделенная система обработки данных, непривязанная к тому же сайту, что подключенные устройства или полевые шлюзы. В облаке операционные измерения предотвращают целевой физический доступ и не всегда доступны в инфраструктуре общедоступного облака.  Облачный шлюз можно сопоставить с наложением виртуализации сети, чтобы изолировать трафик этого шлюза и всех устройств или полевых шлюзов, подключенных к нему, от сетевого трафика. Сам облачный шлюз не является ни системой управления устройствами, ни средством обработки или хранения данных устройств. Эти средства только взаимодействуют с ним. Зона облачного шлюза включает в себя сам облачный шлюз и все полевые шлюзы и устройства, прямо или опосредованно подключенные к нему.

Облачный шлюз — в большей степени компонент программного обеспечения, разрабатываемый пользователями, который работает в качестве службы и предоставляет конечные точки для подключения устройств и полевого шлюза. Следовательно, при его разработке нужно спланировать систему безопасности. При разработке и создании этой службы следуйте соответствующей процедуре для [SDL](http://www.microsoft.com/sdl). 

#### <a name="services-zone"></a>Зона служб
Система контроля (или контроллер) — это программное решение, которое взаимодействует с устройством, полевым или облачным шлюзом, чтобы контролировать одно или несколько устройств, собирать, хранить и/или анализировать их данные. Оно позволяет использовать результаты, чтобы сформировать представление, или для дальнейшего контроля. Это единственная сущность в этом обсуждении, которая позволяет немедленно получить доступ для взаимодействия с пользователями. Исключение представляют промежуточные физические зоны контроля на устройствах, такие как выключатели. Они позволяют выключать устройства, а также изменять свойства. Другого такого функционального устройства, к которому можно получить цифровой доступ, нет. 

Промежуточные физические зоны контроля — это области, в которых логики регулирования ограничивают функции физической зоны контроля, чтобы предотвратить удаленное управление эквивалентными функциями или конфликты удаленного ввода. Эти промежуточные зоны по сути подключаются к локальной системе управления, которая использует те же базовые функции, что и любая другая система удаленного управления, к которой устройство может быть подключено параллельно. Дополнительные сведения о самых распространенных угрозах безопасности облачных вычислений см. на странице [Cloud Security Alliance (CSA)](https://cloudsecurityalliance.org/research/top-threats/).

## <a name="additional-resources"></a>Дополнительные ресурсы
Дополнительные сведения см. в следующих статьях:

* [Средство моделирования угроз SDL](https://www.microsoft.com/sdl/adopt/threatmodeling.aspx)
* [Эталонная архитектура Центра интернета вещей Microsoft Azure](https://azure.microsoft.com/updates/microsoft-azure-iot-reference-architecture-available/)

## <a name="see-also"></a>См. также
Дополнительные сведения о безопасности решения Центра Интернета вещей см. в статье [Защита развертывания IoT][lnk-security-deployment].

Вы также можете ознакомиться с другими функциями и возможностями предварительно настроенных решений IoT Suite.

* [Обзор предварительно настроенного решения прогнозируемого обслуживания][lnk-predictive-overview]
* [Часто задаваемые вопросы об IoT Suite][lnk-faq]

Сведения о безопасности Центра Интернета вещей см. в статье [Управление доступом к Центру Интернета вещей][lnk-devguide-security] в руководстве для разработчиков.

[lnk-predictive-overview]: iot-suite-predictive-overview.md
[lnk-faq]: iot-suite-faq.md

[lnk-security-deployment]: iot-suite-security-deployment.md
[lnk-devguide-security]: ../iot-hub/iot-hub-devguide-security.md