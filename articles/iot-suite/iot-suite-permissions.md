---
title: "Azure IoT Suite и Azure Active Directory | Документация Майкрософт"
description: "В этой статье описывается, как набор Azure IoT Suite использует Azure Active Directory для управления разрешениями."
services: 
suite: iot-suite
documentationcenter: 
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 246228ba-954a-4d96-b6d6-e53e4590cb4f
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/15/2017
ms.author: dobett
ms.openlocfilehash: f67c7bfa3f0ea7b720c8684cc0c501be3e464373
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="permissions-on-the-azureiotsuitecom-site"></a>Разрешения на сайте azureiotsuite.com

## <a name="what-happens-when-you-sign-in"></a>Что происходит при входе

При первом входе сайт [azureiotsuite.com][lnk-azureiotsuite] определяет ваши уровни разрешений в зависимости от выбранного клиента Azure Active Directory (AAD) и подписки Azure.

1. Сначала сайт получает из Azure сведения о ваших клиентах AAD, чтобы заполнить список клиентов, который отображается рядом с вашим именем пользователя после входа. В настоящее время сайт может одновременно получать маркеры пользователя только для одного клиента. Поэтому, если вы переключитесь между клиентами в раскрывающемся списке в правом верхнем углу сайта, вам придется выполнить вход с указанием этого клиента, чтобы получить для него маркеры.

2. После этого сайт получает из Azure сведения о подписках, связанных с выбранным клиентом. Доступные подписки можно просмотреть при создании нового предварительно настроенного решения.

3. Наконец, сайт получает сведения о всех ресурсах в подписках и группах ресурсов, помеченных как предварительно настроенные решения, и заполняет элементы на домашней странице.

В следующих разделах описываются роли, которые позволяют управлять доступом к предварительно настроенным решениям.

## <a name="aad-roles"></a>Роли AAD

Роли AAD определяют возможность подготавливать предварительно настроенные решения и управлять пользователями в предварительно настроенных решениях.

Дополнительные сведения о ролях администратора в AAD см. в статье [Назначение ролей администратора в Azure AD][lnk-aad-admin]. В этой статье основное внимание уделяется ролям **глобального администратора**, а также **пользовательским** ролям каталога, которые используются в предварительно настроенных решениях.

### <a name="global-administrator"></a>Глобальный администратор.

В одном клиенте AAD может быть несколько глобальных администраторов.

* Создавая клиент AAD, вы по умолчанию становитесь его глобальным администратором.
* Глобальный администратор может подготовить предварительно настроенное решение. В таком случае ему назначается роль **администратора** приложения в клиенте AAD.
* Если другой пользователь в том же клиенте AAD создаст приложение, глобальному администратору будет по умолчанию присвоена роль **только для чтения**.
* Глобальный администратор может назначать пользователям роли для приложений, используя [портал Azure][lnk-portal].

### <a name="domain-user"></a>Пользователь домена

На каждый клиент AAD может приходиться много пользователей домена.

* Пользователь домена может подготовить предварительно настроенное решение на сайте [azureiotsuite.com][lnk-azureiotsuite]. По умолчанию пользователю домена предоставляется роль **Администратор** в подготавливаемом приложении.
* Пользователь домена может создать приложение с помощью скрипта build.cmd в репозитории [azure-iot-remote-monitoring][lnk-rm-github-repo], [azure-iot-predictive-maintenance][lnk-pm-github-repo] или [azure-iot-connected-factory][lnk-cf-github-repo]. Однако ему по умолчанию присваивается роль **только для чтения**, так как он не имеет права назначать роли.
* Если другой пользователь в клиенте AAD создаст приложение, пользователю домена по умолчанию будет присвоена роль **только для чтения** для этого приложения.
* Пользователь домена не может назначать роли для приложений, поэтому он не может добавлять пользователей к ролям или присваивать пользователям роли для приложения, даже если он подготовил это приложение.

### <a name="guest-user"></a>Гостевой пользователь

В одном клиенте AAD может быть много гостевых пользователей. Пользователи-гости обладают ограниченным набором прав в клиенте AAD. Поэтому они не могут подготавливать предварительно настроенные решения в клиенте AAD.

Дополнительные сведения о пользователях и ролях в AAD см. в следующих ресурсах:

* [Добавление новых пользователей или пользователей с учетными записями Майкрософт в Azure Active Directory][lnk-create-edit-users]
* [Назначение пользователя или группы корпоративному приложению в предварительной версии Azure Active Directory][lnk-assign-app-roles]

## <a name="azure-subscription-administrator-roles"></a>Роли администратора подписки Azure

Роли администратора Azure определяют возможность сопоставлять подписку Azure с клиентом AD.

Дополнительные сведения о ролях администраторов Azure см. в статье [Добавление или изменение ролей администратора Azure, управляющих подписками и службами][lnk-admin-roles].

## <a name="application-roles"></a>Роли приложений

Роли приложения позволяют контролировать доступ к устройствам в рамках предварительно настроенного решения.

В подготовленном приложении существует две определенные и одна неявная роль.

* **Администратор** может добавлять, удалять устройства и управлять ими, а также изменять параметры.
* **Только для чтения.** Просмотр устройств, правил, действий, заданий и телеметрии.

Вы можете найти разрешения, назначаемые каждой роли, в исходном файле [RolePermissions.cs][lnk-resource-cs].

### <a name="changing-application-roles-for-a-user"></a>Изменение ролей приложений для пользователя

Чтобы сделать пользователя в Active Directory администратором предварительно настроенного решения, можно выполнить описанную ниже процедуру.

Изменять роли пользователей может только глобальный администратор AAD.

1. Перейдите на [портал Azure][lnk-portal].
2. Выберите **Azure Active Directory**.
3. Убедитесь, что вы используете каталог, который вы выбрали на сайте azureiotsuite.com при подготовке решения. При наличии нескольких каталогов, связанных с подпиской, можно переключаться между ними, щелкнув имя учетной записи в правом верхнем углу страницы портала.
4. Щелкните **Корпоративные приложения**, а затем **Все приложения**.
4. Отобразите **все приложения** с состоянием **Любой**. Затем найдите приложения с именем вашего предварительно настроенного решения.
5. Щелкните имя приложения, совпадающее с именем предварительно настроенного решения.
6. Щелкните **Пользователи и группы**.
7. Выберите пользователя, для которого нужно изменить роли.
8. Щелкните **Назначить** и выберите роль (например, **Администратор**), которую нужно назначить пользователю, установив соответствующий флажок.

## <a name="faq"></a>Часто задаваемые вопросы

### <a name="im-a-service-administrator-and-id-like-to-change-the-directory-mapping-between-my-subscription-and-a-specific-aad-tenant-how-do-i-complete-this-task"></a>Я являюсь администратором службы и хочу изменить сопоставление каталогов подписки и конкретного клиента AAD. Как выполнить эту задачу?

1. Войдите на [классический портал Azure][lnk-classic-portal] и выберите пункт **Параметры** в списке служб слева.
2. Выберите подписку, для которой вы хотите изменить сопоставление каталогов.
3. Щелкните **Изменить каталог**.
4. Выберите в раскрывающемся списке **каталог** , который следует использовать. Щелкните стрелку «Далее».
5. Проверьте сопоставление каталога и соответствующих соадминистраторов. При перемещении из другого каталога удаляются все соадминистраторы из исходного каталога.

### <a name="im-a-domain-usermember-on-the-aad-tenant-and-ive-created-a-preconfigured-solution-how-do-i-get-assigned-a-role-for-my-application"></a>Я являюсь пользователем (членом) домена в клиенте AAD и создаю предварительно настроенное решение. Как мне получить роль для своего приложения?

Попросите глобального администратора назначить вас глобальным администратором клиента AAD, а затем назначьте роли пользователям самостоятельно. Кроме того, вы можете попросить глобального администратора назначить вам роль напрямую. Если вы хотите сменить клиент AAD, в котором развернуто ваше предварительно настроенное решение, см. следующий вопрос.

### <a name="how-do-i-switch-the-aad-tenant-my-remote-monitoring-preconfigured-solution-and-application-are-assigned-to"></a>Как сменить клиент AAD, которому назначены мое предварительно настроенное решение удаленного мониторинга и приложение?

Можно запустить развернутую облачную службу со страницы <https://github.com/Azure/azure-iot-remote-monitoring> и повторить развертывание в новом клиенте AAD. При создании клиента AAD вы по умолчанию назначаетесь глобальным администратором с разрешениями на добавление пользователей и назначение им ролей.

1. Создайте каталог AAD на [портале Azure][lnk-portal].
2. Перейдите на страницу <https://github.com/Azure/azure-iot-remote-monitoring>.
3. Выполните команду `build.cmd cloud [debug | release] {name of previously deployed remote monitoring solution}` (например, `build.cmd cloud debug myRMSolution`).
4. При появлении запроса задайте параметр **tenantid** для нового клиента вместо предыдущего клиента.

### <a name="i-want-to-change-a-service-administrator-or-co-administrator-when-logged-in-with-an-organisational-account"></a>Я хочу сменить администратора службы и соадминистратора при входе в систему с использованием учетной записи организации

См. справочную статью [Смена администратора службы и соадминистратора при входе в систему с использованием учетной записи организации][lnk-service-admins].

### <a name="why-am-i-seeing-this-error-your-account-does-not-have-the-proper-permissions-to-create-a-solution-please-check-with-your-account-administrator-or-try-with-a-different-account"></a>Почему появляется ошибка «У вашей учетной записи нет необходимых разрешений для создания решения. Обратитесь к администратору учетной записи или попробуйте использовать другую учетную запись»

Руководствуйтесь следующей схемой:

![][img-flowchart]

> [!NOTE]
> Вы выполнили проверку, которая подтверждает ваши права глобального администратора на клиенте AAD и соадминистратора подписки, но ошибка не устранена. В таком случае администратор учетной записи должен удалить этого пользователя и повторно назначить необходимые разрешения в указанном порядке. Сначала добавить пользователя в качестве глобального администратора, а затем — пользователя в качестве соадминистратора подписки Azure. Если проблемы не удается устранить, обратитесь в службу [справки и поддержки][lnk-help-support].

### <a name="why-am-i-seeing-this-error-when-i-have-an-azure-subscription-an-azure-subscription-is-required-to-create-pre-configured-solutions-you-can-create-a-free-trial-account-in-just-a-couple-of-minutes"></a>Почему эта ошибка появляется при наличии подписки Azure? "Для создания предварительно настроенных решений требуется подписка Azure. Вы можете создать бесплатную пробную учетную запись всего за несколько минут".

Если точно известно, что у вас есть подписка Azure, проверьте сопоставление клиентов для своей подписки и убедитесь, что в раскрывающемся списке выбран правильный клиент. Если клиент выбран правильно, следуйте приведенной выше схеме и проверьте сопоставление подписки и этого клиента AAD.

## <a name="next-steps"></a>Дальнейшие действия
Чтобы продолжить изучение IoT Suite, см. статью [Настройка предварительно настроенного решения][lnk-customize].

[img-flowchart]: media/iot-suite-permissions/flowchart.png

[lnk-azureiotsuite]: https://www.azureiotsuite.com/
[lnk-rm-github-repo]: https://github.com/Azure/azure-iot-remote-monitoring
[lnk-pm-github-repo]: https://github.com/Azure/azure-iot-predictive-maintenance
[lnk-cf-github-repo]: https://github.com/Azure/azure-iot-connected-factory
[lnk-aad-admin]: ../active-directory/active-directory-assign-admin-roles.md
[lnk-classic-portal]: https://manage.windowsazure.com/
[lnk-portal]: https://portal.azure.com/
[lnk-create-edit-users]: ../active-directory/active-directory-create-users.md
[lnk-assign-app-roles]: ../active-directory/active-directory-coreapps-assign-user-azure-portal.md
[lnk-service-admins]: https://azure.microsoft.com/support/changing-service-admin-and-co-admin/
[lnk-admin-roles]: ../billing/billing-add-change-azure-subscription-administrator.md
[lnk-resource-cs]: https://github.com/Azure/azure-iot-remote-monitoring/blob/master/DeviceAdministration/Web/Security/RolePermissions.cs
[lnk-help-support]: https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade
[lnk-customize]: iot-suite-guidance-on-customizing-preconfigured-solutions.md
