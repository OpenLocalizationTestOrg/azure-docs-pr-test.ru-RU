---
title: "уровни aaaConsistency в базе данных Azure Cosmos | Документы Microsoft"
description: "Azure Cosmos DB имеет пять согласованности уровни toohelp баланс окончательной согласованности, доступность и задержки компромиссы."
keywords: "согласованность в конечном счете, azure cosmos db, azure, Microsoft Azure"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: cgronlun
documentationcenter: 
ms.assetid: 3fe51cfa-a889-4a4a-b320-16bf871fe74c
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/16/2017
ms.author: mimig
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: ac399c229d0856cd811bc81568536e519af3300f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="tunable-data-consistency-levels-in-azure-cosmos-db"></a><span data-ttu-id="43583-104">Настраиваемые уровни согласованности данных в Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="43583-104">Tunable data consistency levels in Azure Cosmos DB</span></span>
<span data-ttu-id="43583-105">Azure Cosmos DB предназначен из hello основание, глобальные распространения с точки зрения каждая модель данных.</span><span class="sxs-lookup"><span data-stu-id="43583-105">Azure Cosmos DB is designed from hello ground up with global distribution in mind for every data model.</span></span> <span data-ttu-id="43583-106">Это гарантирует прогнозируемый низкой задержкой спроектированный toooffer, 99,99% доступности соглашения об уровне ОБСЛУЖИВАНИЯ, и нескольких четко определенных ослаблены согласованности моделей.</span><span class="sxs-lookup"><span data-stu-id="43583-106">It is designed toooffer predictable low latency guarantees, a 99.99% availability SLA, and multiple well-defined relaxed consistency models.</span></span> <span data-ttu-id="43583-107">Сейчас Azure Cosmos DB поддерживает пять уровней согласованности: строгий, с ограниченным устареванием, уровня сеанса, согласованность префиксов и согласованный в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-107">Currently, Azure Cosmos DB provides five consistency levels: strong, bounded-staleness, session, consistent prefix, and eventual.</span></span> 

<span data-ttu-id="43583-108">Помимо **строгой** модели и модели **согласованности в конечном счете**, обычно предусмотренных в распределенных базах данных, Azure Cosmos DB предлагает три тщательно кодифицированные и реализованные практически модели согласованности, эффективность которых была подтверждена реальными случаями использования.</span><span class="sxs-lookup"><span data-stu-id="43583-108">Besides **strong** and **eventual consistency** models commonly offered by distributed databases, Azure Cosmos DB offers three more carefully codified and operationalized consistency models, and has validated their usefulness against real world use cases.</span></span> <span data-ttu-id="43583-109">Это hello **ограниченных устаревание**, **сеанса**, и **согласованное префикс** уровни согласованности.</span><span class="sxs-lookup"><span data-stu-id="43583-109">These are hello **bounded staleness**, **session**, and **consistent prefix** consistency levels.</span></span> <span data-ttu-id="43583-110">Вместе эти уровни согласованности пять включить toomake хорошо зрения компромиссы между согласованности, доступность и задержки.</span><span class="sxs-lookup"><span data-stu-id="43583-110">Collectively these five consistency levels enable you toomake well-reasoned trade-offs between consistency, availability, and latency.</span></span> 

## <a name="distributed-databases-and-consistency"></a><span data-ttu-id="43583-111">Распределенные базы данных и согласованность</span><span class="sxs-lookup"><span data-stu-id="43583-111">Distributed databases and consistency</span></span>
<span data-ttu-id="43583-112">Коммерческие распределенные базы данных делятся на две категории: базы данных, которые вообще не предлагают точно определенные, проверяемые варианты согласованности, и базы данных, которые обеспечивают два радикальных варианта программирования (строгая и итоговая согласованность).</span><span class="sxs-lookup"><span data-stu-id="43583-112">Commercial distributed databases fall into two categories: databases that do not offer well-defined, provable consistency choices at all, and databases which offer two extreme programmability choices (strong vs. eventual consistency).</span></span> 

<span data-ttu-id="43583-113">Здравствуйте бывшая работы разработчиков приложений с детали их протоколов репликации и ожидает их toomake трудно компромисса между согласованности, доступность, задержка и пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="43583-113">hello former burdens application developers with minutia of their replication protocols and expects them toomake difficult tradeoffs between consistency, availability, latency, and throughput.</span></span> <span data-ttu-id="43583-114">последний Hello помещает toochoose давление, один из крайними hello.</span><span class="sxs-lookup"><span data-stu-id="43583-114">hello latter puts a pressure toochoose one of hello two extremes.</span></span> <span data-ttu-id="43583-115">Несмотря на множество hello исследования и предложения для более чем 50 согласованности моделей hello сообщества распределенной базы данных не было возможности toocommercialize уровни согласованности за надежный и окончательной согласованности.</span><span class="sxs-lookup"><span data-stu-id="43583-115">Despite hello abundance of research and proposals for more than 50 consistency models, hello distributed database community has not been able toocommercialize consistency levels beyond strong and eventual consistency.</span></span> <span data-ttu-id="43583-116">Cosmos DB позволяет разработчикам toochoose между пять моделей четко определенных согласованности вдоль спектра согласованности hello — надежный, ограниченных устаревание, [сеанса](http://dl.acm.org/citation.cfm?id=383631), согласованных префикс и окончательным.</span><span class="sxs-lookup"><span data-stu-id="43583-116">Cosmos DB allows developers toochoose between five well-defined consistency models along hello consistency spectrum – strong, bounded staleness, [session](http://dl.acm.org/citation.cfm?id=383631), consistent prefix, and eventual.</span></span> 

![Azure Cosmos DB предлагает несколько, хорошо определенные (ослабленной) согласованности toochoose моделей из](./media/consistency-levels/five-consistency-levels.png)

<span data-ttu-id="43583-118">Hello в следующей таблице показано hello определенной гарантии, которые предоставляет каждый уровень согласованности.</span><span class="sxs-lookup"><span data-stu-id="43583-118">hello following table illustrates hello specific guarantees each consistency level provides.</span></span>
 
<span data-ttu-id="43583-119">**Уровни согласованности и гарантии**</span><span class="sxs-lookup"><span data-stu-id="43583-119">**Consistency Levels and guarantees**</span></span>

| <span data-ttu-id="43583-120">Уровень согласованности</span><span class="sxs-lookup"><span data-stu-id="43583-120">Consistency Level</span></span> | <span data-ttu-id="43583-121">Гарантии</span><span class="sxs-lookup"><span data-stu-id="43583-121">Guarantees</span></span> |
| --- | --- |
| <span data-ttu-id="43583-122">Уровень согласованности Strong (сильная)</span><span class="sxs-lookup"><span data-stu-id="43583-122">Strong</span></span> | <span data-ttu-id="43583-123">Линеаризация</span><span class="sxs-lookup"><span data-stu-id="43583-123">Linearizability</span></span> |
| <span data-ttu-id="43583-124">Ограниченное устаревание</span><span class="sxs-lookup"><span data-stu-id="43583-124">Bounded Staleness</span></span> | <span data-ttu-id="43583-125">Согласованность префиксов.</span><span class="sxs-lookup"><span data-stu-id="43583-125">Consistent Prefix.</span></span> <span data-ttu-id="43583-126">Операции чтения могут отставать от операций записи не более чем на K префиксов или на интервал времени t.</span><span class="sxs-lookup"><span data-stu-id="43583-126">Reads lag behind writes by k prefixes or t interval</span></span> |
| <span data-ttu-id="43583-127">Сеанс</span><span class="sxs-lookup"><span data-stu-id="43583-127">Session</span></span>   | <span data-ttu-id="43583-128">Согласованность префиксов.</span><span class="sxs-lookup"><span data-stu-id="43583-128">Consistent Prefix.</span></span> <span data-ttu-id="43583-129">Монотонные операции чтения и записи, чтение собственных операций записи, запись после чтения.</span><span class="sxs-lookup"><span data-stu-id="43583-129">Monotonic reads, monotonic writes, read-your-writes, write-follows-reads</span></span> |
| <span data-ttu-id="43583-130">Согласованность префиксов</span><span class="sxs-lookup"><span data-stu-id="43583-130">Consistent Prefix</span></span> | <span data-ttu-id="43583-131">Обновления, возвращаются, некоторые префикс для всех обновлений hello с без промежутков</span><span class="sxs-lookup"><span data-stu-id="43583-131">Updates returned are some prefix of all hello updates, with no gaps</span></span> |
| <span data-ttu-id="43583-132">Уровень согласованности Eventual (в конечном счете)</span><span class="sxs-lookup"><span data-stu-id="43583-132">Eventual</span></span>  | <span data-ttu-id="43583-133">Неупорядоченное чтение</span><span class="sxs-lookup"><span data-stu-id="43583-133">Out of order reads</span></span> |

<span data-ttu-id="43583-134">Можно настроить уровень согласованности по умолчанию hello в вашей учетной записи Cosmos DB (и позже переопределение согласованности hello на конкретный запрос чтения).</span><span class="sxs-lookup"><span data-stu-id="43583-134">You can configure hello default consistency level on your Cosmos DB account (and later override hello consistency on a specific read request).</span></span> <span data-ttu-id="43583-135">На внутреннем уровне уровень согласованности по умолчанию hello применяется toodata внутри hello наборы разделов, которые могут охватывать несколько регионов.</span><span class="sxs-lookup"><span data-stu-id="43583-135">Internally, hello default consistency level applies toodata within hello partition sets which may span regions.</span></span> <span data-ttu-id="43583-136">Около 73 % наших клиентов использует согласованность уровня сеанса, а 20 % предпочитают согласованность с ограниченным устареванием.</span><span class="sxs-lookup"><span data-stu-id="43583-136">About 73% of our tenants use session consistency and 20% prefer bounded staleness.</span></span> <span data-ttu-id="43583-137">Мы заметили, что примерно 3 % наших клиентов экспериментируют с различными уровнями согласованности, прежде чем устанавливать определенную согласованность для своего приложения.</span><span class="sxs-lookup"><span data-stu-id="43583-137">We observe that approximately 3% of our customers experiment with various consistency levels initially before settling on a specific consistency choice for their application.</span></span> <span data-ttu-id="43583-138">Мы также заметили, что всего 2 % наших клиентов переопределяет уровни согласованности для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="43583-138">We also observe that only 2% of our tenants override consistency levels on a per request basis.</span></span> 

<span data-ttu-id="43583-139">В Cosmos DB операции чтения, выполняемые с согласованностью уровня сеанса, согласованностью префиксов и согласованностью в конечном счете в два раза дешевле, чем операции чтения, выполняемые со строгой согласованностью или согласованностью с ограниченным устареванием.</span><span class="sxs-lookup"><span data-stu-id="43583-139">In Cosmos DB, reads served at session, consistent prefix and eventual consistency are twice as cheap as reads with strong or bounded staleness consistency.</span></span> <span data-ttu-id="43583-140">Cosmos DB обеспечивает лучшие в отрасли соглашения об уровне обслуживания (SLA) с доступностью на уровне 99,99 %, включая гарантии согласованности и доступности, высокий показатель пропускной способности и низкий уровень задержки.</span><span class="sxs-lookup"><span data-stu-id="43583-140">Cosmos DB has industry leading comprehensive 99.99% SLAs including consistency guarantees along with availability, throughput, and latency.</span></span> <span data-ttu-id="43583-141">Мы [linearizability проверки](http://dl.acm.org/citation.cfm?id=1806634), который постоянно работает над нашей службы телеметрии и открыто сообщает любой tooyou нарушений целостности.</span><span class="sxs-lookup"><span data-stu-id="43583-141">We employ a [linearizability checker](http://dl.acm.org/citation.cfm?id=1806634), which continuously operates over our service telemetry and openly reports any consistency violations tooyou.</span></span> <span data-ttu-id="43583-142">Для ограниченного устаревание мы мониторинг и создание отчетов, как было нарушения и t границы.</span><span class="sxs-lookup"><span data-stu-id="43583-142">For bounded staleness, we monitor and report any violations took and t bounds.</span></span> <span data-ttu-id="43583-143">Для всех пяти уровней ослабленной согласованности мы отчетов hello [вероятностный ограниченным устареванием метрика](http://dl.acm.org/citation.cfm?id=2212359) tooyou напрямую.</span><span class="sxs-lookup"><span data-stu-id="43583-143">For all five relaxed consistency levels, we also report hello [probabilistic bounded staleness metric](http://dl.acm.org/citation.cfm?id=2212359) directly tooyou.</span></span>  

## <a name="scope-of-consistency"></a><span data-ttu-id="43583-144">Область действия согласованности</span><span class="sxs-lookup"><span data-stu-id="43583-144">Scope of consistency</span></span>
<span data-ttu-id="43583-145">Гранулярность Hello согласованности — запрос с областью tooa одного пользователя.</span><span class="sxs-lookup"><span data-stu-id="43583-145">hello granularity of consistency is scoped tooa single user request.</span></span> <span data-ttu-id="43583-146">Запрос записи может соответствуют tooan вставки, замены, вставки-обновления или удаления транзакции.</span><span class="sxs-lookup"><span data-stu-id="43583-146">A write request may correspond tooan insert, replace, upsert, or delete transaction.</span></span> <span data-ttu-id="43583-147">С помощью записи и чтения или запрос транзакция также — запрос одного пользователя с областью tooa.</span><span class="sxs-lookup"><span data-stu-id="43583-147">As with writes, a read/query transaction is also scoped tooa single user request.</span></span> <span data-ttu-id="43583-148">Hello пользователя может быть обязательным toopaginate большой результирующий набор, объединение нескольких секций, но каждое чтение транзакция с областью tooa одной страницы и предоставляемого в одной секции.</span><span class="sxs-lookup"><span data-stu-id="43583-148">hello user may be required toopaginate over a large result-set, spanning multiple partitions, but each read transaction is scoped tooa single page and served from within a single partition.</span></span>

## <a name="consistency-levels"></a><span data-ttu-id="43583-149">Уровни согласованности</span><span class="sxs-lookup"><span data-stu-id="43583-149">Consistency levels</span></span>
<span data-ttu-id="43583-150">Можно настроить уровень согласованности по умолчанию в вашей учетной записи базы данных, применяющий tooall коллекций (и базы данных) в рамках учетной записи Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="43583-150">You can configure a default consistency level on your database account that applies tooall collections (and databases) under your Cosmos DB account.</span></span> <span data-ttu-id="43583-151">По умолчанию все операции чтения и запросах, посылаемых к hello пользовательских ресурсов, используйте заданный hello учетной записи базы данных уровень согласованности по умолчанию hello.</span><span class="sxs-lookup"><span data-stu-id="43583-151">By default, all reads and queries issued against hello user-defined resources use hello default consistency level specified on hello database account.</span></span> <span data-ttu-id="43583-152">Могут опускать уровень согласованности hello определенного запроса или чтение запроса, использование в каждом hello поддерживается API-интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="43583-152">You can relax hello consistency level of a specific read/query request using in each of hello supported APIs.</span></span> <span data-ttu-id="43583-153">Существует пять типов уровни согласованности, поддерживаемые протоколом репликации hello Azure Cosmos DB, предоставляющие очистить компромисса между гарантии конкретных согласованности и производительности, как описано в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="43583-153">There are five types of consistency levels supported by hello Azure Cosmos DB replication protocol that provide a clear trade-off between specific consistency guarantees and performance, as described in this section.</span></span>

<span data-ttu-id="43583-154">**Уровень согласованности Strong (сильная)**:</span><span class="sxs-lookup"><span data-stu-id="43583-154">**Strong**:</span></span> 

* <span data-ttu-id="43583-155">Строгая согласованность предлагает [linearizability](https://aphyr.com/posts/313-strong-consistency-models) гарантии с hello считывает гарантированную tooreturn hello самой последней версии элемента.</span><span class="sxs-lookup"><span data-stu-id="43583-155">Strong consistency offers a [linearizability](https://aphyr.com/posts/313-strong-consistency-models) guarantee with hello reads guaranteed tooreturn hello most recent version of an item.</span></span> 
* <span data-ttu-id="43583-156">Надежная согласованность гарантирует, что записи будет видна только после надежной фиксации по кворума большинства hello реплик.</span><span class="sxs-lookup"><span data-stu-id="43583-156">Strong consistency guarantees that a write is only visible after it is committed durably by hello majority quorum of replicas.</span></span> <span data-ttu-id="43583-157">Запись либо синхронно надежной фиксации первичной hello и hello кворум баз данных-получателей, или он будет прерван.</span><span class="sxs-lookup"><span data-stu-id="43583-157">A write is either synchronously committed durably by both hello primary and hello quorum of secondaries, or it is aborted.</span></span> <span data-ttu-id="43583-158">Чтение всегда подтверждается чтения кворума большинства hello, клиент никогда не увидите незафиксированных или часть записи и гарантированно tooread hello последнего подтвержденного записи.</span><span class="sxs-lookup"><span data-stu-id="43583-158">A read is always acknowledged by hello majority read quorum, a client can never see an uncommitted or partial write and is always guaranteed tooread hello latest acknowledged write.</span></span> 
* <span data-ttu-id="43583-159">Azure Cosmos DB учетных записей, настроенных toouse строгая согласованность нельзя связать более одного региона Azure с учетной записью Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="43583-159">Azure Cosmos DB accounts that are configured toouse strong consistency cannot associate more than one Azure region with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="43583-160">Здравствуйте, затраты на операции чтения (в виде [единиц запросов](request-units.md) потребляет) строго согласованная выше, чем сеанса и возможном, но Здравствуйте таким же, как ограниченным устареванием.</span><span class="sxs-lookup"><span data-stu-id="43583-160">hello cost of a read operation (in terms of [request units](request-units.md) consumed) with strong consistency is higher than session and eventual, but hello same as bounded staleness.</span></span>

<span data-ttu-id="43583-161">**Ограниченное устаревание**</span><span class="sxs-lookup"><span data-stu-id="43583-161">**Bounded staleness**:</span></span> 

* <span data-ttu-id="43583-162">Согласованность с ограниченным устареванием гарантирует, что hello операций чтения может отставать от операций записи в журнал не чаще *K* версий или префиксы элемента или *t* интервал времени.</span><span class="sxs-lookup"><span data-stu-id="43583-162">Bounded staleness consistency guarantees that hello reads may lag behind writes by at most *K* versions or prefixes of an item or *t* time-interval.</span></span> 
* <span data-ttu-id="43583-163">Таким образом, при выборе ограниченных устаревание, hello «устаревание» можно настроить двумя способами: номеров версий *K* hello элемента, по которому считывает hello отставать от записи hello и интервал времени hello *t*</span><span class="sxs-lookup"><span data-stu-id="43583-163">Therefore, when choosing bounded staleness, hello "staleness" can be configured in two ways: number of versions *K* of hello item by which hello reads lag behind hello writes, and hello time interval *t*</span></span> 
* <span data-ttu-id="43583-164">Ограниченная устаревание предложения общее глобального порядке, за исключением внутри hello «устаревание окно».</span><span class="sxs-lookup"><span data-stu-id="43583-164">Bounded staleness offers total global order except within hello "staleness window."</span></span> <span data-ttu-id="43583-165">чтение Hello монотонными гарантии существует в области внутри и снаружи hello «устаревание окно».</span><span class="sxs-lookup"><span data-stu-id="43583-165">hello monotonic read guarantees exists within a region both inside and outside hello "staleness window."</span></span> 
* <span data-ttu-id="43583-166">Модель ограниченного устаревания обеспечивает более надежную гарантию согласованности, чем согласованность уровня сеанса и согласованность в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-166">Bounded staleness provides a stronger consistency guarantee than session or eventual consistency.</span></span> <span data-ttu-id="43583-167">Для глобально распределенных приложений мы рекомендуем использовать ограниченным устареванием для сценариев, где должны строгая согласованность toohave но хотелось 99,99% доступности и малой задержкой.</span><span class="sxs-lookup"><span data-stu-id="43583-167">For globally distributed applications, we recommend you use bounded staleness for scenarios where you would like toohave strong consistency but also want 99.99% availability and low latency.</span></span> 
* <span data-ttu-id="43583-168">С учетными записями Azure Cosmos DB, для которых настроена согласованность с ограниченным устареванием, можно связать любое количество регионов Azure.</span><span class="sxs-lookup"><span data-stu-id="43583-168">Azure Cosmos DB accounts that are configured with bounded staleness consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="43583-169">Здравствуйте стоимость операции чтения (с точки зрения RUs использованы) с ограниченным устареванием больше, чем сеанс и окончательной согласованности, но Здравствуйте таким же, как надежная согласованность.</span><span class="sxs-lookup"><span data-stu-id="43583-169">hello cost of a read operation (in terms of RUs consumed) with bounded staleness is higher than session and eventual consistency, but hello same as strong consistency.</span></span>

<span data-ttu-id="43583-170">**Уровень согласованности Session (сеанс)**:</span><span class="sxs-lookup"><span data-stu-id="43583-170">**Session**:</span></span> 

* <span data-ttu-id="43583-171">В отличие от моделей hello глобальной согласованности, предлагаемые уровни согласованности надежный и связанной устаревание согласованность сеансов — tooa с областью сеанса клиента.</span><span class="sxs-lookup"><span data-stu-id="43583-171">Unlike hello global consistency models offered by strong and bounded staleness consistency levels, session consistency is scoped tooa client session.</span></span> 
* <span data-ttu-id="43583-172">Согласованность уровня сеанса идеально подходит для всех сценариев, включающих в себя сеанс устройства или пользователя, так как она гарантирует монотонное чтение и монотонную запись, а также гарантирует чтение собственных записей (RYW).</span><span class="sxs-lookup"><span data-stu-id="43583-172">Session consistency is ideal for all scenarios where a device or user session is involved since it guarantees monotonic reads, monotonic writes, and read your own writes (RYW) guarantees.</span></span> 
* <span data-ttu-id="43583-173">Согласованность сеансов обеспечивает прогнозируемого согласованности сеанса и максимально пропускная способность операций чтения при низких hello низкие задержки операций записи и чтения.</span><span class="sxs-lookup"><span data-stu-id="43583-173">Session consistency provides predictable consistency for a session, and maximum read throughput while offering hello lowest latency writes and reads.</span></span> 
* <span data-ttu-id="43583-174">С учетными записями Azure Cosmos DB, для которых настроена согласованность уровня сеанса, можно связать любое количество регионов Azure.</span><span class="sxs-lookup"><span data-stu-id="43583-174">Azure Cosmos DB accounts that are configured with session consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="43583-175">Здравствуйте, затраты на операции чтения (с точки зрения RUs потребляет) с сеансом, уровень согласованности — меньше, чем надежный и связанной устаревание, но более окончательной согласованности</span><span class="sxs-lookup"><span data-stu-id="43583-175">hello cost of a read operation (in terms of RUs consumed) with session consistency level is less than strong and bounded staleness, but more than eventual consistency</span></span>

<span data-ttu-id="43583-176"><a id="consistent-prefix"></a>
**Согласованность префиксов**:</span><span class="sxs-lookup"><span data-stu-id="43583-176"><a id="consistent-prefix"></a>
**Consistent Prefix**:</span></span> 

* <span data-ttu-id="43583-177">Согласованное префикс гарантирует, что при отсутствии дополнительные операции записи hello реплики в рамках группы hello в конечном итоге совпадают.</span><span class="sxs-lookup"><span data-stu-id="43583-177">Consistent prefix guarantees that in absence of any further writes, hello replicas within hello group eventually converge.</span></span> 
* <span data-ttu-id="43583-178">Согласованность префиксов гарантирует, что операции чтения никогда не столкнутся с неупорядоченными операциями записи.</span><span class="sxs-lookup"><span data-stu-id="43583-178">Consistent prefix guarantees that reads never see out of order writes.</span></span> <span data-ttu-id="43583-179">Если были выполнены операции записи в порядке hello `A, B, C`, клиент видит либо `A`, `A,B`, или `A,B,C`, но никогда не по порядку как `A,C` или `B,A,C`.</span><span class="sxs-lookup"><span data-stu-id="43583-179">If writes were performed in hello order `A, B, C`, then a client sees either `A`, `A,B`, or `A,B,C`, but never out of order like `A,C` or `B,A,C`.</span></span>
* <span data-ttu-id="43583-180">С учетными записями Azure Cosmos DB, для которых настроена согласованность префиксов, можно связать любое количество регионов Azure.</span><span class="sxs-lookup"><span data-stu-id="43583-180">Azure Cosmos DB accounts that are configured with consistent prefix consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 

<span data-ttu-id="43583-181">**Уровень согласованности Eventual (в конечном счете)**:</span><span class="sxs-lookup"><span data-stu-id="43583-181">**Eventual**:</span></span> 

* <span data-ttu-id="43583-182">Итоговая согласованность гарантирует, что при отсутствии дополнительные операции записи hello реплики в рамках группы hello в конечном итоге совпадают.</span><span class="sxs-lookup"><span data-stu-id="43583-182">Eventual consistency guarantees that in absence of any further writes, hello replicas within hello group eventually converge.</span></span> 
* <span data-ttu-id="43583-183">Итоговая согласованность является слабым формой hello согласованности, где клиент может получить hello значения, которые являются более старыми, чем hello из них раньше было.</span><span class="sxs-lookup"><span data-stu-id="43583-183">Eventual consistency is hello weakest form of consistency where a client may get hello values that are older than hello ones it had seen before.</span></span>
* <span data-ttu-id="43583-184">Итоговая согласованность обеспечивает hello наименьшую согласованность чтения, но предложения hello наименьшую задержку для операций чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="43583-184">Eventual consistency provides hello weakest read consistency but offers hello lowest latency for both reads and writes.</span></span>
* <span data-ttu-id="43583-185">С учетными записями Azure Cosmos DB, для которых настроена согласованность в конечном счете, можно связать любое количество регионов Azure.</span><span class="sxs-lookup"><span data-stu-id="43583-185">Azure Cosmos DB accounts that are configured with eventual consistency can associate any number of Azure regions with their Azure Cosmos DB account.</span></span> 
* <span data-ttu-id="43583-186">Здравствуйте, затраты на операции чтения (с точки зрения потребления RUs) с окончательной согласованности hello уровень — минимальный все уровни согласованности hello Azure Cosmos DB hello.</span><span class="sxs-lookup"><span data-stu-id="43583-186">hello cost of a read operation (in terms of RUs consumed) with hello eventual consistency level is hello lowest of all hello Azure Cosmos DB consistency levels.</span></span>

## <a name="configuring-hello-default-consistency-level"></a><span data-ttu-id="43583-187">Настройка уровня согласованности по умолчанию hello</span><span class="sxs-lookup"><span data-stu-id="43583-187">Configuring hello default consistency level</span></span>
1. <span data-ttu-id="43583-188">В hello [портал Azure](https://portal.azure.com/)в hello Jumpbar, щелкнув **Azure Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="43583-188">In hello [Azure portal](https://portal.azure.com/), in hello Jumpbar, click **Azure Cosmos DB**.</span></span>
2. <span data-ttu-id="43583-189">В hello **Azure Cosmos DB** колонки, toomodify учетной записи базы данных выберите hello.</span><span class="sxs-lookup"><span data-stu-id="43583-189">In hello **Azure Cosmos DB** blade, select hello database account toomodify.</span></span>
3. <span data-ttu-id="43583-190">В колонке hello учетной записи, нажмите кнопку **по умолчанию согласованности**.</span><span class="sxs-lookup"><span data-stu-id="43583-190">In hello account blade, click **Default consistency**.</span></span>
4. <span data-ttu-id="43583-191">В hello **согласованности по умолчанию** колонки, новый уровень согласованности выберите hello и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="43583-191">In hello **Default Consistency** blade, select hello new consistency level and click **Save**.</span></span>
   
    ![Снимок экрана выделения hello значок параметров и запись по умолчанию согласованности](./media/consistency-levels/database-consistency-level-1.png)

## <a name="consistency-levels-for-queries"></a><span data-ttu-id="43583-193">Уровни согласованности для запросов</span><span class="sxs-lookup"><span data-stu-id="43583-193">Consistency levels for queries</span></span>
<span data-ttu-id="43583-194">Для определяемых пользователем ресурсов по умолчанию hello уровень согласованности для запросов — hello же как считывает уровень согласованности hello.</span><span class="sxs-lookup"><span data-stu-id="43583-194">By default, for user-defined resources, hello consistency level for queries is hello same as hello consistency level for reads.</span></span> <span data-ttu-id="43583-195">По умолчанию hello индекс обновляется синхронно для каждой вставки, замены или удаления контейнера Cosmos DB toohello элемента.</span><span class="sxs-lookup"><span data-stu-id="43583-195">By default, hello index is updated synchronously on each insert, replace, or delete of an item toohello Cosmos DB container.</span></span> <span data-ttu-id="43583-196">Это позволяет toohonor hello уровень согласованности, что запросы hello точки операций чтения.</span><span class="sxs-lookup"><span data-stu-id="43583-196">This enables hello queries toohonor hello same consistency level as that of point reads.</span></span> <span data-ttu-id="43583-197">Azure Cosmos DB доступно для записи оптимизированной и поддерживает длительной тома операций записи, обслуживание индекса синхронной и обслуживания запросов согласованное, можно настроить некоторые коллекции tooupdate их индекс неактивно.</span><span class="sxs-lookup"><span data-stu-id="43583-197">While Azure Cosmos DB is write optimized and supports sustained volumes of writes, synchronous index maintenance and serving consistent queries, you can configure certain collections tooupdate their index lazily.</span></span> <span data-ttu-id="43583-198">Кроме того отложенного индексирования повышает производительность записи hello, идеально подходит для сценариев массового приема при основном чтения тяжелой рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="43583-198">Lazy indexing further boosts hello write performance and is ideal for bulk ingestion scenarios when a workload is primarily read-heavy.</span></span>  

| <span data-ttu-id="43583-199">Режим индексирования</span><span class="sxs-lookup"><span data-stu-id="43583-199">Indexing Mode</span></span> | <span data-ttu-id="43583-200">Операции чтения</span><span class="sxs-lookup"><span data-stu-id="43583-200">Reads</span></span> | <span data-ttu-id="43583-201">Запросы</span><span class="sxs-lookup"><span data-stu-id="43583-201">Queries</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43583-202">Режим согласованности (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="43583-202">Consistent (default)</span></span> |<span data-ttu-id="43583-203">Можно выбрать строгую согласованность, согласованность с ограниченным устареванием, согласованность уровня сеанса, согласованность префиксов или согласованность в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-203">Select from strong, bounded staleness, session, consistent prefix, or eventual</span></span> |<span data-ttu-id="43583-204">Можно выбрать строгую согласованность, согласованность с ограниченным устареванием, согласованность уровня сеанса и согласованность в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-204">Select from strong, bounded staleness, session, or eventual</span></span> |
| <span data-ttu-id="43583-205">Отложенная</span><span class="sxs-lookup"><span data-stu-id="43583-205">Lazy</span></span> |<span data-ttu-id="43583-206">Можно выбрать строгую согласованность, согласованность с ограниченным устареванием, согласованность уровня сеанса, согласованность префиксов или согласованность в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-206">Select from strong, bounded staleness, session, consistent prefix, or eventual</span></span> |<span data-ttu-id="43583-207">Уровень согласованности Eventual (в конечном счете)</span><span class="sxs-lookup"><span data-stu-id="43583-207">Eventual</span></span> |
| <span data-ttu-id="43583-208">None</span><span class="sxs-lookup"><span data-stu-id="43583-208">None</span></span> |<span data-ttu-id="43583-209">Можно выбрать строгую согласованность, согласованность с ограниченным устареванием, согласованность уровня сеанса, согласованность префиксов или согласованность в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-209">Select from strong, bounded staleness, session, consistent prefix, or eventual</span></span> |<span data-ttu-id="43583-210">Не применяется</span><span class="sxs-lookup"><span data-stu-id="43583-210">Not applicable</span></span> |

<span data-ttu-id="43583-211">Как с помощью запросов чтения, можно понизить уровень согласованности hello конкретных запросов в каждый API.</span><span class="sxs-lookup"><span data-stu-id="43583-211">As with read requests, you can lower hello consistency level of a specific query request in each API.</span></span>

## <a name="next-steps"></a><span data-ttu-id="43583-212">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="43583-212">Next steps</span></span>
<span data-ttu-id="43583-213">Если вы хотите toodo более чтения об уровнях согласованности и недостатки, мы рекомендуем hello следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="43583-213">If you'd like toodo more reading about consistency levels and tradeoffs, we recommend hello following resources:</span></span>

* <span data-ttu-id="43583-214">Даг Терри.</span><span class="sxs-lookup"><span data-stu-id="43583-214">Doug Terry.</span></span> <span data-ttu-id="43583-215">Объяснение согласованности при репликации данных на примере бейсбола (видео).</span><span class="sxs-lookup"><span data-stu-id="43583-215">Replicated Data Consistency explained through baseball (video).</span></span>   
  [<span data-ttu-id="43583-216">https://www.youtube.com/watch?v=gluIh8zd26I</span><span class="sxs-lookup"><span data-stu-id="43583-216">https://www.youtube.com/watch?v=gluIh8zd26I</span></span>](https://www.youtube.com/watch?v=gluIh8zd26I)
* <span data-ttu-id="43583-217">Даг Терри.</span><span class="sxs-lookup"><span data-stu-id="43583-217">Doug Terry.</span></span> <span data-ttu-id="43583-218">Объяснение согласованности при репликации данных на примере игры в бейсбол (Replicated Data Consistency explained through baseball).</span><span class="sxs-lookup"><span data-stu-id="43583-218">Replicated Data Consistency explained through baseball.</span></span>   
  [<span data-ttu-id="43583-219">http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf</span><span class="sxs-lookup"><span data-stu-id="43583-219">http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf</span></span>](http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf)
* <span data-ttu-id="43583-220">Даг Терри.</span><span class="sxs-lookup"><span data-stu-id="43583-220">Doug Terry.</span></span> <span data-ttu-id="43583-221">Гарантии на уровне сеанса для репликации слабо согласованных данных.</span><span class="sxs-lookup"><span data-stu-id="43583-221">Session Guarantees for Weakly Consistent Replicated Data.</span></span>   
  [<span data-ttu-id="43583-222">http://dl.acm.org/citation.cfm?id=383631</span><span class="sxs-lookup"><span data-stu-id="43583-222">http://dl.acm.org/citation.cfm?id=383631</span></span>](http://dl.acm.org/citation.cfm?id=383631)
* <span data-ttu-id="43583-223">Дэниэл Абади.</span><span class="sxs-lookup"><span data-stu-id="43583-223">Daniel Abadi.</span></span> <span data-ttu-id="43583-224">Недостатки согласованности по современный дизайн системы базы данных распределенных: ограничение составляет часть истории hello».</span><span class="sxs-lookup"><span data-stu-id="43583-224">Consistency Tradeoffs in Modern Distributed Database Systems Design: CAP is only part of hello story”.</span></span>   
  [<span data-ttu-id="43583-225">http://computer.org/csdl/mags/co/2012/02/mco2012020037-abs.html</span><span class="sxs-lookup"><span data-stu-id="43583-225">http://computer.org/csdl/mags/co/2012/02/mco2012020037-abs.html</span></span>](http://computer.org/csdl/mags/co/2012/02/mco2012020037-abs.html)
* <span data-ttu-id="43583-226">Питер Бейлис, Шиварам Венкатараман, Майкл Дж. Франклин, Джозеф М. Хеллерштейн, Ион Стойка (Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein, Ion Stoica).</span><span class="sxs-lookup"><span data-stu-id="43583-226">Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein, Ion Stoica.</span></span> <span data-ttu-id="43583-227">Вероятностное ограниченное запаздывание (PBS) для практических неполных кворумов.</span><span class="sxs-lookup"><span data-stu-id="43583-227">Probabilistic Bounded Staleness (PBS) for Practical Partial Quorums.</span></span>   
  [<span data-ttu-id="43583-228">http://vldb.org/pvldb/vol5/p776_peterbailis_vldb2012.pdf</span><span class="sxs-lookup"><span data-stu-id="43583-228">http://vldb.org/pvldb/vol5/p776_peterbailis_vldb2012.pdf</span></span>](http://vldb.org/pvldb/vol5/p776_peterbailis_vldb2012.pdf)
* <span data-ttu-id="43583-229">Вернер Вогелс.</span><span class="sxs-lookup"><span data-stu-id="43583-229">Werner Vogels.</span></span> <span data-ttu-id="43583-230">Возвращаясь к вопросу о согласованности в конечном счете.</span><span class="sxs-lookup"><span data-stu-id="43583-230">Eventual Consistent - Revisited.</span></span>    
  [<span data-ttu-id="43583-231">http://allthingsdistributed.com/2008/12/eventually_consistent.html</span><span class="sxs-lookup"><span data-stu-id="43583-231">http://allthingsdistributed.com/2008/12/eventually_consistent.html</span></span>](http://allthingsdistributed.com/2008/12/eventually_consistent.html)
* <span data-ttu-id="43583-232">Naor входа в сам шерсть Avishai, hello нагрузки, емкость и систем доступности кворума, SIAM журнала вычислений, v.27 n.2, p.423-447 апреля 1998 года.</span><span class="sxs-lookup"><span data-stu-id="43583-232">Moni Naor , Avishai Wool, hello Load, Capacity, and Availability of Quorum Systems, SIAM Journal on Computing, v.27 n.2, p.423-447, April 1998.</span></span>
  [<span data-ttu-id="43583-233">http://epubs.siam.org/doi/abs/10.1137/S0097539795281232</span><span class="sxs-lookup"><span data-stu-id="43583-233">http://epubs.siam.org/doi/abs/10.1137/S0097539795281232</span></span>](http://epubs.siam.org/doi/abs/10.1137/S0097539795281232)
* <span data-ttu-id="43583-234">Себастиан Burckhardt, Крис Dern, Macanal Musuvathi, Roy Tan, линейку: linearizability завершения и автоматической проверки, событий hello 2010 конференции ACM SIGPLAN о программировании языка проектирования и реализации 05-10 июня 2010 г., Торонто, Онтарио, Канада [doi > 10.1145/1806596.1806634] [http://dl.acm.org/citation.cfm?id=1806634](http://dl.acm.org/citation.cfm?id=1806634)</span><span class="sxs-lookup"><span data-stu-id="43583-234">Sebastian Burckhardt, Chris Dern, Macanal Musuvathi, Roy Tan, Line-up: a complete and automatic linearizability checker, Proceedings of hello 2010 ACM SIGPLAN conference on Programming language design and implementation, June 05-10, 2010, Toronto, Ontario, Canada  [doi>10.1145/1806596.1806634] [http://dl.acm.org/citation.cfm?id=1806634](http://dl.acm.org/citation.cfm?id=1806634)</span></span>
* <span data-ttu-id="43583-235">Питер Bailis, Shivaram Venkataraman, Майкл Дж. Франклин, Hellerstein M. Джозеф, Ion Stoica первопричину ограниченных устаревание для практического частичного кворумов событий hello VLDB Endowment, n.8 в.5, p.776 787, апрель 2012 г. [http:// DL.ACM.org/Citation.cfm?ID=2212359](http://dl.acm.org/citation.cfm?id=2212359)</span><span class="sxs-lookup"><span data-stu-id="43583-235">Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, Joseph M. Hellerstein , Ion Stoica, Probabilistically bounded staleness for practical partial quorums, Proceedings of hello VLDB Endowment, v.5 n.8, p.776-787, April 2012 [http://dl.acm.org/citation.cfm?id=2212359](http://dl.acm.org/citation.cfm?id=2212359)</span></span>
