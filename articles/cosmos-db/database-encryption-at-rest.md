---
title: "Шифрование неактивных данных базы данных в Azure Cosmos DB | Документы Майкрософт"
description: "Сведения о шифровании всех данных по умолчанию в Azure Cosmos DB."
services: cosmos-db
author: voellm
manager: jhubbard
editor: mimig
documentationcenter: 
ms.assetid: 99725c52-d7ca-4bfa-888b-19b1569754d3
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/23/2017
ms.author: voellm
ms.openlocfilehash: d8967d4504a8ccabb444c7f3d5635e2d00f287c5
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="azure-cosmos-db-database-encryption-at-rest"></a><span data-ttu-id="1f67c-103">Шифрование неактивных данных базы данных в Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="1f67c-103">Azure Cosmos DB database encryption at rest</span></span>

<span data-ttu-id="1f67c-104">При шифровании неактивных данных обычно шифруются данные на устройствах долговременного хранения, например твердотельных накопителях (SSD) и жестких дисках (HDD).</span><span class="sxs-lookup"><span data-stu-id="1f67c-104">Encryption at rest is a phrase that commonly refers to the encryption of data on nonvolatile storage devices, such as solid state drives (SSDs) and hard disk drives (HDDs).</span></span> <span data-ttu-id="1f67c-105">Основные базы данных хранятся в Cosmos DB на твердотельных накопителях.</span><span class="sxs-lookup"><span data-stu-id="1f67c-105">Cosmos DB stores its primary databases on SSDs.</span></span> <span data-ttu-id="1f67c-106">Мультимедийные вложения и резервные копии хранятся в хранилище BLOB-объектов Azure, как правило, на основе жестких дисков.</span><span class="sxs-lookup"><span data-stu-id="1f67c-106">Its media attachments and backups are stored in Azure Blob storage, which is generally backed up by HDDs.</span></span> <span data-ttu-id="1f67c-107">С реализацией возможности шифрования неактивных данных Cosmos DB вы можете шифровать все базы данных, мультимедийные вложения и резервные копии.</span><span class="sxs-lookup"><span data-stu-id="1f67c-107">With the release of encryption at rest for Cosmos DB, all your databases, media attachments, and backups are encrypted.</span></span> <span data-ttu-id="1f67c-108">Шифруются как передаваемые данные (по сети), так и неактивные (долговременное хранение), обеспечивая непрерывное шифрование.</span><span class="sxs-lookup"><span data-stu-id="1f67c-108">Your data is now encrypted in transit (over the network) and at rest (nonvolatile storage), giving you end-to-end encryption.</span></span>

<span data-ttu-id="1f67c-109">Решение Cosmos DB, которое является службой PaaS, очень просто в использовании.</span><span class="sxs-lookup"><span data-stu-id="1f67c-109">As a PaaS service, Cosmos DB is very easy to use.</span></span> <span data-ttu-id="1f67c-110">Так как все данные пользователей, хранящиеся в Cosmos DB, шифруются как при хранении, так и при передаче, не нужно предпринимать никаких действий.</span><span class="sxs-lookup"><span data-stu-id="1f67c-110">Because all user data stored in Cosmos DB is encrypted at rest and in transport, you don't have to take any action.</span></span> <span data-ttu-id="1f67c-111">Другими словами, шифрование неактивных данных включено по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1f67c-111">Another way to put this is that encryption at rest is "on" by default.</span></span> <span data-ttu-id="1f67c-112">Элементов управления для его включения и отключения нет.</span><span class="sxs-lookup"><span data-stu-id="1f67c-112">There are no controls to turn it off or on.</span></span> <span data-ttu-id="1f67c-113">Мы предоставляем эту функцию в соответствии с нашими [соглашениями об уровне обслуживания в отношении доступности и производительности](https://azure.microsoft.com/support/legal/sla/cosmos-db).</span><span class="sxs-lookup"><span data-stu-id="1f67c-113">We provide this feature while we continue to meet our [availability and performance SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db).</span></span>

## <a name="implement-encryption-at-rest"></a><span data-ttu-id="1f67c-114">Реализация шифрования неактивных данных</span><span class="sxs-lookup"><span data-stu-id="1f67c-114">Implement encryption at rest</span></span>

<span data-ttu-id="1f67c-115">Шифрование неактивных данных реализуется с применением различных технологий обеспечения безопасности, включая безопасные системы хранения ключей, зашифрованные сети и криптографические API.</span><span class="sxs-lookup"><span data-stu-id="1f67c-115">Encryption at rest is implemented by using a number of security technologies, including secure key storage systems, encrypted networks, and cryptographic APIs.</span></span> <span data-ttu-id="1f67c-116">Системы расшифровки и обработки данных должны взаимодействовать с системами управления ключами.</span><span class="sxs-lookup"><span data-stu-id="1f67c-116">Systems that decrypt and process data have to communicate with systems that manage keys.</span></span> <span data-ttu-id="1f67c-117">На схеме показано, как разделено хранение зашифрованных данных и управление ключами.</span><span class="sxs-lookup"><span data-stu-id="1f67c-117">The diagram shows how storage of encrypted data and the management of keys is separated.</span></span> 

![Схема структуры](./media/database-encryption-at-rest/design-diagram.png)

<span data-ttu-id="1f67c-119">Запрос пользователя выполняется и обрабатывается следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1f67c-119">The basic flow of a user request is as follows:</span></span>
- <span data-ttu-id="1f67c-120">Учетная запись базы данных пользователя подготавливается, а ключи к хранилищу данных извлекаются по запросу к поставщику ресурсов службы управления.</span><span class="sxs-lookup"><span data-stu-id="1f67c-120">The user database account is made ready, and storage keys are retrieved via a request to the Management Service Resource Provider.</span></span>
- <span data-ttu-id="1f67c-121">Пользователь создает подключение к Cosmos DB с помощью протокола HTTPS или безопасного транспортного протокола.</span><span class="sxs-lookup"><span data-stu-id="1f67c-121">A user creates a connection to Cosmos DB via HTTPS/secure transport.</span></span> <span data-ttu-id="1f67c-122">(Пакеты SDK абстрагируют подробные сведения.)</span><span class="sxs-lookup"><span data-stu-id="1f67c-122">(The SDKs abstract the details.)</span></span>
- <span data-ttu-id="1f67c-123">Пользователь отправляет документ JSON для сохранения, используя ранее созданное безопасное подключение.</span><span class="sxs-lookup"><span data-stu-id="1f67c-123">The user sends a JSON document to be stored over the previously created secure connection.</span></span>
- <span data-ttu-id="1f67c-124">Документ JSON индексируется, если пользователь не отключил эту возможность.</span><span class="sxs-lookup"><span data-stu-id="1f67c-124">The JSON document is indexed unless the user has turned off indexing.</span></span>
- <span data-ttu-id="1f67c-125">Документ JSON и данные индекса записываются в безопасное хранилище.</span><span class="sxs-lookup"><span data-stu-id="1f67c-125">Both the JSON document and index data are written to secure storage.</span></span>
- <span data-ttu-id="1f67c-126">Время от времени данные считываются из безопасного хранилища и архивируются в зашифрованное хранилище BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="1f67c-126">Periodically, data is read from the secure storage and backed up to the Azure Encrypted Blob Store.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="1f67c-127">Часто задаваемые вопросы</span><span class="sxs-lookup"><span data-stu-id="1f67c-127">Frequently asked questions</span></span>

### <a name="q-how-much-more-does-azure-storage-cost-if-storage-service-encryption-is-enabled"></a><span data-ttu-id="1f67c-128">Вопрос. Насколько дороже обходится служба хранилища Azure с включенным шифрованием службы хранилища?</span><span class="sxs-lookup"><span data-stu-id="1f67c-128">Q: How much more does Azure Storage cost if Storage Service Encryption is enabled?</span></span>
<span data-ttu-id="1f67c-129">Ответ. Дополнительные затраты не требуются.</span><span class="sxs-lookup"><span data-stu-id="1f67c-129">A: There is no additional cost.</span></span>

### <a name="q-who-manages-the-encryption-keys"></a><span data-ttu-id="1f67c-130">Вопрос. Кто управляет ключами шифрования?</span><span class="sxs-lookup"><span data-stu-id="1f67c-130">Q: Who manages the encryption keys?</span></span>
<span data-ttu-id="1f67c-131">Ответ. Ключами управляет корпорация Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="1f67c-131">A: The keys are managed by Microsoft.</span></span>

### <a name="q-how-often-are-encryption-keys-rotated"></a><span data-ttu-id="1f67c-132">Вопрос. Как часто меняются ключи шифрования?</span><span class="sxs-lookup"><span data-stu-id="1f67c-132">Q: How often are encryption keys rotated?</span></span>
<span data-ttu-id="1f67c-133">Ответ. В корпорации Майкрософт есть ряд внутренних правил касательно смены ключей шифрования, которым следует Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="1f67c-133">A: Microsoft has a set of internal guidelines for encryption key rotation, which Cosmos DB follows.</span></span> <span data-ttu-id="1f67c-134">Эти правила не публикуются.</span><span class="sxs-lookup"><span data-stu-id="1f67c-134">The specific guidelines are not published.</span></span> <span data-ttu-id="1f67c-135">Однако корпорация Майкрософт публикует [жизненный цикл разработки защищенных приложений (SDL)](https://www.microsoft.com/sdl/default.aspx), который представляет собой часть внутренних рекомендаций и содержит полезные указания для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="1f67c-135">Microsoft does publish the [Security Development Lifecycle (SDL)](https://www.microsoft.com/sdl/default.aspx), which is seen as a subset of internal guidance and has useful best practices for developers.</span></span>

### <a name="q-can-i-use-my-own-encryption-keys"></a><span data-ttu-id="1f67c-136">Вопрос. Можно ли использовать собственные ключи шифрования?</span><span class="sxs-lookup"><span data-stu-id="1f67c-136">Q: Can I use my own encryption keys?</span></span>
<span data-ttu-id="1f67c-137">Ответ. Cosmos DB — это служба PaaS. Мы сделали все возможное, чтобы максимально упростить работу с ней.</span><span class="sxs-lookup"><span data-stu-id="1f67c-137">A: Cosmos DB is a PaaS service, and we worked hard to keep the service easy to use.</span></span> <span data-ttu-id="1f67c-138">Мы заметили, что этот вопрос часто задают при обсуждении соответствия требованиям, например PCI-DSS.</span><span class="sxs-lookup"><span data-stu-id="1f67c-138">We've noticed this question is often asked as a proxy question for meeting a compliance requirement like PCI-DSS.</span></span> <span data-ttu-id="1f67c-139">Разрабатывая эту функцию, мы совместно с аудиторами соответствия старались создать для клиентов такие условия, в которых они могли бы использовать Cosmos DB в соответствии со своими требованиями без необходимости управлять ключами самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="1f67c-139">As part of building this feature, we worked with compliance auditors to ensure that customers who use Cosmos DB meet their requirements without the need to manage keys themselves.</span></span>
<span data-ttu-id="1f67c-140">Поэтому сейчас мы не предлагаем пользователям возможность самостоятельно управлять ключами.</span><span class="sxs-lookup"><span data-stu-id="1f67c-140">As a result, we currently do not offer users the option to burden themselves with key management.</span></span>

### <a name="q-what-regions-have-encryption-turned-on"></a><span data-ttu-id="1f67c-141">Вопрос. В каких регионах включено шифрование?</span><span class="sxs-lookup"><span data-stu-id="1f67c-141">Q: What regions have encryption turned on?</span></span>
<span data-ttu-id="1f67c-142">Ответ. Шифрование пользовательских данных включено во всех регионах Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="1f67c-142">A: All Azure Cosmos DB regions have encryption turned on for all user data.</span></span>

### <a name="q-does-encryption-affect-the-performance-latency-and-throughput-slas"></a><span data-ttu-id="1f67c-143">Вопрос. Влияет ли шифрование на пропускную способность и задержку производительности, определенные соглашениями об уровне обслуживания?</span><span class="sxs-lookup"><span data-stu-id="1f67c-143">Q: Does encryption affect the performance latency and throughput SLAs?</span></span>
<span data-ttu-id="1f67c-144">Ответ. Нет, не влияет, так как шифрование при хранении включено для всех имеющихся или новых учетных записей.</span><span class="sxs-lookup"><span data-stu-id="1f67c-144">A: There is no impact or changes to the performance SLAs now that encryption at rest is enabled for all existing and new accounts.</span></span> <span data-ttu-id="1f67c-145">Дополнительные сведения об актуальных гарантиях см. на странице [соглашения об уровне обслуживания для Cosmos DB](https://azure.microsoft.com/support/legal/sla/cosmos-db).</span><span class="sxs-lookup"><span data-stu-id="1f67c-145">You can read more on the [SLA for Cosmos DB](https://azure.microsoft.com/support/legal/sla/cosmos-db) page to see the latest guarantees.</span></span>

### <a name="q-does-the-local-emulator-support-encryption-at-rest"></a><span data-ttu-id="1f67c-146">Вопрос. Поддерживает ли локальный эмулятор шифрование при хранении?</span><span class="sxs-lookup"><span data-stu-id="1f67c-146">Q: Does the local emulator support encryption at rest?</span></span>
<span data-ttu-id="1f67c-147">Ответ. Эмулятор — это изолированное средство разработки и тестирования, которое не использует службы управления ключами, применяемые управляемой службой Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="1f67c-147">A: The emulator is a standalone dev/test tool and does not use the key management services that the managed Cosmos DB service uses.</span></span> <span data-ttu-id="1f67c-148">Мы советуем включить BitLocker на дисках, где хранятся конфиденциальные тестовые данные эмулятора.</span><span class="sxs-lookup"><span data-stu-id="1f67c-148">Our recommendation is to enable BitLocker on drives where you are storing sensitive emulator test data.</span></span> <span data-ttu-id="1f67c-149">[Эмулятор поддерживает изменение каталога данных по умолчанию](local-emulator.md), а также использование известного расположения.</span><span class="sxs-lookup"><span data-stu-id="1f67c-149">The [emulator supports changing the default data directory](local-emulator.md) as well as using a well-known location.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1f67c-150">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="1f67c-150">Next steps</span></span>

<span data-ttu-id="1f67c-151">Общие сведения о системе безопасности и последних усовершенствованиях Cosmos DB см. в статье [Безопасность базы данных в Azure Cosmos DB](database-security.md).</span><span class="sxs-lookup"><span data-stu-id="1f67c-151">For an overview of Cosmos DB security and the latest improvements, see [Azure Cosmos DB database security](database-security.md).</span></span>
<span data-ttu-id="1f67c-152">Дополнительные сведения о сертификатах Майкрософт см. в [центре управления безопасностью Azure](https://azure.microsoft.com/en-us/support/trust-center/).</span><span class="sxs-lookup"><span data-stu-id="1f67c-152">For more information about Microsoft certifications, see the [Azure Trust Center](https://azure.microsoft.com/en-us/support/trust-center/).</span></span>
