---
title: "Подключение к Azure Cosmos DB с помощью инструментов бизнес-аналитики | Документация Майкрософт"
description: "Сведения о создании таблиц и представлений с помощью драйвера ODBC для Azure Cosmos DB, чтобы просматривать нормализованные данные в программном обеспечении для бизнес-аналитики и анализа данных."
keywords: "ODBC, драйвер ODBC"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 9967f4e5-4b71-4cd7-8324-221a8c789e6b
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: rest-api
ms.topic: article
ms.date: 05/24/2017
ms.author: mimig
ms.openlocfilehash: 2df792c00b7a789dbefa64bfe0245f1ad73c3faa
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="connect-to-azure-cosmos-db-using-bi-analytics-tools-with-the-odbc-driver"></a><span data-ttu-id="46f42-104">Подключение к Azure Cosmos DB с помощью драйвера ODBC с использованием инструментов бизнес-аналитики</span><span class="sxs-lookup"><span data-stu-id="46f42-104">Connect to Azure Cosmos DB using BI analytics tools with the ODBC driver</span></span>

<span data-ttu-id="46f42-105">Драйвер ODBC для Azure Cosmos DB позволяет подключаться к Azure Cosmos DB с помощью инструментов бизнес-аналитики, таких как SQL Server Integration Services, Power BI Desktop и Tableau, а также анализировать данные Azure Cosmos DB и создавать их визуализации в этих решениях.</span><span class="sxs-lookup"><span data-stu-id="46f42-105">The Azure Cosmos DB ODBC driver enables you to connect to Azure Cosmos DB using BI analytics tools such as SQL Server Integration Services, Power BI Desktop, and Tableau so that you can analyze and create visualizations of your Azure Cosmos DB data in those solutions.</span></span>

<span data-ttu-id="46f42-106">Драйвер ODBC для Azure Cosmos DB совместим с ODBC версии 3.8 и поддерживает синтаксис ANSI SQL-92.</span><span class="sxs-lookup"><span data-stu-id="46f42-106">The Azure Cosmos DB ODBC driver is ODBC 3.8 compliant and supports ANSI SQL-92 syntax.</span></span> <span data-ttu-id="46f42-107">Он обеспечивает широкие возможности для ренормализации данных в Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-107">The driver offers rich features to help you renormalize data in Azure Cosmos DB.</span></span> <span data-ttu-id="46f42-108">Используя драйвер, вы можете представить данные в Azure Cosmos DB в виде таблиц и представлений.</span><span class="sxs-lookup"><span data-stu-id="46f42-108">Using the driver, you can represent data in Azure Cosmos DB as tables and views.</span></span> <span data-ttu-id="46f42-109">Драйвер позволяет выполнять операции SQL с таблицами и представлениями, включая группирование по запросам, вставкам, обновлениям и удалениям.</span><span class="sxs-lookup"><span data-stu-id="46f42-109">The driver enables you to perform SQL operations against the tables and views including group by queries, inserts, updates, and deletes.</span></span>

## <a name="why-do-i-need-to-normalize-my-data"></a><span data-ttu-id="46f42-110">Причины для нормализации данных</span><span class="sxs-lookup"><span data-stu-id="46f42-110">Why do I need to normalize my data?</span></span>
<span data-ttu-id="46f42-111">Azure Cosmos DB — это база данных без схемы, поэтому она обеспечивает возможность быстрой разработки приложений, позволяя им выполнять итерацию модели данных в режиме реального времени, не придерживаясь строгой схемы.</span><span class="sxs-lookup"><span data-stu-id="46f42-111">Azure Cosmos DB is a schemaless database, so it enables rapid development of apps by enabling applications to iterate their data model on the fly and not confine them to a strict schema.</span></span> <span data-ttu-id="46f42-112">Отдельная база данных Azure Cosmos DB может содержать документы JSON разной структуры.</span><span class="sxs-lookup"><span data-stu-id="46f42-112">A single Azure Cosmos DB database can contain JSON documents of various structures.</span></span> <span data-ttu-id="46f42-113">Это отлично подходит для быстрой разработки приложений. Однако если вам нужно проанализировать данные и создать отчеты на их основе, используя инструменты для анализа данных и бизнес-аналитики, часто данные необходимо сделать плоскими и применить к ним определенную схему.</span><span class="sxs-lookup"><span data-stu-id="46f42-113">This is great for rapid application development, but when you want to analyze and create reports of your data using data analytics and BI tools, the data often needs to be flattened and adhere to a specific schema.</span></span>

<span data-ttu-id="46f42-114">Именно в этом вам поможет драйвер ODBC.</span><span class="sxs-lookup"><span data-stu-id="46f42-114">This is where the ODBC driver comes in.</span></span> <span data-ttu-id="46f42-115">С помощью драйвера ODBC теперь можно ренормализировать данные в Azure Cosmos DB в таблицы и представления в соответствии с требованиями к анализу данных и созданию отчетов.</span><span class="sxs-lookup"><span data-stu-id="46f42-115">By using the ODBC driver, you can now renormalized data in Azure Cosmos DB into tables and views fitting to your data analytic and reporting needs.</span></span> <span data-ttu-id="46f42-116">Ренормализированные схемы не влияют на базовые данные, и разработчики не обязаны им следовать. Эти схемы просто позволяют использовать совместимые с ODBC инструменты для доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="46f42-116">The renormalized schemas have no impact on the underlying data and do not confine developers to adhere to them, they simply enable you to leverage ODBC-compliant tools to access the data.</span></span> <span data-ttu-id="46f42-117">База данных Azure Cosmos DB придется по душе не только разработчикам, но и специалистам по анализу данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-117">So now your Azure Cosmos DB database will not only be a favorite for your development team, but your data analysts will love it too.</span></span>

<span data-ttu-id="46f42-118">Теперь давайте приступим к работе с драйвером ODBC.</span><span class="sxs-lookup"><span data-stu-id="46f42-118">Now lets get started with the ODBC driver.</span></span>

## <span data-ttu-id="46f42-119"><a id="install"></a>Шаг 1. Установка драйвера ODBC для Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="46f42-119"><a id="install"></a>Step 1: Install the Azure Cosmos DB ODBC driver</span></span>

1. <span data-ttu-id="46f42-120">Скачайте драйверы для своей среды:</span><span class="sxs-lookup"><span data-stu-id="46f42-120">Download the drivers for your environment:</span></span>

    * <span data-ttu-id="46f42-121">[Microsoft Azure Cosmos DB ODBC 64-bit.msi](https://aka.ms/documentdb-odbc-64x64) для 64-разрядной версии Windows.</span><span class="sxs-lookup"><span data-stu-id="46f42-121">[Microsoft Azure Cosmos DB ODBC 64-bit.msi](https://aka.ms/documentdb-odbc-64x64) for 64-bit Windows</span></span>
    * <span data-ttu-id="46f42-122">[Microsoft Azure Cosmos DB ODBC 32x64-bit.msi](https://aka.ms/documentdb-odbc-32x64) для 32-разрядной версии на 64-разрядной версии Windows.</span><span class="sxs-lookup"><span data-stu-id="46f42-122">[Microsoft Azure Cosmos DB ODBC 32x64-bit.msi](https://aka.ms/documentdb-odbc-32x64) for 32-bit on 64-bit Windows</span></span>
    * <span data-ttu-id="46f42-123">[Microsoft Azure Cosmos DB ODBC 32-bit.msi](https://aka.ms/documentdb-odbc-32x32) для 32-разрядной версии Windows.</span><span class="sxs-lookup"><span data-stu-id="46f42-123">[Microsoft Azure Cosmos DB ODBC 32-bit.msi](https://aka.ms/documentdb-odbc-32x32) for 32-bit Windows</span></span>

    <span data-ttu-id="46f42-124">Запустите MSI-файл локально. После этого запустится **мастер установки драйвера ODBC для Microsoft Azure Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="46f42-124">Run the msi file locally, which starts the **Microsoft Azure Cosmos DB ODBC Driver Installation Wizard**.</span></span> 
2. <span data-ttu-id="46f42-125">Завершите работу с мастером установки, введя значения по умолчанию для установки драйвера ODBC.</span><span class="sxs-lookup"><span data-stu-id="46f42-125">Complete the installation wizard using the default input to install the ODBC driver.</span></span>
3. <span data-ttu-id="46f42-126">Откройте приложение **Администратор источников данных ODBC** на компьютере. Для этого в поле поиска Windows введите **Источники данных ODBC**.</span><span class="sxs-lookup"><span data-stu-id="46f42-126">Open the **ODBC Data source Administrator** app on your computer, you can do this by typing **ODBC Data sources** in the Windows search box.</span></span> 
    <span data-ttu-id="46f42-127">Чтобы убедиться, что драйвер установлен, щелкните вкладку **Драйверы**, на которой должен отображаться **драйвер ODBC для Microsoft Azure Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="46f42-127">You can confirm the driver was installed by clicking the **Drivers** tab and ensuring **Microsoft Azure Cosmos DB ODBC Driver** is listed.</span></span>

    ![Администратор источников данных ODBC для Azure Cosmos DB](./media/odbc-driver/odbc-driver.png)

## <span data-ttu-id="46f42-129"><a id="connect"></a>Шаг 2. Подключение к базе данных Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="46f42-129"><a id="connect"></a>Step 2: Connect to your Azure Cosmos DB database</span></span>

1. <span data-ttu-id="46f42-130">[Установив драйвер ODBC для Azure Cosmos DB](#install), в окне **Администратор источников данных ODBC** щелкните **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="46f42-130">After [Installing the Azure Cosmos DB ODBC driver](#install), in the **ODBC Data Source Administrator** window, click **Add**.</span></span> <span data-ttu-id="46f42-131">Вы можете создать пользовательское или системное имя источника данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-131">You can create a User or System DSN.</span></span> <span data-ttu-id="46f42-132">В этом примере мы создаем пользовательское имя источника данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-132">In this example, we are creating a User DSN.</span></span>
2. <span data-ttu-id="46f42-133">В окне **Создание нового источника данных** выберите **Microsoft Azure Cosmos DB ODBC Driver** (Драйвер ODBC для Microsoft Azure Cosmos DB), а затем щелкните **Готово**.</span><span class="sxs-lookup"><span data-stu-id="46f42-133">In the **Create New Data Source** window, select **Microsoft Azure Cosmos DB ODBC Driver**, and then click **Finish**.</span></span>
3. <span data-ttu-id="46f42-134">В окне **Azure Cosmos DB ODBC Driver SDN Setup** (Настройка имени источника данных драйвера ODBC для Azure Cosmos DB) укажите следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="46f42-134">In the **Azure Cosmos DB ODBC Driver SDN Setup** window, fill in the following:</span></span> 

    ![Окно настройки имени источника данных драйвера ODBC для Azure Cosmos DB](./media/odbc-driver/odbc-driver-dsn-setup.png)
    - <span data-ttu-id="46f42-136">**Имя источника данных** — понятное имя для источника данных ODBC.</span><span class="sxs-lookup"><span data-stu-id="46f42-136">**Data Source Name**: Your own friendly name for the ODBC DSN.</span></span> <span data-ttu-id="46f42-137">Это имя является уникальным для учетной записи Azure Cosmos DB, так что при наличии нескольких учетных записей присваивайте ей уникальное имя.</span><span class="sxs-lookup"><span data-stu-id="46f42-137">This name is unique to your Azure Cosmos DB account, so name it appropriately if you have multiple accounts.</span></span>
    - <span data-ttu-id="46f42-138">**Описание** — краткое описание источника данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-138">**Description**: A brief description of the data source.</span></span>
    - <span data-ttu-id="46f42-139">**Узел** — универсальный код ресурса (URI) для учетной записи Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-139">**Host**: URI for your Azure Cosmos DB account.</span></span> <span data-ttu-id="46f42-140">Его можно получить в колонке ключей Azure Cosmos DB на портале Azure, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="46f42-140">You can retrieve this from the Azure Cosmos DB Keys blade in the Azure portal, as shown in the following screenshot.</span></span> 
    - <span data-ttu-id="46f42-141">**Ключ доступа** — первичный или вторичный ключ для чтения и записи или только для чтения из колонки ключей Azure Cosmos DB на портале Azure, как показано на следующем снимке экрана.</span><span class="sxs-lookup"><span data-stu-id="46f42-141">**Access Key**: The primary or secondary, read-write or read-only key from the Azure Cosmos DB Keys blade in the Azure portal as shown in the following screenshot.</span></span> <span data-ttu-id="46f42-142">Мы рекомендуем использовать ключ только для чтения, если имя источника данных используется для обработки данных, предназначенных только для чтения, и создания отчетов на их основе.</span><span class="sxs-lookup"><span data-stu-id="46f42-142">We recommend you use the read-only key if the DSN is used for read-only data processing and reporting.</span></span>
    <span data-ttu-id="46f42-143">![Колонка ключей Azure Cosmos DB](./media/odbc-driver/odbc-driver-keys.png)</span><span class="sxs-lookup"><span data-stu-id="46f42-143">![Azure Cosmos DB Keys blade](./media/odbc-driver/odbc-driver-keys.png)</span></span>
    - <span data-ttu-id="46f42-144">**Encrypt Access Key for** (Зашифровать ключ доступа для). Выберите лучший вариант исходя из того, кто использует этот компьютер.</span><span class="sxs-lookup"><span data-stu-id="46f42-144">**Encrypt Access Key for**: Select the best choice based on the users of this machine.</span></span> 
4. <span data-ttu-id="46f42-145">Нажмите кнопку **проверки**, чтобы подключиться к учетной записи Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-145">Click the **Test** button to make sure you can connect to your Azure Cosmos DB account.</span></span> 
5. <span data-ttu-id="46f42-146">Нажмите кнопку **Дополнительные параметры** и задайте следующие значения:</span><span class="sxs-lookup"><span data-stu-id="46f42-146">Click **Advanced Options** and set the following values:</span></span>
    - <span data-ttu-id="46f42-147">**Query Consistency** (Согласованность запросов). Выберите [уровень согласованности](consistency-levels.md) операций.</span><span class="sxs-lookup"><span data-stu-id="46f42-147">**Query Consistency**: Select the [consistency level](consistency-levels.md) for your operations.</span></span> <span data-ttu-id="46f42-148">Значение по умолчанию — "Сеанс".</span><span class="sxs-lookup"><span data-stu-id="46f42-148">The default is Session.</span></span>
    - <span data-ttu-id="46f42-149">**Число повторных попыток.** Введите число повторных попыток выполнения операции, если первоначальный запрос не был выполнен из-за регулирования службы.</span><span class="sxs-lookup"><span data-stu-id="46f42-149">**Number of Retries**: Enter the number of times to retry an operation if the initial request does not complete due to service throttling.</span></span>
    - <span data-ttu-id="46f42-150">**Schema File** (Файл схемы). Здесь можно выбрать один из нескольких вариантов.</span><span class="sxs-lookup"><span data-stu-id="46f42-150">**Schema File**: You have a number of options here.</span></span>
        - <span data-ttu-id="46f42-151">По умолчанию (если не указывать здесь сведения) драйвер сканирует данные первой страницы для всех коллекций для определения схемы каждой коллекции.</span><span class="sxs-lookup"><span data-stu-id="46f42-151">By default, leaving this entry as is (blank), the driver scans the first page data for all collections to determine the schema of each collection.</span></span> <span data-ttu-id="46f42-152">Этот процесс известен как сопоставление коллекций.</span><span class="sxs-lookup"><span data-stu-id="46f42-152">This is known as Collection Mapping.</span></span> <span data-ttu-id="46f42-153">Так как файл схемы не определен, драйверу приходится выполнять сканирование для каждого сеанса. При этом запуск приложения с использованием имени источника данных может стать дольше.</span><span class="sxs-lookup"><span data-stu-id="46f42-153">Without a schema file defined, the driver has to perform the scan for each driver session and could result in a higher start up time of an application using the DSN.</span></span> <span data-ttu-id="46f42-154">Мы рекомендуем связывать файл схемы для имени источника данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-154">We recommend that you always associate a schema file for a DSN.</span></span>
        - <span data-ttu-id="46f42-155">Если у вас есть файл схемы (созданный с помощью [редактора схем](#schema-editor)), нажмите кнопку **Обзор**, перейдите к файлу, нажмите кнопку **Сохранить** и **ОК**.</span><span class="sxs-lookup"><span data-stu-id="46f42-155">If you already have a schema file (possibly one that you created using the [Schema Editor](#schema-editor)), you can click **Browse**, navigate to your file, click **Save**, and then click **OK**.</span></span>
        - <span data-ttu-id="46f42-156">Если нужно создать схему, нажмите кнопку **ОК**, а затем в главном окне нажмите кнопку **Редактор схем**.</span><span class="sxs-lookup"><span data-stu-id="46f42-156">If you want to create a new schema, click **OK**, and then click **Schema Editor** in the main window.</span></span> <span data-ttu-id="46f42-157">Перейдите к сведениям [редактора схем](#schema-editor).</span><span class="sxs-lookup"><span data-stu-id="46f42-157">Then proceed to the [Schema Editor](#schema-editor) information.</span></span> <span data-ttu-id="46f42-158">Создавая файл схемы, не забудьте вернуться к окну **Дополнительные параметры**, чтобы добавить новый файл схемы.</span><span class="sxs-lookup"><span data-stu-id="46f42-158">Upon creating the new schema file, please remember to go back to the **Advanced Options** window to include the newly created schema file.</span></span>

6. <span data-ttu-id="46f42-159">Когда вы завершите настройку и закроете окно **настройки имени источника данных драйвера ODBC для Azure Cosmos DB**, новое пользовательское имя источника данных будет добавлено на соответствующую вкладку.</span><span class="sxs-lookup"><span data-stu-id="46f42-159">Once you complete and close the **Azure Cosmos DB ODBC Driver DSN Setup** window, the new User DSN is added to the User DSN tab.</span></span>

    ![Новое имя источника данных ODBC для Azure Cosmos DB на вкладке "DSN пользователя"](./media/odbc-driver/odbc-driver-user-dsn.png)

## <span data-ttu-id="46f42-161"><a id="#collection-mapping"></a>Шаг 3. Создание определения схемы с использованием метода сопоставления коллекций</span><span class="sxs-lookup"><span data-stu-id="46f42-161"><a id="#collection-mapping"></a>Step 3: Create a schema definition using the collection mapping method</span></span>

<span data-ttu-id="46f42-162">Существует два типа методов выборки, которые можно использовать: **сопоставление коллекций** и **таблицы-разделители**.</span><span class="sxs-lookup"><span data-stu-id="46f42-162">There are two types of sampling methods that you can use: **collection mapping** or **table-delimiters**.</span></span> <span data-ttu-id="46f42-163">В сеансе выборки могут использоваться оба метода выборки, но в каждой коллекции можно использовать только один из них.</span><span class="sxs-lookup"><span data-stu-id="46f42-163">A sampling session can utilize both sampling methods, but each collection can only use a specific sampling method.</span></span> <span data-ttu-id="46f42-164">Выполнив приведенные ниже действия, можно создать схему для данных в одной или нескольких коллекциях, используя метод сопоставления коллекций.</span><span class="sxs-lookup"><span data-stu-id="46f42-164">The steps below create a schema for the data in one or more collections using the collection mapping method.</span></span> <span data-ttu-id="46f42-165">При использовании этого метода выборки извлекаются данные на странице коллекции для определения структуры данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-165">This sampling method retrieves the data in the page of a collection to determine the structure of the data.</span></span> <span data-ttu-id="46f42-166">Коллекция переносится в таблицу на стороне ODBC.</span><span class="sxs-lookup"><span data-stu-id="46f42-166">It transposes a collection to a table on the ODBC side.</span></span> <span data-ttu-id="46f42-167">Этот метод выборки действует эффективно и быстро при использовании однородных данных в коллекции.</span><span class="sxs-lookup"><span data-stu-id="46f42-167">This sampling method is efficient and fast when the data in a collection is homogenous.</span></span> <span data-ttu-id="46f42-168">Если коллекция содержит разнородные данные, мы рекомендуем использовать [метод сопоставления таблиц-разделителей](#table-mapping), так как это более надежный метод выборки, позволяющий определить структуру данных в коллекции.</span><span class="sxs-lookup"><span data-stu-id="46f42-168">If a collection contains heterogenous type of data, we recommend you use the [table-delimiters mapping method](#table-mapping) as it provides a more robust sampling method to determine the data structures in the collection.</span></span> 

1. <span data-ttu-id="46f42-169">Выполнив шаги 1–4 в разделе о [подключении к базе данных Azure Cosmos DB](#connect), щелкните **Редактор схем** в окне **настройки имени источника данных драйвера ODBC для Azure Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="46f42-169">After completing steps 1-4 in [Connect to your Azure Cosmos DB database](#connect), click **Schema Editor** in the **Azure Cosmos DB ODBC Driver DSN Setup** window.</span></span>

    ![Кнопка "Редактор схем" в окне настройки имени источника данных драйвера ODBC для Azure Cosmos DB](./media/odbc-driver/odbc-driver-schema-editor.png)
2. <span data-ttu-id="46f42-171">В окне **Редактор схем** нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="46f42-171">In the **Schema Editor** window, click **Create New**.</span></span>
    <span data-ttu-id="46f42-172">Появится окно **создания схемы** со всеми коллекциями в учетной записи Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-172">The **Generate Schema** window displays all the collections in the Azure Cosmos DB account.</span></span> 
3. <span data-ttu-id="46f42-173">Выберите одну или несколько коллекций для выборки и щелкните **Sample** (Выборка).</span><span class="sxs-lookup"><span data-stu-id="46f42-173">Select one or more collections to sample, and then click **Sample**.</span></span> 
4. <span data-ttu-id="46f42-174">На вкладке **Design View** (Конструктор) представлены базы данных, схемы и таблицы.</span><span class="sxs-lookup"><span data-stu-id="46f42-174">In the **Design View** tab, the database, schema, and table are represented.</span></span> <span data-ttu-id="46f42-175">В табличном представлении отображается набор свойств, связанных с именами столбцов ("Имя SQL", "Имя источника" и т. д.).</span><span class="sxs-lookup"><span data-stu-id="46f42-175">In the table view, the scan displays the set of properties associated with the column names (SQL Name, Source Name, etc.).</span></span>
    <span data-ttu-id="46f42-176">Вы можете изменить имя, тип и длину SQL (если применимо), масштаб (если применимо), точность (если применимо) и параметр, допускающий значение null, для каждого столбца.</span><span class="sxs-lookup"><span data-stu-id="46f42-176">For each column, you can modify the column SQL name, the SQL type, SQL length (if applicable), Scale (if applicable), Precision (if applicable) and Nullable.</span></span>
    - <span data-ttu-id="46f42-177">Для параметра **Скрыть столбец** можно задать значение **true**, если необходимо исключить этот столбец из результатов запроса.</span><span class="sxs-lookup"><span data-stu-id="46f42-177">You can set **Hide Column** to **true** if you want to exclude that column from query results.</span></span> <span data-ttu-id="46f42-178">Столбцы, для параметра "Скрыть столбец" которых задано значение true, не возвращаются для выбора и проекции, несмотря на то, что они по-прежнему являются частью схемы.</span><span class="sxs-lookup"><span data-stu-id="46f42-178">Columns marked Hide Column = true are not returned for selection and projection, although they are still part of the schema.</span></span> <span data-ttu-id="46f42-179">Например, можно скрыть все обязательные системные свойства Azure Cosmos DB, начинающиеся со знака "_".</span><span class="sxs-lookup"><span data-stu-id="46f42-179">For example, you can hide all of the Azure Cosmos DB system required properties starting with “_”.</span></span>
    - <span data-ttu-id="46f42-180">Столбец **Идентификатор** — это единственное поле, которое нельзя скрыть, так как оно используется в качестве первичного ключа в нормализованной схеме.</span><span class="sxs-lookup"><span data-stu-id="46f42-180">The **id** column is the only field that cannot be hidden as it is used as the primary key in the normalized schema.</span></span> 
5. <span data-ttu-id="46f42-181">Завершив определение схемы, щелкните **Файл** | **Сохранить**, перейдите в каталог, чтобы сохранить схему, и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="46f42-181">Once you have finished defining the schema, click **File** | **Save**, navigate to the directory to save the schema, and then click **Save**.</span></span>

    <span data-ttu-id="46f42-182">Если в будущем нужно использовать эту схему с именем источника данных, откройте окно настройки имени источника данных драйвера ODBC для Azure Cosmos DB (в приложении "Администратор источников данных ODBC"), щелкните "Дополнительные параметры" и, используя поле файла схемы, перейдите к сохраненной схеме.</span><span class="sxs-lookup"><span data-stu-id="46f42-182">If in the future you want to use this schema with a DSN, open the Azure Cosmos DB ODBC Driver DSN Setup window (via the ODBC Data Source Administrator), click Advanced Options, and then in the Schema File box, navigate to the saved schema.</span></span> <span data-ttu-id="46f42-183">При сохранении файла схемы в существующем имени источника данных изменяется DSN-соединение в соответствии с данными и структурой, определенными схемой.</span><span class="sxs-lookup"><span data-stu-id="46f42-183">Saving a schema file to an existing DSN modifies the DSN connection to scope to the data and structure defined by schema.</span></span>

## <span data-ttu-id="46f42-184"><a id="table-mapping"></a>Шаг 4. Создание определения схемы с использованием метода таблиц-разделителей</span><span class="sxs-lookup"><span data-stu-id="46f42-184"><a id="table-mapping"></a>Step 4: Create a schema definition using the table-delimiters mapping method</span></span>

<span data-ttu-id="46f42-185">Существует два типа методов выборки, которые можно использовать: **сопоставление коллекций** и **таблицы-разделители**.</span><span class="sxs-lookup"><span data-stu-id="46f42-185">There are two types of sampling methods that you can use: **collection mapping** or **table-delimiters**.</span></span> <span data-ttu-id="46f42-186">В сеансе выборки могут использоваться оба метода выборки, но в каждой коллекции можно использовать только один из них.</span><span class="sxs-lookup"><span data-stu-id="46f42-186">A sampling session can utilize both sampling methods, but each collection can only use a specific sampling method.</span></span> 

<span data-ttu-id="46f42-187">Выполнив следующие действия, можно создать схему для данных в одной или нескольких коллекциях, используя метод **таблиц-разделителей**.</span><span class="sxs-lookup"><span data-stu-id="46f42-187">The following steps create a schema for the data in one or more collections using the **table-delimiters** mapping method.</span></span> <span data-ttu-id="46f42-188">Мы рекомендуем использовать этот метод выборки, если коллекции содержат разнородные данные.</span><span class="sxs-lookup"><span data-stu-id="46f42-188">We recommend that you use this sampling method when your collections contain heterogeneous type of data.</span></span> <span data-ttu-id="46f42-189">С помощью этого метода можно ограничить выборку набором атрибутов и соответствующими значениями.</span><span class="sxs-lookup"><span data-stu-id="46f42-189">You can use this method to scope the sampling to a set of attributes and its corresponding values.</span></span> <span data-ttu-id="46f42-190">Например, если документ содержит свойство "Тип", можно ограничить выборку значениями этого свойства.</span><span class="sxs-lookup"><span data-stu-id="46f42-190">For example, if a document contains a “Type” property, you can scope the sampling to the values of this property.</span></span> <span data-ttu-id="46f42-191">В результате выборки вы получите набор таблиц для каждого значения выбранного типа.</span><span class="sxs-lookup"><span data-stu-id="46f42-191">The end result of the sampling would be a set of tables for each of the values for Type you have specified.</span></span> <span data-ttu-id="46f42-192">Например, если выбрать значение "Автомобиль", будет создана таблица со сведениями об автомобилях, а если выбрать значение "Самолет", будет создана таблица со сведениями о самолетах.</span><span class="sxs-lookup"><span data-stu-id="46f42-192">For example, Type = Car will produce a Car table while Type = Plane would produce a Plane table.</span></span>

1. <span data-ttu-id="46f42-193">Выполнив шаги 1–4 в разделе о [подключении к базе данных Azure Cosmos DB](#connect), щелкните **Редактор схем** в окне настройки имени источника данных драйвера ODBC для Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-193">After completing steps 1-4 in [Connect to your Azure Cosmos DB database](#connect), click **Schema Editor** in the Azure Cosmos DB ODBC Driver DSN Setup window.</span></span>
2. <span data-ttu-id="46f42-194">В окне **Редактор схем** нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="46f42-194">In the **Schema Editor** window, click **Create New**.</span></span>
    <span data-ttu-id="46f42-195">Появится окно **создания схемы** со всеми коллекциями в учетной записи Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-195">The **Generate Schema** window displays all the collections in the Azure Cosmos DB account.</span></span> 
3. <span data-ttu-id="46f42-196">Выберите коллекцию на вкладке **Представление-пример** в столбце **Определение сопоставления** для коллекции и щелкните **Изменить**.</span><span class="sxs-lookup"><span data-stu-id="46f42-196">Select a collection on the **Sample View** tab, in the **Mapping Definition** column for the collection, click **Edit**.</span></span> <span data-ttu-id="46f42-197">Затем в окне **Mapping Definition** (Определение сопоставления) выберите метод **Table Delimiters** (Таблицы-разделители).</span><span class="sxs-lookup"><span data-stu-id="46f42-197">Then in the **Mapping Definition** window, select **Table Delimiters** method.</span></span> <span data-ttu-id="46f42-198">После этого выполните описанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="46f42-198">Then do the following:</span></span>

    <span data-ttu-id="46f42-199">а.</span><span class="sxs-lookup"><span data-stu-id="46f42-199">a.</span></span> <span data-ttu-id="46f42-200">В поле **Атрибуты** введите имя свойства разделителя.</span><span class="sxs-lookup"><span data-stu-id="46f42-200">In the **Attributes** box, type the name of a delimiter property.</span></span> <span data-ttu-id="46f42-201">Это свойство документа, которым нужно ограничить выборку (например, "Город"). Затем нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="46f42-201">This is a property in your document that you want to scope the sampling to, for instance, City and press enter.</span></span> 

    <span data-ttu-id="46f42-202">b.</span><span class="sxs-lookup"><span data-stu-id="46f42-202">b.</span></span> <span data-ttu-id="46f42-203">Если требуется ограничить выборку только конкретными значениями введенного атрибута, выберите атрибут в списке, а затем введите значение в поле **Значение**, например "Сиэтл", и нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="46f42-203">If you only want to scope the sampling to certain values for the attribute you just entered, select the attribute in the selection box, then enter a value in the **Value** box, for example, Seattle and press enter.</span></span> <span data-ttu-id="46f42-204">Вы можете добавить еще несколько значений для атрибутов.</span><span class="sxs-lookup"><span data-stu-id="46f42-204">You can continue to add multiple values for attributes.</span></span> <span data-ttu-id="46f42-205">При вводе значения убедитесь, что выбран правильный атрибут.</span><span class="sxs-lookup"><span data-stu-id="46f42-205">Just ensure that the correct attribute is selected when you're entering values.</span></span>

    <span data-ttu-id="46f42-206">Например, если добавить значение "Город" для **атрибута** и при этом нужно, чтобы таблица содержала только строки со значением города Нью-Йорк и Дубаи, в поле "Атрибуты" следует ввести "Город", а "Нью-Йорк" и "Дубаи" — в поле **Значения**.</span><span class="sxs-lookup"><span data-stu-id="46f42-206">For example, if you include an **Attributes** value of City, and you want to limit your table to only include rows with a city value of New York and Dubai, you would enter City in the Attributes box, and New York and then Dubai in the **Values** box.</span></span>
4. <span data-ttu-id="46f42-207">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="46f42-207">Click **OK**.</span></span> 
5. <span data-ttu-id="46f42-208">Завершив работу с определениями сопоставлений для коллекций, по которым нужно выполнить выборку, в окне **Редактор схем** щелкните **Sample** (Выборка).</span><span class="sxs-lookup"><span data-stu-id="46f42-208">After completing the mapping definitions for the collections you want to sample, in the **Schema Editor** window, click **Sample**.</span></span>
     <span data-ttu-id="46f42-209">Вы можете изменить имя, тип и длину SQL (если применимо), масштаб (если применимо), точность (если применимо) и параметр, допускающий значение null, для каждого столбца.</span><span class="sxs-lookup"><span data-stu-id="46f42-209">For each column, you can modify the column SQL name, the SQL type, SQL length (if applicable), Scale (if applicable), Precision (if applicable) and Nullable.</span></span>
    - <span data-ttu-id="46f42-210">Для параметра **Скрыть столбец** можно задать значение **true**, если необходимо исключить этот столбец из результатов запроса.</span><span class="sxs-lookup"><span data-stu-id="46f42-210">You can set **Hide Column** to **true** if you want to exclude that column from query results.</span></span> <span data-ttu-id="46f42-211">Столбцы, для параметра "Скрыть столбец" которых задано значение true, не возвращаются для выбора и проекции, несмотря на то, что они по-прежнему являются частью схемы.</span><span class="sxs-lookup"><span data-stu-id="46f42-211">Columns marked Hide Column = true are not returned for selection and projection, although they are still part of the schema.</span></span> <span data-ttu-id="46f42-212">Например, можно скрыть все обязательные системные свойства Azure Cosmos DB, начинающиеся со знака "_".</span><span class="sxs-lookup"><span data-stu-id="46f42-212">For example, you can hide all the Azure Cosmos DB system required properties starting with “_”.</span></span>
    - <span data-ttu-id="46f42-213">Столбец **Идентификатор** — это единственное поле, которое нельзя скрыть, так как оно используется в качестве первичного ключа в нормализованной схеме.</span><span class="sxs-lookup"><span data-stu-id="46f42-213">The **id** column is the only field that cannot be hidden as it is used as the primary key in the normalized schema.</span></span> 
6. <span data-ttu-id="46f42-214">Завершив определение схемы, щелкните **Файл** | **Сохранить**, перейдите в каталог, чтобы сохранить схему, и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="46f42-214">Once you have finished defining the schema, click **File** | **Save**, navigate to the directory to save the schema, and then click **Save**.</span></span>
7. <span data-ttu-id="46f42-215">В окне **настройки имени источника данных драйвера ODBC для Azure Cosmos DB** щелкните "Дополнительные параметры".</span><span class="sxs-lookup"><span data-stu-id="46f42-215">Back in the **Azure Cosmos DB ODBC Driver DSN Setup** window, click ** Advanced Options**.</span></span> <span data-ttu-id="46f42-216">Затем в поле **Schema File** (Файл схемы) перейдите к сохраненному файлу схемы и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="46f42-216">Then, in the **Schema File** box, navigate to the saved schema file and click **OK**.</span></span> <span data-ttu-id="46f42-217">Нажмите кнопку **ОК** еще раз, чтобы сохранить имя источника данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-217">Click **OK** again to save the DSN.</span></span> <span data-ttu-id="46f42-218">Таким образом сохраняется схема, созданная для имени источника данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-218">This saves the schema you created to the DSN.</span></span> 

## <a name="optional-creating-views"></a><span data-ttu-id="46f42-219">Создание представлений (необязательно)</span><span class="sxs-lookup"><span data-stu-id="46f42-219">(Optional) Creating views</span></span>
<span data-ttu-id="46f42-220">В ходе выборки можно определять и создавать представления.</span><span class="sxs-lookup"><span data-stu-id="46f42-220">You can define and create views as part of the sampling process.</span></span> <span data-ttu-id="46f42-221">Эти представления аналогичны представлениям SQL.</span><span class="sxs-lookup"><span data-stu-id="46f42-221">These views are equivalent to SQL views.</span></span> <span data-ttu-id="46f42-222">Они доступны только для чтения и ограничены выбранными элементами и проекциями определенной базы данных SQL в Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-222">They are read-only and are scope the selections and projections of the Azure Cosmos DB SQL defined.</span></span> 

<span data-ttu-id="46f42-223">Чтобы создать представление данных, в окне **Редактор схем** в столбце **Определения представлений** щелкните **Добавить** в строке коллекции для выборки.</span><span class="sxs-lookup"><span data-stu-id="46f42-223">To create a view for your data, in the **Schema Editor** window, in the **View Definitions** column, click **Add** on the row of the collection to sample.</span></span> <span data-ttu-id="46f42-224">Затем в окне **Определения представлений** сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="46f42-224">Then in the **View Definitions** window, do the following:</span></span>
1. <span data-ttu-id="46f42-225">Щелкните **Создать**, введите имя представления, например EmployeesfromSeattleView, и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="46f42-225">Click **New**, enter a name for the view, for example, EmployeesfromSeattleView and then click **OK**.</span></span>
2. <span data-ttu-id="46f42-226">В окне **Изменить представление** введите запрос Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f42-226">In the **Edit view** window, enter an Azure Cosmos DB query.</span></span> <span data-ttu-id="46f42-227">Это должен быть SQL-запрос Azure Cosmos DB, например `SELECT c.City, c.EmployeeName, c.Level, c.Age, c.Gender, c.Manager FROM c WHERE c.City = “Seattle”`. Затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="46f42-227">This must be an Azure Cosmos DB SQL query, for example`SELECT c.City, c.EmployeeName, c.Level, c.Age, c.Gender, c.Manager FROM c WHERE c.City = “Seattle”`, and then click **OK**.</span></span>

<span data-ttu-id="46f42-228">Количество создаваемых представлений не ограничено.</span><span class="sxs-lookup"><span data-stu-id="46f42-228">You can create a many views as you like.</span></span> <span data-ttu-id="46f42-229">Завершив определение представлений, можно приступить к выборке данных.</span><span class="sxs-lookup"><span data-stu-id="46f42-229">Once you are done defining the views, you can then sample the data.</span></span> 

## <a name="step-5-view-your-data-in-bi-tools-such-as-power-bi-desktop"></a><span data-ttu-id="46f42-230">Шаг 5. Просмотр данных в инструментах бизнес-аналитики (Power BI Desktop)</span><span class="sxs-lookup"><span data-stu-id="46f42-230">Step 5: View your data in BI tools such as Power BI Desktop</span></span>

<span data-ttu-id="46f42-231">Используя новое имя источника данных, можно подключиться к DocumentDB с помощью любых инструментов, совместимых с ODBC. На этом шаге показано, как подключиться к Power BI Desktop и создать визуализацию Power BI.</span><span class="sxs-lookup"><span data-stu-id="46f42-231">You can use your new DSN to connect DocumentADB with any ODBC-compliant tools - this step simply shows you how to connect to Power BI Desktop and create a Power BI visualization.</span></span>

1. <span data-ttu-id="46f42-232">Откройте Power BI Desktop.</span><span class="sxs-lookup"><span data-stu-id="46f42-232">Open Power BI Desktop.</span></span>
2. <span data-ttu-id="46f42-233">Щелкните **Получить данные**.</span><span class="sxs-lookup"><span data-stu-id="46f42-233">Click **Get Data**.</span></span>
3. <span data-ttu-id="46f42-234">В окне **Получить данные** щелкните **Другие** | **ODBC** | **Подключиться**.</span><span class="sxs-lookup"><span data-stu-id="46f42-234">In the **Get Data** window, click **Other** | **ODBC** | **Connect**.</span></span>
4. <span data-ttu-id="46f42-235">В окне **Из ODBC** выберите созданное имя источника данных и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="46f42-235">In the **From ODBC** window, select the data source name you created, and then click **OK**.</span></span> <span data-ttu-id="46f42-236">Поля на вкладке **Дополнительные параметры** можно не заполнять.</span><span class="sxs-lookup"><span data-stu-id="46f42-236">You can leave the **Advanced Options** entries blank.</span></span>
5. <span data-ttu-id="46f42-237">В окне **Access a data source using an ODBC driver** (Получение доступа к источнику данных с помощью драйвера ODBC) выберите параметр **По умолчанию или пользовательский** и щелкните **Подключиться**.</span><span class="sxs-lookup"><span data-stu-id="46f42-237">In the **Access a data source using an ODBC driver** window, select **Default or Custom** and then click **Connect**.</span></span> <span data-ttu-id="46f42-238">Не нужно добавлять **свойства строки подключения учетных данных**.</span><span class="sxs-lookup"><span data-stu-id="46f42-238">You do not need to include the **Credential connection string properties**.</span></span>
6. <span data-ttu-id="46f42-239">В окне **Навигатор** на панели слева разверните базу данных, схему и выберите таблицу.</span><span class="sxs-lookup"><span data-stu-id="46f42-239">In the **Navigator** window, in the left pane, expand the database, the schema, and then select the table.</span></span> <span data-ttu-id="46f42-240">В область результатов данные добавляются по созданной схеме.</span><span class="sxs-lookup"><span data-stu-id="46f42-240">The results pane includes the data using the schema you created.</span></span>
7. <span data-ttu-id="46f42-241">Чтобы визуализировать данные в Power BI Desktop, установите флажок рядом с именем таблицы и щелкните **Загрузить**.</span><span class="sxs-lookup"><span data-stu-id="46f42-241">To visualize the data in Power BI desktop, check the box in front of the table name, and then click **Load**.</span></span>
8. <span data-ttu-id="46f42-242">В Power BI Desktop слева выберите вкладку "Данные"</span><span class="sxs-lookup"><span data-stu-id="46f42-242">In Power BI Desktop, on the far left, select the Data tab</span></span> ![вкладка "Данные" в Power BI Desktop,](./media/odbc-driver/odbc-driver-data-tab.png) <span data-ttu-id="46f42-244">чтобы убедиться, что данные импортированы.</span><span class="sxs-lookup"><span data-stu-id="46f42-244">to confirm your data was imported.</span></span>
9. <span data-ttu-id="46f42-245">Теперь с помощью Power BI можно создавать визуальные элементы. Для этого щелкните вкладку "Отчет" ![вкладка "Отчет" в Power BI Desktop](./media/odbc-driver/odbc-driver-report-tab.png), выберите **Новый визуальный объект** и настройте элемент.</span><span class="sxs-lookup"><span data-stu-id="46f42-245">You can now create visuals using Power BI by clicking on the Report tab ![Report tab in Power BI Desktop](./media/odbc-driver/odbc-driver-report-tab.png), clicking **New Visual**, and then customizing your tile.</span></span> <span data-ttu-id="46f42-246">Дополнительные сведения о создании визуализаций в Power BI Desktop см. в статье [Типы визуализаций в Power BI](https://powerbi.microsoft.com/documentation/powerbi-service-visualization-types-for-reports-and-q-and-a/).</span><span class="sxs-lookup"><span data-stu-id="46f42-246">For more information about creating visualizations in Power BI Desktop, see [Visualization types in Power BI](https://powerbi.microsoft.com/documentation/powerbi-service-visualization-types-for-reports-and-q-and-a/).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="46f42-247">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="46f42-247">Troubleshooting</span></span>

<span data-ttu-id="46f42-248">Если появляется следующая ошибка, убедитесь, что значения параметров **Узел** и **Ключ доступа**, скопированные на портале Azure на [шаге 2](#connect), правильные, и повторите попытку.</span><span class="sxs-lookup"><span data-stu-id="46f42-248">If you receive the following error, ensure the **Host** and **Access Key** values you copied the Azure portal in [Step 2](#connect) are correct and then retry.</span></span> <span data-ttu-id="46f42-249">Чтобы скопировать значения без ошибок, нажмите кнопки копирования справа от значений параметров **Узел** и **Ключ доступа** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="46f42-249">Use the copy buttons to the right of the **Host** and **Access Key** values in the Azure portal to copy the values error free.</span></span>

    [HY000]: [Microsoft][Azure Cosmos DB] (401) HTTP 401 Authentication Error: {"code":"Unauthorized","message":"The input authorization token can't serve the request. Please check that the expected payload is built as per the protocol, and check the key being used. Server used the following payload to sign: 'get\ndbs\n\nfri, 20 jan 2017 03:43:55 gmt\n\n'\r\nActivityId: 9acb3c0d-cb31-4b78-ac0a-413c8d33e373"}`

## <a name="next-steps"></a><span data-ttu-id="46f42-250">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="46f42-250">Next steps</span></span>

<span data-ttu-id="46f42-251">Дополнительные сведения о службе Azure Cosmos DB см. в статье [Знакомство со службой Azure Cosmos DB. API DocumentDB](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="46f42-251">To learn more about Azure Cosmos DB, see [What is Azure Cosmos DB?](introduction.md).</span></span>
