---
title: "Общие сведения об API SQL для Azure Cosmos DB | Документация Майкрософт"
description: "Узнайте, как можно использовать Azure Cosmos DB для хранения больших объемов документов JSON и выполнения их запросов с минимальной задержкой с помощью SQL и JavaScript."
keywords: "база данных JSON, база данных документов"
services: cosmos-db
author: rafats
manager: jhubbard
editor: monicar
documentationcenter: 
ms.assetid: 686cdd2b-704a-4488-921e-8eefb70d5c63
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/22/2017
ms.author: rafats
ms.openlocfilehash: 28c18be81d184766f7b64199c09620238e47cde4
ms.sourcegitcommit: 0e4491b7fdd9ca4408d5f2d41be42a09164db775
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2017
---
# <a name="introduction-to-azure-cosmos-db-sql-api"></a>Общие сведения об Azure Cosmos DB: API SQL

[!INCLUDE [cosmos-db-sql-api](../../includes/cosmos-db-sql-api.md)]

[Azure Cosmos DB](introduction.md) — это глобально распределенная, многомодельная служба базы данных Майкрософт, необходимая для работы с критически важными приложениями. Эта служба базы данных обеспечивает [готовое к использованию глобальное распределение](distribute-data-globally.md), [гибкое масштабирование пропускной способности и хранилища](partition-data.md) по всему миру, задержки менее 10 миллисекунд на уровне 99-го процентиля, [пять четко определенных уровней согласованности](consistency-levels.md), а также гарантированную высокую доступность — все это согласно [ведущим в отрасли соглашениям об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/cosmos-db/). Azure Cosmos DB [автоматически индексирует данные](http://www.vldb.org/pvldb/vol8/p1668-shukla.pdf) без необходимости управлять схемой и индексом. Так как эта база данных является многомодельной, она поддерживает модели данных документа, пары "ключ — значение", графа и столбчатые модели данных.

![API SQL Azure](./media/sql-api-introduction/cosmosdb-sql-api.png) 

С помощью API SQL служба Azure Cosmos DB предоставляет широкие [возможности запросов SQL](sql-api-sql-query.md) с постоянно низкой задержкой для данных JSON без схемы. В этой статье содержится обзор API SQL службы Azure Cosmos DB, а также рекомендации по использованию этой службы для хранения больших объемов данных JSON. Вы также узнаете о том, как запрашивать эти данные в пределах миллисекундных задержек и как просто разработать структуру схемы. 

## <a name="what-capabilities-and-key-features-does-azure-cosmos-db-offer"></a>Какие основные функции и возможности предлагает служба Azure Cosmos DB?
С помощью API SQL служба Azure Cosmos DB предлагает следующие основные возможности и преимущества:

* **Гибко масштабируемые пропускная способность и объем хранения.** База данных JSON легко масштабируется в соответствии с потребностями вашего приложения. Ваши данные хранятся на твердотельных накопителях (SSD), что обеспечивает прогнозируемо низкие задержки. Azure Cosmos DB поддерживает контейнеры для хранения данных JSON, которые называются коллекциями и которые можно масштабировать, достигая практически неограниченных размеров хранилища и подготовленной пропускной способности. Вы можете гибко масштабировать Azure Cosmos DB с предсказуемым уровнем производительности по мере увеличения объема данных приложения. 


* **Репликация между несколькими регионами.** Azure Cosmos DB прозрачно реплицирует данные во все регионы, связанные с учетной записью Azure Cosmos DB. Это позволяет разрабатывать приложения, которым требуется глобальный доступ к данным, при этом обеспечивая компромиссы между согласованностью, доступностью и производительностью с соответствующими гарантиями. Эта служба обеспечивает прозрачную отработку отказа между регионами с помощью API-интерфейсов с поддержкой множественной адресации, а также возможность гибко масштабировать пропускную способность и размер хранилища по всему миру. Дополнительные сведения см. в статье о [глобальном распределении данных с использованием Azure Cosmos DB](distribute-data-globally.md).

* **Нерегламентированные запросы со знакомым синтаксисом SQL** — хранение гетерогенных документов JSON и запросы этих документов с помощью знакомого синтаксиса SQL. Служба Azure Cosmos DB использует технологию индексирования со структурированием журналов и с высокой степенью параллелизма без блокировки для автоматического индексирования всего содержимого документа. Это позволяет формировать многофункциональные запросы в режиме реального времени без необходимости указывать подсказки для схемы, вторичные индексы или представления. Дополнительные сведения см. в статье о [SQL-запросах и синтаксисе SQL в Azure Cosmos DB](sql-api-sql-query.md). 
* **Выполнение JavaScript в базе данных.** Реализация логики приложения в виде хранимых процедур, триггеров и пользовательских функций (UDF), использующих стандартный JavaScript. Это позволяет логике приложения оперировать данными, не беспокоясь о соответствии между приложением и схемой базы данных. API SQL предоставляет полное транзакционное выполнение логики приложения JavaScript непосредственно внутри ядра СУБД. Глубокая интеграция JavaScript позволяет выполнять операции INSERT, REPLACE, DELETE и SELECT из кода JavaScript в изолированной транзакции. Дополнительные сведения см. в статье [Программирование Azure Cosmos DB на стороне сервера: хранимые процедуры, триггеры баз данных и определяемые пользователем функции](programming.md).

* **Настраиваемые уровни согласованности.** Вам доступны на выбор пять четко определенных уровней согласованности для достижения оптимального соотношения между согласованностью и производительностью. Для запросов и операций чтения служба Azure Cosmos DB предлагает пять отдельных уровней согласованности — сильный, с ограниченным устареванием, сеансовый, с согласованностью префиксов и согласованный в конечном счете. Эти разделенные, четко определенные уровни согласованности позволяют принимать обоснованные компромиссы между показателями согласованности, доступности и задержки. Дополнительные сведения см. в статье [Настраиваемые уровни согласованности данных в DocumentDB](consistency-levels.md).

* **Полная управляемость:** устранение необходимости управления базой данных и вычислительными ресурсами. В полностью управляемой службе Microsoft Azure вам не нужно заниматься управлением виртуальными машинами, развертыванием и настройкой программного обеспечения или масштабированием или иметь дело со сложными обновлениями на уровне данных. Каждая база данных автоматически сохраняется и защищается от региональных сбоев. Вы можете легко добавлять учетные записи Azure Cosmos DB и подготавливать необходимую емкость по мере необходимости, что позволяет сосредоточиться на приложении, а не на вопросах эксплуатации и управления базой данных. 

* **Открытая структура:** быстрое начало работы с имеющимися навыками и инструментами. Программирование API SQL является простым и доступным и не требует изучения новых средств или пользовательских расширений для JSON или JavaScript. Вы можете получить доступ ко всей функциональности базы данных, включая CRUD, запросы и обработку JavaScript через простой HTTP-интерфейс с поддержкой REST. API SQL охватывает существующие форматы, языки и стандарты, предлагая широкие возможности и функции базы данных.

* **Автоматическая индексация.** По умолчанию Azure Cosmos DB автоматически индексирует все документы в базе данных, не ожидая и не требуя наличия какой-либо схемы или создания дополнительных индексов. Не желаете индексировать все файлы? Вы всегда можете [отказаться от использования путей к своим JSON-файлам](indexing-policies.md) .

* **Поддержка веб-канала изменений.** Веб-канал изменений предоставляет отсортированный список документов в коллекции Azure Cosmos DB в том порядке, в котором они были изменены. Этот веб-канал можно использовать для прослушивания изменения данных, чтобы реплицировать данные, активировать вызовы API или выполнять потоковую обработку обновлений. Веб-канал изменений включается автоматически, его легко использовать. Дополнительные сведения см. в статье [Работа с поддержкой веб-канала изменений в Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/change-feed). 

## <a name="data-management"></a>Как управлять данными с помощью API SQL?
API SQL помогает управлять данными JSON с помощью четко определенных ресурсов базы данных. Эти ресурсы реплицируются для обеспечения высокой доступности и однозначно адресуются по их логическому URI. API SQL предлагает простую и открытую модель программирования через HTTP-интерфейс с поддержкой REST для всех ресурсов. 


Учетная запись базы данных Azure Cosmos DB — это уникальное пространство имен, предоставляющее доступ к службе Azure Cosmos DB. Прежде чем создавать учетную запись базы данных, вам необходимо оформить подписку Azure, которая дает доступ к различным службам Azure. 

Все ресурсы в Azure Cosmos DB моделируются и хранятся как документы JSON. Ресурсы управляются как элементы, которые представляют собой документы JSON, содержащие метаданные, и как потоки, которые представляют собой коллекции элементов. Наборы элементов содержатся внутри соответствующих потоков.

На рисунке ниже показаны взаимосвязи между ресурсами Azure Cosmos DB.

![Иерархическая связь между ресурсами в службе Azure Cosmos DB][1] 

Учетная запись базы данных состоит из набора баз данных, каждая из которых содержит несколько коллекций, каждая из которых в свою очередь содержит хранимые процедуры, триггеры, определяемые пользователем функции, документы и соответствующие вложения. База данных также имеет связанных с ней пользователей, каждый из которых обладает набором разрешений для доступа к коллекциям, хранимым процедурам, триггерам, определяемым пользователем функциям, документам и вложениям. В то время как базы данных, пользователи, разрешения и коллекции — это определяемые системой ресурсы с известными схемами, документы, хранимые процедуры, триггеры, определяемые пользователем функции и вложения содержат произвольное, определяемое пользователем содержимое в формате JSON.  

## <a name="develop"></a> Как разработать приложения с помощью API SQL?

Azure Cosmos DB предоставляет ресурсы с помощью интерфейсов API REST, которые можно вызвать с помощью любого языка, позволяющего отправлять запросы HTTP или HTTPS. Кроме того, мы предлагаем библиотеки программирования для нескольких распространенных языков для API SQL. Эти клиентские библиотеки упрощают многие аспекты работы с API, обрабатывая такие процессы, как кэширование адресов, управление исключениями, автоматические повторы и т. д. В настоящее время доступны библиотеки для следующих языков и платформ:  

| Загрузить | Документация |
| --- | --- |
| [ПАКЕТ SDK .NET](http://go.microsoft.com/fwlink/?LinkID=402989) |[Библиотека для .NET](/dotnet/api/overview/azure/cosmosdb?view=azure-dotnet) |
| [Пакет SDK для Node.js](http://go.microsoft.com/fwlink/?LinkID=402990) |[Библиотека для Node.js](http://azure.github.io/azure-documentdb-node/) |
| [Пакет SDK для Java](http://go.microsoft.com/fwlink/?LinkID=402380) |[Библиотека для Java](/java/api/com.microsoft.azure.documentdb) |
| [Пакет SDK для JavaScript](http://go.microsoft.com/fwlink/?LinkID=402991) |[Библиотека для JavaScript](http://azure.github.io/azure-documentdb-js/) |
| Недоступно |[Пакет SDK для серверного JavaScript](http://azure.github.io/azure-documentdb-js-server/) |
| [Пакет SDK для Python](https://pypi.python.org/pypi/pydocumentdb) |[Библиотека для Python](http://azure.github.io/azure-documentdb-python/) |
| Недоступно | [API для MongoDB](mongodb-introduction.md)


[Эмулятор Azure Cosmos DB](local-emulator.md) позволит вам локально разработать и проверить приложение с помощью API SQL без создания подписки Azure и без каких-либо затрат. Если приложение в эмуляторе работает правильно, вы можете использовать учетную запись Azure Cosmos DB в облаке.

Помимо основных операций создания, чтения, обновления и удаления данных API SQL предоставляет обширный интерфейс запросов SQL для извлечения документов JSON и поддержку транзакционного выполнения логики приложения JavaScript на стороне сервера. Интерфейсы выполнения запросов и сценарий доступны во всех библиотеках платформы, а также через интерфейс API REST. 

### <a name="sql-query"></a>Запросы SQL
Azure Cosmos DB поддерживает запросы к документам, используя язык SQL, который основан на системе типов JavaScript, и выражения с поддержкой реляционных, иерархических и пространственных запросов. Язык запросов Azure Cosmos DB — это простой, но мощный интерфейс для запроса документов JSON. Язык поддерживает грамматику подмножества ANSI SQL и добавляет глубокую интеграцию объектов, массивов, создания объектов и вызова функций JavaScript. Модель запросов API SQL предоставляется без явных схем или подсказок индексации от разработчика.

Пользовательские функции могут быть зарегистрированы в API SQL. На них можно ссылаться как на часть SQL-запроса, тем самым расширяя грамматику для поддержки логики пользовательского приложения. Эти определяемые пользователем функции записываются в виде программ JavaScript и выполняются в базе данных. 

Для .NET-разработчиков в API SQL также предлагается поставщик запросов LINQ в составе [пакета SDK для .NET](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.linq.aspx). 

### <a name="transactions-and-javascript-execution"></a>Транзакции и выполнение JavaScript
API SQL позволяет реализовать логику приложения в виде программ, написанных полностью на JavaScript. Эти программы регистрируются в коллекции и могут выполнять операции с документами базы данных в пределах данной коллекции. JavaScript может быть зарегистрирован для выполнения в качестве триггера, хранимой процедуры или пользовательской функции (UDF). Триггеры и хранимые процедуры могут создавать, читать, обновлять и удалять документы, в то время как определяемые пользователем функции выполняются в рамках логики выполнения запроса без доступа на запись в коллекции.

Выполнение JavaScript в Cosmos DB моделируется по принципам, поддерживаемым реляционными СУБД. JavaScript выступает в качестве современной замены Transact-SQL. Вся логика JavaScript выполняется в транзакции ACID с изоляцией моментального снимка. В ходе его исполнения, если код JavaScript генерирует исключение, то вся транзакция прерывается.

## <a name="next-steps"></a>Дальнейшие действия
Уже есть учетная запись Azure? Тогда вы можете приступить к работе с Azure Cosmos DB, ознакомившись с нашими [краткими руководствами](../cosmos-db/create-sql-api-dotnet.md) по созданию учетной записи и работе со службой Cosmos DB.

[1]: ./media/sql-api-introduction/json-database-resources1.png

