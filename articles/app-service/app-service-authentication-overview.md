---
title: "Проверка подлинности и авторизация в службе приложений Azure | Документация Майкрософт"
description: "Принципы использования и обзор функции проверки подлинности и авторизации в службе приложений Azure"
services: app-service
documentationcenter: 
author: mattchenderson
manager: erikre
editor: 
ms.assetid: b7151b57-09e5-4c77-a10c-375a262f17e5
ms.service: app-service
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/29/2016
ms.author: mahender
ms.openlocfilehash: e89ba5613c615c41af93e8f63b3703da8395095c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="authentication-and-authorization-in-azure-app-service"></a><span data-ttu-id="2f3f5-103">Проверка подлинности и авторизация в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="2f3f5-103">Authentication and authorization in Azure App Service</span></span>
## <a name="what-is-app-service-authentication--authorization"></a><span data-ttu-id="2f3f5-104">Что такое проверка подлинности и авторизация службы приложений?</span><span class="sxs-lookup"><span data-stu-id="2f3f5-104">What is App Service Authentication / Authorization?</span></span>
<span data-ttu-id="2f3f5-105">Проверка подлинности и авторизация службы приложений — это функция, которая позволяет приложению выполнять вход пользователей, не требуя изменения кода в серверной части приложения.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-105">App Service Authentication / Authorization is a feature that provides a way for your application to sign in users so that you don't have to change code on the app backend.</span></span> <span data-ttu-id="2f3f5-106">Она является простым способом обеспечения защиты приложения и работы с данными пользователей.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-106">It provides an easy way to protect your application and work with per-user data.</span></span>

<span data-ttu-id="2f3f5-107">Служба приложений использует федеративную идентификацию, при которой сторонний поставщик удостоверений сохраняет учетные записи и проводит аутентификацию пользователей.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-107">App Service uses federated identity, in which a third-party identity provider stores accounts and authenticates users.</span></span> <span data-ttu-id="2f3f5-108">Приложение использует информацию об удостоверении поставщика вместо того, чтобы хранить ее самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-108">The application relies on the provider's identity information so that the app doesn't have to store that information itself.</span></span> <span data-ttu-id="2f3f5-109">Служба приложений поддерживает пять поставщиков удостоверений по умолчанию: Azure Active Directory, Facebook, Google, учетная запись Майкрософт и Twitter.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-109">App Service supports five identity providers out of the box: Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter.</span></span> <span data-ttu-id="2f3f5-110">Приложение может использовать любое количество поставщиков удостоверений, позволяя пользователям выбрать способ входа.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-110">Your app can use any number of these identity providers to provide your users with options for how they sign in.</span></span> <span data-ttu-id="2f3f5-111">Чтобы расширить встроенную поддержку, можно добавить другой поставщик удостоверений или [собственное настраиваемое решение для идентификации][custom-auth].</span><span class="sxs-lookup"><span data-stu-id="2f3f5-111">To expand the built-in support, you can integrate another identity provider or [your own custom identity solution][custom-auth].</span></span>

<span data-ttu-id="2f3f5-112">Чтобы немедленно приступить к работе, ознакомьтесь с одним из следующих руководств:</span><span class="sxs-lookup"><span data-stu-id="2f3f5-112">If you want to get started right away, see one of the following tutorials:</span></span>

* <span data-ttu-id="2f3f5-113">[Добавление проверки подлинности в приложение iOS][iOS] (или в приложение для [Windows], приложение [Android], [Xamarin.iOS], [Xamarin.Android], [Xamarin.Forms] или [Cordova]).</span><span class="sxs-lookup"><span data-stu-id="2f3f5-113">[Add authentication to your iOS app][iOS] (or [Android], [Windows], [Xamarin.iOS], [Xamarin.Android], [Xamarin.Forms], or [Cordova])</span></span>
* <span data-ttu-id="2f3f5-114">[Проверка подлинности пользователя для приложений API в службе приложений Azure][apia-user]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-114">[User authentication for API Apps in Azure App Service][apia-user]</span></span>
* <span data-ttu-id="2f3f5-115">[Начало работы со службой приложений Azure (часть 2)][web-getstarted]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-115">[Get started with Azure App Service - Part 2][web-getstarted]</span></span>

## <a name="how-authentication-works-in-app-service"></a><span data-ttu-id="2f3f5-116">Как устроена проверка подлинности в службе приложений</span><span class="sxs-lookup"><span data-stu-id="2f3f5-116">How authentication works in App Service</span></span>
<span data-ttu-id="2f3f5-117">Чтобы выполнять проверку подлинности с помощью одного из поставщиков удостоверений, сначала необходимо настроить поставщик удостоверений так, чтобы ему было известно о вашем приложении.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-117">In order to authenticate by using one of the identity providers, you first need to configure the identity provider to know about your application.</span></span> <span data-ttu-id="2f3f5-118">Затем поставщик удостоверений предоставит идентификаторы и секреты, которые необходимо передать службе приложений.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-118">The identity provider will then provide IDs and secrets that you provide to App Service.</span></span> <span data-ttu-id="2f3f5-119">На этом отношение доверия завершается, и после этого служба приложений может проверять утверждения пользователей от поставщика удостоверений, например маркеры проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-119">This completes the trust relationship so that App Service can validate user assertions, such as authentication tokens, from the identity provider.</span></span>

<span data-ttu-id="2f3f5-120">Для входа с использованием одного из этих поставщиков пользователь должен быть перенаправлен на конечную точку входа для этого поставщика.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-120">To sign in a user by using one of these providers, the user must be redirected to an endpoint that signs in users for that provider.</span></span> <span data-ttu-id="2f3f5-121">Если клиенты используют веб-браузер, можно сделать так, чтобы служба приложений автоматически перенаправляла на конечную точку входа всех пользователей, не прошедших проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-121">If customers are using a web browser, you can have App Service automatically direct all unauthenticated users to the endpoint that signs in users.</span></span> <span data-ttu-id="2f3f5-122">В противном случае необходимо перенаправить клиентов в `{your App Service base URL}/.auth/login/<provider>`, где параметру `<provider>` задано одно из таких значений: aad, facebook, google, microsoft или twitter.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-122">Otherwise, you will need to direct your customers to `{your App Service base URL}/.auth/login/<provider>`, where `<provider>` is one of the following values: aad, facebook, google, microsoft, or twitter.</span></span> <span data-ttu-id="2f3f5-123">Сценарии для мобильных устройств и API рассматриваются в следующих разделах этой статьи.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-123">Mobile and API scenarios are explained in sections later in this article.</span></span>

<span data-ttu-id="2f3f5-124">У пользователей, которые взаимодействуют с приложением через веб-браузер, файл cookie будет настроен таким образом, чтобы при просмотре приложения они оставались аутентифицированными.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-124">Users who interact with your application through a web browser will have a cookie set so that they can remain authenticated as they browse your application.</span></span> <span data-ttu-id="2f3f5-125">Для других типов клиентов, например мобильных устройств, клиенту будет выдан веб-маркер JSON (JWT), который должен присутствовать в заголовке `X-ZUMO-AUTH` .</span><span class="sxs-lookup"><span data-stu-id="2f3f5-125">For other client types, such as mobile, a JSON web token (JWT), which should be presented in the `X-ZUMO-AUTH` header, will be issued to the client.</span></span> <span data-ttu-id="2f3f5-126">В пакетах SDK для клиента мобильных приложений это будет сделано автоматически.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-126">The Mobile Apps client SDKs will handle this for you.</span></span> <span data-ttu-id="2f3f5-127">Кроме того, в заголовок `Authorization` можно напрямую включить маркер идентификации Azure Active Directory или маркер доступа в качестве [токена носителя](https://tools.ietf.org/html/rfc6750).</span><span class="sxs-lookup"><span data-stu-id="2f3f5-127">Alternatively, an Azure Active Directory identity token or access token may be directly included in the `Authorization` header as a [bearer token](https://tools.ietf.org/html/rfc6750).</span></span>

<span data-ttu-id="2f3f5-128">Служба приложений будет проверять все файлы cookie и маркеры, выпущенные вашим приложением, для проверки подлинности пользователей.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-128">App Service will validate any cookie or token that your application issues to authenticate users.</span></span> <span data-ttu-id="2f3f5-129">Сведения о том, как ограничить доступ к приложению, см. в разделе [Принцип действия авторизации в службе приложений](#authorization) ниже.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-129">To restrict who can access your application, see the [Authorization](#authorization) section later in this article.</span></span>

### <a name="mobile-authentication-with-a-provider-sdk"></a><span data-ttu-id="2f3f5-130">Мобильная проверка подлинности с пакетом SDK поставщика</span><span class="sxs-lookup"><span data-stu-id="2f3f5-130">Mobile authentication with a provider SDK</span></span>
<span data-ttu-id="2f3f5-131">Выполнив все настройки на серверной стороне, можно изменить мобильные клиенты для входа в службу приложений.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-131">After everything is configured on the backend, you can modify mobile clients to sign in with App Service.</span></span> <span data-ttu-id="2f3f5-132">Существует два подхода:</span><span class="sxs-lookup"><span data-stu-id="2f3f5-132">There are two approaches here:</span></span>

* <span data-ttu-id="2f3f5-133">использование пакета SDK, опубликованного указанным поставщиком удостоверений, для определения удостоверения и последующего получения доступа к службе приложений;</span><span class="sxs-lookup"><span data-stu-id="2f3f5-133">Use an SDK that a given identity provider publishes to establish identity and then gain access to App Service.</span></span>
* <span data-ttu-id="2f3f5-134">использование одной строки кода для входа пользователей с помощью пакета SDK клиента для мобильных приложений.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-134">Use a single line of code so that the Mobile Apps client SDK can sign in users.</span></span>

> [!TIP]
> <span data-ttu-id="2f3f5-135">Большинству приложений следует использовать пакет SDK поставщика, чтобы обеспечить согласованное взаимодействие с пользователями во время входа, получать поддержку обновлений и другие преимущества, указанные поставщиком.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-135">Most applications should use a provider SDK to get a more consistent experience when users sign in, to use refresh support, and to get other benefits that the provider specifies.</span></span>
> 
> 

<span data-ttu-id="2f3f5-136">При использовании пакета SDK поставщика пользователи могут входить в интерфейс, который теснее интегрируется с операционной системой, в которой запущено приложение.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-136">When you use a provider SDK, users can sign in to an experience that integrates more tightly with the operating system that the app is running on.</span></span> <span data-ttu-id="2f3f5-137">При этом вы также получаете маркер поставщика и некоторые сведения о пользователях на стороне клиента, что упрощает использование Graph API и настройку пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-137">This also gives you a provider token and some user information on the client, which makes it much easier to consume graph APIs and customize the user experience.</span></span> <span data-ttu-id="2f3f5-138">Иногда в блогах и на форумах это может называться "клиентским потоком" или "управляемым клиентом потоком", так как управление входом на клиенте выполняет код, и код клиента имеет доступ к маркеру поставщика.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-138">Occasionally on blogs and forums, you will see this referred to as the "client flow" or "client-directed flow" because code on the client signs in users, and the client code has access to a provider token.</span></span>

<span data-ttu-id="2f3f5-139">Полученный маркер поставщика необходимо отправить в службу приложений для проверки.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-139">After a provider token is obtained, it needs to be sent to App Service for validation.</span></span> <span data-ttu-id="2f3f5-140">После того как служба приложений проверит маркер, она создает новый маркер службы приложений, который возвращается клиенту.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-140">After App Service validates the token, App Service creates a new App Service token that is returned to the client.</span></span> <span data-ttu-id="2f3f5-141">Пакет SDK для клиента мобильных приложений содержит вспомогательные методы, которые управляют этим обменом и автоматически присоединяют маркеры ко всем запросам к серверной части приложения.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-141">The Mobile Apps client SDK has helper methods to manage this exchange and automatically attach the token to all requests to the application backend.</span></span> <span data-ttu-id="2f3f5-142">Если необходимо, разработчики также могут сохранить ссылку на маркер поставщика.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-142">Developers can also keep a reference to the provider token if they so choose.</span></span>

### <a name="mobile-authentication-without-a-provider-sdk"></a><span data-ttu-id="2f3f5-143">Мобильная проверка подлинности без пакета SDK поставщика</span><span class="sxs-lookup"><span data-stu-id="2f3f5-143">Mobile authentication without a provider SDK</span></span>
<span data-ttu-id="2f3f5-144">Вместо настройки пакета SDK можно настроить выполнение входа с помощью функции мобильных приложений службы приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-144">If you do not want to set up a provider SDK, you can allow the Mobile Apps feature of Azure App Service to sign in for you.</span></span> <span data-ttu-id="2f3f5-145">Клиентский пакет SDK мобильных приложений будет открывать выбранному вами поставщику веб-представление и осуществлять процедуру входа.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-145">The Mobile Apps client SDK will open a web view to the provider of your choosing and sign in the user.</span></span> <span data-ttu-id="2f3f5-146">Иногда в блогах и на форумах это называется "серверным потоком" или "управляемым сервером потоком", так как процедурой входа управляет сервер, а пакет SDK клиента никогда не получает маркер поставщика.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-146">Occasionally on blogs and forums, you will see this referred to as the "server flow" or "server-directed flow" because the server manages the process that signs in users, and the client SDK never receives the provider token.</span></span>

<span data-ttu-id="2f3f5-147">Код, необходимый для запуска этого потока, рассматривается в руководстве по проверке подлинности для каждой платформы.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-147">Code to start this flow is included in the authentication tutorial for each platform.</span></span> <span data-ttu-id="2f3f5-148">В конце потока у клиентского пакета SDK есть маркер службы приложений, и маркер автоматически присоединяется ко всем запросам, отправляемым к серверной части приложения.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-148">At the end of the flow, the client SDK has an App Service token, and the token is automatically attached to all requests to the application backend.</span></span>

### <a name="service-to-service-authentication"></a><span data-ttu-id="2f3f5-149">Взаимодействие между службами</span><span class="sxs-lookup"><span data-stu-id="2f3f5-149">Service-to-service authentication</span></span>
<span data-ttu-id="2f3f5-150">Помимо предоставления пользователям прямого доступа к своему приложению, можно также доверить другому приложению вызывать API вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-150">Although you can give users access to your application, you can also trust another application to call your own API.</span></span> <span data-ttu-id="2f3f5-151">Например, одно веб-приложение может вызывать API в другом веб-приложении.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-151">For example, you could have one web app call an API in another web app.</span></span> <span data-ttu-id="2f3f5-152">В этом случае для получения маркера используются учетные данные службы, а не учетные данные пользователя.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-152">In this scenario, you use credentials for a service account instead of user credentials to get a token.</span></span> <span data-ttu-id="2f3f5-153">Учетная запись службы в терминологии Azure Active Directory также называется *субъектом-службой* , а проверка подлинности с использованием такой учетной записи называется сценарием взаимодействия между службами.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-153">A service account is also known as a *service principal* in Azure Active Directory parlance, and authentication that uses such an account is also known as a service-to-service scenario.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2f3f5-154">Так как мобильные приложения работают на клиентских устройствах, эти приложения *не* считаются доверенными и не должны использовать поток субъекта-службы.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-154">Because mobile apps run on customer devices, mobile applications do *not* count as trusted applications and should not use a service principal flow.</span></span> <span data-ttu-id="2f3f5-155">Вместо этого они должны использовать пользовательский поток, описанный выше.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-155">Instead, they should use a user flow that was detailed earlier.</span></span>
> 
> 

<span data-ttu-id="2f3f5-156">В сценариях взаимодействия между службами служба приложений может защитить приложение с помощью Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-156">For service-to-service scenarios, App Service can protect your application by using Azure Active Directory.</span></span> <span data-ttu-id="2f3f5-157">Вызывающее приложение просто предоставляет маркер авторизации субъекта-службы Azure Active Directory, полученный после предоставления идентификатора клиента и секрета клиента от Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-157">The calling application just needs to provide an Azure Active Directory service principal authorization token that is obtained by providing the client ID and client secret from Azure Active Directory.</span></span> <span data-ttu-id="2f3f5-158">Пример такого сценария для приложений API ASP.NET приводится в руководстве [Проверка подлинности с использованием субъекта-службы для приложений API в службе приложений Azure][apia-service].</span><span class="sxs-lookup"><span data-stu-id="2f3f5-158">An example of this scenario that uses ASP.NET API apps is explained by the tutorial, [Service principal authentication for API Apps][apia-service].</span></span>

<span data-ttu-id="2f3f5-159">Если в сценарии взаимодействия между службами нужно выполнить проверку подлинности службы приложений, используйте сертификаты клиентов или обычную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-159">If you want to use App Service authentication to handle a service-to-service scenario, you can use client certificates or basic authentication.</span></span> <span data-ttu-id="2f3f5-160">Сведения о клиентских сертификатах в Azure см. в статье [Настройка взаимной проверки подлинности TLS для веб-приложения](../app-service-web/app-service-web-configure-tls-mutual-auth.md).</span><span class="sxs-lookup"><span data-stu-id="2f3f5-160">For information about client certificates in Azure, see [How To Configure TLS Mutual Authentication for Web Apps](../app-service-web/app-service-web-configure-tls-mutual-auth.md).</span></span> <span data-ttu-id="2f3f5-161">Сведения об обычной проверке подлинности в ASP.NET см. в статье [Authentication Filters in ASP.NET Web API 2](http://www.asp.net/web-api/overview/security/authentication-filters) (Фильтры проверки подлинности в веб-API ASP.NET 2).</span><span class="sxs-lookup"><span data-stu-id="2f3f5-161">For information about basic authentication in ASP.NET, see [Authentication Filters in ASP.NET Web API 2](http://www.asp.net/web-api/overview/security/authentication-filters).</span></span>

<span data-ttu-id="2f3f5-162">Проверка подлинности учетной записи службы из приложения логики службы приложений в приложение API — это особый вариант проверки подлинности, который описан в статье [Использование настраиваемого интерфейса API, размещенного в службе приложений, с приложениями логики](../logic-apps/logic-apps-custom-hosted-api.md).</span><span class="sxs-lookup"><span data-stu-id="2f3f5-162">Service account authentication from an App Service logic app to an API app is a special case that is detailed in [Using your custom API hosted on App Service with Logic apps](../logic-apps/logic-apps-custom-hosted-api.md).</span></span>

## <span data-ttu-id="2f3f5-163"><a name="authorization"></a>Принцип действия авторизации в службе приложений</span><span class="sxs-lookup"><span data-stu-id="2f3f5-163"><a name="authorization"></a>How authorization works in App Service</span></span>
<span data-ttu-id="2f3f5-164">Вы полностью контролируете, какие запросы могут быть отправлены приложению.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-164">You have full control over the requests that can access your application.</span></span> <span data-ttu-id="2f3f5-165">Проверку подлинности и авторизацию службы приложений можно настроить для любого из следующих вариантов:</span><span class="sxs-lookup"><span data-stu-id="2f3f5-165">App Service Authentication / Authorization can be configured with any of the following behaviors:</span></span>

* <span data-ttu-id="2f3f5-166">Приложению могут отправляться только запросы, прошедшие проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-166">Allow only authenticated requests to reach your application.</span></span>
  
    <span data-ttu-id="2f3f5-167">Если из браузера поступает анонимный запрос, служба приложений перенаправляет его на страницу входа выбранного поставщика удостоверений.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-167">If a browser receives an anonymous request, App Service will redirect to a page for the identity provider that you choose so that users can sign in.</span></span> <span data-ttu-id="2f3f5-168">Если запрос приходит с мобильного устройства, будет возвращен ответ HTTP *401 — Не санкционировано*.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-168">If the request comes from a mobile device, the returned response is an HTTP *401 Unauthorized* response.</span></span>
  
    <span data-ttu-id="2f3f5-169">В этом случае в клиентском приложении не нужен никакой код для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-169">With this option, you don't need to write any authentication code at all in your app.</span></span> <span data-ttu-id="2f3f5-170">Если требуется более контролируемая авторизация, можно воспользоваться сведениями о пользователе в коде.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-170">If you need finer authorization, information about the user is available to your code.</span></span>
* <span data-ttu-id="2f3f5-171">Приложению могут отправляться все запросы, но запросы проверки подлинности нужно проверять и передавать сведения о проверке подлинности в заголовках HTTP.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-171">Allow all requests to reach your application, but validate authenticated requests, and pass along authentication information in the HTTP headers.</span></span>
  
    <span data-ttu-id="2f3f5-172">В этом случае решение об авторизации должно приниматься в коде приложения.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-172">This option defers authorization decisions to your application code.</span></span> <span data-ttu-id="2f3f5-173">Такая схема обеспечивает большую гибкость в обработке анонимных запросов, но требует написания кода.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-173">It provides more flexibility in handling anonymous requests, but you have to write code.</span></span>
* <span data-ttu-id="2f3f5-174">Приложению могут отправляться все запросы. Сведения о проверке подлинности в запросах не используются.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-174">Allow all requests to reach your application, and take no action on authentication information in the requests.</span></span>
  
    <span data-ttu-id="2f3f5-175">В этом случае функция аутентификации и авторизации отключена.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-175">In this case, the Authentication / Authorization feature is off.</span></span> <span data-ttu-id="2f3f5-176">Все задачи проверки подлинности и авторизации полностью ложатся на код приложения.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-176">The tasks of authentication and authorization are entirely up to your application code.</span></span>

<span data-ttu-id="2f3f5-177">Выбрать выполняемое действие можно с помощью параметра **Предпринимаемое действие, если проверка подлинности для запроса не выполнена** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-177">The previous behaviors are controlled by the **Action to take when request is not authenticated** option in the Azure portal.</span></span> <span data-ttu-id="2f3f5-178">Если выбрать параметр **Войти как *имя_поставщика***, все запросы будут проходить проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-178">If you choose **Log in with *provider name* **, all requests have to be authenticated.</span></span> <span data-ttu-id="2f3f5-179">Если выбрать параметр **Разрешить запрос (нет действия)**, решение об авторизации выполняется в коде, но сведения о проверке подлинности по-прежнему предоставляются.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-179">**Allow request (no action)** defers the authorization decision to your code, but it still provides authentication information.</span></span> <span data-ttu-id="2f3f5-180">Если вы хотите выполнять всю обработку в коде, функцию проверки подлинности и авторизации компонента можно отключить.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-180">If you want to have your code handle everything, you can disable the Authentication / Authorization feature.</span></span>

## <a name="working-with-user-identities-in-your-application"></a><span data-ttu-id="2f3f5-181">Работа с удостоверениями пользователей в приложении</span><span class="sxs-lookup"><span data-stu-id="2f3f5-181">Working with user identities in your application</span></span>
<span data-ttu-id="2f3f5-182">Служба приложений передает некоторые сведения о пользователе в приложение с помощью специальных заголовков.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-182">App Service passes some user information to your application by using special headers.</span></span> <span data-ttu-id="2f3f5-183">Эти заголовки не могут использоваться во внешних запросах. Они могут присутствовать, только если были установлены службой приложений при проверке подлинности или авторизации.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-183">External requests prohibit these headers and will only be present if set by App Service Authentication / Authorization.</span></span> <span data-ttu-id="2f3f5-184">Некоторые примеры заголовков включают:</span><span class="sxs-lookup"><span data-stu-id="2f3f5-184">Some example headers include:</span></span>

* <span data-ttu-id="2f3f5-185">X-MS-CLIENT-PRINCIPAL-NAME</span><span class="sxs-lookup"><span data-stu-id="2f3f5-185">X-MS-CLIENT-PRINCIPAL-NAME</span></span>
* <span data-ttu-id="2f3f5-186">X-MS-CLIENT-PRINCIPAL-ID</span><span class="sxs-lookup"><span data-stu-id="2f3f5-186">X-MS-CLIENT-PRINCIPAL-ID</span></span>
* <span data-ttu-id="2f3f5-187">X-MS-TOKEN-FACEBOOK-ACCESS-TOKEN</span><span class="sxs-lookup"><span data-stu-id="2f3f5-187">X-MS-TOKEN-FACEBOOK-ACCESS-TOKEN</span></span>
* <span data-ttu-id="2f3f5-188">X-MS-TOKEN-FACEBOOK-EXPIRES-ON</span><span class="sxs-lookup"><span data-stu-id="2f3f5-188">X-MS-TOKEN-FACEBOOK-EXPIRES-ON</span></span>

<span data-ttu-id="2f3f5-189">Сведения из этих заголовков можно получить с помощью кода, написанного на любом языке или в любой платформе.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-189">Code that is written in any language or framework can get the information that it needs from these headers.</span></span> <span data-ttu-id="2f3f5-190">Для приложений ASP.NET 4.6 автоматически настраивается класс **ClaimsPrincipal** с соответствующими значениями.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-190">For ASP.NET 4.6 apps, the **ClaimsPrincipal** is automatically set with the appropriate values.</span></span>

<span data-ttu-id="2f3f5-191">Приложение может получить дополнительные сведения о пользователях, отправив запрос HTTP GET на конечную точку приложения `/.auth/me` .</span><span class="sxs-lookup"><span data-stu-id="2f3f5-191">Your application can also obtain additional user details through an HTTP GET on the `/.auth/me` endpoint of your application.</span></span> <span data-ttu-id="2f3f5-192">Если в запрос был включен допустимый маркер, будут возвращены полезные данные JSON со сведениями об используемом поставщике, маркером базового поставщика и другими данными пользователя.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-192">A valid token that's included with the request will return a JSON payload with details about the provider that's being used, the underlying provider token, and some other user information.</span></span> <span data-ttu-id="2f3f5-193">Пакеты SDK для серверной части мобильных приложений предоставляют вспомогательные методы для работы с этими данными  Дополнительные сведения см.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-193">The Mobile Apps server SDKs provide helper methods to work with this data.</span></span> <span data-ttu-id="2f3f5-194">Дополнительные сведения см. в разделах [Практическое руководство. Использование утверждений аутентификации для таблиц](../app-service-mobile/app-service-mobile-node-backend-how-to-use-server-sdk.md#howto-tables-getidentity) и [Практическое руководство. Получение сведений о пользователе, прошедшем проверку подлинности](../app-service-mobile/app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#user-info).</span><span class="sxs-lookup"><span data-stu-id="2f3f5-194">For more information, see [How to use the Azure Mobile Apps Node.js SDK](../app-service-mobile/app-service-mobile-node-backend-how-to-use-server-sdk.md#howto-tables-getidentity), and [Work with the .NET backend server SDK for Azure Mobile Apps](../app-service-mobile/app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#user-info).</span></span>

## <a name="documentation-and-additional-resources"></a><span data-ttu-id="2f3f5-195">Документация и дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="2f3f5-195">Documentation and additional resources</span></span>
### <a name="identity-providers"></a><span data-ttu-id="2f3f5-196">Поставщики удостоверений</span><span class="sxs-lookup"><span data-stu-id="2f3f5-196">Identity providers</span></span>
<span data-ttu-id="2f3f5-197">В следующих руководствах содержатся сведения о том, как настроить службу приложений для использования различных поставщиков проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-197">The following tutorials show how to configure App Service to use different authentication providers:</span></span>

* <span data-ttu-id="2f3f5-198">[Настройка приложения службы приложений для использования службы входа Azure Active Directory][AAD]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-198">[How to configure your app to use Azure Active Directory login][AAD]</span></span>
* <span data-ttu-id="2f3f5-199">[Как настроить приложение службы приложений для использования имени для входа Facebook][Facebook]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-199">[How to configure your app to use Facebook login][Facebook]</span></span>
* <span data-ttu-id="2f3f5-200">[Как настроить приложение службы приложений для использования имени для входа Google][Google]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-200">[How to configure your app to use Google login][Google]</span></span>
* <span data-ttu-id="2f3f5-201">[Настройка приложения службы приложений для использования входа по учетной записи Майкрософт][MSA]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-201">[How to configure your app to use Microsoft Account login][MSA]</span></span>
* <span data-ttu-id="2f3f5-202">[Как настроить приложение службы приложений для использования имени для входа Twitter][Twitter]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-202">[How to configure your app to use Twitter login][Twitter]</span></span>

<span data-ttu-id="2f3f5-203">Если вам нужна система удостоверений, отличная от указанных здесь, можете использовать [предварительную версию поддержки настраиваемой проверки подлинности в серверном пакете SDK .NET для мобильных приложений][custom-auth]. Ее можно использовать с веб-приложениями, мобильными приложениями или приложениями API.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-203">If you want to use an identity system other than the ones provided here, you can also use the [preview custom authentication support in the Mobile Apps .NET server SDK][custom-auth], which can be used in web apps, mobile apps, or API apps.</span></span>

### <a name="web-applications"></a><span data-ttu-id="2f3f5-204">Веб-приложения</span><span class="sxs-lookup"><span data-stu-id="2f3f5-204">Web applications</span></span>
<span data-ttu-id="2f3f5-205">В следующем руководстве содержатся сведения о том, как добавить проверку подлинности в веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-205">The following tutorials show how to add authentication to a web application:</span></span>

* <span data-ttu-id="2f3f5-206">[Начало работы со службой приложений Azure (часть 2)][web-getstarted]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-206">[Get started with Azure App Service - Part 2][web-getstarted]</span></span>

### <a name="mobile-applications"></a><span data-ttu-id="2f3f5-207">Мобильные приложения</span><span class="sxs-lookup"><span data-stu-id="2f3f5-207">Mobile applications</span></span>
<span data-ttu-id="2f3f5-208">В следующих руководствах показано, как добавить проверку подлинности в мобильные клиенты с использованием управляемого сервером потока.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-208">The following tutorials show how to add authentication to your mobile clients by using the server-directed flow:</span></span>

* <span data-ttu-id="2f3f5-209">[Добавление проверки подлинности в приложение iOS][iOS]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-209">[Add authentication to your iOS app][iOS]</span></span>
* <span data-ttu-id="2f3f5-210">[Добавление проверки подлинности в приложение Android][Android]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-210">[Add Authentication to your Android app][Android]</span></span>
* <span data-ttu-id="2f3f5-211">[Добавление проверки подлинности в приложение Windows][Windows]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-211">[Add Authentication to your Windows app][Windows]</span></span>
* <span data-ttu-id="2f3f5-212">[Добавление проверки подлинности в приложение Xamarin.Android][Xamarin.iOS]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-212">[Add authentication to your Xamarin.iOS app][Xamarin.iOS]</span></span>
* <span data-ttu-id="2f3f5-213">[Добавление проверки подлинности в приложение Xamarin.Android][Xamarin.Android]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-213">[Add authentication to your Xamarin.Android app][Xamarin.Android]</span></span>
* <span data-ttu-id="2f3f5-214">[Добавление проверки подлинности в приложение Xamarin.iOS][Xamarin.Forms]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-214">[Add authentication to your Xamarin.Forms app][Xamarin.Forms]</span></span>
* <span data-ttu-id="2f3f5-215">[Добавление проверки подлинности в приложение Cordova][Cordova]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-215">[Add Authentication to your Cordova app][Cordova]</span></span>

<span data-ttu-id="2f3f5-216">Если вы хотите использовать управляемый клиентом поток для Azure Active Directory, см. следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="2f3f5-216">Use the following resources if you want to use the client-directed flow for Azure Active Directory:</span></span>

* <span data-ttu-id="2f3f5-217">[Использование клиентской библиотеки iOS для мобильных приложений Azure][ADAL-iOS]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-217">[Use the Active Directory Authentication Library for iOS][ADAL-iOS]</span></span>
* <span data-ttu-id="2f3f5-218">[Использование клиентской библиотеки Android для мобильных приложений][ADAL-Android]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-218">[Use the Active Directory Authentication Library for Android][ADAL-Android]</span></span>
* <span data-ttu-id="2f3f5-219">[Использование управляемого клиента для мобильных приложений Azure][ADAL-dotnet]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-219">[Use the Active Directory Authentication Library for Windows and Xamarin][ADAL-dotnet]</span></span>

<span data-ttu-id="2f3f5-220">Если вы хотите использовать управляемый клиентом поток для Facebook, см. следующий раздел.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-220">Use the following resources if you want to use the client-directed flow for Facebook:</span></span>

* [<span data-ttu-id="2f3f5-221">Практическое руководство: проверка подлинности пользователей с помощью пакета SDK Facebook для iOS</span><span class="sxs-lookup"><span data-stu-id="2f3f5-221">Use the Facebook SDK for iOS</span></span>](../app-service-mobile/app-service-mobile-ios-how-to-use-client-library.md#facebook-sdk)

<span data-ttu-id="2f3f5-222">Если вы хотите использовать управляемый клиентом поток для Twitter, см. следующий раздел.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-222">Use the following resources if you want to use the client-directed flow for Twitter:</span></span>

* [<span data-ttu-id="2f3f5-223">Практическое руководство: проверка подлинности пользователей с помощью структуры Twitter для iOS</span><span class="sxs-lookup"><span data-stu-id="2f3f5-223">Use Twitter Fabric for iOS</span></span>](../app-service-mobile/app-service-mobile-ios-how-to-use-client-library.md#twitter-fabric)

<span data-ttu-id="2f3f5-224">Если вы хотите использовать управляемый клиентом поток для Google, см. следующий раздел.</span><span class="sxs-lookup"><span data-stu-id="2f3f5-224">Use the following resources if you want to use the client-directed flow for Google:</span></span>

* [<span data-ttu-id="2f3f5-225">How to: Authenticate users with the Google Sign-In SDK for iOS</span><span class="sxs-lookup"><span data-stu-id="2f3f5-225">Use the Google Sign-In SDK for iOS</span></span>](../app-service-mobile/app-service-mobile-ios-how-to-use-client-library.md#google-sdk)

### <a name="api-applications"></a><span data-ttu-id="2f3f5-226">Приложения API</span><span class="sxs-lookup"><span data-stu-id="2f3f5-226">API applications</span></span>
<span data-ttu-id="2f3f5-227">Защита приложений API описана в следующих учебниках:</span><span class="sxs-lookup"><span data-stu-id="2f3f5-227">The following tutorials show how to protect your API apps:</span></span>

* <span data-ttu-id="2f3f5-228">[Проверка подлинности пользователя для приложений API в службе приложений Azure][apia-user]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-228">[User authentication for API Apps in Azure App Service][apia-user]</span></span>
* <span data-ttu-id="2f3f5-229">[Проверка подлинности с использованием субъекта-службы для приложений API в службе приложений Azure][apia-service]</span><span class="sxs-lookup"><span data-stu-id="2f3f5-229">[Service principal authentication for API Apps in Azure App Service][apia-service]</span></span>

[apia-user]: ../app-service-api/app-service-api-dotnet-user-principal-auth.md
[apia-service]: ../app-service-api/app-service-api-dotnet-service-principal-auth.md

[web-getstarted]: ../app-service-web/app-service-web-get-started-2.md#authenticate-your-users

[iOS]: ../app-service-mobile/app-service-mobile-ios-get-started-users.md
<span data-ttu-id="2f3f5-230">[Android]: ../app-service-mobile/app-service-mobile-android-get-started-users.md</span><span class="sxs-lookup"><span data-stu-id="2f3f5-230">[Android]: ../app-service-mobile/app-service-mobile-android-get-started-users.md</span></span>
<span data-ttu-id="2f3f5-231">[Xamarin.iOS]: ../app-service-mobile/app-service-mobile-xamarin-ios-get-started-users.md</span><span class="sxs-lookup"><span data-stu-id="2f3f5-231">[Xamarin.iOS]: ../app-service-mobile/app-service-mobile-xamarin-ios-get-started-users.md</span></span>
<span data-ttu-id="2f3f5-232">[Xamarin.Android]: ../app-service-mobile/app-service-mobile-xamarin-android-get-started-users.md</span><span class="sxs-lookup"><span data-stu-id="2f3f5-232">[Xamarin.Android]: ../app-service-mobile/app-service-mobile-xamarin-android-get-started-users.md</span></span>
<span data-ttu-id="2f3f5-233">[Xamarin.Forms]: ../app-service-mobile/app-service-mobile-xamarin-forms-get-started-users.md</span><span class="sxs-lookup"><span data-stu-id="2f3f5-233">[Xamarin.Forms]: ../app-service-mobile/app-service-mobile-xamarin-forms-get-started-users.md</span></span>
<span data-ttu-id="2f3f5-234">[Windows]: ../app-service-mobile/app-service-mobile-windows-store-dotnet-get-started-users.md</span><span class="sxs-lookup"><span data-stu-id="2f3f5-234">[Windows]: ../app-service-mobile/app-service-mobile-windows-store-dotnet-get-started-users.md</span></span>
<span data-ttu-id="2f3f5-235">[Cordova]: ../app-service-mobile/app-service-mobile-cordova-get-started-users.md</span><span class="sxs-lookup"><span data-stu-id="2f3f5-235">[Cordova]: ../app-service-mobile/app-service-mobile-cordova-get-started-users.md</span></span>

[AAD]: ../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md
[Facebook]: ../app-service-mobile/app-service-mobile-how-to-configure-facebook-authentication.md
[Google]: ../app-service-mobile/app-service-mobile-how-to-configure-google-authentication.md
[MSA]: ../app-service-mobile/app-service-mobile-how-to-configure-microsoft-authentication.md
[Twitter]: ../app-service-mobile/app-service-mobile-how-to-configure-twitter-authentication.md

[custom-auth]: ../app-service-mobile/app-service-mobile-dotnet-backend-how-to-use-server-sdk.md#custom-auth

[ADAL-Android]: ../app-service-mobile/app-service-mobile-android-how-to-use-client-library.md#adal
[ADAL-iOS]: ../app-service-mobile/app-service-mobile-ios-how-to-use-client-library.md#adal
[ADAL-dotnet]: ../app-service-mobile/app-service-mobile-dotnet-how-to-use-client-library.md#adal
