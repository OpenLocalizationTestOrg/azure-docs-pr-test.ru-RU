---
title: "Гибридные подключения к службе приложений Azure | Документация Майкрософт"
description: "Создание и использование гибридных подключений для доступа к ресурсам в разнородных сетях."
services: app-service
documentationcenter: 
author: ccompy
manager: stefsch
editor: 
ms.assetid: 66774bde-13f5-45d0-9a70-4e9536a4f619
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/22/2017
ms.author: ccompy
ms.openlocfilehash: fef9e7b280387934cb093f51b4c8aa134a3b87e7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="azure-app-service-hybrid-connections"></a><span data-ttu-id="50af9-103">Гибридные подключения к службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="50af9-103">Azure App Service Hybrid Connections</span></span> #

## <a name="overview"></a><span data-ttu-id="50af9-104">Обзор</span><span class="sxs-lookup"><span data-stu-id="50af9-104">Overview</span></span> ##

<span data-ttu-id="50af9-105">Гибридные подключения — это и служба в Azure, и функция в службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="50af9-105">Hybrid Connections is both a service in Azure as well as a feature in the Azure App Service.</span></span>  <span data-ttu-id="50af9-106">В качестве службы их применение и возможности шире, чем функциональные возможности, используемые в службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="50af9-106">As a service it has use and capabilities beyond those that are leveraged in the Azure App Service.</span></span>  <span data-ttu-id="50af9-107">Чтобы узнать больше о гибридных подключениях и их использовании вне службы приложения Azure, можно начать с раздела [Протокол гибридных подключений ретранслятора Azure][HCService].</span><span class="sxs-lookup"><span data-stu-id="50af9-107">To learn more about Hybrid Connections and their usage outside of the Azure App Service you can start here, [Azure Relay Hybrid Connections][HCService]</span></span>

<span data-ttu-id="50af9-108">В службе приложений Azure гибридные подключения можно использовать для доступа к ресурсам приложений в других сетях.</span><span class="sxs-lookup"><span data-stu-id="50af9-108">Within the Azure App Service, hybrid connections can be used to access application resources in other networks.</span></span> <span data-ttu-id="50af9-109">Они обеспечивают доступ из вашего приложения к конечной точке приложения.</span><span class="sxs-lookup"><span data-stu-id="50af9-109">It provides access FROM your app TO an application endpoint.</span></span>  <span data-ttu-id="50af9-110">Гибридные подключения не являются альтернативным средством доступа к вашему приложению.</span><span class="sxs-lookup"><span data-stu-id="50af9-110">It does not enable an alternative capability to access your application.</span></span>  <span data-ttu-id="50af9-111">При использовании в службе приложений каждое гибридное подключение сопоставляется с одной комбинацией узла TCP и TCP-порта.</span><span class="sxs-lookup"><span data-stu-id="50af9-111">As used in the App Service, each hybrid connection correlates to a single TCP host and port combination.</span></span>  <span data-ttu-id="50af9-112">Это означает, что конечная точка гибридного подключения может быть размещена в любой операционной системе, а любое ваше приложение использует TCP-порт прослушивания.</span><span class="sxs-lookup"><span data-stu-id="50af9-112">This means that the hybrid connection endpoint can be on any operating system and any application provided you are hitting a TCP listening port.</span></span> <span data-ttu-id="50af9-113">Гибридным подключениям не важен используемый протокол приложения или ресурсы, к которым вы обращаетесь.</span><span class="sxs-lookup"><span data-stu-id="50af9-113">Hybrid connections does not know or care what the application protocol is or what you are accessing.</span></span>  <span data-ttu-id="50af9-114">Они просто обеспечивают доступ к сети.</span><span class="sxs-lookup"><span data-stu-id="50af9-114">It is simply providing network access.</span></span>  


## <a name="how-it-works"></a><span data-ttu-id="50af9-115">Принцип работы</span><span class="sxs-lookup"><span data-stu-id="50af9-115">How it works</span></span> ##
<span data-ttu-id="50af9-116">Функция гибридных подключений использует два исходящих вызова к ретранслятору служебной шины.</span><span class="sxs-lookup"><span data-stu-id="50af9-116">The hybrid connections feature consists of two outbound calls to Service Bus Relay.</span></span>  <span data-ttu-id="50af9-117">К узлу, на котором приложение выполняется в службе приложений, устанавливается подключение из библиотеки, после чего устанавливается подключение из Hybrid Connection Manager (HCM) к ретранслятору служебной шины.</span><span class="sxs-lookup"><span data-stu-id="50af9-117">There is a connection from a library on the host where your app is running in the app service and then there is a connection from the Hybrid Connection Manager(HCM) to Service Bus relay.</span></span>  <span data-ttu-id="50af9-118">HCM — это служба ретрансляции, которая развертывается в сетевом размещении.</span><span class="sxs-lookup"><span data-stu-id="50af9-118">The HCM is a relay service that you deploy within the network hosting</span></span> 

<span data-ttu-id="50af9-119">Посредством двух соединенных подключений приложение получает TCP-туннель к фиксированной комбинации "узел:порт" на другой стороне HCM.</span><span class="sxs-lookup"><span data-stu-id="50af9-119">Through the two joined connections your app has a TCP tunnel to a fixed host:port combination on the other side of the HCM.</span></span>  <span data-ttu-id="50af9-120">Это подключение использует TLS 1.2 для обеспечения безопасности и ключи SAS для аутентификации и авторизации.</span><span class="sxs-lookup"><span data-stu-id="50af9-120">The connection uses TLS 1.2 for security and SAS keys for authentication/authorization.</span></span>    

![][1]

<span data-ttu-id="50af9-121">Когда приложение выполнит запрос DNS, который соответствует настроенной конечной точке гибридного подключения, исходящий трафик TCP будет перенаправлен дальше по этому гибридному подключению.</span><span class="sxs-lookup"><span data-stu-id="50af9-121">When your app makes a DNS request that matches a configure Hybrid Connection endpoint, then the outbound TCP traffic will be redirected down the hybrid connection.</span></span>  

> [!NOTE]
> <span data-ttu-id="50af9-122">Это означает, что для гибридного подключения следует всегда использовать DNS-имя.</span><span class="sxs-lookup"><span data-stu-id="50af9-122">This means that you should try to always use a DNS name for your Hybrid Connection.</span></span>  <span data-ttu-id="50af9-123">Некоторые клиентские программы не выполняют поиск DNS, если конечная точка использует IP-адрес, а не DNS-имя.</span><span class="sxs-lookup"><span data-stu-id="50af9-123">Some client software does not do a DNS lookup if the endpoint uses an IP address instead.</span></span>
>
>

<span data-ttu-id="50af9-124">Существуют два типа гибридных подключений: новые гибридные подключения, которые предоставляются как служба в ретрансляторе Azure, и устаревшие гибридные подключения BizTalk.</span><span class="sxs-lookup"><span data-stu-id="50af9-124">There are two types of hybrid connections, the new hybrid connections that are offered as a service under Azure Relay and the older BizTalk Hybrid Connections.</span></span>  <span data-ttu-id="50af9-125">Устаревшие гибридные подключения BizTalk на портале называются классическими гибридными подключениями.</span><span class="sxs-lookup"><span data-stu-id="50af9-125">The older BizTalk Hybrid Connections are referred to as Classic Hybrid Connections in the portal.</span></span>  <span data-ttu-id="50af9-126">Дополнительная информация о них приведена далее в этом документе.</span><span class="sxs-lookup"><span data-stu-id="50af9-126">There is more information later in this document about them.</span></span>

### <a name="app-service-hybrid-connection-benefits"></a><span data-ttu-id="50af9-127">Преимущества гибридного подключения службы приложений</span><span class="sxs-lookup"><span data-stu-id="50af9-127">App Service hybrid connection benefits</span></span> ###

<span data-ttu-id="50af9-128">Гибридные подключения обладают рядом преимуществ, включая следующие:</span><span class="sxs-lookup"><span data-stu-id="50af9-128">There are a number of benefits to the hybrid connections capability including</span></span>

- <span data-ttu-id="50af9-129">Приложения могут безопасно обращаться к локальным службам и системам.</span><span class="sxs-lookup"><span data-stu-id="50af9-129">Apps can securely access on premises systems and services securely</span></span>
- <span data-ttu-id="50af9-130">Для них не требуется конечная точка с доступом к Интернету.</span><span class="sxs-lookup"><span data-stu-id="50af9-130">the feature does not require an internet accessible endpoint</span></span>
- <span data-ttu-id="50af9-131">Их можно быстро и легко настроить.</span><span class="sxs-lookup"><span data-stu-id="50af9-131">it is quick and easy to set up</span></span>  
- <span data-ttu-id="50af9-132">Каждое гибридное подключение соответствует отдельной комбинации "узел:порт", что прекрасно с точки зрения безопасности.</span><span class="sxs-lookup"><span data-stu-id="50af9-132">each hybrid connection matches to a single host:port combination which is an excellent security aspect</span></span>
- <span data-ttu-id="50af9-133">Как правило, бреши в брандмауэре не нужны, так как все подключения являются исходящими и осуществляются через стандартные веб-порты.</span><span class="sxs-lookup"><span data-stu-id="50af9-133">it normally does not require firewall holes as the connections are all outbound over standard web ports</span></span>
- <span data-ttu-id="50af9-134">Так как гибридные подключения работают на уровне сети, это также означает, что они не зависят ни от языка, используемого приложением, ни от технологии, используемой конечной точкой.</span><span class="sxs-lookup"><span data-stu-id="50af9-134">because the feature is network level that also means that it is agnostic to the language used by your app and the technology used by the endpoint</span></span>
- <span data-ttu-id="50af9-135">Их можно использовать для доступа к нескольким сетям из одного приложения.</span><span class="sxs-lookup"><span data-stu-id="50af9-135">it can be used to provide access in multiple networks from a single app</span></span> 

### <a name="things-you-cannot-do-with-hybrid-connections"></a><span data-ttu-id="50af9-136">Что невозможно сделать с помощью гибридных подключений</span><span class="sxs-lookup"><span data-stu-id="50af9-136">Things you cannot do with Hybrid Connections</span></span> ###

<span data-ttu-id="50af9-137">Существует несколько вещей, которые невозможно выполнить с помощью гибридных подключений, в том числе:</span><span class="sxs-lookup"><span data-stu-id="50af9-137">There are a few things you cannot do with hybrid connections and they include:</span></span>

- <span data-ttu-id="50af9-138">подключение диска;</span><span class="sxs-lookup"><span data-stu-id="50af9-138">mounting a drive</span></span>
- <span data-ttu-id="50af9-139">использование протокола UDP;</span><span class="sxs-lookup"><span data-stu-id="50af9-139">using UDP</span></span>
- <span data-ttu-id="50af9-140">доступ к службам на основе протокола TCP, использующим динамические порты (таким как пассивным режим FTP или расширенный пассивный режим FTP);</span><span class="sxs-lookup"><span data-stu-id="50af9-140">accessing TCP based services that use dynamic ports such as FTP Passive Mode or Extended Passive Mode</span></span>
- <span data-ttu-id="50af9-141">поддержка LDAP, так как иногда для нее требуется UDP;</span><span class="sxs-lookup"><span data-stu-id="50af9-141">LDAP support, as it sometimes requires UDP</span></span>
- <span data-ttu-id="50af9-142">поддержка Active Directory.</span><span class="sxs-lookup"><span data-stu-id="50af9-142">Active Directory support</span></span>

## <a name="adding-and-creating-a-hybrid-connection-in-your-app"></a><span data-ttu-id="50af9-143">Добавление и создание гибридного подключения в приложении</span><span class="sxs-lookup"><span data-stu-id="50af9-143">Adding and Creating a Hybrid Connection in your App</span></span> ##

<span data-ttu-id="50af9-144">Гибридные подключения можно создавать на портале приложения или на портале службы гибридных подключений.</span><span class="sxs-lookup"><span data-stu-id="50af9-144">Hybrid Connections can be created through the app portal or from the Hybrid Connection service portal.</span></span>  <span data-ttu-id="50af9-145">Настоятельно рекомендуется использовать портал приложения для создания гибридных подключений, которые вы хотите использовать в своем приложении.</span><span class="sxs-lookup"><span data-stu-id="50af9-145">It is highly recommended that you use the app portal to create the Hybrid Connections you wish to use with your app.</span></span>  <span data-ttu-id="50af9-146">Чтобы создать гибридное подключение, перейдите на [портал Azure][portal] и откройте пользовательский интерфейс своего приложения.</span><span class="sxs-lookup"><span data-stu-id="50af9-146">To create a Hybrid Connection go to the [Azure portal][portal] and go into the UI for your app.</span></span>  <span data-ttu-id="50af9-147">Выберите **Сети > Настройте конечные точки гибридного подключения**.</span><span class="sxs-lookup"><span data-stu-id="50af9-147">Select **Networking > Configure your hybrid connection endpoints**.</span></span>  <span data-ttu-id="50af9-148">Здесь можно увидеть гибридные подключения, которые были настроены для приложения.</span><span class="sxs-lookup"><span data-stu-id="50af9-148">From here you can see the Hybrid Connections that are configured with your app</span></span>  

![][2]

<span data-ttu-id="50af9-149">Чтобы добавить новое гибридное подключение, нажмите кнопку "Добавить гибридное подключение".</span><span class="sxs-lookup"><span data-stu-id="50af9-149">To add a new Hybrid Connection, click Add Hybrid Connection.</span></span>  <span data-ttu-id="50af9-150">В открывшемся окне пользовательского интерфейса отобразится список гибридных подключений, которые вы уже создали.</span><span class="sxs-lookup"><span data-stu-id="50af9-150">The UI that opens up lists the Hybrid Connections that you have already created.</span></span>  <span data-ttu-id="50af9-151">Чтобы добавить одно или несколько из них в приложение, выберите соответствующие подключения, затем щелкните **Добавление выбранного гибридного подключения**.</span><span class="sxs-lookup"><span data-stu-id="50af9-151">To add one or more of them to your app, click on the ones you want and hit **Add selected hybrid connection**.</span></span>  

![][3]

<span data-ttu-id="50af9-152">Если вы хотите создать гибридное подключение, щелкните **Создать гибридное подключение**.</span><span class="sxs-lookup"><span data-stu-id="50af9-152">If you want to create a new Hybrid Connection, click **Create new hybrid connection**.</span></span>  <span data-ttu-id="50af9-153">Теперь следует указать:</span><span class="sxs-lookup"><span data-stu-id="50af9-153">From here you specify the:</span></span> 

- <span data-ttu-id="50af9-154">имя конечной точки;</span><span class="sxs-lookup"><span data-stu-id="50af9-154">endpoint name</span></span>
- <span data-ttu-id="50af9-155">имя узла конечной точки;</span><span class="sxs-lookup"><span data-stu-id="50af9-155">endpoint hostname</span></span>
- <span data-ttu-id="50af9-156">порт конечной точки;</span><span class="sxs-lookup"><span data-stu-id="50af9-156">endpoint port</span></span>
- <span data-ttu-id="50af9-157">пространство имен служебной шины, которое вы хотите использовать.</span><span class="sxs-lookup"><span data-stu-id="50af9-157">servicebus namespace you wish to use</span></span>

![][4]

<span data-ttu-id="50af9-158">Каждое гибридное подключение привязано к пространству имен служебной шины, а каждое пространство имен служебной шины находится в регионе Azure.</span><span class="sxs-lookup"><span data-stu-id="50af9-158">Every hybrid connection is tied to a service bus namespace and each service bus namespace is in an Azure region.</span></span>  <span data-ttu-id="50af9-159">Важно стараться использовать пространство имен служебной шины в том же регионе, в котором размещено ваше приложение, чтобы избежать сетевых задержек.</span><span class="sxs-lookup"><span data-stu-id="50af9-159">It is important to try and use a service bus namespace in the same region as your app so as to avoid network induced latency.</span></span>

<span data-ttu-id="50af9-160">Если вы хотите удалить из приложения гибридное подключение, щелкните его правой кнопкой мыши и выберите **Отключить**.</span><span class="sxs-lookup"><span data-stu-id="50af9-160">If you want to remove your hybrid connection from your app, right click on it and select **Disconnect**.</span></span>  

<span data-ttu-id="50af9-161">После добавления гибридного подключения в веб-приложение вы сможете просмотреть сведения о нем, просто щелкнув это подключение.</span><span class="sxs-lookup"><span data-stu-id="50af9-161">Once a hybrid connection is added to your web app, you can see details on it by simply clicking on it.</span></span>  

![][5]

## <a name="hybrid-connections-and-app-service-plans"></a><span data-ttu-id="50af9-162">Гибридные подключения и планы службы приложений</span><span class="sxs-lookup"><span data-stu-id="50af9-162">Hybrid Connections and App Service Plans</span></span> ##

<span data-ttu-id="50af9-163">В настоящее время можно устанавливать только новые гибридные подключения.</span><span class="sxs-lookup"><span data-stu-id="50af9-163">The only hybrid connections you can now make are the new hybrid connections.</span></span>  <span data-ttu-id="50af9-164">Они доступны только для SKU "Базовый", "Стандартный", "Премиум" и Isolated.</span><span class="sxs-lookup"><span data-stu-id="50af9-164">They are only available in Basic, Standard, Premium and Isolated pricing SKUs.</span></span>  <span data-ttu-id="50af9-165">С каждым тарифным планом связаны определенные ограничения.</span><span class="sxs-lookup"><span data-stu-id="50af9-165">There are limits tied to the pricing plan.</span></span>  

| <span data-ttu-id="50af9-166">Тарифный план</span><span class="sxs-lookup"><span data-stu-id="50af9-166">Pricing Plan</span></span> | <span data-ttu-id="50af9-167">Количество гибридных подключений в плане</span><span class="sxs-lookup"><span data-stu-id="50af9-167">Number of hybrid connections usable in the plan</span></span> |
|----|----|
| <span data-ttu-id="50af9-168">базовая;</span><span class="sxs-lookup"><span data-stu-id="50af9-168">Basic</span></span> | <span data-ttu-id="50af9-169">5</span><span class="sxs-lookup"><span data-stu-id="50af9-169">5</span></span> |
| <span data-ttu-id="50af9-170">Стандартная</span><span class="sxs-lookup"><span data-stu-id="50af9-170">Standard</span></span> | <span data-ttu-id="50af9-171">25</span><span class="sxs-lookup"><span data-stu-id="50af9-171">25</span></span> |
| <span data-ttu-id="50af9-172">Premium</span><span class="sxs-lookup"><span data-stu-id="50af9-172">Premium</span></span> | <span data-ttu-id="50af9-173">200</span><span class="sxs-lookup"><span data-stu-id="50af9-173">200</span></span> |
| <span data-ttu-id="50af9-174">Isolated</span><span class="sxs-lookup"><span data-stu-id="50af9-174">Isolated</span></span> | <span data-ttu-id="50af9-175">200</span><span class="sxs-lookup"><span data-stu-id="50af9-175">200</span></span> |

<span data-ttu-id="50af9-176">Так как существуют ограничения плана службы приложений, в нем доступен пользовательский интерфейс, который показывает, сколько гибридных подключений используется и какими приложениями.</span><span class="sxs-lookup"><span data-stu-id="50af9-176">Since there are App Service Plan restrictions there is also UI in the App Service Plan that shows you how many hybrid connections are being used and by what apps.</span></span>  

![][6]

<span data-ttu-id="50af9-177">Как и в представлении приложения, просмотреть сведения о гибридном подключении можно, щелкнув его.</span><span class="sxs-lookup"><span data-stu-id="50af9-177">Just as with the app view, you can see details on your hybrid connection by clicking on it.</span></span>  <span data-ttu-id="50af9-178">Среди отображенных свойств можно увидеть все сведения, показанные в представлении приложения, но также можно узнать, сколько других приложений в этом же плане службы приложений использует это гибридное подключение.</span><span class="sxs-lookup"><span data-stu-id="50af9-178">In the properties shown here you can see all the information you had at the app view but can also see how many other apps in the same App Service Plan are using that hybrid connection.</span></span>

![][7]

<span data-ttu-id="50af9-179">Так как существует ограничение на количество конечных точек гибридных подключений, которые можно использовать в плане службы приложений, каждое гибридное подключение может использоваться любым количеством приложений в этом плане службе приложений.</span><span class="sxs-lookup"><span data-stu-id="50af9-179">While there is a limit on the number of hybrid connection endpoints that can be used in an App Service Plan, each hybrid connection used can be used across any number of apps in that App Service Plan.</span></span>  <span data-ttu-id="50af9-180">Иными словами, если имеется 1 гибридное подключение, используемое в 5 отдельных приложениях в плане службы приложений, это все равно 1 гибридное подключение.</span><span class="sxs-lookup"><span data-stu-id="50af9-180">That is to say that if I had 1 hybrid connection that I used in 5 separate apps in my App Service Plan, that is still just 1 hybrid connection.</span></span>

<span data-ttu-id="50af9-181">За гибридные подключения сверх лимита, определенного для уровней "Базовый", "Стандартный", "Премиум" и Isolated, взимается дополнительная плата.</span><span class="sxs-lookup"><span data-stu-id="50af9-181">There is an additional cost to hybrid connections beyond being only usable in a Basic, Standard, Premium or Isolated SKU.</span></span>  <span data-ttu-id="50af9-182">Дополнительные сведения о ценах на гибридные подключения см. здесь: [Служебная шина — цены][sbpricing].</span><span class="sxs-lookup"><span data-stu-id="50af9-182">For details on hybrid connection pricing please go here: [Service Bus pricing][sbpricing].</span></span>

## <a name="hybrid-connection-manager"></a><span data-ttu-id="50af9-183">Hybrid Connection Manager</span><span class="sxs-lookup"><span data-stu-id="50af9-183">Hybrid Connection Manager</span></span> ##

<span data-ttu-id="50af9-184">Для работы гибридных подключений в сети, в которой размещена конечная точка гибридного подключения, необходим агент ретрансляции.</span><span class="sxs-lookup"><span data-stu-id="50af9-184">In order for hybrid connections to work you need a relay agent in the network that hosts your hybrid connection endpoint.</span></span>  <span data-ttu-id="50af9-185">Он называется Hybrid Connection Manager (HCM).</span><span class="sxs-lookup"><span data-stu-id="50af9-185">That relay agent is called the Hybrid Connection Manager (HCM).</span></span>  <span data-ttu-id="50af9-186">Этот инструмент можно скачать, выбрав **Сети > Настройте конечные точки гибридного подключения** в пользовательском интерфейсе, доступном в приложении на [портале Azure][portal].</span><span class="sxs-lookup"><span data-stu-id="50af9-186">This tool can be downloaded from the **Networking > Configure your hybrid connection endpoints** UI available from your app in the [Azure portal][portal].</span></span>  

<span data-ttu-id="50af9-187">Данный инструмент работает в Windows Server 2008 R2 и более поздних версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="50af9-187">This tool runs on Windows server 2008 R2 and later versions of Windows.</span></span>  <span data-ttu-id="50af9-188">После установки HCM запускается как служба.</span><span class="sxs-lookup"><span data-stu-id="50af9-188">Once installed the HCM runs as a service.</span></span>  <span data-ttu-id="50af9-189">Эта служба подключается к ретранслятору служебной шины Azure в соответствии с настроенными конечными точками.</span><span class="sxs-lookup"><span data-stu-id="50af9-189">This service connects to Azure servicebus relay based on the configured endpoints.</span></span>  <span data-ttu-id="50af9-190">HCM устанавливает исходящие подключения через порты 80 и 443.</span><span class="sxs-lookup"><span data-stu-id="50af9-190">The connections from the HCM are outbound to ports 80 and 443.</span></span>    

<span data-ttu-id="50af9-191">В HCM доступен пользовательский интерфейс для его настройки.</span><span class="sxs-lookup"><span data-stu-id="50af9-191">The HCM has a UI to configure it.</span></span>  <span data-ttu-id="50af9-192">После установки HCM можно вызвать его пользовательский интерфейс, запустив файл HybridConnectionManagerUi.exe, находящийся в каталоге установки Hybrid Connection Manager.</span><span class="sxs-lookup"><span data-stu-id="50af9-192">After the HCM is installed you can bring up the UI by running the HybridConnectionManagerUi.exe that sits in the Hybrid Connection Manager installation directory.</span></span>  <span data-ttu-id="50af9-193">Кроме того, его легко вызвать в Windows 10, введя в поле поиска *Hybrid Connection Manager UI*.</span><span class="sxs-lookup"><span data-stu-id="50af9-193">It is also easily reached on Windows 10 by typing *Hybrid Connection Manager UI* in your search box.</span></span>  

<span data-ttu-id="50af9-194">При запуске пользовательского интерфейса HCM первым, что вы увидите, будет таблица со списком всех гибридных подключений, настроенных с помощью этого экземпляра HCM.</span><span class="sxs-lookup"><span data-stu-id="50af9-194">When the HCM UI is started, the first thing you see is a table that lists all of the hybrid connections that are configured with this instance of the HCM.</span></span>  <span data-ttu-id="50af9-195">Если вы хотите внести какие-либо изменения, потребуется пройти аутентификацию в Azure.</span><span class="sxs-lookup"><span data-stu-id="50af9-195">If you wish to make any changes you will need to authenticate with Azure.</span></span> 

<span data-ttu-id="50af9-196">Вот как можно добавить одно или несколько гибридных подключений в HCM.</span><span class="sxs-lookup"><span data-stu-id="50af9-196">To add one or more Hybrid Connections to your HCM:</span></span>

1. <span data-ttu-id="50af9-197">Запустите пользовательский интерфейс HCM.</span><span class="sxs-lookup"><span data-stu-id="50af9-197">Start the HCM UI</span></span>
1. <span data-ttu-id="50af9-198">Щелкните "Configure another hybrid connection" (Настроить новое гибридное подключение). ![][8]</span><span class="sxs-lookup"><span data-stu-id="50af9-198">Click Configure another hybrid connection ![][8]</span></span>

1. <span data-ttu-id="50af9-199">Войдите в систему, используя учетную запись Azure.</span><span class="sxs-lookup"><span data-stu-id="50af9-199">Sign in with your Azure account</span></span>
1. <span data-ttu-id="50af9-200">Выберите подписку.</span><span class="sxs-lookup"><span data-stu-id="50af9-200">Choose a subscription</span></span>
1. <span data-ttu-id="50af9-201">Щелкните гибридные подключения, которые этот HCM должен транслировать. ![][9]</span><span class="sxs-lookup"><span data-stu-id="50af9-201">Click on the hybrid connections you want this HCM to relay ![][9]</span></span>

1. <span data-ttu-id="50af9-202">Щелкните Сохранить</span><span class="sxs-lookup"><span data-stu-id="50af9-202">Click Save</span></span>

<span data-ttu-id="50af9-203">На этом этапе вы увидите добавленные гибридные подключения.</span><span class="sxs-lookup"><span data-stu-id="50af9-203">At this point you will see the hybrid connections you added.</span></span>  <span data-ttu-id="50af9-204">Можно щелкнуть настроенное гибридное подключение и просмотреть сведения о нем.</span><span class="sxs-lookup"><span data-stu-id="50af9-204">You can also click on the configured hybrid connection and see details about the connection.</span></span>

![][10]

<span data-ttu-id="50af9-205">Чтобы HCM мог обслуживать настроенные для него гибридные подключения, ему требуется:</span><span class="sxs-lookup"><span data-stu-id="50af9-205">For your HCM to be able to support the hybrid connections it is configured with, it needs:</span></span>

- <span data-ttu-id="50af9-206">доступ к Azure по протоколу TCP через порты 80 и 443;</span><span class="sxs-lookup"><span data-stu-id="50af9-206">TCP access to Azure over ports 80 and 443</span></span>
- <span data-ttu-id="50af9-207">доступ к конечной точке гибридного подключения по протоколу TCP;</span><span class="sxs-lookup"><span data-stu-id="50af9-207">TCP access to the hybrid connection endpoint</span></span>
- <span data-ttu-id="50af9-208">возможность поиска DNS на узле конечной точки и в пространстве имен служебной шины Azure.</span><span class="sxs-lookup"><span data-stu-id="50af9-208">ability to do DNS look ups on the endpoint host and the azure servicebus namespace</span></span>

<span data-ttu-id="50af9-209">HCM поддерживает новые гибридные подключения и устаревшие гибридные подключения BizTalk.</span><span class="sxs-lookup"><span data-stu-id="50af9-209">The HCM supports both new hybrid connections as well as the older BizTalk hybrid connections.</span></span>

### <a name="redundancy"></a><span data-ttu-id="50af9-210">Избыточность</span><span class="sxs-lookup"><span data-stu-id="50af9-210">Redundancy</span></span> ###

<span data-ttu-id="50af9-211">Каждый экземпляр HCM может поддерживать несколько гибридных подключений.</span><span class="sxs-lookup"><span data-stu-id="50af9-211">Each HCM can support multiple hybrid connections.</span></span>  <span data-ttu-id="50af9-212">Кроме того, любое заданное гибридное подключение может поддерживаться несколькими HCM.</span><span class="sxs-lookup"><span data-stu-id="50af9-212">Also, any given hybrid connection can be supported by multiple HCMs.</span></span>  <span data-ttu-id="50af9-213">Режим по умолчанию — распределение трафика методом циклического перебора между настроенными экземплярами HCM для любой заданной конечной точки.</span><span class="sxs-lookup"><span data-stu-id="50af9-213">The default behavior is to round robin traffic across the configured HCMs for any given endpoint.</span></span>  <span data-ttu-id="50af9-214">Если требуется обеспечить высокий уровень доступности гибридных подключений из сети, просто создайте несколько экземпляров HCM на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="50af9-214">If you want high availability on your hybrid connections from your network, simply instantiate multiple HCMs on separate machines.</span></span> 

### <a name="manually-adding-a-hybrid-connection"></a><span data-ttu-id="50af9-215">Добавление гибридного подключения вручную</span><span class="sxs-lookup"><span data-stu-id="50af9-215">Manually adding a hybrid connection</span></span> ###

<span data-ttu-id="50af9-216">Если необходимо, чтобы кто-то вне вашей подписки разместил экземпляр HCM для заданного гибридного подключения, для этого можно предоставить строку подключения к шлюзу для этого гибридного подключения.</span><span class="sxs-lookup"><span data-stu-id="50af9-216">If you wish somebody outside of your subscription to host an HCM instance for a given hybrid connection, you can share with them the gateway connection string for the hybrid connection.</span></span>  <span data-ttu-id="50af9-217">Ее можно найти в свойствах гибридного подключения на [портале Azure][portal].</span><span class="sxs-lookup"><span data-stu-id="50af9-217">You can see this in the properties for a hybrid connection in the [Azure portal][portal].</span></span> <span data-ttu-id="50af9-218">Чтобы использовать эту строку, нажмите кнопку **Configure manually** (Настроить вручную) в HCM и вставьте строку подключения к шлюзу.</span><span class="sxs-lookup"><span data-stu-id="50af9-218">To use that string, click the **Configure manually** button in the HCM and paste in the gateway connection string.</span></span>


## <a name="troubleshooting"></a><span data-ttu-id="50af9-219">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="50af9-219">Troubleshooting</span></span> ##

<span data-ttu-id="50af9-220">Когда для гибридного подключения настроено запущенное приложение и имеется по крайней мере один HCM, в котором настроено это гибридное подключение, то на портале отображается состояние **Подключено**.</span><span class="sxs-lookup"><span data-stu-id="50af9-220">When your hybrid connection is set up with a running application and there is at least one HCM that has that hybrid connection configured, then the status will say **Connected** in the portal.</span></span>  <span data-ttu-id="50af9-221">Если состояние **Подключено** не отображается, значит, приложение не работает или экземпляру HCM не удается подключиться к Azure через порт 80 или 443.</span><span class="sxs-lookup"><span data-stu-id="50af9-221">If it does not say **Connected** then it means that either your app is down or your HCM cannot connect out to Azure on ports 80 or 443.</span></span>  

<span data-ttu-id="50af9-222">Основная причина, по которой клиенты не могут подключиться к своей конечной точке, состоит в том, что для нее был указан IP-адрес, а не DNS-имя.</span><span class="sxs-lookup"><span data-stu-id="50af9-222">The primary reason that clients cannot connect to their endpoint is because the endpoint was specified using an IP address instead of a DNS name.</span></span>  <span data-ttu-id="50af9-223">Если приложение не может связаться с требуемой конечной точкой и был указан IP-адрес, перейдите на использование DNS-имени, являющегося действительным на узле, на котором выполняется HCM.</span><span class="sxs-lookup"><span data-stu-id="50af9-223">If your app cannot reach the desired endpoint and you used an IP address, switch to using a DNS name that is valid on the host where the HCM is running.</span></span>  <span data-ttu-id="50af9-224">Дополнительно стоит проверить правильность разрешения DNS-имени на узле, на котором выполняется HCM, и возможность исходящего подключения от этого узла к конечной точке гибридного подключения.</span><span class="sxs-lookup"><span data-stu-id="50af9-224">Other things to check are that the DNS name resolves properly on the host where the HCM is running and that there is connectivity from the host where the HCM is running to the hybrid connection endpoint.</span></span>  

<span data-ttu-id="50af9-225">В службе приложений доступен инструмент, который можно вызвать из консоли, который называется tcpping.</span><span class="sxs-lookup"><span data-stu-id="50af9-225">There is a tool in the App Service that can be invoked from the console called tcpping.</span></span>  <span data-ttu-id="50af9-226">Этот инструмент может сообщить, имеется ли доступ к конечной точке TCP, но не сообщает, имеется ли доступ к конечной точке гибридного подключения.</span><span class="sxs-lookup"><span data-stu-id="50af9-226">This tool can tell you if you have access to a TCP endpoint but does not tell you if you have access to a hybrid connection endpoint.</span></span>  <span data-ttu-id="50af9-227">В случае использования консоли для конечной точки гибридного подключения успешная проверка связи означает только наличие гибридного подключения, настроенного для вашего приложения, которое использует заданную комбинацию "узел:порт".</span><span class="sxs-lookup"><span data-stu-id="50af9-227">When used in the console against a hybrid connection endpoint, a successful ping will only tell you that you have a hybrid connection configured for your app that uses that host:port combination.</span></span>  

## <a name="biztalk-hybrid-connections"></a><span data-ttu-id="50af9-228">Гибридные подключения BizTalk</span><span class="sxs-lookup"><span data-stu-id="50af9-228">BizTalk Hybrid Connections</span></span> ##

<span data-ttu-id="50af9-229">Устаревшая функция гибридных подключений BizTalk была заблокирована для дальнейшего создания гибридных подключений.</span><span class="sxs-lookup"><span data-stu-id="50af9-229">The older BizTalk Hybrid Connections capability has been closed off to further BizTalk Hybrid Connection creations.</span></span>  <span data-ttu-id="50af9-230">Можно продолжить использование существующих гибридных подключений BizTalk в приложениях, но следует перейти на новую службу.</span><span class="sxs-lookup"><span data-stu-id="50af9-230">You can continue using your preexisting BizTalk Hybrid Connections with your apps but should migrate to the new service.</span></span>  <span data-ttu-id="50af9-231">По сравнению с версией BizTalk новая служба обладает следующими преимуществами:</span><span class="sxs-lookup"><span data-stu-id="50af9-231">Among the benefits in the new service over the BizTalk version are:</span></span>

- <span data-ttu-id="50af9-232">не требуется дополнительная учетная запись BizTalk;</span><span class="sxs-lookup"><span data-stu-id="50af9-232">no additional BizTalk account is required</span></span>
- <span data-ttu-id="50af9-233">используется протокол TLS 1.2 вместо TLS 1.0, как в гибридных подключениях BizTalk;</span><span class="sxs-lookup"><span data-stu-id="50af9-233">TLS is 1.2 instead of 1.0 as in BizTalk Hybrid Connections</span></span>
- <span data-ttu-id="50af9-234">обмен данными с Azure осуществляется через порты 80 и 443 с помощью DNS-имени, а не посредством IP-адресов и ряда дополнительных портов.</span><span class="sxs-lookup"><span data-stu-id="50af9-234">Communication is over ports 80 and 443 using a DNS name to reach Azure instead of IP addresses and a range of additional other ports.</span></span>  

<span data-ttu-id="50af9-235">Чтобы добавить гибридное подключение BizTalk в приложение, перейдите в приложение на [портале Azure][portal] и щелкните **Сети > Настройте конечные точки гибридного подключения**.</span><span class="sxs-lookup"><span data-stu-id="50af9-235">To add a BizTalk hybrid connection to your app, go to your app in the [Azure portal][portal] and click **Networking > Configure your hybrid connection endpoints**.</span></span>  <span data-ttu-id="50af9-236">В таблице классических гибридных подключений щелкните **Добавить классическое гибридное подключение**.</span><span class="sxs-lookup"><span data-stu-id="50af9-236">In the Classic hybrid connections table click **Add classic hybrid connection**.</span></span>  <span data-ttu-id="50af9-237">Вы увидите список гибридных подключений BizTalk.</span><span class="sxs-lookup"><span data-stu-id="50af9-237">From here you will see a list of your BizTalk hybrid connections.</span></span>  


<!--Image references-->
[1]: ./media/app-service-hybrid-connections/hybridconn-connectiondiagram.png
[2]: ./media/app-service-hybrid-connections/hybridconn-portal.png
[3]: ./media/app-service-hybrid-connections/hybridconn-addhc.png
[4]: ./media/app-service-hybrid-connections/hybridconn-createhc.png
[5]: ./media/app-service-hybrid-connections/hybridconn-properties.png
[6]: ./media/app-service-hybrid-connections/hybridconn-aspproperties.png
[7]: ./media/app-service-hybrid-connections/hybridconn-hcm.png
[8]: ./media/app-service-hybrid-connections/hybridconn-hcmadd.png
[9]: ./media/app-service-hybrid-connections/hybridconn-hcmadded.png
[10]: ./media/app-service-hybrid-connections/hybridconn-hcmdetails.png

<!--Links-->
[HCService]: http://docs.microsoft.com/azure/service-bus-relay/relay-hybrid-connections-protocol/
[portal]: http://portal.azure.com/
[oldhc]: http://docs.microsoft.com/azure/biztalk-services/integration-hybrid-connection-overview/
[sbpricing]: http://azure.microsoft.com/pricing/details/service-bus/

