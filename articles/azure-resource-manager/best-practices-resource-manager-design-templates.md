---
title: "aaaDesign Azure шаблоны для сложных решений | Документы Microsoft"
description: "Содержит советы и рекомендации по разработке шаблонов Azure Resource Manager для сложных сценариев."
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: aa45e9a46d79a6336b696cff8fd37f65fa449f11
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="ee19e-103">Приемы разработки шаблонов Azure Resource Manager при развертывании сложных решений</span><span class="sxs-lookup"><span data-stu-id="ee19e-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="ee19e-104">Гибкий подход, основывающийся на использовании шаблонов Azure Resource Manager, позволяет быстро и согласованно развертывать сложные топологии.</span><span class="sxs-lookup"><span data-stu-id="ee19e-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="ee19e-105">Вы можете адаптировать эти развертывания легко, как основные предложения развивать или tooaccommodate варианты для выброс сценарии или клиентов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-105">You can adapt these deployments easily as core offerings evolve or tooaccommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="ee19e-106">Данная тема является частью другого технического документа.</span><span class="sxs-lookup"><span data-stu-id="ee19e-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="ee19e-107">загрузить полной бумага hello tooread [соображения шаблонов диспетчера ресурсов Azure World классов и проверенные методики](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span><span class="sxs-lookup"><span data-stu-id="ee19e-107">tooread hello full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="ee19e-108">Шаблоны сочетать преимущества hello hello базового диспетчера ресурсов Azure с адаптируемости hello и удобочитаемости кода JavaScript Object Notation (JSON).</span><span class="sxs-lookup"><span data-stu-id="ee19e-108">Templates combine hello benefits of hello underlying Azure Resource Manager with hello adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="ee19e-109">Шаблоны можно использовать следующим образом.</span><span class="sxs-lookup"><span data-stu-id="ee19e-109">Using templates, you can:</span></span>

* <span data-ttu-id="ee19e-110">Последовательное развертывание топологий и рабочих нагрузок.</span><span class="sxs-lookup"><span data-stu-id="ee19e-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="ee19e-111">Управление всеми ресурсами в приложении с помощью групп ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="ee19e-112">Примените соответствующие права доступа toogrant toousers для доступом на основе ролей (RBAC), групп и служб.</span><span class="sxs-lookup"><span data-stu-id="ee19e-112">Apply role-based access control (RBAC) toogrant appropriate access toousers, groups, and services.</span></span>
* <span data-ttu-id="ee19e-113">Использование тегов задачи toostreamline ассоциации, например выставления счетов накопительные пакеты обновления.</span><span class="sxs-lookup"><span data-stu-id="ee19e-113">Use tagging associations toostreamline tasks such as billing rollups.</span></span>

<span data-ttu-id="ee19e-114">В этой статье приводятся сведения об использовании сценариев, архитектуры и шаблонов реализации, определенных во время сеансов разработки и реализации шаблона в реальных условиях с клиентами группы консультирования клиентов Azure (AzureCAT).</span><span class="sxs-lookup"><span data-stu-id="ee19e-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="ee19e-115">Далеко от academic, эти подходы проверенных извещен по hello разработки шаблонов для 12 hello верхней операционные системы на основе Linux технологий, включая рекомендации: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise на платформе Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis и Nagios.</span><span class="sxs-lookup"><span data-stu-id="ee19e-115">Far from academic, these approaches are proven practices informed by hello development of templates for 12 of hello top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="ee19e-116">В этой статье использует эти toohelp проверенные архитектора шаблоны Azure Resource Manager класс мира.</span><span class="sxs-lookup"><span data-stu-id="ee19e-116">This article shares these proven practices toohelp you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="ee19e-117">При работе с клиентами мы определили объемы использования шаблонов Resource Manager предприятиями, системными интеграторами и поставщиками облачных служб.</span><span class="sxs-lookup"><span data-stu-id="ee19e-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="ee19e-118">Hello следующие разделы содержат обобщенный Обзор распространенных сценариев и шаблоны для различных типов клиентов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-118">hello following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="ee19e-119">Предприятия и системные интеграторы</span><span class="sxs-lookup"><span data-stu-id="ee19e-119">Enterprises and system integrators</span></span>
<span data-ttu-id="ee19e-120">Пользователи шаблонов Resource Manager в рамках крупных организаций чаще всего представлены двумя типами: группами разработчиков программного обеспечения для внутреннего пользования и корпоративными ИТ-отделами.</span><span class="sxs-lookup"><span data-stu-id="ee19e-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="ee19e-121">Мы обнаружили, что сценарии hello hello SIs сопоставление toohello сценариев для предприятий, поэтому hello же соображения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-121">We've found that hello scenarios for hello SIs map toohello scenarios for Enterprises, so hello same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="ee19e-122">Группы разработчиков программного обеспечения для внутреннего пользования</span><span class="sxs-lookup"><span data-stu-id="ee19e-122">Internal software development teams</span></span>
<span data-ttu-id="ee19e-123">Если группа разрабатывает toosupport программного обеспечения вашего бизнеса, шаблоны позволяют легко tooquickly развертывание технологий для использования в деловых решений.</span><span class="sxs-lookup"><span data-stu-id="ee19e-123">If your team develops software toosupport your business, templates provide an easy way tooquickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="ee19e-124">Также можно использовать шаблоны toorapidly создания сред обучения, позволяющие team члены toogain необходимые навыки.</span><span class="sxs-lookup"><span data-stu-id="ee19e-124">You can also use templates toorapidly create training environments that enable team members toogain necessary skills.</span></span>

<span data-ttu-id="ee19e-125">Можно использовать шаблоны в качестве- или расширить или создать их tooaccommodate вашим потребностям.</span><span class="sxs-lookup"><span data-stu-id="ee19e-125">You can use templates as-is or extend or compose them tooaccommodate your needs.</span></span> <span data-ttu-id="ee19e-126">Добавляя теги в шаблоны, вы можете отображать сводку по выставленным счетам с использованием разных представлений — уровня отдельного пользователя, группы или проекта — включая обучающие представления.</span><span class="sxs-lookup"><span data-stu-id="ee19e-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="ee19e-127">Организациям часто необходимо групп разработчиков toocreate шаблон для развертывания решения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-127">Businesses often want software development teams toocreate a template for consistent deployment of a solution.</span></span> <span data-ttu-id="ee19e-128">шаблон Hello облегчает ограничения, поэтому некоторые элементы в этой среде остаются фиксированными и не может быть переопределен.</span><span class="sxs-lookup"><span data-stu-id="ee19e-128">hello template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="ee19e-129">Например, банк могут потребовать шаблона tooinclude RBAC так, что программист не может изменить решение банковских операций tooa личным хранилищем toosend данных счета.</span><span class="sxs-lookup"><span data-stu-id="ee19e-129">For example, a bank might require a template tooinclude RBAC so a programmer can’t revise a banking solution toosend data tooa personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="ee19e-130">Корпоративные ИТ-отделы</span><span class="sxs-lookup"><span data-stu-id="ee19e-130">Corporate IT</span></span>
<span data-ttu-id="ee19e-131">Корпоративные ИТ-отделы обычно используют шаблоны для доставки емкости облака и возможностей размещения в облаке.</span><span class="sxs-lookup"><span data-stu-id="ee19e-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="ee19e-132">Емкость облака</span><span class="sxs-lookup"><span data-stu-id="ee19e-132">Cloud capacity</span></span>
<span data-ttu-id="ee19e-133">Чаще всего для корпоративных ИТ группы tooprovide емкость облака в плане для команды — «футболки размеры», являющиеся стандартные предложения размеры например малых, средних и больших.</span><span class="sxs-lookup"><span data-stu-id="ee19e-133">A common way for corporate IT groups tooprovide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="ee19e-134">Hello размер футболки предложений можно смешивать разных типов ресурсов и количестве то же время предоставляя уровень стандартизации, делающую возможных toouse шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-134">hello t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible toouse templates.</span></span> <span data-ttu-id="ee19e-135">шаблоны Hello доставлять емкости согласованным образом применяет корпоративной политики, использующий разметку tooprovide о гибком управлении ресурсами tooconsuming организаций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-135">hello templates deliver capacity in a consistent way that enforces corporate policies and uses tagging tooprovide chargeback tooconsuming organizations.</span></span>

<span data-ttu-id="ee19e-136">Например может потребоваться tooprovide разработки, тестирования или рабочей среде, в течение которого hello разработчики программного обеспечения можно развернуть их решения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-136">For example, you may need tooprovide development, test, or production environments within which hello software development teams can deploy their solutions.</span></span> <span data-ttu-id="ee19e-137">Hello среда имеет стандартные сетевые топологии и не может изменять элементы, которые Здравствуйте, разработчики программного обеспечения, например правила, касающиеся доступа toohello открытый Интернет и пакетов проверки.</span><span class="sxs-lookup"><span data-stu-id="ee19e-137">hello environment has a predefined network topology and elements that hello software development teams cannot change, such as rules governing access toohello public internet and packet inspection.</span></span> <span data-ttu-id="ee19e-138">Также возможно, организация ролей для этих сред с правами доступа, уникальные для среды hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-138">You may also have organization-specific roles for these environments with distinct access rights for hello environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="ee19e-139">Возможности размещения в облаке</span><span class="sxs-lookup"><span data-stu-id="ee19e-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="ee19e-140">Можно использовать шаблоны toosupport облаке возможности, включая отдельные пакеты или составного предложения, которые предлагаются toointernal сфер деятельности.</span><span class="sxs-lookup"><span data-stu-id="ee19e-140">You can use templates toosupport cloud-hosted capabilities, including individual software packages or composite offerings that are offered toointernal lines of business.</span></span> <span data-ttu-id="ee19e-141">Пример составного предложения — это аналитика как услуга — технологии аналитики, визуализации и пр. Такие предложения реализуются в оптимизированной и подключенной конфигурации в рамках предопределенной сетевой топологии.</span><span class="sxs-lookup"><span data-stu-id="ee19e-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="ee19e-142">Возможности, размещенных в облаке и оказывают влияние на hello безопасности роли вопросы, заданные в предложение, на которой они выполняется построение мощности облака hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-142">Cloud-hosted capabilities are affected by hello security and role considerations established by hello cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="ee19e-143">Эти возможности предоставляются как есть или в качестве управляемой службы.</span><span class="sxs-lookup"><span data-stu-id="ee19e-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="ee19e-144">Для второй hello, ограниченного доступа роли требуются tooenable доступ в среду hello для целей управления.</span><span class="sxs-lookup"><span data-stu-id="ee19e-144">For hello latter, access-constrained roles are required tooenable access into hello environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="ee19e-145">Поставщики облачных служб</span><span class="sxs-lookup"><span data-stu-id="ee19e-145">Cloud service vendors</span></span>
<span data-ttu-id="ee19e-146">После переговоров toomany общих томов кластера, мы определили несколько подходов, которые можно предпринять toodeploy служб для клиентов и соответствующим требованиям.</span><span class="sxs-lookup"><span data-stu-id="ee19e-146">After talking toomany CSVs, we identified multiple approaches you can take toodeploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="ee19e-147">Предложения, размещаемые поставщиками облачных служб</span><span class="sxs-lookup"><span data-stu-id="ee19e-147">CSV-hosted offering</span></span>
<span data-ttu-id="ee19e-148">При размещении предложения в подписке Azure обычно используется два подхода: отдельное развертывание для каждого клиента и развертывание единиц масштабирования, которые обеспечивают общую инфраструктуру, используемую для всех клиентов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="ee19e-149">**Отдельные развертывания для каждого клиента.**</span><span class="sxs-lookup"><span data-stu-id="ee19e-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="ee19e-150">Отдельные развертывания для каждого клиента требуют наличия фиксированной топологии разных известных конфигураций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="ee19e-151">Эти развертывания могут быть представлены разными размерами виртуальных машин, разным количеством узлов, а также разными объемами связанного хранилища.</span><span class="sxs-lookup"><span data-stu-id="ee19e-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="ee19e-152">Добавление тегов развертываний используется для сведенного выставления счетов каждому клиенту.</span><span class="sxs-lookup"><span data-stu-id="ee19e-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="ee19e-153">RBAC может быть включено tooallow tooaspects доступ клиентов облачной среды.</span><span class="sxs-lookup"><span data-stu-id="ee19e-153">RBAC may be enabled tooallow customers access tooaspects of their cloud environment.</span></span>
* <span data-ttu-id="ee19e-154">**Единицы масштабирования в общей среде с несколькими клиентами.**</span><span class="sxs-lookup"><span data-stu-id="ee19e-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="ee19e-155">Шаблон может представлять единицу масштабирования для сред с несколькими клиентами.</span><span class="sxs-lookup"><span data-stu-id="ee19e-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="ee19e-156">В этом случае hello одной инфраструктуре является используется toosupport всех клиентов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-156">In this case, hello same infrastructure is used toosupport all customers.</span></span> <span data-ttu-id="ee19e-157">Hello развертываний представляет группу ресурсов, которые обеспечивают уровень производительности для hello размещенных предложения, например количество пользователей и число транзакций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-157">hello deployments represent a group of resources that deliver a level of capacity for hello hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="ee19e-158">Эти единицы масштабирования увеличиваются или уменьшаются по запросу.</span><span class="sxs-lookup"><span data-stu-id="ee19e-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="ee19e-159">Внедрение предложений поставщиков облачных служб в подписку клиента</span><span class="sxs-lookup"><span data-stu-id="ee19e-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="ee19e-160">Вы можете toodeploy программного обеспечения в подписок, принадлежащих конечным пользователям.</span><span class="sxs-lookup"><span data-stu-id="ee19e-160">You may want toodeploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="ee19e-161">Можно использовать шаблоны toodeploy различных развертываний в Azure учетной записи клиента.</span><span class="sxs-lookup"><span data-stu-id="ee19e-161">You can use templates toodeploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="ee19e-162">Эти способы развертывания используют RBAC, поэтому можно обновлять и управлять развертыванием hello в учетной записи клиента hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-162">These deployments use RBAC so you can update and manage hello deployment within hello customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="ee19e-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="ee19e-163">Azure Marketplace</span></span>
<span data-ttu-id="ee19e-164">tooadvertise и продавать ваших предложений через marketplace, например Azure Marketplace, можно разработать шаблоны toodeliver различных типов развертывания, работающих в Azure учетной записи клиента.</span><span class="sxs-lookup"><span data-stu-id="ee19e-164">tooadvertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates toodeliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="ee19e-165">Эти разные развертывания обычно можно описать с помощью "размеров футболки" (малый, средний, большой), типа продукта и аудитории (сообщество, разработчики, предприятие) или типа функции (базовый, высокий уровень доступности).</span><span class="sxs-lookup"><span data-stu-id="ee19e-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="ee19e-166">В некоторых случаях эти типы позволяют toospecify определенные атрибуты hello развертывания, такие как тип виртуальной Машины или число дисков.</span><span class="sxs-lookup"><span data-stu-id="ee19e-166">In some cases, these types allow you toospecify certain attributes of hello deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="ee19e-167">Программные проекты с открытым исходным кодом</span><span class="sxs-lookup"><span data-stu-id="ee19e-167">OSS projects</span></span>
<span data-ttu-id="ee19e-168">В рамках проектов с открытым исходным кодом шаблоны диспетчера ресурсов включить toodeploy сообщества решения быстро с использованием проверенные.</span><span class="sxs-lookup"><span data-stu-id="ee19e-168">Within open source projects, Resource Manager templates enable a community toodeploy a solution quickly using proven practices.</span></span> <span data-ttu-id="ee19e-169">Шаблоны можно хранить в репозитории GitHub, hello сообщества можно просмотреть и изменить их во времени.</span><span class="sxs-lookup"><span data-stu-id="ee19e-169">You can store templates in a GitHub repository so hello community can revise them over time.</span></span> <span data-ttu-id="ee19e-170">Пользователи могут развертывать эти шаблоны в своих подписках Azure.</span><span class="sxs-lookup"><span data-stu-id="ee19e-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="ee19e-171">Hello следующих разделах описываются hello необходимые tooconsider перед проектирования решения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-171">hello following sections identify hello things you need tooconsider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="ee19e-172">Определение внутренних и внешних возможностей виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="ee19e-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="ee19e-173">При создании шаблона весьма полезно toolook на требования hello с точки зрения за пределами и внутри hello виртуальных машин (ВМ):</span><span class="sxs-lookup"><span data-stu-id="ee19e-173">As you design your template, it’s helpful toolook at hello requirements in terms of what's outside and inside hello virtual machines (VMs):</span></span>

* <span data-ttu-id="ee19e-174">За пределами означает hello виртуальные машины и другие ресурсы развертывания, таких как топология сети hello, добавление тегов, toohello ссылки на сертификаты и секреты, а также управление доступом на основе ролей.</span><span class="sxs-lookup"><span data-stu-id="ee19e-174">Outside means hello VMs and other resources of your deployment, such as hello network topology, tagging, references toohello certs/secrets, and role-based access control.</span></span> <span data-ttu-id="ee19e-175">Все эти ресурсы являются частью шаблона.</span><span class="sxs-lookup"><span data-stu-id="ee19e-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="ee19e-176">Внутри означает hello установленного программного обеспечения и в целом требуемого состояния конфигурации.</span><span class="sxs-lookup"><span data-stu-id="ee19e-176">Inside means hello installed software and overall desired state configuration.</span></span> <span data-ttu-id="ee19e-177">Другие механизмы, включая расширения виртуальной машины или сценарии, используются целиком или частично.</span><span class="sxs-lookup"><span data-stu-id="ee19e-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="ee19e-178">Эти механизмы может идентифицировать и исполнен hello шаблона, но не в нем.</span><span class="sxs-lookup"><span data-stu-id="ee19e-178">These mechanisms may be identified and executed by hello template but aren’t in it.</span></span>

<span data-ttu-id="ee19e-179">Распространенные примеры действий, которые необходимо выполнить «в поле hello»-</span><span class="sxs-lookup"><span data-stu-id="ee19e-179">Common examples of activities you would do “inside hello box” include -</span></span>  

* <span data-ttu-id="ee19e-180">установка и удаление ролей и компонентов сервера;</span><span class="sxs-lookup"><span data-stu-id="ee19e-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="ee19e-181">Установка и настройка программного обеспечения на уровне узла или кластера hello</span><span class="sxs-lookup"><span data-stu-id="ee19e-181">Install and configure software at hello node or cluster level</span></span>
* <span data-ttu-id="ee19e-182">развертывание веб-сайтов на веб-сервере;</span><span class="sxs-lookup"><span data-stu-id="ee19e-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="ee19e-183">развертывание схем базы данных;</span><span class="sxs-lookup"><span data-stu-id="ee19e-183">Deploy database schemas</span></span>
* <span data-ttu-id="ee19e-184">управление реестром или другими типами параметров конфигурации;</span><span class="sxs-lookup"><span data-stu-id="ee19e-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="ee19e-185">управление файлами и каталогами;</span><span class="sxs-lookup"><span data-stu-id="ee19e-185">Manage files and directories</span></span>
* <span data-ttu-id="ee19e-186">запуск и остановка процессов и служб, а также управление ими;</span><span class="sxs-lookup"><span data-stu-id="ee19e-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="ee19e-187">управление локальными группами и учетными записями пользователей;</span><span class="sxs-lookup"><span data-stu-id="ee19e-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="ee19e-188">установка пакетов и управление ими (файлы MSI и ЕХЕ, yum и т. д.);</span><span class="sxs-lookup"><span data-stu-id="ee19e-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="ee19e-189">настройка переменных среды;</span><span class="sxs-lookup"><span data-stu-id="ee19e-189">Manage environment variables</span></span>
* <span data-ttu-id="ee19e-190">запуск собственных скриптов (Windows PowerShell, bash и т. д.).</span><span class="sxs-lookup"><span data-stu-id="ee19e-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="ee19e-191">Настройка требуемого состояния</span><span class="sxs-lookup"><span data-stu-id="ee19e-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="ee19e-192">Размышления о hello внутреннее состояние виртуальных машин после развертывания, необходимо, чтобы toomake убедиться, что это развертывание не «смещения» из конфигурации hello, определены и возвращены в систему управления версиями.</span><span class="sxs-lookup"><span data-stu-id="ee19e-192">Thinking about hello internal state of your VMs beyond deployment, you want toomake sure this deployment doesn’t "drift" from hello configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="ee19e-193">Такой подход гарантирует разработчиков или сотрудникам не делают ad-hoc изменения tooan среды, не являются экспертизу, тестирование или записи в системе управления версиями.</span><span class="sxs-lookup"><span data-stu-id="ee19e-193">This approach ensures your developers or operations staff don’t make ad-hoc changes tooan environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="ee19e-194">Этот элемент управления важна, так как в системе управления версиями не hello изменения вручную.</span><span class="sxs-lookup"><span data-stu-id="ee19e-194">This control is important, because hello manual changes are not in source control.</span></span> <span data-ttu-id="ee19e-195">Они также не являются частью стандартного развертывания hello и повлияет на будущие автоматизированное развертывание программного обеспечения hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-195">They are also not part of hello standard deployment and will impact future automated deployments of hello software.</span></span>

<span data-ttu-id="ee19e-196">Помимо управления доступом внутренних сотрудников настройка требуемого состояния имеет большое значение для безопасности.</span><span class="sxs-lookup"><span data-stu-id="ee19e-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="ee19e-197">Хакеров регулярно пытаетесь toocompromise и воспользоваться программных систем.</span><span class="sxs-lookup"><span data-stu-id="ee19e-197">Hackers are regularly trying toocompromise and exploit software systems.</span></span> <span data-ttu-id="ee19e-198">При успешном выполнении это общие файлы tooinstall, который в противном случае изменения состояния hello скомпрометированных системы.</span><span class="sxs-lookup"><span data-stu-id="ee19e-198">When successful, it's common tooinstall files and otherwise change hello state of a compromised system.</span></span> <span data-ttu-id="ee19e-199">Конфигурации требуемого состояния можно определить различия между требуемого hello и фактическим состоянием и восстановление известной конфигурации.</span><span class="sxs-lookup"><span data-stu-id="ee19e-199">Using desired state configuration, you can identify deltas between hello desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="ee19e-200">Существуют расширения ресурсов hello наиболее популярных механизма DSC — PowerShell DSC, Chef и Puppet.</span><span class="sxs-lookup"><span data-stu-id="ee19e-200">There are resource extensions for hello most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="ee19e-201">Каждый из этих расширений можно развернуть hello начальное состояние виртуальной Машины и быть действительно hello требуемого состояния, используемые toomake.</span><span class="sxs-lookup"><span data-stu-id="ee19e-201">Each of these extensions can deploy hello initial state of your VM and also be used toomake sure hello desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="ee19e-202">Общие области действия шаблона</span><span class="sxs-lookup"><span data-stu-id="ee19e-202">Common template scopes</span></span>
<span data-ttu-id="ee19e-203">На практике мы сталкиваемся с тремя ключевыми областями действия шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="ee19e-204">Эти три области — емкости, возможностей и решения с начала до конца — описаны в следующих разделах hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-204">These three scopes – capacity, capability, and end-to-end solution – are described in hello following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="ee19e-205">Область определения емкости</span><span class="sxs-lookup"><span data-stu-id="ee19e-205">Capacity scope</span></span>
<span data-ttu-id="ee19e-206">Емкость область предоставляет набор ресурсов в стандартной топологии, предварительно настроенных toobe в соответствии с правилами и политик.</span><span class="sxs-lookup"><span data-stu-id="ee19e-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured toobe in compliance with regulations and policies.</span></span> <span data-ttu-id="ee19e-207">наиболее типичный пример Hello — развертывание стандартной среде разработки в сценарии ИТ предприятия или SI.</span><span class="sxs-lookup"><span data-stu-id="ee19e-207">hello most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="ee19e-208">Область определения возможностей</span><span class="sxs-lookup"><span data-stu-id="ee19e-208">Capability scope</span></span>
<span data-ttu-id="ee19e-209">Область определения возможностей фокусируется на развертывании и настройке топологии для данной технологии.</span><span class="sxs-lookup"><span data-stu-id="ee19e-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="ee19e-210">Типичные сценарии включают такие технологии, как SQL Server, Cassandra, Hadoop и т. д.</span><span class="sxs-lookup"><span data-stu-id="ee19e-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="ee19e-211">Область законченного решения</span><span class="sxs-lookup"><span data-stu-id="ee19e-211">End-to-end solution scope</span></span>
<span data-ttu-id="ee19e-212">Область решения конца в конец целевой за пределы одного возможностей и вместо сконцентрирована на реализации tooend решениям, состоящей из нескольких возможностей.</span><span class="sxs-lookup"><span data-stu-id="ee19e-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end tooend solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="ee19e-213">Область действия шаблона, определяющего решение, представляет собой некий набор. Этот набор состоит из одного или нескольких шаблонов, определяющих возможности, со специальными ресурсами, логикой и требуемым состоянием конкретного решения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="ee19e-214">Пример решения области шаблона — шаблон решения tooend данных конец конвейера.</span><span class="sxs-lookup"><span data-stu-id="ee19e-214">An example of a solution-scoped template is an end tooend data pipeline solution template.</span></span> <span data-ttu-id="ee19e-215">шаблон Hello может смешивать топологии конкретного решения и состояния с несколькими шаблонами решением из области функции, такие как Kafka, Storm и Hadoop.</span><span class="sxs-lookup"><span data-stu-id="ee19e-215">hello template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="ee19e-216">Конфигурации свободной формы и известные конфигурации</span><span class="sxs-lookup"><span data-stu-id="ee19e-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="ee19e-217">Изначально может показаться шаблона следует предоставить потребителей hello обеспечить гибкость, но учесть множество факторов, влияющих на hello выбрать, следует ли toouse конфигураций свободной формы и известных конфигураций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-217">You might initially think a template should give consumers hello utmost flexibility, but many considerations affect hello choice of whether toouse free-form configurations vs. known configurations.</span></span> <span data-ttu-id="ee19e-218">В этом разделе определяет hello ключа клиентские требования и технические вопросы, которые были сформированы подход hello совместно в этом документе.</span><span class="sxs-lookup"><span data-stu-id="ee19e-218">This section identifies hello key customer requirements and technical considerations that shaped hello approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="ee19e-219">Конфигурации свободной формы</span><span class="sxs-lookup"><span data-stu-id="ee19e-219">Free-form configurations</span></span>
<span data-ttu-id="ee19e-220">На первый взгляд hello произвольных конфигураций звук идеальным.</span><span class="sxs-lookup"><span data-stu-id="ee19e-220">On hello surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="ee19e-221">Они позволяют tooselect тип виртуальной Машины и обеспечивают произвольное число узлов и подключенные диски для тех узлов, и сделать это в качестве параметров шаблона tooa.</span><span class="sxs-lookup"><span data-stu-id="ee19e-221">They allow you tooselect a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters tooa template.</span></span> <span data-ttu-id="ee19e-222">Тем не менее этот подход не подходит для некоторых сценариев.</span><span class="sxs-lookup"><span data-stu-id="ee19e-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="ee19e-223">В [размеры виртуальных машин](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), определяются hello разных типов ВМ и доступные размеры и каждого hello число устойчивой диски (2, 4, 8, 16 или 32), который может быть присоединен.</span><span class="sxs-lookup"><span data-stu-id="ee19e-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), hello different VM types and available sizes are identified, and each of hello number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="ee19e-224">Каждый подключенный диск выполняет 500 операций ввода-вывода в секунду; несколько таких дисков могут быть объединены для увеличения этого показателя.</span><span class="sxs-lookup"><span data-stu-id="ee19e-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="ee19e-225">Например, 16 дисков может быть пула tooprovide 8 000 операций ввода-ВЫВОДА.</span><span class="sxs-lookup"><span data-stu-id="ee19e-225">For example, 16 disks can be pooled tooprovide 8,000 IOPS.</span></span> <span data-ttu-id="ee19e-226">Создание пулов выполняется с помощью конфигурации в hello операционной системы, с помощью дисковых пространств Microsoft Windows или дисковый массив недорогих дисков (RAID) в Linux.</span><span class="sxs-lookup"><span data-stu-id="ee19e-226">Pooling is done with configuration in hello operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="ee19e-227">Конфигурации произвольный выбор hello несколько экземпляров виртуальных Машин, ВМ различные типы и размеры для этих экземпляров различных дисков для hello типа виртуальной Машины, и один или несколько сценариев tooconfigure hello ВМ содержимое.</span><span class="sxs-lookup"><span data-stu-id="ee19e-227">A free-form configuration enables hello selection several VM instances, various VM types and sizes for those instances, various disks for hello VM type, and one or more scripts tooconfigure hello VM contents.</span></span>

<span data-ttu-id="ee19e-228">Чаще всего развертывание может иметь несколько типов узлов, включая главные узлы и узлы данных, поэтому гибкое использование обеспечивается для каждого типа узла.</span><span class="sxs-lookup"><span data-stu-id="ee19e-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="ee19e-229">Как только вы начнете toodeploy кластеры любого значимости, сначала toowork на этих сложных сценариях.</span><span class="sxs-lookup"><span data-stu-id="ee19e-229">As you start toodeploy clusters of any significance, you begin toowork with these complex scenarios.</span></span> <span data-ttu-id="ee19e-230">При развертывании кластера Hadoop, например, с 8 главных узлов и узлов 200 данных, а пул 4 присоединенные диски на каждом главном узле и пула 16 присоединенные диски на узле данных, потребовалось бы 208 виртуальные машины и toomanage 3,232 дисков.</span><span class="sxs-lookup"><span data-stu-id="ee19e-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks toomanage.</span></span>

<span data-ttu-id="ee19e-231">Учетная запись хранения будет регулировать запросы выше ограничить его идентифицированных 20 000 транзакций в секунду, поэтому необходимо рассмотреть секционирование учетной записи хранилища и использовать вычисления toodetermine hello достаточное количество хранилища учетных записей tooaccommodate этой топологии.</span><span class="sxs-lookup"><span data-stu-id="ee19e-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations toodetermine hello appropriate number of storage accounts tooaccommodate this topology.</span></span> <span data-ttu-id="ee19e-232">Получает множество hello сочетания поддерживаемых подход hello произвольной формы, динамические вычисления необходимые toodetermine hello соответствующие секционирование.</span><span class="sxs-lookup"><span data-stu-id="ee19e-232">Given hello multitude of combinations supported by hello free-form approach, dynamic calculations are required toodetermine hello appropriate partitioning.</span></span> <span data-ttu-id="ee19e-233">Hello язык шаблонов диспетчера ресурсов Azure не предоставляет в настоящее время математические функции, поэтому необходимо выполнять эти вычисления в коде, создания уникальных, жестко шаблон с hello необходимые сведения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-233">hello Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with hello appropriate details.</span></span>

<span data-ttu-id="ee19e-234">В корпоративных ИТ и SI сценариев кто-то Ведение hello шаблонов и поддержки топологии развертывания hello для одного или нескольких организаций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-234">In enterprise IT and SI scenarios, someone must maintain hello templates and support hello deployed topologies for one or more organizations.</span></span> <span data-ttu-id="ee19e-235">Эти дополнительные издержки — наличие разных конфигураций и шаблонов для каждого клиента — сложно назвать идеальным вариантом.</span><span class="sxs-lookup"><span data-stu-id="ee19e-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="ee19e-236">Можно использовать эти шаблоны toodeploy среды в Azure подписки клиента, но корпоративных ИТ-отделов и CSV обычно их развертывания в своих подписок toobill функция гибкого управления ресурсами с помощью своих клиентов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-236">You can use these templates toodeploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function toobill their customers.</span></span> <span data-ttu-id="ee19e-237">В этих сценариях hello цель — toodeploy емкости для нескольких клиентов, через пул подписки и сохранить развертываний плотно включаются в центрах подписки toominimize подписки hello — то есть дополнительные toomanage подписки.</span><span class="sxs-lookup"><span data-stu-id="ee19e-237">In these scenarios, hello goal is toodeploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into hello subscriptions toominimize subscription sprawl—that is, more subscriptions toomanage.</span></span> <span data-ttu-id="ee19e-238">Размеры настоящему динамическое развертывание достижения этого типа плотность требует тщательного планирования и дополнительная разработка для формирования шаблонов работы от имени организации hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of hello organization.</span></span>

<span data-ttu-id="ee19e-239">Кроме того невозможно создать подписки через вызов API, но необходимо сделать вручную через портал hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-239">In addition, you can’t create subscriptions via an API call but must do so manually through hello portal.</span></span> <span data-ttu-id="ee19e-240">При увеличении hello количество подписок, все результирующие центрах подписки требует вмешательства человека, не могут быть автоматизированы.</span><span class="sxs-lookup"><span data-stu-id="ee19e-240">As hello number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="ee19e-241">С так много вариативности в hello размеры развертываний пришлось бы toopre подготовки подписок вручную tooensure подписки доступны.</span><span class="sxs-lookup"><span data-stu-id="ee19e-241">With so much variability in hello sizes of deployments, you would have toopre-provision a number of subscriptions manually tooensure subscriptions are available.</span></span>

<span data-ttu-id="ee19e-242">Учитывая все эти факторы, конфигурации свободной формы являются в реальности менее привлекательным решением, чем на первый взгляд.</span><span class="sxs-lookup"><span data-stu-id="ee19e-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--hello-t-shirt-sizing-approach"></a><span data-ttu-id="ee19e-243">Удачной конфигурации — hello подход футболки изменения размера</span><span class="sxs-lookup"><span data-stu-id="ee19e-243">Known configurations — hello t-shirt sizing approach</span></span>
<span data-ttu-id="ee19e-244">А не реализует шаблон, который обеспечивает общее гибкость и множество вариантов, опыт распространенный подход заключается в tooprovide hello возможность tooselect удачной конфигурации, в сущности, стандартная футболки размеров, таких как "песочницы", небольшой, средний и большой.</span><span class="sxs-lookup"><span data-stu-id="ee19e-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is tooprovide hello ability tooselect known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="ee19e-245">Другие примеры использования этого подхода включают такие продукты, как Community Edition или Enterprise Edition.</span><span class="sxs-lookup"><span data-stu-id="ee19e-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="ee19e-246">Другие случаи могут быть представлены конфигурациями технологий, зависящими от рабочей нагрузки, включая решения Map/Reduce или NoSQL.</span><span class="sxs-lookup"><span data-stu-id="ee19e-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="ee19e-247">Многие корпоративные ИТ-отделы, поставщики программного обеспечения с открытым исходным кодом и системные интеграторы предоставляют свои продукты локально, в виртуализованных средах (предприятия) или в качестве программного обеспечения как услуги (SaaS) (поставщики облачных служб и поставщики решений с открытым исходным кодом).</span><span class="sxs-lookup"><span data-stu-id="ee19e-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="ee19e-248">Такой подход позволяет использовать хорошие и известные конфигурации разных размеров, предварительно настроенные для клиентов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="ee19e-249">Без известных конфигураций конечных пользователей необходимо определить изменения размера кластера по отдельности, учитывать ограничения ресурсов платформы и выполнять математические tooidentify hello возникающие секционирование учетные записи хранения и другие ресурсы (из-за размера toocluster и ресурсов ограничения).</span><span class="sxs-lookup"><span data-stu-id="ee19e-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math tooidentify hello resulting partitioning of storage accounts and other resources (due toocluster size and resource constraints).</span></span> <span data-ttu-id="ee19e-250">Удачной конфигурации включить неправильный размер футболки клиентов tooeasily выберите hello — то есть конкретного развертывания.</span><span class="sxs-lookup"><span data-stu-id="ee19e-250">Known configurations enable customers tooeasily select hello right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="ee19e-251">Кроме toomaking для повышения удобства для клиента hello небольшое количество известной конфигурации будет проще toosupport и может помочь вам предоставлять более высокий уровень плотности.</span><span class="sxs-lookup"><span data-stu-id="ee19e-251">In addition toomaking a better experience for hello customer, a small number of known configurations is easier toosupport and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="ee19e-252">Подход с применением известной конфигурации по методу «размер футболки» также характеризуется переменным количеством узлов одного размера.</span><span class="sxs-lookup"><span data-stu-id="ee19e-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="ee19e-253">Например, «футболка» малого размера может включать от 3 до 10 узлов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="ee19e-254">размер футболки Hello будут спроектированный tooaccommodate too10 узлов и предоставить hello потребителя возможность hello toomake выбранных элементов в свободной форме toohello максимальный размер определяемого.</span><span class="sxs-lookup"><span data-stu-id="ee19e-254">hello t-shirt size would be designed tooaccommodate up too10 nodes and provide hello consumer hello ability toomake free form selections up toohello maximum size identified.</span></span>  

<span data-ttu-id="ee19e-255">Размер футболки, в зависимости от типа рабочей нагрузки может быть несколько произвольной формы по своей природе с точки зрения hello число узлов, которые могут быть развернуты, но будет иметь размер distinct узел рабочей нагрузки и конфигурации hello программного обеспечения на узле hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-255">A t-shirt size based on workload type, may be more free form in nature in terms of hello number of nodes that can be deployed but will have workload distinct node size and configuration of hello software on hello node.</span></span>

<span data-ttu-id="ee19e-256">Размеры футболки основании предложения продуктов, например community или Enterprise, могут иметь типы различных ресурсов и максимальное количество узлов, которые могут быть развернуты, обычно привязаны toolicensing вопросы или доступность функций по hello разных предложений.</span><span class="sxs-lookup"><span data-stu-id="ee19e-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied toolicensing considerations or feature availability across hello different offerings.</span></span>

<span data-ttu-id="ee19e-257">Можно также обеспечивает возможность проведения клиентов с уникальным вариантов с помощью шаблонов на основе JSON hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-257">You can also accommodate customers with unique variants using hello JSON-based templates.</span></span> <span data-ttu-id="ee19e-258">При работе с выбросы, можно включить соответствующий план hello и рекомендации для разработки, поддержки и расчет затрат.</span><span class="sxs-lookup"><span data-stu-id="ee19e-258">When dealing with outliers, you can incorporate hello appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="ee19e-259">На основе шаблона потребления hello клиентских сценариев и требованиям, определенным в начале hello этого документа, мы определили шаблон для развернутого шаблона.</span><span class="sxs-lookup"><span data-stu-id="ee19e-259">Based on hello customer template consumption scenarios, and requirements identified at hello start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="ee19e-260">Шаблоны решений, определяющие емкость и возможности</span><span class="sxs-lookup"><span data-stu-id="ee19e-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="ee19e-261">Развернутое предоставляет разработка tootemplate Модульный подход, поддерживающий многократного использования, расширяемость, тестирования и работы с проектами.</span><span class="sxs-lookup"><span data-stu-id="ee19e-261">Decomposition provides a modular approach tootemplate development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="ee19e-262">Этот раздел содержит сведения о как развернутого подход может быть применен tootemplates с областью возможностей.</span><span class="sxs-lookup"><span data-stu-id="ee19e-262">This section provides detail on how a decomposition approach can be applied tootemplates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="ee19e-263">При таком подходе основной шаблон получает значения параметров из шаблона объекта-получателя, а затем связывает нижестоящим tooseveral типов шаблонов и сценариев, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="ee19e-263">In this approach, a main template receives parameter values from a template consumer, then links tooseveral types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="ee19e-264">Параметры, статические переменные и переменные, созданные являются значениями используется tooprovide и из него hello связанных шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-264">Parameters, static variables, and generated variables are used tooprovide values in and out of hello linked templates.</span></span>

![Параметры шаблона](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="ee19e-266">**Параметры передаются tooa главного шаблона, а затем toolinked шаблонов**</span><span class="sxs-lookup"><span data-stu-id="ee19e-266">**Parameters are passed tooa main template then toolinked templates**</span></span>

<span data-ttu-id="ee19e-267">следующие разделы фокус на hello типов шаблонов и сценариев, в одном шаблоне разлагаются на Hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-267">hello following sections focus on hello types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="ee19e-268">Hello разделах представлены подходы для передачи сведений о состоянии из шаблонов hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-268">hello sections present approaches for passing state information among hello templates.</span></span> <span data-ttu-id="ee19e-269">Каждый шаблон и hello типы скрипт в образе hello описаны вместе с примерами.</span><span class="sxs-lookup"><span data-stu-id="ee19e-269">Each template and hello script types in hello image are described along with examples.</span></span> <span data-ttu-id="ee19e-270">Контекстные примеры см. в разделе «Сборка: пример реализации» далее в этом документе.</span><span class="sxs-lookup"><span data-stu-id="ee19e-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="ee19e-271">Метаданные шаблона</span><span class="sxs-lookup"><span data-stu-id="ee19e-271">Template metadata</span></span>
<span data-ttu-id="ee19e-272">Метаданные шаблона (hello metadata.json-файл) содержит пары ключ значение, описание шаблона в формате JSON, который может быть прочитан человека и программных систем.</span><span class="sxs-lookup"><span data-stu-id="ee19e-272">Template metadata (hello metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Метаданные шаблона](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="ee19e-274">**Метаданные шаблона описан в файле metadata.json hello**</span><span class="sxs-lookup"><span data-stu-id="ee19e-274">**Template metadata is described in hello metadata.json file**</span></span>

<span data-ttu-id="ee19e-275">Для установки агентов можно извлечь файл metadata.json hello и публикации информации hello и шаблон toohello ссылку в веб-страницы или каталога.</span><span class="sxs-lookup"><span data-stu-id="ee19e-275">Software agents can retrieve hello metadata.json file and publish hello information and a link toohello template in a web page or directory.</span></span> <span data-ttu-id="ee19e-276">Элементы включают: *itemDisplayName*, *description*, *summary*, *githubUsername* и *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="ee19e-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="ee19e-277">Ниже приведен пример файла целиком.</span><span class="sxs-lookup"><span data-stu-id="ee19e-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. hello database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="ee19e-278">Основной шаблон</span><span class="sxs-lookup"><span data-stu-id="ee19e-278">Main template</span></span>
<span data-ttu-id="ee19e-279">основной шаблон Hello получает параметры пользователя, использует toopopulate сложный объект сведения о переменных и выполняет hello связанных шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-279">hello main template receives parameters from a user, uses that information toopopulate complex object variables, and executes hello linked templates.</span></span>

![Основной шаблон](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="ee19e-281">**основной шаблон Hello получает параметры пользователя**</span><span class="sxs-lookup"><span data-stu-id="ee19e-281">**hello main template receives parameters from a user**</span></span>

<span data-ttu-id="ee19e-282">Один параметр, который предоставляется является типом известной конфигурации также называется hello параметр размер футболки, из-за его стандартных значений, таких как малых, средних и больших.</span><span class="sxs-lookup"><span data-stu-id="ee19e-282">One parameter that is provided is a known configuration type also known as hello t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="ee19e-283">На практике этот параметр можно использовать разными способами.</span><span class="sxs-lookup"><span data-stu-id="ee19e-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="ee19e-284">Дополнительные сведения см. в разделе «Шаблоны ресурсов известной конфигурации» далее в этом документе.</span><span class="sxs-lookup"><span data-stu-id="ee19e-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="ee19e-285">Некоторые ресурсы развертываются независимо от известных конфигурации hello, заданного параметром пользователя.</span><span class="sxs-lookup"><span data-stu-id="ee19e-285">Some resources are deployed regardless of hello known configuration specified by a user parameter.</span></span> <span data-ttu-id="ee19e-286">Эти ресурсы, подготовленные с помощью шаблона одного общего ресурса и могут совместно использоваться другими шаблонами, поэтому hello общего ресурса шаблона выполняется первым.</span><span class="sxs-lookup"><span data-stu-id="ee19e-286">These resources are provisioned using a single shared resource template and are shared by other templates, so hello shared resource template is run first.</span></span>

<span data-ttu-id="ee19e-287">Некоторые ресурсы развертываются при необходимости независимо от указанного известной конфигурации hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-287">Some resources are deployed optionally regardless of hello specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="ee19e-288">Шаблон общих ресурсов</span><span class="sxs-lookup"><span data-stu-id="ee19e-288">Shared resources template</span></span>
<span data-ttu-id="ee19e-289">Этот шаблон предоставляет ресурсы, которые являются общими для всех известных конфигураций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="ee19e-290">В нем hello виртуальной сети, группы доступности и другие ресурсы, которые требуются независимо от hello известной конфигурации шаблона, который развертывается.</span><span class="sxs-lookup"><span data-stu-id="ee19e-290">It contains hello virtual network, availability sets, and other resources that are required regardless of hello known configuration template that is deployed.</span></span>

![Ресурсы шаблона](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="ee19e-292">**Шаблон общих ресурсов**</span><span class="sxs-lookup"><span data-stu-id="ee19e-292">**Shared resources template**</span></span>

<span data-ttu-id="ee19e-293">Имена ресурсов, такие как имя виртуальной сети hello, основанные на шаблоне основной hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-293">Resource names, such as hello virtual network name, are based on hello main template.</span></span> <span data-ttu-id="ee19e-294">Можно указать их в качестве переменной в этом шаблоне или получать их в виде параметра от пользователя hello, согласно требованиям вашей организации.</span><span class="sxs-lookup"><span data-stu-id="ee19e-294">You can specify them as a variable within that template or receive them as a parameter from hello user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="ee19e-295">Шаблон дополнительных ресурсов</span><span class="sxs-lookup"><span data-stu-id="ee19e-295">Optional resources template</span></span>
<span data-ttu-id="ee19e-296">шаблон Hello необязательно ресурсов содержит ресурсы, которые развертываются программным способом на основе значения параметра или переменной hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-296">hello optional resources template contains resources that are programmatically deployed based on hello value of a parameter or variable.</span></span>

![Дополнительные ресурсы](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="ee19e-298">**Шаблон дополнительных ресурсов**</span><span class="sxs-lookup"><span data-stu-id="ee19e-298">**Optional resources template**</span></span>

<span data-ttu-id="ee19e-299">Например, можно использовать необязательный ресурсов шаблона tooconfigure jumpbox, позволяющий среды развертывания tooa косвенный доступ из hello общедоступный Интернет.</span><span class="sxs-lookup"><span data-stu-id="ee19e-299">For example, you can use an optional resources template tooconfigure a jumpbox that enables indirect access tooa deployed environment from hello public Internet.</span></span> <span data-ttu-id="ee19e-300">Используется параметр или переменную tooidentify Включение hello jumpbox и hello *concat* toobuild hello целевой имя для шаблона hello функции например *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="ee19e-300">You would use a parameter or variable tooidentify whether hello jumpbox should be enabled and hello *concat* function toobuild hello target name for hello template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="ee19e-301">Связывание шаблона будет использоваться hello полученный переменной tooinstall hello jumpbox.</span><span class="sxs-lookup"><span data-stu-id="ee19e-301">Template linking would use hello resulting variable tooinstall hello jumpbox.</span></span>

<span data-ttu-id="ee19e-302">Можно связать шаблон hello дополнительные ресурсы из нескольких мест:</span><span class="sxs-lookup"><span data-stu-id="ee19e-302">You can link hello optional resources template from multiple places:</span></span>

* <span data-ttu-id="ee19e-303">Если применимо tooevery развертывания, создать ссылку на основании параметров из шаблона hello общих ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-303">When applicable tooevery deployment, create a parameter-driven link from hello shared resources template.</span></span>
* <span data-ttu-id="ee19e-304">При применимо tooselect удачной конфигурации — например, установить только на крупных развертываний — создать ссылку на основании параметров или управляемых переменной из шаблона hello известной конфигурации.</span><span class="sxs-lookup"><span data-stu-id="ee19e-304">When applicable tooselect known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from hello known configuration template.</span></span>

<span data-ttu-id="ee19e-305">Данному ресурсу необязателен может не влияют hello шаблон потребителя, а шаблон поставщиком hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-305">Whether a given resource is optional may not be driven by hello template consumer but instead by hello template provider.</span></span> <span data-ttu-id="ee19e-306">Например, может потребоваться toosatisfy требования конкретного продукта или надстройками продуктов (общее для общих томов кластера) или политики tooenforce (обычно хранилище единственных копий и корпоративных ИТ группы).</span><span class="sxs-lookup"><span data-stu-id="ee19e-306">For example, you may need toosatisfy a particular product requirement or product add-on (common for CSVs) or tooenforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="ee19e-307">В этих случаях можно использовать переменной tooidentify ли развертываться hello ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-307">In these cases, you can use a variable tooidentify whether hello resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="ee19e-308">Шаблон известной конфигурации ресурсов</span><span class="sxs-lookup"><span data-stu-id="ee19e-308">Known configuration resources template</span></span>
<span data-ttu-id="ee19e-309">В главном шаблоне hello параметр может быть предоставляется tooallow hello шаблон потребителя toospecify toodeploy известной требуемой конфигурации.</span><span class="sxs-lookup"><span data-stu-id="ee19e-309">In hello main template, a parameter can be exposed tooallow hello template consumer toospecify a desired known configuration toodeploy.</span></span> <span data-ttu-id="ee19e-310">Зачастую эта известная конфигурация использует подход "размер футболки" с набором фиксированных размеров конфигураций песочницы: малый, средний и большой.</span><span class="sxs-lookup"><span data-stu-id="ee19e-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Ресурсы известной конфигурации](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="ee19e-312">**Шаблон известной конфигурации ресурсов**</span><span class="sxs-lookup"><span data-stu-id="ee19e-312">**Known configuration resources template**</span></span>

<span data-ttu-id="ee19e-313">обычно используется подход размер футболки Hello, но параметры hello могут представлять любой набор известных конфигураций.</span><span class="sxs-lookup"><span data-stu-id="ee19e-313">hello t-shirt size approach is commonly used, but hello parameters can represent any set of known configurations.</span></span> <span data-ttu-id="ee19e-314">Например, вы можете указать набор сред для корпоративного приложения, включая среды для разработки, тестирования и производства.</span><span class="sxs-lookup"><span data-stu-id="ee19e-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="ee19e-315">Или можно использовать для облачной службы toorepresent различных масштабирование единиц, версии продукта или конфигурации продукта, такие как сообщества, Developer или Enterprise.</span><span class="sxs-lookup"><span data-stu-id="ee19e-315">Or you could use it for a cloud service toorepresent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="ee19e-316">С помощью шаблона hello общего ресурса, передаются переменные toohello известной конфигурации шаблон либо из:</span><span class="sxs-lookup"><span data-stu-id="ee19e-316">As with hello shared resource template, variables are passed toohello known configurations template from either:</span></span>

* <span data-ttu-id="ee19e-317">Конечный пользователь — то есть, параметры hello передавать toohello основного шаблона.</span><span class="sxs-lookup"><span data-stu-id="ee19e-317">An end user—that is, hello parameters sent toohello main template.</span></span>
* <span data-ttu-id="ee19e-318">Организации, то есть hello переменных в шаблоне основной hello, которые представляют внутренние требованиям или политик.</span><span class="sxs-lookup"><span data-stu-id="ee19e-318">An organization—that is, hello variables in hello main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="ee19e-319">Шаблон элемента ресурсов</span><span class="sxs-lookup"><span data-stu-id="ee19e-319">Member resources template</span></span>
<span data-ttu-id="ee19e-320">В известную конфигурацию часто включены один или несколько типов элементов узла.</span><span class="sxs-lookup"><span data-stu-id="ee19e-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="ee19e-321">Например, при работе с Hadoop у вас есть основные узлы и узлы данных.</span><span class="sxs-lookup"><span data-stu-id="ee19e-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="ee19e-322">При установке MongoDB у вас будут узлы данных и арбитр.</span><span class="sxs-lookup"><span data-stu-id="ee19e-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="ee19e-323">При развертывании DataStax у вас будут узлы данных, а также ВМ с установленной службой OpsCenter.</span><span class="sxs-lookup"><span data-stu-id="ee19e-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Ресурсы элементов](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="ee19e-325">**Шаблон элемента ресурсов**</span><span class="sxs-lookup"><span data-stu-id="ee19e-325">**Member resources template**</span></span>

<span data-ttu-id="ee19e-326">Каждый тип узлов можно имеют разные размеры виртуальных машин, количество присоединенные диски, сценарии tooinstall и настроить узлы hello, конфигурации порта для виртуальных машин hello, число экземпляров и другие сведения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts tooinstall and set up hello nodes, port configurations for hello VMs, number of instances, and other details.</span></span> <span data-ttu-id="ee19e-327">Поэтому каждый тип узла получает свой собственный ресурсов шаблона элемента, который содержит hello сведения для развертывание и Настройка инфраструктуры, а также выполнения сценариев toodeploy и настройка программного обеспечения в пределах hello виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="ee19e-327">So each node type gets its own member resource template, which contains hello details for deploying and configuring an infrastructure as well as executing scripts toodeploy and configure software within hello VM.</span></span>

<span data-ttu-id="ee19e-328">Для виртуальной машины обычно используется два типа скриптов: повторно используемые и пользовательские.</span><span class="sxs-lookup"><span data-stu-id="ee19e-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="ee19e-329">Повторно используемые скрипты</span><span class="sxs-lookup"><span data-stu-id="ee19e-329">Widely reusable scripts</span></span>
<span data-ttu-id="ee19e-330">Повторно используемые скрипты можно использовать для нескольких типов шаблонов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="ee19e-331">Один из примеров лучше hello этих скриптов, широко многократно используемых настраивает RAID на дисках toopool Linux и получения большого количества операций ввода-ВЫВОДА.</span><span class="sxs-lookup"><span data-stu-id="ee19e-331">One of hello better examples of these widely reusable scripts sets up RAID on Linux toopool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="ee19e-332">Независимо от программного обеспечения hello, устанавливаемый в hello виртуальной Машины этот сценарий обеспечивает повторное использование проверенные для распространенных сценариев.</span><span class="sxs-lookup"><span data-stu-id="ee19e-332">Regardless of hello software being installed in hello VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Скрипты повторного использования](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="ee19e-334">**Шаблоны элементов ресурсов могут вызывать повторно используемые скрипты**</span><span class="sxs-lookup"><span data-stu-id="ee19e-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="ee19e-335">Пользовательские скрипты</span><span class="sxs-lookup"><span data-stu-id="ee19e-335">Custom scripts</span></span>
<span data-ttu-id="ee19e-336">Шаблоны часто вызывают один или несколько скриптов, отвечающих за установку и настройку программного обеспечения в виртуальной машине.</span><span class="sxs-lookup"><span data-stu-id="ee19e-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="ee19e-337">Общий шаблон используется с большими топологиями, в которых развернуто несколько экземпляров одного или нескольких типов элементов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="ee19e-338">Скрипт установки инициируется для каждой виртуальной машины, которая может быть запущена параллельно. Затем выполняется скрипт установки, который вызывается после развертывания всех виртуальных машин (или всех виртуальных машин данного типа элемента).</span><span class="sxs-lookup"><span data-stu-id="ee19e-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Пользовательские скрипты](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="ee19e-340">**Шаблоны элементов ресурсов могут вызывать скрипты для выполнения определенных задач, например, конфигурации виртуальной машины**</span><span class="sxs-lookup"><span data-stu-id="ee19e-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="ee19e-341">Пример шаблона решения, определяющего возможности — Redis</span><span class="sxs-lookup"><span data-stu-id="ee19e-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="ee19e-342">tooshow как реализация может работать нормально, давайте взглянем на практический пример создания шаблона, которая позволяет hello развертывание и настройку Redis в стандартные размеры футболки.</span><span class="sxs-lookup"><span data-stu-id="ee19e-342">tooshow how an implementation might work, let's look at a practical example of building a template that facilitates hello deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="ee19e-343">Для развертывания hello существует ряд общих ресурсов (виртуальной сети, учетная запись хранения, группы доступности) и необязательно ресурсов (jumpbox).</span><span class="sxs-lookup"><span data-stu-id="ee19e-343">For hello deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="ee19e-344">Существует несколько известных конфигураций, представленных в рамках подхода «размеры футболки» (малая, средняя, большая), каждая с одним типом узла.</span><span class="sxs-lookup"><span data-stu-id="ee19e-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="ee19e-345">Кроме того, есть два соответствующих задаче скрипта (установка и настройка).</span><span class="sxs-lookup"><span data-stu-id="ee19e-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-hello-template-files"></a><span data-ttu-id="ee19e-346">Создание файлов шаблонов hello</span><span class="sxs-lookup"><span data-stu-id="ee19e-346">Creating hello template files</span></span>
<span data-ttu-id="ee19e-347">Будет создан основной шаблон с именем azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="ee19e-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="ee19e-348">Создание шаблона общих ресурсов с именем resources.json</span><span class="sxs-lookup"><span data-stu-id="ee19e-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="ee19e-349">Создайте дополнительный шаблон ресурсов развертывания hello tooenable jumpbox, с именем jumpbox_enabled.json</span><span class="sxs-lookup"><span data-stu-id="ee19e-349">You create an Optional Resource Template tooenable hello deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="ee19e-350">Redis использует только один тип узла, поэтому создается один шаблон элемента ресурсов с именем node-resources.json.</span><span class="sxs-lookup"><span data-stu-id="ee19e-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="ee19e-351">С помощью Redis tooinstall каждого отдельного узла, а затем задать hello кластера.</span><span class="sxs-lookup"><span data-stu-id="ee19e-351">With Redis, you want tooinstall each individual node, and then set up hello cluster.</span></span>  <span data-ttu-id="ee19e-352">Сценарии tooaccommodate hello Установка и настройка, redis кластера install.sh и redis кластера setup.sh.</span><span class="sxs-lookup"><span data-stu-id="ee19e-352">You have scripts tooaccommodate hello installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-hello-templates"></a><span data-ttu-id="ee19e-353">Связывание шаблонов hello</span><span class="sxs-lookup"><span data-stu-id="ee19e-353">Linking hello templates</span></span>
<span data-ttu-id="ee19e-354">Ссылки позволяют шаблона hello основной шаблон связывает out toohello общих ресурсов шаблона, который устанавливает hello виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="ee19e-354">Using template linking, hello main template links out toohello shared resources template, which establishes hello virtual network.</span></span>

<span data-ttu-id="ee19e-355">Логика добавляется внутри hello основного шаблона tooenable потребителей toospecify шаблона hello ли jumpbox должны развертываться.</span><span class="sxs-lookup"><span data-stu-id="ee19e-355">Logic is added within hello main template tooenable consumers of hello template toospecify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="ee19e-356">*Включен* значение hello *EnableJumpbox* параметр указывает, что hello клиенту toodeploy jumpbox.</span><span class="sxs-lookup"><span data-stu-id="ee19e-356">An *enabled* value for hello *EnableJumpbox* parameter indicates that hello customer wants toodeploy a jumpbox.</span></span> <span data-ttu-id="ee19e-357">Если это значение указано, объединяет hello шаблона *_enabled* как суффикс tooa базовый шаблон для возможности jumpbox hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-357">When this value is provided, hello template concatenates *_enabled* as a suffix tooa base template name for hello jumpbox capability.</span></span>

<span data-ttu-id="ee19e-358">Hello основной шаблон применяется hello *больших* значение параметра как суффикс tooa базовый шаблон для размер футболки, а затем использует это значение в ссылке шаблона out слишком*technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="ee19e-358">hello main template applies hello *large* parameter value as a suffix tooa base template name for t-shirt sizes, and then uses that value in a template link out too*technology_on_os_large.json*.</span></span>

<span data-ttu-id="ee19e-359">Топология Hello будет выглядеть следующим образом на этом рисунке.</span><span class="sxs-lookup"><span data-stu-id="ee19e-359">hello topology would resemble this illustration.</span></span>

![Шаблон Redis](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="ee19e-361">**Структура шаблона для шаблона Redis**</span><span class="sxs-lookup"><span data-stu-id="ee19e-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="ee19e-362">Настройка состояния</span><span class="sxs-lookup"><span data-stu-id="ee19e-362">Configuring state</span></span>
<span data-ttu-id="ee19e-363">Для hello узлов в кластере hello состоит из двух этапов состояние tooconfiguring hello, оба представленных скриптами определенной цели.</span><span class="sxs-lookup"><span data-stu-id="ee19e-363">For hello nodes in hello cluster, there are two steps tooconfiguring hello state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="ee19e-364">Redis устанавливает «install.sh redis кластера» и «setup.sh redis кластера» устанавливает hello кластера.</span><span class="sxs-lookup"><span data-stu-id="ee19e-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up hello cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="ee19e-365">Поддержка развертываний разных размеров</span><span class="sxs-lookup"><span data-stu-id="ee19e-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="ee19e-366">В переменных, шаблон размер футболки hello указывает hello количество узлов каждого типа toodeploy для hello указанный размер (*больших*).</span><span class="sxs-lookup"><span data-stu-id="ee19e-366">Inside variables, hello t-shirt size template specifies hello number of nodes of each type toodeploy for hello specified size (*large*).</span></span> <span data-ttu-id="ee19e-367">Затем он развертывает соответствующее количество экземпляров виртуальных Машин с помощью ресурсов циклы, предоставляя tooresources уникальные имена путем добавления имени узла с номером числовой последовательности из *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="ee19e-367">It then deploys that number of VM instances using resource loops, providing unique names tooresources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="ee19e-368">Как и следующие действия для обоих горячие "и" горячего зоны ВМ, как определено в шаблоне имя футболки hello</span><span class="sxs-lookup"><span data-stu-id="ee19e-368">It does these steps for both hot and warm zone VMs, as defined in hello t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="ee19e-369">Декомпозиция и шаблоны законченных решений</span><span class="sxs-lookup"><span data-stu-id="ee19e-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="ee19e-370">Шаблон решения, определяющий законченные решения, отвечает за предоставление законченного решения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="ee19e-371">Обычно такой шаблон представляет собой сочетание нескольких шаблонов заданных возможностей с дополнительными ресурсами, логикой и состоянием.</span><span class="sxs-lookup"><span data-stu-id="ee19e-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="ee19e-372">Как видно в приведенном ниже рисунке hello hello одной модели используется для возможности в области шаблонов расширяется для шаблонов с начала до конца область решения.</span><span class="sxs-lookup"><span data-stu-id="ee19e-372">As highlighted in hello image below, hello same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="ee19e-373">Общие ресурсы шаблон и дополнительные ресурсы, шаблоны служат hello одной функции, как и hello емкость и возможности области шаблона подходов, но относятся к tooend hello решениям.</span><span class="sxs-lookup"><span data-stu-id="ee19e-373">A Shared Resources Template and Optional Resources Templates serve hello same function as in hello capacity and capability scoped template approaches, but are scoped for hello end tooend solution.</span></span>

<span data-ttu-id="ee19e-374">Как решение tooend области шаблоны также обычно могут иметь размер футболки, hello известных ресурсов для настройки шаблона отражает то, которое требуется для заданной конфигурации известного решения hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-374">As end tooend solution scoped templates also can typically have t-shirt sizes, hello Known Configuration Resources template reflects what is required for a given known configuration of hello solution.</span></span>

<span data-ttu-id="ee19e-375">tooone ссылки Hello известные ресурсы шаблон конфигурации и дополнительные возможности в области Шаблоны решений, соответствующих toohello tooend решение, а также hello шаблоны членов ресурсов, которые необходимы для hello tooend решение.</span><span class="sxs-lookup"><span data-stu-id="ee19e-375">hello Known Configuration Resources Template links tooone or more capability scoped solution templates that are relevant toohello end tooend solution as well as hello Member Resource Templates that are required for hello end tooend solution.</span></span>

<span data-ttu-id="ee19e-376">Как размер футболки hello hello решения могут отличаться от hello отдельного шаблона уровня возможностей, переменные внутри hello известные шаблон конфигурации ресурсы, используемые tooprovide hello соответствующие значения для подчиненных возможность область решения шаблоны toodeploy hello соответствующий размер футболки.</span><span class="sxs-lookup"><span data-stu-id="ee19e-376">As hello t-shirt size of hello solution may be different than hello individual capability-scoped template, variables within hello Known Configuration Resources Template are used tooprovide hello appropriate values for downstream capability scoped solution templates toodeploy hello appropriate t-shirt size.</span></span>

![Законченное решение](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="ee19e-378">**используемая модель Hello емкости или возможность области Шаблоны решений можно легко расширена для области шаблона решения tooend end**</span><span class="sxs-lookup"><span data-stu-id="ee19e-378">**hello model used for capacity or capability scoped solution templates can be readily extended for end tooend solution template scopes**</span></span>

## <a name="preparing-templates-for-hello-marketplace"></a><span data-ttu-id="ee19e-379">Подготовка шаблонов для hello Marketplace</span><span class="sxs-lookup"><span data-stu-id="ee19e-379">Preparing templates for hello Marketplace</span></span>
<span data-ttu-id="ee19e-380">Hello легко предшествующий подход включает сценарии, где предприятий и хранилище единственных копий, Общие тома кластера должна tooeither развертывать шаблоны hello самостоятельно или включить их клиентам toodeploy сами по себе.</span><span class="sxs-lookup"><span data-stu-id="ee19e-380">hello preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want tooeither deploy hello templates themselves or enable their customers toodeploy on their own.</span></span>

<span data-ttu-id="ee19e-381">Другой требуемый сценарий выполняет развертывание шаблона через hello marketplace.</span><span class="sxs-lookup"><span data-stu-id="ee19e-381">Another desired scenario is deploying a template via hello marketplace.</span></span>  <span data-ttu-id="ee19e-382">Такой подход развернутого работает для marketplace hello, а также с некоторыми незначительными изменениями.</span><span class="sxs-lookup"><span data-stu-id="ee19e-382">This decomposition approach works for hello marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="ee19e-383">Как упоминалось ранее, шаблоны могут быть типами distinct развертывания используется toooffer для продажи в hello marketplace.</span><span class="sxs-lookup"><span data-stu-id="ee19e-383">As mentioned previously, templates can be used toooffer distinct deployment types for sale in hello marketplace.</span></span> <span data-ttu-id="ee19e-384">Разные типы развертываний могут быть представлены разными "размерами футболки" (малый, средний, большой), типом продукта и аудитории (сообщества, разработчики, организации) или типом функции (базовый, высокий уровень доступности).</span><span class="sxs-lookup"><span data-stu-id="ee19e-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="ee19e-385">Как показано ниже, hello существующих конечных tooend решения или возможность использования шаблонов в заданной области могут быть легко загруженные toolist hello различных известных конфигураций hello marketplace.</span><span class="sxs-lookup"><span data-stu-id="ee19e-385">As shown below, hello existing end tooend solution or capability scoped templates can be readily utilized toolist hello different known configurations in hello marketplace.</span></span>

<span data-ttu-id="ee19e-386">Hello главного шаблона toohello параметров сначала изменяются tooremove hello входящего параметра с именем tshirtSize.</span><span class="sxs-lookup"><span data-stu-id="ee19e-386">hello parameters toohello main template are first modified tooremove hello inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="ee19e-387">Хотя hello развертывания различных типов сопоставления toohello известные шаблон конфигурации ресурсов, им также необходимо hello общих ресурсов и конфигурация найдена в hello шаблон общих ресурсов и, возможно, их необязательно шаблонов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ee19e-387">While hello distinct deployment types map toohello Known Configuration Resources Template, they also need hello common resources and configuration found in hello Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="ee19e-388">Следует toopublish ваш marketplace toohello шаблона вы устанавливаете различных копий шаблоне Main, заменяет hello ранее доступный параметр входящих переменной tooa tshirtSize внедрен в шаблон hello.</span><span class="sxs-lookup"><span data-stu-id="ee19e-388">If you want toopublish your template toohello marketplace, you establish distinct copies of your Main template that replaces hello previously available inbound parameter of tshirtSize tooa variable embedded within hello template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="ee19e-390">**Адаптация решения области шаблона для hello marketplace**</span><span class="sxs-lookup"><span data-stu-id="ee19e-390">**Adapting a solution scoped template for hello marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="ee19e-391">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="ee19e-391">Next steps</span></span>
* <span data-ttu-id="ee19e-392">toolearn о общее состояние в действие и из шаблонов, в разделе [совместного использования состояния в шаблоны Azure Resource Manager](best-practices-resource-manager-state.md).</span><span class="sxs-lookup"><span data-stu-id="ee19e-392">toolearn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="ee19e-393">Для получения рекомендаций по как предприятия могут использовать диспетчер ресурсов tooeffectively управление подписками см. в разделе [корпоративные функции формирования шаблонов - управление конкретные подписки](resource-manager-subscription-governance.md).</span><span class="sxs-lookup"><span data-stu-id="ee19e-393">For guidance on how enterprises can use Resource Manager tooeffectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

