---
title: "aaaAzure данных Озера хранилище производительности рекомендации по настройке | Документы Microsoft"
description: "Рекомендации по настройке производительности Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: cgronlun
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 06/30/2017
ms.author: stewu
ms.openlocfilehash: 939faa068c0f81d18d9533956f4d336bc4d0cbe3
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="tuning-azure-data-lake-store-for-performance"></a>Настройка Azure Data Lake Store для повышения производительности

Data Lake Store поддерживает высокую пропускную способность при анализе с интенсивным использованием ввода-вывода и перемещением данных.  В хранилище Озера данных Azure использование всю доступную пропускную способность — hello объем данных, который может читать или записываемых за одну секунду — является важным tooget hello наилучшей производительности.  Для этого нужно выполнить как можно больше операций чтения и записи параллельно.

![Производительность Data Lake Store](./media/data-lake-store-performance-tuning-guidance/throughput.png)

Хранилище Озера данных Azure можно масштабировать tooprovide hello необходимые пропускной способности для всех analytics сценария. По умолчанию учетную запись хранилища Озера данных Azure предоставляет автоматически достаточную пропускную способность потребностей hello toomeet широкие категории вариантов использования. Для вариантов hello, где пользователи могут запускать в ограничение по умолчанию hello, hello ADLS учетной записи может быть более высокая пропускная способность настроенных tooprovide, обратившись в службу поддержки Майкрософт.

## <a name="data-ingestion"></a>Прием данных

При передаче данных из исходной системы tooADLS, очень важно, tooconsider, hello оборудования источника, исходного сетевого оборудования и tooADLS подключения к сети может быть узким местом hello.  

![Производительность Data Lake Store](./media/data-lake-store-performance-tuning-guidance/bottleneck.png)

Очень важно, что tooensure, hello перемещения данных не зависит от следующих факторов.

### <a name="source-hardware"></a>Исходное оборудование

При использовании локальных компьютеров или виртуальных машин в Azure, следует тщательно выберите соответствующее оборудование hello. Для источника дискового оборудования предпочтительно tooHDDs SSD и выберите дискового оборудования с шпинделей быстрее. Для источника сетевого оборудования используйте hello наивысшей сетевых адаптеров.  В Azure мы рекомендуем D14 виртуальных машинах Azure, имеющих hello соответствующим образом мощные диска и сетевого оборудования.

### <a name="network-connectivity-tooazure-data-lake-store"></a>Хранилище Озера данных tooAzure подключения к сети

Hello сетевое подключение между исходными данными и хранилище Озера данных Azure иногда может быть узким местом hello. Если исходные данные находятся в локальной среде, рекомендуется использовать выделенный канал с [Azure ExpressRoute](https://azure.microsoft.com/en-us/services/expressroute/). Если источник данных находится в Azure, производительности hello подойдет лучше всего, когда данные hello в hello же регионе Azure, что hello хранилища Озера данных.

### <a name="configure-data-ingestion-tools-for-maximum-parallelization"></a>Настройка средств приема данных для обеспечения максимальной параллелизации

После обращения к hello источника оборудования и сети узкие места подключения выше, вы являетесь готов tooconfigure ваши средства приема. Hello следующей таблице приведена сводка hello ключевых параметров несколько средств популярных приема и предоставляет подробные настройки статей для их производительности.  toolearn больше о том, какие средства toouse для конкретного сценария, посетите следующий [статьи](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-scenarios).

| Средство               | Параметры     | Дополнительные сведения                                                                 |
|--------------------|------------------------------------------------------|------------------------------|
| PowerShell       | PerFileThreadCount, ConcurrentFileCount |  [Ссылка](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-get-started-powershell#performance-guidance-while-using-powershell)   |
| AdlCopy    | Единицы измерения Azure Data Lake Analytics  |   [Ссылка](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-copy-data-azure-storage-blob#performance-considerations-for-using-adlcopy)         |
| DistCp            | -m (mapper)   | [Ссылка](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-copy-data-wasb-distcp#performance-considerations-while-using-distcp)                             |
| Фабрика данных Azure| parallelCopies    | [Ссылка](../data-factory/data-factory-copy-activity-performance.md)                          |
| Sqoop           | fs.azure.block.size, -m (mapper)    |   [Ссылка](https://blogs.msdn.microsoft.com/bigdatasupport/2015/02/17/sqoop-job-performance-tuning-in-hdinsight-hadoop/)        |

## <a name="structure-your-data-set"></a>Структура набора данных

Если данные хранятся в хранилище Озера данных, размер файла hello, число файлов и структуру папок оказывают влияние на производительность.  Hello следующем разделе описываются рекомендации в следующих областях.  

### <a name="file-size"></a>Размер файла

Как правило, у модулей аналитики, таких как HDInsight и Azure Data Lake Analytics, нагрузка зависит от количества файлов.  Если вы храните данные в большом количестве небольших файлов, это может отрицательно сказаться на производительности.  

Упорядочивайте свои данные в файлы большого размера для лучшей производительности.  Мы рекомендуем упорядочивать наборы данных в файлы размером 256 МБ или больше. В некоторых случаях, таких как изображения и двоичные данные, не возможные tooprocess их параллельно.  В таких случаях рекомендуется tookeep отдельных файлов не более 2 ГБ.

В некоторых случаях конвейеры данных полный контроль над hello необработанные данные, которые были большое количество небольших файлов.  Рекомендуется toohave «кулинарии» процесс, который приводит к возникновению ошибки большего размера файлов toouse для нисходящие приложения.  

### <a name="organizing-time-series-data-in-folders"></a>Упорядочение данных временных рядов в папках

Для рабочих нагрузок Hive и ADLA раздел при очистке данных временных рядов могут помочь некоторых запросов, читаемых только подмножество данных hello, что улучшает производительность.    

Конвейеры, принимающие данные временных рядов, часто помещают свои файлы с сильно структурированными именами файлов и папок. Ниже приведен обычный пример для данных, структурированных по дате:

    \DataSet\YYYY\MM\DD\datafile_YYYY_MM_DD.tsv

Обратите внимание, что данные datetime hello отображается как папки, а в параметре filename hello.

Для даты и времени hello ниже приведен общий шаблон

    \DataSet\YYYY\MM\DD\HH\mm\datafile_YYYY_MM_DD_HH_mm.tsv

Опять же, сделанный для организации файлов и папок hello Выбор hello следует оптимизировать hello размер файлов и разумного числа файлов в каждой папке.

## <a name="optimizing-io-intensive-jobs-on-hadoop-and-spark-workloads-on-hdinsight"></a>Оптимизация заданий с интенсивными вычислениями ввода-вывода для рабочих нагрузок Hadoop и Spark в HDInsight

Задания относятся к одному из следующих трех категорий hello:

* **Интенсивно использующие ЦП.**  Эти задания имеют долгое время вычисления с минимальным временем ввода-вывода.  Примеры включают машинное обучение и задания обработки естественных языков.  
* **С высоким объемом требуемой памяти.**  Эти задания используют большой объем памяти.  Примеры включают PageRank и задания аналитики в реальном времени.  
* **С большим количеством операций ввода-вывода.**  Эти задания большую часть своего времени выполняют операции ввода-вывода.  Распространенным примером является задание копирования, которое использует только операции чтения и записи.  Другие примеры задания подготовки данных, чтение большого объема данных, выполняет некоторые преобразования данных, а затем записывает hello задней toohello хранилища данных.  

следующие рекомендации Hello — только применимые tooI заданиями ввода/вывода служб с интенсивными вычислениями.

### <a name="general-considerations-for-an-hdinsight-cluster"></a>Общие рекомендации, связанные с кластером HDInsight

* **Поддерживаемые версии HDInsight.** Для повышения производительности рекомендуется используйте последний выпуск hello HDInsight.
* **Регионы.** Поместите хранилища Озера данных hello в hello же регионе, что кластер HDInsight hello.  

Кластер HDInsight An состоит из двух головных узлов и нескольких рабочих узлов. Каждый рабочий узел предоставляет определенное количество ядер и памяти, которое определяется hello типа ВМ.  При запуске задания, YARN очень согласователь ресурсов hello, выделяемый объем доступной памяти hello и контейнеры toocreate ядер.  Каждый контейнер запускается задание hello toocomplete необходимые задачи hello.  Контейнеры быстро запустить в tooprocess параллельных задач. Таким образом производительность повышается за счет выполнения максимально возможного количества контейнеров параллельно.

Существует три уровня в кластер HDInsight, которое может быть отлажена tooincrease hello число контейнеров и использовать всю доступную пропускную способность.  

* **Физический уровень**
* **Уровень YARN**
* **Уровень рабочей нагрузки**

### <a name="physical-layer"></a>Физический уровень

**Запустите кластер с большим количеством узлов и/или на виртуальной машине большего размера.**  Больший размер кластера позволит вам toorun дополнительные контейнеры YARN, как показано на рисунке hello.

![Производительность Data Lake Store](./media/data-lake-store-performance-tuning-guidance/VM.png)

**Используйте виртуальные машины с большей пропускной способностью сети.**  Hello объем пропускной способности сети может быть узким местом, если имеется меньше пропускной способности сети, чем пропускная способность хранилища Озера данных.  У различных виртуальных машин будет разная пропускная способность сети.  Выберите VM-тип, который имеет наибольший пропускную способность сети на hello.

### <a name="yarn-layer"></a>Уровень YARN

**Используйте контейнеры YARN меньшего размера.**  Уменьшить размер hello каждого toocreate контейнера YARN дополнительные контейнеры с hello такого же объема ресурсов.

![Производительность Data Lake Store](./media/data-lake-store-performance-tuning-guidance/small-containers.png)

В зависимости от рабочей нагрузки минимальный необходимый размер контейнера YARN будет иметься всегда. Если выбрать слишком маленький контейнер, у заданий будут возникать проблемы из-за нехватки памяти. Как правило, контейнеры YARN должны быть размером не менее 1 ГБ. Это обычные контейнеры YARN / 3GB toosee. Для некоторых рабочих нагрузок могут потребоваться контейнеры YARN большего размера.  

**Увеличьте количество ядер на контейнер YARN.**  Увеличьте число hello ядер, выделенных tooeach контейнера tooincrease hello число параллельных задач, которые выполняются в каждом контейнере.  Это работает для приложений, которые выполняют несколько задач на контейнер, например Spark.  Для приложений, например Hive использующие один поток находится в каждом контейнере улучшенной toohave несколько контейнеров, а не больше ядер на контейнер.   

### <a name="workload-layer"></a>Уровень рабочей нагрузки

**Используйте все доступные контейнеры.**  Набор hello число задач toobe равно или больше числа hello доступные контейнеры для всех ресурсов.

![Производительность Data Lake Store](./media/data-lake-store-performance-tuning-guidance/use-containers.png)

**Незавершенные задачи ресурсоемки.** Если у каждой задачи есть большой объем данных tooprocess, неудачного выполнения задачи приводит к дорогих повторных попыток.  Таким образом, существует более toocreate дополнительные задачи, каждый из которых обрабатывает небольшой объем данных.

В дополнение toohello Общие рекомендации, приведенные выше каждое приложение имеет tootune доступны различные параметры для данного конкретного приложения. hello параметры и ссылки tooget, работы с Настройка производительности для каждого приложения, перечислены в следующей таблице Hello.

| Рабочая нагрузка               | Параметр tooset задачи                                                         |
|--------------------|-------------------------------------------------------------------------------------|
| [Spark в HDInsight](data-lake-store-performance-tuning-spark.md)       | <ul><li>Num-executors</li><li>Executor-memory</li><li>Executor-cores</li></ul> |
| [Hive в HDInsight](data-lake-store-performance-tuning-hive.md)    | <ul><li>hive.tez.container.size</li></ul>         |
| [MapReduce в HDInsight](data-lake-store-performance-tuning-mapreduce.md)            | <ul><li>Mapreduce.map.memory</li><li>Mapreduce.job.maps</li><li>Mapreduce.reduce.memory</li><li>Mapreduce.job.reduces</li></ul> |
| [Storm в HDInsight](data-lake-store-performance-tuning-storm.md)| <ul><li>Количество рабочих процессов</li><li>Количество экземпляров исполнителей воронки</li><li>Количество экземпляров исполнителей сита </li><li>Количество задач воронки</li><li>Количество задач сита</li></ul>|

## <a name="see-also"></a>Дополнительные материалы
* [Обзор хранилища озера данных Azure](data-lake-store-overview.md)
* [Начало работы с аналитикой озера данных Azure](../data-lake-analytics/data-lake-analytics-get-started-portal.md)
