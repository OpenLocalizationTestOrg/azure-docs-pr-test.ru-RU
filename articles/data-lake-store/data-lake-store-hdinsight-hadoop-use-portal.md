---
title: "Создание кластеров Azure HDInsight, использующих Data Lake Store, с помощью портала Azure | Документация Майкрософт"
description: "Создание и использование кластеров HDInsight для работы с Azure Data Lake Store с помощью портала Azure."
services: data-lake-store,hdinsight
documentationcenter: 
author: nitinme
manager: jhubbard
editor: cgronlun
ms.assetid: a8c45a83-a8e3-4227-8b02-1bc1e1de6767
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 08/14/2017
ms.author: nitinme
ms.openlocfilehash: 9dd56efb89e07ea61ae431d1ea2accd721cd6502
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2017
---
# <a name="create-hdinsight-clusters-with-data-lake-store-by-using-the-azure-portal"></a><span data-ttu-id="d7acc-103">Создание кластеров HDInsight, использующих Data Lake Store, с помощью портала Azure</span><span class="sxs-lookup"><span data-stu-id="d7acc-103">Create HDInsight clusters with Data Lake Store by using the Azure portal</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="d7acc-104">Использование портала Azure</span><span class="sxs-lookup"><span data-stu-id="d7acc-104">Use the Azure portal</span></span>](data-lake-store-hdinsight-hadoop-use-portal.md)
> * [<span data-ttu-id="d7acc-105">Использование PowerShell (для хранилища по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="d7acc-105">Use PowerShell (for default storage)</span></span>](data-lake-store-hdinsight-hadoop-use-powershell-for-default-storage.md)
> * [<span data-ttu-id="d7acc-106">Использование PowerShell (для дополнительного хранилища)</span><span class="sxs-lookup"><span data-stu-id="d7acc-106">Use PowerShell (for additional storage)</span></span>](data-lake-store-hdinsight-hadoop-use-powershell.md)
> * [<span data-ttu-id="d7acc-107">Использование Resource Manager</span><span class="sxs-lookup"><span data-stu-id="d7acc-107">Use Resource Manager</span></span>](data-lake-store-hdinsight-hadoop-use-resource-manager-template.md)
>
>

<span data-ttu-id="d7acc-108">Узнайте, как использовать портал Azure для создания кластера HDInsight с учетной записью Azure Data Lake Store в качестве хранилища по умолчанию или дополнительного хранилища.</span><span class="sxs-lookup"><span data-stu-id="d7acc-108">Learn how to use the Azure portal to create a HDInsight cluster with an Azure Data Lake Store account as the default storage or an additional storage.</span></span> <span data-ttu-id="d7acc-109">Хотя дополнительное хранилище для кластера HDInsight является необязательным, бизнес-данные рекомендуется хранить в дополнительных учетных записях хранения.</span><span class="sxs-lookup"><span data-stu-id="d7acc-109">Even though additional storage is optional for a HDInsight cluster, it is recommended to store your business data in the additional storage accounts.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="d7acc-110">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="d7acc-110">Prerequisites</span></span>
<span data-ttu-id="d7acc-111">Прежде чем приступить к изучению этого руководства, убедитесь, что выполнены следующие требования.</span><span class="sxs-lookup"><span data-stu-id="d7acc-111">Before you begin this tutorial, ensure that you've met the following requirements:</span></span>

* <span data-ttu-id="d7acc-112">**Подписка Azure**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-112">**An Azure subscription**.</span></span> <span data-ttu-id="d7acc-113">Перейдите на сайт [бесплатной пробной версии Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="d7acc-113">Go to [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="d7acc-114">**Учетная запись Azure Data Lake Store.**</span><span class="sxs-lookup"><span data-stu-id="d7acc-114">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="d7acc-115">Следуйте инструкциям в статье [Начало работы с Azure Data Lake Store с помощью портала Azure](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="d7acc-115">Follow the instructions from [Get started with Azure Data Lake Store by using the Azure portal](data-lake-store-get-started-portal.md).</span></span> <span data-ttu-id="d7acc-116">В учетной записи также необходимо создать корневую папку.</span><span class="sxs-lookup"><span data-stu-id="d7acc-116">You must also create a root folder on the account.</span></span>  <span data-ttu-id="d7acc-117">В этом учебнике используется корневая папка __/clusters__.</span><span class="sxs-lookup"><span data-stu-id="d7acc-117">In this tutorial, a root folder called __/clusters__ is used.</span></span>
* <span data-ttu-id="d7acc-118">**Субъект-служба Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-118">**An Azure Active Directory service principal**.</span></span> <span data-ttu-id="d7acc-119">В этом руководстве приведены инструкции по созданию субъекта-службы в Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="d7acc-119">This tutorial provides instructions on how to create a service principal in Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="d7acc-120">Чтобы создать субъект-службу, необходимо быть администратором Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d7acc-120">However, to create a service principal, you must be an Azure AD administrator.</span></span> <span data-ttu-id="d7acc-121">Если вы являетесь администратором, то можете пропустить это предварительное требование и продолжить работу с руководством.</span><span class="sxs-lookup"><span data-stu-id="d7acc-121">If you are an administrator, you can skip this prerequisite and proceed with the tutorial.</span></span>

    >[!NOTE]
    ><span data-ttu-id="d7acc-122">Создать субъект-службу может только администратор Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d7acc-122">You can create a service principal only if you are an Azure AD administrator.</span></span> <span data-ttu-id="d7acc-123">Администратор Azure AD должен сначала создать субъект-службу, после чего вы сможете создать кластер HDInsight, использующий Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-123">Your Azure AD administrator must create a service principal before you can create an HDInsight cluster with Data Lake Store.</span></span> <span data-ttu-id="d7acc-124">При создании субъекта-службы также необходимо использовать сертификат, как описано в разделе [Создание субъекта-службы с использованием сертификата](../azure-resource-manager/resource-group-authenticate-service-principal.md#create-service-principal-with-self-signed-certificate).</span><span class="sxs-lookup"><span data-stu-id="d7acc-124">Also, the service principal must be created with a certificate, as described at [Create a service principal with certificate](../azure-resource-manager/resource-group-authenticate-service-principal.md#create-service-principal-with-self-signed-certificate).</span></span>
    >

## <a name="create-an-hdinsight-cluster"></a><span data-ttu-id="d7acc-125">Создание кластера HDInsight</span><span class="sxs-lookup"><span data-stu-id="d7acc-125">Create an HDInsight cluster</span></span>

<span data-ttu-id="d7acc-126">В этом разделе вы создадите кластер HDInsight с учетными записями Data Lake Store в качестве хранилища по умолчанию или дополнительного хранилища.</span><span class="sxs-lookup"><span data-stu-id="d7acc-126">In this section, you create a HDInsight cluster with Data Lake Store accounts as the default or the additional storage.</span></span> <span data-ttu-id="d7acc-127">В этой статье описывается только часть процесса настройки учетных записей Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-127">This article only focuses the part of configuring Data Lake Store accounts.</span></span>  <span data-ttu-id="d7acc-128">Общие сведения о создании кластеров и соответствующие процедуры см. в статье [Создание кластеров Hadoop в HDInsight](../hdinsight/hdinsight-hadoop-provision-linux-clusters.md).</span><span class="sxs-lookup"><span data-stu-id="d7acc-128">For the general cluster creation information and procedures, see [Create Hadoop clusters in HDInsight](../hdinsight/hdinsight-hadoop-provision-linux-clusters.md).</span></span>

### <a name="create-a-cluster-with-data-lake-store-as-default-storage"></a><span data-ttu-id="d7acc-129">Создание кластера HDInsight, использующего Data Lake Store в качестве хранилища по умолчанию</span><span class="sxs-lookup"><span data-stu-id="d7acc-129">Create a cluster with Data Lake Store as default storage</span></span>

<span data-ttu-id="d7acc-130">**Создание кластера HDInsight с Data Lake Store в качестве учетной записи хранения по умолчанию**</span><span class="sxs-lookup"><span data-stu-id="d7acc-130">**To create a HDInsight cluster with a Data Lake Store as the default storage account**</span></span>

1. <span data-ttu-id="d7acc-131">Войдите на [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="d7acc-131">Sign in to the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="d7acc-132">Общие сведения о создании кластеров HDInsight см. в разделе [Создание кластеров](../hdinsight/hdinsight-hadoop-create-linux-clusters-portal.md#create-clusters).</span><span class="sxs-lookup"><span data-stu-id="d7acc-132">Follow [Create clusters](../hdinsight/hdinsight-hadoop-create-linux-clusters-portal.md#create-clusters) for the general information on creating HDInsight clusters.</span></span>
3. <span data-ttu-id="d7acc-133">В колонке **Хранилище** в разделе **Тип первичного хранилища** выберите **Data Lake Store**, а затем введите указанные ниже сведения.</span><span class="sxs-lookup"><span data-stu-id="d7acc-133">On the **Storage** blade, under **Primary storage type**, select **Data Lake Store**, and then enter the following information:</span></span>

    <span data-ttu-id="d7acc-134">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.1.adls.storage.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-134">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.1.adls.storage.png "Add service principal to HDInsight cluster")</span></span>

    - <span data-ttu-id="d7acc-135">**Выбрать учетную запись Data Lake Store**: выберите существующую учетную запись Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-135">**Select Data Lake Store account**: Select an existing Data Lake Store account.</span></span> <span data-ttu-id="d7acc-136">Требуется существующая учетная запись Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-136">An existing Data Lake Store account is required.</span></span>  <span data-ttu-id="d7acc-137">См. раздел [Предварительные требования](#prereuisites).</span><span class="sxs-lookup"><span data-stu-id="d7acc-137">See [Prerequisites](#prereuisites).</span></span>
    - <span data-ttu-id="d7acc-138">**Корневой путь**: введите путь к каталогу, в котором будут храниться файлы, связанные с кластером.</span><span class="sxs-lookup"><span data-stu-id="d7acc-138">**Root path**: Enter a path where the cluster-specific files are to be stored.</span></span> <span data-ttu-id="d7acc-139">На снимке экрана это путь __/clusters/myhdiadlcluster/__, в котором должна существовать папка __/clusters__ и в котором портал создает папку *myhdicluster*.</span><span class="sxs-lookup"><span data-stu-id="d7acc-139">On the screenshot, it is __/clusters/myhdiadlcluster/__, in which the __/clusters__ folder must exist, and the Portal creates *myhdicluster* folder.</span></span>  <span data-ttu-id="d7acc-140">*myhdicluster* — это имя кластера.</span><span class="sxs-lookup"><span data-stu-id="d7acc-140">The *myhdicluster* is the cluster name.</span></span>
    - <span data-ttu-id="d7acc-141">**Доступ к Data Lake Store**: настройте доступ между учетной записью Data Lake Store и кластером HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d7acc-141">**Data Lake Store access**: Configure access between the Data Lake Store account and HDInsight cluster.</span></span> <span data-ttu-id="d7acc-142">Инструкции см. в разделе [Настройка доступа к Data Lake Store](#configure-data-lake-store-access).</span><span class="sxs-lookup"><span data-stu-id="d7acc-142">For instructions, see [Configure Data Lake Store access](#configure-data-lake-store-access).</span></span>
    - <span data-ttu-id="d7acc-143">**Дополнительные учетные записи хранения**: добавьте учетные записи хранения Azure в качестве дополнительных учетных записей хранения для кластера.</span><span class="sxs-lookup"><span data-stu-id="d7acc-143">**Additional storage accounts**: Add Azure Storage Accounts as additional storage accounts for the cluster.</span></span> <span data-ttu-id="d7acc-144">Добавление дополнительных хранилищ Data Lake Store осуществляется путем предоставления разрешений на доступ к данным в кластере дополнительным учетным записям Data Lake Store. При этом учетная запись Data Lake Store настраивается в качестве основного типа хранилища.</span><span class="sxs-lookup"><span data-stu-id="d7acc-144">To add additional Data Lake Stores is done by giving the cluster permissions on data in more Data Lake Store accounts while configuring a Data Lake Store account as the primary storage type.</span></span> <span data-ttu-id="d7acc-145">См. раздел [Настройка доступа к Data Lake Store](#configure-data-lake-store-access).</span><span class="sxs-lookup"><span data-stu-id="d7acc-145">See [Configure Data Lake Store access](#configure-data-lake-store-access).</span></span>

4. <span data-ttu-id="d7acc-146">В колонке **Доступ к Data Lake Store** нажмите кнопку **Выбрать** и продолжайте создание кластера, как описано в статье [Создание кластеров под управлением Linux в HDInsight с помощью портала Azure](../hdinsight/hdinsight-hadoop-create-linux-clusters-portal.md).</span><span class="sxs-lookup"><span data-stu-id="d7acc-146">On the **Data Lake Store access**, click **Select**, and then continue with cluster creation as described in [Create Hadoop clusters in HDInsight](../hdinsight/hdinsight-hadoop-create-linux-clusters-portal.md).</span></span>


### <a name="create-a-cluster-with-data-lake-store-as-additional-storage"></a><span data-ttu-id="d7acc-147">Создание кластера HDInsight, использующего Data Lake Store в качестве дополнительного хранилища</span><span class="sxs-lookup"><span data-stu-id="d7acc-147">Create a cluster with Data Lake Store as additional storage</span></span>

<span data-ttu-id="d7acc-148">Ниже приведены инструкции по созданию кластера HDInsight с учетной записью хранения Azure в качестве хранилища по умолчанию и учетной записью Data Lake Store в качестве дополнительного хранилища.</span><span class="sxs-lookup"><span data-stu-id="d7acc-148">The following instructions create a HDInsight cluster with an Azure Storage account as the default storage, and a Data Lake Store account as an additional storage.</span></span>
<span data-ttu-id="d7acc-149">**Создание кластера HDInsight с Data Lake Store в качестве учетной записи хранения по умолчанию**</span><span class="sxs-lookup"><span data-stu-id="d7acc-149">**To create a HDInsight cluster with a Data Lake Store as the default storage account**</span></span>

1. <span data-ttu-id="d7acc-150">Войдите на [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="d7acc-150">Sign in to the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="d7acc-151">Общие сведения о создании кластеров HDInsight см. в разделе [Создание кластеров](../hdinsight/hdinsight-hadoop-create-linux-clusters-portal.md#create-clusters).</span><span class="sxs-lookup"><span data-stu-id="d7acc-151">Follow [Create clusters](../hdinsight/hdinsight-hadoop-create-linux-clusters-portal.md#create-clusters) for the general information on creating HDInsight clusters.</span></span>
3. <span data-ttu-id="d7acc-152">В колонке **Хранилище** в разделе **Тип первичного хранилища** выберите **Хранилище Azure**, а затем введите указанные ниже сведения.</span><span class="sxs-lookup"><span data-stu-id="d7acc-152">On the **Storage** blade, under **Primary storage type**, select **Azure Storage**, and then enter the following information:</span></span>

    <span data-ttu-id="d7acc-153">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.1.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-153">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.1.png "Add service principal to HDInsight cluster")</span></span>

    - <span data-ttu-id="d7acc-154">**Метод выбора**: выберите один из указанных ниже вариантов.</span><span class="sxs-lookup"><span data-stu-id="d7acc-154">**Selection method**: use one of the following options:</span></span>

        * <span data-ttu-id="d7acc-155">Выберите **Мои подписки**, чтобы указать учетную запись хранения, которая является частью вашей подписки Azure, а затем выберите учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="d7acc-155">To specify a storage account that is part of your Azure subscription, select **My subscriptions**, and then select the storage account.</span></span>
        * <span data-ttu-id="d7acc-156">Чтобы указать учетную запись хранения, не входящую в вашу подписку Azure, выберите **Ключ доступа**, а затем введите данные внешней учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="d7acc-156">To specify a storage account that is outside your Azure subscription, select **Access key**, and then provide the information for the outside storage account.</span></span>

    - <span data-ttu-id="d7acc-157">**Контейнер по умолчанию**: используйте значение по умолчанию или укажите собственное имя.</span><span class="sxs-lookup"><span data-stu-id="d7acc-157">**Default container**: use either the default value or specify your own name.</span></span>

    - <span data-ttu-id="d7acc-158">"Дополнительные учетные записи хранения": добавьте учетные записи хранения Azure в качестве дополнительного хранилища.</span><span class="sxs-lookup"><span data-stu-id="d7acc-158">Additional Storage accounts: add more Azure Storage accounts as the additional storage.</span></span>
    - <span data-ttu-id="d7acc-159">"Доступ к Data Lake Store": настройте доступ между учетной записью Data Lake Store и кластером HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d7acc-159">Data Lake Store access: configure access between the Data Lake Store account and HDInsight cluster.</span></span> <span data-ttu-id="d7acc-160">Инструкции см. в разделе [Настройка доступа к Data Lake Store](#configure-data-lake-store-access).</span><span class="sxs-lookup"><span data-stu-id="d7acc-160">For instructions see [Configure Data Lake Store access](#configure-data-lake-store-access).</span></span>

## <a name="configure-data-lake-store-access"></a><span data-ttu-id="d7acc-161">Настройка доступа к Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="d7acc-161">Configure Data Lake Store access</span></span> 

<span data-ttu-id="d7acc-162">В этом разделе вы настроите доступ к Data Lake Store из кластеров HDInsight с помощью субъекта-службы Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d7acc-162">In this section, you configure Data Lake Store access from HDInsight clusters using an Azure Active Directory service principal.</span></span> 

### <a name="specify-a-service-principal"></a><span data-ttu-id="d7acc-163">Указание субъекта-службы</span><span class="sxs-lookup"><span data-stu-id="d7acc-163">Specify a service principal</span></span>

<span data-ttu-id="d7acc-164">На портале Azure можно использовать существующий субъект-службу или создать новый.</span><span class="sxs-lookup"><span data-stu-id="d7acc-164">From the Azure portal, you can either use an existing service principal or create a new one.</span></span>

<span data-ttu-id="d7acc-165">**Создание субъекта-службы на портале Azure**</span><span class="sxs-lookup"><span data-stu-id="d7acc-165">**To create a service principal from the Azure portal**</span></span>

1. <span data-ttu-id="d7acc-166">В колонке "Хранилище" щелкните **Доступ к Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-166">Click **Data Lake Store access** from the Store blade.</span></span>
2. <span data-ttu-id="d7acc-167">В колонке **Доступ к Data Lake Store** щелкните **Создать**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-167">On the **Data Lake Store access** blade, click **Create new**.</span></span>
3. <span data-ttu-id="d7acc-168">Щелкните **Субъект-служба**, а затем выполните инструкции по созданию участника-службы.</span><span class="sxs-lookup"><span data-stu-id="d7acc-168">Click **Service Principal**, and then follow the instructions to create a service principal.</span></span>
4. <span data-ttu-id="d7acc-169">Скачайте сертификат, если его потребуется использовать в будущем.</span><span class="sxs-lookup"><span data-stu-id="d7acc-169">Download the certificate if you decide to use it again in the future.</span></span> <span data-ttu-id="d7acc-170">Скачать сертификат удобно, если вы холите использовать этот же субъект-службу для создания дополнительных кластеров HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d7acc-170">Downloading the certificate is useful if you want to use the same service principal when you create additional HDInsight clusters.</span></span>

    <span data-ttu-id="d7acc-171">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.2.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-171">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.2.png "Add service principal to HDInsight cluster")</span></span>

4. <span data-ttu-id="d7acc-172">Щелкните **Доступ**, чтобы настроить доступ к папке.</span><span class="sxs-lookup"><span data-stu-id="d7acc-172">Click **Access** to configure the folder access.</span></span>  <span data-ttu-id="d7acc-173">См. раздел [Настройка разрешений для файлов](#configure-file-permissions).</span><span class="sxs-lookup"><span data-stu-id="d7acc-173">See [Configure file permissions](#configure-file-permissions).</span></span>


<span data-ttu-id="d7acc-174">**Использование существующего субъекта-службы на портале Azure**</span><span class="sxs-lookup"><span data-stu-id="d7acc-174">**To use an existing service principal from the Azure portal**</span></span>

1. <span data-ttu-id="d7acc-175">Щелкните **Доступ к Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-175">Click **Data Lake Store access**.</span></span>
1. <span data-ttu-id="d7acc-176">В колонке **Доступ к Data Lake Store** щелкните **Использовать существующий**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-176">On the **Data Lake Store access** blade, click **Use existing**.</span></span>
2. <span data-ttu-id="d7acc-177">Щелкните **Субъект-служба**, а затем выберите субъект-службу.</span><span class="sxs-lookup"><span data-stu-id="d7acc-177">Click **Service Principal**, and then select a service principal.</span></span> 
3. <span data-ttu-id="d7acc-178">Отправьте связанный с выбранным субъектом-службой сертификат (PFX-файл) и введите пароль этого сертификата.</span><span class="sxs-lookup"><span data-stu-id="d7acc-178">Upload the certificate (.pfx file) that's associated with your selected service principal, and then enter the certificate password.</span></span>

    <span data-ttu-id="d7acc-179">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.5.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-179">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.5.png "Add service principal to HDInsight cluster")</span></span>

4. <span data-ttu-id="d7acc-180">Щелкните **Доступ**, чтобы настроить доступ к папке.</span><span class="sxs-lookup"><span data-stu-id="d7acc-180">Click **Access** to configure the folder access.</span></span>  <span data-ttu-id="d7acc-181">См. раздел [Настройка разрешений для файлов](#configure-file-permissions).</span><span class="sxs-lookup"><span data-stu-id="d7acc-181">See [Configure file permissions](#configure-file-permissions).</span></span>


### <span data-ttu-id="d7acc-182"><a name="configure-file-permissions"></a>Настройка разрешений для файлов</span><span class="sxs-lookup"><span data-stu-id="d7acc-182"><a name="configure-file-permissions"></a>Configure file permissions</span></span>

<span data-ttu-id="d7acc-183">Настройки зависят от того, используется ли учетная запись как хранилище по умолчанию или как дополнительная учетная запись хранения.</span><span class="sxs-lookup"><span data-stu-id="d7acc-183">The configures are different depending on whether the account is used as the default storage or an additional storage account:</span></span>

- <span data-ttu-id="d7acc-184">В качестве хранилища по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="d7acc-184">Used as default storage</span></span>

    - <span data-ttu-id="d7acc-185">разрешение на корневом уровне учетной записи Data Lake Store;</span><span class="sxs-lookup"><span data-stu-id="d7acc-185">permission at the root level of the Data Lake Store account</span></span>
    - <span data-ttu-id="d7acc-186">разрешение на корневом уровне хранилища кластера HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d7acc-186">permission at the root level of the HDInsight cluster storage.</span></span> <span data-ttu-id="d7acc-187">Например, в этом учебнике это папка __/clusters__.</span><span class="sxs-lookup"><span data-stu-id="d7acc-187">For example, the __/clusters__ folder used earlier in the tutorial.</span></span>
- <span data-ttu-id="d7acc-188">В качестве дополнительного хранилища:</span><span class="sxs-lookup"><span data-stu-id="d7acc-188">Use as an additional storage</span></span>

    - <span data-ttu-id="d7acc-189">разрешение на доступ к папкам, в которых находятся требуемые файлы.</span><span class="sxs-lookup"><span data-stu-id="d7acc-189">Permission at the folders where you need file access.</span></span>

<span data-ttu-id="d7acc-190">**Назначение разрешения на корневом уровне учетной записи Data Lake Store**</span><span class="sxs-lookup"><span data-stu-id="d7acc-190">**To assign permission at the Data Lake Store account root level**</span></span>

1. <span data-ttu-id="d7acc-191">В колонке **Доступ к Data Lake Store** щелкните **Доступ**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-191">On the **Data Lake Store access** blade, click **Access**.</span></span> <span data-ttu-id="d7acc-192">Откроется колонка **Выбор разрешений для файла**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-192">The **Select file permissions** blade is opened.</span></span> <span data-ttu-id="d7acc-193">В ней отображены все учетные записи Data Lake Store в вашей подписке.</span><span class="sxs-lookup"><span data-stu-id="d7acc-193">It lists all the Data Lake Store accounts in your subscription.</span></span>
2. <span data-ttu-id="d7acc-194">Наведите указатель мыши (но не щелкайте) на имя учетной записи Data Lake Store, чтобы отобразился флажок, а затем установите этот флажок.</span><span class="sxs-lookup"><span data-stu-id="d7acc-194">Hover (do not click) the mouse over the name of the Data Lake Store account to make the check box visible, then select the check box.</span></span>

    <span data-ttu-id="d7acc-195">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.3.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-195">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.3.png "Add service principal to HDInsight cluster")</span></span>

  <span data-ttu-id="d7acc-196">По умолчанию выбраны разрешения __Чтение__, __Запись__ и __Выполнение__.</span><span class="sxs-lookup"><span data-stu-id="d7acc-196">By default, __READ__, __WRITE__, AND __EXECUTE__ are all selected.</span></span>

3. <span data-ttu-id="d7acc-197">В нижней части страницы щелкните **Выбрать**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-197">Click **Select** on the bottom of the page.</span></span>
4. <span data-ttu-id="d7acc-198">Чтобы назначить разрешение, щелкните **Выполнить**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-198">Click **Run** to assign permission.</span></span>
5. <span data-ttu-id="d7acc-199">Нажмите кнопку **Done**(Готово).</span><span class="sxs-lookup"><span data-stu-id="d7acc-199">Click **Done**.</span></span>

<span data-ttu-id="d7acc-200">**Назначение разрешения на корневом уровне кластера HDInsight**</span><span class="sxs-lookup"><span data-stu-id="d7acc-200">**To assign permission at the HDInsight cluster root level**</span></span>

1. <span data-ttu-id="d7acc-201">В колонке **Доступ к Data Lake Store** щелкните **Доступ**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-201">On the **Data Lake Store access** blade, click **Access**.</span></span> <span data-ttu-id="d7acc-202">Откроется колонка **Выбор разрешений для файла**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-202">The **Select file permissions** blade is opened.</span></span> <span data-ttu-id="d7acc-203">В ней отображены все учетные записи Data Lake Store в вашей подписке.</span><span class="sxs-lookup"><span data-stu-id="d7acc-203">It lists all the Data Lake Store accounts in your subscription.</span></span>
1. <span data-ttu-id="d7acc-204">В колонке **Выбор разрешений для файла** щелкните имя хранилища Data Lake Store, чтобы увидеть его содержимое.</span><span class="sxs-lookup"><span data-stu-id="d7acc-204">From the **Select file permissions** blade, click the Data Lake Store name to show its content.</span></span>
2. <span data-ttu-id="d7acc-205">Выберите корень хранилища кластера HDInsight, установив флажок слева от папки.</span><span class="sxs-lookup"><span data-stu-id="d7acc-205">Select the HDInsight cluster storage root by selecting the checkbox on the left of the folder.</span></span> <span data-ttu-id="d7acc-206">В соответствии с предыдущим снимком экрана корнем хранилища кластера является папка __/clusters__, указанная при выборе Data Lake Store в качестве хранилища по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d7acc-206">According to the screenshot earlier, the cluster storage root is __/clusters__ folder that you specified while selecting the Data Lake Store as default storage.</span></span>
3. <span data-ttu-id="d7acc-207">Задайте разрешения для папки.</span><span class="sxs-lookup"><span data-stu-id="d7acc-207">Set the permissions on the folder.</span></span>  <span data-ttu-id="d7acc-208">По умолчанию выбраны разрешения на чтение, запись и выполнение.</span><span class="sxs-lookup"><span data-stu-id="d7acc-208">By default, read, write, and execute are all selected.</span></span>
4. <span data-ttu-id="d7acc-209">В нижней части страницы щелкните **Выбрать**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-209">Click **Select** on the bottom of the page.</span></span>
5. <span data-ttu-id="d7acc-210">Щелкните **Выполнить**.</span><span class="sxs-lookup"><span data-stu-id="d7acc-210">Click **Run**.</span></span>
6. <span data-ttu-id="d7acc-211">Нажмите кнопку **Done**(Готово).</span><span class="sxs-lookup"><span data-stu-id="d7acc-211">Click **Done**.</span></span>

<span data-ttu-id="d7acc-212">При использовании Data Lake Store в качестве дополнительного хранилища необходимо назначить разрешение только для папок, к которым нужен доступ из кластера HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d7acc-212">If you are using Data Lake Store as additional storage, you must assign permission only for the folders that you want to access from the HDInsight cluster.</span></span> <span data-ttu-id="d7acc-213">Например, на снимке экрана ниже предоставляется доступ только к папке **hdiaddonstorage** в учетной записи Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-213">For example, in the screenshot below, you provide access only to **hdiaddonstorage** folder in a Data Lake Store account.</span></span>

<span data-ttu-id="d7acc-214">![Назначение разрешений субъекта-службы для кластера HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.3-1.png "Назначение разрешений субъекта-службы для кластера HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-214">![Assign service principal permissions to the HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.3-1.png "Assign service principal permissions to the HDInsight cluster")</span></span>


## <a name="verify-cluster-set-up"></a><span data-ttu-id="d7acc-215">Проверка настроек кластера</span><span class="sxs-lookup"><span data-stu-id="d7acc-215">Verify cluster set up</span></span>

<span data-ttu-id="d7acc-216">После завершения настройки кластера проверьте результат в колонке кластера, выполнив одно или оба указанных ниже действия.</span><span class="sxs-lookup"><span data-stu-id="d7acc-216">After the cluster setup is complete, on the cluster blade, verify your results by doing either or both of the following steps:</span></span>

* <span data-ttu-id="d7acc-217">Чтобы проверить, является ли указанная вами учетная запись Data Lake Store связанным хранилищем для кластера, щелкните **Учетные записи хранения** в левой области.</span><span class="sxs-lookup"><span data-stu-id="d7acc-217">To verify that the associated storage for the cluster is the Data Lake Store account that you specified, click **Storage accounts** in the left pane.</span></span>

    <span data-ttu-id="d7acc-218">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.6-1.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-218">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.6-1.png "Add service principal to HDInsight cluster")</span></span>

* <span data-ttu-id="d7acc-219">Чтобы проверить, правильно ли связан субъект-служба с кластером HDInsight, щелкните **Доступ к Data Lake Store** в левой области.</span><span class="sxs-lookup"><span data-stu-id="d7acc-219">To verify that the service principal is correctly associated with the HDInsight cluster, click **Data Lake Store access** in the left pane.</span></span>

    <span data-ttu-id="d7acc-220">![Добавление субъекта-службы в кластер HDInsight](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.6.png "Добавление субъекта-службы в кластер HDInsight")</span><span class="sxs-lookup"><span data-stu-id="d7acc-220">![Add service principal to HDInsight cluster](./media/data-lake-store-hdinsight-hadoop-use-portal/hdi.adl.6.png "Add service principal to HDInsight cluster")</span></span>


## <a name="examples"></a><span data-ttu-id="d7acc-221">Примеры</span><span class="sxs-lookup"><span data-stu-id="d7acc-221">Examples</span></span>

<span data-ttu-id="d7acc-222">Настроив кластер для работы с Data Lake Store в качестве хранилища, вы можете изучить следующие примеры использования кластера HDInsight для анализа данных, хранимых в Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-222">After you have set up the cluster with Data Lake Store as your storage, refer to these examples of how to use HDInsight cluster to analyze the data that's stored in Data Lake Store.</span></span>

### <a name="run-a-hive-query-against-data-in-a-data-lake-store-as-primary-storage"></a><span data-ttu-id="d7acc-223">Выполнение запроса Hive к данным, хранящимся в Data Lake Store (основное хранилище)</span><span class="sxs-lookup"><span data-stu-id="d7acc-223">Run a Hive query against data in a Data Lake Store (as primary storage)</span></span>

<span data-ttu-id="d7acc-224">Чтобы выполнить запрос Hive, используйте интерфейс представлений Hive, доступный на портале Ambari.</span><span class="sxs-lookup"><span data-stu-id="d7acc-224">To run a Hive query, use the Hive views interface in the Ambari portal.</span></span> <span data-ttu-id="d7acc-225">Инструкции по использованию представлений Ambari Hive см. в статье [Использование представления Hive с Hadoop в HDInsight](../hdinsight/hdinsight-hadoop-use-hive-ambari-view.md).</span><span class="sxs-lookup"><span data-stu-id="d7acc-225">For instructions on how to use Ambari Hive views, see [Use the Hive View with Hadoop in HDInsight](../hdinsight/hdinsight-hadoop-use-hive-ambari-view.md).</span></span>

<span data-ttu-id="d7acc-226">При работе с данными в Data Lake Store изменить можно лишь несколько строк.</span><span class="sxs-lookup"><span data-stu-id="d7acc-226">When you work with data in a Data Lake Store, there are a few strings to change.</span></span>

<span data-ttu-id="d7acc-227">Например, если вы используете созданный кластер, в котором основным хранилищем является Data Lake Store, то путь к данным будет следующим: *adl://<учентая_запись_Data_Lake_Store>/azuredatalakestore.net/<путь_к_файлу>*.</span><span class="sxs-lookup"><span data-stu-id="d7acc-227">If you use, for example, the cluster that you created with Data Lake Store as primary storage, the path to the data is: *adl://<data_lake_store_account_name>/azuredatalakestore.net/path/to/file*.</span></span> <span data-ttu-id="d7acc-228">Запрос Hive для создания таблицы на основе демонстрационных данных, хранящихся в учетной записи Data Lake Store, выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="d7acc-228">A Hive query to create a table from sample data that's stored in the Data Lake Store account looks like the following statement:</span></span>

    CREATE EXTERNAL TABLE websitelog (str string) LOCATION 'adl://hdiadlsstorage.azuredatalakestore.net/clusters/myhdiadlcluster/HdiSamples/HdiSamples/WebsiteLogSampleData/SampleLog/'

<span data-ttu-id="d7acc-229">Описание</span><span class="sxs-lookup"><span data-stu-id="d7acc-229">Descriptions:</span></span>
* <span data-ttu-id="d7acc-230">`adl://hdiadlstorage.azuredatalakestore.net/` — корневой элемент учетной записи Data Lake Store;</span><span class="sxs-lookup"><span data-stu-id="d7acc-230">`adl://hdiadlstorage.azuredatalakestore.net/` is the root of the Data Lake Store account.</span></span>
* <span data-ttu-id="d7acc-231">`/clusters/myhdiadlcluster` — корень данных кластера, указанный при создании кластера;</span><span class="sxs-lookup"><span data-stu-id="d7acc-231">`/clusters/myhdiadlcluster` is the root of the cluster data that you specified while creating the cluster.</span></span>
* <span data-ttu-id="d7acc-232">`/HdiSamples/HdiSamples/WebsiteLogSampleData/SampleLog/` — расположение примера файла, который используется в запросе.</span><span class="sxs-lookup"><span data-stu-id="d7acc-232">`/HdiSamples/HdiSamples/WebsiteLogSampleData/SampleLog/` is the location of the sample file that you used in the query.</span></span>

### <a name="run-a-hive-query-against-data-in-a-data-lake-store-as-additional-storage"></a><span data-ttu-id="d7acc-233">Выполнение запроса Hive к данным, хранящимся в Data Lake Store (дополнительное хранилище)</span><span class="sxs-lookup"><span data-stu-id="d7acc-233">Run a Hive query against data in a Data Lake Store (as additional storage)</span></span>

<span data-ttu-id="d7acc-234">Если созданный кластер в качестве хранилища по умолчанию использует хранилище BLOB-объектов, то демонстрационные данные не будут находиться в учетной записи Azure Data Lake Store, используемой в качестве дополнительного хранилища.</span><span class="sxs-lookup"><span data-stu-id="d7acc-234">If the cluster that you created uses Blob storage as default storage, the sample data is not contained in the Azure Data Lake Store account that's used as additional storage.</span></span> <span data-ttu-id="d7acc-235">В этом случае сначала передайте данные из хранилища BLOB-объектов в Data Lake Store, а затем выполните запросы, как показано в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="d7acc-235">In such a case, first transfer the data from Blob storage to the Data Lake Store, and then run the queries as shown in the preceding example.</span></span>

<span data-ttu-id="d7acc-236">Сведения о том, как скопировать данные из хранилища BLOB-объектов в Azure Data Lake Store, см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="d7acc-236">For information on how to copy data from Blob storage to a Data Lake Store, see the following articles:</span></span>

* [<span data-ttu-id="d7acc-237">Использование Distcp для копирования данных между BLOB-объектами и хранилищем озера данных</span><span class="sxs-lookup"><span data-stu-id="d7acc-237">Use Distcp to copy data between Azure Storage blobs and Data Lake Store</span></span>](data-lake-store-copy-data-wasb-distcp.md)
* [<span data-ttu-id="d7acc-238">Копирование данных из больших двоичных объектов хранилища Azure в хранилище озера данных</span><span class="sxs-lookup"><span data-stu-id="d7acc-238">Use AdlCopy to copy data from Azure Storage blobs to Data Lake Store</span></span>](data-lake-store-copy-data-azure-storage-blob.md)

### <a name="use-data-lake-store-with-a-spark-cluster"></a><span data-ttu-id="d7acc-239">Использование Data Lake Store с кластером Spark</span><span class="sxs-lookup"><span data-stu-id="d7acc-239">Use Data Lake Store with a Spark cluster</span></span>
<span data-ttu-id="d7acc-240">Кластер Spark можно использовать для выполнения заданий Spark с данными, хранящимися в Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="d7acc-240">You can use a Spark cluster to run Spark jobs on data that is stored in a Data Lake Store.</span></span> <span data-ttu-id="d7acc-241">Дополнительные сведения см. в статье [Использование кластера HDInsight Spark для анализа данных в Data Lake Store](../hdinsight/hdinsight-apache-spark-use-with-data-lake-store.md).</span><span class="sxs-lookup"><span data-stu-id="d7acc-241">For more information, see [Use HDInsight Spark cluster to analyze data in Data Lake Store](../hdinsight/hdinsight-apache-spark-use-with-data-lake-store.md).</span></span>


### <a name="use-data-lake-store-in-a-storm-topology"></a><span data-ttu-id="d7acc-242">Использование хранилища озера данных в топологии Storm</span><span class="sxs-lookup"><span data-stu-id="d7acc-242">Use Data Lake Store in a Storm topology</span></span>
<span data-ttu-id="d7acc-243">Хранилище озера данных можно использовать для записи данных из топологии Storm.</span><span class="sxs-lookup"><span data-stu-id="d7acc-243">You can use the Data Lake Store to write data from a Storm topology.</span></span> <span data-ttu-id="d7acc-244">Инструкции по реализации этого сценария см. в статье [Использование хранилища озера данных Azure с помощью Apache Storm в HDInsight](../hdinsight/hdinsight-storm-write-data-lake-store.md).</span><span class="sxs-lookup"><span data-stu-id="d7acc-244">For instructions on how to achieve this scenario, see [Use Azure Data Lake Store with Apache Storm with HDInsight](../hdinsight/hdinsight-storm-write-data-lake-store.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="d7acc-245">Дополнительные материалы</span><span class="sxs-lookup"><span data-stu-id="d7acc-245">See also</span></span>
* [<span data-ttu-id="d7acc-246">PowerShell: создание кластера HDInsight для работы с хранилищем озера данных</span><span class="sxs-lookup"><span data-stu-id="d7acc-246">PowerShell: Create an HDInsight cluster to use Data Lake Store</span></span>](data-lake-store-hdinsight-hadoop-use-powershell.md)

[makecert]: https://msdn.microsoft.com/library/windows/desktop/ff548309(v=vs.85).aspx
[pvk2pfx]: https://msdn.microsoft.com/library/windows/desktop/ff550672(v=vs.85).aspx
