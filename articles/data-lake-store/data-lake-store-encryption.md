---
title: "aaaEncryption в хранилище Озера данных Azure | Документы Microsoft"
description: "Сведения о механизме шифрования и смены ключей в Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: yagupta
manager: 
editor: 
ms.assetid: 
ms.service: data-lake-store
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 4/14/2017
ms.author: yagupta
ms.openlocfilehash: a9f3a2dce8232deba93005594d1e6a21e9c0cbee
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="encryption-of-data-in-azure-data-lake-store"></a>Шифрование данных в Azure Data Lake Store

Шифрование в Azure Data Lake Store помогает защищать данные, реализовывать корпоративные политики безопасности и соблюдать соответствие нормативным требованиям. В этой статье содержится обзор разработки hello и рассматриваются некоторые технические аспекты реализации hello.

Data Lake Store поддерживает шифрование данных при хранении (неактивные данные) и передаче. Data Lake Store поддерживает прозрачное шифрование неактивных данных, включенное по умолчанию. Далее упомянутые термины представлены подробнее.

* **На по умолчанию**: при создании новой учетной записи хранилища Озера данных по умолчанию hello включает шифрование. После этого данные, хранящиеся в хранилище Озера данных всегда является зашифрованный предыдущих toostoring на постоянные носителе. Это поведение hello для всех данных, и его нельзя изменить после создания учетной записи.
* **Прозрачный**: хранилище Озера данных автоматически шифрует toopersisting предыдущих данных и расшифровывает tooretrieval предыдущих данных. шифрование Hello настраивается и управляется администратором в hello уровень хранилища Озера данных. Изменения не вносятся toohello данных доступ к API. Таким образом, при шифровании изменять приложения и службы, взаимодействующие с Data Lake Store, не требуется.

Передаваемые (перемещаемые) данные также всегда шифруются в Data Lake Store. Кроме tooencrypting данных предыдущих toostoring toopersistent мультимедиа, hello данных всегда также обеспечивается во время передачи по протоколу HTTPS. HTTPS — hello единственный протокол, который поддерживается для приветствия интерфейсы REST хранилища Озера данных. Hello следующей схеме показан способ становится шифрования данных в хранилище Озера данных:

![Схема шифрования данных в Data Lake Store](./media/data-lake-store-encryption/fig1.png)


## <a name="set-up-encryption-with-data-lake-store"></a>Настройка шифрования с помощью Data Lake Store

Шифрование для Data Lake Store настраивается во время создания учетной записи. Эта функция всегда включена по умолчанию. Можно самостоятельно управлять ключами hello, или разрешить хранилища Озера данных toomanage ими (это по умолчанию hello).

Дополнительные сведения см. в [руководстве по началу работы](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).

## <a name="how-encryption-works-in-data-lake-store"></a>Механизм шифрования в Data Lake Store

Hello ниже сведения охватывают как toomanage master шифрования разделов и описываются три разных типов hello ключей, которые можно использовать в шифрование данных для хранилища Озера данных.

### <a name="master-encryption-keys"></a>Главные ключи шифрования

В Data Lake Store предусмотрено два режима управления главными ключами шифрования. Теперь предположим, что этой hello главный ключ шифрования является hello раздел верхнего уровня. Доступ toohello главный ключ шифрования является обязательным toodecrypt любые данные, хранящиеся в хранилище Озера данных.

Ниже приведены Hello двух режимов управления hello главный ключ шифрования.

*   Ключами управляет служба
*   Ключами управляет пользователь

В обоих режимах hello главный ключ шифрования защищен путем его сохранения в хранилище ключей Azure. Хранилище ключей — это полностью управляемая, высокий уровень безопасности служба в Azure, которая может быть используется toosafeguard криптографических ключей. Дополнительные сведения см. в [документации по Key Vault](https://azure.microsoft.com/services/key-vault).

Вот краткое сравнение возможностей hello двумя режимами управления hello MEKs.

|  | Ключами управляет служба | Ключами управляет пользователь |
| --- | --- | --- |
|Способ хранения данных|Постоянное шифрование предыдущих toobeing хранятся.|Постоянное шифрование предыдущих toobeing хранятся.|
|Где хранятся hello главного ключа шифрования|Хранилище ключей|Хранилище ключей|
|Такое какого-либо шифрования ключей, хранящихся в hello удалены за пределами хранилища ключей |Нет|Нет|
|Можно получить hello MEK хранилищем ключей?|Нет. После hello MEK хранится в хранилище ключей он может использоваться только для шифрования и расшифровки.|Нет. После hello MEK хранится в хранилище ключей он может использоваться только для шифрования и расшифровки.|
|Кто является владельцем экземпляра хранилища ключей hello и hello MEK?|Hello службы хранилища Озера данных|Пользователь является владельцем экземпляра hello хранилище ключей, который принадлежит к своей подписке Azure. Hello MEK в хранилище ключей может управляться оборудования или программного обеспечения.|
|Вы отзываете доступа toohello MEK для hello службы хранилища Озера данных|Нет|Да. Можно управлять списки управления доступом в хранилище ключей и удалите удостоверение службы toohello записи управления доступом для hello службы хранилища Озера данных.|
|Окончательно удалить hello MEK?|Нет|Да. При удалении hello MEK из хранилища ключей, всем, включая службы хранилища Озера данных hello невозможно расшифровать данные hello в hello хранилища Озера данных. <br><br> Если явно архивации hello MEK предыдущих toodeleting его из хранилища ключей, hello MEK может быть восстановлена и hello данных можно будет восстановить. Тем не менее, если не заархивированы hello MEK предыдущих toodeleting его из хранилища ключей, hello данных в hello хранилища Озера данных никогда не возможна соответственно.|


Помимо этого разницу, управляющий hello MEK и в котором он находится, экземпляре хранилища ключей hello hello остальной части конструктора hello hello же обоих режимов.

Это следующие важные tooremember hello Выбор режима hello для hello ключи шифрования master:

*   Можно ли клиент toouse управляемых ключи или ключи управление службой при подготовке учетной записи хранилища Озера данных.
*   После подготовки учетной записи хранилища Озера данных нельзя изменить режим hello.

### <a name="encryption-and-decryption-of-data"></a>Шифрование и расшифровка данных

Существует три типа ключей, используемых при разработке hello шифрования данных. Привет, в следующей таблице приведена сводка:

| Ключ                   | Сокращение | С чем связан | Расположение хранения                             | Тип       | Примечания                                                                                                   |
|-----------------------|--------------|-----------------|----------------------------------------------|------------|---------------------------------------------------------------------------------------------------------|
| Главный ключ шифрования | MEK          | Учетная запись Data Lake Store | хранилище ключей;                              | Асимметричный | Может управляться Data Lake Store или пользователем.                                                              |
| Ключ шифрования данных   | DEK          | Учетная запись Data Lake Store | Постоянное хранилище; управляется Data Lake Store | Симметричный  | используется шифрование hello MEK Hello ключ шифрования базы данных. Здравствуйте, зашифрованный ключ шифрования базы данных — что хранится на носителе постоянно. |
| Ключ блочного шифрования  | BEK          | Блок данных | None                                         | Симметричный  | Hello BEK является производным от hello ключ шифрования базы данных и блок данных hello.                                                      |

Привет, следующая схема иллюстрирует эти основные понятия.

![Ключи в шифровании данных](./media/data-lake-store-encryption/fig2.png)

#### <a name="pseudo-algorithm-when-a-file-is-toobe-decrypted"></a>Если файл является toobe расшифровать псевдо алгоритм:
1.  Проверьте, является ли hello ключ шифрования базы данных для учетной записи хранилища Озера данных hello кэшированных и готова к использованию.
    - В противном случае считать hello зашифрован ключ шифрования базы данных из постоянного хранилища и отправить его toobe хранилище tooKey расшифровать. Кэш hello расшифровать ключ шифрования базы данных в памяти. Все готово toouse сейчас.
2.  Для каждого блока данных в файле hello:
    - Hello зашифрованный блок данных, считанных из постоянного хранилища.
    - Создание hello BEK из hello ключ шифрования базы данных и hello зашифрованный блок данных.
    - Используйте данные toodecrypt BEK hello.


#### <a name="pseudo-algorithm-when-a-block-of-data-is-toobe-encrypted"></a>Алгоритм псевдо после блока данных toobe шифрования:
1.  Проверьте, является ли hello ключ шифрования базы данных для учетной записи хранилища Озера данных hello кэшированных и готова к использованию.
    - В противном случае считать hello зашифрован ключ шифрования базы данных из постоянного хранилища и отправить его toobe хранилище tooKey расшифровать. Кэш hello расшифровать ключ шифрования базы данных в памяти. Все готово toouse сейчас.
2.  Создайте уникальный BEK для hello блока данных из hello ключ шифрования базы данных.
3.  Шифрование hello блок данных с hello BEK, с помощью шифрования AES-256.
4.  Хранить hello зашифрованный блок данных данных в постоянное хранилище.

> [!NOTE] 
> Из соображений производительности hello, ключ шифрования базы данных в hello снимите кэшируется в памяти в течение некоторого времени и удаляется сразу же после этого. На постоянные носители всегда хранится шифруется hello MEK.

## <a name="key-rotation"></a>Смена ключей

При использовании ключей, управляемых клиентов можно поворачивать hello MEK. tooset учетной записи хранилища Озера данных с помощью ключей, управление на стороне клиента, в статье toolearn [Приступая к работе](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).

### <a name="prerequisites"></a>Предварительные требования

При настройке хранилища Озера данных hello выбрано toouse свои собственные ключи. Этот параметр нельзя изменить после создания учетной записи hello. Hello следующие шаги предполагают, что вы используете ключи с управлением клиентом (то есть вы выбрали свои собственные ключи из хранилища ключей).

Обратите внимание, что при использовании параметров по умолчанию hello для шифрования данных всегда зашифрованы при помощи ключей управляется хранилища Озера данных. В этом случае у вас нет ключей toorotate возможность hello, они управляются хранилища Озера данных.

### <a name="how-toorotate-hello-mek-in-data-lake-store"></a>Как toorotate hello MEK в хранилище Озера данных

1. Войдите в toohello [портал Azure](https://portal.azure.com/).
2. Обзор toohello хранилище ключей экземпляра, который сохраняет ключи, связанные с вашей учетной записи хранилища Озера данных. Выберите **Ключи**.

    ![Снимок экрана с Key Vault](./media/data-lake-store-encryption/keyvault.png)

3.  Выберите ключ hello, связанный с вашей учетной записи хранилища Озера данных и создать новую версию этого раздела. Обратите внимание, что хранилище Озера данных в настоящее время поддерживает только смены ключей tooa новую версию ключа. Эта версия не поддерживает поворота tooa другой ключ.

   ![Снимок экрана с окном "Ключи" и выделенным пунктом "Новая версия"](./media/data-lake-store-encryption/keynewversion.png)

4.  Учетная запись хранения в хранилище Озера данных toohello перейдите и выберите **шифрования**.

    ![Снимок экрана с окном учетной записи хранения Data Lake Store с выделенным пунктом "Шифрование"](./media/data-lake-store-encryption/select-encryption.png)

5.  Сообщение уведомляет о том, что новая версия ключа hello ключ доступен. Нажмите кнопку **Поворачивайте ключ** tooupdate hello ключа toohello новой версии.

    ![Снимок экрана с окном Data Lake Store с сообщением и выделенным пунктом "Сменить ключ"](./media/data-lake-store-encryption/rotatekey.png)

Эта операция займет не более двух минут, и нет отсутствует ожидаемое время простоя из-за tookey поворота. По завершении операции hello hello новую версию hello ключ уже используется.
