---
title: "aaaEncryption в хранилище Озера данных Azure | Документы Microsoft"
description: "Сведения о механизме шифрования и смены ключей в Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: yagupta
manager: 
editor: 
ms.assetid: 
ms.service: data-lake-store
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 4/14/2017
ms.author: yagupta
ms.openlocfilehash: a9f3a2dce8232deba93005594d1e6a21e9c0cbee
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="encryption-of-data-in-azure-data-lake-store"></a><span data-ttu-id="95a9a-103">Шифрование данных в Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="95a9a-103">Encryption of data in Azure Data Lake Store</span></span>

<span data-ttu-id="95a9a-104">Шифрование в Azure Data Lake Store помогает защищать данные, реализовывать корпоративные политики безопасности и соблюдать соответствие нормативным требованиям.</span><span class="sxs-lookup"><span data-stu-id="95a9a-104">Encryption in Azure Data Lake Store helps you protect your data, implement enterprise security policies, and meet regulatory compliance requirements.</span></span> <span data-ttu-id="95a9a-105">В этой статье содержится обзор разработки hello и рассматриваются некоторые технические аспекты реализации hello.</span><span class="sxs-lookup"><span data-stu-id="95a9a-105">This article provides an overview of hello design, and discusses some of hello technical aspects of implementation.</span></span>

<span data-ttu-id="95a9a-106">Data Lake Store поддерживает шифрование данных при хранении (неактивные данные) и передаче.</span><span class="sxs-lookup"><span data-stu-id="95a9a-106">Data Lake Store supports encryption of data both at rest and in transit.</span></span> <span data-ttu-id="95a9a-107">Data Lake Store поддерживает прозрачное шифрование неактивных данных, включенное по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="95a9a-107">For data at rest, Data Lake Store supports "on by default," transparent encryption.</span></span> <span data-ttu-id="95a9a-108">Далее упомянутые термины представлены подробнее.</span><span class="sxs-lookup"><span data-stu-id="95a9a-108">Here is what these terms mean in a bit more detail:</span></span>

* <span data-ttu-id="95a9a-109">**На по умолчанию**: при создании новой учетной записи хранилища Озера данных по умолчанию hello включает шифрование.</span><span class="sxs-lookup"><span data-stu-id="95a9a-109">**On by default**: When you create a new Data Lake Store account, hello default setting enables encryption.</span></span> <span data-ttu-id="95a9a-110">После этого данные, хранящиеся в хранилище Озера данных всегда является зашифрованный предыдущих toostoring на постоянные носителе.</span><span class="sxs-lookup"><span data-stu-id="95a9a-110">Thereafter, data that is stored in Data Lake Store is always encrypted prior toostoring on persistent media.</span></span> <span data-ttu-id="95a9a-111">Это поведение hello для всех данных, и его нельзя изменить после создания учетной записи.</span><span class="sxs-lookup"><span data-stu-id="95a9a-111">This is hello behavior for all data, and it cannot be changed after an account is created.</span></span>
* <span data-ttu-id="95a9a-112">**Прозрачный**: хранилище Озера данных автоматически шифрует toopersisting предыдущих данных и расшифровывает tooretrieval предыдущих данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-112">**Transparent**: Data Lake Store automatically encrypts data prior toopersisting, and decrypts data prior tooretrieval.</span></span> <span data-ttu-id="95a9a-113">шифрование Hello настраивается и управляется администратором в hello уровень хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-113">hello encryption is configured and managed at hello Data Lake Store level by an administrator.</span></span> <span data-ttu-id="95a9a-114">Изменения не вносятся toohello данных доступ к API.</span><span class="sxs-lookup"><span data-stu-id="95a9a-114">No changes are made toohello data access APIs.</span></span> <span data-ttu-id="95a9a-115">Таким образом, при шифровании изменять приложения и службы, взаимодействующие с Data Lake Store, не требуется.</span><span class="sxs-lookup"><span data-stu-id="95a9a-115">Thus, no changes are required in applications and services that interact with Data Lake Store because of encryption.</span></span>

<span data-ttu-id="95a9a-116">Передаваемые (перемещаемые) данные также всегда шифруются в Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="95a9a-116">Data in transit (also known as data in motion) is also always encrypted in Data Lake Store.</span></span> <span data-ttu-id="95a9a-117">Кроме tooencrypting данных предыдущих toostoring toopersistent мультимедиа, hello данных всегда также обеспечивается во время передачи по протоколу HTTPS.</span><span class="sxs-lookup"><span data-stu-id="95a9a-117">In addition tooencrypting data prior toostoring toopersistent media, hello data is also always secured in transit by using HTTPS.</span></span> <span data-ttu-id="95a9a-118">HTTPS — hello единственный протокол, который поддерживается для приветствия интерфейсы REST хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-118">HTTPS is hello only protocol that is supported for hello Data Lake Store REST interfaces.</span></span> <span data-ttu-id="95a9a-119">Hello следующей схеме показан способ становится шифрования данных в хранилище Озера данных:</span><span class="sxs-lookup"><span data-stu-id="95a9a-119">hello following diagram shows how data becomes encrypted in Data Lake Store:</span></span>

![Схема шифрования данных в Data Lake Store](./media/data-lake-store-encryption/fig1.png)


## <a name="set-up-encryption-with-data-lake-store"></a><span data-ttu-id="95a9a-121">Настройка шифрования с помощью Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="95a9a-121">Set up encryption with Data Lake Store</span></span>

<span data-ttu-id="95a9a-122">Шифрование для Data Lake Store настраивается во время создания учетной записи. Эта функция всегда включена по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="95a9a-122">Encryption for Data Lake Store is set up during account creation, and it is always enabled by default.</span></span> <span data-ttu-id="95a9a-123">Можно самостоятельно управлять ключами hello, или разрешить хранилища Озера данных toomanage ими (это по умолчанию hello).</span><span class="sxs-lookup"><span data-stu-id="95a9a-123">You can either manage hello keys yourself, or allow Data Lake Store toomanage them for you (this is hello default).</span></span>

<span data-ttu-id="95a9a-124">Дополнительные сведения см. в [руководстве по началу работы](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span><span class="sxs-lookup"><span data-stu-id="95a9a-124">For more information, see [Getting started](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span></span>

## <a name="how-encryption-works-in-data-lake-store"></a><span data-ttu-id="95a9a-125">Механизм шифрования в Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="95a9a-125">How encryption works in Data Lake Store</span></span>

<span data-ttu-id="95a9a-126">Hello ниже сведения охватывают как toomanage master шифрования разделов и описываются три разных типов hello ключей, которые можно использовать в шифрование данных для хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-126">hello following information covers how toomanage master encryption keys, and it explains hello three different types of keys you can use in data encryption for Data Lake Store.</span></span>

### <a name="master-encryption-keys"></a><span data-ttu-id="95a9a-127">Главные ключи шифрования</span><span class="sxs-lookup"><span data-stu-id="95a9a-127">Master encryption keys</span></span>

<span data-ttu-id="95a9a-128">В Data Lake Store предусмотрено два режима управления главными ключами шифрования.</span><span class="sxs-lookup"><span data-stu-id="95a9a-128">Data Lake Store provides two modes for management of master encryption keys (MEKs).</span></span> <span data-ttu-id="95a9a-129">Теперь предположим, что этой hello главный ключ шифрования является hello раздел верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="95a9a-129">For now, assume that hello master encryption key is hello top-level key.</span></span> <span data-ttu-id="95a9a-130">Доступ toohello главный ключ шифрования является обязательным toodecrypt любые данные, хранящиеся в хранилище Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-130">Access toohello master encryption key is required toodecrypt any data stored in Data Lake Store.</span></span>

<span data-ttu-id="95a9a-131">Ниже приведены Hello двух режимов управления hello главный ключ шифрования.</span><span class="sxs-lookup"><span data-stu-id="95a9a-131">hello two modes for managing hello master encryption key are as follows:</span></span>

*   <span data-ttu-id="95a9a-132">Ключами управляет служба</span><span class="sxs-lookup"><span data-stu-id="95a9a-132">Service managed keys</span></span>
*   <span data-ttu-id="95a9a-133">Ключами управляет пользователь</span><span class="sxs-lookup"><span data-stu-id="95a9a-133">Customer managed keys</span></span>

<span data-ttu-id="95a9a-134">В обоих режимах hello главный ключ шифрования защищен путем его сохранения в хранилище ключей Azure.</span><span class="sxs-lookup"><span data-stu-id="95a9a-134">In both modes, hello master encryption key is secured by storing it in Azure Key Vault.</span></span> <span data-ttu-id="95a9a-135">Хранилище ключей — это полностью управляемая, высокий уровень безопасности служба в Azure, которая может быть используется toosafeguard криптографических ключей.</span><span class="sxs-lookup"><span data-stu-id="95a9a-135">Key Vault is a fully managed, highly secure service on Azure that can be used toosafeguard cryptographic keys.</span></span> <span data-ttu-id="95a9a-136">Дополнительные сведения см. в [документации по Key Vault](https://azure.microsoft.com/services/key-vault).</span><span class="sxs-lookup"><span data-stu-id="95a9a-136">For more information, see [Key Vault](https://azure.microsoft.com/services/key-vault).</span></span>

<span data-ttu-id="95a9a-137">Вот краткое сравнение возможностей hello двумя режимами управления hello MEKs.</span><span class="sxs-lookup"><span data-stu-id="95a9a-137">Here is a brief comparison of capabilities provided by hello two modes of managing hello MEKs.</span></span>

|  | <span data-ttu-id="95a9a-138">Ключами управляет служба</span><span class="sxs-lookup"><span data-stu-id="95a9a-138">Service managed keys</span></span> | <span data-ttu-id="95a9a-139">Ключами управляет пользователь</span><span class="sxs-lookup"><span data-stu-id="95a9a-139">Customer managed keys</span></span> |
| --- | --- | --- |
|<span data-ttu-id="95a9a-140">Способ хранения данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-140">How is data stored?</span></span>|<span data-ttu-id="95a9a-141">Постоянное шифрование предыдущих toobeing хранятся.</span><span class="sxs-lookup"><span data-stu-id="95a9a-141">Always encrypted prior toobeing stored.</span></span>|<span data-ttu-id="95a9a-142">Постоянное шифрование предыдущих toobeing хранятся.</span><span class="sxs-lookup"><span data-stu-id="95a9a-142">Always encrypted prior toobeing stored.</span></span>|
|<span data-ttu-id="95a9a-143">Где хранятся hello главного ключа шифрования</span><span class="sxs-lookup"><span data-stu-id="95a9a-143">Where is hello Master Encryption Key stored?</span></span>|<span data-ttu-id="95a9a-144">Хранилище ключей</span><span class="sxs-lookup"><span data-stu-id="95a9a-144">Key Vault</span></span>|<span data-ttu-id="95a9a-145">Хранилище ключей</span><span class="sxs-lookup"><span data-stu-id="95a9a-145">Key Vault</span></span>|
|<span data-ttu-id="95a9a-146">Такое какого-либо шифрования ключей, хранящихся в hello удалены за пределами хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="95a9a-146">Are any encryption keys stored in hello clear outside of Key Vault?</span></span> |<span data-ttu-id="95a9a-147">Нет</span><span class="sxs-lookup"><span data-stu-id="95a9a-147">No</span></span>|<span data-ttu-id="95a9a-148">Нет</span><span class="sxs-lookup"><span data-stu-id="95a9a-148">No</span></span>|
|<span data-ttu-id="95a9a-149">Можно получить hello MEK хранилищем ключей?</span><span class="sxs-lookup"><span data-stu-id="95a9a-149">Can hello MEK be retrieved by Key Vault?</span></span>|<span data-ttu-id="95a9a-150">Нет.</span><span class="sxs-lookup"><span data-stu-id="95a9a-150">No.</span></span> <span data-ttu-id="95a9a-151">После hello MEK хранится в хранилище ключей он может использоваться только для шифрования и расшифровки.</span><span class="sxs-lookup"><span data-stu-id="95a9a-151">After hello MEK is stored in Key Vault, it can only be used for encryption and decryption.</span></span>|<span data-ttu-id="95a9a-152">Нет.</span><span class="sxs-lookup"><span data-stu-id="95a9a-152">No.</span></span> <span data-ttu-id="95a9a-153">После hello MEK хранится в хранилище ключей он может использоваться только для шифрования и расшифровки.</span><span class="sxs-lookup"><span data-stu-id="95a9a-153">After hello MEK is stored in Key Vault, it can only be used for encryption and decryption.</span></span>|
|<span data-ttu-id="95a9a-154">Кто является владельцем экземпляра хранилища ключей hello и hello MEK?</span><span class="sxs-lookup"><span data-stu-id="95a9a-154">Who owns hello Key Vault instance and hello MEK?</span></span>|<span data-ttu-id="95a9a-155">Hello службы хранилища Озера данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-155">hello Data Lake Store service</span></span>|<span data-ttu-id="95a9a-156">Пользователь является владельцем экземпляра hello хранилище ключей, который принадлежит к своей подписке Azure.</span><span class="sxs-lookup"><span data-stu-id="95a9a-156">You own hello Key Vault instance, which belongs in your own Azure subscription.</span></span> <span data-ttu-id="95a9a-157">Hello MEK в хранилище ключей может управляться оборудования или программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="95a9a-157">hello MEK in Key Vault can be managed by software or hardware.</span></span>|
|<span data-ttu-id="95a9a-158">Вы отзываете доступа toohello MEK для hello службы хранилища Озера данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-158">Can you revoke access toohello MEK for hello Data Lake Store service?</span></span>|<span data-ttu-id="95a9a-159">Нет</span><span class="sxs-lookup"><span data-stu-id="95a9a-159">No</span></span>|<span data-ttu-id="95a9a-160">Да.</span><span class="sxs-lookup"><span data-stu-id="95a9a-160">Yes.</span></span> <span data-ttu-id="95a9a-161">Можно управлять списки управления доступом в хранилище ключей и удалите удостоверение службы toohello записи управления доступом для hello службы хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-161">You can manage access control lists in Key Vault, and remove access control entries toohello service identity for hello Data Lake Store service.</span></span>|
|<span data-ttu-id="95a9a-162">Окончательно удалить hello MEK?</span><span class="sxs-lookup"><span data-stu-id="95a9a-162">Can you permanently delete hello MEK?</span></span>|<span data-ttu-id="95a9a-163">Нет</span><span class="sxs-lookup"><span data-stu-id="95a9a-163">No</span></span>|<span data-ttu-id="95a9a-164">Да.</span><span class="sxs-lookup"><span data-stu-id="95a9a-164">Yes.</span></span> <span data-ttu-id="95a9a-165">При удалении hello MEK из хранилища ключей, всем, включая службы хранилища Озера данных hello невозможно расшифровать данные hello в hello хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-165">If you delete hello MEK from Key Vault, hello data in hello Data Lake Store account cannot be decrypted by anyone, including hello Data Lake Store service.</span></span> <br><br> <span data-ttu-id="95a9a-166">Если явно архивации hello MEK предыдущих toodeleting его из хранилища ключей, hello MEK может быть восстановлена и hello данных можно будет восстановить.</span><span class="sxs-lookup"><span data-stu-id="95a9a-166">If you have explicitly backed up hello MEK prior toodeleting it from Key Vault, hello MEK can be restored, and hello data can then be recovered.</span></span> <span data-ttu-id="95a9a-167">Тем не менее, если не заархивированы hello MEK предыдущих toodeleting его из хранилища ключей, hello данных в hello хранилища Озера данных никогда не возможна соответственно.</span><span class="sxs-lookup"><span data-stu-id="95a9a-167">However, if you have not backed up hello MEK prior toodeleting it from Key Vault, hello data in hello Data Lake Store account can never be decrypted thereafter.</span></span>|


<span data-ttu-id="95a9a-168">Помимо этого разницу, управляющий hello MEK и в котором он находится, экземпляре хранилища ключей hello hello остальной части конструктора hello hello же обоих режимов.</span><span class="sxs-lookup"><span data-stu-id="95a9a-168">Aside from this difference of who manages hello MEK and hello Key Vault instance in which it resides, hello rest of hello design is hello same for both modes.</span></span>

<span data-ttu-id="95a9a-169">Это следующие важные tooremember hello Выбор режима hello для hello ключи шифрования master:</span><span class="sxs-lookup"><span data-stu-id="95a9a-169">It's important tooremember hello following when you choose hello mode for hello master encryption keys:</span></span>

*   <span data-ttu-id="95a9a-170">Можно ли клиент toouse управляемых ключи или ключи управление службой при подготовке учетной записи хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-170">You can choose whether toouse customer managed keys or service managed keys when you provision a Data Lake Store account.</span></span>
*   <span data-ttu-id="95a9a-171">После подготовки учетной записи хранилища Озера данных нельзя изменить режим hello.</span><span class="sxs-lookup"><span data-stu-id="95a9a-171">After a Data Lake Store account is provisioned, hello mode cannot be changed.</span></span>

### <a name="encryption-and-decryption-of-data"></a><span data-ttu-id="95a9a-172">Шифрование и расшифровка данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-172">Encryption and decryption of data</span></span>

<span data-ttu-id="95a9a-173">Существует три типа ключей, используемых при разработке hello шифрования данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-173">There are three types of keys that are used in hello design of data encryption.</span></span> <span data-ttu-id="95a9a-174">Привет, в следующей таблице приведена сводка:</span><span class="sxs-lookup"><span data-stu-id="95a9a-174">hello following table provides a summary:</span></span>

| <span data-ttu-id="95a9a-175">Ключ</span><span class="sxs-lookup"><span data-stu-id="95a9a-175">Key</span></span>                   | <span data-ttu-id="95a9a-176">Сокращение</span><span class="sxs-lookup"><span data-stu-id="95a9a-176">Abbreviation</span></span> | <span data-ttu-id="95a9a-177">С чем связан</span><span class="sxs-lookup"><span data-stu-id="95a9a-177">Associated with</span></span> | <span data-ttu-id="95a9a-178">Расположение хранения</span><span class="sxs-lookup"><span data-stu-id="95a9a-178">Storage location</span></span>                             | <span data-ttu-id="95a9a-179">Тип</span><span class="sxs-lookup"><span data-stu-id="95a9a-179">Type</span></span>       | <span data-ttu-id="95a9a-180">Примечания</span><span class="sxs-lookup"><span data-stu-id="95a9a-180">Notes</span></span>                                                                                                   |
|-----------------------|--------------|-----------------|----------------------------------------------|------------|---------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="95a9a-181">Главный ключ шифрования</span><span class="sxs-lookup"><span data-stu-id="95a9a-181">Master Encryption Key</span></span> | <span data-ttu-id="95a9a-182">MEK</span><span class="sxs-lookup"><span data-stu-id="95a9a-182">MEK</span></span>          | <span data-ttu-id="95a9a-183">Учетная запись Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="95a9a-183">A Data Lake Store account</span></span> | <span data-ttu-id="95a9a-184">хранилище ключей;</span><span class="sxs-lookup"><span data-stu-id="95a9a-184">Key Vault</span></span>                              | <span data-ttu-id="95a9a-185">Асимметричный</span><span class="sxs-lookup"><span data-stu-id="95a9a-185">Asymmetric</span></span> | <span data-ttu-id="95a9a-186">Может управляться Data Lake Store или пользователем.</span><span class="sxs-lookup"><span data-stu-id="95a9a-186">It can be managed by Data Lake Store or you.</span></span>                                                              |
| <span data-ttu-id="95a9a-187">Ключ шифрования данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-187">Data Encryption Key</span></span>   | <span data-ttu-id="95a9a-188">DEK</span><span class="sxs-lookup"><span data-stu-id="95a9a-188">DEK</span></span>          | <span data-ttu-id="95a9a-189">Учетная запись Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="95a9a-189">A Data Lake Store account</span></span> | <span data-ttu-id="95a9a-190">Постоянное хранилище; управляется Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="95a9a-190">Persistent storage, managed by Data Lake Store service</span></span> | <span data-ttu-id="95a9a-191">Симметричный</span><span class="sxs-lookup"><span data-stu-id="95a9a-191">Symmetric</span></span>  | <span data-ttu-id="95a9a-192">используется шифрование hello MEK Hello ключ шифрования базы данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-192">hello DEK is encrypted by hello MEK.</span></span> <span data-ttu-id="95a9a-193">Здравствуйте, зашифрованный ключ шифрования базы данных — что хранится на носителе постоянно.</span><span class="sxs-lookup"><span data-stu-id="95a9a-193">hello encrypted DEK is what is stored on persistent media.</span></span> |
| <span data-ttu-id="95a9a-194">Ключ блочного шифрования</span><span class="sxs-lookup"><span data-stu-id="95a9a-194">Block Encryption Key</span></span>  | <span data-ttu-id="95a9a-195">BEK</span><span class="sxs-lookup"><span data-stu-id="95a9a-195">BEK</span></span>          | <span data-ttu-id="95a9a-196">Блок данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-196">A block of data</span></span> | <span data-ttu-id="95a9a-197">None</span><span class="sxs-lookup"><span data-stu-id="95a9a-197">None</span></span>                                         | <span data-ttu-id="95a9a-198">Симметричный</span><span class="sxs-lookup"><span data-stu-id="95a9a-198">Symmetric</span></span>  | <span data-ttu-id="95a9a-199">Hello BEK является производным от hello ключ шифрования базы данных и блок данных hello.</span><span class="sxs-lookup"><span data-stu-id="95a9a-199">hello BEK is derived from hello DEK and hello data block.</span></span>                                                      |

<span data-ttu-id="95a9a-200">Привет, следующая схема иллюстрирует эти основные понятия.</span><span class="sxs-lookup"><span data-stu-id="95a9a-200">hello following diagram illustrates these concepts:</span></span>

![Ключи в шифровании данных](./media/data-lake-store-encryption/fig2.png)

#### <a name="pseudo-algorithm-when-a-file-is-toobe-decrypted"></a><span data-ttu-id="95a9a-202">Если файл является toobe расшифровать псевдо алгоритм:</span><span class="sxs-lookup"><span data-stu-id="95a9a-202">Pseudo algorithm when a file is toobe decrypted:</span></span>
1.  <span data-ttu-id="95a9a-203">Проверьте, является ли hello ключ шифрования базы данных для учетной записи хранилища Озера данных hello кэшированных и готова к использованию.</span><span class="sxs-lookup"><span data-stu-id="95a9a-203">Check if hello DEK for hello Data Lake Store account is cached and ready for use.</span></span>
    - <span data-ttu-id="95a9a-204">В противном случае считать hello зашифрован ключ шифрования базы данных из постоянного хранилища и отправить его toobe хранилище tooKey расшифровать.</span><span class="sxs-lookup"><span data-stu-id="95a9a-204">If not, then read hello encrypted DEK from persistent storage, and send it tooKey Vault toobe decrypted.</span></span> <span data-ttu-id="95a9a-205">Кэш hello расшифровать ключ шифрования базы данных в памяти.</span><span class="sxs-lookup"><span data-stu-id="95a9a-205">Cache hello decrypted DEK in memory.</span></span> <span data-ttu-id="95a9a-206">Все готово toouse сейчас.</span><span class="sxs-lookup"><span data-stu-id="95a9a-206">It is now ready toouse.</span></span>
2.  <span data-ttu-id="95a9a-207">Для каждого блока данных в файле hello:</span><span class="sxs-lookup"><span data-stu-id="95a9a-207">For every block of data in hello file:</span></span>
    - <span data-ttu-id="95a9a-208">Hello зашифрованный блок данных, считанных из постоянного хранилища.</span><span class="sxs-lookup"><span data-stu-id="95a9a-208">Read hello encrypted block of data from persistent storage.</span></span>
    - <span data-ttu-id="95a9a-209">Создание hello BEK из hello ключ шифрования базы данных и hello зашифрованный блок данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-209">Generate hello BEK from hello DEK and hello encrypted block of data.</span></span>
    - <span data-ttu-id="95a9a-210">Используйте данные toodecrypt BEK hello.</span><span class="sxs-lookup"><span data-stu-id="95a9a-210">Use hello BEK toodecrypt data.</span></span>


#### <a name="pseudo-algorithm-when-a-block-of-data-is-toobe-encrypted"></a><span data-ttu-id="95a9a-211">Алгоритм псевдо после блока данных toobe шифрования:</span><span class="sxs-lookup"><span data-stu-id="95a9a-211">Pseudo algorithm when a block of data is toobe encrypted:</span></span>
1.  <span data-ttu-id="95a9a-212">Проверьте, является ли hello ключ шифрования базы данных для учетной записи хранилища Озера данных hello кэшированных и готова к использованию.</span><span class="sxs-lookup"><span data-stu-id="95a9a-212">Check if hello DEK for hello Data Lake Store account is cached and ready for use.</span></span>
    - <span data-ttu-id="95a9a-213">В противном случае считать hello зашифрован ключ шифрования базы данных из постоянного хранилища и отправить его toobe хранилище tooKey расшифровать.</span><span class="sxs-lookup"><span data-stu-id="95a9a-213">If not, then read hello encrypted DEK from persistent storage, and send it tooKey Vault toobe decrypted.</span></span> <span data-ttu-id="95a9a-214">Кэш hello расшифровать ключ шифрования базы данных в памяти.</span><span class="sxs-lookup"><span data-stu-id="95a9a-214">Cache hello decrypted DEK in memory.</span></span> <span data-ttu-id="95a9a-215">Все готово toouse сейчас.</span><span class="sxs-lookup"><span data-stu-id="95a9a-215">It is now ready toouse.</span></span>
2.  <span data-ttu-id="95a9a-216">Создайте уникальный BEK для hello блока данных из hello ключ шифрования базы данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-216">Generate a unique BEK for hello block of data from hello DEK.</span></span>
3.  <span data-ttu-id="95a9a-217">Шифрование hello блок данных с hello BEK, с помощью шифрования AES-256.</span><span class="sxs-lookup"><span data-stu-id="95a9a-217">Encrypt hello data block with hello BEK, by using AES-256 encryption.</span></span>
4.  <span data-ttu-id="95a9a-218">Хранить hello зашифрованный блок данных данных в постоянное хранилище.</span><span class="sxs-lookup"><span data-stu-id="95a9a-218">Store hello encrypted data block of data on persistent storage.</span></span>

> [!NOTE] 
> <span data-ttu-id="95a9a-219">Из соображений производительности hello, ключ шифрования базы данных в hello снимите кэшируется в памяти в течение некоторого времени и удаляется сразу же после этого.</span><span class="sxs-lookup"><span data-stu-id="95a9a-219">For performance reasons, hello DEK in hello clear is cached in memory for a short time, and is immediately erased afterward.</span></span> <span data-ttu-id="95a9a-220">На постоянные носители всегда хранится шифруется hello MEK.</span><span class="sxs-lookup"><span data-stu-id="95a9a-220">On persistent media, it is always stored encrypted by hello MEK.</span></span>

## <a name="key-rotation"></a><span data-ttu-id="95a9a-221">Смена ключей</span><span class="sxs-lookup"><span data-stu-id="95a9a-221">Key rotation</span></span>

<span data-ttu-id="95a9a-222">При использовании ключей, управляемых клиентов можно поворачивать hello MEK.</span><span class="sxs-lookup"><span data-stu-id="95a9a-222">When you are using customer-managed keys, you can rotate hello MEK.</span></span> <span data-ttu-id="95a9a-223">tooset учетной записи хранилища Озера данных с помощью ключей, управление на стороне клиента, в статье toolearn [Приступая к работе](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span><span class="sxs-lookup"><span data-stu-id="95a9a-223">toolearn how tooset up a Data Lake Store account with customer-managed keys, see [Getting started](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="95a9a-224">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="95a9a-224">Prerequisites</span></span>

<span data-ttu-id="95a9a-225">При настройке хранилища Озера данных hello выбрано toouse свои собственные ключи.</span><span class="sxs-lookup"><span data-stu-id="95a9a-225">When you set up hello Data Lake Store account, you have chosen toouse your own keys.</span></span> <span data-ttu-id="95a9a-226">Этот параметр нельзя изменить после создания учетной записи hello.</span><span class="sxs-lookup"><span data-stu-id="95a9a-226">This option cannot be changed after hello account has been created.</span></span> <span data-ttu-id="95a9a-227">Hello следующие шаги предполагают, что вы используете ключи с управлением клиентом (то есть вы выбрали свои собственные ключи из хранилища ключей).</span><span class="sxs-lookup"><span data-stu-id="95a9a-227">hello following steps assume that you are using customer-managed keys (that is, you have chosen your own keys from Key Vault).</span></span>

<span data-ttu-id="95a9a-228">Обратите внимание, что при использовании параметров по умолчанию hello для шифрования данных всегда зашифрованы при помощи ключей управляется хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-228">Note that if you use hello default options for encryption, your data is always encrypted by using keys managed by Data Lake Store.</span></span> <span data-ttu-id="95a9a-229">В этом случае у вас нет ключей toorotate возможность hello, они управляются хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-229">In this option, you don't have hello ability toorotate keys, as they are managed by Data Lake Store.</span></span>

### <a name="how-toorotate-hello-mek-in-data-lake-store"></a><span data-ttu-id="95a9a-230">Как toorotate hello MEK в хранилище Озера данных</span><span class="sxs-lookup"><span data-stu-id="95a9a-230">How toorotate hello MEK in Data Lake Store</span></span>

1. <span data-ttu-id="95a9a-231">Войдите в toohello [портал Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="95a9a-231">Sign in toohello [Azure portal](https://portal.azure.com/).</span></span>
2. <span data-ttu-id="95a9a-232">Обзор toohello хранилище ключей экземпляра, который сохраняет ключи, связанные с вашей учетной записи хранилища Озера данных.</span><span class="sxs-lookup"><span data-stu-id="95a9a-232">Browse toohello Key Vault instance that stores your keys associated with your Data Lake Store account.</span></span> <span data-ttu-id="95a9a-233">Выберите **Ключи**.</span><span class="sxs-lookup"><span data-stu-id="95a9a-233">Select **Keys**.</span></span>

    ![Снимок экрана с Key Vault](./media/data-lake-store-encryption/keyvault.png)

3.  <span data-ttu-id="95a9a-235">Выберите ключ hello, связанный с вашей учетной записи хранилища Озера данных и создать новую версию этого раздела.</span><span class="sxs-lookup"><span data-stu-id="95a9a-235">Select hello key associated with your Data Lake Store account, and create a new version of this key.</span></span> <span data-ttu-id="95a9a-236">Обратите внимание, что хранилище Озера данных в настоящее время поддерживает только смены ключей tooa новую версию ключа.</span><span class="sxs-lookup"><span data-stu-id="95a9a-236">Note that Data Lake Store currently only supports key rotation tooa new version of a key.</span></span> <span data-ttu-id="95a9a-237">Эта версия не поддерживает поворота tooa другой ключ.</span><span class="sxs-lookup"><span data-stu-id="95a9a-237">It doesn't support rotating tooa different key.</span></span>

   ![Снимок экрана с окном "Ключи" и выделенным пунктом "Новая версия"](./media/data-lake-store-encryption/keynewversion.png)

4.  <span data-ttu-id="95a9a-239">Учетная запись хранения в хранилище Озера данных toohello перейдите и выберите **шифрования**.</span><span class="sxs-lookup"><span data-stu-id="95a9a-239">Browse toohello Data Lake Store storage account, and select **Encryption**.</span></span>

    ![Снимок экрана с окном учетной записи хранения Data Lake Store с выделенным пунктом "Шифрование"](./media/data-lake-store-encryption/select-encryption.png)

5.  <span data-ttu-id="95a9a-241">Сообщение уведомляет о том, что новая версия ключа hello ключ доступен.</span><span class="sxs-lookup"><span data-stu-id="95a9a-241">A message notifies you that a new key version of hello key is available.</span></span> <span data-ttu-id="95a9a-242">Нажмите кнопку **Поворачивайте ключ** tooupdate hello ключа toohello новой версии.</span><span class="sxs-lookup"><span data-stu-id="95a9a-242">Click **Rotate Key** tooupdate hello key toohello new version.</span></span>

    ![Снимок экрана с окном Data Lake Store с сообщением и выделенным пунктом "Сменить ключ"](./media/data-lake-store-encryption/rotatekey.png)

<span data-ttu-id="95a9a-244">Эта операция займет не более двух минут, и нет отсутствует ожидаемое время простоя из-за tookey поворота.</span><span class="sxs-lookup"><span data-stu-id="95a9a-244">This operation should take less than two minutes, and there is no expected downtime due tookey rotation.</span></span> <span data-ttu-id="95a9a-245">По завершении операции hello hello новую версию hello ключ уже используется.</span><span class="sxs-lookup"><span data-stu-id="95a9a-245">After hello operation is complete, hello new version of hello key is in use.</span></span>
