---
title: "Защита доступа к Azure RemoteApp и дополнительные возможности | Документация Майкрософт"
description: "Узнайте, как безопасно осуществлять доступ к Azure RemoteApp с помощью условного доступа в Azure Active Directory"
services: remoteapp
documentationcenter: 
author: piotrci
manager: mbaldwin
ms.assetid: a19b0b09-ab26-4beb-80bb-33a46da39887
ms.service: remoteapp
ms.workload: compute
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/26/2017
ms.author: mbaldwin
ms.openlocfilehash: 28ee4698515d11964e5371628d21dbc00687c861
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="securing-access-to-azure-remoteapp-and-beyond"></a>Защита доступа к Azure RemoteApp и дополнительные возможности
> [!IMPORTANT]
> Мы выводим службу Azure RemoteApp из эксплуатации 31 августа 2017 года. Дополнительные сведения см. в [объявлении](https://go.microsoft.com/fwlink/?linkid=821148).
> 
> 

В этой статье объясняется, как администратор может настроить канал безопасного доступа. Этот канал начинается с пользователя, идет через Azure RemoteApp и заканчивается на защищенном ресурсе, например в базе данных SQL или на другом внутреннем ресурсе приложения. Этот канал создается, чтобы к удаленным приложениям получали доступ только авторизованные пользователи, которые отвечают всем необходимым условиям, и чтобы к защищенному внутреннему ресурсу был возможен доступ только из управляемой среды Azure RemoteApp.

Администратор должен задать себе три вопроса:

![Рекомендации по условному доступу Azure RemoteApp](./media/remoteapp-secureaccess/ra-conditionalenvironment.png)

Далее приводятся ответы на эти вопросы.

## <a name="who-can-access-the-collection"></a>Кто может получить доступ к коллекции?
Администратор выбирает пользователей, которые имеют доступ к удаленным приложениям в коллекции. Можно использовать рабочие или учебные учетные записи Azure Active Directory (Azure AD) (раньше они назывались учетными записями в организации) или учетные записи Майкрософт (например, @outlook.com). В большинстве сценариев для предприятий используются учетные записи Azure AD. Такие записи позволяют использовать функции условного доступа, описанные далее, а также являются единственным вариантом для коллекций, присоединенных к домену. Далее в статье предполагается, что вы используете учетные записи Azure AD с Azure RemoteApp.

**Чего мы добились**

Использование учетных записей Azure AD для управления доступом к Azure RemoteApp дает нам два преимущества.

1. Мы всегда знаем, кто имеет доступ к приложениям, которые мы публикуем, и кто имеет доступ к внутренним ресурсам, к которым подключаются эти приложения.
2. Мы управляем основными сведениями Azure AD, т. е. мы можем создавать и удалять учетные записи пользователей, устанавливать политики паролей, использовать многофакторную проверку подлинности и т. д. 

## <a name="how-is-the-collection-accessed-from-where"></a>Как осуществляется доступ к коллекции? Откуда?
Обычно администраторам нужно определять политики для доступа к общедоступной среде (с выходом в Интернет), например Azure RemoteApp. Например, они настраивают систему так, чтобы пользователи, обращающиеся к среде не из корпоративной сети, должны использовать многофакторную проверку подлинности (MFA) для получения доступа. Иногда такие пользователи полностью блокируются.

Администраторы Azure RemoteApp могут использовать функциональные возможности, доступные в Azure AD Premium, чтобы настраивать политики условного доступа для своей среды Azure RemoteApp. Они также могут пользоваться функциями создания отчетов и оповещений для мониторинга среды, к которой осуществляется доступ.

### <a name="how-to-set-up-conditional-access-for-azure-remoteapp"></a>Как настроить условный доступ для Azure RemoteApp
Разберем пример сценария: администратору Azure RemoteApp необходимо заблокировать доступ к среде для пользователей, которые находятся за пределами корпоративной сети.

> [!NOTE]
> Предполагается, что вы используете Azure AD Premium и создали хотя бы одну коллекцию Azure RemoteApp.
> 
> 

1. На портале Azure откройте вкладку **Active Directory** . Выберите каталог, который требуется настроить.
   
   Помните, что условный доступ является свойством каталога, а не Azure RemoteApp, поэтому все настройки выполняются на уровне каталога. Это также означает, что вносить такие изменения может только администратор каталога.
2. Щелкните **Приложения** > **Microsoft Azure RemoteApp**, чтобы настроить условный доступ. Обратите внимание, что условный доступ можно настроить отдельно для каждого приложения SaaS (программное обеспечение как услуга) в каталоге.
   ![Настройка условного доступа для Azure RemoteApp](./media/remoteapp-secureaccess/ra-conditionalaccessscreen.png)
3. На вкладке **Настройка** установите для параметра **Включение правил доступа** значение "ВКЛ".
   ![Включение правил доступа для Azure RemoteApp](./media/remoteapp-secureaccess/ra-enableaccessrules.png)
4. Теперь вы можете настроить разные правила и выбрать, к кому их применить.
   
   1. Выберите параметр **Блокировать доступ, если не на работе** , чтобы полностью запретить доступ к Azure RemoteApp пользователям, которые находятся за пределами указанной вам сети.
   2. Выберите параметр ниже, чтобы определить диапазоны IP-адресов, составляющих "доверенную сеть". Все IP-адреса за пределами этого диапазона будут отклонены.
5. Проверьте конфигурацию, запустив клиент Azure RemoteApp с IP-адреса, который находится за пределами указанного диапазона. После входа в систему с помощью своих учетных данных Azure AD вы увидите примерно следующее сообщение:

![Отказ в доступе к Azure RemoteApp](./media/remoteapp-secureaccess/ra-accessdenied.png)

### <a name="future-conditional-access-features"></a>Разрабатываемые функции условного доступа
Команда Azure Active Directory работает над новыми возможностями условного доступа. Администраторы смогут создавать новые типы правил, помимо правил на основе расположения сети. Скоро появится общедоступная предварительная версия новых функциональных возможностей.

### <a name="how-to-monitor-access-to-azure-remoteapp"></a>Отслеживание доступа к Azure RemoteApp
Вместе с условным доступом хорошо использовать функцию создания отчетов Azure Active Directory Premium. Вы можете использовать отчеты, чтобы отслеживать доступ к своей среде и обнаруживать подозрительные действия.

Например, вы можете видеть имена пользователей, обращающихся к Azure RemoteApp, а также количество и время обращений.

1. На портале Azure щелкните **Active Directory**, а затем выберите свой каталог.
2. Откройте вкладку **Отчеты** .
3. В списке отчетов в разделе **Интегрированные приложения** выберите **Использование приложения**.
   
   Вы увидите сводные статистические данные для удаленного приложения Azure RemoteApp. 
   ![Объединенная статистика доступа Azure RemoteApp](./media/remoteapp-secureaccess/ra-accessstats.png)
4. Щелкните приложение, чтобы отобразить сведения о пользователях, которые обращались к удаленному приложению Azure RemoteApp.
   ![Статистика доступа пользователей к Azure RemoteApp](./media/remoteapp-secureaccess/ra-userstats.png)

### <a name="summary"></a>Сводка
С помощью Azure Active Directory Premium можно настроить правила доступа к Azure RemoteApp (и другим программам, так как приложения-службы доступны через Azure AD). Правила в настоящее время ограничены политиками на основе расположения сети, но в будущем они будут дополнены другими возможностями управления предприятием.

Azure AD Premium также предлагает функции создания отчетов и мониторинга, которые расширяют возможности управления средой Azure RemoteApp, доступные администратору.

## <a name="how-do-i-make-sure-my-secure-resource-is-accessible-only-from-my-azure-remoteapp-environment"></a>Что нужно сделать, чтобы доступ к моему защищенному ресурсу был возможен только из моей среды Azure RemoteApp?
В предыдущих разделах этой статьи мы рассмотрели возможности безопасного доступа к среде Azure RemoteApp. Эти возможности реализуются путем выбора пользователей, которым разрешен доступ, и настройки правил доступа, которые определяют то, как будет использоваться служба.

Удаленным приложениям необходимо взаимодействовать с внутренним ресурсом, например базой данных SQL. Это распространенный сценарий для развертываний Azure RemoteApp. Этот ресурс расположен локально (например, в корпоративной сети) или в облаке (например, в Azure IaaS). Администраторам часто нужно, чтобы доступ к внутреннему ресурсу осуществлялся только из приложения, развернутого с помощью Azure RemoteApp, а не из приложения, которое работает непосредственно на компьютере пользователя и доступ к которому осуществляется через Интернет. Azure RemoteApp часто рассматривается как защищенная среда с централизованным управлением и единственный канал, через который пользователи должны взаимодействовать с внутренним ресурсом.

Рекомендуется размещать среду Azure RemoteApp и защищенный ресурс в одной виртуальной сети Azure (VNET). Если ресурс находится в другом месте, нужно установить VPN-подключение "сеть–сеть", чтобы создать виртуальную сеть, которая будет объединять центр обработки данных Azure и локальную среду клиента.

Azure RemoteApp поддерживает два типа развертываний коллекции, в которых вы можете создать собственную виртуальную сеть.

* Без присоединения к домену — приложения будут в пределах "прямой видимости" для других ресурсов в виртуальной сети. Например, это можно использовать для подключения приложения к базе данных SQL, которая использует проверку подлинности SQL (приложения проверяют подлинность пользователя непосредственно в базе данных)
* С присоединением к домену — виртуальные машины, используемые Azure RemoteApp, присоединяются к контроллеру домена в виртуальной сети. Это полезно, если приложения должны проходить аутентификацию в контроллере домена Windows для получения доступа к внутреннему ресурсу.
  ![Присоединенная к домену коллекция в Azure RemoteApp](./media/remoteapp-secureaccess/ra-domainjoined.png)

### <a name="how-to-create-a-secure-connection-between-azure-and-my-on-premises-environment"></a>Создание безопасного подключения между Azure и локальной средой
Существует несколько вариантов настройки подключения между Azure и локальной средой. Мы приводим их подробный обзор.

Сначала вам нужно настроить виртуальную сеть с помощью Azure RemoteApp, а затем использовать эту сеть во время создания коллекции. 

## <a name="the-complete-solution"></a>Полное решение
На следующей схеме показано полное решение, в котором мы создали канал безопасного доступа, связывающий пользователя через Azure RemoteApp (ARA) с внутренним ресурсом.
![Защищенная среда Azure RemoteApp](./media/remoteapp-secureaccess/ra-secureoverview.png) На этапе 1 мы выбрали пользователей и создали правила доступа, определяющие способ обращения к ARA. В этом примере мы разрешили доступ только пользователям, работающим в корпоративной сети. Пользователи, которые не отвечают этому условию, не смогут получить доступ к среде ARA.
На этапе 2 мы предоставили доступ к внутреннему ресурсу только через конфигурацию виртуальной сети и VPN, которой мы управляем. Azure RemoteApp находится в той же виртуальной сети. В результате ресурс доступен только через среду ARA.

