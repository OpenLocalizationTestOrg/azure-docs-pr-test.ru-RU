---
title: "пространства имен в паре aaaAzure Service Bus | Документы Microsoft"
description: "Сведения о реализации и затратах для сопряженных пространств имен"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 2440c8d3-ed2e-47e0-93cf-ab7fbb855d2e
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: sethm
ms.openlocfilehash: 4c44b2b95d2228e1ad8075b52634d88a1593d3b1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="paired-namespace-implementation-details-and-cost-implications"></a><span data-ttu-id="32f97-103">Сведения о реализации и финансовых затратах для сопряженных пространств имен</span><span class="sxs-lookup"><span data-stu-id="32f97-103">Paired namespace implementation details and cost implications</span></span>
<span data-ttu-id="32f97-104">Hello [PairNamespaceAsync] [ PairNamespaceAsync] метод, с помощью [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] экземпляр, выполняет видимые задачи от вашего имени.</span><span class="sxs-lookup"><span data-stu-id="32f97-104">hello [PairNamespaceAsync][PairNamespaceAsync] method, using a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance, performs visible tasks on your behalf.</span></span> <span data-ttu-id="32f97-105">Так как при использовании функции hello стоимости вопросы, бывает полезно toounderstand тех задач, чтобы ожидать поведения hello, это происходит при.</span><span class="sxs-lookup"><span data-stu-id="32f97-105">Because there are cost considerations when using hello feature, it is useful toounderstand those tasks so that you expect hello behavior when it happens.</span></span> <span data-ttu-id="32f97-106">Hello API использует следующие автоматическое поведение от вашего имени hello:</span><span class="sxs-lookup"><span data-stu-id="32f97-106">hello API engages hello following automatic behavior on your behalf:</span></span>

* <span data-ttu-id="32f97-107">Создает очереди невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-107">Creation of backlog queues.</span></span>
* <span data-ttu-id="32f97-108">Создание [MessageSender] [ MessageSender] объекта говорят tooqueues или разделы.</span><span class="sxs-lookup"><span data-stu-id="32f97-108">Creation of a [MessageSender][MessageSender] object that talks tooqueues or topics.</span></span>
* <span data-ttu-id="32f97-109">Сущности обмена сообщениями становится недоступной, отправляет сообщения проверки связи toohello сущности в toodetect попытки при этой сущности снова становится доступной.</span><span class="sxs-lookup"><span data-stu-id="32f97-109">When a messaging entity becomes unavailable, sends ping messages toohello entity in an attempt toodetect when that entity becomes available again.</span></span>
* <span data-ttu-id="32f97-110">Дополнительно создается набор «конвейеров сообщений» hello, перемещение сообщения из очередей основной toohello очередей невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-110">Optionally creates of a set of “message pumps” that move messages from hello backlog queues toohello primary queues.</span></span>
* <span data-ttu-id="32f97-111">Согласовывает закрытие или завершение со сбоем hello первичного и вторичного [MessagingFactory] [ MessagingFactory] экземпляров.</span><span class="sxs-lookup"><span data-stu-id="32f97-111">Coordinates closing/faulting of hello primary and secondary [MessagingFactory][MessagingFactory] instances.</span></span>

<span data-ttu-id="32f97-112">На высоком уровне hello функция работает следующим образом: Если hello основная сущность работоспособна, изменения поведения не происходят.</span><span class="sxs-lookup"><span data-stu-id="32f97-112">At a high level, hello feature works as follows: when hello primary entity is healthy, no behavior changes occur.</span></span> <span data-ttu-id="32f97-113">Здравствуйте, когда [FailoverInterval] [ FailoverInterval] истекает период и основная сущность hello видит не отправляет успешно после непереходные [MessagingException] [ MessagingException] или [TimeoutException][TimeoutException], происходит следующая поведение hello:</span><span class="sxs-lookup"><span data-stu-id="32f97-113">When hello [FailoverInterval][FailoverInterval] duration elapses, and hello primary entity sees no successful sends after a non-transient [MessagingException][MessagingException] or a [TimeoutException][TimeoutException], hello following behavior occurs:</span></span>

1. <span data-ttu-id="32f97-114">Toohello операции отправки основной сущности отключаются, и hello системы связи hello основной сущности, пока не будет успешно доставлено проверки связи.</span><span class="sxs-lookup"><span data-stu-id="32f97-114">Send operations toohello primary entity are disabled and hello system pings hello primary entity until pings can be successfully delivered.</span></span>
2. <span data-ttu-id="32f97-115">Выбирается произвольная очередь невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-115">A random backlog queue is selected.</span></span>
3. <span data-ttu-id="32f97-116">[BrokeredMessage] [ BrokeredMessage] объектов, перенаправленных toohello выбрана очередь невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-116">[BrokeredMessage][BrokeredMessage] objects are routed toohello chosen backlog queue.</span></span>
4. <span data-ttu-id="32f97-117">Если происходит сбой toohello операции отправки, выбрана очередь невыполненной работы, эта очередь убирается из ротации hello и новая очередь.</span><span class="sxs-lookup"><span data-stu-id="32f97-117">If a send operation toohello chosen backlog queue fails, that queue is pulled from hello rotation and a new queue is selected.</span></span> <span data-ttu-id="32f97-118">Все отправители в hello [MessagingFactory] [ MessagingFactory] экземпляр узнать hello сбоя.</span><span class="sxs-lookup"><span data-stu-id="32f97-118">All senders on hello [MessagingFactory][MessagingFactory] instance learn of hello failure.</span></span>

<span data-ttu-id="32f97-119">Hello следующие данные описывают последовательность hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-119">hello following figures depict hello sequence.</span></span> <span data-ttu-id="32f97-120">Во-первых hello отправитель отправляет сообщения.</span><span class="sxs-lookup"><span data-stu-id="32f97-120">First, hello sender sends messages.</span></span>

![Сопряженные пространства имен][0]

<span data-ttu-id="32f97-122">После сбоя toosend toohello основную очередь hello отправитель начинает отправлять сообщения tooa выбрана случайным образом очередь невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-122">Upon failure toosend toohello primary queue, hello sender begins sending messages tooa randomly chosen backlog queue.</span></span> <span data-ttu-id="32f97-123">Одновременно он запускает задачу проверки связи.</span><span class="sxs-lookup"><span data-stu-id="32f97-123">Simultaneously, it starts a ping task.</span></span>

![Сопряженные пространства имен][1]

<span data-ttu-id="32f97-125">На этом этапе сообщения hello все еще находятся в дополнительной очереди hello и не были доставлены toohello основную очередь.</span><span class="sxs-lookup"><span data-stu-id="32f97-125">At this point hello messages are still in hello secondary queue and have not been delivered toohello primary queue.</span></span> <span data-ttu-id="32f97-126">После hello основная очередь снова становится работоспособной, по крайней мере один процесс должен быть запущен процесс выкачивания hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-126">Once hello primary queue is healthy again, at least one process should be running hello syphon.</span></span> <span data-ttu-id="32f97-127">Hello выкачивания доставляет сообщения hello из различных невыполненной работы всех приветствия очереди toohello соответствующие сущности назначения (очереди и разделы).</span><span class="sxs-lookup"><span data-stu-id="32f97-127">hello syphon delivers hello messages from all hello various backlog queues toohello proper destination entities (queues and topics).</span></span>

![Сопряженные пространства имен][2]

<span data-ttu-id="32f97-129">Hello оставшейся части этого раздела обсуждаются hello определенные сведения о работе этих частей.</span><span class="sxs-lookup"><span data-stu-id="32f97-129">hello remainder of this topic discusses hello specific details of how these pieces work.</span></span>

## <a name="creation-of-backlog-queues"></a><span data-ttu-id="32f97-130">Создание очередей невыполненной работы</span><span class="sxs-lookup"><span data-stu-id="32f97-130">Creation of backlog queues</span></span>
<span data-ttu-id="32f97-131">Hello [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] объекта, переданного toohello [PairNamespaceAsync] [ PairNamespaceAsync] hello указывает, метод число невыполненной работы по очереди, вы хотите toouse.</span><span class="sxs-lookup"><span data-stu-id="32f97-131">hello [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] object passed toohello [PairNamespaceAsync][PairNamespaceAsync] method indicates hello number of backlog queues you want toouse.</span></span> <span data-ttu-id="32f97-132">Каждая очередь невыполненной работы затем создается hello следующие свойства явным образом задать (все остальные значения устанавливаются toohello [QueueDescription] [ QueueDescription] значения по умолчанию):</span><span class="sxs-lookup"><span data-stu-id="32f97-132">Each backlog queue is then created with hello following properties explicitly set (all other values are set toohello [QueueDescription][QueueDescription] defaults):</span></span>

| <span data-ttu-id="32f97-133">Путь</span><span class="sxs-lookup"><span data-stu-id="32f97-133">Path</span></span> | <span data-ttu-id="32f97-134">[основное пространство имен]/x-servicebus-transfer/[индекс], где [индекс] — это значение в диапазоне [0, BacklogQueueCount)</span><span class="sxs-lookup"><span data-stu-id="32f97-134">[primary namespace]/x-servicebus-transfer/[index] where [index] is a value in [0, BacklogQueueCount)</span></span> |
| --- | --- |
| <span data-ttu-id="32f97-135">MaxSizeInMegabytes</span><span class="sxs-lookup"><span data-stu-id="32f97-135">MaxSizeInMegabytes</span></span> |<span data-ttu-id="32f97-136">5120</span><span class="sxs-lookup"><span data-stu-id="32f97-136">5120</span></span> |
| <span data-ttu-id="32f97-137">MaxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="32f97-137">MaxDeliveryCount</span></span> |<span data-ttu-id="32f97-138">int.MaxValue</span><span class="sxs-lookup"><span data-stu-id="32f97-138">int.MaxValue</span></span> |
| <span data-ttu-id="32f97-139">DefaultMessageTimeToLive</span><span class="sxs-lookup"><span data-stu-id="32f97-139">DefaultMessageTimeToLive</span></span> |<span data-ttu-id="32f97-140">TimeSpan.MaxValue</span><span class="sxs-lookup"><span data-stu-id="32f97-140">TimeSpan.MaxValue</span></span> |
| <span data-ttu-id="32f97-141">AutoDeleteOnIdle</span><span class="sxs-lookup"><span data-stu-id="32f97-141">AutoDeleteOnIdle</span></span> |<span data-ttu-id="32f97-142">TimeSpan.MaxValue</span><span class="sxs-lookup"><span data-stu-id="32f97-142">TimeSpan.MaxValue</span></span> |
| <span data-ttu-id="32f97-143">LockDuration</span><span class="sxs-lookup"><span data-stu-id="32f97-143">LockDuration</span></span> |<span data-ttu-id="32f97-144">1 минута</span><span class="sxs-lookup"><span data-stu-id="32f97-144">1 minute</span></span> |
| <span data-ttu-id="32f97-145">EnableDeadLetteringOnMessageExpiration</span><span class="sxs-lookup"><span data-stu-id="32f97-145">EnableDeadLetteringOnMessageExpiration</span></span> |<span data-ttu-id="32f97-146">Да</span><span class="sxs-lookup"><span data-stu-id="32f97-146">true</span></span> |
| <span data-ttu-id="32f97-147">EnableBatchedOperations</span><span class="sxs-lookup"><span data-stu-id="32f97-147">EnableBatchedOperations</span></span> |<span data-ttu-id="32f97-148">Да</span><span class="sxs-lookup"><span data-stu-id="32f97-148">true</span></span> |

<span data-ttu-id="32f97-149">Например, первая очередь невыполненной работы hello создается для пространства имен **contoso** называется `contoso/x-servicebus-transfer/0`.</span><span class="sxs-lookup"><span data-stu-id="32f97-149">For example, hello first backlog queue created for namespace **contoso** is named `contoso/x-servicebus-transfer/0`.</span></span>

<span data-ttu-id="32f97-150">При создании очереди hello, hello код сначала проверяет toosee, если такая очередь существует.</span><span class="sxs-lookup"><span data-stu-id="32f97-150">When creating hello queues, hello code first checks toosee if such a queue exists.</span></span> <span data-ttu-id="32f97-151">Если очередь hello не существует, создается очередь hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-151">If hello queue does not exist, then hello queue is created.</span></span> <span data-ttu-id="32f97-152">Код Hello не Очистка очередей невыполненной работы «дополнительному».</span><span class="sxs-lookup"><span data-stu-id="32f97-152">hello code does not clean up "extra" backlog queues.</span></span> <span data-ttu-id="32f97-153">В частности, если hello приложения с hello основного пространства имен **contoso** запрашивает пять очередей невыполненной работы, но очередь невыполненной работы по пути hello `contoso/x-servicebus-transfer/7` существует, эта дополнительная очередь по-прежнему присутствует, но не используется.</span><span class="sxs-lookup"><span data-stu-id="32f97-153">Specifically, if hello application with hello primary namespace **contoso** requests five backlog queues but a backlog queue with hello path `contoso/x-servicebus-transfer/7` exists, that extra backlog queue is still present but is not used.</span></span> <span data-ttu-id="32f97-154">Hello система явно разрешает tooexist дополнительная очереди, не будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="32f97-154">hello system explicitly allows extra backlog queues tooexist that would not be used.</span></span> <span data-ttu-id="32f97-155">Владелец пространства имен hello ответственного за очистку всех неиспользуемых и нежелательных невыполненной работы очередей.</span><span class="sxs-lookup"><span data-stu-id="32f97-155">As hello namespace owner, you are responsible for cleaning up any unused/unwanted backlog queues.</span></span> <span data-ttu-id="32f97-156">Hello причину принятия этого решения является, Service Bus не знает, чего предназначены все очереди hello в пространстве имен.</span><span class="sxs-lookup"><span data-stu-id="32f97-156">hello reason for this decision is that Service Bus cannot know what purposes exist for all hello queues in your namespace.</span></span> <span data-ttu-id="32f97-157">Кроме того Если очередь с заданным именем hello существует, но не соответствует hello предполагается, что [QueueDescription][QueueDescription], то причины не свой собственный изменение стандартного поведения hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-157">Furthermore, if a queue exists with hello given name but does not meet hello assumed [QueueDescription][QueueDescription], then your reasons are your own for changing hello default behavior.</span></span> <span data-ttu-id="32f97-158">Гарантии не предоставляются для очередей невыполненной работы toohello изменения в коде.</span><span class="sxs-lookup"><span data-stu-id="32f97-158">No guarantees are made for modifications toohello backlog queues by your code.</span></span> <span data-ttu-id="32f97-159">Убедитесь, что tootest изменения тщательно.</span><span class="sxs-lookup"><span data-stu-id="32f97-159">Make sure tootest your changes thoroughly.</span></span>

## <a name="custom-messagesender"></a><span data-ttu-id="32f97-160">Пользовательский объект MessageSender</span><span class="sxs-lookup"><span data-stu-id="32f97-160">Custom MessageSender</span></span>
<span data-ttu-id="32f97-161">При отправке, все сообщения проходят через внутренний [MessageSender] [ MessageSender] объекта, который работает нормально, когда все работает и перенаправляет toohello очередей невыполненной работы, когда вещей «прервать.»</span><span class="sxs-lookup"><span data-stu-id="32f97-161">When sending, all messages go through an internal [MessageSender][MessageSender] object that behaves normally when everything works, and redirects toohello backlog queues when things "break."</span></span> <span data-ttu-id="32f97-162">При возникновении ошибки, которая не является временной, запускается таймер.</span><span class="sxs-lookup"><span data-stu-id="32f97-162">Upon receiving a non-transient failure, a timer starts.</span></span> <span data-ttu-id="32f97-163">После [TimeSpan] [ TimeSpan] период, состоящий из hello [FailoverInterval] [ FailoverInterval] значение свойства, во время которого нет успешно отправленных сообщений , запускается отработка отказа hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-163">After a [TimeSpan][TimeSpan] period consisting of hello [FailoverInterval][FailoverInterval] property value during which no successful messages are sent, hello failover is engaged.</span></span> <span data-ttu-id="32f97-164">На этом этапе hello выполняются следующие действия для каждой сущности.</span><span class="sxs-lookup"><span data-stu-id="32f97-164">At this point, hello following things happen for each entity:</span></span>

* <span data-ttu-id="32f97-165">Выполняется задача проверки связи каждого [PingPrimaryInterval] [ PingPrimaryInterval] toocheck при наличии hello сущности.</span><span class="sxs-lookup"><span data-stu-id="32f97-165">A ping task executes every [PingPrimaryInterval][PingPrimaryInterval] toocheck if hello entity is available.</span></span> <span data-ttu-id="32f97-166">После успешного завершения этой задачи весь клиентский код, использующий hello entity немедленно начинает отправлять новые сообщения toohello основного пространства имен.</span><span class="sxs-lookup"><span data-stu-id="32f97-166">Once this task succeeds, all client code that uses hello entity immediately starts sending new messages toohello primary namespace.</span></span>
* <span data-ttu-id="32f97-167">Будущие запросы toosend toothat же сущность от любых других отправителей приведут hello [BrokeredMessage] [ BrokeredMessage] , отправляемых toobe изменить toosit в очередь невыполненной работы hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-167">Future requests toosend toothat same entity from any other senders will result in hello [BrokeredMessage][BrokeredMessage] being sent toobe modified toosit in hello backlog queue.</span></span> <span data-ttu-id="32f97-168">Hello модификация удаляет некоторые свойства от hello [BrokeredMessage] [ BrokeredMessage] объекта и сохраняет их в другом месте.</span><span class="sxs-lookup"><span data-stu-id="32f97-168">hello modification removes some properties from hello [BrokeredMessage][BrokeredMessage] object and stores them elsewhere.</span></span> <span data-ttu-id="32f97-169">Hello следующие свойства удаляются и добавляются под новыми псевдонимами, позволяя Service Bus и hello сообщения SDK tooprocess одинаково:</span><span class="sxs-lookup"><span data-stu-id="32f97-169">hello following properties are cleared and added under a new alias, allowing Service Bus and hello SDK tooprocess messages uniformly:</span></span>

| <span data-ttu-id="32f97-170">Старое имя свойства</span><span class="sxs-lookup"><span data-stu-id="32f97-170">Old Property Name</span></span> | <span data-ttu-id="32f97-171">Новое имя свойства</span><span class="sxs-lookup"><span data-stu-id="32f97-171">New Property Name</span></span> |
| --- | --- |
| <span data-ttu-id="32f97-172">SessionId</span><span class="sxs-lookup"><span data-stu-id="32f97-172">SessionId</span></span> |<span data-ttu-id="32f97-173">x-ms-sessionid</span><span class="sxs-lookup"><span data-stu-id="32f97-173">x-ms-sessionid</span></span> |
| <span data-ttu-id="32f97-174">TimeToLive</span><span class="sxs-lookup"><span data-stu-id="32f97-174">TimeToLive</span></span> |<span data-ttu-id="32f97-175">x-ms-timetolive</span><span class="sxs-lookup"><span data-stu-id="32f97-175">x-ms-timetolive</span></span> |
| <span data-ttu-id="32f97-176">ScheduledEnqueueTimeUtc</span><span class="sxs-lookup"><span data-stu-id="32f97-176">ScheduledEnqueueTimeUtc</span></span> |<span data-ttu-id="32f97-177">x-ms-path</span><span class="sxs-lookup"><span data-stu-id="32f97-177">x-ms-path</span></span> |

<span data-ttu-id="32f97-178">Hello исходный путь назначения также сохраняется в приветственное сообщение как свойство с именем x-ms-path.</span><span class="sxs-lookup"><span data-stu-id="32f97-178">hello original destination path is also stored within hello message as a property named x-ms-path.</span></span> <span data-ttu-id="32f97-179">Такой подход позволяет сообщениям для многих toocoexist сущности в одной очереди невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-179">This design allows messages for many entities toocoexist in a single backlog queue.</span></span> <span data-ttu-id="32f97-180">Hello свойства преобразуются обратно процессом выкачивания hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-180">hello properties are translated back by hello syphon.</span></span>

<span data-ttu-id="32f97-181">пользовательские Hello [MessageSender] [ MessageSender] объекта может столкнуться с проблемами при сообщений приближается hello 256 КБ и запускается отработка отказа.</span><span class="sxs-lookup"><span data-stu-id="32f97-181">hello custom [MessageSender][MessageSender] object can encounter issues when messages approach hello 256-KB limit and failover is engaged.</span></span> <span data-ttu-id="32f97-182">пользовательские Hello [MessageSender] [ MessageSender] объект хранит сообщения для всех очередей и разделов в очередях невыполненной работы hello вместе.</span><span class="sxs-lookup"><span data-stu-id="32f97-182">hello custom [MessageSender][MessageSender] object stores messages for all queues and topics together in hello backlog queues.</span></span> <span data-ttu-id="32f97-183">Этот объект смешивает сообщения из нескольких источников вместе в очередях невыполненной работы hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-183">This object mixes messages from many primaries together within hello backlog queues.</span></span> <span data-ttu-id="32f97-184">toohandle балансировку нагрузки между большое количество клиентов, которые не знают каждого других, hello SDK случайным образом выбирает одну очередь невыполненной работы для каждого [QueueClient] [ QueueClient] или [TopicClient] [ TopicClient] создается в коде.</span><span class="sxs-lookup"><span data-stu-id="32f97-184">toohandle load balancing among many clients that do not know each other, hello SDK randomly picks one backlog queue for each [QueueClient][QueueClient] or [TopicClient][TopicClient] you create in code.</span></span>

## <a name="pings"></a><span data-ttu-id="32f97-185">Проверка связи</span><span class="sxs-lookup"><span data-stu-id="32f97-185">Pings</span></span>
<span data-ttu-id="32f97-186">Сообщение ping — это пустой [BrokeredMessage] [ BrokeredMessage] с его [ContentType] [ ContentType] свойство tooapplication/vnd.ms-servicebus-ping и [TimeToLive] [ TimeToLive] значение равно 1 секунде.</span><span class="sxs-lookup"><span data-stu-id="32f97-186">A ping message is an empty [BrokeredMessage][BrokeredMessage] with its [ContentType][ContentType] property set tooapplication/vnd.ms-servicebus-ping and a [TimeToLive][TimeToLive] value of 1 second.</span></span> <span data-ttu-id="32f97-187">Проверка связи имеет одну особенность в Service Bus: hello сервер никогда не доставляет сообщение проверки связи, когда любой вызывающий объект запрашивает [BrokeredMessage][BrokeredMessage].</span><span class="sxs-lookup"><span data-stu-id="32f97-187">This ping has one special characteristic in Service Bus: hello server never delivers a ping when any caller requests a [BrokeredMessage][BrokeredMessage].</span></span> <span data-ttu-id="32f97-188">Таким образом, никогда не toolearn как tooreceive и пропускать эти сообщения.</span><span class="sxs-lookup"><span data-stu-id="32f97-188">Thus, you never have toolearn how tooreceive and ignore these messages.</span></span> <span data-ttu-id="32f97-189">Каждой сущности (уникальной очереди или раздела) на [MessagingFactory] [ MessagingFactory] экземпляр на одного клиента выполняется проверка связи, когда они считаются toobe недоступна.</span><span class="sxs-lookup"><span data-stu-id="32f97-189">Each entity (unique queue or topic) per [MessagingFactory][MessagingFactory] instance per client will be pinged when they are considered toobe unavailable.</span></span> <span data-ttu-id="32f97-190">По умолчанию это происходит один раз в минуту.</span><span class="sxs-lookup"><span data-stu-id="32f97-190">By default, this happens once per minute.</span></span> <span data-ttu-id="32f97-191">Сообщения проверки связи, считаются toobe регулярных сообщений Service Bus и может привести к расходам на полосу пропускания и сообщения.</span><span class="sxs-lookup"><span data-stu-id="32f97-191">Ping messages are considered toobe regular Service Bus messages, and can result in charges for bandwidth and messages.</span></span> <span data-ttu-id="32f97-192">Как только hello клиенты обнаруживают, что система hello доступна, остановите сообщений hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-192">As soon as hello clients detect that hello system is available, hello messages stop.</span></span>

## <a name="hello-syphon"></a><span data-ttu-id="32f97-193">процесс выкачивания Hello</span><span class="sxs-lookup"><span data-stu-id="32f97-193">hello syphon</span></span>
<span data-ttu-id="32f97-194">Процесс выкачивания hello должен активно выполнять по крайней мере один исполняемый файл в приложение hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-194">At least one executable program in hello application should be actively running hello syphon.</span></span> <span data-ttu-id="32f97-195">процесс выкачивания Hello выполняет long опроса получения, которая длится 15 минут.</span><span class="sxs-lookup"><span data-stu-id="32f97-195">hello syphon performs a long poll receive that lasts 15 minutes.</span></span> <span data-ttu-id="32f97-196">Когда все сущности доступны и имеется 10 очередей невыполненной работы, Здравствуйте, приложения, в котором hello процесс выкачивания вызывает hello получать операции 40 раз в час, 960 раз в день и 28 800 раз в 30 дней.</span><span class="sxs-lookup"><span data-stu-id="32f97-196">When all entities are available and you have 10 backlog queues, hello application that hosts hello syphon calls hello receive operation 40 times per hour, 960 times per day, and 28800 times in 30 days.</span></span> <span data-ttu-id="32f97-197">Когда hello выкачивания активно перемещает сообщения из основной очереди hello невыполненной работы toohello, каждое сообщение вносятся hello, следуя расходов (на всех этапах взимается Стандартная плата за размер сообщения и пропускной способности):</span><span class="sxs-lookup"><span data-stu-id="32f97-197">When hello syphon is actively moving messages from hello backlog toohello primary queue, each message experiences hello following charges (standard charges for message size and bandwidth apply in all stages):</span></span>

1. <span data-ttu-id="32f97-198">Отправьте toohello невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-198">Send toohello backlog.</span></span>
2. <span data-ttu-id="32f97-199">Получать от hello невыполненной работы.</span><span class="sxs-lookup"><span data-stu-id="32f97-199">Receive from hello backlog.</span></span>
3. <span data-ttu-id="32f97-200">Отправьте toohello первичной.</span><span class="sxs-lookup"><span data-stu-id="32f97-200">Send toohello primary.</span></span>
4. <span data-ttu-id="32f97-201">Получает от основного hello.</span><span class="sxs-lookup"><span data-stu-id="32f97-201">Receive from hello primary.</span></span>

## <a name="closefault-behavior"></a><span data-ttu-id="32f97-202">Поведение при закрытии или сбое</span><span class="sxs-lookup"><span data-stu-id="32f97-202">Close/fault behavior</span></span>
<span data-ttu-id="32f97-203">В приложении, на котором размещен процесс выкачивания hello, один раз hello первичный или вторичный [MessagingFactory] [ MessagingFactory] завершает работу с ошибкой или закрыт без его партнер ошибкой или закрывает и hello процесс выкачивания обнаруживает это состояние , процесс выкачивания hello действует.</span><span class="sxs-lookup"><span data-stu-id="32f97-203">Within an application that hosts hello syphon, once hello primary or secondary [MessagingFactory][MessagingFactory] faults or is closed without its partner also being faulted/closed and hello syphon detects this state, hello syphon acts.</span></span> <span data-ttu-id="32f97-204">Если другие hello [MessagingFactory] [ MessagingFactory] не закрывается в течение 5 секунд hello выкачивания завершит со сбоем по-прежнему открытую hello [MessagingFactory] [ MessagingFactory] .</span><span class="sxs-lookup"><span data-stu-id="32f97-204">If hello other [MessagingFactory][MessagingFactory] is not closed within 5 seconds, hello syphon will fault hello still open [MessagingFactory][MessagingFactory].</span></span>

## <a name="next-steps"></a><span data-ttu-id="32f97-205">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="32f97-205">Next steps</span></span>
<span data-ttu-id="32f97-206">Подробное описание асинхронного обмена сообщениями в служебной шине см. в статье [Шаблоны асинхронного обмена сообщениями и высокий уровень доступности][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="32f97-206">See [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability] for a detailed discussion of Service Bus asynchronous messaging.</span></span> 

[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[MessageSender]: /dotnet/api/microsoft.servicebus.messaging.messagesender
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[FailoverInterval]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions#Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_FailoverInterval
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[TimeoutException]: https://msdn.microsoft.com/library/azure/system.timeoutexception.aspx
[BrokeredMessage]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage
[QueueDescription]: /dotnet/api/microsoft.servicebus.messaging.queuedescription
[TimeSpan]: https://msdn.microsoft.com/library/azure/system.timespan.aspx
[PingPrimaryInterval]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_PingPrimaryInterval
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[ContentType]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_ContentType
[TimeToLive]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md
[0]: ./media/service-bus-paired-namespaces/IC673405.png
[1]: ./media/service-bus-paired-namespaces/IC673406.png
[2]: ./media/service-bus-paired-namespaces/IC673407.png
