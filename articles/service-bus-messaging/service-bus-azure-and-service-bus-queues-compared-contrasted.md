---
title: "Очереди службы хранилища Azure и очереди служебной шины: сходства и различия | Документация Майкрософт"
description: "Анализ сходства и различий между двумя типами очередей, предлагаемых в Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: f07301dc-ca9b-465c-bd5b-a0f99bab606b
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: tbd
ms.date: 11/08/2017
ms.author: sethm
ms.openlocfilehash: d564f3974b2bc6355bb5dc5320a5193fe3c196af
ms.sourcegitcommit: 71fa59e97b01b65f25bcae318d834358fea5224a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2018
---
# <a name="storage-queues-and-service-bus-queues---compared-and-contrasted"></a>Очереди службы хранилища и очереди служебной шины: сходства и различия
В этой статье рассматриваются сходства и различия между двумя типами очередей, предлагаемых Microsoft Azure: очередями службы хранилища и очередями служебной шины. Эти сведения помогут вам сопоставить эти технологии и выбрать решение, которое лучше всего отвечает вашим требованиям.

## <a name="introduction"></a>Введение
Azure поддерживает два типа очередей: **очереди службы хранилища** и **очереди служебной шины**.

**Очереди службы хранилища** являются частью инфраструктуры [службы хранилища Azure](https://azure.microsoft.com/services/storage/) и предоставляют простой интерфейс REST с операциями GET, PUT и PEEK для надежного обмена сообщениями внутри служб и между ними.

**Очереди служебной шины** входят в более обширную инфраструктуру [обмена сообщениями Azure](https://azure.microsoft.com/services/service-bus/), поддерживающую очереди, публикации и подписки, а также более сложные шаблоны интеграции. Дополнительные сведения об очередях служебной шины, разделах и подписках см. в [обзоре служебной шины](service-bus-messaging-overview.md).

Несмотря на то что описываемые технологии очередей существуют параллельно, очереди службы хранилища появились раньше как выделенный механизм хранения очередей на базе служб хранилища Azure. Очереди служебной шины разработаны на основе более масштабной инфраструктуры обмена сообщениями, предназначенной для интеграции приложений или их компонентов и охватывающей различные протоколы связи, контракты данных, доверенные домены и (или) сети.

## <a name="technology-selection-considerations"></a>Рекомендации по выбору технологии
И очереди службы хранилища, и очереди служебной шины являются вариантами реализации службы очередей сообщений, доступной в настоящее время в Microsoft Azure. Предлагаемые ими наборы функций немного различаются, поэтому вы можете использовать как один, так и оба варианта в зависимости от потребностей конкретного решения либо бизнес- или технической задачи, которую вы пытаетесь решить.

При выборе технологии очередей под конкретные цели и задачи архитекторам и разработчикам решений следует принимать во внимание приведенные ниже рекомендации. Дополнительные сведения см. в следующем разделе.

Ниже приведены случаи, в которых архитекторам и разработчикам решений **рекомендуется использовать очереди службы хранилища**.

* Приложение должно хранить в очереди более 80 ГБ сообщений со сроком существования менее 7 дней.
* Вы хотите, чтобы приложение отслеживало ход обработки сообщения внутри очереди. В этом случае при сбое рабочего процесса, обрабатывающего сообщения, следующий рабочий процесс сможет использовать полученную информацию, чтобы продолжить обработку с того места, где произошел сбой предыдущего обработчика.
* Вам требуются серверные журналы всех примененных к очередям транзакций.

В следующих случаях архитекторам и разработчикам решений **рекомендуется использовать очереди служебной шины**:

* Решение должно иметь возможность получать сообщения, не опрашивая очередь. Это можно обеспечить за счет применения операции получения с продолжительным опросом на основе протоколов TCP, поддерживаемых служебной шиной.
* В решении требуется, чтобы очередь гарантированно доставляла сообщения в порядке их добавления в очередь (FIFO).
* Вы хотите, чтобы Azure и Windows Server работали симметрично (частное облако). Дополнительные сведения см. в статье [Служебная шина для Windows Server](https://msdn.microsoft.com/library/dn282144.aspx).
* Необходимо, чтобы решение поддерживало автоматическое обнаружение дубликатов.
* Вы хотите, чтобы приложение обрабатывало сообщения как параллельные долговременные потоки (сообщения связываются с потоком с помощью свойства [SessionId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sessionid) сообщения). В этой модели каждый узел принимающего приложения конкурирует за потоки, а не за сообщения. Когда для принимающего узла выделяется поток, узел может проверить состояние потока приложения с помощью транзакций.
* В решении требуется реализовать транзакционный режим работы и атомарность при отправке или получении нескольких сообщений из очереди.
* Срок жизни (TTL) рабочей нагрузки конкретного приложения может превышать 7 дней.
* Ваше приложение обрабатывает сообщения, размер которых может превышать 64 КБ, но вряд ли приблизится к пределу в 256 КБ.
* Вам требуется обеспечить доступ к очередям на основе ролей, а также предусмотреть различные права или разрешения для отправителей и получателей.
* Размер очереди не будет превышать 80 ГБ.
* Вы хотите использовать протокол обмена сообщениями на основе стандартов AMQP 1.0. Дополнительные сведения об AMQP см. в статье [Общие сведения о протоколе AMQP для служебной шины](service-bus-amqp-overview.md).
* Вы предполагаете, что впоследствии перейдете от двухточечной коммуникации на основе очередей к модели обмена сообщениями, позволяющей надежно интегрировать дополнительных получателей (подписчиков), каждый из которых получает независимые копии отдельных или всех сообщений, отправленных в очередь. Последнее относится к предусмотренным в служебной шине функциям публикации и подписки.
* Ваше решение для обмена сообщениями должно поддерживать гарантированную доставку "без повторов", не требуя добавления новых компонентов в инфраструктуру.
* Вам нужна возможность пакетной публикации и потребления сообщений.

## <a name="comparing-storage-queues-and-service-bus-queues"></a>Сравнение очередей службы хранилища и служебной шины
Для удобства сравнения в следующих разделах функции очередей службы хранилища Azure и служебной шины сгруппированы логически и представлены в виде таблиц.

## <a name="foundational-capabilities"></a>Основные возможности
В этом разделе сравниваются некоторые из основных возможностей, предоставляемых очередями служебной шины и службы хранилища.

| Критерии сравнения | Очереди службы хранилища | Очереди служебной шины |
| --- | --- | --- |
| Гарантированный метод упорядочивания |**Нет** <br/><br>Дополнительные сведения см. в первом примечании в разделе "Дополнительные сведения".</br> |**Да — "первым прибыл, первым обслужен" (FIFO)**<br/><br>(используются сеансы обмена сообщениями) |
| Гарантированный метод доставки |**Как минимум один раз** |**Как минимум один раз**<br/><br/>**Как минимум один раз** |
| Поддержка атомарной операции |**Нет** |**Да**<br/><br/> |
| Поведение при получении |**Без блокировки**<br/><br/>(немедленно завершается, если новые сообщения не найдены) |**Блокировка со временем ожидания или без него**<br/><br/>(продолжительный опрос, или ["метод Comet"](http://go.microsoft.com/fwlink/?LinkId=613759))<br/><br/>**Без блокировки**<br/><br/>(только с помощью управляемого интерфейса API для .NET) |
| API push-уведомлений |**Нет** |**Да**<br/><br/>Сеансы [OnMessage](/dotnet/api/microsoft.servicebus.messaging.queueclient.onmessage#Microsoft_ServiceBus_Messaging_QueueClient_OnMessage_System_Action_Microsoft_ServiceBus_Messaging_BrokeredMessage__) и **OnMessage** API-интерфейса .NET. |
| Режим получения |**Просмотр и аренда** |**Просмотр и блокировка**<br/><br/>**Получение и удаление** |
| Режим монопольного доступа |**На основе аренды** |**На основе блокировки** |
| Продолжительность аренды или блокировки |**30 секунд (по умолчанию)**<br/><br/>**7 дней (максимум)** (можно продлить или отменить аренду сообщения с помощью метода API [UpdateMessage](/dotnet/api/microsoft.windowsazure.storage.queue.cloudqueue.updatemessage)) |**60 секунд (по умолчанию)**<br/><br/>Можно возобновить блокировку сообщения с помощью метода API [RenewLock](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.renewlock#Microsoft_ServiceBus_Messaging_BrokeredMessage_RenewLock). |
| Степень детализации аренды или блокировки |**Уровень сообщения**<br/><br/>(у сообщений могут быть уникальные значения времени ожидания; при необходимости их можно обновлять в процессе обработки сообщения с помощью метода API [UpdateMessage](/dotnet/api/microsoft.windowsazure.storage.queue.cloudqueue.updatemessage)) |**Уровень очереди**<br/><br/>(для каждой очереди определена степень детализации блокировки, применяемая ко всем сообщениям в ней, однако блокировку можно продлить с помощью метода API [RenewLock](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.renewlock#Microsoft_ServiceBus_Messaging_BrokeredMessage_RenewLock)) |
| Получение в пакетном режиме |**Да**<br/><br/>(явно, путем указания количества сообщений при их извлечении; до 32 сообщений) |**Да**<br/><br/>(неявно, путем включения свойства предварительной выборки, или явно, с помощью транзакций) |
| Отправка в пакетном режиме |**Нет** |**Да**<br/><br/>(с помощью транзакций или пакетной обработки на стороне клиента) |

### <a name="additional-information"></a>Дополнительная информация
* Сообщения в очередях службы хранилища обычно располагаются в порядке их добавления (FIFO), но иногда очередность может нарушаться. Например, в результате сбоя при обработке на стороне клиентского приложения может закончиться время ожидания видимости сообщения. По истечении времени ожидания сообщение снова становится видимым, и следующий рабочий процесс может вывести его из очереди. При этом вновь ставшее видимым сообщение может быть помещено в очередь (чтобы снова быть выведенным из нее) после сообщения, которое изначально располагалось в очереди за ним.
* Для гарантированного упорядочения сообщений по методу FIFO в очередях служебной шины необходимо использовать сеансы обмена сообщениями. Если во время обработки сообщения, получаемого в режиме **Просмотр и блокировка**, произойдет сбой приложения, в следующем сеансе обмена сообщениями получатель очереди начнет работу с сообщения, на котором произошел сбой, после истечения срока жизни (TTL) этого сообщения.
* Очереди службы хранилища поддерживают стандартные сценарии использования очередей, например разделение компонентов приложений для повышения масштабируемости и отказоустойчивости, выравнивание нагрузки и создание рабочих процессов.
* Очереди служебной шины поддерживают гарантию доставки *как минимум один раз*. Кроме того, можно добавить поддержку семантики *без повторов*. При этом для хранения состояния приложения используется состояние сеанса, а для атомарного получения сообщений и обновления состояния сеанса используются транзакции.
* Очереди службы хранилища предоставляют единообразную и согласованную модель программирования для очередей, таблиц и больших двоичных объектов как разработчикам, так и специалистам по эксплуатации.
* Очереди служебной шины обеспечивают поддержку локальных транзакций в контексте одной очереди.
* Режим **Получение и удаление**, поддерживаемый служебной шиной, позволяет сократить число операций обмена сообщениями (и связанные с этим расходы) за счет понижения уровня гарантии доставки.
* Очереди службы хранилища поддерживают аренду сообщений с возможностью продления, благодаря чему рабочие процессы могут использовать краткосрочную аренду. В случае сбоя одного рабочего процесса сообщение может быть быстро обработано другим рабочим процессом. Кроме того, рабочий процесс может продлить аренду сообщения, если для его обработки требуется время, превышающее текущее время аренды.
* Очереди службы хранилища поддерживают время ожидания видимости, которое можно задавать при добавлении сообщения в очередь или выведении из нее. Кроме того, можно обновлять значения аренды сообщения в рабочем режиме, а также использовать разные значения для разных сообщений в рамках одной очереди. При использовании служебной шины время ожидания блокировки задается в метаданных очереди, однако блокировку можно возобновить с помощью метода [RenewLock](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.renewlock#Microsoft_ServiceBus_Messaging_BrokeredMessage_RenewLock).
* Максимальное время ожидания для операции получения с блокировкой в очередях служебной шины составляет 24 дня. Однако для очередей на основе REST время ожидания не может превышать 55 секунд.
* Служебная шина позволяет выполнять пакетную обработку на стороне клиента. Это означает, что клиент очереди может отправлять несколько сообщений в рамках одной операции отправки. Пакетная обработка возможна только для операций асинхронной отправки.
* Верхнее ограничение в 200 ТБ (при виртуализации учетных записей — больше) для очередей службы хранилища или полное отсутствие ограничений делают эти службы идеальной платформой для поставщиков SaaS.
* Очереди службы хранилища предоставляют гибкий и эффективный механизм управления делегированным доступом.

## <a name="advanced-capabilities"></a>Расширенные возможности
В этом разделе сравниваются расширенные возможности очередей службы хранилища и очередей служебной шины.

| Критерии сравнения | Очереди службы хранилища | Очереди служебной шины |
| --- | --- | --- |
| Доставка по расписанию |**Да** |**Да** |
| Автоматическое перемещение в "мертвую очередь" |**Нет** |**Да** |
| Увеличение срока жизни очереди |**Да**<br/><br/>(посредством обновления времени ожидания видимости "на месте") |**Да**<br/><br/>(используется выделенная функция API) |
| Поддержка сообщений о сбое |**Да** |**Да** |
| Обновление "на месте" |**Да** |**Да** |
| Журнал транзакций на стороне сервера |**Да** |**Нет** |
| Метрики хранения |**Да**<br/><br/>**Точные метрики**: в реальном времени отслеживаются доступность, количество транзакций в секунду, количество вызовов API, количество ошибок и многое другое (данные агрегируются поминутно и доступны уже через несколько минут после того, как в рабочей среде произошло то или иное событие). Дополнительные сведения см. в разделе [О метриках аналитики хранилища](/rest/api/storageservices/fileservices/About-Storage-Analytics-Metrics). |**Да**<br/><br/>(массовые запросы путем вызова [GetQueues](/dotnet/api/microsoft.servicebus.namespacemanager.getqueues#Microsoft_ServiceBus_NamespaceManager_GetQueues)) |
| Управление данными о состоянии |**Нет** |**Да**<br/><br/>[Microsoft.ServiceBus.Messaging.EntityStatus.Active](/dotnet/api/microsoft.servicebus.messaging.entitystatus), [Microsoft.ServiceBus.Messaging.EntityStatus.Disabled](/dotnet/api/microsoft.servicebus.messaging.entitystatus), [Microsoft.ServiceBus.Messaging.EntityStatus.SendDisabled](/dotnet/api/microsoft.servicebus.messaging.entitystatus), [Microsoft.ServiceBus.Messaging.EntityStatus.ReceiveDisabled](/dotnet/api/microsoft.servicebus.messaging.entitystatus) |
| Автоматическая пересылка сообщений |**Нет** |**Да** |
| Функция очистки очереди |**Да** |**Нет** |
| Группы сообщений |**Нет** |**Да**<br/><br/>(используются сеансы обмена сообщениями) |
| Состояние приложений по группам сообщений |**Нет** |**Да** |
| Обнаружение дубликатов |**Нет** |**Да**<br/><br/>(настраивается на стороне отправителя) |
| Просмотр групп сообщений |**Нет** |**Да** |
| Выборка сеансов сообщений по идентификатору |**Нет** |**Да** |

### <a name="additional-information"></a>Дополнительная информация
* Обе технологии очередей позволяют запланировать доставку сообщения в более позднее время.
* Автоматическая пересылка позволяет тысячам очередей автоматически перенаправлять сообщения в одну очередь, из которой их забирает получающее приложение. Этот механизм можно использовать для обеспечения безопасности, управления потоком и изоляции хранилищ разных создателей сообщений.
* Очереди службы хранилища поддерживают обновление содержимого сообщений. Вы можете использовать эту возможность для сохранения в сообщении сведений о состоянии и поэтапного обновления хода выполнения операций. Это позволит продолжать обработку сообщений с последней известной контрольной точки, а не с самого начала. В очередях служебной шины тот же сценарий реализуется с использованием сеансов сообщений. Сеансы позволяют сохранять и извлекать состояние обработки приложения (с помощью методов [SetState](/dotnet/api/microsoft.servicebus.messaging.messagesession.setstate#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_) и [GetState](/dotnet/api/microsoft.servicebus.messaging.messagesession.getstate#Microsoft_ServiceBus_Messaging_MessageSession_GetState)).
* Перемещение сообщений в [мертвую очередь](service-bus-dead-letter-queues.md), поддерживаемое только очередями служебной шины, может использоваться для изоляции таких сообщений, которые приложение-получатель не смогло успешно обработать, или сообщений, которые не смогли достичь места назначения из-за истечения срока жизни (TTL). Значение TTL определяет время, в течение которого сообщение остается в очереди. Если используется служебная шина, после истечения срока жизни сообщение перемещается в специальную очередь $DeadLetterQueue.
* Чтобы найти подозрительные сообщения в очередях службы хранилища, приложение проверяет свойство сообщения [DequeueCount](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.storage.queue.cloudqueuemessage.dequeuecount.aspx) при выведении его из очереди. Если значение **DequeueCount** превышает заданное пороговое значение, сообщение перемещается в определяемую приложением "мертвую очередь".
* Очереди службы хранилища позволяют получить подробный журнал всех транзакций, примененных к очереди, а также агрегированные метрики. Обе функции полезны для отладки и понимания принципов использования очередей службы хранилища в приложении. Они также помогают оптимизировать производительность приложения и сократить расходы, связанные с использованием очередей.
* Сеансы сообщений, поддерживаемые очередями служебной шины, позволяют связывать сообщения в определенной логической группе с конкретным получателем, создавая так называемое "сходство". Чтобы включить эту функцию в служебной шине, нужно задать свойство сообщения [SessionID](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sessionid#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId). Получатели смогут выполнять прослушку по конкретному идентификатору сеанса и получать сообщения с этим идентификатором.
* Функция обнаружения дубликатов, поддерживаемая очередями служебной шины, автоматически удаляет дубликаты сообщений, отправленные в очередь или раздел, используя свойство [MessageID](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.messageid#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId).

## <a name="capacity-and-quotas"></a>Емкость и квоты
В этом разделе сравниваются допустимые значения [емкости и квот](service-bus-quotas.md), которые могут использоваться в очередях служебной шины и службы хранилища.

| Критерии сравнения | Очереди службы хранилища | Очереди служебной шины |
| --- | --- | --- |
| Максимальный размер очереди |**500 ТБ**<br/><br/>(в рамках [емкости одной учетной записи хранения](../storage/common/storage-introduction.md#queue-storage)) |**От 1 до 80 ГБ**<br/><br/>(определяется при создании очереди и [включении секционирования](service-bus-partitioning.md); см. раздел "Дополнительные сведения") |
| Максимальный размер сообщения |**64 КБ**<br/><br/>(48 КБ при использовании кодировки **Base64**)<br/><br/>Azure поддерживает большие сообщения за счет сочетания очередей и больших двоичных объектов; благодаря этому можно поставить в очередь до 200 ГБ данных на один элемент. |**256 КБ** или **1 МБ**<br/><br/>(включая заголовок и текст; максимальный размер заголовка — 64 КБ).<br/><br/>Зависит от [уровня службы](service-bus-premium-messaging.md). |
| Максимальный срок жизни сообщения |**7 дней** |**TimeSpan.Max** |
| Максимальное количество очередей |**Unlimited** |**10 000**<br/><br/>(на пространство имен службы) |
| Максимальное количество параллельных клиентов |**Unlimited** |**Unlimited**<br/><br/>(к взаимодействию на основе протокола TCP применяется единственное ограничение в 100 одновременных подключений) |

### <a name="additional-information"></a>Дополнительная информация
* В служебной шине ограничения по размеру применяются принудительно. Максимальный размер очереди задается при создании очереди и может иметь значение в диапазоне от 1 до 80 ГБ. При достижении размера очереди, заданного при ее создании, последующие входящие сообщения отклоняются, а вызывающий код получает исключение. Дополнительные сведения о квотах в служебной шине см. в разделе [Квоты на служебную шину](service-bus-quotas.md).
* На [уровне "Стандартный"](service-bus-premium-messaging.md) вы можете создавать очереди служебной шины размером 1, 2, 3, 4 или 5 ГБ (по умолчанию — 1 ГБ), а на уровне "Премиум" — до 80 ГБ. Если на уровне "Стандартный" включено секционирование (по умолчанию), служебная шина создает на каждый гигабайт 16 секций. Поэтому если вы создаете очередь размером 5 ГБ с 16 разделами, максимальный размер очереди составит 80 ГБ (5 х 16). Чтобы просмотреть максимальный размер секционированной очереди или раздела, откройте соответствующую запись на [портале Azure][Azure portal]. На уровне "Премиум" для каждой очереди создаются только 2 секции.
* При использовании очередей службы хранилища содержимое сообщений, небезопасное с точки зрения XML, должно кодироваться в формат **Base64**. При кодировке сообщения методом **Base64** размер полезных данных может достигать 48 KБ (а не 64 КБ).
* Каждое сообщение, сохраненное в очереди служебной шины, состоит из двух частей: заголовка и текста. Общий размер сообщения не может превышать максимальный размер, поддерживаемый уровнем служб.
* Когда клиенты взаимодействуют с очередями служебной шины по протоколу TCP, максимальное количество одновременных подключений к отдельной очереди служебной шины не может превышать 100. Это число распределяется между отправителями и получателями. После достижения квоты запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. Это ограничение не применяется к клиентам, подключающимся к очередям с помощью интерфейса API на основе REST.
* Если требуется более 10 000 очередей в одном пространстве имен служебной шины, можно отправить запрос на увеличение в службу поддержки Azure. Чтобы увеличить количество очередей служебной шины сверх ограничения в 10 000, создайте дополнительные пространства имен на [портале Azure][Azure portal].

## <a name="management-and-operations"></a>Управление и использование
В этом разделе сравниваются возможности управления, предоставляемые очередями служебной шины и службы хранилища.

| Критерии сравнения | Очереди службы хранилища | Очереди служебной шины |
| --- | --- | --- |
| Протокол управления |**REST по протоколу HTTP/HTTPS** |**REST по протоколу HTTPS** |
| Протокол выполнения |**REST по протоколу HTTP/HTTPS** |**REST по протоколу HTTPS**<br/><br/>**Стандарт AMQP 1.0 (TCP с TLS)** |
| .NET API |**Да**<br/><br/>(API клиента службы хранилища для .NET) |**Да**<br/><br/>(API служебной шины для .NET) |
| Машинный C++ |**Да** |**Да** |
| API Java |**Да** |**Да** |
| API для PHP |**Да** |**Да** |
| API для Node.js |**Да** |**Да** |
| Поддержка произвольных метаданных |**Да** |**Нет** |
| Правила именования очередей |**Может содержать до 63 символов**<br/><br/>(Буквы в имени очереди должны быть строчными.) |**Может содержать до 260 символов**<br/><br/>(В путях и именах очередей регистр не учитывается.) |
| Функция получения длины очереди |**Да**<br/><br/>(Приблизительное значение, если сообщение не удаляется после истечения срока жизни.) |**Да**<br/><br/>(Точное значение в определенный момент времени.) |
| Функция просмотра |**Да** |**Да** |

### <a name="additional-information"></a>Дополнительная информация
* Очереди службы хранилища поддерживают произвольные атрибуты, которые могут применяться к описанию очереди, в формате пары "имя/значение"
* Обе технологии также позволяют просматривать сообщения без их блокировки, что может пригодиться при реализации браузера или проводника для очередей.
* В API для .NET для обмена сообщениями через посредника, предоставляемых служебной шиной, используются дуплексные TCP-соединения, позволяющие повысить производительность по сравнению с REST через HTTP. Они также поддерживают стандарт AMQP 1.0.
* Имена очередей службы хранилища могут содержать от 3 до 63 знаков, включая строчные буквы, цифры и дефисы (-). Дополнительные сведения см. в статье [Именование очередей и метаданных](/rest/api/storageservices/fileservices/Naming-Queues-and-Metadata).
* Имя очереди служебной шины может содержать до 260 символов. При этом действуют менее жесткие правила именования: имена очереди служебной шины могут содержать буквы, цифры, точки, дефисы и знаки подчеркивания.

## <a name="authentication-and-authorization"></a>Аутентификация и авторизация
В этом разделе рассматриваются функции аутентификации и авторизации, поддерживаемые очередями служебной шины и службы хранилища.

| Критерии сравнения | Очереди службы хранилища | Очереди служебной шины |
| --- | --- | --- |
| Authentication |**Симметричный ключ** |**Симметричный ключ** |
| Модель безопасности |Делегирование доступа через маркеры SAS |SAS |
| Федерация поставщика удостоверений |**Нет** |**Да** |

### <a name="additional-information"></a>Дополнительная информация
* В обеих технологиях очередей требуется аутентификация при каждом запросе. Общие очереди с анонимным доступом не поддерживаются. При использовании [SAS](service-bus-sas.md) вы можете публиковать SAS только для записи, SAS только для чтения или даже SAS для полного доступа.
* Аутентификация в очередях службы хранилища основана на использовании симметричного ключа, который представляет собой хэш-код аутентификации сообщения (HMAC), вычисляемый по алгоритму SHA-256 и кодируемый в виде строки **Base64**. Дополнительные сведения о соответствующем протоколе см. в статье [Проверка подлинности для служб хранилища Azure](/rest/api/storageservices/fileservices/Authentication-for-the-Azure-Storage-Services). Очереди служебной шины поддерживают аналогичную модель с использованием симметричных ключей. Дополнительные сведения см. в статье [Проверка подлинности подписанного URL-адреса с помощью служебной шины](service-bus-sas.md).

## <a name="conclusion"></a>Заключение
Глубокое понимание описанных технологий поможет вам сделать более обоснованный выбор. Решение о том, когда следует использовать очереди службы хранилища, а когда очереди служебной шины, зависит от целого ряда факторов. Все они могут в значительной степени зависеть от конкретных требований приложения и его архитектуры. Если в приложении уже используются основные возможности Microsoft Azure, то предпочтительным может оказаться использование очередей службы хранилища, особенно если необходимы базовые функции обмена информацией и сообщениями между службами или требуется работа с очередями размером более 80 ГБ.

Так как очереди служебной шины предлагают ряд расширенных функций (в том числе сеансы, транзакции, обнаружение дубликатов, автоматическое перемещение в "мертвую очередь", возможности публикации или подписки), они могут оказаться предпочтительнее для построения гибридного приложения или если в приложении они требуются по каким-либо другим причинам.

## <a name="next-steps"></a>Дополнительная информация
Для получения подробной информации и рекомендаций по использованию очередей служебной шины и службы хранилища ознакомьтесь со следующими статьями.

* [Начало работы с очередями служебной шины](service-bus-dotnet-get-started-with-queues.md)
* [Как использовать службу хранилища очередей](../storage/queues/storage-dotnet-how-to-use-queues.md)
* [Рекомендации по повышению производительности с помощью обмена сообщениями через брокер в служебной шине](service-bus-performance-improvements.md)
* [Introducing Queues and Topics in Azure Service Bus](http://www.code-magazine.com/article.aspx?quickid=1112041) (Введение в очереди и разделы служебной шины Azure) (запись блога)
* [Руководство разработчика по служебной шине](http://www.cloudcasts.net/devguide/Default.aspx?id=11030)
* [Использование службы очередей в Azure ](http://www.developerfusion.com/article/120197/using-the-queuing-service-in-windows-azure/)

[Azure portal]: https://portal.azure.com

