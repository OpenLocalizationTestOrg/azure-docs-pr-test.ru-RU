---
title: "aaaCreate секционированные очереди и разделы шины службы Azure | Документы Microsoft"
description: "Описывает, как toopartition Service Bus очереди и разделы с помощью нескольких сообщений является посредником."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 6d42556a0714d6a012dc319f662521c8b0bb958b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="8de09-103">Секционированные очереди и разделы</span><span class="sxs-lookup"><span data-stu-id="8de09-103">Partitioned queues and topics</span></span>
<span data-ttu-id="8de09-104">Azure Service Bus использует несколько сообщений tooprocess брокеры сообщений и несколько сообщений хранит сообщения toostore.</span><span class="sxs-lookup"><span data-stu-id="8de09-104">Azure Service Bus employs multiple message brokers tooprocess messages and multiple messaging stores toostore messages.</span></span> <span data-ttu-id="8de09-105">Обычная очередь или раздел обрабатываются одним брокером сообщений и сохраняются в одном хранилище сообщений.</span><span class="sxs-lookup"><span data-stu-id="8de09-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="8de09-106">Шина обслуживания *секций* включить очереди и разделы, или *сущностей обмена сообщениями*, toobe секционированы по нескольким посредникам сообщений и хранилищам сообщений.</span><span class="sxs-lookup"><span data-stu-id="8de09-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, toobe partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="8de09-107">Это означает, что hello общая пропускная способность секционированной сущности больше не ограничивается hello производительностью одного брокера сообщений или хранилища обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="8de09-107">This means that hello overall throughput of a partitioned entity is no longer limited by hello performance of a single message broker or messaging store.</span></span> <span data-ttu-id="8de09-108">Кроме того, при возникновении временного сбоя хранилища сообщений секционированная очередь или раздел останутся доступными.</span><span class="sxs-lookup"><span data-stu-id="8de09-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="8de09-109">Секционированные очереди и разделы могут предоставлять все расширенные функции служебной шины, в том числе поддержку транзакций и сеансов.</span><span class="sxs-lookup"><span data-stu-id="8de09-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="8de09-110">Сведения о внутренней организации Service Bus см. в разделе hello [архитектуры Service Bus] [ Service Bus architecture] статьи.</span><span class="sxs-lookup"><span data-stu-id="8de09-110">For information about Service Bus internals, see hello [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="8de09-111">Секционирование включается по умолчанию при создании сущности во всех очередях и разделах на уровне обмена сообщениями "Стандартный" и "Премиум".</span><span class="sxs-lookup"><span data-stu-id="8de09-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="8de09-112">Сущности уровня обмена сообщениями "Стандартный"можно создать без секционирования, но очереди и разделы в пространстве имен уровня "Премиум" всегда секционируются. Этот параметр невозможно отключить.</span><span class="sxs-lookup"><span data-stu-id="8de09-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="8de09-113">Это не возможные toochange hello вариант на существующей очереди или раздела на уровнях Standard или Premium секционирования, можно задать только hello параметр при создании сущности hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-113">It is not possible toochange hello partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set hello option when you create hello entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="8de09-114">Принцип работы</span><span class="sxs-lookup"><span data-stu-id="8de09-114">How it works</span></span>

<span data-ttu-id="8de09-115">Каждая секционированная очередь или раздел состоит из нескольких фрагментов.</span><span class="sxs-lookup"><span data-stu-id="8de09-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="8de09-116">Фрагменты хранятся в разных хранилищах сообщений и обрабатываются разными посредниками сообщений.</span><span class="sxs-lookup"><span data-stu-id="8de09-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="8de09-117">При отправке сообщения tooa секционированной очереди или раздела Service Bus назначает tooone сообщение hello hello фрагментов.</span><span class="sxs-lookup"><span data-stu-id="8de09-117">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="8de09-118">Выбор Hello случайным образом осуществляется служебной шины или можно указать с помощью ключа секции, hello отправителя.</span><span class="sxs-lookup"><span data-stu-id="8de09-118">hello selection is done randomly by Service Bus or by using a partition key that hello sender can specify.</span></span>

<span data-ttu-id="8de09-119">Когда клиенту tooreceive сообщение из секционированной очереди или из секционированного раздела tooa подписки, Service Bus запрашивает все фрагменты сообщения, затем возвращает первое сообщение hello, полученный из любого hello обмена сообщениями получатель toohello хранилищ.</span><span class="sxs-lookup"><span data-stu-id="8de09-119">When a client wants tooreceive a message from a partitioned queue, or from a subscription tooa partitioned topic, Service Bus queries all fragments for messages, then returns hello first message that is obtained from any of hello messaging stores toohello receiver.</span></span> <span data-ttu-id="8de09-120">Кэши Service Bus hello другие сообщения и возвращает их при получении дополнительных получать запросы.</span><span class="sxs-lookup"><span data-stu-id="8de09-120">Service Bus caches hello other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="8de09-121">Получающему клиенту неизвестно о секционировании hello. Здравствуйте поведение клиента секционированной очереди или раздела (например, чтение завершение, откладывание, блокированное письмо, предварительная выборка) поведение идентичные toohello обычной сущности.</span><span class="sxs-lookup"><span data-stu-id="8de09-121">A receiving client is not aware of hello partitioning; hello client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical toohello behavior of a regular entity.</span></span>

<span data-ttu-id="8de09-122">При отправке или получении сообщения из секционированной очереди или раздела не возникает никаких дополнительных затрат.</span><span class="sxs-lookup"><span data-stu-id="8de09-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="8de09-123">Включение секционирования</span><span class="sxs-lookup"><span data-stu-id="8de09-123">Enable partitioning</span></span>

<span data-ttu-id="8de09-124">toouse секционированные очереди и разделы с Azure Service Bus использовать hello Azure SDK версии 2.2 или более поздней версии, либо указать `api-version=2013-10` в запросах HTTP.</span><span class="sxs-lookup"><span data-stu-id="8de09-124">toouse partitioned queues and topics with Azure Service Bus, use hello Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="8de09-125">Standard</span><span class="sxs-lookup"><span data-stu-id="8de09-125">Standard</span></span>

<span data-ttu-id="8de09-126">Стандартный уровень обмена сообщениями hello можно создать очереди Service Bus и разделы с размерами 1, 2, 3, 4 или 5 ГБ (по умолчанию hello составляет 1 ГБ).</span><span class="sxs-lookup"><span data-stu-id="8de09-126">In hello Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (hello default is 1 GB).</span></span> <span data-ttu-id="8de09-127">Секционирование включено, служебная шина создает 16 копий hello сущности (16 секции) для каждого указанного ГБ.</span><span class="sxs-lookup"><span data-stu-id="8de09-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of hello entity for each GB you specify.</span></span> <span data-ttu-id="8de09-128">Таким образом, при создании очереди, имеет размер в 5 ГБ, с 16 секциями hello максимальный размер очереди становится (5 \* 16) = 80 ГБ.</span><span class="sxs-lookup"><span data-stu-id="8de09-128">As such, if you create a queue that's 5 GB in size, with 16 partitions hello maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="8de09-129">Вы увидите hello максимальный размер секционированной очереди или раздела, просмотрев его запись в hello [портал Azure][Azure portal], в hello **Обзор** колонку для этой сущности.</span><span class="sxs-lookup"><span data-stu-id="8de09-129">You can see hello maximum size of your partitioned queue or topic by looking at its entry on hello [Azure portal][Azure portal], in hello **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="8de09-130">Premium</span><span class="sxs-lookup"><span data-stu-id="8de09-130">Premium</span></span>

<span data-ttu-id="8de09-131">В пространстве имен уровня Premium можно создать очереди Service Bus и разделы с размерами 1, 2, 3, 4, 5, 10, 20, 40 или 80 ГБ (по умолчанию hello составляет 1 ГБ).</span><span class="sxs-lookup"><span data-stu-id="8de09-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (hello default is 1 GB).</span></span> <span data-ttu-id="8de09-132">Если секционирование включено по умолчанию, служебная шина создает две секции на каждую сущность.</span><span class="sxs-lookup"><span data-stu-id="8de09-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="8de09-133">Вы увидите hello максимальный размер секционированной очереди или раздела, просмотрев его запись в hello [портал Azure][Azure portal], в hello **Обзор** колонку для этой сущности.</span><span class="sxs-lookup"><span data-stu-id="8de09-133">You can see hello maximum size of your partitioned queue or topic by looking at its entry on hello [Azure portal][Azure portal], in hello **Overview** blade for that entity.</span></span>

<span data-ttu-id="8de09-134">Дополнительные сведения о секционировании в уровня обмена сообщениями Premium hello см. в разделе [Service Bus Premium и стандартного уровней обмена сообщениями](service-bus-premium-messaging.md).</span><span class="sxs-lookup"><span data-stu-id="8de09-134">For more information about partitioning in hello Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="8de09-135">Создание секционированной сущности</span><span class="sxs-lookup"><span data-stu-id="8de09-135">Create a partitioned entity</span></span>

<span data-ttu-id="8de09-136">Существует несколько способов toocreate секционированной очереди или раздела.</span><span class="sxs-lookup"><span data-stu-id="8de09-136">There are several ways toocreate a partitioned queue or topic.</span></span> <span data-ttu-id="8de09-137">При создании hello очереди или раздела из приложения можно включить секционирование hello очередь или раздел, соответственно, параметр hello [QueueDescription.EnablePartitioning] [ QueueDescription.EnablePartitioning] или [TopicDescription.EnablePartitioning] [ TopicDescription.EnablePartitioning] свойство слишком**true**.</span><span class="sxs-lookup"><span data-stu-id="8de09-137">When you create hello queue or topic from your application, you can enable partitioning for hello queue or topic by respectively setting hello [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property too**true**.</span></span> <span data-ttu-id="8de09-138">Эти свойства должны задаваться в очередь hello hello времени или создания раздела.</span><span class="sxs-lookup"><span data-stu-id="8de09-138">These properties must be set at hello time hello queue or topic is created.</span></span> <span data-ttu-id="8de09-139">Как уже говорилось ранее, это невозможно, toochange на эти свойства существующей очереди или раздела.</span><span class="sxs-lookup"><span data-stu-id="8de09-139">As stated previously, it is not possible toochange these properties on an existing queue or topic.</span></span> <span data-ttu-id="8de09-140">Например:</span><span class="sxs-lookup"><span data-stu-id="8de09-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="8de09-141">Кроме того, можно создать секционированной очереди или раздела в hello [портал Azure] [ Azure portal] или в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8de09-141">Alternatively, you can create a partitioned queue or topic in hello [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="8de09-142">При создании очереди или раздела на портале hello hello **включить секционирование** параметр в hello очередь или раздел **создать** колонке включен по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8de09-142">When you create a queue or topic in hello portal, hello **Enable partitioning** option in hello queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="8de09-143">Можно только отключить этот параметр в стандартном уровне сущности; в hello секционирование уровня Premium всегда включен.</span><span class="sxs-lookup"><span data-stu-id="8de09-143">You can only disable this option in a Standard tier entity; in hello Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="8de09-144">В Visual Studio щелкните hello **включить секционирование** флажок в hello **новую очередь** или **новый раздел** диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="8de09-144">In Visual Studio, click hello **Enable Partitioning** checkbox in hello **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="8de09-145">Использование ключей секции</span><span class="sxs-lookup"><span data-stu-id="8de09-145">Use of partition keys</span></span>
<span data-ttu-id="8de09-146">Когда сообщение помещается в секционированные очередь или раздел, Service Bus проверяет hello наличие ключа секционирования.</span><span class="sxs-lookup"><span data-stu-id="8de09-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for hello presence of a partition key.</span></span> <span data-ttu-id="8de09-147">Если найден, он выбирает hello фрагмент на основе такого ключа.</span><span class="sxs-lookup"><span data-stu-id="8de09-147">If it finds one, it selects hello fragment based on that key.</span></span> <span data-ttu-id="8de09-148">Если не удается найти ключ раздела, он выбирает hello фрагмент на основе внутреннего алгоритма.</span><span class="sxs-lookup"><span data-stu-id="8de09-148">If it does not find a partition key, it selects hello fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="8de09-149">Использование ключа секции</span><span class="sxs-lookup"><span data-stu-id="8de09-149">Using a partition key</span></span>
<span data-ttu-id="8de09-150">Некоторые сценарии, такие как сеансы или транзакции, требуется toobe сообщений, хранимых в определенных фрагментах.</span><span class="sxs-lookup"><span data-stu-id="8de09-150">Some scenarios, such as sessions or transactions, require messages toobe stored in a specific fragment.</span></span> <span data-ttu-id="8de09-151">Эти сценарии необходимо использовать hello ключ раздела.</span><span class="sxs-lookup"><span data-stu-id="8de09-151">All these scenarios require hello use of a partition key.</span></span> <span data-ttu-id="8de09-152">Все сообщения, используйте hello, одинаковым ключом секции назначаются toohello же фрагмента.</span><span class="sxs-lookup"><span data-stu-id="8de09-152">All messages that use hello same partition key are assigned toohello same fragment.</span></span> <span data-ttu-id="8de09-153">Если hello фрагмент временно недоступен, Service Bus возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="8de09-153">If hello fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="8de09-154">В зависимости от сценария hello в качестве ключа секционирования используются различные свойства сообщения:</span><span class="sxs-lookup"><span data-stu-id="8de09-154">Depending on hello scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="8de09-155">**SessionId**: Если в сообщении имеется hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] свойство задано, то Service Bus использует это свойство в качестве ключа секции hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-155">**SessionId**: If a message has hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as hello partition key.</span></span> <span data-ttu-id="8de09-156">Таким образом, все сообщения, которые принадлежат toohello того же сеанса, обрабатываются hello же посредником сообщения.</span><span class="sxs-lookup"><span data-stu-id="8de09-156">This way, all messages that belong toohello same session are handled by hello same message broker.</span></span> <span data-ttu-id="8de09-157">Благодаря этому сообщения tooguarantee Service Bus, порядок и согласованность состояний сеанса hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-157">This enables Service Bus tooguarantee message ordering as well as hello consistency of session states.</span></span>

<span data-ttu-id="8de09-158">**PartitionKey**: Если в сообщении имеется hello [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] свойство, но не hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] свойство задано, то Service Bus использует hello [PartitionKey] [ PartitionKey] свойство в качестве ключа секции hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-158">**PartitionKey**: If a message has hello [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses hello [PartitionKey][PartitionKey] property as hello partition key.</span></span> <span data-ttu-id="8de09-159">Если сообщение hello имеет оба hello [SessionId] [ SessionId] и hello [PartitionKey] [ PartitionKey] набором свойств, оба свойства должны совпадать.</span><span class="sxs-lookup"><span data-stu-id="8de09-159">If hello message has both hello [SessionId][SessionId] and hello [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="8de09-160">Если hello [PartitionKey] [ PartitionKey] свойству tooa отличается от hello [SessionId] [ SessionId] свойство Service Bus возвращает недопустимый исключение, вызванное операции.</span><span class="sxs-lookup"><span data-stu-id="8de09-160">If hello [PartitionKey][PartitionKey] property is set tooa different value than hello [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="8de09-161">Hello [PartitionKey] [ PartitionKey] свойство должно использоваться, если отправитель посылает транзактные сообщения вне сеанса.</span><span class="sxs-lookup"><span data-stu-id="8de09-161">hello [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="8de09-162">Hello ключ секционирования гарантирует, что все сообщения, отправленные в транзакции обрабатываются hello же брокера обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="8de09-162">hello partition key ensures that all messages that are sent within a transaction are handled by hello same messaging broker.</span></span>

<span data-ttu-id="8de09-163">**Код (ID)**: Если hello очередь или раздел имеют hello [QueueDescription.RequiresDuplicateDetection] [ QueueDescription.RequiresDuplicateDetection] значение свойства слишком**true** и hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] или [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] свойства не заданы, то hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] служит в качестве ключа секции hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-163">**MessageId**: If hello queue or topic has hello [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set too**true** and hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as hello partition key.</span></span> <span data-ttu-id="8de09-164">(Обратите внимание, что hello библиотек Microsoft .NET и AMQP автоматически назначают идентификатор сообщения, если не делает отправляющее приложение hello). В этом случае все копии одного сообщения обрабатываются hello hello одним посредником сообщения.</span><span class="sxs-lookup"><span data-stu-id="8de09-164">(Note that hello Microsoft .NET and AMQP libraries automatically assign a message ID if hello sending application does not.) In this case, all copies of hello same message are handled by hello same message broker.</span></span> <span data-ttu-id="8de09-165">Это позволяет toodetect Service Bus и удалить дублирующие сообщения.</span><span class="sxs-lookup"><span data-stu-id="8de09-165">This enables Service Bus toodetect and eliminate duplicate messages.</span></span> <span data-ttu-id="8de09-166">Если hello [QueueDescription.RequiresDuplicateDetection] [ QueueDescription.RequiresDuplicateDetection] свойство не задано слишком**true**, Service Bus не учитывает hello [MessageId] [ MessageId] свойство в качестве ключа секции.</span><span class="sxs-lookup"><span data-stu-id="8de09-166">If hello [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set too**true**, Service Bus does not consider hello [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="8de09-167">Неиспользование ключа секции</span><span class="sxs-lookup"><span data-stu-id="8de09-167">Not using a partition key</span></span>
<span data-ttu-id="8de09-168">В отсутствие hello ключа секционирования Service Bus распределяет сообщения фрагментами hello циклического перебора tooall hello секционированной очереди или раздела.</span><span class="sxs-lookup"><span data-stu-id="8de09-168">In hello absence of a partition key, Service Bus distributes messages in a round-robin fashion tooall hello fragments of hello partitioned queue or topic.</span></span> <span data-ttu-id="8de09-169">Если hello выбранный фрагмент недоступен, Service Bus назначает hello сообщение tooa другой фрагмент.</span><span class="sxs-lookup"><span data-stu-id="8de09-169">If hello chosen fragment is not available, Service Bus assigns hello message tooa different fragment.</span></span> <span data-ttu-id="8de09-170">В этом случае hello операция отправки завершается успешно, несмотря hello Временная недоступность хранилища обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="8de09-170">This way, hello send operation succeeds despite hello temporary unavailability of a messaging store.</span></span> <span data-ttu-id="8de09-171">Тем не менее не произойдет hello гарантированное упорядочивание, предоставляет ключ раздела.</span><span class="sxs-lookup"><span data-stu-id="8de09-171">However, you will not achieve hello guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="8de09-172">Подробное обсуждение hello компромисс между доступностью (нет ключа секции) и согласованности (с помощью ключа секции) см. в разделе [в этой статье](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="8de09-172">For a more in-depth discussion of hello tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="8de09-173">Эти сведения относятся одинаково toopartitioned сущностей служебной шины и разделов концентраторов событий.</span><span class="sxs-lookup"><span data-stu-id="8de09-173">This information applies equally toopartitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="8de09-174">toogive службы шины сообщение hello tooenqueue достаточное количество времени в другом фрагменте hello [MessagingFactorySettings.OperationTimeout] [ MessagingFactorySettings.OperationTimeout] значения, указанного в hello клиента, который отправляет сообщение hello должно быть больше 15 секунд.</span><span class="sxs-lookup"><span data-stu-id="8de09-174">toogive Service Bus enough time tooenqueue hello message into a different fragment, hello [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by hello client that sends hello message must be greater than 15 seconds.</span></span> <span data-ttu-id="8de09-175">Рекомендуется установить hello [OperationTimeout] [ OperationTimeout] свойство toohello значение по умолчанию 60 секунд.</span><span class="sxs-lookup"><span data-stu-id="8de09-175">It is recommended that you set hello [OperationTimeout][OperationTimeout] property toohello default value of 60 seconds.</span></span>

<span data-ttu-id="8de09-176">Обратите внимание, что ключ раздела «прикрепляет» определенному фрагменту tooa сообщение.</span><span class="sxs-lookup"><span data-stu-id="8de09-176">Note that a partition key "pins" a message tooa specific fragment.</span></span> <span data-ttu-id="8de09-177">Если хранилище сообщений hello, этим фрагментом недоступно, Service Bus возвращает ошибку.</span><span class="sxs-lookup"><span data-stu-id="8de09-177">If hello messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="8de09-178">В отсутствие hello ключа секционирования Service Bus можно выбрать другой фрагмент и hello операция выполнена успешно.</span><span class="sxs-lookup"><span data-stu-id="8de09-178">In hello absence of a partition key, Service Bus can choose a different fragment and hello operation succeeds.</span></span> <span data-ttu-id="8de09-179">Поэтому рекомендуется не указывать ключ раздела, если он не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="8de09-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="8de09-180">Дополнительные разделы: использование транзакций и секционированных сущностей</span><span class="sxs-lookup"><span data-stu-id="8de09-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="8de09-181">Сообщения, отправленные в рамках транзакции, должны указать ключ секции.</span><span class="sxs-lookup"><span data-stu-id="8de09-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="8de09-182">Это может быть одним из hello следующие свойства: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], или [ BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span><span class="sxs-lookup"><span data-stu-id="8de09-182">This can be one of hello following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="8de09-183">Все сообщения, отправленные в рамках одной транзакции необходимо указать hello hello же ключ секционирования.</span><span class="sxs-lookup"><span data-stu-id="8de09-183">All messages that are sent as part of hello same transaction must specify hello same partition key.</span></span> <span data-ttu-id="8de09-184">При попытке toosend сообщение без ключа секции в пределах транзакции, Service Bus возвращает исключение Недопустимая операция.</span><span class="sxs-lookup"><span data-stu-id="8de09-184">If you attempt toosend a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="8de09-185">При попытке toosend Здравствуйте, несколько сообщений в рамках одной транзакции, имеют различные ключи разделов, Service Bus возвращает исключение Недопустимая операция.</span><span class="sxs-lookup"><span data-stu-id="8de09-185">If you attempt toosend multiple messages within hello same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="8de09-186">Например:</span><span class="sxs-lookup"><span data-stu-id="8de09-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="8de09-187">Если заданы свойства hello, которые выступают в качестве ключа секции, Service Bus ПИН-кодов hello tooa фрагмент сообщения.</span><span class="sxs-lookup"><span data-stu-id="8de09-187">If any of hello properties that serve as a partition key are set, Service Bus pins hello message tooa specific fragment.</span></span> <span data-ttu-id="8de09-188">Это происходит независимо от того, используется ли транзакция.</span><span class="sxs-lookup"><span data-stu-id="8de09-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="8de09-189">Рекомендуется не указывать ключ секции, если в этом нет необходимости.</span><span class="sxs-lookup"><span data-stu-id="8de09-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="8de09-190">Использование сеансов и секционированных сущностей</span><span class="sxs-lookup"><span data-stu-id="8de09-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="8de09-191">toosend с поддержкой сеансов раздела tooa транзакционного сообщения или очереди, сообщение hello должно иметь hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] набор свойств.</span><span class="sxs-lookup"><span data-stu-id="8de09-191">toosend a transactional message tooa session-aware topic or queue, hello message must have hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="8de09-192">Если hello [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] также задается свойство, оно должно быть идентичными toohello [SessionId] [ SessionId] свойство.</span><span class="sxs-lookup"><span data-stu-id="8de09-192">If hello [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical toohello [SessionId][SessionId] property.</span></span> <span data-ttu-id="8de09-193">Если они различаются, служебная шина возвращает исключение недопустимой операции.</span><span class="sxs-lookup"><span data-stu-id="8de09-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="8de09-194">В отличие от обычных очередей (несекционированного) или разделы нет возможности toouse toosend одной транзакции несколько сеансов toodifferent сообщений.</span><span class="sxs-lookup"><span data-stu-id="8de09-194">Unlike regular (non-partitioned) queues or topics, it is not possible toouse a single transaction toosend multiple messages toodifferent sessions.</span></span> <span data-ttu-id="8de09-195">Если же попытаться это сделать, служебная шина возвращает исключение недопустимой операции.</span><span class="sxs-lookup"><span data-stu-id="8de09-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="8de09-196">Например:</span><span class="sxs-lookup"><span data-stu-id="8de09-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="8de09-197">Автоматическая переадресация сообщений для секционированных сущностей</span><span class="sxs-lookup"><span data-stu-id="8de09-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="8de09-198">Служебная шина поддерживает автоматическую переадресацию сообщений в секционированные сущности, из них или между ними.</span><span class="sxs-lookup"><span data-stu-id="8de09-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="8de09-199">hello задать автоматическую отправку, сообщений tooenable [QueueDescription.ForwardTo] [ QueueDescription.ForwardTo] свойство hello исходной очереди или подписки.</span><span class="sxs-lookup"><span data-stu-id="8de09-199">tooenable automatic message forwarding, set hello [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on hello source queue or subscription.</span></span> <span data-ttu-id="8de09-200">Если сообщение hello указывает ключ раздела ([SessionId][SessionId], [PartitionKey][PartitionKey], или [MessageId] [ MessageId]), этот ключ секции используется для конечной сущности hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-200">If hello message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for hello destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="8de09-201">Рекомендации и советы</span><span class="sxs-lookup"><span data-stu-id="8de09-201">Considerations and guidelines</span></span>
* <span data-ttu-id="8de09-202">**Высокий уровень согласованности функции**: если сущность использует функции, такие как сеансы, обнаружение повторяющихся сообщений или явное управление ключ секционирования, то hello операций обмена сообщениями всегда являются фрагментами перенаправленное toospecific.</span><span class="sxs-lookup"><span data-stu-id="8de09-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then hello messaging operations are always routed toospecific fragments.</span></span> <span data-ttu-id="8de09-203">Если любой из фрагментов hello столкнуться с высоким трафиком или hello базовое хранилище находится в неработоспособном состоянии, эти операции завершатся ошибкой и доступности снижается.</span><span class="sxs-lookup"><span data-stu-id="8de09-203">If any of hello fragments experience high traffic or hello underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="8de09-204">В целом hello согласованности по-прежнему гораздо выше, чем несекционированного сущности; только часть трафика, возникают проблемы, как противоположность tooall hello трафика.</span><span class="sxs-lookup"><span data-stu-id="8de09-204">Overall, hello consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed tooall hello traffic.</span></span> <span data-ttu-id="8de09-205">Дополнительные сведения см. в этом [обсуждении доступности и целостности](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="8de09-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="8de09-206">**Управление**: операции, такие как Create, Update и Delete, которые необходимо выполнить на всех фрагментов hello объекта hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-206">**Management**: Operations such as Create, Update and Delete must be performed on all hello fragments of hello entity.</span></span> <span data-ttu-id="8de09-207">Если какой-либо из фрагментов находится в неработоспособном состоянии, это может привести к сбою этих операций.</span><span class="sxs-lookup"><span data-stu-id="8de09-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="8de09-208">Для операции Get hello сведения о таких, как количество сообщений должны быть собраны из всех фрагментов.</span><span class="sxs-lookup"><span data-stu-id="8de09-208">For hello Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="8de09-209">Если любой фрагмент неработоспособен, состояние доступности hello сущности отображается как limited.</span><span class="sxs-lookup"><span data-stu-id="8de09-209">If any fragment is unhealthy, hello entity availability status is reported as limited.</span></span>
* <span data-ttu-id="8de09-210">**Недостаточно сценарии сообщение корпоративных**: для таких сценариев, особенно при использовании протокола hello HTTP, может иметь tooperform несколько операций получения в порядке tooobtain все сообщения hello.</span><span class="sxs-lookup"><span data-stu-id="8de09-210">**Low volume message scenarios**: For such scenarios, especially when using hello HTTP protocol, you may have tooperform multiple receive operations in order tooobtain all hello messages.</span></span> <span data-ttu-id="8de09-211">Для получения запросов обслуживающего hello выполняет инструкция receive на все фрагменты hello и кэширует все hello ответов, полученных.</span><span class="sxs-lookup"><span data-stu-id="8de09-211">For receive requests, hello front end performs a receive on all hello fragments and caches all hello responses received.</span></span> <span data-ttu-id="8de09-212">Последующие приема запроса hello одного соединения бы выиграть от этого кэширования и получения задержки будет ниже.</span><span class="sxs-lookup"><span data-stu-id="8de09-212">A subsequent receive request on hello same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="8de09-213">Тем не менее при наличии нескольких подключений или использовании протокола HTTP для каждого запроса устанавливается новое подключение.</span><span class="sxs-lookup"><span data-stu-id="8de09-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="8de09-214">Таким образом, нет никакой гарантии, что она окажется на hello того же узла.</span><span class="sxs-lookup"><span data-stu-id="8de09-214">As such, there is no guarantee that it would land on hello same node.</span></span> <span data-ttu-id="8de09-215">Если все существующие сообщения блокируются и кэширования данных в другой интерфейс hello получать возвращает **null**.</span><span class="sxs-lookup"><span data-stu-id="8de09-215">If all existing messages are locked and cached in another front end, hello receive operation returns **null**.</span></span> <span data-ttu-id="8de09-216">Когда в конечном итоге срок действия сообщений истекает, их снова можно получать.</span><span class="sxs-lookup"><span data-stu-id="8de09-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="8de09-217">Рекомендуется выполнить проверку активности HTTP.</span><span class="sxs-lookup"><span data-stu-id="8de09-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="8de09-218">**Обзор и Просмотр сообщения**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) не всегда возвращают hello количество сообщений, определенных в hello [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) свойство.</span><span class="sxs-lookup"><span data-stu-id="8de09-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return hello number of messages specified in hello [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="8de09-219">На это есть две причины.</span><span class="sxs-lookup"><span data-stu-id="8de09-219">There are two common reasons for this.</span></span> <span data-ttu-id="8de09-220">Одна из причин — что hello агрегированных размер hello коллекция сообщений превышает максимальный размер hello 256 КБ.</span><span class="sxs-lookup"><span data-stu-id="8de09-220">One reason is that hello aggregated size of hello collection of messages exceeds hello maximum size of 256KB.</span></span> <span data-ttu-id="8de09-221">Еще одна причина: Если hello очередь или раздел имеют hello [свойство параметр EnablePartitioning](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) значение слишком**true**, секции не может иметь достаточного количества сообщений toocomplete hello запрошено количество сообщений.</span><span class="sxs-lookup"><span data-stu-id="8de09-221">Another reason is that if hello queue or topic has hello [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set too**true**, a partition may not have enough messages toocomplete hello requested number of messages.</span></span> <span data-ttu-id="8de09-222">Как правило, если приложению требуется tooreceive определенное число сообщений, он должен вызывать [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) несколько раз он получает это количество сообщений, или пока не дополнительные toopeek сообщений.</span><span class="sxs-lookup"><span data-stu-id="8de09-222">In general, if an application wants tooreceive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages toopeek.</span></span> <span data-ttu-id="8de09-223">Дополнительные сведения, включая примеры кода, см. в разделах [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) или [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span><span class="sxs-lookup"><span data-stu-id="8de09-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="8de09-224">Новые функции</span><span class="sxs-lookup"><span data-stu-id="8de09-224">Latest added features</span></span>
* <span data-ttu-id="8de09-225">Теперь для секционированных сущностей поддерживаются операции добавления и удаления правила.</span><span class="sxs-lookup"><span data-stu-id="8de09-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="8de09-226">В отличие от несекционированных сущностей эти операции не поддерживаются при выполнении транзакций.</span><span class="sxs-lookup"><span data-stu-id="8de09-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="8de09-227">AMQP теперь поддерживается для отправки и получения сообщений tooand от секционированную сущность.</span><span class="sxs-lookup"><span data-stu-id="8de09-227">AMQP is now supported for sending and receiving messages tooand from a partitioned entity.</span></span>
* <span data-ttu-id="8de09-228">AMQP теперь поддерживается для следующих операций hello: [отправки пакета](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [получения пакета](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive порядковом номере](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Показать](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [ Обновить блокировки](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [запланировать сообщение](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [запланированные сообщения отмены](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [добавить правило](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [удалить правило](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Блокировки обновления сеанса](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [состояние сеанса набор](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [состояние сеанса Get](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), и [перечислить сеансы](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span><span class="sxs-lookup"><span data-stu-id="8de09-228">AMQP is now supported for hello following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="8de09-229">Ограничения секционированных сущностей</span><span class="sxs-lookup"><span data-stu-id="8de09-229">Partitioned entities limitations</span></span>
<span data-ttu-id="8de09-230">В настоящее время Service Bus налагает следующие ограничения на секционированные очереди и разделы hello:</span><span class="sxs-lookup"><span data-stu-id="8de09-230">Currently Service Bus imposes hello following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="8de09-231">Секционированные очереди и разделы не поддерживают отправку сообщений, которые принадлежат toodifferent сеансы в одной транзакции.</span><span class="sxs-lookup"><span data-stu-id="8de09-231">Partitioned queues and topics do not support sending messages that belong toodifferent sessions in a single transaction.</span></span>
* <span data-ttu-id="8de09-232">Service Bus в настоящее время позволяет too100 секционированных очередей или разделов на пространство имен.</span><span class="sxs-lookup"><span data-stu-id="8de09-232">Service Bus currently allows up too100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="8de09-233">Каждая секционированная очередь или раздел учитывается при подсчете квоты hello 10 000 объектов на пространство имен (tooPremium уровня не применяется).</span><span class="sxs-lookup"><span data-stu-id="8de09-233">Each partitioned queue or topic counts towards hello quota of 10,000 entities per namespace (does not apply tooPremium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8de09-234">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="8de09-234">Next steps</span></span>
<span data-ttu-id="8de09-235">См. обсуждение hello [поддержка AMQP 1.0 Service Bus секционированные очереди и разделы] [ AMQP 1.0 support for Service Bus partitioned queues and topics] toolearn Дополнительные общие сведения о секционировании сущностей обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="8de09-235">See hello discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] toolearn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
