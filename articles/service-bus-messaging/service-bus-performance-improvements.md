---
title: "aaaBest и рекомендации по улучшению производительности с помощью Azure Service Bus | Документы Microsoft"
description: "Описывает, как toouse Service Bus toooptimize производительности при обмене через посредника сообщений."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: e756c15d-31fc-45c0-8df4-0bca0da10bb2
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/10/2017
ms.author: sethm
ms.openlocfilehash: 52764d227757cbb11246675878933f21685817f1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-performance-improvements-using-service-bus-messaging"></a>Рекомендации по повышению производительности с помощью обмена сообщениями через служебную шину

В этой статье описывается как toouse [обмена сообщениями Azure Service Bus](https://azure.microsoft.com/services/service-bus/) toooptimize производительности при обмене через посредника сообщений. Hello первая часть этого раздела описывает hello различные механизмы, предлагаемые toohelp увеличение производительности. Вторая часть Hello даются рекомендации по как toouse Service Bus способом, который может предложить hello оптимальной производительности для конкретного сценария.

В этом разделе hello термин «клиент» означает tooany сущность, которая обращается к Service Bus. Клиент может выполнять роль отправителя или получателя hello. Hello термин «отправитель» используется для клиента очереди или раздела Service Bus, который отправляет сообщения tooa Service Bus очереди или раздела. Hello термин «получатель» относится tooa Service Bus очереди или подписки клиента, который получает сообщения из очереди Service Bus или подписки.

В этих разделах представлены некоторые понятия, Service Bus использует toohelp повышения производительности.

## <a name="protocols"></a>Протоколы
Service Bus позволяет клиентам toosend и получения сообщений через одну из трех протоколов:

1. Протокол AMQP
2. Протокол SBMP
3. HTTP

AMQP и SBMP являются более эффективен, поскольку они поддерживают tooService подключения hello шины при условии, что существует фабрика сообщений hello. Он также реализует функции пакетной обработки и предварительной выборки. Если не было упомянуто явно, все содержимое этого раздела предполагается, что используется hello AMQP или SBMP.

## <a name="reusing-factories-and-clients"></a>Повторное использование фабрик и клиентов
Клиентские объекты служебной шины, такие как [QueueClient][QueueClient] или [MessageSender][MessageSender], создаются с помощью объекта [MessagingFactory][MessagingFactory]. Этот объект также обеспечивает внутреннее управление подключениями. Вам не следует закрывать фабрики обмена сообщениями или очереди, раздела и подписки клиентов после отправки сообщения, а затем создайте их повторно при отправке следующего сообщения hello. Закрытие фабрики обмена сообщениями удаляет службу Service Bus toohello соединения hello и новое подключение устанавливается при повторном создании фабрики hello. Соединение — ресурсоемкая операция, можно избежать, повторно используя hello же фабрики и клиента для установки объектов для нескольких операций. Можно безопасно использовать hello [QueueClient] [ QueueClient] объект для отправки сообщений от параллельных асинхронных операций и нескольких потоков. 

## <a name="concurrent-operations"></a>Параллельные операции
Выполнение любой операции (отправка, получение, удаление и т. д.) занимает определенное время. Это время включает в себя hello обработку hello операции по hello службы Service Bus задержки toohello сложения hello запроса и ответа hello. tooincrease число hello операций в единицу времени, необходимо выполнять их параллельно. Это можно сделать несколькими способами.

* **Асинхронные операции**: hello клиент планирует операции, выполняя асинхронные операции. Следующий запрос Hello запускается до завершения предыдущего запроса hello. Hello ниже приведен пример асинхронной отправки операции:
  
 ```csharp
  BrokeredMessage m1 = new BrokeredMessage(body);
  BrokeredMessage m2 = new BrokeredMessage(body);
  
  Task send1 = queueClient.SendAsync(m1).ContinueWith((t) => 
    {
      Console.WriteLine("Sent message #1");
    });
  Task send2 = queueClient.SendAsync(m2).ContinueWith((t) => 
    {
      Console.WriteLine("Sent message #2");
    });
  Task.WaitAll(send1, send2);
  Console.WriteLine("All messages sent");
  ```
  
  Вот пример асинхронной операции получения:
  
  ```csharp
  Task receive1 = queueClient.ReceiveAsync().ContinueWith(ProcessReceivedMessage);
  Task receive2 = queueClient.ReceiveAsync().ContinueWith(ProcessReceivedMessage);
  
  Task.WaitAll(receive1, receive2);
  Console.WriteLine("All messages received");
  
  async void ProcessReceivedMessage(Task<BrokeredMessage> t)
  {
    BrokeredMessage m = t.Result;
    Console.WriteLine("{0} received", m.Label);
    await m.CompleteAsync();
    Console.WriteLine("{0} complete", m.Label);
  }
  ```
* **Несколько фабрик**: все клиенты (отправители в tooreceivers сложения), созданные hello фабрики папки один TCP-подключению. Hello максимальная пропускная способность сообщений ограничена hello количество операций, которые могут проходить через это TCP-соединение. пропускная способность Hello, которые могут быть получены в одной фабрике, существенно зависит от времени приема-передачи TCP и размера сообщения. tooobtain более высокую пропускную, следует использовать несколько фабрик обмена сообщениями.

## <a name="receive-mode"></a>Режим получения
При создании клиента очереди или подписки вы можете выбрать режим получения: *блокировка для просмотра* или *получение и удаление*. режим получения по умолчанию Hello — [PeekLock][PeekLock]. При работе в этом режиме hello клиент отправляет запрос tooreceive сообщение через служебную шину. После получения приветственное сообщение hello клиента он отправляет сообщение hello toocomplete запроса.

Если параметр hello режим получения слишком[ReceiveAndDelete][ReceiveAndDelete], оба действия объединяются в одном запросе. Это уменьшает общее количество операций hello, а также повышает hello общую пропускную способность сообщений. Такое увеличение производительности вызывает риск потери сообщений hello.

Служебная шина не поддерживает транзакции для операций получения и удаления. Кроме того, требуются для сценариев, в которых hello клиенту toodefer семантику блокировки для просмотра или [недоставленных](service-bus-dead-letter-queues.md) сообщение.

## <a name="client-side-batching"></a>Пакетная обработка на стороне клиента
Пакетная обработка на стороне клиента позволяет очереди или разделе клиента toodelay hello отправку сообщения для определенного периода времени. Если hello клиент отправляет дополнительные сообщения в этот период времени, он передает сообщения hello в одном пакете. Пакетная обработка на стороне клиента также приводит клиента очереди или подписки toobatch несколько **завершить** запросов в один запрос. Пакетная обработка возможна только для асинхронных операций **отправки** и **завершения**. Синхронные операции отправляются немедленно toohello службы шины обслуживания. Пакетная обработка недоступна для операций просмотра или получения. Также пакетную обработку нельзя использовать для объединения операций нескольких клиентов.

По умолчанию интервал пакетной обработки в клиенте составляет 20 мс. Можно изменить интервал пакетов hello, установка hello [BatchFlushInterval] [ BatchFlushInterval] свойство перед созданием hello фабрики обмена сообщениями. Этот параметр влияет на все клиенты, создаваемые этой фабрикой.

Пакетная обработка toodisable, задайте hello [BatchFlushInterval] [ BatchFlushInterval] свойство слишком**TimeSpan.Zero**. Например:

```csharp
MessagingFactorySettings mfs = new MessagingFactorySettings();
mfs.TokenProvider = tokenProvider;
mfs.NetMessagingTransportSettings.BatchFlushInterval = TimeSpan.FromSeconds(0.05);
MessagingFactory messagingFactory = MessagingFactory.Create(namespaceUri, mfs);
```

Пакетная обработка не влияет на количество оплачиваемых операций обмена сообщениями в hello и доступна только для hello протокола клиента Service Bus. Hello протокол HTTP не поддерживает пакетную обработку.

## <a name="batching-store-access"></a>Пакетный доступ к хранилищу
При записи внутреннее хранилище tooits tooincrease hello пропускную способность очереди, раздела или подписки, Service Bus пакетов несколько сообщений. Если включена очередь или раздел, запись сообщений в хранилище hello будут объединены. Если включена очередь или подписка, удаление сообщений из hello хранилища будут передаваться пакетами. Если для сущности включен доступ к хранилищу в пакетном режиме, задержки при операции записи хранилища, относительно этой сущности путем копирования too20ms Service Bus. Дополнительные операции с хранилищем, возникающие во время этого интервала, добавляются toohello пакета. Пакетный доступ к хранилищу влияет только на операции **отправки** и **завершения**. Операции получения не затрагиваются. Пакетный доступ к хранилищу является свойством сущности. Пакетная обработка применяется ко всем сущностям, для которых включен пакетный доступ к хранилищу.

При создании новой очереди, раздела или подписки пакетный доступ к хранилищу включен по умолчанию. доступ к хранилищу, набор hello в пакетном режиме toodisable [EnableBatchedOperations] [ EnableBatchedOperations] свойство слишком**false** перед созданием сущности hello. Например:

```csharp
QueueDescription qd = new QueueDescription();
qd.EnableBatchedOperations = false;
Queue q = namespaceManager.CreateQueue(qd);
```

Доступ к хранилищу в пакетном режиме не влияет на количество оплачиваемых операций обмена сообщениями в hello и является свойством очереди, раздела или подписки. Она не зависит от hello получать режим и hello протокола, используемого между клиентом и hello службы Service Bus.

## <a name="prefetching"></a>Предварительная выборка
Предварительная выборка позволяет hello очереди или подписки клиента tooload дополнительные сообщения от службы hello, при выполнении операции получения. Hello клиент сохраняет эти сообщения в локальном кэше. размер Hello hello кэша определяется hello [QueueClient.PrefetchCount] [ QueueClient.PrefetchCount] или [SubscriptionClient.PrefetchCount] [ SubscriptionClient.PrefetchCount] свойства. В каждом клиенте с включенной предварительной выборкой создается собственный кэш. Кэш не может использоваться одновременно несколькими клиентами. Если hello клиент инициирует операцию получения и его кэш пуст, hello служба передает пакет сообщений. Hello размер пакета hello равен размеру hello hello кэша или 256 КБ, какое значение меньше. Если кэш hello содержит сообщение hello клиент инициирует операцию получения, приветственное сообщение берется из кэша hello.

Если сообщение предварительно выбрано, предварительно выбранное сообщение hello блокировки hello службы. Благодаря этому предварительно выбранное сообщение hello не может получить другой получатель. Если получатель hello не может завершить приветственное сообщение, до истечения срока действия блокировки Здравствуй, приветственное сообщение становится доступных tooother приемников. упреждающая выборка Hello копию сообщения hello остается в кэше hello. Hello получатель, который использует hello истек срок действия кэшированных копии получит сообщение об ошибке, когда он пытается toocomplete этого сообщения. По умолчанию блокировка сообщения hello истекает через 60 секунд. Это значение может быть расширенные too5 минут. Использование hello tooprevent сообщений с истекшим сроком, размер кэша hello всегда должно быть меньше hello количество сообщений, которые могут быть использованы клиентом в течение времени ожидания блокировки hello.

При использовании срока блокировки по умолчанию hello 60 секунд, хорошо подходит значение для [SubscriptionClient.PrefetchCount] [ SubscriptionClient.PrefetchCount] 20 раз hello максимальное скорость обработки для всех получателей фабрики hello. Например фабрика создает 3 получателей, и каждый получатель может обработать too10 сообщений в секунду. Счетчик предварительной выборки Hello не должна превышать 20 X 3 X 10 = 600. По умолчанию [QueueClient.PrefetchCount] [ QueueClient.PrefetchCount] — набор too0, это означает, что никаких дополнительных сообщений не будут выбраны из службы hello.

Предварительная выборка сообщений, что повышает общую пропускную способность очереди или подписки hello, так как это снижает hello общее количество операций с сообщениями или циклов приема-передачи. Получение первого сообщения hello, однако займет больше времени (из-за toohello увеличить размер сообщения). Получение предварительно выбранных сообщений будет выполняться быстрее, поскольку эти сообщения уже были загружены клиентом hello.

срок жизни (TTL) свойство Hello сообщения проверяется сервером hello hello момент hello сервер отправляет клиенту toohello сообщение hello. При получении сообщения hello Hello клиент не проверяет свойство TTL сообщения hello. Вместо этого может быть получено сообщение hello, даже если срок ЖИЗНИ сообщения hello истек во время кэширования клиентом hello приветственное сообщение.

Предварительная выборка не влияет на количество оплачиваемых операций обмена сообщениями в hello и доступна только для hello протокола клиента Service Bus. Hello протокол HTTP не поддерживает предварительную выборку. Предварительная выборка доступна как для синхронных, так и для асинхронных операций получения.

## <a name="express-queues-and-topics"></a>Экспресс-очереди и экспресс-разделы

Экспресс-сущностей включите высокой пропускной способности и сценариях сокращенной задержки и поддерживаются только стандартный уровень обмена сообщениями hello. Сущности, созданные в [пространства имен Premium](service-bus-premium-messaging.md) не поддерживают параметр express hello. С экспресс-сущностей Если сообщение отправляется tooa очередь или раздел, приветственное сообщение не хранятся непосредственно в хранилище сообщений hello. Вместо этого оно сохраняется в кэше, расположенном в памяти. Если сообщение остается в очереди hello на несколько секунд, оно автоматически записывается toostable хранилище, таким образом защищая его от потери из-за сбоя tooan. Написание приветственное сообщение в кэш памяти повышает пропускную способность и сокращает задержки, так как нет доступа к toostable отправляется хранилище на приветственное сообщение hello времени. Сообщения, используемые в течение нескольких секунд не записываются toohello хранилище обмена сообщениями. Следующий пример Hello создается экспресс-раздел.

```csharp
TopicDescription td = new TopicDescription(TopicName);
td.EnableExpress = true;
namespaceManager.CreateTopic(td);
```

При отправке сообщения, содержащего критически важной информации, которая не может быть потеряна tooan экспресс-сущность hello отправитель может потребовать Service Bus tooimmediately сохранения хранилища toostable сообщений hello, установка hello [ForcePersistence] [ ForcePersistence] свойство слишком**true**.

> [!NOTE]
> Транзакции не поддерживаются экспресс-сущностями.

## <a name="use-of-partitioned-queues-or-topics"></a>Использование секционированных очередей или разделов
На внутреннем уровне использует Service Bus hello того же узла и обмена сообщениями tooprocess хранилища и хранить все сообщения для сущности обмена сообщениями (очереди или раздела). Секционированная очередь или раздел, на hello другой стороны, распределяется по нескольким узлам и хранилищам сообщений. Секционированные очереди и разделы не только повышают пропускную способность в сравнении с обычными очередями и разделами, но также обеспечивают высочайший уровень доступности. toocreate секционированную сущность hello набор [параметр EnablePartitioning] [ EnablePartitioning] свойство слишком**true**, как показано в следующий пример hello. Дополнительные сведения о секционированных сущностях см. в статье [Секционированные сущности обмена сообщениями][Partitioned messaging entities].

```csharp
// Create partitioned queue.
QueueDescription qd = new QueueDescription(QueueName);
qd.EnablePartitioning = true;
namespaceManager.CreateQueue(qd);
```

## <a name="use-of-multiple-queues"></a>Использование нескольких очередей

Если нет возможности toouse, секционированная очередь или раздел или hello ожидаемого нагрузки не может быть обработана одной секционированной очереди или раздела, необходимо использовать несколько сущностей обмена сообщениями. При использовании нескольких сущностей создайте выделенный клиент для каждой сущности, вместо использования hello же клиента для всех сущностей.

## <a name="development-and-testing-features"></a>Возможности для разработки и тестирования

В служебной шине доступна одна функция, используемая специально для разработки, которую **никогда не следует использовать в рабочих конфигурациях**: [TopicDescription.EnableFilteringMessagesBeforePublishing][].

Когда toohello разделе добавляются новые правила или фильтры, можно использовать [TopicDescription.EnableFilteringMessagesBeforePublishing][] tooverify, hello нового критерия фильтра работает надлежащим образом.

## <a name="scenarios"></a>Сценарии
Hello следующих разделах описаны распространенные сценарии обмена сообщениями и указаны параметры hello предпочитаемый Service Bus. Пропускная способность бывает небольшой (менее 1 сообщения в секунду), средней (1 сообщение в секунду или больше, но не более 100 сообщений в секунду) и высокой (100 сообщений в секунду или больше). Hello число клиентов классифицируется как малое Средний (5 или меньше) (более 5 но меньше или равно too20) и большой (более 20).

### <a name="high-throughput-queue"></a>Очередь с высокой пропускной способностью
Цель: Максимально увеличить пропускную способность hello одной очереди. Hello количество отправителей и получателей невелико.

* Используйте секционированную очередь для повышения производительности и доступности.
* tooincrease hello общую скорость отправки в очередь hello, используйте несколько фабрик toocreate отправителей. Для каждого отправителя используйте асинхронные операции или разделение на потоки.
* tooincrease hello общую скорость приема из очереди hello, используйте несколько получателей toocreate фабрики сообщений.
* Используйте асинхронные операции tootake преимуществами пакетной обработки на стороне клиента.
* Задать hello пакетной обработки интервалов too50ms tooreduce hello число передач клиентского протокола Service Bus. Если используется несколько отправителей, увеличьте hello пакетной обработки too100ms интервал.
* Не отключайте пакетный доступ к хранилищу. Это увеличивает hello общую скорость, с которой сообщения могут записываться в очередь hello.
* Время too20 счетчик упреждающей выборки hello задайте hello максимальную скорость обработки всех получателей фабрики. Это уменьшает количество передач клиентского протокола Service Bus в hello.

### <a name="multiple-high-throughput-queues"></a>Несколько очередей с высокой пропускной способностью
Цель: максимально повысить общую пропускную способность нескольких очередей. Hello пропускная способность отдельной очереди средняя или высокая.

tooobtain максимальную пропускную способность нескольких очередей, используйте параметры hello контура toomaximize hello пропускной способности одной очереди. Кроме того можно используйте различные фабрики toocreate клиенты, отправляющие или получающие в разных очередях.

### <a name="low-latency-queue"></a>Очередь с небольшой задержкой
Цель: минимизировать совокупное время задержки в очереди или разделе. Hello количество отправителей и получателей невелико. пропускная способность Hello hello очереди низкая или средняя.

* Используйте секционированную очередь для повышения доступности.
* Отключите пакетную обработку на стороне клиента. Hello клиент немедленно отправляет сообщение.
* Отключите пакетный доступ к хранилищу. Hello служба немедленно записывает хранилища toohello сообщений hello.
* При использовании одного клиента, задайте hello упреждающей выборки счетчика too20 раз hello скорость обработки hello приемника. Если несколько сообщений поступают в очередь hello по hello же времени, hello протокола клиента Service Bus передает их все на hello то же время. Когда клиент hello получает следующее сообщение hello, данное сообщение уже находится в локальном кэше hello. кэш Hello должен быть небольшим.
* При использовании нескольких клиентов, задайте число too0 hello упреждающей выборки. Таким образом, hello второй клиент может получить второе сообщение hello, пока первый клиент hello по-прежнему обрабатывается первое сообщение hello.

### <a name="queue-with-a-large-number-of-senders"></a>Очередь с большим числом отправителей
Цель: максимально повысить пропускную способность очереди или раздела с большим количеством отправителей. Каждый отправитель отправляет сообщения со средней скоростью. Hello количества получателей мал.

Service Bus обеспечивает копирование tooa одновременных подключений too1000 сущности обмена сообщениями (или 5000 использовании AMQP). Это ограничение действует на уровне пространства имен hello и очередей, разделов и подписок устанавливается ограничение hello количество параллельных соединений для каждого пространства имен. В случае очередей это значение распределяется между отправителями и получателями. Если отправителям требуются все 1000 подключений, следует заменить очередь hello разделом и одной подписке. Раздел принимает вверх too1000 параллельных подключений от отправителей, а hello подписка принимает Дополнительно 1000 параллельных подключений от получателей. Если требуется более 1000 параллельных отправителей, hello отправители должны отправлять сообщения toohello протокол Service Bus с помощью HTTP.

toomaximize пропускной способности, hello следующие:

* Используйте секционированную очередь для повышения производительности и доступности.
* Если каждый отправитель размещается в отдельном процессе, используйте одну фабрику для этого процесса.
* Используйте асинхронные операции tootake преимуществами пакетной обработки на стороне клиента.
* Используйте пакетную обработку 20 мс tooreduce hello количество передач клиентского протокола Service Bus интервала по умолчанию hello.
* Не отключайте пакетный доступ к хранилищу. Это увеличивает hello общую скорость, с которой сообщения могут записываться в очередь hello или раздел.
* Время too20 счетчик упреждающей выборки hello задайте hello максимальную скорость обработки всех получателей фабрики. Это уменьшает количество передач клиентского протокола Service Bus в hello.

### <a name="queue-with-a-large-number-of-receivers"></a>Очередь с большим числом получателей
Цель: Максимизировать hello скорость очереди или подписки с большим числом получателей приема. Каждый получатель получает сообщения со средней скоростью. Hello число отправителей невелико.

Service Bus обеспечивает копирование сущности tooan too1000 одновременных подключений. Если очереди требуется более 1000 получателей, следует заменить очередь hello разделом и несколькими подписками. Каждая подписка может поддерживать too1000 параллельных соединений. Кроме того получатели могут обращаться к очереди hello посредством hello протокол HTTP.

toomaximize пропускной способности, hello следующие:

* Используйте секционированную очередь для повышения производительности и доступности.
* Если каждый получатель размещается в отдельном процессе, используйте одну фабрику для этого процесса.
* Получатели могут использовать синхронные и асинхронные операции. Данный средний hello СК отдельного получателя, пакетная обработка на стороне клиента запроса на завершение не влияет на пропускную способность получателя.
* Не отключайте пакетный доступ к хранилищу. Это уменьшает hello общей нагрузки hello сущности. Это также уменьшает hello общую скорость, с которой сообщения могут записываться в очередь hello или раздел.
* Набор hello упреждающей выборки определяет tooa небольшое значение (например, PrefetchCount = 10). Это позволит избежать ситуации, когда одни получатели простаивают, а другие получают множество кэшированных сообщений.

### <a name="topic-with-a-small-number-of-subscriptions"></a>Раздел с небольшим количеством подписок
Цель: Максимально увеличить пропускную способность раздела с небольшим числом подписок hello. Сообщение получается большим числом подписок, означающее hello вместе получать скорость по всем подпискам больше, чем скорость отправки hello. Hello число отправителей невелико. Hello число получателей в каждой подписке невелико.

toomaximize пропускной способности, hello следующие:

* Используйте секционированный раздел для повышения уровня доступности и производительности.
* tooincrease hello общую скорость отправки в раздел hello, используйте несколько фабрик toocreate отправителей. Для каждого отправителя используйте асинхронные операции или разделение на потоки.
* tooincrease hello общую скорость приема из подписки, используйте несколько получателей toocreate фабрики сообщений. Для каждого получателя используйте асинхронные операции или разделение на потоки.
* Используйте асинхронные операции tootake преимуществами пакетной обработки на стороне клиента.
* Используйте пакетную обработку 20 мс tooreduce hello количество передач клиентского протокола Service Bus интервала по умолчанию hello.
* Не отключайте пакетный доступ к хранилищу. Это увеличивает hello общую скорость, с которой сообщения могут записываться в разделе hello.
* Время too20 счетчик упреждающей выборки hello задайте hello максимальную скорость обработки всех получателей фабрики. Это уменьшает количество передач клиентского протокола Service Bus в hello.

### <a name="topic-with-a-large-number-of-subscriptions"></a>Раздел с большим количеством подписок
Цель: Максимально увеличить пропускную способность раздела с большим числом подписок hello. Сообщение получается большим числом подписок, означающее hello вместе получать скорость по всем подпискам гораздо больше, чем скорость отправки hello. Hello число отправителей невелико. Hello число получателей в каждой подписке невелико.

Разделы с большим числом подписок обычно предоставляют низкую общую пропускную способность, если все сообщения, перенаправленные tooall подписки. Это вызвано hello тем, что каждое сообщение получается несколько раз, и все сообщения, которые содержатся в разделах и все его подписки хранятся в hello же хранения. Предполагается небольшого числа hello отправителей и получателей в каждой подписке. Служебная шина поддерживает копирование too2 000 подписок для каждого раздела.

toomaximize пропускной способности, hello следующие:

* Используйте секционированный раздел для повышения уровня доступности и производительности.
* Используйте асинхронные операции tootake преимуществами пакетной обработки на стороне клиента.
* Используйте пакетную обработку 20 мс tooreduce hello количество передач клиентского протокола Service Bus интервала по умолчанию hello.
* Не отключайте пакетный доступ к хранилищу. Это увеличивает hello общую скорость, с которой сообщения могут записываться в разделе hello.
* Задайте hello предварительную загрузку count too20 раз hello требуется получать частота в секундах. Это уменьшает количество передач клиентского протокола Service Bus в hello.

## <a name="next-steps"></a>Дальнейшие действия
toolearn более об оптимизации производительности служебной шины. в разделе [секционированные сущности обмена сообщениями][Partitioned messaging entities].

[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[MessageSender]: /dotnet/api/microsoft.servicebus.messaging.messagesender
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[PeekLock]: /dotnet/api/microsoft.servicebus.messaging.receivemode
[ReceiveAndDelete]: /dotnet/api/microsoft.servicebus.messaging.receivemode
[BatchFlushInterval]: /dotnet/api/microsoft.servicebus.messaging.netmessagingtransportsettings.batchflushinterval#Microsoft_ServiceBus_Messaging_NetMessagingTransportSettings_BatchFlushInterval
[EnableBatchedOperations]: /dotnet/api/microsoft.servicebus.messaging.queuedescription.enablebatchedoperations#Microsoft_ServiceBus_Messaging_QueueDescription_EnableBatchedOperations
[QueueClient.PrefetchCount]: /dotnet/api/microsoft.servicebus.messaging.queueclient.prefetchcount#Microsoft_ServiceBus_Messaging_QueueClient_PrefetchCount
[SubscriptionClient.PrefetchCount]: /dotnet/api/microsoft.servicebus.messaging.subscriptionclient.prefetchcount#Microsoft_ServiceBus_Messaging_SubscriptionClient_PrefetchCount
[ForcePersistence]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence#Microsoft_ServiceBus_Messaging_BrokeredMessage_ForcePersistence
[EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription.enablepartitioning#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[Partitioned messaging entities]: service-bus-partitioning.md
[TopicDescription.EnableFilteringMessagesBeforePublishing]: /dotnet/api/microsoft.servicebus.messaging.topicdescription.enablefilteringmessagesbeforepublishing#Microsoft_ServiceBus_Messaging_TopicDescription_EnableFilteringMessagesBeforePublishing
