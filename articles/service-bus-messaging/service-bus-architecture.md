---
title: "Обзор архитектуры обработки сообщений служебной шины Azure | Документация Майкрософт"
description: "Здесь описана архитектура обработки сообщений, которая используется служебной шиной Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: baf94c2d-0e58-4d5d-a588-767f996ccf7f
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: b810618b485b631e1d72b24c2a9587017d635cc4
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="service-bus-architecture"></a>Архитектура служебной шины
В этой статье описывается архитектура обработки сообщений, которая используется служебной шиной Azure.

## <a name="service-bus-scale-units"></a>Единицы масштабирования служебной шины
Содержимое служебной шины упорядочено по *единицам масштабирования*. Единица масштабирования — это единица развертывания, которая содержит все компоненты, необходимые для запуска службы. Для каждой области развертывается одна или несколько единиц масштабирования служебной шины.

С единицей масштабирования сопоставляется пространство имен служебной шины. Единица масштабирования охватывает все типы сущностей служебной шины (очереди, разделы, подписки). Единица масштабирования служебной шины состоит из следующих компонентов.

* **Набор узлов шлюза.** Узлы шлюза проверяют подлинность входящих запросов. У каждого узла шлюза есть общедоступный IP-адрес.
* **Набор узлов брокера сообщений.** Узлы брокера сообщений обрабатывают запросы к сущностям обмена сообщениями.
* **Единое хранилище шлюза.** Хранилище шлюза содержит данные по каждой сущности, определенной в соответствующей единице масштабирования. Хранилище шлюза реализуется на основе базы данных SQL Azure.
* **Несколько хранилищ сообщений.** Хранилища сообщений содержат сообщения из всех очередей, разделов и подписок, определенных в соответствующей единице масштабирования. Здесь же хранятся все данные подписки. Если не включить [секционированные сущности обмена сообщениями](service-bus-partitioning.md), очередь или раздел будут сопоставлены с одним хранилищем сообщений. Подписки хранятся в том же хранилище сообщений, что и соответствующий родительский раздел. Хранилища сообщений реализуются поверх баз данных SQL Azure (это не касается [обмена сообщениями через служебную шину категории "Премиум"](service-bus-premium-messaging.md)).

## <a name="containers"></a>Контейнеры
Каждой сущности обмена сообщениями назначается определенный контейнер. Контейнер — это логическая конструкция, которая использует одно хранилище сообщений для хранения всех соответствующих данных в этом контейнере. Каждый контейнер назначается узлу брокера сообщений. Обычно контейнеров больше, чем узлов брокера сообщений. Таким образом, каждый узел брокера сообщений загружает несколько контейнеров. Контейнеры назначаются узлу брокера сообщений таким образом, чтобы все узлы брокера сообщений были загружены в равной мере. Если шаблон нагрузки меняется (например, один из контейнеров загружается слишком сильно) или узел брокера сообщений становится временно недоступным, контейнеры перераспределяются между узлами брокера сообщений.

## <a name="processing-of-incoming-messaging-requests"></a>Обработка входящих запросов обмена сообщениями
Когда клиент отправляет запрос на служебную шину, подсистема балансировки нагрузки Azure передает его в один из узлов шлюза. Узел шлюза авторизует запрос. Если запрос относится к сущности обмена сообщениями (очереди, разделу или подписке), узел шлюза выполняет поиск этой сущности в хранилище шлюза и определяет, в каком хранилище сообщений она находится. Затем он определяет, какой узел брокера сообщений обслуживает данный контейнер в настоящий момент, и отправляет запрос на этот узел брокера сообщений. Узел брокера сообщений обрабатывает запрос и обновляет состояние сущности в хранилище контейнера. Узел брокера сообщений отправляет ответ обратно на узел шлюза, который пересылает соответствующий ответ клиенту, отправившему исходный запрос.

![Обработка входящих запросов обмена сообщениями](./media/service-bus-architecture/ic690644.png)

## <a name="next-steps"></a>Дальнейшие действия
Теперь, когда вы прочитали общие сведения об архитектуре служебной шины, воспользуйтесь следующими ссылками, чтобы получить дополнительные сведения:

* [Основные сведения об обмене сообщениями через служебную шину](service-bus-messaging-overview.md)
* [Базовая информация о Service Bus](service-bus-fundamentals-hybrid-solutions.md)
* [Решение для обмена сообщениями в очередях с помощью очередей служебной шины](service-bus-dotnet-multi-tier-app-using-service-bus-queues.md)


