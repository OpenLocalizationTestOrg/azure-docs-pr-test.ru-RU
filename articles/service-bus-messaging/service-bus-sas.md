---
title: "Проверка подлинности Service Bus aaaAzure с подписями коллективного доступа | Документы Microsoft"
description: "Обзор аутентификации служебной шины с помощью подписанных URL-адресов, а также сведения об аутентификации SAS с помощью служебной шины Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: 773bb11720384d7245820b56dc25b8e064ffa746
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="service-bus-authentication-with-shared-access-signatures"></a><span data-ttu-id="934af-103">Аутентификация служебной шины с помощью подписанных URL-адресов</span><span class="sxs-lookup"><span data-stu-id="934af-103">Service Bus authentication with Shared Access Signatures</span></span>

<span data-ttu-id="934af-104">*Подписи коллективного доступа* (SAS), hello безопасности основной механизм для обмена сообщениями Service Bus.</span><span class="sxs-lookup"><span data-stu-id="934af-104">*Shared Access Signatures* (SAS) are hello primary security mechanism for Service Bus messaging.</span></span> <span data-ttu-id="934af-105">В этой статье рассматриваются SAS, как они работают и как toouse их в виде зависящий от платформы.</span><span class="sxs-lookup"><span data-stu-id="934af-105">This article discusses SAS, how they work, and how toouse them in a platform-agnostic way.</span></span>

<span data-ttu-id="934af-106">Проверка подлинности SAS позволяет tooService tooauthenticate приложений шины с помощью клавиши доступа, настроенной на приветствия имен или hello сущности (очереди или раздела) обмена сообщениями с связаны определенные права.</span><span class="sxs-lookup"><span data-stu-id="934af-106">SAS authentication enables applications tooauthenticate tooService Bus using an access key configured on hello namespace, or on hello messaging entity (queue or topic) with which specific rights are associated.</span></span> <span data-ttu-id="934af-107">Затем можно использовать этот ключа toogenerate маркер SAS, которая tooauthenticate tooService шины в свою очередь может использоваться клиентами.</span><span class="sxs-lookup"><span data-stu-id="934af-107">You can then use this key toogenerate a SAS token that clients can in turn use tooauthenticate tooService Bus.</span></span>

<span data-ttu-id="934af-108">Поддержка проверки подлинности SAS включается в hello Azure SDK версии 2.0 и более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="934af-108">SAS authentication support is included in hello Azure SDK version 2.0 and later.</span></span>

## <a name="overview-of-sas"></a><span data-ttu-id="934af-109">Общие сведения о SAS</span><span class="sxs-lookup"><span data-stu-id="934af-109">Overview of SAS</span></span>

<span data-ttu-id="934af-110">Подписи общего доступа представляют собой механизм проверки подлинности на основе безопасных хэшей SHA-256 или URI.</span><span class="sxs-lookup"><span data-stu-id="934af-110">Shared Access Signatures are an authentication mechanism based on SHA-256 secure hashes or URIs.</span></span> <span data-ttu-id="934af-111">Это очень мощный механизм, который используется всеми службами служебной шины.</span><span class="sxs-lookup"><span data-stu-id="934af-111">SAS is an extremely powerful mechanism that is used by all Service Bus services.</span></span> <span data-ttu-id="934af-112">На практике SAS состоит из двух компонентов: *политики общего доступа* и *подписанного URL-адреса* (который часто называется *маркером*).</span><span class="sxs-lookup"><span data-stu-id="934af-112">In actual use, SAS has two components: a *shared access policy* and a *Shared Access Signature* (often called a *token*).</span></span>

<span data-ttu-id="934af-113">Проверка подлинности SAS в Service Bus включается конфигурация hello криптографического ключа со связанными правами для ресурса Service Bus.</span><span class="sxs-lookup"><span data-stu-id="934af-113">SAS authentication in Service Bus involves hello configuration of a cryptographic key with associated rights on a Service Bus resource.</span></span> <span data-ttu-id="934af-114">Клиенты утверждения доступа tooService шины ресурсов путем предъявления маркера SAS.</span><span class="sxs-lookup"><span data-stu-id="934af-114">Clients claim access tooService Bus resources by presenting a SAS token.</span></span> <span data-ttu-id="934af-115">Этот маркер состоит из hello ресурса (URI) для вызываемой и срока действия подписана hello настроить ключ.</span><span class="sxs-lookup"><span data-stu-id="934af-115">This token consists of hello resource URI being accessed, and an expiry signed with hello configured key.</span></span>

<span data-ttu-id="934af-116">Правила авторизации подписанного URL-адреса можно настроить в [ретрансляторах](service-bus-fundamentals-hybrid-solutions.md#relays), [очередях](service-bus-fundamentals-hybrid-solutions.md#queues) и [разделах](service-bus-fundamentals-hybrid-solutions.md#topics) служебной шины.</span><span class="sxs-lookup"><span data-stu-id="934af-116">You can configure Shared Access Signature authorization rules on Service Bus [relays](service-bus-fundamentals-hybrid-solutions.md#relays), [queues](service-bus-fundamentals-hybrid-solutions.md#queues), and [topics](service-bus-fundamentals-hybrid-solutions.md#topics).</span></span>

<span data-ttu-id="934af-117">Проверка подлинности SAS использует hello следующие элементы:</span><span class="sxs-lookup"><span data-stu-id="934af-117">SAS authentication uses hello following elements:</span></span>

* <span data-ttu-id="934af-118">[Правило авторизации общего доступа](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): 256-битный основной криптографический ключ в кодировке Base64, необязательный дополнительный ключ, имя ключа и соответствующие права (набор прав на *прослушивание*, *отправку* и *управление*).</span><span class="sxs-lookup"><span data-stu-id="934af-118">[Shared Access authorization rule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): A 256-bit primary cryptographic key in Base64 representation, an optional secondary key, and a key name and associated rights (a collection of *Listen*, *Send*, or *Manage* rights).</span></span>
* <span data-ttu-id="934af-119">[Подписанный URL-](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) маркера: создан с помощью hello HMAC-SHA256 строки ресурса, состоящий из URI ресурса hello, к которому осуществляется hello и срока действия с криптографическим ключом hello.</span><span class="sxs-lookup"><span data-stu-id="934af-119">[Shared Access Signature](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token: Generated using hello HMAC-SHA256 of a resource string, consisting of hello URI of hello resource that is accessed and an expiry, with hello cryptographic key.</span></span> <span data-ttu-id="934af-120">подпись Hello и другие элементы, описанные в следующих разделах hello форматируются в строку tooform hello маркер SAS.</span><span class="sxs-lookup"><span data-stu-id="934af-120">hello signature and other elements described in hello following sections are formatted into a string tooform hello SAS token.</span></span>

## <a name="shared-access-policy"></a><span data-ttu-id="934af-121">Политика общего доступа</span><span class="sxs-lookup"><span data-stu-id="934af-121">Shared access policy</span></span>

<span data-ttu-id="934af-122">Главное toounderstand о SAS — что он начинается с политикой.</span><span class="sxs-lookup"><span data-stu-id="934af-122">An important thing toounderstand about SAS is that it starts with a policy.</span></span> <span data-ttu-id="934af-123">Для каждой политики необходимо выбрать три элемента информации: **имя**, **область** и **разрешения**.</span><span class="sxs-lookup"><span data-stu-id="934af-123">For each policy, you decide on three pieces of information: **name**, **scope**, and **permissions**.</span></span> <span data-ttu-id="934af-124">Hello **имя** , является; уникальное имя в пределах данной области.</span><span class="sxs-lookup"><span data-stu-id="934af-124">hello **name** is just that; a unique name within that scope.</span></span> <span data-ttu-id="934af-125">Hello области достаточно просто: его hello URI ресурса hello в вопросе.</span><span class="sxs-lookup"><span data-stu-id="934af-125">hello scope is easy enough: it's hello URI of hello resource in question.</span></span> <span data-ttu-id="934af-126">Для пространства имен Service Bus, hello относится hello полное доменное имя (FQDN), такие как `https://<yournamespace>.servicebus.windows.net/`.</span><span class="sxs-lookup"><span data-stu-id="934af-126">For a Service Bus namespace, hello scope is hello fully qualified domain name (FQDN), such as `https://<yournamespace>.servicebus.windows.net/`.</span></span>

<span data-ttu-id="934af-127">во многом очевидны Hello доступные разрешения для политики:</span><span class="sxs-lookup"><span data-stu-id="934af-127">hello available permissions for a policy are largely self-explanatory:</span></span>

* <span data-ttu-id="934af-128">Отправка</span><span class="sxs-lookup"><span data-stu-id="934af-128">Send</span></span>
* <span data-ttu-id="934af-129">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-129">Listen</span></span>
* <span data-ttu-id="934af-130">Управление</span><span class="sxs-lookup"><span data-stu-id="934af-130">Manage</span></span>

<span data-ttu-id="934af-131">После создания политики hello, ей назначается *первичного ключа* и *вторичный ключ*.</span><span class="sxs-lookup"><span data-stu-id="934af-131">After you create hello policy, it is assigned a *Primary Key* and a *Secondary Key*.</span></span> <span data-ttu-id="934af-132">Это криптографически строгие ключи.</span><span class="sxs-lookup"><span data-stu-id="934af-132">These are cryptographically strong keys.</span></span> <span data-ttu-id="934af-133">Не потеряны и их утечка — они всегда будут доступны в hello [портал Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="934af-133">Don't lose them or leak them - they'll always be available in hello [Azure portal][Azure portal].</span></span> <span data-ttu-id="934af-134">Можно использовать любой из созданных hello ключи и повторно создать их в любое время.</span><span class="sxs-lookup"><span data-stu-id="934af-134">You can use either of hello generated keys, and you can regenerate them at any time.</span></span> <span data-ttu-id="934af-135">Тем не менее если повторно создать или изменить первичный ключ hello в политике hello, станут недействительными все подписанные URL-адреса созданные из нее.</span><span class="sxs-lookup"><span data-stu-id="934af-135">However, if you regenerate or change hello primary key in hello policy, any Shared Access Signatures created from it will be invalidated.</span></span>

<span data-ttu-id="934af-136">При создании пространства имен Service Bus политики создается автоматически для всего пространства имен hello вызывается **RootManageSharedAccessKey**, и эта политика имеет все разрешения.</span><span class="sxs-lookup"><span data-stu-id="934af-136">When you create a Service Bus namespace, a policy is automatically created for hello entire namespace called **RootManageSharedAccessKey**, and this policy has all permissions.</span></span> <span data-ttu-id="934af-137">Так как вы не входите в систему как **привилегированный пользователь**, не используйте эту политику без действительно веской причины.</span><span class="sxs-lookup"><span data-stu-id="934af-137">You don't log on as **root**, so don't use this policy unless there's a really good reason.</span></span> <span data-ttu-id="934af-138">Можно создать дополнительные политики в hello **Настройка** вкладки для пространства имен hello hello портала.</span><span class="sxs-lookup"><span data-stu-id="934af-138">You can create additional policies in hello **Configure** tab for hello namespace in hello portal.</span></span> <span data-ttu-id="934af-139">Это важные toonote, уровень одно дерево в Service Bus (пространство имен, очереди, т. д.) может иметь только копирование tooit too12 присоединенного политики.</span><span class="sxs-lookup"><span data-stu-id="934af-139">It's important toonote that a single tree level in Service Bus (namespace, queue, etc.) can only have up too12 policies attached tooit.</span></span>

## <a name="configuration-for-shared-access-signature-authentication"></a><span data-ttu-id="934af-140">Настройка проверки подлинности подписанного URL-адреса</span><span class="sxs-lookup"><span data-stu-id="934af-140">Configuration for Shared Access Signature authentication</span></span>
<span data-ttu-id="934af-141">Можно настроить hello [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) правило на пространства имен служебной шины, очереди или разделы.</span><span class="sxs-lookup"><span data-stu-id="934af-141">You can configure hello [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) rule on Service Bus namespaces, queues, or topics.</span></span> <span data-ttu-id="934af-142">Настройка [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) на Service Bus подписка в настоящее время не поддерживается, но можно использовать правила, настроенные на пространство имен или разделе toosubscriptions toosecure доступа.</span><span class="sxs-lookup"><span data-stu-id="934af-142">Configuring a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) on a Service Bus subscription is currently not supported, but you can use rules configured on a namespace or topic toosecure access toosubscriptions.</span></span> <span data-ttu-id="934af-143">Рабочий образец иллюстрирует эту процедуру см. в разделе hello [проверки подлинности с помощью общего подписи доступа (SAS) с подписками Service Bus](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) образца.</span><span class="sxs-lookup"><span data-stu-id="934af-143">For a working sample that illustrates this procedure, see hello [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) sample.</span></span>

<span data-ttu-id="934af-144">В пространстве имен, очереди или разделе служебной шины можно настроить до 12 таких правил.</span><span class="sxs-lookup"><span data-stu-id="934af-144">A maximum of 12 such rules can be configured on a Service Bus namespace, queue, or topic.</span></span> <span data-ttu-id="934af-145">Правила, которые можно настроить на пространство имен служебной шины применяются tooall сущностей в этом пространстве имен.</span><span class="sxs-lookup"><span data-stu-id="934af-145">Rules that are configured on a Service Bus namespace apply tooall entities in that namespace.</span></span>

![SAS](./media/service-bus-sas/service-bus-namespace.png)

<span data-ttu-id="934af-147">На этом рисунке hello *manageRuleNS*, *sendRuleNS*, и *listenRuleNS* применяются правила авторизации, tooboth очередь Q1 и к разделу T1, пока *listenRuleQ*  и *sendRuleQ* применяются только tooqueue Q1 и *sendRuleT* применяется только tootopic T1.</span><span class="sxs-lookup"><span data-stu-id="934af-147">In this figure, hello *manageRuleNS*, *sendRuleNS*, and *listenRuleNS* authorization rules apply tooboth queue Q1 and topic T1, while *listenRuleQ* and *sendRuleQ* apply only tooqueue Q1 and *sendRuleT* applies only tootopic T1.</span></span>

<span data-ttu-id="934af-148">Здравствуйте, важнейшие параметры [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) , как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="934af-148">hello key parameters of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) are as follows:</span></span>

| <span data-ttu-id="934af-149">Параметр</span><span class="sxs-lookup"><span data-stu-id="934af-149">Parameter</span></span> | <span data-ttu-id="934af-150">Описание</span><span class="sxs-lookup"><span data-stu-id="934af-150">Description</span></span> |
| --- | --- |
| <span data-ttu-id="934af-151">*KeyName*</span><span class="sxs-lookup"><span data-stu-id="934af-151">*KeyName*</span></span> |<span data-ttu-id="934af-152">Строка, описывающая hello правила авторизации.</span><span class="sxs-lookup"><span data-stu-id="934af-152">A string that describes hello authorization rule.</span></span> |
| <span data-ttu-id="934af-153">*PrimaryKey*</span><span class="sxs-lookup"><span data-stu-id="934af-153">*PrimaryKey*</span></span> |<span data-ttu-id="934af-154">Base64-кодированном 256-разрядный первичный ключ для подписания и проверки маркера SAS hello.</span><span class="sxs-lookup"><span data-stu-id="934af-154">A base64-encoded 256-bit primary key for signing and validating hello SAS token.</span></span> |
| <span data-ttu-id="934af-155">*SecondaryKey*</span><span class="sxs-lookup"><span data-stu-id="934af-155">*SecondaryKey*</span></span> |<span data-ttu-id="934af-156">Base64-кодированном 256-разрядный вторичный ключ для подписания и проверки маркера SAS hello.</span><span class="sxs-lookup"><span data-stu-id="934af-156">A base64-encoded 256-bit secondary key for signing and validating hello SAS token.</span></span> |
| <span data-ttu-id="934af-157">*AccessRights*</span><span class="sxs-lookup"><span data-stu-id="934af-157">*AccessRights*</span></span> |<span data-ttu-id="934af-158">Список прав доступа, предоставляемых правилом авторизации hello.</span><span class="sxs-lookup"><span data-stu-id="934af-158">A list of access rights granted by hello authorization rule.</span></span> <span data-ttu-id="934af-159">Эти права могут быть любым набором прав на прослушивание, отправку и управление.</span><span class="sxs-lookup"><span data-stu-id="934af-159">These rights can be any collection of Listen, Send, and Manage rights.</span></span> |

<span data-ttu-id="934af-160">При подготовке пространства имен Service Bus [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), с [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) значение слишком**RootManageSharedAccessKey**, создается по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="934af-160">When a Service Bus namespace is provisioned, a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), with [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) set too**RootManageSharedAccessKey**, is created by default.</span></span>

## <a name="generate-a-shared-access-signature-token"></a><span data-ttu-id="934af-161">Создание подписанного URL-адреса (маркера)</span><span class="sxs-lookup"><span data-stu-id="934af-161">Generate a Shared Access Signature (token)</span></span>

<span data-ttu-id="934af-162">сама политика Hello не hello маркер доступа для Service Bus.</span><span class="sxs-lookup"><span data-stu-id="934af-162">hello policy itself is not hello access token for Service Bus.</span></span> <span data-ttu-id="934af-163">— Это объект hello, из которого hello создается маркер доступа - с помощью либо hello первичный или вторичный ключ.</span><span class="sxs-lookup"><span data-stu-id="934af-163">It is hello object from which hello access token is generated - using either hello primary or secondary key.</span></span> <span data-ttu-id="934af-164">Любой клиент, имеющий доступ toohello подписи ключи, указанные в правиле авторизации общего доступа hello можно создать токен SAS hello.</span><span class="sxs-lookup"><span data-stu-id="934af-164">Any client that has access toohello signing keys specified in hello shared access authorization rule can generate hello SAS token.</span></span> <span data-ttu-id="934af-165">токен Hello создается тщательно разработать строку в кодировке hello:</span><span class="sxs-lookup"><span data-stu-id="934af-165">hello token is generated by carefully crafting a string in hello following format:</span></span>

```
SharedAccessSignature sig=<signature-string>&se=<expiry>&skn=<keyName>&sr=<URL-encoded-resourceURI>
```

<span data-ttu-id="934af-166">Где `signature-string` область hello маркера hello хэш hello SHA-256 (**область** как описано в предыдущем разделе hello) с добавляется код CRLF и время истечения срока действия (в секундах с начала эпохи hello: `00:00:00 UTC` 1 января 1970 года).</span><span class="sxs-lookup"><span data-stu-id="934af-166">Where `signature-string` is hello SHA-256 hash of hello scope of hello token (**scope** as described in hello previous section) with a CRLF appended and an expiry time (in seconds since hello epoch: `00:00:00 UTC` on 1 January 1970).</span></span> 

> [!NOTE]
> <span data-ttu-id="934af-167">tooavoid короткий срок действия токена, рекомендуется кодировать hello значение времени истечения срока действия, как по крайней мере 32-разрядное целое число без знака или предпочтительно целое long (64-разрядная версия).</span><span class="sxs-lookup"><span data-stu-id="934af-167">tooavoid a short token expiry time, it is recommended that you encode hello expiry time value as at least a 32-bit unsigned integer, or preferably a long (64-bit) integer.</span></span>  
> 
> 

<span data-ttu-id="934af-168">хэш Hello выглядит примерно toohello следующий псевдокод и возвращает 32 байта.</span><span class="sxs-lookup"><span data-stu-id="934af-168">hello hash looks similar toohello following pseudo code and returns 32 bytes.</span></span>

```
SHA-256('https://<yournamespace>.servicebus.windows.net/'+'\n'+ 1438205742)
```

<span data-ttu-id="934af-169">Hello нехэшированные значения находятся в hello **SharedAccessSignature** строки, hello получателя можно вычислить hello хэш-код с hello такими же параметрами, убедиться, что он возвращает toobe hello того же результата.</span><span class="sxs-lookup"><span data-stu-id="934af-169">hello non-hashed values are in hello **SharedAccessSignature** string so that hello recipient can compute hello hash with hello same parameters, toobe sure that it returns hello same result.</span></span> <span data-ttu-id="934af-170">Hello URI указывает область hello и имя ключа hello идентифицирует хэш hello toocompute toobe использовать политики hello.</span><span class="sxs-lookup"><span data-stu-id="934af-170">hello URI specifies hello scope, and hello key name identifies hello policy toobe used toocompute hello hash.</span></span> <span data-ttu-id="934af-171">Это требуется для обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="934af-171">This is important from a security standpoint.</span></span> <span data-ttu-id="934af-172">Если подпись hello не соответствует значению hello получателей (Service Bus) вычисляет, доступ запрещен.</span><span class="sxs-lookup"><span data-stu-id="934af-172">If hello signature doesn't match that which hello recipient (Service Bus) calculates, then access is denied.</span></span> <span data-ttu-id="934af-173">На этом этапе можно быть уверенным, что отправителя hello имел toohello ключ доступа и должны быть предоставлены права hello, указанным в политике hello.</span><span class="sxs-lookup"><span data-stu-id="934af-173">At this point you can be sure that hello sender had access toohello key and should be granted hello rights specified in hello policy.</span></span>

<span data-ttu-id="934af-174">Обратите внимание, что необходимо использовать hello кодировке ресурса (URI) для этой операции.</span><span class="sxs-lookup"><span data-stu-id="934af-174">Note that you should use hello encoded resource URI for this operation.</span></span> <span data-ttu-id="934af-175">Hello ресурса (URI) — hello, который запрашивается полный URI hello доступа toowhich ресурсов служебной шины.</span><span class="sxs-lookup"><span data-stu-id="934af-175">hello resource URI is hello full URI of hello Service Bus resource toowhich access is claimed.</span></span> <span data-ttu-id="934af-176">Например, `http://<namespace>.servicebus.windows.net/<entityPath>` или `sb://<namespace>.servicebus.windows.net/<entityPath>`. Вся строка будет выглядеть так: `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span><span class="sxs-lookup"><span data-stu-id="934af-176">For example, `http://<namespace>.servicebus.windows.net/<entityPath>` or `sb://<namespace>.servicebus.windows.net/<entityPath>`; that is, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span></span>

<span data-ttu-id="934af-177">правила авторизации общего доступа Hello, используемого для подписи должен быть настроен, этот URI, либо один из его родителей иерархических сущности hello.</span><span class="sxs-lookup"><span data-stu-id="934af-177">hello shared access authorization rule used for signing must be configured on hello entity specified by this URI, or by one of its hierarchical parents.</span></span> <span data-ttu-id="934af-178">Например `http://contoso.servicebus.windows.net/contosoTopics/T1` или `http://contoso.servicebus.windows.net` в предыдущем примере hello.</span><span class="sxs-lookup"><span data-stu-id="934af-178">For example, `http://contoso.servicebus.windows.net/contosoTopics/T1` or `http://contoso.servicebus.windows.net` in hello previous example.</span></span>

<span data-ttu-id="934af-179">Маркер SAS действителен для всех ресурсов в группе hello `<resourceURI>` используется в hello `signature-string`.</span><span class="sxs-lookup"><span data-stu-id="934af-179">A SAS token is valid for all resources under hello `<resourceURI>` used in hello `signature-string`.</span></span>

<span data-ttu-id="934af-180">Hello [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) в hello SAS токен относится toohello **keyName** элемента hello правила авторизации общего доступа используется токен toogenerate hello.</span><span class="sxs-lookup"><span data-stu-id="934af-180">hello [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) in hello SAS token refers toohello **keyName** of hello shared access authorization rule used toogenerate hello token.</span></span>

<span data-ttu-id="934af-181">Hello *URL-encoded-resourceURI* необходимо hello так же, как hello URI, используемый в строку hello-входа во время вычисления подписи hello hello.</span><span class="sxs-lookup"><span data-stu-id="934af-181">hello *URL-encoded-resourceURI* must be hello same as hello URI used in hello string-to-sign during hello computation of hello signature.</span></span> <span data-ttu-id="934af-182">Значение должно быть [закодировано с помощью знака процента](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span><span class="sxs-lookup"><span data-stu-id="934af-182">It should be [percent-encoded](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span></span>

<span data-ttu-id="934af-183">Рекомендуется периодически заново формировать ключи hello, используемые в hello [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) объекта.</span><span class="sxs-lookup"><span data-stu-id="934af-183">It is recommended that you periodically regenerate hello keys used in hello [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object.</span></span> <span data-ttu-id="934af-184">Приложения обычно должны использовать hello [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) toogenerate маркер SAS.</span><span class="sxs-lookup"><span data-stu-id="934af-184">Applications should generally use hello [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) toogenerate a SAS token.</span></span> <span data-ttu-id="934af-185">При повторном создании ключей hello, следует заменить hello [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) с старая первичная hello ключом и сформировать новый ключ в качестве hello новый первичный ключ.</span><span class="sxs-lookup"><span data-stu-id="934af-185">When regenerating hello keys, you should replace hello [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) with hello old primary key, and generate a new key as hello new primary key.</span></span> <span data-ttu-id="934af-186">Это позволяет toocontinue использование токенов для авторизации, созданные hello старому первичному ключу, и который еще не истек.</span><span class="sxs-lookup"><span data-stu-id="934af-186">This enables you toocontinue using tokens for authorization that were issued with hello old primary key, and that have not yet expired.</span></span>

<span data-ttu-id="934af-187">Если ключ становится известен посторонним и у вас есть toorevoke hello ключи, можно повторно создать оба hello [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) и hello [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) из [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), заменить их с использованием новых ключей.</span><span class="sxs-lookup"><span data-stu-id="934af-187">If a key is compromised and you have toorevoke hello keys, you can regenerate both hello [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) and hello [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), replacing them with new keys.</span></span> <span data-ttu-id="934af-188">Эта процедура делает недействительными все маркеры, подписанные hello старые ключи.</span><span class="sxs-lookup"><span data-stu-id="934af-188">This procedure invalidates all tokens signed with hello old keys.</span></span>

## <a name="how-toouse-shared-access-signature-authentication-with-service-bus"></a><span data-ttu-id="934af-189">Способ проверки подлинности подписи общего доступа toouse со служебной шиной</span><span class="sxs-lookup"><span data-stu-id="934af-189">How toouse Shared Access Signature authentication with Service Bus</span></span>

<span data-ttu-id="934af-190">Привет, следующие сценарии включают Настройка правил авторизации, Создание маркеров SAS и авторизация клиента.</span><span class="sxs-lookup"><span data-stu-id="934af-190">hello following scenarios include configuration of authorization rules, generation of SAS tokens, and client authorization.</span></span>

<span data-ttu-id="934af-191">Полный рабочий образец приложения служебной шины, который иллюстрирует hello конфигурации и используется авторизация SAS, в разделе [проверки подлинности подписи общего доступа с Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span><span class="sxs-lookup"><span data-stu-id="934af-191">For a full working sample of a Service Bus application that illustrates hello configuration and uses SAS authorization, see [Shared Access Signature authentication with Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span></span> <span data-ttu-id="934af-192">Подходящий пример, иллюстрирующий использование правил авторизации SAS, настроенных в пространствах имен или разделах подписках Service Bus toosecure hello доступен здесь: [проверки подлинности с помощью общего подписи доступа (SAS) с подписками Service Bus ](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span><span class="sxs-lookup"><span data-stu-id="934af-192">A related sample that illustrates hello use of SAS authorization rules configured on namespaces or topics toosecure Service Bus subscriptions is available here: [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span></span>

## <a name="access-shared-access-authorization-rules-on-a-namespace"></a><span data-ttu-id="934af-193">Доступ к правилам авторизации общего доступа в пространстве имен</span><span class="sxs-lookup"><span data-stu-id="934af-193">Access Shared Access Authorization rules on a namespace</span></span>

<span data-ttu-id="934af-194">Операции на корень пространства имен Service Bus hello требуют проверки подлинности сертификата.</span><span class="sxs-lookup"><span data-stu-id="934af-194">Operations on hello Service Bus namespace root require certificate authentication.</span></span> <span data-ttu-id="934af-195">Необходимо передать сертификат управления для вашей подписки Azure.</span><span class="sxs-lookup"><span data-stu-id="934af-195">You must upload a management certificate for your Azure subscription.</span></span> <span data-ttu-id="934af-196">tooupload сертификата управления, выполните действия hello [здесь](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate), с помощью hello [портал Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="934af-196">tooupload a management certificate, follow hello steps [here](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate), using hello [Azure portal][Azure portal].</span></span> <span data-ttu-id="934af-197">Дополнительные сведения о сертификатах управления Azure см. в разделе hello [Общие сведения о сертификатах Azure](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span><span class="sxs-lookup"><span data-stu-id="934af-197">For more information about Azure management certificates, see hello [Azure certificates overview](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span></span>

<span data-ttu-id="934af-198">Конечная точка Hello для доступа к правил авторизации общего доступа на пространство имен служебной шины выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="934af-198">hello endpoint for accessing shared access authorization rules on a Service Bus namespace is as follows:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/
```

<span data-ttu-id="934af-199">toocreate [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) объектов на пространство имен служебной шины, выполните операцию POST для этой конечной точки с hello сериализацией сведений о формате JSON или XML.</span><span class="sxs-lookup"><span data-stu-id="934af-199">toocreate a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object on a Service Bus namespace, execute a POST operation on this endpoint with hello rule information serialized as JSON or XML.</span></span> <span data-ttu-id="934af-200">Например:</span><span class="sxs-lookup"><span data-stu-id="934af-200">For example:</span></span>

```csharp
// Base address for accessing authorization rules on a namespace
string baseAddress = @"https://management.core.windows.net/<subscriptionId>/services/ServiceBus/namespaces/<namespace>/AuthorizationRules/";

// Configure authorization rule with base64-encoded 256-bit key and Send rights
var sendRule = new SharedAccessAuthorizationRule("contosoSendAll",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send });

// Operations on hello Service Bus namespace root require certificate authentication.
WebRequestHandler handler = new WebRequestHandler
{
    ClientCertificateOptions = ClientCertificateOption.Manual
};
// Access hello management certificate by subject name
handler.ClientCertificates.Add(GetCertificate(<certificateSN>));

HttpClient httpClient = new HttpClient(handler)
{
    BaseAddress = new Uri(baseAddress)
};
httpClient.DefaultRequestHeaders.Accept.Add(
    new MediaTypeWithQualityHeaderValue("application/json"));
httpClient.DefaultRequestHeaders.Add("x-ms-version", "2015-01-01");

// Execute a POST operation on hello baseAddress above toocreate an auth rule
var postResult = httpClient.PostAsJsonAsync("", sendRule).Result;
```

<span data-ttu-id="934af-201">Аналогичным образом можно используйте операцию GET на правила hello конечной точки tooread hello авторизации, настроенные в пространстве имен hello.</span><span class="sxs-lookup"><span data-stu-id="934af-201">Similarly, use a GET operation on hello endpoint tooread hello authorization rules configured on hello namespace.</span></span>

<span data-ttu-id="934af-202">tooupdate или удалить определенное правило авторизации, используйте hello, следующая конечная точка:</span><span class="sxs-lookup"><span data-stu-id="934af-202">tooupdate or delete a specific authorization rule, use hello following endpoint:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/{KeyName}
```

## <a name="access-shared-access-authorization-rules-on-an-entity"></a><span data-ttu-id="934af-203">Доступ к правилам авторизации общего доступа в сущности</span><span class="sxs-lookup"><span data-stu-id="934af-203">Access Shared Access Authorization rules on an entity</span></span>

<span data-ttu-id="934af-204">Вы можете получить доступ к [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) настраивается на очередь служебной шины или разделе через hello объекта [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) коллекции в hello соответствующий [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) или [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span><span class="sxs-lookup"><span data-stu-id="934af-204">You can access a [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object configured on a Service Bus queue or topic through hello [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) collection in hello corresponding [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) or [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span></span>

<span data-ttu-id="934af-205">Hello, следующий код показывает, как правила авторизации tooadd для очереди.</span><span class="sxs-lookup"><span data-stu-id="934af-205">hello following code shows how tooadd authorization rules for a queue.</span></span>

```csharp
// Create an instance of NamespaceManager for hello operation
NamespaceManager nsm = NamespaceManager.CreateFromConnectionString(
    <connectionString> );
QueueDescription qd = new QueueDescription( <qPath> );

// Create a rule with send rights with keyName as "contosoQSendKey"
// and add it toohello queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoSendKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send }));

// Create a rule with listen rights with keyName as "contosoQListenKey"
// and add it toohello queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQListenKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Listen }));

// Create a rule with manage rights with keyName as "contosoQManageKey"
// and add it toohello queue description.
// A rule with manage rights must also have send and receive rights.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQManageKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] {AccessRights.Manage, AccessRights.Listen, AccessRights.Send }));

// Create hello queue.
nsm.CreateQueue(qd);
```

## <a name="use-shared-access-signature-authorization"></a><span data-ttu-id="934af-206">Использование авторизации подписанного URL-адреса</span><span class="sxs-lookup"><span data-stu-id="934af-206">Use Shared Access Signature authorization</span></span>

<span data-ttu-id="934af-207">Приложения, использующие hello Azure .NET SDK с библиотеками .NET служебной шины hello можно использовать авторизации SAS с помощью hello [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) класса.</span><span class="sxs-lookup"><span data-stu-id="934af-207">Applications using hello Azure .NET SDK with hello Service Bus .NET libraries can use SAS authorization through hello [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) class.</span></span> <span data-ttu-id="934af-208">Hello следующий код иллюстрирует использование hello tooa hello поставщик маркеров toosend сообщений очереди Service Bus.</span><span class="sxs-lookup"><span data-stu-id="934af-208">hello following code illustrates hello use of hello token provider toosend messages tooa Service Bus queue.</span></span>

```csharp
Uri runtimeUri = ServiceBusEnvironment.CreateServiceUri("sb",
    <yourServiceNamespace>, string.Empty);
MessagingFactory mf = MessagingFactory.Create(runtimeUri,
    TokenProvider.CreateSharedAccessSignatureTokenProvider(keyName, key));
QueueClient sendClient = mf.CreateQueueClient(qPath);

//Sending hello message tooqueue.
BrokeredMessage helloMessage = new BrokeredMessage("Hello, Service Bus!");
helloMessage.MessageId = "SAS-Sample-Message";
sendClient.Send(helloMessage);
```

<span data-ttu-id="934af-209">Приложения также могут использовать SAS для проверки подлинности с помощью строки подключения SAS в методах, которые принимают строки подключения в качестве параметров.</span><span class="sxs-lookup"><span data-stu-id="934af-209">Applications can also use SAS for authentication by using a SAS connection string in methods that accept connection strings.</span></span>

<span data-ttu-id="934af-210">Обратите внимание, что авторизации SAS toouse с ретранслятор Service Bus, можно использовать ключи SAS, настроенные на пространство имен Service Bus hello.</span><span class="sxs-lookup"><span data-stu-id="934af-210">Note that toouse SAS authorization with Service Bus relays, you can use SAS keys configured on hello Service Bus namespace.</span></span> <span data-ttu-id="934af-211">Если вы явно создаете ретрансляцию в пространстве имен hello ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) с [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) объекта, можно задать правила SAS hello только для ретрансляции.</span><span class="sxs-lookup"><span data-stu-id="934af-211">If you explicitly create a relay on hello namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) with a [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) object, you can set hello SAS rules just for that relay.</span></span> <span data-ttu-id="934af-212">toouse авторизации SAS с подписками Service Bus, можно использовать ключи SAS, настроенные в пространстве имен служебной шины или разделе.</span><span class="sxs-lookup"><span data-stu-id="934af-212">toouse SAS authorization with Service Bus subscriptions, you can use SAS keys configured on a Service Bus namespace or on a topic.</span></span>

## <a name="use-hello-shared-access-signature-at-http-level"></a><span data-ttu-id="934af-213">Использовать hello подпись общего доступа (на уровне HTTP)</span><span class="sxs-lookup"><span data-stu-id="934af-213">Use hello Shared Access Signature (at HTTP level)</span></span>

<span data-ttu-id="934af-214">Теперь, когда известно, как toocreate подписей общего доступа для всех сущностей в Service Bus, вы готовы tooperform HTTP POST:</span><span class="sxs-lookup"><span data-stu-id="934af-214">Now that you know how toocreate Shared Access Signatures for any entities in Service Bus, you are ready tooperform an HTTP POST:</span></span>

```http
POST https://<yournamespace>.servicebus.windows.net/<yourentity>/messages
Content-Type: application/json
Authorization: SharedAccessSignature sr=https%3A%2F%2F<yournamespace>.servicebus.windows.net%2F<yourentity>&sig=<yoursignature from code above>&se=1438205742&skn=KeyName
ContentType: application/atom+xml;type=entry;charset=utf-8
``` 

<span data-ttu-id="934af-215">Этот способ работает всегда.</span><span class="sxs-lookup"><span data-stu-id="934af-215">Remember, this works for everything.</span></span> <span data-ttu-id="934af-216">SAS можно создать для очереди, раздела или подписки.</span><span class="sxs-lookup"><span data-stu-id="934af-216">You can create SAS for a queue, topic, or subscription.</span></span> 

<span data-ttu-id="934af-217">Если вы предоставляете отправителя или клиента маркер SAS, они не имеют hello ключ непосредственно, и нельзя изменить обратно tooobtain хэширования Привет его.</span><span class="sxs-lookup"><span data-stu-id="934af-217">If you give a sender or client a SAS token, they don't have hello key directly, and they cannot reverse hello hash tooobtain it.</span></span> <span data-ttu-id="934af-218">Это позволяет контролировать, к чему вы предоставляете доступ и на какое время.</span><span class="sxs-lookup"><span data-stu-id="934af-218">As such, you have control over what they can access, and for how long.</span></span> <span data-ttu-id="934af-219">Tooremember главное — что при изменении hello первичного ключа в политике hello все подписанные URL-адреса созданные из этого станут недействительными.</span><span class="sxs-lookup"><span data-stu-id="934af-219">An important thing tooremember is that if you change hello primary key in hello policy, any Shared Access Signatures created from it will be invalidated.</span></span>

## <a name="use-hello-shared-access-signature-at-amqp-level"></a><span data-ttu-id="934af-220">Использовать hello подпись общего доступа (на уровне AMQP)</span><span class="sxs-lookup"><span data-stu-id="934af-220">Use hello Shared Access Signature (at AMQP level)</span></span>

<span data-ttu-id="934af-221">В предыдущем разделе hello вы увидели, как toouse hello маркер SAS с помощью запроса HTTP POST для отправки данных toohello Service Bus.</span><span class="sxs-lookup"><span data-stu-id="934af-221">In hello previous section, you saw how toouse hello SAS token with an HTTP POST request for sending data toohello Service Bus.</span></span> <span data-ttu-id="934af-222">Как известно, можно получить доступ к Service Bus с помощью hello Advanced Message Queuing Protocol (AMQP), toouse hello предпочитаемый протокол для повышения производительности во многих сценариях.</span><span class="sxs-lookup"><span data-stu-id="934af-222">As you know, you can access Service Bus using hello Advanced Message Queuing Protocol (AMQP) that is hello preferred protocol toouse for performance reasons, in many scenarios.</span></span> <span data-ttu-id="934af-223">описывается использование токенов SAS с помощью AMQP Hello в документе hello [AMQP Claim-Based безопасности версии 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) именно в рабочем проекте с момента выпуска 2013 но хорошо поддерживается Azure сегодня.</span><span class="sxs-lookup"><span data-stu-id="934af-223">hello SAS token usage with AMQP is described in hello document [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) that is in working draft since 2013 but well-supported by Azure today.</span></span>

<span data-ttu-id="934af-224">Перед началом tooService toosend данных шины, hello издатель должен отослать передачи маркера SAS hello внутри AMQP сообщение tooa четко определенных AMQP узел с именем **$cbs** (вы можете просмотреть его как «специальный» очередь используется tooacquire службы hello и проверить все маркеры SAS Hello).</span><span class="sxs-lookup"><span data-stu-id="934af-224">Before starting toosend data tooService Bus, hello publisher must send hello SAS token inside an AMQP message tooa well-defined AMQP node named **$cbs** (you can see it as a "special" queue used by hello service tooacquire and validate all hello SAS tokens).</span></span> <span data-ttu-id="934af-225">Hello издателя необходимо указать hello **ReplyTo** поле внутри сообщения hello AMQP — это узел hello, в какие hello службы отвечает издатель toohello с результатом проверки токенов hello (простой запрос ответ шаблон между hello Издатель и службы).</span><span class="sxs-lookup"><span data-stu-id="934af-225">hello publisher must specify hello **ReplyTo** field inside hello AMQP message; this is hello node in which hello service replies toohello publisher with hello result of hello token validation (a simple request/reply pattern between publisher and service).</span></span> <span data-ttu-id="934af-226">Этот узел ответ создается на «hello ходу, «говоря о динамических» Создание «удаленного узла, как описано в спецификации hello AMQP 1.0.</span><span class="sxs-lookup"><span data-stu-id="934af-226">This reply node is created "on hello fly," speaking about "dynamic creation of remote node" as described by hello AMQP 1.0 specification.</span></span> <span data-ttu-id="934af-227">После проверки допустимости этот маркер SAS hello, hello издателя может продолжаться и запустить службу toohello toosend данных.</span><span class="sxs-lookup"><span data-stu-id="934af-227">After checking that hello SAS token is valid, hello publisher can go forward and start toosend data toohello service.</span></span>

<span data-ttu-id="934af-228">Hello следующие шаги показывают, как toosend hello маркер SAS с протоколом AMQP, с помощью hello [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) библиотеки.</span><span class="sxs-lookup"><span data-stu-id="934af-228">hello following steps show how toosend hello SAS token with AMQP protocol using hello [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) library.</span></span> <span data-ttu-id="934af-229">Это полезно, если не удается использовать официальные hello пакет SDK служебной шины (например на WinRT, .net Compact Framework, платформа .net Micro Framework и Mono) разработке на языке C\#.</span><span class="sxs-lookup"><span data-stu-id="934af-229">This is useful if you can't use hello official Service Bus SDK (for example on WinRT, .Net Compact Framework, .Net Micro Framework and Mono) developing in C\#.</span></span> <span data-ttu-id="934af-230">Конечно, эта библиотека является полезным toohelp понять систему безопасности на основе утверждений работает на уровне AMQP hello, как было показано, как работает на уровне hello HTTP (с HTTP POST запроса и hello SAS маркера отправленных внутри hello» «заголовок авторизации).</span><span class="sxs-lookup"><span data-stu-id="934af-230">Of course, this library is useful toohelp understand how claims-based security works at hello AMQP level, as you saw how it works at hello HTTP level (with an HTTP POST request and hello SAS token sent inside hello "Authorization" header).</span></span> <span data-ttu-id="934af-231">Если не требуется такой глубоких знаний о AMQP, можно использовать официальные hello пакет SDK служебной шины с помощью .net Framework приложения, которые будет выполнять ее автоматически.</span><span class="sxs-lookup"><span data-stu-id="934af-231">If you don't need such deep knowledge about AMQP, you can use hello official Service Bus SDK with .Net Framework applications, which will do it for you.</span></span>

### <a name="c35"></a><span data-ttu-id="934af-232">C&#35;</span><span class="sxs-lookup"><span data-stu-id="934af-232">C&#35;</span></span>

```csharp
/// <summary>
/// Send claim-based security (CBS) token
/// </summary>
/// <param name="shareAccessSignature">Shared access signature (token) toosend</param>
private bool PutCbsToken(Connection connection, string sasToken)
{
    bool result = true;
    Session session = new Session(connection);

    string cbsClientAddress = "cbs-client-reply-to";
    var cbsSender = new SenderLink(session, "cbs-sender", "$cbs");
    var cbsReceiver = new ReceiverLink(session, cbsClientAddress, "$cbs");

    // construct hello put-token message
    var request = new Message(sasToken);
    request.Properties = new Properties();
    request.Properties.MessageId = Guid.NewGuid().ToString();
    request.Properties.ReplyTo = cbsClientAddress;
    request.ApplicationProperties = new ApplicationProperties();
    request.ApplicationProperties["operation"] = "put-token";
    request.ApplicationProperties["type"] = "servicebus.windows.net:sastoken";
    request.ApplicationProperties["name"] = Fx.Format("amqp://{0}/{1}", sbNamespace, entity);
    cbsSender.Send(request);

    // receive hello response
    var response = cbsReceiver.Receive();
    if (response == null || response.Properties == null || response.ApplicationProperties == null)
    {
        result = false;
    }
    else
    {
        int statusCode = (int)response.ApplicationProperties["status-code"];
        if (statusCode != (int)HttpStatusCode.Accepted && statusCode != (int)HttpStatusCode.OK)
        {
            result = false;
        }
    }

    // hello sender/receiver may be kept open for refreshing tokens
    cbsSender.Close();
    cbsReceiver.Close();
    session.Close();

    return result;
}
```

<span data-ttu-id="934af-233">Hello `PutCbsToken()` метод получает hello *подключения* (экземпляр класса подключение AMQP в соответствии со hello [AMQP .NET Lite библиотеки](https://github.com/Azure/amqpnetlite)), представляющий службу toohello подключения TCP hello и hello *sasToken* параметр toosend маркера SAS hello.</span><span class="sxs-lookup"><span data-stu-id="934af-233">hello `PutCbsToken()` method receives hello *connection* (AMQP connection class instance as provided by hello [AMQP .NET Lite library](https://github.com/Azure/amqpnetlite)) that represents hello TCP connection toohello service and hello *sasToken* parameter that is hello SAS token toosend.</span></span> 

> [!NOTE]
> <span data-ttu-id="934af-234">Очень важно, что соединения hello создается с **механизма SASL проверки подлинности значение tooEXTERNAL** (и не hello обычного по умолчанию с именем пользователя и пароль, используемый, когда нет необходимости использовать маркер SAS toosend hello).</span><span class="sxs-lookup"><span data-stu-id="934af-234">It's important that hello connection is created with **SASL authentication mechanism set tooEXTERNAL** (and not hello default PLAIN with username and password used when you don't need toosend hello SAS token).</span></span>
> 
> 

<span data-ttu-id="934af-235">Далее издателю hello создает две связи AMQP для отправки маркера SAS hello и получения ответа hello (результат проверки токенов hello) из службы hello.</span><span class="sxs-lookup"><span data-stu-id="934af-235">Next, hello publisher creates two AMQP links for sending hello SAS token and receiving hello reply (hello token validation result) from hello service.</span></span>

<span data-ttu-id="934af-236">приветственное сообщение AMQP содержит набор свойств и больше сведений, чем простое сообщение.</span><span class="sxs-lookup"><span data-stu-id="934af-236">hello AMQP message contains a set of properties, and more information than a simple message.</span></span> <span data-ttu-id="934af-237">маркер SAS Hello — hello тело сообщения hello (использование конструктора).</span><span class="sxs-lookup"><span data-stu-id="934af-237">hello SAS token is hello body of hello message (using its constructor).</span></span> <span data-ttu-id="934af-238">Hello **«ReplyTo»** свойству toohello имя узла для получения hello результат проверки связи приемника hello (если необходимо, и она будет создана динамически службой hello, можно изменить его имя).</span><span class="sxs-lookup"><span data-stu-id="934af-238">hello **"ReplyTo"** property is set toohello node name for receiving hello validation result on hello receiver link (you can change its name if you want, and it will be created dynamically by hello service).</span></span> <span data-ttu-id="934af-239">Hello последние три приложения и пользовательские свойства используются службы tooindicate hello какие операции имеет tooexecute.</span><span class="sxs-lookup"><span data-stu-id="934af-239">hello last three application/custom properties are used by hello service tooindicate what kind of operation it has tooexecute.</span></span> <span data-ttu-id="934af-240">Описанный hello спецификация CBS, они должны быть hello **имя операции** hello («put-token»), **тип маркера** (в данном случае «servicebus.windows.net:sastoken») и hello **» Имя «hello аудитории** toowhich hello токен применяется (hello всей сущности).</span><span class="sxs-lookup"><span data-stu-id="934af-240">As described by hello CBS draft specification, they must be hello **operation name** ("put-token"), hello **type of token** (in this case, a "servicebus.windows.net:sastoken"), and hello **"name" of hello audience** toowhich hello token applies (hello entire entity).</span></span>

<span data-ttu-id="934af-241">После отправки hello маркера SAS на ссылку отправителя hello, hello издателя должна чтение hello ответа на ссылку приемника hello.</span><span class="sxs-lookup"><span data-stu-id="934af-241">After sending hello SAS token on hello sender link, hello publisher must read hello reply on hello receiver link.</span></span> <span data-ttu-id="934af-242">Hello ответа имеет простое сообщение AMQP с свойства приложения с именем **«код состояния»** , может содержать hello же значений в виде кода состояния HTTP.</span><span class="sxs-lookup"><span data-stu-id="934af-242">hello reply is a simple AMQP message with an application property named **"status-code"** that can contain hello same values as an HTTP status code.</span></span>

## <a name="rights-required-for-service-bus-operations"></a><span data-ttu-id="934af-243">Права, необходимые для операций служебной шины</span><span class="sxs-lookup"><span data-stu-id="934af-243">Rights required for Service Bus operations</span></span>

<span data-ttu-id="934af-244">Hello следующей таблице показаны hello права доступа, необходимые для выполнения различных операций на ресурсах Service Bus.</span><span class="sxs-lookup"><span data-stu-id="934af-244">hello following table shows hello access rights required for various operations on Service Bus resources.</span></span>

| <span data-ttu-id="934af-245">Операция</span><span class="sxs-lookup"><span data-stu-id="934af-245">Operation</span></span> | <span data-ttu-id="934af-246">Требуемое утверждение</span><span class="sxs-lookup"><span data-stu-id="934af-246">Claim Required</span></span> | <span data-ttu-id="934af-247">Область утверждения</span><span class="sxs-lookup"><span data-stu-id="934af-247">Claim Scope</span></span> |
| --- | --- | --- |
| <span data-ttu-id="934af-248">**Пространство имен**</span><span class="sxs-lookup"><span data-stu-id="934af-248">**Namespace**</span></span> | | |
| <span data-ttu-id="934af-249">Настройка правила авторизации для пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-249">Configure authorization rule on a namespace</span></span> |<span data-ttu-id="934af-250">управление</span><span class="sxs-lookup"><span data-stu-id="934af-250">Manage</span></span> |<span data-ttu-id="934af-251">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-251">Any namespace address</span></span> |
| <span data-ttu-id="934af-252">**Регистр служб**</span><span class="sxs-lookup"><span data-stu-id="934af-252">**Service Registry**</span></span> | | |
| <span data-ttu-id="934af-253">Перечисление частных политик</span><span class="sxs-lookup"><span data-stu-id="934af-253">Enumerate Private Policies</span></span> |<span data-ttu-id="934af-254">управление</span><span class="sxs-lookup"><span data-stu-id="934af-254">Manage</span></span> |<span data-ttu-id="934af-255">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-255">Any namespace address</span></span> |
| <span data-ttu-id="934af-256">Начало прослушивания в пространстве имен</span><span class="sxs-lookup"><span data-stu-id="934af-256">Begin listening on a namespace</span></span> |<span data-ttu-id="934af-257">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-257">Listen</span></span> |<span data-ttu-id="934af-258">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-258">Any namespace address</span></span> |
| <span data-ttu-id="934af-259">Отправка сообщений tooa прослушивателя в пространстве имен</span><span class="sxs-lookup"><span data-stu-id="934af-259">Send messages tooa listener at a namespace</span></span> |<span data-ttu-id="934af-260">Отправка</span><span class="sxs-lookup"><span data-stu-id="934af-260">Send</span></span> |<span data-ttu-id="934af-261">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-261">Any namespace address</span></span> |
| <span data-ttu-id="934af-262">**Очередь**</span><span class="sxs-lookup"><span data-stu-id="934af-262">**Queue**</span></span> | | |
| <span data-ttu-id="934af-263">Создание очереди</span><span class="sxs-lookup"><span data-stu-id="934af-263">Create a queue</span></span> |<span data-ttu-id="934af-264">управление</span><span class="sxs-lookup"><span data-stu-id="934af-264">Manage</span></span> |<span data-ttu-id="934af-265">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-265">Any namespace address</span></span> |
| <span data-ttu-id="934af-266">Удаление очереди</span><span class="sxs-lookup"><span data-stu-id="934af-266">Delete a queue</span></span> |<span data-ttu-id="934af-267">управление</span><span class="sxs-lookup"><span data-stu-id="934af-267">Manage</span></span> |<span data-ttu-id="934af-268">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-268">Any valid queue address</span></span> |
| <span data-ttu-id="934af-269">Перечисление очередей</span><span class="sxs-lookup"><span data-stu-id="934af-269">Enumerate queues</span></span> |<span data-ttu-id="934af-270">управление</span><span class="sxs-lookup"><span data-stu-id="934af-270">Manage</span></span> |<span data-ttu-id="934af-271">/$Resources/Queues</span><span class="sxs-lookup"><span data-stu-id="934af-271">/$Resources/Queues</span></span> |
| <span data-ttu-id="934af-272">Получение описания очереди hello</span><span class="sxs-lookup"><span data-stu-id="934af-272">Get hello queue description</span></span> |<span data-ttu-id="934af-273">Управление</span><span class="sxs-lookup"><span data-stu-id="934af-273">Manage</span></span> |<span data-ttu-id="934af-274">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-274">Any valid queue address</span></span> |
| <span data-ttu-id="934af-275">Настройка правила авторизации для очереди</span><span class="sxs-lookup"><span data-stu-id="934af-275">Configure authorization rule for a queue</span></span> |<span data-ttu-id="934af-276">управление</span><span class="sxs-lookup"><span data-stu-id="934af-276">Manage</span></span> |<span data-ttu-id="934af-277">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-277">Any valid queue address</span></span> |
| <span data-ttu-id="934af-278">Отправка в очередь toohello</span><span class="sxs-lookup"><span data-stu-id="934af-278">Send into toohello queue</span></span> |<span data-ttu-id="934af-279">Отправка</span><span class="sxs-lookup"><span data-stu-id="934af-279">Send</span></span> |<span data-ttu-id="934af-280">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-280">Any valid queue address</span></span> |
| <span data-ttu-id="934af-281">Получение сообщений из очереди</span><span class="sxs-lookup"><span data-stu-id="934af-281">Receive messages from a queue</span></span> |<span data-ttu-id="934af-282">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-282">Listen</span></span> |<span data-ttu-id="934af-283">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-283">Any valid queue address</span></span> |
| <span data-ttu-id="934af-284">Прервать или завершить сообщения после получения сообщения hello в режиме пиковой блокировки</span><span class="sxs-lookup"><span data-stu-id="934af-284">Abandon or complete messages after receiving hello message in peek-lock mode</span></span> |<span data-ttu-id="934af-285">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-285">Listen</span></span> |<span data-ttu-id="934af-286">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-286">Any valid queue address</span></span> |
| <span data-ttu-id="934af-287">Откладывание сообщения для последующего получения</span><span class="sxs-lookup"><span data-stu-id="934af-287">Defer a message for later retrieval</span></span> |<span data-ttu-id="934af-288">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-288">Listen</span></span> |<span data-ttu-id="934af-289">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-289">Any valid queue address</span></span> |
| <span data-ttu-id="934af-290">Назначение сообщению статуса недоставленного</span><span class="sxs-lookup"><span data-stu-id="934af-290">Deadletter a message</span></span> |<span data-ttu-id="934af-291">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-291">Listen</span></span> |<span data-ttu-id="934af-292">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-292">Any valid queue address</span></span> |
| <span data-ttu-id="934af-293">Получение состояния hello, связанного с сеансом очереди сообщений</span><span class="sxs-lookup"><span data-stu-id="934af-293">Get hello state associated with a message queue session</span></span> |<span data-ttu-id="934af-294">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-294">Listen</span></span> |<span data-ttu-id="934af-295">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-295">Any valid queue address</span></span> |
| <span data-ttu-id="934af-296">Задание состояния hello, связанный с сеансом очереди сообщений</span><span class="sxs-lookup"><span data-stu-id="934af-296">Set hello state associated with a message queue session</span></span> |<span data-ttu-id="934af-297">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-297">Listen</span></span> |<span data-ttu-id="934af-298">Любой допустимый адрес очереди</span><span class="sxs-lookup"><span data-stu-id="934af-298">Any valid queue address</span></span> |
| <span data-ttu-id="934af-299">**Раздел**</span><span class="sxs-lookup"><span data-stu-id="934af-299">**Topic**</span></span> | | |
| <span data-ttu-id="934af-300">Создание раздела</span><span class="sxs-lookup"><span data-stu-id="934af-300">Create a topic</span></span> |<span data-ttu-id="934af-301">управление</span><span class="sxs-lookup"><span data-stu-id="934af-301">Manage</span></span> |<span data-ttu-id="934af-302">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-302">Any namespace address</span></span> |
| <span data-ttu-id="934af-303">Удаление раздела</span><span class="sxs-lookup"><span data-stu-id="934af-303">Delete a topic</span></span> |<span data-ttu-id="934af-304">управление</span><span class="sxs-lookup"><span data-stu-id="934af-304">Manage</span></span> |<span data-ttu-id="934af-305">Любой допустимый адрес раздела</span><span class="sxs-lookup"><span data-stu-id="934af-305">Any valid topic address</span></span> |
| <span data-ttu-id="934af-306">Перечисление разделов</span><span class="sxs-lookup"><span data-stu-id="934af-306">Enumerate topics</span></span> |<span data-ttu-id="934af-307">управление</span><span class="sxs-lookup"><span data-stu-id="934af-307">Manage</span></span> |<span data-ttu-id="934af-308">/$Resources/Topics</span><span class="sxs-lookup"><span data-stu-id="934af-308">/$Resources/Topics</span></span> |
| <span data-ttu-id="934af-309">Получите описание раздела hello</span><span class="sxs-lookup"><span data-stu-id="934af-309">Get hello topic description</span></span> |<span data-ttu-id="934af-310">Управление</span><span class="sxs-lookup"><span data-stu-id="934af-310">Manage</span></span> |<span data-ttu-id="934af-311">Любой допустимый адрес раздела</span><span class="sxs-lookup"><span data-stu-id="934af-311">Any valid topic address</span></span> |
| <span data-ttu-id="934af-312">Настройка правила авторизации для раздела</span><span class="sxs-lookup"><span data-stu-id="934af-312">Configure authorization rule for a topic</span></span> |<span data-ttu-id="934af-313">управление</span><span class="sxs-lookup"><span data-stu-id="934af-313">Manage</span></span> |<span data-ttu-id="934af-314">Любой допустимый адрес раздела</span><span class="sxs-lookup"><span data-stu-id="934af-314">Any valid topic address</span></span> |
| <span data-ttu-id="934af-315">Отправить toohello раздела</span><span class="sxs-lookup"><span data-stu-id="934af-315">Send toohello topic</span></span> |<span data-ttu-id="934af-316">Отправка</span><span class="sxs-lookup"><span data-stu-id="934af-316">Send</span></span> |<span data-ttu-id="934af-317">Любой допустимый адрес раздела</span><span class="sxs-lookup"><span data-stu-id="934af-317">Any valid topic address</span></span> |
| <span data-ttu-id="934af-318">**Подписка**</span><span class="sxs-lookup"><span data-stu-id="934af-318">**Subscription**</span></span> | | |
| <span data-ttu-id="934af-319">Создание подписки</span><span class="sxs-lookup"><span data-stu-id="934af-319">Create a subscription</span></span> |<span data-ttu-id="934af-320">управление</span><span class="sxs-lookup"><span data-stu-id="934af-320">Manage</span></span> |<span data-ttu-id="934af-321">Любой адрес пространства имен</span><span class="sxs-lookup"><span data-stu-id="934af-321">Any namespace address</span></span> |
| <span data-ttu-id="934af-322">Удаление подписки</span><span class="sxs-lookup"><span data-stu-id="934af-322">Delete subscription</span></span> |<span data-ttu-id="934af-323">управление</span><span class="sxs-lookup"><span data-stu-id="934af-323">Manage</span></span> |<span data-ttu-id="934af-324">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-324">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-325">Перечисление подписок</span><span class="sxs-lookup"><span data-stu-id="934af-325">Enumerate subscriptions</span></span> |<span data-ttu-id="934af-326">управление</span><span class="sxs-lookup"><span data-stu-id="934af-326">Manage</span></span> |<span data-ttu-id="934af-327">../myTopic/Subscriptions</span><span class="sxs-lookup"><span data-stu-id="934af-327">../myTopic/Subscriptions</span></span> |
| <span data-ttu-id="934af-328">Получение описания подписки</span><span class="sxs-lookup"><span data-stu-id="934af-328">Get subscription description</span></span> |<span data-ttu-id="934af-329">Управление</span><span class="sxs-lookup"><span data-stu-id="934af-329">Manage</span></span> |<span data-ttu-id="934af-330">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-330">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-331">Прервать или завершить сообщения после получения сообщения hello в режиме пиковой блокировки</span><span class="sxs-lookup"><span data-stu-id="934af-331">Abandon or complete messages after receiving hello message in peek-lock mode</span></span> |<span data-ttu-id="934af-332">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-332">Listen</span></span> |<span data-ttu-id="934af-333">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-333">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-334">Откладывание сообщения для последующего получения</span><span class="sxs-lookup"><span data-stu-id="934af-334">Defer a message for later retrieval</span></span> |<span data-ttu-id="934af-335">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-335">Listen</span></span> |<span data-ttu-id="934af-336">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-336">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-337">Назначение сообщению статуса недоставленного</span><span class="sxs-lookup"><span data-stu-id="934af-337">Deadletter a message</span></span> |<span data-ttu-id="934af-338">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-338">Listen</span></span> |<span data-ttu-id="934af-339">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-339">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-340">Получение состояния hello, связанного с сеансом раздела</span><span class="sxs-lookup"><span data-stu-id="934af-340">Get hello state associated with a topic session</span></span> |<span data-ttu-id="934af-341">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-341">Listen</span></span> |<span data-ttu-id="934af-342">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-342">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-343">Задание состояния hello, связанный с сеансом раздела</span><span class="sxs-lookup"><span data-stu-id="934af-343">Set hello state associated with a topic session</span></span> |<span data-ttu-id="934af-344">Прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-344">Listen</span></span> |<span data-ttu-id="934af-345">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-345">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-346">**Правила**</span><span class="sxs-lookup"><span data-stu-id="934af-346">**Rules**</span></span> | | |
| <span data-ttu-id="934af-347">Создание правила</span><span class="sxs-lookup"><span data-stu-id="934af-347">Create a rule</span></span> |<span data-ttu-id="934af-348">управление</span><span class="sxs-lookup"><span data-stu-id="934af-348">Manage</span></span> |<span data-ttu-id="934af-349">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-349">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-350">Удаление правила</span><span class="sxs-lookup"><span data-stu-id="934af-350">Delete a rule</span></span> |<span data-ttu-id="934af-351">управление</span><span class="sxs-lookup"><span data-stu-id="934af-351">Manage</span></span> |<span data-ttu-id="934af-352">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="934af-352">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="934af-353">Перечисление правил</span><span class="sxs-lookup"><span data-stu-id="934af-353">Enumerate rules</span></span> |<span data-ttu-id="934af-354">Управление или прослушивание</span><span class="sxs-lookup"><span data-stu-id="934af-354">Manage or Listen</span></span> |<span data-ttu-id="934af-355">../myTopic/Subscriptions/mySubscription/Rules</span><span class="sxs-lookup"><span data-stu-id="934af-355">../myTopic/Subscriptions/mySubscription/Rules</span></span> 

## <a name="next-steps"></a><span data-ttu-id="934af-356">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="934af-356">Next steps</span></span>

<span data-ttu-id="934af-357">toolearn Дополнительные сведения о Service Bus обмена сообщениями, см. следующие разделы hello.</span><span class="sxs-lookup"><span data-stu-id="934af-357">toolearn more about Service Bus messaging, see hello following topics.</span></span>

* [<span data-ttu-id="934af-358">Базовая информация о служебной шине</span><span class="sxs-lookup"><span data-stu-id="934af-358">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="934af-359">Очереди, разделы и подписки служебной шины</span><span class="sxs-lookup"><span data-stu-id="934af-359">Service Bus queues, topics, and subscriptions</span></span>](service-bus-queues-topics-subscriptions.md)
* [<span data-ttu-id="934af-360">Как toouse очереди шины обслуживания</span><span class="sxs-lookup"><span data-stu-id="934af-360">How toouse Service Bus queues</span></span>](service-bus-dotnet-get-started-with-queues.md)
* [<span data-ttu-id="934af-361">Как toouse Service Bus разделы и подписки</span><span class="sxs-lookup"><span data-stu-id="934af-361">How toouse Service Bus topics and subscriptions</span></span>](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[Azure portal]: https://portal.azure.com