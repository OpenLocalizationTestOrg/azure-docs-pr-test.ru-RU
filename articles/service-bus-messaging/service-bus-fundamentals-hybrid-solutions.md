---
title: "aaaOverview из принципы работы Azure Service Bus | Документы Microsoft"
description: "Введение toousing Service Bus tooconnect программного обеспечения tooother приложения Azure."
services: service-bus-messaging
documentationcenter: .net
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 12654cdd-82ab-4b95-b56f-08a5a8bbc6f9
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/15/2017
ms.author: sethm
ms.openlocfilehash: 1abd5cf310ef06ba35e1e2489a7c0a07e1797736
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-service-bus"></a><span data-ttu-id="c1e65-103">Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="c1e65-103">Azure Service Bus</span></span>

<span data-ttu-id="c1e65-104">Приложение или служба выполняется в облаке hello, или на локальном компьютере, должен ли он часто toointeract с другими приложениями или службами.</span><span class="sxs-lookup"><span data-stu-id="c1e65-104">Whether an application or service runs in hello cloud or on premises, it often needs toointeract with other applications or services.</span></span> <span data-ttu-id="c1e65-105">tooprovide toodo широко удобным способом, предложения Microsoft Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c1e65-105">tooprovide a broadly useful way toodo this, Microsoft Azure offers Service Bus.</span></span> <span data-ttu-id="c1e65-106">В этой статье рассматривается эта технология, описывающее, что это такое и зачем может потребоваться toouse его.</span><span class="sxs-lookup"><span data-stu-id="c1e65-106">This article looks at this technology, describing what it is and why you might want toouse it.</span></span>

## <a name="service-bus-fundamentals"></a><span data-ttu-id="c1e65-107">Базовая информация о Service Bus</span><span class="sxs-lookup"><span data-stu-id="c1e65-107">Service Bus fundamentals</span></span>

<span data-ttu-id="c1e65-108">В разных ситуациях требуются разные способы взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="c1e65-108">Different situations call for different styles of communication.</span></span> <span data-ttu-id="c1e65-109">Иногда позволяя приложениям отправлять и получать сообщения с помощью простой очереди является наилучшим решением hello.</span><span class="sxs-lookup"><span data-stu-id="c1e65-109">Sometimes, letting applications send and receive messages through a simple queue is hello best solution.</span></span> <span data-ttu-id="c1e65-110">В других ситуациях обычной очереди недостаточно и лучше использовать очередь с механизмом публикации и подписки.</span><span class="sxs-lookup"><span data-stu-id="c1e65-110">In other situations, an ordinary queue isn't enough; a queue with a publish-and-subscribe mechanism is better.</span></span> <span data-ttu-id="c1e65-111">В некоторых случаях необходимо лишь подключение между приложениями, а очередь не требуется.</span><span class="sxs-lookup"><span data-stu-id="c1e65-111">In some cases, all that's needed is a connection between applications, and queues are not required.</span></span> <span data-ttu-id="c1e65-112">Шина обслуживания предоставляет все три параметра, включение toointeract вашего приложения несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="c1e65-112">Service Bus provides all three options, enabling your applications toointeract in several different ways.</span></span>

<span data-ttu-id="c1e65-113">Шина обслуживания — это служба многопользовательского облачного, это означает, что служба hello совместно используется несколькими пользователями.</span><span class="sxs-lookup"><span data-stu-id="c1e65-113">Service Bus is a multi-tenant cloud service, which means that hello service is shared by multiple users.</span></span> <span data-ttu-id="c1e65-114">Каждый пользователь, например, разработчик приложения создает *имен*, затем определяет механизмы hello связи, необходимые в этом пространстве имен.</span><span class="sxs-lookup"><span data-stu-id="c1e65-114">Each user, such as an application developer, creates a *namespace*, then defines hello communication mechanisms needed within that namespace.</span></span> <span data-ttu-id="c1e65-115">Эта архитектура показана на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="c1e65-115">Figure 1 shows how this architecture looks.</span></span>

![][1]

<span data-ttu-id="c1e65-116">**Рисунок 1: Service Bus предоставляет службу несколькими клиентами для подключения с помощью hello облачных приложений.**</span><span class="sxs-lookup"><span data-stu-id="c1e65-116">**Figure 1: Service Bus provides a multi-tenant service for connecting applications through hello cloud.**</span></span>

<span data-ttu-id="c1e65-117">В рамках пространства имен можно использовать один или несколько экземпляров трех механизмов взаимодействия, связывающих приложения по-разному.</span><span class="sxs-lookup"><span data-stu-id="c1e65-117">Within a namespace, you can use one or more instances of three different communication mechanisms, each of which connects applications in a different way.</span></span> <span data-ttu-id="c1e65-118">Hello следующие варианты:</span><span class="sxs-lookup"><span data-stu-id="c1e65-118">hello choices are:</span></span>

* <span data-ttu-id="c1e65-119">*Очереди*, которые поддерживают однонаправленное взаимодействие.</span><span class="sxs-lookup"><span data-stu-id="c1e65-119">*Queues*, which allow one-directional communication.</span></span> <span data-ttu-id="c1e65-120">Каждая очередь действует как посредник (иногда называемый *брокером*), который хранит отправленные сообщения, пока они не будут получены.</span><span class="sxs-lookup"><span data-stu-id="c1e65-120">Each queue acts as an intermediary (sometimes called a *broker*) that stores sent messages until they are received.</span></span> <span data-ttu-id="c1e65-121">Каждое сообщение получает один получатель.</span><span class="sxs-lookup"><span data-stu-id="c1e65-121">Each message is received by a single recipient.</span></span>
* <span data-ttu-id="c1e65-122">*Разделы*, которые поддерживают однонаправленное взаимодействие с использованием *подписок*. В одном разделе может быть несколько подписок.</span><span class="sxs-lookup"><span data-stu-id="c1e65-122">*Topics*, which provide one-directional communication using *subscriptions*-a single topic can have multiple subscriptions.</span></span> <span data-ttu-id="c1e65-123">Как и очередь тема выступает посредником, но каждая подписка может дополнительно использовать фильтр tooreceive только сообщения, которые соответствуют определенным критериям.</span><span class="sxs-lookup"><span data-stu-id="c1e65-123">Like a queue, a topic acts as a broker, but each subscription can optionally use a filter tooreceive only messages that match specific criteria.</span></span>
* <span data-ttu-id="c1e65-124">*Ретрансляторы*, которые обеспечивают двунаправленное взаимодействие.</span><span class="sxs-lookup"><span data-stu-id="c1e65-124">*Relays*, which provide bi-directional communication.</span></span> <span data-ttu-id="c1e65-125">В отличие от очередей и разделов ретранслятор не хранит передаваемые сообщения, так как не является брокером.</span><span class="sxs-lookup"><span data-stu-id="c1e65-125">Unlike queues and topics, a relay doesn't store in-flight messages; it's not a broker.</span></span> <span data-ttu-id="c1e65-126">Вместо этого он просто передает их на toohello конечное приложение.</span><span class="sxs-lookup"><span data-stu-id="c1e65-126">Instead, it just passes them on toohello destination application.</span></span>

<span data-ttu-id="c1e65-127">При создании очереди, раздела или ретранслятора задается имя.</span><span class="sxs-lookup"><span data-stu-id="c1e65-127">When you create a queue, topic, or relay, you give it a name.</span></span> <span data-ttu-id="c1e65-128">Вместе с любой Вы вызвали пространства имен, оно создает уникальный идентификатор для hello объекта.</span><span class="sxs-lookup"><span data-stu-id="c1e65-128">Combined with whatever you called your namespace, this name creates a unique identifier for hello object.</span></span> <span data-ttu-id="c1e65-129">Приложения можно указать это имя tooService шины, а затем использовать этой очереди, раздела или ретрансляции toocommunicate друг с другом.</span><span class="sxs-lookup"><span data-stu-id="c1e65-129">Applications can provide this name tooService Bus, then use that queue, topic, or relay toocommunicate with one another.</span></span> 

<span data-ttu-id="c1e65-130">любой из этих объектов в сценарии ретрансляции hello toouse, приложения Windows можно использовать Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="c1e65-130">toouse any of these objects in hello relay scenario, Windows applications can use Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="c1e65-131">Эта служба называется [ретранслятором WCF](../service-bus-relay/relay-what-is-it.md).</span><span class="sxs-lookup"><span data-stu-id="c1e65-131">This service is known as [WCF Relay](../service-bus-relay/relay-what-is-it.md).</span></span> <span data-ttu-id="c1e65-132">Для очередей и разделов приложения Windows могут использовать API-интерфейсы для обмена сообщениями, определяемые служебной шиной.</span><span class="sxs-lookup"><span data-stu-id="c1e65-132">For queues and topics, Windows applications can use Service Bus-defined messaging APIs.</span></span> <span data-ttu-id="c1e65-133">toomake этими объектами проще toouse из приложений, отличных от Windows, корпорация Майкрософт предоставляет пакеты SDK для Java, Node.js и другие языки.</span><span class="sxs-lookup"><span data-stu-id="c1e65-133">toomake these objects easier toouse from non-Windows applications, Microsoft provides SDKs for Java, Node.js, and other languages.</span></span> <span data-ttu-id="c1e65-134">К очередям и разделам можно получить доступ также с помощью интерфейсов [REST API](/rest/api/servicebus/) через HTTP (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c1e65-134">You can also access queues and topics using [REST APIs](/rest/api/servicebus/) over HTTP(s).</span></span> 

<span data-ttu-id="c1e65-135">Очень важно, несмотря на то что службы шины сам toounderstand работает в облаке hello (то есть в центрах обработки данных Azure корпорации Майкрософт), приложения, использующие его можно запустить в любом месте.</span><span class="sxs-lookup"><span data-stu-id="c1e65-135">It's important toounderstand that even though Service Bus itself runs in hello cloud (that is, in Microsoft's Azure datacenters), applications that use it can run anywhere.</span></span> <span data-ttu-id="c1e65-136">Можно использовать приложения tooconnect Service Bus, работающие в Azure, например, или приложений, работающих в собственном центре обработки данных.</span><span class="sxs-lookup"><span data-stu-id="c1e65-136">You can use Service Bus tooconnect applications running on Azure, for example, or applications running inside your own datacenter.</span></span> <span data-ttu-id="c1e65-137">Ее можно также использовать tooconnect приложения, работающего в Azure или другой облачной платформы приложения локально или с планшетов и телефонов.</span><span class="sxs-lookup"><span data-stu-id="c1e65-137">You can also use it tooconnect an application running on Azure or another cloud platform with an on-premises application or with tablets and phones.</span></span> <span data-ttu-id="c1e65-138">Это возможно также tooconnect домашние приборы, датчики и другие приложения центра tooa устройства или tooone других.</span><span class="sxs-lookup"><span data-stu-id="c1e65-138">It's even possible tooconnect household appliances, sensors, and other devices tooa central application or tooone other.</span></span> <span data-ttu-id="c1e65-139">Шина обслуживания — это механизм связи в облаке hello, доступный отовсюду во многом.</span><span class="sxs-lookup"><span data-stu-id="c1e65-139">Service Bus is a communication mechanism in hello cloud that's accessible from pretty much anywhere.</span></span> <span data-ttu-id="c1e65-140">Как использовать зависит какие приложения требуются toodo.</span><span class="sxs-lookup"><span data-stu-id="c1e65-140">How you use it depends on what your applications need toodo.</span></span>

## <a name="queues"></a><span data-ttu-id="c1e65-141">Очереди</span><span class="sxs-lookup"><span data-stu-id="c1e65-141">Queues</span></span>

<span data-ttu-id="c1e65-142">Предположим, что вы решите tooconnect двух приложений с помощью очереди Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c1e65-142">Suppose you decide tooconnect two applications using a Service Bus queue.</span></span> <span data-ttu-id="c1e65-143">Эта ситуация показана на рисунке 2.</span><span class="sxs-lookup"><span data-stu-id="c1e65-143">Figure 2 illustrates this situation.</span></span>

![][2]

<span data-ttu-id="c1e65-144">**Рис. 2. Очереди служебной шины обеспечивают однонаправленное асинхронное взаимодействие**</span><span class="sxs-lookup"><span data-stu-id="c1e65-144">**Figure 2: Service Bus queues provide one-way asynchronous queuing.**</span></span>

<span data-ttu-id="c1e65-145">Hello процедура проста: отправитель посылает сообщение очереди Service Bus tooa и приемник забирает сообщения в дальнейшем.</span><span class="sxs-lookup"><span data-stu-id="c1e65-145">hello process is simple: A sender sends a message tooa Service Bus queue, and a receiver picks up that message at some later time.</span></span> <span data-ttu-id="c1e65-146">В очереди может быть только один получатель, как показано на рис.</span><span class="sxs-lookup"><span data-stu-id="c1e65-146">A queue can have just a single receiver, as Figure 2 shows.</span></span> <span data-ttu-id="c1e65-147">Или несколько приложений могут считываться hello одной очереди.</span><span class="sxs-lookup"><span data-stu-id="c1e65-147">Or, multiple applications can read from hello same queue.</span></span> <span data-ttu-id="c1e65-148">В последнем случае hello каждое сообщение считывается только один получатель.</span><span class="sxs-lookup"><span data-stu-id="c1e65-148">In hello latter situation, each message is read by just one receiver.</span></span> <span data-ttu-id="c1e65-149">А для службы многоадресной рассылки следует использовать раздел.</span><span class="sxs-lookup"><span data-stu-id="c1e65-149">For a multi-cast service, you should use a topic instead.</span></span>

<span data-ttu-id="c1e65-150">Каждое сообщение состоит из двух частей: набора свойств (пары ключ-значение) и полезных данных сообщения.</span><span class="sxs-lookup"><span data-stu-id="c1e65-150">Each message has two parts: a set of properties, each a key/value pair, and a message payload.</span></span> <span data-ttu-id="c1e65-151">Hello полезных данных может быть двоичный файл, текст или даже XML.</span><span class="sxs-lookup"><span data-stu-id="c1e65-151">hello payload can be binary, text, or even XML.</span></span> <span data-ttu-id="c1e65-152">Их использование зависит от того, какое приложение пытается toodo.</span><span class="sxs-lookup"><span data-stu-id="c1e65-152">How they're used depends on what an application is trying toodo.</span></span> <span data-ttu-id="c1e65-153">Например, приложения, отправляющие сообщения о последних продаж могут включать свойства hello **продавца = «Ava»** и **сумма = 10000**.</span><span class="sxs-lookup"><span data-stu-id="c1e65-153">For example, an application sending a message about a recent sale might include hello properties **Seller="Ava"** and **Amount=10000**.</span></span> <span data-ttu-id="c1e65-154">текст сообщения Hello может содержать отсканированные изображения hello продажи знаком контракта или, если нет, остаются пустыми.</span><span class="sxs-lookup"><span data-stu-id="c1e65-154">hello message body might contain a scanned image of hello sale's signed contract or, if there isn't one, remain empty.</span></span>

<span data-ttu-id="c1e65-155">Получатель может считать сообщение из очереди Service Bus двумя способами.</span><span class="sxs-lookup"><span data-stu-id="c1e65-155">A receiver can read a message from a Service Bus queue in two different ways.</span></span> <span data-ttu-id="c1e65-156">Здравствуйте, первый параметр, называемый  *[ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, удаляет сообщение из очереди hello и немедленно удаляется.</span><span class="sxs-lookup"><span data-stu-id="c1e65-156">hello first option, called *[ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, removes a message from hello queue and immediately deletes it.</span></span> <span data-ttu-id="c1e65-157">Этот параметр является простой, но если получатель hello аварийно завершает работу после окончания обработки сообщения hello, приветственное сообщение теряется.</span><span class="sxs-lookup"><span data-stu-id="c1e65-157">This option is simple, but if hello receiver crashes before it finishes processing hello message, hello message is lost.</span></span> <span data-ttu-id="c1e65-158">Так как оно является было удалено из очереди hello, нет других приемника к нему возможен доступ.</span><span class="sxs-lookup"><span data-stu-id="c1e65-158">Because it's been removed from hello queue, no other receiver can access it.</span></span> 

<span data-ttu-id="c1e65-159">Здравствуйте, второй параметр  *[PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, предназначена toohelp с этой проблемой.</span><span class="sxs-lookup"><span data-stu-id="c1e65-159">hello second option, *[PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, is meant toohelp with this problem.</span></span> <span data-ttu-id="c1e65-160">Как **ReceiveAndDelete**, **PeekLock** чтения удаляет сообщение из очереди hello.</span><span class="sxs-lookup"><span data-stu-id="c1e65-160">Like **ReceiveAndDelete**, a **PeekLock** read removes a message from hello queue.</span></span> <span data-ttu-id="c1e65-161">Приветственное сообщение, но не удаляется.</span><span class="sxs-lookup"><span data-stu-id="c1e65-161">It doesn't delete hello message, however.</span></span> <span data-ttu-id="c1e65-162">Вместо этого блокирует приветственное сообщение, делая его невидимым tooother приемников, затем ожидает один из трех событий:</span><span class="sxs-lookup"><span data-stu-id="c1e65-162">Instead, it locks hello message, making it invisible tooother receivers, then waits for one of three events:</span></span>

* <span data-ttu-id="c1e65-163">Если процессы приемника hello hello сообщение успешно, он вызывает метод [Complete()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete), и hello очереди удаляет сообщение hello.</span><span class="sxs-lookup"><span data-stu-id="c1e65-163">If hello receiver processes hello message successfully, it calls [Complete()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete), and hello queue deletes hello message.</span></span> 
* <span data-ttu-id="c1e65-164">Если получатель hello решает, что он не может успешно обработать сообщение hello, он вызывает [Abandon()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon).</span><span class="sxs-lookup"><span data-stu-id="c1e65-164">If hello receiver decides that it can't process hello message successfully, it calls [Abandon()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon).</span></span> <span data-ttu-id="c1e65-165">очередь Hello затем удаление hello блокировки с приветственное сообщение и делает его доступных tooother получателей.</span><span class="sxs-lookup"><span data-stu-id="c1e65-165">hello queue then removes hello lock from hello message and makes it available tooother receivers.</span></span>
* <span data-ttu-id="c1e65-166">Если получатель hello вызывает ни один из этих методов в течение настроенного периода времени (по умолчанию — 60 секунд), hello очереди предполагается, что получатель hello произошел сбой.</span><span class="sxs-lookup"><span data-stu-id="c1e65-166">If hello receiver calls neither of these methods within a configurable period of time (by default, 60 seconds), hello queue assumes hello receiver has failed.</span></span> <span data-ttu-id="c1e65-167">В этом случае он ведет себя как если бы вызвана hello получателя **прервать**, делая hello доступных tooother получателей сообщений.</span><span class="sxs-lookup"><span data-stu-id="c1e65-167">In this case, it behaves as if hello receiver had called **Abandon**, making hello message available tooother receivers.</span></span>

<span data-ttu-id="c1e65-168">Обратите внимание, что может произойти здесь: hello же сообщение может быть доставлен дважды, возможно tootwo разные получатели.</span><span class="sxs-lookup"><span data-stu-id="c1e65-168">Notice what can happen here: hello same message might be delivered twice, perhaps tootwo different receivers.</span></span> <span data-ttu-id="c1e65-169">Приложения, использующие очереди служебной шины, должны быть готовы к этому событию.</span><span class="sxs-lookup"><span data-stu-id="c1e65-169">Applications using Service Bus queues must be prepared for this event.</span></span> <span data-ttu-id="c1e65-170">toomake обнаружения повторяющихся сообщений проще, каждое сообщение имеет уникальный [MessageID](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) свойство, которое по умолчанию hello остается таким же, независимо от того, сколько раз приветственное сообщение считывается из очереди.</span><span class="sxs-lookup"><span data-stu-id="c1e65-170">toomake duplicate detection easier, each message has a unique [MessageID](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) property that by default stays hello same no matter how many times hello message is read from a queue.</span></span> 

<span data-ttu-id="c1e65-171">Очереди полезны во многих ситуациях.</span><span class="sxs-lookup"><span data-stu-id="c1e65-171">Queues are useful in quite a few situations.</span></span> <span data-ttu-id="c1e65-172">Они позволяют приложениям toocommunicate даже в том случае, если оба работают не под управлением в hello же время, то, что особенно удобно, поскольку с помощью пакета и приложений для мобильных устройств.</span><span class="sxs-lookup"><span data-stu-id="c1e65-172">They enable applications toocommunicate even when both aren't running at hello same time, something that's especially handy with batch and mobile applications.</span></span> <span data-ttu-id="c1e65-173">Очередь с несколькими получателями обеспечивает автоматическую балансировку нагрузки, так как отправленные сообщения распределяются между получателями.</span><span class="sxs-lookup"><span data-stu-id="c1e65-173">A queue with multiple receivers also provides automatic load balancing, since sent messages are spread across these receivers.</span></span>

## <a name="topics"></a><span data-ttu-id="c1e65-174">Разделы</span><span class="sxs-lookup"><span data-stu-id="c1e65-174">Topics</span></span>

<span data-ttu-id="c1e65-175">Полезным, как они являются, очереди не всегда hello подходящее решение.</span><span class="sxs-lookup"><span data-stu-id="c1e65-175">Useful as they are, queues aren't always hello right solution.</span></span> <span data-ttu-id="c1e65-176">Иногда лучше использовать разделы служебной шины.</span><span class="sxs-lookup"><span data-stu-id="c1e65-176">Sometimes, Service Bus topics are better.</span></span> <span data-ttu-id="c1e65-177">Рисунок 3 иллюстрирует принцип работы разделов.</span><span class="sxs-lookup"><span data-stu-id="c1e65-177">Figure 3 illustrates this idea.</span></span>

![][3]

<span data-ttu-id="c1e65-178">**Рисунок 3: На основании hello фильтр, который указывает подписанного приложения, он может получить некоторые или все сообщения hello отправлены tooa раздел служебной шины.**</span><span class="sxs-lookup"><span data-stu-id="c1e65-178">**Figure 3: Based on hello filter a subscribing application specifies, it can receive some or all hello messages sent tooa Service Bus topic.**</span></span>

<span data-ttu-id="c1e65-179">Объект *разделе* аналогично и во многих способов tooa очереди.</span><span class="sxs-lookup"><span data-stu-id="c1e65-179">A *topic* is similar in many ways tooa queue.</span></span> <span data-ttu-id="c1e65-180">Отправители отправки сообщений tooa раздела hello так же, как они отправляют tooa сообщений в очереди, что внешний вид этих сообщений hello так же, как очереди.</span><span class="sxs-lookup"><span data-stu-id="c1e65-180">Senders submit messages tooa topic in hello same way that they submit messages tooa queue, and those messages look hello same as with queues.</span></span> <span data-ttu-id="c1e65-181">Hello отличие заключается в том, что разделы включить каждого принимающее приложение toocreate свой собственный *подписки* путем определения *фильтра*.</span><span class="sxs-lookup"><span data-stu-id="c1e65-181">hello difference is that topics enable each receiving application toocreate its own *subscription* by defining a *filter*.</span></span> <span data-ttu-id="c1e65-182">Затем подписчик видит только сообщения hello, которые соответствуют этим фильтром.</span><span class="sxs-lookup"><span data-stu-id="c1e65-182">A subscriber then sees only hello messages that match that filter.</span></span> <span data-ttu-id="c1e65-183">Например, на рисунке 3 показан отправитель и раздел с тремя подписчиками, у каждого из которых имеется собственный фильтр:</span><span class="sxs-lookup"><span data-stu-id="c1e65-183">For example, Figure 3 shows a sender and a topic with three subscribers, each with its own filter:</span></span>

* <span data-ttu-id="c1e65-184">Подписчик 1 получает только те сообщения, которые содержат свойство hello *продавца = «Ava»*.</span><span class="sxs-lookup"><span data-stu-id="c1e65-184">Subscriber 1 receives only messages that contain hello property *Seller="Ava"*.</span></span>
* <span data-ttu-id="c1e65-185">Подписчик 2 получает сообщения, содержащие свойство hello *продавца = «Ruby»* и/или содержать *сумма* свойства, значение которого больше, чем 100 000.</span><span class="sxs-lookup"><span data-stu-id="c1e65-185">Subscriber 2 receives messages that contain hello property *Seller="Ruby"* and/or contain an *Amount* property whose value is greater than 100,000.</span></span> <span data-ttu-id="c1e65-186">Возможно, Ruby является hello менеджер по продажам, поэтому ей toosee собственный продаж и все большие продажи, независимо от того, кто их.</span><span class="sxs-lookup"><span data-stu-id="c1e65-186">Perhaps Ruby is hello sales manager, so she wants toosee both her own sales and all large sales regardless of who makes them.</span></span>
* <span data-ttu-id="c1e65-187">Подписчик 3 задал фильтром слишком*True*, что означает, что он получает все сообщения.</span><span class="sxs-lookup"><span data-stu-id="c1e65-187">Subscriber 3 has set its filter too*True*, which means that it receives all messages.</span></span> <span data-ttu-id="c1e65-188">Например возможно, это приложение отвечает за поддержание след аудита и поэтому он должен toosee все сообщения hello.</span><span class="sxs-lookup"><span data-stu-id="c1e65-188">For example, this application might be responsible for maintaining an audit trail and therefore it needs toosee all hello messages.</span></span>

<span data-ttu-id="c1e65-189">Как с очередями, в разделе tooa подписчиков доступны для чтения с помощью [ReceiveAndDelete или PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode).</span><span class="sxs-lookup"><span data-stu-id="c1e65-189">As with queues, subscribers tooa topic can read messages using either [ReceiveAndDelete or PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode).</span></span> <span data-ttu-id="c1e65-190">В отличие от очередей тем не менее, одно сообщение отправлено tooa раздела могут быть получены несколько подписок.</span><span class="sxs-lookup"><span data-stu-id="c1e65-190">Unlike queues, however, a single message sent tooa topic can be received by multiple subscriptions.</span></span> <span data-ttu-id="c1e65-191">Такой подход часто называется *публикации и подписки* (или *pub/sub*), параметр полезен, если несколько приложений интересуют hello же сообщения.</span><span class="sxs-lookup"><span data-stu-id="c1e65-191">This approach, commonly called *publish and subscribe* (or *pub/sub*), is useful whenever multiple applications are interested in hello same messages.</span></span> <span data-ttu-id="c1e65-192">Путем определения фильтра справа hello, можно воспользоваться каждому подписчику только часть hello, что ему требуется toosee потока сообщений hello.</span><span class="sxs-lookup"><span data-stu-id="c1e65-192">By defining hello right filter, each subscriber can tap into just hello part of hello message stream that it needs toosee.</span></span>

## <a name="relays"></a><span data-ttu-id="c1e65-193">Ретрансляторы</span><span class="sxs-lookup"><span data-stu-id="c1e65-193">Relays</span></span>

<span data-ttu-id="c1e65-194">Очереди и разделы обеспечивают однонаправленное асинхронное взаимодействие через брокер.</span><span class="sxs-lookup"><span data-stu-id="c1e65-194">Both queues and topics provide one-way asynchronous communication through a broker.</span></span> <span data-ttu-id="c1e65-195">Трафик протекает только в одном направлении, и между отправителями и получателями нет прямой связи.</span><span class="sxs-lookup"><span data-stu-id="c1e65-195">Traffic flows in just one direction, and there's no direct connection between senders and receivers.</span></span> <span data-ttu-id="c1e65-196">Но что делать, если требуется другое подключение?</span><span class="sxs-lookup"><span data-stu-id="c1e65-196">But what if you don't want this connection?</span></span> <span data-ttu-id="c1e65-197">Предположим, что приложения должны tooboth отправлять и получать сообщения, или может быть нужно прямую связь между ними и toostore брокера сообщений не требуется.</span><span class="sxs-lookup"><span data-stu-id="c1e65-197">Suppose your applications need tooboth send and receive messages, or perhaps you want a direct link between them and you don't need a broker toostore messages.</span></span> <span data-ttu-id="c1e65-198">Шина обслуживания предоставляет tooaddress сценарии, такие как это, *ретранслирует*, как показано на рис. 4.</span><span class="sxs-lookup"><span data-stu-id="c1e65-198">tooaddress scenarios such as this, Service Bus provides *relays*, as Figure 4 shows.</span></span>

![][4]

<span data-ttu-id="c1e65-199">**Рис. 4. Ретранслятор служебной шины обеспечивает синхронное двунаправленное взаимодействие между приложениями**</span><span class="sxs-lookup"><span data-stu-id="c1e65-199">**Figure 4: Service Bus relay provides synchronous, two-way communication between applications.**</span></span>

<span data-ttu-id="c1e65-200">Hello tooask очевидным вопрос о ретрансляциях это: Почему используется?</span><span class="sxs-lookup"><span data-stu-id="c1e65-200">hello obvious question tooask about relays is this: why would I use one?</span></span> <span data-ttu-id="c1e65-201">Даже если не создавать очереди, почему бы сделать приложениях взаимодействуют через облачную службу, а не просто взаимодействуют напрямую? получен ответ Hello, взаимодействуют напрямую может быть сложнее, чем может показаться.</span><span class="sxs-lookup"><span data-stu-id="c1e65-201">Even if I don't need queues, why make applications communicate via a cloud service rather than just interact directly? hello answer is that talking directly can be harder than you might think.</span></span>

<span data-ttu-id="c1e65-202">Предположим, что нужно tooconnect двух локальных приложений, как выполняется внутри корпоративной центрах обработки данных.</span><span class="sxs-lookup"><span data-stu-id="c1e65-202">Suppose you want tooconnect two on-premises applications, both running inside corporate datacenters.</span></span> <span data-ttu-id="c1e65-203">Каждое из этих приложений находится за брандмауэром, а центры обработки данных могут использовать преобразование сетевых адресов (NAT).</span><span class="sxs-lookup"><span data-stu-id="c1e65-203">Each of these applications sits behind a firewall, and each datacenter probably uses network address translation (NAT).</span></span> <span data-ttu-id="c1e65-204">брандмауэр блокирует Hello входящих данных для всех, кроме несколько портов и NAT подразумевает, что компьютер hello, каждое приложение, на котором выполняется не имеет фиксированный IP-адрес, который требуется получить доступ непосредственно из внешнего центра обработки данных hello.</span><span class="sxs-lookup"><span data-stu-id="c1e65-204">hello firewall blocks incoming data on all but a few ports, and NAT implies that hello machine each application is running on doesn't have a fixed IP address that you can reach directly from outside hello datacenter.</span></span> <span data-ttu-id="c1e65-205">Без некоторых дополнительных справки этих приложений можно подключаться по hello общедоступный Интернет проблематичным.</span><span class="sxs-lookup"><span data-stu-id="c1e65-205">Without some extra help, connecting these applications over hello public internet is problematic.</span></span>

<span data-ttu-id="c1e65-206">Ретранслятор служебной шины Azure может помочь в этом.</span><span class="sxs-lookup"><span data-stu-id="c1e65-206">A Service Bus relay can help.</span></span> <span data-ttu-id="c1e65-207">toocommunicate двунаправленно через ретранслятор, каждое приложение устанавливает исходящее подключение TCP с Service Bus, а затем поддерживает открытым.</span><span class="sxs-lookup"><span data-stu-id="c1e65-207">toocommunicate bi-directionally through a relay, each application establishes an outbound TCP connection with Service Bus, then keeps it open.</span></span> <span data-ttu-id="c1e65-208">Весь обмен данными между двумя приложениями hello проходит через эти подключения.</span><span class="sxs-lookup"><span data-stu-id="c1e65-208">All communication between hello two applications travels over these connections.</span></span> <span data-ttu-id="c1e65-209">Поскольку каждое соединение было установлено из внутри центра данных hello, hello брандмауэр разрешает входящий трафик tooeach приложения без открытия новых портов.</span><span class="sxs-lookup"><span data-stu-id="c1e65-209">Because each connection was established from inside hello datacenter, hello firewall allows incoming traffic tooeach application without opening new ports.</span></span> <span data-ttu-id="c1e65-210">Такой подход также получает проблемы hello NAT, поскольку каждое приложение имеет согласованное конечную точку в облаке hello во всей hello связи.</span><span class="sxs-lookup"><span data-stu-id="c1e65-210">This approach also gets around hello NAT problem, because each application has a consistent endpoint in hello cloud throughout hello communication.</span></span> <span data-ttu-id="c1e65-211">Обмен данными через посредника hello, приложения hello избежать hello проблемы, которые бы в противном случае затруднить связи.</span><span class="sxs-lookup"><span data-stu-id="c1e65-211">By exchanging data through hello relay, hello applications can avoid hello problems that would otherwise make communication difficult.</span></span> 

<span data-ttu-id="c1e65-212">toouse ретрансляции Service Bus, приложения используют hello Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="c1e65-212">toouse Service Bus relays, applications rely on hello Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="c1e65-213">Шина обслуживания предоставляет привязок WCF, упрощения toointeract приложений Windows через ретрансляции.</span><span class="sxs-lookup"><span data-stu-id="c1e65-213">Service Bus provides WCF bindings that make it straightforward for Windows applications toointeract via relays.</span></span> <span data-ttu-id="c1e65-214">Приложения, которые уже используют WCF можно обычно указать один из этих привязок, а затем взаимодействовать tooeach других через ретранслятор.</span><span class="sxs-lookup"><span data-stu-id="c1e65-214">Applications that already use WCF can typically specify one of these bindings, then talk tooeach other through a relay.</span></span> <span data-ttu-id="c1e65-215">В отличие от использования очередей и разделов, использование ретрансляторов из приложений, работающих не под управлением Windows, хотя и возможно, но требует дополнительных усилий программистов, так как стандартные библиотеки не предусмотрены.</span><span class="sxs-lookup"><span data-stu-id="c1e65-215">Unlike queues and topics, however, using relays from non-Windows applications, while possible, requires some programming effort; no standard libraries are provided.</span></span>

<span data-ttu-id="c1e65-216">В отличие от очередей и разделов, приложения не создают ретрансляторы явно.</span><span class="sxs-lookup"><span data-stu-id="c1e65-216">Unlike queues and topics, applications don't explicitly create relays.</span></span> <span data-ttu-id="c1e65-217">Вместо этого когда приложение, которое желает tooreceive сообщений устанавливает соединение TCP со служебной шиной, ретрансляции будет создана автоматически.</span><span class="sxs-lookup"><span data-stu-id="c1e65-217">Instead, when an application that wishes tooreceive messages establishes a TCP connection with Service Bus, a relay is created automatically.</span></span> <span data-ttu-id="c1e65-218">При удалении подключения hello ретрансляции hello удаляется.</span><span class="sxs-lookup"><span data-stu-id="c1e65-218">When hello connection is dropped, hello relay is deleted.</span></span> <span data-ttu-id="c1e65-219">tooenable создан сервером приложения toofind hello ретрансляции определенных прослушиватель, Service Bus предоставляет реестра, который позволяет приложениям toolocate конкретных ретрансляции по имени.</span><span class="sxs-lookup"><span data-stu-id="c1e65-219">tooenable an application toofind hello relay created by a specific listener, Service Bus provides a registry that enables applications toolocate a specific relay by name.</span></span>

<span data-ttu-id="c1e65-220">Ретрансляторы относятся hello подходящее решение, когда требуется прямой обмен данными между приложениями.</span><span class="sxs-lookup"><span data-stu-id="c1e65-220">Relays are hello right solution when you need direct communication between applications.</span></span> <span data-ttu-id="c1e65-221">Например, система бронирования авиабилетов, работающая в локальном центре обработки данных, к которой должен осуществляться доступ из киосков регистрации, с мобильных устройств и с других компьютеров.</span><span class="sxs-lookup"><span data-stu-id="c1e65-221">For example, consider an airline reservation system running in an on-premises datacenter that must be accessed from check-in kiosks, mobile devices, and other computers.</span></span> <span data-ttu-id="c1e65-222">Приложения, работающие в этих системах могли полагаться на ретранслятор Service Bus в toocommunicate облаке hello, везде, где они могут запущены.</span><span class="sxs-lookup"><span data-stu-id="c1e65-222">Applications running on all these systems could rely on Service Bus relays in hello cloud toocommunicate, wherever they might be running.</span></span>

## <a name="summary"></a><span data-ttu-id="c1e65-223">Сводка</span><span class="sxs-lookup"><span data-stu-id="c1e65-223">Summary</span></span>

<span data-ttu-id="c1e65-224">Подключение приложений всегда была частью создавать комплексные решения, и диапазон hello ряд сценариев, требующих приложений и служб toocommunicate друг с другом задан tooincrease как несколько приложений и устройств, подключенных toohello Интернета.</span><span class="sxs-lookup"><span data-stu-id="c1e65-224">Connecting applications has always been part of building complete solutions, and hello range of scenarios that require applications and services toocommunicate with each other is set tooincrease as more applications and devices are connected toohello internet.</span></span> <span data-ttu-id="c1e65-225">Предоставляя облачных технологий для достижения взаимодействие через очереди, разделы и ретрансляции Service Bus, цель — toomake проще tooimplement это важная функция и более широкий доступ.</span><span class="sxs-lookup"><span data-stu-id="c1e65-225">By providing cloud-based technologies for achieving communication through queues, topics, and relays, Service Bus aims toomake this essential function easier tooimplement and more broadly available.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c1e65-226">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c1e65-226">Next steps</span></span>

<span data-ttu-id="c1e65-227">Теперь, когда вы узнали основы hello Azure Service Bus, выполните следующие дополнительные toolearn ссылки.</span><span class="sxs-lookup"><span data-stu-id="c1e65-227">Now that you've learned hello fundamentals of Azure Service Bus, follow these links toolearn more.</span></span>

* <span data-ttu-id="c1e65-228">Как toouse [очереди шины обслуживания](service-bus-dotnet-get-started-with-queues.md)</span><span class="sxs-lookup"><span data-stu-id="c1e65-228">How toouse [Service Bus queues](service-bus-dotnet-get-started-with-queues.md)</span></span>
* <span data-ttu-id="c1e65-229">Как toouse [разделы служебной шины](service-bus-dotnet-how-to-use-topics-subscriptions.md)</span><span class="sxs-lookup"><span data-stu-id="c1e65-229">How toouse [Service Bus topics](service-bus-dotnet-how-to-use-topics-subscriptions.md)</span></span>
* <span data-ttu-id="c1e65-230">Как toouse [ретрансляции служебной шины](../service-bus-relay/service-bus-dotnet-how-to-use-relay.md)</span><span class="sxs-lookup"><span data-stu-id="c1e65-230">How toouse [Service Bus relay](../service-bus-relay/service-bus-dotnet-how-to-use-relay.md)</span></span>
* [<span data-ttu-id="c1e65-231">Служебная шина: примеры</span><span class="sxs-lookup"><span data-stu-id="c1e65-231">Service Bus samples</span></span>](service-bus-samples.md)

[1]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_01_architecture.png
[2]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_02_queues.png
[3]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_03_topicsandsubscriptions.png
[4]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_04_relay.png
