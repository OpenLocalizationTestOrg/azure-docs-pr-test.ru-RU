---
title: "Azure Active Directory B2C: пользовательские политики | Документация Майкрософт"
description: "В этой статье описываются пользовательские политики Azure Active Directory B2C"
services: active-directory-b2c
documentationcenter: 
author: parakhj
manager: krassk
editor: parakhj
ms.assetid: 1ff398a4-2079-4615-94f1-57de22c0aad6
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.topic: article
ms.devlang: na
ms.date: 04/04/2017
ms.author: parakhj
ms.openlocfilehash: 33f62a33ea7a3fadb6e7b045de10df25f5edbe83
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="azure-active-directory-b2c-custom-policies"></a><span data-ttu-id="b501d-103">Azure Active Directory B2C: пользовательские политики</span><span class="sxs-lookup"><span data-stu-id="b501d-103">Azure Active Directory B2C: Custom policies</span></span>

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

## <a name="what-are-custom-policies"></a><span data-ttu-id="b501d-104">Что такое пользовательские политики?</span><span class="sxs-lookup"><span data-stu-id="b501d-104">What are custom policies?</span></span>

<span data-ttu-id="b501d-105">Пользовательские политики — это файлы конфигурации, которые определяют поведение вашего клиента Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="b501d-105">Custom policies are configuration files that define the behavior of your Azure AD B2C tenant.</span></span> <span data-ttu-id="b501d-106">Для самых распространенных задач идентификации на портале Azure AD B2C заданы **встроенные политики**. Пользовательские политики, в свою очередь, могут быть полностью изменены разработчиком удостоверений для выполнения практически неограниченного количества задач.</span><span class="sxs-lookup"><span data-stu-id="b501d-106">Whereas **built-in policies** are predefined in the Azure AD B2C portal for the most common identity tasks, custom policies can be fully edited by an identity developer to complete a near unlimited number of tasks.</span></span> <span data-ttu-id="b501d-107">Чтобы определить, подходят ли пользовательские политики для вас и вашего сценария идентификации, продолжайте чтение.</span><span class="sxs-lookup"><span data-stu-id="b501d-107">Read on to determine if custom policies are right for you and your identity scenario.</span></span>

<span data-ttu-id="b501d-108">**Изменение пользовательских политик подходит не для всех.**</span><span class="sxs-lookup"><span data-stu-id="b501d-108">**Custom policy editing is not for everyone.**</span></span> <span data-ttu-id="b501d-109">Для этого требуется обучение, время запуска дольше и будущие изменения в пользовательских политиках потребуют аналогичных знаний.</span><span class="sxs-lookup"><span data-stu-id="b501d-109">The learning curve is demanding, the startup time is longer, and future changes to custom policies will require similar expertise to maintain.</span></span> <span data-ttu-id="b501d-110">Прежде чем применять пользовательские политики для вашего сценария, следует рассмотреть возможность использования встроенных политик.</span><span class="sxs-lookup"><span data-stu-id="b501d-110">Built-in policies should be carefully considered first for your scenario before using custom policies.</span></span>

## <a name="comparing-built-in-policies-and-custom-policies"></a><span data-ttu-id="b501d-111">Сравнение встроенных политик и пользовательских политик</span><span class="sxs-lookup"><span data-stu-id="b501d-111">Comparing built-in policies and custom policies</span></span>

| | <span data-ttu-id="b501d-112">Встроенные политики</span><span class="sxs-lookup"><span data-stu-id="b501d-112">Built-in policies</span></span> | <span data-ttu-id="b501d-113">Пользовательские политики</span><span class="sxs-lookup"><span data-stu-id="b501d-113">Custom policies</span></span> |
|-|-------------------|-----------------|
|<span data-ttu-id="b501d-114">Целевые пользователи</span><span class="sxs-lookup"><span data-stu-id="b501d-114">Target users</span></span> | <span data-ttu-id="b501d-115">Все разработчики приложений с опытом работы с удостоверениями или без него</span><span class="sxs-lookup"><span data-stu-id="b501d-115">All app developers with or without identity expertise</span></span> | <span data-ttu-id="b501d-116">Профессионалы: системные интеграторы, консультанты и внутренние специалисты по работе с удостоверениями.</span><span class="sxs-lookup"><span data-stu-id="b501d-116">Identity pros: systems integrators, consultants and in-house identity teams.</span></span> <span data-ttu-id="b501d-117">Они знакомы с потоками OpenIDConnect, поставщиками удостоверений и проверкой подлинности на основе утверждений</span><span class="sxs-lookup"><span data-stu-id="b501d-117">They are comfortable with OpenIDConnect flows, and understand identity providers and claims-based authentication</span></span> |
|<span data-ttu-id="b501d-118">Метод настройки</span><span class="sxs-lookup"><span data-stu-id="b501d-118">Configuration method</span></span> | <span data-ttu-id="b501d-119">Портал Azure с удобным пользовательским интерфейсом</span><span class="sxs-lookup"><span data-stu-id="b501d-119">Azure portal with a user-friendly UI</span></span> | <span data-ttu-id="b501d-120">Изменение XML-файлов напрямую, а затем их отправка на портал Azure</span><span class="sxs-lookup"><span data-stu-id="b501d-120">Directly editing XML files and then uploading to the Azure portal</span></span> |
|<span data-ttu-id="b501d-121">Настройка пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="b501d-121">UI customization</span></span> | <span data-ttu-id="b501d-122">Полная настройка пользовательского интерфейса, включая поддержку HTML, CSS и JScript (требуется личный домен)</span><span class="sxs-lookup"><span data-stu-id="b501d-122">Full UI customization, including HTML, CSS, and jscript support(requires custom domain)</span></span><br><br><span data-ttu-id="b501d-123">Поддержка нескольких языков для пользовательских строк</span><span class="sxs-lookup"><span data-stu-id="b501d-123">Multilanguage support with Custom strings</span></span> | <span data-ttu-id="b501d-124">Аналогично</span><span class="sxs-lookup"><span data-stu-id="b501d-124">Same</span></span> |
| <span data-ttu-id="b501d-125">Настройка атрибутов</span><span class="sxs-lookup"><span data-stu-id="b501d-125">Attribute customization</span></span> | <span data-ttu-id="b501d-126">Стандартные и пользовательские атрибуты</span><span class="sxs-lookup"><span data-stu-id="b501d-126">Standard and custom attributes</span></span> | <span data-ttu-id="b501d-127">Аналогично</span><span class="sxs-lookup"><span data-stu-id="b501d-127">Same</span></span> |
|<span data-ttu-id="b501d-128">Управление токенами и сеансами</span><span class="sxs-lookup"><span data-stu-id="b501d-128">Token and session management</span></span> | <span data-ttu-id="b501d-129">Пользовательский токен и несколько параметров сеанса</span><span class="sxs-lookup"><span data-stu-id="b501d-129">Custom token and multiple session options</span></span> | <span data-ttu-id="b501d-130">Аналогично</span><span class="sxs-lookup"><span data-stu-id="b501d-130">Same</span></span> |
|<span data-ttu-id="b501d-131">Поставщики удостоверений</span><span class="sxs-lookup"><span data-stu-id="b501d-131">Identity Providers</span></span>| <span data-ttu-id="b501d-132">**Сегодня**: определенный локальный поставщик, поставщик социальных сетей</span><span class="sxs-lookup"><span data-stu-id="b501d-132">**Today**: predefined local, social provider</span></span><br><br><span data-ttu-id="b501d-133">**В будущем**: OIDC, SAML, OAuth в соответствии со стандартами</span><span class="sxs-lookup"><span data-stu-id="b501d-133">**Future**: Standards-based OIDC, SAML, OAuth</span></span> | <span data-ttu-id="b501d-134">**Сегодня**: OIDC, SAML, OAuth в соответствии со стандартами</span><span class="sxs-lookup"><span data-stu-id="b501d-134">**Today**: Standards-based OIDC, OAUTH, SAML</span></span><br><br><span data-ttu-id="b501d-135">**В будущем**: WsFed</span><span class="sxs-lookup"><span data-stu-id="b501d-135">**Future**: WsFed</span></span> |
|<span data-ttu-id="b501d-136">Задачи удостоверений (примеры)</span><span class="sxs-lookup"><span data-stu-id="b501d-136">Identity Tasks (examples)</span></span> | <span data-ttu-id="b501d-137">Регистрация или вход в систему локальных поставщиков и многих учетных записей социальных сетей</span><span class="sxs-lookup"><span data-stu-id="b501d-137">Signup or SignIn with local and many social accounts</span></span><br><br><span data-ttu-id="b501d-138">Самостоятельный сброс пароля</span><span class="sxs-lookup"><span data-stu-id="b501d-138">Self-Service Password Reset</span></span><br><br><span data-ttu-id="b501d-139">Изменение профиля</span><span class="sxs-lookup"><span data-stu-id="b501d-139">Profile Edit</span></span><br><br><span data-ttu-id="b501d-140">Сценарии многофакторной проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="b501d-140">Multi-Factor Auth scenarios</span></span><br><br><span data-ttu-id="b501d-141">Настройка токенов и сеансов</span><span class="sxs-lookup"><span data-stu-id="b501d-141">Customize Tokens and sessions</span></span><br><br><span data-ttu-id="b501d-142">Потоки токена доступа</span><span class="sxs-lookup"><span data-stu-id="b501d-142">Access Token flows</span></span> | <span data-ttu-id="b501d-143">Выполняют те же задачи, что и встроенные политики, с помощью пользовательских поставщиков удостоверений или настраиваемых областей</span><span class="sxs-lookup"><span data-stu-id="b501d-143">Complete the same tasks as built-in policies using custom identity providers or use custom scopes</span></span><br><br><span data-ttu-id="b501d-144">Подготовка пользователя в другой системе во время регистрации</span><span class="sxs-lookup"><span data-stu-id="b501d-144">Provision user in another system at the time of registration</span></span><br><br><span data-ttu-id="b501d-145">Отправка приветственного сообщения почты с помощью поставщика услуг электронной почты</span><span class="sxs-lookup"><span data-stu-id="b501d-145">Send a welcome email using your own email service provider</span></span><br><br><span data-ttu-id="b501d-146">Использование пользовательского хранилища за пределами B2C</span><span class="sxs-lookup"><span data-stu-id="b501d-146">Use a user store outside B2C</span></span><br><br><span data-ttu-id="b501d-147">Проверка предоставленной пользователями информации с помощью доверенной системы через API</span><span class="sxs-lookup"><span data-stu-id="b501d-147">Validate user provided information with a trusted system via API</span></span> |

## <a name="policy-files"></a><span data-ttu-id="b501d-148">Файлы политики</span><span class="sxs-lookup"><span data-stu-id="b501d-148">Policy files</span></span>

<span data-ttu-id="b501d-149">Пользовательские политики представлены одним или несколькими XML-файлами, которые ссылаются друг на друга в иерархической цепочке.</span><span class="sxs-lookup"><span data-stu-id="b501d-149">A custom policy is represented as one or several XML-formatted files which refer to each other in a hierarchical chain.</span></span> <span data-ttu-id="b501d-150">Элементы XML определяют: схему утверждений, преобразования утверждений, определения содержимого, поставщиков утверждений, технические профили и шаги оркестрации пути взаимодействия пользователя, а также другие элементы.</span><span class="sxs-lookup"><span data-stu-id="b501d-150">The XML elements define: Claims schema, claims transformations, content definitions, claims providers/technical profiles, and Userjourney orchestration steps, among other elements.</span></span>

<span data-ttu-id="b501d-151">Мы советуем использовать три типа файлов политики:</span><span class="sxs-lookup"><span data-stu-id="b501d-151">We recommend the use of three types of policy files:</span></span>

- <span data-ttu-id="b501d-152">**Базовый файл**, который содержит большинство определений и для которого Azure предоставляет полный пример.</span><span class="sxs-lookup"><span data-stu-id="b501d-152">**A BASE file**, which contains most of the definitions and for which Azure provides a complete sample.</span></span>  <span data-ttu-id="b501d-153">Мы советуем вносить минимальное число изменений в этот файл, чтобы упростить устранение неполадок и долгосрочное обслуживание ваших политик.</span><span class="sxs-lookup"><span data-stu-id="b501d-153">We recommend you make a minimum number of changes to this file to help with troubleshooting, and long-term maintenance of your policies</span></span>
- <span data-ttu-id="b501d-154">**Файл расширения** — файл, содержащий уникальную конфигурацию вашего клиента.</span><span class="sxs-lookup"><span data-stu-id="b501d-154">**an EXTensions file** that holds the unique configuration changes for your tenant</span></span>
- <span data-ttu-id="b501d-155">**Файл проверяющей стороны (RP)** — однозадачный файл, который может быть вызван непосредственно приложением или службой (т. е. проверяющей стороной).</span><span class="sxs-lookup"><span data-stu-id="b501d-155">**a Relying Party (RP) file** which is the single task-focused file that is invoked directly by the application or service (aka Relying Party).</span></span>  <span data-ttu-id="b501d-156">Дополнительные сведения см. в статье об определениях файлов политики.</span><span class="sxs-lookup"><span data-stu-id="b501d-156">Read the article on Policy file definitions for more information.</span></span>  <span data-ttu-id="b501d-157">Каждой уникальной задаче требуется собственный файл проверяющей стороны и в зависимости от требований к фирменной символике их число может быть выражено как "общее количество приложений общее количество вариантов использования".</span><span class="sxs-lookup"><span data-stu-id="b501d-157">Each unique task requires its own RP and depending on branding requirements the number might be "total of applications x total number of use cases".</span></span>


<span data-ttu-id="b501d-158">Встроенные политики в Azure AD B2C следуют описанному выше шаблону с 3 файлами, но разработчик видит только файл проверяющей стороны, в то время как портал в фоновом режиме вносит изменения в файл расширения.</span><span class="sxs-lookup"><span data-stu-id="b501d-158">Built-in policies in Azure AD B2C follow the 3-file pattern depicted above, but the developer only sees the Relying Party (RP) file, while the portal makes changes in the background to the EXTenstions file.</span></span>

## <a name="core-concepts-you-should-know-when-using-custom-policies"></a><span data-ttu-id="b501d-159">Основные понятия, которые следует знать при использовании пользовательских политик</span><span class="sxs-lookup"><span data-stu-id="b501d-159">Core concepts you should know when using custom policies</span></span>

### <a name="azure-active-directory-b2c"></a><span data-ttu-id="b501d-160">Azure Active Directory B2C</span><span class="sxs-lookup"><span data-stu-id="b501d-160">Azure Active Directory B2C</span></span>

<span data-ttu-id="b501d-161">Служба управления удостоверениями и доступом клиентов Azure (CIAM).</span><span class="sxs-lookup"><span data-stu-id="b501d-161">Azure’s customer identity and access management (CIAM) service.</span></span> <span data-ttu-id="b501d-162">Служба включает в себя:</span><span class="sxs-lookup"><span data-stu-id="b501d-162">The service includes:</span></span>

1. <span data-ttu-id="b501d-163">Пользовательский каталог в виде специализированного Azure Active Directory, который доступен через Microsoft Graph. В нем содержатся данные пользователя для локальных и федеративных учетных записей.</span><span class="sxs-lookup"><span data-stu-id="b501d-163">A user directory in the form of a special-purpose Azure Active Directory accessible via Microsoft Graph and which holds user data for both local accounts and federated accounts</span></span> 
2. <span data-ttu-id="b501d-164">Доступ к **инфраструктуре процедур идентификации**, которая управляет доверием между пользователями и сущностями и обменивается утверждениями между ними для выполнения задач управления удостоверениями и доступом</span><span class="sxs-lookup"><span data-stu-id="b501d-164">Access to the **Identity Experience Framework** which orchestrates trust between users and entities and passes claims between them to complete an identity/access management task</span></span> 
3. <span data-ttu-id="b501d-165">Служба токенов безопасности (STS), выдающая токены удостоверений, токены обновления и токены доступа (и эквивалентные утверждения SAML) и проверяющая их для защиты ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b501d-165">A security token service (STS) issuing id tokens, refresh tokens, and access tokens (and equivalent SAML assertions) and validating them to protect resources.</span></span>

<span data-ttu-id="b501d-166">Azure AD B2C последовательно взаимодействует с поставщиками удостоверений, пользователями, другими системами и с локальным каталогом пользователей для выполнения задачи с удостоверением (например, вход в систему, регистрация нового пользователя, сброс пароля).</span><span class="sxs-lookup"><span data-stu-id="b501d-166">Azure AD B2C interacts with identity providers, users, other systems, and with the local user directory in sequence to achieve an identity task (e.g. login a user, register a new user, reset a password).</span></span> <span data-ttu-id="b501d-167">Базовая платформа, устанавливающая доверие между несколькими участниками и выполняющая эти шаги, называется инфраструктурой процедур идентификации, а политика (которая также называется путем взаимодействия пользователя или инфраструктурой доверия) явно определяет субъекты, действия, протоколы и последовательность шагов для завершения.</span><span class="sxs-lookup"><span data-stu-id="b501d-167">The underlying platform which establishes multi-party trust and executes these steps is called the Identity Experience Framework and a policy (also called an user journey or a Trust framework policy) explicitly defines the actors, the actions, the protocols, and the sequence of steps to complete.</span></span>

### <a name="identity-experience-framework"></a><span data-ttu-id="b501d-168">Инфраструктура процедур идентификации</span><span class="sxs-lookup"><span data-stu-id="b501d-168">Identity Experience Framework</span></span>

<span data-ttu-id="b501d-169">Полностью настраиваемая управляемая политиками облачная платформа Azure, которая оркестрирует доверие между сущностями (в основном поставщиками утверждений) с использованием стандартных протоколов, таких как OpenIDConnect, OAuth, SAML, WSFed, и нескольких нестандартных (например, обмен утверждениями между системами на основе REST API).</span><span class="sxs-lookup"><span data-stu-id="b501d-169">A fully configurable, policy-driven, cloud-based Azure platform that orchestrates trust between entities (broadly Claims Providers) in standard protocol formats such as OpenIDConnect, OAuth, SAML, WSFed, and a few non-standard ones (e.g. REST API-based system-to-system claims exchanges).</span></span> <span data-ttu-id="b501d-170">Эта подсистема обеспечивает удобные возможности с поддержкой HTML, CSS и JScript.</span><span class="sxs-lookup"><span data-stu-id="b501d-170">The I2E creates user-friendly, whitelabelled experiences that support HTML, CSS, and jscript.</span></span>  <span data-ttu-id="b501d-171">В настоящее время инфраструктура процедур идентификации доступна только в контексте службы Azure AD B2C. Приоритетом для нее являются задачи, связанные с CIAM.</span><span class="sxs-lookup"><span data-stu-id="b501d-171">Today, the Identity Experience Framework is available only in the context of the Azure AD B2C service and prioritized for tasks related to CIAM.</span></span>

### <a name="built-in-policies"></a><span data-ttu-id="b501d-172">Встроенные политики</span><span class="sxs-lookup"><span data-stu-id="b501d-172">Built-in policies</span></span>

<span data-ttu-id="b501d-173">Стандартные файлы конфигурации, которые определяют поведение Azure AD B2C при выполнении наиболее часто используемых задач с удостоверениями (т. е.</span><span class="sxs-lookup"><span data-stu-id="b501d-173">Predefined configuration files that direct the behavior of Azure AD B2C to perform the most commonly used identity tasks (i.e.</span></span> <span data-ttu-id="b501d-174">регистрации пользователя, входе в учетную запись, сбросе паролей) и взаимодействуют с доверенными сторонами, чьи связи также определены в Azure AD B2C (например, поставщик удостоверений Facebook, LinkedIn, учетная запись Майкрософт, учетные записи Google).</span><span class="sxs-lookup"><span data-stu-id="b501d-174">user registration, signin, password reset) and interact with trusted parties whose relationship is also predefined in Azure AD B2C (e.g. Facebook identity provider, LinkedIn, Microsoft Account, Google accounts).</span></span>  <span data-ttu-id="b501d-175">В будущем встроенные политики также смогут предоставить настройку поставщиков удостоверений, которые обычно находятся в корпоративной области, например Azure Active Directory Premium, Active Directory и ADFS, Salesforce ID Provider и т. д.</span><span class="sxs-lookup"><span data-stu-id="b501d-175">In the future, built-in policies may also provide for customization of identity providers which are typically in the enterprise realm such as Azure Active Directory Premium, Active Directory/ADFS, Salesforce ID Provider etc.</span></span>


### <a name="custom-policies"></a><span data-ttu-id="b501d-176">Пользовательские политики</span><span class="sxs-lookup"><span data-stu-id="b501d-176">Custom policies</span></span>

<span data-ttu-id="b501d-177">Файлы конфигурации, которые определяют поведение инфраструктуры процедур идентификации в вашем клиенте Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="b501d-177">Configuration files that define the behavior of Identity Experience Framework in your Azure AD B2C tenant.</span></span> <span data-ttu-id="b501d-178">Пользовательская политика доступна в виде одного или нескольких XML-файлов (см. определения файлов политики), которые выполняются инфраструктурой процедур идентификации при вызове проверяющей стороной (например, приложением).</span><span class="sxs-lookup"><span data-stu-id="b501d-178">A custom policy is accessible as one or several XML files (see Policy Files definitions) which are executed by the Identity Experience Framework when invoked by a relying party (e.g. an application).</span></span> <span data-ttu-id="b501d-179">Разработчик удостоверения может напрямую изменять пользовательские политики для выполнения практически неограниченного количества задач.</span><span class="sxs-lookup"><span data-stu-id="b501d-179">Custom policies can be directly edited by an identity developer to complete a near unlimited number of tasks.</span></span> <span data-ttu-id="b501d-180">Разработчики, которые настраивают пользовательские политики, должны тщательно и подробно определить доверительные связи, в частности добавить конечные точки метаданных, точные определения обмена утверждениями и настроить секретные данные, ключи и сертификаты, отличающиеся в зависимости от поставщика удостоверений.</span><span class="sxs-lookup"><span data-stu-id="b501d-180">Developers configuring custom policies must define the trusted relationships in careful detail to include metadata endpoints, exact claims exchange definitions, and configure secrets, keys and certificates as needed by each identity provider.</span></span>

## <a name="policy-file-definitions-for-identity-experience-framework-trustframeworks"></a><span data-ttu-id="b501d-181">Определения файлов политики для платформ инфраструктуры процедур идентификации</span><span class="sxs-lookup"><span data-stu-id="b501d-181">Policy File Definitions for Identity Experience Framework Trustframeworks</span></span>

### <a name="policy-files"></a><span data-ttu-id="b501d-182">Файлы политики</span><span class="sxs-lookup"><span data-stu-id="b501d-182">Policy Files</span></span>

<span data-ttu-id="b501d-183">Пользовательские политики представлены одним или несколькими XML-файлами, которые ссылаются друг на друга в иерархической цепочке.</span><span class="sxs-lookup"><span data-stu-id="b501d-183">A custom policy is represented as one or several XML-formatted files which refer to each other in a hierarchical chain.</span></span> <span data-ttu-id="b501d-184">Элементы XML определяют: схему утверждений, преобразования утверждений, определения содержимого, поставщиков утверждений, технические профили и шаги оркестрации пути взаимодействия пользователя, а также другие элементы.</span><span class="sxs-lookup"><span data-stu-id="b501d-184">The XML elements define: Claims schema, claims transformations, content definitions, claims providers/technical profiles, and Userjourney orchestration steps, among other elements.</span></span>  <span data-ttu-id="b501d-185">Мы советуем использовать три типа файлов политики:</span><span class="sxs-lookup"><span data-stu-id="b501d-185">We recommend the use of three types of policy files:</span></span>

- <span data-ttu-id="b501d-186">**Базовый файл**, который содержит большинство определений и для которого Azure предоставляет полный пример.</span><span class="sxs-lookup"><span data-stu-id="b501d-186">**A BASE file**, which contains most of the definitions and for which Azure provides a complete sample.</span></span>  <span data-ttu-id="b501d-187">Мы советуем вносить минимальное число изменений в этот файл, чтобы упростить устранение неполадок и долгосрочное обслуживание ваших политик.</span><span class="sxs-lookup"><span data-stu-id="b501d-187">We recommend you make a minimum number of changes to this file to help with troubleshooting, and long-term maintenance of your policies</span></span>
- <span data-ttu-id="b501d-188">**Файл расширения** — файл, содержащий уникальную конфигурацию вашего клиента.</span><span class="sxs-lookup"><span data-stu-id="b501d-188">**an EXTensions file** that holds the unique configuration changes for your tenant</span></span>
- <span data-ttu-id="b501d-189">**Файл проверяющей стороны (RP)** — однозадачный файл, который может быть вызван непосредственно приложением или службой (т. е. проверяющей стороной).</span><span class="sxs-lookup"><span data-stu-id="b501d-189">**a Relying Party (RP) file** which is the single task-focused file that is invoked directly by the application or service (aka Relying Party).</span></span>  <span data-ttu-id="b501d-190">Дополнительные сведения см. в статье об определениях файлов политики.</span><span class="sxs-lookup"><span data-stu-id="b501d-190">Read the article on Policy file definitions for more information.</span></span>  <span data-ttu-id="b501d-191">Каждой уникальной задаче требуется собственный файл проверяющей стороны и в зависимости от требований к фирменной символике их число может быть выражено как "общее количество приложений общее количество вариантов использования".</span><span class="sxs-lookup"><span data-stu-id="b501d-191">Each unique task requires its own RP and depending on branding requirements the number might be "total of applications x total number of use cases".</span></span>

![Типы файлов политики](media/active-directory-b2c-overview-custom/active-directory-b2c-overview-custom-policy-files.png)

| <span data-ttu-id="b501d-193">Тип файла политики</span><span class="sxs-lookup"><span data-stu-id="b501d-193">Type of policy file</span></span> | <span data-ttu-id="b501d-194">Примеры имени файла</span><span class="sxs-lookup"><span data-stu-id="b501d-194">Examples file name</span></span> | <span data-ttu-id="b501d-195">Рекомендации по использованию</span><span class="sxs-lookup"><span data-stu-id="b501d-195">Recommended use</span></span> | <span data-ttu-id="b501d-196">Наследует от</span><span class="sxs-lookup"><span data-stu-id="b501d-196">Inherits from</span></span> |
|---------------------|--------------------|-----------------|---------------|
| <span data-ttu-id="b501d-197">Базовая</span><span class="sxs-lookup"><span data-stu-id="b501d-197">BASE</span></span> |<span data-ttu-id="b501d-198">TrustFrameworkBase.xml</span><span class="sxs-lookup"><span data-stu-id="b501d-198">TrustFrameworkBase.xml</span></span><br><br><span data-ttu-id="b501d-199">Mytenant.onmicrosoft.com-B2C-1A_BASE1.xml</span><span class="sxs-lookup"><span data-stu-id="b501d-199">Mytenant.onmicrosoft.com-B2C-1A_BASE1.xml</span></span> | <span data-ttu-id="b501d-200">Включает схему основных утверждений, преобразования утверждений, поставщиков утверждений и пути взаимодействия пользователей, настроенные Майкрософт</span><span class="sxs-lookup"><span data-stu-id="b501d-200">Includes the core claims schema, claims transformations, claims providers, and user journeys configured by Microsoft</span></span><br><br><span data-ttu-id="b501d-201">Вносите минимальные изменения в этот файл</span><span class="sxs-lookup"><span data-stu-id="b501d-201">Make minimal changes to this file</span></span> | <span data-ttu-id="b501d-202">None</span><span class="sxs-lookup"><span data-stu-id="b501d-202">None</span></span> |
| <span data-ttu-id="b501d-203">Расширение (EXT)</span><span class="sxs-lookup"><span data-stu-id="b501d-203">Extension (EXT)</span></span> | <span data-ttu-id="b501d-204">TrustFrameworkExtensions.xml</span><span class="sxs-lookup"><span data-stu-id="b501d-204">TrustFrameworkExtensions.xml</span></span><br><br><span data-ttu-id="b501d-205">Mytenant.onmicrosoft.com-B2C-1A_EXT.xml</span><span class="sxs-lookup"><span data-stu-id="b501d-205">Mytenant.onmicrosoft.com-B2C-1A_EXT.xml</span></span> | <span data-ttu-id="b501d-206">Объедините изменения в базовый файл</span><span class="sxs-lookup"><span data-stu-id="b501d-206">Consolidate your changes to the BASE file here</span></span><br><br><span data-ttu-id="b501d-207">Измененные поставщики утверждений</span><span class="sxs-lookup"><span data-stu-id="b501d-207">Modified claims providers</span></span><br><br><span data-ttu-id="b501d-208">Измененные пути взаимодействия пользователей</span><span class="sxs-lookup"><span data-stu-id="b501d-208">Modified user journeys</span></span><br><br><span data-ttu-id="b501d-209">Пользовательские определения схем</span><span class="sxs-lookup"><span data-stu-id="b501d-209">Your own custom schema definitions</span></span> | <span data-ttu-id="b501d-210">Базовый файл</span><span class="sxs-lookup"><span data-stu-id="b501d-210">BASE file</span></span> |
| <span data-ttu-id="b501d-211">Проверяющая сторона (RP)</span><span class="sxs-lookup"><span data-stu-id="b501d-211">Relying Party (RP)</span></span> | <span data-ttu-id="b501d-212">B2C_1A_sign_up_sign_in.xml</span><span class="sxs-lookup"><span data-stu-id="b501d-212">B2C_1A_sign_up_sign_in.xml</span></span>| <span data-ttu-id="b501d-213">Измените параметры сеанса и фигуры токена здесь</span><span class="sxs-lookup"><span data-stu-id="b501d-213">Change token shape and session settings here</span></span>| <span data-ttu-id="b501d-214">Файл исключений (EXT-файл)</span><span class="sxs-lookup"><span data-stu-id="b501d-214">Extensions(EXT) file</span></span> |

### <a name="inheritance-model"></a><span data-ttu-id="b501d-215">Модель наследования</span><span class="sxs-lookup"><span data-stu-id="b501d-215">Inheritance model</span></span>

<span data-ttu-id="b501d-216">Когда приложение вызывает файл политики проверяющей стороны, инфраструктура процедур идентификации в B2C добавит все элементы из базового файла, затем из файла расширений и, наконец, из файла политики проверяющей стороны, чтобы создать действующую политику.</span><span class="sxs-lookup"><span data-stu-id="b501d-216">When an application calls the RP Policy file, the Identity Experience Framework in B2C will add all the elements from BASE, then from EXTENSIONS, and lastly from the RP policy file to assemble the current policy in effect.</span></span>  <span data-ttu-id="b501d-217">Элементы одного и того же типа и имени в файле проверяющей стороны будут переопределять те, что находятся в файле расширений, а последние переопределят значения в базовом файле.</span><span class="sxs-lookup"><span data-stu-id="b501d-217">Elements of the same type and name in the RP file will override those in the EXTENSIONS, and EXTENSIONS overrides BASE.</span></span>

<span data-ttu-id="b501d-218">**Встроенные политики** в Azure AD B2C следуют описанному выше шаблону с 3 файлами, но разработчик видит только файл проверяющей стороны, в то время как портал в фоновом режиме вносит изменения в файл расширения.</span><span class="sxs-lookup"><span data-stu-id="b501d-218">**Built-in policies** in Azure AD B2C follow the 3-file pattern depicted above, but the developer only sees the Relying Party (RP) file, while the portal makes changes in the background to the EXTenstions file.</span></span>  <span data-ttu-id="b501d-219">Все экземпляры Azure AD B2C используют базовый файл политики, который находится под контролем команды Azure B2C и часто обновляется.</span><span class="sxs-lookup"><span data-stu-id="b501d-219">All of Azure AD B2C shares a BASE policy file that is under the control of the Azure B2C team and is updated frequently.</span></span>
