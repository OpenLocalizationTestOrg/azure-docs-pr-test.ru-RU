---
title: "Azure Active Directory B2C: пользовательские политики | Документация Майкрософт"
description: "В этой статье описываются пользовательские политики Azure Active Directory B2C"
services: active-directory-b2c
documentationcenter: 
author: parakhj
manager: krassk
editor: parakhj
ms.assetid: 1ff398a4-2079-4615-94f1-57de22c0aad6
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.topic: article
ms.devlang: na
ms.date: 04/04/2017
ms.author: parakhj
ms.openlocfilehash: bada9cf5f1a86f3dd047536f6fd9359c0231a384
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-active-directory-b2c-custom-policies"></a>Azure Active Directory B2C: пользовательские политики

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

## <a name="what-are-custom-policies"></a>Что такое пользовательские политики?

Настраиваемые политики, файлы конфигурации, которые определяют поведение hello вашего клиента Azure AD B2C. В то время как **встроенных политик** предопределены в портале Azure AD B2C hello для hello наиболее распространенные задачи удостоверений, настраиваемых политик можно полностью изменить с помощью удостоверения разработчика toocomplete практически неограниченное количество задач. Читайте дальше toodetermine, если пользовательские политики подходит для вас и вашего удостоверения сценария.

**Изменение пользовательских политик подходит не для всех.** ресурсоемких Hello обучения, время запуска hello больше времени, и будущие изменения политики toocustom потребуются аналогичные toomaintain опыт. Прежде чем применять пользовательские политики для вашего сценария, следует рассмотреть возможность использования встроенных политик.

## <a name="comparing-built-in-policies-and-custom-policies"></a>Сравнение встроенных политик и пользовательских политик

| | Встроенные политики | Пользовательские политики |
|-|-------------------|-----------------|
|Целевые пользователи | Все разработчики приложений с опытом работы с удостоверениями или без него | Профессионалы: системные интеграторы, консультанты и внутренние специалисты по работе с удостоверениями. Они знакомы с потоками OpenIDConnect, поставщиками удостоверений и проверкой подлинности на основе утверждений |
|Метод настройки | Портал Azure с удобным пользовательским интерфейсом | Непосредственное редактирование XML-файлов и затем загрузить toohello портал Azure |
|Настройка пользовательского интерфейса | Полная настройка пользовательского интерфейса, включая поддержку HTML, CSS и JScript (требуется личный домен)<br><br>Поддержка нескольких языков для пользовательских строк | Аналогично |
| Настройка атрибутов | Стандартные и пользовательские атрибуты | Аналогично |
|Управление токенами и сеансами | Пользовательский токен и несколько параметров сеанса | Аналогично |
|Поставщики удостоверений| **Сегодня**: определенный локальный поставщик, поставщик социальных сетей<br><br>**В будущем**: OIDC, SAML, OAuth в соответствии со стандартами | **Сегодня**: OIDC, SAML, OAuth в соответствии со стандартами<br><br>**В будущем**: WsFed |
|Задачи удостоверений (примеры) | Регистрация или вход в систему локальных поставщиков и многих учетных записей социальных сетей<br><br>Самостоятельный сброс пароля<br><br>Изменение профиля<br><br>Сценарии многофакторной проверки подлинности<br><br>Настройка токенов и сеансов<br><br>Потоки токена доступа | Завершить hello же задачи, как поставщики пользовательских удостоверений с помощью встроенных политик или использовать настраиваемые области<br><br>Подготовить пользователя в другой системе во время hello регистрации<br><br>Отправка приветственного сообщения почты с помощью поставщика услуг электронной почты<br><br>Использование пользовательского хранилища за пределами B2C<br><br>Проверка предоставленной пользователями информации с помощью доверенной системы через API |

## <a name="policy-files"></a>Файлы политики

Пользовательские политики представляется как один или несколько XML-файлов, указывающие tooeach других в иерархическую цепочку. Определение Hello XML-элементы: схемы утверждений, утверждения преобразований, определения содержимого, профили поставщиков или технической утверждений и Userjourney этапов оркестрации, среди других элементов.

Мы рекомендуем использовать hello три типа файлов политики:

- **БАЗОВЫЙ файл**, который содержит большинство hello определений и для которой Azure предоставляет полный пример.  Мы рекомендуем сделать минимальное количество изменений toothis файл toohelp по устранению неполадок и долгосрочного обслуживания политик
- **файл расширения** , содержащий изменения hello уникальные конфигурации клиента
- **файл проверяющей стороны (RP)** hello один ориентированный на задачи файл, вызываемая напрямую hello приложения или службы (также называемого проверяющая сторона).  Статья hello файл определений для получения дополнительной информации.  Каждый уникальный задачи требуется собственный RP и в зависимости от требований фирменная символика hello число может быть «общее приложений x общее количество вариантов использования».


Встроенные политики в Azure AD B2C следуют hello файл 3 показано выше, но разработчик hello только видит hello файл проверяющей стороны (RP), пока портала hello вносит изменения в файл EXTenstions toohello фонового hello.

## <a name="core-concepts-you-should-know-when-using-custom-policies"></a>Основные понятия, которые следует знать при использовании пользовательских политик

### <a name="azure-active-directory-b2c"></a>Azure Active Directory B2C

Служба управления удостоверениями и доступом клиентов Azure (CIAM). Служба Hello включает:

1. Каталог пользователя в форме hello специальная Azure Active Directory через Microsoft Graph и которая хранит данные пользователя для локальных учетных записей и федеративными учетными записями 
2. Доступ к toohello **Identity Framework качества** которой управляет доверия между пользователями и сущностей и передает утверждений между ними toocomplete задачу управления удостоверений и доступа 
3. Службы маркеров безопасности (STS) выдачи идентификатор токены, обновления токенов и доступ маркеров (и эквивалентные утверждения SAML) и проверка их tooprotect ресурсов.

Azure AD B2C взаимодействует с поставщиками удостоверений, пользователей и других систем и каталог локального пользователя hello в последовательности tooachieve задачу удостоверений (например имя входа пользователя, регистрация нового пользователя, сбросить пароль). Hello базовой платформы, которая выполняет следующие действия и позволяет установить отношения доверия многосторонний называется hello Framework качества удостоверения и политики (также называемые пути пользователя или framework политики доверия) явно определяет субъекты hello, действия hello hello протоколы и последовательность hello toocomplete действия.

### <a name="identity-experience-framework"></a>Инфраструктура процедур идентификации

Полностью настраиваемая управляемая политиками облачная платформа Azure, которая оркестрирует доверие между сущностями (в основном поставщиками утверждений) с использованием стандартных протоколов, таких как OpenIDConnect, OAuth, SAML, WSFed, и нескольких нестандартных (например, обмен утверждениями между системами на основе REST API). Hello I2E создает понятное, возникает whitelabelled, который поддерживает HTML, CSS и jscript.  В настоящее время hello Identity Framework качества доступен только в контексте hello hello службы Azure AD B2C и приоритет для tooCIAM связанные задачи.

### <a name="built-in-policies"></a>Встроенные политики

Стандартные файлы конфигурации, что поведение прямой hello Azure AD B2C tooperform hello наиболее часто используемые удостоверения задачи (т. е. Регистрация пользователя, signin, сброс пароля) и взаимодействия с доверенными сторонами, связи также заранее определены в Azure AD B2C ( Например поставщика удостоверений Facebook, LinkedIn, учетной записи Майкрософт, учетных записей Google).  В будущем hello встроенных политик может также обеспечивают возможность настройки поставщиков удостоверений, которые обычно находятся в области enterprise hello, такие как Azure Active Directory Premium, Active Directory или ADFS, Salesforce идентификатор поставщика и т. д.


### <a name="custom-policies"></a>Пользовательские политики

Файлы конфигурации, определяющие поведение hello платформы качества удостоверения в клиенте Azure AD B2C. Пользовательские политики доступен как один или несколько XML-файлы (см. определения файлы политики) которых выполняются hello Identity Framework взаимодействие при вызове проверяющей стороной (например приложение). Настраиваемые политики можно редактировать непосредственно по toocomplete разработчика удостоверение практически неограниченное количество задач. Разработчики, Настройка настраиваемых политик необходимо определить Здравствуйте доверительные отношения в конечных точках метаданных tooinclude внимательны детализации, точное утверждений обмена определения и настройки секретные данные, ключи и сертификаты с каждого поставщика удостоверений.

## <a name="policy-file-definitions-for-identity-experience-framework-trustframeworks"></a>Определения файлов политики для платформ инфраструктуры процедур идентификации

### <a name="policy-files"></a>Файлы политики

Пользовательские политики представляется как один или несколько XML-файлов, указывающие tooeach других в иерархическую цепочку. Определение Hello XML-элементы: схемы утверждений, утверждения преобразований, определения содержимого, профили поставщиков или технической утверждений и Userjourney этапов оркестрации, среди других элементов.  Мы рекомендуем использовать hello три типа файлов политики:

- **БАЗОВЫЙ файл**, который содержит большинство hello определений и для которой Azure предоставляет полный пример.  Мы рекомендуем сделать минимальное количество изменений toothis файл toohelp по устранению неполадок и долгосрочного обслуживания политик
- **файл расширения** , содержащий изменения hello уникальные конфигурации клиента
- **файл проверяющей стороны (RP)** hello один ориентированный на задачи файл, вызываемая напрямую hello приложения или службы (также называемого проверяющая сторона).  Статья hello файл определений для получения дополнительной информации.  Каждый уникальный задачи требуется собственный RP и в зависимости от требований фирменная символика hello число может быть «общее приложений x общее количество вариантов использования».

![Типы файлов политики](media/active-directory-b2c-overview-custom/active-directory-b2c-overview-custom-policy-files.png)

| Тип файла политики | Примеры имени файла | Рекомендации по использованию | Наследует от |
|---------------------|--------------------|-----------------|---------------|
| Базовая |TrustFrameworkBase.xml<br><br>Mytenant.onmicrosoft.com-B2C-1A_BASE1.xml | Включает в себя hello основной утверждений схемы, преобразования утверждений, поставщиками утверждений и поездок пользователя настроен корпорацией Майкрософт<br><br>Сделать файл toothis минимальные изменения | None |
| Расширение (EXT) | TrustFrameworkExtensions.xml<br><br>Mytenant.onmicrosoft.com-B2C-1A_EXT.xml | Объединить изменения toohello БАЗОВЫЙ файл здесь<br><br>Измененные поставщики утверждений<br><br>Измененные пути взаимодействия пользователей<br><br>Пользовательские определения схем | Базовый файл |
| Проверяющая сторона (RP) | B2C_1A_sign_up_sign_in.xml| Измените параметры сеанса и фигуры токена здесь| Файл исключений (EXT-файл) |

### <a name="inheritance-model"></a>Модель наследования

Когда приложение вызывает файл политики RP hello, hello Identity Framework взаимодействие в B2C добавить все элементы hello из БАЗЫ, а затем с РАСШИРЕНИЯМИ и наконец из tooassemble файла политики RP hello hello текущую политику в силе.  Элементы hello же типов и имен в файле RP hello переопределяют hello расширения и расширения переопределения БАЗЫ.

**Встроенные политики** в Azure AD B2C соответствуют шаблону файла 3 hello, описанные выше, но разработчик hello только видит hello файл проверяющей стороны (RP), пока портала hello вносит изменения в файл EXTenstions toohello фонового hello.  Все Azure AD B2C использует БАЗОВУЮ политику файлом, который находится под управлением hello hello Azure B2C команды и постоянно обновляется.
