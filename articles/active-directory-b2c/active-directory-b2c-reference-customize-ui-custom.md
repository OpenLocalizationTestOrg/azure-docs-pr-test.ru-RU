---
title: "Azure Active Directory B2C. Справочные материалы. Настройка пользовательского интерфейса с помощью пользовательских политик | Документация Майкрософт"
description: "В этой статье описываются пользовательские политики Azure Active Directory B2C"
services: active-directory-b2c
documentationcenter: 
author: rojasja
manager: krassk
editor: rojasja
ms.assetid: 
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.topic: article
ms.devlang: na
ms.date: 04/25/2017
ms.author: joroja
ms.openlocfilehash: 68f40aa638a687398512278a0b77d1ba392859cf
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="customize-the-ui-of-a-user-journey-with-custom-policies"></a><span data-ttu-id="6449b-103">Настройка пользовательского интерфейса с помощью пользовательских политик</span><span class="sxs-lookup"><span data-stu-id="6449b-103">Customize the UI of a user journey with Custom Policies</span></span>

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

> [!NOTE]
> <span data-ttu-id="6449b-104">В этой статье представлено расширенное описание принципов настройки пользовательского интерфейса и включения пользовательских политик B2C с помощью инфраструктуры процедур идентификации.</span><span class="sxs-lookup"><span data-stu-id="6449b-104">This article is an advanced description of how UI customization works and how to enable with B2C Custom policies, using the Identity Experience Framework</span></span>


<span data-ttu-id="6449b-105">Удобная работа пользователя является ключевым фактором для любого корпоративного решения, предоставляемого потребителям.</span><span class="sxs-lookup"><span data-stu-id="6449b-105">A seamless user experience is key for any business-to-consumer solution.</span></span> <span data-ttu-id="6449b-106">Под удобной работой пользователя подразумевается работа на устройстве или в браузере, при которой взаимодействие пользователя с нашей службой невозможно отличить от взаимодействия со службой, которую он использует.</span><span class="sxs-lookup"><span data-stu-id="6449b-106">By seamless user experience, we mean an experience, whether on device or browser, where a user’s journey through our service cannot be distinguished from that of the customer service they are using.</span></span>

## <a name="understand-the-cors-way-for-ui-customization"></a><span data-ttu-id="6449b-107">Общие сведения о механизме CORS для настройки пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="6449b-107">Understand the CORS way for UI customization</span></span>

<span data-ttu-id="6449b-108">Azure AD B2C позволяет настраивать внешний вид и поведение пользовательского интерфейса на различных страницах, которые могут обслуживаться и отображаться в Azure AD B2C с помощью пользовательских политик.</span><span class="sxs-lookup"><span data-stu-id="6449b-108">Azure AD B2C allows you to customize the look-and-feel of user experience (UX) on the various pages that can be potentially served and displayed by Azure AD B2C via your custom policies.</span></span>

<span data-ttu-id="6449b-109">Для этого Azure AD B2C выполняет код в браузере пользователя и использует современный стандартный подход [общего доступа к ресурсам независимо от источника (CORS)](http://www.w3.org/TR/cors/) для загрузки пользовательского содержимого с определенного URL-адреса, указанного в пользовательской политике, чтобы она указывала на шаблоны HTML5/CSS.</span><span class="sxs-lookup"><span data-stu-id="6449b-109">For that purpose, Azure AD B2C runs code in your consumer's browser and uses the modern and standard approach [Cross-Origin Resource Sharing (CORS)](http://www.w3.org/TR/cors/) to load custom content from a specific URL that you specify in a custom policy to point to your HTML5/CSS templates.</span></span> <span data-ttu-id="6449b-110">Механизм CORS позволяет запрашивать ограниченные ресурсы на веб-странице (например, шрифты) из домена, отличного от домена исходного размещения ресурсов.</span><span class="sxs-lookup"><span data-stu-id="6449b-110">CORS is a mechanism that allows restricted resources, like fonts, on a web page to be requested from another domain outside the domain from which the resource originated.</span></span>

<span data-ttu-id="6449b-111">По сравнению с традиционным механизмом, когда страницы шаблонов принадлежат решению с небольшим количеством текста и изображений и ограниченной настройкой макета и внешнего вида, что усложняло работу, способ CORS поддерживает HTML5 и CSS и предоставляет следующие возможности:</span><span class="sxs-lookup"><span data-stu-id="6449b-111">Compared to the old traditional way, where template pages are owned by the solution where you provided limited text and images, where limited control of layout and feel was offered leading to more than difficulties to achieve a seamless experience, the CORS way supports HTML5 and CSS and allow you to:</span></span>

- <span data-ttu-id="6449b-112">Размещение содержимого и внедрение элементов управления решения с помощью клиентского скрипта.</span><span class="sxs-lookup"><span data-stu-id="6449b-112">Host the content and the solution injects its controls using client side script.</span></span>
- <span data-ttu-id="6449b-113">Полный контроль над каждым пикселем и внешним видом макета.</span><span class="sxs-lookup"><span data-stu-id="6449b-113">Have full control over every pixel of layout and feel.</span></span>

<span data-ttu-id="6449b-114">Вы можете предоставить любое количество страниц содержимого, составляя файлы HTML5 и CSS соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="6449b-114">You can provide as many content pages as you like by crafting HTML5/CSS files as appropriate.</span></span>

> [!NOTE]
> <span data-ttu-id="6449b-115">По соображениям безопасности использование JavaScript для настройки сейчас заблокировано.</span><span class="sxs-lookup"><span data-stu-id="6449b-115">For security reasons, the use of JavaScript is currently blocked for customization.</span></span> <span data-ttu-id="6449b-116">Чтобы разблокировать JavaScript, необходимо использовать пользовательское имя домена для клиента Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="6449b-116">To unblock JavaScript, use of a custom domain name for your Azure AD B2C tenant is needed.</span></span>

<span data-ttu-id="6449b-117">В каждом шаблоне HTML5 и CSS предоставляется элемент *привязки*, который соответствует необходимому элементу `<div id=”api”>` в HTML или на странице содержимого, как показано далее.</span><span class="sxs-lookup"><span data-stu-id="6449b-117">In each of your HTML5/CSS templates, you provide an *anchor* element, which corresponds to the required `<div id=”api”>` element in the HTML or the content page as illustrate hereafter.</span></span> <span data-ttu-id="6449b-118">Для Azure AD B2C необходимо, чтобы все страницы содержимого имели этот div.</span><span class="sxs-lookup"><span data-stu-id="6449b-118">Azure AD B2C requires that all content pages have this specific div.</span></span>

```
<!DOCTYPE html>
<html>
  <head>
    <title>Your page content’s tile!</title>
  </head>
  <body>
    <div id="api"></div>
  </body>
</html>
```

<span data-ttu-id="6449b-119">Содержимое страницы, связанное с Azure AD B2C, будет внедрено в этот div, а остальной частью страницы вы сможете управлять сами.</span><span class="sxs-lookup"><span data-stu-id="6449b-119">Azure AD B2C-related content for the page will be injected into this div, while the rest of the page is yours to control.</span></span> <span data-ttu-id="6449b-120">Код JavaScript Azure AD B2C получает содержимое и внедряет HTML в этот элемент div.</span><span class="sxs-lookup"><span data-stu-id="6449b-120">The Azure AD B2C’s JavaScript code pulls in your content and injects our HTML into this specific div element.</span></span> <span data-ttu-id="6449b-121">Azure AD B2C внедряет следующие элементы управления соответствующим образом: элемент управления средства выбора учетной записи, элементы управления входа, элементы управления многофакторной проверки подлинности (сейчас для телефона) и элементы управления коллекции атрибутов.</span><span class="sxs-lookup"><span data-stu-id="6449b-121">Azure AD B2C injects the following controls as appropriate: account chooser control, login controls, multi-factor (currently phone-based) controls, and attribute collection controls.</span></span> <span data-ttu-id="6449b-122">Azure AD B2C гарантирует, что все элементы управления совместимы с HTML5, доступны и к ним можно применить стили, а также гарантирует, что версии элементов управления не устареют.</span><span class="sxs-lookup"><span data-stu-id="6449b-122">Azure AD B2C ensures that all the controls are HTML5 compliant and accessible, all the controls can be fully styled, and that a control version will not regress.</span></span>

<span data-ttu-id="6449b-123">В конечном счете для пользователя объединенное содержимое отображается как динамический документ.</span><span class="sxs-lookup"><span data-stu-id="6449b-123">The merged content is eventually displayed as the dynamic document to your consumer.</span></span>

<span data-ttu-id="6449b-124">Чтобы это работало ожидаемым образом, необходимо сделать следующее:</span><span class="sxs-lookup"><span data-stu-id="6449b-124">To ensure of the above works as expected, you must:</span></span>

- <span data-ttu-id="6449b-125">Убедитесь, что содержимое HTML5 соответствует и доступно.</span><span class="sxs-lookup"><span data-stu-id="6449b-125">Ensure your content is HTML5 compliant and accessible</span></span>
- <span data-ttu-id="6449b-126">Убедитесь, что на сервере содержимого включен механизм CORS.</span><span class="sxs-lookup"><span data-stu-id="6449b-126">Ensure your content server is enabled for CORS.</span></span>
- <span data-ttu-id="6449b-127">Передавайте содержимое по протоколу HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6449b-127">Serve content over HTTPS.</span></span>
- <span data-ttu-id="6449b-128">Используйте абсолютные URL-адреса для всех ссылок и содержимого CSS, например https://yourdomain/content.</span><span class="sxs-lookup"><span data-stu-id="6449b-128">Use absolute URLS such as https://yourdomain/content for all links and CSS content.</span></span>

> [!TIP]
> <span data-ttu-id="6449b-129">Чтобы проверить, включен ли CORS на веб-сайте, на котором размещается содержимое, и протестировать запросы CORS, можно использовать веб-сайт http://test-cors.org/.</span><span class="sxs-lookup"><span data-stu-id="6449b-129">To verify that the site you are hosting your content on has CORS enabled and test CORS requests, you can use the site http://test-cors.org/.</span></span> <span data-ttu-id="6449b-130">Благодаря данному веб-сайту можно отправить запрос CORS к удаленному серверу (для проверки поддержки CORS) или к тестовому серверу (для просмотра определенных функций CORS).</span><span class="sxs-lookup"><span data-stu-id="6449b-130">Thanks to this site, you can simply either send the CORS request to a remote server (to test if CORS is supported), or send the CORS request to a test server (to explore certain features of CORS).</span></span>

> [!TIP]
> <span data-ttu-id="6449b-131">На сайте http://enable-cors.org/ также представлены полезные ресурсы со сведениями о CORS.</span><span class="sxs-lookup"><span data-stu-id="6449b-131">The site http://enable-cors.org/ also constitutes a more than useful resources on CORS.</span></span>

<span data-ttu-id="6449b-132">Благодаря подходу на основе CORS пользователи смогут согласованно работать в приложении и на страницах, обслуживаемых Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="6449b-132">Thanks to this CORS-based approach, the end users will then have consistent experiences between your application and the pages served by Azure AD B2C.</span></span>

## <a name="create-a-storage-account"></a><span data-ttu-id="6449b-133">Создайте учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="6449b-133">Create a storage account</span></span>

<span data-ttu-id="6449b-134">Перед началом необходимо создать учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="6449b-134">As a prerequisite, you need to create a storage account.</span></span> <span data-ttu-id="6449b-135">Для создания учетной записи хранения больших двоичных объектов Azure требуется подписка Azure.</span><span class="sxs-lookup"><span data-stu-id="6449b-135">You will need an Azure subscription to create an Azure Blob Storage account.</span></span> <span data-ttu-id="6449b-136">Вы можете оформить подписку на бесплатную пробную версию на [веб-сайте Azure](https://azure.microsoft.com/en-us/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="6449b-136">You can sign up a free trial at the [Azure website](https://azure.microsoft.com/en-us/pricing/free-trial/).</span></span>

1. <span data-ttu-id="6449b-137">Откройте браузер и перейдите на [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="6449b-137">Open a browsing session and navigate to the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="6449b-138">Выполните вход с использованием учетных данных администратора.</span><span class="sxs-lookup"><span data-stu-id="6449b-138">Sign in with your administrative credentials.</span></span>
3. <span data-ttu-id="6449b-139">Последовательно выберите пункты **+Создать** > **Данные+хранилище** > **Учетная запись хранения**.</span><span class="sxs-lookup"><span data-stu-id="6449b-139">Click **New** > **Data + Storage** > **Storage account**.</span></span>  <span data-ttu-id="6449b-140">Откроется колонка **Создание учетной записи хранения**.</span><span class="sxs-lookup"><span data-stu-id="6449b-140">A **Create storage account** blade opens up.</span></span>
4. <span data-ttu-id="6449b-141">В поле **Имя** введите имя учетной записи хранения, например *contoso369b2c*.</span><span class="sxs-lookup"><span data-stu-id="6449b-141">In **Name**, provide a name for the storage account, for example, *contoso369b2c*.</span></span> <span data-ttu-id="6449b-142">Это значение будет позже называться *storageAccountName*.</span><span class="sxs-lookup"><span data-stu-id="6449b-142">This value will be later referred as to *storageAccountName*.</span></span>
5. <span data-ttu-id="6449b-143">Выберите соответствующую ценовую категорию, группу ресурсов и подписку.</span><span class="sxs-lookup"><span data-stu-id="6449b-143">Pick the appropriate selections for the pricing tier, the resource group and the subscription.</span></span> <span data-ttu-id="6449b-144">Убедитесь, что флажок **Закрепить на начальной панели** установлен.</span><span class="sxs-lookup"><span data-stu-id="6449b-144">Make sure that you have the **Pin to Startboard** option checked.</span></span> <span data-ttu-id="6449b-145">Щелкните **Создать**.</span><span class="sxs-lookup"><span data-stu-id="6449b-145">Click **Create**.</span></span>
6. <span data-ttu-id="6449b-146">Вернитесь на начальную панель и щелкните только что созданную учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="6449b-146">Go back to the Startboard and click the storage account that you just created.</span></span>
7. <span data-ttu-id="6449b-147">В разделе **Службы** щелкните **BLOB-объекты**.</span><span class="sxs-lookup"><span data-stu-id="6449b-147">In the **Services** section, click **Blobs**.</span></span> <span data-ttu-id="6449b-148">Откроется колонка **Служба BLOB-объектов**.</span><span class="sxs-lookup"><span data-stu-id="6449b-148">A **Blob service blade** opens up.</span></span>
8. <span data-ttu-id="6449b-149">Щелкните **+ Container** (+ Контейнер).</span><span class="sxs-lookup"><span data-stu-id="6449b-149">Click **+ Container**.</span></span>
9. <span data-ttu-id="6449b-150">В поле **Имя** ведите имя для контейнера, например *b2c*.</span><span class="sxs-lookup"><span data-stu-id="6449b-150">In **Name**, provide a name for the container, for example, *b2c*.</span></span> <span data-ttu-id="6449b-151">Это значение будет позже называться *containerName*.</span><span class="sxs-lookup"><span data-stu-id="6449b-151">This value will be later referred to as *containerName*.</span></span>
9. <span data-ttu-id="6449b-152">Задайте для параметра **Тип доступа** значение **BLOB-объект**.</span><span class="sxs-lookup"><span data-stu-id="6449b-152">Select **Blob** as the **Access type**.</span></span> <span data-ttu-id="6449b-153">Щелкните **Создать**.</span><span class="sxs-lookup"><span data-stu-id="6449b-153">Click **Create**.</span></span>
10. <span data-ttu-id="6449b-154">Созданный контейнер появится в списке в колонке **Служба BLOB-объектов**.</span><span class="sxs-lookup"><span data-stu-id="6449b-154">The container that you created will appear in the list on the **Blob service blade**.</span></span>
11. <span data-ttu-id="6449b-155">Закройте колонку **Большие двоичные объекты**.</span><span class="sxs-lookup"><span data-stu-id="6449b-155">Close the **Blobs** blade.</span></span>
12. <span data-ttu-id="6449b-156">В **колонке учетной записи хранения** щелкните значок **Ключ**.</span><span class="sxs-lookup"><span data-stu-id="6449b-156">On the **storage account blade**, click the **Key** icon.</span></span> <span data-ttu-id="6449b-157">Откроется колонка **Ключи доступа**.</span><span class="sxs-lookup"><span data-stu-id="6449b-157">An **Access keys blade** opens up.</span></span>  
13. <span data-ttu-id="6449b-158">Запишите значение **key1**.</span><span class="sxs-lookup"><span data-stu-id="6449b-158">Write down the value of **key1**.</span></span> <span data-ttu-id="6449b-159">Это значение будет позже называться *key1*.</span><span class="sxs-lookup"><span data-stu-id="6449b-159">This value will be later referred as *key1*.</span></span>

## <a name="downloading-the-helper-tool"></a><span data-ttu-id="6449b-160">Скачивание вспомогательного средства</span><span class="sxs-lookup"><span data-stu-id="6449b-160">Downloading the helper tool</span></span>

1.  <span data-ttu-id="6449b-161">Скачайте вспомогательное средство с [GitHub](https://github.com/azureadquickstarts/b2c-azureblobstorage-client/archive/master.zip).</span><span class="sxs-lookup"><span data-stu-id="6449b-161">Download the helper tool from [GitHub](https://github.com/azureadquickstarts/b2c-azureblobstorage-client/archive/master.zip).</span></span>
2.  <span data-ttu-id="6449b-162">Сохраните файл *B2C-AzureBlobStorage-Client-master.zip* на локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="6449b-162">Save the *B2C-AzureBlobStorage-Client-master.zip* file on your local machine.</span></span>
3.  <span data-ttu-id="6449b-163">Извлеките содержимое файла B2C-AzureBlobStorage-Client-master.zip на локальный диск, например в папку **UI-Customization-Pack**.</span><span class="sxs-lookup"><span data-stu-id="6449b-163">Extract the content of the B2C-AzureBlobStorage-Client-master.zip file on your local disk, for example under the **UI-Customization-Pack** folder.</span></span> <span data-ttu-id="6449b-164">В ней появится папка *B2C-AzureBlobStorage-Client-master*.</span><span class="sxs-lookup"><span data-stu-id="6449b-164">This will create a *B2C-AzureBlobStorage-Client-master* folder underneath.</span></span>
4.  <span data-ttu-id="6449b-165">Откройте эту папку и извлеките содержимое архива *B2CAzureStorageClient.zip*.</span><span class="sxs-lookup"><span data-stu-id="6449b-165">Open that folder and extract the content of the archive file *B2CAzureStorageClient.zip* within it.</span></span>

## <a name="upload-the-ui-customization-pack-sample-files"></a><span data-ttu-id="6449b-166">Передача примеров файлов UI-Customization-Pack</span><span class="sxs-lookup"><span data-stu-id="6449b-166">Upload the UI-Customization-Pack sample files</span></span>

1.  <span data-ttu-id="6449b-167">С помощью проводника Windows перейдите в папку *B2C-AzureBlobStorage-Client-master*, расположенную в папке *UI-Customization-Pack*, созданной при работе с предыдущим разделом.</span><span class="sxs-lookup"><span data-stu-id="6449b-167">Using Windows Explorer, navigate to the folder *B2C-AzureBlobStorage-Client-master* located under the *UI-Customization-Pack* folder created in the previous section.</span></span>
2.  <span data-ttu-id="6449b-168">Запустите файл *B2CAzureStorageClient.exe*.</span><span class="sxs-lookup"><span data-stu-id="6449b-168">Run the *B2CAzureStorageClient.exe* file.</span></span> <span data-ttu-id="6449b-169">Эта программа просто загружает все файлы в каталог, указанный в вашей учетной записи хранения, и обеспечивает доступ к этим файлам с помощью CORS.</span><span class="sxs-lookup"><span data-stu-id="6449b-169">This program will simply upload all the files in the directory that you specify to your storage account, and enable CORS access for those files.</span></span>
3.  <span data-ttu-id="6449b-170">При появлении запроса укажите:</span><span class="sxs-lookup"><span data-stu-id="6449b-170">When prompted, specify: a.</span></span>  <span data-ttu-id="6449b-171">Имя учетной записи хранения *storageAccountName*, например *contoso369b2c*.</span><span class="sxs-lookup"><span data-stu-id="6449b-171">The name of your storage account, *storageAccountName*, for example *contoso369b2c*.</span></span>
    <span data-ttu-id="6449b-172">b.</span><span class="sxs-lookup"><span data-stu-id="6449b-172">b.</span></span>  <span data-ttu-id="6449b-173">Первичный ключ доступа хранилища BLOB-объектов Azure *key1*, например *contoso369b2c*.</span><span class="sxs-lookup"><span data-stu-id="6449b-173">The primary access key of your azure blob storage, *key1*, for example *contoso369b2c*.</span></span>
    <span data-ttu-id="6449b-174">c.</span><span class="sxs-lookup"><span data-stu-id="6449b-174">c.</span></span>  <span data-ttu-id="6449b-175">Имя контейнера хранилища BLOB-объектов *containerName*, например *b2c*.</span><span class="sxs-lookup"><span data-stu-id="6449b-175">The name of your storage blob storage container, *containerName*, for example *b2c*.</span></span>
    <span data-ttu-id="6449b-176">г)</span><span class="sxs-lookup"><span data-stu-id="6449b-176">d.</span></span>  <span data-ttu-id="6449b-177">Путь к примерам файлов *Starter-Pack*, например *..\B2CTemplates\wingtiptoys*.</span><span class="sxs-lookup"><span data-stu-id="6449b-177">The path of the *Starter-Pack* sample files, for example *..\B2CTemplates\wingtiptoys*.</span></span>

<span data-ttu-id="6449b-178">Если вы следовали приведенным выше инструкциям, файлы HTML5 и CSS *UI-Customization-Pack* вымышленной компании **wingtiptoys** будут указывать на вашу учетную запись хранения.</span><span class="sxs-lookup"><span data-stu-id="6449b-178">If you followed the steps above, the HTML5 and CSS files of the *UI-Customization-Pack* for the fictitious company **wingtiptoys** will now be pointing to your storage account.</span></span>  <span data-ttu-id="6449b-179">Чтобы проверить, правильно ли передано содержимое, откройте колонку связанного контейнера на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="6449b-179">You can verify that the content has been uploaded correctly by opening the related container blade in the Azure portal.</span></span> <span data-ttu-id="6449b-180">Кроме того, это можно проверить на странице браузера.</span><span class="sxs-lookup"><span data-stu-id="6449b-180">You can alternatively verify that the content has been uploaded correctly by accessing the page from a browser.</span></span> <span data-ttu-id="6449b-181">Дополнительные сведения см. в статье [Azure Active Directory B2C: вспомогательное средство, используемое для демонстрации настройки пользовательского интерфейса для страницы пользователя](active-directory-b2c-reference-ui-customization-helper-tool.md).</span><span class="sxs-lookup"><span data-stu-id="6449b-181">For more information, see [Azure Active Directory B2C: A helper tool used to demonstrate the page user interface (UI) customization feature](active-directory-b2c-reference-ui-customization-helper-tool.md).</span></span>

## <a name="ensure-the-storage-account-has-cors-enabled"></a><span data-ttu-id="6449b-182">Проверка включения механизма CORS в учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="6449b-182">Ensure the storage account has CORS enabled</span></span>

<span data-ttu-id="6449b-183">CORS необходимо включить в конечной точке, чтобы Azure AD B2C Premium мог загрузить содержимое.</span><span class="sxs-lookup"><span data-stu-id="6449b-183">CORS (Cross-Origin Resource Sharing) must be enabled on your endpoint for Azure AD B2C Premium to load your content.</span></span> <span data-ttu-id="6449b-184">Это необходимо, так как содержимое размещается в домене, отличном от домена, из которого Azure AD B2C Premium будет обслуживать страницу.</span><span class="sxs-lookup"><span data-stu-id="6449b-184">This is because your content is hosted on a different domain than the domain Azure AD B2C Premium will be serving the page from.</span></span>

<span data-ttu-id="6449b-185">Чтобы убедиться, что в хранилище, в котором размещается содержимое, включен механизм CORS, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="6449b-185">To verify that the storage you are hosting your content on has CORS enabled, proceed with the following steps:</span></span>

1. <span data-ttu-id="6449b-186">Откройте браузер и перейдите на страницу *unified.html*, используя полный URL-адрес расположения в вашей учетной записи хранения `https://<storageAccountName>.blob.core.windows.net/<containerName>/unified.html`.</span><span class="sxs-lookup"><span data-stu-id="6449b-186">Open a browsing session and navigate to the page *unified.html* using the full URL of its location in your storage account, `https://<storageAccountName>.blob.core.windows.net/<containerName>/unified.html`.</span></span> <span data-ttu-id="6449b-187">Например, https://contoso369b2c.blob.core.windows.net/b2c/unified.html.</span><span class="sxs-lookup"><span data-stu-id="6449b-187">For example, https://contoso369b2c.blob.core.windows.net/b2c/unified.html.</span></span>
2. <span data-ttu-id="6449b-188">Перейдите к http://test-cors.org.</span><span class="sxs-lookup"><span data-stu-id="6449b-188">Navigate to http://test-cors.org.</span></span> <span data-ttu-id="6449b-189">Этот сайт позволяет убедиться, что на используемой странице включен механизм CORS.</span><span class="sxs-lookup"><span data-stu-id="6449b-189">This site allows you to verify that the page you are using has CORS enabled.</span></span>  
<!--
![test-cors.org](../../media/active-directory-b2c-customize-ui-of-a-user-journey/test-cors.png)
-->

3. <span data-ttu-id="6449b-190">В поле **Remote URL** (Удаленный URL-адрес) введите полный URL-адрес содержимого unified.html и щелкните **Отправить запрос**.</span><span class="sxs-lookup"><span data-stu-id="6449b-190">In **Remote URL**, enter the full URL for your unified.html content, and click **Send Request**.</span></span>
4. <span data-ttu-id="6449b-191">Убедитесь, что выходные данные в разделе **Результаты** содержат *XHR status: 200*.</span><span class="sxs-lookup"><span data-stu-id="6449b-191">Verify that the output in the **Results** section contains *XHR status: 200*.</span></span> <span data-ttu-id="6449b-192">Это означает, что CORS включен.</span><span class="sxs-lookup"><span data-stu-id="6449b-192">This indicates that CORS is enabled.</span></span>
<!--
![CORS enabled](../../media/active-directory-b2c-customize-ui-of-a-user-journey/cors-enabled.png)
-->
<span data-ttu-id="6449b-193">Теперь учетная запись хранения должна содержать контейнер больших двоичных объектов с именем *b2c* со следующими шаблонами wingtiptoys из *Starter-Pack*.</span><span class="sxs-lookup"><span data-stu-id="6449b-193">The storage account should now contain a blob container named *b2c* in our illustration that contains the following wingtiptoys templates from the *Starter-Pack*.</span></span>

<!--
![Correctly configured storage account](../../articles/active-directory-b2c/media/active-directory-b2c-reference-customize-ui-custom/storage-account-final.png)
-->

<span data-ttu-id="6449b-194">В следующей таблице описано назначение страниц HTML5, указанных выше.</span><span class="sxs-lookup"><span data-stu-id="6449b-194">The following table describes the purpose of the above HTML5 pages.</span></span>

| <span data-ttu-id="6449b-195">Шаблон HTML5</span><span class="sxs-lookup"><span data-stu-id="6449b-195">HTML5 template</span></span> | <span data-ttu-id="6449b-196">Описание</span><span class="sxs-lookup"><span data-stu-id="6449b-196">Description</span></span> |
|----------------|-------------|
| <span data-ttu-id="6449b-197">*phonefactor.html*</span><span class="sxs-lookup"><span data-stu-id="6449b-197">*phonefactor.html*</span></span> | <span data-ttu-id="6449b-198">Эта страница используется как шаблон для страницы Многофакторной идентификации.</span><span class="sxs-lookup"><span data-stu-id="6449b-198">This page can be used as a template for a multi-factor authentication page.</span></span> |
| <span data-ttu-id="6449b-199">*ResetPassword.html*</span><span class="sxs-lookup"><span data-stu-id="6449b-199">*resetpassword.html*</span></span> | <span data-ttu-id="6449b-200">Эту страницу можно использовать в качестве шаблона для страницы восстановления пароля.</span><span class="sxs-lookup"><span data-stu-id="6449b-200">This page can be used as a template for a forgot password page.</span></span> |
| <span data-ttu-id="6449b-201">*selfasserted.html*</span><span class="sxs-lookup"><span data-stu-id="6449b-201">*selfasserted.html*</span></span> | <span data-ttu-id="6449b-202">Эта страница используется как шаблон для страницы регистрации учетных записей социальных сетей, страницы регистрации локальной учетной записи или страницы входа в локальную учетную запись.</span><span class="sxs-lookup"><span data-stu-id="6449b-202">This page can be used as a template for a social account sign-up page, a local account sign-up page, or a local account sign-in page.</span></span> |
| <span data-ttu-id="6449b-203">*unified.html*</span><span class="sxs-lookup"><span data-stu-id="6449b-203">*unified.html*</span></span> | <span data-ttu-id="6449b-204">Эта страница используется как шаблон для единой страницы регистрации или входа в систему.</span><span class="sxs-lookup"><span data-stu-id="6449b-204">This page can be used as a template for a unified sign-up or sign-in page.</span></span> |
| <span data-ttu-id="6449b-205">*updateprofile.html*</span><span class="sxs-lookup"><span data-stu-id="6449b-205">*updateprofile.html*</span></span> | <span data-ttu-id="6449b-206">Эта страница используется как шаблон для страницы обновления профиля.</span><span class="sxs-lookup"><span data-stu-id="6449b-206">This page can be used as a template for a profile update page.</span></span> |

## <a name="add-a-link-to-your-html5css-templates-to-your-user-journey"></a><span data-ttu-id="6449b-207">Добавление ссылки на шаблоны HTML5 и CSS к пути взаимодействия пользователя</span><span class="sxs-lookup"><span data-stu-id="6449b-207">Add a link to your HTML5/CSS templates to your user journey</span></span>

<span data-ttu-id="6449b-208">Вы можете добавить ссылку на шаблоны HTML5 и CSS к пути взаимодействия пользователя, изменив пользовательскую политику напрямую.</span><span class="sxs-lookup"><span data-stu-id="6449b-208">You can add a link to your HTML5/CSS templates to your user journey by editing a custom policy directly.</span></span>

<span data-ttu-id="6449b-209">Пользовательские шаблоны HTML5 и CSS для использования в пути взаимодействия пользователя нужно указать в списке определений содержимого, которое можно использовать.</span><span class="sxs-lookup"><span data-stu-id="6449b-209">The custom HTML5/CSS templates to use in your user journey have to be specified in a list of content definitions that can be used in those user journeys.</span></span> <span data-ttu-id="6449b-210">Для этого нужно объявить необязательный XML-элемент *<ContentDefinitions>* в разделе *<BuildingBlocks>* XML-файла пользовательской политики.</span><span class="sxs-lookup"><span data-stu-id="6449b-210">For that purpose, an optional *<ContentDefinitions>* XML element must be declared under the *<BuildingBlocks>* section of your custom policy XML file.</span></span>

<span data-ttu-id="6449b-211">В следующей таблице описан набор идентификаторов определений содержимого, распознаваемых подсистемой идентификации Azure AD B2C, и типы страниц, относящихся к ним.</span><span class="sxs-lookup"><span data-stu-id="6449b-211">The following table describes the set of content definition ids recognized by the Azure AD B2C identity experience engine and the type of pages that relates to them.</span></span>

| <span data-ttu-id="6449b-212">Идентификатор определения содержимого</span><span class="sxs-lookup"><span data-stu-id="6449b-212">Content definition id</span></span> | <span data-ttu-id="6449b-213">Описание</span><span class="sxs-lookup"><span data-stu-id="6449b-213">Description</span></span> |
|-----------------------|-------------|
| <span data-ttu-id="6449b-214">*api.error*</span><span class="sxs-lookup"><span data-stu-id="6449b-214">*api.error*</span></span> | <span data-ttu-id="6449b-215">**Страница ошибки.**</span><span class="sxs-lookup"><span data-stu-id="6449b-215">**Error page**.</span></span> <span data-ttu-id="6449b-216">Эта страница отображается при обнаружении исключения или ошибки.</span><span class="sxs-lookup"><span data-stu-id="6449b-216">This page is displayed when an exception or an error is encountered.</span></span> |
| <span data-ttu-id="6449b-217">*api.idpselections*</span><span class="sxs-lookup"><span data-stu-id="6449b-217">*api.idpselections*</span></span> | <span data-ttu-id="6449b-218">**Страница выбора поставщика удостоверений.**</span><span class="sxs-lookup"><span data-stu-id="6449b-218">**Identity provider selection page**.</span></span> <span data-ttu-id="6449b-219">На этой странице содержится список поставщиков удостоверений, которых можно выбирать во время входа пользователя.</span><span class="sxs-lookup"><span data-stu-id="6449b-219">This page contains a list of identity providers that the user can choose from during sign-in.</span></span> <span data-ttu-id="6449b-220">Это поставщики удостоверений организаций, социальных сетей, например Facebook и Google+, или локальных учетных записей (адрес электронной почты или имя пользователя).</span><span class="sxs-lookup"><span data-stu-id="6449b-220">These are either enterprise identity providers, social identity providers such as Facebook and Google+, or local accounts (based on email address or user name).</span></span> |
| <span data-ttu-id="6449b-221">*api.idpselections.signup*</span><span class="sxs-lookup"><span data-stu-id="6449b-221">*api.idpselections.signup*</span></span> | <span data-ttu-id="6449b-222">**Выбор поставщика удостоверений для регистрации.**</span><span class="sxs-lookup"><span data-stu-id="6449b-222">**Identity provider selection for sign-up**.</span></span> <span data-ttu-id="6449b-223">На этой странице содержится список поставщиков удостоверений, которых можно выбирать во время регистрации.</span><span class="sxs-lookup"><span data-stu-id="6449b-223">This page contains a list of identity providers that the user can choose from during sign-up.</span></span> <span data-ttu-id="6449b-224">Это поставщики удостоверений организаций, социальных сетей, например Facebook и Google+, или локальных учетных записей (адрес электронной почты или имя пользователя).</span><span class="sxs-lookup"><span data-stu-id="6449b-224">These are either enterprise identity providers, social identity providers such as Facebook and Google+, or local accounts (based on email address or user name).</span></span> |
| <span data-ttu-id="6449b-225">*api.localaccountpasswordreset*</span><span class="sxs-lookup"><span data-stu-id="6449b-225">*api.localaccountpasswordreset*</span></span> | <span data-ttu-id="6449b-226">**Страница восстановления пароля.**</span><span class="sxs-lookup"><span data-stu-id="6449b-226">**Forgot password page**.</span></span> <span data-ttu-id="6449b-227">Эта страница содержит форму, которую должен заполнить пользователь для выполнения сброса пароля.</span><span class="sxs-lookup"><span data-stu-id="6449b-227">This page contains a form that the user has to fill to initiate their password reset.</span></span>  |
| <span data-ttu-id="6449b-228">*api.localaccountsignin*</span><span class="sxs-lookup"><span data-stu-id="6449b-228">*api.localaccountsignin*</span></span> | <span data-ttu-id="6449b-229">**Страница входа в локальную учетную запись.**</span><span class="sxs-lookup"><span data-stu-id="6449b-229">**Local account sign-in page**.</span></span> <span data-ttu-id="6449b-230">Эта страница содержит форму, которую пользователь должен заполнить при входе в локальную учетную запись (на основе адреса электронной почты или имени пользователя).</span><span class="sxs-lookup"><span data-stu-id="6449b-230">This page contains a sign-in form that the user has to fill in when signing in with a local account that is based on an email address or a user name.</span></span> <span data-ttu-id="6449b-231">Форма может содержать текстовое поле ввода и окно ввода пароля.</span><span class="sxs-lookup"><span data-stu-id="6449b-231">The form can contain a text input box and password entry box.</span></span> |
| <span data-ttu-id="6449b-232">*api.localaccountsignup*</span><span class="sxs-lookup"><span data-stu-id="6449b-232">*api.localaccountsignup*</span></span> | <span data-ttu-id="6449b-233">**Страница регистрации локальной учетной записи.**</span><span class="sxs-lookup"><span data-stu-id="6449b-233">**Local account sign-up page**.</span></span> <span data-ttu-id="6449b-234">Эта страница содержит форму, которую пользователь должен заполнить при регистрации локальной учетной записи (на основе адреса электронной почты или имени пользователя).</span><span class="sxs-lookup"><span data-stu-id="6449b-234">This page contains a sign-up form that the user has to fill in when signing up for a local account that is based on an email address or a user name.</span></span> <span data-ttu-id="6449b-235">Форма может содержать различные элементы управления для ввода текста, например: текстовое поле, поле ввода пароля, переключатель, раскрывающийся список с единственным выбором или флажки множественного выбора.</span><span class="sxs-lookup"><span data-stu-id="6449b-235">The form can contain different input controls such as text input box, password entry box, radio button, single-select drop-down boxes, and multi-select check boxes.</span></span> |
| <span data-ttu-id="6449b-236">*api.phonefactor*</span><span class="sxs-lookup"><span data-stu-id="6449b-236">*api.phonefactor*</span></span> | <span data-ttu-id="6449b-237">**Страница Многофакторной идентификации.**</span><span class="sxs-lookup"><span data-stu-id="6449b-237">**Multi-factor authentication page**.</span></span> <span data-ttu-id="6449b-238">Эта страница позволяет пользователю подтвердить свой номер телефона (с помощью SMS-сообщения или голосового звонка) во время регистрации или входа.</span><span class="sxs-lookup"><span data-stu-id="6449b-238">On this page, users can verify their phone numbers (using text or voice) during sign-up or sign-in.</span></span> |
| <span data-ttu-id="6449b-239">*api.selfasserted*</span><span class="sxs-lookup"><span data-stu-id="6449b-239">*api.selfasserted*</span></span> | <span data-ttu-id="6449b-240">**Страница регистрации учетной записи социальных сетей.**</span><span class="sxs-lookup"><span data-stu-id="6449b-240">**Social account sign-up page**.</span></span> <span data-ttu-id="6449b-241">Эта страница содержит форму регистрации, которую нужно заполнить пользователю при регистрации с использованием существующей учетной записи от таких поставщиков удостоверений социальных сетей, как Facebook или Google+.</span><span class="sxs-lookup"><span data-stu-id="6449b-241">This page contains a sign-up form that the user has to fill in when signing up using an existing account from a social identity provider such as Facebook or Google+.</span></span> <span data-ttu-id="6449b-242">Эта страница аналогична странице регистрации локальных учетных записей, за исключением полей для ввода пароля.</span><span class="sxs-lookup"><span data-stu-id="6449b-242">This page is similar to the above social account sign-up page with the exception of the password entry fields.</span></span> |
| <span data-ttu-id="6449b-243">*api.selfasserted.profileupdate*</span><span class="sxs-lookup"><span data-stu-id="6449b-243">*api.selfasserted.profileupdate*</span></span> | <span data-ttu-id="6449b-244">**Страница обновления профиля.**</span><span class="sxs-lookup"><span data-stu-id="6449b-244">**Profile update page**.</span></span> <span data-ttu-id="6449b-245">Эта страница содержит форму, которую пользователь может использовать для обновления профиля.</span><span class="sxs-lookup"><span data-stu-id="6449b-245">This page contains a form that the user can use to update their profile.</span></span> <span data-ttu-id="6449b-246">Эта страница аналогична странице регистрации локальных учетных записей, за исключением полей для ввода пароля.</span><span class="sxs-lookup"><span data-stu-id="6449b-246">This page is similar to the above social account sign-up page with the exception of the password entry fields.</span></span> |
| <span data-ttu-id="6449b-247">*api.signuporsignin*</span><span class="sxs-lookup"><span data-stu-id="6449b-247">*api.signuporsignin*</span></span> | <span data-ttu-id="6449b-248">**Единая страница регистрации или входа.**</span><span class="sxs-lookup"><span data-stu-id="6449b-248">**Unified sign-up or sign-in page**.</span></span>  <span data-ttu-id="6449b-249">На этой странице обрабатывается регистрация и вход пользователей, которые могут использовать поставщики удостоверений организаций, поставщики удостоверений социальных сетей, такие как Facebook или Google+, или локальные учетные записи.</span><span class="sxs-lookup"><span data-stu-id="6449b-249">This page handles both sign-up & sign-in of users, who can use enterprise identity providers, social identity providers such as Facebook or Google+, or local accounts.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6449b-250">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="6449b-250">Next steps</span></span>
[<span data-ttu-id="6449b-251">Общие сведения о пользовательских политиках начального пакета Azure Active Directory B2C</span><span class="sxs-lookup"><span data-stu-id="6449b-251">Reference: Understand how custom policies work with the Identity Experience Framework in B2C</span></span>](active-directory-b2c-reference-custom-policies-understanding-contents.md)
