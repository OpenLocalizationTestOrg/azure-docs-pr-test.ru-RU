---
title: "Azure AD B2C: вход в веб-приложения с помощью OpenID Connect | Документация Майкрософт"
description: "Построение веб-приложений с использованием реализации протокола проверки подлинности OpenID Connect hello hello Azure Active Directory"
services: active-directory-b2c
documentationcenter: 
author: saeedakhter-msft
manager: krassk
editor: parakhj
ms.assetid: 21d420c8-3c10-4319-b681-adf2e89e7ede
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/16/2017
ms.author: saeedakhter-msft
ms.openlocfilehash: 89e9cfa28e4e5c34304aea355cca2dd0c4b42abc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-active-directory-b2c-web-sign-in-with-openid-connect"></a><span data-ttu-id="a97a2-103">Azure Active Directory B2C: вход в веб-приложения с помощью OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="a97a2-103">Azure Active Directory B2C: Web sign-in with OpenID Connect</span></span>
<span data-ttu-id="a97a2-104">OpenID Connect — это протокол проверки подлинности, построена на базе OAuth 2.0, может быть вход пользователей используется toosecurely tooweb приложений.</span><span class="sxs-lookup"><span data-stu-id="a97a2-104">OpenID Connect is an authentication protocol, built on top of OAuth 2.0, that can be used toosecurely sign users in tooweb applications.</span></span> <span data-ttu-id="a97a2-105">С помощью реализации hello Azure Active Directory B2C OpenID Connect (Azure AD B2C), можно передать регистрации, вход и задач по управлению другими удостоверениями в вашей tooAzure приложения web Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="a97a2-105">By using hello Azure Active Directory B2C (Azure AD B2C) implementation of OpenID Connect, you can outsource sign-up, sign-in, and other identity management experiences in your web applications tooAzure Active Directory (Azure AD).</span></span> <span data-ttu-id="a97a2-106">В этом руководстве показано, как toodo так, в зависимости от языка.</span><span class="sxs-lookup"><span data-stu-id="a97a2-106">This guide shows you how toodo so in a language-independent manner.</span></span> <span data-ttu-id="a97a2-107">Описывает способ toosend и получать сообщения HTTP без использования нашей библиотек с открытым исходным кодом.</span><span class="sxs-lookup"><span data-stu-id="a97a2-107">It describes how toosend and receive HTTP messages without using any of our open-source libraries.</span></span>

<span data-ttu-id="a97a2-108">[OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html) расширяет hello OAuth 2.0 *авторизации* протокола для использования в качестве *проверки подлинности* протокола.</span><span class="sxs-lookup"><span data-stu-id="a97a2-108">[OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html) extends hello OAuth 2.0 *authorization* protocol for use as an *authentication* protocol.</span></span> <span data-ttu-id="a97a2-109">Это позволяет вам tooperform единого входа с помощью OAuth.</span><span class="sxs-lookup"><span data-stu-id="a97a2-109">This allows you tooperform single sign-on by using OAuth.</span></span> <span data-ttu-id="a97a2-110">Представляет концепцию hello *маркер идентификатора*, который является маркер безопасности, позволяющий tooverify клиента hello hello удостоверение пользователя hello и получить профиль основные сведения о пользователе hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-110">It introduces hello concept of an *ID token*, which is a security token that allows hello client tooverify hello identity of hello user and obtain basic profile information about hello user.</span></span>

<span data-ttu-id="a97a2-111">Поскольку он расширяет OAuth 2.0, также позволяет приложениям получить toosecurely *маркеры доступа*.</span><span class="sxs-lookup"><span data-stu-id="a97a2-111">Because it extends OAuth 2.0, it also enables apps toosecurely acquire *access tokens*.</span></span> <span data-ttu-id="a97a2-112">Можно использовать access_tokens tooaccess ресурсы, которые защищены с помощью [сервер авторизации](active-directory-b2c-reference-protocols.md#the-basics).</span><span class="sxs-lookup"><span data-stu-id="a97a2-112">You can use access_tokens tooaccess resources that are secured by an [authorization server](active-directory-b2c-reference-protocols.md#the-basics).</span></span> <span data-ttu-id="a97a2-113">Мы рекомендуем использовать OpenID Connect для веб-приложений, которые размещаются на сервере и доступны через веб-браузер.</span><span class="sxs-lookup"><span data-stu-id="a97a2-113">We recommend OpenID Connect if you're building a web application that is hosted on a server and accessed through a browser.</span></span> <span data-ttu-id="a97a2-114">Если требуется tooadd identity management tooyour мобильных или настольных приложений с помощью Azure AD B2C, следует использовать [OAuth 2.0](active-directory-b2c-reference-oauth-code.md) вместо OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="a97a2-114">If you want tooadd identity management tooyour mobile or desktop applications by using Azure AD B2C, you should use [OAuth 2.0](active-directory-b2c-reference-oauth-code.md) rather than OpenID Connect.</span></span>

<span data-ttu-id="a97a2-115">Azure AD B2C расширяет toodo протокола Стандартная OpenID Connect hello больше, чем простой проверки подлинности и авторизации.</span><span class="sxs-lookup"><span data-stu-id="a97a2-115">Azure AD B2C extends hello standard OpenID Connect protocol toodo more than simple authentication and authorization.</span></span> <span data-ttu-id="a97a2-116">Представляет hello [параметра политики](active-directory-b2c-reference-policies.md), обеспечивающий toouse OpenID Connect tooadd взаимодействий с пользователем, таких как регистрация, вход и управление профилями--tooyour приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-116">It introduces hello [policy parameter](active-directory-b2c-reference-policies.md), which enables you toouse OpenID Connect tooadd user experiences--such as sign-up, sign-in, and profile management--tooyour app.</span></span> <span data-ttu-id="a97a2-117">Здесь мы покажем, как toouse OpenID Connect и политики tooimplement, каждый из них возникает в веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="a97a2-117">Here, we show you how toouse OpenID Connect and policies tooimplement each of these experiences in your web applications.</span></span> <span data-ttu-id="a97a2-118">Мы также покажем, как tooget токены доступа для доступа к веб-API.</span><span class="sxs-lookup"><span data-stu-id="a97a2-118">We'll also show you how tooget access tokens for accessing web APIs.</span></span>

<span data-ttu-id="a97a2-119">запросы HTTP пример Hello в следующем разделе hello использования каталог B2C образца, fabrikamb2c.onmicrosoft.com, а также пример приложения, https://aadb2cplayground.azurewebsites.net и политик.</span><span class="sxs-lookup"><span data-stu-id="a97a2-119">hello example HTTP requests in hello next section use our sample B2C directory, fabrikamb2c.onmicrosoft.com, as well as our sample application, https://aadb2cplayground.azurewebsites.net, and policies.</span></span> <span data-ttu-id="a97a2-120">Вы можете tootry out hello запрашивает самостоятельно, используя эти значения, или их можно заменить на собственный.</span><span class="sxs-lookup"><span data-stu-id="a97a2-120">You're free tootry out hello requests yourself by using these values, or you can replace them with your own.</span></span>
<span data-ttu-id="a97a2-121">Узнайте, каким образом слишком[получить клиента B2C, приложения и политики](#use-your-own-b2c-directory).</span><span class="sxs-lookup"><span data-stu-id="a97a2-121">Learn how too[get your own B2C tenant, application, and policies](#use-your-own-b2c-directory).</span></span>

## <a name="send-authentication-requests"></a><span data-ttu-id="a97a2-122">Отправка запросов проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="a97a2-122">Send authentication requests</span></span>
<span data-ttu-id="a97a2-123">Если веб-приложения требуется tooauthenticate hello пользователя и выполнения политики, мог направлять пользователя toohello hello `/authorize` конечной точки.</span><span class="sxs-lookup"><span data-stu-id="a97a2-123">When your web app needs tooauthenticate hello user and execute a policy, it can direct hello user toohello `/authorize` endpoint.</span></span> <span data-ttu-id="a97a2-124">Это интерактивный часть потока hello hello где hello пользователь выполняет действие, в зависимости от политики hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-124">This is hello interactive portion of hello flow, where hello user takes action, depending on hello policy.</span></span>

<span data-ttu-id="a97a2-125">В этом запросе hello клиент указывает hello разрешения, необходимость tooacquire от пользователя hello в hello `scope` tooexecute политику параметров и hello в hello `p` параметра.</span><span class="sxs-lookup"><span data-stu-id="a97a2-125">In this request, hello client indicates hello permissions that it needs tooacquire from hello user in hello `scope` parameter and hello policy tooexecute in hello `p` parameter.</span></span> <span data-ttu-id="a97a2-126">Три примера приведены в следующих разделах (с разбиением на строки для удобства чтения), hello каждого с помощью другой политики.</span><span class="sxs-lookup"><span data-stu-id="a97a2-126">Three examples are provided in hello following sections (with line breaks for readability), each using a different policy.</span></span> <span data-ttu-id="a97a2-127">tooget вид, как работает каждый запрос, повторите запрос вставки hello в браузере и запустив его.</span><span class="sxs-lookup"><span data-stu-id="a97a2-127">tooget a feel for how each request works, try pasting hello request into a browser and running it.</span></span>

#### <a name="use-a-sign-in-policy"></a><span data-ttu-id="a97a2-128">Пример с политикой входа в систему</span><span class="sxs-lookup"><span data-stu-id="a97a2-128">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_in
```

#### <a name="use-a-sign-up-policy"></a><span data-ttu-id="a97a2-129">Пример с политикой регистрации</span><span class="sxs-lookup"><span data-stu-id="a97a2-129">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_up
```

#### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="a97a2-130">Пример с политикой изменения профиля</span><span class="sxs-lookup"><span data-stu-id="a97a2-130">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_edit_profile
```

| <span data-ttu-id="a97a2-131">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-131">Parameter</span></span> | <span data-ttu-id="a97a2-132">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="a97a2-132">Required?</span></span> | <span data-ttu-id="a97a2-133">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-133">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a97a2-134">client_id</span><span class="sxs-lookup"><span data-stu-id="a97a2-134">client_id</span></span> |<span data-ttu-id="a97a2-135">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-135">Required</span></span> |<span data-ttu-id="a97a2-136">Hello приложение с кодом, hello [портал Azure](https://portal.azure.com/) назначенный tooyour приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-136">hello application ID that hello [Azure portal](https://portal.azure.com/) assigned tooyour app.</span></span> |
| <span data-ttu-id="a97a2-137">response_type</span><span class="sxs-lookup"><span data-stu-id="a97a2-137">response_type</span></span> |<span data-ttu-id="a97a2-138">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-138">Required</span></span> |<span data-ttu-id="a97a2-139">Тип ответа Hello, которое должно включать маркер идентификатора для OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="a97a2-139">hello response type, which must include an ID token for OpenID Connect.</span></span> <span data-ttu-id="a97a2-140">Если веб-приложению также потребуются токены для вызова веб-API, можете использовать `code+id_token`, как и в наших примерах.</span><span class="sxs-lookup"><span data-stu-id="a97a2-140">If your web app also needs tokens for calling a web API, you can use `code+id_token`, as we've done here.</span></span> |
| <span data-ttu-id="a97a2-141">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="a97a2-141">redirect_uri</span></span> |<span data-ttu-id="a97a2-142">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-142">Recommended</span></span> |<span data-ttu-id="a97a2-143">Hello `redirect_uri` параметр приложения, где запросы проверки подлинности можно отправленных и полученных приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-143">hello `redirect_uri` parameter of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="a97a2-144">Он должен точно соответствовать одному из hello `redirect_uri` параметров, зарегистрированных в портале hello, за исключением того, он должен быть в кодировке URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="a97a2-144">It must exactly match one of hello `redirect_uri` parameters that you registered in hello portal, except that it must be URL encoded.</span></span> |
| <span data-ttu-id="a97a2-145">scope</span><span class="sxs-lookup"><span data-stu-id="a97a2-145">scope</span></span> |<span data-ttu-id="a97a2-146">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-146">Required</span></span> |<span data-ttu-id="a97a2-147">Список областей с разделителями-пробелами.</span><span class="sxs-lookup"><span data-stu-id="a97a2-147">A space-separated list of scopes.</span></span> <span data-ttu-id="a97a2-148">Значение одной области указывает tooAzure AD оба разрешения, которые были запрошены.</span><span class="sxs-lookup"><span data-stu-id="a97a2-148">A single scope value indicates tooAzure AD both permissions that are being requested.</span></span> <span data-ttu-id="a97a2-149">Hello `openid` область указывает toosign разрешение в hello пользователей и получить данные о пользователе hello в форме hello маркеров безопасности (Дополнительные toocome об этом hello статьи).</span><span class="sxs-lookup"><span data-stu-id="a97a2-149">hello `openid` scope indicates a permission toosign in hello user and get data about hello user in hello form of ID tokens (more toocome on this later in hello article).</span></span> <span data-ttu-id="a97a2-150">Hello `offline_access` область является необязательным для веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="a97a2-150">hello `offline_access` scope is optional for web apps.</span></span> <span data-ttu-id="a97a2-151">Указывает, что вашему приложению потребуется *токен обновления* для tooresources долгоживущие доступа.</span><span class="sxs-lookup"><span data-stu-id="a97a2-151">It indicates that your app will need a *refresh token* for long-lived access tooresources.</span></span> |
| <span data-ttu-id="a97a2-152">response_mode</span><span class="sxs-lookup"><span data-stu-id="a97a2-152">response_mode</span></span> |<span data-ttu-id="a97a2-153">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-153">Recommended</span></span> |<span data-ttu-id="a97a2-154">метод Hello, которые должны быть задней tooyour используется toosend hello полученный авторизации кода приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-154">hello method that should be used toosend hello resulting authorization code back tooyour app.</span></span> <span data-ttu-id="a97a2-155">Это может быть `query`, `form_post` или `fragment`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-155">It can be either `query`, `form_post`, or `fragment`.</span></span>  <span data-ttu-id="a97a2-156">Hello `form_post` для обеспечения лучшей защиты рекомендуется режим ответа.</span><span class="sxs-lookup"><span data-stu-id="a97a2-156">hello `form_post` response mode is recommended for best security.</span></span> |
| <span data-ttu-id="a97a2-157">state</span><span class="sxs-lookup"><span data-stu-id="a97a2-157">state</span></span> |<span data-ttu-id="a97a2-158">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-158">Recommended</span></span> |<span data-ttu-id="a97a2-159">Значение, включенных в запрос hello, также возвращается в ответ на токен hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-159">A value included in hello request that is also returned in hello token response.</span></span> <span data-ttu-id="a97a2-160">Это может быть строка любого контента.</span><span class="sxs-lookup"><span data-stu-id="a97a2-160">It can be a string of any content that you want.</span></span> <span data-ttu-id="a97a2-161">Как правило, с целью предотвращения подделки межсайтовых запросов используется генерируемое случайным образом уникальное значение.</span><span class="sxs-lookup"><span data-stu-id="a97a2-161">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span></span> <span data-ttu-id="a97a2-162">Hello вариант, также используется tooencode сведения о состоянии пользователя hello в приложение hello до возникновения hello запрос проверки подлинности, например страницы hello, в котором они находились на.</span><span class="sxs-lookup"><span data-stu-id="a97a2-162">hello state is also used tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page they were on.</span></span> |
| <span data-ttu-id="a97a2-163">nonce</span><span class="sxs-lookup"><span data-stu-id="a97a2-163">nonce</span></span> |<span data-ttu-id="a97a2-164">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-164">Required</span></span> |<span data-ttu-id="a97a2-165">Значение, включенных в запрос hello (созданных в ходе приложение hello), будут включены в результирующий маркер идентификатор hello как утверждения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-165">A value included in hello request (generated by hello app) that will be included in hello resulting ID token as a claim.</span></span> <span data-ttu-id="a97a2-166">приложение Hello можно затем удостоверьтесь, что атак воспроизведения токена значение toomitigate.</span><span class="sxs-lookup"><span data-stu-id="a97a2-166">hello app can then verify this value toomitigate token replay attacks.</span></span> <span data-ttu-id="a97a2-167">Hello значение обычно равно случайного уникальную строку, которая может быть используется tooidentify hello источник запроса hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-167">hello value is typically a randomized unique string that can be used tooidentify hello origin of hello request.</span></span> |
| <span data-ttu-id="a97a2-168">p</span><span class="sxs-lookup"><span data-stu-id="a97a2-168">p</span></span> |<span data-ttu-id="a97a2-169">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-169">Required</span></span> |<span data-ttu-id="a97a2-170">политика Hello, который будет выполняться.</span><span class="sxs-lookup"><span data-stu-id="a97a2-170">hello policy that will be executed.</span></span> <span data-ttu-id="a97a2-171">Это имя политики, созданные в клиенте B2C hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-171">It is hello name of a policy that is created in your B2C tenant.</span></span> <span data-ttu-id="a97a2-172">Имя политики Hello значение должна начинаться с `b2c\_1\_`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-172">hello policy name value should begin with `b2c\_1\_`.</span></span> <span data-ttu-id="a97a2-173">Дополнительные сведения о политиках и hello [расширяемая инфраструктура политик](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="a97a2-173">Learn more about policies and hello [extensible policy framework](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="a97a2-174">prompt</span><span class="sxs-lookup"><span data-stu-id="a97a2-174">prompt</span></span> |<span data-ttu-id="a97a2-175">Необязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-175">Optional</span></span> |<span data-ttu-id="a97a2-176">Тип Hello это требует взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="a97a2-176">hello type of user interaction that is required.</span></span> <span data-ttu-id="a97a2-177">Hello единственным допустимым значением в данный момент является `login`, который принудительно hello пользователя tooenter свои учетные данные для этого запроса.</span><span class="sxs-lookup"><span data-stu-id="a97a2-177">hello only valid value at this time is `login`, which forces hello user tooenter their credentials on that request.</span></span> <span data-ttu-id="a97a2-178">Единый вход не сработает.</span><span class="sxs-lookup"><span data-stu-id="a97a2-178">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="a97a2-179">На этом этапе hello пользователя запрашивается toocomplete hello политики рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="a97a2-179">At this point, hello user is asked toocomplete hello policy's workflow.</span></span> <span data-ttu-id="a97a2-180">Это может вызвать hello пользователь вводит свое имя пользователя и пароль, вход удостоверений из социальных сетей, регистрирующихся для каталога hello или любое другое число шагов в зависимости от способа определения политики hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-180">This might involve hello user entering their username and password, signing in with a social identity, signing up for hello directory, or any other number of steps, depending on how hello policy is defined.</span></span>

<span data-ttu-id="a97a2-181">После завершения политики hello hello пользователя Azure AD возвращает приложении tooyour ответ в указанном hello `redirect_uri` параметра с помощью метода hello, которая указана в hello `response_mode` параметра.</span><span class="sxs-lookup"><span data-stu-id="a97a2-181">After hello user completes hello policy, Azure AD returns a response tooyour app at hello indicated `redirect_uri` parameter, by using hello method that is specified in hello `response_mode` parameter.</span></span> <span data-ttu-id="a97a2-182">для каждого из предыдущих случаев, независимо от политики hello, который выполняется hello hello же Hello ответа.</span><span class="sxs-lookup"><span data-stu-id="a97a2-182">hello response is hello same for each of hello preceding cases, independent of hello policy that is executed.</span></span>

<span data-ttu-id="a97a2-183">Успешный ответ с использованием метода `response_mode=fragment` выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a97a2-183">A successful response using `response_mode=fragment` would look like:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="a97a2-184">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-184">Parameter</span></span> | <span data-ttu-id="a97a2-185">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-185">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a97a2-186">id_token</span><span class="sxs-lookup"><span data-stu-id="a97a2-186">id_token</span></span> |<span data-ttu-id="a97a2-187">Здравствуйте, маркер идентификатора, hello запрошенного приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-187">hello ID token that hello app requested.</span></span> <span data-ttu-id="a97a2-188">Можно использовать удостоверение маркера tooverify hello hello идентификатор пользователя и начать сеанс с пользователем hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-188">You can use hello ID token tooverify hello user's identity and begin a session with hello user.</span></span> <span data-ttu-id="a97a2-189">Дополнительные сведения о маркеров безопасности и их содержимое включаются в hello [ссылку маркера Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="a97a2-189">More details on ID tokens and their contents are included in hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |
| <span data-ttu-id="a97a2-190">Код</span><span class="sxs-lookup"><span data-stu-id="a97a2-190">code</span></span> |<span data-ttu-id="a97a2-191">Hello код авторизации, приложение hello запрошена, если вы использовали `response_type=code+id_token`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-191">hello authorization code that hello app requested, if you used `response_type=code+id_token`.</span></span> <span data-ttu-id="a97a2-192">приложение Hello можно использовать toorequest код авторизации hello маркер доступа для целевого ресурса.</span><span class="sxs-lookup"><span data-stu-id="a97a2-192">hello app can use hello authorization code toorequest an access token for a target resource.</span></span> <span data-ttu-id="a97a2-193">Срок действия кодов авторизации крайне мал.</span><span class="sxs-lookup"><span data-stu-id="a97a2-193">Authorization codes are very short-lived.</span></span> <span data-ttu-id="a97a2-194">и обычно истекает по прошествии порядка 10 минут.</span><span class="sxs-lookup"><span data-stu-id="a97a2-194">Typically, they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="a97a2-195">state</span><span class="sxs-lookup"><span data-stu-id="a97a2-195">state</span></span> |<span data-ttu-id="a97a2-196">Если `state` параметр включен в запрос hello hello же значение должно содержаться в ответе hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-196">If a `state` parameter is included in hello request, hello same value should appear in hello response.</span></span> <span data-ttu-id="a97a2-197">Hello приложения следует убедиться, что hello `state` значения в hello запроса и ответа идентичны.</span><span class="sxs-lookup"><span data-stu-id="a97a2-197">hello app should verify that hello `state` values in hello request and response are identical.</span></span> |

<span data-ttu-id="a97a2-198">Сообщения об ошибках могут отправляться также toohello `redirect_uri` параметра, так что приложение hello можно обрабатывать их соответствующим образом:</span><span class="sxs-lookup"><span data-stu-id="a97a2-198">Error responses can also be sent toohello `redirect_uri` parameter so that hello app can handle them appropriately:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=access_denied
&error_description=the+user+canceled+the+authentication
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="a97a2-199">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-199">Parameter</span></span> | <span data-ttu-id="a97a2-200">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a97a2-201">error</span><span class="sxs-lookup"><span data-stu-id="a97a2-201">error</span></span> |<span data-ttu-id="a97a2-202">Строка кода ошибки, может быть используется tooclassify типы ошибок, происходящих и это может стать tooerrors tooreact используется.</span><span class="sxs-lookup"><span data-stu-id="a97a2-202">An error-code string that can be used tooclassify types of errors that occur and that can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="a97a2-203">error_description</span><span class="sxs-lookup"><span data-stu-id="a97a2-203">error_description</span></span> |<span data-ttu-id="a97a2-204">Сообщение об ошибке, которые могут помочь определить причину ошибки проверки подлинности hello разработчик.</span><span class="sxs-lookup"><span data-stu-id="a97a2-204">A specific error message that can help a developer identify hello root cause of an authentication error.</span></span> |
| <span data-ttu-id="a97a2-205">state</span><span class="sxs-lookup"><span data-stu-id="a97a2-205">state</span></span> |<span data-ttu-id="a97a2-206">См. полное описание hello в первой таблице hello в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="a97a2-206">See hello full description in hello first table in this section.</span></span> <span data-ttu-id="a97a2-207">Если `state` параметр включен в запрос hello hello же значение должно содержаться в ответе hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-207">If a `state` parameter is included in hello request, hello same value should appear in hello response.</span></span> <span data-ttu-id="a97a2-208">Hello приложения следует убедиться, что hello `state` значения в hello запроса и ответа идентичны.</span><span class="sxs-lookup"><span data-stu-id="a97a2-208">hello app should verify that hello `state` values in hello request and response are identical.</span></span> |

## <a name="validate-hello-id-token"></a><span data-ttu-id="a97a2-209">Проверка токена идентификатор hello</span><span class="sxs-lookup"><span data-stu-id="a97a2-209">Validate hello ID token</span></span>
<span data-ttu-id="a97a2-210">Просто получает маркер идентификатора не хватает tooauthenticate hello пользователем.</span><span class="sxs-lookup"><span data-stu-id="a97a2-210">Just receiving an ID token is not enough tooauthenticate hello user.</span></span> <span data-ttu-id="a97a2-211">Необходимо проверить подпись маркер идентификатора hello и hello утверждения маркера hello в соответствии с требованиями приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-211">You must validate hello ID token's signature and verify hello claims in hello token per your app's requirements.</span></span> <span data-ttu-id="a97a2-212">Использует Azure AD B2C [веб-маркеры JSON (JWT)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) и открытый ключ шифрования toosign маркеры и убедитесь, что они являются допустимыми.</span><span class="sxs-lookup"><span data-stu-id="a97a2-212">Azure AD B2C uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography toosign tokens and verify that they are valid.</span></span>

<span data-ttu-id="a97a2-213">Для проверки JWT доступны многие библиотеки с открытым исходным кодом в зависимости от выбранного языка программирования.</span><span class="sxs-lookup"><span data-stu-id="a97a2-213">There are many open-source libraries that are available for validating JWTs, depending on your language of preference.</span></span> <span data-ttu-id="a97a2-214">Мы рекомендуем изучить различные библиотеки, а не реализовывать логику проверки самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="a97a2-214">We recommend exploring those options rather than implementing your own validation logic.</span></span> <span data-ttu-id="a97a2-215">здесь сведения Hello будет полезно понять, как tooproperly использование этих библиотек.</span><span class="sxs-lookup"><span data-stu-id="a97a2-215">hello information here will be useful in figuring out how tooproperly use those libraries.</span></span>

<span data-ttu-id="a97a2-216">Azure AD B2C имеет OpenID Connect конечную точку метаданных, что позволяет toofetch приложение сведения о Azure AD B2C во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-216">Azure AD B2C has an OpenID Connect metadata endpoint, which allows an app toofetch information about Azure AD B2C at runtime.</span></span> <span data-ttu-id="a97a2-217">Эти сведения включают конечные точки, содержимое маркеров и ключи подписи маркеров.</span><span class="sxs-lookup"><span data-stu-id="a97a2-217">This information includes endpoints, token contents, and token signing keys.</span></span> <span data-ttu-id="a97a2-218">Для каждой политики в клиенте B2C есть собственный документ метаданных JSON.</span><span class="sxs-lookup"><span data-stu-id="a97a2-218">There is a JSON metadata document for each policy in your B2C tenant.</span></span> <span data-ttu-id="a97a2-219">Например, документ hello метаданных для hello `b2c_1_sign_in` политики в `fabrikamb2c.onmicrosoft.com` находится в:</span><span class="sxs-lookup"><span data-stu-id="a97a2-219">For example, hello metadata document for hello `b2c_1_sign_in` policy in `fabrikamb2c.onmicrosoft.com` is located at:</span></span>

`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=b2c_1_sign_in`

<span data-ttu-id="a97a2-220">Одно из свойств hello этого документа конфигурации является `jwks_uri`, значение которого для hello бы одной политике:</span><span class="sxs-lookup"><span data-stu-id="a97a2-220">One of hello properties of this configuration document is `jwks_uri`, whose value for hello same policy would be:</span></span>

<span data-ttu-id="a97a2-221">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-221">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span></span>

<span data-ttu-id="a97a2-222">toodetermine политики, был использован в подписи маркер идентификатора (и, из которой toofetch hello метаданных), у вас есть два варианта.</span><span class="sxs-lookup"><span data-stu-id="a97a2-222">toodetermine which policy was used in signing an ID token (and from where toofetch hello metadata), you have two options.</span></span> <span data-ttu-id="a97a2-223">Во-первых, имя политики hello включается в hello `acr` утверждения в маркер идентификатора hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-223">First, hello policy name is included in hello `acr` claim in hello ID token.</span></span> <span data-ttu-id="a97a2-224">Сведения о как tooparse hello утверждений от маркер идентификатора разделе hello [ссылку маркера Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="a97a2-224">For information on how tooparse hello claims from an ID token, see hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="a97a2-225">Другой вариант — tooencode политики hello в значение hello hello `state` параметра при выдать запрос hello и расшифровать его toodetermine использовался какую политику.</span><span class="sxs-lookup"><span data-stu-id="a97a2-225">Your other option is tooencode hello policy in hello value of hello `state` parameter when you issue hello request, and then decode it toodetermine which policy was used.</span></span> <span data-ttu-id="a97a2-226">Каждый из этих методов является допустимым.</span><span class="sxs-lookup"><span data-stu-id="a97a2-226">Either method is valid.</span></span>

<span data-ttu-id="a97a2-227">После приобретен hello документов метаданных из конечной точки метаданных OpenID Connect hello открытые ключи RSA 256 hello (которые находятся в данной конечной точке) можно использовать подпись hello toovalidate hello идентификатор токена.</span><span class="sxs-lookup"><span data-stu-id="a97a2-227">After you've acquired hello metadata document from hello OpenID Connect metadata endpoint, you can use hello RSA 256 public keys (which are located at this endpoint) toovalidate hello signature of hello ID token.</span></span> <span data-ttu-id="a97a2-228">В каждый момент времени в этой конечной точке может находиться множество ключей, каждый из которых определяется утверждением `kid`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-228">There might be multiple keys listed at this endpoint at any given point in time, each identified by a `kid` claim.</span></span> <span data-ttu-id="a97a2-229">Hello заголовок маркер идентификатора hello также содержит `kid` утверждения, которое указывает, какой из этих ключей был маркер идентификатора используется toosign hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-229">hello header of hello ID token also contains a `kid` claim, which indicates which of these keys was used toosign hello ID token.</span></span> <span data-ttu-id="a97a2-230">Дополнительные сведения см. в разделе hello [ссылку маркера Azure AD B2C](active-directory-b2c-reference-tokens.md) (hello раздел на [проверку маркеров](active-directory-b2c-reference-tokens.md#token-validation), в частности).</span><span class="sxs-lookup"><span data-stu-id="a97a2-230">For more information, see hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md) (hello section on [validating tokens](active-directory-b2c-reference-tokens.md#token-validation), in particular).</span></span>
<!--TODO: Improve hello information on this-->

<span data-ttu-id="a97a2-231">Существует несколько утверждений, необходимо tooverify после проверки предоставленных hello подпись токена идентификатор hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-231">After you've validated hello signature of hello ID token, there are several claims that you need tooverify.</span></span> <span data-ttu-id="a97a2-232">например</span><span class="sxs-lookup"><span data-stu-id="a97a2-232">For instance:</span></span>

* <span data-ttu-id="a97a2-233">Следует проверить hello `nonce` утверждения tooprevent атак с повторением токенов.</span><span class="sxs-lookup"><span data-stu-id="a97a2-233">You should validate hello `nonce` claim tooprevent token replay attacks.</span></span> <span data-ttu-id="a97a2-234">Его значение должно быть указанный запрос hello вход.</span><span class="sxs-lookup"><span data-stu-id="a97a2-234">Its value should be what you specified in hello sign-in request.</span></span>
* <span data-ttu-id="a97a2-235">Следует проверить hello `aud` утверждения, hello маркер идентификатора tooensure был выпущен для приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-235">You should validate hello `aud` claim tooensure that hello ID token was issued for your app.</span></span> <span data-ttu-id="a97a2-236">Его значение должно быть Идентификатором приложения hello приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-236">Its value should be hello application ID of your app.</span></span>
* <span data-ttu-id="a97a2-237">Следует проверить hello `iat` и `exp` утверждений tooensure, hello маркер идентификатора не истек.</span><span class="sxs-lookup"><span data-stu-id="a97a2-237">You should validate hello `iat` and `exp` claims tooensure that hello ID token has not expired.</span></span>

<span data-ttu-id="a97a2-238">Также существуют некоторые дополнительные проверки, которые необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="a97a2-238">There are also several more validations that you should perform.</span></span> <span data-ttu-id="a97a2-239">Они описаны подробно hello [OpenID подключения Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).  Можно также toovalidate дополнительные утверждения, в зависимости от вашего сценария.</span><span class="sxs-lookup"><span data-stu-id="a97a2-239">These are described in detail in hello [OpenID Connect Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).  You might also want toovalidate additional claims, depending on your scenario.</span></span> <span data-ttu-id="a97a2-240">Ниже приведены некоторые из стандартных проверок:</span><span class="sxs-lookup"><span data-stu-id="a97a2-240">Some common validations include:</span></span>

* <span data-ttu-id="a97a2-241">Убедитесь, что Здравствуйте, пользователя или организации, зарегистрировался для приложения hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-241">Ensuring that hello user/organization has signed up for hello app.</span></span>
* <span data-ttu-id="a97a2-242">Обеспечение авторизации и права, необходимые этому пользователю hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-242">Ensuring that hello user has proper authorization/privileges.</span></span>
* <span data-ttu-id="a97a2-243">Обеспечение определенного уровня проверки подлинности, например многофакторной проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="a97a2-243">Ensuring that a certain strength of authentication has occurred, such as Azure Multi-Factor Authentication.</span></span>

<span data-ttu-id="a97a2-244">Дополнительные сведения о hello утверждения в маркер идентификатора см. в разделе hello [ссылку маркера Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="a97a2-244">For more information on hello claims in an ID token, see hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span>

<span data-ttu-id="a97a2-245">После проверки маркер идентификатора hello можно начать сеанс с пользователем hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-245">After you have validated hello ID token, you can begin a session with hello user.</span></span> <span data-ttu-id="a97a2-246">Можно использовать утверждения hello в hello идентификатор маркера tooobtain сведения о пользователе hello в вашем приложении.</span><span class="sxs-lookup"><span data-stu-id="a97a2-246">You can use hello claims in hello ID token tooobtain information about hello user in your app.</span></span> <span data-ttu-id="a97a2-247">Эти сведения используются для отображения, получения записей и проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="a97a2-247">Uses for this information include display, records, and authorization.</span></span>

## <a name="get-a-token"></a><span data-ttu-id="a97a2-248">Получение маркера</span><span class="sxs-lookup"><span data-stu-id="a97a2-248">Get a token</span></span>
<span data-ttu-id="a97a2-249">При необходимости вашей tooonly web app выполнение политик, можно пропустить hello следующие несколько разделов.</span><span class="sxs-lookup"><span data-stu-id="a97a2-249">If you need your web app tooonly execute policies, you can skip hello next few sections.</span></span> <span data-ttu-id="a97a2-250">Эти разделы — это применимо только tooweb приложения, которым требуется проверка подлинности toomake вызовы tooa веб-API и также защищен Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="a97a2-250">These sections are applicable only tooweb apps that need toomake authenticated calls tooa web API and are also protected by Azure AD B2C.</span></span>

<span data-ttu-id="a97a2-251">Можно использовать код авторизации hello, который вы приобрели (с помощью `response_type=code+id_token`) для токена toohello требуемого ресурса, отправляя `POST` запроса toohello `/token` конечной точки.</span><span class="sxs-lookup"><span data-stu-id="a97a2-251">You can redeem hello authorization code that you acquired (by using `response_type=code+id_token`) for a token toohello desired resource by sending a `POST` request toohello `/token` endpoint.</span></span> <span data-ttu-id="a97a2-252">В настоящее время hello только ресурсов, можно запросить маркер является серверной части приложения собственных веб-API.</span><span class="sxs-lookup"><span data-stu-id="a97a2-252">Currently, hello only resource that you can request a token for is your app's own back-end web API.</span></span> <span data-ttu-id="a97a2-253">соглашение о Hello для запроса маркера tooyourself — это идентификатор клиента приложения hello областью toouse:</span><span class="sxs-lookup"><span data-stu-id="a97a2-253">hello convention for requesting a token tooyourself is toouse your app's client ID as hello scope:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob&client_secret=<your-application-secret>

```

| <span data-ttu-id="a97a2-254">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-254">Parameter</span></span> | <span data-ttu-id="a97a2-255">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="a97a2-255">Required?</span></span> | <span data-ttu-id="a97a2-256">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-256">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a97a2-257">p</span><span class="sxs-lookup"><span data-stu-id="a97a2-257">p</span></span> |<span data-ttu-id="a97a2-258">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-258">Required</span></span> |<span data-ttu-id="a97a2-259">Здравствуйте, политики, которая была используется tooacquire hello авторизации кода.</span><span class="sxs-lookup"><span data-stu-id="a97a2-259">hello policy that was used tooacquire hello authorization code.</span></span> <span data-ttu-id="a97a2-260">Другую политику в этом запросе использовать нельзя.</span><span class="sxs-lookup"><span data-stu-id="a97a2-260">You cannot use a different policy in this request.</span></span> <span data-ttu-id="a97a2-261">Примечание При добавлении этого параметра строки запроса toohello, не toohello `POST` текста.</span><span class="sxs-lookup"><span data-stu-id="a97a2-261">Note that you add this parameter toohello query string, not toohello `POST` body.</span></span> |
| <span data-ttu-id="a97a2-262">client_id</span><span class="sxs-lookup"><span data-stu-id="a97a2-262">client_id</span></span> |<span data-ttu-id="a97a2-263">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-263">Required</span></span> |<span data-ttu-id="a97a2-264">Hello приложение с кодом, hello [портал Azure](https://portal.azure.com/) назначенный tooyour приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-264">hello application ID that hello [Azure portal](https://portal.azure.com/) assigned tooyour app.</span></span> |
| <span data-ttu-id="a97a2-265">grant_type</span><span class="sxs-lookup"><span data-stu-id="a97a2-265">grant_type</span></span> |<span data-ttu-id="a97a2-266">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-266">Required</span></span> |<span data-ttu-id="a97a2-267">Здравствуйте, тип используемого предоставления прав, который должен быть `authorization_code` для потока кода авторизации hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-267">hello type of grant, which must be `authorization_code` for hello authorization code flow.</span></span> |
| <span data-ttu-id="a97a2-268">scope</span><span class="sxs-lookup"><span data-stu-id="a97a2-268">scope</span></span> |<span data-ttu-id="a97a2-269">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-269">Recommended</span></span> |<span data-ttu-id="a97a2-270">Список областей с разделителями-пробелами.</span><span class="sxs-lookup"><span data-stu-id="a97a2-270">A space-separated list of scopes.</span></span> <span data-ttu-id="a97a2-271">Значение одной области указывает tooAzure AD оба разрешения, которые были запрошены.</span><span class="sxs-lookup"><span data-stu-id="a97a2-271">A single scope value indicates tooAzure AD both permissions that are being requested.</span></span> <span data-ttu-id="a97a2-272">Hello `openid` область указывает toosign разрешение в hello пользователей и получения данных о пользователе hello в виде hello id_token параметров.</span><span class="sxs-lookup"><span data-stu-id="a97a2-272">hello `openid` scope indicates a permission toosign in hello user and get data about hello user in hello form of id_token parameters.</span></span> <span data-ttu-id="a97a2-273">Это может быть используется tooget маркеры tooyour приложении серверной части веб-API, который представляется hello таким же Идентификатором приложения hello клиентом.</span><span class="sxs-lookup"><span data-stu-id="a97a2-273">It can be used tooget tokens tooyour app's own back-end web API, which is represented by hello same application ID as hello client.</span></span> <span data-ttu-id="a97a2-274">Hello `offline_access` область показывает, что вашему приложению потребуется токен обновления для tooresources долгоживущие доступа.</span><span class="sxs-lookup"><span data-stu-id="a97a2-274">hello `offline_access` scope indicates that your app will need a refresh token for long-lived access tooresources.</span></span> |
| <span data-ttu-id="a97a2-275">Код</span><span class="sxs-lookup"><span data-stu-id="a97a2-275">code</span></span> |<span data-ttu-id="a97a2-276">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-276">Required</span></span> |<span data-ttu-id="a97a2-277">Код авторизации Hello, полученному в первый участок потока hello hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-277">hello authorization code that you acquired in hello first leg of hello flow.</span></span> |
| <span data-ttu-id="a97a2-278">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="a97a2-278">redirect_uri</span></span> |<span data-ttu-id="a97a2-279">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-279">Required</span></span> |<span data-ttu-id="a97a2-280">Hello `redirect_uri` параметр приложения hello, которого вы получили код авторизации hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-280">hello `redirect_uri` parameter of hello application where you received hello authorization code.</span></span> |
| <span data-ttu-id="a97a2-281">client_secret</span><span class="sxs-lookup"><span data-stu-id="a97a2-281">client_secret</span></span> |<span data-ttu-id="a97a2-282">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-282">Required</span></span> |<span data-ttu-id="a97a2-283">секрет приложения Hello, созданный hello [портал Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="a97a2-283">hello application secret that you generated in hello [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="a97a2-284">Это важный артефакт безопасности,</span><span class="sxs-lookup"><span data-stu-id="a97a2-284">This application secret is an important security artifact.</span></span> <span data-ttu-id="a97a2-285">и он должен безопасно храниться на сервере.</span><span class="sxs-lookup"><span data-stu-id="a97a2-285">You should store it securely on your server.</span></span> <span data-ttu-id="a97a2-286">Также следует периодически изменять секрет клиента.</span><span class="sxs-lookup"><span data-stu-id="a97a2-286">You should also rotate this client secret on a periodic basis.</span></span> |

<span data-ttu-id="a97a2-287">Успешный ответ маркера выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a97a2-287">A successful token response looks like:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="a97a2-288">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-288">Parameter</span></span> | <span data-ttu-id="a97a2-289">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-289">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a97a2-290">not_before</span><span class="sxs-lookup"><span data-stu-id="a97a2-290">not_before</span></span> |<span data-ttu-id="a97a2-291">время Hello, на какие hello считается действительным, во время эпохи маркер.</span><span class="sxs-lookup"><span data-stu-id="a97a2-291">hello time at which hello token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="a97a2-292">token_type</span><span class="sxs-lookup"><span data-stu-id="a97a2-292">token_type</span></span> |<span data-ttu-id="a97a2-293">значение типа токена Hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-293">hello token type value.</span></span> <span data-ttu-id="a97a2-294">Здравствуйте, только тип, который поддерживает Azure AD является `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-294">hello only type that Azure AD supports is `Bearer`.</span></span> |
| <span data-ttu-id="a97a2-295">access_token</span><span class="sxs-lookup"><span data-stu-id="a97a2-295">access_token</span></span> |<span data-ttu-id="a97a2-296">Hello подписан маркер JWT по запросу.</span><span class="sxs-lookup"><span data-stu-id="a97a2-296">hello signed JWT token that you requested.</span></span> |
| <span data-ttu-id="a97a2-297">scope</span><span class="sxs-lookup"><span data-stu-id="a97a2-297">scope</span></span> |<span data-ttu-id="a97a2-298">для какой hello маркер действителен в областях Hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-298">hello scopes for which hello token is valid.</span></span> <span data-ttu-id="a97a2-299">Их можно использовать для кэширования маркеров для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="a97a2-299">These can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="a97a2-300">expires_in</span><span class="sxs-lookup"><span data-stu-id="a97a2-300">expires_in</span></span> |<span data-ttu-id="a97a2-301">Hello продолжительность hello токен доступа является допустимым (в секундах).</span><span class="sxs-lookup"><span data-stu-id="a97a2-301">hello length of time that hello access token is valid (in seconds).</span></span> |
| <span data-ttu-id="a97a2-302">refresh_token</span><span class="sxs-lookup"><span data-stu-id="a97a2-302">refresh_token</span></span> |<span data-ttu-id="a97a2-303">Маркер обновления OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="a97a2-303">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="a97a2-304">приложение Hello можно использовать этот токен tooacquire дополнительные маркеры, после истечения срока действия текущего маркера hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-304">hello app can use this token tooacquire additional tokens after hello current token expires.</span></span> <span data-ttu-id="a97a2-305">Обновить токены долгоживущие и может быть tooresources доступа используется tooretain на длительное время.</span><span class="sxs-lookup"><span data-stu-id="a97a2-305">Refresh tokens are long-lived and can be used tooretain access tooresources for extended periods of time.</span></span> <span data-ttu-id="a97a2-306">Дополнительные сведения см. в разделе toohello [ссылку на маркер B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="a97a2-306">For more details, refer toohello [B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="a97a2-307">Обратите внимание, вы должны использовали hello области `offline_access` в hello авторизации и маркер запросов в порядке tooreceive токен обновления.</span><span class="sxs-lookup"><span data-stu-id="a97a2-307">Note that you must have used hello scope `offline_access` in both hello authorization and token requests in order tooreceive a refresh token.</span></span> |

<span data-ttu-id="a97a2-308">Сообщения об ошибках выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a97a2-308">Error responses look like:</span></span>

```
{
    "error": "access_denied",
    "error_description": "hello user revoked access toohello app.",
}
```

| <span data-ttu-id="a97a2-309">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-309">Parameter</span></span> | <span data-ttu-id="a97a2-310">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-310">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a97a2-311">error</span><span class="sxs-lookup"><span data-stu-id="a97a2-311">error</span></span> |<span data-ttu-id="a97a2-312">Строка кода ошибки, может быть используется tooclassify типы ошибок, происходящих и это может стать tooerrors tooreact используется.</span><span class="sxs-lookup"><span data-stu-id="a97a2-312">An error-code string that can be used tooclassify types of errors that occur and that can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="a97a2-313">error_description</span><span class="sxs-lookup"><span data-stu-id="a97a2-313">error_description</span></span> |<span data-ttu-id="a97a2-314">Сообщение об ошибке, которые могут помочь определить причину ошибки проверки подлинности hello разработчик.</span><span class="sxs-lookup"><span data-stu-id="a97a2-314">A specific error message that can help a developer identify hello root cause of an authentication error.</span></span> |

## <a name="use-hello-token"></a><span data-ttu-id="a97a2-315">Использование маркера hello</span><span class="sxs-lookup"><span data-stu-id="a97a2-315">Use hello token</span></span>
<span data-ttu-id="a97a2-316">Теперь, когда вы успешно получили маркер доступа, можно использовать токен hello в запросы tooyour серверной части веб-API, включив его в hello `Authorization` заголовка:</span><span class="sxs-lookup"><span data-stu-id="a97a2-316">Now that you've successfully acquired an access token, you can use hello token in requests tooyour back-end web APIs by including it in hello `Authorization` header:</span></span>

```
GET /tasks
Host: https://mytaskwebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
```

## <a name="refresh-hello-token"></a><span data-ttu-id="a97a2-317">Обновление маркера hello</span><span class="sxs-lookup"><span data-stu-id="a97a2-317">Refresh hello token</span></span>
<span data-ttu-id="a97a2-318">Срок действия маркеров идентификации крайне мал.</span><span class="sxs-lookup"><span data-stu-id="a97a2-318">ID tokens are short-lived.</span></span> <span data-ttu-id="a97a2-319">Их необходимо обновить, после истечения срока их действия, ресурсы могут tooaccess toocontinue.</span><span class="sxs-lookup"><span data-stu-id="a97a2-319">You must refresh them after they expire toocontinue being able tooaccess resources.</span></span> <span data-ttu-id="a97a2-320">Это можно сделать путем отправки другой `POST` запроса toohello `/token` конечной точки.</span><span class="sxs-lookup"><span data-stu-id="a97a2-320">You can do so by submitting another `POST` request toohello `/token` endpoint.</span></span> <span data-ttu-id="a97a2-321">На этот раз укажите hello `refresh_token` параметра вместо hello `code` параметр:</span><span class="sxs-lookup"><span data-stu-id="a97a2-321">This time, provide hello `refresh_token` parameter instead of hello `code` parameter:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=openid offline_access&refresh_token=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob&client_secret=<your-application-secret>
```

| <span data-ttu-id="a97a2-322">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-322">Parameter</span></span> | <span data-ttu-id="a97a2-323">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-323">Required</span></span> | <span data-ttu-id="a97a2-324">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-324">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a97a2-325">p</span><span class="sxs-lookup"><span data-stu-id="a97a2-325">p</span></span> |<span data-ttu-id="a97a2-326">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-326">Required</span></span> |<span data-ttu-id="a97a2-327">политика Hello, исходный токен обновления используется tooacquire hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-327">hello policy that was used tooacquire hello original refresh token.</span></span> <span data-ttu-id="a97a2-328">Другую политику в этом запросе использовать нельзя.</span><span class="sxs-lookup"><span data-stu-id="a97a2-328">You cannot use a different policy in this request.</span></span> <span data-ttu-id="a97a2-329">Обратите внимание, добавить этот параметр строки запроса toohello, toohello тело POST.</span><span class="sxs-lookup"><span data-stu-id="a97a2-329">Note that you add this parameter toohello query string, not toohello POST body.</span></span> |
| <span data-ttu-id="a97a2-330">client_id</span><span class="sxs-lookup"><span data-stu-id="a97a2-330">client_id</span></span> |<span data-ttu-id="a97a2-331">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-331">Required</span></span> |<span data-ttu-id="a97a2-332">Hello приложение с кодом, hello [портал Azure](https://portal.azure.com/) назначенный tooyour приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-332">hello application ID that hello [Azure portal](https://portal.azure.com/) assigned tooyour app.</span></span> |
| <span data-ttu-id="a97a2-333">grant_type</span><span class="sxs-lookup"><span data-stu-id="a97a2-333">grant_type</span></span> |<span data-ttu-id="a97a2-334">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-334">Required</span></span> |<span data-ttu-id="a97a2-335">Тип инструкции grant, который должен быть токен обновления для этого участка поток authorization code hello Hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-335">hello type of grant, which must be a refresh token for this leg of hello authorization code flow.</span></span> |
| <span data-ttu-id="a97a2-336">scope</span><span class="sxs-lookup"><span data-stu-id="a97a2-336">scope</span></span> |<span data-ttu-id="a97a2-337">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-337">Recommended</span></span> |<span data-ttu-id="a97a2-338">Список областей с разделителями-пробелами.</span><span class="sxs-lookup"><span data-stu-id="a97a2-338">A space-separated list of scopes.</span></span> <span data-ttu-id="a97a2-339">Значение одной области указывает tooAzure AD оба разрешения, которые были запрошены.</span><span class="sxs-lookup"><span data-stu-id="a97a2-339">A single scope value indicates tooAzure AD both permissions that are being requested.</span></span> <span data-ttu-id="a97a2-340">Hello `openid` область указывает toosign разрешение в hello пользователей и получения данных о пользователе hello в форме hello маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="a97a2-340">hello `openid` scope indicates a permission toosign in hello user and get data about hello user in hello form of ID tokens.</span></span> <span data-ttu-id="a97a2-341">Это может быть используется tooget маркеры tooyour приложении серверной части веб-API, который представляется hello таким же Идентификатором приложения hello клиентом.</span><span class="sxs-lookup"><span data-stu-id="a97a2-341">It can be used tooget tokens tooyour app's own back-end web API, which is represented by hello same application ID as hello client.</span></span> <span data-ttu-id="a97a2-342">Hello `offline_access` область показывает, что вашему приложению потребуется токен обновления для tooresources долгоживущие доступа.</span><span class="sxs-lookup"><span data-stu-id="a97a2-342">hello `offline_access` scope indicates that your app will need a refresh token for long-lived access tooresources.</span></span> |
| <span data-ttu-id="a97a2-343">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="a97a2-343">redirect_uri</span></span> |<span data-ttu-id="a97a2-344">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-344">Recommended</span></span> |<span data-ttu-id="a97a2-345">Hello `redirect_uri` параметр приложения hello, которого вы получили код авторизации hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-345">hello `redirect_uri` parameter of hello application where you received hello authorization code.</span></span> |
| <span data-ttu-id="a97a2-346">refresh_token</span><span class="sxs-lookup"><span data-stu-id="a97a2-346">refresh_token</span></span> |<span data-ttu-id="a97a2-347">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-347">Required</span></span> |<span data-ttu-id="a97a2-348">Hello исходный токен обновления, полученному в hello второго участка hello потока.</span><span class="sxs-lookup"><span data-stu-id="a97a2-348">hello original refresh token that you acquired in hello second leg of hello flow.</span></span> <span data-ttu-id="a97a2-349">Обратите внимание, вы должны использовали hello области `offline_access` в hello авторизации и маркер запросов в порядке tooreceive токен обновления.</span><span class="sxs-lookup"><span data-stu-id="a97a2-349">Note that you must have used hello scope `offline_access` in both hello authorization and token requests in order tooreceive a refresh token.</span></span> |
| <span data-ttu-id="a97a2-350">client_secret</span><span class="sxs-lookup"><span data-stu-id="a97a2-350">client_secret</span></span> |<span data-ttu-id="a97a2-351">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-351">Required</span></span> |<span data-ttu-id="a97a2-352">секрет приложения Hello, созданный hello [портал Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="a97a2-352">hello application secret that you generated in hello [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="a97a2-353">Это важный артефакт безопасности,</span><span class="sxs-lookup"><span data-stu-id="a97a2-353">This application secret is an important security artifact.</span></span> <span data-ttu-id="a97a2-354">и он должен безопасно храниться на сервере.</span><span class="sxs-lookup"><span data-stu-id="a97a2-354">You should store it securely on your server.</span></span> <span data-ttu-id="a97a2-355">Также следует периодически изменять секрет клиента.</span><span class="sxs-lookup"><span data-stu-id="a97a2-355">You should also rotate this client secret on a periodic basis.</span></span> |

<span data-ttu-id="a97a2-356">Успешный ответ маркера выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a97a2-356">A successful token response looks like:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="a97a2-357">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-357">Parameter</span></span> | <span data-ttu-id="a97a2-358">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-358">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a97a2-359">not_before</span><span class="sxs-lookup"><span data-stu-id="a97a2-359">not_before</span></span> |<span data-ttu-id="a97a2-360">время Hello, на какие hello считается действительным, во время эпохи маркер.</span><span class="sxs-lookup"><span data-stu-id="a97a2-360">hello time at which hello token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="a97a2-361">token_type</span><span class="sxs-lookup"><span data-stu-id="a97a2-361">token_type</span></span> |<span data-ttu-id="a97a2-362">значение типа токена Hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-362">hello token type value.</span></span> <span data-ttu-id="a97a2-363">Здравствуйте, только тип, который поддерживает Azure AD является `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="a97a2-363">hello only type that Azure AD supports is `Bearer`.</span></span> |
| <span data-ttu-id="a97a2-364">access_token</span><span class="sxs-lookup"><span data-stu-id="a97a2-364">access_token</span></span> |<span data-ttu-id="a97a2-365">Hello подписан маркер JWT по запросу.</span><span class="sxs-lookup"><span data-stu-id="a97a2-365">hello signed JWT token that you requested.</span></span> |
| <span data-ttu-id="a97a2-366">scope</span><span class="sxs-lookup"><span data-stu-id="a97a2-366">scope</span></span> |<span data-ttu-id="a97a2-367">область Hello, hello токена является допустимым для, который может использоваться для кэширования токенов для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="a97a2-367">hello scope that hello token is valid for, which can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="a97a2-368">expires_in</span><span class="sxs-lookup"><span data-stu-id="a97a2-368">expires_in</span></span> |<span data-ttu-id="a97a2-369">Hello продолжительность hello токен доступа является допустимым (в секундах).</span><span class="sxs-lookup"><span data-stu-id="a97a2-369">hello length of time that hello access token is valid (in seconds).</span></span> |
| <span data-ttu-id="a97a2-370">refresh_token</span><span class="sxs-lookup"><span data-stu-id="a97a2-370">refresh_token</span></span> |<span data-ttu-id="a97a2-371">Маркер обновления OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="a97a2-371">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="a97a2-372">приложение Hello можно использовать этот токен tooacquire дополнительные маркеры, после истечения срока действия текущего маркера hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-372">hello app can use this token tooacquire additional tokens after hello current token expires.</span></span>  <span data-ttu-id="a97a2-373">Обновить токены долгоживущие и может быть tooresources доступа используется tooretain на длительное время.</span><span class="sxs-lookup"><span data-stu-id="a97a2-373">Refresh tokens are long-lived and can be used tooretain access tooresources for extended periods of time.</span></span> <span data-ttu-id="a97a2-374">Дополнительные сведения см. в разделе toohello [ссылку на маркер B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="a97a2-374">For more detail, refer toohello [B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="a97a2-375">Сообщения об ошибках выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a97a2-375">Error responses look like:</span></span>

```
{
    "error": "access_denied",
    "error_description": "hello user revoked access toohello app.",
}
```

| <span data-ttu-id="a97a2-376">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-376">Parameter</span></span> | <span data-ttu-id="a97a2-377">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-377">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a97a2-378">error</span><span class="sxs-lookup"><span data-stu-id="a97a2-378">error</span></span> |<span data-ttu-id="a97a2-379">Строка кода ошибки, может быть используется tooclassify типы ошибок, происходящих и это может стать tooerrors tooreact используется.</span><span class="sxs-lookup"><span data-stu-id="a97a2-379">An error-code string that can be used tooclassify types of errors that occur and that can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="a97a2-380">error_description</span><span class="sxs-lookup"><span data-stu-id="a97a2-380">error_description</span></span> |<span data-ttu-id="a97a2-381">Сообщение об ошибке, которые могут помочь определить причину ошибки проверки подлинности hello разработчик.</span><span class="sxs-lookup"><span data-stu-id="a97a2-381">A specific error message that can help a developer identify hello root cause of an authentication error.</span></span> |

## <a name="send-a-sign-out-request"></a><span data-ttu-id="a97a2-382">Отправка запроса на выход</span><span class="sxs-lookup"><span data-stu-id="a97a2-382">Send a sign-out request</span></span>
<span data-ttu-id="a97a2-383">При необходимости hello toosign выход пользователя из приложения hello, оно не хватает tooclear файлов cookie вашего приложения или в противном случае завершения сеанса hello с пользователем hello.</span><span class="sxs-lookup"><span data-stu-id="a97a2-383">When you want toosign hello user out of hello app, it is not enough tooclear your app's cookies or otherwise end hello session with hello user.</span></span> <span data-ttu-id="a97a2-384">Также необходимо перенаправить hello пользователя tooAzure AD toosign out. Если не toodo таким образом, пользователь hello может быть приложение может tooreauthenticate tooyour без еще раз ввести свои учетные данные.</span><span class="sxs-lookup"><span data-stu-id="a97a2-384">You must also redirect hello user tooAzure AD toosign out. If you fail toodo so, hello user might be able tooreauthenticate tooyour app without entering their credentials again.</span></span> <span data-ttu-id="a97a2-385">так как они будут иметь действительный сеанс единого входа с Azure AD.</span><span class="sxs-lookup"><span data-stu-id="a97a2-385">This is because they will have a valid single sign-on session with Azure AD.</span></span>

<span data-ttu-id="a97a2-386">Можно просто перенаправить пользователя toohello hello `end_session` конечной точки, указанный в документе метаданных OpenID Connect hello описано ранее в hello раздел «Проверка маркер идентификатора hello»:</span><span class="sxs-lookup"><span data-stu-id="a97a2-386">You can simply redirect hello user toohello `end_session` endpoint that is listed in hello OpenID Connect metadata document described earlier in hello "Validate hello ID token" section:</span></span>

```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?
p=b2c_1_sign_in
&post_logout_redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
```

| <span data-ttu-id="a97a2-387">Параметр</span><span class="sxs-lookup"><span data-stu-id="a97a2-387">Parameter</span></span> | <span data-ttu-id="a97a2-388">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="a97a2-388">Required?</span></span> | <span data-ttu-id="a97a2-389">Описание</span><span class="sxs-lookup"><span data-stu-id="a97a2-389">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a97a2-390">p</span><span class="sxs-lookup"><span data-stu-id="a97a2-390">p</span></span> |<span data-ttu-id="a97a2-391">Обязательно</span><span class="sxs-lookup"><span data-stu-id="a97a2-391">Required</span></span> |<span data-ttu-id="a97a2-392">политика Hello требуется toouse toosign hello пользователя приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-392">hello policy that you want toouse toosign hello user out of your application.</span></span> |
| <span data-ttu-id="a97a2-393">post_logout_redirect_uri</span><span class="sxs-lookup"><span data-stu-id="a97a2-393">post_logout_redirect_uri</span></span> |<span data-ttu-id="a97a2-394">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="a97a2-394">Recommended</span></span> |<span data-ttu-id="a97a2-395">Hello URL-адрес этого hello пользователя должно быть перенаправленный tooafter успешного выхода. Если не указан, Azure AD B2C показан пользователь hello универсальное сообщение.</span><span class="sxs-lookup"><span data-stu-id="a97a2-395">hello URL that hello user should be redirected tooafter successful sign-out. If it is not included, Azure AD B2C shows hello user a generic message.</span></span> |

> [!NOTE]
> <span data-ttu-id="a97a2-396">Несмотря на то, что направление hello пользователя toohello `end_session` некоторые из одного состояния входа с Azure AD B2C hello пользователя приведет к очистке конечной точки, hello выход пользователя из сеанса поставщика Удостоверений удостоверений из социальных сетей подпись не будет.</span><span class="sxs-lookup"><span data-stu-id="a97a2-396">Although directing hello user toohello `end_session` endpoint will clear some of hello user's single sign-on state with Azure AD B2C, it will not sign hello user out of their social identity provider (IDP) session.</span></span> <span data-ttu-id="a97a2-397">При выборе пользователем hello Здравствуйте того же поставщика Удостоверений, при последующем входе в систему, они будут пройти повторную проверку подлинности, не вводя свои учетные данные.</span><span class="sxs-lookup"><span data-stu-id="a97a2-397">If hello user selects hello same IDP during a subsequent sign-in, they will be reauthenticated, without entering their credentials.</span></span> <span data-ttu-id="a97a2-398">Если пользователю toosign B2C приложения, оно означает, что им нужен toosign за пределы свою учетную запись Facebook.</span><span class="sxs-lookup"><span data-stu-id="a97a2-398">If a user wants toosign out of your B2C application, it does not necessarily mean they want toosign out of their Facebook account.</span></span> <span data-ttu-id="a97a2-399">Однако в случае hello локальных учетных записей пользователя hello сеанс будет завершен правильно.</span><span class="sxs-lookup"><span data-stu-id="a97a2-399">However, in hello case of local accounts, hello user's session will be ended properly.</span></span>
> 
> 

## <a name="use-your-own-b2c-tenant"></a><span data-ttu-id="a97a2-400">Использование собственного клиента B2C</span><span class="sxs-lookup"><span data-stu-id="a97a2-400">Use your own B2C tenant</span></span>
<span data-ttu-id="a97a2-401">Если требуется tootry эти запросы самостоятельно, необходимо сначала выполнить следующие три шага и замените примеры значений hello описано выше на собственный:</span><span class="sxs-lookup"><span data-stu-id="a97a2-401">If you want tootry these requests for yourself, you must first perform these three steps, and then replace hello example values described earlier with your own:</span></span>

1. <span data-ttu-id="a97a2-402">[Создание клиента B2C](active-directory-b2c-get-started.md)и использовать в запросах hello hello имя вашего клиента.</span><span class="sxs-lookup"><span data-stu-id="a97a2-402">[Create a B2C tenant](active-directory-b2c-get-started.md), and use hello name of your tenant in hello requests.</span></span>
2. <span data-ttu-id="a97a2-403">[Создание приложения](active-directory-b2c-app-registration.md) tooobtain идентификатор приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-403">[Create an application](active-directory-b2c-app-registration.md) tooobtain an application ID.</span></span> <span data-ttu-id="a97a2-404">Включите в свое приложение веб-приложение или веб-API.</span><span class="sxs-lookup"><span data-stu-id="a97a2-404">Include a web app/web API in your app.</span></span> <span data-ttu-id="a97a2-405">При необходимости создайте секрет приложения.</span><span class="sxs-lookup"><span data-stu-id="a97a2-405">Optionally, create an application secret.</span></span>
3. <span data-ttu-id="a97a2-406">[Создание политик](active-directory-b2c-reference-policies.md) tooobtain имена ваших политики.</span><span class="sxs-lookup"><span data-stu-id="a97a2-406">[Create your policies](active-directory-b2c-reference-policies.md) tooobtain your policy names.</span></span>

