---
title: "Azure Active Directory B2C. Одностраничные приложения, использующие неявный поток | Документация Майкрософт"
description: "Узнайте, как с помощью Azure Active Directory B2C создавать одностраничные приложения, использующие неявный поток OAuth 2.0."
services: active-directory-b2c
documentationcenter: 
author: parakhj
manager: krassk
editor: parakhj
ms.assetid: a45cc74c-a37e-453f-b08b-af75855e0792
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/06/2017
ms.author: parakhj
ms.openlocfilehash: 44ff168599e9078506e1afdd0f1dc4657ef0964d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="azure-ad-b2c-single-page-app-sign-in-by-using-oauth-20-implicit-flow"></a><span data-ttu-id="eb1cc-103">Azure AD B2C. Вход в одностраничные приложения с помощью неявного потока OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="eb1cc-103">Azure AD B2C: Single-page app sign-in by using OAuth 2.0 implicit flow</span></span>

> [!NOTE]
> <span data-ttu-id="eb1cc-104">Эта функция предоставляется в предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-104">This feature is in preview.</span></span>
> 

<span data-ttu-id="eb1cc-105">Многие современные приложения содержат интерфейсное одностраничное приложение, созданное преимущественно на языке JavaScript.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-105">Many modern apps have a single-page app front end that primarily is written in JavaScript.</span></span> <span data-ttu-id="eb1cc-106">Часто приложение создается с помощью таких платформ, как AngularJS, Ember.js или Durandal.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-106">Often, the app is written by using a framework like AngularJS, Ember.js, or Durandal.</span></span> <span data-ttu-id="eb1cc-107">При аутентификации одностраничные и другие приложения JavaScript, которые запускаются в основном в браузере, сталкиваются с некоторыми дополнительными проблемами:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-107">Single-page apps and other JavaScript apps that run primarily in a browser have some additional challenges for authentication:</span></span>

* <span data-ttu-id="eb1cc-108">Характеристики безопасности этих приложений значительно отличаются от традиционных серверных веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-108">The security characteristics of these apps are significantly different from traditional server-based web applications.</span></span>
* <span data-ttu-id="eb1cc-109">Многие серверы авторизации и поставщики удостоверений не поддерживают запросы на общий доступ к ресурсам независимо от источника (CORS).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-109">Many authorization servers and identity providers do not support cross-origin resource sharing (CORS) requests.</span></span>
* <span data-ttu-id="eb1cc-110">Полностраничный браузер перенаправляет пользователя из приложения, взаимодействие с которым становится особенно агрессивным.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-110">Full-page browser redirects away from the app can be significantly invasive to the user experience.</span></span>

<span data-ttu-id="eb1cc-111">Для поддержки этих приложений в Azure Active Directory B2C (Azure AD B2C) используется неявный поток OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-111">To support these applications, Azure Active Directory B2C (Azure AD B2C) uses the OAuth 2.0 implicit flow.</span></span> <span data-ttu-id="eb1cc-112">Описание неявного потока предоставления авторизации OAuth 2.0 см. в [разделе 4.2 спецификации OAuth 2.0](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-112">The OAuth 2.0 authorization implicit grant flow is described in [section 4.2 of the OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="eb1cc-113">В неявном потоке приложение получает маркеры из конечной точки авторизации Azure Active Directory (Azure AD) напрямую, без какого-либо обмена данными между серверами.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-113">In implicit flow, the app receives tokens directly from the Azure Active Directory (Azure AD) authorize endpoint, without any server-to-server exchange.</span></span> <span data-ttu-id="eb1cc-114">Вся обработка логики аутентификации и сеансов выполняется в клиенте JavaScript без перенаправления на дополнительные страницы.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-114">All authentication logic and session handling takes place entirely in the JavaScript client, without additional page redirects.</span></span>

<span data-ttu-id="eb1cc-115">В Azure AD B2C стандартный неявный поток OAuth 2.0 выходит за рамки простой аутентификации и авторизации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-115">Azure AD B2C extends the standard OAuth 2.0 implicit flow to more than simple authentication and authorization.</span></span> <span data-ttu-id="eb1cc-116">В Azure AD B2C вводится [параметр политики](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-116">Azure AD B2C introduces the [policy parameter](active-directory-b2c-reference-policies.md).</span></span> <span data-ttu-id="eb1cc-117">Он позволяет использовать OAuth 2.0 для добавления в приложение действий по управлению пользователями, таких как регистрация, вход и управление профилями.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-117">With the policy parameter, you can use OAuth 2.0 to add user experiences to your app, such as sign-up, sign-in, and profile management.</span></span> <span data-ttu-id="eb1cc-118">В этой статье демонстрируется, как с помощью неявного потока и Azure AD реализовать каждую из этих функций в одностраничных приложениях.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-118">In this article, we show you how to use the implicit flow and Azure AD to implement each of these experiences in your single-page applications.</span></span> <span data-ttu-id="eb1cc-119">Просмотрите примеры для [Node.js](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-nodejs-webapi) и [Microsoft .NET](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-dotnet-webapi), которые помогут вам приступить к работе.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-119">To help you get started, take a look at our [Node.js](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-nodejs-webapi) and [Microsoft .NET](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-dotnet-webapi) samples.</span></span>

<span data-ttu-id="eb1cc-120">В приведенных в этой статье запросах HTTP используется наш пример каталога Azure AD B2C **fabrikamb2c.onmicrosoft.com**.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-120">In the example HTTP requests in this article, we use our sample Azure AD B2C directory, **fabrikamb2c.onmicrosoft.com**.</span></span> <span data-ttu-id="eb1cc-121">Также используются наши примеры приложения и политик.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-121">We also use our own sample application and policies.</span></span> <span data-ttu-id="eb1cc-122">Вы можете пробовать выполнять запросы с этими значениями или заменить их собственными.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-122">You can try the requests yourself by using these values, or you can replace them with your own values.</span></span>
<span data-ttu-id="eb1cc-123">Узнайте, как [получить собственный каталог Azure AD B2C, приложение и политики](#use-your-own-b2c-tenant).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-123">Learn how to [get your own Azure AD B2C directory, application, and policies](#use-your-own-b2c-tenant).</span></span>


## <a name="protocol-diagram"></a><span data-ttu-id="eb1cc-124">Схема протокола</span><span class="sxs-lookup"><span data-stu-id="eb1cc-124">Protocol diagram</span></span>

<span data-ttu-id="eb1cc-125">Неявный поток входа выглядит примерно так, как показано на приведенном ниже рисунке.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-125">The implicit sign-in flow looks something like the following figure.</span></span> <span data-ttu-id="eb1cc-126">Каждый шаг описан более подробно далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-126">Each step is described in detail later in the article.</span></span>

![Дорожки OpenID Connect](../media/active-directory-v2-flows/convergence_scenarios_implicit.png)

## <a name="send-authentication-requests"></a><span data-ttu-id="eb1cc-128">Отправка запросов проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="eb1cc-128">Send authentication requests</span></span>
<span data-ttu-id="eb1cc-129">Если веб-приложению требуется проверить подлинность пользователя и выполнить политику, то оно направляет его к конечной точке `/authorize`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-129">When your web app needs to authenticate the user and execute a policy, it directs the user to the `/authorize` endpoint.</span></span> <span data-ttu-id="eb1cc-130">Это интерактивная часть потока, в которой пользователь выполняет действие в зависимости от политики.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-130">This is the interactive portion of the flow, where the user takes action, depending on the policy.</span></span> <span data-ttu-id="eb1cc-131">Пользователь получает маркер идентификации от конечной точки Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-131">The user gets an ID token from the Azure AD endpoint.</span></span>

<span data-ttu-id="eb1cc-132">В этом запросе клиент указывает в параметре `scope` разрешения, которые ему требуется получить от пользователя.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-132">In this request, the client indicates in the `scope` parameter the permissions that it needs to acquire from the user.</span></span> <span data-ttu-id="eb1cc-133">В параметре `p` он указывает политику, которую необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-133">In the `p` parameter, it indicates the policy to execute.</span></span> <span data-ttu-id="eb1cc-134">Ниже приведены три примера (переносы строк добавлены для удобства чтения), в которых используются разные политики.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-134">The following three examples (with line breaks for readability) each use a different policy.</span></span> <span data-ttu-id="eb1cc-135">Чтобы понять, как работает каждый запрос, попробуйте вставить его в браузер и запустить.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-135">To get a feel for how each request works, try pasting the request into a browser and running it.</span></span>

### <a name="use-a-sign-in-policy"></a><span data-ttu-id="eb1cc-136">Пример с политикой входа в систему</span><span class="sxs-lookup"><span data-stu-id="eb1cc-136">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=id_token+token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=fragment
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_in
```

### <a name="use-a-sign-up-policy"></a><span data-ttu-id="eb1cc-137">Пример с политикой регистрации</span><span class="sxs-lookup"><span data-stu-id="eb1cc-137">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=id_token+token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=fragment
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_up
```

### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="eb1cc-138">Пример с политикой изменения профиля</span><span class="sxs-lookup"><span data-stu-id="eb1cc-138">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=id_token+token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=fragment
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_edit_profile
```

| <span data-ttu-id="eb1cc-139">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-139">Parameter</span></span> | <span data-ttu-id="eb1cc-140">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="eb1cc-140">Required?</span></span> | <span data-ttu-id="eb1cc-141">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-141">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="eb1cc-142">client_id</span><span class="sxs-lookup"><span data-stu-id="eb1cc-142">client_id</span></span> |<span data-ttu-id="eb1cc-143">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-143">Required</span></span> |<span data-ttu-id="eb1cc-144">Идентификатор приложения, назначенный вашему приложению на [портале Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-144">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="eb1cc-145">response_type</span><span class="sxs-lookup"><span data-stu-id="eb1cc-145">response_type</span></span> |<span data-ttu-id="eb1cc-146">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-146">Required</span></span> |<span data-ttu-id="eb1cc-147">Должен включать `id_token` для входа в OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-147">Must include `id_token` for OpenID Connect sign-in.</span></span> <span data-ttu-id="eb1cc-148">Он также может содержать значение `token` типа ответа.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-148">It also can include the response type `token`.</span></span> <span data-ttu-id="eb1cc-149">Использование `token` позволяет приложению получать маркер доступа непосредственно от конечной точки авторизации, не отправляя новый запрос на вход в эту конечную точку.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-149">If you use `token`, your app can immediately receive an access token from the authorize endpoint, without making a second request to the authorize endpoint.</span></span>  <span data-ttu-id="eb1cc-150">При использовании типа ответа `token` параметр `scope` должен содержать область, определяющую ресурсы, для которых необходимо выдавать маркер.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-150">If you use the `token` response type, the `scope` parameter must contain a scope that indicates which resource to issue the token for.</span></span> |
| <span data-ttu-id="eb1cc-151">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="eb1cc-151">redirect_uri</span></span> |<span data-ttu-id="eb1cc-152">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-152">Recommended</span></span> |<span data-ttu-id="eb1cc-153">Универсальный код ресурса (URI) перенаправления приложения, на который можно отправлять ответы аутентификации для их получения приложением.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-153">The redirect URI of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="eb1cc-154">Он должен в точности соответствовать одному из URI перенаправления, зарегистрированных на портале, но иметь форму закодированного URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-154">It must exactly match one of the redirect URIs that you registered in the portal, except that it must be URL-encoded.</span></span> |
| <span data-ttu-id="eb1cc-155">response_mode</span><span class="sxs-lookup"><span data-stu-id="eb1cc-155">response_mode</span></span> |<span data-ttu-id="eb1cc-156">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-156">Recommended</span></span> |<span data-ttu-id="eb1cc-157">Указывает метод, с помощью которого результирующий маркер будет отправлен приложению.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-157">Specifies the method to use to send the resulting token back to your app.</span></span>  <span data-ttu-id="eb1cc-158">Для неявных потоков используйте `fragment`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-158">For implicit flows, use `fragment`.</span></span> |
| <span data-ttu-id="eb1cc-159">scope</span><span class="sxs-lookup"><span data-stu-id="eb1cc-159">scope</span></span> |<span data-ttu-id="eb1cc-160">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-160">Required</span></span> |<span data-ttu-id="eb1cc-161">Список областей с разделителями-пробелами.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-161">A space-separated list of scopes.</span></span> <span data-ttu-id="eb1cc-162">При указании одной области также обозначаются запрашиваемые разрешения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-162">A single scope value indicates to Azure AD both of the permissions that are being requested.</span></span> <span data-ttu-id="eb1cc-163">Область `openid` определяет разрешение на вход пользователя и получение данных о пользователе в форме маркеров идентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-163">The `openid` scope indicates a permission to sign in the user and get data about the user in the form of ID tokens.</span></span> <span data-ttu-id="eb1cc-164">(Мы рассмотрим это более подробно далее в этой статье.) Область `offline_access` для веб-приложений является необязательной.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-164">(We'll talk about this more later in the article.) The `offline_access` scope is optional for web apps.</span></span> <span data-ttu-id="eb1cc-165">Она означает, что вашему приложению потребуется маркер обновления для продолжительного доступа к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-165">It indicates that your app needs a refresh token for long-lived access to resources.</span></span> |
| <span data-ttu-id="eb1cc-166">state</span><span class="sxs-lookup"><span data-stu-id="eb1cc-166">state</span></span> |<span data-ttu-id="eb1cc-167">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-167">Recommended</span></span> |<span data-ttu-id="eb1cc-168">Значение, включенное в запрос, которое также возвращается в ответе маркера.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-168">A value included in the request that also is returned in the token response.</span></span> <span data-ttu-id="eb1cc-169">Это может быть строка любого содержимого.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-169">It can be a string of any content that you want to use.</span></span> <span data-ttu-id="eb1cc-170">Как правило, с целью предотвращения подделки межсайтовых запросов используется генерируемое случайным образом уникальное значение.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-170">Usually, a randomly generated, unique value is used, to prevent cross-site request forgery attacks.</span></span> <span data-ttu-id="eb1cc-171">Этот параметр также включает сведения о состоянии пользователя в приложении перед созданием запроса на аутентификацию (например, об открытой в тот момент странице).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-171">The state is also used to encode information about the user's state in the app before the authentication request occurred, like the page they were on.</span></span> |
| <span data-ttu-id="eb1cc-172">nonce</span><span class="sxs-lookup"><span data-stu-id="eb1cc-172">nonce</span></span> |<span data-ttu-id="eb1cc-173">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-173">Required</span></span> |<span data-ttu-id="eb1cc-174">Значение, включенное в запрос (созданное приложением), которое входит в состав полученного маркера идентификации в качестве утверждения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-174">A value included in the request (generated by the app) that is included in the resulting ID token as a claim.</span></span> <span data-ttu-id="eb1cc-175">Приложение может проверить это значение во избежание атак с использованием воспроизведения токена.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-175">The app can then verify this value to mitigate token replay attacks.</span></span> <span data-ttu-id="eb1cc-176">Это значение обычно представляет собой случайную уникальную строку, которую можно использовать для определения источника запроса.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-176">Usually, the value is a randomized, unique string that can be used to identify the origin of the request.</span></span> |
| <span data-ttu-id="eb1cc-177">p</span><span class="sxs-lookup"><span data-stu-id="eb1cc-177">p</span></span> |<span data-ttu-id="eb1cc-178">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-178">Required</span></span> |<span data-ttu-id="eb1cc-179">Политика, которую необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-179">The policy to execute.</span></span> <span data-ttu-id="eb1cc-180">Это имя политики, созданной в клиенте Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-180">It's the name of a policy that is created in your Azure AD B2C tenant.</span></span> <span data-ttu-id="eb1cc-181">Оно должно начинаться с **b2c\_1\_**.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-181">The policy name value should begin with **b2c\_1\_**.</span></span> <span data-ttu-id="eb1cc-182">Дополнительные сведения см. в [документации по встроенным политикам Azure AD B2C](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-182">For more information, see [Azure AD B2C built-in policies](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="eb1cc-183">prompt</span><span class="sxs-lookup"><span data-stu-id="eb1cc-183">prompt</span></span> |<span data-ttu-id="eb1cc-184">Необязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-184">Optional</span></span> |<span data-ttu-id="eb1cc-185">Требуемый тип взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-185">The type of user interaction that's required.</span></span> <span data-ttu-id="eb1cc-186">В настоящее время поддерживается только значение `login`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-186">Currently, the only valid value is `login`.</span></span> <span data-ttu-id="eb1cc-187">При этом значении пользователь должен ввести учетные данные по запросу.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-187">This forces the user to enter their credentials on that request.</span></span> <span data-ttu-id="eb1cc-188">Единый вход не сработает.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-188">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="eb1cc-189">На этом этапе пользователю предлагается выполнить рабочий процесс политики.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-189">At this point, the user is asked to complete the policy's workflow.</span></span> <span data-ttu-id="eb1cc-190">Для этого могут потребоваться ввод имени пользователя и пароля, вход с помощью удостоверения социальной сети, регистрация в каталоге или любые другие шаги.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-190">This might involve the user entering their username and password, signing in with a social identity, signing up for the directory, or any other number of steps.</span></span> <span data-ttu-id="eb1cc-191">Действия пользователя определяются в политике.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-191">User actions depend on how the policy is defined.</span></span>

<span data-ttu-id="eb1cc-192">Когда пользователь выполнит рабочий процесс политики, служба Azure AD вернет ответ приложению, используя значение, указанное для `redirect_uri`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-192">After the user completes the policy, Azure AD returns a response to your app at the value you used for `redirect_uri`.</span></span> <span data-ttu-id="eb1cc-193">Она использует метод, указанный в параметре `response_mode`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-193">It uses the method specified in the `response_mode` parameter.</span></span> <span data-ttu-id="eb1cc-194">Во всех сценариях действий пользователя ответ будет одинаковым независимо от политики, которая была выполнена.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-194">The response is exactly the same for each of the user action scenarios, independent of the policy that was executed.</span></span>

### <a name="successful-response"></a><span data-ttu-id="eb1cc-195">Успешный ответ</span><span class="sxs-lookup"><span data-stu-id="eb1cc-195">Successful response</span></span>
<span data-ttu-id="eb1cc-196">Успешный ответ с использованием `response_mode=fragment` и `response_type=id_token+token` выглядит следующим образом (разрывы строк — для удобства чтения):</span><span class="sxs-lookup"><span data-stu-id="eb1cc-196">A successful response that uses `response_mode=fragment` and `response_type=id_token+token` looks like the following, with line breaks for legibility:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&token_type=Bearer
&expires_in=3599
&scope="90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
&id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=arbitrary_data_you_sent_earlier
```

| <span data-ttu-id="eb1cc-197">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-197">Parameter</span></span> | <span data-ttu-id="eb1cc-198">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-198">Description</span></span> |
| --- | --- |
| <span data-ttu-id="eb1cc-199">access_token</span><span class="sxs-lookup"><span data-stu-id="eb1cc-199">access_token</span></span> |<span data-ttu-id="eb1cc-200">Маркер доступа, запрошенный приложением.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-200">The access token that the app requested.</span></span>  <span data-ttu-id="eb1cc-201">Маркер доступа не следует расшифровывать или каким-либо иным образом проверять.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-201">The access token should not be decoded or otherwise inspected.</span></span> <span data-ttu-id="eb1cc-202">Его можно рассматривать как непрозрачную строку.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-202">It can be treated as an opaque string.</span></span> |
| <span data-ttu-id="eb1cc-203">token_type</span><span class="sxs-lookup"><span data-stu-id="eb1cc-203">token_type</span></span> |<span data-ttu-id="eb1cc-204">Значение типа маркера.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-204">The token type value.</span></span> <span data-ttu-id="eb1cc-205">Единственный тип, поддерживаемый Azure AD — носитель.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-205">The only type that Azure AD supports is Bearer.</span></span> |
| <span data-ttu-id="eb1cc-206">expires_in</span><span class="sxs-lookup"><span data-stu-id="eb1cc-206">expires_in</span></span> |<span data-ttu-id="eb1cc-207">Срок действия маркера доступа (в секундах).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-207">The length of time that the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="eb1cc-208">scope</span><span class="sxs-lookup"><span data-stu-id="eb1cc-208">scope</span></span> |<span data-ttu-id="eb1cc-209">Области, для которых действителен маркер.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-209">The scopes that the token is valid for.</span></span> <span data-ttu-id="eb1cc-210">Области также можно использовать, чтобы кэшировать маркеры для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-210">You also can use scopes to cache tokens for later use.</span></span> |
| <span data-ttu-id="eb1cc-211">id_token</span><span class="sxs-lookup"><span data-stu-id="eb1cc-211">id_token</span></span> |<span data-ttu-id="eb1cc-212">Маркер идентификации, запрошенный приложением.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-212">The ID token that the app requested.</span></span> <span data-ttu-id="eb1cc-213">Вы можете использовать маркер идентификации для проверки личности пользователя и запуска сеанса пользователя.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-213">You can use the ID token to verify the user's identity and begin a session with the user.</span></span> <span data-ttu-id="eb1cc-214">Дополнительные сведения о маркерах идентификации и их содержимом см. в [справочнике по маркерам Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-214">For more information about ID tokens and their contents, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |
| <span data-ttu-id="eb1cc-215">state</span><span class="sxs-lookup"><span data-stu-id="eb1cc-215">state</span></span> |<span data-ttu-id="eb1cc-216">Если запрос содержит параметр `state`, то в ответе должно отображаться то же значение.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-216">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="eb1cc-217">Приложение должно проверить, совпадают ли значения параметра `state` в запросе и ответе.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-217">The app should verify that the `state` values in the request and response are identical.</span></span> |

### <a name="error-response"></a><span data-ttu-id="eb1cc-218">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="eb1cc-218">Error response</span></span>
<span data-ttu-id="eb1cc-219">Сообщения об ошибках также можно отправлять на универсальный код ресурса (URI) перенаправления, чтобы приложение могло их правильно обработать:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-219">Error responses also can be sent to the redirect URI so that the app can handle them appropriately:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=access_denied
&error_description=the+user+canceled+the+authentication
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="eb1cc-220">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-220">Parameter</span></span> | <span data-ttu-id="eb1cc-221">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-221">Description</span></span> |
| --- | --- |
| <span data-ttu-id="eb1cc-222">error</span><span class="sxs-lookup"><span data-stu-id="eb1cc-222">error</span></span> |<span data-ttu-id="eb1cc-223">Строка кода ошибки, используемая для классификации типов возникших ошибок.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-223">An error code string used to classify types of errors that occur.</span></span> <span data-ttu-id="eb1cc-224">Код ошибки также можно использовать для обработки ошибок.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-224">You also can use the error code for error handling.</span></span> |
| <span data-ttu-id="eb1cc-225">error_description</span><span class="sxs-lookup"><span data-stu-id="eb1cc-225">error_description</span></span> |<span data-ttu-id="eb1cc-226">Конкретное сообщение об ошибке, с помощью которого можно определить первопричину возникновения ошибки аутентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-226">A specific error message that can help you identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="eb1cc-227">state</span><span class="sxs-lookup"><span data-stu-id="eb1cc-227">state</span></span> |<span data-ttu-id="eb1cc-228">См. полное описание в предыдущей таблице.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-228">See the full description in the preceding table.</span></span> <span data-ttu-id="eb1cc-229">Если запрос содержит параметр `state`, то в ответе должно отображаться то же значение.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-229">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="eb1cc-230">Приложение должно проверить, совпадают ли значения параметра `state` в запросе и ответе.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-230">The app should verify that the `state` values in the request and response are identical.</span></span>|

## <a name="validate-the-id-token"></a><span data-ttu-id="eb1cc-231">Проверка маркера идентификации</span><span class="sxs-lookup"><span data-stu-id="eb1cc-231">Validate the ID token</span></span>
<span data-ttu-id="eb1cc-232">Получение маркера идентификации не является достаточным для прохождения пользователем аутентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-232">Receiving an ID token is not enough to authenticate the user.</span></span> <span data-ttu-id="eb1cc-233">Необходимо проверить подпись маркера идентификации и сопоставить утверждения в маркере с требованиями вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-233">You must validate the ID token's signature, and verify the claims in the token per your app's requirements.</span></span> <span data-ttu-id="eb1cc-234">В Azure AD B2C для подписи маркеров и проверки их правильности используются [веб-маркеры JSON Web Token (JWT)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) и шифрование с открытым ключом.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-234">Azure AD B2C uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography to sign tokens and verify that they are valid.</span></span>

<span data-ttu-id="eb1cc-235">Для проверки маркеров JWT доступны многие библиотеки с открытым исходным кодом в зависимости от выбранного языка.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-235">Many open-source libraries are available for validating JWTs, depending on the language you prefer to use.</span></span> <span data-ttu-id="eb1cc-236">Рекомендуется изучить доступные библиотеки с открытым исходным кодом, а не реализовывать логику проверки самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-236">Consider exploring available open-source libraries rather than implementing your own validation logic.</span></span> <span data-ttu-id="eb1cc-237">Сведения, приведенные в данной статье, помогут вам узнать, как правильно использовать эти библиотеки.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-237">You can use the information in this article to help you learn how to properly use those libraries.</span></span>

<span data-ttu-id="eb1cc-238">Служба Azure AD B2C имеет конечную точку метаданных OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-238">Azure AD B2C has an OpenID Connect metadata endpoint.</span></span> <span data-ttu-id="eb1cc-239">Приложение может использовать конечную точку для получения сведений об Azure AD B2C в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-239">An app can use the endpoint to fetch information about Azure AD B2C at runtime.</span></span> <span data-ttu-id="eb1cc-240">Эти сведения включают конечные точки, содержимое маркеров и ключи подписи маркеров.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-240">This information includes endpoints, token contents, and token signing keys.</span></span> <span data-ttu-id="eb1cc-241">Для каждой политики в клиенте Azure AD B2C есть собственный документ метаданных JSON.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-241">There is a JSON metadata document for each policy in your Azure AD B2C tenant.</span></span> <span data-ttu-id="eb1cc-242">Например, документ метаданных для политики b2c_1_sign_in в клиенте fabrikamb2c.onmicrosoft.com находится в каталоге:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-242">For example, the metadata document for the b2c_1_sign_in policy in the fabrikamb2c.onmicrosoft.com tenant is located at:</span></span>

`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=b2c_1_sign_in`

<span data-ttu-id="eb1cc-243">Одно из свойств этого документа конфигурации — `jwks_uri`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-243">One of the properties of this configuration document is the `jwks_uri`.</span></span> <span data-ttu-id="eb1cc-244">Значение для точно такой же политики будет следующим:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-244">The value for the same policy would be:</span></span>

`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`

<span data-ttu-id="eb1cc-245">Чтобы определить, какая политика была использована для подписи маркера идентификации (а также определить, откуда получать метаданные), можно воспользоваться одним из двух вариантов.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-245">To determine which policy was used to sign an ID token (and where to fetch the metadata from), you have two options.</span></span> <span data-ttu-id="eb1cc-246">Сначала имя политики включается в утверждение `acr` в `id_token`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-246">First, the policy name is included in the `acr` claim in `id_token`.</span></span> <span data-ttu-id="eb1cc-247">Сведения об анализе утверждений маркера идентификации см. в [справочнике по маркерам Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-247">For information about how to parse the claims from an ID token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="eb1cc-248">Другой вариант — закодировать политику в значении параметра `state` при отправке запроса.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-248">Your other option is to encode the policy in the value of the `state` parameter when you issue the request.</span></span> <span data-ttu-id="eb1cc-249">Затем декодировать параметр `state`, чтобы определить, какая политика была использована.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-249">Then, decode the `state` parameter to determine which policy was used.</span></span> <span data-ttu-id="eb1cc-250">Каждый из этих методов является допустимым.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-250">Either method is valid.</span></span>

<span data-ttu-id="eb1cc-251">После получения документа метаданных из конечной точки метаданных OpenID Connect можно использовать открытые ключи RSA-256, расположенные в этой конечной точке, для проверки подписи маркера идентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-251">After you've acquired the metadata document from the OpenID Connect metadata endpoint, you can use the RSA-256 public keys (located at this endpoint) to validate the signature of the ID token.</span></span> <span data-ttu-id="eb1cc-252">В каждый момент времени в этой конечной точке может находиться множество ключей, каждый из которых определяется `kid`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-252">There might be multiple keys listed at this endpoint at any given time, each identified by a `kid`.</span></span> <span data-ttu-id="eb1cc-253">Заголовок `id_token` также содержит утверждение `kid`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-253">The header of `id_token` also contains a `kid` claim.</span></span> <span data-ttu-id="eb1cc-254">Оно указывает на ключ, который был использован для подписи маркера идентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-254">It indicates which of these keys was used to sign the ID token.</span></span> <span data-ttu-id="eb1cc-255">Дополнительные сведения см. в [справочнике по маркерам Azure AD B2C](active-directory-b2c-reference-tokens.md), включая раздел [Проверка маркеров](active-directory-b2c-reference-tokens.md#token-validation).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-255">For more information, including learning about [validating tokens](active-directory-b2c-reference-tokens.md#token-validation), see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span>
<!--TODO: Improve the information on this-->

<span data-ttu-id="eb1cc-256">После проверки подписи маркера идентификации для некоторых утверждений требуется проверка.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-256">After you validate the signature of the ID token, several claims require verification.</span></span> <span data-ttu-id="eb1cc-257">Например:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-257">For example:</span></span>

* <span data-ttu-id="eb1cc-258">Проверьте утверждение `nonce` во избежание атак с использованием воспроизведения маркеров.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-258">Validate the `nonce` claim to prevent token replay attacks.</span></span> <span data-ttu-id="eb1cc-259">Его значение должно совпадать с указанным вами в запросе на вход.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-259">Its value should be what you specified in the sign-in request.</span></span>
* <span data-ttu-id="eb1cc-260">Проверьте утверждение `aud`, чтобы убедиться, что для вашего приложения был выдан маркер идентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-260">Validate the `aud` claim to ensure that the ID token was issued for your app.</span></span> <span data-ttu-id="eb1cc-261">Его значением должен быть идентификатор приложения вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-261">Its value should be the application ID of your app.</span></span>
* <span data-ttu-id="eb1cc-262">Проверьте утверждения `iat` и `exp`, чтобы убедиться, что срок действия маркера идентификации не истек.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-262">Validate the `iat` and `exp` claims to ensure that the ID token has not expired.</span></span>

<span data-ttu-id="eb1cc-263">Вам нужно выполнить дополнительные проверки, которые подробно описаны в [спецификации OpenID Connect Core](http://openid.net/specs/openid-connect-core-1_0.html).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-263">Several more validations that you should perform are described in detail in the [OpenID Connect Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).</span></span> <span data-ttu-id="eb1cc-264">Вам также может потребоваться проверить дополнительные утверждения в зависимости от сценария.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-264">You might also want to validate additional claims, depending on your scenario.</span></span> <span data-ttu-id="eb1cc-265">Ниже приведены некоторые из стандартных проверок:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-265">Some common validations include:</span></span>

* <span data-ttu-id="eb1cc-266">Обеспечение регистрации пользователя или организации в приложении.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-266">Ensuring that the user or organization has signed up for the app.</span></span>
* <span data-ttu-id="eb1cc-267">Предоставление пользователю необходимого уровня авторизации и привилегий.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-267">Ensuring that the user has proper authorization and privileges.</span></span>
* <span data-ttu-id="eb1cc-268">Обеспечение определенного уровня аутентификации, например с помощью Многофакторной идентификации Azure.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-268">Ensuring that a certain strength of authentication has occurred, such as by using Azure Multi-Factor Authentication.</span></span>

<span data-ttu-id="eb1cc-269">Дополнительные сведения об утверждениях в маркере идентификации см. в [справочнике по маркерам Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-269">For more information about the claims in an ID token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span>

<span data-ttu-id="eb1cc-270">После полной проверки маркера идентификации можно запустить сеанс пользователя.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-270">After you have completely validated the ID token, you can begin a session with the user.</span></span> <span data-ttu-id="eb1cc-271">В приложении используйте утверждения в маркере идентификации для получения сведений о пользователе.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-271">In your app, use the claims in the ID token to obtain information about the user.</span></span> <span data-ttu-id="eb1cc-272">Эти сведения можно использовать для отображения, записей, авторизации и т. д.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-272">This information can be used for display, records, authorization, and so on.</span></span>

## <a name="get-access-tokens"></a><span data-ttu-id="eb1cc-273">Получение маркеров доступа</span><span class="sxs-lookup"><span data-stu-id="eb1cc-273">Get access tokens</span></span>
<span data-ttu-id="eb1cc-274">Если вашим веб-приложениям требуется только выполнять политики, вы можете пропустить следующие несколько разделов.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-274">If the only thing your web apps needs to do is execute policies, you can skip the next few sections.</span></span> <span data-ttu-id="eb1cc-275">Сведения в следующих разделах применяются только к веб-приложениям, которым необходимо выполнять защищенные аутентификацией вызовы веб-API, защищенные Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-275">The information in the following sections are applicable only to web apps that need to make authenticated calls to a web API, and which are protected by Azure AD B2C.</span></span>

<span data-ttu-id="eb1cc-276">Теперь, когда пользователь вошел в одностраничное приложение, можно получить маркеры доступа для вызова интерфейсов веб-API, защищенных с помощью Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-276">Now that you've signed the user in to your single-page app, you can get access tokens for calling web APIs that are secured by Azure AD.</span></span> <span data-ttu-id="eb1cc-277">Даже если вы уже получили маркер с помощью типа ответа `token`, то этот метод можно использовать для получения маркеров для дополнительных ресурсов. При этом пользователям не нужно повторно выполнять вход.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-277">Even if you have already received a token by using the `token` response type, you can use this method to acquire tokens for additional resources without redirecting the user to sign in again.</span></span>

<span data-ttu-id="eb1cc-278">В обычном потоке веб-приложения маркеры можно получить, отправив запрос к конечной точке `/token`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-278">In a typical web app flow, you would do this by making a request to the `/token` endpoint.</span></span>  <span data-ttu-id="eb1cc-279">Однако конечная точка не поддерживает запросы CORS, поэтому получение и обновление маркеров с помощью вызовов AJAX недоступно.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-279">However, the endpoint does not support CORS requests, so making AJAX calls to get and refresh tokens is not an option.</span></span> <span data-ttu-id="eb1cc-280">Вместо этого для получения новых маркеров для других веб-API можно использовать неявный поток данных в скрытом HTML-элементе iframe.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-280">Instead, you can use the implicit flow in a hidden HTML iframe element to get new tokens for other web APIs.</span></span> <span data-ttu-id="eb1cc-281">Ниже приведен пример (разрывы строк — для удобства чтения):</span><span class="sxs-lookup"><span data-stu-id="eb1cc-281">Here's an example, with line breaks for legibility:</span></span>

```

https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&scope=https%3A%2F%2Fapi.contoso.com%2Ftasks.read
&response_mode=fragment
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&prompt=none
&domain_hint=organizations
&login_hint=myuser@mycompany.com
&p=b2c_1_sign_in
```

| <span data-ttu-id="eb1cc-282">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-282">Parameter</span></span> | <span data-ttu-id="eb1cc-283">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="eb1cc-283">Required?</span></span> | <span data-ttu-id="eb1cc-284">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-284">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="eb1cc-285">client_id</span><span class="sxs-lookup"><span data-stu-id="eb1cc-285">client_id</span></span> |<span data-ttu-id="eb1cc-286">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-286">Required</span></span> |<span data-ttu-id="eb1cc-287">Идентификатор приложения, назначенный вашему приложению на [портале Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-287">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="eb1cc-288">response_type</span><span class="sxs-lookup"><span data-stu-id="eb1cc-288">response_type</span></span> |<span data-ttu-id="eb1cc-289">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-289">Required</span></span> |<span data-ttu-id="eb1cc-290">Должен включать `id_token` для входа в OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-290">Must include `id_token` for OpenID Connect sign-in.</span></span>  <span data-ttu-id="eb1cc-291">Этот параметр также может содержать `token` типа ответа.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-291">It might also include the response type `token`.</span></span> <span data-ttu-id="eb1cc-292">Если использовать `token`, то приложение сможет получить маркер доступа непосредственно от конечной точки авторизации, не отправляя новый запрос на вход в эту конечную точку.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-292">If you use `token` here, your app can immediately receive an access token from the authorize endpoint, without making a second request to the authorize endpoint.</span></span> <span data-ttu-id="eb1cc-293">При использовании типа ответа `token` параметр `scope` должен содержать область, определяющую ресурсы, для которых необходимо выдавать маркер.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-293">If you use the `token` response type, the `scope` parameter must contain a scope that indicates which resource to issue the token for.</span></span> |
| <span data-ttu-id="eb1cc-294">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="eb1cc-294">redirect_uri</span></span> |<span data-ttu-id="eb1cc-295">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-295">Recommended</span></span> |<span data-ttu-id="eb1cc-296">Универсальный код ресурса (URI) перенаправления приложения, на который можно отправлять ответы аутентификации для их получения приложением.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-296">The redirect URI of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="eb1cc-297">Он должен в точности соответствовать одному из универсальных кодов ресурса (URI) перенаправления, зарегистрированных на портале, но иметь форму URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-297">It must exactly match one of the redirect URIs you registered in the portal, except that it must be URL-encoded.</span></span> |
| <span data-ttu-id="eb1cc-298">scope</span><span class="sxs-lookup"><span data-stu-id="eb1cc-298">scope</span></span> |<span data-ttu-id="eb1cc-299">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-299">Required</span></span> |<span data-ttu-id="eb1cc-300">Список областей с разделителями-пробелами.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-300">A space-separated list of scopes.</span></span>  <span data-ttu-id="eb1cc-301">Для получения маркеров укажите все области, которые необходимы для целевого ресурса.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-301">For getting tokens, include all scopes that you require for the intended resource.</span></span> |
| <span data-ttu-id="eb1cc-302">response_mode</span><span class="sxs-lookup"><span data-stu-id="eb1cc-302">response_mode</span></span> |<span data-ttu-id="eb1cc-303">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-303">Recommended</span></span> |<span data-ttu-id="eb1cc-304">Указывает метод, с помощью которого результирующий маркер будет отправлен приложению.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-304">Specifies the method that is used to send the resulting token back to your app.</span></span>  <span data-ttu-id="eb1cc-305">Возможные значения: `query`, `form_post` или `fragment`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-305">Can be `query`, `form_post`, or `fragment`.</span></span> |
| <span data-ttu-id="eb1cc-306">state</span><span class="sxs-lookup"><span data-stu-id="eb1cc-306">state</span></span> |<span data-ttu-id="eb1cc-307">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-307">Recommended</span></span> |<span data-ttu-id="eb1cc-308">Значение, включенное в запрос, которое также возвращается в ответе маркера.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-308">A value included in the request that is returned in the token response.</span></span>  <span data-ttu-id="eb1cc-309">Это может быть строка любого содержимого.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-309">It can be a string of any content that you want to use.</span></span>  <span data-ttu-id="eb1cc-310">Как правило, с целью предотвращения подделки межсайтовых запросов используется генерируемое случайным образом уникальное значение.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-310">Usually, a randomly generated, unique value is used, to prevent cross-site request forgery attacks.</span></span>  <span data-ttu-id="eb1cc-311">Параметр state используется также для кодирования сведений о состоянии пользователя в приложении перед созданием запроса на аутентификацию.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-311">The state also is used to encode information about the user's state in the app before the authentication request occurred.</span></span> <span data-ttu-id="eb1cc-312">Например, сведений об открытой на тот момент странице или представлении.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-312">For example, the page or view the user was on.</span></span> |
| <span data-ttu-id="eb1cc-313">nonce</span><span class="sxs-lookup"><span data-stu-id="eb1cc-313">nonce</span></span> |<span data-ttu-id="eb1cc-314">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-314">Required</span></span> |<span data-ttu-id="eb1cc-315">Значение, включенное в запрос и созданное приложением, которое входит в состав полученного маркера идентификации в качестве утверждения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-315">A value included in the request, generated by the app, that is included in the resulting ID token as a claim.</span></span>  <span data-ttu-id="eb1cc-316">Приложение может проверить это значение во избежание атак с использованием воспроизведения токена.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-316">The app can then verify this value to mitigate token replay attacks.</span></span> <span data-ttu-id="eb1cc-317">Обычно это значение представляет собой случайную уникальную строку, которая определяет источник запроса.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-317">Usually, the value is a randomized, unique string that identifies the origin of the request.</span></span> |
| <span data-ttu-id="eb1cc-318">prompt</span><span class="sxs-lookup"><span data-stu-id="eb1cc-318">prompt</span></span> |<span data-ttu-id="eb1cc-319">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-319">Required</span></span> |<span data-ttu-id="eb1cc-320">Для обновления и получения маркеров в скрытом запросе iframe используйте `prompt=none`. Таким образом, iframe не перестает отвечать на странице входа приложения и сразу же возвращает данные.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-320">To refresh and get tokens in a hidden iframe, use `prompt=none` to ensure that the iframe does not get stuck on the sign-in page, and returns immediately.</span></span> |
| <span data-ttu-id="eb1cc-321">login_hint</span><span class="sxs-lookup"><span data-stu-id="eb1cc-321">login_hint</span></span> |<span data-ttu-id="eb1cc-322">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-322">Required</span></span> |<span data-ttu-id="eb1cc-323">Для обновления и получения маркеров в скрытом запросе iframe включите в эту подсказку имя пользователя. Это позволяет различать сеансы пользователя в определенный момент времени.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-323">To refresh and get tokens in a hidden iframe, include the username of the user in this hint to distinguish between multiple sessions the user might have at a given  time.</span></span> <span data-ttu-id="eb1cc-324">Имя пользователя можно извлечь из предыдущей операции входа с помощью утверждения `preferred_username`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-324">You can extract the username from an earlier sign-in by using the `preferred_username` claim.</span></span> |
| <span data-ttu-id="eb1cc-325">domain_hint</span><span class="sxs-lookup"><span data-stu-id="eb1cc-325">domain_hint</span></span> |<span data-ttu-id="eb1cc-326">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-326">Required</span></span> |<span data-ttu-id="eb1cc-327">Может иметь значение `consumers` или `organizations`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-327">Can be `consumers` or `organizations`.</span></span>  <span data-ttu-id="eb1cc-328">Для обновления и получения маркеров в скрытом запросе iframe необходимо включить в запрос значение `domain_hint`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-328">For refreshing and getting tokens in a hidden iframe, you must include the `domain_hint` value in the request.</span></span>  <span data-ttu-id="eb1cc-329">Извлеките утверждение `tid` из маркера идентификации предыдущей операции входа, чтобы определить, какое значение следует использовать.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-329">Extract the `tid` claim from the ID token of an earlier sign-in to determine which value to use.</span></span>  <span data-ttu-id="eb1cc-330">Если значение утверждения `tid` — `9188040d-6c67-4c5b-b112-36a304b66dad`, то используйте `domain_hint=consumers`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-330">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`,  use `domain_hint=consumers`.</span></span>  <span data-ttu-id="eb1cc-331">Или используйте `domain_hint=organizations`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-331">Otherwise, use `domain_hint=organizations`.</span></span> |

<span data-ttu-id="eb1cc-332">Если задать параметр `prompt=none`, то этот запрос успешно выполнится или немедленно завершится с ошибкой, и вы вернетесь к своему приложению.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-332">By setting the `prompt=none` parameter, this request either succeeds or fails immediately, and returns to your application.</span></span>  <span data-ttu-id="eb1cc-333">Успешный ответ будет отправлен в ваше приложение на указанный URI перенаправления с помощью метода, заданного в параметре `response_mode`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-333">A successful response is sent to your app at the indicated redirect URI, by using the method specified in the `response_mode` parameter.</span></span>

### <a name="successful-response"></a><span data-ttu-id="eb1cc-334">Успешный ответ</span><span class="sxs-lookup"><span data-stu-id="eb1cc-334">Successful response</span></span>
<span data-ttu-id="eb1cc-335">Успешный ответ с использованием `response_mode=fragment` выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-335">A successful response by using `response_mode=fragment` looks like this:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=arbitrary_data_you_sent_earlier
&token_type=Bearer
&expires_in=3599
&scope=https%3A%2F%2Fapi.contoso.com%2Ftasks.read
```

| <span data-ttu-id="eb1cc-336">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-336">Parameter</span></span> | <span data-ttu-id="eb1cc-337">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-337">Description</span></span> |
| --- | --- |
| <span data-ttu-id="eb1cc-338">access_token</span><span class="sxs-lookup"><span data-stu-id="eb1cc-338">access_token</span></span> |<span data-ttu-id="eb1cc-339">Маркер, запрошенный приложением.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-339">The token that the app requested.</span></span> |
| <span data-ttu-id="eb1cc-340">token_type</span><span class="sxs-lookup"><span data-stu-id="eb1cc-340">token_type</span></span> |<span data-ttu-id="eb1cc-341">Маркер всегда будет иметь тип Bearer (Носитель).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-341">The token type will always be Bearer.</span></span> |
| <span data-ttu-id="eb1cc-342">state</span><span class="sxs-lookup"><span data-stu-id="eb1cc-342">state</span></span> |<span data-ttu-id="eb1cc-343">Если запрос содержит параметр `state`, то в ответе должно отображаться то же значение.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-343">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="eb1cc-344">Приложение должно проверить, совпадают ли значения параметра `state` в запросе и ответе.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-344">The app should verify that the `state` values in the request and response are identical.</span></span> |
| <span data-ttu-id="eb1cc-345">expires_in</span><span class="sxs-lookup"><span data-stu-id="eb1cc-345">expires_in</span></span> |<span data-ttu-id="eb1cc-346">Срок действия маркера доступа (в секундах).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-346">How long the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="eb1cc-347">scope</span><span class="sxs-lookup"><span data-stu-id="eb1cc-347">scope</span></span> |<span data-ttu-id="eb1cc-348">Области, для которых действителен маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-348">The scopes that the access token is valid for.</span></span> |

### <a name="error-response"></a><span data-ttu-id="eb1cc-349">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="eb1cc-349">Error response</span></span>
<span data-ttu-id="eb1cc-350">Сообщения об ошибках также можно отправлять на универсальный код ресурса (URI) перенаправления, чтобы приложение могло их правильно обработать.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-350">Error responses also can be sent to the redirect URI so that the app can handle them appropriately.</span></span>  <span data-ttu-id="eb1cc-351">Для `prompt=none` ожидаемая ошибка выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-351">For `prompt=none`, an expected error looks like this:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=user_authentication_required
&error_description=the+request+could+not+be+completed+silently
```

| <span data-ttu-id="eb1cc-352">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-352">Parameter</span></span> | <span data-ttu-id="eb1cc-353">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-353">Description</span></span> |
| --- | --- |
| <span data-ttu-id="eb1cc-354">error</span><span class="sxs-lookup"><span data-stu-id="eb1cc-354">error</span></span> |<span data-ttu-id="eb1cc-355">Строка кода ошибки, которую можно использовать для классификации типов возникающих ошибок.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-355">An error code string that can be used to classify types of errors that occur.</span></span> <span data-ttu-id="eb1cc-356">Эту строку также можно использовать для реагирования на ошибки.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-356">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="eb1cc-357">error_description</span><span class="sxs-lookup"><span data-stu-id="eb1cc-357">error_description</span></span> |<span data-ttu-id="eb1cc-358">Конкретное сообщение об ошибке, с помощью которого можно определить первопричину возникновения ошибки аутентификации.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-358">A specific error message that can help you identify the root cause of an authentication error.</span></span> |

<span data-ttu-id="eb1cc-359">После появления этой ошибки в запросе iframe пользователю необходимо войти еще раз в интерактивном режиме для получения нового маркера.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-359">If you receive this error in the iframe request, the user must interactively sign in again to retrieve a new token.</span></span> <span data-ttu-id="eb1cc-360">Это можно обрабатывать любым способом, который лучше всего подходит для вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-360">You can handle this in a way that makes sense for your application.</span></span>

## <a name="refresh-tokens"></a><span data-ttu-id="eb1cc-361">Маркеры обновления</span><span class="sxs-lookup"><span data-stu-id="eb1cc-361">Refresh tokens</span></span>
<span data-ttu-id="eb1cc-362">Срок действия маркеров идентификации и доступа достаточно короткий.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-362">ID tokens and access tokens both expire after a short period of time.</span></span> <span data-ttu-id="eb1cc-363">Поэтому приложение должно быть готово периодически обновлять их.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-363">Your app must be prepared to refresh these tokens periodically.</span></span>  <span data-ttu-id="eb1cc-364">Чтобы обновить маркер любого типа, выполните тот же скрытый запрос iframe, который использовался в предыдущем примере, используя параметр `prompt=none` для управления действиями Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-364">To refresh either type of token, perform the same hidden iframe request we used in an earlier example, by using the `prompt=none` parameter to control Azure AD steps.</span></span>  <span data-ttu-id="eb1cc-365">Чтобы получить новое значение `id_token`, обязательно используйте `response_type=id_token` и `scope=openid`, а также параметр `nonce`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-365">To receive a new `id_token` value, be sure to use `response_type=id_token` and `scope=openid`, and a `nonce` parameter.</span></span>

## <a name="send-a-sign-out-request"></a><span data-ttu-id="eb1cc-366">Отправка запроса на выход</span><span class="sxs-lookup"><span data-stu-id="eb1cc-366">Send a sign-out request</span></span>
<span data-ttu-id="eb1cc-367">Для выхода пользователя из приложения перенаправьте его в Azure AD для выполнения выхода.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-367">When you want to sign the user out of the app, redirect the user to Azure AD to sign out.</span></span> <span data-ttu-id="eb1cc-368">Если этого не сделать, то пользователи смогут снова пройти аутентификацию в приложении без ввода учетных данных,</span><span class="sxs-lookup"><span data-stu-id="eb1cc-368">If you don't do this, the user might be able to reauthenticate to your app without entering their credentials again.</span></span> <span data-ttu-id="eb1cc-369">так как они будут иметь действительный сеанс единого входа с Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-369">This is because they will have a valid single sign-on session with Azure AD.</span></span>

<span data-ttu-id="eb1cc-370">Можно просто перенаправить пользователя на точку `end_session_endpoint`, которая указана в том же документе метаданных OpenID Connect, описанном выше в разделе [Проверка маркера идентификации](#validate-the-id-token).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-370">You can simply redirect the user to the `end_session_endpoint` that is listed in the same OpenID Connect metadata document described in [Validate the ID token](#validate-the-id-token).</span></span> <span data-ttu-id="eb1cc-371">Например:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-371">For example:</span></span>

```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?
p=b2c_1_sign_in
&post_logout_redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
```

| <span data-ttu-id="eb1cc-372">Параметр</span><span class="sxs-lookup"><span data-stu-id="eb1cc-372">Parameter</span></span> | <span data-ttu-id="eb1cc-373">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="eb1cc-373">Required?</span></span> | <span data-ttu-id="eb1cc-374">Описание</span><span class="sxs-lookup"><span data-stu-id="eb1cc-374">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="eb1cc-375">p</span><span class="sxs-lookup"><span data-stu-id="eb1cc-375">p</span></span> |<span data-ttu-id="eb1cc-376">Обязательно</span><span class="sxs-lookup"><span data-stu-id="eb1cc-376">Required</span></span> |<span data-ttu-id="eb1cc-377">Политика, которую необходимо использовать для выхода пользователя из приложения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-377">The policy to use to sign the user out of your application.</span></span> |
| <span data-ttu-id="eb1cc-378">post_logout_redirect_uri</span><span class="sxs-lookup"><span data-stu-id="eb1cc-378">post_logout_redirect_uri</span></span> |<span data-ttu-id="eb1cc-379">Рекомендуется</span><span class="sxs-lookup"><span data-stu-id="eb1cc-379">Recommended</span></span> |<span data-ttu-id="eb1cc-380">URL-адрес, на который пользователя следует перенаправить после успешного выхода.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-380">The URL that the user should be redirected to after successful sign-out.</span></span> <span data-ttu-id="eb1cc-381">Если он не указан, то Azure AD B2C покажет пользователю универсальное сообщение.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-381">If it is not included, Azure AD B2C displays a generic message to the user.</span></span> |

> [!NOTE]
> <span data-ttu-id="eb1cc-382">При перенаправлении пользователя на `end_session_endpoint` очищается часть его данных состояния единого входа через Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-382">Directing the user to the `end_session_endpoint` clears some of the user's single sign-on state with Azure AD B2C.</span></span> <span data-ttu-id="eb1cc-383">Хотя фактически пользователь не выходит из сеанса поставщика удостоверений социальных сетей.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-383">However, it doesn't sign the user out of the user's social identity provider session.</span></span> <span data-ttu-id="eb1cc-384">Если пользователь выберет тот же поставщик удостоверений во время последующего входа, то он будет повторно аутентифицирован без ввода учетных данных.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-384">If the user selects the same identify provider during a subsequent sign-in, the user is reauthenticated, without entering their credentials.</span></span> <span data-ttu-id="eb1cc-385">Например, если пользователь хочет выйти из приложения Azure AD B2C, то это совершенно не означает, что он также хочет полностью выйти из учетной записи Facebook.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-385">If a user wants to sign out of your Azure AD B2C application, it does not necessarily mean they want to completely sign out of their Facebook account, for example.</span></span> <span data-ttu-id="eb1cc-386">Тем не менее для локальных учетных записей необходимо правильно завершить сеанс пользователя.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-386">However, for local accounts, the user's session will be ended properly.</span></span>
> 
> 

## <a name="use-your-own-azure-ad-b2c-tenant"></a><span data-ttu-id="eb1cc-387">Использование собственного клиента Azure AD B2C</span><span class="sxs-lookup"><span data-stu-id="eb1cc-387">Use your own Azure AD B2C tenant</span></span>
<span data-ttu-id="eb1cc-388">Чтобы отправить эти запросы самостоятельно, выполните следующие три действия.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-388">To try these requests yourself, complete the following three steps.</span></span> <span data-ttu-id="eb1cc-389">Замените значения, приведенные в этой статье в качестве примера, собственными значениями:</span><span class="sxs-lookup"><span data-stu-id="eb1cc-389">Replace the example values we use in this article with your own values:</span></span>

1. <span data-ttu-id="eb1cc-390">[Создайте клиента Azure AD B2C](active-directory-b2c-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="eb1cc-390">[Create an Azure AD B2C tenant](active-directory-b2c-get-started.md).</span></span> <span data-ttu-id="eb1cc-391">Используйте имя своего клиента в запросах.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-391">Use the name of your tenant in the requests.</span></span>
2. <span data-ttu-id="eb1cc-392">[Создайте приложение](active-directory-b2c-app-registration.md) для получения идентификатора приложения и значения `redirect_uri`.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-392">[Create an application](active-directory-b2c-app-registration.md) to obtain an application ID and a `redirect_uri` value.</span></span> <span data-ttu-id="eb1cc-393">Включите в свое приложение веб-приложение или веб-API.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-393">Include a web app or web API in your app.</span></span> <span data-ttu-id="eb1cc-394">При необходимости можно также создать секретный код приложения.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-394">Optionally, you can create an application secret.</span></span>
3. <span data-ttu-id="eb1cc-395">[Создайте собственные политики](active-directory-b2c-reference-policies.md) для получения имен политик.</span><span class="sxs-lookup"><span data-stu-id="eb1cc-395">[Create your policies](active-directory-b2c-reference-policies.md) to obtain your policy names.</span></span>

## <a name="samples"></a><span data-ttu-id="eb1cc-396">Примеры</span><span class="sxs-lookup"><span data-stu-id="eb1cc-396">Samples</span></span>

* [<span data-ttu-id="eb1cc-397">Создание одностраничного приложения с помощью Node.js</span><span class="sxs-lookup"><span data-stu-id="eb1cc-397">Create a single-page app by using Node.js</span></span>](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-nodejs-webapi)
* [<span data-ttu-id="eb1cc-398">Создание одностраничного приложения с помощью .NET</span><span class="sxs-lookup"><span data-stu-id="eb1cc-398">Create a single-page app by using .NET</span></span>](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-dotnet-webapi)

