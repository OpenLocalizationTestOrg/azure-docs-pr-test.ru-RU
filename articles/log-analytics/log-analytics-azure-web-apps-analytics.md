---
title: "Просмотр аналитических данных веб-приложений Azure | Документация Майкрософт"
description: "Аналитику веб-приложений Azure можно использовать для углубленного анализа данных веб-приложений Azure при сборе разных метрик ресурсов веб-приложений Azure."
services: log-analytics
documentationcenter: 
author: bandersmsft
manager: carmonm
editor: 
ms.assetid: 20ff337f-b1a3-4696-9b5a-d39727a94220
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/11/2017
ms.author: banders
ms.openlocfilehash: d910339cc35e09705e543706b40dfe8e0ea9dd42
ms.sourcegitcommit: 922687d91838b77c038c68b415ab87d94729555e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2017
---
# <a name="view-analytic-data-for-metrics-across-all-your-azure-web-app-resources"></a>Просмотр аналитических данных для метрик ресурсов веб-приложений Azure

![Символ веб-приложений](./media/log-analytics-azure-web-apps-analytics/azure-web-apps-analytics-symbol.png)  
Аналитику веб-приложений Azure (предварительная версия) можно использовать для углубленного анализа данных [веб-приложений Azure](../app-service/app-service-web-overview.md) при сборе разных метрик ресурсов веб-приложений Azure. Это решение позволяет анализировать и искать данные метрик ресурсов веб-приложений.

Это решение позволяет просматривать:

- основные веб-приложения с наибольшим временем отклика;
- число запросов в веб-приложениях, включая успешные и неудачные попытки запросов;
- основные веб-приложения с самым высоким входящим и исходящим трафиком;
- основные планы обслуживания с высокой загрузкой ЦП и использованием памяти;
- операции журнала действий веб-приложений Azure;

## <a name="connected-sources"></a>Подключенные источники

В отличие от большинства других решений Log Analytics, данные для веб-приложений Azure не собираются агентами. Все данные, используемые решением, поступают непосредственно из Azure.

| Подключенный источник | Поддерживаются | ОПИСАНИЕ |
| --- | --- | --- |
| [Агенты Windows](log-analytics-windows-agent.md) | Нет  | Решение не собирает сведения из агентов Windows. |
| [Агенты Linux](log-analytics-linux-agents.md) | Нет  | Решение не собирает сведения из агентов Linux. |
| [Группы управления SCOM](log-analytics-om-agents.md) | Нет  | Решение не собирает сведения из агентов в подключенной группе управления SCOM. |
| [Учетная запись хранения Azure](log-analytics-azure-storage.md) | Нет  | Решение не собирает сведения из службы хранилища Azure. |

## <a name="prerequisites"></a>Технические условия

- Для доступа к данным метрик веб-приложений Azure необходима подписка Azure.

## <a name="configuration"></a>Параметр Configuration

Выполните следующие действия, чтобы настроить решение "Аналитика веб-приложений Azure" в рабочих областях.

1. Включите решение "Аналитика веб-приложений Azure" из [Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/Microsoft.AzureWebAppsAnalyticsOMS?tab=Overview) или выполните инструкции по [добавлению решений Log Analytics из коллекции решений](log-analytics-add-solutions.md).
2. [Включите ведение журнала метрик ресурсов Azure для OMS с помощью PowerShell](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell).

Решение "Аналитика веб-приложений Azure" собирает два набора метрик из Azure:

- метрики веб-приложений Azure;
  - средний размер рабочего набора памяти;
  - Среднее время ответа:
  - полученные и отправленные байты;
  - Время ЦП:
  - Requests
  - рабочий набор памяти;
  - Httpxxx.
- Метрики плана службы приложений
  - полученные и отправленные байты;
  - Процент использования ЦП
  - Длина дисковой очереди
  - Длина очереди HTTP:
  - Процент использования памяти

Метрики плана службы приложения собираются, только если вы используете выделенный план службы. Это не относится к планам службы приложений категории "Бесплатный" или "Общий".

При добавлении решения с помощью портала OMS отображается следующая плитка. Вам нужно [включить ведение журнала метрик ресурсов Azure для OMS с помощью PowerShell](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell).

![Уведомление "Выполнение оценки"](./media/log-analytics-azure-web-apps-analytics/performing-assessment.png)

После настройки решения данные начнут поступать в рабочую область в течение 15 минут.

## <a name="using-the-solution"></a>Использование решения

Когда вы добавляете решение "Аналитика веб-приложений Azure" в рабочую область, на панель мониторинга "Обзор" добавляется плитка **Аналитика веб-приложений Azure**. На этой плитке отображается число веб-приложений Azure для подписки Azure, которая доступна для решения.

![Плитка "Аналитика веб-приложений Azure"](./media/log-analytics-azure-web-apps-analytics/azure-web-apps-analytics-tile.png)

### <a name="view-azure-web-apps-analytics-information"></a>Просмотр сведений решения "Аналитика веб-приложений Azure"

Щелкните плитку **Аналитика веб-приложений Azure**, чтобы открыть панель мониторинга **Аналитика веб-приложений Azure**. Панель мониторинга содержит колонки, перечисленные в приведенной ниже таблице. В каждой колонке содержится до 10 элементов, соответствующих критериям для определенных области действия и диапазона времени. Вы можете выполнить поиск по журналам, в результате которого возвращаются все записи, если щелкнуть заголовок колонки или **Показать все** в ее нижней части.

[!include[log-analytics-log-search-nextgeneration](../../includes/log-analytics-log-search-nextgeneration.md)]

| столбец | ОПИСАНИЕ |
| --- | --- |
| Веб-приложения Azure |   |
| Тенденции в запросах веб-приложений | Показывает график тенденций в запросах веб-приложений для выбранного диапазона дат, а также список из десяти основных веб-запросов. Щелкните график, чтобы выполнить поиск по журналам: <code>Type=AzureMetrics ResourceId=*"/MICROSOFT.WEB/SITES/"* (MetricName=Requests OR MetricName=Http*) &#124; measure avg(Average) by MetricName interval 1HOUR</code> <br>Щелкните элемент веб-запроса, чтобы выполнить поиск по журналам, который вернет тенденции в метриках веб-запросов. |
| Время отклика веб-приложений | Показывает график времени отклика веб-приложений для выбранного диапазона дат. Также показывает список из десяти основных записей о времени отклика веб-приложений. Щелкните диаграмму, чтобы выполнить поиск по журналам: <code>Type:AzureMetrics ResourceId=*"/MICROSOFT.WEB/SITES/"* MetricName="AverageResponseTime" &#124; measure avg(Average) by Resource interval 1HOUR</code>.<br> Щелкните веб-приложение, чтобы выполнить поиск по журналам, который вернет время отклика для веб-приложений. |
| Трафик веб-приложений | Показывает график трафика веб-приложений (в МБ), а также самый большой трафик веб-приложений. Щелкните диаграмму, чтобы выполнить поиск по журналам: <code>Type:AzureMetrics ResourceId=*"/MICROSOFT.WEB/SITES/"*  MetricName=BytesSent OR BytesReceived &#124; measure sum(Average) by Resource interval 1HOUR</code>.<br> Показывает все веб-приложения с трафиком за последнюю минуту. Щелкните веб-приложение, чтобы выполнить поиск по журналам, который вернет число получаемых и отправляемых для веб-приложения байт. |
| Планы службы приложений Azure |   |
| Планы службы приложений с использованием ЦП на уровне &gt; 80 % | Показывает общее число планов службы приложений, использующих ЦП на уровне более 80 %, а также список из 10 основных планов службы приложений по использованию ЦП. Щелкните всю область, чтобы выполнить поиск по журналам: <code>Type=AzureMetrics ResourceId=*"/MICROSOFT.WEB/SERVERFARMS/"* MetricName=CpuPercentage &#124; measure Avg(Average) by Resource</code><br> Показывает список планов службы приложений и их средней показатель использования ЦП. Щелкните план службы приложений, чтобы выполнить поиск по журналам, который вернет его средний показатель использования ЦП. |
| Планы службы приложений с использованием памяти на уровне &gt; 80 % | Показывает общее число планов службы приложений, использующих память на уровне более 80 %, а также список из 10 основных планов службы приложений по использованию памяти. Щелкните всю область, чтобы выполнить поиск по журналам: <code>Type=AzureMetrics ResourceId=*"/MICROSOFT.WEB/SERVERFARMS/"* MetricName=MemoryPercentage &#124; measure Avg(Average) by Resource</code><br> Показывает список планов службы приложений и их средний показатель использования памяти. Щелкните план службы приложений, чтобы выполнить поиск по журналам, который вернет его средний показатель использования памяти. |
| Журналы действий веб-приложений Azure |   |
| Аудит действий веб-приложений Azure | Показывает общее число веб-приложений с [журналами действий](log-analytics-activity.md), а также список из 10 основных операций журнала действий. Щелкните всю область, чтобы выполнить поиск по журналам: <code>Type=AzureActivity ResourceProvider= "Azure Web Sites" &#124; measure count() by OperationName</code><br> Показывает список операций журнала действий. Щелкните операцию журнала действий, чтобы выполнить поиск по журналам, который возвращает список записей для операции. |



### <a name="azure-web-apps"></a>Веб-приложения Azure.

На панели мониторинга можно отобразить подробные сведения, которые помогут проанализировать метрики веб-приложений. В первом наборе колонок отображаются тенденции в запросах веб-приложений, номера ошибок (например, HTTP404), показатели трафика и среднее время отклика. Здесь также показано распределение этих метрик для разных веб-приложений.

![Колонки веб-приложений Azure](./media/log-analytics-azure-web-apps-analytics/web-apps-dash01.png)

Все эти данные отображаются главным образом для того, чтобы вы могли определить веб-приложение с высокими показателями времени отклика, а затем выяснить причину. Также можно использовать показатели пороговых значений. Это простой способ определения проблемных веб-приложений.

- У веб-приложений, выделенных красным цветом, время отклика превышает 1 секунду.
- У веб-приложений, выделенных оранжевым цветом, время отклика составляет более 0,7 секунды, но менее 1 секунды.
- У веб-приложений, выделенных зеленым цветом, время отклика составляет менее 0,7 секунды.

На следующем рисунке с поиском по журналам можно видеть, что у веб-приложения *anugup3* время отклика гораздо выше, чем у других веб-приложений.

![Пример поиска по журналам](./media/log-analytics-azure-web-apps-analytics/web-app-search-example.png)

### <a name="app-service-plans"></a>Планы службы приложений

Если вы используете выделенные планы службы, вы также можете собирать метрики для своих планов службы приложений. В этом представлении отображаются планы службы приложений с высокими показателями использования ЦП или памяти (&gt; 80 %). Здесь также перечислены основные службы приложений, которые потребляют больше всего памяти или ресурсов ЦП. Точно так же можно использовать показатели пороговых значений. Это простой способ определения проблемных служб веб-приложений.

- У планов службы приложений, выделенных красным цветом, показатели использования ЦП и памяти превышают 80 %.
- У планов службы приложений, выделенных оранжевым цветом, показатели использования ЦП и памяти составляют более 60 %, но менее 80 %.
- У планов службы приложений, выделенных зеленым цветом, показатели использования ЦП и памяти составляют менее 60 %.

![Колонки планов службы приложений Azure](./media/log-analytics-azure-web-apps-analytics/web-apps-dash02.png)

## <a name="azure-web-apps-log-searches"></a>Поиск по журналам веб-приложений Azure

В **списке популярных запросов поиска веб-приложений Azure** показаны все связанные журналы действий для веб-приложений. В них представлены аналитические сведения об операциях, которые выполнялись с ресурсами веб-приложений. Здесь также перечислены все связанные операции и указано количество выполнений этих операций.

Используя любой из запросов поиска по журналам в качестве отправной точки, можно легко создать оповещение. Например, можно создать оповещение, если среднее время отклика для метрики превышает 1 секунду.

## <a name="next-steps"></a>Дальнейшие действия

- Создание [оповещения](log-analytics-alerts-creating.md) для определенной метрики.
- Использование [поиска по журналам](log-analytics-log-searches.md) для просмотра подробных сведений из журналов действий.
