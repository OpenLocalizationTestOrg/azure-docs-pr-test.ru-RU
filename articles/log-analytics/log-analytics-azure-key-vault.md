---
title: "решение хранилища ключей в службе анализа журналов aaaAzure | Документы Microsoft"
description: "Можно использовать решение хранилища ключей Azure hello в tooreview аналитики журналов, журналов хранилища ключей Azure."
services: log-analytics
documentationcenter: 
author: richrundmsft
manager: jochan
editor: 
ms.assetid: 5e25e6d6-dd20-4528-9820-6e2958a40dae
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/09/2017
ms.author: richrund
ms.openlocfilehash: 1c6eae26ded7ad55b0159a3be09cdc9901596298
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-key-vault-analytics-solution-in-log-analytics"></a><span data-ttu-id="ded07-103">Решение Azure Key Vault Analytics в Log Analytics</span><span class="sxs-lookup"><span data-stu-id="ded07-103">Azure Key Vault Analytics solution in Log Analytics</span></span>

![Символ Key Vault](./media/log-analytics-azure-keyvault/key-vault-analytics-symbol.png)

<span data-ttu-id="ded07-105">Можно использовать решение хранилища ключей Azure hello в tooreview аналитики журналов, журналов AuditEvent хранилище ключей Azure.</span><span class="sxs-lookup"><span data-stu-id="ded07-105">You can use hello Azure Key Vault solution in Log Analytics tooreview Azure Key Vault AuditEvent logs.</span></span>

<span data-ttu-id="ded07-106">решение toouse hello, необходимо tooenable ведения журнала диагностики для хранилища ключей Azure и прямой hello диагностики tooa анализа журналов рабочей.</span><span class="sxs-lookup"><span data-stu-id="ded07-106">toouse hello solution, you need tooenable logging of Azure Key Vault diagnostics and direct hello diagnostics tooa Log Analytics workspace.</span></span> <span data-ttu-id="ded07-107">Это не hello журналы необходимые toowrite tooAzure-хранилище больших двоичных объектов.</span><span class="sxs-lookup"><span data-stu-id="ded07-107">It is not necessary toowrite hello logs tooAzure Blob storage.</span></span>

> [!NOTE]
> <span data-ttu-id="ded07-108">В января 2017 г hello поддерживается способ отправки журналов из хранилища ключей tooLog Analytics изменено.</span><span class="sxs-lookup"><span data-stu-id="ded07-108">In January 2017, hello supported way of sending logs from Key Vault tooLog Analytics changed.</span></span> <span data-ttu-id="ded07-109">При использовании решения хранилища ключей hello показывает *(устарело)* в заголовок hello, ссылаетесь слишком[миграция из старого решения хранилища ключей hello](#migrating-from-the-old-key-vault-solution) для действия необходимы toofollow.</span><span class="sxs-lookup"><span data-stu-id="ded07-109">If hello Key Vault solution you are using shows *(deprecated)* in hello title, refer too[migrating from hello old Key Vault solution](#migrating-from-the-old-key-vault-solution) for steps you need toofollow.</span></span>
>
>

## <a name="install-and-configure-hello-solution"></a><span data-ttu-id="ded07-110">Установка и настройка решения hello</span><span class="sxs-lookup"><span data-stu-id="ded07-110">Install and configure hello solution</span></span>
<span data-ttu-id="ded07-111">Используйте следующие инструкции tooinstall hello и настроить решение hello хранилище ключей Azure:</span><span class="sxs-lookup"><span data-stu-id="ded07-111">Use hello following instructions tooinstall and configure hello Azure Key Vault solution:</span></span>

1. <span data-ttu-id="ded07-112">Включить решение hello хранилище ключей Azure из [Azure marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/Microsoft.KeyVaultAnalyticsOMS?tab=Overview) или с помощью hello процесс, описанный в [решений добавьте анализа журналов из коллекции решений hello](log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="ded07-112">Enable hello Azure Key Vault solution from [Azure marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/Microsoft.KeyVaultAnalyticsOMS?tab=Overview) or by using hello process described in [Add Log Analytics solutions from hello Solutions Gallery](log-analytics-add-solutions.md).</span></span>
2. <span data-ttu-id="ded07-113">Включение диагностики ведения журнала для toomonitor ресурсы hello хранилище ключей, с помощью либо hello [портала](#enable-key-vault-diagnostics-in-the-portal) или [PowerShell](#enable-key-vault-diagnostics-using-powershell)</span><span class="sxs-lookup"><span data-stu-id="ded07-113">Enable diagnostics logging for hello Key Vault resources toomonitor, using either hello [portal](#enable-key-vault-diagnostics-in-the-portal) or [PowerShell](#enable-key-vault-diagnostics-using-powershell)</span></span>

### <a name="enable-key-vault-diagnostics-in-hello-portal"></a><span data-ttu-id="ded07-114">Включение диагностики хранилища ключей на портале hello</span><span class="sxs-lookup"><span data-stu-id="ded07-114">Enable Key Vault diagnostics in hello portal</span></span>

1. <span data-ttu-id="ded07-115">Hello портал Azure перейдите toomonitor ресурсов toohello хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="ded07-115">In hello Azure portal, navigate toohello Key Vault resource toomonitor</span></span>
2. <span data-ttu-id="ded07-116">Выберите *журналы диагностики* после страницы приветствия tooopen</span><span class="sxs-lookup"><span data-stu-id="ded07-116">Select *Diagnostics logs* tooopen hello following page</span></span>

   ![изображение плитки "Хранилище ключей Azure"](./media/log-analytics-azure-keyvault/log-analytics-keyvault-enable-diagnostics01.png)
3. <span data-ttu-id="ded07-118">Нажмите кнопку *включить диагностику* после страницы приветствия tooopen</span><span class="sxs-lookup"><span data-stu-id="ded07-118">Click *Turn on diagnostics* tooopen hello following page</span></span>

   ![изображение плитки "Хранилище ключей Azure"](./media/log-analytics-azure-keyvault/log-analytics-keyvault-enable-diagnostics02.png)
4. <span data-ttu-id="ded07-120">Щелкните tooturn диагностику, *на* под *состояния*</span><span class="sxs-lookup"><span data-stu-id="ded07-120">tooturn on diagnostics, click *On* under *Status*</span></span>
5. <span data-ttu-id="ded07-121">Щелкните флажок hello *отправки tooLog аналитика*</span><span class="sxs-lookup"><span data-stu-id="ded07-121">Click hello checkbox for *Send tooLog Analytics*</span></span>
6. <span data-ttu-id="ded07-122">Выберите существующую рабочую область Log Analytics или создайте новую.</span><span class="sxs-lookup"><span data-stu-id="ded07-122">Select an existing Log Analytics workspace, or create a workspace</span></span>
7. <span data-ttu-id="ded07-123">tooenable *AuditEvent* журналы, установите флажок hello в журнал</span><span class="sxs-lookup"><span data-stu-id="ded07-123">tooenable *AuditEvent* logs, click hello checkbox under Log</span></span>
8. <span data-ttu-id="ded07-124">Нажмите кнопку *Сохранить* tooenable hello ведение журнала диагностики tooLog аналитика</span><span class="sxs-lookup"><span data-stu-id="ded07-124">Click *Save* tooenable hello logging of diagnostics tooLog Analytics</span></span>

### <a name="enable-key-vault-diagnostics-using-powershell"></a><span data-ttu-id="ded07-125">Включение диагностики Key Vault с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="ded07-125">Enable Key Vault diagnostics using PowerShell</span></span>
<span data-ttu-id="ded07-126">Hello следующий скрипт PowerShell приведен пример того, как toouse `Set-AzureRmDiagnosticSetting` tooenable ведения журналов диагностики для хранилища ключей:</span><span class="sxs-lookup"><span data-stu-id="ded07-126">hello following PowerShell script provides an example of how toouse `Set-AzureRmDiagnosticSetting` tooenable diagnostic logging for Key Vault:</span></span>
```
$workspaceId = "/subscriptions/d2e37fee-1234-40b2-5678-0b2199de3b50/resourcegroups/oi-default-east-us/providers/microsoft.operationalinsights/workspaces/rollingbaskets"

$kv = Get-AzureRmKeyVault -VaultName 'ContosoKeyVault'

Set-AzureRmDiagnosticSetting -ResourceId $kv.ResourceId  -WorkspaceId $workspaceId -Enabled $true
```



## <a name="review-azure-key-vault-data-collection-details"></a><span data-ttu-id="ded07-127">Просмотр сведений о сборе данных хранилища ключей Azure</span><span class="sxs-lookup"><span data-stu-id="ded07-127">Review Azure Key Vault data collection details</span></span>
<span data-ttu-id="ded07-128">Решение хранилища ключей Azure собирает журналы диагностики непосредственно из хранилища ключей hello.</span><span class="sxs-lookup"><span data-stu-id="ded07-128">Azure Key Vault solution collects diagnostics logs directly from hello Key Vault.</span></span>
<span data-ttu-id="ded07-129">Не является tooAzure журналы hello необходимые toowrite хранилища больших двоичных объектов и агент не требуется для сбора данных.</span><span class="sxs-lookup"><span data-stu-id="ded07-129">It is not necessary toowrite hello logs tooAzure Blob storage and no agent is required for data collection.</span></span>

<span data-ttu-id="ded07-130">Hello следующей таблице приведены методы сбора данных и другие сведения о сборе данных для хранилища ключей Azure.</span><span class="sxs-lookup"><span data-stu-id="ded07-130">hello following table shows data collection methods and other details about how data is collected for Azure Key Vault.</span></span>

| <span data-ttu-id="ded07-131">Платформа</span><span class="sxs-lookup"><span data-stu-id="ded07-131">Platform</span></span> | <span data-ttu-id="ded07-132">Direct Agent</span><span class="sxs-lookup"><span data-stu-id="ded07-132">Direct agent</span></span> | <span data-ttu-id="ded07-133">Агент Systems Center Operations Manager</span><span class="sxs-lookup"><span data-stu-id="ded07-133">Systems Center Operations Manager agent</span></span> | <span data-ttu-id="ded07-134">Таблицы Azure</span><span class="sxs-lookup"><span data-stu-id="ded07-134">Azure</span></span> | <span data-ttu-id="ded07-135">Нужен ли Operations Manager?</span><span class="sxs-lookup"><span data-stu-id="ded07-135">Operations Manager required?</span></span> | <span data-ttu-id="ded07-136">Отправка данных агента Operations Manager через группу управления</span><span class="sxs-lookup"><span data-stu-id="ded07-136">Operations Manager agent data sent via management group</span></span> | <span data-ttu-id="ded07-137">Частота сбора</span><span class="sxs-lookup"><span data-stu-id="ded07-137">Collection frequency</span></span> |
| --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="ded07-138">Таблицы Azure</span><span class="sxs-lookup"><span data-stu-id="ded07-138">Azure</span></span> |  |  |<span data-ttu-id="ded07-139">&#8226;</span><span class="sxs-lookup"><span data-stu-id="ded07-139">&#8226;</span></span> |  |  | <span data-ttu-id="ded07-140">при получении</span><span class="sxs-lookup"><span data-stu-id="ded07-140">on arrival</span></span> |

## <a name="use-azure-key-vault"></a><span data-ttu-id="ded07-141">Использование хранилища ключей Azure</span><span class="sxs-lookup"><span data-stu-id="ded07-141">Use Azure Key Vault</span></span>
<span data-ttu-id="ded07-142">По окончании [установки решения hello](https://azuremarketplace.microsoft.com/marketplace/apps/Microsoft.KeyVaultAnalyticsOMS?tab=Overview), просматривать данные хранилища ключей hello, щелкнув hello **хранилище ключей Azure** плитки из hello **Обзор** страницы аналитики журналов.</span><span class="sxs-lookup"><span data-stu-id="ded07-142">After you [install hello solution](https://azuremarketplace.microsoft.com/marketplace/apps/Microsoft.KeyVaultAnalyticsOMS?tab=Overview), view hello Key Vault data by clicking hello **Azure Key Vault** tile from hello **Overview** page of Log Analytics.</span></span>

![изображение плитки "Хранилище ключей Azure"](./media/log-analytics-azure-keyvault/log-analytics-keyvault-tile.png)

<span data-ttu-id="ded07-144">После нажатия кнопки hello **Обзор** плитки, можно просмотреть сводные данные журналов и затем в toodetails для hello, следующие категории:</span><span class="sxs-lookup"><span data-stu-id="ded07-144">After you click hello **Overview** tile, you can view summaries of your logs and then drill in toodetails for hello following categories:</span></span>

* <span data-ttu-id="ded07-145">количество всех операций хранилища ключей за определенный период;</span><span class="sxs-lookup"><span data-stu-id="ded07-145">Volume of all key vault operations over time</span></span>
* <span data-ttu-id="ded07-146">количество неудавшихся операций за определенный период;</span><span class="sxs-lookup"><span data-stu-id="ded07-146">Failed operation volumes over time</span></span>
* <span data-ttu-id="ded07-147">среднее время задержки для каждой операции;</span><span class="sxs-lookup"><span data-stu-id="ded07-147">Average operational latency by operation</span></span>
* <span data-ttu-id="ded07-148">Качество обслуживания для операций с hello количество операций, которые занимают более 1 000 мс и список операций, которые занимают более 1 000 мс.</span><span class="sxs-lookup"><span data-stu-id="ded07-148">Quality of service for operations with hello number of operations that take more than 1000 ms and a list of operations that take more than 1000 ms</span></span>

![изображение панели мониторинга хранилища ключей Azure](./media/log-analytics-azure-keyvault/log-analytics-keyvault01.png)

![изображение панели мониторинга хранилища ключей Azure](./media/log-analytics-azure-keyvault/log-analytics-keyvault02.png)

### <a name="tooview-details-for-any-operation"></a><span data-ttu-id="ded07-151">сведения о tooview для любой операции</span><span class="sxs-lookup"><span data-stu-id="ded07-151">tooview details for any operation</span></span>
1. <span data-ttu-id="ded07-152">На hello **Обзор** щелкните hello **хранилище ключей Azure** плитки.</span><span class="sxs-lookup"><span data-stu-id="ded07-152">On hello **Overview** page, click hello **Azure Key Vault** tile.</span></span>
2. <span data-ttu-id="ded07-153">На hello **хранилище ключей Azure** панели мониторинга, просмотрите сводные сведения о hello в одной из колонок hello и выберите один tooview подробные сведения о нем в hello страницы поиска журналов.</span><span class="sxs-lookup"><span data-stu-id="ded07-153">On hello **Azure Key Vault** dashboard, review hello summary information in one of hello blades, and then click one tooview detailed information about it in hello log search page.</span></span>

    <span data-ttu-id="ded07-154">На любой из страниц поиска журналов hello можно просмотреть результаты по времени, подробные результаты и историю поиска журналов.</span><span class="sxs-lookup"><span data-stu-id="ded07-154">On any of hello log search pages, you can view results by time, detailed results, and your log search history.</span></span> <span data-ttu-id="ded07-155">Можно также фильтровать по результатам hello toonarrow аспектов.</span><span class="sxs-lookup"><span data-stu-id="ded07-155">You can also filter by facets toonarrow hello results.</span></span>

## <a name="log-analytics-records"></a><span data-ttu-id="ded07-156">Записи Log Analytics</span><span class="sxs-lookup"><span data-stu-id="ded07-156">Log Analytics records</span></span>
<span data-ttu-id="ded07-157">Hello решения хранилища ключей Azure анализирует записей, имеющих тип **KeyVaults** , получаемые от [AuditEvent журналы](../key-vault/key-vault-logging.md) в системе диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="ded07-157">hello Azure Key Vault solution analyzes records that have a type of **KeyVaults** that are collected from [AuditEvent logs](../key-vault/key-vault-logging.md) in Azure Diagnostics.</span></span>  <span data-ttu-id="ded07-158">В следующей таблице hello имеют свойства для этих записей:</span><span class="sxs-lookup"><span data-stu-id="ded07-158">Properties for these records are in hello following table:</span></span>  

| <span data-ttu-id="ded07-159">Свойство</span><span class="sxs-lookup"><span data-stu-id="ded07-159">Property</span></span> | <span data-ttu-id="ded07-160">Описание</span><span class="sxs-lookup"><span data-stu-id="ded07-160">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="ded07-161">Тип</span><span class="sxs-lookup"><span data-stu-id="ded07-161">Type</span></span> |<span data-ttu-id="ded07-162">*AzureDiagnostics*</span><span class="sxs-lookup"><span data-stu-id="ded07-162">*AzureDiagnostics*</span></span> |
| <span data-ttu-id="ded07-163">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="ded07-163">SourceSystem</span></span> |<span data-ttu-id="ded07-164">*Таблицы Azure*</span><span class="sxs-lookup"><span data-stu-id="ded07-164">*Azure*</span></span> |
| <span data-ttu-id="ded07-165">CallerIpAddress</span><span class="sxs-lookup"><span data-stu-id="ded07-165">CallerIpAddress</span></span> |<span data-ttu-id="ded07-166">IP-адрес клиента hello, сделавшего запрос hello</span><span class="sxs-lookup"><span data-stu-id="ded07-166">IP address of hello client who made hello request</span></span> |
| <span data-ttu-id="ded07-167">Категория</span><span class="sxs-lookup"><span data-stu-id="ded07-167">Category</span></span> | <span data-ttu-id="ded07-168">*AuditEvent*</span><span class="sxs-lookup"><span data-stu-id="ded07-168">*AuditEvent*</span></span> |
| <span data-ttu-id="ded07-169">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="ded07-169">CorrelationId</span></span> |<span data-ttu-id="ded07-170">Необязательный идентификатор GUID, который hello клиента можно передать toocorrelate клиентские журналы с журналами (хранилище ключей) на стороне службы.</span><span class="sxs-lookup"><span data-stu-id="ded07-170">An optional GUID that hello client can pass toocorrelate client-side logs with service-side (Key Vault) logs.</span></span> |
| <span data-ttu-id="ded07-171">DurationMs</span><span class="sxs-lookup"><span data-stu-id="ded07-171">DurationMs</span></span> |<span data-ttu-id="ded07-172">Время, затраченное запроса REST API tooservice hello, в миллисекундах.</span><span class="sxs-lookup"><span data-stu-id="ded07-172">Time it took tooservice hello REST API request, in milliseconds.</span></span> <span data-ttu-id="ded07-173">Это время не включает задержки в сети, поэтому это время может не совпадать с моментом hello мер на стороне клиента hello.</span><span class="sxs-lookup"><span data-stu-id="ded07-173">This time does not include network latency, so hello time that you measure on hello client side might not match this time.</span></span> |
| <span data-ttu-id="ded07-174">HttpStatusCode_d</span><span class="sxs-lookup"><span data-stu-id="ded07-174">httpStatusCode_d</span></span> |<span data-ttu-id="ded07-175">Код состояния HTTP, возвращаемый запросом hello (например, *200*)</span><span class="sxs-lookup"><span data-stu-id="ded07-175">HTTP status code returned by hello request (for example, *200*)</span></span> |
| <span data-ttu-id="ded07-176">id_s</span><span class="sxs-lookup"><span data-stu-id="ded07-176">id_s</span></span> |<span data-ttu-id="ded07-177">Уникальный идентификатор запроса hello</span><span class="sxs-lookup"><span data-stu-id="ded07-177">Unique ID of hello request</span></span> |
| <span data-ttu-id="ded07-178">identity_claim_appid_g</span><span class="sxs-lookup"><span data-stu-id="ded07-178">identity_claim_appid_g</span></span> | <span data-ttu-id="ded07-179">Идентификатор GUID для идентификатора приложения hello</span><span class="sxs-lookup"><span data-stu-id="ded07-179">GUID for hello application id</span></span> |
| <span data-ttu-id="ded07-180">OperationName</span><span class="sxs-lookup"><span data-stu-id="ded07-180">OperationName</span></span> |<span data-ttu-id="ded07-181">Имя операции hello, как описано в документе [ведение журнала хранилища ключей Azure](../key-vault/key-vault-logging.md)</span><span class="sxs-lookup"><span data-stu-id="ded07-181">Name of hello operation, as documented in [Azure Key Vault Logging](../key-vault/key-vault-logging.md)</span></span> |
| <span data-ttu-id="ded07-182">OperationVersion</span><span class="sxs-lookup"><span data-stu-id="ded07-182">OperationVersion</span></span> |<span data-ttu-id="ded07-183">Версия REST API, необходимая для клиента hello (например *2015-06-01*)</span><span class="sxs-lookup"><span data-stu-id="ded07-183">REST API version requested by hello client (for example *2015-06-01*)</span></span> |
| <span data-ttu-id="ded07-184">requestUri_s</span><span class="sxs-lookup"><span data-stu-id="ded07-184">requestUri_s</span></span> |<span data-ttu-id="ded07-185">URI запроса hello</span><span class="sxs-lookup"><span data-stu-id="ded07-185">Uri of hello request</span></span> |
| <span data-ttu-id="ded07-186">Ресурс</span><span class="sxs-lookup"><span data-stu-id="ded07-186">Resource</span></span> |<span data-ttu-id="ded07-187">Имя хранилища ключей hello</span><span class="sxs-lookup"><span data-stu-id="ded07-187">Name of hello key vault</span></span> |
| <span data-ttu-id="ded07-188">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="ded07-188">ResourceGroup</span></span> |<span data-ttu-id="ded07-189">Группа ресурсов хранилища ключей hello</span><span class="sxs-lookup"><span data-stu-id="ded07-189">Resource group of hello key vault</span></span> |
| <span data-ttu-id="ded07-190">ResourceId</span><span class="sxs-lookup"><span data-stu-id="ded07-190">ResourceId</span></span> |<span data-ttu-id="ded07-191">Идентификатор ресурса диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="ded07-191">Azure Resource Manager Resource ID.</span></span> <span data-ttu-id="ded07-192">Для журналов хранилища ключей это hello хранилище ключей, идентификатор ресурса.</span><span class="sxs-lookup"><span data-stu-id="ded07-192">For Key Vault logs, this is hello Key Vault resource ID.</span></span> |
| <span data-ttu-id="ded07-193">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="ded07-193">ResourceProvider</span></span> |<span data-ttu-id="ded07-194">*MICROSOFT.KEYVAULT*</span><span class="sxs-lookup"><span data-stu-id="ded07-194">*MICROSOFT.KEYVAULT*</span></span> |
| <span data-ttu-id="ded07-195">ResourceType</span><span class="sxs-lookup"><span data-stu-id="ded07-195">ResourceType</span></span> | <span data-ttu-id="ded07-196">*VAULTS*</span><span class="sxs-lookup"><span data-stu-id="ded07-196">*VAULTS*</span></span> |
| <span data-ttu-id="ded07-197">ResultSignature</span><span class="sxs-lookup"><span data-stu-id="ded07-197">ResultSignature</span></span> |<span data-ttu-id="ded07-198">Код состояния HTTP (например, *ОК*)</span><span class="sxs-lookup"><span data-stu-id="ded07-198">HTTP status (for example, *OK*)</span></span> |
| <span data-ttu-id="ded07-199">ResultType</span><span class="sxs-lookup"><span data-stu-id="ded07-199">ResultType</span></span> |<span data-ttu-id="ded07-200">Результат запроса REST API (например, *Успешно*)</span><span class="sxs-lookup"><span data-stu-id="ded07-200">Result of REST API request (for example, *Success*)</span></span> |
| <span data-ttu-id="ded07-201">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="ded07-201">SubscriptionId</span></span> |<span data-ttu-id="ded07-202">Идентификатор подписки Azure hello подписку, содержащую hello хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="ded07-202">Azure subscription ID of hello subscription containing hello Key Vault</span></span> |

## <a name="migrating-from-hello-old-key-vault-solution"></a><span data-ttu-id="ded07-203">Миграция из старого решения хранилища ключей hello</span><span class="sxs-lookup"><span data-stu-id="ded07-203">Migrating from hello old Key Vault solution</span></span>
<span data-ttu-id="ded07-204">В января 2017 г hello поддерживается способ отправки журналов из хранилища ключей tooLog Analytics изменено.</span><span class="sxs-lookup"><span data-stu-id="ded07-204">In January 2017, hello supported way of sending logs from Key Vault tooLog Analytics changed.</span></span> <span data-ttu-id="ded07-205">Эти изменения обеспечивают hello следующие преимущества:</span><span class="sxs-lookup"><span data-stu-id="ded07-205">These changes provide hello following advantages:</span></span>
+ <span data-ttu-id="ded07-206">Журналы записываются напрямую tooLog Analytics без hello требуется toouse учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="ded07-206">Logs are written directly tooLog Analytics without hello need toouse a storage account</span></span>
+ <span data-ttu-id="ded07-207">Меньше задержка из hello время, когда журналы, созданные toothem, недоступными в службе анализа журналов</span><span class="sxs-lookup"><span data-stu-id="ded07-207">Less latency from hello time when logs are generated toothem being available in Log Analytics</span></span>
+ <span data-ttu-id="ded07-208">Меньше этапов настройки.</span><span class="sxs-lookup"><span data-stu-id="ded07-208">Fewer configuration steps</span></span>
+ <span data-ttu-id="ded07-209">Общий формат для всех типов системы диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="ded07-209">A common format for all types of Azure diagnostics</span></span>

<span data-ttu-id="ded07-210">toouse hello обновление решения:</span><span class="sxs-lookup"><span data-stu-id="ded07-210">toouse hello updated solution:</span></span>

1. [<span data-ttu-id="ded07-211">Настройка диагностики toobe tooLog Analytics отправляется непосредственно из хранилища ключей</span><span class="sxs-lookup"><span data-stu-id="ded07-211">Configure diagnostics toobe sent directly tooLog Analytics from Key Vault</span></span>](#enable-key-vault-diagnostics-in-the-portal)  
2. <span data-ttu-id="ded07-212">Включить решение hello хранилище ключей Azure с помощью hello процесс, описанный в [решений добавьте анализа журналов из hello коллекции решений](log-analytics-add-solutions.md)</span><span class="sxs-lookup"><span data-stu-id="ded07-212">Enable hello Azure Key Vault solution by using hello process described in [Add Log Analytics solutions from hello Solutions Gallery](log-analytics-add-solutions.md)</span></span>
3. <span data-ttu-id="ded07-213">Обновить все сохраненные запросы, панели мониторинга и новый тип данных оповещения toouse hello</span><span class="sxs-lookup"><span data-stu-id="ded07-213">Update any saved queries, dashboards, or alerts toouse hello new data type</span></span>
  + <span data-ttu-id="ded07-214">Тип — изменение с: KeyVaults tooAzureDiagnostics.</span><span class="sxs-lookup"><span data-stu-id="ded07-214">Type is change from: KeyVaults tooAzureDiagnostics.</span></span> <span data-ttu-id="ded07-215">Можно использовать hello ResourceType toofilter tooKey хранилище журналов.</span><span class="sxs-lookup"><span data-stu-id="ded07-215">You can use hello ResourceType toofilter tooKey Vault Logs.</span></span>
  - <span data-ttu-id="ded07-216">Вместо `Type=KeyVaults` используйте `Type=AzureDiagnostics ResourceType=VAULTS`.</span><span class="sxs-lookup"><span data-stu-id="ded07-216">Instead of: `Type=KeyVaults`, use `Type=AzureDiagnostics ResourceType=VAULTS`</span></span>
  + <span data-ttu-id="ded07-217">Поля (в именах полей учитывается регистр).</span><span class="sxs-lookup"><span data-stu-id="ded07-217">Fields: (Field names are case-sensitive)</span></span>
  - <span data-ttu-id="ded07-218">Для любого поля, имеет суффикс \_s, \_d, или \_g в поле имя hello hello первый символ toolower регистр</span><span class="sxs-lookup"><span data-stu-id="ded07-218">For any field that has a suffix of \_s, \_d, or \_g in hello name, change hello first character toolower case</span></span>
  - <span data-ttu-id="ded07-219">Для любого поля, имеет суффикс \_«o» в имени hello данных разбивается на отдельные поля на основе имен hello вложенные поля.</span><span class="sxs-lookup"><span data-stu-id="ded07-219">For any field that has a suffix of \_o in name, hello data is split into individual fields based on hello nested field names.</span></span> <span data-ttu-id="ded07-220">Например hello UPN вызывающему Привет хранится в поле`identity_claim_http_schemas_xmlsoap_org_ws_2005_05_identity_claims_upn_s`</span><span class="sxs-lookup"><span data-stu-id="ded07-220">For example, hello UPN of hello caller is stored in a field `identity_claim_http_schemas_xmlsoap_org_ws_2005_05_identity_claims_upn_s`</span></span>
   - <span data-ttu-id="ded07-221">TooCallerIPAddress CallerIpAddress поля изменен</span><span class="sxs-lookup"><span data-stu-id="ded07-221">Field CallerIpAddress changed tooCallerIPAddress</span></span>
   - <span data-ttu-id="ded07-222">Поле RemoteIPCountry больше не используется.</span><span class="sxs-lookup"><span data-stu-id="ded07-222">Field RemoteIPCountry is no longer present</span></span>
4. <span data-ttu-id="ded07-223">Удалите hello *аналитика хранилища ключей (не рекомендуется)* решения.</span><span class="sxs-lookup"><span data-stu-id="ded07-223">Remove hello *Key Vault Analytics (Deprecated)* solution.</span></span> <span data-ttu-id="ded07-224">Если используется PowerShell, то выполните следующую команду: `Set-AzureOperationalInsightsIntelligencePack -ResourceGroupName <resource group that hello workspace is in> -WorkspaceName <name of hello log analytics workspace> -IntelligencePackName "KeyVault" -Enabled $false`</span><span class="sxs-lookup"><span data-stu-id="ded07-224">If you are using PowerShell, use `Set-AzureOperationalInsightsIntelligencePack -ResourceGroupName <resource group that hello workspace is in> -WorkspaceName <name of hello log analytics workspace> -IntelligencePackName "KeyVault" -Enabled $false`</span></span>

<span data-ttu-id="ded07-225">Данные, собранные до вызова hello изменений не отображается в новом решении hello.</span><span class="sxs-lookup"><span data-stu-id="ded07-225">Data collected before hello change is not visible in hello new solution.</span></span> <span data-ttu-id="ded07-226">Вы можете продолжить tooquery для этого данные с помощью hello и старый тип и имена полей.</span><span class="sxs-lookup"><span data-stu-id="ded07-226">You can continue tooquery for this data using hello old Type and field names.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="ded07-227">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="ded07-227">Troubleshooting</span></span>
[!INCLUDE [log-analytics-troubleshoot-azure-diagnostics](../../includes/log-analytics-troubleshoot-azure-diagnostics.md)]

## <a name="next-steps"></a><span data-ttu-id="ded07-228">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="ded07-228">Next steps</span></span>
* <span data-ttu-id="ded07-229">Используйте [входа поиска аналитики журналов](log-analytics-log-searches.md) tooview подробных данных хранилища ключей Azure.</span><span class="sxs-lookup"><span data-stu-id="ded07-229">Use [Log searches in Log Analytics](log-analytics-log-searches.md) tooview detailed Azure Key Vault data.</span></span>
