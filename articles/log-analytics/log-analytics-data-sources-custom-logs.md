---
title: "aaaCollect пользовательские журналы в аналитику журнала OMS | Документы Microsoft"
description: "Служба Log Analytics может собирать события из текстовых файлов на компьютерах Windows и Linux.  В этой статье описывается toodefine новый пользовательский журнал и сведения о записи hello их создания в репозитории OMS hello."
services: log-analytics
documentationcenter: 
author: bwren
manager: jwhit
editor: tysonn
ms.assetid: aca7f6bb-6f53-4fd4-a45c-93f12ead4ae1
ms.service: log-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/15/2017
ms.author: bwren
ms.openlocfilehash: a75d058c371fecf7c43690a797d4e650c1570317
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="custom-logs-in-log-analytics"></a>Настраиваемые журналы в службе Log Analytics
источник данных настраиваемые журналы Hello в службе анализа журналов позволяет toocollect события из текстовых файлов на компьютерах Windows и Linux. Во многих приложениях файлам сведения tootext вместо стандартной службы ведения журнала, такие как системный журнал и журнал событий Windows.  После сбора, можно выполнить синтаксический анализ каждой записи в журнале hello в полях tooindividual, с помощью hello [настраиваемые поля](log-analytics-custom-fields.md) функции аналитики журналов.

![Сбор данных из настраиваемых журналов](media/log-analytics-data-sources-custom-logs/overview.png)

Hello журнала файлов toobe собранные должно соответствовать hello следующие условия.

- Hello журнала необходимо иметь одну запись в строке или использовать соответствующий timestamp, одно из следующих hello форматы в начале каждой операции hello.

    ГГГГ-ММ-ДД ЧЧ:ММ:СС; <br>М/Д/ГГГГ ЧЧ:ММ:СС AM/PM (12-часовой формат); <br>М ДД, ГГГГ ЧЧ:ММ:СС.

- файл журнала Hello не должно допускать циклические обновлений где hello файл перезаписывается новых записей.
- файл журнала Hello должен использовать кодировку ASCII или UTF-8.  Другие форматы, например UTF-16, не поддерживаются.

>[!NOTE]
>Если имеются повторяющиеся записи в файл журнала hello, служба аналитики журналов будет собирать их.  Тем не менее результаты поиска hello будет согласовано где результаты фильтрации hello Показать больше событий, чем число результатов hello.  Будет ли это важно проверить toodetermine hello журнала, если приложение hello, который его создал вызывает это поведение и по возможности его адрес перед созданием определения collection hello пользовательского журнала.  
>
  
## <a name="defining-a-custom-log"></a>Определение настраиваемого журнала
Используйте следующие процедуры toodefine файл пользовательского журнала hello.  Прокрутите toohello конце статьи Пошаговое руководство образца добавления пользовательского журнала.

### <a name="step-1-open-hello-custom-log-wizard"></a>Шаг 1. Откройте hello журнала специальный мастер
Hello специальный мастер журнала выполняется на портале OMS hello и позволяет вам toodefine новый toocollect пользовательского журнала.

1. На портале OMS hello, go слишком**параметры**.
2. Выберите вкладку **Данные**, а затем — раздел **Настраиваемые журналы**.
3. По умолчанию все изменения конфигурации автоматически размещаемых tooall агентов.  Агенты Linux файл конфигурации отправляется сборщик данных Fluentd toohello.  Если вы хотите toomodify этот файл вручную на каждом агенте Linux, затем снимите флажок hello *применить указанную ниже компьютеры Linux toomy конфигурации*.
4. Нажмите кнопку **добавить +** tooopen hello пользовательского журнала мастера.

### <a name="step-2-upload-and-parse-a-sample-log"></a>Шаг 2. Загрузка и преобразование примера журнала
Запустить, загрузив образец hello пользовательского журнала.  Мастер Hello синтаксический анализ и отобразить hello записи в этом файле можно toovalidate.  Служба аналитики журналов будет использовать разделитель hello, укажите tooidentify каждой записи.

**Новая строка** является разделителем по умолчанию hello и используется для файлов журнала, имеющие одну запись в каждой строке.  Если строка hello начинается с даты и времени в один из доступных форматов hello, то можно указать **Timestamp** разделитель, который поддерживает операции, охватывающие более одной строки.

Если используется разделитель отметки времени, то hello свойстве TimeGenerated каждую запись в OMS будет заполняться hello даты и времени для этой записи в файл журнала hello.  Если используется новый разделитель строк, TimeGenerated заполняется с датой и временем, что анализа журналов собраны запись hello.

> [!NOTE]
> Служба аналитики журналов в настоящее время обрабатывает hello даты и времени собираются из журналов с помощью разделителя отметки времени в формате UTC.  Это будет скоро измененные toouse hello часового пояса на агенте hello.
>
>

1. Нажмите кнопку **Обзор** и обзор tooa образец файла.  Обратите внимание, что в некоторых браузерах эта кнопка может называться **Выбрать файл** .
2. Щелкните **Далее**.
3. Hello пользовательского журнала мастера будет отправлен hello файла и список hello записи, в которые он указывает.
4. Изменить hello разделитель, который будет использоваться tooidentify новую запись и выберите hello разделитель, определяющие hello записей в файле журнала.
5. Щелкните **Далее**.

### <a name="step-3-add-log-collection-paths"></a>Шаг 3. Добавление пути к файлам журнала
Необходимо определить один или несколько путей в агенте hello, где можно найти hello пользовательского журнала.  Можно предоставить конкретный путь и имя файла журнала hello, или можно указать путь с подстановочным знаком для имени hello.  Это подходит для приложений, в которых каждый день создается новый файл, или когда один файл достигает определенного размера.  Вы также можете указать несколько путей для одного файла журнала.

Например приложение может создать файл журнала каждый день с датой hello включен в имя hello как log20100316.txt. Шаблон для таких журнала может быть *журнала\*.txt* которого должно было применяться следующие приложения hello файл журнала tooany именования элемента схемы.

Hello следующей таблице приведены примеры допустимых шаблонов toospecify различных файлах журналов.

| Описание | Путь |
|:--- |:--- |
| Все файлы агента Windows в папке *C:\Logs* с расширением .txt |C:\Logs\\\*.txt |
| Все файлы агента Windows в папке *C:\Logs* с расширением .txt и именем, начинающимся со слова log |C:\Logs\log\*.txt |
| Все файлы агента Linux в папке */var/log/audits* с расширением .txt |/var/log/audit/*.txt |
| Все файлы агента Linux в папке */var/log/audit* с расширением .txt и именем, начинающимся со слова log |/var/log/Audit/log\*.txt |

1. Выберите toospecify Windows или Linux, добавление какой формат пути.
2. Введите путь hello и щелкните hello  **+**  кнопки.
3. Повторите процесс hello для любых дополнительных путей.

### <a name="step-4-provide-a-name-and-description-for-hello-log"></a>Шаг 4. Укажите имя и описание для журнала hello
Hello имя будет использоваться для типа hello как описано выше.  Всегда заканчивается _CL toodistinguish его как пользовательский журнал.

1. Введите имя для журнала hello.  Hello  **\_CL** суффикс предоставляется автоматически.
2. При необходимости введите **описание**.
3. Нажмите кнопку **Далее** определение пользовательского журнала toosave hello.

### <a name="step-5-validate-that-hello-custom-logs-are-being-collected"></a>Шаг 5. Проверка во время сбора пользовательских журналов hello
Это может потребоваться до часа tooan hello исходные данные из новых tooappear пользовательского журнала в службе анализа журналов.  Он будет запущен сбор записей hello журналы найти пути hello указан из точки hello hello определенные пользовательские войти в.  Она не хранит записи hello, загруженные во время создания пользовательского журнала hello, но он будет собирать уже существующие записи в файлы журналов hello, она выполняет поиск.

После анализа журналов начинается сбор hello пользовательский журнал, записи будут доступны с поиска журналов.  Используйте hello имя, присвоенное hello пользовательского журнала как hello **типа** в запросе.

> [!NOTE]
> При поиска hello hello RawData свойство отсутствует, может потребоваться tooclose и повторно откройте браузер.
>
>

### <a name="step-6-parse-hello-custom-log-entries"></a>Шаг 6. Синтаксический анализ hello пользовательские записи журнала
запись Hello весь журнал будет храниться в одиночное свойство **RawData**.  Скорее всего, вы будете tooseparate hello разные части сведений в каждой записи в отдельные свойства, которые хранятся в записи hello.  Это делается с помощью hello [настраиваемые поля](log-analytics-custom-fields.md) функции аналитики журналов.

Подробное описание процедуры синтаксического анализа hello пользовательские записи журнала не указаны здесь.  См. toohello [настраиваемые поля](log-analytics-custom-fields.md) документации для получения этих сведений.

## <a name="disabling-a-custom-log"></a>Отключение настраиваемого журнала
Определение настраиваемого журнала нельзя удалить после создания, но его можно отключить, удалив все пути к коллекции.

1. На портале OMS hello, go слишком**параметры**.
2. Выберите вкладку **Данные**, а затем — раздел **Настраиваемые журналы**.
3. Нажмите кнопку **сведения** Далее toodisable определение пользовательского журнала toohello.
4. Удалите каждого из путей hello коллекции для определения пользовательского журнала hello.

## <a name="data-collection"></a>Сбор данных
Log Analytics собирает новые записи из каждого настраиваемого журнала примерно каждые 5 минут.  в каждый файл журнала, выполняющее сбор данных из Hello агент будет записано его место.  Если агент hello переходит в автономный режим на период времени, затем аналитики журналов будет собирать записи от последнего места остановки, даже если эти записи создаются, когда агент hello находился в автономном режиме.

Hello все содержимое для записи в журнале hello записываются tooa одиночное свойство **RawData**.  Вы можете проанализировать в несколько свойств, которые могут быть проанализированы и поиск выполняется путем определения [настраиваемые поля](log-analytics-custom-fields.md) после создания пользовательского журнала hello.

## <a name="custom-log-record-properties"></a>Свойства записей настраиваемого журнала
Пользовательский журнал записей имеют тип с именем журнала hello, предоставляющих и hello свойства в hello в следующей таблице.

| Свойство | Описание |
|:--- |:--- |
| TimeGenerated |Дата и время записи hello собранные службой аналитики журналов.  Если журнала hello использует разделитель основано время, это можно сделать hello времени, собранные из записи hello. |
| SourceSystem |Тип агента hello записи были собраны. <br> OpsManager — агент Windows, подключенный напрямую или управляемый с помощью System Center Operations Manager. <br> Linux — все агенты Linux |
| RawData |Полный текст hello собранные записи. |
| ManagementGroupName |Имя группы управления hello для System Center Operations Управление агентами.  Для других агентов это AOI-\<идентификатор_рабочей_области\>. |

## <a name="log-searches-with-custom-log-records"></a>Поиск по журналу с использованием записей настраиваемого журнала
Записи из пользовательских журналов хранятся в репозитории OMS hello так же, как записи из любого другого источника данных.  Они будут иметь тип, соответствующий имени hello, указываемые при определении hello журнала, чтобы можно было использовать в своих записей tooretrieve поиска, собранных из определенного журнала свойство типа hello.

Hello следующей таблице приведены примеры различных запросов поиска журналов, которые извлекаются из пользовательских журналов.

| Запрос | Описание |
|:--- |:--- |
| Type=MyApp_CL |Все события из настраиваемого журнала с именем MyApp_CL. |
| Type=MyApp_CL Severity_CF=error |Все события из настраиваемого журнала с именем MyApp_CL и значением *error* в настраиваемом поле с именем *Severity_CF*. |

>[!NOTE]
> Если рабочую область был обновленного toohello [языка запросов новый журнал аналитики](log-analytics-log-search-upgrade.md), то hello выше запросы будут изменены следующие toohello.

> | Запрос | Описание |
|:--- |:--- |
| MyApp_CL |Все события из настраиваемого журнала с именем MyApp_CL. |
| MyApp_CL &#124; где Severity_CF=="error" |Все события из настраиваемого журнала с именем MyApp_CL и значением *error* в настраиваемом поле с именем *Severity_CF*. |


## <a name="sample-walkthrough-of-adding-a-custom-log"></a>Пошаговое руководство по добавлению настраиваемого журнала
Hello следующем разделе описывается пример создания пользовательского журнала.  во время сбора журналов Образец Hello содержит одну запись в каждой строке, начиная с даты и времени, а затем с разделителями запятыми поля для кода, состояние и сообщения.  Ниже приведены некоторые примеры записей.

    2016-03-10 01:34:36 207,Success,Client 05a26a97-272a-4bc9-8f64-269d154b0e39 connected
    2016-03-10 01:33:33 208,Warning,Client ec53d95c-1c88-41ae-8174-92104212de5d disconnected
    2016-03-10 01:35:44 209,Success,Transaction 10d65890-b003-48f8-9cfc-9c74b51189c8 succeeded
    2016-03-10 01:38:22 302,Error,Application could not connect toodatabase
    2016-03-10 01:31:34 303,Error,Application lost connection toodatabase

### <a name="upload-and-parse-a-sample-log"></a>Загрузка и преобразование примера журнала
Мы предоставить один из файлов журнала hello и можно увидеть события hello, будет осуществляться сбор.  В этом случае достаточно использовать в качестве разделителя новую строку.  Если запись в журнал hello хотя может занимать несколько строк, разделитель отметки времени, должны использовать toobe.

![Загрузка и преобразование примера журнала](media/log-analytics-data-sources-custom-logs/delimiter.png)

### <a name="add-log-collection-paths"></a>Добавление пути к файлам журнала
файлы журнала Hello будут находиться в *C:\MyApp\Logs*.  Новый файл создается каждый день с именем, которое включает в себя дату hello в шаблоне hello *appYYYYMMDD.log*.  Для этого журнала будет использоваться путь *C:\MyApp\Logs\\\*.log*.

![Путь к файлам журнала](media/log-analytics-data-sources-custom-logs/collection-path.png)

### <a name="provide-a-name-and-description-for-hello-log"></a>Укажите имя и описание для журнала hello
Мы введем имя *MyApp_CL* и текст **описания**.

![Имя журнала](media/log-analytics-data-sources-custom-logs/log-name.png)

### <a name="validate-that-hello-custom-logs-are-being-collected"></a>Проверка во время сбора пользовательских журналов hello
Мы используем запрос *тип = MyApp_CL* tooreturn все записи из журнала hello.

![Запрос к журналу без настраиваемых полей](media/log-analytics-data-sources-custom-logs/query-01.png)

### <a name="parse-hello-custom-log-entries"></a>Синтаксический анализ hello пользовательские записи журнала
Мы используем hello настраиваемые поля toodefine *EventTime*, *кода*, *состояние*, и *сообщение* поля и мы можно заметить разницу hello в hello записи, которые возвращаются запросом hello.

![Запрос к журналу с использованием настраиваемых полей](media/log-analytics-data-sources-custom-logs/query-02.png)

## <a name="next-steps"></a>Дальнейшие действия
* Используйте [настраиваемые поля](log-analytics-custom-fields.md) tooparse hello записей в пользовательском журнале hello в полях tooindividual.
* Дополнительные сведения о [входа выполняет](log-analytics-log-searches.md) tooanalyze hello данные, собранные из источников данных и решений.
