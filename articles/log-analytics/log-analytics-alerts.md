---
title: "aaaUnderstanding предупреждения в службе анализа журналов Azure | Документы Microsoft"
description: "Предупреждения в службе анализа журналов определить важную информацию в репозитории OMS и можно заранее уведомлять вас о проблемах или вызова действия tooattempt toocorrect их.  В этой статье описываются hello различные виды правил оповещений и как они определяются."
services: log-analytics
documentationcenter: 
author: bwren
manager: jwhit
editor: tysonn
ms.assetid: 6cfd2a46-b6a2-4f79-a67b-08ce488f9a91
ms.service: log-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/26/2017
ms.author: bwren
ms.openlocfilehash: bfa0a5aaeca81674e79a6d647f36d937efeeb439
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="understanding-alerts-in-log-analytics"></a>Общие сведения об оповещениях в Log Analytics

Оповещения в Log Analytics содержат важную информацию о вашем репозитории Log Analytics.  В этой статье подробно описаны правила, как оповещения в работе службы анализа журналов и описание hello различия между различными типами правил оповещения.

Hello процесс создания правила оповещения см. следующие статьи hello.

- создание правил генерации оповещений на [портале Azure](log-analytics-alerts-creating.md);
- создание правил генерации оповещений с помощью [шаблона Resource Manager](../operations-management-suite/operations-management-suite-solutions-resources-searches-alerts.md);
- создание правил генерации оповещений с помощью [REST API](log-analytics-api-alerts.md).


## <a name="alert-rules"></a>Правила оповещения

Оповещения создаются с помощью правил оповещения, которые автоматически выполняют поиск по журналам через регулярные интервалы.  Если результаты поиска журналов hello hello соответствует конкретным условиям, создается запись предупреждений.  правило Hello можно автоматически выполните одну или дополнительные действия tooproactively уведомит hello предупреждения или вызвать другой процесс.  Этот анализ различных типов правил оповещения используется tooperform другой логикой.

![Оповещения Log Analytics](media/log-analytics-alerts/overview.png)

Правила оповещения определяются hello, приведенные ниже сведения.

- **Поиск по журналам**.  Hello запрос, который выполняется каждый раз, срабатывает правило генерации оповещений hello.  Hello записей, возвращаемых этим запросом является используется toodetermine ли создаваться оповещение.
- **Временное окно**.  Указывает диапазон времени hello для запроса hello.  Hello запрос возвращает только те записи, которые были созданы в течение этого интервала hello текущее время.  Это значение может составлять от 5 минут до 24 часов. Например если hello время устанавливается окна too60 минут, а hello запрос выполняется в 13:15, возвращается только записи, созданные между 12:15 PM и 1:15 PM.
- **Частота**.  Указывает, как часто hello должен выполняться запрос. Это значение может составлять от 5 минут до 24 часов. Должно быть равно tooor меньше временного окна hello.  Если значение hello превышает временное окно приветствия, существует риск записей будет пропущено.<br>Например, рассмотрим временное окно в 30 минут и частоту в 60 минут.  Если hello запрос выполняется в 1:00, он возвращает записи от 12:30 до 1:00 PM.  Hello очередного запроса hello запустит — 2:00, когда она возвратит записей от 1:30 до 2:00.  Записи, созданные между 13:00 и 13:30, не будут учитываться.
- **Пороговое значение**.  Hello результаты поиска журналов hello, вычисленное toodetermine ли создаваться оповещение.  Пороговое значение Hello отличается для различных типов hello правил оповещения.

Каждое правило генерации оповещений в Log Analytics относится к одному из двух типов.  Каждый из этих типов подробно описан в последующих разделах hello.

- **[Число результатов](#number-of-results-alert-rules)**. Одно предупреждение, созданные при возврате hello число записей поиска журналов hello превышать указанного числа.
- **[Измерение метрик](#metric-measurement-alert-rules)**.  Предупреждение создано для каждого объекта в hello результатов поиска журналов hello со значениями, которые превышают заданное пороговое значение.

Ниже приведены Hello различия между типами правило оповещения.

- **Количество результатов** правило генерации оповещений всегда создается один предупреждения while **метрической** оповещения правило создает оповещение для каждого объекта, превышающий пороговое значение hello.
- **Количество результатов** правила оповещения создавать оповещения при превышении порогового значения hello один раз. **Метрической** правил оповещений можно создать предупреждение при превышении порогового значения hello определенное число раз за определенный временной интервал.

## <a name="number-of-results-alert-rules"></a>Правило генерации оповещений "Число результатов"
**Количество результатов** правила оповещения создать одно оповещение при hello количество записей, возвращаемых запросом поиска hello превышает заданное пороговое значение hello.

### <a name="threshold"></a>Пороговое значение
Пороговое значение Hello для **число результатов** правило генерации оповещений, просто больше или меньше, чем определенное значение.  Если hello число записей, возвращаемых поиска журналов hello соответствует этому критерию, создается предупреждение.

### <a name="scenarios"></a>Сценарии

#### <a name="events"></a>События
Этот тип правила генерации оповещений идеально подходит для работы с такими событиями, как журналы событий Windows, системный журнал и настраиваемые журналы.  Вы можете toocreate оповещение, когда создается событие конкретной ошибки или при создании нескольких событий ошибки в окне определенный момент времени.

tooalert по одному событию набору hello toogreater результаты, чем 0 как hello частоту и время окна too5 минут.  Которое будет выполняться запрос hello каждые 5 минут и проверить наличие вхождения hello одиночного события, созданного с момента последнего запуска запроса hello во время последнего hello.  В первом случае периодичность может задержать hello время между собранных выполняется событие hello и создается предупреждение hello.

Некоторые приложения могут вносить в журнал нерегулярную ошибку, которая не обязательно должна вызывать оповещение.  Например приложение hello может повторите hello процесса, который создал событие ошибки hello и затем успешно hello следующем.  В этом случае может не должны toocreate hello предупреждения, если несколько событий создаются в течение определенного временного окна.  

В некоторых случаях может потребоваться toocreate оповещение при отсутствии hello события.  Например процесс может войти tooindicate регулярные события, в которой он работает правильно.  Если он не регистрирует одно из таких событий в пределах определенного временного окна, следует создать оповещение.  В этом случае будет задать пороговое значение hello слишком**менее 1**.

#### <a name="performance-alerts"></a>Оповещения производительности
[Данные о производительности](log-analytics-data-sources-performance-counters.md) хранится в виде записи в hello аналогичные tooevents репозиторий OMS.  Если требуется tooalert счетчика производительности превышает определенный порог, пороговое значение должен включаться в запросе hello.

Например, если требуется tooalert при hello обработчик запросов производит 90%, используйте запрос наподобие следующих с пороговым значением hello для правила оповещения hello hello **больше 0**.

    Type=Perf ObjectName=Processor CounterName="% Processor Time" CounterValue>90

Если требуется tooalert процессора hello усредненный более 90% для окна определенный момент времени, используется запрос с помощью hello [измерения команда](log-analytics-search-reference.md#commands) как следующем hello с пороговым значением hello для правила оповещения hello **больше 0** .

    Type=Perf ObjectName=Processor CounterName="% Processor Time" | measure avg(CounterValue) by Computer | where AggregatedValue>90

>[!NOTE]
> Если рабочую область был обновленного toohello [языка запросов новый журнал аналитики](log-analytics-log-search-upgrade.md), то hello выше запросы будут изменены следующие toohello:`Perf | where ObjectName=="Processor" and CounterName=="% Processor Time" and CounterValue>90`
> `Perf | where ObjectName=="Processor" and CounterName=="% Processor Time" | summarize avg(CounterValue) by Computer | where CounterValue>90`


## <a name="metric-measurement-alert-rules"></a>Metric measurement alert rules (Измерение метрики для правила генерации оповещений)

>[!NOTE]
> Сейчас правила генерации оповещений "Измерение метрик" находятся на этапе общедоступной предварительной версии.

Правила генерации оповещений **Измерение метрик** создают оповещение для каждого объекта в запросе со значением, превышающим указанное пороговое значение.  Они имеют следующие уникальные отличия от hello **число результатов** правила оповещения.

#### <a name="log-search"></a>Поиск по журналам
Хотя можно использовать для любого запроса **число результатов** правило оповещения, существуют особые требования hello запроса для правила оповещений метрической.  Она должна включать [измерения команда](log-analytics-search-reference.md#commands) toogroup hello результаты для определенного поля. Эта команда должен включать следующие элементы hello.

- **Агрегатная функция**.  Определяет hello вычисление, которое выполняется и потенциально tooaggregate числового поля.  Например **count()** вернет hello количество записей в запросе hello **avg(CounterValue)** будут возвращены hello среднего значения CounterValue поля hello за интервал приветствия.
- **Группировка по полю**.  Для каждого экземпляра этого поля будет создана запись с агрегированным значением, и для каждого из них можно создать оповещение.  Например, если требуется toogenerate оповещения для каждого компьютера, используется **компьютером**.   
- **Интервал**.  Определяет интервал времени hello, по которому выполняется статистическое вычисление данных hello.  Например, если вы указали **5 минут**, записи будут создаваться для каждого экземпляра поля группы hello агрегируются каждые 5 минут за период времени hello, указанные для оповещения hello.

#### <a name="threshold"></a>Пороговое значение
Hello пороговое значение для правил генерации оповещений метрической определяется статистическое значение и число нарушений.  Если все точки данных в поиске по журналам hello превышает это значение, он считается нарушения безопасности.  Если превышает hello количество нарушений в для любого объекта в результатах hello hello указанное значение, то для этого объекта создается предупреждение.

#### <a name="example"></a>Пример
Рассмотрим ситуацию, где оповещение должно создаваться, когда использование процессора на компьютере превышает 90 % три раза в течение 30 минут.  Вы создадите правило генерации оповещений с hello, приведенные ниже сведения.  

**Запрос:** Type=Perf ObjectName=Processor CounterName="% Processor Time" | measure avg(CounterValue) by Computer Interval 5minute.<br>
**Временное окно:** 30 минут.<br>
**Периодичность предупреждений:** 5 минут.<br>
**Объединенное значение:** больше 90.<br>
**Активировать оповещение на основе:** общее число нарушений превышает 5.<br>

создать запрос Hello среднее значение для каждого компьютера каждые 5 минут.  Этот запрос будут выполняться каждые 5 минут для данных, собранных за hello предшествующие 30 минут.  Ниже приведен пример данных для трех компьютеров.

![Результаты выполнения примера запроса](media/log-analytics-alerts/metrics-measurement-sample-graph.png)

В этом примере отдельные предупреждения будут создаваться для srv02 и srv03, так как они нарушения порога 90% hello 3 раза за период времени hello.  Если hello **на основе триггера предупреждение:** были изменены слишком**Фальцовка** то оповещения будут создаваться только для srv03, так как он нарушения порога hello для 3 последовательных выборок.

## <a name="alert-records"></a>Записи оповещений
Записи оповещений, созданные правилами генерации оповещений в Log Analytics, имеют значение **Alert** для **Type** и значение **OMS** для **SourceSystem**.  Они имеют свойства hello в hello в следующей таблице.

| Свойство | Описание |
|:--- |:--- |
| Тип |*Предупреждение* |
| SourceSystem |*OMS* |
| *Объект*  | [Оповещения метрической](#metric-measurement-alert-rules) будет иметь свойство, поле группы hello.  Например при поиске по журналам hello группы на компьютере, hello предупреждения запись с иметь поле компьютера с именем hello hello компьютера как значение hello.
| AlertName |Имя предупреждения hello. |
| AlertSeverity |Уровень серьезности предупреждения hello. |
| LinkToSearchResults |Свяжите tooLog поиска журналов для аналитики, возвращающий hello записи из hello запрос, созданный hello предупреждение. |
| Запрос |Текст hello запрос, который был запущен. |
| QueryExecutionEndTime |Конец диапазона времени hello для запроса hello. |
| QueryExecutionStartTime |Начало диапазона времени hello для запроса hello. |
| ThresholdOperator | Оператор, который был использован правилом оповещения hello. |
| ThresholdValue | Значение, которое было использовано правилом оповещения hello. |
| TimeGenerated |Создания предупреждения hello даты и времени. |

Существуют другие виды записи оповещений, созданных hello [решения по управлению предупреждение](log-analytics-solution-alert-management.md) и [экспортирует Power BI](log-analytics-powerbi.md).  Все они имеют значение **Alert** для **Type**, но различаются по **SourceSystem**.


## <a name="next-steps"></a>Дальнейшие действия
* Установка hello [решение для управления оповещениями](log-analytics-solution-alert-management.md) tooanalyze предупреждения, созданные в службе анализа журналов вместе с оповещениями, собранных с System Center Operations Manager.
* Вы можете ознакомиться с дополнительными сведениями о [поисках журналов](log-analytics-log-searches.md) , которые могут создавать оповещения.
* Вы можете выполнить пошаговое руководство по [настройке webook](log-analytics-alerts-webhooks.md) с использованием правила генерации оповещений.  
* Узнайте, как toowrite [Runbook в автоматизации Azure](https://azure.microsoft.com/documentation/services/automation) tooremediate проблемы определяется предупреждения.
