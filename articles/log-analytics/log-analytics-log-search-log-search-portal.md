---
title: "Использование портала поиска по журналам в Azure Log Analytics | Документация Майкрософт"
description: "Эта статья содержит руководство, в котором описывается, как создать поиски по журналам и анализировать данные, хранящиеся в рабочей области Log Analytics, с помощью портала поиска по журналам.  Это руководство включает в себя выполнение некоторых простых запросов с целью возврата различных типов данных и анализа результатов."
services: log-analytics
documentationcenter: 
author: bwren
manager: carmonm
editor: 
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/23/2017
ms.author: bwren
ms.openlocfilehash: 6fc556ceb34cde26d5f3789a2397cdaa34b0b84d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2017
---
# <a name="create-log-searches-in-azure-log-analytics-using-the-log-search-portal"></a>Создание поисков по журналам в Azure Log Analytics с помощью портала поиска по журналам

> [!NOTE]
> В этой статье описываются портал поиска по журналам в Azure Log Analytics с использованием нового языка запросов.  Дополнительные сведения о новом языке и процедурах обновления рабочей области см. в [этой статье](log-analytics-log-search-upgrade.md).  
>
> Если вы еще не перевели рабочую область на новый язык запросов, используйте информацию из статьи [Поиск данных по журналам](log-analytics-log-searches.md), чтобы узнать текущую версию портала поиска по журналам.

Эта статья содержит руководство, в котором описывается, как создать поиски по журналам и анализировать данные, хранящиеся в рабочей области Log Analytics, с помощью портала поиска по журналам.  Это руководство включает в себя выполнение некоторых простых запросов с целью возврата различных типов данных и анализа результатов.  Здесь рассматривается изменение запроса с помощью функций на портале поиска по журналам, а не напрямую.  Дополнительные сведения об изменении запроса напрямую см. в [справочнике по языку запросов](https://go.microsoft.com/fwlink/?linkid=856079).

Чтобы создать поиски на портале расширенной аналитики, а не на портале поиска по журналам, ознакомьтесь со статьей [Getting Started with the Analytics Portal](https://go.microsoft.com/fwlink/?linkid=856587) (Начало работы с порталом аналитики).  Оба портала используют тот же язык запросов для доступа к одним и тем же данным в рабочей области Log Analytics.

## <a name="prerequisites"></a>Предварительные требования
Это руководство предполагает наличие рабочей области Log Analytics с хотя бы одним подключенным источником, который генерирует данные для анализа запросов.  

- Если у вас нет рабочей области, вы можете создать ее бесплатно, выполнив действия, описанные в статье [Начало работы с рабочей областью Log Analytics](log-analytics-get-started.md).
- Подключите хотя бы один агент [Windows](log-analytics-windows-agents.md) или [Linux](log-analytics-linux-agents.md) к рабочей области.  

## <a name="open-the-log-search-portal"></a>Открытие портала поиска по журналам
Откройте портал поиска по журналам, используя  портал Azure или портал OMS.

1. Перейдите на портал Azure.
2. Перейдите к Log Analytics и выберите рабочую область.
3. Выберите **Поиск по журналу**, чтобы остаться на портале Azure или запустите портал OMS, выбрав **Портал OMS** и нажав кнопку "Поиск по журналу".

![Кнопка поиска по журналу](media/log-analytics-log-search-log-search-portal/log-search-button.png)

## <a name="create-a-simple-search"></a>Создание простого поиска
Самый быстрый способ получить некоторые данные для работы — создать простой запрос, который возвращает все записи в таблице.  Если у вас есть клиенты Windows или Linux, подключенные к рабочей области, у вас будут данные в таблице событий (Windows) или таблице системного журнала (Linux).

Введите один из следующих запросов в поле поиска и нажмите кнопку поиска.  

```
Event
```
```
Syslog
```

Данные возвращаются в представлении списка по умолчанию. Вы можете просмотреть общее количество возвращенных записей.

![Простой запрос](media/log-analytics-log-search-log-search-portal/log-search-portal-01.png)

Отображаются только первые несколько свойств каждой записи.  Щелкните **Показать больше**, чтобы отобразить все свойства конкретной записи.

![Сведения о записи](media/log-analytics-log-search-log-search-portal/log-search-portal-02.png)

## <a name="set-the-time-scope"></a>Задание промежутка времени
Все записи, собранные Log Analytics, имеют свойство **TimeGenerated**, содержащее дату и время создания записи.  Запрос на портале поиска по журналам возвращает только записи со свойством **TimeGenerated** за промежуток времени, отображаемый в левой области экрана.  

Фильтр времени можно изменить, выбрав раскрывающий список или переместив ползунок.  С помощью ползунка можно отобразить гистограмму, на которой показано относительное количество записей для каждого промежутка времени в диапазоне.  Этот промежуток варьируется в зависимости от диапазона.

Промежуток времени по умолчанию составляет **1 день**.  Измените это значение на **7 дней**, и общее число записей должно увеличиться.

![Промежуток времени создания данных](media/log-analytics-log-search-log-search-portal/log-search-portal-03.png)

## <a name="filter-results-of-the-query"></a>Фильтрация результатов запроса
В левой области экрана расположена панель фильтров, которая позволяет добавить фильтрацию к запросу, не изменяя его напрямую.  Несколько свойств возвращаемых записей отображаются с 10 основными значениями с количеством записей.

При работе с **событиями** установите флажок рядом с **Ошибка** в разделе **EVENTLEVELNAME**.   Если вы работаете с **системным журналом**, установите флажок рядом с **Ошибка** в разделе **SEVERITYLEVEL**.  Это позволит изменить запрос на один из указанных ниже, чтобы ограничить результаты событиями ошибки.

```
Event | where (EventLevelName == "Error")
```
```
Syslog | where (SeverityLevel == "err")
```

![Фильтр](media/log-analytics-log-search-log-search-portal/log-search-portal-04.png)

Добавьте свойства на панель фильтров, выбрав **Добавить в фильтры** в меню свойств одной из записей.

![Меню добавления в фильтры](media/log-analytics-log-search-log-search-portal/log-search-portal-02a.png)

Вы можете задать тот же фильтр, выбрав **Фильтр** в меню свойств записи со значением, которое необходимо отфильтровать.  

Для свойств, имена которых выделены синим цветом, доступен только параметр **Фильтр**.  Это *доступные для поиска* поля, индексируемые для условий поиска.  Поля, выделенные серым цветом, — это поля *с возможностью поиска произвольного текста*, имеющие только параметр **Показать ссылки**.  Этот параметр возвращает записи, имеющие это значение в любом свойстве.

![Меню фильтра](media/log-analytics-log-search-log-search-portal/log-search-portal-01a.png)

Вы можете группировать результаты по одному свойству, выбрав параметр **Группировать по** в меню записи.  Это позволит добавить оператор [суммирования](https://docs.loganalytics.io/docs/Language-Reference/Tabular-operators/summarize-operator) к запросу, который отображает результаты на диаграмме.  Вы можете сгруппировать по нескольким свойствам, однако необходимо будет изменить запрос напрямую.  Выберите меню записи рядом со свойством **Компьютер** и выберите **Group by 'Computer'** (Группировать по компьютеру).  

![Группировка по компьютеру](media/log-analytics-log-search-log-search-portal/log-search-portal-10.png)

## <a name="work-with-results"></a>Работа с результатами
Портал поиска по журналам имеет множество функций для работы с результатами запроса.  Вы можете сортировать, фильтровать и группировать результаты, чтобы анализировать данные, не изменяя фактический запрос.  По умолчанию результаты запроса не сортируются.

Чтобы просмотреть данные в табличном представлении, которое предоставляет дополнительные параметры для фильтрации и сортировки, щелкните **Таблица**.  

![Табличное представление](media/log-analytics-log-search-log-search-portal/log-search-portal-05.png)

Щелкните стрелку рядом с записью, чтобы просмотреть сведения для этой записи.

![Сортировка результатов](media/log-analytics-log-search-log-search-portal/log-search-portal-06.png)

Выполните сортировку по любому полю, щелкнув заголовок соответствующего столбца.

![Сортировка результатов](media/log-analytics-log-search-log-search-portal/log-search-portal-07.png)

Отфильтруйте результаты по определенному значению в столбце с помощью кнопки "Фильтр", а затем укажите условия фильтра.

![Фильтрация результатов](media/log-analytics-log-search-log-search-portal/log-search-portal-08.png)

Сгруппируйте по столбцу, перетащив заголовок соответствующего столбца в верхнюю часть результатов.  Вы можете сгруппировать по нескольким полям, перетащив несколько столбцов в верхнюю часть результатов.

![Группирование результатов](media/log-analytics-log-search-log-search-portal/log-search-portal-09.png)



## <a name="work-with-performance-data"></a>Работа с данными о производительности
Данные о производительности для агентов Windows и Linux хранятся в рабочей области Log Analytics в таблице **Производительность**.  Записи о производительности выглядят как любые другие записи. Мы можем создать простой запрос, который возвращает все записи о производительности, а также события.

```
Perf
```

![Данные о производительности](media/log-analytics-log-search-log-search-portal/log-search-portal-11.png)

Возвращать миллионы записей для всех объектов и счетчиков производительности не очень полезно.  Вы можете воспользоваться методами, используемыми выше, чтобы отфильтровать данные. Или просто введите указанный ниже запрос непосредственно в поле поиска по журналам.  В результате будут возвращены только записи использования процессора для компьютеров Windows и Linux.

```
Perf | where (ObjectName == "Processor")  | where (CounterName == "% Processor Time")
```

![Использование процессора](media/log-analytics-log-search-log-search-portal/log-search-portal-12.png)

Это ограничивает данные до определенного счетчика, но это не помещает их в особенно удобный формат.  Данные можно отобразить на графике, однако сначала необходимо сгруппировать их по компьютеру или времени создания.  Чтобы сгруппировать по нескольким полям, необходимо изменить запрос напрямую следующим образом.  Для вычисления среднего значения за каждый час используется функция [avg](https://docs.loganalytics.io/docs/Language-Reference/Aggregation-functions/avg()) для свойства **CounterValue**.

```
Perf  | where (ObjectName == "Processor")  | where (CounterName == "% Processor Time") | summarize avg(CounterValue) by Computer, TimeGenerated
```

![Диаграмма данных о производительности](media/log-analytics-log-search-log-search-portal/log-search-portal-13.png)

Теперь, когда данные сгруппированы подходящим образом, их можно отобразить на визуальной диаграмме, добавив оператор [обработки](https://docs.loganalytics.io/docs/Language-Reference/Tabular-operators/render-operator).  

```
Perf  | where (ObjectName == "Processor")  | where (CounterName == "% Processor Time") | summarize avg(CounterValue) by Computer, TimeGenerated | render timechart
```

![График](media/log-analytics-log-search-log-search-portal/log-search-portal-14.png)

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о языке запросов Log Analytics см. в статье [Getting Started with the Analytics Portal](https://go.microsoft.com/fwlink/?linkid=856079) (Начало работы с порталом аналитики).
- Изучите пошаговое руководство по использованию [портала расширенной аналитики](https://go.microsoft.com/fwlink/?linkid=856587), который позволяет выполнять те же запросы и получать доступ к тем же данным, что и портал поиска по журналам.
