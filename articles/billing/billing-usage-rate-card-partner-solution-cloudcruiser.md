---
title: "aaaCloud Cruiser и выставление счетов интеграции API Microsoft Azure | Документы Microsoft"
description: "Предоставляет уникальный взгляд из Microsoft Azure Billing партнер Cruiser облака опытом интеграции hello API-интерфейсов выставления счетов Azure в своих продуктах.  Эти сведения особенно полезны для клиентов Azure и Cloud Cruiser, которые хотели бы использовать Cloud Cruiser для Microsoft Azure Pack или уже рассматривают такой вариант."
services: 
documentationcenter: 
author: BryanLa
manager: tonguyen
editor: 
tags: billing
ms.assetid: b65128cf-5d4d-4cbd-b81e-d3dceab44271
ms.service: billing
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: billing
ms.date: 02/03/2017
ms.author: mobandyo;sirishap;bryanla
ms.openlocfilehash: 74cc19bdeed26c6684210736caa0cb365e8f8821
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="cloud-cruiser-and-microsoft-azure-billing-api-integration"></a><span data-ttu-id="4b75c-104">Интеграция Cloud Cruiser и API выставления счетов Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="4b75c-104">Cloud Cruiser and Microsoft Azure Billing API Integration</span></span>
<span data-ttu-id="4b75c-105">В этой статье описывается, как стоимость hello сведения, собранные из hello новый выставления счетов интерфейсов API Microsoft Azure, которая может использоваться в облаке Cruiser для рабочего процесса, моделирования и анализа.</span><span class="sxs-lookup"><span data-stu-id="4b75c-105">This article describes how hello information collected from hello new Microsoft Azure Billing APIs can be used in Cloud Cruiser for workflow cost simulation and analysis.</span></span>

## <a name="azure-ratecard-api"></a><span data-ttu-id="4b75c-106">API RateCard Azure</span><span class="sxs-lookup"><span data-stu-id="4b75c-106">Azure RateCard API</span></span>
<span data-ttu-id="4b75c-107">Hello RateCard API предоставляет данные о курсе из Azure.</span><span class="sxs-lookup"><span data-stu-id="4b75c-107">hello RateCard API provides rate information from Azure.</span></span> <span data-ttu-id="4b75c-108">После проверки подлинности с правильными учетными данными hello, может запросить hello API toocollect метаданные о службах hello, доступный в Azure, вместе с hello ставки, связанный с вашей предлагают ID.</span><span class="sxs-lookup"><span data-stu-id="4b75c-108">After authenticating with hello proper credentials, you can query hello API toocollect metadata about hello services available on Azure, along with hello rates associated with your Offer ID.</span></span>

<span data-ttu-id="4b75c-109">Hello ниже приведен пример ответа от API hello, показывающая hello цены для hello A0 (Windows) экземпляр:</span><span class="sxs-lookup"><span data-stu-id="4b75c-109">hello following is a sample response from hello API showing hello prices for hello A0 (Windows) instance:</span></span>

    {
        "MeterId": "0e59ad56-03e5-4c3d-90d4-6670874d7e29",
        "MeterName": "Compute Hours",
        "MeterCategory": "Virtual Machines",
        "MeterSubCategory": "A0 VM (Windows)",
        "Unit": "Hours",
        "MeterRates":
        {
            "0": 0.029
        },
        "EffectiveDate": "2014-08-01T00:00:00Z",
        "IncludedQuantity": 0.0,
        "MeterStatus": "Active"
    },

### <a name="cloud-cruisers-interface-tooazure-ratecard-api"></a><span data-ttu-id="4b75c-110">Cloud Cruiser элемента интерфейса tooAzure RateCard API</span><span class="sxs-lookup"><span data-stu-id="4b75c-110">Cloud Cruiser’s Interface tooAzure RateCard API</span></span>
<span data-ttu-id="4b75c-111">Cruiser облаке могут использовать сведения об RateCard API hello различными способами.</span><span class="sxs-lookup"><span data-stu-id="4b75c-111">Cloud Cruiser can leverage hello RateCard API information in different ways.</span></span> <span data-ttu-id="4b75c-112">В этой статье мы рассмотрим, как его можно использовать toomake IaaS рабочей нагрузки стоимость моделирование и анализа.</span><span class="sxs-lookup"><span data-stu-id="4b75c-112">For this article, we will show how it can be used toomake IaaS workload cost simulation and analysis.</span></span>

<span data-ttu-id="4b75c-113">toodemonstrate это вариант использования, представьте себе рабочей нагрузки нескольких экземпляров, работающих на Microsoft Azure Pack (MAP).</span><span class="sxs-lookup"><span data-stu-id="4b75c-113">toodemonstrate this use case, imagine a workload of several instances running on Microsoft Azure Pack (WAP).</span></span> <span data-ttu-id="4b75c-114">Цель Hello является toosimulate этой же рабочей нагрузки в Azure, а также оценить затраты hello выполнения такой миграции.</span><span class="sxs-lookup"><span data-stu-id="4b75c-114">hello goal is toosimulate this same workload on Azure, and estimate hello costs of doing such migration.</span></span> <span data-ttu-id="4b75c-115">Чтобы toocreate имитации, существует два toobe основные задачи выполнены:</span><span class="sxs-lookup"><span data-stu-id="4b75c-115">In order toocreate this simulation, there are two main tasks toobe performed:</span></span>

1. <span data-ttu-id="4b75c-116">**Процесс импорта и hello службы данных, собираемых из hello RateCard API.**</span><span class="sxs-lookup"><span data-stu-id="4b75c-116">**Import and process hello service information collected from hello RateCard API.**</span></span> <span data-ttu-id="4b75c-117">Эта задача также выполняется на книгах hello, где hello извлечение из hello RateCard API — новый план скорость tooa преобразованный и опубликована.</span><span class="sxs-lookup"><span data-stu-id="4b75c-117">This task is also performed on hello workbooks, where hello extract from hello RateCard API is transformed and published tooa new rate plan.</span></span> <span data-ttu-id="4b75c-118">Нового плана скорость будет использоваться на tooestimate имитаций hello hello Azure цены.</span><span class="sxs-lookup"><span data-stu-id="4b75c-118">This new rate plan will be used on hello simulations tooestimate hello Azure prices.</span></span>
2. <span data-ttu-id="4b75c-119">**Нормализация служб WAP и служб Azure для IaaS.**</span><span class="sxs-lookup"><span data-stu-id="4b75c-119">**Normalize WAP services and Azure services for IaaS.**</span></span> <span data-ttu-id="4b75c-120">По умолчанию службы WAP основаны на отдельных ресурсах (ЦП, объем памяти, размер диска и т. д.), а службы Azure основаны на размере экземпляра (A0, A1, A2 и т. д.).</span><span class="sxs-lookup"><span data-stu-id="4b75c-120">By default, WAP services are based on individual resources (CPU, Memory Size, Disk Size, etc.) while Azure services are based on instance size (A0, A1, A2, etc.).</span></span> <span data-ttu-id="4b75c-121">Первой задаче можно выполняемых ядром ETL Cruiser облака, вызывается книг, где может поставляться эти ресурсы вместе с размером экземпляра, аналогичный tooAzure экземпляр служб.</span><span class="sxs-lookup"><span data-stu-id="4b75c-121">This first task can be performed by Cloud Cruiser’s ETL engine, called workbooks, where these resources can be bundled on instance sizes, analogous tooAzure instance services.</span></span>

### <a name="import-data-from-hello-ratecard-api"></a><span data-ttu-id="4b75c-122">Импорт данных из hello RateCard API</span><span class="sxs-lookup"><span data-stu-id="4b75c-122">Import data from hello RateCard API</span></span>
<span data-ttu-id="4b75c-123">Книги Cruiser облака с информацией автоматической toocollect и процесс из hello RateCard API.</span><span class="sxs-lookup"><span data-stu-id="4b75c-123">Cloud Cruiser workbooks provide an automated way toocollect and process information from hello RateCard API.</span></span>  <span data-ttu-id="4b75c-124">Книги ETL (извлечение — преобразование — загрузка) позволяют tooconfigure hello коллекции, преобразования и публикации данных в базу данных облака Cruiser hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-124">ETL (extract-transform-load) workbooks allow you tooconfigure hello collection, transformation, and publishing of data into hello Cloud Cruiser database.</span></span>

<span data-ttu-id="4b75c-125">Каждую книгу можно иметь одну или несколько коллекций, позволяя toocorrelate информацию из разных источников toocomplement или дополнять данные об использовании hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-125">Each workbook can have one or multiple collections, allowing you toocorrelate information from different sources toocomplement or augment hello usage data.</span></span> <span data-ttu-id="4b75c-126">следующие два снимки экрана Показать как Hello toocreate новый *коллекции* в существующей рабочей книге, а также сведения об импорте hello *коллекции* из hello RateCard API:</span><span class="sxs-lookup"><span data-stu-id="4b75c-126">hello following two screenshots show how toocreate a new *collection* in an existing workbook, and importing information into hello *collection* from hello RateCard API:</span></span>

<span data-ttu-id="4b75c-127">![Рис. 1. Создание коллекции][1]</span><span class="sxs-lookup"><span data-stu-id="4b75c-127">![Figure 1 - Creating a new collection][1]</span></span>

<span data-ttu-id="4b75c-128">![Рис. 2 - Импорт данных из новой коллекции hello][2]</span><span class="sxs-lookup"><span data-stu-id="4b75c-128">![Figure 2 - Import data from hello new collection][2]</span></span>

<span data-ttu-id="4b75c-129">После импорта данных hello в книге hello, — возможно toocreate несколько шагов и процессов преобразования, toomodify и модели hello данных.</span><span class="sxs-lookup"><span data-stu-id="4b75c-129">After importing hello data into hello workbook, it’s possible toocreate multiple steps and transformation processes, toomodify and model hello data.</span></span> <span data-ttu-id="4b75c-130">Для этого примера поскольку нас интересуют только инфраструктуры как услуга (IaaS), мы используем hello преобразования действия tooremove ненужные строки или записи, связанные с tooservices Кроме IaaS.</span><span class="sxs-lookup"><span data-stu-id="4b75c-130">For this example, since we are only interested in infrastructure-as-a-Service (IaaS) we can use hello transformation steps tooremove unnecessary rows, or records, related tooservices other than IaaS.</span></span>

<span data-ttu-id="4b75c-131">Hello следующем снимке экрана показаны шаги преобразования hello используемых tooprocess hello данные, полученные от RateCard API:</span><span class="sxs-lookup"><span data-stu-id="4b75c-131">hello following screenshot shows hello transformation steps used tooprocess hello data collected from RateCard API:</span></span>

<span data-ttu-id="4b75c-132">![Рисунок 3. преобразование шаги tooprocess сбора данных из RateCard API][3]</span><span class="sxs-lookup"><span data-stu-id="4b75c-132">![Figure 3 - Transformation steps tooprocess collected data from RateCard API][3]</span></span>

### <a name="defining-new-services-and-rate-plans"></a><span data-ttu-id="4b75c-133">Определение новых служб и тарифных планов</span><span class="sxs-lookup"><span data-stu-id="4b75c-133">Defining New Services and Rate Plans</span></span>
<span data-ttu-id="4b75c-134">Существуют различные способы toodefine службы на Cruiser облака.</span><span class="sxs-lookup"><span data-stu-id="4b75c-134">There are different ways toodefine services on Cloud Cruiser.</span></span> <span data-ttu-id="4b75c-135">Один из способов hello является tooimport hello служб на основе данных об использовании hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-135">One of hello options is tooimport hello services from hello usage data.</span></span> <span data-ttu-id="4b75c-136">Этот метод часто используется при работе с общедоступных облаков, где уже определены hello служб поставщиком hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-136">This method is commonly used when working with public clouds, where hello services are already defined by hello provider.</span></span>

<span data-ttu-id="4b75c-137">Тарифного плана — это набор курсов или цен, которые могут быть применен toodifferent службы, на основе даты вступления в силу или всех клиентов среди других параметров.</span><span class="sxs-lookup"><span data-stu-id="4b75c-137">A Rate Plan is a set of rates or prices that can be applied toodifferent services, based on effective dates, or group of customers, among other options.</span></span> <span data-ttu-id="4b75c-138">Тарифные планы также может использоваться для моделирования toocreate Cruiser облака или сценарии «Что если», toounderstand влияние изменений в службах hello стоимость рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="4b75c-138">Rate Plans can also be used on Cloud Cruiser toocreate simulation or “What-if” scenarios, toounderstand how changes in services can affect hello total cost of a workload.</span></span>

<span data-ttu-id="4b75c-139">В этом примере мы будем использовать сведения о службе hello из hello RateCard API toodefine новых служб в облаке Cruiser.</span><span class="sxs-lookup"><span data-stu-id="4b75c-139">In this example, we will use hello service information from hello RateCard API toodefine new services in Cloud Cruiser.</span></span> <span data-ttu-id="4b75c-140">В hello таким же способом, мы используем hello тарифы, действующие toohello служб toocreate новый тарифного плана на Cruiser облака.</span><span class="sxs-lookup"><span data-stu-id="4b75c-140">In hello same way, we can use hello rates associated toohello services toocreate a new Rate Plan on Cloud Cruiser.</span></span>

<span data-ttu-id="4b75c-141">В конце процесса преобразования hello hello он возможных toocreate новый шаг и опубликовать данные hello из hello RateCard API как новые службы и ставки.</span><span class="sxs-lookup"><span data-stu-id="4b75c-141">At hello end of hello transformation process, it is possible toocreate a new step and publish hello data from hello RateCard API as new services and rates.</span></span>

<span data-ttu-id="4b75c-142">![Рис. 4. Публикация данных hello из hello RateCard API как новые службы и скорости][4]</span><span class="sxs-lookup"><span data-stu-id="4b75c-142">![Figure 4 - Publishing hello data from hello RateCard API as new Services and Rates][4]</span></span>

### <a name="verify-azure-services-and-rates"></a><span data-ttu-id="4b75c-143">Проверка служб Azure и тарифов</span><span class="sxs-lookup"><span data-stu-id="4b75c-143">Verify Azure Services and Rates</span></span>
<span data-ttu-id="4b75c-144">После публикации службы hello и ставки, вы можете проверить hello список импортированных служб в облаке Cruiser *служб* вкладки:</span><span class="sxs-lookup"><span data-stu-id="4b75c-144">After publishing hello services and rates, you can verify hello list of imported services in Cloud Cruiser’s *Services* tab:</span></span>

<span data-ttu-id="4b75c-145">![Рис. 5 — проверка hello новых служб][5]</span><span class="sxs-lookup"><span data-stu-id="4b75c-145">![Figure 5 - Verifying hello new Services][5]</span></span>

<span data-ttu-id="4b75c-146">На hello *планы скорость* вкладку, можно проверить план скорость новых hello с именем «AzureSimulation» с показателями hello импортированы из hello RateCard API.</span><span class="sxs-lookup"><span data-stu-id="4b75c-146">On hello *Rate Plans* tab, you can check hello new rate plan called “AzureSimulation” with hello rates imported from hello RateCard API.</span></span>

<span data-ttu-id="4b75c-147">![Рис. 6 - проверка hello новый тарифного плана и связанные ставки][6]</span><span class="sxs-lookup"><span data-stu-id="4b75c-147">![Figure 6 - Verifying hello new Rate Plan and associated rates][6]</span></span>

### <a name="normalize-wap-and-azure-services"></a><span data-ttu-id="4b75c-148">Нормализация WAP и служб Azure</span><span class="sxs-lookup"><span data-stu-id="4b75c-148">Normalize WAP and Azure Services</span></span>
<span data-ttu-id="4b75c-149">По умолчанию WAP предоставляет сведения об использовании на основе использования hello вычислений, памяти и сетевых ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4b75c-149">By default, WAP provides usage information based on hello use of compute, memory, and network resources.</span></span> <span data-ttu-id="4b75c-150">В облаке Cruiser можно определить вашей служб на основе непосредственно для выделения hello или отслеживаемой использование этих ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4b75c-150">In Cloud Cruiser, you can define your services based directly on hello allocation or metered usage of these resources.</span></span> <span data-ttu-id="4b75c-151">Например можно задать базового уровня для каждый час ЦП или платы hello ГБ памяти, выделенный экземпляр tooan.</span><span class="sxs-lookup"><span data-stu-id="4b75c-151">For example, you can set a basic rate for each hour of CPU usage, or charge hello GB of memory allocated tooan instance.</span></span>

<span data-ttu-id="4b75c-152">Например, в стоимость заказа toocompare между WAP и Azure мы должны tooaggregate hello уровня использования ресурсов на WAP на пакетов, которые затем могут быть tooAzure сопоставленных служб.</span><span class="sxs-lookup"><span data-stu-id="4b75c-152">For this example, in order toocompare costs between WAP and Azure, we need tooaggregate hello resource usage on WAP into bundles, which can then be mapped tooAzure services.</span></span> <span data-ttu-id="4b75c-153">Это преобразование можно легко реализовать в hello книги:</span><span class="sxs-lookup"><span data-stu-id="4b75c-153">This transformation can be implemented easily in hello workbooks:</span></span>

<span data-ttu-id="4b75c-154">![Рис. 7. преобразование служб toonormalize данных WAP][7]</span><span class="sxs-lookup"><span data-stu-id="4b75c-154">![Figure 7 - Transforming WAP data toonormalize services][7]</span></span>

<span data-ttu-id="4b75c-155">Последний шаг Hello в книге hello данные toopublish hello в базу данных облака Cruiser hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-155">hello last step at hello workbook is toopublish hello data into hello Cloud Cruiser database.</span></span> <span data-ttu-id="4b75c-156">На этом этапе данные об использовании hello теперь объединены в службы (, сопоставляемые toohello служб Azure) и привязывать toocreate hello toodefault ставки расходов.</span><span class="sxs-lookup"><span data-stu-id="4b75c-156">During this step, hello usage data is now bundled into services (that map toohello Azure Services) and tied toodefault rates toocreate hello charges.</span></span>

<span data-ttu-id="4b75c-157">После завершения hello книги можно автоматизировать hello обработку данных hello, путем добавления задачи в планировщике hello и указания hello частоту и время для hello toorun книги.</span><span class="sxs-lookup"><span data-stu-id="4b75c-157">After finishing hello workbook, you can automate hello processing of hello data, by adding a task on hello scheduler and specifying hello frequency and time for hello workbook toorun.</span></span>

<span data-ttu-id="4b75c-158">![Рис. 8. Планирование книги][8]</span><span class="sxs-lookup"><span data-stu-id="4b75c-158">![Figure 8 - Workbook scheduling][8]</span></span>

### <a name="create-reports-for-workload-cost-simulation-analysis"></a><span data-ttu-id="4b75c-159">Создание отчетов для анализа моделирования стоимости рабочей нагрузки</span><span class="sxs-lookup"><span data-stu-id="4b75c-159">Create Reports for Workload Cost Simulation Analysis</span></span>
<span data-ttu-id="4b75c-160">После использования hello собираются и расходы, загружаются в базы данных облака Cruiser hello, мы задействуем hello облака Cruiser аналитики модуля toocreate hello рабочей нагрузки стоимость моделирования, нам нужен.</span><span class="sxs-lookup"><span data-stu-id="4b75c-160">After hello usage is collected and charges are loaded into hello Cloud Cruiser database, we can leverage hello Cloud Cruiser Insights module toocreate hello workload cost simulation that we desire.</span></span>

<span data-ttu-id="4b75c-161">В порядке toodemonstrate этот сценарий, мы создали hello следующих отчетов:</span><span class="sxs-lookup"><span data-stu-id="4b75c-161">In order toodemonstrate this scenario, we created hello following report:</span></span>

<span data-ttu-id="4b75c-162">![Сравнение стоимости][9]</span><span class="sxs-lookup"><span data-stu-id="4b75c-162">![Cost Comparison][9]</span></span>

<span data-ttu-id="4b75c-163">Hello верхней диаграмме показано сравнение стоимости службами сравнение цены hello выполняющаяся рабочая нагрузка hello каждой службы, определенные между WAP (Темно-синий) и Azure (светло-синий).</span><span class="sxs-lookup"><span data-stu-id="4b75c-163">hello top graph shows a cost comparison by services, comparing hello price of running hello workload for each specific service between WAP (dark blue) and Azure (light blue).</span></span>

<span data-ttu-id="4b75c-164">Hello нижней диаграмме отображается hello и те же данные, но с разбивкой по отделам.</span><span class="sxs-lookup"><span data-stu-id="4b75c-164">hello bottom graph shows hello same data but broken down by department.</span></span> <span data-ttu-id="4b75c-165">Это показывает hello затрат для каждого отдела toorun своей рабочей нагрузки WAP и Azure, наряду с hello различие между ними в строке экономии hello (зеленый цвет).</span><span class="sxs-lookup"><span data-stu-id="4b75c-165">This shows hello costs for each department toorun their workload on WAP and Azure, along with hello difference between them in hello Savings bar (green).</span></span>

## <a name="azure-usage-api"></a><span data-ttu-id="4b75c-166">API Usage Azure</span><span class="sxs-lookup"><span data-stu-id="4b75c-166">Azure Usage API</span></span>
### <a name="introduction"></a><span data-ttu-id="4b75c-167">Введение</span><span class="sxs-lookup"><span data-stu-id="4b75c-167">Introduction</span></span>
<span data-ttu-id="4b75c-168">Недавно корпорация Майкрософт представила hello использования API Azure, допускающей запросу tooprogrammatically подписчиков в использования данных toogain анализировать их потребления.</span><span class="sxs-lookup"><span data-stu-id="4b75c-168">Microsoft recently introduced hello Azure Usage API, allowing subscribers tooprogrammatically pull in usage data toogain insights into their consumption.</span></span> <span data-ttu-id="4b75c-169">Это здорово для облака Cruiser клиентов, которые могут воспользоваться преимуществами hello богатый набор данных через этот интерфейс API.</span><span class="sxs-lookup"><span data-stu-id="4b75c-169">This is great news for Cloud Cruiser customers that can take advantage of hello richer dataset available through this API.</span></span>

<span data-ttu-id="4b75c-170">Cruiser облака можно использовать hello интеграция с hello API использования несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="4b75c-170">Cloud Cruiser can leverage hello integration with hello Usage API in several ways.</span></span> <span data-ttu-id="4b75c-171">Гранулярность Hello (каждый час сведения об использовании) и сведения о метаданных ресурсов через API предоставляет приветствия hello необходимые dataset toosupport гибкие Потребительское или о гибком управлении ресурсами моделей.</span><span class="sxs-lookup"><span data-stu-id="4b75c-171">hello granularity (hourly usage information) and resource metadata information available through hello API provides hello necessary dataset toosupport flexible Showback or Chargeback models.</span></span> 

<span data-ttu-id="4b75c-172">В этом учебнике мы представим одним из примеров как Cruiser облаке могут использовать преимущества hello сведения об использовании API.</span><span class="sxs-lookup"><span data-stu-id="4b75c-172">In this tutorial, we will present one example of how Cloud Cruiser can benefit from hello Usage API information.</span></span> <span data-ttu-id="4b75c-173">В частности мы будет создать группу ресурсов в Azure, свяжите теги для структуры hello учетной записи, а затем описан процесс запроса и обработки сведений о тегах hello в облаке Cruiser hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-173">More specifically, we will create a Resource Group on Azure, associate tags for hello account structure, then describe hello process of pulling and processing hello tag information into Cloud Cruiser.</span></span>

<span data-ttu-id="4b75c-174">Hello конечной цели — отчеты могут toocreate toobe как hello, выполнив одно может tooanalyze затрат и и на основе структуры учетной записи hello заполняется по тегам hello потребления.</span><span class="sxs-lookup"><span data-stu-id="4b75c-174">hello final goal is toobe able toocreate reports like hello following one, and be able tooanalyze cost and consumption based on hello account structure populated by hello tags.</span></span>

<span data-ttu-id="4b75c-175">![Рис. 10. Отчет с разбивкой по тегам][10]</span><span class="sxs-lookup"><span data-stu-id="4b75c-175">![Figure 10 - Report with breakdowns using tags][10]</span></span>

### <a name="microsoft-azure-tags"></a><span data-ttu-id="4b75c-176">Теги Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="4b75c-176">Microsoft Azure Tags</span></span>
<span data-ttu-id="4b75c-177">Hello данные, доступные через hello API использования Azure включает в себя не только информация о потребленных, но метаданные ресурса, включая любые теги, связанные с ним.</span><span class="sxs-lookup"><span data-stu-id="4b75c-177">hello data available through hello Azure Usage API includes not only consumption information, but also resource metadata including any tags associated with it.</span></span> <span data-ttu-id="4b75c-178">Теги предоставляют простой способ tooorganize ресурсов, но нужен tooensure действующие toobe заказа, который:</span><span class="sxs-lookup"><span data-stu-id="4b75c-178">Tags provide an easy way tooorganize your resources, but in order toobe effective, you need tooensure that:</span></span>

* <span data-ttu-id="4b75c-179">Теги — это правильно примененных toohello ресурсы во время подготовки</span><span class="sxs-lookup"><span data-stu-id="4b75c-179">Tags are correctly applied toohello resources at provision time</span></span>
* <span data-ttu-id="4b75c-180">Теги используются должным образом на hello Потребительское/о гибком управлении ресурсами процесса tootie hello использования toohello учетной записи структуру организации.</span><span class="sxs-lookup"><span data-stu-id="4b75c-180">Tags are properly used on hello Showback/Chargeback process tootie hello usage toohello organization’s account structure.</span></span>

<span data-ttu-id="4b75c-181">Оба этих требования может быть сложной задачей, особенно в том случае, если ручной процесс подготовки hello или заряжается стороне.</span><span class="sxs-lookup"><span data-stu-id="4b75c-181">Both of these requirements can be challenging, especially when there is a manual process on hello provision or charging side.</span></span> <span data-ttu-id="4b75c-182">Неверный, неправильное или даже отсутствуют теги, распространенных проблем клиентов при с помощью меток и эти ошибки можно сделать на hello заряжается стороны очень сложно жизни.</span><span class="sxs-lookup"><span data-stu-id="4b75c-182">Mistyped, incorrect or even missing tags are common complaints from customers when using tags and these errors can make life on hello charging side very difficult.</span></span>

<span data-ttu-id="4b75c-183">Hello новые API для использования Azure, Cruiser облака можно ресурса, добавление тегов сведения по запросу и в программе сложных ETL вызывается книг, исправить эти общие тегов ошибки.</span><span class="sxs-lookup"><span data-stu-id="4b75c-183">With hello new Azure Usage API, Cloud Cruiser can pull resource tagging information, and through a sophisticated ETL tool called workbooks, fix these common tagging errors.</span></span> <span data-ttu-id="4b75c-184">Посредством преобразования с использованием регулярных выражений и корреляции данных Cruiser облака можно определить неправильно с тегами ресурсы и применить правильный тегов hello, обеспечивая hello правильный связывание hello ресурсы с hello потребителя.</span><span class="sxs-lookup"><span data-stu-id="4b75c-184">Through transformation using regular expressions and data correlation, Cloud Cruiser can identify incorrectly tagged resources and apply hello correct tags, ensuring hello correct association of hello resources with hello consumer.</span></span>

<span data-ttu-id="4b75c-185">На hello заряжается стороны облака Cruiser автоматизирует hello Потребительское/о гибком управлении ресурсами процесса и могут использовать hello тег сведения tootie hello использования toohello потребителя соответствующего (отдела, подразделения, проект, и т. д.).</span><span class="sxs-lookup"><span data-stu-id="4b75c-185">On hello charging side, Cloud Cruiser automates hello Showback/Chargeback process, and can leverage hello tag information tootie hello usage toohello appropriate consumer (Department, Division, Project, etc.).</span></span> <span data-ttu-id="4b75c-186">Автоматизация совершенствует процесс учета расходов и обеспечивает его согласованность и подконтрольность.</span><span class="sxs-lookup"><span data-stu-id="4b75c-186">This automation provides a huge improvement and can ensure a consistent and auditable charging process.</span></span>

### <a name="creating-a-resource-group-with-tags-on-microsoft-azure"></a><span data-ttu-id="4b75c-187">Создание группы ресурсов с тегами в Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="4b75c-187">Creating a Resource Group with tags on Microsoft Azure</span></span>
<span data-ttu-id="4b75c-188">Hello первым шагом в этом учебнике это toocreate группа ресурсов в hello портал Azure, а затем создание новых тегов tooassociate toohello ресурсов.</span><span class="sxs-lookup"><span data-stu-id="4b75c-188">hello first step in this tutorial is toocreate a Resource Group in hello Azure portal, then create new tags tooassociate toohello resources.</span></span> <span data-ttu-id="4b75c-189">В этом примере мы создадим hello следующие теги: отдел, среда, владелец проекта.</span><span class="sxs-lookup"><span data-stu-id="4b75c-189">For this example, we will be creating hello following tags: Department, Environment, Owner, Project.</span></span>

<span data-ttu-id="4b75c-190">Снимок экрана приветствия ниже образец что теги, связанные с группой ресурсов с hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-190">hello screenshot below shows a sample Resource Group with hello associated tags.</span></span>

<span data-ttu-id="4b75c-191">![Рис. 11. Группа ресурсов с сопоставленными тегами на портале Azure][11]</span><span class="sxs-lookup"><span data-stu-id="4b75c-191">![Figure 11 - Resource Group with associated tags on Azure portal][11]</span></span>

<span data-ttu-id="4b75c-192">Hello следующим шагом является toopull hello сведения из API использования hello в Cruiser облака.</span><span class="sxs-lookup"><span data-stu-id="4b75c-192">hello next step is toopull hello information from hello Usage API into Cloud Cruiser.</span></span> <span data-ttu-id="4b75c-193">в настоящее время Hello API использования предоставляет ответы в формате JSON.</span><span class="sxs-lookup"><span data-stu-id="4b75c-193">hello Usage API currently provides responses in JSON format.</span></span> <span data-ttu-id="4b75c-194">Ниже приведен пример извлекаемых данных hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-194">Here is a sample of hello data retrieved:</span></span>

    {
      "id": "/subscriptions/bb678b04-0e48-4b44-XXXX-XXXXXXX/providers/Microsoft.Commerce/UsageAggregates/Daily_BRSDT_20150623_0000",
      "name": "Daily_BRSDT_20150623_0000",
      "type": "Microsoft.Commerce/UsageAggregate",
      "properties":
      {
        "subscriptionId": "bb678b04-0e48-4b44-XXXX-XXXXXXXXX",
        "usageStartTime": "2015-06-22T00:00:00+00:00",
        "usageEndTime": "2015-06-23T00:00:00+00:00",
        "meterName": "Compute Hours",
        "meterRegion": "",
        "meterCategory": "Virtual Machines",
        "meterSubCategory": "Standard_D1 VM (Non-Windows)",
        "unit": "Hours",
        "instanceData": "{\"Microsoft.Resources\":{\"resourceUri\":\"/subscriptions/bb678b04-0e48-4b44-XXXX-XXXXXXXX/resourceGroups/DEMOUSAGEAPI/providers/Microsoft.Compute/virtualMachines/MyDockerVM\",\"location\":\"eastus\",\"tags\":{\"Department\":\"Sales\",\"Project\":\"Demo Usage API\",\"Environment\":\"Test\",\"Owner\":\"RSE\"},\"additionalInfo\":{\"ImageType\":\"Canonical\",\"ServiceType\":\"Standard_D1\"}}}",
        "meterId": "e60caf26-9ba0-413d-a422-6141f58081d6",
        "infoFields": {},
        "quantity": 8

      },
    },


### <a name="import-data-from-hello-usage-api-into-cloud-cruiser"></a><span data-ttu-id="4b75c-195">Импортировать данные из API использования hello в облаке Cruiser</span><span class="sxs-lookup"><span data-stu-id="4b75c-195">Import data from hello Usage API into Cloud Cruiser</span></span>
<span data-ttu-id="4b75c-196">Книги Cruiser облака с информацией автоматической toocollect и процесс из hello API использования.</span><span class="sxs-lookup"><span data-stu-id="4b75c-196">Cloud Cruiser workbooks provide an automated way toocollect and process information from hello Usage API.</span></span> <span data-ttu-id="4b75c-197">Книги ETL (извлечение — преобразование — загрузка) позволяет tooconfigure hello коллекции, преобразования и публикации данных в базу данных облака Cruiser hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-197">An ETL (extract-transform-load) workbook allows you tooconfigure hello collection, transformation, and publishing of data into hello Cloud Cruiser database.</span></span>

<span data-ttu-id="4b75c-198">Каждая книга может иметь одну или несколько коллекций.</span><span class="sxs-lookup"><span data-stu-id="4b75c-198">Each workbook can have one or multiple collections.</span></span> <span data-ttu-id="4b75c-199">Это позволяет toocorrelate информацию из разных источников toocomplement или пополните hello данные об использовании.</span><span class="sxs-lookup"><span data-stu-id="4b75c-199">This allows you toocorrelate information from different sources toocomplement or augment hello usage data.</span></span> <span data-ttu-id="4b75c-200">В этом примере мы создадим новый лист в книге hello Azure шаблона (*UsageAPI)* и задать новый *коллекции* tooimport сведения из hello API использования.</span><span class="sxs-lookup"><span data-stu-id="4b75c-200">For this example, we will create a new sheet in hello Azure template workbook (*UsageAPI)* and set a new *collection* tooimport information from hello Usage API.</span></span>

<span data-ttu-id="4b75c-201">![Рисунок 3. Использование API данные, импортированные в лист UsageAPI hello][12]</span><span class="sxs-lookup"><span data-stu-id="4b75c-201">![Figure 3 - Usage API data imported into hello UsageAPI sheet][12]</span></span>

<span data-ttu-id="4b75c-202">Обратите внимание, что эта книга уже содержит другие листы tooimport служб из Azure (*ImportServices*) и обрабатывать данные потребления hello из hello API выставления счетов (*PublishData*).</span><span class="sxs-lookup"><span data-stu-id="4b75c-202">Notice that this workbook already has other sheets tooimport services from Azure (*ImportServices*), and process hello consumption information from hello Billing API (*PublishData*).</span></span>

<span data-ttu-id="4b75c-203">Далее мы будем использовать hello API использования toopopulate hello *UsageAPI* лист и согласовывать hello информации hello потребления данных из hello API выставление счетов в hello *PublishData* листа.</span><span class="sxs-lookup"><span data-stu-id="4b75c-203">Next we will use hello Usage API toopopulate hello *UsageAPI* sheet, and correlate hello information with hello consumption data from hello Billing API on hello *PublishData* sheet.</span></span>

### <a name="processing-hello-tag-information-from-hello-usage-api"></a><span data-ttu-id="4b75c-204">Сведения о тегах hello обработки из hello API использования</span><span class="sxs-lookup"><span data-stu-id="4b75c-204">Processing hello tag information from hello Usage API</span></span>
<span data-ttu-id="4b75c-205">После импорта данных hello в книге hello, мы создадим действия преобразования в hello *UsageAPI* листа tooprocess hello информацию с hello API.</span><span class="sxs-lookup"><span data-stu-id="4b75c-205">After importing hello data into hello workbook, we will create transformation steps in hello *UsageAPI* sheet in order tooprocess hello information from hello API.</span></span> <span data-ttu-id="4b75c-206">Первым шагом является toouse «Расщеплений JSON» hello tooextract процессора теги из одного поля, а затем создать поля для каждого из них (отдел, проект, владелец и среде).</span><span class="sxs-lookup"><span data-stu-id="4b75c-206">First step is toouse a “JSON split” processor tooextract hello tags from a single field, then create fields for each one of them (Department, Project, Owner, and Environment).</span></span>

<span data-ttu-id="4b75c-207">![Рис. 4. создать новые поля для сведений о тегах hello][13]</span><span class="sxs-lookup"><span data-stu-id="4b75c-207">![Figure 4 - Create new fields for hello tag information][13]</span></span>

<span data-ttu-id="4b75c-208">Hello уведомления службы «Сетевые возможности» отсутствуют данные тег hello (желтого прямоугольника), но мы убедимся, что он является частью hello одну группу ресурсов, просмотрев hello *ResourceGroupName* поля.</span><span class="sxs-lookup"><span data-stu-id="4b75c-208">Notice hello “Networking” service is missing hello tag information (yellow box), but we can verify that it is part of hello same Resource Group by looking at hello *ResourceGroupName* field.</span></span> <span data-ttu-id="4b75c-209">Поскольку мы имеем hello теги для hello другие ресурсы из этой группы ресурсов, мы можно использовать этот сведения tooapply hello отсутствует ресурс toothis теги позже в процессе hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-209">Since we have hello tags for hello other resources from this Resource Group, we can use this information tooapply hello missing tags toothis resource later in hello process.</span></span>

<span data-ttu-id="4b75c-210">Hello следующим шагом является toocreate уточняющего запроса таблицы связывание hello сведения из hello теги toohello *ResourceGroupName*.</span><span class="sxs-lookup"><span data-stu-id="4b75c-210">hello next step is toocreate a lookup table associating hello information from hello tags toohello *ResourceGroupName*.</span></span> <span data-ttu-id="4b75c-211">Эту таблицу подстановки будет использоваться на hello следующего шага tooenrich hello потребления данных с сведения о тегах.</span><span class="sxs-lookup"><span data-stu-id="4b75c-211">This lookup table will be used on hello next step tooenrich hello consumption data with tag information.</span></span>

### <a name="adding-hello-tag-information-toohello-consumption-data"></a><span data-ttu-id="4b75c-212">Добавление hello тег сведения toohello потребления данных</span><span class="sxs-lookup"><span data-stu-id="4b75c-212">Adding hello tag information toohello consumption data</span></span>
<span data-ttu-id="4b75c-213">Теперь перейдем toohello *PublishData* лист, какие процессы hello сведений о потреблении с hello API выставления счетов и добавить поля hello, извлеченных из тегов hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-213">Now we can jump toohello *PublishData* sheet, which processes hello consumption information from hello Billing API, and add hello fields extracted from hello tags.</span></span> <span data-ttu-id="4b75c-214">Этот процесс выполняется, просмотрев таблицы подстановки hello создан для предыдущего шага hello, с помощью hello *ResourceGroupName* в качестве ключа hello hello уточняющих запросов.</span><span class="sxs-lookup"><span data-stu-id="4b75c-214">This process is performed by looking at hello lookup table created on hello previous step, using hello *ResourceGroupName* as hello key for hello lookups.</span></span>

<span data-ttu-id="4b75c-215">![Рис. 5 — заполнение структуры счета hello hello данными из hello уточняющие запросы][14]</span><span class="sxs-lookup"><span data-stu-id="4b75c-215">![Figure 5 - Populating hello account structure with hello information from hello lookups][14]</span></span>

<span data-ttu-id="4b75c-216">Обратите внимание, применения полей структуры hello соответствующую учетную запись для службы «Сетевые возможности» hello, исправления проблемы hello с hello отсутствуют теги.</span><span class="sxs-lookup"><span data-stu-id="4b75c-216">Notice that hello appropriate account structure fields for hello “Networking” service were applied, fixing hello issue with hello missing tags.</span></span> <span data-ttu-id="4b75c-217">Мы заполняется полей структуры hello учетной записи для ресурсов, отличные от наших целевой группы ресурсов с «Другие», в порядке toodifferentiate их на hello отчеты.</span><span class="sxs-lookup"><span data-stu-id="4b75c-217">We also populated hello account structure fields for resources other than our target Resource Group with “Other”, in order toodifferentiate them on hello reports.</span></span>

<span data-ttu-id="4b75c-218">Теперь нужно просто tooadd данные об использовании hello toopublish шаг.</span><span class="sxs-lookup"><span data-stu-id="4b75c-218">Now we just need tooadd a step toopublish hello usage data.</span></span> <span data-ttu-id="4b75c-219">На этом этапе hello соответствующие ставки для каждой службы, определенные в нашем тарифного плана будет применяться toohello сведения об использовании, с hello результирующий бесплатно загрузить в базу данных hello.</span><span class="sxs-lookup"><span data-stu-id="4b75c-219">During this step, hello appropriate rates for each service defined on our Rate Plan will be applied toohello usage information, with hello resulting charge loaded into hello database.</span></span>

<span data-ttu-id="4b75c-220">лучше всего Hello является только наличие toogo таким образом один раз.</span><span class="sxs-lookup"><span data-stu-id="4b75c-220">hello best part is that you only have toogo through this process once.</span></span> <span data-ttu-id="4b75c-221">После завершения hello книги, необходимо просто tooadd его toohello планировщика и он будет ежечасно или ежедневно в hello запланированного времени.</span><span class="sxs-lookup"><span data-stu-id="4b75c-221">When hello workbook is completed, you just need tooadd it toohello scheduler and it will run hourly or daily at hello scheduled time.</span></span> <span data-ttu-id="4b75c-222">Затем это лишь создание новых отчетов или настройка существующих в порядке tooanalyze hello данных tooget важные аналитические сведения из использовании облачных.</span><span class="sxs-lookup"><span data-stu-id="4b75c-222">Then it’s just a matter of creating new reports, or customizing existing ones, in order tooanalyze hello data tooget meaningful insights from your cloud usage.</span></span>

### <a name="next-steps"></a><span data-ttu-id="4b75c-223">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="4b75c-223">Next Steps</span></span>
* <span data-ttu-id="4b75c-224">Для подробные инструкции по созданию Cruiser облака книг и отчетов, можно найти tooCloud Cruiser online [документации](http://docs.cloudcruiser.com/) (требуется допустимое имя входа).</span><span class="sxs-lookup"><span data-stu-id="4b75c-224">For detailed instructions on creating Cloud Cruiser workbooks and reports, please refer tooCloud Cruiser’s online [documentation](http://docs.cloudcruiser.com/) (valid login required).</span></span>  <span data-ttu-id="4b75c-225">Для получения дополнительных сведений о Cloud Cruiser обратитесь по адресу [info@cloudcruiser.com](mailto:info@cloudcruiser.com).</span><span class="sxs-lookup"><span data-stu-id="4b75c-225">For more information about Cloud Cruiser, please contact [info@cloudcruiser.com](mailto:info@cloudcruiser.com).</span></span>
* <span data-ttu-id="4b75c-226">В разделе [анализировать потребления ресурсов Microsoft Azure](billing-usage-rate-card-overview.md) Обзор hello использование ресурсов Azure и API-интерфейсов RateCard.</span><span class="sxs-lookup"><span data-stu-id="4b75c-226">See [Gain insights into your Microsoft Azure resource consumption](billing-usage-rate-card-overview.md) for an overview of hello Azure Resource Usage and RateCard APIs.</span></span>
* <span data-ttu-id="4b75c-227">Извлечение hello [выставления счетов Справочник API REST Azure](https://msdn.microsoft.com/library/azure/1ea5b323-54bb-423d-916f-190de96c6a3c) Дополнительные сведения о двух интерфейсов API, являющиеся частью hello набор API, предоставляемые hello диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="4b75c-227">Check out hello [Azure Billing REST API Reference](https://msdn.microsoft.com/library/azure/1ea5b323-54bb-423d-916f-190de96c6a3c) for more information on both APIs, which are part of hello set of APIs provided by hello Azure Resource Manager.</span></span>
* <span data-ttu-id="4b75c-228">Если вы хотите toodive прямо в образце кода hello, извлеките наших примеров Microsoft Azure Billing API код на [образцы кода Azure](https://azure.microsoft.com/documentation/samples/?term=billing).</span><span class="sxs-lookup"><span data-stu-id="4b75c-228">If you would like toodive right into hello sample code, check out our Microsoft Azure Billing API Code Samples on [Azure Code Samples](https://azure.microsoft.com/documentation/samples/?term=billing).</span></span>

### <a name="learn-more"></a><span data-ttu-id="4b75c-229">Подробнее</span><span class="sxs-lookup"><span data-stu-id="4b75c-229">Learn More</span></span>
* <span data-ttu-id="4b75c-230">В разделе hello [Обзор диспетчера ресурсов Azure](../azure-resource-manager/resource-group-overview.md) toolearn статьи о hello диспетчера ресурсов Azure.</span><span class="sxs-lookup"><span data-stu-id="4b75c-230">See hello [Azure Resource Manager Overview](../azure-resource-manager/resource-group-overview.md) article toolearn more about hello Azure Resource Manager.</span></span>

<!--Image references-->

[1]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Create-New-Workbook-Collection.png "Рис. 1. Создание коллекции"
[2]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Import-Data-From-RateCard.png "Рис. 2 - Импорт данных из новой коллекции hello"
[3]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Transformation-Steps-Process-RateCard-Data.png "Рисунок 3. преобразование шаги tooprocess сбора данных из RateCard API"
[4]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Publish-RateCard-Data-New-Services-Rates.png "Рис. 4. Публикация данных hello из hello RateCard API как новые службы и скорости"
[5]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Verify-Azure-Services-And-Pricing1.png "Рис. 5 — проверка hello новых служб"
[6]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Verify-Azure-Services-And-Pricing2.png "Рис. 6 - проверка hello новый тарифного плана и связанные ставки"
[7]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Transforming-WAP-Normalize-Services.png "Рис. 7. преобразование служб toonormalize данных WAP"
[8]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Workbook-Scheduling.png "Рис. 8. Планирование книги"
[9]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/Workload-Cost-Simulation-Report.png "Рис. 9 - образец отчета для сравнения затрат сценарий для hello рабочей нагрузки"
[10]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/1_ReportWithTags.png "Рис. 10. Отчет с разбивкой по тегам"
[11]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/2_ResourceGroupsWithTags.png "Рис. 11. Группа ресурсов с сопоставленными тегами на портале Azure"
[12]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/3_ImportIntoUsageAPISheet.png "Рис. 12 - данные об использовании API, импортируются в лист UsageAPI hello"
[13]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/4_NewTagField.png "Рис. 13 - создать новые поля для сведений о тегах hello"
[14]: ./media/billing-usage-rate-card-partner-solution-cloudcruiser/5_PopulateAccountStructure.png "Рис. 14 - заполнение структуры счета hello hello данными из hello уточняющие запросы"
