---
title: "Доменные службы Azure Active Directory: включение ограниченного делегирования Kerberos | Документация Майкрософт"
description: "Включение ограниченного делегирования Kerberos в управляемых доменах доменных служб Azure Active Directory"
services: active-directory-ds
documentationcenter: 
author: mahesh-unnikrishnan
manager: stevenpo
editor: curtand
ms.assetid: 938a5fbc-2dd1-4759-bcce-628a6e19ab9d
ms.service: active-directory-ds
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/06/2017
ms.author: maheshu
ms.openlocfilehash: f36f16a7bb00ace9fd5164eb38ba77f015f22f5c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="configure-kerberos-constrained-delegation-kcd-on-a-managed-domain"></a>Настройка ограниченного делегирования Kerberos в управляемом домене
Многим приложениям требуется доступ к ресурсам в контексте пользователя. Active Directory поддерживает делегирование Kerberos — механизм, который позволяет использовать эту возможность. Кроме того, делегирование можно ограничить, чтобы разрешить доступ в контексте пользователя только к определенным ресурсам. Управляемые домены доменных служб Azure AD отличаются от традиционных доменов Active Directory, поскольку они безопаснее заблокированы.

В этой статье показано, как настроить ограниченное делегирование Kerberos в управляемом домене доменных служб Azure AD.

## <a name="kerberos-constrained-delegation-kcd"></a>Ограниченное делегирование Kerberos
Делегирование Kerberos позволяет учетной записи олицетворять другой субъект безопасности (например, пользователя) для доступа к ресурсам. Рассмотрим веб-приложение, которое обращается к серверному API веб-приложения в контексте пользователя. В этом примере веб-приложение (запущенное в контексте учетной записи службы или учетной записи компьютера или виртуальной машины) олицетворяет пользователя при доступе к ресурсу (серверному API веб-приложения). Делегирование Kerberos не защищено, поскольку в нем не ограничивается доступ к ресурсам, к которым может получить доступ олицетворяемая учетная запись в контексте пользователя.

Ограниченное делегирование Kerberos ограничивает службы и ресурсы, к которым указанный сервер может обращаться от имени пользователя. Для настройки учетной записи домена для службы и ограничения учетной записи одним доменом в традиционном ограниченном делегировании Kerberos требуются привилегии администратора домена.

Традиционное ограниченное делегирование Kerberos связано с несколькими трудностями. В ранних версиях операционных систем если администратор домена настроил службу, у администратора службы не было возможности узнать, какие службы клиентской части делегируются принадлежащим им службам ресурсов. При этом все интерфейсные службы, которые можно делегировать службе ресурса, являлись потенциальной точкой атаки. Если сервер, на котором размещена интерфейсная служба, скомпрометирован и при этом он настроен для делегирования службам ресурсов, службы ресурсов также могут быть скомпрометированы.

> [!NOTE]
> В управляемом домене доменных служб Azure AD у вас нет привилегий администратора домена. Таким образом **традиционное ограниченное делегирование Kerberos нельзя настроить в управляемом домене**. Используйте основанное на ресурсах ограниченное делегирование Kerberos, как описано в этой статье. Этот механизм также более безопасен.
>
>

## <a name="resource-based-kerberos-constrained-delegation"></a>Ограниченное делегирование Kerberos на основе ресурсов
В Windows Server 2012 и Windows Server 2012 R2 возможность настройки ограниченного делегирования для службы была передана от администратора домена администратору служб. Таким образом администратор служб сервера может разрешить или запретить интерфейсные службы. Эта модель называется **ограниченное делегирование Kerberos на основе ресурсов**.

Ограниченное делегирование Kerberos на основе ресурсов настраивается с помощью PowerShell. Используйте командлет Set-ADComputer или Set-ADUser в зависимости от того, является ли учетная запись олицетворением учетной записи компьютера, учетной записи службы или пользователя.

### <a name="configure-resource-based-kcd-for-a-computer-account-on-a-managed-domain"></a>Настройка ограниченного делегирования Kerberos на основе ресурсов для учетной записи компьютера в управляемом домене
Допустим, что веб-приложение запущено на компьютере "contoso100-webapp.contoso100.com". Ему требуется доступ к ресурсу (API веб-приложения, запущенного на компьютере "contoso100-api.contoso100.com") в контексте пользователей домена. Вот как можно настроить ограниченное делегирование Kerberos на основе ресурсов для этого сценария.

```
$ImpersonatingAccount = Get-ADComputer -Identity contoso100-webapp.contoso100.com
Set-ADComputer contoso100-api.contoso100.com -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

### <a name="configure-resource-based-kcd-for-a-user-account-on-a-managed-domain"></a>Настройка ограниченного делегирования Kerberos на основе ресурсов для учетной записи пользователя в управляемом домене
Предположим, что веб-приложение запущено как от имени учетной записи службы appsvc и ему требуется доступ к ресурсу (API веб-приложения, запущенного от имени учетной записи службы backendsvc) в контексте пользователей домена. Вот как можно настроить ограниченное делегирование Kerberos на основе ресурсов для этого сценария.

```
$ImpersonatingAccount = Get-ADUser -Identity appsvc
Set-ADUser backendsvc -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

## <a name="related-content"></a>Похожий контент
* [Приступая к работе с доменными службами Azure AD](active-directory-ds-getting-started.md)
* [(Обзор ограниченного делегирования Kerberos)](https://technet.microsoft.com/library/jj553400.aspx)
