---
title: "Доменные службы Azure Active Directory: включение ограниченного делегирования Kerberos | Документация Майкрософт"
description: "Включение ограниченного делегирования Kerberos в управляемых доменах доменных служб Azure Active Directory"
services: active-directory-ds
documentationcenter: 
author: mahesh-unnikrishnan
manager: stevenpo
editor: curtand
ms.assetid: 938a5fbc-2dd1-4759-bcce-628a6e19ab9d
ms.service: active-directory-ds
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/06/2017
ms.author: maheshu
ms.openlocfilehash: d32547c8018dd1f99c992e95a01d2711d460a261
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="configure-kerberos-constrained-delegation-kcd-on-a-managed-domain"></a><span data-ttu-id="487c1-103">Настройка ограниченного делегирования Kerberos в управляемом домене</span><span class="sxs-lookup"><span data-stu-id="487c1-103">Configure kerberos constrained delegation (KCD) on a managed domain</span></span>
<span data-ttu-id="487c1-104">Во многих приложениях нужно tooaccess ресурсов в контексте hello hello пользователя.</span><span class="sxs-lookup"><span data-stu-id="487c1-104">Many applications need tooaccess resources in hello context of hello user.</span></span> <span data-ttu-id="487c1-105">Active Directory поддерживает делегирование Kerberos — механизм, который позволяет использовать эту возможность.</span><span class="sxs-lookup"><span data-stu-id="487c1-105">Active Directory supports a mechanism called Kerberos delegation, which enables this use-case.</span></span> <span data-ttu-id="487c1-106">Кроме того вы можете ограничить делегирование, чтобы только определенных ресурсов может осуществляться в контексте hello hello пользователя.</span><span class="sxs-lookup"><span data-stu-id="487c1-106">Further, you can restrict delegation so that only specific resources can be accessed in hello context of hello user.</span></span> <span data-ttu-id="487c1-107">Управляемые домены доменных служб Azure AD отличаются от традиционных доменов Active Directory, поскольку они безопаснее заблокированы.</span><span class="sxs-lookup"><span data-stu-id="487c1-107">Azure AD Domain Services managed domains are different from traditional Active Directory domains since they are more securely locked down.</span></span>

<span data-ttu-id="487c1-108">В этой статье показано, как tooconfigure kerberos ограниченного делегирования в Azure AD управляемого домена доменных служб.</span><span class="sxs-lookup"><span data-stu-id="487c1-108">This article shows you how tooconfigure kerberos constrained delegation on an Azure AD Domain Services managed domain.</span></span>

## <a name="kerberos-constrained-delegation-kcd"></a><span data-ttu-id="487c1-109">Ограниченное делегирование Kerberos</span><span class="sxs-lookup"><span data-stu-id="487c1-109">Kerberos constrained delegation (KCD)</span></span>
<span data-ttu-id="487c1-110">Делегирование Kerberos позволяет учетной записи tooimpersonate другой ресурсам участника (например, пользователь) tooaccess безопасности.</span><span class="sxs-lookup"><span data-stu-id="487c1-110">Kerberos delegation enables an account tooimpersonate another security principal (such as a user) tooaccess resources.</span></span> <span data-ttu-id="487c1-111">Рассмотрим веб-приложение, которое обращается к серверной части веб-API в контексте пользователя hello.</span><span class="sxs-lookup"><span data-stu-id="487c1-111">Consider a web application that accesses a back-end web API in hello context of a user.</span></span> <span data-ttu-id="487c1-112">В этом примере hello веб-приложения (выполняется в контексте учетной записи службы или учетной записи компьютера/machine hello) олицетворяют hello пользователя при доступе к ресурсу hello (фоновая веб-API).</span><span class="sxs-lookup"><span data-stu-id="487c1-112">In this example, hello web application (running in hello context of a service account or a computer/machine account) impersonates hello user when accessing hello resource (back-end web API).</span></span> <span data-ttu-id="487c1-113">Делегирование Kerberos не защищен, поскольку не ограничивает hello hello ресурсы олицетворения учетной записи может получить доступ в контексте hello hello пользователя.</span><span class="sxs-lookup"><span data-stu-id="487c1-113">Kerberos delegation is insecure since it does not restrict hello resources hello impersonating account can access in hello context of hello user.</span></span>

<span data-ttu-id="487c1-114">Ограниченное делегирование Kerberos (KCD) ограничивает hello, службы и ресурсы toowhich hello указанного сервера может действовать от имени hello пользователя.</span><span class="sxs-lookup"><span data-stu-id="487c1-114">Kerberos constrained delegation (KCD) restricts hello services/resources toowhich hello specified server can act on hello behalf of a user.</span></span> <span data-ttu-id="487c1-115">Традиционные проверки подлинности Kerberos требуется tooconfigure привилегии администратора домена учетной записи домена для службы и он ограничивает hello учетной записи tooa один домен.</span><span class="sxs-lookup"><span data-stu-id="487c1-115">Traditional KCD requires domain administrator privileges tooconfigure a domain account for a service and it restricts hello account tooa single domain.</span></span>

<span data-ttu-id="487c1-116">Традиционное ограниченное делегирование Kerberos связано с несколькими трудностями.</span><span class="sxs-lookup"><span data-stu-id="487c1-116">Traditional KCD also has a few issues associated with it.</span></span> <span data-ttu-id="487c1-117">В предыдущих версиях операционных систем, где hello администратор домена настроил службы hello администратор служб hello имел нет удобного способа tooknow, какие службы интерфейса делегированы toohello ресурсов службы осуществлялись.</span><span class="sxs-lookup"><span data-stu-id="487c1-117">In earlier operating systems where hello domain administrator configured hello service, hello service administrator had no useful way tooknow which front-end services delegated toohello resource services they owned.</span></span> <span data-ttu-id="487c1-118">И все службы интерфейса, которые могли делегировать службы ресурсов tooa под угрозой атаки.</span><span class="sxs-lookup"><span data-stu-id="487c1-118">And any front-end service that could delegate tooa resource service represented a potential attack point.</span></span> <span data-ttu-id="487c1-119">Если было настроенных toodelegate tooresource службы сервера, на котором размещалась служба интерфейса был скомпрометирован, службы hello ресурсов также могли быть скомпрометированы.</span><span class="sxs-lookup"><span data-stu-id="487c1-119">If a server that hosted a front-end service was compromised, and it was configured toodelegate tooresource services, hello resource services could also be compromised.</span></span>

> [!NOTE]
> <span data-ttu-id="487c1-120">В управляемом домене доменных служб Azure AD у вас нет привилегий администратора домена.</span><span class="sxs-lookup"><span data-stu-id="487c1-120">On an Azure AD Domain Services managed domain, you do not have domain administrator privileges.</span></span> <span data-ttu-id="487c1-121">Таким образом **традиционное ограниченное делегирование Kerberos нельзя настроить в управляемом домене**.</span><span class="sxs-lookup"><span data-stu-id="487c1-121">Therefore, **traditional KCD cannot be configured on a managed domain**.</span></span> <span data-ttu-id="487c1-122">Используйте основанное на ресурсах ограниченное делегирование Kerberos, как описано в этой статье.</span><span class="sxs-lookup"><span data-stu-id="487c1-122">Use resource-based KCD as described in this article.</span></span> <span data-ttu-id="487c1-123">Этот механизм также более безопасен.</span><span class="sxs-lookup"><span data-stu-id="487c1-123">This mechanism is also more secure.</span></span>
>
>

## <a name="resource-based-kerberos-constrained-delegation"></a><span data-ttu-id="487c1-124">Ограниченное делегирование Kerberos на основе ресурсов</span><span class="sxs-lookup"><span data-stu-id="487c1-124">Resource-based kerberos constrained delegation</span></span>
<span data-ttu-id="487c1-125">В Windows Server 2012 R2 и Windows Server 2012 hello возможность tooconfigure ограниченное делегирование для службы hello была передана от администратора службы toohello администратора домена hello.</span><span class="sxs-lookup"><span data-stu-id="487c1-125">In Windows Server 2012 R2 and Windows Server 2012, hello ability tooconfigure constrained delegation for hello service has been transferred from hello domain administrator toohello service administrator.</span></span> <span data-ttu-id="487c1-126">Таким образом Здравствуйте, администратор служб может разрешить или запретить службы интерфейса.</span><span class="sxs-lookup"><span data-stu-id="487c1-126">In this way, hello back-end service administrator can allow or deny front-end services.</span></span> <span data-ttu-id="487c1-127">Эта модель называется **ограниченное делегирование Kerberos на основе ресурсов**.</span><span class="sxs-lookup"><span data-stu-id="487c1-127">This model is known as **resource-based kerberos constrained delegation**.</span></span>

<span data-ttu-id="487c1-128">Ограниченное делегирование Kerberos на основе ресурсов настраивается с помощью PowerShell.</span><span class="sxs-lookup"><span data-stu-id="487c1-128">Resource-based KCD is configured using PowerShell.</span></span> <span data-ttu-id="487c1-129">Используйте hello Set-ADComputer или командлета Set-ADUser, в зависимости от того, является ли hello олицетворения учетной записи учетную запись или учетную запись службы или учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="487c1-129">You use hello Set-ADComputer or Set-ADUser cmdlets, depending on whether hello impersonating account is a computer account or a user account/service account.</span></span>

### <a name="configure-resource-based-kcd-for-a-computer-account-on-a-managed-domain"></a><span data-ttu-id="487c1-130">Настройка ограниченного делегирования Kerberos на основе ресурсов для учетной записи компьютера в управляемом домене</span><span class="sxs-lookup"><span data-stu-id="487c1-130">Configure resource-based KCD for a computer account on a managed domain</span></span>
<span data-ttu-id="487c1-131">Предположим, что веб-приложения, запущенного на компьютере hello "contoso100-webapp.contoso100.com".</span><span class="sxs-lookup"><span data-stu-id="487c1-131">Assume you have a web app running on hello computer 'contoso100-webapp.contoso100.com'.</span></span> <span data-ttu-id="487c1-132">Он должен tooaccess hello ресурсов (на веб-API "contoso100-api.contoso100.com") в контексте hello пользователей домена.</span><span class="sxs-lookup"><span data-stu-id="487c1-132">It needs tooaccess hello resource (a web API running on 'contoso100-api.contoso100.com') in hello context of domain users.</span></span> <span data-ttu-id="487c1-133">Вот как можно настроить ограниченное делегирование Kerberos на основе ресурсов для этого сценария.</span><span class="sxs-lookup"><span data-stu-id="487c1-133">Here's how you would set up resource-based KCD for this scenario.</span></span>

```
$ImpersonatingAccount = Get-ADComputer -Identity contoso100-webapp.contoso100.com
Set-ADComputer contoso100-api.contoso100.com -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

### <a name="configure-resource-based-kcd-for-a-user-account-on-a-managed-domain"></a><span data-ttu-id="487c1-134">Настройка ограниченного делегирования Kerberos на основе ресурсов для учетной записи пользователя в управляемом домене</span><span class="sxs-lookup"><span data-stu-id="487c1-134">Configure resource-based KCD for a user account on a managed domain</span></span>
<span data-ttu-id="487c1-135">Предположим, у вас есть веб-приложения, выполняющиеся как учетная запись службы «appsvc» и он должен tooaccess hello ресурсов (веб-API работает под учетной записью службы - «backendsvc») в контексте hello пользователей домена.</span><span class="sxs-lookup"><span data-stu-id="487c1-135">Assume you have a web app running as a service account 'appsvc' and it needs tooaccess hello resource (a web API running as a service account - 'backendsvc') in hello context of domain users.</span></span> <span data-ttu-id="487c1-136">Вот как можно настроить ограниченное делегирование Kerberos на основе ресурсов для этого сценария.</span><span class="sxs-lookup"><span data-stu-id="487c1-136">Here's how you would set up resource-based KCD for this scenario.</span></span>

```
$ImpersonatingAccount = Get-ADUser -Identity appsvc
Set-ADUser backendsvc -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

## <a name="related-content"></a><span data-ttu-id="487c1-137">Похожий контент</span><span class="sxs-lookup"><span data-stu-id="487c1-137">Related Content</span></span>
* [<span data-ttu-id="487c1-138">Приступая к работе с доменными службами Azure AD</span><span class="sxs-lookup"><span data-stu-id="487c1-138">Azure AD Domain Services - Getting Started guide</span></span>](active-directory-ds-getting-started.md)
* [<span data-ttu-id="487c1-139">(Обзор ограниченного делегирования Kerberos)</span><span class="sxs-lookup"><span data-stu-id="487c1-139">Kerberos Constrained Delegation Overview</span></span>](https://technet.microsoft.com/library/jj553400.aspx)
