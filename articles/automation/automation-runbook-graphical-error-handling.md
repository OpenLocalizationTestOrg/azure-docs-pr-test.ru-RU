---
title: "Обработка в графический Runbook автоматизации Azure aaaError | Документы Microsoft"
description: "В этой статье описывается способ обработки логики в графический Runbook автоматизации Azure tooimplement ошибок."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: b9ff01361d2ebd9c0174b074a7a290b1cc2fd1c8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="77697-103">Обработка ошибок в графических модулях Runbook в службе автоматизации Azure</span><span class="sxs-lookup"><span data-stu-id="77697-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="77697-104">Tooconsider основного ключа runbook разработки является определение различные проблемы, которые могут возникнуть runbook.</span><span class="sxs-lookup"><span data-stu-id="77697-104">A key runbook design principal tooconsider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="77697-105">например состояние успеха, состояния ожидаемых ошибок и условия непредвиденных ошибок.</span><span class="sxs-lookup"><span data-stu-id="77697-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="77697-106">Модули Runbook должны включать обработку ошибок.</span><span class="sxs-lookup"><span data-stu-id="77697-106">Runbooks should include error handling.</span></span> <span data-ttu-id="77697-107">toovalidate hello выходных данных действия или обработки ошибки с графический Runbook, может использовать в действии кода Windows PowerShell, задать условную логику на hello выходную ссылку действия hello или применить другой метод.</span><span class="sxs-lookup"><span data-stu-id="77697-107">toovalidate hello output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on hello output link of hello activity, or apply another method.</span></span>          

<span data-ttu-id="77697-108">Часто Если устранимую ошибку, которая происходит при использовании действия runbook, все действия, следующего обрабатывается независимо от того, ошибка hello.</span><span class="sxs-lookup"><span data-stu-id="77697-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of hello error.</span></span> <span data-ttu-id="77697-109">Hello ошибка: вероятно, toogenerate исключение, но по-прежнему может быть следующее действие hello toorun.</span><span class="sxs-lookup"><span data-stu-id="77697-109">hello error is likely toogenerate an exception, but hello next activity is still allowed toorun.</span></span> <span data-ttu-id="77697-110">Этот способ hello, PowerShell является спроектированный toohandle ошибок.</span><span class="sxs-lookup"><span data-stu-id="77697-110">This is hello way that PowerShell is designed toohandle errors.</span></span>    

<span data-ttu-id="77697-111">Завершение или устранимую Hello типов ошибок PowerShell, которые могут возникнуть во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="77697-111">hello types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="77697-112">Существуют следующие различия Hello завершающий и устранимые ошибки.</span><span class="sxs-lookup"><span data-stu-id="77697-112">hello differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="77697-113">**Прерывающая ошибка**: серьезная ошибка во время выполнения, который полностью останавливает выполнение команды hello (или выполнение сценария).</span><span class="sxs-lookup"><span data-stu-id="77697-113">**Terminating error**: A serious error during execution that halts hello command (or script execution) completely.</span></span> <span data-ttu-id="77697-114">К примерам можно отнести несуществующие командлеты, синтаксические ошибки, предотвращающие выполнение командлета, или другие неустранимые ошибки.</span><span class="sxs-lookup"><span data-stu-id="77697-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="77697-115">**Устранимые ошибки**: не серьезная ошибка, позволяющий toocontinue выполнения, несмотря на сбой hello.</span><span class="sxs-lookup"><span data-stu-id="77697-115">**Non-terminating error**: A non-serious error that allows execution toocontinue despite hello failure.</span></span> <span data-ttu-id="77697-116">Примеры включают ошибки из-за отсутствия файла и проблемы с разрешениями.</span><span class="sxs-lookup"><span data-stu-id="77697-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="77697-117">Графические модули Runbook Azure Automation улучшены с обработкой ошибок tooinclude возможность hello.</span><span class="sxs-lookup"><span data-stu-id="77697-117">Azure Automation graphical runbooks have been improved with hello capability tooinclude error handling.</span></span> <span data-ttu-id="77697-118">Теперь можно преобразовывать исключения в устранимые ошибки и создавать ссылки ошибок между действиями.</span><span class="sxs-lookup"><span data-stu-id="77697-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="77697-119">Этот процесс позволяет автору runbook toocatch ошибки и управление условиями, реализованных или неожиданно.</span><span class="sxs-lookup"><span data-stu-id="77697-119">This process allows a runbook author toocatch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-toouse-error-handling"></a><span data-ttu-id="77697-120">При обработке ошибок toouse</span><span class="sxs-lookup"><span data-stu-id="77697-120">When toouse error handling</span></span>

<span data-ttu-id="77697-121">При каждом запуске важные действия, которое вызывает произошла ошибка или исключение, это важные tooprevent hello следующее действие в модуле runbook после обработки и toohandle hello ошибки соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="77697-121">Whenever there is a critical activity that throws an error or exception, it's important tooprevent hello next activity in your runbook from processing and toohandle hello error appropriately.</span></span> <span data-ttu-id="77697-122">Это особенно важно, если модули Runbook поддерживают бизнес-процессы или операции, связанные со службами.</span><span class="sxs-lookup"><span data-stu-id="77697-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="77697-123">Для каждого действия, которое может вызвать ошибку автор runbook hello можно добавить ошибки ссылку tooany других действий.</span><span class="sxs-lookup"><span data-stu-id="77697-123">For each activity that can produce an error, hello runbook author can add an error link pointing tooany other activity.</span></span>  <span data-ttu-id="77697-124">Hello целевое действие может быть любого типа, включая действия кода вызова командлета, вызов другого модуля runbook и так далее.</span><span class="sxs-lookup"><span data-stu-id="77697-124">hello destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="77697-125">Кроме того hello целевое действие также может иметь исходящие связи.</span><span class="sxs-lookup"><span data-stu-id="77697-125">In addition, hello destination activity can also have outgoing links.</span></span> <span data-ttu-id="77697-126">Это могут быть обычные ссылки или ссылки ошибок.</span><span class="sxs-lookup"><span data-stu-id="77697-126">These links can be regular links or error links.</span></span> <span data-ttu-id="77697-127">Это означает, что автор runbook hello можно реализовать сложную логику обработки ошибок без обращения tooa код действия.</span><span class="sxs-lookup"><span data-stu-id="77697-127">This means hello runbook author can implement complex error-handling logic without resorting tooa code activity.</span></span> <span data-ttu-id="77697-128">Рекомендуется toocreate выделенный runbook обработки ошибок с общими функциональными возможностями, но это не обязательно, рекомендуется Hello.</span><span class="sxs-lookup"><span data-stu-id="77697-128">hello recommended practice is toocreate a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="77697-129">Логика обработки ошибок в действии кода PowerShell, которые не hello только параметр.</span><span class="sxs-lookup"><span data-stu-id="77697-129">Error-handling logic in a PowerShell code activity it isn't hello only option.</span></span>  

<span data-ttu-id="77697-130">Например рассмотрим книгу выполнения, пытается toostart виртуальную Машину и установите приложения на него.</span><span class="sxs-lookup"><span data-stu-id="77697-130">For example, consider a runbook that tries toostart a VM and install an application on it.</span></span> <span data-ttu-id="77697-131">Если hello виртуальная машина не запускается правильно, он выполняет два действия:</span><span class="sxs-lookup"><span data-stu-id="77697-131">If hello VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="77697-132">Отправляет уведомление об этой проблеме.</span><span class="sxs-lookup"><span data-stu-id="77697-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="77697-133">Запускает другой модуль Runbook, который автоматически подготавливает новую виртуальную машину.</span><span class="sxs-lookup"><span data-stu-id="77697-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="77697-134">Одним из решений является toohave ошибка ссылку действия tooan, что дескрипторы шаг 1.</span><span class="sxs-lookup"><span data-stu-id="77697-134">One solution is toohave an error link pointing tooan activity that handles step one.</span></span> <span data-ttu-id="77697-135">Например, можно установить соединение hello **Write-Warning** действия tooan командлет на шаге 2, например hello **AzureRmAutomationRunbook начала** командлета.</span><span class="sxs-lookup"><span data-stu-id="77697-135">For example, you could connect hello **Write-Warning** cmdlet tooan activity for step two, such as hello **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="77697-136">Может также generalize это поведение для использования в много модулей Runbook, преобразуя эти два действия в runbook обработка отдельных ошибок и приводимых hello предложил ранее.</span><span class="sxs-lookup"><span data-stu-id="77697-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following hello guidance suggested earlier.</span></span> <span data-ttu-id="77697-137">Перед вызовом этого модуля runbook обработки ошибок, можно создать пользовательское сообщение hello данные в исходное runbook hello и передайте его в качестве модуля параметр toohello обработки ошибок.</span><span class="sxs-lookup"><span data-stu-id="77697-137">Before calling this error-handling runbook, you could construct a custom message from hello data in hello original runbook, and then pass it as a parameter toohello error-handling runbook.</span></span>

## <a name="how-toouse-error-handling"></a><span data-ttu-id="77697-138">Способ обработки ошибок toouse</span><span class="sxs-lookup"><span data-stu-id="77697-138">How toouse error handling</span></span>

<span data-ttu-id="77697-139">Каждое действие настроено для преобразования исключений в устранимые ошибки.</span><span class="sxs-lookup"><span data-stu-id="77697-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="77697-140">Эта функция отключена по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="77697-140">By default, this setting is disabled.</span></span> <span data-ttu-id="77697-141">Рекомендуется включить этот параметр на любое действие, когда необходимо toohandle ошибки.</span><span class="sxs-lookup"><span data-stu-id="77697-141">We recommend that you enable this setting on any activity where you want toohandle errors.</span></span>  

<span data-ttu-id="77697-142">Включив эту конфигурацию, гарантируя завершающий и устранимые ошибки в действии hello обрабатываются как устранимые ошибки что можно обрабатывать с помощью ссылки на ошибки.</span><span class="sxs-lookup"><span data-stu-id="77697-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in hello activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="77697-143">После настройки этого параметра необходимо создать действие, которое обрабатывает ошибку hello.</span><span class="sxs-lookup"><span data-stu-id="77697-143">After configuring this setting, you create an activity that handles hello error.</span></span> <span data-ttu-id="77697-144">Если действие создает ошибки, затем hello исходящих ошибки, которые выполняются ссылки и обычные ссылки hello не, даже если стандартный выход также формирует действие hello.</span><span class="sxs-lookup"><span data-stu-id="77697-144">If an activity produces any error, then hello outgoing error links are followed, and hello regular links are not, even if hello activity produces regular output as well.</span></span><br><br> ![Пример ссылки ошибки в модуле Runbook службы автоматизации](media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="77697-146">В следующем примере hello runbook извлекает переменную, содержащую hello имя компьютера виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="77697-146">In hello following example, a runbook retrieves a variable that contains hello computer name of a virtual machine.</span></span> <span data-ttu-id="77697-147">Он предпринимает toostart hello виртуальной машины с hello следующее действие.</span><span class="sxs-lookup"><span data-stu-id="77697-147">It then attempts toostart hello virtual machine with hello next activity.</span></span><br><br> ![Пример обработки ошибок в модуле Runbook службы автоматизации](media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="77697-149">Hello **Get-AutomationVariable** действия и **AzureRmVm начала** , настроенных tooconvert tooerrors исключения.</span><span class="sxs-lookup"><span data-stu-id="77697-149">hello **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured tooconvert exceptions tooerrors.</span></span>  <span data-ttu-id="77697-150">При наличии проблем с запуском hello, переменной или начальный hello виртуальной Машины, то возникают ошибки.</span><span class="sxs-lookup"><span data-stu-id="77697-150">If there are problems getting hello variable or starting hello VM, then errors are generated.</span></span><br><br> <span data-ttu-id="77697-151">![Параметры действия обработки ошибок в модуле Runbook службы автоматизации](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="77697-151">![Automation runbook error-handling activity settings](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="77697-152">Ошибка ссылки потока из этих действий tooa один **управление обработкой ошибок** действия (действие кода).</span><span class="sxs-lookup"><span data-stu-id="77697-152">Error links flow from these activities tooa single **error management** activity (a code activity).</span></span> <span data-ttu-id="77697-153">Это действие настроено простое выражение PowerShell, который использует hello *Throw* toostop ключевое слово обработки вместе с *$Error.Exception.Message* tooget приветственное сообщение, описывающее hello текущее исключение.</span><span class="sxs-lookup"><span data-stu-id="77697-153">This activity is configured with a simple PowerShell expression that uses hello *Throw* keyword toostop processing, along with *$Error.Exception.Message* tooget hello message that describes hello current exception.</span></span><br><br> <span data-ttu-id="77697-154">![Пример кода для обработки ошибок в модуле Runbook службы автоматизации](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="77697-154">![Automation runbook error-handling code example](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="77697-155">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="77697-155">Next steps</span></span>

* <span data-ttu-id="77697-156">toolearn Дополнительные сведения о связи и типы связей в графические модули Runbook в разделе [графический разработки в Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="77697-156">toolearn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="77697-157">Дополнительные сведения о выполнение модуля runbook, как toomonitor заданиях и другие технические сведения см. в разделе toolearn [отследить задание runbook](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="77697-157">toolearn more about runbook execution, how toomonitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
