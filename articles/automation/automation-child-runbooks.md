---
title: "aaaChild Runbook в автоматизации Azure | Документы Microsoft"
description: "Описывает различные методы hello запуск runbook в автоматизации Azure из другого модуля runbook и совместного использования информации между ними."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: d3d06818d344b565d53cc4f4705b41dcfcf9a376
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="bd56b-103">Дочерние модули Runbook в службе автоматизации Azure</span><span class="sxs-lookup"><span data-stu-id="bd56b-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="bd56b-104">Рекомендуется в автоматизации Azure toowrite многоразовые, модульные Runbook с дискретной функцией, который может использоваться другими модулями Runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-104">It is a best practice in Azure Automation toowrite reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="bd56b-105">Родительский модуль runbook часто вызывает один или несколько дочерних модулей Runbook tooperform необходимые функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="bd56b-105">A parent runbook will often call one or more child runbooks tooperform required functionality.</span></span> <span data-ttu-id="bd56b-106">Существует два способа toocall дочернего модуля runbook, и каждый имеет уникальные отличия, которые следует понимать, чтобы определить, что подойдет лучше всего для различных сценариев.</span><span class="sxs-lookup"><span data-stu-id="bd56b-106">There are two ways toocall a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="bd56b-107">Вызов дочернего Runbook с использованием встроенного выполнения</span><span class="sxs-lookup"><span data-stu-id="bd56b-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="bd56b-108">tooinvoke встроенной функции модуля runbook из другого модуля runbook используйте имя hello hello runbook и укажите значения для параметров такие же используется для действия или командлета.</span><span class="sxs-lookup"><span data-stu-id="bd56b-108">tooinvoke a runbook inline from another runbook, you use hello name of hello runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="bd56b-109">Здравствуйте, все модули Runbook в одной учетной записи автоматизации еще доступны tooall других toobe используемые таким образом.</span><span class="sxs-lookup"><span data-stu-id="bd56b-109">All runbooks in hello same Automation account are available tooall others toobe used in this manner.</span></span> <span data-ttu-id="bd56b-110">Hello родительский модуль runbook будет ожидать hello дочерних runbook toocomplete перед перемещением toohello следующую строку и любые выходные данные возвращаются непосредственно toohello родительского.</span><span class="sxs-lookup"><span data-stu-id="bd56b-110">hello parent runbook will wait for hello child runbook toocomplete before moving toohello next line, and any output is returned directly toohello parent.</span></span>

<span data-ttu-id="bd56b-111">При вызове встроенной функции модуля runbook он выполняется в hello же задание как hello родительский модуль runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-111">When you invoke a runbook inline, it runs in hello same job as hello parent runbook.</span></span> <span data-ttu-id="bd56b-112">Изменений в журнале заданий hello hello дочернего модуля runbook, он был запущен не будет.</span><span class="sxs-lookup"><span data-stu-id="bd56b-112">There will be no indication in hello job history of hello child runbook that it ran.</span></span> <span data-ttu-id="bd56b-113">Любые исключения и любые выходные данные hello дочернего модуля будут связаны с родительским hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-113">Any exceptions and any stream output from hello child runbook will be associated with hello parent.</span></span> <span data-ttu-id="bd56b-114">Это приводит к меньшему числу заданий и упрощает их tootrack и tootroubleshoot после исключения, вызываемые hello дочернего модуля runbook и все выходные потока связаны с заданием родительского hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-114">This results in fewer jobs and makes them easier tootrack and tootroubleshoot since any exceptions thrown by hello child runbook and any of its stream output are associated with hello parent job.</span></span>

<span data-ttu-id="bd56b-115">При публикации Runbook все дочерние Runbook, которые он вызывает, уже должны быть опубликованы.</span><span class="sxs-lookup"><span data-stu-id="bd56b-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="bd56b-116">Это связано с тем, что служба автоматизации Azure создает связь с любыми дочерними Runbook при компиляции Runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="bd56b-117">В противном случае hello родительский модуль runbook будет правильно отображаться toopublish, но будет создавать исключение при запуске.</span><span class="sxs-lookup"><span data-stu-id="bd56b-117">If they aren’t, hello parent runbook will appear toopublish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="bd56b-118">В этом случае можно повторно опубликовать родительский модуль runbook в hello в порядке tooproperly ссылка hello дочерние модули.</span><span class="sxs-lookup"><span data-stu-id="bd56b-118">If this happens, you can republish hello parent runbook in order tooproperly reference hello child runbooks.</span></span> <span data-ttu-id="bd56b-119">Toorepublish hello родительский модуль runbook не требуется, если изменены какие-либо дочерние модули hello поскольку hello связь уже была создана.</span><span class="sxs-lookup"><span data-stu-id="bd56b-119">You do not need toorepublish hello parent runbook if any of hello child runbooks are changed because hello association will have already been created.</span></span>

<span data-ttu-id="bd56b-120">Параметры дочернего модуля runbook с вызовом встроенной Hello могут иметь любой тип данных, включая сложные объекты и имеется не [сериализации JSON](automation-starting-a-runbook.md#runbook-parameters) как при запуске runbook hello, с помощью портала управления Azure hello, или с hello Командлет Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-120">hello parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start hello runbook using hello Azure Management Portal or with hello Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="bd56b-121">Типы Runbook</span><span class="sxs-lookup"><span data-stu-id="bd56b-121">Runbook types</span></span>
<span data-ttu-id="bd56b-122">Какие типы могут вызывать друг друга?</span><span class="sxs-lookup"><span data-stu-id="bd56b-122">Which types can call each other:</span></span>

* <span data-ttu-id="bd56b-123">[Runbook PowerShell](automation-runbook-types.md#powershell-runbooks)и [графические модули Runbook](automation-runbook-types.md#graphical-runbooks) могут вызывать друг друга с помощью встроенного вызова (на основе PowerShell).</span><span class="sxs-lookup"><span data-stu-id="bd56b-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="bd56b-124">[Runbook рабочего процесса PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) и графические модули Runbook рабочего процесса PowerShell могут вызывать друг друга с помощью встроенного вызова (на основе рабочих процессов PowerShell).</span><span class="sxs-lookup"><span data-stu-id="bd56b-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="bd56b-125">Здравствуйте типы PowerShell и приветствия типы рабочего процесса PowerShell не может вызвать друг с другом, а также должны использовать AzureRmAutomationRunbook начала.</span><span class="sxs-lookup"><span data-stu-id="bd56b-125">hello PowerShell types and hello PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="bd56b-126">Когда имеет значение порядок публикации?</span><span class="sxs-lookup"><span data-stu-id="bd56b-126">When does publish order matter:</span></span>

* <span data-ttu-id="bd56b-127">Hello публикации порядок имеет значение только модули Runbook для Runbook PowerShell и рабочими процессами графического рабочего процесса PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bd56b-127">hello publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="bd56b-128">При вызове графический или рабочий процесс PowerShell дочернего модуля runbook с использованием встроенного выполнения, просто используйте имя hello runbook hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use hello name of hello runbook.</span></span>  <span data-ttu-id="bd56b-129">При вызове дочернего модуля runbook PowerShell, необходимо перед его имя с *.\\*  toospecify, hello сценарий находится в локальном каталоге hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* toospecify that hello script is located in hello local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="bd56b-130">Пример</span><span class="sxs-lookup"><span data-stu-id="bd56b-130">Example</span></span>
<span data-ttu-id="bd56b-131">Следующий пример Hello вызывается тестовый дочерний модуль runbook, принимающий три параметра, сложный объект, целое число и логическое значение.</span><span class="sxs-lookup"><span data-stu-id="bd56b-131">hello following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="bd56b-132">выходные данные дочернего модуля hello Hello назначается переменной tooa.</span><span class="sxs-lookup"><span data-stu-id="bd56b-132">hello output of hello child runbook is assigned tooa variable.</span></span>  <span data-ttu-id="bd56b-133">В этом случае hello дочерний модуль является runbook рабочего процесса PowerShell</span><span class="sxs-lookup"><span data-stu-id="bd56b-133">In this case, hello child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="bd56b-134">Ниже приведен hello же пример с использованием модуля PowerShell как дочерний hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-134">Following is hello same example using a PowerShell runbook as hello child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="bd56b-135">Запуск дочернего Runbook с помощью командлета</span><span class="sxs-lookup"><span data-stu-id="bd56b-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="bd56b-136">Можно использовать hello [начала AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) toostart командлет runbook, как описано в [toostart runbook с помощью Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="bd56b-136">You can use hello [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet toostart a runbook as described in [toostart a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="bd56b-137">Этот командлет можно использовать в двух режимах.</span><span class="sxs-lookup"><span data-stu-id="bd56b-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="bd56b-138">В одном режиме hello командлет возвращает идентификатор задания hello, сразу после создания hello дочерние задания для hello дочернего модуля.</span><span class="sxs-lookup"><span data-stu-id="bd56b-138">In one mode, hello cmdlet returns hello job id as soon as hello child job is created for hello child runbook.</span></span>  <span data-ttu-id="bd56b-139">В другом режиме можно включить, указав hello Здравствуйте, **-ожидания** параметр, командлет hello период ожидания hello дочерние задания завершается и возвращает hello выходные данные из дочернего модуля runbook hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-139">In hello other mode, which you enable by specifying hello **-wait** parameter, hello cmdlet will wait until hello child job finishes and will return hello output from hello child runbook.</span></span>

<span data-ttu-id="bd56b-140">Задание Hello из дочернего модуля runbook, запущенное с помощью командлета будет выполняться в отдельном задании из родительского модуля hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-140">hello job from a child runbook started with a cmdlet will run in a separate job from hello parent runbook.</span></span> <span data-ttu-id="bd56b-141">Это приводит к увеличению числа заданий, чем при вызове встроенной функции модуля runbook hello и делает их более сложным tootrack.</span><span class="sxs-lookup"><span data-stu-id="bd56b-141">This results in more jobs than invoking hello runbook inline and makes them more difficult tootrack.</span></span> <span data-ttu-id="bd56b-142">родительский Hello можно запустить несколько дочерних модулей асинхронно без ожидания завершения каждого toocomplete.</span><span class="sxs-lookup"><span data-stu-id="bd56b-142">hello parent can start multiple child runbooks asynchronously without waiting for each toocomplete.</span></span> <span data-ttu-id="bd56b-143">Для такого же вида параллельного выполнения вызова hello дочерние модули Runbook встроенной функции hello родительский модуль runbook, потребуется toouse hello [параллельных ключевое слово](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="bd56b-143">For that same kind of parallel execution calling hello child runbooks inline, hello parent runbook would need toouse hello [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="bd56b-144">Параметры дочернего Runbook, запускаемого с помощью командлета, предоставляются в виде хэш-таблицы, как описано в статье [Параметры Runbook](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="bd56b-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="bd56b-145">Можно использовать только простые типы данных.</span><span class="sxs-lookup"><span data-stu-id="bd56b-145">Only simple data types can be used.</span></span> <span data-ttu-id="bd56b-146">Если hello runbook имеет параметр со сложным типом данных, затем его необходимо вызывать в коде.</span><span class="sxs-lookup"><span data-stu-id="bd56b-146">If hello runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="bd56b-147">Пример</span><span class="sxs-lookup"><span data-stu-id="bd56b-147">Example</span></span>
<span data-ttu-id="bd56b-148">Hello следующем примере запускается дочерний модуль runbook с параметрами и затем ожидает toocomplete с помощью hello Start AzureRmAutomationRunbook-ожидания параметра.</span><span class="sxs-lookup"><span data-stu-id="bd56b-148">hello following example starts a child runbook with parameters and then waits for it toocomplete using hello Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="bd56b-149">После завершения его выходные данные из дочернего модуля hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-149">Once completed, its output is collected from hello child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="bd56b-150">Сравнение методов вызова дочернего Runbook</span><span class="sxs-lookup"><span data-stu-id="bd56b-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="bd56b-151">Hello следующей таблице представлены различия hello hello два метода для вызова модуля runbook из другого модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-151">hello following table summarizes hello differences between hello two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="bd56b-152">Встроенный</span><span class="sxs-lookup"><span data-stu-id="bd56b-152">Inline</span></span> | <span data-ttu-id="bd56b-153">Командлет</span><span class="sxs-lookup"><span data-stu-id="bd56b-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="bd56b-154">Задание</span><span class="sxs-lookup"><span data-stu-id="bd56b-154">Job</span></span> |<span data-ttu-id="bd56b-155">Дочерние модули Runbook выполняются в hello же задание как родительский hello.</span><span class="sxs-lookup"><span data-stu-id="bd56b-155">Child runbooks run in hello same job as hello parent.</span></span> |<span data-ttu-id="bd56b-156">Для hello дочернего модуля runbook создается отдельное задание.</span><span class="sxs-lookup"><span data-stu-id="bd56b-156">A separate job is created for hello child runbook.</span></span> |
| <span data-ttu-id="bd56b-157">Выполнение</span><span class="sxs-lookup"><span data-stu-id="bd56b-157">Execution</span></span> |<span data-ttu-id="bd56b-158">Родительский модуль runbook ожидает hello дочерних runbook toocomplete перед продолжением.</span><span class="sxs-lookup"><span data-stu-id="bd56b-158">Parent runbook waits for hello child runbook toocomplete before continuing.</span></span> |<span data-ttu-id="bd56b-159">Родительский модуль runbook продолжает работу сразу после запуска дочернего модуля runbook *или* родительский модуль runbook ожидает hello дочерние задания toofinish.</span><span class="sxs-lookup"><span data-stu-id="bd56b-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for hello child job toofinish.</span></span> |
| <span data-ttu-id="bd56b-160">Выходные данные</span><span class="sxs-lookup"><span data-stu-id="bd56b-160">Output</span></span> |<span data-ttu-id="bd56b-161">Родительский Runbook может получить выходные данные непосредственно из дочернего Runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="bd56b-162">Родительский модуль Runbook должен получить выходные данные из задания дочернего модуля Runbook *или* может получить выходные данные непосредственно из дочернего модуля Runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="bd56b-163">Параметры</span><span class="sxs-lookup"><span data-stu-id="bd56b-163">Parameters</span></span> |<span data-ttu-id="bd56b-164">Значения для параметров hello дочерних модулей runbook указываются отдельно и могут использовать любой тип данных.</span><span class="sxs-lookup"><span data-stu-id="bd56b-164">Values for hello child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="bd56b-165">Значения для дочернего модуля hello параметры должны быть объединены в одну хэш-таблицу и могут содержать только простой, массива или объекта, что типы данных, использующие сериализацию JSON.</span><span class="sxs-lookup"><span data-stu-id="bd56b-165">Values for hello child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="bd56b-166">Учетная запись службы автоматизации</span><span class="sxs-lookup"><span data-stu-id="bd56b-166">Automation Account</span></span> |<span data-ttu-id="bd56b-167">Родительский модуль runbook можно использовать только дочерний модуль в hello одной учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="bd56b-167">Parent runbook can only use child runbook in hello same automation account.</span></span> |<span data-ttu-id="bd56b-168">Родительский модуль runbook можно использовать дочерний модуль из любой учетной записи автоматизации hello одной подписке Azure и даже в других подписках при наличии tooit соединения.</span><span class="sxs-lookup"><span data-stu-id="bd56b-168">Parent runbook can use child runbook from any automation account from hello same Azure subscription and even a different subscription if you have a connection tooit.</span></span> |
| <span data-ttu-id="bd56b-169">Публикация</span><span class="sxs-lookup"><span data-stu-id="bd56b-169">Publishing</span></span> |<span data-ttu-id="bd56b-170">Перед публикацией родительского Runbook должен быть опубликован дочерний Runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="bd56b-171">Дочерний Runbook должен быть опубликован в любое время до запуска родительского Runbook.</span><span class="sxs-lookup"><span data-stu-id="bd56b-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="bd56b-172">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="bd56b-172">Next steps</span></span>
* [<span data-ttu-id="bd56b-173">Запуск модуля Runbook в службе автоматизации Azure</span><span class="sxs-lookup"><span data-stu-id="bd56b-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="bd56b-174">Выходные данные и сообщения Runbook в службе автоматизации Azure</span><span class="sxs-lookup"><span data-stu-id="bd56b-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

