---
title: "Пересылка данных отчетов Azure Automation DSC в OMS Log Analytics | Документация Майкрософт"
description: "В этой статье показано, как отправлять данные отчетов Desired State Configuration (DSC) в Log Analytics (Microsoft Operations Management Suite) для получения дополнительных сведений и возможностей управления."
services: automation
documentationcenter: 
author: eslesar
manager: carmonm
editor: tysonn
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/24/2017
ms.author: eslesar
ms.openlocfilehash: 316031c5297a0201c8db4a9e177298c78962c673
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2017
---
# <a name="forward-azure-automation-dsc-reporting-data-to-oms-log-analytics"></a><span data-ttu-id="c8bb4-103">Пересылка данных отчетов Azure Automation DSC в OMS Log Analytics</span><span class="sxs-lookup"><span data-stu-id="c8bb4-103">Forward Azure Automation DSC reporting data to OMS Log Analytics</span></span>

<span data-ttu-id="c8bb4-104">Служба автоматизации может отправлять сведения о состоянии узла DSC в рабочую область Log Analytics в Microsoft Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-104">Automation can send DSC node status data to your Microsoft Operations Management Suite (OMS) Log Analytics workspace.</span></span>  
<span data-ttu-id="c8bb4-105">Сведения о состоянии соответствия для узлов и отдельных ресурсов DSC в конфигурации узла можно просмотреть на портале Azure или с помощью PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-105">Compliance status is visible in the Azure portal, or with PowerShell, for nodes and for individual DSC resources in node configurations.</span></span> <span data-ttu-id="c8bb4-106">С помощью Log Analytics можно:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-106">With Log Analytics you can:</span></span>

* <span data-ttu-id="c8bb4-107">получать сведения о соответствии требованиям для управляемых узлов и отдельных ресурсов;</span><span class="sxs-lookup"><span data-stu-id="c8bb4-107">Get compliance information for managed nodes and individual resources</span></span>
* <span data-ttu-id="c8bb4-108">активировать сообщение электронной почты или предупреждение (в зависимости от состояния соответствия);</span><span class="sxs-lookup"><span data-stu-id="c8bb4-108">Trigger an email or alert based on compliance status</span></span>
* <span data-ttu-id="c8bb4-109">создавать сложные запросы к управляемым узлам;</span><span class="sxs-lookup"><span data-stu-id="c8bb4-109">Write advanced queries across your managed nodes</span></span>
* <span data-ttu-id="c8bb4-110">сопоставлять состояние соответствия в учетных записях службы автоматизации;</span><span class="sxs-lookup"><span data-stu-id="c8bb4-110">Correlate compliance status across Automation accounts</span></span>
* <span data-ttu-id="c8bb4-111">визуализировать журнал соответствия узла с течением времени.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-111">Visualize your node compliance history over time</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c8bb4-112">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="c8bb4-112">Prerequisites</span></span>

<span data-ttu-id="c8bb4-113">Чтобы начать отправку отчетов Automation DSC в Log Analytics, необходимо следующее:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-113">To start sending your Automation DSC reports to Log Analytics, you need:</span></span>

* <span data-ttu-id="c8bb4-114">Выпуск за ноябрь 2016 года или более поздний выпуск [Azure PowerShell](/powershell/azure/overview) (вер. 2.3.0).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-114">The November 2016 or later release of [Azure PowerShell](/powershell/azure/overview) (v2.3.0).</span></span>
* <span data-ttu-id="c8bb4-115">Учетная запись службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-115">An Azure Automation account.</span></span> <span data-ttu-id="c8bb4-116">Дополнительные сведения см. в статье [Приступая к работе со службой автоматизации Azure](automation-offering-get-started.md)</span><span class="sxs-lookup"><span data-stu-id="c8bb4-116">For more information, see [Getting Started with Azure Automation](automation-offering-get-started.md)</span></span>
* <span data-ttu-id="c8bb4-117">Рабочая область Log Analytics с предложением службы **Автоматизация и управление**.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-117">A Log Analytics workspace with an **Automation & Control** service offering.</span></span> <span data-ttu-id="c8bb4-118">Дополнительные сведения см. в статье [Начало работы с Log Analytics](../log-analytics/log-analytics-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-118">For more information, see [Get started with Log Analytics](../log-analytics/log-analytics-get-started.md).</span></span>
* <span data-ttu-id="c8bb4-119">Как минимум один узел Azure Automation DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-119">At least one Azure Automation DSC node.</span></span> <span data-ttu-id="c8bb4-120">Дополнительные сведения см. в статье [Подключение компьютеров для управления с помощью Azure Automation DSC](automation-dsc-onboarding.md).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-120">For more information, see [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md)</span></span> 

## <a name="set-up-integration-with-log-analytics"></a><span data-ttu-id="c8bb4-121">Настройка интеграции с Log Analytics</span><span class="sxs-lookup"><span data-stu-id="c8bb4-121">Set up integration with Log Analytics</span></span>

<span data-ttu-id="c8bb4-122">Чтобы начать импорт данных из Azure Automation DSC в Log Analytics, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-122">To begin importing data from Azure Automation DSC into Log Analytics, complete the following steps:</span></span>

1. <span data-ttu-id="c8bb4-123">Войдите в свою учетную запись Azure в PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-123">Log in to your Azure account in PowerShell.</span></span> <span data-ttu-id="c8bb4-124">См. статью [Вход с помощью Azure PowerShell](https://docs.microsoft.com/en-us/powershell/azure/authenticate-azureps?view=azurermps-4.0.0).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-124">See [Log in with Azure PowerShell](https://docs.microsoft.com/en-us/powershell/azure/authenticate-azureps?view=azurermps-4.0.0)</span></span>
1. <span data-ttu-id="c8bb4-125">Получите идентификатор _ResourceId_ для учетной записи службы автоматизации, выполнив следующую команду PowerShell (при наличии нескольких учетных записей службы автоматизации выберите _ResourceID_ для учетной записи, которую требуется настроить):</span><span class="sxs-lookup"><span data-stu-id="c8bb4-125">Get the _ResourceId_ of your automation account by running the following PowerShell command: (if you have more than one automation account, choose the _ResourceID_ for the account you want to configure).</span></span>

  ```powershell
  # Find the ResourceId for the Automation Account
  Find-AzureRmResource -ResourceType "Microsoft.Automation/automationAccounts"
  ```
1. <span data-ttu-id="c8bb4-126">Получите идентификатор _ResourceId_ для рабочей области Log Analytics, выполнив следующую команду PowerShell (при наличии нескольких рабочих областей выберите _ResourceID_ для рабочей области, которую требуется настроить):</span><span class="sxs-lookup"><span data-stu-id="c8bb4-126">Get the _ResourceId_ of your Log Analytics workspace by running the following PowerShell command: (if you have more than one workspace, choose the _ResourceID_ for the workspace you want to configure).</span></span>

  ```powershell
  # Find the ResourceId for the Log Analytics workspace
  Find-AzureRmResource -ResourceType "Microsoft.OperationalInsights/workspaces"
  ```
1. <span data-ttu-id="c8bb4-127">Выполните следующую команду PowerShell, заменив `<AutomationResourceId>` и `<WorkspaceResourceId>` значениями _ResourceId_ из предыдущих шагов:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-127">Run the following PowerShell command, replacing `<AutomationResourceId>` and `<WorkspaceResourceId>` with the _ResourceId_ values from each of the previous steps:</span></span>

  ```powershell
  Set-AzureRmDiagnosticSetting -ResourceId <AutomationResourceId> -WorkspaceId <WorkspaceResourceId> -Enabled $true -Categories "DscNodeStatus"
  ```

<span data-ttu-id="c8bb4-128">Чтобы остановить импорт данных из Azure Automation DSC в Log Analytics, выполните следующую команду PowerShell:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-128">If you want to stop importing data from Azure Automation DSC into Log Analytics, run the following PowerShell command.</span></span>

```powershell
Set-AzureRmDiagnosticSetting -ResourceId <AutomationResourceId> -WorkspaceId <WorkspaceResourceId> -Enabled $false -Categories "DscNodeStatus"
```

## <a name="view-the-dsc-logs"></a><span data-ttu-id="c8bb4-129">Просмотр журналов DSC</span><span class="sxs-lookup"><span data-stu-id="c8bb4-129">View the DSC logs</span></span>

<span data-ttu-id="c8bb4-130">Когда интеграция с Log Analytics для данных Automation DSC будет настроена, отобразится кнопка **Поиск по журналам** в колонке **Узлы DSC** в учетной записи службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-130">After you set up integration with Log Analytics for your Automation DSC data, a **Log search** button will appear on the **DSC Nodes** blade of your automation account.</span></span> <span data-ttu-id="c8bb4-131">Нажмите кнопку **Поиск по журналам**, чтобы просмотреть журналы для данных узла DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-131">Click the **Log Search** button to view the logs for DSC node data.</span></span>

![Кнопка поиска по журналам](media/automation-dsc-diagnostics/log-search-button.png)

<span data-ttu-id="c8bb4-133">Откроется колонка **Поиск по журналам**, и для каждого узла DSC отобразятся данные операции **DscNodeStatusData**. Для каждого [ресурса DSC](https://msdn.microsoft.com/powershell/dsc/resources), вызванного в конфигурации такого узла, отобразятся данные операции **DscResourceStatusData**.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-133">The **Log Search** blade opens, and you see a **DscNodeStatusData** operation for each DSC node, and a **DscResourceStatusData** operation for each [DSC resource](https://msdn.microsoft.com/powershell/dsc/resources) called in the Node configuration applied to that node.</span></span>

<span data-ttu-id="c8bb4-134">Для операции **DscResourceStatusData** отображаются сведения об ошибках при сбое в работе любых ресурсов DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-134">The **DscResourceStatusData** operation contains error information for any DSC resources that failed.</span></span>

<span data-ttu-id="c8bb4-135">Щелкните каждую операцию в списке, чтобы просмотреть сведения о ней.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-135">Click each operation in the list to see the data for that operation.</span></span>

<span data-ttu-id="c8bb4-136">Кроме того, можно просмотреть журналы, выполнив поиск в Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-136">You can also view the logs by [searching in Log Analytics.</span></span> <span data-ttu-id="c8bb4-137">См. статью [Поиск данных по журналам](../log-analytics/log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-137">See [Find data using log searches](../log-analytics/log-analytics-log-searches.md).</span></span>
<span data-ttu-id="c8bb4-138">Чтобы найти журналы DSC, введите запрос `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category = "DscNodeStatus"`</span><span class="sxs-lookup"><span data-stu-id="c8bb4-138">Type the following query to find your DSC logs: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category = "DscNodeStatus"`</span></span>

<span data-ttu-id="c8bb4-139">Можно сузить запрос, использовав имя операции.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-139">You can also narrow the query by the operation name.</span></span> <span data-ttu-id="c8bb4-140">Например: \`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category = "DscNodeStatus" OperationName = "DscNodeStatusData"</span><span class="sxs-lookup"><span data-stu-id="c8bb4-140">For example: \`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category = "DscNodeStatus" OperationName = "DscNodeStatusData"</span></span>

### <a name="send-an-email-when-a-dsc-compliance-check-fails"></a><span data-ttu-id="c8bb4-141">Отправка сообщения электронной почты при сбое проверки соответствия DSC</span><span class="sxs-lookup"><span data-stu-id="c8bb4-141">Send an email when a DSC compliance check fails</span></span>

<span data-ttu-id="c8bb4-142">Наши клиенты часто интересуются возможностью отправки электронного сообщения или SMS-сообщения при возникновении ошибки в конфигурации DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-142">One of our top customer requests is for the ability to send an email or a text when something goes wrong with a DSC configuration.</span></span>   

<span data-ttu-id="c8bb4-143">Чтобы создать правило генерации оповещений, начните с создания поиска по журналам для записей отчетов DSC, которые должны вызывать оповещение.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-143">To create an alert rule, you start by creating a log search for the DSC report records that should invoke the alert.</span></span>  <span data-ttu-id="c8bb4-144">Щелкните кнопку **Оповещение**, чтобы создать и настроить правило генерации оповещений.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-144">Click the **Alert** button to create and configure the alert rule.</span></span>

1. <span data-ttu-id="c8bb4-145">На странице обзора Log Analytics щелкните **Поиск по журналу**.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-145">From the Log Analytics Overview page, click **Log Search**.</span></span>
1. <span data-ttu-id="c8bb4-146">Поищите по журналам свое оповещение при помощи следующего поискового запроса: `Type=AzureDiagnostics Category=DscNodeStatus NodeName_s=DSCTEST1 OperationName=DscNodeStatusData ResultType=Failed`</span><span class="sxs-lookup"><span data-stu-id="c8bb4-146">Create a log search query for your alert by typing the following search into the query field:  `Type=AzureDiagnostics Category=DscNodeStatus NodeName_s=DSCTEST1 OperationName=DscNodeStatusData ResultType=Failed`</span></span>

  <span data-ttu-id="c8bb4-147">Если вы настроили для рабочей области журналы из более чем одной учетной записи службы автоматизации или подписки, то можете группировать оповещения по подписке или учетной записи службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-147">If you have set up logs from more than one Automation account or subscription to your workspace, you can group your alerts by subscription and Automation account.</span></span>  
  <span data-ttu-id="c8bb4-148">Имя учетной записи службы автоматизации можно получить из поля "Ресурс" для поискового запроса DscNodeStatusData.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-148">Automation account name can be derived from the Resource field in the search of DscNodeStatusData.</span></span>  
1. <span data-ttu-id="c8bb4-149">Чтобы открыть экран **Добавить правило оповещения**, щелкните **Оповещение** в верхней части страницы.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-149">To open the **Add Alert Rule** screen, click **Alert** at the top of the page.</span></span> <span data-ttu-id="c8bb4-150">Дополнительные сведения о параметрах для настройки оповещения см. в разделе [Правила оповещения](../log-analytics/log-analytics-alerts.md#alert-rules).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-150">For more information on the options to configure the alert, see [Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md#alert-rules).</span></span>

### <a name="find-failed-dsc-resources-across-all-nodes"></a><span data-ttu-id="c8bb4-151">Поиск ресурсов DSC со сбоями по всем узлам</span><span class="sxs-lookup"><span data-stu-id="c8bb4-151">Find failed DSC resources across all nodes</span></span>

<span data-ttu-id="c8bb4-152">Одно из преимуществ Log Analytics — возможность поиска проверок со сбоями по узлам.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-152">One advantage of using Log Analytics is that you can search for failed checks across nodes.</span></span>
<span data-ttu-id="c8bb4-153">Чтобы найти все экземпляры ресурсов DSC со сбоями, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-153">To find all instances of DSC resources that failed.</span></span>

1. <span data-ttu-id="c8bb4-154">На странице обзора Log Analytics щелкните **Поиск по журналу**.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-154">From the Log Analytics Overview page, click **Log Search**.</span></span>
1. <span data-ttu-id="c8bb4-155">Поищите по журналам свое оповещение при помощи следующего поискового запроса: `Type=AzureDiagnostics Category=DscNodeStatus OperationName=DscResourceStatusData ResultType=Failed`</span><span class="sxs-lookup"><span data-stu-id="c8bb4-155">Create a log search query for your alert by typing the following search into the query field:  `Type=AzureDiagnostics Category=DscNodeStatus OperationName=DscResourceStatusData ResultType=Failed`</span></span>

### <a name="view-historical-dsc-node-status"></a><span data-ttu-id="c8bb4-156">Просмотр состояния узла DSC за предыдущие периоды</span><span class="sxs-lookup"><span data-stu-id="c8bb4-156">View historical DSC node status</span></span>

<span data-ttu-id="c8bb4-157">Наконец, вам может понадобиться визуализировать изменение состояния узла DSC с течением времени.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-157">Finally, you may want to visualize your DSC node status history over time.</span></span>  
<span data-ttu-id="c8bb4-158">Для поиска состояния узла DSC за предыдущие периоды можно использовать следующий запрос:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-158">You can use this query to search for the status of your DSC node status over time.</span></span>

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=DscNodeStatus NOT(ResultType="started") | measure Count() by ResultType interval 1hour`  

<span data-ttu-id="c8bb4-159">При этом отобразится диаграмма состояния узла с течением времени.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-159">This will display a chart of the node status over time.</span></span>

## <a name="log-analytics-records"></a><span data-ttu-id="c8bb4-160">Записи Log Analytics</span><span class="sxs-lookup"><span data-stu-id="c8bb4-160">Log Analytics records</span></span>

<span data-ttu-id="c8bb4-161">При диагностике службы автоматизации Azure в Log Analytics создаются записи двух категорий.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-161">Diagnostics from Azure Automation creates two categories of records in Log Analytics.</span></span>

### <a name="dscnodestatusdata"></a><span data-ttu-id="c8bb4-162">DscNodeStatusData</span><span class="sxs-lookup"><span data-stu-id="c8bb4-162">DscNodeStatusData</span></span>

| <span data-ttu-id="c8bb4-163">Свойство</span><span class="sxs-lookup"><span data-stu-id="c8bb4-163">Property</span></span> | <span data-ttu-id="c8bb4-164">Описание</span><span class="sxs-lookup"><span data-stu-id="c8bb4-164">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c8bb4-165">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="c8bb4-165">TimeGenerated</span></span> |<span data-ttu-id="c8bb4-166">Дата и время запуска проверки соответствия.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-166">Date and time when the compliance check ran.</span></span> |
| <span data-ttu-id="c8bb4-167">OperationName</span><span class="sxs-lookup"><span data-stu-id="c8bb4-167">OperationName</span></span> |<span data-ttu-id="c8bb4-168">DscNodeStatusData</span><span class="sxs-lookup"><span data-stu-id="c8bb4-168">DscNodeStatusData</span></span> |
| <span data-ttu-id="c8bb4-169">ResultType</span><span class="sxs-lookup"><span data-stu-id="c8bb4-169">ResultType</span></span> |<span data-ttu-id="c8bb4-170">Подтверждено ли соответствие узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-170">Whether the node is compliant.</span></span> |
| <span data-ttu-id="c8bb4-171">NodeName_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-171">NodeName_s</span></span> |<span data-ttu-id="c8bb4-172">Имя управляемого узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-172">The name of the managed node.</span></span> |
| <span data-ttu-id="c8bb4-173">NodeComplianceStatus_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-173">NodeComplianceStatus_s</span></span> |<span data-ttu-id="c8bb4-174">Подтверждено ли соответствие узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-174">Whether the node is compliant.</span></span> |
| <span data-ttu-id="c8bb4-175">DscReportStatus</span><span class="sxs-lookup"><span data-stu-id="c8bb4-175">DscReportStatus</span></span> |<span data-ttu-id="c8bb4-176">Успешно ли прошла проверка соответствия.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-176">Whether the compliance check ran successfully.</span></span> |
| <span data-ttu-id="c8bb4-177">ConfigurationMode</span><span class="sxs-lookup"><span data-stu-id="c8bb4-177">ConfigurationMode</span></span> | <span data-ttu-id="c8bb4-178">Применение конфигурации к узлу.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-178">How the configuration is applied to the node.</span></span> <span data-ttu-id="c8bb4-179">Возможные значения: __ApplyOnly__, __ApplyandMonitior__ и __ApplyandAutoCorrect__.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-179">Possible values are __"ApplyOnly"__,__"ApplyandMonitior"__, and __"ApplyandAutoCorrect"__.</span></span> <ul><li><span data-ttu-id="c8bb4-180">__ApplyOnly__ — DSC применяет конфигурацию и не выполняет дальнейшие действия, пока новая конфигурация не будет отправлена в целевой узел или получена с сервера.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-180">__ApplyOnly__: DSC applies the configuration and does nothing further unless a new configuration is pushed to the target node or when a new configuration is pulled from a server.</span></span> <span data-ttu-id="c8bb4-181">После первоначального применения новой конфигурации DSC не проверяет наличие отклонений от ранее настроенного состояния.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-181">After initial application of a new configuration, DSC does not check for drift from a previously configured state.</span></span> <span data-ttu-id="c8bb4-182">Перед вступлением в силу __ApplyOnly__ DSC пытается применить конфигурацию, пока это не будет успешно реализовано.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-182">DSC attempts to apply the configuration until it is successful before __ApplyOnly__ takes effect.</span></span> </li><li> <span data-ttu-id="c8bb4-183">__ApplyAndMonitor__ — значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-183">__ApplyAndMonitor__: This is the default value.</span></span> <span data-ttu-id="c8bb4-184">LCM применяет любую новую конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-184">The LCM applies any new configurations.</span></span> <span data-ttu-id="c8bb4-185">Если после начального применения новой конфигурации состояние целевого узла отклоняется от требуемого, DSC сообщает о расхождении в журналах.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-185">After initial application of a new configuration, if the target node drifts from the desired state, DSC reports the discrepancy in logs.</span></span> <span data-ttu-id="c8bb4-186">Перед вступлением в силу __ApplyAndMonitor__ DSC пытается применить конфигурацию, пока это не будет успешно реализовано.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-186">DSC attempts to apply the configuration until it is successful before __ApplyAndMonitor__ takes effect.</span></span></li><li><span data-ttu-id="c8bb4-187">__ApplyAndAutoCorrect__ — DSC применяет любые новые конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-187">__ApplyAndAutoCorrect__: DSC applies any new configurations.</span></span> <span data-ttu-id="c8bb4-188">Если после начального применения новой конфигурации состояние целевого узла отклоняется от требуемого, DSC сообщает о расхождении в журналах, а затем повторно применяет текущую конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-188">After initial application of a new configuration, if the target node drifts from the desired state, DSC reports the discrepancy in logs, and then reapplies the current configuration.</span></span></li></ul> |
| <span data-ttu-id="c8bb4-189">HostName_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-189">HostName_s</span></span> | <span data-ttu-id="c8bb4-190">Имя управляемого узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-190">The name of the managed node.</span></span> |
| <span data-ttu-id="c8bb4-191">IPAddress</span><span class="sxs-lookup"><span data-stu-id="c8bb4-191">IPAddress</span></span> | <span data-ttu-id="c8bb4-192">Адрес IPv4 управляемого узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-192">The IPv4 address of the managed node.</span></span> |
| <span data-ttu-id="c8bb4-193">Категория</span><span class="sxs-lookup"><span data-stu-id="c8bb4-193">Category</span></span> | <span data-ttu-id="c8bb4-194">DscNodeStatus</span><span class="sxs-lookup"><span data-stu-id="c8bb4-194">DscNodeStatus</span></span> |
| <span data-ttu-id="c8bb4-195">Ресурс</span><span class="sxs-lookup"><span data-stu-id="c8bb4-195">Resource</span></span> | <span data-ttu-id="c8bb4-196">Имя учетной записи службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-196">The name of the Azure Automation account.</span></span> |
| <span data-ttu-id="c8bb4-197">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="c8bb4-197">Tenant_g</span></span> | <span data-ttu-id="c8bb4-198">GUID, идентифицирующий клиента для вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-198">GUID that identifies the tenant for the Caller.</span></span> |
| <span data-ttu-id="c8bb4-199">NodeId_g</span><span class="sxs-lookup"><span data-stu-id="c8bb4-199">NodeId_g</span></span> |<span data-ttu-id="c8bb4-200">Идентификатор GUID для определения управляемого узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-200">GUID that identifies the managed node.</span></span> |
| <span data-ttu-id="c8bb4-201">DscReportId_g</span><span class="sxs-lookup"><span data-stu-id="c8bb4-201">DscReportId_g</span></span> |<span data-ttu-id="c8bb4-202">Идентификатор GUID для определения отчета.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-202">GUID that identifies the report.</span></span> |
| <span data-ttu-id="c8bb4-203">LastSeenTime_t</span><span class="sxs-lookup"><span data-stu-id="c8bb4-203">LastSeenTime_t</span></span> |<span data-ttu-id="c8bb4-204">Дата и время последнего просмотра отчета.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-204">Date and time when the report was last viewed.</span></span> |
| <span data-ttu-id="c8bb4-205">ReportStartTime_t</span><span class="sxs-lookup"><span data-stu-id="c8bb4-205">ReportStartTime_t</span></span> |<span data-ttu-id="c8bb4-206">Дата и время начала отчета.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-206">Date and time when the report was started.</span></span> |
| <span data-ttu-id="c8bb4-207">ReportEndTime_t</span><span class="sxs-lookup"><span data-stu-id="c8bb4-207">ReportEndTime_t</span></span> |<span data-ttu-id="c8bb4-208">Дата и время завершения отчета.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-208">Date and time when the report completed.</span></span> |
| <span data-ttu-id="c8bb4-209">NumberOfResources_d</span><span class="sxs-lookup"><span data-stu-id="c8bb4-209">NumberOfResources_d</span></span> |<span data-ttu-id="c8bb4-210">Количество ресурсов DSC, которые вызывались в примененной к узлу конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-210">The number of DSC resources called in the configuration applied to the node.</span></span> |
| <span data-ttu-id="c8bb4-211">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="c8bb4-211">SourceSystem</span></span> | <span data-ttu-id="c8bb4-212">Способ сбора данных в Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-212">How Log Analytics collected the data.</span></span> <span data-ttu-id="c8bb4-213">Всегда имеет значение *Azure* для системы диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-213">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="c8bb4-214">ResourceId</span><span class="sxs-lookup"><span data-stu-id="c8bb4-214">ResourceId</span></span> |<span data-ttu-id="c8bb4-215">Указывает учетную запись службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-215">Specifies the Azure Automation account.</span></span> |
| <span data-ttu-id="c8bb4-216">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="c8bb4-216">ResultDescription</span></span> | <span data-ttu-id="c8bb4-217">Описание для этой операции.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-217">The description for this operation.</span></span> |
| <span data-ttu-id="c8bb4-218">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="c8bb4-218">SubscriptionId</span></span> | <span data-ttu-id="c8bb4-219">Идентификатор подписки Azure (GUID) для учетной записи службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-219">The Azure subscription Id (GUID) for the Automation account.</span></span> |
| <span data-ttu-id="c8bb4-220">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="c8bb4-220">ResourceGroup</span></span> | <span data-ttu-id="c8bb4-221">Имя группы ресурсов для учетной записи службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-221">Name of the resource group for the Automation account.</span></span> |
| <span data-ttu-id="c8bb4-222">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="c8bb4-222">ResourceProvider</span></span> | <span data-ttu-id="c8bb4-223">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="c8bb4-223">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="c8bb4-224">ResourceType</span><span class="sxs-lookup"><span data-stu-id="c8bb4-224">ResourceType</span></span> | <span data-ttu-id="c8bb4-225">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="c8bb4-225">AUTOMATIONACCOUNTS</span></span> |
| <span data-ttu-id="c8bb4-226">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="c8bb4-226">CorrelationId</span></span> |<span data-ttu-id="c8bb4-227">Идентификатор GUID для корреляции отчета о соответствии.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-227">GUID that is the Correlation Id of the compliance report.</span></span> |

### <a name="dscresourcestatusdata"></a><span data-ttu-id="c8bb4-228">DscResourceStatusData</span><span class="sxs-lookup"><span data-stu-id="c8bb4-228">DscResourceStatusData</span></span>

| <span data-ttu-id="c8bb4-229">Свойство</span><span class="sxs-lookup"><span data-stu-id="c8bb4-229">Property</span></span> | <span data-ttu-id="c8bb4-230">Описание</span><span class="sxs-lookup"><span data-stu-id="c8bb4-230">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c8bb4-231">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="c8bb4-231">TimeGenerated</span></span> |<span data-ttu-id="c8bb4-232">Дата и время запуска проверки соответствия.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-232">Date and time when the compliance check ran.</span></span> |
| <span data-ttu-id="c8bb4-233">OperationName</span><span class="sxs-lookup"><span data-stu-id="c8bb4-233">OperationName</span></span> |<span data-ttu-id="c8bb4-234">DscResourceStatusData</span><span class="sxs-lookup"><span data-stu-id="c8bb4-234">DscResourceStatusData</span></span>|
| <span data-ttu-id="c8bb4-235">ResultType</span><span class="sxs-lookup"><span data-stu-id="c8bb4-235">ResultType</span></span> |<span data-ttu-id="c8bb4-236">Подтверждено ли соответствие ресурса.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-236">Whether the resource is compliant.</span></span> |
| <span data-ttu-id="c8bb4-237">NodeName_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-237">NodeName_s</span></span> |<span data-ttu-id="c8bb4-238">Имя управляемого узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-238">The name of the managed node.</span></span> |
| <span data-ttu-id="c8bb4-239">Категория</span><span class="sxs-lookup"><span data-stu-id="c8bb4-239">Category</span></span> | <span data-ttu-id="c8bb4-240">DscNodeStatus</span><span class="sxs-lookup"><span data-stu-id="c8bb4-240">DscNodeStatus</span></span> |
| <span data-ttu-id="c8bb4-241">Ресурс</span><span class="sxs-lookup"><span data-stu-id="c8bb4-241">Resource</span></span> | <span data-ttu-id="c8bb4-242">Имя учетной записи службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-242">The name of the Azure Automation account.</span></span> |
| <span data-ttu-id="c8bb4-243">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="c8bb4-243">Tenant_g</span></span> | <span data-ttu-id="c8bb4-244">GUID, идентифицирующий клиента для вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-244">GUID that identifies the tenant for the Caller.</span></span> |
| <span data-ttu-id="c8bb4-245">NodeId_g</span><span class="sxs-lookup"><span data-stu-id="c8bb4-245">NodeId_g</span></span> |<span data-ttu-id="c8bb4-246">Идентификатор GUID для определения управляемого узла.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-246">GUID that identifies the managed node.</span></span> |
| <span data-ttu-id="c8bb4-247">DscReportId_g</span><span class="sxs-lookup"><span data-stu-id="c8bb4-247">DscReportId_g</span></span> |<span data-ttu-id="c8bb4-248">Идентификатор GUID для определения отчета.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-248">GUID that identifies the report.</span></span> |
| <span data-ttu-id="c8bb4-249">DscResourceId_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-249">DscResourceId_s</span></span> |<span data-ttu-id="c8bb4-250">Имя для экземпляра ресурса DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-250">The name of the DSC resource instance.</span></span> |
| <span data-ttu-id="c8bb4-251">DscResourceName_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-251">DscResourceName_s</span></span> |<span data-ttu-id="c8bb4-252">Имя ресурса DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-252">The name of the DSC resource.</span></span> |
| <span data-ttu-id="c8bb4-253">DscResourceStatus_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-253">DscResourceStatus_s</span></span> |<span data-ttu-id="c8bb4-254">Подтверждено ли соответствие ресурса DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-254">Whether the DSC resource is in compliance.</span></span> |
| <span data-ttu-id="c8bb4-255">DscModuleName_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-255">DscModuleName_s</span></span> |<span data-ttu-id="c8bb4-256">Имя модуля PowerShell, который содержит ресурс DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-256">The name of the PowerShell module that contains the DSC resource.</span></span> |
| <span data-ttu-id="c8bb4-257">DscModuleVersion_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-257">DscModuleVersion_s</span></span> |<span data-ttu-id="c8bb4-258">Версия модуля PowerShell, который содержит ресурс DSC.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-258">The version of the PowerShell module that contains the DSC resource.</span></span> |
| <span data-ttu-id="c8bb4-259">DscConfigurationName_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-259">DscConfigurationName_s</span></span> |<span data-ttu-id="c8bb4-260">Имя примененной к узлу конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-260">The name of the configuration applied to the node.</span></span> |
| <span data-ttu-id="c8bb4-261">ErrorCode_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-261">ErrorCode_s</span></span> | <span data-ttu-id="c8bb4-262">Код ошибки при сбое ресурса.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-262">The error code if the resource failed.</span></span> |
| <span data-ttu-id="c8bb4-263">ErrorMessage_s</span><span class="sxs-lookup"><span data-stu-id="c8bb4-263">ErrorMessage_s</span></span> |<span data-ttu-id="c8bb4-264">Сообщение об ошибке при сбое ресурса.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-264">The error message if the resource failed.</span></span> |
| <span data-ttu-id="c8bb4-265">DscResourceDuration_d</span><span class="sxs-lookup"><span data-stu-id="c8bb4-265">DscResourceDuration_d</span></span> |<span data-ttu-id="c8bb4-266">Период выполнения ресурса DSC в секундах.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-266">The time, in seconds, that the DSC resource ran.</span></span> |
| <span data-ttu-id="c8bb4-267">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="c8bb4-267">SourceSystem</span></span> | <span data-ttu-id="c8bb4-268">Способ сбора данных в Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-268">How Log Analytics collected the data.</span></span> <span data-ttu-id="c8bb4-269">Всегда имеет значение *Azure* для системы диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-269">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="c8bb4-270">ResourceId</span><span class="sxs-lookup"><span data-stu-id="c8bb4-270">ResourceId</span></span> |<span data-ttu-id="c8bb4-271">Указывает учетную запись службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-271">Specifies the Azure Automation account.</span></span> |
| <span data-ttu-id="c8bb4-272">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="c8bb4-272">ResultDescription</span></span> | <span data-ttu-id="c8bb4-273">Описание для этой операции.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-273">The description for this operation.</span></span> |
| <span data-ttu-id="c8bb4-274">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="c8bb4-274">SubscriptionId</span></span> | <span data-ttu-id="c8bb4-275">Идентификатор подписки Azure (GUID) для учетной записи службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-275">The Azure subscription Id (GUID) for the Automation account.</span></span> |
| <span data-ttu-id="c8bb4-276">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="c8bb4-276">ResourceGroup</span></span> | <span data-ttu-id="c8bb4-277">Имя группы ресурсов для учетной записи службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-277">Name of the resource group for the Automation account.</span></span> |
| <span data-ttu-id="c8bb4-278">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="c8bb4-278">ResourceProvider</span></span> | <span data-ttu-id="c8bb4-279">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="c8bb4-279">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="c8bb4-280">ResourceType</span><span class="sxs-lookup"><span data-stu-id="c8bb4-280">ResourceType</span></span> | <span data-ttu-id="c8bb4-281">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="c8bb4-281">AUTOMATIONACCOUNTS</span></span> |
| <span data-ttu-id="c8bb4-282">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="c8bb4-282">CorrelationId</span></span> |<span data-ttu-id="c8bb4-283">Идентификатор GUID для корреляции отчета о соответствии.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-283">GUID that is the Correlation Id of the compliance report.</span></span> |

## <a name="summary"></a><span data-ttu-id="c8bb4-284">Сводка</span><span class="sxs-lookup"><span data-stu-id="c8bb4-284">Summary</span></span>

<span data-ttu-id="c8bb4-285">Отправляя данные о состоянии Automation DSC в Log Analytics, можно лучше понять, в каком состоянии находятся ваши узлы Automation DSC. Для этого вы можете:</span><span class="sxs-lookup"><span data-stu-id="c8bb4-285">By sending your Automation DSC data to Log Analytics, you can get better insight into the status of your Automation DSC nodes by:</span></span>

* <span data-ttu-id="c8bb4-286">настроить оповещения, уведомляющие вас о проблемах;</span><span class="sxs-lookup"><span data-stu-id="c8bb4-286">Setting up alerts to notify you when there is an issue</span></span>
* <span data-ttu-id="c8bb4-287">с помощью пользовательских представлений и поисковых запросов визуализировать результаты модуля Runbook, состояние задания Runbook и другие связанные ключевые индикаторы или метрики.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-287">Using custom views and search queries to visualize your runbook results, runbook job status, and other related key indicators or metrics.</span></span>  

<span data-ttu-id="c8bb4-288">Log Analytics предоставляет расширенный оперативный контроль над данными Automation DSC и позволяет быстрее устранять инциденты.</span><span class="sxs-lookup"><span data-stu-id="c8bb4-288">Log Analytics provides greater operational visibility to your Automation DSC data and can help address incidents more quickly.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="c8bb4-289">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c8bb4-289">Next steps</span></span>

* <span data-ttu-id="c8bb4-290">Чтобы узнать больше о том, как создавать различные поисковые запросы и просматривать журналы Automation DSC с помощью Log Analytics, см. статью [Поиск данных по журналам](../log-analytics/log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-290">To learn more about how to construct different search queries and review the Automation DSC logs with Log Analytics, see [Log searches in Log Analytics](../log-analytics/log-analytics-log-searches.md)</span></span>
* <span data-ttu-id="c8bb4-291">Дополнительные сведения об использовании Azure Automation DSC см. в статье [Приступая к работе с DSC службы автоматизации Azure](automation-dsc-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="c8bb4-291">To learn more about using Azure Automation DSC, see [Getting started with Azure Automation DSC](automation-dsc-getting-started.md)</span></span>
* <span data-ttu-id="c8bb4-292">Чтобы узнать больше о Log Analytics (OMS) и источниках сбора данных, ознакомьтесь с разделом [Подключение службы Azure к Log Analytics](../log-analytics/log-analytics-azure-storage.md)</span><span class="sxs-lookup"><span data-stu-id="c8bb4-292">To learn more about OMS Log Analytics and data collection sources, see [Collecting Azure storage data in Log Analytics overview](../log-analytics/log-analytics-azure-storage.md)</span></span>

