---
title: "aaaMy первый runbook PowerShell в службе автоматизации Azure | Документы Microsoft"
description: "Учебник, в котором описывается создание hello, тестированию и публикации из простого модуля runbook PowerShell."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "Azure PowerShell, руководство по скриптам PowerShell, инструменты автоматизации PowerShell"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: abff94abe666cd8423c35b970b4162ba9247bcf8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="b5cbe-104">Мой первый модуль Runbook PowerShell</span><span class="sxs-lookup"><span data-stu-id="b5cbe-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="b5cbe-105">Графический</span><span class="sxs-lookup"><span data-stu-id="b5cbe-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="b5cbe-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="b5cbe-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="b5cbe-107">Рабочий процесс PowerShell</span><span class="sxs-lookup"><span data-stu-id="b5cbe-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="b5cbe-108">Этот учебник поможет выполнить создание hello [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) в службе автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-108">This tutorial walks you through hello creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="b5cbe-109">Мы начнем с простого модуля runbook, мы протестировать и опубликовать, пока мы объясним, как tootrack hello состояния задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-109">We start with a simple runbook that we test and publish while we explain how tootrack hello status of hello runbook job.</span></span> <span data-ttu-id="b5cbe-110">Затем мы измените hello runbook tooactually управления ресурсами Azure, в этом случае запуск виртуальной машины Azure.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-110">Then we modify hello runbook tooactually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="b5cbe-111">Наконец мы предоставим hello runbook более надежными, добавив параметры модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-111">Lastly, we make hello runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="b5cbe-112">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="b5cbe-112">Prerequisites</span></span>
<span data-ttu-id="b5cbe-113">toocomplete этого учебника требуется hello следующие:</span><span class="sxs-lookup"><span data-stu-id="b5cbe-113">toocomplete this tutorial, you need hello following:</span></span>

* <span data-ttu-id="b5cbe-114">Подписка Azure.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-114">Azure subscription.</span></span> <span data-ttu-id="b5cbe-115">Если у вас ее нет, [активируйте преимущества для подписчиков MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) или <a href="/pricing/free-account/" target="_blank">[зарегистрируйте бесплатную учетную запись](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="b5cbe-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="b5cbe-116">[Учетная запись службы автоматизации](automation-sec-configure-azure-runas-account.md) toohold hello runbook и проверить подлинность tooAzure ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-116">[Automation account](automation-sec-configure-azure-runas-account.md) toohold hello runbook and authenticate tooAzure resources.</span></span>  <span data-ttu-id="b5cbe-117">Этой учетной записи необходимо разрешение toostart и остановить виртуальную машину hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-117">This account must have permission toostart and stop hello virtual machine.</span></span>
* <span data-ttu-id="b5cbe-118">Виртуальная машина Azure.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-118">An Azure virtual machine.</span></span> <span data-ttu-id="b5cbe-119">Это не должна быть рабочая виртуальная машина, так как в процессе изучения этого руководства ее нужно будет остановить и запустить заново.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="b5cbe-120">Шаг 1. Создание нового модуля Runbook</span><span class="sxs-lookup"><span data-stu-id="b5cbe-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="b5cbe-121">Мы начнем с создания простого модуля runbook, который выводит текст hello *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-121">We'll start by creating a simple runbook that outputs hello text *Hello World*.</span></span>

1. <span data-ttu-id="b5cbe-122">Откройте в hello портал Azure, ваша учетная запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-122">In hello Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="b5cbe-123">страница учетной записи автоматизации Hello предоставляет быстрый просмотр hello ресурсов в этой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-123">hello Automation account page gives you a quick view of hello resources in this account.</span></span> <span data-ttu-id="b5cbe-124">Некоторые ресурсы уже должны быть доступны.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-124">You should already have some assets.</span></span> <span data-ttu-id="b5cbe-125">Большинство из них являются hello модули, которые автоматически включаются в новую учетную запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-125">Most of those are hello modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="b5cbe-126">Вы также должны hello ресурс учетных данных, которая упоминается в hello [необходимых компонентов](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="b5cbe-126">You should also have hello Credential asset that's mentioned in hello [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="b5cbe-127">Нажмите кнопку hello **Runbooks** плитки tooopen hello список модулей Runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-127">Click hello **Runbooks** tile tooopen hello list of runbooks.</span></span><br><br> <span data-ttu-id="b5cbe-128">![Управление модулями Runbook](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="b5cbe-129">Создать новый runbook, щелкнув hello **добавить модуль runbook** кнопки и затем **создать новый runbook**.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-129">Create a new runbook by clicking hello **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="b5cbe-130">Присвойте имя hello hello runbook *MyFirstRunbook PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-130">Give hello runbook hello name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="b5cbe-131">В этом случае мы будем toocreate [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) поэтому выберите **Powershell** для **тип Runbook**.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-131">In this case, we're going toocreate a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="b5cbe-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="b5cbe-133">Нажмите кнопку **создать** toocreate hello runbook и откройте hello текстового редактора.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-133">Click **Create** toocreate hello runbook and open hello textual editor.</span></span>

## <a name="step-2---add-code-toohello-runbook"></a><span data-ttu-id="b5cbe-134">Шаг 2 — Добавление кода toohello runbook</span><span class="sxs-lookup"><span data-stu-id="b5cbe-134">Step 2 - Add code toohello runbook</span></span>
<span data-ttu-id="b5cbe-135">Можно любой тип кода непосредственно в hello runbook, или можно выбрать из hello элемент управления из библиотеки командлетов, модули Runbook и ресурсов и их добавления runbook toohello связанные параметры.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-135">You can either type code directly into hello runbook, or you can select cmdlets, runbooks, and assets from hello Library control and have them added toohello runbook with any related parameters.</span></span> <span data-ttu-id="b5cbe-136">В данном пошаговом руководстве мы ввести непосредственно в hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-136">For this walkthrough, we type directly in hello runbook.</span></span>

1. <span data-ttu-id="b5cbe-137">Сейчас модуль Runbook пуст, поэтому введите *Write-Output "Hello World."*.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="b5cbe-138">![Привет, мир!](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="b5cbe-139">Сохранить hello runbook, установив **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-139">Save hello runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="b5cbe-140">![Кнопка "Сохранить"](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-hello-runbook"></a><span data-ttu-id="b5cbe-141">Шаг 3. при проверке runbook hello</span><span class="sxs-lookup"><span data-stu-id="b5cbe-141">Step 3 - Test hello runbook</span></span>
<span data-ttu-id="b5cbe-142">Прежде чем мы опубликовать hello runbook toomake он доступен в рабочей среде, нам нужно tootest его toomake убедиться, что он работает правильно.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-142">Before we publish hello runbook toomake it available in production, we want tootest it toomake sure that it works properly.</span></span> <span data-ttu-id="b5cbe-143">Чтобы протестировать модуль Runbook, нужно запустить его **черновую** версию и проверить его работу в интерактивном режиме.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="b5cbe-144">Нажмите кнопку **области тестов** tooopen hello тестовой области.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-144">Click **Test pane** tooopen hello Test pane.</span></span><br><br> <span data-ttu-id="b5cbe-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="b5cbe-146">Нажмите кнопку **запустить** toostart hello теста.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-146">Click **Start** toostart hello test.</span></span> <span data-ttu-id="b5cbe-147">Это должно быть включено только hello вариантом.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-147">This should be hello only enabled option.</span></span>
3. <span data-ttu-id="b5cbe-148">При этом создается [задание Runbook](automation-runbook-execution.md) и отображается его состояние.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="b5cbe-149">состояние задания Hello для запуска в качестве *в очереди* означает, что он ожидает runbook worker в доступных toocome облака hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-149">hello job status starts as *Queued* indicating that it is waiting for a runbook worker in hello cloud toocome available.</span></span> <span data-ttu-id="b5cbe-150">Он будет двигаться слишком*запуск* когда исполнитель задания hello, а затем *под управлением* при hello runbook фактически начинает выполнение.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-150">It will then move too*Starting* when a worker claims hello job, and then *Running* when hello runbook actually starts running.</span></span>  
4. <span data-ttu-id="b5cbe-151">По завершении заданий runbook hello его вывода.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-151">When hello runbook job completes, its output is displayed.</span></span> <span data-ttu-id="b5cbe-152">В нашем случае это должен быть текст *Привет, мир!*.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="b5cbe-153">![Вывод области тестирования](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="b5cbe-154">Закройте hello тестирования области tooreturn toohello холста.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-154">Close hello Test pane tooreturn toohello canvas.</span></span>

## <a name="step-4---publish-and-start-hello-runbook"></a><span data-ttu-id="b5cbe-155">Шаг 4. Публикация и запуск модуля runbook hello</span><span class="sxs-lookup"><span data-stu-id="b5cbe-155">Step 4 - Publish and start hello runbook</span></span>
<span data-ttu-id="b5cbe-156">runbook Hello, созданную по-прежнему черновом режиме.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-156">hello runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="b5cbe-157">Мы должны toopublish перед его можно было запустить в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-157">We need toopublish it before we can run it in production.</span></span>  <span data-ttu-id="b5cbe-158">При публикации модуля runbook, можно заменить hello существующей опубликованной версии hello черновую версию.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-158">When you publish a runbook, you overwrite hello existing Published version with hello Draft version.</span></span>  <span data-ttu-id="b5cbe-159">В нашем случае мы опубликованную версию еще нет, потому что мы только что создали hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-159">In our case, we don't have a Published version yet because we just created hello runbook.</span></span>

1. <span data-ttu-id="b5cbe-160">Нажмите кнопку **публикации** toopublish hello runbook и затем **Да** при появлении запроса.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-160">Click **Publish** toopublish hello runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="b5cbe-161">![Кнопка "Опубликовать"](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="b5cbe-162">При прокрутке левой tooview runbook hello в hello **Runbooks** области, он будет отображаться **состояние создания** из **опубликовано**.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-162">If you scroll left tooview hello runbook in hello **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="b5cbe-163">Панель hello правой tooview задней toohello прокрутки для **MyFirstRunbook PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-163">Scroll back toohello right tooview hello pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="b5cbe-164">Hello параметры сверху hello позволит нам toostart hello runbook, просмотра hello runbook, запланировать toostart в некоторый момент в будущем hello или создания [веб-перехватчика](automation-webhooks.md) , оно может начаться через вызов HTTP.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-164">hello options across hello top allow us toostart hello runbook, view hello runbook, schedule it toostart at some time in hello future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="b5cbe-165">Мы должны toostart hello runbook, нажмите **запустить** и нажмите кнопку **ОК** при открытии колонке hello запустить Runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-165">We want toostart hello runbook, so click **Start** and then click **Ok** when hello Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="b5cbe-166">![Кнопка "Запуск"](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="b5cbe-167">Открывается область задание для hello задание runbook, который мы создали.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-167">A job pane is opened for hello runbook job that we created.</span></span> <span data-ttu-id="b5cbe-168">В этой области можно закрыть, но в этом случае мы оставить его открытым, поэтому мы можно отслеживать ход выполнения задания hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-168">We can close this pane, but in this case we leave it open so we can watch hello job's progress.</span></span>
6. <span data-ttu-id="b5cbe-169">отображается состояние заданий Hello в **Сводка заданий** и совпадений hello состояния, мы видели, когда мы протестировали hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-169">hello job status is shown in **Job Summary** and matches hello statuses that we saw when we tested hello runbook.</span></span><br><br> <span data-ttu-id="b5cbe-170">![Сводные данные задания](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="b5cbe-171">Один раз hello показано состояние runbook *завершено*, нажмите кнопку **вывода**.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-171">Once hello runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="b5cbe-172">открыть область вывода Hello, и мы видим нашей *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-172">hello Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="b5cbe-173">![Выходные данные задания](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="b5cbe-174">Закрыть hello области вывода.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-174">Close hello Output pane.</span></span>
9. <span data-ttu-id="b5cbe-175">Нажмите кнопку **все журналы** tooopen hello потоки области для задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-175">Click **All Logs** tooopen hello Streams pane for hello runbook job.</span></span> <span data-ttu-id="b5cbe-176">Мы должны видеть только *Hello World* в выходных данных hello потока, но это может показывать другие потоки для задания runbook, например Verbose и ошибка записывает toothem hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-176">We should only see *Hello World* in hello output stream, but this can show other streams for a runbook job such as Verbose and Error if hello runbook writes toothem.</span></span><br><br> <span data-ttu-id="b5cbe-177">![Все журналы](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="b5cbe-178">Закройте hello потоки области и hello задания области tooreturn toohello MyFirstRunbook PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-178">Close hello Streams pane and hello Job pane tooreturn toohello MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="b5cbe-179">Нажмите кнопку **заданий** tooopen hello задания области для этого модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-179">Click **Jobs** tooopen hello Jobs pane for this runbook.</span></span> <span data-ttu-id="b5cbe-180">Перечисляет все задания hello, созданные этим модулем runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-180">This lists all of hello jobs created by this runbook.</span></span> <span data-ttu-id="b5cbe-181">Мы должны видеть только одно задание, так как мы только запуска задания hello один раз в списке.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-181">We should only see one job listed since we only ran hello job once.</span></span><br><br> <span data-ttu-id="b5cbe-182">![Список заданий](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="b5cbe-183">Можно щелкнуть это задание tooopen hello одной области задания, которые мы просматривать, когда мы начали hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-183">You can click this job tooopen hello same Job pane that we viewed when we started hello runbook.</span></span> <span data-ttu-id="b5cbe-184">Это позволяет toogo обратно в времени и просмотреть подробные сведения hello любого задания, который был создан для конкретного модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-184">This allows you toogo back in time and view hello details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-toomanage-azure-resources"></a><span data-ttu-id="b5cbe-185">Шаг 5 — Добавление toomanage проверки подлинности ресурсов Azure</span><span class="sxs-lookup"><span data-stu-id="b5cbe-185">Step 5 - Add authentication toomanage Azure resources</span></span>
<span data-ttu-id="b5cbe-186">Мы протестировали и опубликовали свой модуль Runbook, но пока он не выполняет никаких полезных действий.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="b5cbe-187">Мы хотим toohave его управления ресурсами Azure.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-187">We want toohave it manage Azure resources.</span></span> <span data-ttu-id="b5cbe-188">Он не будет возможности toodo на то, что если у нас нет проверки подлинности с использованием учетных данных hello, называется tooin hello [необходимых компонентов](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="b5cbe-188">It won't be able toodo that though unless we have it authenticate using hello credentials that are referred tooin hello [prerequisites](#prerequisites).</span></span> <span data-ttu-id="b5cbe-189">Что мы делаем с hello **AzureRmAccount добавить** командлета.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-189">We do that with hello **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="b5cbe-190">Откройте hello текстового редактора, щелкнув **изменить** на панели hello MyFirstRunbook PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-190">Open hello textual editor by clicking **Edit** on hello MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="b5cbe-191">![Изменение модуля Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="b5cbe-192">Нам не нужен hello **Write-Output** строки больше, поэтому действуйте и удалите его.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-192">We don't need hello **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="b5cbe-193">Введите или скопируйте и вставьте следующий код, который обрабатывает hello проверку подлинности с помощью учетной записи запуска от автоматизации hello:</span><span class="sxs-lookup"><span data-stu-id="b5cbe-193">Type or copy and paste hello following code that handles hello authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="b5cbe-194">Нажмите кнопку **области тестов** , чтобы мы смогли проверить hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-194">Click **Test pane** so that we can test hello runbook.</span></span>
5. <span data-ttu-id="b5cbe-195">Нажмите кнопку **запустить** toostart hello теста.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-195">Click **Start** toostart hello test.</span></span> <span data-ttu-id="b5cbe-196">После ее завершения, должно появиться примерно toohello выходных данных после, отображение основных сведений из вашей учетной записи.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-196">Once it completes, you should receive output similar toohello following, displaying basic information from your account.</span></span> <span data-ttu-id="b5cbe-197">Это подтверждает, что эти учетные данные hello является допустимым.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-197">This confirms that hello credential is valid.</span></span><br><br> <span data-ttu-id="b5cbe-198">![Проверка подлинности](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-toostart-a-virtual-machine"></a><span data-ttu-id="b5cbe-199">Шаг 6 — Добавление кода toostart виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="b5cbe-199">Step 6 - Add code toostart a virtual machine</span></span>
<span data-ttu-id="b5cbe-200">Теперь, когда наши runbook проверяет подлинность tooour подписки Azure, мы управление ресурсами.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-200">Now that our runbook is authenticating tooour Azure subscription, we can manage resources.</span></span> <span data-ttu-id="b5cbe-201">Мы добавляем команда toostart виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-201">We add a command toostart a virtual machine.</span></span> <span data-ttu-id="b5cbe-202">Можно выбрать любой виртуальной машине в вашей подписке Azure, и сейчас мы будут жестко это имя в hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in hello runbook.</span></span>

1. <span data-ttu-id="b5cbe-203">После *AzureRmAccount добавить*, тип *Start AzureRmVM-имя «VMName» - ResourceGroupName «NameofResourceGroup»* указания имени hello и имя группы ресурсов toostart hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing hello name and Resource Group name of hello virtual machine toostart.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="b5cbe-204">Сохранить hello runbook и нажмите кнопку **области тестов** , чтобы мы смогли проверить его.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-204">Save hello runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="b5cbe-205">Нажмите кнопку **запустить** toostart hello теста.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-205">Click **Start** toostart hello test.</span></span> <span data-ttu-id="b5cbe-206">После ее завершения, убедитесь, что виртуальная машина, hello была запущена.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-206">Once it completes, check that hello virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-toohello-runbook"></a><span data-ttu-id="b5cbe-207">Шаг 7 - добавьте входной параметр toohello runbook</span><span class="sxs-lookup"><span data-stu-id="b5cbe-207">Step 7 - Add an input parameter toohello runbook</span></span>
<span data-ttu-id="b5cbe-208">В настоящее время наши runbook запускает hello виртуальной машины, что мы жестко задано в hello runbook, но было бы более полезным, если при запуске hello runbook указывается hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-208">Our runbook currently starts hello virtual machine that we hardcoded in hello runbook, but it would be more useful if we specify hello virtual machine when hello runbook is started.</span></span> <span data-ttu-id="b5cbe-209">Теперь добавим tooprovide runbook toohello входных параметров эта функция.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-209">We will now add input parameters toohello runbook tooprovide that functionality.</span></span>

1. <span data-ttu-id="b5cbe-210">Добавление параметров для *VMName* и *ResourceGroupName* toohello runbook и использовать эти переменные с hello **AzureRmVM начала** командлет, как показано в приведенном ниже примере hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-210">Add parameters for *VMName* and *ResourceGroupName* toohello runbook and use these variables with hello **Start-AzureRmVM** cmdlet as in hello example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="b5cbe-211">Сохраните hello runbook и откройте панель тестовых hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-211">Save hello runbook and open hello Test pane.</span></span> <span data-ttu-id="b5cbe-212">Вам могут предоставлять значения для hello две входные переменные, используемые в тесте hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-212">You can now provide values for hello two input variables that are used in hello test.</span></span>
3. <span data-ttu-id="b5cbe-213">Закрыть hello тестовой области.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-213">Close hello Test pane.</span></span>
4. <span data-ttu-id="b5cbe-214">Нажмите кнопку **публикации** toopublish hello hello runbook в новой версии.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-214">Click **Publish** toopublish hello new version of hello runbook.</span></span>
5. <span data-ttu-id="b5cbe-215">Остановите hello виртуальную машину, которая запущена на предыдущем шаге hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-215">Stop hello virtual machine that you started in hello previous step.</span></span>
6. <span data-ttu-id="b5cbe-216">Нажмите кнопку **запустить** toostart hello runbook.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-216">Click **Start** toostart hello runbook.</span></span> <span data-ttu-id="b5cbe-217">Тип в hello **VMName** и **ResourceGroupName** для виртуальной машины hello ты toostart.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-217">Type in hello **VMName** and **ResourceGroupName** for hello virtual machine that you're going toostart.</span></span><br><br> <span data-ttu-id="b5cbe-218">![Передача параметра](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="b5cbe-219">После завершения hello runbook, убедитесь, что виртуальная машина, hello была запущена.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-219">When hello runbook completes, check that hello virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="b5cbe-220">Отличия от рабочего процесса PowerShell</span><span class="sxs-lookup"><span data-stu-id="b5cbe-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="b5cbe-221">Модули Runbook PowerShell имеют hello же жизненного цикла, возможности и управление как модули PowerShell рабочего процесса, но существуют некоторые отличия и ограничения:</span><span class="sxs-lookup"><span data-stu-id="b5cbe-221">PowerShell runbooks have hello same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="b5cbe-222">PowerShell выполняются быстро сравниваемых tooPowerShell модулях Runbook рабочего процесса, они не имеют шага компиляции.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-222">PowerShell runbooks run fast compared tooPowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="b5cbe-223">Модули Runbook рабочий процесс PowerShell поддерживает контрольные точки, с помощью контрольных точек, можно возобновить рабочий процесс PowerShell модули Runbook из любой точки в hello runbook в то время как модули Runbook PowerShell может возобновлять только с начала hello.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in hello runbook whereas PowerShell runbooks can only resume from hello beginning.</span></span>
3. <span data-ttu-id="b5cbe-224">Модули Runbook PowerShell поддерживают параллельное и последовательное выполнение, тогда как модули Runbook рабочих процессов PowerShell могут выполнять команды только последовательно.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="b5cbe-225">В модуле runbook рабочего процесса PowerShell действие, команда или блок скрипта могут иметь свои собственные пространства выполнения, тогда как в модуле runbook PowerShell все содержимое скрипта выполняется в одном пространстве выполнения.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="b5cbe-226">Кроме того, существуют некоторые [синтаксические различия](https://technet.microsoft.com/magazine/dn151046.aspx) между собственным модулем Runbook PowerShell и модулем Runbook рабочих процессов PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b5cbe-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b5cbe-227">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="b5cbe-227">Next steps</span></span>
* <span data-ttu-id="b5cbe-228">tooget к работе с графический Runbook в разделе [Мой первый графический runbook](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-228">tooget started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="b5cbe-229">tooget к работе с PowerShell модули Runbook рабочего процесса, в разделе [Мой первый runbook рабочего процесса PowerShell](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-229">tooget started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="b5cbe-230">в разделе tooknow Дополнительные сведения о типах runbook, их преимущества и ограничения, [типов runbook службы автоматизации Azure](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="b5cbe-230">tooknow more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="b5cbe-231">Дополнительные сведения о функции поддержки скриптов PowerShell см. в статье [Announcing Native PowerShell Script Support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/) (Встроенная поддержка скриптов PowerShell в службе автоматизации Azure).</span><span class="sxs-lookup"><span data-stu-id="b5cbe-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

