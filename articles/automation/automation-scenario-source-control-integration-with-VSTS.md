---
title: "aaaIntegrate автоматизации Azure с системой управления версиями Visual Stuido Team Services | Документы Microsoft"
description: "В этой статье описан сценарий настройки интеграции учетной записи службы автоматизации Azure с системой управления версиями Visual Studio Team Services."
services: automation
documentationcenter: 
author: eamono
manager: 
editor: 
keywords: "azure powershell, VSTS, система управления версиями, служба автоматизации"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2017
ms.openlocfilehash: 8f6faa596a5ad1f8b72e820ca320b3e103d83579
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="azure-automation-scenario---automation-source-control-integration-with-visual-studio-team-services"></a><span data-ttu-id="c374b-104">Сценарий службы автоматизации Azure: интеграция системы управления версиями службы автоматизации с Visual Studio Team Services</span><span class="sxs-lookup"><span data-stu-id="c374b-104">Azure Automation scenario - Automation source control integration with Visual Studio Team Services</span></span>

<span data-ttu-id="c374b-105">В этом сценарии у вас есть проект Visual Studio Team Services, что вы используете toomanage Runbook автоматизации Azure или конфигураций DSC в системе управления версиями.</span><span class="sxs-lookup"><span data-stu-id="c374b-105">In this scenario, you have a Visual Studio Team Services project that you are using toomanage Azure Automation runbooks or DSC configurations under source control.</span></span>
<span data-ttu-id="c374b-106">В этой статье описывается как toointegrate VSTS с среде автоматизации Azure, так что непрерывной интеграции происходит для каждого возврата.</span><span class="sxs-lookup"><span data-stu-id="c374b-106">This article describes how toointegrate VSTS with your Azure Automation environment so that continuous integration happens for each check-in.</span></span>

## <a name="getting-hello-scenario"></a><span data-ttu-id="c374b-107">Начало сценария hello</span><span class="sxs-lookup"><span data-stu-id="c374b-107">Getting hello scenario</span></span>

<span data-ttu-id="c374b-108">Этот сценарий состоит из двух Runbook PowerShell, которые можно импортировать напрямую из hello [коллекции модулей Runbook](automation-runbook-gallery.md) в hello портал Azure или загрузить с hello [коллекции PowerShell](https://www.powershellgallery.com).</span><span class="sxs-lookup"><span data-stu-id="c374b-108">This scenario consists of two PowerShell runbooks that you can import directly from hello [Runbook Gallery](automation-runbook-gallery.md) in hello Azure portal or download from hello [PowerShell Gallery](https://www.powershellgallery.com).</span></span>

### <a name="runbooks"></a><span data-ttu-id="c374b-109">Модули Runbook</span><span class="sxs-lookup"><span data-stu-id="c374b-109">Runbooks</span></span>

<span data-ttu-id="c374b-110">Модуль Runbook</span><span class="sxs-lookup"><span data-stu-id="c374b-110">Runbook</span></span> | <span data-ttu-id="c374b-111">Описание</span><span class="sxs-lookup"><span data-stu-id="c374b-111">Description</span></span>| 
--------|------------|
<span data-ttu-id="c374b-112">Sync-VSTS</span><span class="sxs-lookup"><span data-stu-id="c374b-112">Sync-VSTS</span></span> | <span data-ttu-id="c374b-113">Импорт модулей Runbook или конфигураций из системы управления версиями VSTS, когда выполняется возврат.</span><span class="sxs-lookup"><span data-stu-id="c374b-113">Import runbooks or configurations from VSTS source control when a check-in is done.</span></span> <span data-ttu-id="c374b-114">При запуске вручную, он импортируется и опубликовать все модули Runbook и конфигурации в hello учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c374b-114">If run manually, it will import and publish all runbooks or configurations into hello Automation account.</span></span>| 
<span data-ttu-id="c374b-115">Sync-VSTSGit</span><span class="sxs-lookup"><span data-stu-id="c374b-115">Sync-VSTSGit</span></span> | <span data-ttu-id="c374b-116">Импорт модулей Runbook или конфигураций из системы управления версиями Git VSTS, когда выполняется возврат.</span><span class="sxs-lookup"><span data-stu-id="c374b-116">Import runbooks or configurations from VSTS under Git source control when a check-in is done.</span></span> <span data-ttu-id="c374b-117">При запуске вручную, он импортируется и опубликовать все модули Runbook и конфигурации в hello учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c374b-117">If run manually, it will import and publish all runbooks or configurations into hello Automation account.</span></span>|

### <a name="variables"></a><span data-ttu-id="c374b-118">Переменные</span><span class="sxs-lookup"><span data-stu-id="c374b-118">Variables</span></span>

<span data-ttu-id="c374b-119">Переменная</span><span class="sxs-lookup"><span data-stu-id="c374b-119">Variable</span></span> | <span data-ttu-id="c374b-120">Описание</span><span class="sxs-lookup"><span data-stu-id="c374b-120">Description</span></span>|
-----------|------------|
<span data-ttu-id="c374b-121">VSToken</span><span class="sxs-lookup"><span data-stu-id="c374b-121">VSToken</span></span> | <span data-ttu-id="c374b-122">Безопасный контейнер переменной будет создан, содержащий hello VSTS личный маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="c374b-122">Secure variable asset you will create that contains hello VSTS personal access token.</span></span> <span data-ttu-id="c374b-123">Вы узнаете, как toocreate VSTS personal получать доступ к маркера на hello [страницу проверки подлинности VSTS](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview).</span><span class="sxs-lookup"><span data-stu-id="c374b-123">You can learn how toocreate a VSTS personal access token on hello [VSTS authentication page](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview).</span></span> 
## <a name="installing-and-configuring-this-scenario"></a><span data-ttu-id="c374b-124">Установка и настройка данного сценария</span><span class="sxs-lookup"><span data-stu-id="c374b-124">Installing and configuring this scenario</span></span>

<span data-ttu-id="c374b-125">Создание [личный маркер доступа](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview) в VSTS, который будет использоваться модули Runbook toosync hello или конфигураций в вашу учетную запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c374b-125">Create a [personal access token](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview) in VSTS that you will use toosync hello runbooks or configurations into your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPersonalToken.png) 

<span data-ttu-id="c374b-126">Создание [переменной $secure](automation-variables.md) в ваш hello toohold учетной записи автоматизации личных доступа токен hello runbook для проверки подлинности, модули Runbook hello tooVSTS и синхронизации или конфигураций в hello учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c374b-126">Create a [secure variable](automation-variables.md) in your automation account toohold hello personal access token so that hello runbook can authenticate tooVSTS and sync hello runbooks or configurations into hello Automation account.</span></span> <span data-ttu-id="c374b-127">Можно назвать ее VSToken.</span><span class="sxs-lookup"><span data-stu-id="c374b-127">You can name this VSToken.</span></span> 

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSTokenVariable.png)

<span data-ttu-id="c374b-128">Импорт runbook hello, будут синхронизироваться модулей Runbook или конфигураций в учетной записи автоматизации hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-128">Import hello runbook that will sync your runbooks or configurations into hello automation account.</span></span> <span data-ttu-id="c374b-129">Можно использовать hello [VSTS пример модуля runbook](https://www.powershellgallery.com/packages/Sync-VSTS/1.0/DisplayScript) или hello [VSTS с Git пример runbook] (https://www.powershellgallery.com/packages/Sync-VSTSGit/1.0/DisplayScript) из hello PowerShellGallery.com в зависимости от того, если использовать VSTS исходный элемент управления или VSTS с Git и развернуть tooyour учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c374b-129">You can use hello [VSTS sample runbook](https://www.powershellgallery.com/packages/Sync-VSTS/1.0/DisplayScript) or hello [VSTS with Git sample runbook] (https://www.powershellgallery.com/packages/Sync-VSTSGit/1.0/DisplayScript) from hello PowerShellGallery.com depending on if you use VSTS source control or VSTS with Git and deploy tooyour automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPowerShellGallery.png)

<span data-ttu-id="c374b-130">Теперь можно [опубликовать](automation-creating-importing-runbook.md#publishing-a-runbook) этот модуль Runbook, чтобы затем создать объект webhook.</span><span class="sxs-lookup"><span data-stu-id="c374b-130">You can now [publish](automation-creating-importing-runbook.md#publishing-a-runbook) this runbook so you can create a webhook.</span></span> 
![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPublishRunbook.png)

<span data-ttu-id="c374b-131">Создание [веб-перехватчика](automation-webhooks.md) для этой runbook VSTS синхронизации и заполните параметры hello, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="c374b-131">Create a [webhook](automation-webhooks.md) for this Sync-VSTS runbook and fill in hello parameters as shown below.</span></span> <span data-ttu-id="c374b-132">Убедитесь, что скопируйте URL-адрес веб-перехватчика hello, как он понадобится для службы обработчик в VSTS.</span><span class="sxs-lookup"><span data-stu-id="c374b-132">Make sure you copy hello webhook url as you will need it for a service hook in VSTS.</span></span> <span data-ttu-id="c374b-133">Hello VSAccessTokenVariableName является именем hello (VSToken) безопасный переменной hello, созданный ранее toohold hello личный маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="c374b-133">hello VSAccessTokenVariableName is hello name (VSToken) of hello secure variable that you created earlier toohold hello personal access token.</span></span> 

<span data-ttu-id="c374b-134">Интеграция с VSTS (синхронизации VSTS.ps1) займет hello следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="c374b-134">Integrating with VSTS (Sync-VSTS.ps1) will take hello following parameters.</span></span>
### <a name="sync-vsts-parameters"></a><span data-ttu-id="c374b-135">Параметры Sync-VSTS</span><span class="sxs-lookup"><span data-stu-id="c374b-135">Sync-VSTS Parameters</span></span>

<span data-ttu-id="c374b-136">Параметр</span><span class="sxs-lookup"><span data-stu-id="c374b-136">Parameter</span></span> | <span data-ttu-id="c374b-137">Описание</span><span class="sxs-lookup"><span data-stu-id="c374b-137">Description</span></span>| 
--------|------------|
<span data-ttu-id="c374b-138">WebhookData</span><span class="sxs-lookup"><span data-stu-id="c374b-138">WebhookData</span></span> | <span data-ttu-id="c374b-139">Этот элемент будет содержать hello возврат сведений, полученных от службы ловушек hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="c374b-139">This will contain hello checkin information sent from hello VSTS service hook.</span></span> <span data-ttu-id="c374b-140">Этот параметр следует оставить пустым.</span><span class="sxs-lookup"><span data-stu-id="c374b-140">You should leave this parameter blank.</span></span>| 
<span data-ttu-id="c374b-141">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="c374b-141">ResourceGroup</span></span> | <span data-ttu-id="c374b-142">Это имя hello hello группы ресурсов, учетная запись автоматизации hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-142">This is hello name of hello resource group that hello automation account is in.</span></span>|
<span data-ttu-id="c374b-143">AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="c374b-143">AutomationAccountName</span></span> | <span data-ttu-id="c374b-144">Имя учетной записи автоматизации hello, будут синхронизироваться с VSTS Hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-144">hello name of hello automation account that will sync with VSTS.</span></span>|
<span data-ttu-id="c374b-145">VSFolder</span><span class="sxs-lookup"><span data-stu-id="c374b-145">VSFolder</span></span> | <span data-ttu-id="c374b-146">Имя папки hello в VSTS, где существует Runbook hello и конфигураций.</span><span class="sxs-lookup"><span data-stu-id="c374b-146">The name of hello folder in VSTS where hello runbooks and configurations exist.</span></span>|
<span data-ttu-id="c374b-147">VSAccount</span><span class="sxs-lookup"><span data-stu-id="c374b-147">VSAccount</span></span> | <span data-ttu-id="c374b-148">Имя учетной записи Visual Studio Team Services hello Hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-148">hello name of hello Visual Studio Team Services account.</span></span>| 
<span data-ttu-id="c374b-149">VSAccessTokenVariableName</span><span class="sxs-lookup"><span data-stu-id="c374b-149">VSAccessTokenVariableName</span></span> | <span data-ttu-id="c374b-150">Имя Hello hello безопасного переменной (VSToken), содержащей hello VSTS личный маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="c374b-150">hello name of hello secure variable (VSToken) that holds hello VSTS personal access token.</span></span>| 


![](media/automation-scenario-source-control-integration-with-VSTS/VSTSWebhook.png)

<span data-ttu-id="c374b-151">Если вы используете VSTS с GIT (синхронизации VSTSGit.ps1), необходимое hello следующие параметры.</span><span class="sxs-lookup"><span data-stu-id="c374b-151">If you are using VSTS with GIT (Sync-VSTSGit.ps1) it will take hello following parameters.</span></span>

<span data-ttu-id="c374b-152">Параметр</span><span class="sxs-lookup"><span data-stu-id="c374b-152">Parameter</span></span> | <span data-ttu-id="c374b-153">Описание</span><span class="sxs-lookup"><span data-stu-id="c374b-153">Description</span></span>|
--------|------------|
<span data-ttu-id="c374b-154">WebhookData</span><span class="sxs-lookup"><span data-stu-id="c374b-154">WebhookData</span></span> | <span data-ttu-id="c374b-155">Этот элемент будет содержать hello возврат сведений, полученных от службы ловушек hello VSTS.</span><span class="sxs-lookup"><span data-stu-id="c374b-155">This will contain hello checkin information sent from hello VSTS service hook.</span></span> <span data-ttu-id="c374b-156">Этот параметр следует оставить пустым.</span><span class="sxs-lookup"><span data-stu-id="c374b-156">You should leave this parameter blank.</span></span>| <span data-ttu-id="c374b-157">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="c374b-157">ResourceGroup</span></span> | <span data-ttu-id="c374b-158">Имя группы ресурсов hello, учетная запись автоматизации hello этот hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-158">This hello name of hello resource group that hello automation account is in.</span></span>|
<span data-ttu-id="c374b-159">AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="c374b-159">AutomationAccountName</span></span> | <span data-ttu-id="c374b-160">Имя учетной записи автоматизации hello, будут синхронизироваться с VSTS Hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-160">hello name of hello automation account that will sync with VSTS.</span></span>|
<span data-ttu-id="c374b-161">VSAccount</span><span class="sxs-lookup"><span data-stu-id="c374b-161">VSAccount</span></span> | <span data-ttu-id="c374b-162">Имя учетной записи Visual Studio Team Services hello Hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-162">hello name of hello Visual Studio Team Services account.</span></span>|
<span data-ttu-id="c374b-163">VSProject</span><span class="sxs-lookup"><span data-stu-id="c374b-163">VSProject</span></span> | <span data-ttu-id="c374b-164">Hello имя проекта hello в VSTS, где существует Runbook hello и конфигураций.</span><span class="sxs-lookup"><span data-stu-id="c374b-164">hello name of hello project in VSTS where hello runbooks and configurations exist.</span></span>|
<span data-ttu-id="c374b-165">GitRepo</span><span class="sxs-lookup"><span data-stu-id="c374b-165">GitRepo</span></span> | <span data-ttu-id="c374b-166">Имя репозитория Git hello Hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-166">hello name of hello Git repository.</span></span>|
<span data-ttu-id="c374b-167">GitBranch</span><span class="sxs-lookup"><span data-stu-id="c374b-167">GitBranch</span></span> | <span data-ttu-id="c374b-168">Имя Hello hello ветви в репозитории VSTS.</span><span class="sxs-lookup"><span data-stu-id="c374b-168">hello name of hello branch in VSTS Git repository.</span></span>|
<span data-ttu-id="c374b-169">Папка</span><span class="sxs-lookup"><span data-stu-id="c374b-169">Folder</span></span> | <span data-ttu-id="c374b-170">Имя Hello hello папки в ветвь VSTS Git.</span><span class="sxs-lookup"><span data-stu-id="c374b-170">hello name of hello folder in VSTS Git branch.</span></span>|
<span data-ttu-id="c374b-171">VSAccessTokenVariableName</span><span class="sxs-lookup"><span data-stu-id="c374b-171">VSAccessTokenVariableName</span></span> | <span data-ttu-id="c374b-172">Имя Hello hello безопасного переменной (VSToken), содержащей hello VSTS личный маркер доступа.</span><span class="sxs-lookup"><span data-stu-id="c374b-172">hello name of hello secure variable (VSToken) that holds hello VSTS personal access token.</span></span>|

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSGitWebhook.png)

<span data-ttu-id="c374b-173">Создайте обработчик службы в VSTS для папки toohello возвратов, запускающее этот веб-перехватчик при возврате кода.</span><span class="sxs-lookup"><span data-stu-id="c374b-173">Create a service hook in VSTS for check-ins toohello folder that triggers this webhook on code check-in.</span></span> <span data-ttu-id="c374b-174">Выберите веб-обработчиков как hello toointegrate службы с при создании новой подписки.</span><span class="sxs-lookup"><span data-stu-id="c374b-174">Select Web Hooks as hello service toointegrate with when you create a new subscription.</span></span> <span data-ttu-id="c374b-175">Дополнительные сведения о перехватчиках события см. в статье [Integrate with service hooks](https://www.visualstudio.com/en-us/docs/marketplace/integrate/service-hooks/get-started) (Интеграция с перехватчиками события).</span><span class="sxs-lookup"><span data-stu-id="c374b-175">You can learn more about service hooks on [VSTS Service Hooks documentation](https://www.visualstudio.com/en-us/docs/marketplace/integrate/service-hooks/get-started).</span></span>
![](media/automation-scenario-source-control-integration-with-VSTS/VSTSServiceHook.png)

<span data-ttu-id="c374b-176">Должна теперь быть может toodo всех регистраций модулей Runbook и конфигураций в VSTS, и они были автоматически синхронизироваться бы в вашу учетную запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c374b-176">You should now be able toodo all check-ins of your runbooks and configurations into VSTS and have these automatically sync’d into your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSSyncRunbookOutput.png)

<span data-ttu-id="c374b-177">Если запустить этот runbook вручную не запустилась, VSTS, параметр webhookdata hello можно оставить пустым, и он будет выполнять полной синхронизации в указанной папке VSTS hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-177">If you run this runbook manually without being triggered by VSTS, you can leave hello webhookdata parameter empty and it will do a full sync from hello VSTS folder specified.</span></span>

<span data-ttu-id="c374b-178">При необходимости сценарий hello toouninstall удалить hello службы ловушек из VSTS, удалить hello runbook и переменной VSToken hello.</span><span class="sxs-lookup"><span data-stu-id="c374b-178">If you wish toouninstall hello scenario, remove hello service hook from VSTS, delete hello runbook, and hello VSToken variable.</span></span>
