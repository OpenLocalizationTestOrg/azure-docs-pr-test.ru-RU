---
title: "aaaMy первый runbook рабочего процесса PowerShell в службе автоматизации Azure | Документы Microsoft"
description: "Учебник, в котором описывается создание hello, тестированию и публикации модуля Runbook простой текст, с помощью рабочего процесса PowerShell."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "рабочий процесс PowerShell, примеры рабочего процесса powershell, рабочие процессы powershell"
ms.assetid: 0002d7f7-e2b5-46e3-b5eb-4596b84fd526
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;bwren
ms.openlocfilehash: b5a34d363ef4865878f3f68119833367b5280f83
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="my-first-powershell-workflow-runbook"></a><span data-ttu-id="dfdf2-104">Первый Runbook рабочего процесса PowerShell</span><span class="sxs-lookup"><span data-stu-id="dfdf2-104">My first PowerShell Workflow runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="dfdf2-105">Графический</span><span class="sxs-lookup"><span data-stu-id="dfdf2-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="dfdf2-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="dfdf2-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="dfdf2-107">Рабочий процесс PowerShell</span><span class="sxs-lookup"><span data-stu-id="dfdf2-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="dfdf2-108">Этот учебник поможет выполнить создание hello [runbook рабочего процесса PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) в службе автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-108">This tutorial walks you through hello creation of a [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) in Azure Automation.</span></span> <span data-ttu-id="dfdf2-109">Мы начнем с простого модуля runbook, которую тестирования и публикации при о том, как tootrack hello состояния задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-109">We start with a simple runbook that we test and publish while explaining how tootrack hello status of hello runbook job.</span></span> <span data-ttu-id="dfdf2-110">Затем мы измените hello runbook tooactually управления ресурсами Azure, в этом случае запуск виртуальной машины Azure.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-110">Then we modify hello runbook tooactually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="dfdf2-111">Наконец, мы предоставим hello runbook более надежными, добавив параметры модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-111">Lastly we make hello runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="dfdf2-112">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="dfdf2-112">Prerequisites</span></span>
<span data-ttu-id="dfdf2-113">toocomplete этого учебника вам потребуется hello следующие:</span><span class="sxs-lookup"><span data-stu-id="dfdf2-113">toocomplete this tutorial, you will need hello following:</span></span>

* <span data-ttu-id="dfdf2-114">Подписка Azure.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-114">Azure subscription.</span></span> <span data-ttu-id="dfdf2-115">Если у вас ее нет, [активируйте преимущества для подписчиков MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) или <a href="/pricing/free-account/" target="_blank">[зарегистрируйте бесплатную учетную запись](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="dfdf2-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="dfdf2-116">[Учетная запись службы автоматизации](automation-sec-configure-azure-runas-account.md) toohold hello runbook и проверить подлинность tooAzure ресурсов.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-116">[Automation account](automation-sec-configure-azure-runas-account.md) toohold hello runbook and authenticate tooAzure resources.</span></span>  <span data-ttu-id="dfdf2-117">Этой учетной записи необходимо разрешение toostart и остановить виртуальную машину hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-117">This account must have permission toostart and stop hello virtual machine.</span></span>
* <span data-ttu-id="dfdf2-118">Виртуальная машина Azure.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-118">An Azure virtual machine.</span></span> <span data-ttu-id="dfdf2-119">Это не должна быть рабочая виртуальная машина, так как в процессе изучения этого руководства ее нужно будет остановить и запустить заново.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="dfdf2-120">Шаг 1. Создание нового модуля Runbook</span><span class="sxs-lookup"><span data-stu-id="dfdf2-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="dfdf2-121">Мы начнем с создания простого модуля runbook, который выводит текст hello *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-121">We'll start by creating a simple runbook that outputs hello text *Hello World*.</span></span>

1. <span data-ttu-id="dfdf2-122">Откройте в hello портал Azure, ваша учетная запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-122">In hello Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="dfdf2-123">страница учетной записи автоматизации Hello предоставляет быстрый просмотр hello ресурсов в этой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-123">hello Automation account page gives you a quick view of hello resources in this account.</span></span> <span data-ttu-id="dfdf2-124">Некоторые ресурсы уже должны быть доступны.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-124">You should already have some assets.</span></span> <span data-ttu-id="dfdf2-125">Большинство из них являются hello модули, которые автоматически включаются в новую учетную запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-125">Most of those are hello modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="dfdf2-126">Вы также должны hello ресурс учетных данных, которая упоминается в hello [необходимых компонентов](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="dfdf2-126">You should also have hello Credential asset that's mentioned in hello [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="dfdf2-127">Щелкните hello **Runbooks** плитки tooopen hello список модулей Runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-127">Click on hello **Runbooks** tile tooopen hello list of runbooks.</span></span><br><br> <span data-ttu-id="dfdf2-128">![Элемент управления "Модули Runbook"](media/automation-first-runbook-textual/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-128">![Runbooks control](media/automation-first-runbook-textual/runbooks-control-tiles.png)</span></span>
3. <span data-ttu-id="dfdf2-129">Создать новый runbook, щелкнув hello **добавить модуль runbook** кнопки и затем **создать новый runbook**.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-129">Create a new runbook by clicking on hello **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="dfdf2-130">Присвойте имя hello hello runbook *рабочего процесса MyFirstRunbook*.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-130">Give hello runbook hello name *MyFirstRunbook-Workflow*.</span></span>
5. <span data-ttu-id="dfdf2-131">В этом случае мы будем toocreate [runbook рабочего процесса PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) поэтому выберите **рабочего процесса Powershell** для **тип Runbook**.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-131">In this case, we're going toocreate a [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) so select **Powershell Workflow** for **Runbook type**.</span></span><br><br> <span data-ttu-id="dfdf2-132">![Новый Runbook](media/automation-first-runbook-textual/new-runbook-properties.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-132">![New runbook](media/automation-first-runbook-textual/new-runbook-properties.png)</span></span>
6. <span data-ttu-id="dfdf2-133">Нажмите кнопку **создать** toocreate hello runbook и откройте hello текстового редактора.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-133">Click **Create** toocreate hello runbook and open hello textual editor.</span></span>

## <a name="step-2---add-code-toohello-runbook"></a><span data-ttu-id="dfdf2-134">Шаг 2 — Добавление кода toohello runbook</span><span class="sxs-lookup"><span data-stu-id="dfdf2-134">Step 2 - Add code toohello runbook</span></span>
<span data-ttu-id="dfdf2-135">Можно любой тип кода непосредственно в hello runbook, или можно выбрать из hello элемент управления из библиотеки командлетов, модули Runbook и ресурсов и их добавления runbook toohello связанные параметры.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-135">You can either type code directly into hello runbook, or you can select cmdlets, runbooks, and assets from hello Library control and have them added toohello runbook with any related parameters.</span></span> <span data-ttu-id="dfdf2-136">В данном пошаговом руководстве мы будем ввести непосредственно в hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-136">For this walkthrough, we'll type directly into hello runbook.</span></span>

1. <span data-ttu-id="dfdf2-137">Наш runbook в настоящее время пуст с только hello необходимые *рабочего процесса* ключевое слово, имя hello наших runbook и hello фигурные скобки, которые будут encase hello весь рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-137">Our runbook is currently empty with only hello required *workflow* keyword, hello name of our runbook, and hello braces that will encase hello entire workflow.</span></span>

   ```
   Workflow MyFirstRunbook-Workflow
   {
   }
   ```
2. <span data-ttu-id="dfdf2-138">Введите *Write-Output "Привет, мир!"*</span><span class="sxs-lookup"><span data-stu-id="dfdf2-138">Type *Write-Output "Hello World."*</span></span> <span data-ttu-id="dfdf2-139">в фигурных скобках hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-139">between hello braces.</span></span>

   ```
   Workflow MyFirstRunbook-Workflow
   {
   Write-Output "Hello World"
   }
   ```
3. <span data-ttu-id="dfdf2-140">Сохранить hello runbook, установив **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-140">Save hello runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="dfdf2-141">![Сохранить Runbook](media/automation-first-runbook-textual/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-141">![Save runbook](media/automation-first-runbook-textual/automation-runbook-edit-controls-save.png)</span></span>

## <a name="step-3---test-hello-runbook"></a><span data-ttu-id="dfdf2-142">Шаг 3. при проверке runbook hello</span><span class="sxs-lookup"><span data-stu-id="dfdf2-142">Step 3 - Test hello runbook</span></span>
<span data-ttu-id="dfdf2-143">Прежде чем мы опубликовать hello runbook toomake он доступен в рабочей среде, нам нужно tootest его toomake убедиться, что он работает правильно.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-143">Before we publish hello runbook toomake it available in production, we want tootest it toomake sure that it works properly.</span></span> <span data-ttu-id="dfdf2-144">Чтобы протестировать модуль Runbook, нужно запустить его **черновую** версию и проверить его работу в интерактивном режиме.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-144">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="dfdf2-145">Нажмите кнопку **области тестов** tooopen hello тестовой области.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-145">Click **Test pane** tooopen hello Test pane.</span></span><br><br> <span data-ttu-id="dfdf2-146">![Область тестирования](media/automation-first-runbook-textual/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-146">![Test pane](media/automation-first-runbook-textual/automation-runbook-edit-controls-test.png)</span></span>
2. <span data-ttu-id="dfdf2-147">Нажмите кнопку **запустить** toostart hello теста.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-147">Click **Start** toostart hello test.</span></span> <span data-ttu-id="dfdf2-148">Это должно быть включено только hello вариантом.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-148">This should be hello only enabled option.</span></span>
3. <span data-ttu-id="dfdf2-149">При этом создается [задание Runbook](automation-runbook-execution.md) и отображается его состояние.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-149">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="dfdf2-150">состояние задания Hello будет запускаться как *в очереди* означает, что он ожидает runbook worker в доступных toocome облака hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-150">hello job status will start as *Queued* indicating that it is waiting for a runbook worker in hello cloud toocome available.</span></span> <span data-ttu-id="dfdf2-151">Он будет двигаться слишком*запуск* когда исполнитель задания hello, а затем *под управлением* при hello runbook фактически начинает выполнение.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-151">It will then move too*Starting* when a worker claims hello job, and then *Running* when hello runbook actually starts running.</span></span>  
4. <span data-ttu-id="dfdf2-152">По завершении заданий runbook hello его вывода.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-152">When hello runbook job completes, its output is displayed.</span></span> <span data-ttu-id="dfdf2-153">В нашем случае это должен быть текст *Привет, мир!*.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-153">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="dfdf2-154">![Привет, мир!](media/automation-first-runbook-textual/test-output-hello-world.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-154">![Hello World](media/automation-first-runbook-textual/test-output-hello-world.png)</span></span>
5. <span data-ttu-id="dfdf2-155">Закройте hello тестирования области tooreturn toohello холста.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-155">Close hello Test pane tooreturn toohello canvas.</span></span>

## <a name="step-4---publish-and-start-hello-runbook"></a><span data-ttu-id="dfdf2-156">Шаг 4. Публикация и запуск модуля runbook hello</span><span class="sxs-lookup"><span data-stu-id="dfdf2-156">Step 4 - Publish and start hello runbook</span></span>
<span data-ttu-id="dfdf2-157">по-прежнему в режиме черновика — Hello runbook, который мы только что создали.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-157">hello runbook that we just created is still in Draft mode.</span></span> <span data-ttu-id="dfdf2-158">Мы должны toopublish перед его можно было запустить в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-158">We need toopublish it before we can run it in production.</span></span> <span data-ttu-id="dfdf2-159">При публикации модуля runbook, можно заменить hello существующей опубликованной версии hello черновую версию.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-159">When you publish a runbook, you overwrite hello existing Published version with hello Draft version.</span></span> <span data-ttu-id="dfdf2-160">В нашем случае мы опубликованную версию еще нет, потому что мы только что создали hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-160">In our case, we don't have a Published version yet because we just created hello runbook.</span></span>

1. <span data-ttu-id="dfdf2-161">Нажмите кнопку **публикации** toopublish hello runbook и затем **Да** при появлении запроса.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-161">Click **Publish** toopublish hello runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="dfdf2-162">![Опубликовать](media/automation-first-runbook-textual/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-162">![Publish](media/automation-first-runbook-textual/automation-runbook-edit-controls-publish.png)</span></span>
2. <span data-ttu-id="dfdf2-163">При прокрутке левой tooview runbook hello в hello **Runbooks** области, он будет отображаться **состояние создания** из **опубликовано**.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-163">If you scroll left tooview hello runbook in hello **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="dfdf2-164">Панель hello правой tooview задней toohello прокрутки для **рабочего процесса MyFirstRunbook**.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-164">Scroll back toohello right tooview hello pane for **MyFirstRunbook-Workflow**.</span></span>  
   <span data-ttu-id="dfdf2-165">Hello параметры сверху hello позволит нам toostart hello runbook, запланировать toostart в некоторый момент в будущем hello или создать [веб-перехватчика](automation-webhooks.md) , оно может начаться через вызов HTTP.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-165">hello options across hello top allow us toostart hello runbook, schedule it toostart at some time in hello future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="dfdf2-166">Нужен только toostart hello runbook нажмите **запустить** и затем **Да** при появлении запроса.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-166">We just want toostart hello runbook so click **Start** and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="dfdf2-167">![Запуск модуля Runbook](media/automation-first-runbook-textual/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-167">![Start runbook](media/automation-first-runbook-textual/automation-runbook-controls-start.png)</span></span>
5. <span data-ttu-id="dfdf2-168">Открывается область задание для hello задание runbook, который мы только что создали.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-168">A job pane is opened for hello runbook job that we just created.</span></span> <span data-ttu-id="dfdf2-169">В этой области можно закрыть, но в этом случае мы будем его открыть, мы можно отслеживать ход выполнения задания hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-169">We can close this pane, but in this case we'll leave it open so we can watch hello job's progress.</span></span>
6. <span data-ttu-id="dfdf2-170">отображается состояние заданий Hello в **Сводка заданий** и совпадений hello состояния, мы видели, когда мы протестировали hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-170">hello job status is shown in **Job Summary** and matches hello statuses that we saw when we tested hello runbook.</span></span><br><br> <span data-ttu-id="dfdf2-171">![Сводные данные задания](media/automation-first-runbook-textual/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-171">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-jobsummary.png)</span></span>
7. <span data-ttu-id="dfdf2-172">Один раз hello показано состояние runbook *завершено*, нажмите кнопку **вывода**.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-172">Once hello runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="dfdf2-173">открыть область вывода Hello, и мы видим нашей *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-173">hello Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="dfdf2-174">![Сводные данные задания](media/automation-first-runbook-textual/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-174">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-outputtile.png)</span></span>  
8. <span data-ttu-id="dfdf2-175">Закрыть hello области вывода.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-175">Close hello Output pane.</span></span>
9. <span data-ttu-id="dfdf2-176">Нажмите кнопку **все журналы** tooopen hello потоки области для задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-176">Click **All Logs** tooopen hello Streams pane for hello runbook job.</span></span> <span data-ttu-id="dfdf2-177">Мы должны видеть только *Hello World* в выходных данных hello потока, но это может показывать другие потоки для задания runbook, например Verbose и ошибка записывает toothem hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-177">We should only see *Hello World* in hello output stream, but this can show other streams for a runbook job such as Verbose and Error if hello runbook writes toothem.</span></span><br><br> <span data-ttu-id="dfdf2-178">![Сводные данные задания](media/automation-first-runbook-textual/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-178">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-alllogstile.png)</span></span>
10. <span data-ttu-id="dfdf2-179">Закройте панель потоки hello и область MyFirstRunbook tooreturn toohello hello задание области.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-179">Close hello Streams pane and hello Job pane tooreturn toohello MyFirstRunbook pane.</span></span>
11. <span data-ttu-id="dfdf2-180">Нажмите кнопку **заданий** tooopen hello задания области для этого модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-180">Click **Jobs** tooopen hello Jobs pane for this runbook.</span></span> <span data-ttu-id="dfdf2-181">Перечисляет все задания hello, созданные этим модулем runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-181">This lists all of hello jobs created by this runbook.</span></span> <span data-ttu-id="dfdf2-182">Мы должны видеть только одно задание, так как мы только запуска задания hello один раз в списке.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-182">We should only see one job listed since we only ran hello job once.</span></span><br><br> <span data-ttu-id="dfdf2-183">![Задания](media/automation-first-runbook-textual/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-183">![Jobs](media/automation-first-runbook-textual/runbook-control-job-tile.png)</span></span>
12. <span data-ttu-id="dfdf2-184">Можно щелкнуть это задание tooopen hello же панели задания, которые мы просматривать, когда мы начали hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-184">You can click on this job tooopen hello same Job pane that we viewed when we started hello runbook.</span></span> <span data-ttu-id="dfdf2-185">Это позволяет toogo обратно в времени и просмотреть подробные сведения hello любого задания, который был создан для конкретного модуля runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-185">This allows you toogo back in time and view hello details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-toomanage-azure-resources"></a><span data-ttu-id="dfdf2-186">Шаг 5 — Добавление toomanage проверки подлинности ресурсов Azure</span><span class="sxs-lookup"><span data-stu-id="dfdf2-186">Step 5 - Add authentication toomanage Azure resources</span></span>
<span data-ttu-id="dfdf2-187">Мы протестировали и опубликовали свой модуль Runbook, но пока он не выполняет никаких полезных действий.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-187">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="dfdf2-188">Мы хотим toohave его управления ресурсами Azure.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-188">We want toohave it manage Azure resources.</span></span> <span data-ttu-id="dfdf2-189">Он не будет возможности toodo на то, что если у нас нет проверки подлинности с использованием учетных данных hello, называется tooin hello [необходимых компонентов](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="dfdf2-189">It won't be able toodo that though unless we have it authenticate using hello credentials that are referred tooin hello [prerequisites](#prerequisites).</span></span> <span data-ttu-id="dfdf2-190">Что мы делаем с hello **AzureRMAccount добавить** командлета.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-190">We do that with hello **Add-AzureRMAccount** cmdlet.</span></span>

1. <span data-ttu-id="dfdf2-191">Откройте hello текстового редактора, щелкнув **изменить** hello рабочего процесса MyFirstRunbook области.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-191">Open hello textual editor by clicking **Edit** on hello MyFirstRunbook-Workflow pane.</span></span><br><br> <span data-ttu-id="dfdf2-192">![Изменить Runbook](media/automation-first-runbook-textual/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-192">![Edit runbook](media/automation-first-runbook-textual/automation-runbook-controls-edit.png)</span></span>
2. <span data-ttu-id="dfdf2-193">Нам не нужен hello **Write-Output** строки больше, поэтому действуйте и удалите его.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-193">We don't need hello **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="dfdf2-194">Поместите курсор в место hello в пустую строку в фигурных скобках hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-194">Position hello cursor on a blank line between hello braces.</span></span>
4. <span data-ttu-id="dfdf2-195">Введите или скопируйте и вставьте следующий код, который будет обрабатывать hello проверку подлинности с помощью учетной записи запуска от автоматизации hello:</span><span class="sxs-lookup"><span data-stu-id="dfdf2-195">Type or copy and paste hello following code that will handle hello authentication with your Automation Run As account:</span></span>

   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
5. <span data-ttu-id="dfdf2-196">Нажмите кнопку **области тестов** , чтобы мы смогли проверить hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-196">Click **Test pane** so that we can test hello runbook.</span></span>
6. <span data-ttu-id="dfdf2-197">Нажмите кнопку **запустить** toostart hello теста.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-197">Click **Start** toostart hello test.</span></span> <span data-ttu-id="dfdf2-198">После ее завершения, должно появиться примерно toohello выходных данных после, отображение основных сведений из вашей учетной записи.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-198">Once it completes, you should receive output similar toohello following, displaying basic information from your account.</span></span> <span data-ttu-id="dfdf2-199">Это подтверждает, что эти учетные данные hello является допустимым.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-199">This confirms that hello credential is valid.</span></span><br><br> <span data-ttu-id="dfdf2-200">![Проверка подлинности](media/automation-first-runbook-textual/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-200">![Authenticate](media/automation-first-runbook-textual/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-toostart-a-virtual-machine"></a><span data-ttu-id="dfdf2-201">Шаг 6 — Добавление кода toostart виртуальной машины</span><span class="sxs-lookup"><span data-stu-id="dfdf2-201">Step 6 - Add code toostart a virtual machine</span></span>
<span data-ttu-id="dfdf2-202">Теперь, когда наши runbook проверяет подлинность tooour подписки Azure, мы управление ресурсами.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-202">Now that our runbook is authenticating tooour Azure subscription, we can manage resources.</span></span> <span data-ttu-id="dfdf2-203">Мы добавляем команда toostart виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-203">We add a command toostart a virtual machine.</span></span> <span data-ttu-id="dfdf2-204">Можно выбрать любой виртуальной машине в вашей подписке Azure, а сейчас можно жестко закодировать, что имя в hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-204">You can pick any virtual machine in your Azure subscription, and for now we will be hardcoding that name in hello runbook.</span></span>

1. <span data-ttu-id="dfdf2-205">После *AzureRmAccount добавить*, тип *Start AzureRmVM-имя «VMName» - ResourceGroupName «NameofResourceGroup»* указания имени hello и имя группы ресурсов toostart hello виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-205">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing hello name and Resource Group name of hello virtual machine toostart.</span></span>  

   ```
   workflow MyFirstRunbook-Workflow
   {
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   }
   ```
2. <span data-ttu-id="dfdf2-206">Сохранить hello runbook и нажмите кнопку **области тестов** , чтобы мы смогли проверить его.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-206">Save hello runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="dfdf2-207">Нажмите кнопку **запустить** toostart hello теста.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-207">Click **Start** toostart hello test.</span></span> <span data-ttu-id="dfdf2-208">После ее завершения, убедитесь, что виртуальная машина, hello была запущена.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-208">Once it completes, check that hello virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-toohello-runbook"></a><span data-ttu-id="dfdf2-209">Шаг 7 - добавьте входной параметр toohello runbook</span><span class="sxs-lookup"><span data-stu-id="dfdf2-209">Step 7 - Add an input parameter toohello runbook</span></span>
<span data-ttu-id="dfdf2-210">В настоящее время наши runbook запускает hello виртуальной машины, что мы жестко задано в hello runbook, но было бы более полезным, если hello виртуальной машины можно указать при запуске hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-210">Our runbook currently starts hello virtual machine that we hardcoded in hello runbook, but it would be more useful if we could specify hello virtual machine when hello runbook is started.</span></span> <span data-ttu-id="dfdf2-211">Теперь добавим tooprovide runbook toohello входных параметров эта функция.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-211">We will now add input parameters toohello runbook tooprovide that functionality.</span></span>

1. <span data-ttu-id="dfdf2-212">Добавление параметров для *VMName* и *ResourceGroupName* toohello runbook и использовать эти переменные с hello **AzureRmVM начала** командлет, как показано в приведенном ниже примере hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-212">Add parameters for *VMName* and *ResourceGroupName* toohello runbook and use these variables with hello **Start-AzureRmVM** cmdlet as in hello example below.</span></span>

   ```
   workflow MyFirstRunbook-Workflow
   {
    Param(
     [string]$VMName,
     [string]$ResourceGroupName
    )  
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   }
   ```
2. <span data-ttu-id="dfdf2-213">Сохраните hello runbook и откройте панель тестовых hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-213">Save hello runbook and open hello Test pane.</span></span> <span data-ttu-id="dfdf2-214">Обратите внимание, что вы можете теперь задать значения для hello два входные переменные, которые будут использоваться в тесте hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-214">Note that you can now provide values for hello two input variables that will be used in hello test.</span></span>
3. <span data-ttu-id="dfdf2-215">Закрыть hello тестовой области.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-215">Close hello Test pane.</span></span>
4. <span data-ttu-id="dfdf2-216">Нажмите кнопку **публикации** toopublish hello hello runbook в новой версии.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-216">Click **Publish** toopublish hello new version of hello runbook.</span></span>
5. <span data-ttu-id="dfdf2-217">Остановите hello виртуальную машину, которая запущена на предыдущем шаге hello.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-217">Stop hello virtual machine that you started in hello previous step.</span></span>
6. <span data-ttu-id="dfdf2-218">Нажмите кнопку **запустить** toostart hello runbook.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-218">Click **Start** toostart hello runbook.</span></span> <span data-ttu-id="dfdf2-219">Тип в hello **VMName** и **ResourceGroupName** для виртуальной машины hello ты toostart.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-219">Type in hello **VMName** and **ResourceGroupName** for hello virtual machine that you're going toostart.</span></span><br><br> <span data-ttu-id="dfdf2-220">![Start Runbook](media/automation-first-runbook-textual/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-220">![Start Runbook](media/automation-first-runbook-textual/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="dfdf2-221">После завершения hello runbook, убедитесь, что виртуальная машина, hello была запущена.</span><span class="sxs-lookup"><span data-stu-id="dfdf2-221">When hello runbook completes, check that hello virtual machine was started.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="dfdf2-222">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="dfdf2-222">Next steps</span></span>
* <span data-ttu-id="dfdf2-223">tooget к работе с графический Runbook в разделе [Мой первый графический runbook](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-223">tooget started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="dfdf2-224">tooget к работе с PowerShell модули Runbook в разделе [Мой первый runbook PowerShell](automation-first-runbook-textual-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-224">tooget started with PowerShell runbooks, see [My first PowerShell runbook](automation-first-runbook-textual-powershell.md)</span></span>
* <span data-ttu-id="dfdf2-225">в разделе toolearn Дополнительные сведения о типах runbook, их преимущества и ограничения, [типов runbook службы автоматизации Azure](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="dfdf2-225">toolearn more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="dfdf2-226">Дополнительные сведения о функции поддержки скриптов PowerShell см. в статье [Announcing Native PowerShell Script Support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/) (Встроенная поддержка скриптов PowerShell в службе автоматизации Azure).</span><span class="sxs-lookup"><span data-stu-id="dfdf2-226">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>
