---
title: "aaaForward tooOMS данных задания службы автоматизации Azure Log Analytics | Документы Microsoft"
description: "В этой статье показано, как toosend задания состояния и runbook задание потоки управления и анализа журналов Operations Management Suite tooMicrosoft toodeliver Дополнительные подробные сведения."
services: automation
documentationcenter: 
author: MGoedtel
manager: carmonm
editor: tysonn
ms.assetid: c12724c6-01a9-4b55-80ae-d8b7b99bd436
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/02/2017
ms.author: magoedte
ms.openlocfilehash: e78b6c6677d6502711ce828e2d32b7a91922ae26
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="forward-job-status-and-job-streams-from-automation-toolog-analytics-oms"></a><span data-ttu-id="ea226-103">Пересылать состояние задания и задания потоков из автоматизации tooLog Analytics (OMS)</span><span class="sxs-lookup"><span data-stu-id="ea226-103">Forward job status and job streams from Automation tooLog Analytics (OMS)</span></span>
<span data-ttu-id="ea226-104">Автоматизация может отправлять runbook задания состояние задания потоки tooyour анализа журналов Microsoft Operations Management Suite (OMS) рабочей области и.</span><span class="sxs-lookup"><span data-stu-id="ea226-104">Automation can send runbook job status and job streams tooyour Microsoft Operations Management Suite (OMS) Log Analytics workspace.</span></span>  <span data-ttu-id="ea226-105">Заносит в журнал заданий и потоки задания, отображаются в hello портал Azure, либо с помощью PowerShell, отдельные задания, и позволяет tooperform простой исследования.</span><span class="sxs-lookup"><span data-stu-id="ea226-105">Job logs and job streams are visible in hello Azure portal, or with PowerShell, for individual jobs and this allows you tooperform simple investigations.</span></span> <span data-ttu-id="ea226-106">С помощью Log Analytics теперь можно:</span><span class="sxs-lookup"><span data-stu-id="ea226-106">Now with Log Analytics you can:</span></span>

* <span data-ttu-id="ea226-107">получить информацию о заданиях службы автоматизации;</span><span class="sxs-lookup"><span data-stu-id="ea226-107">Get insight on your Automation jobs</span></span>
* <span data-ttu-id="ea226-108">активировать отправку электронного сообщения или оповещения в соответствии с состоянием задания Runbook (например, сбой или приостановка);</span><span class="sxs-lookup"><span data-stu-id="ea226-108">Trigger an email or alert based on your runbook job status (for example, failed or suspended)</span></span>
* <span data-ttu-id="ea226-109">создавать сложные запросы для потоков заданий;</span><span class="sxs-lookup"><span data-stu-id="ea226-109">Write advanced queries across your job streams</span></span>
* <span data-ttu-id="ea226-110">коррелировать задания и учетные записи службы автоматизации;</span><span class="sxs-lookup"><span data-stu-id="ea226-110">Correlate jobs across Automation accounts</span></span>
* <span data-ttu-id="ea226-111">визуализировать журнал задания по прошествии времени.</span><span class="sxs-lookup"><span data-stu-id="ea226-111">Visualize your job history over time</span></span>     

## <a name="prerequisites-and-deployment-considerations"></a><span data-ttu-id="ea226-112">Предварительные требования и рекомендации по развертыванию</span><span class="sxs-lookup"><span data-stu-id="ea226-112">Prerequisites and deployment considerations</span></span>
<span data-ttu-id="ea226-113">toostart автоматической отправки журналов tooLog аналитики, необходимо:</span><span class="sxs-lookup"><span data-stu-id="ea226-113">toostart sending your Automation logs tooLog Analytics, you need:</span></span>

1. <span data-ttu-id="ea226-114">Здравствуйте, ноябрь 2016 г. или более поздней версии версии [Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/) (v2.3.0).</span><span class="sxs-lookup"><span data-stu-id="ea226-114">hello November 2016 or later release of [Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/) (v2.3.0).</span></span>
2. <span data-ttu-id="ea226-115">Рабочая область Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="ea226-115">A Log Analytics workspace.</span></span> <span data-ttu-id="ea226-116">Дополнительные сведения см. в статье [Начало работы с Log Analytics](../log-analytics/log-analytics-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="ea226-116">For more information, see [Get started with Log Analytics](../log-analytics/log-analytics-get-started.md).</span></span> 
3. <span data-ttu-id="ea226-117">Hello ResourceId для вашей учетной записи службы автоматизации Azure</span><span class="sxs-lookup"><span data-stu-id="ea226-117">hello ResourceId for your Azure Automation account</span></span>

<span data-ttu-id="ea226-118">hello toofind ResourceId для вашей учетной записи службы автоматизации Azure и рабочей области аналитики журналов, запустите следующие PowerShell hello:</span><span class="sxs-lookup"><span data-stu-id="ea226-118">toofind hello ResourceId for your Azure Automation account and Log Analytics workspace, run hello following PowerShell:</span></span>

```powershell
# Find hello ResourceId for hello Automation Account
Find-AzureRmResource -ResourceType "Microsoft.Automation/automationAccounts"

# Find hello ResourceId for hello Log Analytics workspace
Find-AzureRmResource -ResourceType "Microsoft.OperationalInsights/workspaces"
```

<span data-ttu-id="ea226-119">Если у вас несколько учетных записей автоматизации или рабочие области, в выходные данные команды, предшествующие hello hello найти hello *имя* требуется tooconfigure и скопируйте значение hello для *ResourceId*.</span><span class="sxs-lookup"><span data-stu-id="ea226-119">If you have multiple Automation accounts, or workspaces, in hello output of hello preceding commands, find hello *Name* you need tooconfigure and copy hello value for *ResourceId*.</span></span>

<span data-ttu-id="ea226-120">Если вам требуется toofind hello *имя* учетной записи автоматизации в hello портала Azure выберите учетную запись автоматизации из hello **учетной записи автоматизации** и выберите **все параметры**.</span><span class="sxs-lookup"><span data-stu-id="ea226-120">If you need toofind hello *Name* of your Automation account, in hello Azure portal select your Automation account from hello **Automation account** blade and select **All settings**.</span></span>  <span data-ttu-id="ea226-121">Из hello **все параметры** колонки в разделе **параметры учетной записи** выберите **свойства**.</span><span class="sxs-lookup"><span data-stu-id="ea226-121">From hello **All settings** blade, under **Account Settings** select **Properties**.</span></span>  <span data-ttu-id="ea226-122">В hello **свойства** колонки, эти значения можно обратить внимание.</span><span class="sxs-lookup"><span data-stu-id="ea226-122">In hello **Properties** blade, you can note these values.</span></span><br> <span data-ttu-id="ea226-123">![Свойства учетной записи службы автоматизации](media/automation-manage-send-joblogs-log-analytics/automation-account-properties.png).</span><span class="sxs-lookup"><span data-stu-id="ea226-123">![Automation Account properties](media/automation-manage-send-joblogs-log-analytics/automation-account-properties.png).</span></span>

## <a name="set-up-integration-with-log-analytics"></a><span data-ttu-id="ea226-124">Настройка интеграции с Log Analytics</span><span class="sxs-lookup"><span data-stu-id="ea226-124">Set up integration with Log Analytics</span></span>
1. <span data-ttu-id="ea226-125">На компьютере, запустите **Windows PowerShell** из hello **запустить** экрана.</span><span class="sxs-lookup"><span data-stu-id="ea226-125">On your computer, start **Windows PowerShell** from hello **Start** screen.</span></span>  
2. <span data-ttu-id="ea226-126">Скопируйте и вставьте следующий PowerShell hello и измените значение hello для hello `$workspaceId` и `$automationAccountId`.</span><span class="sxs-lookup"><span data-stu-id="ea226-126">Copy and paste hello following PowerShell, and edit hello value for hello `$workspaceId` and `$automationAccountId`.</span></span>  <span data-ttu-id="ea226-127">Для hello `-Environment` параметров, допустимыми значениями являются *облачной* или *AzureUSGovernment* в зависимости от того, вы работаете в среде облака hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-127">For hello `-Environment` parameter, valid values are *AzureCloud* or *AzureUSGovernment* depending on hello cloud environment you are working in.</span></span>     

```powershell
[cmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$True)]
        [ValidateSet("AzureCloud","AzureUSGovernment")]
        [string]$Environment="AzureCloud"
    )

#Check toosee which cloud environment toosign into.
Switch ($Environment)
   {
       "AzureCloud" {Login-AzureRmAccount}
       "AzureUSGovernment" {Login-AzureRmAccount -EnvironmentName AzureUSGovernment} 
   }

# if you have one Log Analytics workspace you can use hello following command tooget hello resource id of hello workspace
$workspaceId = (Get-AzureRmOperationalInsightsWorkspace).ResourceId

$automationAccountId = "/SUBSCRIPTIONS/ec11ca60-1234-491e-5678-0ea07feae25c/RESOURCEGROUPS/DEMO/PROVIDERS/MICROSOFT.AUTOMATION/ACCOUNTS/DEMO" 

Set-AzureRmDiagnosticSetting -ResourceId $automationAccountId -WorkspaceId $workspaceId -Enabled $true

```

<span data-ttu-id="ea226-128">После запуска этого сценария вы увидите записи в Log Analytics, добавленные в новый элемент JobLogs или JobStreams за 10 минут.</span><span class="sxs-lookup"><span data-stu-id="ea226-128">After running this script, you will see records in Log Analytics within 10 minutes of new JobLogs or JobStreams being written.</span></span>

<span data-ttu-id="ea226-129">toosee журналы hello, запустите hello в следующем запросе в поиске по журналам анализа журналов:`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span><span class="sxs-lookup"><span data-stu-id="ea226-129">toosee hello logs, run hello following query in Log Analytics log search: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span></span>

### <a name="verify-configuration"></a><span data-ttu-id="ea226-130">Проверка конфигурации</span><span class="sxs-lookup"><span data-stu-id="ea226-130">Verify configuration</span></span>
<span data-ttu-id="ea226-131">tooconfirm отправляет учетной записи автоматизации в журналах рабочей областью аналитики журналов tooyour, проверьте, что диагностики правильно установлены на hello учетной записи автоматизации с помощью следующих PowerShell hello:</span><span class="sxs-lookup"><span data-stu-id="ea226-131">tooconfirm that your Automation account is sending logs tooyour Log Analytics workspace, check that diagnostics are set correctly on hello Automation account using hello following PowerShell:</span></span>

```powershell
[cmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$True)]
        [ValidateSet("AzureCloud","AzureUSGovernment")]
        [string]$Environment="AzureCloud"
    )

#Check toosee which cloud environment toosign into.
Switch ($Environment)
   {
       "AzureCloud" {Login-AzureRmAccount}
       "AzureUSGovernment" {Login-AzureRmAccount -EnvironmentName AzureUSGovernment} 
   }
# if you have one Log Analytics workspace you can use hello following command tooget hello resource id of hello workspace
$workspaceId = (Get-AzureRmOperationalInsightsWorkspace).ResourceId

$automationAccountId = "/SUBSCRIPTIONS/ec11ca60-1234-491e-5678-0ea07feae25c/RESOURCEGROUPS/DEMO/PROVIDERS/MICROSOFT.AUTOMATION/ACCOUNTS/DEMO" 

Get-AzureRmDiagnosticSetting -ResourceId $automationAccountId
```

<span data-ttu-id="ea226-132">В выходных данных hello убедитесь, что:</span><span class="sxs-lookup"><span data-stu-id="ea226-132">In hello output ensure that:</span></span>
+ <span data-ttu-id="ea226-133">В разделе *журналы*, hello значение *включено* — *True*</span><span class="sxs-lookup"><span data-stu-id="ea226-133">Under *Logs*, hello value for *Enabled* is *True*</span></span>
+ <span data-ttu-id="ea226-134">Здравствуйте, значение *ИД рабочей области* задано toohello ResourceId рабочей области аналитики журналов</span><span class="sxs-lookup"><span data-stu-id="ea226-134">hello value of *WorkspaceId* is set toohello ResourceId of your Log Analytics workspace</span></span>


## <a name="log-analytics-records"></a><span data-ttu-id="ea226-135">Записи Log Analytics</span><span class="sxs-lookup"><span data-stu-id="ea226-135">Log Analytics records</span></span>
<span data-ttu-id="ea226-136">При диагностике из службы автоматизации Azure в Log Analytics создаются записи двух типов, которые помечаются как **Type=AzureDiagnostics**.</span><span class="sxs-lookup"><span data-stu-id="ea226-136">Diagnostics from Azure Automation creates two types of records in Log Analytics and are tagged as **Type=AzureDiagnostics**.</span></span>

### <a name="job-logs"></a><span data-ttu-id="ea226-137">Журналы заданий</span><span class="sxs-lookup"><span data-stu-id="ea226-137">Job Logs</span></span>
| <span data-ttu-id="ea226-138">Свойство</span><span class="sxs-lookup"><span data-stu-id="ea226-138">Property</span></span> | <span data-ttu-id="ea226-139">Описание</span><span class="sxs-lookup"><span data-stu-id="ea226-139">Description</span></span> |
| --- | --- |
| <span data-ttu-id="ea226-140">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="ea226-140">TimeGenerated</span></span> |<span data-ttu-id="ea226-141">Дата и время выполнения задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-141">Date and time when hello runbook job executed.</span></span> |
| <span data-ttu-id="ea226-142">RunbookName_s</span><span class="sxs-lookup"><span data-stu-id="ea226-142">RunbookName_s</span></span> |<span data-ttu-id="ea226-143">Имя hello runbook Hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-143">hello name of hello runbook.</span></span> |
| <span data-ttu-id="ea226-144">Caller_s</span><span class="sxs-lookup"><span data-stu-id="ea226-144">Caller_s</span></span> |<span data-ttu-id="ea226-145">Кто инициировал операцию hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-145">Who initiated hello operation.</span></span>  <span data-ttu-id="ea226-146">Допустимые значения: электронный адрес или system для запланированных заданий.</span><span class="sxs-lookup"><span data-stu-id="ea226-146">Possible values are either an email address or system for scheduled jobs.</span></span> |
| <span data-ttu-id="ea226-147">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="ea226-147">Tenant_g</span></span> | <span data-ttu-id="ea226-148">Идентификатор GUID, определяющий hello клиента для hello вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="ea226-148">GUID that identifies hello tenant for hello Caller.</span></span> |
| <span data-ttu-id="ea226-149">JobId_g</span><span class="sxs-lookup"><span data-stu-id="ea226-149">JobId_g</span></span> |<span data-ttu-id="ea226-150">Идентификатор GUID, — идентификатор задания runbook hello hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-150">GUID that is hello Id of hello runbook job.</span></span> |
| <span data-ttu-id="ea226-151">ResultType</span><span class="sxs-lookup"><span data-stu-id="ea226-151">ResultType</span></span> |<span data-ttu-id="ea226-152">состояние задания runbook hello Hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-152">hello status of hello runbook job.</span></span>  <span data-ttu-id="ea226-153">Возможные значения:</span><span class="sxs-lookup"><span data-stu-id="ea226-153">Possible values are:</span></span><br><span data-ttu-id="ea226-154">Started</span><span class="sxs-lookup"><span data-stu-id="ea226-154">- Started</span></span><br><span data-ttu-id="ea226-155">- Остановлена</span><span class="sxs-lookup"><span data-stu-id="ea226-155">- Stopped</span></span><br><span data-ttu-id="ea226-156">Приостановлено</span><span class="sxs-lookup"><span data-stu-id="ea226-156">- Suspended</span></span><br><span data-ttu-id="ea226-157">Сбой</span><span class="sxs-lookup"><span data-stu-id="ea226-157">- Failed</span></span><br><span data-ttu-id="ea226-158">Завершено</span><span class="sxs-lookup"><span data-stu-id="ea226-158">- Completed</span></span> |
| <span data-ttu-id="ea226-159">Категория</span><span class="sxs-lookup"><span data-stu-id="ea226-159">Category</span></span> | <span data-ttu-id="ea226-160">Классификация данных типа hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-160">Classification of hello type of data.</span></span>  <span data-ttu-id="ea226-161">Для автоматизации используется значение hello JobLogs.</span><span class="sxs-lookup"><span data-stu-id="ea226-161">For Automation, hello value is JobLogs.</span></span> |
| <span data-ttu-id="ea226-162">OperationName</span><span class="sxs-lookup"><span data-stu-id="ea226-162">OperationName</span></span> | <span data-ttu-id="ea226-163">Указывает тип операции, выполняемой в Azure hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-163">Specifies hello type of operation performed in Azure.</span></span>  <span data-ttu-id="ea226-164">Для автоматизации используется значение hello задания.</span><span class="sxs-lookup"><span data-stu-id="ea226-164">For Automation, hello value is Job.</span></span> |
| <span data-ttu-id="ea226-165">Ресурс</span><span class="sxs-lookup"><span data-stu-id="ea226-165">Resource</span></span> | <span data-ttu-id="ea226-166">Имя учетной записи автоматизации hello</span><span class="sxs-lookup"><span data-stu-id="ea226-166">Name of hello Automation account</span></span> |
| <span data-ttu-id="ea226-167">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="ea226-167">SourceSystem</span></span> | <span data-ttu-id="ea226-168">Как служба аналитики журналов сбора данных hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-168">How Log Analytics collected hello data.</span></span> <span data-ttu-id="ea226-169">Всегда имеет значение *Azure* для системы диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="ea226-169">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="ea226-170">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="ea226-170">ResultDescription</span></span> |<span data-ttu-id="ea226-171">Описывает состояние результата задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-171">Describes hello runbook job result state.</span></span>  <span data-ttu-id="ea226-172">Возможные значения:</span><span class="sxs-lookup"><span data-stu-id="ea226-172">Possible values are:</span></span><br><span data-ttu-id="ea226-173">— Job is started;</span><span class="sxs-lookup"><span data-stu-id="ea226-173">- Job is started</span></span><br><span data-ttu-id="ea226-174">— Job Failed;</span><span class="sxs-lookup"><span data-stu-id="ea226-174">- Job Failed</span></span><br><span data-ttu-id="ea226-175">- Job Completed.</span><span class="sxs-lookup"><span data-stu-id="ea226-175">- Job Completed</span></span> |
| <span data-ttu-id="ea226-176">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="ea226-176">CorrelationId</span></span> |<span data-ttu-id="ea226-177">Идентификатор GUID, который является hello Корреляционный идентификатор задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-177">GUID that is hello Correlation Id of hello runbook job.</span></span> |
| <span data-ttu-id="ea226-178">ResourceId</span><span class="sxs-lookup"><span data-stu-id="ea226-178">ResourceId</span></span> |<span data-ttu-id="ea226-179">Указывает идентификатор ресурса учетной записи автоматизации Azure hello hello модуля Runbook.</span><span class="sxs-lookup"><span data-stu-id="ea226-179">Specifies hello Azure Automation account resource id of hello runbook.</span></span> |
| <span data-ttu-id="ea226-180">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="ea226-180">SubscriptionId</span></span> | <span data-ttu-id="ea226-181">Здравствуйте, подписки Azure идентификатор (GUID) для учетной записи автоматизации hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-181">hello Azure subscription Id (GUID) for hello Automation account.</span></span> |
| <span data-ttu-id="ea226-182">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="ea226-182">ResourceGroup</span></span> | <span data-ttu-id="ea226-183">Имя группы ресурсов hello hello учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="ea226-183">Name of hello resource group for hello Automation account.</span></span> |
| <span data-ttu-id="ea226-184">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="ea226-184">ResourceProvider</span></span> | <span data-ttu-id="ea226-185">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="ea226-185">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="ea226-186">ResourceType</span><span class="sxs-lookup"><span data-stu-id="ea226-186">ResourceType</span></span> | <span data-ttu-id="ea226-187">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="ea226-187">AUTOMATIONACCOUNTS</span></span> |


### <a name="job-streams"></a><span data-ttu-id="ea226-188">Потоки заданий</span><span class="sxs-lookup"><span data-stu-id="ea226-188">Job Streams</span></span>
| <span data-ttu-id="ea226-189">Свойство</span><span class="sxs-lookup"><span data-stu-id="ea226-189">Property</span></span> | <span data-ttu-id="ea226-190">Описание</span><span class="sxs-lookup"><span data-stu-id="ea226-190">Description</span></span> |
| --- | --- |
| <span data-ttu-id="ea226-191">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="ea226-191">TimeGenerated</span></span> |<span data-ttu-id="ea226-192">Дата и время выполнения задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-192">Date and time when hello runbook job executed.</span></span> |
| <span data-ttu-id="ea226-193">RunbookName_s</span><span class="sxs-lookup"><span data-stu-id="ea226-193">RunbookName_s</span></span> |<span data-ttu-id="ea226-194">Имя hello runbook Hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-194">hello name of hello runbook.</span></span> |
| <span data-ttu-id="ea226-195">Caller_s</span><span class="sxs-lookup"><span data-stu-id="ea226-195">Caller_s</span></span> |<span data-ttu-id="ea226-196">Кто инициировал операцию hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-196">Who initiated hello operation.</span></span>  <span data-ttu-id="ea226-197">Допустимые значения: электронный адрес или system для запланированных заданий.</span><span class="sxs-lookup"><span data-stu-id="ea226-197">Possible values are either an email address or system for scheduled jobs.</span></span> |
| <span data-ttu-id="ea226-198">StreamType_s</span><span class="sxs-lookup"><span data-stu-id="ea226-198">StreamType_s</span></span> |<span data-ttu-id="ea226-199">Тип Hello потока задания.</span><span class="sxs-lookup"><span data-stu-id="ea226-199">hello type of job stream.</span></span> <span data-ttu-id="ea226-200">Возможные значения:</span><span class="sxs-lookup"><span data-stu-id="ea226-200">Possible values are:</span></span><br><span data-ttu-id="ea226-201">ход выполнения</span><span class="sxs-lookup"><span data-stu-id="ea226-201">-Progress</span></span><br><span data-ttu-id="ea226-202">Выходные данные</span><span class="sxs-lookup"><span data-stu-id="ea226-202">- Output</span></span><br><span data-ttu-id="ea226-203">Предупреждение</span><span class="sxs-lookup"><span data-stu-id="ea226-203">- Warning</span></span><br><span data-ttu-id="ea226-204">error</span><span class="sxs-lookup"><span data-stu-id="ea226-204">- Error</span></span><br><span data-ttu-id="ea226-205">debug</span><span class="sxs-lookup"><span data-stu-id="ea226-205">- Debug</span></span><br><span data-ttu-id="ea226-206">- Verbose.</span><span class="sxs-lookup"><span data-stu-id="ea226-206">- Verbose</span></span> |
| <span data-ttu-id="ea226-207">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="ea226-207">Tenant_g</span></span> | <span data-ttu-id="ea226-208">Идентификатор GUID, определяющий hello клиента для hello вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="ea226-208">GUID that identifies hello tenant for hello Caller.</span></span> |
| <span data-ttu-id="ea226-209">JobId_g</span><span class="sxs-lookup"><span data-stu-id="ea226-209">JobId_g</span></span> |<span data-ttu-id="ea226-210">Идентификатор GUID, — идентификатор задания runbook hello hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-210">GUID that is hello Id of hello runbook job.</span></span> |
| <span data-ttu-id="ea226-211">ResultType</span><span class="sxs-lookup"><span data-stu-id="ea226-211">ResultType</span></span> |<span data-ttu-id="ea226-212">состояние задания runbook hello Hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-212">hello status of hello runbook job.</span></span>  <span data-ttu-id="ea226-213">Возможные значения:</span><span class="sxs-lookup"><span data-stu-id="ea226-213">Possible values are:</span></span><br><span data-ttu-id="ea226-214">- In Progress</span><span class="sxs-lookup"><span data-stu-id="ea226-214">- In Progress</span></span> |
| <span data-ttu-id="ea226-215">Категория</span><span class="sxs-lookup"><span data-stu-id="ea226-215">Category</span></span> | <span data-ttu-id="ea226-216">Классификация данных типа hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-216">Classification of hello type of data.</span></span>  <span data-ttu-id="ea226-217">Для автоматизации используется значение hello JobStreams.</span><span class="sxs-lookup"><span data-stu-id="ea226-217">For Automation, hello value is JobStreams.</span></span> |
| <span data-ttu-id="ea226-218">OperationName</span><span class="sxs-lookup"><span data-stu-id="ea226-218">OperationName</span></span> | <span data-ttu-id="ea226-219">Указывает тип операции, выполняемой в Azure hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-219">Specifies hello type of operation performed in Azure.</span></span>  <span data-ttu-id="ea226-220">Для автоматизации используется значение hello задания.</span><span class="sxs-lookup"><span data-stu-id="ea226-220">For Automation, hello value is Job.</span></span> |
| <span data-ttu-id="ea226-221">Ресурс</span><span class="sxs-lookup"><span data-stu-id="ea226-221">Resource</span></span> | <span data-ttu-id="ea226-222">Имя учетной записи автоматизации hello</span><span class="sxs-lookup"><span data-stu-id="ea226-222">Name of hello Automation account</span></span> |
| <span data-ttu-id="ea226-223">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="ea226-223">SourceSystem</span></span> | <span data-ttu-id="ea226-224">Как служба аналитики журналов сбора данных hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-224">How Log Analytics collected hello data.</span></span> <span data-ttu-id="ea226-225">Всегда имеет значение *Azure* для системы диагностики Azure.</span><span class="sxs-lookup"><span data-stu-id="ea226-225">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="ea226-226">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="ea226-226">ResultDescription</span></span> |<span data-ttu-id="ea226-227">Включает в себя hello выходной поток из модуля runbook hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-227">Includes hello output stream from hello runbook.</span></span> |
| <span data-ttu-id="ea226-228">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="ea226-228">CorrelationId</span></span> |<span data-ttu-id="ea226-229">Идентификатор GUID, который является hello Корреляционный идентификатор задания runbook hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-229">GUID that is hello Correlation Id of hello runbook job.</span></span> |
| <span data-ttu-id="ea226-230">ResourceId</span><span class="sxs-lookup"><span data-stu-id="ea226-230">ResourceId</span></span> |<span data-ttu-id="ea226-231">Указывает идентификатор ресурса учетной записи автоматизации Azure hello hello модуля Runbook.</span><span class="sxs-lookup"><span data-stu-id="ea226-231">Specifies hello Azure Automation account resource id of hello runbook.</span></span> |
| <span data-ttu-id="ea226-232">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="ea226-232">SubscriptionId</span></span> | <span data-ttu-id="ea226-233">Здравствуйте, подписки Azure идентификатор (GUID) для учетной записи автоматизации hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-233">hello Azure subscription Id (GUID) for hello Automation account.</span></span> |
| <span data-ttu-id="ea226-234">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="ea226-234">ResourceGroup</span></span> | <span data-ttu-id="ea226-235">Имя группы ресурсов hello hello учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="ea226-235">Name of hello resource group for hello Automation account.</span></span> |
| <span data-ttu-id="ea226-236">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="ea226-236">ResourceProvider</span></span> | <span data-ttu-id="ea226-237">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="ea226-237">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="ea226-238">ResourceType</span><span class="sxs-lookup"><span data-stu-id="ea226-238">ResourceType</span></span> | <span data-ttu-id="ea226-239">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="ea226-239">AUTOMATIONACCOUNTS</span></span> |

## <a name="viewing-automation-logs-in-log-analytics"></a><span data-ttu-id="ea226-240">Просмотр журналов службы автоматизации в Log Analytics</span><span class="sxs-lookup"><span data-stu-id="ea226-240">Viewing Automation Logs in Log Analytics</span></span>
<span data-ttu-id="ea226-241">Теперь, когда вы начали отправки задания tooLog журналы аналитики вашей автоматизации, давайте посмотрим, можно сделать с помощью этих журналов в службе анализа журналов.</span><span class="sxs-lookup"><span data-stu-id="ea226-241">Now that you have started sending your Automation job logs tooLog Analytics, let’s see what you can do with these logs inside Log Analytics.</span></span>

<span data-ttu-id="ea226-242">журналы hello toosee с запуска приветствия при следующем запросе:`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span><span class="sxs-lookup"><span data-stu-id="ea226-242">toosee hello logs, run hello following query: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span></span>

### <a name="send-an-email-when-a-runbook-job-fails-or-suspends"></a><span data-ttu-id="ea226-243">Отправка электронного сообщения при сбое или приостановке задания Runbook</span><span class="sxs-lookup"><span data-stu-id="ea226-243">Send an email when a runbook job fails or suspends</span></span>
<span data-ttu-id="ea226-244">Одно из нашего главного клиента запрашивает предназначен для hello возможность toosend сообщение электронной почты или текстовый при возникновении неполадок с задания runbook.</span><span class="sxs-lookup"><span data-stu-id="ea226-244">One of our top customer asks is for hello ability toosend an email or a text when something goes wrong with a runbook job.</span></span>   

<span data-ttu-id="ea226-245">правило toocreate предупреждение, сначала нужно создать задание записи, которые следует вызвать предупреждение hello поиска журналов для hello runbook.</span><span class="sxs-lookup"><span data-stu-id="ea226-245">toocreate an alert rule, you start by creating a log search for hello runbook job records that should invoke hello alert.</span></span>  <span data-ttu-id="ea226-246">Нажмите кнопку hello **предупреждение** кнопку toocreate и настроить правила оповещений hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-246">Click hello **Alert** button toocreate and configure hello alert rule.</span></span>

1. <span data-ttu-id="ea226-247">На странице приветствия Обзор аналитики журналов нажмите **поиска журналов**.</span><span class="sxs-lookup"><span data-stu-id="ea226-247">From hello Log Analytics Overview page, click **Log Search**.</span></span>
2. <span data-ttu-id="ea226-248">Создайте запрос поиска журнала для оповещения, введя hello, выполнив поиск в поле запроса hello: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended)` задачи можно группировать по hello RunbookName с помощью:`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended) | measure Count() by RunbookName_s`</span><span class="sxs-lookup"><span data-stu-id="ea226-248">Create a log search query for your alert by typing hello following search into hello query field:  `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended)`  You can also group by hello RunbookName by using: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended) | measure Count() by RunbookName_s`</span></span>   

   <span data-ttu-id="ea226-249">Если настраивается журналы из более чем одной автоматизации учетная запись или подписка tooyour рабочей области, можно сгруппировать оповещения, подписки и учетной записи автоматизации.</span><span class="sxs-lookup"><span data-stu-id="ea226-249">If you have set up logs from more than one Automation account or subscription tooyour workspace, you can group your alerts by subscription and Automation account.</span></span>  <span data-ttu-id="ea226-250">Имя учетной записи автоматизации могут быть производными от поле ресурса hello в поиске hello объекта JobLogs.</span><span class="sxs-lookup"><span data-stu-id="ea226-250">Automation account name can be derived from hello Resource field in hello search of JobLogs.</span></span>  
3. <span data-ttu-id="ea226-251">tooopen hello **добавить правило оповещения** щелкните **предупреждения** вверху hello страницы приветствия.</span><span class="sxs-lookup"><span data-stu-id="ea226-251">tooopen hello **Add Alert Rule** screen, click **Alert** at hello top of hello page.</span></span> <span data-ttu-id="ea226-252">Для получения сведений о tooconfigure hello hello параметры оповещений в разделе [предупреждения в службе анализа журналов](../log-analytics/log-analytics-alerts.md#alert-rules).</span><span class="sxs-lookup"><span data-stu-id="ea226-252">For further details on hello options tooconfigure hello alert, see [Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md#alert-rules).</span></span>

### <a name="find-all-jobs-that-have-completed-with-errors"></a><span data-ttu-id="ea226-253">Поиск всех заданий, завершенных с ошибками</span><span class="sxs-lookup"><span data-stu-id="ea226-253">Find all jobs that have completed with errors</span></span>
<span data-ttu-id="ea226-254">В дополнение к этому tooalerting об ошибках можно найти после задания runbook устранимую ошибку.</span><span class="sxs-lookup"><span data-stu-id="ea226-254">In addition tooalerting on failures, you can find when a runbook job has a non-terminating error.</span></span> <span data-ttu-id="ea226-255">В таких случаях PowerShell создает поток сообщений об ошибках, но не вызвать ваш toosuspend задания или ошибкой hello устранимые ошибки.</span><span class="sxs-lookup"><span data-stu-id="ea226-255">In these cases PowerShell produces an error stream, but hello non-terminating errors do not cause your job toosuspend or fail.</span></span>    

1. <span data-ttu-id="ea226-256">В рабочей области Log Analytics щелкните **Поиск по журналу**.</span><span class="sxs-lookup"><span data-stu-id="ea226-256">In your Log Analytics workspace, click **Log Search**.</span></span>
2. <span data-ttu-id="ea226-257">Введите в поле запроса hello `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams StreamType_s=Error | measure count() by JobId_g` и нажмите кнопку **поиска**.</span><span class="sxs-lookup"><span data-stu-id="ea226-257">In hello query field, type `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams StreamType_s=Error | measure count() by JobId_g` and then click **Search**.</span></span>

### <a name="view-job-streams-for-a-job"></a><span data-ttu-id="ea226-258">Просмотр потоков заданий для задания</span><span class="sxs-lookup"><span data-stu-id="ea226-258">View job streams for a job</span></span>
<span data-ttu-id="ea226-259">При отладке задания можно также toolook в потоки задания hello.</span><span class="sxs-lookup"><span data-stu-id="ea226-259">When you are debugging a job, you may also want toolook into hello job streams.</span></span>  <span data-ttu-id="ea226-260">Hello следующий запрос отображает все потоки hello для одного задания с GUID 2ebd22ea-e05e-4eb9 - 9d 76-d73cbd4356e0:</span><span class="sxs-lookup"><span data-stu-id="ea226-260">hello following query shows all hello streams for a single job with GUID 2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0:</span></span>   

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams JobId_g="2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0" | sort TimeGenerated | select ResultDescription`

### <a name="view-historical-job-status"></a><span data-ttu-id="ea226-261">Просмотр хронологии состояния задания</span><span class="sxs-lookup"><span data-stu-id="ea226-261">View historical job status</span></span>
<span data-ttu-id="ea226-262">Наконец вы можете toovisualize историю задания со временем.</span><span class="sxs-lookup"><span data-stu-id="ea226-262">Finally, you may want toovisualize your job history over time.</span></span>  <span data-ttu-id="ea226-263">Можно использовать этот запрос toosearch hello состояния заданий со временем.</span><span class="sxs-lookup"><span data-stu-id="ea226-263">You can use this query toosearch for hello status of your jobs over time.</span></span>

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs NOT(ResultType="started") | measure Count() by ResultType interval 1hour`  
<br> <span data-ttu-id="ea226-264">![Диаграмма хронологии состояния задания в OMS](media/automation-manage-send-joblogs-log-analytics/historical-job-status-chart.png)</span><span class="sxs-lookup"><span data-stu-id="ea226-264">![OMS Historical Job Status Chart](media/automation-manage-send-joblogs-log-analytics/historical-job-status-chart.png)</span></span><br>

## <a name="summary"></a><span data-ttu-id="ea226-265">Сводка</span><span class="sxs-lookup"><span data-stu-id="ea226-265">Summary</span></span>
<span data-ttu-id="ea226-266">Отправляя вашей автоматизации задания состояния и поток данных tooLog Analytics, можно получить более глубокое представление о hello состояние автоматизации заданий по:</span><span class="sxs-lookup"><span data-stu-id="ea226-266">By sending your Automation job status and stream data tooLog Analytics, you can get better insight into hello status of your Automation jobs by:</span></span>
+ <span data-ttu-id="ea226-267">Настройка оповещений toonotify вы при возникновении проблемы</span><span class="sxs-lookup"><span data-stu-id="ea226-267">Setting up alerts toonotify you when there is an issue</span></span>
+ <span data-ttu-id="ea226-268">С помощью настраиваемых представлений и запросов toovisualize поиска вашей результатов runbook, состояние задания runbook и других связанных ключевых показателей или метрики.</span><span class="sxs-lookup"><span data-stu-id="ea226-268">Using custom views and search queries toovisualize your runbook results, runbook job status, and other related key indicators or metrics.</span></span>  

<span data-ttu-id="ea226-269">Служба аналитики журналов предоставляет больше оперативной видимость tooyour автоматизации заданий и могут помочь быстрее инцидентов адрес.</span><span class="sxs-lookup"><span data-stu-id="ea226-269">Log Analytics provides greater operational visibility tooyour Automation jobs and can help address incidents quicker.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="ea226-270">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="ea226-270">Next steps</span></span>
* <span data-ttu-id="ea226-271">toolearn Дополнительные сведения о как журналы с помощью аналитики журналов задания tooconstruct различных поисковые запросы и просмотрите hello автоматизации см [входа поиска аналитики журналов](../log-analytics/log-analytics-log-searches.md)</span><span class="sxs-lookup"><span data-stu-id="ea226-271">toolearn more about how tooconstruct different search queries and review hello Automation job logs with Log Analytics, see [Log searches in Log Analytics](../log-analytics/log-analytics-log-searches.md)</span></span>
* <span data-ttu-id="ea226-272">toounderstand toocreate и получение выходных данных и сообщения об ошибках из модулей Runbook, в статье [Runbook вывода и сообщений](automation-runbook-output-and-messages.md)</span><span class="sxs-lookup"><span data-stu-id="ea226-272">toounderstand how toocreate and retrieve output and error messages from runbooks, see [Runbook output and messages](automation-runbook-output-and-messages.md)</span></span>
* <span data-ttu-id="ea226-273">Дополнительные сведения о выполнение модуля runbook, как toomonitor заданиях и другие технические сведения см. в разделе toolearn [отследить задание runbook](automation-runbook-execution.md)</span><span class="sxs-lookup"><span data-stu-id="ea226-273">toolearn more about runbook execution, how toomonitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md)</span></span>
* <span data-ttu-id="ea226-274">в разделе toolearn Дополнительные сведения о службе анализа журналов OMS и коллекцию источников данных, [Azure сбор данных из хранилища в обзоре анализа журналов](../log-analytics/log-analytics-azure-storage.md)</span><span class="sxs-lookup"><span data-stu-id="ea226-274">toolearn more about OMS Log Analytics and data collection sources, see [Collecting Azure storage data in Log Analytics overview](../log-analytics/log-analytics-azure-storage.md)</span></span>
