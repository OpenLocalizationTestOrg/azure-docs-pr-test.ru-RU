---
title: "Интеграция системы управления версиями службы автоматизации Azure с GitHub Enterprise | Документация Майкрософт"
description: "В статье описано, как настроить интеграцию модулей Runbook системы управления версиями службы автоматизации с GitHub Enterprise."
services: automation
documentationCenter: 
authors: mgoedtel
manager: jwhit
editor: 
ms.assetid: e01d817c-7d38-421c-adf5-647a4b526eb4
ms.service: automation
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: magoedte
ms.openlocfilehash: 62793dcdbbf4c83161e95d1c165d5c231245f7c6
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="azure-automation-scenario---automation-source-control-integration-with-github-enterprise"></a><span data-ttu-id="c87e2-103">Сценарий службы автоматизации Azure: интеграция системы управления версиями службы автоматизации с GitHub Enterprise</span><span class="sxs-lookup"><span data-stu-id="c87e2-103">Azure Automation scenario - Automation source control integration with GitHub Enterprise</span></span>

<span data-ttu-id="c87e2-104">Служба автоматизации сейчас поддерживает интеграцию системы управления версиями. Благодаря этому вы можете связать модули Runbook в своей учетной записи службы автоматизации с репозиторием системы управления версиями GitHub.</span><span class="sxs-lookup"><span data-stu-id="c87e2-104">Automation currently supports source control integration, which allows you to associate runbooks in your Automation account to a GitHub source control repository.</span></span>  <span data-ttu-id="c87e2-105">Тем не менее клиенты, развернувшие [GitHub Enterprise](https://enterprise.github.com/home) для поддержки своих решений DevOps, также хотят использовать это развертывание для управления жизненным циклом модулей Runbook, разработанных для автоматизации бизнес-процессов и операций управления службами.</span><span class="sxs-lookup"><span data-stu-id="c87e2-105">However, customers who have deployed [GitHub Enterprise](https://enterprise.github.com/home) to support their DevOps practices, also want to use it to manage the lifecycle of runbooks that are developed to automate business processes and service management operations.</span></span>  

<span data-ttu-id="c87e2-106">В этом сценарии используется компьютер Windows в центре обработки данных, настроенном в качестве гибридной рабочей роли Runbook, на котором установлены модулями Azure Resource Manager и инструменты Git.</span><span class="sxs-lookup"><span data-stu-id="c87e2-106">In this scenario, you have a Windows computer in your data center configured as a Hybrid Runbook Worker with the Azure Resource Manager modules and Git tools installed.</span></span>  <span data-ttu-id="c87e2-107">На компьютере с гибридной рабочей ролью установлен клон локального репозитория.</span><span class="sxs-lookup"><span data-stu-id="c87e2-107">The Hybrid worker machine has a clone of the local Git repository.</span></span>  <span data-ttu-id="c87e2-108">При запуске модуля Runbook в гибридной рабочей роли каталог Git синхронизируется, а содержимое файла модуля импортируется в учетную запись службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c87e2-108">When the runbook is run on the hybrid worker, the Git directory is synchronized and the runbook file contents are imported into the Automation account.</span></span>

<span data-ttu-id="c87e2-109">В этой статье рассказывается, как настроить такую конфигурацию в среде службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c87e2-109">This article describes how to set up this configuration in your Azure Automation environment.</span></span> <span data-ttu-id="c87e2-110">Мы начнем с настройки учетных данных, обеспечивающих безопасность службы автоматизации, модулей runbook, необходимых для поддержки этого сценария и развертывания гибридной рабочей роли Runbook в центре обработки данных. Это необходимо для запуска модулей runbook и доступа к репозиторию GitHub Enterprise для синхронизации модулей runbook с учетной записью службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c87e2-110">We start by configuring Automation with the security credentials, runbooks required to support this scenario, and deployment of a Hybrid Runbook Worker in your data center to run the runbooks and access your GitHub Enterprise repository to synchronize runbooks with your Automation account.</span></span>  


## <a name="getting-the-scenario"></a><span data-ttu-id="c87e2-111">Получение сценария</span><span class="sxs-lookup"><span data-stu-id="c87e2-111">Getting the scenario</span></span>

<span data-ttu-id="c87e2-112">В сценарии используются два модуля Runbook PowerShell, которые можно импортировать непосредственно из [коллекции модулей Runbook](automation-runbook-gallery.md) на портале Azure или скачать из [коллекции PowerShell](https://www.powershellgallery.com).</span><span class="sxs-lookup"><span data-stu-id="c87e2-112">This scenario consists of two PowerShell runbooks that you can import directly from the [Runbook Gallery](automation-runbook-gallery.md) in the Azure portal or download from the [PowerShell Gallery](https://www.powershellgallery.com).</span></span>

### <a name="runbooks"></a><span data-ttu-id="c87e2-113">Модули Runbook</span><span class="sxs-lookup"><span data-stu-id="c87e2-113">Runbooks</span></span>

<span data-ttu-id="c87e2-114">Модуль Runbook</span><span class="sxs-lookup"><span data-stu-id="c87e2-114">Runbook</span></span> | <span data-ttu-id="c87e2-115">Описание</span><span class="sxs-lookup"><span data-stu-id="c87e2-115">Description</span></span>| 
--------|------------|
<span data-ttu-id="c87e2-116">Export-RunAsCertificateToHybridWorker</span><span class="sxs-lookup"><span data-stu-id="c87e2-116">Export-RunAsCertificateToHybridWorker</span></span> | <span data-ttu-id="c87e2-117">Runbook экспортирует сертификат запуска от имени из учетной записи службы автоматизации в гибридную рабочую роль, чтобы модули runbook в рабочей роли, импортируемые в учетную запись службы автоматизации, могли проходить аутентификацию с помощью Azure.</span><span class="sxs-lookup"><span data-stu-id="c87e2-117">Runbook exports a RunAs certificate from an Automation account to a hybrid worker so that runbooks on the worker can authenticate with Azure in order to import runbooks into the Automation account.</span></span>| 
<span data-ttu-id="c87e2-118">Sync-LocalGitFolderToAutomationAccount</span><span class="sxs-lookup"><span data-stu-id="c87e2-118">Sync-LocalGitFolderToAutomationAccount</span></span> | <span data-ttu-id="c87e2-119">Runbook синхронизирует локальную папку Git на компьютере с гибридной рабочей ролью, а затем импортирует файлы runbook (PS1-файлы) в учетную запись автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c87e2-119">Runbook syncs the local Git folder on the hybrid machine and then import the runbook files (*.ps1) into the Automation account.</span></span>|

### <a name="credentials"></a><span data-ttu-id="c87e2-120">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="c87e2-120">Credentials</span></span>

<span data-ttu-id="c87e2-121">Учетные данные</span><span class="sxs-lookup"><span data-stu-id="c87e2-121">Credential</span></span> | <span data-ttu-id="c87e2-122">Описание</span><span class="sxs-lookup"><span data-stu-id="c87e2-122">Description</span></span>|
-----------|------------|
<span data-ttu-id="c87e2-123">GitHRWCredential</span><span class="sxs-lookup"><span data-stu-id="c87e2-123">GitHRWCredential</span></span> | <span data-ttu-id="c87e2-124">Создаваемый ресурс учетных данных, содержащий имя и пароль пользователя с разрешениями на доступ к гибридной рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="c87e2-124">Credential asset you create to contain the username and password for a user with permissions to the hybrid worker.</span></span>|

## <a name="installing-and-configuring-this-scenario"></a><span data-ttu-id="c87e2-125">Установка и настройка данного сценария</span><span class="sxs-lookup"><span data-stu-id="c87e2-125">Installing and configuring this scenario</span></span>

### <a name="prerequisites"></a><span data-ttu-id="c87e2-126">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="c87e2-126">Prerequisites</span></span>

1. <span data-ttu-id="c87e2-127">Модуль Runbook Sync-LocalGitFolderToAutomationAccount выполняет проверку подлинности с использованием [учетной записи запуска от имени Azure](automation-sec-configure-azure-runas-account.md).</span><span class="sxs-lookup"><span data-stu-id="c87e2-127">The Sync-LocalGitFolderToAutomationAccount runbook authenticates using the [Azure Run As account](automation-sec-configure-azure-runas-account.md).</span></span> 

2. <span data-ttu-id="c87e2-128">Также понадобится рабочая область Microsoft Operations Management Suite (OMS) с включенным и настроенным решением службы автоматизации Azure.</span><span class="sxs-lookup"><span data-stu-id="c87e2-128">A Microsoft Operations Management Suite (OMS) workspace with the Azure Automation solution enabled and configured is also required.</span></span>  <span data-ttu-id="c87e2-129">Если у вас нет такой области, связанной с учетной записью службы автоматизации, используемой для установки и настройки этого сценария, она будет создана и настроена автоматически при выполнении сценария **New-OnPremiseHybridWorker.ps1** из гибридной рабочей роли Runbook.</span><span class="sxs-lookup"><span data-stu-id="c87e2-129">If you do not have one that is associated with the Automation account used to install and configure this scenario, it is created and configured for you when you execute the **New-OnPremiseHybridWorker.ps1** script from the hybrid runbook worker.</span></span>        

    > [!NOTE]
    > <span data-ttu-id="c87e2-130">Сейчас интеграция службы автоматизации с OMS поддерживается только для следующих регионов: **Юго-восточная Австралия**, **Восточная часть США 2**, **Юго-Восточная Азия** и **Западная Европа**.</span><span class="sxs-lookup"><span data-stu-id="c87e2-130">Currently the following regions only support Automation integration with OMS - **Australia Southeast**, **East US 2**, **Southeast Asia**, and **West Europe**.</span></span> 

3. <span data-ttu-id="c87e2-131">На компьютере, который можно использовать в качестве выделенной гибридной рабочей роли Runbook, также будут размещены ПО GitHub и файлы Runbook (*runbook*.ps1) в исходном каталоге в файловой системе для синхронизации между GitHub и учетной записью службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c87e2-131">A computer that can serve as a dedicated Hybrid Runbook Worker that will also host the GitHub software and maintain the runbook files (*runbook*.ps1) in a source directory on the file system to synchronize between GitHub and your Automation account.</span></span>

### <a name="import-and-publish-the-runbooks"></a><span data-ttu-id="c87e2-132">Импорт и публикация модулей Runbook</span><span class="sxs-lookup"><span data-stu-id="c87e2-132">Import and publish the runbooks</span></span>

<span data-ttu-id="c87e2-133">Чтобы импортировать модули runbook *Export-RunAsCertificateToHybridWorker* и *Sync-LocalGitFolderToAutomationAccount* из коллекции модулей runbook своей учетной записи службы автоматизации на портале Azure, выполните процедуры, описанные разделе [Импорт модуля Runbook из коллекции Runbook с помощью портала Azure](automation-runbook-gallery.md#to-import-a-runbook-from-the-runbook-gallery-with-the-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="c87e2-133">To import the *Export-RunAsCertificateToHybridWorker* and *Sync-LocalGitFolderToAutomationAccount* runbooks from the Runbook Gallery from your Automation account in the Azure portal, follow the procedures in [Import Runbook from the Runbook Gallery](automation-runbook-gallery.md#to-import-a-runbook-from-the-runbook-gallery-with-the-azure-portal).</span></span> <span data-ttu-id="c87e2-134">Опубликуйте каждый импортированный в учетную запись службы автоматизации модуль Runbook.</span><span class="sxs-lookup"><span data-stu-id="c87e2-134">Publish the runbooks after they have been successfully imported into your Automation account.</span></span>

### <a name="deploy-and-configure-hybrid-runbook-worker"></a><span data-ttu-id="c87e2-135">Развертывание и настройка гибридной рабочей роли Runbook</span><span class="sxs-lookup"><span data-stu-id="c87e2-135">Deploy and Configure Hybrid Runbook Worker</span></span>

<span data-ttu-id="c87e2-136">Если у вас нет гибридной рабочей роли Runbook, развернутой в центре обработки данных, ознакомьтесь с требованиями и выполните действия по автоматической установке и настройке, как описано [здесь](automation-hybrid-runbook-worker.md#automated-deployment).</span><span class="sxs-lookup"><span data-stu-id="c87e2-136">If you do not have a Hybrid Runbook Worker already deployed in your data center, you should review the requirements and follow the automated installation steps using the procedure in [Azure Automation Hybrid Runbook Workers - Automate Install and Configuration](automation-hybrid-runbook-worker.md#automated-deployment).</span></span>  <span data-ttu-id="c87e2-137">Установив гибридную рабочую роль на компьютере, выполните следующие действия, чтобы завершить настройку для поддержки этого сценария.</span><span class="sxs-lookup"><span data-stu-id="c87e2-137">Once you have successfully installed the hybrid worker on a computer, perform the following steps to complete its configuration to support this scenario.</span></span>

1. <span data-ttu-id="c87e2-138">Войдите на компьютер, на котором размещена гибридная рабочая роль Runbook, используя учетную запись с правами локального администратора, и создайте каталог для хранения файлов runbook Git.</span><span class="sxs-lookup"><span data-stu-id="c87e2-138">Sign on to the computer hosting the Hybrid Runbook Worker role with an account that has local administrative rights and create a directory to hold the Git runbook files.</span></span>  <span data-ttu-id="c87e2-139">Клонируйте внутренний репозиторий в этот каталог.</span><span class="sxs-lookup"><span data-stu-id="c87e2-139">Clone  the internal Git repository to the directory.</span></span>
2. <span data-ttu-id="c87e2-140">Если вы еще не создали учетную запись запуска от имени или хотите создать новую (специально выделенную для этой цели), на портале Azure перейдите к учетным записям службы автоматизации, выберите свою учетную запись и создайте [ресурс учетных данных](automation-credentials.md). Этот ресурс должен содержать имя пользователя и пароль для пользователя с разрешениями на доступ к гибридной рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="c87e2-140">If you do not already have a RunAs account created or you want to create a new one dedicated for this purpose, from the Azure portal navigate to Automation accounts, select your Automation account and create a [credential asset](automation-credentials.md) that contains the username and password for a user with permissions to the hybrid worker.</span></span>  
3. <span data-ttu-id="c87e2-141">Из учетной записи службы автоматизации [измените модуль Runbook](automation-edit-textual-runbook.md) **Export-RunAsCertificateToHybridWorker**, заменив значение переменной *$Password* надежным паролем.</span><span class="sxs-lookup"><span data-stu-id="c87e2-141">From your Automation account, [edit the runbook](automation-edit-textual-runbook.md)  **Export-RunAsCertificateToHybridWorker** and modify the value for the variable *$Password* with a strong password.</span></span>  <span data-ttu-id="c87e2-142">Заменив значение, щелкните **Опубликовать** для публикации черновой версии модуля Runbook.</span><span class="sxs-lookup"><span data-stu-id="c87e2-142">After you modify the value, click **Publish** to have the draft version of the runbook published.</span></span> 
5. <span data-ttu-id="c87e2-143">Запустите модуль Runbook **Export-RunAsCertificateToHybridWorker**, а затем в колонке **Запуск Runbook** в разделе **Параметры запуска** щелкните **Гибридная рабочая роль**. В раскрывающемся списке выберите созданную ранее в этом сценарии группу гибридной рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="c87e2-143">Start the runbook **Export-RunAsCertificateToHybridWorker**, and in the **Start Runbook** blade, under the option **Run settings** select the option **Hybrid Worker** and in the drop-down list select the Hybrid worker group you created earlier for this scenario.</span></span>  

    <span data-ttu-id="c87e2-144">Сертификат будет экспортирован в гибридную рабочую роль, чтобы модули runbook в рабочей роли могли проходить аутентификацию в Azure с помощью подключения запуска от имени. Это необходимо для управления ресурсами Azure (а в этом сценарии — для импорта модулей runbook в учетную запись службы автоматизации).</span><span class="sxs-lookup"><span data-stu-id="c87e2-144">This exports a certificate to the hybrid worker so that runbooks on the worker can authenticate with Azure using the Run As connection in order to manage Azure resources (in particular for this scenario - import runbooks to the Automation account).</span></span>

4. <span data-ttu-id="c87e2-145">В учетной записи службы автоматизации выберите созданную ранее группу гибридных рабочих ролей и [укажите учетную запись запуска от имени](automation-hrw-run-runbooks.md#runas-account) для нее. Затем выберите созданный (сейчас или ранее) ресурс учетных данных.</span><span class="sxs-lookup"><span data-stu-id="c87e2-145">From your Automation account, select the Hybrid worker group created earlier and [specify a RunAs account](automation-hrw-run-runbooks.md#runas-account) for the Hybrid worker group, and chose the credential asset you just or already have created.</span></span>  <span data-ttu-id="c87e2-146">После этого модуль Runbook для синхронизации сможет запускать команды Git.</span><span class="sxs-lookup"><span data-stu-id="c87e2-146">This assures that the Sync runbook can run Git commands.</span></span> 
5. <span data-ttu-id="c87e2-147">Запустите модуль Runbook **Sync-LocalGitFolderToAutomationAccount**, укажите следующие обязательные значения для входных параметров, а затем в колонке **Запуск Runbook** в разделе **Параметры запуска** щелкните **Гибридная рабочая роль**. В раскрывающемся списке выберите созданную ранее в этом сценарии группу гибридной рабочей роли.</span><span class="sxs-lookup"><span data-stu-id="c87e2-147">Start the runbook **Sync-LocalGitFolderToAutomationAccount**, provide the following required input parameter values and in the **Start Runbook** blade, under the option **Run settings** select the option **Hybrid Worker** and in the drop-down list select the Hybrid worker group you created earlier for this scenario:</span></span>
    * <span data-ttu-id="c87e2-148">*ResourceGroupName* — имя группы ресурсов, связанной с вашей учетной записью службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c87e2-148">*ResourceGroup* - the name of your resource group associated with your Automation account</span></span>
    * <span data-ttu-id="c87e2-149">*AutomationAccountName* — имя учетной записи службы автоматизации;</span><span class="sxs-lookup"><span data-stu-id="c87e2-149">*AutomationAccountName* - the name of your Automation account</span></span>
    * <span data-ttu-id="c87e2-150">*GitPath* — локальная папка или файл в гибридной рабочей роли Runbook, куда Git в соответствии с настройками извлекает последние изменения.</span><span class="sxs-lookup"><span data-stu-id="c87e2-150">*GitPath* - The local folder or file on the Hybrid Runbook Worker where Git is set up to pull latest changes into</span></span>

    <span data-ttu-id="c87e2-151">Это обеспечит синхронизацию локальной папки Git на компьютер с гибридной рабочей ролью с последующим импортом файлов PS1 из исходного каталога в учетную запись службы автоматизации.</span><span class="sxs-lookup"><span data-stu-id="c87e2-151">This will sync the local Git folder on the hybrid worker computer and then import the .ps1 files from the source directory to the Automation account.</span></span>

    ![Start Sync-LocalGitFolderToAutomationAccount Runbook](media/automation-scenario-source-control-integration-with-github-ent/start-runbook-synclocalgitfoldertoautoacct.png)<br>

7. <span data-ttu-id="c87e2-153">Чтобы просмотреть сводные данные о состоянии заданий модуля Runbook, выберите этот модуль в колонке **Модули Runbook** учетной записи службы автоматизации и щелкните плитку **Задания**.</span><span class="sxs-lookup"><span data-stu-id="c87e2-153">View job summary details for the runbook by selecting it from the **Runbooks** blade in your Automation account, and then select the **Jobs** tile.</span></span>  <span data-ttu-id="c87e2-154">Щелкните плитку **Все журналы** и проверьте подробный поток журнала, чтобы убедиться, что задание выполнено.</span><span class="sxs-lookup"><span data-stu-id="c87e2-154">Confirm it completed successfully by selecting the **All logs** tile and reviewing the detailed log stream.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="c87e2-155">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c87e2-155">Next steps</span></span>

-  <span data-ttu-id="c87e2-156">Чтобы получить дополнительные сведения о типах модулей Runbook, их преимуществах и ограничениях, обратитесь к статье [Типы модулей Runbook в службе автоматизации Azure](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="c87e2-156">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
-  <span data-ttu-id="c87e2-157">Дополнительные сведения о функции поддержки скриптов PowerShell см. в статье [Announcing Native PowerShell Script Support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/) (Встроенная поддержка скриптов PowerShell в службе автоматизации Azure).</span><span class="sxs-lookup"><span data-stu-id="c87e2-157">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>
