---
title: "Шаблон мультитенантного веб-приложения | Документация Майкрософт"
description: "Найдите обзоры архитектуры и шаблоны разработки, описывающие, как реализовать мультитенантное веб-приложение в Azure."
services: 
documentationcenter: .net
author: wadepickett
manager: wpickett
editor: 
ms.assetid: 4f0281d2-1555-42b0-a99d-1222fade0b0f
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/05/2015
ms.author: wpickett
ms.openlocfilehash: 57ba0e46139bda2d74c9f7db0ffab2f2122b0df2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2017
---
# <a name="multitenant-applications-in-azure"></a><span data-ttu-id="e129b-103">Мультитенантные приложения Azure</span><span class="sxs-lookup"><span data-stu-id="e129b-103">Multitenant Applications in Azure</span></span>
<span data-ttu-id="e129b-104">Мультитенантное приложение – это общий ресурс, который позволяет разделять пользователей или "клиентов" для просмотра приложения, как будто каждый пользователь является его владельцем.</span><span class="sxs-lookup"><span data-stu-id="e129b-104">A multitenant application is a shared resource that allows separate users, or "tenants," to view the application as though it was their own.</span></span> <span data-ttu-id="e129b-105">Типичный сценарий, связанный с мультитенатным приложением: все пользователи приложения могут настроить под себя интерфейс, однако во всем остальном приложение должно соответствовать одним и тем же бизнес-требованиям.</span><span class="sxs-lookup"><span data-stu-id="e129b-105">A typical scenario that lends itself to a multitenant application is one in which all users of the application may wish to customize the user experience but otherwise have the same basic business requirements.</span></span> <span data-ttu-id="e129b-106">Примерами крупных мультитенатных приложений являются Office 365, Outlook.com и visualstudio.com.</span><span class="sxs-lookup"><span data-stu-id="e129b-106">Examples of large multitenant applications are Office 365, Outlook.com, and visualstudio.com.</span></span>

<span data-ttu-id="e129b-107">С точки зрения поставщика приложения преимущества мультитенантности связаны в основном с оптимизацией работы и расходов.</span><span class="sxs-lookup"><span data-stu-id="e129b-107">From an application provider's perspective, the benefits of multitenancy mostly relate to operational and cost efficiencies.</span></span> <span data-ttu-id="e129b-108">Одна версия приложения может соответствовать потребностям многих клиентов/заказчиков, что позволяет консолидировать задачи системного администрирования, такие как мониторинг, настройка производительности, поддержка программного обеспечения и резервное копирование данных.</span><span class="sxs-lookup"><span data-stu-id="e129b-108">One version of your application can meet the needs of many tenants/customers, allowing consolidation of system administration tasks such as monitoring, performance tuning, software maintenance, and data backups.</span></span>

<span data-ttu-id="e129b-109">Ниже приведен список наиболее значимых целей и требований с точки зрения поставщика.</span><span class="sxs-lookup"><span data-stu-id="e129b-109">The following provides a list of the most significant goals and requirements from a provider's perspective.</span></span>

* <span data-ttu-id="e129b-110">**Подготовка.** Необходимо иметь возможность подготавливать новых клиентов для приложения.</span><span class="sxs-lookup"><span data-stu-id="e129b-110">**Provisioning**: You must be able to provision new tenants for the application.</span></span>  <span data-ttu-id="e129b-111">Для мультитенатных приложений с большим количеством клиентов, как правило, необходимо автоматизировать этот процесс, включив возможность самостоятельной подготовки.</span><span class="sxs-lookup"><span data-stu-id="e129b-111">For multitenant applications with a large number of tenants, it is usually necessary to automate this process by enabling self-service provisioning.</span></span>
* <span data-ttu-id="e129b-112">**Возможность поддержки.** Необходимо иметь возможность обновить приложение и выполнить другие задачи поддержки во время использования приложения несколькими клиентами.</span><span class="sxs-lookup"><span data-stu-id="e129b-112">**Maintainability**: You must be able to upgrade the application and perform other maintenance tasks while multiple tenants are using it.</span></span>
* <span data-ttu-id="e129b-113">**Мониторинг.** Необходимо иметь возможность постоянного мониторинга приложения для определения любых проблем и их эффективного устранения.</span><span class="sxs-lookup"><span data-stu-id="e129b-113">**Monitoring**: You must be able to monitor the application at all times to identify any problems and to troubleshoot them.</span></span> <span data-ttu-id="e129b-114">Это включает мониторинг использования приложения каждым клиентом.</span><span class="sxs-lookup"><span data-stu-id="e129b-114">This includes monitoring how each tenant is using the application.</span></span>

<span data-ttu-id="e129b-115">Правильно реализованного мультитенантное приложение предоставляет пользователям следующие преимущества.</span><span class="sxs-lookup"><span data-stu-id="e129b-115">A properly implemented multitenant application provides the following benefits to users.</span></span>

* <span data-ttu-id="e129b-116">**Изоляция.** Действия отдельных клиентов не влияют на использование приложения другими клиентами.</span><span class="sxs-lookup"><span data-stu-id="e129b-116">**Isolation**: The activities of individual tenants do not affect the use of the application by other tenants.</span></span> <span data-ttu-id="e129b-117">Клиенты не могут получить доступ к данным друг друга.</span><span class="sxs-lookup"><span data-stu-id="e129b-117">Tenants cannot access each other's data.</span></span> <span data-ttu-id="e129b-118">С точки зрения клиента он имеет эксклюзивный доступ к приложению.</span><span class="sxs-lookup"><span data-stu-id="e129b-118">It appears to the tenant as though they have exclusive use of the application.</span></span>
* <span data-ttu-id="e129b-119">**Доступность.** Отдельные клиенты нуждаются в постоянной доступности приложения, возможно, с определением гарантии в соглашении об уровне обслуживания.</span><span class="sxs-lookup"><span data-stu-id="e129b-119">**Availability**: Individual tenants want the application to be constantly available, perhaps with guarantees defined in an SLA.</span></span> <span data-ttu-id="e129b-120">Опять же, действия других клиентов не должны влиять на доступность приложения.</span><span class="sxs-lookup"><span data-stu-id="e129b-120">Again, the activities of other tenants should not affect the availability of the application.</span></span>
* <span data-ttu-id="e129b-121">**Масштабируемость.** Приложение масштабируется для соответствия требованиям отдельных клиентов.</span><span class="sxs-lookup"><span data-stu-id="e129b-121">**Scalability**: The application scales to meet the demand of individual tenants.</span></span> <span data-ttu-id="e129b-122">Присутствие и действия других клиентов не должны влиять на производительность приложения.</span><span class="sxs-lookup"><span data-stu-id="e129b-122">The presence and actions of other tenants should not affect the performance of the application.</span></span>
* <span data-ttu-id="e129b-123">**Расходы.** Расходы ниже, чем при использовании выделенного для одного клиента приложения, так как мультитенантность обеспечивает совместное использование ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e129b-123">**Costs**: Costs are lower than running a dedicated, single-tenant application because multi-tenancy enables the sharing of resources.</span></span>
* <span data-ttu-id="e129b-124">**Возможность настройки**.</span><span class="sxs-lookup"><span data-stu-id="e129b-124">**Customizability**.</span></span> <span data-ttu-id="e129b-125">Возможность настройки приложения для отдельного клиента различными способами, например путем добавления и удаления функциональных возможностей, изменения цветов и логотипов или даже добавления собственного кода или сценария.</span><span class="sxs-lookup"><span data-stu-id="e129b-125">The ability to customize the application for an individual tenant in various ways such as adding or removing features, changing colors and logos, or even adding their own code or script.</span></span>

<span data-ttu-id="e129b-126">В целом, для предоставления масштабируемой службы следует учитывать различные факторы, однако существует также ряд целей и требований, которые являются общими для многих мультитенатных приложений.</span><span class="sxs-lookup"><span data-stu-id="e129b-126">In short, while there are many considerations that you must take into account to provide a highly scalable service, there are also a number of the goals and requirements that are common to many multitenant applications.</span></span> <span data-ttu-id="e129b-127">Некоторые могут не быть связаны с определенными сценариями, а важность отдельных целей и требований будут различаться в каждом сценарии.</span><span class="sxs-lookup"><span data-stu-id="e129b-127">Some may not be relevant in specific scenarios, and the importance of individual goals and requirements will differ in each scenario.</span></span> <span data-ttu-id="e129b-128">Как поставщик мультитенатных приложений вы также будете иметь определенные цели и требования, такие как выполнение требований клиентов, обеспечение прибыли, выставление счетов, предоставление различных уровней обслуживаний, подготовка, поддержка, мониторинг и автоматизация.</span><span class="sxs-lookup"><span data-stu-id="e129b-128">As a provider of the multitenant application, you will also have goals and requirements such as, meeting the tenants' goals and requirements, profitability, billing, multiple service levels, provisioning, maintainability monitoring, and automation.</span></span>

<span data-ttu-id="e129b-129">Дополнительные сведения о дополнительных аспектах разработки мультитенантного приложения см. в статье [Размещение мультитенантного приложения в Azure][Hosting a Multi-Tenant Application on Azure].</span><span class="sxs-lookup"><span data-stu-id="e129b-129">For more information on additional design considerations of a multitenant application, see [Hosting a Multi-Tenant Application on Azure][Hosting a Multi-Tenant Application on Azure].</span></span> <span data-ttu-id="e129b-130">Сведения о распространенных шаблонах архитектуры данных для мультитенантных приложений базы данных SaaS см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием базы данных Azure SQL](sql-database/sql-database-design-patterns-multi-tenancy-saas-applications.md).</span><span class="sxs-lookup"><span data-stu-id="e129b-130">For information on common data architecture patterns of multi-tenant software-as-a-service (SaaS) database applications, see [Design Patterns for Multi-tenant SaaS Applications with Azure SQL Database](sql-database/sql-database-design-patterns-multi-tenancy-saas-applications.md).</span></span> 

<span data-ttu-id="e129b-131">Azure предоставляет различные функциональные возможности, которые позволяют устранить основные проблемы, возникающие при разработке мультитенантной системы.</span><span class="sxs-lookup"><span data-stu-id="e129b-131">Azure provides many features that allow you to address the key problems encountered when designing a multitenant system.</span></span>

<span data-ttu-id="e129b-132">**Изоляция**</span><span class="sxs-lookup"><span data-stu-id="e129b-132">**Isolation**</span></span>

* <span data-ttu-id="e129b-133">Сегментация клиентов веб-сайта с помощью заголовков узла как при использовании SSL-подключений, так и при их отсутствии.</span><span class="sxs-lookup"><span data-stu-id="e129b-133">Segment Website Tenants by Host Headers with or without SSL communication</span></span>
* <span data-ttu-id="e129b-134">Сегментация клиентов веб-сайтов с помощью параметров запросов.</span><span class="sxs-lookup"><span data-stu-id="e129b-134">Segment Website Tenants by Query Parameters</span></span>
* <span data-ttu-id="e129b-135">Веб-службы в рабочих ролях.</span><span class="sxs-lookup"><span data-stu-id="e129b-135">Web Services in Worker Roles</span></span>
  * <span data-ttu-id="e129b-136">Рабочие роли</span><span class="sxs-lookup"><span data-stu-id="e129b-136">Worker Roles.</span></span> <span data-ttu-id="e129b-137">которые, как правило, обрабатывают данные в серверной части приложения.</span><span class="sxs-lookup"><span data-stu-id="e129b-137">that typically process data on the backend of an application.</span></span>
  * <span data-ttu-id="e129b-138">Веб-роли, которые, как правило, функционируют как интерфейсные части приложений.</span><span class="sxs-lookup"><span data-stu-id="e129b-138">Web Roles that typically act as the frontend for applications.</span></span>

<span data-ttu-id="e129b-139">**Хранилище**</span><span class="sxs-lookup"><span data-stu-id="e129b-139">**Storage**</span></span>

<span data-ttu-id="e129b-140">Управление данными, такое как база данных SQL Azure, или службы хранилища Azure, такие как служба таблиц, которая предоставляет службы хранилища для больших объемов неструктурированных данных, и служба BLOB-объектов, которая предоставляет возможности хранения больших объемов неструктурированных текстовых или двоичных данных, таких как видео, аудио и изображения.</span><span class="sxs-lookup"><span data-stu-id="e129b-140">Data management such as Azure SQL Database or Azure Storage services such as the Table service which provides services for storage of large amounts of unstructured data and the Blob service which provides services to store large amounts of unstructured text or binary data such as video, audio and images.</span></span>

* <span data-ttu-id="e129b-141">Обеспечение защиты мультитенантных данных в базе данных SQL в соответствии с учетными данными входа каждого клиента на сервер SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e129b-141">Securing Multitenant Data in SQL Database appropriate per-tenant SQL Server logins.</span></span>
* <span data-ttu-id="e129b-142">Использование таблиц Azure для ресурсов приложения. Путем определения политики доступа на уровне контейнера можно регулировать разрешения без необходимости формирования нового URL-адреса для ресурсов, защищенных подписями общего доступа.</span><span class="sxs-lookup"><span data-stu-id="e129b-142">Using Azure Tables for Application Resources By specifying a container level access policy, you can the ability to adjust permissions without having to issue new URL's for the resources protected with shared access signatures.</span></span>
* <span data-ttu-id="e129b-143">Очереди Azure для ресурсов приложения. Очереди Azure часто используются для выполнения обработки от имени клиентов, однако также могут быть использованы для распределения работы, необходимой для подготовки и управления.</span><span class="sxs-lookup"><span data-stu-id="e129b-143">Azure Queues for Application Resources Azure queues are commonly used to drive processing on behalf of tenants, but may also be used to distribute work required for provisioning or management.</span></span>
* <span data-ttu-id="e129b-144">Очереди Service Bus для ресурсов приложения, которые передают работу в общую службу. Можно использовать отдельную очередь, где каждый клиент-отправитель может иметь разрешения (по требованиям ACS) только на передачу данных в эту очередь, тогда как только получатели из службы могут иметь разрешение на прием из очереди данных, поступающих от нескольких клиентов.</span><span class="sxs-lookup"><span data-stu-id="e129b-144">Service Bus Queues for Application Resources that pushes work to a shared a service, you can use a single queue where each tenant sender only has permissions (as derived from claims issued from ACS) to push to that queue, while only the receivers from the service have permission to pull from the queue the data coming from multiple tenants.</span></span>

<span data-ttu-id="e129b-145">**Службы подключения и безопасности**</span><span class="sxs-lookup"><span data-stu-id="e129b-145">**Connection and Security Services**</span></span>

* <span data-ttu-id="e129b-146">Azure Service Bus — это инфраструктура обмена сообщениями, которая размещается между приложениями и позволяет им обмениваться сообщениями в слабосвязанной конфигурации для улучшения масштабирования и устойчивости.</span><span class="sxs-lookup"><span data-stu-id="e129b-146">Azure Service Bus, a messaging infrastructure that sits between applications allowing them to exchange messages in a loosely coupled way for improved scale and resiliency.</span></span>

<span data-ttu-id="e129b-147">**Сетевые службы**</span><span class="sxs-lookup"><span data-stu-id="e129b-147">**Networking Services**</span></span>

<span data-ttu-id="e129b-148">Azure предоставляет несколько сетевых служб, поддерживающих проверку подлинности и повышающих управляемость размещенных приложений.</span><span class="sxs-lookup"><span data-stu-id="e129b-148">Azure provides several networking services that support authentication, and improve manageability of your hosted applications.</span></span> <span data-ttu-id="e129b-149">В число этих служб входят следующие:</span><span class="sxs-lookup"><span data-stu-id="e129b-149">These services include the following:</span></span>

* <span data-ttu-id="e129b-150">Виртуальная сеть Azure позволяет подготавливать виртуальные частные сети (VPN) в Azure, управлять ими, а также обеспечить безопасный канал с локальной ИТ-инфраструктурой.</span><span class="sxs-lookup"><span data-stu-id="e129b-150">Azure Virtual Network lets you provision and manage virtual private networks (VPNs) in Azure as well as securely link these with on-premises IT infrastructure.</span></span>
* <span data-ttu-id="e129b-151">Диспетчер трафика (Traffic Manager) виртуальных сетей обеспечивает балансировку нагрузки по входящему трафику между несколькими размещенными службами Azure независимо от того, работают они в одном центре обработки данных или распределены по всему миру.</span><span class="sxs-lookup"><span data-stu-id="e129b-151">Virtual Network Traffic Manager allows you to load balance incoming traffic across multiple hosted Azure services whether they're running in the same datacenter or across different datacenters around the world.</span></span>
* <span data-ttu-id="e129b-152">Azure Active Directory (Azure AD) — это современная служба на основе интерфейса REST, которая предоставляет возможности для управления идентификацией и доступом в облачных приложениях.</span><span class="sxs-lookup"><span data-stu-id="e129b-152">Azure Active Directory (Azure AD) is a modern, REST-based service that provides identity management and access control capabilities for your cloud applications.</span></span> <span data-ttu-id="e129b-153">Использование Azure AD для ресурсов приложения Azure AD для предоставления простого способа проверки подлинности и авторизации пользователей для получения доступа к веб-приложениям и службам, одновременно позволяя реализовывать функциональные возможности проверки подлинности и авторизации в своем коде.</span><span class="sxs-lookup"><span data-stu-id="e129b-153">Using Azure AD for Application Resources Azure AD to provides an easy way of authenticating and authorizing users to gain access to your web applications and services while allowing the features of authentication and authorization to be factored out of your code.</span></span>
* <span data-ttu-id="e129b-154">Azure Service Bus предоставляет возможность безопасного обмена сообщениями и передачи данных для распределенных и гибридных приложений, например связи между размещенными в Azure приложениями и локальными приложениями и службами без необходимости в использовании комплексных инфраструктур брандмауэра и безопасности.</span><span class="sxs-lookup"><span data-stu-id="e129b-154">Azure Service Bus provides a secure messaging and data flow capability for distributed and hybrid applications, such as communication between Azure hosted applications and on-premises applications and services, without requiring complex firewall and security infrastructures.</span></span> <span data-ttu-id="e129b-155">С помощью ретранслятора служебной шины для ресурсов приложений. Службы, которые являются конечными точками, могут принадлежать клиенту (например, размещаться вне системы, в локальной среде) или подготавливаться специально для клиента (так как между ними передаются конфиденциальные данные, относящиеся к клиенту).</span><span class="sxs-lookup"><span data-stu-id="e129b-155">Using Service Bus Relay for Application Resources to The services that are exposed as endpoints may belong to the tenant (for example, hosted outside of the system, such as on-premises), or they may be services provisioned specifically for the tenant (because sensitive, tenant-specific data travels across them).</span></span>

<span data-ttu-id="e129b-156">**Подготовка ресурсов**</span><span class="sxs-lookup"><span data-stu-id="e129b-156">**Provisioning Resources**</span></span>

<span data-ttu-id="e129b-157">Azure предоставляет ряд способов подготовки новых клиентов приложения.</span><span class="sxs-lookup"><span data-stu-id="e129b-157">Azure provides a number of ways provision new tenants for the application.</span></span> <span data-ttu-id="e129b-158">Для мультитенатных приложений с большим количеством клиентов, как правило, необходимо автоматизировать этот процесс, включив возможность самостоятельной подготовки.</span><span class="sxs-lookup"><span data-stu-id="e129b-158">For multitenant applications with a large number of tenants, it is usually necessary to automate this process by enabling self-service provisioning.</span></span>

* <span data-ttu-id="e129b-159">Рабочие роли позволяют подготовить и отменить подготовку ресурсов для каждого клиента (например, при регистрации или отмене регистрации клиентов), собирать показатели для использования этих данных, а также управлять масштабированием по определенному расписанию или в ответ на пересечение порогового значения или ключевого показателя производительности.</span><span class="sxs-lookup"><span data-stu-id="e129b-159">Worker roles allow you to provision and de-provision per tenant resources (such as when a new tenant signs-up or cancels), collect metrics for metering use, and manage scale following a certain schedule or in response to the crossing of thresholds of key performance indicators.</span></span> <span data-ttu-id="e129b-160">Эта же роль может использоваться для передачи обновлений и модернизаций в решение.</span><span class="sxs-lookup"><span data-stu-id="e129b-160">This same role may also be used to push out updates and upgrades to the solution.</span></span>
* <span data-ttu-id="e129b-161">BLOB-объекты Azure могут использоваться для подготовки вычислительных ресурсов или предварительно инициализированных ресурсов хранения для новых клиентов, обеспечивая при этом политики доступа на уровне контейнера для защиты пакетов, VHD-образов и других ресурсов вычислительных служб.</span><span class="sxs-lookup"><span data-stu-id="e129b-161">Azure Blobs can be used to provision compute or pre-initialized storage resources for new tenants while providing container level access policies to protect the compute service Packages, VHD images and other resources.</span></span>
* <span data-ttu-id="e129b-162">Возможности подготовки ресурсов баз данных SQL для клиентов включают следующие:</span><span class="sxs-lookup"><span data-stu-id="e129b-162">Options for provisioning SQL Database resources for a tenant include:</span></span>
  
  * <span data-ttu-id="e129b-163">DDL в сценариях или в виде встроенных ресурсов в сборках</span><span class="sxs-lookup"><span data-stu-id="e129b-163">DDL in scripts or embedded as resources within assemblies</span></span>
  * <span data-ttu-id="e129b-164">Пакеты SQL Server 2008 R2, развернутые программными средствами.</span><span class="sxs-lookup"><span data-stu-id="e129b-164">SQL Server 2008 R2 DAC Packages deployed programmatically.</span></span>
  * <span data-ttu-id="e129b-165">Копирование из главной справочной базы данных</span><span class="sxs-lookup"><span data-stu-id="e129b-165">Copying from a master reference database</span></span>
  * <span data-ttu-id="e129b-166">Использование импорта и экспорта базы данных для подготовки новых баз данных из файла.</span><span class="sxs-lookup"><span data-stu-id="e129b-166">Using database Import and Export to provision new databases from a file.</span></span>

<!--links-->

[Hosting a Multi-Tenant Application on Azure]: http://msdn.microsoft.com/library/hh534480.aspx
[Designing Multitenant Applications on Azure]: http://msdn.microsoft.com/library/windowsazure/hh689716
