---
title: "Предварительная версия Azure Event Hubs Role-Based управления доступом (RBAC) | Документы Microsoft"
description: "Управление доступом на основе ролей концентраторов событий Azure"
services: event-hubs
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 
ms.service: event-hubs
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 12/19/2017
ms.author: sethm
ms.openlocfilehash: 0d3a779eb2cccf242bcd42d82c1a90048b3512ab
ms.sourcegitcommit: f46cbcff710f590aebe437c6dd459452ddf0af09
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/20/2017
---
# <a name="active-directory-role-based-access-control-preview"></a>Управление доступом Active Directory Role-Based (Предварительная версия)

Microsoft Azure предоставляет Управление интегрированной доступом к ресурсам и приложениям на базе Azure Active Directory (Azure AD). С помощью Azure AD можно управление учетными записями пользователей и приложений на основе приложений специально для Azure, или можно создать федерацию существующую инфраструктуру Active Directory с Azure AD для всей компании-единого входа, который также охватывает ресурсы Azure и Azure доступ к приложениям. Затем можно назначить эти удостоверения пользователя и приложения Azure AD глобальный, так и конкретных служб ролей для предоставления доступа к ресурсам Azure.

Для концентраторов событий Azure, управление пространств имен и все связанные ресурсы через портал Azure и API управления Azure ресурсов уже защищен с помощью *управления доступом на основе ролей* модели (RBAC). RBAC для операций среды выполнения теперь является компонентом в общедоступной предварительной версии. 

Приложение, использующее Azure AD RBAC не нужно обрабатывать правила SAS и ключи или любые другие маркеры доступа для концентраторов событий. Клиентское приложение взаимодействует с Azure AD, чтобы установить контекст проверки подлинности и получает маркер доступа для концентраторов событий. С учетными записями пользователей домена, требующие интерактивный вход в систему приложение никогда не обрабатывает любые учетные данные напрямую.

## <a name="event-hubs-roles-and-permissions"></a>Роли концентраторов событий и разрешения

Начальной общедоступной предварительной версии можно только добавить учетные записи Azure AD и субъекты-службы роли «Владелец» или «Участник» пространства имен концентраторов событий. Эта операция предоставляет удостоверение полный контроль над все сущности в пространстве имен. Операции управления, изменение топологии пространства имен, изначально являются только поддерживаемые управление ресурсами, однако Azure, а не через интерфейс управления REST концентраторов событий в машинном коде. Эта поддержка также означает, что клиент .NET Framework [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) объект не может использоваться с учетной записью Azure AD.  

## <a name="use-event-hubs-with-an-azure-ad-domain-user-account"></a>Использование концентраторов событий с учетной записи пользователя домена в Azure AD

В следующем разделе описаны шаги, необходимые для создания и запуска примеров приложений, которые запрашиваются Azure интерактивного пользователя AD, чтобы войти в систему, как предоставить доступ концентраторов событий с учетной записью пользователя и как использовать его для доступа к концентраторов событий. 

Это введение описывает простое консольное приложение, [код, для которого находится на Github](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/Rbac/EventHubsSenderReceiverRbac/)

### <a name="create-an-active-directory-user-account"></a>Создание учетной записи пользователя в Active Directory

Это первый шаг является необязательным. Каждая подписка Azure автоматически связан с клиентом Azure Active Directory, и если имеется доступ к подписке Azure, ваша учетная запись пользователя уже зарегистрирован. Это означает, что позволяет использовать учетную запись. 

Если вы по-прежнему хотите создать учетную запись для этого сценария [выполните следующие действия](../automation/automation-create-aduser-account.md). Необходимо иметь разрешение на создание учетных записей в клиенте Azure Active Directory, который не может иметь место для больших корпоративных сценариев.

### <a name="create-an-event-hubs-namespace"></a>Создание пространства имен концентраторов событий

Далее, [создать пространство имен концентраторов событий](event-hubs-create.md) в одном из регионов Azure с поддержкой предварительной версии концентраторов событий RBAC: **Востоке**, **Восток 2**, или **Западная Европа** . 

После создания пространства имен, перейдите к его **управления доступа (IAM)** на портале и нажмите кнопку **добавить** для добавления учетной записи пользователя Azure AD для роли владельца. Если вы используете собственную учетную запись пользователя, и вы создали пространство имен, уже принадлежат роли-владельца. Чтобы добавить другую учетную запись в роль, найдите имя веб-приложения в **добавить разрешения** панель **выберите** , а затем щелкните запись. Нажмите кнопку **Сохранить**.
 
![](./media/event-hubs-role-based-access-control/rbac1.PNG)

Теперь учетная запись имеет доступ к пространству имен концентраторов событий и в концентратор событий созданного ранее.
 
### <a name="register-the-application"></a>Регистрация приложения

Перед запуском образца приложения, зарегистрируйте его в Azure AD и утвердить запрос согласия, позволяющий приложению доступ к концентраторам событий от его имени. 

Поскольку образец приложения представляет собой консольное приложение, необходимо зарегистрировать собственного приложения и добавить разрешения на API для **Microsoft.EventHub** набор «необходимые разрешения». Собственного приложения также должны **URI перенаправления** в Azure AD, который служит идентификатором; URI не должны получить назначения сети. Используйте `http://eventhubs.microsoft.com` для этого примера, поскольку образца кода уже использует этот URI.

Описываются действия по регистрации подробные [этого учебника](../active-directory/develop/active-directory-integrating-applications.md). Выполните действия по регистрации **собственного** приложения и выполните инструкции по обновлению, чтобы добавить **Microsoft.EventHub** API для необходимых разрешений. Как вы выполните действия, запишите **TenantId** и **ApplicationId**, как вам потребуются эти значения для запуска приложения.

### <a name="run-the-app"></a>Запуск приложения

Перед запуском образца, измените файл App.config и в зависимости от вашего сценария установите следующие значения:

- `tenantId`: Значение **TenantId** значение.
- `clientId`: Значение **ApplicationId** значение. 
- `clientSecret`: Если вы хотите войти в систему с помощью секрет клиента, создайте его в Azure AD. Кроме того используйте веб-приложения или API вместо собственного приложения. Кроме того, добавьте тестируемое приложение **управления доступа (IAM)** в пространстве имен, созданный ранее.
- `eventHubNamespaceFQDN`: Укажите полное DNS-имя пространства имен только что созданный концентраторов событий; например `example.servicebus.windows.net`.
- `eventHubName`: Установите для имени концентратора событий, который вы создали.
- URI перенаправления, указанный в приложении в предыдущих шагах.
 
При запуске консольного приложения будет предложено выбрать сценарий; Нажмите кнопку **интерактивного входа в систему пользователя** введите номер его и нажмите клавишу ВВОД. Приложение отображает окно входа в систему, запрашивает ваше согласие на доступ к концентраторам событий и затем использует для запуска сценария отправки и получения, с помощью идентификатора имени входа с помощью службы.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о концентраторах событий см. по следующим ссылкам:

* Начните работу с [руководства по концентраторам событий](event-hubs-dotnet-standard-getstarted-send.md)
* [Часто задаваемые вопросы о концентраторах событий](event-hubs-faq.md)
* [Сведения о ценах на концентраторы событий](https://azure.microsoft.com/pricing/details/event-hubs/)
* [Примеры приложений, использующие концентраторы событий](https://github.com/Azure/azure-event-hubs/tree/master/samples)