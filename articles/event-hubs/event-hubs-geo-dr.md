---
title: "Географическое аварийное восстановление в концентраторах событий Azure | Документация Майкрософт"
description: "Способы использования географических регионов для отработки отказа и аварийного восстановления в концентраторах событий Azure"
services: event-hubs
documentationcenter: 
author: sethmanheim
manager: timlt
editor: 
ms.service: event-hubs
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/15/2017
ms.author: sethm
ms.openlocfilehash: 237b0639be75e12cff56f40ac76426aba7a8a701
ms.sourcegitcommit: 821b6306aab244d2feacbd722f60d99881e9d2a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/16/2017
---
# <a name="azure-event-hubs-geo-disaster-recovery"></a>Azure концентраторов событий Geo аварийного восстановления

Если весь регионах Azure или центры обработки данных (если не [доступности зоны](../availability-zones/az-overview.md) используются) избежать простоя, крайне важно для обработки данных продолжить работать и в другом регионе и центре обработки данных. Таким образом *географическое аварийное восстановление* и *георепликация* являются важными функциями для любого предприятия. Концентраторы событий Azure поддерживают географическое аварийное восстановления и георепликацию на уровне пространства имен. 

Функция Geo аварийного восстановления глобально доступной для номера SKU Standard концентраторов событий.

## <a name="outages-and-disasters"></a>Сбои и аварийные ситуации

Важно отметить различия между «сбои в работе» и «бедствия.» *Сбоя* Временная недоступность концентраторов событий Azure и может повлиять на некоторые компоненты службы, такие как хранилища сообщений или даже весь центр обработки данных. Однако после исправления проблемы концентраторов событий снова становится доступной. Как правило, простой не приводит к утрате сообщений или других данных. Примером такого сбоя может быть сбой питания в центре обработки данных. Некоторые сбои являются только короткие подключения убытки из-за временной или сетевых проблем. 

Объект *аварийного* определяется как потеря постоянных и долговременного концентраторов событий кластера, регион Azure или центра обработки данных. Регион или центра обработки данных может не будут доступны еще раз или может простаивать в течение часов или дней. Примеры аварий — пожар, наводнение или землетрясение. Сбой, который становится постоянной может привести к потере некоторые сообщения, события или другие данные. Но в большинстве случаев потеря данных не происходит и сообщения можно восстановить сразу же после резервного копирования в центре обработки данных.

Функция восстановления после сбоя Geo концентраторов событий Azure является решение аварийного восстановления. Основные понятия и рабочий процесс, описанные в этой статье, относятся к сценариям восстановления после аварий, но не временных сбоев. Дополнительные сведения об аварийном восстановлении в Microsoft Azure см. в статье [Аварийное восстановление для приложений на платформе Azure](/azure/architecture/resiliency/disaster-recovery-azure-applications).

## <a name="basic-concepts-and-terms"></a>Основные понятия и термины

Функции аварийного восстановления реализует метаданных аварийного восстановления и зависит от пространства имен первичных и вторичных аварийного восстановления. Обратите внимание, что функция Geo аварийного восстановления для [стандартном номере SKU](https://azure.microsoft.com/pricing/details/event-hubs/) только. Вам не нужно изменять какие-либо строки подключения, так как соединение выполняется через псевдоним.

В этом руководстве используются термины, представленные ниже.

-  *Псевдоним*: имя для конфигурации аварийного восстановления, которую вы настроили. Псевдоним предоставляет единую стабильную строку подключения полного доменного имени (FQDN). Приложения используют ее для подключения к пространству имен. 

-  *Пространство имен первичный или вторичный*: пространств имен, которые соответствуют псевдоним. Основное пространство имен «активно» и получает сообщения (это может быть существующего или нового пространства имен). Дополнительное пространство имен «пассивный» и не получает сообщения. Метаданные между открывающими синхронизированы, так как можно легко принимать сообщения без изменений строки кода или соединения приложения. Чтобы убедиться, что только активное пространство имен получает сообщения, необходимо использовать псевдоним. 

-  *Метаданные*: сущности, такие как концентраторы событий и групп потребителей и их свойства службы, связанные с пространством имен. Обратите внимание, что автоматически реплицируются только сущностей и их параметры. Сообщения и события, не реплицируются. 

-  *Отработка отказа*: процесс активации дополнительного пространства имен.

## <a name="setup-and-failover-flow"></a>Поток, настройки и отработки отказа

В следующем разделе приведен обзор процесса отработки отказа и объясняется, как настроить начальные отработку отказа. 

![1][]

### <a name="setup"></a>Настройка

Можно сначала создать или использовать существующий основного пространства имен и нового дополнительного пространства имен, а затем связать два. Это связывание предоставит псевдоним, который можно использовать для подключения. Так как используется псевдоним, нет необходимости изменять строки подключения. Только новые пространства имен могут быть добавлены к вашему связыванию. Наконец следует добавить некоторыми функциями мониторинга, чтобы определить, является ли необходимые отработки отказа. В большинстве случаев служба входит в состав экосистемы больших, таким образом редко, возможно, автоматический переход на другой ресурс, очень часто переход на другой ресурс выполняется в соответствии с оставшиеся подсистемы или инфраструктуры.

### <a name="example"></a>Пример

Примером такого сценария рассмотрите решение точки продажи (POS), создает сообщения или события. Концентраторы событий передает эти события некоторые сопоставления или переформатировании решение, которое затем перенаправляет сопоставленные данные в другую систему для дальнейшей обработки. В этот момент все эти системы могут размещаться в том же регионе Azure. Решение, когда и какие части переход на другой ресурс зависит от потока данных в вашей инфраструктуре. 

Можно автоматизировать переход на другой ресурс с контроль различных систем, или пользовательские решений для мониторинга. Однако такие автоматизации занимает дополнительное планирование и работы, которая выходит за рамки данной статьи.

### <a name="failover-flow"></a>Поток отработки отказа

Если запустить отработку отказа, необходимы два шага:

1. Если возникает другой сбой, необходимо иметь возможность перехода на другой ресурс снова. Таким образом Настройка другой пассивный пространства имен и обновление сопряжение. 

2. Извлекать сообщения из бывшей основного пространства имен, как только она снова станет доступной. После этого использовать это пространство имен для регулярного обмена сообщениями вне настройку geo восстановления или удаления старого основного пространства имен.

> [!NOTE]
> Поддерживается семантика сбоя вперед. В этом случае при сбое и повторно связать с новым пространством имен. Не поддерживается сбоя; Например в кластере SQL. 

![2][]

## <a name="management"></a>управления

Если ошибки; Например связан неправильный области во время начальной настройки, можно прервать связывания двух пространств имен в любое время. Если вы хотите использовать сопряженные пространства имен в качестве регулярного пространства имен, удалите псевдоним.

## <a name="samples"></a>Примеры

[На GitHub](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/GeoDRClient) показано, как установить и инициировать отработку отказа. В этом примере показано выполнение следующих задач:

- Параметры, необходимые в Azure Active Directory для использования диспетчера ресурсов Azure с концентраторами событий. 
- Шаги, необходимые для выполнения образца кода. 
- Отправка и получение из текущего основного пространства имен. 

## <a name="considerations"></a>Рекомендации

Обратите внимание на следующие аспекты, необходимо иметь в виду, в этом выпуске:

1. При планировании отработки отказа, следует также учитывать фактором времени. Например при утере подключения к более 15 – 20 минут, можно начать отработку отказа. 
 
2. Тот факт, что данные не реплицируются означает, что в настоящее время активных сеансов не реплицируются. Кроме того обнаружение дубликатов и запланированные сообщения будут недоступны. Новые сеансы, запланированные сообщения и новые дубликаты будут работать. 

3. Должно быть отработки отказа сложной инфраструктуры распределенных [записанные](/azure/architecture/resiliency/disaster-recovery-azure-applications#disaster-simulation) по крайней мере один раз. 

4. Синхронизация сущностей может занять некоторое время примерно на 50 – 100 сущностей в минуту.

## <a name="next-steps"></a>Дальнейшие действия

* В разделе с [примером на сайте GitHub](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/GeoDRClient) рассматривается простой рабочий процесс, который создает геосвязь и инициирует отработку отказа для сценария аварийного восстановления.
* В [справочнике для REST API](/rest/api/eventhub/disasterrecoveryconfigs) описываются программные интерфейсы, позволяющие настроить географическое аварийное восстановление.

Дополнительные сведения о концентраторах событий см. по следующим ссылкам:

* Начните работу с [руководства по концентраторам событий](event-hubs-dotnet-standard-getstarted-send.md)
* [Часто задаваемые вопросы о концентраторах событий](event-hubs-faq.md)
* [Примеры приложений, использующие концентраторы событий](https://github.com/Azure/azure-event-hubs/tree/master/samples)

[1]: ./media/event-hubs-geo-dr/geo1.png
[2]: ./media/event-hubs-geo-dr/geo2.png