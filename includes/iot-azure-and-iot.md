
# <a name="azure-and-internet-of-things"></a>Azure и "Интернет вещей"

Добро пожаловать в Microsoft Azure и "Интернет вещей" (IoT). В этой статье рассматривается архитектура решения IoT, описывающая общие характеристики решения IoT, которое можно развернуть с помощью служб Azure. Решения Интернета вещей требуют наличия безопасной двусторонней связи между устройствами, количество которых может исчисляться миллионами, а также серверной части решения. Например, серверная часть решения может использовать прогнозную аналитику для анализа данных в потоке событий между устройством и облаком.

Центр Интернета вещей Azure — ключевой стандартный блок при реализации этой архитектуры решения Интернета вещей с помощью служб Azure. Набор IoT Suite предоставляет полную завершенную реализацию этой архитектуры для определенных сценариев, связанных с Интернетом вещей. Например:

* Решение для *удаленного мониторинга* позволяет отслеживать состояние таких устройств, как торговые автоматы.
* Решение для *прогнозного обслуживания* позволяет прогнозировать время обслуживания таких устройств, как насосы на удаленных насосных станциях, и избегать незапланированных сбоев.
* Решение для *подключенной фабрики* позволяет выполнять подключение и мониторинг промышленных устройств.

## <a name="iot-solution-architecture"></a>Архитектура решения IoT

На приведенной ниже схеме показана архитектура типичного решения IoT. Она не содержит имен определенных служб Azure, а описывает ключевые элементы в архитектуре обобщенного решения Интернета вещей. В этой архитектуре устройства Интернета вещей собирают данные, которые они отправляют в облачный шлюз. Облачный шлюз делает данные доступными для обработки другими службами серверной части. Данные из серверной части предоставляются другим бизнес-приложениям или операторам через панель мониторинга или другое устройство для представления данных.

![Архитектура решения IoT][img-solution-architecture]

> [!NOTE]
> Подробное рассмотрение архитектуры Центра Интернета вещей см. в документе [Microsoft Azure IoT Reference Architecture][lnk-refarch] (Эталонная архитектура Microsoft Azure IoT).

### <a name="device-connectivity"></a>Взаимодействие устройств

В этой архитектуре решения IoT устройства отправляют данные телеметрии, например показания датчика с насосной станции, на конечную точку облака для хранения и обработки. В сценарии прогнозирования обслуживания серверная часть решения может использовать поток данных от датчика, чтобы определить время обслуживания конкретного насоса. Устройства также могут принимать сообщения, передаваемые из облака на устройство, и отвечать на них путем считывания сообщений из конечной точки облака. Например, в сценарии прогнозирования обслуживания серверная часть решения может отправлять сообщения другим насосам на станции, чтобы перенаправлять потоки непосредственно перед началом обслуживания. Благодаря этому инженер технической поддержки может приступать к работе сразу после прибытия на станцию.

Одной из крупнейших задач, стоящих перед проектами IoT, является обеспечение надежного и безопасного подключения устройств к серверной части решения. Характеристики устройств IoT отличаются от характеристик других клиентов, таких как браузеры и мобильные приложения. Устройства IoT:

* часто представляют собой встраиваемые системы, у которых отсутствует оператор;
* могут развертываться в удаленных расположениях, где физический доступ дорогой;
* могут быть доступны только через серверную часть решения; другого способа взаимодействия с устройством нет.
* могут иметь ограниченную мощность и (или) объем ресурсов для обработки;
* могут иметь временное, медленное или дорогостоящее подключение к сети;
* могут требовать использования закрытых, пользовательских или отраслевых протоколов приложения;
* могут создаваться с помощью большого числа популярных аппаратных и программных платформ.

В дополнение к изложенным выше требованиям любое решение IoT также должно быть масштабируемым, безопасным и надежным. В итоге формируется набор требований к подключению, выполнить которые с помощью традиционных технологий, таких как веб-контейнеры и брокеры сообщений, очень трудно. Центр Интернета вещей Azure и пакеты SDK для устройств Azure IoT облегчают реализацию решений, соответствующих этим требованиям.

Устройство может установить связь непосредственно с конечной точкой облачного шлюза или, если устройство не может использовать протоколы связи, поддерживаемые облачным шлюзом, подключаться через промежуточный шлюз. Например, [шлюз протокола Центра Интернета вещей][lnk-protocol-gateway] может преобразовывать протоколы, если устройства не могут использовать протоколы, поддерживаемые Центром Интернета вещей.

### <a name="data-processing-and-analytics"></a>Обработка данных и аналитика

Большая часть обработки данных в серверной части решения Интернета вещей происходит в облаке. В частности, там выполняются фильтрация и статистическая обработка данных телеметрии и их маршрутизация к другим службам. Серверная часть решения IoT:

* Принимает данные телеметрии в необходимом объеме с устройств и определяет способ обработки и хранения полученных данных. 
* В некоторых случаях позволяет передавать команды из облака на определенное устройство.
* Предоставляет возможность регистрации устройств в решении IoT, позволяющей подготавливать их к работе и управлять доступом устройств к инфраструктуре.
* Позволяет отслеживать состояние устройств и отслеживать выполняемые ими операции.

В сценарии прогнозирования обслуживания серверная часть решения хранит данные журнала телеметрии, которые используются для определения шаблонов, указывающих на необходимость обслуживания конкретного насоса.

Решения IoT могут включать в себя циклы автоматической обратной связи. Например, на основе данных телеметрии модуль аналитики в серверной части решения может выявить, что температура определенного устройства выше нормального рабочего уровня, после чего решение может отправить на это устройство команду для выполнения корректирующих действий.

### <a name="presentation-and-business-connectivity"></a>Представление и бизнес-подключение

Уровень представления и бизнес-подключения позволяет конечным пользователям взаимодействовать с решением IoT и устройствами. Это дает пользователям возможность просматривать и анализировать данные, собираемые с их устройств. Эти представления могут принимать форму панелей мониторинга и отчетов бизнес-аналитики, которые могут отображаться как данные журнала или данные в режиме реального времени. Например, оператор может проверить состояние конкретной насосной станции и увидеть все предупреждения, созданные системой. Этот уровень также обеспечивает интеграцию серверной части решения IoT с существующими бизнес-приложениями для привязки к корпоративным бизнес-процессам или рабочим процессам. Например, решение прогнозного обслуживания может интегрироваться с системой планирования, резервирующей инженера, который должен посетить насосную станцию, когда решение определит, что насос нуждается в обслуживании.

![Панель мониторинга решения IoT][img-dashboard]

[img-solution-architecture]: ./media/iot-azure-and-iot/iot-reference-architecture.png
[img-dashboard]: ./media/iot-azure-and-iot/iot-suite.png

[lnk-machinelearning]: http://azure.microsoft.com/documentation/services/machine-learning/
[Azure IoT Suite]: http://azure.microsoft.com/solutions/iot
[lnk-protocol-gateway]:  ../articles/iot-hub/iot-hub-protocol-gateway.md
[lnk-refarch]: http://download.microsoft.com/download/A/4/D/A4DAD253-BC21-41D3-B9D9-87D2AE6F0719/Microsoft_Azure_IoT_Reference_Architecture.pdf
