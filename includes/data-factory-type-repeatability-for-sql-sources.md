## <a name="repeatability-during-copy"></a>Повторяемость во время копирования
При копирование tooAzure данных SQL и SQL Server на основе других данных хранит один повторяемость tookeep потребности в виду tooavoid непредвиденные результаты. 

При копировании данных tooAzure базы данных SQL и SQL Server, действие копирования будет по умолчанию APPEND hello набора данных toohello приемник таблицы по умолчанию. Например при копировании данных из исходного файла CSV (данные значения с разделителями-запятыми), содержащий два записывает tooAzure базы данных SQL и SQL Server, это выглядит как hello таблиц:

```
ID    Product        Quantity    ModifiedDate
...    ...            ...            ...
6    Flat Washer    3            2015-05-01 00:00:00
7     Down Tube    2            2015-05-01 00:00:00
```

Предположим, что обнаружены ошибки в исходном файле и обновленные hello количество для работы с 2 too4 в исходном файле hello. При повторном запуске hello срез данных для этого периода, вы найдете две новые записи добавляются tooAzure базы данных SQL и SQL Server. Hello ниже предполагается, что hello столбцов в таблице hello не имеют hello первичного ключа.

```
ID    Product        Quantity    ModifiedDate
...    ...            ...            ...
6    Flat Washer    3            2015-05-01 00:00:00
7     Down Tube    2            2015-05-01 00:00:00
6    Flat Washer    3            2015-05-01 00:00:00
7     Down Tube    4            2015-05-01 00:00:00
```

tooavoid это, вам потребуется toospecify семантику вставки-обновления, используя один из hello ниже 2 механизмы, указанной ниже.

> [!NOTE]
> Срез можно повторно выполняться автоматически в фабрике данных Azure согласно заданной политике hello повторных попыток.
> 
> 

### <a name="mechanism-1"></a>Механизм 1
Можно использовать **sqlWriterCleanupScript** toofirst свойство Действие очистки при выполнении среза. 

```json
"sink":  
{ 
  "type": "SqlSink", 
  "sqlWriterCleanupScript": "$$Text.Format('DELETE FROM table WHERE ModifiedDate >= \\'{0:yyyy-MM-dd HH:mm}\\' AND ModifiedDate < \\'{1:yyyy-MM-dd HH:mm}\\'', WindowStart, WindowEnd)"
}
```

Hello скрипт очистки будет выполняться первой во время копирования для данного фрагмента, которой будет удалять данные hello из соответствующего среза toothat hello таблицы SQL. Действие Hello впоследствии будет вставлять данные hello в hello таблицы SQL. 

Если срез hello сейчас запустить повторно, то можно будет видеть, что количество hello обновляется как правильно.

```
ID    Product        Quantity    ModifiedDate
...    ...            ...            ...
6    Flat Washer    3            2015-05-01 00:00:00
7     Down Tube    4            2015-05-01 00:00:00
```

Предположим, что hello плоский Шайба запись удаляется из исходной csv hello. Затем повторным запуском срез hello приведет к получению hello следующий результат: 

```
ID    Product        Quantity    ModifiedDate
...    ...            ...            ...
7     Down Tube    4            2015-05-01 00:00:00
```
Ничего нового было сделано toobe. Действие копирования Hello выполнялись hello очистки сценария toodelete hello соответствующих данных для этого среза. Затем он считывают hello входные данные из CSV-файла hello (которое затем содержит всего одну запись) и вставлены hello таблицы. 

### <a name="mechanism-2"></a>Механизм 2
> [!IMPORTANT]
> В настоящее время sliceIdentifierColumnName не поддерживается для хранилища данных Azure SQL. 

Другой механизм tooachieve повторяемость является выделенный столбец (**sliceIdentifierColumnName**) в hello целевая таблица. Этот столбец будет использоваться фабрики данных Azure tooensure hello источника и назначения Оставайтесь синхронизированы. Такой подход работает, когда гибкие возможности изменения или определение схемы таблицы SQL hello назначения. 

Этот столбец будет использоваться фабрики данных Azure в целях обеспечения и в процессе hello фабрики данных Azure не будет выполнять любую схему изменяет toohello таблицы. Способ toouse этот подход:

1. Задать столбец двоичного типа (32) на целевом экземпляре hello таблицы SQL. Для этого столбца не должно быть никаких ограничений. Давайте в данном примере назовем столбец ColumnForADFuseOnly.
2. Используйте его в действие hello копирования следующим образом:
   
    ```json
    "sink":  
    { 
   
        "type": "SqlSink", 
        "sliceIdentifierColumnName": "ColumnForADFuseOnly"
    }
    ```

Фабрика данных Azure заполнит этот столбец согласно необходимости tooensure hello источника и назначения сохранить синхронизацию. Hello значения этого столбца не используется за пределами этого контекста пользователя hello. 

Аналогичные toomechanism 1, действие копирования будет автоматически первой очистки данных hello для hello даны срез hello целевой таблицы SQL и запустите действие копирования hello обычно tooinsert hello данные из источника toodestination для этого среза. 

