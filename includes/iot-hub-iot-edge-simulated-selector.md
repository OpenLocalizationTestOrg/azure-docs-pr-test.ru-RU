> [!div class="op_single_selector"]
> * [Linux](../articles/iot-hub/iot-hub-linux-iot-edge-simulated-device.md)
> * [Windows](../articles/iot-hub/iot-hub-windows-iot-edge-simulated-device.md)

В данном пошаговом руководстве для hello [имитации устройства облака отправить образец] показано, как toouse [Azure IoT Edge] [ lnk-sdk] tooIoT toosend устройства в облако телеметрии концентратора из смоделированной устройства.

В этом руководстве рассматриваются следующие темы.

* **Архитектура**: сведения об hello [имитации устройства облака отправить образец].
* **Построение и запуск**: пример hello выполнения и toobuild необходимые шаги hello.

## <a name="architecture"></a>Архитектура

Hello [имитации устройства облака отправить образец] показано, как шлюз, который отправляет данные телеметрии из toocreate имитируемые центра IoT tooan устройств. Устройство не может быть tooconnect может напрямую tooIoT концентратора поскольку hello устройства:

* не использует протокол связи, поддерживаемый Центром Интернета вещей;
* Не является достаточно широкими tooremember tooit идентификаторов назначен hello в IoT Hub.

IoT шлюз позволяет решить эти проблемы в hello следующих способов:

* шлюз Hello понимает hello протокол, используемый устройством hello, получает телеметрии устройства в облако с устройства hello и передает эти сообщения tooIoT протоколу воспринимает hello центра IoT Hub.

* шлюз Hello сопоставляет идентификаторы toodevices центр IoT и действует как прокси-сервер, когда устройство отправляет сообщения tooIoT концентратора.

Hello, следующая схема показывает Здравствуйте основные компоненты образца hello, включая hello IoT Edge модули:

![][1]

модули Hello не следует передавать сообщения непосредственно tooeach других. модули Hello публикации сообщений tooan внутреннего компонента broker, обеспечивающая toohello сообщений hello другие модули, используя механизм подписки. Дополнительные сведения см. в статье [Explore Azure IoT Edge architecture on Linux][lnk-gw-getstarted] (Обзор архитектуры Edge Интернета вещей в Linux).

### <a name="protocol-ingestion-module"></a>Модуль получения протокола

Этот модуль является начальной точкой для получения данных с устройств, через шлюз hello и в облаке hello hello. В образце hello hello модуля:

1. моделирует данные температуры При использовании физических устройств hello модуль считывает данные из этих физических устройств.
1. создает сообщение;
1. В содержимое сообщения hello помещает hello имитируемые температур.
1. Добавляет свойство с поддельное toohello сообщение MAC-адрес.
1. Делает hello сообщения доступны toohello следующий модуль в цепочке hello.

Hello модуль с именем **X протокол приема** в hello называется предыдущей диаграмме **Имитированное устройство** в исходном коде hello.

### <a name="mac-lt-gt-iot-hub-id-module"></a>MAC &lt;-&gt; Модуль идентификатора центра Интернета вещей

Этот модуль проверяет сообщения, которые содержат свойства MAC-адреса. В образце hello hello протокол приема модуль добавляет свойство адрес MAC hello. Обнаружив такое свойство hello модуля он добавляет другое свойство с сообщением ключа toohello устройства центра IoT. модуль Hello делает hello сообщения доступны toohello следующий модуль в цепочке hello.

developer Привет устанавливает соответствие между MAC-адреса и центр IoT удостоверения tooassociate hello имитируемые устройства с удостоверениями устройства центра IoT. Hello разработчик добавляет сопоставление hello вручную как часть конфигурации модуля hello.

> [!NOTE]
> В этом примере MAC-адрес используется как уникальный идентификатор устройства и сопоставляет его с удостоверением устройства в центре IoT. В то же время вы можете написать собственный модуль, где будет использоваться другой уникальный идентификатор. Например устройства могут иметь уникальные серийные номера или данные телеметрии hello могут включать имя уникальным встроенное устройство.

### <a name="iot-hub-communication-module"></a>Модуль связи центра IoT

Этот модуль принимает сообщения с центра IoT ключевого свойства устройства от предыдущего модуля hello. модуль Hello отправляет сообщение hello содержимого tooIoT концентратора с помощью протокола HTTP "hello". HTTP является одним из hello понятны трех протоколов в IoT Hub.

Вместо открытия соединения для каждого устройства имитации, этот модуль открывает одиночное соединение HTTP из центра IoT toohello hello шлюза. Затем модуль Hello multiplexes подключения от всех устройств hello имитировать через это подключение. Такой подход позволяет tooconnect один шлюз другие устройства.

## <a name="before-you-get-started"></a>Необходимые условия

Перед началом работы необходимо выполнить следующие действия:

* [Создать центр IoT] [ lnk-create-hub] в вашей подписке Azure необходимо имя вашей toocomplete концентратора hello в данном пошаговом руководстве. Если у вас нет учетной записи, можно создать [бесплатную учетную запись][lnk-free-trial] всего за несколько минут.
* Добавьте два центра IoT tooyour устройств и запомните или запишите их идентификаторы и ключи устройства. Можно использовать hello [обозреватель устройств] [ lnk-device-explorer] или [explorer центром IOT] [ lnk-iothub-explorer] средства tooadd центр IoT toohello вашего устройства, вы создали в hello предыдущего шага и извлекать их ключей.

![][2]

<!-- Images -->
[1]: media/iot-hub-iot-edge-simulated-selector/image1.png
[2]: media/iot-hub-iot-edge-simulated-selector/image2.png

<!-- Links -->
[имитации устройства облака отправить образец]: https://github.com/Azure/iot-edge/blob/master/samples/simulated_device_cloud_upload/README.md
[lnk-sdk]: https://github.com/Azure/iot-edge
[lnk-gw-getstarted]: ../articles/iot-hub/iot-hub-linux-iot-edge-get-started.md
[lnk-free-trial]: https://azure.microsoft.com/pricing/free-trial/
[lnk-device-explorer]: https://github.com/Azure/azure-iot-sdk-csharp/tree/master/tools/DeviceExplorer
[lnk-iothub-explorer]: https://github.com/Azure/iothub-explorer/blob/master/readme.md
[lnk-create-hub]: ../articles/iot-hub/iot-hub-create-through-portal.md