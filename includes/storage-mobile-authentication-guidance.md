## <a name="configure-your-application-to-access-azure-storage"></a><span data-ttu-id="31f42-101">Настройка приложения для доступа к хранилищу Azure</span><span class="sxs-lookup"><span data-stu-id="31f42-101">Configure your application to access Azure Storage</span></span>
<span data-ttu-id="31f42-102">Существует два способа проверки подлинности приложения при получении доступа к службам хранения:</span><span class="sxs-lookup"><span data-stu-id="31f42-102">There are two ways to authenticate your application to access Storage services:</span></span>

* <span data-ttu-id="31f42-103">Общий ключ — следует использовать только для тестирования.</span><span class="sxs-lookup"><span data-stu-id="31f42-103">Shared Key: Use Shared Key for testing purposes only</span></span>
* <span data-ttu-id="31f42-104">Подписанный URL-адрес (SAS) — используется для рабочих приложений.</span><span class="sxs-lookup"><span data-stu-id="31f42-104">Shared Access Signature (SAS): Use SAS for production applications</span></span>

### <a name="shared-key"></a><span data-ttu-id="31f42-105">Общий ключ</span><span class="sxs-lookup"><span data-stu-id="31f42-105">Shared Key</span></span>
<span data-ttu-id="31f42-106">Проверка подлинности с помощью общего ключа означает, что приложение будет использовать имя и ключ учетной записи для доступа к службам хранилища.</span><span class="sxs-lookup"><span data-stu-id="31f42-106">Shared Key authentication means that your application will use your account name and account key to access Storage services.</span></span> <span data-ttu-id="31f42-107">Чтобы быстро показать, как использовать эту библиотеку, в данном руководстве по началу работы мы используем аутентификацию с общим ключом.</span><span class="sxs-lookup"><span data-stu-id="31f42-107">For the purposes of quickly showing how to use this library, we will be using Shared Key authentication in this getting started.</span></span>

> [!WARNING] 
> <span data-ttu-id="31f42-108">**Аутентификацию с общим ключом следует использовать только для тестирования!**</span><span class="sxs-lookup"><span data-stu-id="31f42-108">**Only use Shared Key authentication for testing purposes!**</span></span> <span data-ttu-id="31f42-109">Имя и ключ учетной записи, которые предоставляют полный доступ на чтение и запись к связанной учетной записи хранения, будут переданы каждому пользователю, который загружает ваше приложение.</span><span class="sxs-lookup"><span data-stu-id="31f42-109">Your account name and account key, which give full read/write access to the associated Storage account, will be distributed to every person that downloads your app.</span></span> <span data-ttu-id="31f42-110">Такой подход **не** рекомендуется ввиду возможности компрометации ключа ненадежными клиентами.</span><span class="sxs-lookup"><span data-stu-id="31f42-110">This is **not** a good practice as you risk having your key compromised by untrusted clients.</span></span>
> 
> 

<span data-ttu-id="31f42-111">При использовании аутентификации с общим ключом вам нужно создать [строку подключения](../articles/storage/common/storage-configure-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="31f42-111">When using Shared Key authentication, you will create a [connection string](../articles/storage/common/storage-configure-connection-string.md).</span></span> <span data-ttu-id="31f42-112">Строка подключения состоит из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="31f42-112">The connection string is comprised of:</span></span>  

* <span data-ttu-id="31f42-113">**DefaultEndpointsProtocol** — можно выбрать HTTP или HTTPS.</span><span class="sxs-lookup"><span data-stu-id="31f42-113">The **DefaultEndpointsProtocol** - you can choose HTTP or HTTPS.</span></span> <span data-ttu-id="31f42-114">Настоятельно рекомендуется использовать протокол HTTPS.</span><span class="sxs-lookup"><span data-stu-id="31f42-114">However, using HTTPS is highly recommended.</span></span>
* <span data-ttu-id="31f42-115">**AccountName** — имя вашей учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="31f42-115">The **Account Name** - the name of your storage account</span></span>
* <span data-ttu-id="31f42-116">**AccountKey** — чтобы получить это значение, на [портале Azure](https://portal.azure.com) перейдите к своей учетной записи хранения и щелкните значок **Ключи**.</span><span class="sxs-lookup"><span data-stu-id="31f42-116">The **Account Key** - On the [Azure Portal](https://portal.azure.com), navigate to your storage account and click the **Keys** icon to find this information.</span></span>
* <span data-ttu-id="31f42-117">(Необязательно) **EndpointSuffix** — это значение используется для служб хранилища в регионах с разными суффиксами конечных точек, например Azure China или Azure Governance.</span><span class="sxs-lookup"><span data-stu-id="31f42-117">(Optional) **EndpointSuffix** - This is used for storage services in regions with different endpoint suffixes, such as Azure China or Azure Governance.</span></span>

<span data-ttu-id="31f42-118">Ниже приведен пример строки подключения, использующей аутентификацию с общим ключом.</span><span class="sxs-lookup"><span data-stu-id="31f42-118">Here is an example of connection string using Shared Key authentication:</span></span>

`"DefaultEndpointsProtocol=https;AccountName=your_account_name_here;AccountKey=your_account_key_here"`

### <a name="shared-access-signatures-sas"></a><span data-ttu-id="31f42-119">Подписанный URL-адрес (SAS)</span><span class="sxs-lookup"><span data-stu-id="31f42-119">Shared Access Signatures (SAS)</span></span>
<span data-ttu-id="31f42-120">В мобильном приложении аутентифицировать запрос клиента к службе хранилища Azure рекомендуется с помощью подписанного URL-адреса (SAS).</span><span class="sxs-lookup"><span data-stu-id="31f42-120">For a mobile application, the recommended method for authenticating a request by a client against the Azure Storage service is by using a Shared Access Signature (SAS).</span></span> <span data-ttu-id="31f42-121">SAS позволяет предоставлять клиенту доступ к ресурсу на указанный период времени и с указанным набором разрешений.</span><span class="sxs-lookup"><span data-stu-id="31f42-121">SAS allows you to grant a client access to a resource for a specified period of time, with a specified set of permissions.</span></span>
<span data-ttu-id="31f42-122">В качестве владельца учетной записи хранения вам понадобится создать SAS для использования мобильными клиентами.</span><span class="sxs-lookup"><span data-stu-id="31f42-122">As the storage account owner, you'll need to generate a SAS for your mobile clients to consume.</span></span> <span data-ttu-id="31f42-123">Для этого вам, скорее всего, нужно будет написать отдельную службу, которая создаст SAS и распространит ее между клиентами.</span><span class="sxs-lookup"><span data-stu-id="31f42-123">To generate the SAS, you'll probably want to write a separate service that generates the SAS to be distributed to your clients.</span></span> <span data-ttu-id="31f42-124">Чтобы создать SAS в целях тестирования, можно использовать [Обозреватель службы хранилища Microsoft Azure](http://storageexplorer.com) или [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="31f42-124">For testing purposes, you can use the [Microsoft Azure Storage Explorer](http://storageexplorer.com) or the [Azure Portal](https://portal.azure.com) to generate a SAS.</span></span> <span data-ttu-id="31f42-125">При создании SAS можно указать не только интервал времени, в течение которого SAS будет действительным, но и разрешения, которые SAS предоставляет клиенту.</span><span class="sxs-lookup"><span data-stu-id="31f42-125">When you create the SAS, you can specify the time interval over which the SAS is valid, and the permissions that the SAS grants to the client.</span></span>

<span data-ttu-id="31f42-126">В приведенном ниже примере показано, как в целях тестирования использовать Microsoft Azure Storage Explorer, чтобы создать SAS.</span><span class="sxs-lookup"><span data-stu-id="31f42-126">The following example shows how to use the Microsoft Azure Storage Explorer to generate a SAS.</span></span>

1. <span data-ttu-id="31f42-127">Если это еще не сделано, [установите Microsoft Azure Storage Explorer](http://storageexplorer.com)</span><span class="sxs-lookup"><span data-stu-id="31f42-127">If you haven't already, [Install the Microsoft Azure Storage Explorer](http://storageexplorer.com)</span></span>
2. <span data-ttu-id="31f42-128">Подключитесь к своей подписке.</span><span class="sxs-lookup"><span data-stu-id="31f42-128">Connect to your subscription.</span></span>
3. <span data-ttu-id="31f42-129">Щелкните в свою учетную запись хранилища и перейдите на вкладку "Действия" в нижнем левом углу.</span><span class="sxs-lookup"><span data-stu-id="31f42-129">Click on your Storage account and click on the "Actions" tab at the bottom left.</span></span> <span data-ttu-id="31f42-130">Щелкните "Get Shared Access Signature" (Получить подписанный URL-адрес), чтобы создать строку подключения для SAS.</span><span class="sxs-lookup"><span data-stu-id="31f42-130">Click "Get Shared Access Signature" to generate a "connection string" for your SAS.</span></span>
4. <span data-ttu-id="31f42-131">Ниже приведен пример строки подключения SAS, которая предоставляет разрешения на чтение и запись на уровне службы, контейнера и объекта для службы BLOB-объектов учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="31f42-131">Here is an example of a SAS connection string that grants read and write permissions at the service, container and object level for the blob service of the Storage account.</span></span>
   
   `"SharedAccessSignature=sv=2015-04-05&ss=b&srt=sco&sp=rw&se=2016-07-21T18%3A00%3A00Z&sig=3ABdLOJZosCp0o491T%2BqZGKIhafF1nlM3MzESDDD3Gg%3D;BlobEndpoint=https://youraccount.blob.core.windows.net"`

<span data-ttu-id="31f42-132">Как видите, при использовании SAS в приложении вам не нужно предоставлять ключ учетной записи.</span><span class="sxs-lookup"><span data-stu-id="31f42-132">As you can see, when using a SAS, you’re not exposing your account key in your application.</span></span> <span data-ttu-id="31f42-133">Дополнительные сведения и рекомендации по использованию SAS см. в статье [о подписанных URL-адресах и общих сведениях о модели SAS](../articles/storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="31f42-133">You can learn more about SAS and best practices for using SAS by checking out [Shared Access Signatures: Understanding the SAS model](../articles/storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

