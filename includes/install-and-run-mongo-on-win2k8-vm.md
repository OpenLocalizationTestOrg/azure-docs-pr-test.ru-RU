Выполните следующие действия, чтобы установить и запустить MongoDB на виртуальной машине Windows Server.

> [!IMPORTANT]
> Функции безопасности MongoDB, такие как проверка подлинности и привязка IP-адреса, не включены по умолчанию. Функции безопасности необходимо включить перед развертыванием MongoDB в рабочей среде.  Дополнительные сведения см. в документе [Безопасность и проверка подлинности](http://www.mongodb.org/display/DOCS/Security+and+Authentication).
>
>

1. После подключения к виртуальной машине с помощью удаленного рабочего стола откройте Internet Explorer из меню **Пуск** на виртуальной машине.
2. Нажмите кнопку **Сервис** в правом верхнем углу.  В окне **Свойства браузера** выберите вкладку **Безопасность**, щелкните значок **Надежные сайты**, а затем нажмите кнопку **Сайты**. Добавьте *http://\*.mongodb.org* в список надежных сайтов.
3. Перейдите на страницу [центра загрузок MongoDB](https://www.mongodb.com/download-center#community).
4. Найдите **текущий стабильный выпуск** **сервера сообщества** и выберите последнюю **64-разрядную** версию в столбце Windows. Скачайте установщик MSI и запустите его.
5. Приложение MongoDB обычно устанавливается в папку C:\Program Files\MongoDB. Найдите переменные среды на компьютере и добавьте путь к двоичным файлам MongoDB в переменную PATH. Например, двоичные файлы могут находиться в папке C:\Program Files\MongoDB\Server\3.4\bin компьютера.
6. Создайте каталоги данных и журналов MongoDB на диске данных (например, на диске **F:**), созданном на предыдущих этапах. В меню **Пуск** выберите **Командная строка**, чтобы открыть окно командной строки.  Тип:

        C:\> F:
        F:\> mkdir \MongoData
        F:\> mkdir \MongoLogs
7. Чтобы запустить базу данных, введите:

        F:\> C:
        C:\> mongod --dbpath F:\MongoData\ --logpath F:\MongoLogs\mongolog.log

    Все сообщения журнала будут направляться в файл *F:\MongoLogs\mongolog.log*, когда сервер mongod.exe запустится и выделит место для файлов журналов. Может пройти несколько минут, пока MongoDB выделит место для файлов журналов и начнет прослушивать подключения. Фокус командной строки будет оставаться на этой задаче, пока выполняется экземпляр MongoDB.
8. Чтобы запустить консоль управления MongoDB, откройте еще одно окно командной строки из меню **Пуск** и введите следующие команды:

        C:\> cd \my_mongo_dir\bin  
        C:\my_mongo_dir\bin> mongo  
        >db  
        test
        > db.foo.insert( { a : 1 } )  
        > db.foo.find()  
        { _id : ..., a : 1 }  
        > show dbs  
        ...  
        > show collections  
        ...  
        > help  

    База данных создается путем вставки.
9. Кроме того, можно установить файл mongod.exe в качестве службы.

        C:\> mongod --dbpath F:\MongoData\ --logpath F:\MongoLogs\mongolog.log --logappend  --install

    В этом случае будет установлена служба с именем MongoDB и описанием Mongo DB. Необходимо указать файл журнала с помощью параметра `--logpath`, так как у работающей службы нет командного окна для вывода данных.  Параметр `--logappend` указывает, что после перезапуска службы выходные данные будут добавляться в имеющийся файл журнала.  Параметр `--dbpath` указывает расположение каталога данных. Дополнительные сведения о параметрах командной строки, связанных со службами, см. [здесь][MongoWindowsSvcOptions].

    Чтобы запустить службу, выполните указанную ниже команду.

        C:\> net start MongoDB
10. После установки и запуска MongoDB необходимо открыть порт в брандмауэре Windows для удаленного подключения к MongoDB.  В меню **Пуск** выберите **Администрирование**, а затем — **Брандмауэр Windows в режиме повышенной безопасности**.
11. 11.1. На левой панели выберите **Правила для входящих подключений**.  На панели **Действия** справа выберите **Создать правило...**.

    ![Брандмауэр Windows][Image1]

    11.2. В окне **Мастер создания правила для нового входящего подключения** выберите **Порт** и нажмите кнопку **Далее**.

    ![Брандмауэр Windows][Image2]

    11.3. Выберите **TCP** и **Определенные локальные порты**.  Укажите порт 27017 (порт, прослушиваемый приложением MongoDB) и нажмите кнопку **Далее**.

    ![Брандмауэр Windows][Image3]

    11.4. Выберите **Разрешить подключение** и нажмите кнопку **Далее**.

    ![Брандмауэр Windows][Image4]

    11.5. Нажмите кнопку **Далее** еще раз.

    ![Брандмауэр Windows][Image5]

    11.6. Введите имя правила, например MongoPort, и нажмите кнопку **Готово**.

    ![Брандмауэр Windows][Image6]

12. Если вы не настроили конечную точку для MongoDB при создании виртуальной машины, можно сделать это сейчас. Для удаленного подключения к MongoDB потребуется правило брандмауэра и конечная точка.

  На портале Azure щелкните **Виртуальные машины (классические)**, выберите имя новой виртуальной машины, а затем щелкните **Конечные точки**.

    ![Конечные точки][Image7]

13. Щелкните **Добавить**.

14. Добавьте конечную точку с именем Mongo, протоколом **TCP** и портами **Общий** и **Частный** со значением "27017". Открыв этот порт, вы сможете получать удаленный доступ к MongoDB.

    ![Конечные точки][Image9]

> [!NOTE]
> По умолчанию приложение MongoDB использует порт 27017. Вы можете изменить порт по умолчанию, указав параметр `--port` при запуске сервера mongod.exe. В брандмауэре укажите тот же номер порта, что и для конечной точки Mongo в инструкциях выше.
>
>

[MongoDownloads]: http://www.mongodb.org/downloads

[MongoWindowsSvcOptions]: http://www.mongodb.org/display/DOCS/Windows+Service


[Image1]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall1.png
[Image2]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall2.png
[Image3]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall3.png
[Image4]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall4.png
[Image5]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall5.png
[Image6]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall6.png
[Image7]: ./media/install-and-run-mongo-on-win2k8-vm/menusendpointadd.png
<!-- Removed 03/08/2017. Not in new portal. -->
<!-- [Image8]: ./media/install-and-run-mongo-on-win2k8-vm/WinVmAddEndpoint2.png
-->
[Image9]: ./media/install-and-run-mongo-on-win2k8-vm/newendpointdetails.png
