
Если ваш Azure проблемы отсутствует в этой статье, посетите hello [форумы Azure на MSDN и переполнения стека](https://azure.microsoft.com/support/forums/). Проблему можно опубликовать на следующих форумах или too@AzureSupport в Twitter. Кроме того, можно зарегистрировать запрос поддержки Azure, выбрав **получение поддержки** на hello [поддержки Azure](https://azure.microsoft.com/support/options/) сайта.

## <a name="general-troubleshooting-steps"></a>Общие действия по устранению неполадок
### <a name="troubleshoot-common-allocation-failures-in-hello-classic-deployment-model"></a>Устранение общих ошибок выделения в hello классической модели развертывания
Выполнение этих шагов позволяет устранить многие ошибки выделения ресурсов в виртуальных машинах:

* Изменение размера другой размер виртуальной Машины hello ВМ tooa.<br>
    Выберите **Просмотреть все** > **Виртуальные машины (классические)** > имя виртуальной машины > **Параметры** > **Размер**. Подробные инструкции см. в разделе [изменить размер виртуальной машины hello](https://msdn.microsoft.com/library/dn168976.aspx).
* Удалите все виртуальные машины из hello облачной службы и повторного создания виртуальных машин.<br>
    Выберите **Просмотреть все** > **Виртуальные машины (классические)** > имя виртуальной машины > **Удалить**. Затем щелкните **Создать** > **Вычисления** > [образ виртуальной машины].

### <a name="troubleshoot-common-allocation-failures-in-hello-azure-resource-manager-deployment-model"></a>Устранение общих ошибок выделения в модели развертывания диспетчера ресурсов Azure hello
Выполнение этих шагов позволяет устранить многие ошибки выделения ресурсов в виртуальных машинах:

* Остановить (освободить) все виртуальные машины в hello же доступности установить, а затем перезапустите каждого из них.<br>
    toostop: щелкните **групп ресурсов** > группы ресурсов > **ресурсы** > в набор доступности > **виртуальные машины** > виртуальной машины >  **Остановить**.
  
    Здравствуйте, предварительно остановив все виртуальные машины, выберите первая виртуальная машина и нажмите кнопку **запустить**.

## <a name="background-information"></a>Справочная информация
### <a name="how-allocation-works"></a>Как выделяются ресурсы
Hello серверов в центрах обработки данных Azure разбиваются на кластеры. Как правило выполняется попытка запроса на выделение памяти в несколько кластеров, но возможно, некоторые ограничения из запроса на выделение hello принудительно hello tooattempt платформы Azure hello запроса только один кластер. В этой статье мы будем подразумевать toothis «закрепленных tooa кластер». Рис. 1 ниже показан случай hello обычного выделения, который выполняется в несколько кластеров. Схема 2 показан случай hello распределения, закрепленные tooCluster 2, так как это размещения hello существующих CS_1 облачной службы или группы доступности.
![Схема выделения ресурсов](./media/virtual-machines-common-allocation-failure/Allocation1.png)

### <a name="why-allocation-failures-happen"></a>Причины возникновения ошибок выделения ресурсов
Когда запрос на выделение памяти кластера закрепленных tooa, нет выше вероятность сбой toofind освободить ресурсы, поскольку меньше hello доступный пул ресурсов. Кроме того Если запроса на выделение закрепленных tooa кластера, но тип hello запрошенного ресурса не поддерживается в этом кластере, запрос завершится ошибкой, даже если кластера hello освободить ресурсы. 3 показан на следующем рисунке показан случай hello, где закрепленных выделение завершается неудачей, так как только Кандидат в кластеры hello не имеет свободных ресурсов. На рис. 4 показан случай hello, где закрепленных выделение завершается неудачей, поскольку только Кандидат в кластеры hello не поддерживает hello запрошенный размер виртуальной Машины, даже если кластер hello имеет освободить ресурсы.

![Ошибка выделения прикрепленных ресурсов](./media/virtual-machines-common-allocation-failure/Allocation2.png)

## <a name="detailed-troubleshoot-steps-specific-allocation-failure-scenarios-in-hello-classic-deployment-model"></a>Подробные устранения сбоев конкретного действия в hello классической модели развертывания
Ниже приведены распространенные сценарии распределения, вызывающие toobe запроса выделения закреплен. Каждый сценарий мы более подробно рассмотрим ниже.

* Изменение размера виртуальной Машины или добавить виртуальные машины или роли экземпляров tooan существующей облачной службы
* Перезапустите частично остановленные (освобожденные) виртуальные машины
* Перезапустите полностью остановленные (освобожденные) виртуальные машины
* Промежуточное и рабочее развертывание (только для "платформы как услуги")
* Территориальная группа (взаимодействие с виртуальными машинами или службами)
* Виртуальная сеть на основе группы сходства

При получении ошибки распределения см. Если любой из описанных сценариях hello tooyour ошибка при применении. Используйте hello выделения ошибку, возвращенную соответствующий сценарий hello tooidentify hello платформы Azure. Если ваш запрос закреплен, удалите некоторые из закрепляющий ограничения tooopen hello кластеров toomore запроса, тем самым повышая hello шансов на успех распределения.

Как правило, при условии, что ошибка hello указывает «hello запрошенный размер виртуальной Машины не поддерживается», можно всегда повторить попытку позднее, как недостаточно ресурсов, был освобожден в tooaccommodate кластера hello ваш запрос. Если hello проблема заключается в том, hello запрошенный размер виртуальной Машины не поддерживается, попробуйте другой размер виртуальной Машины. В противном случае hello единственный параметр — tooremove hello, закрепление ограничение.

Два распространенных ошибок — это группы связанных tooaffinity. В прошлом hello, территориальная группа экземпляров tooVMs или службы используется tooprovide близости его не или используется tooenable hello создания виртуальной сети. С появлением hello региональные виртуальные сети Территориальные группы больше не требуется toocreate виртуальной сети. Уменьшение задержки в сети в инфраструктуре Azure hello hello рекомендация toouse территориальных группах для виртуальной Машины или службы близости изменилась.

Схема 5 ниже представляется таксономии hello сценариев выделения hello (закреплены).
![Таксономия выделения прикрепленных ресурсов](./media/virtual-machines-common-allocation-failure/Allocation3.png)

> [!NOTE]
> Ошибка Hello, перечисленных в каждом сценарии выделения является краткой формой. См. toohello [поиск строки ошибки](#Error string lookup) для строки подробных сообщений об ошибках.
> 
> 

## <a name="allocation-scenario-resize-a-vm-or-add-vms-or-role-instances-tooan-existing-cloud-service"></a>Выделение сценарий: изменение размера виртуальной Машины и добавить виртуальные машины или роли экземпляров tooan существующей облачной службы
**Ошибка**

Upgrade_VMSizeNotSupported или GeneralError

**Причина прикрепления к кластеру**

Объект запроса tooresize виртуальной Машины или добавить виртуальную Машину или роль экземпляра tooan существующей облачной службы имеет toobe попытки в hello исходного кластера, на котором размещена hello существующей облачной службы. Создание новой облачной службы позволяет другой кластер, освобождая ресурсы или поддерживает размер виртуальной Машины hello, запрашиваемая toofind hello платформы Azure.

**Возможное решение**

Если ошибка hello Upgrade_VMSizeNotSupported *, попробуйте другой размер виртуальной Машины. Если с помощью другой размер виртуальной Машины не подходит, но если это допустимый toouse другой виртуальный IP-адрес (VIP), создайте новый toohost службы облачных hello новой виртуальной Машины и добавьте hello новой облачной службы toohello региональной виртуальной сети где hello существующие виртуальные машины запущены. Если существующий облачная служба не использует региональной виртуальной сети, по-прежнему создать новую виртуальную сеть для hello новой облачной службы и подключитесь к [существующей виртуальной сети toohello новую виртуальную сеть](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/). См. дополнительные сведения о [региональных виртуальных сетях](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).

Если ошибка hello GeneralError *, вполне вероятно, кластером hello поддерживается hello тип ресурса (например, определенный размер виртуальной Машины), что кластер hello не имеет свободных ресурсов на момент hello. Аналогичные toohello выше сценария, добавьте hello требуемого вычислительных ресурсов по созданию новой облачной службы (Обратите внимание, что новая облачная служба hello toouse различных виртуальных IP-адресов) и используйте tooconnect региональную виртуальную сеть облачных служб.

## <a name="allocation-scenario-restart-partially-stopped-deallocated-vms"></a>Сценарий выделения: перезапустите частично остановленные (освобожденные) виртуальные машины
**Ошибка**

GeneralError*

**Причина прикрепления к кластеру**

Частичное освобождение означает, что в облачной службе будут остановлены (освобождены) одна или несколько виртуальных машин, но не все. При остановке (освобождении) виртуальной Машины, hello связанные ресурсы освобождаются. Таким образом, перезагрузка остановленной (освобожденной) виртуальной машины предусматривает выполнение нового запроса. Перезагрузка виртуальных машин в частично освобожден облачной службы является эквивалентные tooadding виртуальные машины tooan существующей облачной службы. запрос на выделение Hello имеет toobe попытки в hello исходного кластера, на котором размещена hello существующей облачной службы. Создание в другой облачной службе позволяет другой кластер, который бесплатных ресурсов или поддерживает размер виртуальной Машины hello, запрашиваемая toofind hello платформы Azure.

**Возможное решение**

Если вы принимаете toouse различных VIP delete hello остановлена (освобождена) виртуальных машин (но keep hello связанные диски) и добавьте hello виртуальные машины обратно через другую облачную службу. Используйте tooconnect региональную виртуальную сеть облачных служб:

* Если существующей облачной службы использует региональной виртуальной сети, просто добавьте hello новой облачной службы toohello одной виртуальной сети.
* Если существующей облачной службы не использует региональной виртуальной сети, создайте новую виртуальную сеть для hello новой облачной службы, а затем [подключение существующей виртуальной сети toohello новой виртуальной сети](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/). См. дополнительные сведения о [региональных виртуальных сетях](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).

## <a name="allocation-scenario-restart-fully-stopped-deallocated-vms"></a>Сценарий выделения: перезапустите полностью остановленные (освобожденные) виртуальные машины
**Ошибка**

GeneralError*

**Причина прикрепления к кластеру**

Полное освобождение означает, что в облачной службе остановлены (освобождены) все виртуальные машины. Hello распределения запросов toorestart эти виртуальные машины имели toobe попытки в hello исходного кластера, на котором размещена hello облачной службы. Создание новой облачной службы позволяет другой кластер, освобождая ресурсы или поддерживает размер виртуальной Машины hello, запрашиваемая toofind hello платформы Azure.

**Возможное решение**

Если это допустимый toouse различных виртуальных IP-адресов, удалить hello исходного остановлена (освобождена) виртуальных машин (но keep hello связанные диски) и удалить hello соответствующей облачной службы (hello связанные вычислительных ресурсов уже были выпущены, когда вы остановлена (освобождена) Здравствуйте, виртуальные машины). Создание нового hello tooadd службы облака виртуальных машин обратно.

## <a name="allocation-scenario-stagingproduction-deployments-platform-as-a-service-only"></a>Сценарий выделения: промежуточное и рабочее развертывание (только для "платформы как услуги")
**Ошибка**

New_General* или New_VMSizeNotSupported*

**Причина прикрепления к кластеру**

Hello промежуточные развертывания и hello рабочего развертывания облачной службы, размещенные в hello одного кластера. При добавлении второе развертывание hello hello соответствующего запроса на выделение будут применены в hello одного кластера, на котором размещена hello первого развертывания.

**Возможное решение**

Удаление первого развертывания hello и hello исходного облачной службы и повторного развертывания облачной службы hello. Это действие может перемещаться hello первого развертывания в кластере, который имеет достаточно свободных ресурсов toofit оба развертывания или в кластере, который поддерживает размеры виртуальных Машин hello запрошенные.

## <a name="allocation-scenario-affinity-group-vmservice-proximity"></a>Сценарий выделения: территориальная группа (взаимодействие с виртуальными машинами или службами)
**Ошибка**

New_General* или New_VMSizeNotSupported*

**Причина прикрепления к кластеру**

Любой ресурс вычислений, назначенный tooan территориальная группа связана tooone кластера. Новые запросы вычислительных ресурсов в этой территориальной группе, применяются в hello же кластера, где размещаются существующие ресурсы hello. Это верно ли hello новые ресурсы создаются через новой облачной службы или существующей облачной службе.

**Возможное решение**

Если территориальная группа не нужна, не используйте ее или сгруппируйте вычислительные ресурсы в нескольких территориальных группах.

## <a name="allocation-scenario-affinity-group-based-virtual-network"></a>Сценарий выделения: виртуальная сеть на основе территориальной группы
**Ошибка**

New_General* или New_VMSizeNotSupported*

**Причина прикрепления к кластеру**

Перед появлением региональные виртуальные сети можно было необходимые tooassociate виртуальной сети с территориальной группой. В результате ограничивается вычислительные ресурсы помещаются в территориальной группе hello и те же ограничения, как описано в hello» выделения сценарий: территориальная группа (приближения виртуальной Машины или службы)» выше. Hello вычислительные ресурсы, связанные tooone кластера.

**Возможное решение**

Если не требуется использовать территориальную группу, создайте новый региональную виртуальную сеть для hello новые ресурсы, которые вы добавляете, а затем [подключение существующей виртуальной сети toohello новой виртуальной сети](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/). См. дополнительные сведения о [региональных виртуальных сетях](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).

Вы также можете [миграция виртуальной сети территориальной группы на основе tooa региональной виртуальной сети](https://azure.microsoft.com/blog/2014/11/26/migrating-existing-services-to-regional-scope/), а затем снова добавьте ресурсы hello требуемого.

## <a name="detailed-troubleshooting-steps-specific-allocation-failure-scenarios-in-hello-azure-resource-manager-deployment-model"></a>Подробные сведения об устранении сбоев конкретного действия в модели развертывания диспетчера ресурсов Azure hello
Ниже приведены распространенные сценарии распределения, вызывающие toobe запроса выделения закреплен. Каждый сценарий мы более подробно рассмотрим ниже.

* Изменение размера виртуальной Машины или добавить виртуальные машины или роли экземпляров tooan существующей облачной службы
* Перезапустите частично остановленные (освобожденные) виртуальные машины
* Перезапустите полностью остановленные (освобожденные) виртуальные машины

При получении ошибки распределения см. Если любой из описанных сценариях hello tooyour ошибка при применении. Используйте hello выделения ошибку, возвращенную соответствующий сценарий hello tooidentify hello платформы Azure. Если ваш запрос закрепленных tooan существующего кластера, удалите некоторые из hello закрепляющий tooopen ограничения запроса toomore кластеров, тем самым повышая hello шансов на успех распределения.

Как правило, при условии, что ошибка hello указывает «hello запрошенный размер виртуальной Машины не поддерживается», можно всегда повторить попытку позднее, как недостаточно ресурсов, был освобожден в tooaccommodate кластера hello ваш запрос. Если проблема hello, hello запрошенный размер виртуальной Машины не поддерживается, ниже приведены способы решения проблем.

## <a name="allocation-scenario-resize-a-vm-or-add-vms-tooan-existing-availability-set"></a>Выделение сценарий: изменение размера виртуальной Машины и добавить существующую группу доступности виртуальных машин tooan
**Ошибка**

Upgrade_VMSizeNotSupported* или GeneralError*

**Причина прикрепления к кластеру**

Объект запроса tooresize виртуальной Машины или добавить tooan виртуальной Машины, в существующую группу доступности имеет toobe попытки в hello исходного кластера, на котором размещена hello существующую группу доступности. Создание нового набора доступности позволяет другой кластер, освобождая ресурсы или поддерживает размер виртуальной Машины hello, запрашиваемая toofind hello платформы Azure.

**Возможное решение**

Если ошибка hello Upgrade_VMSizeNotSupported *, попробуйте другой размер виртуальной Машины. Если с помощью другой размер виртуальной Машины не подходит, остановите все виртуальные машины в наборе доступности hello. После этого можно изменить размер hello hello виртуальной машины, выделяемый hello ВМ tooa кластер, поддерживающий hello желаемый размер виртуальной Машины.

Если ошибка hello GeneralError *, вполне вероятно, кластером hello поддерживается hello тип ресурса (например, определенный размер виртуальной Машины), что кластер hello не имеет свободных ресурсов на момент hello. Если hello виртуальной Машины может быть частью набора доступности на другой, создайте новую ВМ в набор доступности на другой (в hello одного региона). Этой новой виртуальной Машины, можно добавить toohello одной виртуальной сети.  

## <a name="allocation-scenario-restart-partially-stopped-deallocated-vms"></a>Сценарий выделения: перезапустите частично остановленные (освобожденные) виртуальные машины
**Ошибка**

GeneralError*

**Причина прикрепления к кластеру**

Частичное освобождение означает, что в группе доступности будут остановлены (освобождены) одна или несколько виртуальных машин, но не все. При остановке (освобождении) виртуальной Машины, hello связанные ресурсы освобождаются. Таким образом, перезагрузка остановленной (освобожденной) виртуальной машины предусматривает выполнение нового запроса. Перезапуска виртуальных машин в наборе доступности частично освобождена эквивалентные tooadding доступности существующие виртуальные машины tooan устанавливается. запрос на выделение Hello имеет toobe попытки в hello исходного кластера, на котором размещена hello существующую группу доступности.

**Возможное решение**

Остановите все виртуальные машины в группе до перезапуска hello первый доступности hello. Это обеспечит выполнение новой попытки выделения и возможность выбора нового кластера с доступной емкостью.

## <a name="allocation-scenario-restart-fully-stopped-deallocated"></a>Сценарий выделения: перезапустите полностью остановленные (освобожденные) виртуальные машины
**Ошибка**

GeneralError*

**Причина прикрепления к кластеру**

Полное освобождение означает, что в группе доступности остановлены (освобождены) все виртуальные машины. Эти виртуальные машины будут связаны всех кластеров, поддерживающих toorestart hello нужного размера запроса на выделение Hello.

**Возможное решение**

Выберите новый tooallocate размер виртуальной Машины. Если это не сработает, повторите попытку позже.

## <a name="error-string-lookup"></a>Значение строк ошибок
**New_VMSizeNotSupported***

«hello ВМ размера (или комбинация размеров ВМ) требуемый для этого развертывания не может быть подготовлен из-за ограничений запроса toodeployment. Если это возможно, попробуйте ослабить ограничения, такие как привязки виртуальной сети, развертывание tooa размещенной службе без других развертываний в нем и tooa другой территориальной группе или без территориальной группе и повторите развертывание tooa другой регион.»

**New_General***

«Ошибка при выделении; не удается toosatisfy ограничения в запросе. Hello запрошенное новое развертывание службы привязанного tooan территориальную группу, или он предназначен виртуальной сети или имеется существующее развертывание в рамках этой размещенной службы. Любое из этих условий ограничивает toospecific нового развертывания hello Azure ресурсы. Повторите попытку позже или попробуйте уменьшить размер виртуальной Машины hello или число экземпляров роли. Кроме того Если это возможно, удалите hello упомянутой выше ограничения или попробуйте выполнить развертывание tooa другой регион.»

**Upgrade_VMSizeNotSupported***

«Не удается tooupgrade hello развертывания. Hello запрошенный размер виртуальной Машины XXX могут быть недоступны в ресурсах hello, поддерживающих существующее развертывание hello. Повторите попытку позже, попробуйте использовать другой размер виртуальной машины или меньше экземпляров ролей либо создать развертывание в пустой размещенной службе с новой территориальной группой или без использования привязки к территориальной группе".

**GeneralError***

«hello сервер обнаружил внутреннюю ошибку. Повторите запрос hello.» Или «Сбой tooproduce выделение для службы hello».

