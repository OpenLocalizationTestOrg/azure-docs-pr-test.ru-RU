# <a name="securing-docker-containers-in-azure-container-service"></a>Защита контейнеров Docker в службе контейнеров Azure

В этой статье описываются рекомендации по защите контейнеров Docker, развернутых в службе контейнеров Azure. Многие из этих соображений обычно применяются tooDocker контейнеры, развернутых в Azure или в других средах. 

## <a name="image-security"></a>Безопасность образов

Контейнеры состоят из образов, которые хранятся в одном или нескольких репозиториях. Эти репозиториев могут принадлежать toopublic или закрытого контейнера реестры. Примером общего реестра является [Docker Hub](https://hub.docker.com/). Пример частного реестра — hello [доверенный реестр Docker](https://docs.docker.com/datacenter/dtr/2.0/), который может быть установлен локально или в частном облаке виртуальных. Существуют также частные службы реестров контейнеров на основе облака, включая [реестр контейнеров Azure](../articles/container-registry/container-registry-intro.md).

### <a name="public-and-private-images"></a>Общие и частные образы
В целом, как и любой общедоступный опубликованный программный пакет, общедоступный образ контейнера не может гарантировать безопасность. Образы контейнеров состоят из нескольких программных слоев, у каждого из которых могут быть свои уязвимости. Это источник ключа toounderstand hello hello образ контейнера, включая владельца hello hello изображения (toodetermine, если это надежного источника или нет), hello слоев программного обеспечения, оно содержит и hello версии программного обеспечения. 

Например, при переходе официальный toohello [nginx репозитория](https://hub.docker.com/_/nginx/) в Docker Hub и перейдите toohello **теги** вкладку, появится цветной уязвимости в каждого изображения. Каждый цвет описывается уязвимость hello слоев программного обеспечения hello изображения. Дополнительные сведения о сканировании уязвимостей на Docker Hub см. в записи блога, посвященной [обзору официальных репозиториев на Docker Hub](https://blog.docker.com/2015/06/understanding-official-repos-docker-hub/).

![Образы Nginx на Docker Hub](./media/container-service-security/docker-hub-nginx.png)

Предприятиям обеспечивает глубокую о безопасности и tooprotect себя от атак системы безопасности следует сохранять и извлекать образы из частного реестра, таких как Azure контейнер реестра или доверенный реестр Docker. В управляемых частного реестра tooproviding сложения, реестр контейнера Azure поддерживает [проверки подлинности на основе субъекта-службы](../articles/container-registry/container-registry-authentication.md) через Azure Active Directory для обычной проверки подлинности потоков, включая доступ на основе ролей для только для чтения, записи и разрешений владельца.

### <a name="image-security-scanning"></a>Сканирование безопасности образов

Даже при использовании частного реестра, это образ toouse смысл сканирование решения для обеспечения дополнительной безопасности проверки. Каждый слой программного обеспечения в образ контейнера — потенциально подвержен toovulnerabilities независимо от других слоев в образе контейнера hello. Как все больше компаний начать развертывание своих рабочих нагрузок на основе технологий контейнера, сканирования рисунка становится важным tooensure защиты от угроз безопасности для своей организации. 

Безопасность, наблюдение и проверку решения, такие как [Twistlock](https://www.twistlock.com/2016/11/07/twistlock-supports-azure-container-registry) и [безопасности голубой](http://blog.aquasec.com/image-vulnerability-scanning-in-azure-container-registry), среди прочего, можно использовать tooscan образы контейнеров в частного реестра и идентификации потенциальных уязвимостей. Важно указать глубину hello toounderstand сканирование различные решения, hello. Например, некоторые решения могут использовать перекрестную проверку слоев образа на наличие известных уязвимостей. Эти решения могут быть программы может tooverify слой образа, созданные через определенное программное обеспечение диспетчера пакетов. Для других решений предусмотрена более глубокая интеграция сканирования, и они могут обнаружить уязвимости в любом комплекте программного обеспечения.

### <a name="production-deployment-rules-and-audit"></a>Правила развертывания в рабочей среде и аудит
После развертывания приложения в рабочей среде это основные tooset несколько tooensure правила использования образов в рабочей среде являются безопасными и содержать не уязвимости.

* Как правило с уязвимостей, даже небольшие изображения должен быть запрещен toorun в рабочей среде. Кроме того все образы, развернутых в рабочей среде в идеале сохраняться в инструкции select доступного tooa частного реестра лишь немногие. Это также важно tookeep hello количество небольших tooensure производства изображений, ими можно управлять эффективно.

* Поскольку это источник hello жестких toopinpoint программного обеспечения с образ контейнера с общедоступным, это изображений toobuild рекомендаций из базы знаний tooensure источника происхождения hello hello слоя. Уязвимость рабочих областей в образе самостоятельно создать контейнер, клиенты могут найти ускорить разрешение tooa пути. С открытого изображения, клиентам потребуется корень hello toofind toofix открытый изображения его или получить от издателя hello другой безопасный образ.

* Тщательно отсканированные изображения, развернутых в рабочей среде не гарантируется toobe копирование toodate hello жизненного цикла приложения hello. Уязвимости системы безопасности может быть сообщено слоев hello образа, которые ранее не были известны или были введены после hello рабочего развертывания. Периодических аудит изображений, развернутых в рабочей среде — необходимые tooidentify образы, которые являются устаревшими или не была обновлена в некоторое время. Один использовать методологий развертывания сине зеленый и последовательного обновления механизмы образы контейнеров tooupdate без простоев. Сканирования рисунка можно сделать с средствах, описанных в предшествующих раздел hello. 

* Конвейер непрерывной интеграции (CI) toobuild изображения и сканирование встроенную безопасность можно обеспечить безопасный частных реестрах с образами безопасный контейнер. Hello поиск уязвимостей встроены в решение непрерывной Интеграции hello гарантирует, что образы, которые прошли все тесты hello помещаются в стек toohello частного реестра из какой рабочей среды развертывания рабочих нагрузок. Сбой конвейера CI гарантирует, что уязвимым изображений не включено в hello частного реестра используются для рабочих развертываний рабочей нагрузки. В случае значительного количества образов также запускается автоматическая проверка их безопасности. Выполнение аудита образов вручную для обнаружения уязвимостей системы безопасности очень долгий процесс, подверженный ошибкам.

## <a name="host-level-container-isolation"></a>Изоляция контейнера на уровне узла
Когда клиент развертывает приложения контейнера в ресурсах Azure, они развертываются в группах ресурсов на уровне подписки и не являются мультитенантными. Это означает, что, если клиент использует подписки с другими пользователями, нет границ, можно создать между двумя развертываниями в hello же подписки. Таким образом, безопасность на уровне контейнера не гарантируется. 

Это критическое toounderstand, что контейнеры используют ядра hello и hello ресурсы узла hello (который в службе контейнера Azure ВМ Azure в кластере). Следовательно, контейнеры, запущенные в рабочей среде, должны запускаться в непривилегированном пользовательском режиме. Контейнер запускается с правами корневой могут поставить под угрозу hello всей среды. С доступом на корневом уровне в контейнере злоумышленник может получить доступ права полного корневой toohello на узле hello. Кроме того это контейнеры важные toorun только для чтения файловые системы. Это предотвращает тем, кто имеет доступ toohello скомпрометированы контейнера toowrite вредоносных сценариев toohello файловой системы и получения доступа tooother файлов. Аналогичным образом это ресурсы hello, важные toolimit (например, память, ЦП и пропускной способности сети) выделенные tooa контейнера. Это помогает предотвратить хакеров занимать ресурсы и проводит незаконных действий, например мошенничества с кредитными картами или bitcoin интеллектуального анализа данных, что может помешать запущена на кластере или узле hello другие контейнеры.

## <a name="orchestrator-considerations"></a>Оркестратор и вопросы безопасности

Для каждого оркестратора, доступного в службе контейнеров Azure, предусмотрены свои рекомендации по безопасности. Например следует ограничить прямой узлов tooorchestrator доступа SSH в контейнере службы. Вместо этого следует использовать каждый orchestrator пользовательского интерфейса или средства командной строки (такие как `kubectl` для Kubernetes) toomanage hello контейнера среде без обращения к узлам hello. Дополнительные сведения см. в разделе [создания кластера, Kubernetes, DC/OS или с помощью Docker Swarm tooa удаленного подключения](../articles/container-service/kubernetes/container-service-connect.md).

Безопасности orchestrator Дополнительные сведения см. в разделе hello следующие ресурсы:

* **Kubernetes**: [Security Best Practices for Kubernetes Deployment](http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html) (Рекомендации по безопасности для развертывания Kubernetes)

* **DC/OS**: [Securing Your Cluster](https://dcos.io/docs/1.8/administration/securing-your-cluster/) (Защита кластера)

* **Docker Swarm**: [Docker Security](https://www.docker.com/docker-security) (Защита Docker)

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о безопасности архитектуры и контейнер Docker см. в разделе [tooContainer введение безопасности](https://www.docker.com/sites/default/files/WP_IntrotoContainerSecurity_08.19.2016.pdf).

* Сведения о безопасности платформы Azure см. в разделе hello [центра безопасности Azure](https://www.microsoft.com/en-us/trustcenter/cloudservices/azure).
