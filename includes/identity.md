<span data-ttu-id="d0aca-101">Управление удостоверениями столь же важно, в общедоступном облаке hello как на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="d0aca-101">Managing identity is just as important in hello public cloud as it is on premises.</span></span> <span data-ttu-id="d0aca-102">toohelp с этим Azure поддерживает несколько технологий различных облачных удостоверений.</span><span class="sxs-lookup"><span data-stu-id="d0aca-102">toohelp with this, Azure supports several different cloud identity technologies.</span></span> <span data-ttu-id="d0aca-103">К ним относятся следующие:</span><span class="sxs-lookup"><span data-stu-id="d0aca-103">They include these:</span></span>

* <span data-ttu-id="d0aca-104">Windows Server Active Directory (обычно называется просто AD) можно запускать в облаке hello, с использованием виртуальных машин, созданных с помощью виртуальных машин Azure.</span><span class="sxs-lookup"><span data-stu-id="d0aca-104">You can run Windows Server Active Directory (commonly called just AD) in hello cloud using virtual machines created with Azure Virtual machines.</span></span> <span data-ttu-id="d0aca-105">Такой подход имеет смысл при работе с Azure tooextend локального центра обработки данных в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-105">This approach makes sense when you're using Azure tooextend your on-premises datacenter into hello cloud.</span></span>
* <span data-ttu-id="d0aca-106">Можно использовать Azure Active Directory toogive пользователями единого входа слишком[программное обеспечение как услуга (SaaS)](https://azure.microsoft.com/overview/what-is-saas/) приложений.</span><span class="sxs-lookup"><span data-stu-id="d0aca-106">You can use Azure Active Directory toogive your users single sign-on too[Software as a Service (SaaS)](https://azure.microsoft.com/overview/what-is-saas/) applications.</span></span> <span data-ttu-id="d0aca-107">Эта технология используется, например, в Microsoft Office 365, а также может использоваться в приложениях, работающих на платформе Azure и на других облачных платформах.</span><span class="sxs-lookup"><span data-stu-id="d0aca-107">Microsoft's Office 365 uses this technology, for example, and applications running on Azure or other cloud platforms can also use it.</span></span>
* <span data-ttu-id="d0aca-108">Приложения, выполняющиеся в hello облачной или локальной можно использовать Azure Active Directory Access Control toolet входе с использованием идентификаторов от Facebook, Google, Microsoft и других поставщиков удостоверений.</span><span class="sxs-lookup"><span data-stu-id="d0aca-108">Applications running in hello cloud or on-premises can use Azure Active Directory Access Control toolet users log in using identities from Facebook, Google, Microsoft, and other identity providers.</span></span>

<span data-ttu-id="d0aca-109">В этой статье описываются все три варианта.</span><span class="sxs-lookup"><span data-stu-id="d0aca-109">This article describes all three of these options.</span></span>

## <a name="table-of-contents"></a><span data-ttu-id="d0aca-110">Оглавление</span><span class="sxs-lookup"><span data-stu-id="d0aca-110">Table of Contents</span></span>
* [<span data-ttu-id="d0aca-111">Выполнение Windows Server Active Directory на виртуальных машинах</span><span class="sxs-lookup"><span data-stu-id="d0aca-111">Running Windows Server Active Directory in virtual machines</span></span>](#adinvm)
* [<span data-ttu-id="d0aca-112">Использование Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d0aca-112">Using Azure Active Directory</span></span>](#ad)
* [<span data-ttu-id="d0aca-113">Использование службы контроля доступа Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d0aca-113">Using Azure Active Directory Access Control</span></span>](#ac)

## <span data-ttu-id="d0aca-114"><a name="adinvm"></a>Выполнение Windows Server Active Directory на виртуальных машинах</span><span class="sxs-lookup"><span data-stu-id="d0aca-114"><a name="adinvm"></a>Running Windows Server Active Directory in virtual machines</span></span>
<span data-ttu-id="d0aca-115">Выполнение Windows Server AD на виртуальных машинах Azure очень похоже на выполнение в локальных средах.</span><span class="sxs-lookup"><span data-stu-id="d0aca-115">Running Windows Server AD in Azure virtual machines is much like running it on-premises.</span></span> <span data-ttu-id="d0aca-116">[На рисунке 1](#fig1) показан типичный пример того, как это выглядит.</span><span class="sxs-lookup"><span data-stu-id="d0aca-116">[Figure 1](#fig1) shows a typical example of how this looks.</span></span>

![Azure Active Directory на виртуальной машине](./media/identity/identity_01_ADinVM.png)

<span data-ttu-id="d0aca-118"><a name="Fig1"></a>Рисунок 1: Windows Server Active Directory можно запускать в Azure виртуальными машинами, подключенными tooan организации на локальном центре обработки данных, с помощью виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="d0aca-118"><a name="Fig1"></a>Figure 1: Windows Server Active Directory can run in Azure virtual machines connected tooan organization's on-premises datacenter using Azure Virtual Network.</span></span>

<span data-ttu-id="d0aca-119">В приведенном здесь примере hello Windows Server AD работает на виртуальных машинах, созданных с помощью виртуальных машин Azure, технологию IaaS hello платформы.</span><span class="sxs-lookup"><span data-stu-id="d0aca-119">In hello example shown here, Windows Server AD is running in VMs created using Azure Virtual Machines, hello platform's IaaS technology.</span></span> <span data-ttu-id="d0aca-120">Эти виртуальные машины и некоторые другие группируются в виртуальную сеть, подключенную tooan локального центра обработки данных с помощью виртуальной сети Azure.</span><span class="sxs-lookup"><span data-stu-id="d0aca-120">These VMs and a few others are grouped into a virtual network connected tooan on-premises datacenter using Azure Virtual Network.</span></span> <span data-ttu-id="d0aca-121">Виртуальная сеть Hello вырезает группы облака виртуальных машин, которые взаимодействуют с локальной сетью hello посредством подключения к виртуальной частной сети (VPN).</span><span class="sxs-lookup"><span data-stu-id="d0aca-121">hello virtual network carves out a group of cloud virtual machines that interact with hello on-premises network via a virtual private network (VPN) connection.</span></span> <span data-ttu-id="d0aca-122">Выполнив этот позволяет эти виртуальные машины Azure выглядеть просто еще одно центра данных в локальной подсети toohello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-122">Doing this lets these Azure virtual machines look like just another subnet toohello on-premises datacenter.</span></span> <span data-ttu-id="d0aca-123">Как показано на рисунке hello, два из этих виртуальных машин работают контроллеры домена Windows Server AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-123">As hello figure shows, two of those VMs are running Windows Server AD domain controllers.</span></span> <span data-ttu-id="d0aca-124">Hello других виртуальных машин в виртуальной сети hello могут работать приложения, такие как SharePoint, или используется другим способом, например, для разработки и тестирования.</span><span class="sxs-lookup"><span data-stu-id="d0aca-124">hello other virtual machines in hello virtual network might be running applications, such as SharePoint, or being used in some other way, such as for development and testing.</span></span> <span data-ttu-id="d0aca-125">Hello локального центра обработки данных также выполняется двух контроллеров домена Windows Server AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-125">hello on-premises datacenter is also running two Windows Server AD domain controllers.</span></span>

<span data-ttu-id="d0aca-126">Существует несколько вариантов подключения контроллеры домена hello в облаке hello запущенных на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="d0aca-126">There are several options for connecting hello domain controllers in hello cloud with those running on premises:</span></span>

* <span data-ttu-id="d0aca-127">— Включить все контроллеры в один домен Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0aca-127">Make all of them part of a single Active Directory domain.</span></span>
* <span data-ttu-id="d0aca-128">Создайте отдельный AD домены локально и в облаке hello, которые являются частью hello того же леса.</span><span class="sxs-lookup"><span data-stu-id="d0aca-128">Create separate AD domains on-premises and in hello cloud that are part of hello same forest.</span></span>
* <span data-ttu-id="d0aca-129">Создайте в hello облачных и локальных лесов AD, а затем соедините hello лесов, с помощью отношения доверия между лесами или Windows Server службы Active Directory федерации (AD FS), которой могут выполняться в виртуальных машинах в Azure.</span><span class="sxs-lookup"><span data-stu-id="d0aca-129">Create separate AD forests in hello cloud and on-premises, then connect hello forests using cross-forest trusts or Windows Server Active Directory Federation Services (AD FS), which can also run in virtual machines on Azure.</span></span>

<span data-ttu-id="d0aca-130">Независимо от выбираете, администратору следует убедиться в том, запросы проверки подлинности от локальных пользователей перейдите toocloud контроллеры домена только при необходимости, так как облаке toohello связи hello скорее всего toobe медленнее, чем в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="d0aca-130">Whatever choice is made, an administrator should make sure that authentication requests from on-premises users go toocloud domain controllers only when necessary, since hello link toohello cloud is likely toobe slower than on-premises networks.</span></span> <span data-ttu-id="d0aca-131">Другой фактор tooconsider в подключении облачные и локальные контроллеры домена — hello трафик, созданного репликацией.</span><span class="sxs-lookup"><span data-stu-id="d0aca-131">Another factor tooconsider in connecting cloud and on-premises domain controllers is hello traffic generated by replication.</span></span> <span data-ttu-id="d0aca-132">Контроллеры домена в облаке hello обычно являются в собственном сайте AD, который позволяет администратору tooschedule как часто выполняется репликация.</span><span class="sxs-lookup"><span data-stu-id="d0aca-132">Domain controllers in hello cloud are typically in their own AD site, which allows an administrator tooschedule how often replication is done.</span></span> <span data-ttu-id="d0aca-133">Azure взимает плату за трафик, отправленный из центра обработки данных Azure, несмотря на то, что не отправлено байт в, который может повлиять на выбор hello администратора репликации.</span><span class="sxs-lookup"><span data-stu-id="d0aca-133">Azure charges for traffic sent out of an Azure datacenter, although not for bytes sent in, which might affect hello administrator's replication choices.</span></span> <span data-ttu-id="d0aca-134">Также следует отметить, что хотя Azure поддерживает собственную систему доменных имен (DNS), у этой службы нет компонентов, требуемых службой Active Directory (таких как поддержка динамических DNS и записей SRV).</span><span class="sxs-lookup"><span data-stu-id="d0aca-134">It's also worth pointing out that while Azure does provide its own Domain Name System (DNS) support, this service is missing features required by Active Directory (such as support for Dynamic DNS and SRV records).</span></span> <span data-ttu-id="d0aca-135">По этой причине под управлением Windows Server AD в Azure нужно настроить собственный DNS-серверов в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-135">Because of this, running Windows Server AD on Azure requires setting up your own DNS servers in hello cloud.</span></span>

<span data-ttu-id="d0aca-136">Выполнение Windows Server AD на виртуальных машинах Azure может иметь смысл в различных ситуациях.</span><span class="sxs-lookup"><span data-stu-id="d0aca-136">Running Windows Server AD in Azure VMs can make sense in several different situations.</span></span> <span data-ttu-id="d0aca-137">Ниже приведены некоторые примеры:</span><span class="sxs-lookup"><span data-stu-id="d0aca-137">Here are some examples:</span></span>

* <span data-ttu-id="d0aca-138">При использовании виртуальных машин Azure в качестве расширения собственного центра обработки данных, может запускать приложения в облаке hello, для которых требуются локального домена контроллеры toohandle сущности, такие как запросы на встроенную проверку подлинности Windows или запросов LDAP.</span><span class="sxs-lookup"><span data-stu-id="d0aca-138">If you're using Azure Virtual Machines as an extension of your own datacenter, you might run applications in hello cloud that need local domain controllers toohandle things such as Windows Integrated Authentication requests or LDAP queries.</span></span> <span data-ttu-id="d0aca-139">SharePoint, например, часто взаимодействует с Active Directory и поэтому хотя возможных toorun фермы SharePoint в Azure с использованием локального каталога, настройке контроллеров домена в облаке hello значительно повышают производительность.</span><span class="sxs-lookup"><span data-stu-id="d0aca-139">SharePoint, for example, interacts frequently with Active Directory, and so while it's possible toorun a SharePoint farm on Azure using an on-premises directory, setting up domain controllers in hello cloud will significantly improve performance.</span></span> <span data-ttu-id="d0aca-140">(Это важно toorealize, что это не обязательно нужно, однако достаточно приложений могут успешно выполняться в облаке hello, с использованием только контроллеры домена в локальной среде.)</span><span class="sxs-lookup"><span data-stu-id="d0aca-140">(It's important toorealize that this isn't necessarily required, however; plenty of applications can run successfully in hello cloud using only on-premises domain controllers.)</span></span>
* <span data-ttu-id="d0aca-141">Предположим, что дальние филиале отсутствуют ресурсы toorun hello собственными контроллерами домена.</span><span class="sxs-lookup"><span data-stu-id="d0aca-141">Suppose a faraway branch office lacks hello resources toorun its own domain controllers.</span></span> <span data-ttu-id="d0aca-142">В настоящее время ее пользователи должны пройти проверку подлинности контроллеров toodomain на hello другой стороне hello world — имена входа выполняются медленно.</span><span class="sxs-lookup"><span data-stu-id="d0aca-142">Today, its users must authenticate toodomain controllers on hello other side of hello world - logins are slow.</span></span> <span data-ttu-id="d0aca-143">ОС Azure Active Directory в центре Microsoft ближе можно ускорить это не требует дополнительных серверов в филиале hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-143">Running Active Directory on Azure in a closer Microsoft datacenter can speed this up without requiring more servers in hello branch office.</span></span>
* <span data-ttu-id="d0aca-144">Организации, которая использует Azure для аварийного восстановления, то можно поддерживать небольшой набор активных виртуальных машин в облаке hello, включая контроллера домена.</span><span class="sxs-lookup"><span data-stu-id="d0aca-144">An organization that uses Azure for disaster recovery might maintain a small set of active VMs in hello cloud, including a domain controller.</span></span> <span data-ttu-id="d0aca-145">Затем можно подготовить tooexpand этого сайта как необходимые tootake через сбоев в другом месте.</span><span class="sxs-lookup"><span data-stu-id="d0aca-145">It can then be prepared tooexpand this site as needed tootake over for failures elsewhere.</span></span>

<span data-ttu-id="d0aca-146">Существуют и другие возможности.</span><span class="sxs-lookup"><span data-stu-id="d0aca-146">There are also other possibilities.</span></span> <span data-ttu-id="d0aca-147">Например, вы не требуется Windows Server AD в облаке tooan hello tooconnect локального центра обработки данных.</span><span class="sxs-lookup"><span data-stu-id="d0aca-147">For example, you're not required tooconnect Windows Server AD in hello cloud tooan on-premises datacenter.</span></span> <span data-ttu-id="d0aca-148">При желании toorun фермы SharePoint, обработавшего определенной группы пользователей, например, каждый из которых будет вход только с использованием облачных удостоверений, можно создать автономный леса в Azure.</span><span class="sxs-lookup"><span data-stu-id="d0aca-148">If you wanted toorun a SharePoint farm that served a particular set of users, for instance, all of whom would log in solely with cloud-based identities, you might create a standalone forest on Azure.</span></span> <span data-ttu-id="d0aca-149">Способ использования этой технологии зависит от целей.</span><span class="sxs-lookup"><span data-stu-id="d0aca-149">How you use this technology depends on what your goals are.</span></span> <span data-ttu-id="d0aca-150">(Более подробное руководство по использованию Windows Server AD с Azure [см. здесь](http://msdn.microsoft.com/library/windowsazure/jj156090.aspx).)</span><span class="sxs-lookup"><span data-stu-id="d0aca-150">(For more detailed guidance on using Windows Server AD with Azure, [see here](http://msdn.microsoft.com/library/windowsazure/jj156090.aspx).)</span></span>

## <span data-ttu-id="d0aca-151"><a name="ad"></a>Использование Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d0aca-151"><a name="ad"></a>Using Azure Active Directory</span></span>
<span data-ttu-id="d0aca-152">По мере роста популярности приложений SaaS возникает очевидный вопрос: какие службы каталогов должны использовать эти облачные приложения?</span><span class="sxs-lookup"><span data-stu-id="d0aca-152">As SaaS applications become more and more common, they raise an obvious question: What kind of directory service should these cloud-based applications use?</span></span> <span data-ttu-id="d0aca-153">Вопрос toothat ответов корпорации Майкрософт — Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0aca-153">Microsoft's answer toothat question is Azure Active Directory.</span></span>

<span data-ttu-id="d0aca-154">Существует два основных варианта с помощью этой службы каталогов в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-154">There are two main options for using this directory service in hello cloud:</span></span>

* <span data-ttu-id="d0aca-155">— Люди и организации, использующие только приложения SaaS, могут использовать Azure Active Directory в качестве единой службы каталогов.</span><span class="sxs-lookup"><span data-stu-id="d0aca-155">Individuals and organizations that use only SaaS applications can rely on Azure Active Directory as their sole directory service.</span></span>
* <span data-ttu-id="d0aca-156">Организациях, где работает Windows Server Active Directory можно подключиться их tooAzure каталогов в локальной среде Active Directory, а затем использовать его toogive своим пользователям единый вход tooSaaS приложений.</span><span class="sxs-lookup"><span data-stu-id="d0aca-156">Organizations that run Windows Server Active Directory can connect their on-premises directory tooAzure Active Directory, then use it toogive their users single sign-on tooSaaS applications.</span></span>

<span data-ttu-id="d0aca-157">[Рис. 2](#fig2) hello показан первый из этих двух вариантов, где все, что требуется — в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0aca-157">[Figure 2](#fig2) illustrates hello first of these two options, where Azure Active Directory is all that's required.</span></span>

![Azure Active Directory на виртуальной машине](./media/identity/identity_02_AD.png)

<span data-ttu-id="d0aca-159"><a name="fig2"></a>Рисунок 2: Azure Active Directory позволяет пользователям организации-tooSaaS приложений, включая Office 365.</span><span class="sxs-lookup"><span data-stu-id="d0aca-159"><a name="fig2"></a>Figure 2: Azure Active Directory gives an organization's users single sign-on tooSaaS applications, including Office 365.</span></span>

<span data-ttu-id="d0aca-160">Как показано на рисунке hello, Azure AD — это служба несколькими клиентами.</span><span class="sxs-lookup"><span data-stu-id="d0aca-160">As hello figure shows, Azure AD is a multi-tenant service.</span></span> <span data-ttu-id="d0aca-161">Это значит, что она может одновременно поддерживать множество организаций и хранить каталоги пользователей для каждой из них.</span><span class="sxs-lookup"><span data-stu-id="d0aca-161">This means that it can simultaneously support many different organizations, storing directory information about users at each of them.</span></span> <span data-ttu-id="d0aca-162">В этом примере пользователь в организации A пытается tooaccess приложения SaaS.</span><span class="sxs-lookup"><span data-stu-id="d0aca-162">In this example, a user at organization A is trying tooaccess a SaaS application.</span></span> <span data-ttu-id="d0aca-163">Это приложение может быть частью Office 365, например SharePoint Online, или любым другим — приложения сторонних разработчиков также могут использовать эту технологию.</span><span class="sxs-lookup"><span data-stu-id="d0aca-163">This application might be part of Office 365, such as SharePoint Online, or it might be something else - non-Microsoft applications can also use this technology.</span></span> <span data-ttu-id="d0aca-164">Поскольку Azure AD поддерживает протокол SAML 2.0 hello, все, что требовал из приложения hello возможность toointeract использует этот отраслевого стандарта.</span><span class="sxs-lookup"><span data-stu-id="d0aca-164">Because Azure AD supports hello SAML 2.0 protocol, all that's required from an application is hello ability toointeract using this industry standard.</span></span> <span data-ttu-id="d0aca-165">(На самом деле приложения, использующие Azure AD, могут выполняться в любом центре обработки данных, а не только в центре обработки данных Azure).</span><span class="sxs-lookup"><span data-stu-id="d0aca-165">(In fact, applications that use Azure AD can run in any datacenter, not just an Azure datacenter.)</span></span>

<span data-ttu-id="d0aca-166">Hello процесс начинается, когда hello пользователь получает доступ к приложению SaaS (шаг 1).</span><span class="sxs-lookup"><span data-stu-id="d0aca-166">hello process begins when hello user accesses a SaaS application (step 1).</span></span> <span data-ttu-id="d0aca-167">toouse это приложение hello пользователь должен представить маркер, выданный службой Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-167">toouse this application, hello user must present a token issued by Azure AD.</span></span>

<span data-ttu-id="d0aca-168">Этот маркер содержит информацию, определяющую пользователя hello и цифровой подписью Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-168">This token contains information that identifies hello user, and it's digitally signed by Azure AD.</span></span> <span data-ttu-id="d0aca-169">токен tooget hello, hello пользователь проходит проверку себе tooAzure AD путем предоставления имени пользователя и пароля (шаг 2).</span><span class="sxs-lookup"><span data-stu-id="d0aca-169">tooget hello token, hello user authenticates himself tooAzure AD by providing a username and password (step 2).</span></span> <span data-ttu-id="d0aca-170">Затем Azure AD возвращает маркер hello, он должен (шаг 3).</span><span class="sxs-lookup"><span data-stu-id="d0aca-170">Azure AD then returns hello token he needs (step 3).</span></span>

<span data-ttu-id="d0aca-171">Затем этот маркер отправляется приложения SaaS toohello (шаг 4), который проверяет подпись маркера hello и использует его содержимое (шаг 5).</span><span class="sxs-lookup"><span data-stu-id="d0aca-171">This token is then sent toohello SaaS application (step 4), which validates hello token's signature and uses its contents (step 5).</span></span> <span data-ttu-id="d0aca-172">Как правило, приложение hello будет использовать сведения об удостоверении hello hello маркер содержит toodecide hello какие сведения пользователь может быть tooaccess и может быть по-другому.</span><span class="sxs-lookup"><span data-stu-id="d0aca-172">Typically, hello application will use hello identity information hello token contains toodecide what information hello user is allowed tooaccess and perhaps in other ways.</span></span>

<span data-ttu-id="d0aca-173">Если приложение hello необходимы дополнительные сведения о пользователе hello, чем что содержится в маркере hello, его можно запросить непосредственно из Azure AD, используя API Azure AD Graph hello (шаг 6).</span><span class="sxs-lookup"><span data-stu-id="d0aca-173">If hello application needs more information about hello user than what's contained in hello token, it can request this directly from Azure AD using hello Azure AD Graph API (step 6).</span></span> <span data-ttu-id="d0aca-174">Hello начальной версии Azure AD, схема directory hello достаточно прост: он содержит только пользователей, группы и связи между ними.</span><span class="sxs-lookup"><span data-stu-id="d0aca-174">In hello initial version of Azure AD, hello directory schema is quite simple: It contains just users and groups and relationships among them.</span></span> <span data-ttu-id="d0aca-175">Приложения могут использовать этот toolearn сведения о соединениях между пользователями.</span><span class="sxs-lookup"><span data-stu-id="d0aca-175">Applications can use this information toolearn about connections between users.</span></span> <span data-ttu-id="d0aca-176">Например предположим, что tooknow, являющийся руководителем этого пользователя toodecide, является ли он доступ toosome фрагмент данных, необходимых приложению.</span><span class="sxs-lookup"><span data-stu-id="d0aca-176">For example, suppose an application needs tooknow who this user's manager is toodecide whether he's allowed access toosome chunk of data.</span></span> <span data-ttu-id="d0aca-177">Его можно узнать с помощью запроса к Azure AD через Graph API hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-177">It can learn this by querying Azure AD through hello Graph API.</span></span>

<span data-ttu-id="d0aca-178">Hello Graph API используется обычный RESTful протокол, который позволяет простым toouse от большинства клиентов, включая мобильные устройства.</span><span class="sxs-lookup"><span data-stu-id="d0aca-178">hello Graph API uses an ordinary RESTful protocol, which makes it straightforward toouse from most clients, including mobile devices.</span></span> <span data-ttu-id="d0aca-179">Hello API также поддерживает hello расширения, определенные в OData, добавление такие элементы, как доступ к данным клиентов toolet запросов языка полезнее способами.</span><span class="sxs-lookup"><span data-stu-id="d0aca-179">hello API also supports hello extensions defined by OData, adding things such as a query language toolet clients access data in more useful ways.</span></span> <span data-ttu-id="d0aca-180">(Дополнительные сведения по OData см. в [этом документе](http://download.microsoft.com/download/E/5/A/E5A59052-EE48-4D64-897B-5F7C608165B8/IntroducingOData.pdf).) Поскольку hello Graph API используется toolearn о связях между пользователями, она позволяет понять hello социальных граф, который внедряется в схеме hello Azure AD для конкретной организации (что именно он вызывается hello Graph API) приложения.</span><span class="sxs-lookup"><span data-stu-id="d0aca-180">(For more on OData, see [Introducing OData](http://download.microsoft.com/download/E/5/A/E5A59052-EE48-4D64-897B-5F7C608165B8/IntroducingOData.pdf).) Because hello Graph API can be used toolearn about relationships between users, it lets applications understand hello social graph that's embedded in hello Azure AD schema for a particular organization (which is why it's called hello Graph API).</span></span> <span data-ttu-id="d0aca-181">И tooauthenticate сам запрашивает tooAzure AD для Graph API, приложение использует OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="d0aca-181">And tooauthenticate itself tooAzure AD for Graph API requests, an application uses OAuth 2.0.</span></span>

<span data-ttu-id="d0aca-182">Если организация не использует Windows Server Active Directory — он не имеет локальных серверов и доменов — и использует только облачных приложений, которые используют Azure AD, с помощью этого облачного каталога даст hello фирмы пользователи единого входа tooall из них.</span><span class="sxs-lookup"><span data-stu-id="d0aca-182">If an organization doesn't use Windows Server Active Directory - it has no on-premises servers or domains - and relies solely on cloud applications that use Azure AD, using just this cloud directory would give hello firm's users single sign-on tooall of them.</span></span> <span data-ttu-id="d0aca-183">Хотя этот сценарий становится все более распространенным, большинство организаций по-прежнему используют локальные домены, созданные с помощью Windows Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0aca-183">Yet while this scenario gets more common every day, most organizations still use on-premises domains created with Windows Server Active Directory.</span></span> <span data-ttu-id="d0aca-184">Azure AD предоставляет tooplay полезно роли здесь также, как [рис. 3](#fig3) показано.</span><span class="sxs-lookup"><span data-stu-id="d0aca-184">Azure AD has a useful role tooplay here as well, as [Figure 3](#fig3) shows.</span></span>

<span data-ttu-id="d0aca-185">![Azure Active Directory в виртуальной машине](./media/identity/identity_03_AD.png)
<a id="fig3"></a>рис. 3: организации можно создать федерацию Windows Server Active Directory с Azure Active Directory toogive-tooSaaS приложениям пользователи.</span><span class="sxs-lookup"><span data-stu-id="d0aca-185">![Azure Active Directory in Virtual Machine](./media/identity/identity_03_AD.png)
<a id="fig3"></a>Figure 3: An organization can federate Windows Server Active Directory with Azure Active Directory toogive its users single sign-on tooSaaS applications.</span></span>

<span data-ttu-id="d0aca-186">В этом сценарии пользователь в организации B хочет tooaccess приложения SaaS.</span><span class="sxs-lookup"><span data-stu-id="d0aca-186">In this scenario, a user at organization B wishes tooaccess a SaaS application.</span></span> <span data-ttu-id="d0aca-187">Прежде, чем она делает это, Администраторы организации hello каталога необходимо установить отношения федерации с Azure AD с помощью AD FS, как показано на рисунке hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-187">Before she does this, hello organization's directory administrators must establish a federation relationship with Azure AD using AD FS, as hello figure shows.</span></span> <span data-ttu-id="d0aca-188">Эти администраторы также необходимо настроить синхронизацию данных между hello организации в локальной среде Windows Server AD и Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-188">Those admins must also configure data synchronization between hello organization's on-premises Windows Server AD and Azure AD.</span></span> <span data-ttu-id="d0aca-189">Это автоматически копирует пользовательской и групповой информации из tooAzure directory hello в локальной среде AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-189">This automatically copies user and group information from hello on-premises directory tooAzure AD.</span></span> <span data-ttu-id="d0aca-190">Обратите внимание, что это позволяет: В результате организации hello расширяет его в локальный каталог в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-190">Notice what this allows: In effect, hello organization is extending its on-premises directory into hello cloud.</span></span> <span data-ttu-id="d0aca-191">Комбинирование Windows Server AD и Azure AD в этом случае дает hello организации служба каталогов, в которой можно управлять как единой сущностью, сохраняя использует объем как локально, так и в облаке hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-191">Combining Windows Server AD and Azure AD in this way gives hello organization a directory service that can be managed as a single entity, while still having a footprint both on-premises and in hello cloud.</span></span>

<span data-ttu-id="d0aca-192">toouse Azure AD hello сначала входе пользователя в домене Active Directory локальной tooher обычным образом (шаг 1).</span><span class="sxs-lookup"><span data-stu-id="d0aca-192">toouse Azure AD, hello user first logs in tooher on-premises Active Directory domain as usual (step 1).</span></span> <span data-ttu-id="d0aca-193">Когда она пытается tooaccess hello SaaS приложения (шаг 2), hello федерации в результате Azure AD выдает свой маркер для этого приложения (шаг 3).</span><span class="sxs-lookup"><span data-stu-id="d0aca-193">When she tries tooaccess hello SaaS application (step 2), hello federation process results in Azure AD issuing her a token for this application (step 3).</span></span> <span data-ttu-id="d0aca-194">(Дополнительные сведения о действии федерации см. в документе [Claims-Based Identity for Windows: Technologies and Scenarios](http://www.davidchappell.com/writing/white_papers/Claims-Based_Identity_for_Windows_v3.0--Chappell.docx) (Удостоверение на основе утверждений для Windows: технологии и сценарии).) Как ранее, этот маркер содержит информацию, определяющую пользователя hello и цифровой подписью Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-194">(For more on how federation works, see [Claims-Based Identity for Windows: Technologies and Scenarios](http://www.davidchappell.com/writing/white_papers/Claims-Based_Identity_for_Windows_v3.0--Chappell.docx).) As before, this token contains information that identifies hello user, and it's digitally signed by Azure AD.</span></span> <span data-ttu-id="d0aca-195">Затем этот маркер отправляется приложения SaaS toohello (шаг 4), который проверяет подпись маркера hello и использует его содержимое (шаг 5).</span><span class="sxs-lookup"><span data-stu-id="d0aca-195">This token is then sent toohello SaaS application (step 4), which validates hello token's signature and uses its contents (step 5).</span></span> <span data-ttu-id="d0aca-196">И в предыдущем сценарии hello, hello hello SaaS, приложение может использовать Graph API toolearn Дополнительные сведения о пользователе, если требуется (шаг 6).</span><span class="sxs-lookup"><span data-stu-id="d0aca-196">And is in hello previous scenario, hello SaaS application can use hello Graph API toolearn more about this user if necessary (step 6).</span></span>

<span data-ttu-id="d0aca-197">Сегодня Azure AD не может полностью заменить локальную службу Windows Server AD.</span><span class="sxs-lookup"><span data-stu-id="d0aca-197">Today, Azure AD isn't a complete replacement for on-premises Windows Server AD.</span></span> <span data-ttu-id="d0aca-198">Как уже упоминалось hello облачного каталога имеет гораздо более простой схемы, а также отсутствует такие элементы, как групповая политика, hello возможность toostore сведения о компьютерах и поддержка LDAP.</span><span class="sxs-lookup"><span data-stu-id="d0aca-198">As already mentioned, hello cloud directory has a much simpler schema, and it's also missing things such as group policy, hello ability toostore information about machines, and support for LDAP.</span></span> <span data-ttu-id="d0aca-199">(На самом деле компьютером Windows не может быть настроенный toolet входа пользователей в tooit с помощью всего лишь Azure AD — это не поддерживается.) Вместо этого hello начальной Azure AD имеют позволяя корпоративных приложений доступ пользователей в облаке hello без сохранения отдельное имя входа и освобождение локальные администраторы каталога вручную синхронизировать свои локального каталога с Каждое приложение SaaS, который использует их организации.</span><span class="sxs-lookup"><span data-stu-id="d0aca-199">(In fact, a Windows machine can't be configured toolet users log in tooit using nothing but Azure AD - this isn't a supported scenario.) Instead, hello initial goals of Azure AD include letting enterprise users access applications in hello cloud without maintaining a separate login and freeing on-premises directory administrators from manually synchronizing their on-premises directory with every SaaS application their organization uses.</span></span> <span data-ttu-id="d0aca-200">Со временем Однако ожидается, что этот tooaddress службы каталогов облачной более широкого круга сценариев.</span><span class="sxs-lookup"><span data-stu-id="d0aca-200">Over time, however, expect this cloud directory service tooaddress a wider range of scenarios.</span></span>

## <span data-ttu-id="d0aca-201"><a name="ac"></a>Использование службы контроля доступа Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d0aca-201"><a name="ac"></a>Using Azure Active Directory Access Control</span></span>
<span data-ttu-id="d0aca-202">Удостоверение на основе облачных технологий можно toosolve используется ряд проблем.</span><span class="sxs-lookup"><span data-stu-id="d0aca-202">Cloud-based identity technologies can be used toosolve a variety of problems.</span></span> <span data-ttu-id="d0aca-203">Azure Active Directory пользователям можно предоставить организации-toomultiple приложений SaaS, например.</span><span class="sxs-lookup"><span data-stu-id="d0aca-203">Azure Active Directory can give an organization's users single sign-on toomultiple SaaS applications, for example.</span></span> <span data-ttu-id="d0aca-204">Но технологии удостоверения в облаке hello также может использоваться в других целях.</span><span class="sxs-lookup"><span data-stu-id="d0aca-204">But identity technologies in hello cloud can also be used in other ways.</span></span>

<span data-ttu-id="d0aca-205">Предположим, например, что приложение желает своим пользователям вход с использованием токенов, выданных несколько toolet *Поставщики удостоверений (IdPs)*.</span><span class="sxs-lookup"><span data-stu-id="d0aca-205">Suppose, for instance, that an application wishes toolet its users log in using tokens issued by multiple *identity providers (IdPs)*.</span></span> <span data-ttu-id="d0aca-206">Сегодня существует множество поставщиков удостоверений, таких как Facebook, Google, Майкрософт и другие, и приложения часто позволяют пользователям использовать их удостоверения для входа.</span><span class="sxs-lookup"><span data-stu-id="d0aca-206">Lots of different identity providers exist today, including Facebook, Google, Microsoft, and others, and applications frequently let users sign in using one of these identities.</span></span> <span data-ttu-id="d0aca-207">Необходимо приложение зачем toomaintain свой собственный список пользователей и паролей при вместо этого они могут использовать идентификаторы, которые уже существуют?</span><span class="sxs-lookup"><span data-stu-id="d0aca-207">Why should an application bother toomaintain its own list of users and passwords when it can instead rely on identities that already exist?</span></span> <span data-ttu-id="d0aca-208">Принятие существующих удостоверений облегчает жизнь и пользователям, имеющим одну меньше tooremember имя пользователя и пароль, а также для людей hello, создание приложения hello, который больше не нужен toomaintain свой список имен пользователей и паролей.</span><span class="sxs-lookup"><span data-stu-id="d0aca-208">Accepting existing identities makes life simpler both for users, who have one less username and password tooremember, and for hello people who create hello application, who no longer need toomaintain their own lists of usernames and passwords.</span></span>

<span data-ttu-id="d0aca-209">Однако, хотя все поставщики удостоверений выдают маркеры, эти маркеры нестандартные — каждый поставщик использует собственный формат.</span><span class="sxs-lookup"><span data-stu-id="d0aca-209">But while every identity provider issues some kind of token, those tokens aren't standard - each IdP has its own format.</span></span> <span data-ttu-id="d0aca-210">Кроме того также hello сведения в этих токенов не standard.</span><span class="sxs-lookup"><span data-stu-id="d0aca-210">Furthermore, hello information in those tokens also isn't standard.</span></span> <span data-ttu-id="d0aca-211">Приложение, которое желает tooaccept токенов, выданных, скажем, Facebook, Google и Microsoft столкнетесь с задачей hello написания уникальный код toohandle, каждый из этих форматов.</span><span class="sxs-lookup"><span data-stu-id="d0aca-211">An application that wishes tooaccept tokens issued by, say, Facebook, Google, and Microsoft is faced with hello challenge of writing unique code toohandle each of these different formats.</span></span>

<span data-ttu-id="d0aca-212">Но так ли это необходимо?</span><span class="sxs-lookup"><span data-stu-id="d0aca-212">But why do this?</span></span> <span data-ttu-id="d0aca-213">Почему бы не создать посредника, который генерирует единый формат маркера с общим представлением сведений об удостоверении?</span><span class="sxs-lookup"><span data-stu-id="d0aca-213">Why not instead create an intermediary that can generate a single token format with a common representation of identity information?</span></span> <span data-ttu-id="d0aca-214">Этот подход может упростить жизненный для hello разработчики приложений, так как теперь они должны toohandle только один тип маркера.</span><span class="sxs-lookup"><span data-stu-id="d0aca-214">This approach would make life simpler for hello developers who create applications, since they now need toohandle only one kind of token.</span></span> <span data-ttu-id="d0aca-215">Azure Active Directory Access Control осуществляется точно, предоставляя посредника в облаке hello для работы с различными маркерами.</span><span class="sxs-lookup"><span data-stu-id="d0aca-215">Azure Active Directory Access Control does exactly this, providing an intermediary in hello cloud for working with diverse tokens.</span></span> <span data-ttu-id="d0aca-216">[На рисунке 4](#fig4) показано, как это работает</span><span class="sxs-lookup"><span data-stu-id="d0aca-216">[Figure 4](#fig4) shows how it works</span></span>

<span data-ttu-id="d0aca-217">![Azure Active Directory в виртуальной машине](./media/identity/identity_04_IdentityProviders.png)
<a id="fig4"></a>рис. 4: Azure Active Directory Access Control упрощает для приложений tooaccept удостоверение маркеры, выпущенные разными поставщиками удостоверений.</span><span class="sxs-lookup"><span data-stu-id="d0aca-217">![Azure Active Directory in Virtual Machine](./media/identity/identity_04_IdentityProviders.png)
<a id="fig4"></a>Figure 4: Azure Active Directory Access Control makes it easier for applications tooaccept identity tokens issued by different identity providers.</span></span>

<span data-ttu-id="d0aca-218">Hello процесс начинается, когда пользователь пытается приложения hello tooaccess из браузера.</span><span class="sxs-lookup"><span data-stu-id="d0aca-218">hello process begins when a user attempts tooaccess hello application from a browser.</span></span> <span data-ttu-id="d0aca-219">перенаправляет свой tooan поставщика удостоверений по его выбору приложение Hello (и это приложение hello также доверяет).</span><span class="sxs-lookup"><span data-stu-id="d0aca-219">hello application redirects her tooan IdP of her choice (and that hello application also trusts).</span></span> <span data-ttu-id="d0aca-220">Она проверяет подлинность себе toothis поставщика удостоверений, например путем ввода имени пользователя и пароля (шаг 1) и hello поставщика удостоверений возвращает маркер, содержащий сведения о своей (шаг 2).</span><span class="sxs-lookup"><span data-stu-id="d0aca-220">She authenticates herself toothis IdP, such as by entering a username and password (step 1), and hello IdP returns a token containing information about her (step 2).</span></span>

<span data-ttu-id="d0aca-221">Как показано на рисунке hello, управление доступом поддерживает ряд различных облачных IdPs, включая учетные записи, созданные Google, Yahoo, Facebook, корпорация Майкрософт (которая ранее называлась Windows Live ID) и любой поставщик OpenID.</span><span class="sxs-lookup"><span data-stu-id="d0aca-221">As hello figure shows, Access Control supports a range of different cloud-based IdPs, including accounts created by Google, Yahoo, Facebook, Microsoft (formerly known as Windows Live ID), and any OpenID provider.</span></span> <span data-ttu-id="d0aca-222">Поддерживаются также удостоверения, созданные с помощью Azure Active Directory, и, посредством федерации с AD FS, с помощью Windows Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0aca-222">It also supports identities created using Azure Active Directory and, through federation with AD FS, Windows Server Active Directory.</span></span> <span data-ttu-id="d0aca-223">Hello предназначена удостоверения toocover hello чаще всего используется в настоящее время ли они выпущен IdPs в облаке hello или в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="d0aca-223">hello goal is toocover hello most commonly used identities today, whether they're issued by IdPs in hello cloud or on-premises.</span></span>

<span data-ttu-id="d0aca-224">Когда браузер пользователя hello остается токен IdP из своей зависимости от выбранного поставщика удостоверений, он отправляет токен tooAccess управления (шаг 3).</span><span class="sxs-lookup"><span data-stu-id="d0aca-224">Once hello user's browser has an IdP token from her chosen IdP, it sends this token tooAccess Control (step 3).</span></span> <span data-ttu-id="d0aca-225">Управление доступом проверяет токен hello, убедившись, что он действительно был выдан этого поставщика удостоверений, а затем создает новый маркер toohello правила, определенные для этого приложения в соответствии с.</span><span class="sxs-lookup"><span data-stu-id="d0aca-225">Access Control validates hello token, making sure that it really was issued by this IdP, then creates a new token according toohello rules that have been defined for this application.</span></span> <span data-ttu-id="d0aca-226">Как Azure Active Directory управление доступом — это служба нескольких клиентов, но это hello клиентов, приложения, а не организаций-клиентов.</span><span class="sxs-lookup"><span data-stu-id="d0aca-226">Like Azure Active Directory, Access Control is a multi-tenant service, but hello tenants are applications rather than customer organizations.</span></span> <span data-ttu-id="d0aca-227">Каждое приложение может получить собственное пространство имен, как показано на рисунке hello и можно задать различные правила авторизации и многих других.</span><span class="sxs-lookup"><span data-stu-id="d0aca-227">Each application can get its own namespace, as hello figure shows, and can define various rules about authorization and more.</span></span>

<span data-ttu-id="d0aca-228">Эти правила позволяют администратору каждого приложения определить порядок преобразования маркеров различных поставщиков в маркер Access Control.</span><span class="sxs-lookup"><span data-stu-id="d0aca-228">These rules let each application's administrator define how tokens from various IdPs should be transformed into an Access Control token.</span></span> <span data-ttu-id="d0aca-229">Например, если поставщики удостоверений используют разные типы для представления имен пользователей, правила Access Control могут преобразовать все эти типы в общий тип имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="d0aca-229">For example, if different IdPs use different types for representing usernames, Access Control rules can transform all of these into a common username type.</span></span> <span data-ttu-id="d0aca-230">Управление доступом затем отправляет этот новый маркера задней toohello браузера (шаг 4), который отправляет его toohello приложения (шаг 5).</span><span class="sxs-lookup"><span data-stu-id="d0aca-230">Access Control then sends this new token back toohello browser (step 4), which submits it toohello application (step 5).</span></span> <span data-ttu-id="d0aca-231">Получив токен управления доступом hello, приложение hello проверяет, что этот токен действительно был выдан контроля доступа, а затем использует сведения hello, что она содержит (шаг 6).</span><span class="sxs-lookup"><span data-stu-id="d0aca-231">Once it has hello Access Control token, hello application verifies that this token really was issued by Access Control, then uses hello information it contains (step 6).</span></span>

<span data-ttu-id="d0aca-232">Хотя этот процесс может показаться немного сложным, фактически таким образом жизни значительно упрощается для hello создателя приложения hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-232">While this process might seem a little complicated, it actually makes life significantly simpler for hello creator of hello application.</span></span> <span data-ttu-id="d0aca-233">А не обрабатывает различные токены, содержащий различные сведения, приложение hello может принимать удостоверения, выданный различными поставщиками удостоверений, при получении один токен со знакомыми сведениями по-прежнему.</span><span class="sxs-lookup"><span data-stu-id="d0aca-233">Rather than handle diverse tokens containing different information, hello application can accept identities issued by multiple identity providers while still receiving only a single token with familiar information.</span></span> <span data-ttu-id="d0aca-234">Кроме того вместо требуют toobe каждого приложения настроен tootrust различные IdPs, доверительные отношения вместо поддерживаются службой управления доступом - достаточно лишь доверять приложение.</span><span class="sxs-lookup"><span data-stu-id="d0aca-234">Also, rather than require each application toobe configured tootrust various IdPs, these trust relationships are instead maintained by Access Control - an application need only trust it.</span></span>

<span data-ttu-id="d0aca-235">Стоит обратить внимание, что ничего не сказано о контроля доступа равноценных tooWindows - точно так же может использоваться приложением Linux, который принимается только удостоверений Google и Facebook.</span><span class="sxs-lookup"><span data-stu-id="d0aca-235">It's worth pointing out that nothing about Access Control is tied tooWindows - it could just as well be used by a Linux application that accepted only Google and Facebook identities.</span></span> <span data-ttu-id="d0aca-236">И, несмотря на то, что управление доступом является частью hello семейства Azure Active Directory, можно представить ее как службу полностью distinct из процесс, описанный в предыдущем разделе hello.</span><span class="sxs-lookup"><span data-stu-id="d0aca-236">And even though Access Control is part of hello Azure Active Directory family, you can think of it as an entirely distinct service from what was described in hello previous section.</span></span> <span data-ttu-id="d0aca-237">Хотя обе технологии работают с удостоверением, они решить проблемы, совершенно другой (несмотря на то, что корпорация Майкрософт говорят, что ожидается hello toointegrate двух в некоторой точке).</span><span class="sxs-lookup"><span data-stu-id="d0aca-237">While both technologies work with identity, they address quite different problems (although Microsoft has said that it expects toointegrate hello two at some point).</span></span>

<span data-ttu-id="d0aca-238">Работа с удостоверениями важна практически в любом приложении.</span><span class="sxs-lookup"><span data-stu-id="d0aca-238">Working with identity is important in nearly every application.</span></span> <span data-ttu-id="d0aca-239">Задача Hello контроля доступа является toomake облегчить работу разработчиков toocreate приложений, которые принимать удостоверения от различных поставщиков.</span><span class="sxs-lookup"><span data-stu-id="d0aca-239">hello goal of Access Control is toomake it easier for developers toocreate applications that accept identities from diverse identity providers.</span></span> <span data-ttu-id="d0aca-240">Поместив этой службы в облаке hello, корпорация Майкрософт предоставляет им tooany доступные приложения, запущенного на любой платформе.</span><span class="sxs-lookup"><span data-stu-id="d0aca-240">By putting this service in hello cloud, Microsoft has made it available tooany application running on any platform.</span></span>

## <a name="about-hello-author"></a><span data-ttu-id="d0aca-241">О hello автора</span><span class="sxs-lookup"><span data-stu-id="d0aca-241">About hello Author</span></span>
<span data-ttu-id="d0aca-242">Дэвид Чаппел (David Chappell) является главой компании Chappell & Associates [www.davidchappell.com](http://www.davidchappell.com), расположенной в Сан-Франциско, штат Калифорния.</span><span class="sxs-lookup"><span data-stu-id="d0aca-242">David Chappell is Principal of Chappell & Associates [www.davidchappell.com](http://www.davidchappell.com) in San Francisco, California.</span></span>

