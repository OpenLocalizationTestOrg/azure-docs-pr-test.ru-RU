

При создании проекта веб-приложения для Azure можно подготовить виртуальную машину в Azure. Затем можно настроить эту виртуальную машину, добавив дополнительное программное обеспечение, или использовать ее для диагностики или отладки.

Чтобы создать виртуальную машину при создании веб-приложения, выполните следующие действия.

1. В Visual Studio последовательно выберите **Файл** > **Создать** > **Проект** > **Интернет** и **Веб-приложение ASP.NET** (в узле **Visual C#** или **Visual Basic**).
2. В диалоговом окне **Новый проект ASP.NET** выберите нужный тип веб-приложения и в разделе Azure диалогового окна (в нижнем правом углу) установите флажок **Host in the cloud** (Разместить в облаке). В некоторых установках этот флажок имеет метку **Create remote resources** (Создать удаленные ресурсы).
   
    ![][0]
3. В данном случае в разделе Microsoft Azure в раскрывающемся списке выберите **Виртуальная машина (v1)**, а затем нажмите кнопку **ОК**.
4. Войдите в Azure, если появится соответствующий запрос. Откроется диалоговое окно **Создать виртуальную машину** .
   
    ![][2]
5. В поле **DNS-имя** введите имя виртуальной машины. Имя DNS должно быть уникальным в рамках Azure. Если указанное имя недоступно, появится красный восклицательный знак.
6. В списке **Образ** выберите образ, из которого нужно создать виртуальную машину. Вы можете выбрать любой стандартный образ виртуальной машины Azure или свой собственный образ, который вы предварительно передали в Azure.
7. Если не планируется установка другого веб-сервера, не снимайте флажок **Enable IIS and Web Deploy** (Включить IIS и веб-развертывание). Если отключить веб-развертывание, то нельзя будет выполнять публикацию из Visual Studio. Можно добавить IIS и веб-развертывание в любой упакованный образ Windows Server, включая собственные образы.
8. В поле **Размер** выберите размер виртуальной машины.
9. Укажите учетные данные для входа на эту виртуальную машину. Запишите их, поскольку они потребуются для доступа к этой машине через удаленный рабочий стол.
10. В списке **Расположение** выберите регион, в котором будет размещена виртуальная машина.
11. Нажмите кнопку **ОК**, после чего начнется создание виртуальной машины. Ход выполнения операции можно отслеживать в окне **Вывод** .
    
    ![][3]
12. Когда виртуальная машина подготавливается, создаются опубликованные скрипты в узле **PublishScripts** решения. Опубликованный скрипт выполняется и подготавливает виртуальную машину в Azure. В окне **вывода** показывается состояние. Для установки виртуальной машины скрипт выполняет следующие действия.
    
    * Создает виртуальную машину, если она не существует.
    * Создает учетную запись хранения с именем, начинающимся на `devtest`, но только если такая учетная запись хранения еще не существует в указанном регионе.
    * Создает облачную службу в качестве контейнера для виртуальной машины, а также создает веб-роль для веб-приложения.
    * Настраивает на виртуальной машине веб-развертывание.
    * Настраивает на виртуальной машине IIS и ASP.NET.
    
    ![][4]
13. При необходимости можно подключиться к новой виртуальной машине. В **обозревателе сервера** разверните узел **Виртуальные машины**, выберите узел для созданной виртуальной машины, а затем в его контекстном меню выберите пункт **Connect with Remote Desktop** (Подключиться к удаленному рабочему столу). Кроем того, можно открыть **обозреватель облака**, выбрать в контекстном меню параметр **Открыть на портале** и подключиться к виртуальной машине через него.
    
    ![][5]

## <a name="next-steps"></a>Дополнительная информация
Подробные сведения о том, как настроить созданные опубликованные скрипты, см. в статье [Использование скриптов Windows PowerShell для публикации в средах разработки и тестирования](http://msdn.microsoft.com/library/dn642480.aspx).

[0]: ./media/virtual-machines-common-classic-web-app-visual-studio/CreateVM_NewProject.PNG
[1]: ./media/dotnet-visual-studio-create-virtual-machine/CreateVM_SignIn.PNG
[2]: ./media/virtual-machines-common-classic-web-app-visual-studio/CreateVM_CreateVM.PNG
[3]: ./media/virtual-machines-common-classic-web-app-visual-studio/CreateVM_Provisioning.png
[4]: ./media/virtual-machines-common-classic-web-app-visual-studio/CreateVM_SolutionExplorer.png
[5]: ./media/virtual-machines-common-classic-web-app-visual-studio/VS_Create_VM_Connect.png
