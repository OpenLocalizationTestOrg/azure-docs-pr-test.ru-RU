

<span data-ttu-id="09d33-101">В службах инфраструктуры Azure доступны два уровня балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="09d33-101">There are two levels of load balancing available for Azure infrastructure services:</span></span>

* <span data-ttu-id="09d33-102">**Уровень DNS**: балансировки нагрузки для трафика toodifferent облачных служб находятся в различных центрах обработки, toodifferent веб-сайты Azure находятся в разных центрах обработки данных или tooexternal конечные точки.</span><span class="sxs-lookup"><span data-stu-id="09d33-102">**DNS Level**:  Load balancing for traffic toodifferent cloud services located in different data centers, toodifferent Azure websites located in different data centers, or tooexternal endpoints.</span></span> <span data-ttu-id="09d33-103">Это делается с помощью диспетчера трафика Azure и метод балансировки нагрузки hello циклического перебора.</span><span class="sxs-lookup"><span data-stu-id="09d33-103">This is done with Azure Traffic Manager and hello Round Robin load balancing method.</span></span>
* <span data-ttu-id="09d33-104">**Сетевой уровень**: входящее Интернет трафика toodifferent виртуальных машин облачной службы балансировки нагрузки или балансировку нагрузки трафика между виртуальными машинами в облачной службе или виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="09d33-104">**Network Level**:  Load balancing of incoming Internet traffic toodifferent virtual machines of a cloud service, or load balancing of traffic between virtual machines in a cloud service or virtual network.</span></span> <span data-ttu-id="09d33-105">Это делается с подсистемой балансировки нагрузки Azure hello.</span><span class="sxs-lookup"><span data-stu-id="09d33-105">This is done with hello Azure load balancer.</span></span>

## <a name="traffic-manager-load-balancing-for-cloud-services-and-websites"></a><span data-ttu-id="09d33-106">Балансировка нагрузки диспетчером трафика для облачных служб и веб-сайтов</span><span class="sxs-lookup"><span data-stu-id="09d33-106">Traffic Manager load balancing for cloud services and websites</span></span>
<span data-ttu-id="09d33-107">Диспетчер трафика позволяет распределение hello toocontrol tooendpoints трафика пользователя, который может включать облачных служб, веб-сайтов, внешние веб-сайты и другие профили диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="09d33-107">Traffic Manager allows you toocontrol hello distribution of user traffic tooendpoints, which can include cloud services, websites, external sites, and other Traffic Manager profiles.</span></span> <span data-ttu-id="09d33-108">Диспетчер трафика работает путем применения tooDomain имен (DNS) интеллектуальной политики обработчик запросов для hello доменных имен Интернет-ресурсов.</span><span class="sxs-lookup"><span data-stu-id="09d33-108">Traffic Manager works by applying an intelligent policy engine tooDomain Name System (DNS) queries for hello domain names of your Internet resources.</span></span> <span data-ttu-id="09d33-109">Облачные службы или веб-сайтов могут работать в разных центрах обработки данных по Здравствуй, мир.</span><span class="sxs-lookup"><span data-stu-id="09d33-109">Your cloud services or websites can be running in different datacenters across hello world.</span></span>

<span data-ttu-id="09d33-110">Как конечные точки необходимо использовать REST или Windows PowerShell tooconfigure внешние конечные точки или профили диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="09d33-110">You must use either REST or Windows PowerShell tooconfigure external endpoints or Traffic Manager profiles as endpoints.</span></span>

<span data-ttu-id="09d33-111">Диспетчер трафика использует три балансировки нагрузки трафика toodistribute методов:</span><span class="sxs-lookup"><span data-stu-id="09d33-111">Traffic Manager uses three load-balancing methods toodistribute traffic:</span></span>

* <span data-ttu-id="09d33-112">**Переход на другой ресурс**: используйте этот метод при необходимости toouse основную конечную точку для всего трафика, но обеспечивать резервные копии на случай недоступности основного hello.</span><span class="sxs-lookup"><span data-stu-id="09d33-112">**Failover**:  Use this method when you want toouse a primary endpoint for all traffic, but provide backups in case hello primary becomes unavailable.</span></span>
* <span data-ttu-id="09d33-113">**Производительность**: используйте этот метод, если конечные точки в разных географических регионах и требуется запрос «близко расположенные» endpoint hello toouse-клиенты с точки зрения hello наименьшую задержку.</span><span class="sxs-lookup"><span data-stu-id="09d33-113">**Performance**:  Use this method when you have endpoints in different geographic locations and you want requesting clients toouse hello "closest" endpoint in terms of hello lowest latency.</span></span>
* <span data-ttu-id="09d33-114">**Циклический перебор:** используйте этот метод при необходимости toodistribute нагрузку по нескольким облачных служб в hello же центре обработки данных или в нескольких облачных служб или веб-сайтов в разных центрах обработки данных.</span><span class="sxs-lookup"><span data-stu-id="09d33-114">**Round Robin:**  Use this method when you want toodistribute load across a set of cloud services in hello same datacenter or across cloud services or websites in different datacenters.</span></span>

<span data-ttu-id="09d33-115">Дополнительные сведения см. в статье [О методах балансировки нагрузки диспетчера трафика](../articles/traffic-manager/traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-115">For more information, see [About Traffic Manager Load Balancing Methods](../articles/traffic-manager/traffic-manager-routing-methods.md).</span></span>

<span data-ttu-id="09d33-116">Следующая схема Hello показан пример hello циклического метода балансировки нагрузки для распределения трафика между разных облачных службах.</span><span class="sxs-lookup"><span data-stu-id="09d33-116">hello following diagram shows an example of hello Round Robin load balancing method for distributing traffic between different cloud services.</span></span>

![loadbalancing](./media/virtual-machines-common-load-balance/TMSummary.png)

<span data-ttu-id="09d33-118">Hello базовый процесс выглядит hello следующее:</span><span class="sxs-lookup"><span data-stu-id="09d33-118">hello basic process is hello following:</span></span>

1. <span data-ttu-id="09d33-119">Интернет-клиент запрашивает домена имя соответствующей tooa веб-службы.</span><span class="sxs-lookup"><span data-stu-id="09d33-119">An Internet client queries a domain name corresponding tooa web service.</span></span>
2. <span data-ttu-id="09d33-120">DNS пересылает hello имя запроса запроса tooTraffic диспетчера.</span><span class="sxs-lookup"><span data-stu-id="09d33-120">DNS forwards hello name query request tooTraffic Manager.</span></span>
3. <span data-ttu-id="09d33-121">Диспетчер трафика выбирает hello Далее облачной службы в hello циклический перебор списка и отправляет обратно hello DNS-имя.</span><span class="sxs-lookup"><span data-stu-id="09d33-121">Traffic Manager chooses hello next cloud service in hello Round Robin list and sends back hello DNS name.</span></span> <span data-ttu-id="09d33-122">Hello Интернет клиента DNS-сервер разрешает hello имя tooan IP-адрес и отправляет его toohello Интернет-клиента.</span><span class="sxs-lookup"><span data-stu-id="09d33-122">hello Internet client's DNS server resolves hello name tooan IP address and sends it toohello Internet client.</span></span>
4. <span data-ttu-id="09d33-123">Hello Интернет-клиент соединяется с hello облачной службы, выбранной с помощью диспетчера трафика.</span><span class="sxs-lookup"><span data-stu-id="09d33-123">hello Internet client connects with hello cloud service chosen by Traffic Manager.</span></span>

<span data-ttu-id="09d33-124">Дополнительные сведения см. в статье [Диспетчер трафика](../articles/traffic-manager/traffic-manager-overview.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-124">For more information, see [Traffic Manager](../articles/traffic-manager/traffic-manager-overview.md).</span></span>

## <a name="azure-load-balancing-for-virtual-machines"></a><span data-ttu-id="09d33-125">Балансировка нагрузки Azure для виртуальных машин</span><span class="sxs-lookup"><span data-stu-id="09d33-125">Azure load balancing for virtual machines</span></span>
<span data-ttu-id="09d33-126">Здравствуйте, виртуальных машин в одной облачной службе или виртуальной сети могут взаимодействовать друг с другом напрямую, используя их частные IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="09d33-126">Virtual machines in hello same cloud service or virtual network can communicate with each other directly using their private IP addresses.</span></span> <span data-ttu-id="09d33-127">Компьютеры и службы за пределами hello облачной службы или виртуальной сети могут взаимодействовать только с виртуальными машинами в облачной службе или виртуальной сети с настроенной конечной точки.</span><span class="sxs-lookup"><span data-stu-id="09d33-127">Computers and services outside hello cloud service or virtual network can only communicate with virtual machines in a cloud service or virtual network with a configured endpoint.</span></span> <span data-ttu-id="09d33-128">Конечная точка — сопоставление общедоступный IP-адрес и порт toothat частный IP-адрес и порт виртуальной машины или веб-роли в облачной службе Azure.</span><span class="sxs-lookup"><span data-stu-id="09d33-128">An endpoint is a mapping of a public IP address and port toothat private IP address and port of a virtual machine or web role within an Azure cloud service.</span></span>

<span data-ttu-id="09d33-129">случайным образом Hello подсистемы балансировки нагрузки Azure распределяет определенный тип входящего трафика на несколько виртуальных машин и служб в конфигурации, известный как набор с балансировкой нагрузки.</span><span class="sxs-lookup"><span data-stu-id="09d33-129">hello Azure Load Balancer randomly distributes a specific type of incoming traffic across multiple virtual machines or services in a configuration known as a load-balanced set.</span></span> <span data-ttu-id="09d33-130">Например можно распределить hello нагрузки трафика веб-запросов по нескольким веб-серверам или веб-ролей.</span><span class="sxs-lookup"><span data-stu-id="09d33-130">For example, you can spread hello load of web request traffic across multiple web servers or web roles.</span></span>

<span data-ttu-id="09d33-131">Hello следующая диаграмма показывает конечную точку с балансировкой нагрузки для стандартных (незашифрованные) веб-трафика, который разделяется между тремя виртуальными машинами для hello открытого и закрытого TCP-порт 80.</span><span class="sxs-lookup"><span data-stu-id="09d33-131">hello following diagram shows a load-balanced endpoint for standard (unencrypted) web traffic that is shared among three virtual machines for hello public and private TCP port of 80.</span></span> <span data-ttu-id="09d33-132">Эти три виртуальные машины находятся в наборе балансировки нагрузки.</span><span class="sxs-lookup"><span data-stu-id="09d33-132">These three virtual machines are in a load-balanced set.</span></span>

![loadbalancing](./media/virtual-machines-common-load-balance/LoadBalancing.png)

<span data-ttu-id="09d33-134">Дополнительные сведения см. в статье [Подсистема балансировки нагрузки Azure](../articles/load-balancer/load-balancer-overview.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-134">For more information, see [Azure Load Balancer](../articles/load-balancer/load-balancer-overview.md).</span></span> <span data-ttu-id="09d33-135">Hello шаги toocreate набор с балансировкой нагрузки, см. в разделе [настроить набор балансировки нагрузки](../articles/load-balancer/load-balancer-get-started-internet-arm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-135">For hello steps toocreate a load-balanced set, see [Configure a load-balanced set](../articles/load-balancer/load-balancer-get-started-internet-arm-ps.md).</span></span>

<span data-ttu-id="09d33-136">Azure также может распределять нагрузку внутри облачной службы или виртуальной сети.</span><span class="sxs-lookup"><span data-stu-id="09d33-136">Azure can also load balance within a cloud service or virtual network.</span></span> <span data-ttu-id="09d33-137">Это называется внутренней балансировки нагрузки и может использоваться в hello следующих способов:</span><span class="sxs-lookup"><span data-stu-id="09d33-137">This is known as internal load balancing and can be used in hello following ways:</span></span>

* <span data-ttu-id="09d33-138">tooload нагрузку между серверами в разных уровнях многоуровневого приложения (например, между уровнями web и базы данных).</span><span class="sxs-lookup"><span data-stu-id="09d33-138">tooload balance between servers in different tiers of a multi-tier application (for example, between web and database tiers).</span></span>
* <span data-ttu-id="09d33-139">tooload баланс бизнес-БИЗНЕС-приложения размещенного в Azure без дополнительной нагрузки балансировки оборудования или программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="09d33-139">tooload balance line-of-business (LOB) applications hosted in Azure without requiring additional load balancer hardware or software.</span></span>
* <span data-ttu-id="09d33-140">tooinclude локальных серверов в набор компьютеров, трафик которого будет осуществляться Балансировка hello.</span><span class="sxs-lookup"><span data-stu-id="09d33-140">tooinclude on-premises servers in hello set of computers whose traffic is load balanced.</span></span>

<span data-ttu-id="09d33-141">Аналогичные tooAzure балансировки нагрузки, внутренней балансировки нагрузки можно добиться, настроив набор с внутренней балансировкой нагрузки.</span><span class="sxs-lookup"><span data-stu-id="09d33-141">Similar tooAzure load balancing, internal load balancing is facilitated by configuring an internal load-balanced set.</span></span>

<span data-ttu-id="09d33-142">Следующая схема Hello показан пример внутренней конечной с балансировкой нагрузки для бизнес-приложений, с которым среди трех виртуальных машин в виртуальной сети между организациями.</span><span class="sxs-lookup"><span data-stu-id="09d33-142">hello following diagram shows an example of an internal load-balanced endpoint for a line of business (LOB) application that is shared among three virtual machines in a cross-premises virtual network.</span></span>

![loadbalancing](./media/virtual-machines-common-load-balance/LOBServers.png)

## <a name="load-balancer-considerations"></a><span data-ttu-id="09d33-144">Особенности балансировщика нагрузки</span><span class="sxs-lookup"><span data-stu-id="09d33-144">Load balancer considerations</span></span>
<span data-ttu-id="09d33-145">Настройка балансировки нагрузки по умолчанию tootimeout простоя сеанс в 4 минуты.</span><span class="sxs-lookup"><span data-stu-id="09d33-145">A load balancer is configured by default tootimeout an idle session in 4 minutes.</span></span> <span data-ttu-id="09d33-146">Если ваше приложение за подсистемой балансировки нагрузки оставляет подключение бездействия более 4 минут, которая не имеет конфигурацию Keep-Alive, hello соединения будут удалены.</span><span class="sxs-lookup"><span data-stu-id="09d33-146">If your application behind a load balancer leaves a connection idle for more than 4 minutes and it doesn't have a Keep-Alive configuration, hello connection will be dropped.</span></span> <span data-ttu-id="09d33-147">Вы можете изменить tooallow поведение подсистемы балансировки нагрузки hello [больше времени ожидания для балансировки нагрузки Azure](../articles/load-balancer/load-balancer-tcp-idle-timeout.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-147">You can change hello load balancer behavior tooallow a [longer timeout setting for Azure load balancer](../articles/load-balancer/load-balancer-tcp-idle-timeout.md).</span></span>

<span data-ttu-id="09d33-148">Другим аспектом является hello тип распределения, поддерживаемый подсистемой балансировки нагрузки Azure.</span><span class="sxs-lookup"><span data-stu-id="09d33-148">Other consideration is hello type of distribution mode supported by Azure Load Balancer.</span></span> <span data-ttu-id="09d33-149">Вы можете настроить сходство IP-адреса источника (IP-адрес источника, IP-адрес назначения) или протокол IP-адреса источника (IP-адрес источника, IP-адрес назначения и протокол).</span><span class="sxs-lookup"><span data-stu-id="09d33-149">You can configure source IP affinity (source IP, destination IP) or source IP protocol (source IP , destination IP and protocol).</span></span> <span data-ttu-id="09d33-150">Дополнительные сведения см. в статье [Режим распределения балансировщика нагрузки (соответствие исходному IP-адресу)](../articles/load-balancer/load-balancer-distribution-mode.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-150">Check out [Azure Load Balancer distribution mode (source IP affinity)](../articles/load-balancer/load-balancer-distribution-mode.md) for more information.</span></span>

## <a name="next-steps"></a><span data-ttu-id="09d33-151">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="09d33-151">Next steps</span></span>
<span data-ttu-id="09d33-152">Hello шаги toocreate набор с балансировкой нагрузки, см. в разделе [настроить набор с внутренней балансировкой нагрузки](../articles/load-balancer/load-balancer-get-started-ilb-arm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-152">For hello steps toocreate a load-balanced set, see [Configure an internal load-balanced set](../articles/load-balancer/load-balancer-get-started-ilb-arm-ps.md).</span></span>

<span data-ttu-id="09d33-153">Дополнительные сведения см. в статье [Внутренняя балансировка нагрузки](../articles/load-balancer/load-balancer-internal-overview.md).</span><span class="sxs-lookup"><span data-stu-id="09d33-153">For more information about load balancer, see [Internal load balancing](../articles/load-balancer/load-balancer-internal-overview.md).</span></span>

